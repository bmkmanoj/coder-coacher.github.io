<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Fallacies of Doom - Lessons learned from porting Doom 3 to Java  by Mahmoud Abdelghany | Coder Coacher - Coaching Coders</title><meta content="Fallacies of Doom - Lessons learned from porting Doom 3 to Java  by Mahmoud Abdelghany - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Fallacies of Doom - Lessons learned from porting Doom 3 to Java  by Mahmoud Abdelghany</b></h2><h5 class="post__date">2018-03-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GkNofv3yt18" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so welcome and I my name is
Mahmoud of the honey I'm gonna tell you
some stuff about my project porting doom
to doom 3 to Java ok so a brief
introduction about some background about
concerning a project so so it software's
a company created do I don't work for
them unfortunately but so did some cool
games a lot of cool games actually the
quite is known for you know the whole
first person shooter thing and doom and
wolf and quake and that kind of stuff so
probably you know them from the another
cool thing that it is sorry is they open
sourced almost everything they they
created that's it's pretty cool it's
pretty I don't know when it's
progressive I mean most of these games
okay so you can ignore the first couple
of games working a wolf doom quake there
you know triple-a in games actually so
to open source something like that back
in the 90s
so pretty interesting so everybody has
hacked doom and and such and modded them
and to oblivion and it's amazing a very
different era they come from very
different era from the 90s anybody here
has lived through the 90s prior to you
know Stack Overflow and I people
just reinvented the wheel all the time
and interesting stuff came from from
that and you see a lot of stuff you know
if you look at source code like this or
you know the Linux kernel source code of
any source code that's exists for a long
time you see a lot of this kind of stuff
to demonstrate that I have a nerd rage
anecdote it's nothing to do with me but
back in the 90s after they released
source code of doom people we know were
looking through the source code and code
revealed the source code and and
somebody you know you notice the word
the way acid loading worked in June was
basically
you have large file and if you want the
picture of the doom guy just iterate
through the whole file do you find the
doom picture and you know that you want
the sound of the shotgun you just it's
ready to be found and such an cetera you
know what I'm telling it right now
everybody thinks that's very inefficient
and that's what the people thought in
90s and you know they got angry and mad
and went to Maine in this which was you
know the Facebook of the 90s and started
ranting about it and this is not how
it's supposed to be everybody knows this
kind of stuff he put it in the hash map
and such our hash table and doom guys
themselves they were also under under
mailing us and they you know replied I
don't know we really worked on this hard
we thought it out and we tested it under
kind of stuff and this is this is how
this is the most efficient way to do it
nobody really believed them but it
turned out they were really right so
this was the easiest way to do it
but it also used the least resources so
back in the nineties disk space was a
problem memory was a problem CPU was a
problem so you know creating a hash
table for something like this for all
your assets I don't know maybe it was a
couple of hundred bytes I'm not sure how
much it would be but it's it's memory
you don't have so this was the most
efficient solution for for the game you
know and if you put it in a hash table
maybe your game would load faster but it
would be marginally faster and who cares
about that you know it's better that the
hell but the game would run faster than
load faster you know so so that's all
really like that story you know because
mmm what the story to me at least
demonstrates it was discussing this with
a friend of mine and he told me I a
premature optimization is the root of
all evil
and sure but but to me it really
signifies something like how many of us
actually do the optimization to optimize
something else you know most of us just
optimize the place and then forget about
it and then optimizes the next place and
such but how many of us actually D up to
my son thing to gain performance
somewhere else so that's interesting so
June 3 is name of project
the Java version of something get up and
such I've been working on it I think now
for three and a half four years or
something to me at least it's amazing
you know it's a lot of code if you look
at the table below so that's kind of the
evolution of their engines game engines
over time so this is the first dune 42
thousand lines of code it took four that
is this one doom three six hundred
thousand nine to go so that's amazing so
I've worked on six hundred eyes of codes
in single projects hadn't done it before
and one of the most amazing things I
learned is you know I always thought you
know programmers some programmers were
super geniuses and they could you know
fit a million lines of code in their
heads and just remember every part of it
but after working on this and after
reading some stuff the guys that worked
on this talked about they they and they
had the same problem I have I couldn't
fit all this in my head at the same time
and this I've been program for twenty
years this is the first time you know in
my career that I've really encountered
such a large code base for a single
thing you know so so as you see I you
see in the demo at the end you know some
stuff is just broken and I had that
stuff was working I don't know months
ago but now it's broken
and to fix that it's it was probably you
know a very simple fix but I have to
some of the sound is not working
properly for example but I'm doing a lot
of graphics bugs right now so if I have
to switch that context you know I lose
all the graphics it will take me about a
week to just switch the context and they
lose all the graphics knowledge I have
at the moment and such and it's kind of
annoying so but you know so so why this
cool intro so the intro is to give you a
bit of a context switch action since we
just as I mentioned that so this is all
very game oriented you know it's not
gaming oriented in the sense that we're
gonna you know describe how games are
made of such but a lot of the stuff
that's that's going to be presented here
or I'm gonna rent it out actually might
not really be interesting to what we do
in our day-to-day jobs you know so I
don't know operator overloading who
cares about operator of
learning for a java enterprise
application for example but for games
they're pretty cool they're pretty
interesting they're very important you
know they reduce errors abuse bugs and
that kind of stuff so so that's
basically this whole intro also to you
know just way some time so yeah so
disclaimer I'm not an expert of course I
didn't work on the original doom at the
Java architect that kind of stuff so
take everything I say with a lot of
grains of salt and if anything is
interesting just tested out yourself
first before just believing it by people
tend to do with conferences so well the
first part of the talk is basically some
stuff you know so you're porting a lot
of C++ or Java and you miss a lot of
stuff in Java and you just wanted maybe
it's cool to have it maybe it's not too
cool there some people disagree with
most of what I say and a lot of people
just think I'm being stupid
yeah so be honest Trust for people don't
know yes he's like the James Gosling or
C++ so imagine him saying this about his
own language is pretty interesting well
okay so yeah so I'm gonna start out with
overloading and this picture is you just
have to love you know the level of
innovation and creativity of humans so
yeah so operate over long Java doesn't
have operator overloading what is
operator overloading in some languages
like C++ obviously you can define a
mathematical you can define any kind of
object you can say if I use an operator
like the plus or equals or whatever with
this type of object with another type of
object so type object a plus B for
example you should you know add the
members or multiply them or whatever you
want so like I said this might not be
very interesting for our enterprise
applications but for games you know
games especially 3d graphics games are
basically just math you know a lot of
math you know a lot of 3d space geometry
math so you know you want to define
matrices and vectors and and curves and
whatever and you want to you know do
math on them obviously and so yeah so so
the first one oh yeah so the one on top
so that's from a paper guy Steele wrote
he was one of the versions Java are six
it's a long big paper
but this was one of the things he said
is basically we want operator
overloading in Java future Java but then
guy Steele disappeared and nobody knows
where it is so I don't know but yeah the
first line of code so this is basically
life code from from the C++ version and
the one below that this is how I did it
in Java and also I chose you know to the
prefix anything with this lowercase oh
that would mean it's an operator and a
multiply plus minus whatever that's such
and this is basically yeah okay so it's
maybe it's it's it's not the best way
I'm not sure but to me it was the best
way it worked and yeah I found it so I
created this and I think this is
you know so this is just not readable
it's it's very error-prone this kind of
stuff so I showed this specific one
because I had a bug in this and spent
like two weeks chasing it and it was
basically one bracket that was too far
and it just happens you know it's with
with the one you know what's on top on
one above you know it's much easy to
find those kind of bugs yeah so this is
a simple example of what I mean but by
these kind of bugs so this is you know
you want to do this kind of operation in
C++ yeah so this is how I first wrote
this kind of stuff in Java but this is
actually wrong you know so anybody who's
you know familiar with these kind of
bugs so because you have to operate the
precedence you know if you do it like
this you add a to being and you multiply
the result by C but it's really not
correct so this is how we actually
should do it you know yeah it's not
readable anymore I know but yeah so
that's and this is you know kind of like
what the compiler does but still not to
be everyone still whatever so like the
kind of stuff oh okay whatever so yeah
then the next one
yeah I had a big picture but we have no
internet here so so that so the next one
is unsigned primitives so Java doesn't
have so Java has a chair no character
that's some other side primitive but you
know if you do math with Sheridan is
something wrong with you
so Java doesn't have other on-site
primitives it doesn't have the unsigned
keyword with you which you do have in
C++ and other a lot of other languages
or summer we just have an unsigned
cyclic EU int for example which means
I'm sayin
and it's basically no an integer with
only positive range you know so double
the range is just you know just shifted
for it so instead of 0 to 31 with 2 to
the 31st minus 1 or something it's just
the full range yeah
Java doesn't have that because I don't
know why actually I dunno why but it's a
long story
so yeah so the simple solution is just
you know to use didn't so first this one
actually I love this one this will
compile you know and this will run
actually it will you know throw the
throw an exception when you when you get
here of course but but o compile why
because it's a valid Java code you know
an integer array an array you know takes
an integer not a long an integer as its
size so yeah it can be a negative number
sure whatever nobody thought to check
this or throw an exception when you do
this but okay oh yeah so this so the
simple solution for using unsigned
integers and again this might not seem
important but in games this is very
important yeah and in other types of
stuff you know like like when when he
work with electronics and such you know
we just want to wrap around stuff and he
don't want a negative and you have to
bitmask it and such and very annoying so
yeah the simple solution is just you
know to use the next permissive over so
if you need an integer
yeah unsigned you use a long you know do
you need a long and unsigned long when
you're yeah so yeah there's no
solution for it so yeah and of course
when I when I came across this problem
the first thing that came to my mind
would I know some of you are thinking is
hey use being it begins or big decimals
and such and yeah I really thought it
was a good idea at the time I did a lot
of refactoring just trying this out but
then your memory footprint just
quadrupled
no for no apparent reason and it got
slower and such so you see some
benchmarks simple benchmarks you know
just that simple loop over there and you
just note you know even a difference
between int and integer which is
basically the same thing but an object
you know there is a difference there you
know and you think about it you know for
a game for stuff that has I don't know
thousands and sometimes millions loops
iterations per second this is not cool
you know so if you do this once for
micro-service or whatever guess so yeah
so micro benchmark yeah cool yeah
not sure why this picture loaded but
okay so yeah immutable it's Java doesn't
have any so it does that kind of
handsome usability but it doesn't have
something like in C++ you have comes you
have a keyword cough comes and just put
it in front of something and it becomes
immutable it's like magic yeah we don't
have that we have fine it doesn't do
anything you know it just appears to do
something yeah okay so to be fair final
you know it's it's supposed to do
something else it's not supposed to do
this it's not supposed to replace cons
but I don't know if you if you look on
old older Stack Overflow posts or I
don't remember what we used to do before
Stack Overflow but if you look in older
literature so to speak everybody says no
no we don't have constant Java use final
as if this is supposed to you know
substitute accounts absolutely not and
ironically Ofcom's
is a reserved keyword in Java it's never
gonna be used I think I hope it's gonna
be used but so so these are some
examples I'm gonna go through one or two
of them but you know
oh yeah and comes in in C++ when you put
it in front of something it not only
becomes immutable it becomes an
immutable type you know so crumbs
in this case for example and it comes
back three it's not the same as an eight
back three it's it's kind of like a
different type so we can't pass in
normal it back three to the function
granted you know so C C++ when you get
that low-level you know you can do
anything and you can you know work
anything so you can work around this
stuff but out of the box this is how
it's supposed to work and get dimension
for example you can define a function
Const you know in Java only define a
function final it can be overwritten
which is cool can be can be helpful I
guess but in this case you know this
function is not allowed to change
anything within within the object it's
called form so we know this is a
read-only function you're just looking
at the interface you know hey this
function is real so it's also cool we
don't have that in Java but maybe some
time we will have the kind of stuff so
yeah final and we're gonna rant about
that because just that yeah so another
operators that are never a functionality
that we don't really have in Java out of
the box is size up and I know this seems
like a useless operator really use the
functionality but you know for this game
exact specifications Joe has to know the
size of everything you pass it you know
it can just you know give it an object
and say okay this object just use it and
such no you have to give it a nine oh
five right and say hey this thing is
five right so that's how opengl works
and you can't change that maybe somebody
someday will but currently no this can't
this won't change because OpenGL is
basically talking to the hardware so
this is a hardware interface and how did
you change that this is not really you
know same actually and why would they
you know people aren't complaining about
this we're the only ones complaining
about but you don't have that in Java
and yeah so a simple solution for me at
least was you know to just define bytes
and every object I create and this is
actually something Java already has for
most of the stuff that's in Java so if
you call integers or bytes you get four
bytes back or or float the bytes on a
cursor so I basically just stole it from
them and I do like a kind of inheritance
and that's you know so this one calls as
this kind of stuff and it goes the a
track and whatever bytes so so yeah
so I'm gonna rant about this real quick
because last time I rant about this so
long that I ran out of time but enums in
Java are wonderful things that have
absolutely nothing to do with enums and
and this is very weird so so so the
thing about you know the foo so this is
an example in um of everything you could
do with an enum within C++
and this is actually the only thing you
can do it with enum suppose first I know
C professor has an enum class which is
something different but this is the enum
the basically num the primitive enum so
to speak and this is all the stuff you
can do we can just define values out of
order you know and he can repeat values
so I think II 1 or is 1 and B is also 1
so who cares and this this is the only
thing he knows can do is expose and some
other languages and this is the only
thing you can't do with enums and Java
and I find it very curious what you can
do so I try to write the worst in them I
could think of you can do amazing stuff
with enums you can you know extend them
you can what more can you can create
abstract functions you know you can
create public function normal functions
you also can create static functions I
didn't I don't have any static functions
you can serialize them whatever you know
you can do amazing stuff with enums in
Java but a very simple basic idea of
giving enormous value you know you can't
do that in Java which is very strange
and because you can do that in Java you
can't you get this kind of stuff you
always have to go ordinal if you want to
know the order of or the ordinal
actually so the order of the enum within
the I don't know the collection the enum
sequence or such and that kind of stuff
and this is strange this is I'm not
gonna write about this anymore but it's
just weird another thing is how
inheritance works in Java because Java
has what's called the type of ratio or
something one of those ratio things you
can't so another common pattern in in
games at least is you have a lot of
single
inheritance you know and you know so you
have sorry so we have you know like like
a grandchild object and it wants to call
the super function of its grandfather
but skipping the super function of its
father so you want to go the super super
function basically Java terms that's not
possible in Java you know in in that
specific way you know and that's very
annoying so you have to you know work
around it so if I suppose you can just
call it like the one on the right and
Java you have to be creative and you
know over expose the function in the
father or something so yeah it's weird
yeah so pointers of course I usually
start with pointers but I thought no
it's so different this time and cool
picture it's kind of real
so yeah Java does have pointers of
course at the beginning of Java people
were proud that they didn't have
pointers you know because all she was
developers in news for first developers
they always you know the pointers
up you know when they had to create
pointers they just you know they either
allocate the pointer never freed the
pointer or was just annoying stuff and
Java doesn't have that of course so it's
annoying but the offer does a lot of
stuff for you in return but you lose a
lot of benefits as well you know so I
have a slide near the end because you
don't have pointers some debugging
becomes very difficult so yeah so this
is a common pattern in Java and C++ for
example the equivalent of this in other
programming languages would be if you
want to have multiple return types you
know so I can Python or go or whatever
so Java doesn't have multiple and return
there types and doesn't allow pointers
so how do you deal with you know one
method that gives you more than one
thing back you know so yeah my simple
solution is the one you know girl of
course it's just creating a lot of one
element arrays you know and just give
the array and just get it back and
within that and such and yeah it's not
very nice but it's better than creating
a whole wrapper object and such
I like this approach so yeah another
cool thing with point is this you can do
you can basically just cast stuff to
other stuff you know so here for example
you have a three by three matrix and you
say I want a flat point a flat pointer
from that matrix and the people supposed
to just say okay just give me
castus address to a float pointer and
you know it's nine position three by
three and just get that bad and Java
have to be creative and do this kind of
stuff you know why this is important
OpenGL once again oh yeah I'm gonna skip
that one oh yeah so this is the only
point we have in Java it was just very
annoying I think so you know it's like
you know getting now the benefits are
only getting there you know the price
you know you pay so nope no pointer
exception so this is very annoying and
it should be called no reference
exception actually not null pointer
exception but that's also a different
sort so yeah so that's basically all the
cool stuff we don't have wish this hand
so yeah but yeah see I suppose is not
the best language in the world of course
they had a lot of stuff and other stuff
I came across so just she has you know
and yeah so let's anybody know the
answer to this one okay nobody so
suppose for us and a lot of languages
have macros and at the beginning of jar
of Java or at the beginning of the 2000s
at least I can remember a couple of guys
or a couple of people wanted to
introduce macros and Java and I'm really
grateful they never succeeded because
macros are very strange there's
somewhere in between everything you know
so macros so what is a macro what does a
micro do so here this I define square X
so that's the definition of the macro
you say I'm defining when I call square
with anything as ax I'm gonna return x
times X that's basically what a macro is
a search and replace this is nothing
this is not code this gets searched in
replace before you compile but it's it's
readable for people and it's it's easy
sometimes and you can do anything with
this can
constants can define functions can
define parts of a function can do
magical with it so this is simple
example of why you shouldn't use point
macros yeah so this is one I think I got
this from Stack Overflow so when you see
this square X plus plus what do you
think will be the results if X is 5 for
example and most people get it wrong I
got it wrong but this is actually what
happens because it's searched every
place before you compile you know so get
a very strange for with 5 you get 30 I
think or such which is an impossible
solution if you pass it a number you
know or you would think so
so that's this example what not to use
pointers this is another example this
one is from so and the title the slide
is death by microbes this from an
article called Teflon macros this piece
of code from I remember but basically
when when somebody would do crazy stuff
with the worth pointer with the macro
sorry they would give them this piece of
code and tell them hey explain what is
what this does and the highlighted parts
and I guess I missed some of them but
what the hilar parts are all the macros
and such and this is very difficult to
understand code so yeah so why are
pointers yeah so pointers are nothing so
another duck and whatever so so yeah so
this for example so this is four or five
pointers for four or five macros sorry
and this one also something like this
which isn't very interesting but I want
to show this one because this is the
same one these are the exact same macros
but as you can see you know float the
destination type the above this is a
float pointer and destination type below
you know is a byte point you know and
macros don't care you know they just are
type agnostic you know so to translate
this kind of stuff to Java takes a lot
of work you know you have to do it for
everything and and such an annoying sure
and yeah so C++ joke
so C++ you know same way we we worship
camelcase and Java the people first
people they worship and believe in
something called Hungarian notation and
now in Goering notation the idea behind
it is to be a descriptive notation I
find it's not descriptive at all but
this is a simple example you know so
this the one in orange that is that's
that sound guy notation and you know the
M underscore and they really do this you
know so that signifies it's a member of
a class you know and then the B it's a
point or no and then asses z
you know that's it's a 0 terminated it's
no terminate it's you know it's a string
nil terminated string and then you get
the name you know and people go
overboard with this kind of stuff so
this is example of the one on the right
below there that's an example of a very
 up one but you know people do
this and you know we don't have that in
much in India we don't have it at all in
Java I think maybe in the early days and
I'm grateful for that
I could never get used to enjoy
innovation myself maybe people other
people that could okay so yeah oh yeah
so
so yeah Hungarian addition is evil but
like I said camelcase is also kind of
evil you know especially in spring for
example those guys are notorious but
this one this is an actual class name in
Java mature if it wasn't removed or not
and yet this guy who wrote a cool post
about it so I thought I'd share it with
you guys so but yeah so I'm gonna so
camelcase can also go overboard yeah
should I explain unions you know so
Union is something very strange in C++
and I thought I understood them but
recently I spoke to some suppose
developers and that I knew I didn't
understand them so so Union I thought at
least they were like class you know so
you can define multiple members of Union
so basically class for multiple members
but all the members of overlap in memory
and you basically just used the largest
amount the largest remember so in this
case you know the interest largest
member 32 bits
this union is 32 bits and if you call
DCB or a witch from the struct you know
they will overlap with the NT now a
simple example to do it with an IP
address so that was what most people say
unions are useful for but actually you
know and this the sucker pharmacy
developer that's been doing it's in the
seventies and he said now unions were
actually used for polymorph resume now
and inheritance because in see the older
language he didn't have I have any of
this stuff so you had to be creative and
it is it this way so so that's not so
why do I hate unions that's a good
question
this is a cool picture I made and some
of you might recognize it but okay so
union with the new Union so this was a
union in the game a very extensive Union
as you can see and you know it has you
know when you see the a spaces
pointer and a stochastic is pointed to a
pointer and such or two-dimensional
pointer and yeah if you will if you and
the worst part can I do this yeah what's
this one
so this basically within the Union you
have a type of your own Union you know
and this really this really me up
this I think took like two three weeks
to it's just no two three months I think
to get this right you know so every time
I would write it and that I would run it
and it would break somewhere and our
debug debug debug okay
that's a rewrite it and such this was
hell to do and this is one of those
sports it's working I'm not ever going
to touch it again
never ever and also you know so while I
was rewriting this in Java I know and I
was so I usually I run you know IntelliJ
and I roll visual studio next to it you
know and debug both and such and I'm not
sure why this is so you know so a lot of
this stuff it doesn't actually get used
even in the game so I'm not sure why
they it sits in there maybe just you
know to to make fun of people who look
at the cover I'm not sure but it's so
this is why I mean that's why you should
hate unions so so yeah so this is
something in between I think it's not
really that I miss it but it could be
helpful I know and that's somebody the
presentation
somebody really hated this but the
destructor obviously so Java doesn't
have destructors and the destructor in
in any sane language is the opposite of
construct you know so any older
languages you have to manage to resource
yourself so if you you know when you
initialize an object you say you know
new this new that and whatever but you
know at some point somebody has to clean
all this stuff up and all the languages
see that as yourself and Java Java does
all this stuff for you just go yeah
until you know you you notice that
people you know so so this is from the
doom engine of course do this is one
single destructor you know they do all
this stuff you know you shut down
threads you stop sound or whatever and
such because this is compiled you know
the compiler does this for you know so
you basically you misuse the compiler
for your own benefit
instead of calling a method close or
shut down or whatever you do all this
kind of stuff in a destructor you know I
know you only have to destruct the
object which you're already gonna do so
it's it's like so it's cool you know it
can be helpful you know so yeah Java
doesn't have this we had finalized which
is deprecated for good reason so don't
use fine lines but we also have also
closed bow which is a cool cool idea you
know but you know you always have to do
it with a try-catch try with the
resources and such so that's kind of
annoying but it's the same idea you know
so the reason they introduce all the
closeable in Java was this actually you
know if you I don't know you create a
new file input stream or whatever you
don't want to do it you know in the
final and whatever and always close it
and such as annoying who wants to do all
that so we have to introduce it and
the circus can be helpful I think
default arguments is a very simple one
so yeah you can do this kind of stuff
the line on top you can do that in C++
and other languages as well just say you
know if I don't give Y then the Y is
this value if I don't give an x and y
then this is like that and the code bug
below that's that's kind of like the
simplest way I could do it in
in Java maybe it can be simple I'm not
sure of us so that's annoying or could
be helpful
yeah this one also gave me a lot of
trouble last time I spoke about it so
let's begin with the why actually so the
reason we can do this kind of stuff in
Java is because string is immutable and
the idea that string is immutable it's
cool and it's uncool you know because
string is the only thing that's
immutable in Java from from the
primitive type not from the primitive
man all the parameter observer invisible
from from the objects you have in Java
in our string is basically the only
immutable one and it's very annoying and
because string is immutable you can't do
this simple kind of stuff like what we
do here you know when in the part at the
bottom you know so this is C++ code and
just say okay I want to make this hello
world I just inserted at that location
and Java you have to do that's thing
ugly thing at the top and I'm very
certain a lot of us I still do it
actually you can be creative and do it
with a string buffer or a string builder
or whatever but you know under the hood
they also do this you know so it's not
very year pretty so I'm not gonna write
about that anymore
yeah so this one I really miss in in
Java inlining is basically so Java does
inlining but it does it for you out of
the JVM does it for you can't force it
and inlining is basically you know when
you call a method you know that that
function call it wastes CPU cycles and
time or whatever and by saying I want to
Enlai this method you basically copy
paste that block of code and put it
within the places it's called from Java
doesn't Java has this but you can't
control it you know it has a lot of
parameters I don't know the method has
to be a certain size it has to be called
I don't know 10,000 times or more and
then the hotspot in lines it for I think
growl has more options for this kind of
stuff but Java out of the box doesn't
and and for games is very important at
least I think it's very important
because the doom guys did it and they
created great game so I assume it's
important
yeah I'm not gonna talk about this
anymore either
so yeah so yeah it's a weird list
anybody know the answer to this one very
shy people okay so one is true and what
is false and you can test it out but
okay so this is one I talked about
before it because because we don't have
pointers in Java you miss on a lot of
easy debugging techniques so C++ if if
you have like I don't know you know
something
max for it is an X of an object for
example and you want to know when this
has changed and super suppose you can
just watch that memory address because
it's support you can point a pointer to
that memory address in layman's terms
and just watch it and the moment it's
accessed or changed or whatever the
breakpoint goes off in Java we don't
have that we have something similar it's
called I don't know a field modification
break boards or something
so this screenshot from IntelliJ it's
very slow that's that's this really why
it's not very helpful it's very very
slow so when I use this with the game I
never get to the right point you know
the game becomes so slow so it goes from
I don't know 60 frames per second to
half a frame per second and it never
gets to the breakpoint but when I used
with other applications so you know with
with just a piece of code 400 lines or
something it does get there so it can be
helpful I guess and I've only seen this
in IntelliJ and I asked the IntelliJ
guys before so people why is this so
slow and such and they told me that it's
not really our fault you know so this is
not an an feature that it's Ellijay
built this this actually exists in the
ti the tools interface of Java that's
where all the debugging stuff and then
instrumentation stuff comes from and
it's just slow you know and nobody
touches the stuff anymore because I
don't know why actually but so just know
and we can't do anything about it yeah
it's there you can use it it's cool
it's not the same as this setting it up
is also very difficult or much more
difficult than this so so yeah this is
another one yeah so so this is the
primitive the winding primitive
conversion you can put a float with a
double and you can put an end with them
double or winter within the float or
long within the double and such and the
compiler would just allowed to be fair
other programming languages do this as
well but it's it's very error-prone if
you look across these things some of
them are the same when you cast them
back but some aren't you know so the
float sound for example if when you cast
it to a double it gives a different
result from the double sum which is
basically the addition of the two floats
and I've had a lot of bugs around this
kind of stuff and it's very very very
difficult to find as long as no release
in the real solution for this and just
you know renting to you fine folk so any
morning so so yeah this is annoying this
is a cool feature in Java actually and
surprisingly not a lot of people know
about this so just last week somebody
was asking me would it be cool if you
all have this on its own and I told them
yeah it already has this actually but
you know he was using Eclipse and was
difficult finding Eclipse so this is a
in Java you know when you set a
breakpoints you got a call stack which
is the yellow part on left and you can
just basically say okay I want to at
this breakpoint I want to drop the frame
and go back to the previous point and
this is very helpful sometimes and very
helpful you know so when you set a
breakpoint but you said it for example a
couple of lines too late and you want to
say okay now I want to go through those
lines so you stop the frame and then
just you know step in step by step till
you do what you want the biggest problem
with this is it's not sure if there's so
any problem but the biggest problem at
least is that it's it doesn't it only
drops the frame actually no if you
changed anything outside of the context
of that frame it doesn't really care
about that
so if you call a function on an object
for example and it changed one of the
members of the object and you drop the
frame that member won't be turned back
you know so if you did if your ex-boss
plus it's already incremented you know
but everything you do within the
function within the scope of the
function that will be turned by so be
careful
cheaper suppose it has another one which
is much better so this is from gdb and
it's basically you know we can reverse
that so as you step into something or
step over something you can step back
you know and that one really turns
everything back it's it has some
limitations you know but it's it's kind
of better than Java I'm not sure if it's
better but it's something different and
yeah who knows maybe who gets this in
Java someday yeah thank you yeah so this
is the floating point operations when I
talked about so the operator person is
one our talks about when when you
overload operators so so you already
have operator precedence for everything
that already has operators all right
everything because string also has
operators but it doesn't have a presence
but and sometimes it matters actually
what what you what the order is you do
things in so this is an example with
specific values of course not not any
value will do this but mathematically
speaking these two statements should be
the same you know a multiplication and
division you know doesn't really matter
what order you do things in kind of yeah
so these two will return different
results and this one yeah this one as
well this is what multiplication
addition which is even worse you know so
mathematically speaking both these
statements are the same this is an
actual bug ahead in the game and I think
blah too from the one on the right at
least I think blood two is zero
while blah one is an actual value or
vice versa I don't remember
and yeah this is a very tricky stuffy
and this is I'm not gonna say I'm
debuggable um because I found the box
but it's very difficult to debugging
because you're not really doing anything
wrong except being stupid you know so so
that's here's a better example with
actual values yeah with actual printouts
of the values and such so who would
actually imagine that these two would
would you know give different results
and yet they would they still have
different results and the reason for
this I didn't explain the reason but the
reason for this is because floating
points I have limited precision you only
have thirty two-bit precision and at
certain point when you do something you
have you have to round it up or the JVM
does it for you
and this also haven't C++ in most
languages it's just some I Triple E
thing it's just how the standard works
so if you do an operation you round it
up and then you do another operation on
the rounded up version value you get
these kind of errors granted you know a
point or one isn't much but it's still
not the difference same value and this
is another one also with the addition
save backup you know um again for our
day jobs not very important I hope it's
you know when you're doing game you're
only working with floats and frolic
points and sometimes so this one and the
one on the right there's an actual bug I
had you know I thought I would be
creative you know and rewrite it
mathematically and instead of a minus B
plus C now would do it like this because
you know when you're doing six hundred
thousand lines of code you get bored and
try to amuse yourself and do this kind
of stuff a months later you find a bug
you know where you're I don't know
instead of going right you're going left
and dying and stuff so it's important
stuff how much time do I have
so yeah conditional breakpoints are also
pretty cool in Java all programming
languages most program languages have
except in Java I didn't know this myself
I only discovered when I was doing the
game they're very very very slow you
know usually you know because you don't
go through breakpoints go over
breakpoints a lot you know in your
application just so conditional
breakpoint
when you set a breakpoint and you set
the condition within the breakpoint
itself you know and this this is the
other one so this is a normal breakpoint
at least the example is you know an in
Java now so this is another marker
benchmark I did a comparison with a
simple loop so the first experiment is
instead of I is even Izod actually eyes
even I put that in the conditional
breakpoints and this is the other
example I did a normal break point and
put a condition if statement and turns
out it's about if you can believe this
you know it's about 180 times slower you
know so that's I know this is probably a
little bit extra exaggerated but you
know I was too lazy to redo the slide
but it's it's much slower you know so I
notice this a lot in the game when I
debug stuff I always use an if statement
and just compile the code it's much
easier and it's much faster I know and
the reason it's it's much faster is when
you could do conditional breakpoint your
your debugger goes into interpretive
mode which is very slow you know so
beware when you do this kind of stuff
it's very slow I hope I have enough time
for this one yeah so let's just skip
this one so so I'm gonna show you the
progress of the game in the meantime you
can ask questions because it takes some
time to start up so any questions oh
sorry yes
I'm running the game halftime I changed
something you know it just wouldn't be
very helpful there are some unit tests
but they're basically some basic math
stuff and it's not very very helpful for
this kind of stuff yeah maybe they could
be I'm not sure so so so yeah and in
general people in the games industry
don't really do you and us this game did
have some unit tests for some example
not sure why but they were only for the
math library and the math library is I
think maybe two percent of the whole
code so yeah so that passes but how we
use it doesn't pass or how I use it
doesn't pass so yeah so we don't have
sound I'm not sure why but so yeah I
show everything in a wireframe because
I'm missing a lot of textures and
blending so stuff will still be to go a
dark so yeah this switch should say you
don't three but like I said I have
problems with branding any other
questions I can see you can raise your
hand please yes
mostly is just transforming the code
some refactoring but most of it I think
60% just translating code and 40%
refactoring and 100% debugging so so any
other questions we have like two minutes
this is much better with sound yeah MUC
yet I don't expect it to be much of a
problem
to be honest I mean it's it's it's just
a ten-year-old game as you know so it's
not as if I'm doing June 2016 or since
so I'm not really seeing much a problem
right now but I'm also not you know
doing a lot so I'm gonna show right now
the game it's not very very playable yet
you know but the memory footprint is
much larger of course so right now the
average memory footprint is like 1.5
gigs and I think when this came out it
was like recommended memory settings 256
so but it's not optimized at I'm I'm
just you know doing the basic stuff I'm
trying to keep it as is to make it
easier to debug it because I compare it
a lot to C++ code and I'm if I'm too
creative and I lose that so yeah I had a
brother
so as you can see the heads or floating
somewhere else this is one of the things
I broke but I'm not kind of fixed right
now because I'm trying to fix something
else sorry that's I mean it's a horror
game this is much more scarier
so yeah the face should have angry look
right now but because it's not a glad
that he gets to go to Mars any other
questions we have one minute I'm going
to show some yes sir
yeah I tried that it was not a good idea
it was really not a great idea yeah
the scale of the game if you're gonna do
that it's just too large and when you do
it you have to you're basically
rewriting the engine if you're going to
do that because this this is one of the
first games I think for the company at
least what I actually were using floats
back at night is most people used for
for for you know geometry so just use in
sanding around stuff up and I thought it
was much easier
so this one is felt based on yeah doing
those it's hell sorry so so you know
it's much better with sound even if it
is broken yeah I can do this yeah yeah
this is you know it's kind of scary yeah
I don't really remember where I should
go I think it's like this can somebody
tell me if I'm out of time people in the
red shirts in the back okay I'm just
going to play if I can't remember what I
should do yeah scanner is ready yeah
this thing should move up and down it's
not moving right now but who cares right
am I out of that I'm out of time so I'm
gonna kill myself which I'm very proud
the works yeah
and he makes it all sound but you can't
hear it so sorry thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>