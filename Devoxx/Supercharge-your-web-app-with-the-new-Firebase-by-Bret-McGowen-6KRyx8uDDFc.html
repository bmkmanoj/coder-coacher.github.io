<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Supercharge your web app with the new Firebase by Bret McGowen | Coder Coacher - Coaching Coders</title><meta content="Supercharge your web app with the new Firebase by Bret McGowen - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Supercharge your web app with the new Firebase by Bret McGowen</b></h2><h5 class="post__date">2016-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6KRyx8uDDFc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone welcome thank you for
coming out my name is Brett McGowan I am
a developer advocate at Google for the
Google cloud platform you can reach me
here on twitter at at brett MCG and i
work in the Google New York City office
but I have to say even though I live in
New York City I'm from Texas much better
all right howdy welcome how do you know
if someone's from Texas day will tell
you don't worry so hello alright so
today we're going to talk about firebase
and some of the new things that have
come out in the last few months so
firebase is a cross platform SDK over
iOS Android and the web that help you
grow your application grow your user
base and earn money is anyone using
firebase or has played with it okay
quite a few so so there's a few things
that started out as sort of the core
features of firebase and then some
things have been added so we'll get into
that so like I said there's kind of
three categories of what firebase can do
one is to help you develop your
application so there's a few things here
one is the real-time database and this
was very basic sort of first killer
feature so this is a database and no
sequel JSON database that allows you to
do real time synchronization really
really easily without having to manage
any server side code or new servers at
all the the second thing is fire based
authentication so this lets you easily
authenticate your your users either with
things like github Twitter Google
Facebook your own custom authentication
system that maybe you have username and
password anonymous the whole wide range
if I base it makes it really really easy
we'll take a look at that as well
firebase hosting firebase storage for
storing binary data for your application
Cloud messaging for sending
notifications to your web application or
notifications
notifications to your native apps and
then some of the other things so those
are the main ones for web which we'll
talk about today there's a few others
for native mobile apps so there's
there's the test lab which is a service
that lets you test your Android
application on hundreds of virtual and
physical Android devices crash reporting
which lets you monitor and resolve
application not responding errors and
things like that the second thing the
firebase helps you with is to grow your
user base so once you have your
application built how do you grow your
guru base and these are mostly
mobile-focused so I'm just going to
mention them and then we'll move on
dynamic links so this lets you actually
deep link into your android app any all
the way through application install so
you could actually have someone start
and in an interim or in a middle screen
of your application rather than just
being dumped on the first page and this
goes hand in hand with the next thing
which is invites and so invites would be
something where I could invite my friend
to join me in a game and if they don't
have that app installed they can install
it and it will persist that dynamic link
through that so that the first screen
that they see after install is the game
where they're playing me so that's
pretty cool I'm firebase makes that easy
AdWords which is to promote via AdWords
to have users see see ads to come and
install your application or to download
it notifications which is just native
notifications in your application and
then app indexing which is search
results that lead to your to your native
app and then earn AdMob is an SDK that
and a service that lets you generate
money and revenue in your application by
showing display ads and native ads
banner ads the whole kinds of a whole
slew of different options for earning
money with your with your application
and at the cern of all this is firebase
analytics so it's collecting data on all
these different features so you can
monitor you can do reporting on it you
can improve your application experience
so that is kind of a whole suite of
firebase things they are integrated they
work really well together but you don't
have to use all of them you can kind of
can choose what works for you for your
application via web mobile or iOS you
can use just one or you can use all of
them and they can work well together but
that's a whole lot so today we're going
to focus on these four so firebase
database the real-time database bar base
off storage and Cloud messaging and
these are the ones that are most
relevant for a web web application and a
web audience so the first one firebase
database if you've used firebase before
which quite a lot of you have you're
familiar with this right so this is the
ability to synchronize changes across
multiple clients within milliseconds
they can get updates so you just write
to the JSON database and all of your
subscribing web apps or Android apps or
iOS apps will get updated yeah so it is
no sequel it's hosted so you don't
manage any infrastructure at all it's
everything that you write is in your app
be it web or mobile it handles
synchronization and conflict resolution
for you and again you write all that
code in your native app and I'm going to
do a live coding session here in a
second just to kind of set up what this
does for you and one of the things it
does that's pretty cool is offline
support so if you're in a native app it
actually persists across like
application restarts in a web in a web
context if you lose connectivity in your
web app firebase will actually keep
running and then once your app comes
back online or once your device gets
restores connectivity to the Internet it
will ring synchronize the changes that
you've written now you've created in the
interim so it's really nice Andals that
for you and so yeah so once you come
back online it'll sink those changes
bidirectionally things that have updated
and things that you've updated up into
the cloud so let's get started showing
the real-time database whoops all right
so I've got an HTML page here has no
javascript in it just to point out a
couple of things so it's got a header
and then a div we're going to put some
messages and it's including the firebase
SDK so this is what it looks like so
there is a utility fire based
tools nvm module that gives you some
chem mainline functionality so i can say
firebase serve Dash P give it a port so
let's say five thousand three and if so
it starts a local web server so now
let's go to this URL and I can show you
my beautiful gorgeous app that has been
created and it's so functional and does
so many things all right so it doesn't
do anything so let's make it do
something I'm going to put it here and
then firebase database here so this is
what I would like to do I wanted to
synchronize in real time with firebase
with the firebase database so so here's
my database over here there's nothing in
it just know so I'm going to create a
child node called title and I wanted to
say howdy devoxx so what I want is this
title of the page to synchronize with
that value so let's do that so I have a
file here apt j s which right now has
nothing so first we need to connect to
firebase and we can do that pretty
easily if i go to my database and i can
just click Add firebase to your web app
and it's actually going to pre-populate
this configuration with my actual
product and project settings so i'm
going to copy all of copy all of this be
sure you write down my APA I key so you
can hijack my application later all
right and I'll paste it here so that
gets us connected to firebase so now
let's move that lose I lose my screen
all right we're back so now I want to
listen to firebase database so to do
that I will say cause Saudi beer F
equals firebase dot data base dot ref so
this is going to point to the root of my
database so to go back to the database
if you think of it like a tree so this
is the route this brett google node and
title is the child node and that's
actually what i want to listen to so i
will say cons title ref
oops r f equals DB ref child title now
Firebrace gives you a bunch of listeners
you can events you can listen to for
when things change and one of them is
value so i will say title ref dot on
value and then snapshot so what value
does is anytime that value changes from
anyone this will get called so first
thing i want to do is update that page
title let me find it here so we're just
on our base demo okay so page title so
this is what i want to update so i'm
going to copy the ID page title and i'm
going to say that element dot inner text
equals snapshot dot Val so snapshot has
some sort of metadata about that record
like a key things like that val is the
actual value so in this case this
howdy-do box so let me refresh my page
here and yes there what am i missing
live debugging all right I included this
right and total total roof comes all
right here we go console dot log my old
friend hello let's do it nothing oh here
we go how do you dead box yeah maybe I
didn't refresh hard enough so will
notice if I say howdy dead box and I'm
just so this is the firebase database on
the left I will add a smiley face here
as soon as i hit enter almost
immediately it shows up in my
application and that's cool because it's
doing it locally on my machine but
actually anyone who was on this page if
i deployed it out on the web would
instantly get that update which is doing
a lot behind the scenes right and you
notice i wrote one hundred percent of
the code required to do this so let's
add just a little bit more i'm going to
add a chat functionality you've ever
seen a firebase demo before your
required by law to do a chat demo so let
me uncomment this so I have these
elements here I've got a
text input for the name of the person
and a text input for the message and a
sin button so just to show you what that
looks like so this is the name and this
is the message and I'll hit Send so it
doesn't do anything right now so let's
wire it up I will take input name
alright so we talked about value as a as
an event that firebase gives you there's
also something called child added so
actually let me back up let's write it
to the database first so we're going to
take the send button and on send button
to add event listener and on click we're
going to give it a function so whenever
you click that button let's say let
message equal so name and that's where
we'll say what i call it input name and
message input message so these are just
the value dot value so it's getting the
values that are in those text boxes and
it's creating a JSON object called a
message so i could do console.log msg
well let me get rid of my beautiful
hello all right so when I click this
button I'm going to create a JSON object
called message now how do i write it to
database is super easy i'm going to make
another reference here const char f
equals d b RF child chat so this is
anything that is this is all going to go
into the chat node on to the root node
so chat ref dot push message and pushes
a firebase method that automatically
adds to a list so let's see what that
looks like a refresh just make sure it
refreshes so Brett make it a little bit
bigger so i'm going to say hi there hit
send and you'll see under chat and
created this thing with like a wacky ID
I expand it and that is the message that
i had and this is an ID
firebase generates automatically just to
make sure all your messages are in
chronological order without being
without having to worry about complex
like 123 so if two people send at the
same time so that's how we get it in so
how do we read it out so we're going to
do something similar to value but on
chat ref dot on and this time the event
is child added so that is the event
snapshot so child added is going to fire
any time a new one of these comes in
you'll get a reference to that new
element so we're going to get a
reference to the messages div here
that's we're going out put it so doc you
mad don't get I'm going by ID messages
so that message element equal that and
then we'll say oops and then let so this
is our new element equals document
create element let's create a div and
then element dot enter or dot inner text
equals snapshot valam dash snapshot val
dot message alright so hopefully if we
come back here and refresh all right
killing it right now why am I not
oh yeah it would help if I actually
added it yeah there we go message Ellen
and prepend Ellen thank you crowdsourced
debugging appreciate it there we go so
hi there so now I do it again nope
number Burt Brett howdy so I hit Send
and you can see adds it to the list and
also adds it over here in my firebase
database alright so that's cool that is
real-time database it shows you how I
actually I guess I can show you in two
windows in case you don't believe me so
I'll pull up a second one and this will
be right to I'm in another window hit
send and you can see it shows up there
so pretty easy that's all the code we
had to write to get a real-time chat
application going so the next thing
we'll look at is well okay so i should
also mention so i wrote a lot of that UI
code manually there are plugins for
Amber Jas react polymer that will do a
lot of that what we call three-way
binding for you like binding to the
database to the UI and then have it
capture the user input so it makes it
really really easy if you use any of
these frameworks and your web app
firebase supports these really really
nicely so the next thing we look at is
firebase storage so this is one of the
new things that we announced at Google
i/o this year 2016 this is taking your
users binary files and putting it in our
cloud and this is backed by Google cloud
platform cloud storage which means it
can scale up to petabytes it is
distributed it is extremely powerful and
it also has security rules it everything
happens over SSL and with those security
rules you can you can write rules that
only certain users can access certain
files and so on and so forth so security
is very important i'm not going to get
into security rules in this talk but
just know this this kind of expressive
language that you can control access so
let us add storage so it was kind of
painful to watch me live code through
two bugs so let's go to some precooked
code that i have here i'm going to say
so file upload so i want the ability for
users to upload files in a chat
so here is what I have so let me
uncomment some things and then talk
through it so first we are going to get
the HTML element clue file upload so
that is just where is it my own
commented so clue file upload is just a
file input and then next would have an
image called clue image so the reason I
call it clue is originally I envisions
this is a game where you could upload a
image or a famous landmark and people
could guess in the chat what it what is
this a landmark of right so you upload
some kind of Cathedral image first
person to guess what it is wins points
so they didn't get into all that game
logic is too much for this demo but you
can imagine that's where where you might
go with this application so first thing
you'll do is get a reference at HTML
element add an event listener to change
so this is going to actually click file
upload and then they select a file so
then you get a reference to the file
itself so eat a target of files which is
just the HTML way of doing that and then
here is the firebase part so instead of
firebase dot database we do firebase
that storage but also like database you
can ref and this can be anything you
want so I just arbitrarily picked images
/ and then file dot name is what the
browser reported as the file i uploaded
and then i get a reference here much
like I do in chat so let me uncomment
that so then there's this put method so
store draft output you give it the file
and then it returns a promise when that
finishes you get a snapshot and so the
snapshot means your file is successfully
uploaded one thing i should mention
about firebase storage today that I
forgot it also supports you know talking
about offline support with chat like if
you go offline and you come back online
it'll resync your changes with fire with
file uploads it has the ability to do
the same thing with file upload so if
you go offline or you lose connectivity
or something happens when you reconnect
it can resume uploading your file which
is really great if you need to upload
files of any sort of significant size
makes it really really easy for you so
once we get returned our snapshot we can
call storage ref get download URL so
that's if we want to make
publicly available so in this case we're
going to put it in an image source tag
so this returns exactly what we want so
once that finishes we get a URL here and
I'm going to update elsewhere in the
database now instead of the so this is
the root node now I'm going to have it
another node called clue and I'm going
to set that to the image URL so now once
we do that we need to listen for when
that this URL gets updated so the person
uploading it is going to trigger this
event everyone will then hear about this
image that got uploaded through this
event because we're going to set that
URL in the database and just firebase
will automatically sync those changes
for us so this is going back to firebase
database under the root node we have a
clue node whenever that value changes
we're going to get the clue image which
is the image tag in HTML and set the
source to snapshot dot Val so let's take
a look at that all right so I've got
this choose file you can see the broken
image there I was too lazy to actually
hide it and show it but that's where my
uploaded image will show up here in a
second so if I click Choose file and
let's pick wait I want to do this one
Basin know whoops let's try that again
there was just impatient so what it did
over here on the left is it updated this
clue URL with clue property with the URL
of that image which is set in our image
tag so that's all it is I can browse to
storage and I'll see under her images
and those are the two images that i just
uploaded and again this is backed by
google cloud platform storage so i could
actually go into my google cloud project
well you believe me we're running short
on time but I could actually browse in
my google cloud project and see those
same files and if you do something like
Claude functions you can actually have
another function that runs in the
background automatically when a when a
file gets uploaded so the next thing
we're gonna look at is far based cloud
messaging
so this is a free this is a no-cost way
of doing notifications and you can on
top of this you can do firebase
notifications which goes to native apps
and that's actual like native you know
drop down from the top kind of
notification but it also works on web
using cloud messaging to get offline
messages so if the user is in your app
you know there's a lot of ways you can
communicate with the app while that's
happening but if they close your page or
they minimize it they go to another
window your options become a lot become
a lot more restricted so Klaus messaging
will actually let you send those events
to a service worker that's running in
the background to take those messages
and do something with it and and let's
take a look at that so again I have kind
of have a pre-baked file here we're
going to call it messaging and let's
open that up messaging alright so again
similar to firebase dot database or fire
based storage we have fire based
messaging and it does a couple of things
here so the first thing it's going to do
is request permission to send
notifications to the page and you've
probably seen this right if you're using
chrome your browser and it's like such
and such web page would like access to
your location or sisters web page would
like to send you notifications and you
can either accept or decline so all you
have to do is call messaging request
permission if they agree then the then
we'll fire and we know we have
permission if they decline then it will
throw an error and you can see that here
in the catch and you can explain to the
user like you know your functionality
will be limited or maybe just just don't
do anything so it also remembers like
the browser remembers if you gave it
permission so if you come back to the
same page they won't get prompted again
but this will fire so what we're going
to do here is we're going to return
messaging deck get token and then which
goes to this next step in the chain and
we're just going to log it to the
console so normally way the way that
this would work is instead of log into
the console your app would actually
report it your web app would report it
to your server like if you've got some
kind of messaging server or something so
that when you need to message all the
users of your application you they've
all reported their tokens to you so you
can basically say send a message to this
set of tokens send a notification to
this set of tokens and it'll do that we
I I don't have like a back-end setup
it's too much to get into so we're just
going to we're going to do it super
manually so I'm just going to write the
token to the console and they'll copy it
and then do a curl request which I'll
show you in a second to actually tell
firebase Cloud messaging to send that so
we've got another thing here that I want
to point out so by default it would
actually show the notification while
you're in your while they are on your
web page which is kind of annoying right
if they're using your app you don't want
like these floating windows popping up
you only want it to happen when they're
out of your app so right here we can say
ok when this comes in and they are in
the app fire this which in this case I'm
we're just going to log it to the
console but you probably would want to
show them something in the UI in your
app but you would want to do it within
the context of your web app but now what
happens if a message comes in when your
when your page is closed so for that we
need a service worker so I have
pre-canned this service worker so this
runs independently so we have to
actually reconnect a firebase and it's
just using the same settings we were
using initially i'm going to import
firebase app and firebase messaging and
then give this reference to firebase
messaging down here is if you want to
write a custom alert we're going to skip
that for now so let's go back here and
refresh and so you see right away it
says localhost 5003 once to show
notifications so i'll say allow and down
here if you can read it it says have
permission and then how's the token so
let me copy this token no to fake whoa
please hold what did I call this thing
now it's in a different record a
one-minute got to go up a level
alright so just expand so you can see
what I'm looking at so this is a curl
request with JSON body to tell the
firebase so this key is going to
identify my application this is the JSON
that you want to send and it's it can be
anything essentially if you use title
body icon by default chrome knows how to
interpret that and the two is going to
be that token so let me copy this and
then run it so that one that didn't work
at all all right let's try this all
right so success one so what that just
did is that scent and request to the
firebase messaging server to send out
notification to your app and oh no
firebase icon oh I think I need to it
can't find that this firebase icon
because it's called something different
it's called firebase logo of course it
is firebase icon let's change this the
firebase logo all right
and paste that all right and success and
so now so you can see up here hello
world so you didn't see in the other
screen because my terminal my editor was
full screen and os won't show it but
this hello world so let's actually close
this page so you believe me and I'll
send another one so it close this so
they are now out of your web app so if i
send this and then go back over there's
another applicator and then the
notification so that's pretty cool and
if you do in the serviceworker you can
actually inspect a json so if you need
to update some kind of internal state or
you want to like show a notification
depending on what data came in that's
where this background best handler will
come into play so i'm just using the
default which it shows the icon and the
title in the body that i had specified
so that is firebase Khalid messaging so
we're getting a short on time so I'll
just kind of talk through authentication
so this also has existed for a while in
firebase at i/o though we we announced
basically pre-canned you I so without
having to do much you can actually get
in either an inflow authentication and
login with github Twitter or Google
custom email and pad password your
custom authentication you can kind of
get it in flow or goes into the page and
then comes back or it pops up to some UI
so that's pretty cool and yeah these are
the different methods as the port github
Twitter or Facebook Google and so on
firebase hosting which I'll show you
because it just takes one command is
just firebase once you were in my
firebase deploy and this will actually
push this out on the public internet
with your static assets it automatically
creates an ssl cert and it also creates
a fully qualified domain your static
assets are backed by a global CDN so
your assets will be distributed and
highly performant so you can see I go to
Brett googled a firebase app calm and
I'm able to get access to my application
so firebase in it and firebase deploy
all right so we didn't cover security
rules it's definitely something to think
about both in a database sense where you
need to you need to have certain nodes
of your JSON tree that you can read and
some that you can't so for example a
user needs to be able to edit their own
stuff but not someone elses there's also
security rules for files for storage so
you can say only upload files of a
certain type or of a certain size and
that is pretty much it so we are out of
time and thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>