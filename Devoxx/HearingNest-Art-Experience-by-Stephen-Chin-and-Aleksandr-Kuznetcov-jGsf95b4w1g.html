<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>HearingNest Art Experience by Stephen Chin and Aleksandr Kuznetcov | Coder Coacher - Coaching Coders</title><meta content="HearingNest Art Experience by Stephen Chin and Aleksandr Kuznetcov - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>HearingNest Art Experience by Stephen Chin and Aleksandr Kuznetcov</b></h2><h5 class="post__date">2017-04-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jGsf95b4w1g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so this is this is the most fun session
here of the entire conference you guys
are privileged to be in actually the
most exciting session and we're going to
destroy it we have a suitably dangerous
piece of equipment there you can see
alice is wearing his protective
equipment for a reason yeah well
actually we notice we're cutting acrylic
plastic so we don't get any fine
particles in Saada but if we were
cutting wood for rear cutting a more
toxic substance like mdf we would
definitely want a respirator in the
built building so we've chosen a
suitably conference ace material to
Prince here but that that is if you if
you did this on work at home you seem
like you might know something about the
CNC cutter search so we vent okay do you
have proper ventilation in your shop
shop back okay very good so you have
personal safety taken care of so we we
did this experience at javaone to
hearing the star experience and
basically the the idea here is that
attendees got to do different
experiences where they would interact
with ours and create art at the
conference so we had a German artist
Maria Wellman and these are her hearing
helmets that she designed you put these
on and you can hear her yourself all her
artworks about hearing and she also
designed this beautiful sculpture out of
the items which were printed from the
CNC cutters at the event so here are
some examples hey welcome to the top
here are some examples of things which
were printed at the jawbone conference
and then constructed in this huge
geometric sculpture which recreated they
were all cut out on a series of carbide
3d routers so we had about four of these
running a java 12 of them running at
open world and then you can see here one
of the cuts in action so this is a nice
little Java Duke being cut out on the
CNC router real time the way this worked
for attendees is they could either draw
on the touchscreen which alex is setting
up or they could do it on their mobile
app using the code lounge application
which is an app written in java effects
using the gluon framework then they draw
on the screen submit a code and it gives
them back a little QR code and then the
device here would use a QR code scanner
essentially raspberry pi camera and then
print it out on the CNC cutter and the
back end was using the Oracle cloud so
we had an Oracle cloud back-end service
which is a REST API which would you
would send the drawing to the rest api
register with the service get back a
code and then you can print that off the
CNC cutter here is the CNC cutter in my
garage really early prototype you
remember this Alex the horrible you I
it's slightly better enough slightly
less horrible and we're using raspberry
PI's to actually do drive the screens
run the UI and also drive the CNC cutter
by sending verbal to the CNC cutter grb
0 for writing stuff on the Raspberry Pi
if you haven't done this before it's
really easy to run job on the Raspberry
Pi if you use netbeans there is actually
support for remote running on the
Raspberry Pi you set the host IP address
your username and password the JRE path
and then you can directly execute code
on the Raspberry Pi from your desktop
computer so it's a really quick and easy
way to run stuff on the Raspberry Pi and
test it out and a little bit about the
CNC cutter so we're using CNC cutters
from carbide 3d the nice thing about
this model is it uses all brushless DC
motors and it's relatively quiet so you
can run it indoors you could have it on
your desk next to your computer's not
going to make too much noise well that's
noise than your cnc cutter typo and it
it can cut reasonably hard materials so
you can cut plastic wood soft metals
like aluminum you wouldn't want to kind
of think more more you know rigid than
that because the CNC cutter is not
designed for super industrial purposes
but for prototyping designing doing
little three structures with CNC cutting
it's quite nice and it's much much
faster than 3d printing or other
fabrication methods so alex is going to
talk a little bit about how you
calculate the workplane offset and how
we wrote the code to get the CNC cutter
working do you want to use the mic here
the handheld mic that wasn't actually on
that was on it's not on these use this
one hello it's not on at all there you
go hello okay so welcome to the talk I
guess Stephen gave a good introduction
to this and I'll going to talk about
more technical details okay so so how
many of you actually played with with
this simply Carter I guess it's better
just one okay good so it's nice right
fun uh did you use java at all okay what
do you use Wow nice almost what we did
with this is them again you're doing
your job are gonna be friends okay okay
so good yeah so exactly I mean in this
demo we did exactly the same we were
controlling cincy cutter machine from
the javafx app using java libraries and
yeah so that raspberry pi over there
actually does that job and will show the
demo sooner soonish um so coming back to
slides calculating the workplane offset
that's a that's a technical part but
basically what it means is that
since you got our machine operates in
two coordinate systems and one is pretty
much attached to the you know the scene
c.carter itself and another is the piece
of plastic that you're trying to work on
so you need somehow synchronize those
two systems so so much in coordinates
are here on the bottom right ok just
give me this subscribe this one this is
the machine coronary so what's uh what's
nice about machine coordinates is that
those are they all they have a reference
point so inside the device if you look
over here like in the right a backward
top corner there is a set of switches so
can you turn it off and turn on so what
it does when it's turned on it tries to
find that point so it moves to the most
to the right sensor then to the top
sensor led to the back sensor and that
says the zero position in machine
coordinates then the trick is that the
piece of plastic that we're cutting is
on the other end of the of the
coordinate system is over here so how we
get to there and this particular model
has this nice thing called to length
measuring sensor something like that so
the idea if you look at that in action
it was actually going down to touch the
sensor and to measure the length of the
tool to set up the coordinate system and
then you use that data in as an offset
for the work coordinates
and as I shown in the slide here or
coordinate start I usually start
somewhere on the on the piece of plastic
you want to cut and those coordinates
are usually positive so how do we do
this if you if you buy this cincy color
from the store will come up appear with
a there will be a piece of software
provided to do that and if you only
using some key code center you know
software of your own or you develop it
yourself then the trick is how to figure
out the correct sequence to perform the
same measurement steps so what I did is
I actually sneaked into the the protocol
and just collected the commands as the
official software was running and then
just you know guess what they were doing
and here is the sequence that is
actually used so it starts with some
initialization and then position so with
the take a look yeah its position so
with them over the place on the board
whether the sensor is and then moves
down fast first that slows down and yeah
this this is your pass code oh is that
the initialization code shown doesn't
that's fine i think i deleted your
initial I glad you're joking but
basically we recreated the
initialization code to do exactly the
same startup sequence where it goes
moves probes goes down such as the
sensor comes back and it's a fan sort of
G code you can see here this is the G
code that does the equivalent logic for
going from point2 points on the cut out
steps so you know that's the spindle
speed goes to reach path segments you
know moves to the next point and then it
sends each of the commands on the left
but the right side is a you know human
readable form with that
okay so thanks Stephen for killing this
light okay let's move on so basically I
can explain the same thing again it's
just a number of commands that set the
speed at which the bead is approaching
the sensor and it slows down and it
tries to attempt to measure as precise
as possible and then once it's done
there is a set of you know XYZ
coordinates that you can use to offset
and it will always be the same offset
from the position on the plane where you
really cut their the piece so okay
that's that was on that slide so yeah
next thing is just G code so for those
who do not do not do not know much about
it it's a simple very basic format of
how the icc car could be control so
usually it's the XYZ coordinates and
some command associated with it so again
in this example g0 is rapid positioning
thing then g1 is linear interpolation
and F specifies the feed like the speed
of the movement so it always moves from
the previous point to the next one and
then what else is here here's an
interesting fact about chica so back
point was created like this move this
70s 80s really early around the same
time when computer languages are coming
out so the they actually designed g-code
to be a whole language with variables
and control structures and actually if
you look at the full g-code
specification you can do a lot with
chica in practice none of the machines
today support that because most of the
machines they have a dumb controller
which is doing the g-code controlling
and you'll use higher level programming
languages or like gooeys or even
link software to generate the g-code
Saudi code is in its modern form is
mostly just machine instructions for the
motors at a very simple level but
originally I think they had grander
aspirations for g-code people actually
manually writing g code and designing
this in maintaining g code as a language
but in practice most of the machines
don't support the full g codes back
anymore let just support a limited set
of operations for a direct point point
even like complex things like spline
curves and other stuff a lot of machines
don't support analyst doesn't support
spline curves but you can approximate it
by doing linear paths and other things
it definitely supports circular yeah
Archer but not as line I didn't try
those so yeah yeah so yeah you're right
so G code is these days it's just you
know set of coordinates and it could be
very very verbose and not human readable
at all although you can always read it
but hard to understand what's going on
so in order to communicate with a with a
CNC cover I used universal Chico tender
software and that's open source project
available somewhere in the github I
guess so it has a number of commands in
the API that you can use and I was
pretty much just you know queuing
commands like these g-code commands that
we were talking about and that's it
pretty much so well you also fix some
bugs for them okay yeah like that
threading is she is another bugs in the
code yeah I should I should yeah and I
didn't want to put attention to that but
I should say that epic code is not super
high quality so expect things to not
work out of the box sometimes yeah so
but the good part is that the project is
still in development so they developing
versions and you can participate I guess
okay so the next part of so Steven
deleted a lot of slides but basically
these are the only slides that we're
covering how we control the scenes
together I guess what I done what I've
done is I pretty much wrapped all the
commands that you can possibly want to
do with a router like move to this
position cut up to there I wrapped all
of these into API and then just produce
decode and simply using this Chico
tender thing so the next question that
comes into picture is what to cut and
the the plan that we had it was to draw
something on the screen and then somehow
make a command for the foot apply oh
sorry for the sins you got it out of it
so the the good part is that like if you
look here or we pretty much need to know
is XY coordinates a lot of a shape and
that has a really really good mapping to
java 2d shapes like java 2d shapes have
baseline to move to part and i just map
those to the commands to the machine so
the only the only question was what
exactly we want to cut so i just a sec
context on it like i drew an example
there but the way we were doing is cut
out is a we wanted a an outline that we
could give to the artist so whenever you
draw something it always traces your
finger and the that outline part is will
be give to the artist it has to have no
overlapping lines or any odd shapes in
it the center part is what we gave
people to keep as a badge of the
conference so the the white area in the
center is what folks got to take with
them and we would let like cut a hole in
it and we would let them write things on
it and they could carry that around as a
badge for participation in the project
okay so this slide shows two things that
I had to fix I mean to solve in there
when I was developing this software and
one is that if you're if you have a
curves in your path like java 2d
supports cubic curves like arcs and
other like like via curves so the there
is a fortunately there is a easy way to
solve that and you just smoke this get
Pat a greater with null and flatness
value and it will basically replace all
that curves with a move to fly into
segments so no longer need to support
parents on the device and then if you
have an SVG path or if I have an SVG pot
this this is not obvious but this
actually produces the outline of this we
keep our that's the API Java to the API
guess so yeah so whenever a person draws
something on the screen of the the touch
screen of the device whether we get
something like this number of segments
of you know line two thanks what we want
to do instead is to get you shapes one
around and one inside so the way to get
this is actually you know draw this
shape in with a wider you know stroke
and then find it its outline and then
just you know follow the outline and cut
it so the question is what's not what's
wrong here so let me let me add more
context so what 18 here 18 is the width
of the bit and we used to cut and 38
is the width of the shape we want to
produce you have an example of shape
yeah I told them I guess given in the
box yeah something like that so that
that was our goal to cut the shapes like
that when a person just draws out a hard
so yeah so what's wrong here Steve can
you do you think of like that doesn't
look like a circle what's with that
bottom right point that's karoku code
your code is broken what's what's broken
around here any guesses exactly ah ok
sir fancy expert cutter oh yeah that's
the that's the true true answer so yeah
we cannot cut the the parts that are
smaller than the drill bit so anytime a
person draws a sharp corner like that we
can all only approximate it so we won't
get those perfect shapes that people
want so how can you do that in jolla
again you draw this you draw that what's
the code for that ok so Java 2d version
of this code so you get a path path to D
you select a stroke you specify that you
want to round corners around good joints
wrong joins you create a shape you
create an area out of shape and then you
get particle Raider of that area and
that's actually your outline I actually
had you know I wasn't able to find this
from the Javadoc I had to ask an expert
in Java to d2 to actually figure out how
to do that she can collect innocent
nearby some Java to yes that was lucky
parlous Brian Brian back help
feel raised against as well yeah so
somehow somehow if you get past iterator
for the area you get the actually the
outline of the area so but unfortunately
that algorithm they have in Java has
bugs so if you look here the artifact
here oh no sorry not there over there
yeah so this looks like the you know
like it's a cow it is supposed to be a
dog but it looks like a cow but actually
it should be just round corner over here
so and and and and here though it kind
of fits into the you know the idea of a
man with a Buddha knows but but it was
not something that people were actually
wanted to draw in college so I had to
invent something different I ended up
downloading es are I geometry library
from github and they have a much more
obvious API so you you have the boundary
operator and you just you know provide
the shape to it and it can generate you
the polyline around the around the
shaker that actually works and it's used
in this demo it's a little bit less
performant because they kind of try to
cover all the edge cases etc but yeah
that's how I did and then and then we go
actually that that finishes the problem
that I always facing to in order to cut
this do you remember anything else to
talk about oh I remember we had we had
some threading issues with a homing
procedure
yeah we have once we fix those that it
was more reliable and in general these
CSD cutters seem to occasionally fail
but restarting them always fixes it so
sometimes they get stuck in weird states
like you'll get Erika's back during
initialization or other stuff and you
just restart those happy yeah so um want
to remember about that is that it's
actually the code that was communicating
with a with a router it had several
layers like caching layers and like
different threats writing to the you no
doubt outgoing buffer and reading from
it and there were some threading issues
like like it was assuming the state has
changed but it actually didn't change in
stuff like that or for example oh I
remember something else didn't have to
turn off the cash me entirely yeah
exactly that's why we had to turn it off
because there were issues for that and I
I guess another thing was that there was
a was a notification handler when you
send a command I want to tex acute it
there is a handler that smoked but if
you ask the you know the controller the
universal sender about the current state
it's still not like completed so kind of
updates you that the action was done but
it still thinks it's not done so if you
ask it to do more you will just fail so
subtle things like that happened there
and I guess that's one of the place when
I fix it to send a notification after
they update the initial state or
something like that and okay the last
thing it's a QR code reading yeah but
other than that I guess everything else
was pretty straightforward yeah no I
think overall it works pretty seamlessly
I mean we we were running these all week
at javaone and most of the issues we
have for mechanical issues with machines
like the limit switches getting out of
position this offer worked pretty well I
think on a couple machines the
cereal the serial port randomly changed
on the Raspberry Pi for a reason we
never quite determined yeah but there's
a property file for the code to set the
serial port so if we just modified that
to take the new serial port which the
Raspberry Pi which the the Arduino in
the CNC cutter was picking up from the
Raspberry Pi then it worked again until
you rebooted and then I went back to the
original 04 quickly stuff okay so QR
code reader your kids so this is yeah
something that the little will be usable
camera for up here so you can choose a
scan QR code and then if using the
mobile app you can scan with a little
cameras here and it will do its thing so
in order to do that there is a nice
library which is kool g grp i can and
that's again pretty straightforward you
just you know asking to take a picture
and it takes it and what to do next is
that there is a that x single library
that is capable of parsing QR codes out
of the image so you pretty much just
gives it an image and it decoded into a
QR code and then the tricky part is that
you continue to get new images until you
get something reasonable from the q QR
code scanner parsing parser and i guess
that's it and we turn to the demo okay
so question Bob that was a key we
actually Steven mentioned that we
actually had a cloud back back hand that
stored all the SVG past there so they
are if you put the whole SVG part and
secure code
81 be recognizable it will have a lot a
lot of small you know dots in it yeah
yeah we did consider doing that but it's
too much data for a QR code to be read
widely by the UM the scanner yeah I
actually asked them to remove like
everything but the ID so that it's vegan
you know easy just to scan and then I
just add you know the URL to it so they
started that originally it had the full
year old prefix and then the the codes
longer and it's a more complex graphic
and it's harder skin okay cool so we're
going to we're going to do a demo so you
guys should come up here since we are
done with the slides we're going to cut
the mics recording consider the
recording over now and you guys can feel
free to ask questions as well when you
come up so who wants to wants to do leo
you know a code available somewhere I
guess we do I'm not sure oh it's an open
source right yeah so the good part about
this code is it all an open source we
didn't cover a lot of details but you
can get an idea by looking at it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>