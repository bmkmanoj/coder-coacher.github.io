<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Offline first applications, syncing with PouchDB &amp; CouchDB by François Gengler | Coder Coacher - Coaching Coders</title><meta content="Offline first applications, syncing with PouchDB &amp; CouchDB by François Gengler - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Offline first applications, syncing with PouchDB &amp; CouchDB by François Gengler</b></h2><h5 class="post__date">2017-11-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0LzORC0U6uQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so thank you all for joining my name is
uh Australia and I'm working for 12
years now for an international IT
company named Aris and this torque
focuses on offline mode for our
progressive web apps and how the offline
first design pattern can be implemented
at very low cost thanks to the
association of pouch DB on one side and
couch DB on the other side
indeed when designing progressive web
apps in general developers shared a
common belief that offline capability is
highly time demanding feature and thus
its benefit doesn't worth the investment
so I will not argue about the benefit
part in this talk but at least I will
try to convince you it is rather cheap
to have the offline mode enabled in your
apps so you may have heard about
progressive web apps these are web
applications that leverage the new web
and html5 API and to look and feel like
native applications nowadays there is
plenty of things the web can do thanks
to new web and LGT ml5 api's that was
only available before to native
applications such as push notification
of fly mode obviously handling tout
gesture geolocation
getting information about the device
such as the battery so actually
progressive web apps are an opportunity
to rethink how we build the web and
learn from native applications ok let's
now focus on how to address the offline
mode
so this slide depicts common
client-server architecture applications
are occurring data from a single and
shared data source and use these data
tools to persist the information as well
so when all the clients are online there
is no problem the data is persisted
synchronously when one or multiple
clients goes online offline sorry then
you need to think about reconciliate
this data and how to replicate it so
offline applications are like a
distributed system which means you have
to take into account data replication
and conflict resolution thanks to
caching mechanism the application can
still display the data but then how will
users if they want to will modify this
data so this is when pouch DB and
CouchDB come into play with an
out-of-the-box solution thanks to
CouchDB and post DB at the end of the
day it doesn't really matter if your app
is offline or online or your app needs
to do is to produce the data in the
local database pouch DB and then but the
we will take care of synchronizing the
data - Kelcey be so if you are online
the data get it's getting synced in
within milliseconds and if your online
is you offline then the data will be
synced whenever you recover the network
connection so this is all about the
offline first design first focus on
updating your local database then it
will get synced anyway
let's now focus on couchdb which will
play the role of the master node of the
cluster in our scenario CouchDB is no
SQL data store distributed under the
apache license its main advantage
comparing to other no SQL store is that
it supports replication over HTTP with
G's an API which is something very
convenient when you are designing
progressive web app or web application
in general actually code GB is more than
a simple database it comes along with a
reverse proxy support for authentication
conflict resolution and many more
actually curves we can replace your
application server please also mine
there are different solutions for
implementing the coach db-api such as
pouch DB server which I will use in man
demo or Couchbase which as an amazing
community of developers providing a
support of very good quality so on the
server side we will have couchdb another
client side we also have database than 6
then sinks over HTTP which is called
pouch DB pouch DB is an open source
JavaScript database inspired directly by
couch to be designed to run on a client
side in the browser it supports many
different browser and many and various
types of device from mobiles to tablets
and obviously computers actually couch
pouch DB is kind of abstraction layer on
top of index DB and web SQL which are
the real store implementations offered
by modern browsers but we provide two
ways synchronization mechanism with
couch TV
so that your pouch TV application acts
like any node of the cluster finally the
integration of pouch DB with couch DB is
something very easy and fast to
implement thanks to a developer's
friendly JavaScript API is provided by
the pouch DB library so in order to
illustrate how pouch and couch work
together I've created a progressive web
app you will be able to consult the
source code directly on my github
afterwards and this web app allows users
to share images with the users community
with like features on the image so this
app is built using angular JS framework
it's synchronizing with CouchDB database
so I've for the purpose of the demo I
didn't use will casually I use pouch DB
server and this app is using the cookie
based authentication provided by pouch
DB server so for the purpose of the talk
I have packaged this app using two
different methods the first one is
electron which is based on the atom
framework and second one is based on
Chrome extension app okay let's now see
it live
so first before showing you the app I
will show you what the UI dashboard of
pouch DB server looks like and
especially the user database so as you
can see I have created two different
user Batman and Superman that I will
lose I will use to log in through my app
ok so on the left hand side I have my
electron app and on the right hand side
I have my Chrome extension app on the
electro app I will log in as Batman and
on the Chrome extension app I will log
in as Superman okay so now this is done
I can display the gallery page obviously
it's empty for now let's fit it in
Batman is sharing two images and
Superman as well
okay you see data is getting synced with
on the left hand side the electron up on
the right inside Chrome extension app
let us know if you see both application
are online you have the online offline
indicator on the top of the screen
now let's simulate a connection drop on
the Left application this user is still
able to play with the app while being
offline so it will use the like feature
to like images that Superman shirt and
it will also add a new image while being
offline okay obviously the chrome app
didn't get updated because the electron
app is offline I will as well add a new
image while being online on my chrome
app and then I will be back online using
my electron and let's see how it works
so all the data that was stored on the
left-hand side while being offline in
pouch TV is getting automatically synced
thanks to CouchDB back to the chrome app
and the like notification is displayed
and the new images that was shared
between post application are
automatically synced okay so let's go
back to the presentation
so to conclude the talk I've prepared a
very basic pro and cons analysis of the
combination of pouch and couch so the
negative aspects for me it is mainly
linked to the default conflict
resolution mechanism of couchdb which is
your wrists ik and according to me it's
a bit cheap if you really want to have a
production application then use the
solution you'd better write your own
conflict resolution mechanism hopefully
a couch DB when whenever there is a
conflict party view code GB will keep
both revision so you will be able to
know and to manage yourself which one
should be merged and which one should
take the precedence second drawback
according to me is by default pouch DB
when it is configured in live mode it
uses long polling which will consume a
lot battery and a lot of traffic if you
want to configure it that way so
according to me if you really want to
have a prediction app running life
thinking you'd better use a single with
that that will communicate to the
clients over a WebSocket and last but
not least our remember close DB is a new
SQL data store it's not a relational
database so it will not fit all the use
cases and positive parts so the main
advantage is the seamless integration of
pouch and CouchDB the JavaScript API is
are very very well designed and they
enable developers really to focus on
business goal rather than focusing on
the integration with layer with the
back-end system so moreover the
combination of the two projects provide
an out of the box above or
authentication conflict resolution and
so on which is very convenient when
implementing progressive web app or web
app in general it provides many features
out
of the box but when it needs
customization there is room for
customization
you are never blocked with of this
architecture you can write your own
conflict resolution mechanism which is
very which is a must-have because the
conflict resolution by default is not
really good but that good so to conclude
the talk I would say that this approach
is a quick win for offline mode and is
very good for a progressive web apps and
as well for hybrid mobile apps ok that's
it so if you have questions you can come
downstairs thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>