<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The new Voxxed websites using JHipster, Angular and GitLab by Stephan Janssen | Coder Coacher - Coaching Coders</title><meta content="The new Voxxed websites using JHipster, Angular and GitLab by Stephan Janssen - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>The new Voxxed websites using JHipster, Angular and GitLab by Stephan Janssen</b></h2><h5 class="post__date">2018-04-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SRyDJC1Ff0M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right yeah can I start
perfect well thank you for coming to my
session my name is Stephanie Johnson and
this is gonna be like an emotional
roller coaster of what I've been
experiencing for the last four five
months so it's basically a use case
about using prime ng and other
technologies and trying to get that on
production so basically a use case for
the people who don't know me
maybe this morning wasn't completely
clear so so I'm basically the founder of
devoxx I started this 17 years ago as
you can see from the gray hair this side
is from organizing events and this is
from my wife the other side but and I
also co-founded Fox and Fox is basically
an incubator for Java user group events
who want to eventually become a devoxx
so it's like a growing buff and I also
co-founded because of my son dev Fox for
kids and that works for kids is like
it's worldwide every weekends there are
multiple events taking place trying to
inspire children in NIT and engineering
and because of that I'm a Java champion
but I'm also a day-by-day passionate
developer I'm not the best developer but
I'm very passionate about it and I tweet
a lot on Stefan 0:07
so what's the agenda well I want to
first give you a bit of a context of the
objective then I'll give you some
experience about the development and how
I actually approached it and then I'll
do the design and the deployment
coverage and you might notice the order
isn't actually correct because normally
you would do the design and then you
might be doing development so I'll
explain that and for this it's a journey
so I've asked mr. robots to actually
join me and he will actually I found so
because he has a very expressive
expressive face I've asked him to
actually express my emotions throughout
the different phases so that's where
you're gonna see him appear on the
different slides so the first objective
was the following we in the Fox we have
six deaf oxes and each devoxx has a call
for papers so it's called the CFP and in
the CFP people can actually rate or not
in the CFP but the CFP is linked to a
mobile app
mobile app the entities are there when
they are affected they can actually rate
a talk so they can say this was a great
talk
the you can can give comments and so on
but it's fragmented there Fox France has
their own CFP the Fox UK has their own
CFP and so on and what I wanted to do is
create like an aggregated where I could
cut could get all the ratings into one
location and then we could see who are
the top speakers who are the speakers
which still have to learn a lot
etc and and so that was basically we did
the first use case the other one was
also to import the talks I want to get
all the talks of course because if you
have the ratings you need to see the
talks as well so that way in the program
committee if like Alex organizes folks
today's bucharest he says well I've got
this talk has that speaker already
spoken and other their focuses so he or
she can actually search yeah he has
already spoken
there's the youtube link and the ratings
were five out of five yeah we should
definitely schedule that person so that
was a bit did the setup of the first
version of my project and this was in
November so this was in November last
year and so hey let's do some
developments I was like very confident I
was like graph development that's what I
do that's what I breathe that's what I
dream of that's what I do they ended out
so that should be a problem so a very
confident mr. robot and I heard a lot of
things about Jay hipster now just out of
curiosity
anybody already doing or using Jay
hipster okay who has never heard about
your hipster before who has not heard
about it only a few okay so you're gonna
learn a few things I know Julie antibody
is one of the founders of Jay hipster so
I said well I really want to just play
with your technology because also as a
conference organizer you want to play
with technology you want to see what's
hot what's not and then also invite
these people people to your event so
they can talk about it and hopefully
inspire your attendees so the cool thing
about Jay hipster is you saw the opening
keynote from mark heckler this morning
he was like making in 45 minutes
micro-services environment well BJ
hipster I can do the same what he did in
five minutes more or less
and it's it's a it's a generator it
basically generates codes based on
selections that you make in the
generator wizard and the wizard is just
text-based so you can see here on the
slides you can for example the first
thing it asks is that what type of
application do you want to build do you
want to build a monolid or do you want
to build micro-services and so for
because it was version 1 I said I'll
just write a monolid that's easy to
maintain and to deploy I did want to
play with some new technology which is a
key cloak and key cloak is this Oh Alf
authentication authorization environment
from Red Hat so it's open source which
allows me to actually I mean my ultimate
dream is to have like a single sign-on
for all the Deaf foxes and fox days I
have it all centralized right so I
definitely wanted to have geek lock in
the in in the mix and then for the front
end you can actually select multiple
strategies just recently or they're
working also on the react version but at
the time when I chose it I wanted to
learn angular not angularjs but the new
angular 4 and this is a screenshot from
last week so they already support 5 but
at that time I selected angular 4
because I wanted to learn from this so
that's basically what you do you select
these different or you answer these
different questions and then it
basically produces a lot of code it
produces both the server and the client
side and it's all based on best
practices so if you don't know
for example angular it will create a
prototype for you in a matter of minutes
and showing you all the best practices
and that's like learning by example I
mean that's what I like is that you know
you sure you can read some books but if
you look at the codes that's where the
true face and you look at how its
structured and so on and it's it was
really inspiring so it reduces that and
then of course the next so only the
prototype you just have some admin
administration of users and that's it
there are no entities so what J hipster
has again to bootstrap you really fast
is something called design entities
which is the fourth selection on the
left this is by the way J hipster online
takes you step-by-step so you can
actually what I'm doing in the command
line you can also do it in the browser
it couldn't he links it to your github
account and whatever introduces it
actually pushes it into your github
repository and so that's that's what I
really like is that it has this
interface definition language or like
it's like UML class diagram and you it
basically asks you hey what is your
domain model so which entities are you
going to be using and so in my case I
have presentations I had users I had
events I had tracks and so on and what
you can do not only that is that you can
also define the relationships so again
if you've been doing UML it looks very
familiar but the beauty with this one is
that this UI so you basically edit on
the left and you just type and you type
the entity you type the relationships
and on the right it will visualize
basically what you're wanted to achieve
and this creates a an XML file and this
XML file can then actually be used in
the generator to generate all the create
remove update and delete pages for your
domain environments and this is done
just by this one line J hipster import
jdl and then the file that you've
basically have exported from from the
browser when you hit enter it basically
produces all the entities it not only
creates the entities on in the backend
but it also creates all the screens all
the angular screens to edit in a very
simplistic in a very simple way the the
different contents so this is like great
I mean if you don't look at the example
app well this you have this default
welcome page where you can low head will
now click on low him it will redirect me
to key o'clock you have to configure key
clock of course with users and
permissions and so on once your
authentic ated it uses the JWT to
actually pass that token that
authentication token into your
application and your
indicated you can start using the
environments and this is again a matter
of minutes I mean in less than half an
hour
I had a rebound you know you do two
weeks of course on the domain model
because I have you forgot some fields
and then you want to add some more
things of course so it's a bit of an
iterative process but very very rapidly
you actually have a working prototype so
it produces like this screen
automatically for the user so you can
actually edit the users and this was
like one of the examples that it creates
because every deaf Fox every Vox days
has a track so you have like the mobile
apps you have security have server-side
Java and so on so I produced I entered
in the diagram a track and it basically
then generates this this screen for you
so you get a list of all the tracks and
you can edit a track delete a track and
you can also search a track now the
search is only added because I selected
elasticsearch in the generator because
in the generator you can actually say
what type of plugins you want to use in
your system and if you say yes I want to
have a list elasticsearch then it will
automatically add search bars in front
of all of your domain objects now the
problem with elastic well it's not free
for starters at least if you put it in
production but it's also like a bit
heavy if you just want to search on
names I mean then that's really not
that's a bit overkill in my opinion so I
assume realized that that wasn't really
needed and I basically factored that out
using query by example so that whole
search thing was basically replaced with
a few lines of code which is a query by
example is based from the spring data
project and by the way I did that
mention that but the server-side
generation it's all based on spring
boots so what you saw this morning from
mark it's that's actually already
generated and that's the beauty is that
it generates sure it generates a lot of
code but it really is like again
learning by example you really then see
how you actually have to use this by by
the professionals who know it inside and
out so I replace that on the server side
by praying by example but then
are probably factored that out as well
once I learned a few other things so for
example one more complicated form so to
speak is the editing of a presentation
so a presentation can have one or more
speakers and I also want to have
multiple tags because I want to be able
to actually group the content on tags
and so I was having fun this wasn't now
ready it was December so that Fox
Belgium was behind me I could relax and
really do some quality time hacking and
I was like playing with bits angular and
even with jQuery a few things and I was
like oh okay
and then I was showing this to Alex
during a hangout so I'm really having
fun and this is gonna be useful for you
as well and the first thing he said was
like priming G primary G I said yeah
okay and of course I knew about it but I
didn't know that you already had an
angular component so I didn't look at it
and so but now expand out of it
like okay I went through the website Sam
damn I spent like a couple of days
writing my own autocomplete and he just
has that you know that component is
there and it was a lot more nicer than
the code right rod I mean I'm a Java
developer another typescript developer I
must say I'm not a JavaScript developer
typescript is much closer to Java and
I'm really feeling I very at home in
both Java and typescript these days but
but I discovered priming G because of
Alex I was like wow it has an
autocomplete great you know I'll just
add it and it was really very very
simple to do so you know at the top it
basically adds the B autocompletes
you add a complete methods where you
basically are searching for speakers for
example and that search itself can then
actually go to your backends get a JSON
file based on the on the letters that
you've entered and you it gets basically
displayed in the view I was like very
you know very clean very fast to
actually adjust my codes but the problem
was J hipster does not produce priming G
it produces bootstrap components so
because of Alex in suggestion which was
great but I was like damn okay now I
need to like veer
all the tables I need to do all the
different components and you know that
took me again a couple of days I know
there was like a really cool data table
which I looked at and this was before
the to the pool table because the truth
booth table was still in beta so it's
like okay I'm not gonna do the better
yet I'll just stick to the you know the
the stable one so so I played with the
table and I was like blown away I was
like come on I mean this table and I'll
show you in the application this table
already has search and filtering and all
of that so you remember the query by
example I had on the server side well
you know we're not talking about
millions of records we're talking about
a few hundred maximum and short talks we
have like a thousand four hundred talks
a year so it adds up after a while but
but in the beginning I was just about
let's get all the data from the server
and to the client and then the client
does local search own on the data in the
browser so I could actually even remove
all the codes for for searching by
example on the server and just have
primary ng do this for me and the beauty
is is that like here I I did move the
ratings so the ratings is white so you
don't see bad ratings but what I can now
do is that I can filter and say okay
give me all the talks from Mark Reynolds
and give me all the talks from Mark
Reynolds and DEF Fox us and I just type
in those fields in the head of the
columns and I can actually do some
really sophisticated filtering I can
even say give me all the talks from our
grain oats in devoxx us who had a rating
more than four and then or give me all
the talks with more than four and who
have kubernetes in the title and
instantly there of course what I've done
now is that because you don't want to
get that data constantly backwards and
forwards I'm basically storing the data
in local storage so you can even work
with yep I call this now the
administrator I can work with the
administrator even offline so I can
query and see what speakers have what
railings etc and it's like wow I was
like really being productive is like
Christmas was coming close I was like
yeah I'm feeling really good here you
know and I then started thinking of
other things so we have all these
call for papers and one of the things
that mark hazel who runs devoxx UK was
already hinting is that if you want to
configure the CFP you need to configure
this schedule so you need to say what's
happening on day one and they - how many
rooms you have had so on and so on the
rainy weekends I discovered also the
schedule application or the schedule
components from primary which uses the
full calendar underneath which is a
JavaScript component and it allows me to
actually create the schedule of devoxx
in a WYSIWYG type of way so I can like
right-click on a day I can say okay this
is a conference talk and it's happening
in this and that and that drew and it
that creates a time slots on my schedule
and this time slot is then used to
actually schedule the talks so I was
like really doing some some cool stuff
again Alex helped me in deploying it is
some production because it was working
locally but it was not running on
production on staging and what Alex
discovered I mean he's much smarter than
me is that the the JIT compiler was
actually breaking the system so actually
at the turn of the head of time compiler
from angular to get the schedule working
so there's something happening there but
that's probably a different story and a
talk on its own so fine the development
was done I really felt very positive now
for the deployments and I'm not a DevOps
guy I'm a developer and I don't really
do DevOps so my mindset was a bit like
this I was nervous I was like okay I
need to deploy this what should I do and
and luckily again both Alex and I Alex
offered like you know what we'll spend a
few evenings together on zoom' Andre
will not mind we were basically screen
sharing and he was guiding me and I was
learning a lot on really just deploying
this beast onto an ec2 instance and
whatwhat's nice what we discovered is
that jab hipster actually also produces
a complete dog talker structure so you
have actually llamó files for
the different applications that it is
dependent on so you will see you have a
key cloak you have MySQL there you have
hazel caste which is using its using
that for caching and then you have
adjust the docker compose which starts
all these instances for you so you can
do this with the aperture episode Jamel
file and that creates basically your
complete environment so that that was
like wow this is looking good
the first thing we ran into that Tuesday
evening was that key cloak which does
the authentication it only works in
production using SSL you need to have a
certificate because it's doing
authentication or today it should be
secure right so as I was looking at
let's it crimped and so all we'll just
do let's encrypt and that's fine I don't
have to pay for it but then Alex came
again with a suggestion with CloudFlare
so basically cloud fair anybody doesn't
know CloudFlare everybody knows that
welfare others few don't owns but cloud
ferrets it has a free plan and in the
free plan it provides a proxy where it
actually creates an ssl certificate for
you but it also does caching so it's
actually sits between the user and your
website and it does quite a bit of you
know smart enhancements for you
including the ssl certificates so that
was already one problem solved
then of course we started looking at
continuous deployment and integration
and there again get slap was like wow I
mean ours on github the problem it could
help is that if you want to have a
private repository because I didn't want
to immediately open source this because
I was learning a lot and then you know
it supposed to code that would be
refactored quite often as well and with
github if you have a private repo you
have to pay based on the number of
private repos but gitlab you get private
repos free of charge so ok Alex thanks
let's do get lab-created private repos
free of charge and it easy even has a
continuous integration part in it so you
can actually then link it because it
does not only have private repos
it even has stalkers registries as well
so you can actually push a chain
it was actually get your coat from from
gitlab and then I will actually create a
docker file push it in its registry and
then you can push that image basically
to your container and as this is done
using one file that you need to add to
your project which is called good lab CI
for continuous integration and it has a
few parts the first part is not really
necessary but it'sit's definitely worth
adding which it creates it basically
adds a cache to your repository so
everything of your repository is cached
once so the first time it runs your
maven file it will actually download the
internet put it in the cache and then
the next time you run it it will just
take the cash so it's gonna be a lot
faster and then you have different
stages of your builds you have the
different dependencies the build itself
the package and the deploy and every
stage can be configured as you can see
in these these different blocks you can
tell them on which gitlab branches
you're working and then basically it
does the this is the back ends by the
way it creates the docker image for the
backend so you just have a maven -
spot-clean package and then once that's
done it will actually deploy that image
onto your ec2 instance in my in my case
that was it so it very straight forward
I was able already to actually you know
whenever there were new changes
I could actually build it create an
image push the image to ec2 and then I
could start it for example with and
that's on the next slides here to
staging where I'm saying like okay on
staging basically start go to the docker
compose directory put it down put it up
again and and docker compose is
basically running your your container
that was like wow and we did that like
it one evening I was like yeah I was
like really feeling Buster's like this
is good and yeah you can just add more
like if you have you could say like okay
deploy to production and then you can
just have different commands now of
course in production I don't think you
want to do
down and up because I was making me a
bit nervous because if on production you
put your system down there's like you
want to have rolling updates right you
don't want to have your system down for
five minutes because you're updating a
new new version so so this is definitely
I'll come back to that point later on
it's not the way to do it in production
environments and in github
this is basically your your continuous
integration dashboards so did they talk
about pipelines and many other vendors
are doing the same like cloudBees has
like also different solutions there
Atlassian has the same so everybody is
working with these pipelines which
allows you to actually do some
processing and the output becomes the
input for the next pipe in your in your
process and so here you have an example
of the different builds that have
happened and on the right you have
display button and it's that play but
when you click on it where you can say
okay deploy to staging or deploy to
production so that's four for the moment
it's still a manual thing because I
wanted to control the flow of deployment
within my environment now okay we have
an ec2 instance we have the different
docker containers running now we need to
be able to hit it because I was still
missing a central part which which was H
a proxy so basically mapping the
different domains to the public IP again
with a bit of help I was like laying him
I bet after this long hang out with the
Daleks I was like smiling although all
the way I was like yes this is nice this
is running but I did I did understand
that this was staging right because
there were still a few things that need
to be resolved like highly available T
rolling updates and all of that so I
knew I wasn't there yet but at least I
had a staging environment that we could
to play with it so I was like really
bust I was already doing hang out with
the other devoxx organized I said look
what I've built and you have a look at
this and the problem with these guys
there are a lot of them are developers
they bombard you with new ideas and like
Marcus okay so we have this contents and
we have fox.com
so
vox.com is actually showing talks with
the videos and we are adding this
manually WordPress couldn't we just
generated based on the talks you already
have and not manually it inserted so
when the Fox days event is finished you
import the talks from the CFP you go to
youtube to find the link and then you
publish it to fox.com
yeah I could probably do that then you
have folks days I'm manually adding all
the Vox days but you already have these
events so can't you just publish all the
events automatically and you know that's
there you just link it to decieve yeah
yeah I can do that so I was like okay I
showed them something and all of a
sudden I had a few extra new projects on
my hands and I was looking at the system
saying okay well the vox.com and Vox
days they probably talked to the same
backends because that's where the data
is
but it's user-facing because your bin is
just us it's user-facing does that means
I probably need to think about design
because it needs to look cool and sexy
right there were a few other things they
were saying as well as it yeah but you
know the CFP everybody has their own
instance and every CFP somebody changes
something here and Poland's they do
something there and we have a fragmented
version of our CFP application which is
open sourced so they said like maybe you
could also deploy I'll go back one slide
sorry
you could also deploy a CFP so the
administrator allows you to create an
events add the schedule and then say
create now the CFP and it should be like
a white label docker instance where it
gives the properties of the events and
then the CFP is actually configured
based on that property file and that way
we only have one white label version and
we customized it with the properties
that we inject so it was like okay well
I think we can do that so those were
like three three different projects just
with having a hangout with these guys
but now I had to go for the design so I
had to design folks dot-com and folks
days and when the developer is asked to
do design I think that's how you feel
right you go like I'm not a curry guy I
don't
how should I do this I know I know how
to develop but design that's as for the
guys with I want stereotypes but that's
a different breed of person right so I
started thinking about this and what we
often do for the Deaf folks websites we
use WordPress the majority of them use
WordPress and in WordPress you have
these themes so you can like go and buy
a theme like for forty five dollars and
you have a really nice-looking phim
responsive and all of that you just have
to fill in the gaps and I basically was
first looking at that type of approach
it said okay I'm gonna select a cool
theme to present lots of data and then I
will just extract the CSS and HTML and
so on and do that and then basically map
its to angular I did that like for one
day and had like I didn't have I mean I
didn't know angular well enough to do it
good enough and I soon actually dropped
and said okay no that's not gonna work
and then after searching the web a bit I
actually ran into come something called
web flow don't know if you know this but
when that flow is it's it's basically
allowing you to do with a big editing of
also themes so they also have
proprietary themes
so I bought a theme which was like $50
and then you can actually link that
content onto the data test data that you
put into their system and then you can
play with like a quick prototype with
real data but but locally and then once
you're happy you just save the HTML
templates and I use those templates to
actually then angular rise that that
website and not being if in our designer
I showed what I did with the prototypes
and guys were like wow Stefan has like
secret skills you know but I didn't tell
them that actually what it was based on
the theme that I bought
now I've spoiled it of course now Alex
know so you will have less respect for
me but I didn't want to be dependent on
them on the Wi-Fi so I just did a screen
sharing and it looks like really nice
you know you can click on an events like
Bucharest you can import the dates you
can go to the next event which is
minsk after this and then you can go
even to the next one Singapore
you have a drop down you can go to the
different events so you have their
foxfox days and Java user groups events
you can't actually then go to the devoxx
events as well so I'll replace their
scope with this and then you can also
look at the champions remember the
railings so I could get the best rated
speakers and the guys from no fly or fly
zone are here as well but like fan cons
he's like d rockstar and then you get
all the talks from vent cuts that he has
presented at different divorces and you
can basically see his talk there and
then go into voxcom which is the the
content part where it's all categorized
you get all the different contents I was
into kubernetes so you can search on
kubernetes get all the talks from
kubernetes then click on a talk and
basically see the YouTube video and I
watch it so we have now folks days
linked with deaf Fox and they're all
interconnected and that's the next part
I can also then generate the cfb and
it's like becoming one ecosystem of all
these for the moment fragmented but
events are now basically interconnected
which is like yeah cool happy camper so
if you remember that the setup here I
started to run into let's say issues or
I started to see opportunities in the
fact that these were all monoliths but I
actually had some opportunities to
actually externalize and introduce some
some micro services so after some
thinking I said well you know I wanted
to know a bit about all the best about
micro services so I said you know what
I'll just redo my monolids and probably
migrated gently into a micro services
environment and soon but what I realized
after also talking to different people
is that well my monolith is basically a
macro service which I can eventually
start chopping in different pieces like
for example there's a small part for
image processing so when you add a talk
or a learn events I can add a picture of
the the events and then I'm actually
creating multiple sizes of that image so
that I can use this
our image if it's on a mobile phone or
use the bigger image if it's on a
desktop and then I'm saving it that in
Amazon is free but that service could be
perfectly extracted out of monoliths and
create a micro surface out of that right
but there are other things like the one
in the middle there you see the micro
service between the two macros this is
my daugher spinner so that one creates a
new docker cfb instance every time
saying like okay great a CFP for me now
people are having a job that the speaker
reception yesterday evening and the guy
from Amazon said like well the problem
with these micro service is that you're
paying for the micro services when it's
running and it's running constantly but
if you only need it like 12 times a year
because you're starting a new current
CFP for 12 events for example you only
need them and you start it so here it
says suggested like just turn that micro
service into a server less components
and so the server less components is
only built when it is running so you
know so what you're seeing basically
it's a hybrid solution you are basically
trying to get the best of mobile I mean
I'm not touching Bank you know I don't
have enough money to like have thousands
of micro servers and have it all I mean
very small team and every dollar is you
know we need to earn it so you want to
be also a bit conscious about the
resources you're using and so if you can
optimize it why not do so
so my next plan definitely well first of
all after this talk I'll probably use
radix in the angular clients I've
already had to workshop this morning so
that's an improvement but I will also
chop the monolith in different micro
services so I can reuse certain things
and you know it's a constantly evolving
beast a hybrid beast so to speak now Jay
hipster supports micro services and it
does it in an interesting way it has a
registry as you saw this morning where
you have the arica server and the config
server
remember this is all based on spring
boots and in the Gateway which is the
front end the front went actually has a
dual proxy and the ribbon interface or
proxy basically which does the client
side load balancing so every gateway the
vox.com folks days and the admin
have this type of setup okay
now I the the application I already
written was written in the model it so I
actually have to redevelop it and start
selecting it from within the generator
as a micro service so the terminology in
a hipster is that you have a gateway or
you have a micro service micro service
is in the backend so it has no UI and
the Gateway is the front end which has a
UI and then there you can actually
select the surface this discovery so you
select the J hips the registry you
selected key cloak again and basically
it starts generating your your different
components within within that
environment so it that was like it was
basically a rewrite of a lot of
boilerplate codes but my entities you
remember the class diagram I could just
reuse imported and that was all fine so
but now I have a micro services
environment and I need to do a second
deployment I was like I was feeling
confident well you know we did the first
deployment I know how this now works
let's do this this is gonna be easy
well it wasn't really well first of all
you remember I'm starting these token
instances for the different CF piece and
every CFP needs to have their own domain
name and the guys from devoxx Morocco
actually helped me with this and I said
we're gonna use traffic because traffic
does some really crazy stuff it not only
can create certificates on the fly it
actually talks to let's encrypt on the
fly and creates the certificates for you
for every domain that you add to the
environment but you can also it
basically can replace H a proxy and do
this all for you okay I've never heard
about traffic before while I heard it in
some slides but I've never played with
it they're actually based in France so
that's that's really nearby from nearby
from a timezone perspective and so I
said I was reading the documentation of
je hipster and je hipsters documentation
sets please note that traffic only works
with console so this cannot work if
you're using je hipster registry and
reading this on Friday so that basically
meant how to redevelop the application
and not select a hipster registry but
use console and console is also like
it's like a competitor of the arica
service so it was like Friday
refactoring I said well okay it's almost
weekend I'll just do this in one day and
I'll be fine and the first thing I did I
said I'll do it manually
I'll just factor out irenka put in
console in and after four or five hours
it was clear that wouldn't work okay
so I took a shower for a bit about this
and say okay well I will have to re
redeploy it regenerated using console
there's nothing you know there's no
response there's no alternative Julie
and the founder of G hipster he did
reply said well Stephan traffic works
with Eureka it does actually work so it
is just doable but I just didn't have
time to actually add it as a sub
generator okay so it's like this dilemma
like so what and this is like you
know new components I didn't really know
how they work so what should I do you
know what's the step so I was like oh
man this was like Friday evening my wife
she already saw immediately what's going
on because I was running like man this
is you know and I don't want to start
weekend like that so I said relax you
know just just relax have a look think
about it just go out go with the dog and
you'll come up with some new ideas
and so I decided basically to regenerate
it again and now instead of selecting
the registry there is this option select
console as your as the alternative for
your service different
and this was like after a couple of days
I had it working I was like yes finally
this is not development anymore this is
really like tweaking and changing things
and configuring and so on and what you
see on the left is that I have console
which is basically showing you the micro
services in the discovery which is
available and on the right you have
traffic showing all the different
endpoints and how it actually links to
your service and I was like yes
did it but but I didn't think about on
the left in the blue corner there this
is the traffic configuration file it has
a front end rule where it says you take
the path prefix and then you suffix it
with the service name so to visualize it
it has something like this
I had a slash foxed which is talking to
the back end I had a slash fox days and
a slash console on that domain name but
I actually had to try to map these two
and these were like this is staging
domain names beta dot fox.com had to map
to slash foxed and so on I told the
whole accessibility the challenge and I
said no problem
AJ proxy will figure it out it's gonna
work and so he was already taking a bit
more time at the H a proxy and it
actually worked until we used the
authentication key cloak so when we were
going to key cloak it was actually
giving the old URL the slash focused and
not the Fox that's not the better dot
fox.com but it was giving you the domain
name slash focused and so the
authentication didn't work and so we had
to actually drop H a proxy because it
wasn't playing nice with the SSL
certificates and the verticity host
forwarding and all of that that we
were trying to solve so I was like
really frustrated this was already like
one week later like this was like Friday
or Thursday the week before that I
decided to actually use console so I was
like man this is not really good I was
complaining to Julia the guy from Jay
hipster and she answered you know what
well let's reduce you to the founder of
traffic and the founder of traffic is a
Mill fork and the Mill fork on Twitter
said you know what should yeah one of my
tea
another julienne for my team he's gonna
get back to you this afternoon and you
can do a hangout and he'll probably will
figure it out and this is like you know
where it really makes such a big
difference when you have experts on the
line on the like help desk we basically
had a one-hour hangout and he basically
showed me how I had to configure my
existing rake
environment so he actually said get rid
of console okay luckily I had branches
get rid of console go back to Rekha and
I'll show you what you need to add to
the docker sample files to get traffic
working nicely with with your
environment and this is like really very
valuable so basically the first thing
you said is like I will add a front-end
rule which is the host and then actually
the domain name that you want in this
situation admin dot voxcom you enable it
to to actually work together with
traffic and you tell traffic which port
it is listening on and that was
basically it's an indentation I just
want to give you this as an extra
information to enable HTTPS directly and
to enable the certificates those are the
three are the two red blocks that you
need to add so on the buff you say okay
I'm listening on HTTP and HTTP I will do
redirects all HTTP will be redirected to
HTTPS and in the bottom it's basically
telling me you okay well save all the
certificates from let's encrypt in my
JSON file and basically that that magic
happens now automatically when I add the
new domain name it will actually go to
let's encrypt we will get the
certificate it will add it to my JSON
file so when you restart it will still
have that in the external storage and it
was like working I was like wow this is
magic now the problem with magic is that
you don't know what's happening behind
it so if something does go wrong you
have a tough job finding the problem and
I can even enable the dashboard from
traffic so it actually shows you all the
the mappings which is going on and and
then the sorry the exposure so it the
first one was the stalkers link because
what traffic is doing it's listening to
the talker sockets and whenever there's
a new docker image it said others you
talk or image it goes and looks at the
labels and then it produces this mapping
using the SSL Certificates so when you
know how it works it's simple but just
getting those stupid lines in the right
order and getting all the properties
working that that's always the challenge
so basically what I have now in my
dashboard on the left you can see I have
beta voxcom it listens on HTTP and it
- that k2 a micro surface basically on
the right yeah I was like yes it works
great so I was like really happy about
that
and this was like already four months
later when when I started and if you
look at it this is a bit like how how
actually now the the architecture looks
like you know it starts to get really
impressive you know I got angular and
Prime eg I got traffic I got P cloak
everything is dr. docker eyes I got my
SQL for my single sign-on I got my SQL
for my micro services using spring boots
using Hayes Lacoste for caching great
all good and I started adding more
components like this where I have a
spinner now which is going to be a
server less components I have my docker
cfp which is using elastic and Redis
because you want to search on
presentation using Redis I got my image
service which is now a micro service so
this is like this is all cool and this
is like running on one machine so the
next thing is like but you know how
if I now I want to do rolling updates
you know I want to be able to scale this
and so on how will I do this
yeah okay so it's like so I'm not
there yet this is not yet production
this is staging because I I'm unable to
actually get a new version up there
without having the other images going
down as I was talking to Milt different
people that I know and I basically have
two options either I use docker swarm or
I use kubernetes now this is almost last
slides docker swarm I've been told you
can't actually run it locally if you're
on the plane or on a train and you have
no internet they want to test it locally
it's a bit more difficult to actually
run docker swarm on a testing or
development environments with the
kubernetes you have mini cube so in mini
cube you can just start kubernetes
cluster on your machine and you can
actually play with the pots and the
Masters and so on locally and actually
test it until you actually push it to to
product
so I'm probably going for four
kubernetes and then I was tweeting about
this and then all of a sudden the guy
from kee cloak he said yeah but traffic
you should go for traffic you should
probably go for sto and go for surface
mesh because service meant you know it
removes all of these load balancer
client or load balancers it even removes
Arreaga because this Theo it does it all
for you it's like this it's based on
envy and avoid products from lifts and
it seems that lift and Google and IBM
have joined forces to create this very
interesting proxy where it actually runs
as docker instances and you the micro
services they just talk normally to each
other but they're intercepted though
only HTTP calls are intercepted by Sto
and it has all the load balancing and
all the magic for you as a result the
micro server itself becomes lighter it
becomes smaller which is great because
you know these images they're like
between 50 and hundred megabytes and
they eat memory and like I said I'm on
the shoestring budgets so I want to have
really really optimized environment but
then I heard it's version 0.6 and so
last evening at the speaker reception
percenter is actually talking about is
steel tomorrow so if you're interested
in this stuff I'll definitely go to his
session they said like well 0.6 we've
heard from some customers you don't yet
use it in production it's not yet stable
they were expecting a version one this
summer so they like said like well we
strongly suggest you only use it next
summer basically so it looks like I'm
gonna go back to traffic traffic does
support kubernetes so I'll probably use
kubernetes and traffic together and so
now I know what I need to do next I've
got my staging but now finally to
finalize this product and get it in
production you know I still just need a
couple of weeks and then I can go to bed
and probably just smoke a joint and be
happy of what I've done that's it thank
you very much
still got three minutes so if you have
any questions any specific questions or
just out of interest start up for me
who's using kubernetes already
introduction you see like one guy to
like so it's still like early days I
mean kubernetes is only been out there
for since 2014 it's still very young
like Amazon just barely supports it I
mean you can you can install the
clusters yourself but it doesn't have
like these wizards which Google clouds
has so it looks like it's still all
bleeding edge but hey it should be fun
so again if you throw questions I'll be
here today and tomorrow don't hesitate
to just talk to me if you want to share
some experiences or if you have
suggestions of what I can improve I'm
all ears and thank you for your
attention</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>