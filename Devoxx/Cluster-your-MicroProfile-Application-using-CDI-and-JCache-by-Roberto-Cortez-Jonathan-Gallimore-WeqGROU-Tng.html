<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cluster your MicroProfile Application using CDI and JCache by Roberto Cortez &amp; Jonathan Gallimore | Coder Coacher - Coaching Coders</title><meta content="Cluster your MicroProfile Application using CDI and JCache by Roberto Cortez &amp; Jonathan Gallimore - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cluster your MicroProfile Application using CDI and JCache by Roberto Cortez &amp; Jonathan Gallimore</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WeqGROU-Tng" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Birgit inflated do it make sure okay
guys let's start this session first of
all thank you so much for joining us to
this cluster your micro profile
applications in CVI MJ cache session so
kind of like a long name really sorry
for the small delay as you can tell we
can see here on our table we have like a
user setup demo some of our stuff yes
those those guys are actually raspberry
pies and we'll show some of those things
that we want to demo with them in a bit
so first if you allow us to introduce
ourselves
I'm Roberto Cortez I work for a company
called Tommy tribe note if you have
heard about that before but we mostly
work with Apache project namely the
application server Tommy other than that
I run my own blog and Matt Cortes comm
run around conferences doing all kinds
of sessions so this is like a new
session what we're doing here for the
first time so hopefully people go well
and yeah I mean if you have any
questions that you want to ask me I
mostly work with Java EE stuff in Java
in general so please drop me a line on
my blog or an email I'll be happy to
answer any of your questions and here I
have another colleague that's John can
you introduce my dog and my name is
Jonathan Guillermo I would also work for
Tommy tribe alongside Roberto based here
in the UK have been a committed to the
Apache Tommy project for around about 10
years now so I started committing in
about 2007 contributing various patches
and followed that community right
suitors starting to join the micro
profile effort which we'll talk a little
bit about today as well ok so let's dive
in into our session so usually most of
people save the questions to the end
we're actually not that many in the room
but even if we have a full room I would
like people to every time you have a
question just ask it because it's mostly
easily to answer the question in the
context when we are explaining something
so please just write around and say aye
let me ask you this so please you ask
questions anytime you have them to don't
send them to the end of course you have
questions in the end just you can make
them any way but please let's try to
make this more interactive as possible
and feel free to ask any question any
time you want our agenda for today is
we're going to look a little bit on what
is a micro profile look also a little
bit what in J cache then we're going to
do a demo with some of the Raspberry Pi
that we have over here and then we're
going to look in some of the stuff
that's predicted that can have in the
future for for the micro profile but
before going to Mike profile I would
like to ask some questions to the
audience so does anyone here knows about
Michael profile have you ever heard
about micro profile before one to two
people okay and now you guys doing micro
services yes so all the rooms doing
micro services okay it's just not using
my profile to do it it's just doing like
is like spring boots Lagoon others any
other framework no okay so what I like
you guys to learn about is that micro
profile is a joint effort several
companies that tries to give you a
service architecture that you can use on
a Java environment but not with the
heavyweights of the Java EE
so let's look into some numbers and
something so if you want to see some of
the stuff that micro profile has already
done they could go to micro profile dot
IO we already have the release that's
1.0 and it's compromised with CDI jax-rs
and JSONP so what why only those free
spec's is because that's the least
amount of specs that you require to
actually build microservice so most of
the times when you build a microservice
is only a jax-rs end point with some
injection on it and then you are
returning json so basically you have
these free specs only that's the minimum
para metal that you need to run the
micro service and of course if you
actually need to run some stuff into xml
Jack's B is also is actually part of the
plain Java C so you don't need to re for
that another interesting thing is that
micro profile is giving new application
portability across several environments
and going to see some of the servers
that support micro profile so who here
is using java regularly few people okay
do you like you guys enjoy using Java EE
yes no well for the micro profile world
probably Javy kind of like a cannon to
peel off like we have if you look into
how the Java stack evolved and how many
specs there is per version you'll see
that it's been gradually growing every
every message release so 45 we have 24
specifications then we grow up to 40
then forty seven and eight you can come
out yet there's already cut prospects
into that but probably going to have
more than 40 specs into that version so
this that doesn't seem right when you're
trying to build a micro service are
trying to build something that you call
micro right have 40 specs when you
actually probably not going to use 90%
of them so if you go to any of these
vendors so we Tommy drive and committed
Apache Tommy we are now supporting micro
profile
there's also support from WebSphere
Liberty valve life-form by our micro and
Kamui so all of these servers implement
the micro profile specification so you
can use it you can use them to run your
micro services and if you actually go to
the website we have a sample application
over there we like several modules it's
actually very interesting because it's
an application around conferences that
basically allow you to like register
attendees and registered sessions and
stuff like that and each part of the
application is actually implemented in a
different server so I don't remember
exactly which ones mapped with who but
let's just say the agenda is built with
Tommy the attendee registration was
built with WebSphere then all of the
applications just built together and run
on all servers in simultaneously only a
bit on each of the server on the server
so you can actually see micro profile
working with all these specs on these
different environments and it actually
works oh it's so it actually proved that
there is portability between all the
vendors and all these application
servers now let's dip a little bit into
some of the specs oh it's just a quick
reminder on what we have over here so
CBI who who uses CDI few people so CDI
is the contest in dependency injection
spec from javi it's probably don't came
out on on Java six even though we were
able to inject some stuff before most
mostly using a GPS but it's probably one
of the most important specs in the Java
EE the world so pretty much allows you
to define the life cycle of being
defined injections there are typesafe
you have have producers that are able to
produce beams of specific types you can
add interceptors on
on top of that we also have observers an
event so it's a very powerful SPECT that
allows that allows you to integrate with
a lot of technologies most interesting
is mostly all the other specs are now
leveraging the CGI into into their own
implementations to leverage the power so
of the via CDI so if you look into
transactions now you're able to see
transaction using CDI event and other
stuff so Jack's arrest who uses Chuck's
arrest or at least heard about that
before most most most of you guys
yeah Jack's arrest is the the answer of
of Java to implement restful Web
Services is probably one of the most
popular specs out there especially when
you guys are trying to implement micro
services it's mostly annotation place so
you're able to set up an endpoint very
easily just annotating a POJO
with a pass and post or get to indicate
the matter that you want to perform now
you can just return the response over
that the JSON XML doesn't matter
and it's mostly TP centric so it's very
easy to set up pad set up query
parameter set up forms parameters and
just using annotations on the methods
parameter so it's probably respect that
are not artists that I don't have any
numbers to say this but I will guess is
probably the respect it's mostly use I
was more using in the Java environment
at this time then finally we have Jason
E Jessup in only came out from Java 7
it's by the ways anyone using JSONP at
one person yeah so use it to parse
generates transform employee JSON
exactly's has a streaming API so now
also quite a model API so it's a still a
level
guy in the sense that you're not able to
in a standard way
have a POJO and map that budget to a
JSON object you usually have to like
have a JSON object and then I have add
the fields over there if you using the
object model API stream API is very
interesting because it allows you to
parse huge amounts of JSON special field
like JSON files like for 40 50 60 mega
even even higher basics just streams the
file you can parse it and then you can
perform operations on whatever you
exercise from the JSON file so if you
just try to load that file directly to
memory most likely the server or the JVM
will blow up up with out of memory just
just a small example so if you put all
the specs together we will just feel
like a very small micro service here I'm
using here a simple rest endpoint which
has a an application scope beam with a
path just called path so when I call my
endpoint will be like localhost /
context of the application slash pad I'm
injecting a movie being so over here
doesn't matter what it is it's just like
a store where I get data and then I'll
be Zen points we'll just do a gap bypass
on the ID of the movie that I have over
here I'm injecting the ID on the movie
on the method parameter and then I can
just do a find over there then I can
build a JSON object with the object
builder API in the end I'll just return
a response that okay with that object in
it so just roughly 15 lines of code very
very small and very condensed so this is
probably what the micro-service should
look like in the Micro profiles pack now
moving next so we have J cache
John they like to take over yes your
thing
thanks for Berto so I do apologize I'm
hoping that the demo is going to work
okay we seem to have a few gremlins with
a moment but I'll I'll talk a bit about
de cash and walk through the walkthrough
the coding and then hopefully we can
hopefully we can show you that with the
metrics running on the on the Raspberry
Pi stack so is anybody here using J
cache at all at the moment was it was it
fairly new to everybody so J cache is a
SJ sr 107 it's it went final early in
2014 so it's been available for a couple
of years now and it was quite a long
running specification as you can
probably tell by the low number it was a
it took quite a long time to get to that
final release but actually using J cash
inside your application is fairly
straightforward so there are four key
concepts that you need to know about
which other on the board there so the
cashing provider in effect this allows
you to select between any number of
different caching providers that are
available in your server or your
applications so you can actually deploy
a number of different implementations of
J cache into your server and if you wish
to you can use the default one that
called the caching kept provider will
give you alternatively you can specify
the name of the the caching provider
that you want to pick up each caching
provider will provide a thing called a
cache manager and this is something that
will look after a number of different
named caches so you can you can say I'm
interested in pulling information from a
particular named cash inside your inside
your application a cache itself can
consist of a number of entries and these
are key value pairs so if you're used to
using hash maps for example inside
java.util using it using a cache with
key value pairs is very
there's obviously other stuff that goes
on around that in terms of how things
get evicted but in terms of how you
interact it it's it's quite similar so
you can pick up J cash and just use it
in a standard Java Fe way using the code
that I've got up on the up on the screen
here so this is going to go and get the
the default cashing provider that's
available on the class path and this is
loaded using the services loading
mechanism so the next block of code then
goes and gets the cash manager from the
provider and then we're using a cash for
default which has which just takes an
object to the key and also has objects
as a as the value part of the key value
pair set and then finally adding a value
to the cash at the bottom there so we're
using world as the key and hello world
as the value that's actually been put
into into the cash there as you can
probably imagine you could actually take
the Java SE approach to using J cash and
you could start using that inside a Java
EE or a micro profile application right
away that's going to leave you with
probably quite a lot of boilerplate code
floating around inside your application
if you're going and writing this sort of
code every time you want to go every
time you want to go in cash a particular
value so I will show you what we can do
using the J cash API
hazal cast and also a J cash CDI
extension which will allow us to make
use of some J cash annotations that are
defined by the the J cash specification
we're using hazal cast here and one of
the nice things about hazel classes does
anybody use hazel cast by the way quick
show of hands a few of you one of the
really nice things about hazel cast is
out of the box it will it will
distribute the cash
across a cluster of machines and they
can join either by configuring the TCP
addresses in a configuration file or you
can use multicast if that's available on
your network so the different servers
can discover each other and the cash
will be disputed across those servers
this will work right right away in micro
profile just using the CDI extension so
it's just a matter of adding the j cache
API jar to your server if it's not
already there and then adding the havel
class gr and the the CDI extension into
into your application to get started I
will just make a quick mention of Tommy
so I don't know if any of you are too
familiar with Apache Tommy
so as Roberto mentioned in one of the
earlier slides there are a number of
different vendors working together on
the micro profile project including IBM
and Red Hat payara
and Tommy tribe and so each vendor is
producing a an implementation of the
amount of the micro profile inside their
own service so our implementation is
Tommy specifically Tommy 7 which is the
latest version a little bit a little bit
of history on on Tommy just very quickly
and we first announced Tommy in 2011 and
Java and we were Java EE 6 certified but
it's actually grown out of the Apache
opening JB community which is an
embedded EJB server we and we looked at
Tomcat and sort of took a slightly
different approach to the other app
server vendors who are typically taking
Tomcat and embedding that inside their
own application server to provide the
servlet and JSP functionality for
applications we actually did the
opposite and Tomcat as the as the core
component of our server and actually put
open you DB open web beans open JPA and
all various other component
inside pom cap and the integration
between all those components and zips it
back up so what we actually end up with
is a server that is very it's very true
to its tom count origins so if you
actually open it up you can see it has
the same comps Lib web apps directory as
a regular tomcat server I take it a few
people use use use Tomcat in the rink
okay awesome okay so very quickly I
don't know if you're having any luck
with let's open our pie our last beep I
set up here you'll notice that we've got
a couple of a couple of different
clusters but basically what we're doing
here is we have two data centers so the
colorful stack on one side and on the
other side of this stack here represent
two different two different data centers
we have H a proxy setup that is load
balancing traffic across these two data
centers and then we have a load balancer
which is the the raspberry pi in red at
the top of each stack we have two tommy
servers running on the on the orange
raspberry PI's and we have a my sequel
database running on the on the purple
raspberry PI's at the bottom the stack
that's in the middle here is a set of
clients so these are making calls
through to jax-rs services so they're
effectively they're effectively
generating some load and sending traffic
to all the various different raspberry
PI's for us we do have that these should
be pushing out statistics through into
elasticsearch we have some Cabana
dashboards which if we can if we're able
to show you those and then then we'll do
so and talk a little bit about the
metrics proposal that's in micro profile
so that you're aware of what's what's
coming down the line in terms of
functionality that's coming in in micro
profile in that regard
so I'm going to steal my laptop if
that's okay sure and that's what I'll
swap over with you okay
hope you folded the power thank you very
much
Roberto do under this if that's working
on your yeah let me also perfect
okay cool can everybody see my screen
okay or do I need to love the resolution
a little bit I can certainly increase
the font I think that's a little bit
bigger okay
okay so here I've got a rather simple
jax-rs based application so this is this
is our movie fun application that we've
had in in open EJB for a while and we've
converted it over to work as a to work
as a rest service and we have a
persistence layer that is a it's
basically a CDI bean that we're just
that we're injecting into our entire
rest layer so in our movies rest let me
just expand that so you can see we have
a few different we have a few different
end points here so we have a service up
here where we're able to search through
a number of different movies in the
application we have a request here which
we'll go and search by one particular
one particular field in our table genres
field and return the various different
distinct values back from the genres and
then we got some some crud methods to
add edit and delete movies from our
application as well and finally one
right at the very end that will that
will produce a count for us and then
using fairly standard CDI injection
we're injecting in movies the movies
being in here so this is effectively
each one of these services is delegating
through to this bean to do the
persistence side of things for us inside
the movies being it's probably as you
would as you would expect so we have an
entity manager that's being injected in
up at the top here and then the various
different methods here are doing JPA to
operations against that entity managers
so pretty much everything that's coming
in here is is going to go straight
through to our database to do some sort
of interaction whether that's to pick
movies out of the database or add
something new in or or make change
so what I'm going to do is basically
show you how you can add J cash into
this application so so the very first
thing is we need to add the the three
dependencies that I mentioned earlier so
we need to add the dependency for the J
cache API behavior cast jar and also for
the J cache CDI extension that I
mentioned so I've taken a little bit of
a head start rather than trying to
remember all of the maven coordinates
off the top of my head I've added these
three dependencies in here okay so it's
got the cache API hazel car the latest
version of hazel cast is three point
eight point one I believe I think this
will work with earlier versions going
back to about three point three or three
point four was when J cache went fine on
hazel castor had had its implementation
complete okay so the first thing I'm
going to do is um write a very quick CDI
producer that's going to provide the
that can basically inject caches
straight into this into this class so
the idea is to avoid the sort of
boilerplate that we have you know on
this slide so I'm trying to basically
inject the caches straighten strangers
code sort to avoid time to like this
code everywhere so I'm just going to
create a new
in a package which I'm poor cash a new
class which I just call cash producer
okay
I'm going to give this a retention
retention policy and I know sorry I'm
going to do that on the year and do that
on the annotations on here I'm going to
inject in the cache manager well let me
just zoom that in for you
so this injection here is something that
the J cash CDI extension provides
provides for us we don't need to
actually add any code to support this
particular injection and then I'm going
to just add a my producer method so it's
going to return me a object object cash
okay
and I love the produces annotation on
there as well so at this point what I
want to do is go into cash manager and
basically ask it to either give me
either give me a cash that's already
been defined or to auto create one but
each cash has that has a name in the
cash manager so I'd like to specify away
in my injection to actually to actually
provide that name so I'm going to just
create an annotation under here as well
which I'll call movie cash
okay so I just give that a name it's
going to have a tension
and
and maybe I'm here at it as well okay so
once I've got my annotation very quickly
set up I'm just going to flip back to my
producer and I'll add my movie cache
annotation on there as well and then I'm
going to in my cache manager I'm going
to do a site and take my injection point
and look for my movie cache annotation
okay then I'm going to look at the the
name of the cash
excuse me
so my cash is already being created I'm
just going to return it
feel free to shout out my coding errors
but Lee
okay
although I don't think a going know
create my cash I'm gonna provide a name
and I'm going to provide a configuration
as well okay I'm going to use mutable
configuration
so I'm going to set the type so that
this provides be the type of the key and
the type of the value that the cash is
using something that they're both those
two object class turn statistics off
okay
I can't quite remember what the setting
place I'll come back to that afterwards
okay so there's my very basic CDI CDI
producer that's going to inject my vixen
now inject my cash into my into my movie
beam so what I should be able to do over
here at this point is actually start
injecting private cash so I can create
so if I wanted to say for example I
wanted to produce a cash to basically
keep in memory the the results that are
returned from this get movies method
here I might create a cash that's just
called that's just called movies
as I can provide my movie cash
annotation here as well I think it's
cool that search so if I now want to I
could actually come into the the movies
method here and I could start doing
something here so I could say you know
movies don't get provide to provide the
keys if there's already an entry inside
my cache that I want to return or
alternatively put something in there and
one of the really great things that is
in the in the J cache specification
though is there's an annotation called
cache result and what this allows you to
do is actually and basically use all the
parameters in this method so the first
result max results field and search term
it will concatenate all those together
to all the values of those parameters
together to create a key and then it
will automatically intercept this method
look to see whether there's already in
it an entry in the cache with that
particular key and if there is just
return it and I actually execute through
this through this method block at all
and if there's no entry then it will
execute the method and then add the
result into the cache for you so in
effect with the cd-i extension enabled
you can actually you can actually just
start wrapping methods you know if you
don't need to do any additional logic
around the cache you can actually scan
you can actually just go and start
adding this annotation to your methods
so this is great but obviously there's a
bit of an issue where we might be
keeping some stale results behind so for
example if we've done a search with a
particular with a particular genre for
example if we then go and add a new add
a new movie that's a comedy or a horror
film for example the results from this
search that have been cached might no
they may now no longer apply because
there's now something additional inside
the database so this is probably an area
where we would want to actually use the
cache here
oh I'm sorry I've caught that search and
I've call it movies there so we may
actually want to go and actually clear
down this cache or we might want to go
and pull entries out of it that are
stale so in this case just keep it
simple and it's going to say movie stop
movies not clear and again I can do the
same in the add method and and the edit
method so I can go and programmatically
manipulate the cache if I want to one of
the other annotations that's available
is the if the cache is the cache put so
for example when something is added when
we call this add method here we might
want to go and update a particular a
particular cache so again this takes the
cache name so I will call this movie by
ID and I can use the movie that's passed
in here as this as the cache key if I
wanted to although probably more likely
I'd quite like to use the actual ID of
the movie that's passed in and so that I
can reference it again later and when
I'm calling this delete method which
just takes the ID and not the not the
full movie object so there's a the matte
rebuke on the on the cache put
annotation here which is called cache
key generator
so if I very quickly create one of these
we can basically make this gent take the
movies object but actually generate a
different a different key for us to use
for the cash for the cash put annotation
how's it looking our fantastic so let me
just expand that again can everybody see
okay okay so this implements cache key
generator and it takes it takes a
parameter that provides the invocation
context of the method for you and what
you can do here is you can actually go
and pick up all of the various
parameters that the method was called
with and then you can manipulate them to
create a a cache key at the end so for
example you can so we can get all
parameters and we can I'm just going to
close that up
we can say if parameter get raw type
equals our movie class that we're
interested in whoops
just cast the value of that parameter
okay so new object
okay and then obviously if I end up
through the loop and I haven't got
anything I'm just going to throw for an
exception here
okay so what that what that will do is
it will learn basically wherever
wherever we're using movie as a
parameter and we want to use that as a
cash key it will actually go and strip
out the ID for us to use as the key for
the entry instead so then if I wanted to
obviously in the delete movie I might
want to go and grab so if I inject in
movies buy an ID here
I can say movies plot by ID and I can go
and find the element that I want to
remove or alternatively there is a
there's a cache remove element that we
can use as well and again cache name
being movies by ID okay so I'm running a
little bit short of time so I hope that
gives you a bit of a feel for how
relatively straightforward it is to add
J cache in terms of the libraries into
your application and actually add some
of the annotations that are available
into your app and I'm just wanting to we
swap back over and we can talk through
some of the metrics that we that we
provide and talk about some of the
microphone file things
okay so we have a you know justjust in
case things went wrong we did have two
sets of two sets of raspberry PI's as
the power so is that quite long enough
yes I call boobs hover on the end yeah
so as you can probably see I spend a lot
of time over there during John's talking
and this set up is sometimes a little
bit Unforgiven you know it's some so
many things that can go wrong but anyway
I was able to make it work and we have
it sometimes well I think it works
pretty much okay or most of the times
like in the morning we had it running
after two minutes some reason now some
for some reason as soon as we wanted to
share it in a room full of pee you know
you know why not because we forgot to
sacrifice someone to her at the demo god
yes and and well I haven't sacrificed I
won't do that anyways but actually I've
sacrificed something but I haven't done
it and but hopefully and still I have
won a service that's not that's that
infeasible one not one smoke yeah yeah
anyway one of the reasons I think that
sometimes you have some a little bit of
hiccups especially when we unplug and
plug back in again is because we're
running actually all those PI's are
running darker so we used like a docker
images and all of them that runs a
client that injects data into servers
and the particular client and the
servers are running playing Tommy or
files that just invoke an end point on
what father has an endpoint expose as
John sale so we have an HD proxy on any
owner of those clusters that are colored
ones and then the other one is another h
hf proxy that balance between both of
them so I don't know if this is
not sure what's the best one only these
one over here so is it we got a J cache
version deployed again a cache version
okay so basically we have over here as
well or tummy server also has a some jar
files that we added over there that will
introspect stuff that's happening on the
server and then we will push data into
an elk instance of elasticsearch log
stash and Gabanna and then we came up
with these metrics that will showcase
things that are happening on the server
so if you'll see here on the on the
website we have the the endpoints are
being called by by the clients that are
the black ones to the to the other
clusters and if we're interesting
actually I didn't make them suppose
that's actually fun that's happening
that way so each clusters one is called
Graham in August called trowel and
usually should be two plus two servers
on each of them as you can see here so
Charles is actually working it like 40
percent capacity because one of the
server's not responding so usually if
all of them were here to be like 5050
and here per server we have server one
server 12 every one gram server one gram
server two so I can actually see that
troll server - it's missing for some
reason so this also provides very cool
cool monitoring features so you can
actually see if you know if you're doing
something like this you can see oh one
of the services down so what's happening
and now we also have our da will be -
okay so this actually noticing is also
talking about the database yes stuff is
probably exactly that we're going to
show so as you can probably see here we
have these graphs that basically showed
the database queries and and the
database statements the timing so
whenever one I was able to have this
working was around 4 to 28 and basically
the server started loaded some stuff
that was on the data store and of course
it says he has to run some queries where
after that I forgot
skin and now I don't have any queries
that are being executed on the server
especially because the clients are only
doing get requests so that's not going
to change anything that's on our on our
data really similar each of those nine
thousand three hundred and seventy two
requests effectively is coming is yeah
linked data straight from the cache this
coming from the Irish to the Dyke and
and also a interesting thing over here
is that you'll see that the first few
requests of course this might be because
of the JVM warming up but this is this
will be caused by the database calls
that were that's the ones they're going
to take the most so the first few ones
that are over here that's when the
system starts up they are much higher
than the ones that we have at the moment
why because of course I remove the
database and now I have my J cache in
the middle that's just having the data
that my clients are requesting so you'll
see here for the response time for each
HTTP request so we have a 0.3 seconds on
each request and and here you'll also
see that the the the PPS ok so the
temptation for second also went up from
here to here when when the auto cast out
of ice kiki and of course when you have
a database
the system will be moreover loadable
have to spend more time doing stuff so
you can be able to handle that many
requests now with the tray cache on top
of it now I'm I I was able to scale my
my crosshair over there to handle more
requests so those are kind of kind of
ask you a few things that you can do
with these metrics you want to you want
to bring up one of the metrics on the
not in the dashboard here in the
discover tab you bring up like the CPU
one oh he said to discover and then
let's see so one of the things I just
wanted to mention here there in micro
profile there is a proposal that's being
discussed on them on the mailing list
and there's a digital request for in the
in the github repository which is around
providing providing metrics so what
we've shown here is what we have
currently that we can have been doing
inside inside Tommy as you can see
that's very much a sort of a push based
size events happen inside the server we
push those through to elasticsearch but
there's in the proposal in micro profile
and that specifies a number of different
endpoints that you can use to to obtain
metrics data so you can do a forward
slash metrics forward slash base to get
particular metrics that relate to
something that's in in the app server or
slash application to get application
specific metrics that you can provide by
having been injected through CDI so I
can see I'm at an out-of-time but if
that's something that you're interested
in have a look on the on the on the
micro profile list and maybe contribute
to the conversation that's going on
there it's going to be interested to
know what sort of things you're doing in
that in that regard
yeah so we have that absorbed seems to
show you especially those L chef stuff
on what we're going on in the future and
other stuff on the specs of the micro
profile but we run out of time anyway we
would like to thank you guys for showing
up here and/or a session we're missing
the link here but basically actually be
set up is on a deep tub repo so it has
all the docker images all the ansible
scripts all the clients all the server
stuff so if you want you can actually
replicate that environment on your own
so on your own device was set over 3500
you can just run all the docker
containers in in your laptop so I'll
just treat that the link with the github
repo I'm a publisher and social data
large so just go wrap cortes and i'll
publish those in a sec so thank you so
much you very much for showing up</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>