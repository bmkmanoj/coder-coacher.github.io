<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Gradle meets Kotlin by Rene Groeschke | Coder Coacher - Coaching Coders</title><meta content="Gradle meets Kotlin by Rene Groeschke - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Gradle meets Kotlin by Rene Groeschke</b></h2><h5 class="post__date">2016-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_QaECMYonhk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome everybody to is it the last one
no it's not the last hawk ride I'm going
to talk about Kotlin and graded meat
Scotland my name is Jenny Grishka I am
working for great link for five years
doing mostly working on great core and
doing consulting or around continuous
delivery and greatly aid stuff every
twitter account github so if I run out
of time reach me afterwards yeah in this
short session we look how great works
together with Kotlin I start explaining
a little bit how you can build Kotlin
projects with greater really briefly
because it's quite simple spend one
slider so about writing greater plugins
with Kotlin and then most of the rest of
the time we focus on writing great boots
Kreutz within the cortland year there
and what we did in the last couple of
months around that and some issues we
have had have and it looks like with
some live demos so who views using
Kotlin at all okay who views using
greater okay better than vice versa so
if you if you're into cotton and want to
start your cotton project is pretty
simple if you use to greater the
jetbrains guys they provided third-party
plugin for that you apply that it's
nothing magic here build script you
apply the cotton plugin and then you
have to add that standard library
dependency and in cortland you always
need to add that at the moment that
Kotlin plugin is not in the Gradle
plug-in portal there's an open issue for
that you can vote i have a link later on
on top of that there is a there's a
plugin about their from the nebula guy
so nebula is a short term
or Netflix bit language that's actually
the open source suite of Greater related
plug into netflix guys provided and they
have yeah put some convenient plugin on
top of the existing one so you you can
resolve it from the greater plugin
portal using the new plugin dsl specify
a version year then nothing fancy
repository and then for example what
they do is they automatically yet that
standard lip you don't need to do that
copy pasting all over the place and what
I also do is if you have a Kotlin
dependency like Kotlin reflect or
something you don't need to specify a
version anymore so you can just define
the username or group name and then the
version is in fear or is taken from the
plug-in itself so yeah that's how you
build a column project put your cuddling
files and swordsmen cortland that's it
second step so if you want to write the
Gradle plug-in in cortland that's
straight forward to so we use that
Kotlin project I just described with
that nibbler plugin for example you play
the gray lip who have you have written
greater plugins before it's fairly
simple right compared to other bill to
plugins all you need to do actually is
apply or implement one interface with
one method and in cortland that would
look like this so we have that plugin
closet or plugin interface you need to
implement and you have a apply method
and that's what we do here we implement
that apply method create a task l world
and then we create a task with the two
last action nothing fancy in nothing
surprisingly so if that's all what you
wanted to get all of that talk you're
done but i wanted to focus on the
greater scripting front end and how we
can do that with Kotlin so at the moment
or so far since the beginning the
greater bit scripts the built or greater
files are I supposed to be contained
declarative described
of your bid using groovy bass TSL groovy
is nice to create expressivity as air
for describing those bids and in the end
what we also offer apart from our own
dsl elements we allow extending our your
bills with custom dsl elements like for
example android who's doing android
interesting not so much so that would
that's how it would look like so with
android you that android block is
completely coming from an external
plugin nothing we create in the Gradle
code base so we have a declarative build
script where defined different product
flavors different build types all that
kind of stuff so the dsi needs to be
able to deal with that kind of stuff so
but what are the current limitations of
that when the dsl when the original
ideas i was designed or the crucial
elements of it it was not designed for
performance so there are things we do in
our ideas and our groovy based years air
which can hit some performance issues
it's it's not usually not a big deal in
normal-sized project but for example
what we do is in that configuration
block if you see dependencies compile
and then give a dependency notation
what's actually we do there is we rely
on groovies denim dynamism so that you
can call a method or declare a method in
a build script which is not even there
and that how that is resolved in in in
groovy can be is obviously more
expensive than calling a native method
so the other thing about that dsl is
there's not that tooling tooling
friendly for two reasons one is okay
it's groovy and there are some groovy
tools missing these days like this I
think no proper ID plugin for Eclipse at
the moment or nothing that is maintained
the other things that we
use some some stuff in the dsl or in
from groovy like st transformation which
makes it really hard to for tool to to
understand what's going on there yeah so
tooling friendliness is something we I
think we're in a greater quality more so
Anna underestimated the value of that so
in the early so we have built up there
which comes with really good it support
or greater support in Eclipse IntelliJ
they provide their own functionality
which is really working well we see
later on but there's nothing in there at
the moment or not much in there that
supports you in crafting bit scripts
it's more about using a great ability
right with Bill ship and also with with
IntelliJ so and what's missing here is a
link between crafting bit scripts and
doing actually writing production code
like you you don't use the same patterns
you do when you write your production
code when doing great build scripts so
like you can't use refactorings you
don't do you you can't dynamically look
up documentation or that kind of stuff
that's well I'm not a JavaScript guy so
I rely on my ID I need that support so
that's missing for some to some degree
so why did we looked into kirkland at
all cotton is quite new they have been a
relatively new compared to other
languages cut line is statically typed
in comparison to groovy which is not one
that all was released earlier this year
it's what I personally really like about
cutlets driven by pragmatism that's
similar to what how how groovy started I
think and it's invented and maintained
by the dread brain sky so in that by I
think but implicitly means that there
will be theirs perfect ID support for
that and we notice that there is a
considerable uptake in the android
community you they want to use more
one reason is I think they have to rely
on on job and all the Java version so
they can't use Java 8 features so nicely
so that's where Kotlin comes into play
with their lambda support and all that
kind of stuff yeah and when you look at
when when the great team and the and the
cotton team first met or we started
discussing how ideas air could look like
there were some enticing opportunities
there so we we could potentially have
prop IDE support with the code
completion or the refactoring or the ID
stuff you know from from writing Java or
or native code in whatever ed you use
and since the the groovy or the Cortland
team they also or cotton is designed or
as proper support for writing DSL or
it's in the one of the design goals was
to to be able to create desert it it
sounded like a perfect fit to to try
that out with a great coming up with
great ideas there while keeping the
build scripts in a declarative with
Kotlin so if you then compare what we
would like to have what we rely on for
greater dsl compared to what Kotlin feet
or which continent features are there so
for example a great build script should
be expressive so therefore there's this
lambda expressions which makes reading
Kotlin code really nice or provides a
nice view on that you have lamb NOS with
custom receivers so we have something
similar you can build something similar
like the groovy bila pattern with
Copelan buy it but being static right
compared to groovy that big difference
readability so you can extend existing
member or you can extend existing
classes with custom or with more logic
you can delegate to two members all that
kind of stuff your first class scripting
support i mentioned that there's is
katie
Scotland scripting support built-in and
yeah Cortland is designed to run highly
performant or be high performance so
whose build is too fast I guess know
where you're right so builds group
builds are never too fast so performance
is always an issue when you when you
work on the on the bill tool quadlin is
statically typed and mention that that
makes it fast that it has a follows of
vanilla jvm execution model that is not
nothing fancy it compiled to normal by
code you can execute it you even have
control in the way you've write out your
cuddling code to rely on inline
functions so you can lambdas can be
inlined in your in your in your bytecode
so that you don't lose any performance
they also would look like native like
normal functionality without that lambda
and yeah I mentioned a tooling friendly
of course so it's JetBrains design that
language so there's a deep ID
integration not just for IntelliJ dev
they provide plugins for it lips and now
since a couple of weeks also for
netbeans yeah so that's more than for
example groovy has to offer at the
moment there's no there's unfortunately
no ID support for groovy at the moment
in in Eclipse word oh yeah there have
been some design constraints when you
when you think about about moving to a
different language or supporting another
language in as a DSL back end there are
some constraints in the greater words so
like we have something like 800 + grade
plugins in our plugin portal at the
moment and they should work out of the
box right it should not be necessary if
you write your build script in cortland
that you rely on you plugins or stuff
that should work out of the box the
other one things like yeah you can say
something like lessons learned that we
wanted to reduce what some people
for magic like what I mentioned earlier
we use that AST transformations in in
the build script I used to say okay if
you have a bit script just look up or
cradle API project file and then you see
all the methods or the functionality
which is there I keep telling that in
trainings to people come up and say okay
but there's this task tiffin task method
how's that possible and then i have to
say yeah we cheat a bit we do AST
transformation there and that's what
people what some developers consider to
be magic which is fair then in other
things if you're coming from cuddling or
if you used to write cotton it should be
idiomatic you should be able to write a
dramatic coddling code within within the
build script it should look different
too much different to what you do in
your production code for example
especially when you think about the
Android ecosystem if if you don't switch
between your cotton production code and
Kotlin bit script code that's big win
and another thing was of of course that
there should be easy way to migrate your
bid scripts or your bid from one front
end to another yeah we hit some
challenges some we resolved already some
not so much so first of all there's this
this is transition group you have to do
from dynamic to static so if we look at
that snippet here which is a groovy dsl
so you have that dependencies block way
say okay for my test compile I have a
dependency on j unit and actually what
what that is it's it's a method call it
called test compile with the parameter
as a string and that method actually
does not exist so and groove you there's
this method not found talk so you can
declare methods which are not there and
then you can react on that in your in
your custom logic so how would that work
with Courtland for example
in an issue in in an initial version we
had that kind of logic to solve that so
we have what you do is you declare
string which is by definition I guess
dynamic and then you call and you pass
that dependency as a parameter here when
I when I mentioned earlier that we want
to have nice ide support and to
refactoring and all that kind of stuff
that doesn't work if you move everything
to strings right so you have to come up
we had to come up with something else
what you can use there as in Kotlin it's
able you are able to extend existing
classes with with your own methods so
and how that works is so now it looks
quite similar to what we had in in the
jaguar land or in the groovy land so
with test compile and then we pass a
parameter just like a method and the way
you can do that is you can extend
existing classes there so for example
where that dependency handler and hear
what I do is I declare test compile
method peasant the dependency notation
which can be of any type and then in
that method I just delegate to that to
that add method which is which does
exist in the in the dependency and law
itself it's nothing dsl specific yeah
another issue we already we also had in
in the groovy back end is then you have
self referential bits groups like in the
bass cover itself you want to declare
dependency which is used within the bid
script a groovy we solve that long time
ago but in cotton it was kind of a
challenge too so actually what happens
now is if you save that build script the
dependencies resolved and then you can
use that dependence here like I I apply
a plugin publishing sample there's a
greeting task in there and then I can
use that
another thing that's not a big pain
point but kind of inconvenience and we
haven't solved that yet is that the
Grail API uses some patterns which does
not work well with a geometric cotton
cord i would say for example some some
places still the groovy closures in
their api so usually don't want to call
a method which from cortland with a
group groovy closure and there are also
these action parameters as a as a java
equivalent for that in cotton you have
you have lambdas and you want to use
those lambdas so we have to come up with
a solution to maybe to hide these or two
to make them non non available if you
come from the catalan work word yeah
that's something we need to still sort
out and last but not least one I think
general challenges if you maintain
multiple front ends that comes with the
COS right you have to catch up with the
latest greater features which are
currently developed in mainly in the
groovy dsl you have to find an easy way
to migrate between them and we want to
preserve on greater idioms that have
been built up over or the last couple of
years so that's another thing or another
constraint here and another cost with
that so let's we have enough time left
to do some coding so if you want to
start writing our build scripts and
Kotlin at the moment what you would need
to do is you need to change your
settings not greater fire to to specify
the name of your build script and your
build script should be graded kts it has
to end with katie has led to this
detection in in Grail at the moment that
we figure out okay that's a cotton-based
build script so and that's basically all
you need to change and then you can
start writing your boot scripts in in
Kotlin so how does it look like so I
have a have a bit script you just a
simple helward
if you have that settings file you have
that kts file and what I can do now is
for example if I want to apply plugin
enough now we see that I have closure
specific code completion year or
cortlandt specific code completion sorry
and then I can apply the application
plugin for example and that gives me
certain tasks here and then for example
if I want to configure that application
plugin I can do that by conferring that
plugin convention and then i can edit
code completion here i can configure for
example the class name the application
default jvi marks the typical thing that
the application plugin convention
provides let's let another thing
mentioned that earlier for example that
self-referencing build scripts I did a
repository here with that maven stuff I
could use like I have support for maven
central that code completion and now
maybe let's show you what I meant by
that dependencies are that great API
that does not suit very well yet the
cotton boot script so if I say maven I
have now damn it
like you see that there are three
different methods here to declare maven
repository there's this closure block
here which comes from the groovy world
still then there comes this auction
block which is the Java equivalent we
offer and then here's the this genetic
Kotlin solution you would like to use in
your cuddling scripts oh I've I would
say that the first one can be to make it
more readable more usable it would be
nice to hide them or to not make them
available in a column description so
that's something for example we haven't
solved yet so and then you do it like
this down and set the UL unfortunately
Kotlin does only consider properties in
tags if you have a SATA n together and
there's no way I get us we have to
declare together here like like this
yeah that's one thing maybe another
example if we want to have so if I want
to create a task tutor tutor I can have
the task give it the type of that task
and then do the name typical thing we
create a sauce jar and then you have the
code completion or with the with the API
the jar task provides you can use so i
can say wha so this sauce then i can do
exclude whatever and then you have that
support what you get in here is a file
and you can yeah have the normal code
completion that's quite nice and then if
I don't know if you're aware of copy
spec so copy specs are way too
a way to share custom logic you you use
in different copy or guitars so for
example i have now this one which is a
veil which is a non changeable variable
in in cortland and then you can say with
and provide that one and then get sprint
no yeah you see what i mean i can rename
that to some copies big and it should
find all of them yeah that's kind of
what we what's currently there if you
want to try that out with IntelliJ you
need to actually you can use the latest
IntelliJ release and you need to update
your Kotlin plug into to the latest
might soon release but then you have
that functionality basically available
maybe is another example or one example
left is there's already all the
jetbrains guys they over thin layer on
top of the existing Kotlin build script
so maybe remove which removes Lynch and
so here we have damage here we have a
cotton boots group that built an Android
app and if you compare that Android
block actually which which provides that
custom logic on top it looks quite
similar to what you what you know
already from from the groovy solution so
that's really nice but you have way
better code completion and stuff within
even with custom plugins not just with
greater building stuff yeah
so what's next so at the moment the the
cotton support in greater we have we
ship with greater three to the next
grade release will be will ship with
cotton supports 032 I think we want to
release or come to a version one dollar
by the end of the year or really early
really early next year to be on par with
the groovy support till then we need to
catch up with some to stabilize the dsl
and latest dsl features or functionality
that that are available in the groove
ideas are like for example that custom
plugins block we currently are I think
I'm not sure of that already in greater
32 or shipped with greater 302 there we
worked on performance like what we did
for groovy to is like if you have a
build with I don't know 4,000 bit
scripts or something you can imagine if
you compile all the big scoops every
time from from scratch that that's kind
of slow so I mentioned earlier that
cuddlin is statically typed and should
be performance but actually what it has
been in the past at least an hour bit
script is let that the bills have been
slower in terms of processing because we
haven't cashed or we haven't put that
that effort into the caching and now we
we catch the results of that compilation
so we don't compile all those four
thousand bits groups again and again
again one limitation we saw already in
my example is that the settings dot
Gradle file at the moment is is only
groovy so we're not sure yet if there
will be a setting start grade kts file
probably but it's not clear how we we do
that yeah at the moment it's related to
that you have to decide that explicitly
that your build script is built upgraded
kts and not built or greater and last
but not least there's an update
mechanism so or we discuss internally a
bit more about updating
and how we want to ship features faster
like for example greater releases every
now let's say six weeks something like
this and but what happens if the cotton
project test offer something significant
well you do you have you should at the
moment you have to wait to the next
grade release but at the moment we are
discussing things like breaking that up
and making that having those things like
like this the cotton support but also
like other features their own release
cycle and make it easier for them to to
update but you can update as a user to
newer versions of for example that
Courtland stuff yeah aria any questions
so before I have my question slide again
I work for grayling I the nice thing is
you can work from home yeah yeah
no the cotton plug in the cord and plug
in for writing Kotlin is provided by the
jetbrains guys and they they did it on
purpose that they haven't pushed that
plugin into into the Gradle plug-in
portal AB deser I ever have the link to
that tracker I don't know what the what
the reasoning behind that is they're
discussing it to push it there but I
will go with the nibbler plug-in it's
way more convenient to be honest any
other questions perfect undone thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>