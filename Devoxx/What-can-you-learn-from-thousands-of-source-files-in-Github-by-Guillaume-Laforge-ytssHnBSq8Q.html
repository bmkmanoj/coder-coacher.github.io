<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What can you learn from thousands of source files in Github? by Guillaume Laforge | Coder Coacher - Coaching Coders</title><meta content="What can you learn from thousands of source files in Github? by Guillaume Laforge - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What can you learn from thousands of source files in Github? by Guillaume Laforge</b></h2><h5 class="post__date">2016-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ytssHnBSq8Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">are you how are you feeling tonight not
too tired a little bit so what can you
learn from thousands of sources in
github on github there are so many
sources for so many projects personal
open source projects etc that there
might be something interesting to learn
from what's there so I'm gium lafarge
I'm developer advocate for a Google
cloud platform and I'm also the the
chair of the product project management
committee of Apache groovy and in this
presentation because of my two hats
working on the groovy language as well
as working for google i'm going to use
groovy source file as my example but
this applies to other languages as well
so it's not specific to the groovy and
i'm going to use bigquery bigquery
because up pretty recently last one was
that let's june geeta released its
entire data set so but perhaps some of
you know knew about the guitar archive
so this is a big dump of the content of
github but it's basically you know big
chunks of files so it's not easy to let
a grep through that and find interesting
things you have to do your own let's say
parsing or analysis of the of those txt
file but with this this news the thing
is all the the big data set has been
contributed as a data set inside
bigquery and with bigquery what's
interesting is that you can do queries
just like the name implies obviously so
before
I'm saying a few words about bigquery in
some more details get up data set that's
pretty huge so there are about three
terabytes of data in this data set over
2.8 million represents thats pretty big
there are about 145 million unique
commits two billion file path so all the
files on the different paths available
in your repositories and the contents of
the latest revision of that 163 million
files so the data set doesn't contain
each and every revision of each and
every file but really just the latest
version so I don't know what's the
frequency but normally the data set is a
place is updated once in a while but
well you've got a fairly recent version
of the of the files so that's pretty
pretty big alright bigquery it's
google's let's say date data warehouse
for analytics or image in a kind of huge
database that you can query which does
full table scans to go through a pizza
bytes of data and in a way which is
pretty fast and efficient and other
interesting aspects is that it's a
managed service so you don't have to
manage that yourself you don't have to
install anything and have to administer
or or anything like that so it's a
service which is provided as part of the
Google cloud platform and it's pretty
easy to query those data sets because
the the syntax is basically just sequel
so who's a fan of a fan of sequel in the
in the audience how they are a few hands
I'm not part of that crowd because I've
always hated sequel and for some reason
I never managed to
craft a well-written query so it took me
well the queries i'm going to show you
on I'm very very complicated but well
you have to be you know happy to use
sequel to use bigquery what else yeah so
yeah and the something I wanted to
mention there's there are some new
features as well in the previous version
it was really pure breed only but now
they are as well things like a date and
so on a bit more like data where I was
where you can do updates okay next and
perhaps I don't know if anyone heard of
dremel dremel the technology dremel so
there was a research paper published by
Google when was that in which the date
it's not written in yeah well a few
years ago in between 2008 and 2012
because Google's been using something
called dremel which is basically just
big query since 2008 so it's some major
technology and bigquery the the first
version of bigquery was announced in
well like almost four years ago and this
is used internally at Google and it
processes exabytes of data every month
so I have no idea you know how many
zeros exam I it's a Scott but that's too
many for me and then Apache groovy
because that's the the source code I'm
going to have a look at but again you'll
be able to apply that to all the
languages as well so groovy it's now a
13 year old language which is hosted at
the apache foundation so it's a long
wait inspired by java with a java like
syntax but with some nice syntax
shortcuts
it's a dynamic language at the same time
as being a static language in the sense
that you can also do static type
checking set compilation etc there are
some nice syntax shortcuts for things
like regular expressions native list or
special syntax for lists and maps and
things like that and what that's going
to be who's using groovy are there
people using groovy there yeah a few
hands nice so I'm gonna analyze the
source code the glory source code in
github so I've listed a few queries I
want to run so like how many Griffins
are there the most popular grief I names
some are pretty surprising how many
lines of code how big are the the source
files etc perhaps i'm going to show you
first so this is the the demo time so
first of all well this is the the
interface and so once you're logged in
there you can see things like the the so
this is the bigquery public data sets so
for example there are data sets you can
play with on baseball on so the github
one things like Medicare the meteor
roller meteorological stuff whether
stuff stack overflow exports as well and
I think air one of my colleagues had
things like the the reddit comments or
hacker news so if you want to run some
lights on machine learning on some big
data sets of comments so there are some
interesting data sets available and on a
regular basis Google provides new data
sets as well and before jumping to my
groovy related queries I just wanted to
show you like just one query but I
haven't totally finished it but
because I noticed it didn't return there
therefore some false positives but I
wanted to find out things like AWS API
keys that are available in source code
because developers actually commit their
API keys and then some smart or it's not
not sure it's the right adjective but
some guys tell the keys and use you know
your CPU time and that costs quite a lot
of money to you so I noticed that some
of the the results didn't quite show API
keys but also probably don't have the
right regular expressions so let's go
with my first query so where is it up
I'm going to go to my query history and
I've saved say several queries but
perhaps I could show you first before
yeah so just the the public data set so
there are several tables for example
here the list of files which are
available and for example if I query oh
yeah i'm going to create a new query so
for example so this is on the whole data
set so it's not just on the the groovy
subset for example you want to know how
many how many files are there and it's
going to return so that's one of the
figures i had mentioned in in the slides
but there are more than two billion
files available in in all the files in
that dataset so which is pretty I didn't
need the limit because I was just
returning one thing other interesting
things let's go to om perhaps I can show
you so what worthy how is the the table
view no that's not what I want to see
our I'll go back there yeah so there you
had the
so I count the number of files but you
have the file coming from the repository
its path etc perhaps you can look at
things like the language is being used
for a particular repository for example
this feel there in this table it's a
it's a repeated column so one repository
can have several languages so for
example if I let's say select so now
it's a it's a record or it's like long
which name I think pop up from and I'm
going to do where and I don't need the
limit where let's say I want to look at
ripon name we're repo name equals do you
have a repo on github you want to know
you know the languages which are
available in that repository anyone want
to give his ripple say it louder louder
mutton tensorflow what is it tensorflow
/ tens of law let's check that but I'm
gonna double-check like on get them just
to be sure we don't we have the correct
tensorflow then so flow yeah okay let's
do the right one so tensorflow let's run
it tensor float and surf thank you for
the typo okay let's run that so let's
see okay so there's some see some C++ C
make CSS and go in that River Street
what's interesting as well as you could
so I'm not good and sequels I won't try
to do that query alive but you could do
some aggregations to figure out you know
what are the most popular languages
across repositories and things like that
and i'm going to show you some
references to some other studies or blog
post etc which have been done providing
such such features and also something I
if you noticed but you can also see the
time elapsed for this square but also
the amount of data you had to go through
and in this case we had to go through
125 megabytes and the thing is you have
one terabyte free of I mean that's a
let's say free free tier for using
bigquery but if you use a big data set
you might go through so since they are
more than 20 terabytes of data if you do
queries like these at the end of the
month it might cost you something so you
can also do extract and I'm going to use
an extract for just the subset of good
resources and but i'll come back to that
also sings like licensees their query
table query table so I copy so if you
want to see what's the license of I can
do the same thing with tensorflow again
we're repo name equals 10 or so 10 so
flow and let's see what's the can go
back there ok run query and ok it's
apache license so that's great so what
else is interesting so here the list of
commits so you've got the whole you know
tree structure with the trees the parent
parent parent parent committee etc the
the committers the message used etc so
there's quite a lot of data for this one
and then also and we're going to use
this one for going through the GU
resources you can also have a look at
the at the content so this is the table
where you can look at the content and
basically the the query I was trying to
do earlier to find API keys and things
like that and I was going through this
contents a table so this one has got all
the contents of the latest revisions
license etc and there are also some some
tables so if you want to play with the
data set but with a smaller subset they
are some tables like sample commits and
sample content which which are just a
smaller portion of the Comets and
contents table so that it doesn't cost
you too much okay next I'm gonna show
you some groovy queries so what's the
the first query where oh yeah query
history and then then I'm gonna I'm
gonna look for my queries i'm going to
close that saved queries they are here
okay so what I did instead of going
through the big data set each time I
actually exported a subset in my own in
my own project there so i just have the
groovy related content so here i think
so what was the first query already I
forget so we want to do yeah count how
many files they are on github so let's
have a look at this query so I go
through my subset and it's just a simple
count star so how many finals do you
think they are groovy fans inside github
and I guess before I hit the Run 1 1000
1,000,000 1,000,000,000 no guess not
hearing you so they are yeah less than a
million files seven forty-three thousand
files okay so not bad next query saved
queries I second query so what are the
most frequent groovy file names and this
one was actually a bit surprising to me
let's run this one and you're going to
see it pretty fast this one is like okay
a dud groovy whoa I mean I know naming
is hard I know but still a a brewery so
I actually noticed they are I mean
people so I didn't go through all the
eight groovy files because they are two
twenty-two twenty-two thousand a degree
files and sometimes when people write
groovy script instead of creating really
classes just like Java classes they can
write scripts with just statements with
that class food etc actually sometimes
people just save their script as a
groovy because they didn't know what
kind of name they could give so there's
a B etc some are interesting very fine
groovy or config groovy that's often
used in places like continuous
integration or build etc where people
want to check something the result of a
build or for example they I don't know I
don't remember the ones i looked at but
i remember that sometimes as part of the
their amazing deal or greater beta would
run an additional script to check that
the output was the way they expected the
output to be configuration that's
usually to store well basically some
configuration stuff some other
interesting ones like this one built
config groovy URL mappings groovy
datasource groovy so these ones are
typical class is coming from the Grails
web framework so when you have you know
all the mapping the path to controller
mappings in your web application that's
stored in url mappings if you have a
data source defined to access a database
that's going to be in data so that
groovy and what else I've got a few more
there I just didn't use them all
bootstrap it so again grails oh yeah
this one as well
log back when you're doing some logging
it provides a groovy integration so you
can define your logger definition using
groovy so you'll find some log back
there okay next step query k third so
how many lines of groovy source code are
there let's run this one so this is the
total line of all the files okay so for
this one so by the way you notice that
my dataset is not as big because that's
not the big data set that's really just
my subsets we just go through less than
gigabytes of data so I what I did so the
content column of the table of the
content table is actually one big string
so if you want to count the lines you
can use a sub-query to just go through
the content Colin and split by lines
basically so you're gonna do that split
and then count from that sub query so
there are 16 million lines of groovy
code on key term okay so far so good
next saved query so that was this one
third this one is a little bit more
interesting so you know knowing the
total number of lines of code of groovy
code well doesn't bring much but knowing
how their those lines of code are
distributed do people right big groovy
scripts or small guru scripts that's
interesting and just like earlier so we
had basically this query initially and
I've got another surrounding query so
there's three levels of select so I
split I counted I but I also grouped by
a ID that's the
that's the idea of the file i guess and
then i'm going to use a function
quantile which which is going to split
the content for let's say buckets and if
i run that one I think I should use 11
and not 10 it's going to cut by 10
persons packets of 10 persons and let me
let me run this so that I can explain
the results to do do do do it ok so here
oh yeah I don't see everything so let me
increase that a little bit yeah so it
means that they are so the lowest bound
is basically 0 that means that they are
empty groovy script files or class files
well they are actually script and the
upper bound the last row means that
there's a groovy script or grade class
which is which has got nine thousand
lines of code this is big bit big to my
taste I mean let's go through that and
maintain that stuff wow that's pretty
scary but that's really the extreme and
what it's really telling us is that so
there are ten persons of ten persons of
the groovy files which are between 0 and
10 lines 2010 other persons which either
between 10 and 16 lines etc
the ten percent between 33 and 43 lines
etc so you know you have an idea of the
of the breakdown but if you if you see
look at that ninety percent of the
groovy fines are less than 160 three
lines of code which is quite small okay
my queries are there so I've done this
one the most frequent imported packages
so this one are compared to the previous
one so I still do the split per line to
go through the lines and I'm going to
use a new function here the regex
extract so that I can extract the the
package name from the weather the
package statements and I'm going to run
that so what are the most frequently
used packages a few seconds so the first
one spoke that's the Spock testing
framework and it's very much used in the
Greek community second one JAY you need
groovy transform look at this one that's
groovy HD transformation I'm going to
tell you what it is and you can notice
the data set is only on dot groovy files
so you don't see all the thousands and
thousands of Gradle bills because it's a
dot dot Gradle it's not that groovy so I
could have integrated that as well but
notice that well there are suddenly some
great plugins or Gradle bills which are
importing some API is from Gradle and
you also see Grails coming up there like
the test mix-ins logging there's a
special logging annotation in groovy
that you can use and more rails more
spring etc so far so good so it gives
you also some information as to what
kind of tools frameworks that people are
using
next saved queries yeah so the most
popular groovy API is used so it's
pretty much the same one except that
it's going to look only to the the
groovy related ones so groovy transform
I've got another query about that that's
the the cut transformations for for
example there's a just I could show you
that quickly if I had a class foo with a
name in groovy you can use an annotation
groovy transform you can use an import
to get that smaller def f equals new
full name iam lips and then if you print
F which is going to call in order to
string basically if you print that
you're going to have a nice here a nice
a nice to string message so it's a cut
transformation if you will that adds or
changes the the code which is being
combined to you don't have to code the
two string equals and hashcode and take
like that ok so let's get back there so
groovy transform again the logging we've
got some very nice Jason support in in
groovy handling databases XML etc ok
next of saved queries they are there I
wish there were a shortcut to go
directly to my saved queries so two more
queries and we're done ok so this one so
this one so that's the 80
transformations that I mentioned so we
have a transformation for plenty of
design patterns or frequently used
cutting habits and what's interesting is
that so groovy in version too many years
ago at its static combination because
initially agree was only a dynamic
language and we added a special
annotation which instructs the compiler
to generate the same bytecode as
jealousy to get the
puff monsters as Jeff I basically so to
string that's the one I mentioned equals
a nice color to generate equal to Nash
card package co can only call etc and my
last query that I've recorded them which
is there yeah that's a i'm going to show
you that just quickly in the groovy
console as well and just need to have an
idea so if you import I don't know
java.util.list or arraylist whatever
when you use so it's already pre
imported put in your group it's just for
the sake of the example so when you do a
ray list na perhaps I should have used
something like no it's least when you do
list you know this java.awt least and
java.util.list i think so if you had to
import twice the same class so let's say
you had you wanted to have Java let's
say WT list you couldn't do that okay
because there's a crash so instead what
you have to do usually you have to do
one would be not fully qualified and the
other would have to be lets say divided
ability or list something like that okay
not list list so what we are doing is we
allow aliases so I could say awt list
and then I could say new up like this
awt list so this is import any icing so
I just wanted to explain how it worked
before I showed that and do people use
such aliases in groovy well I know I
didn't select the query and the answer
actually I can show you the answer
straight away and the answer is actually
no not much there's just like zero dot
four percent of people using that all
right so we've gone through the queries
I've got several interesting links there
for example there's a someone studied
all the languages and
uh you know there's this good old flame
war about tabs and spaces etc so which
is used more tabs or spaces you've got
an idea well it seems that spaces have
one and there's only one language where
where it's tabs let's go but otherwise
the other one except a bit of sea oh
yeah see seems to be using tabs quite a
bit so there are some interesting other
analyses of other kind of source code
there so i'll publish the the slides on
twitter so that you can have a look at
the links there ok and that's basically
it so I'm over time the Dantas did to
come to me for some questions thanks a
lot for attention</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>