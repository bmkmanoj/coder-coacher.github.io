<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hit the plumber - develop a realtime web application with vert.x 3 by Clement Escoffier/Paulo Lopes | Coder Coacher - Coaching Coders</title><meta content="Hit the plumber - develop a realtime web application with vert.x 3 by Clement Escoffier/Paulo Lopes - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hit the plumber - develop a realtime web application with vert.x 3 by Clement Escoffier/Paulo Lopes</b></h2><h5 class="post__date">2015-11-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vC1EdeBZl7M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello hello everyone and welcome to our
live coding session with vertex and my
name is Paula Lopez and this is Kirk
lemon savvier and Escoffier Escoffier
sorry my bed and we are to developers
developers of the vertex team and our
main our session will be a live session
we're going to make some code we're
going to implement kind of a retro game
and in this retro game you guys will see
vertex you're going to see a web
application a real-time web application
where you in the end will be able to
interact with us on this on this game so
because this we only have like 30
minutes we're going to start right away
and we're going to start from scratch so
let's do this so and that's I will start
by creating a new project and I'll say
it it's a maven project I'm going to
give it a group video a group a group ID
vertex I'm going to call the box to be
original and very fun i'm going to call
it 2015 i see next i'm gonna call it
number game for example yes i say finish
so here we are hope it's readable for
everyone even in the back and try to
increase the font so at the moment we
have just a plane a plane maven project
in order to make it a vertex project
will need to include the vertex so we
add a dependency and then see i'm going
to call it over text core we're going to
use the version 3 10 which is the latest
stable version we have right now and
because my body fold tries to use java
15 we need to do some tweaking here so
i'm going to do you build build plugins
and I'm going to cheat a bit i'm going
to copy this because it's one of those
things that you don't so one thing about
vertex is that you need travel wonder
date and one because we use a heavily
use lambda expression you are going to
see that but also we have many happy I
from Java Heights that were using so you
really need a Java hide gvm what polo is
doing here is also important another
plug-in to create a fatass it's not
required but most of our users are using
maven trade plugin to build a farger so
vertex is completely unaffected you can
use whatever tools you want you don't
have to use maven you can use Gwadar
less BTW no build process at all it's up
to you so here in this session we're
using maven but you can imagine anything
and since we are building a fetcher we
need to have an entry point for
application and I already are coded this
class name of course the class name on
the class itself doesn't exist because
we just create a empty project so I'm
going to go here and I'm going to do new
Java class give this name and in in
vertex we have the constant vertical
vertical is like a small unit
application it's where everything starts
so you can bitch double yourself but we
have and helper upper class vertical and
in this class basically you just need to
overnight which so what vertex is going
to do is starting a launcher class at
vertex provide deploys its vertical not
also but you can do that you know main
missile or use this utility Mossad it's
up to you so here we're just so yeah we
just create this so i will try to show
my install there's some stuff so thus
far has been created and to launch of
fat girls it's a vagina but all the
dependencies you just do java dodge are
the name of
jar and while you see elevate X but
that's far from being a game so
congratulations just been introduced
vertex you just have the first
experiences vertex so in order to speed
up our development what I'm going to do
I'm because one of the things that we
have to do a lot is stop and start and
compile and the one interesting feature
that I would like to show you guys is
that we can do stuff like the people
from no GSR used to like a watcher that
it looks for 45 modifications and every
time there's a file for modification we
have a new a new build a new
redeployment and you done so you don't
need to be constantly stopping compile
start so what I'm gonna do I'm going to
start a script I call it run Sh just
because and basically this kit is quite
simple so what I'm doing is like
invoking maven package and i will say
then I when my my fat choy is compiled I
will run it to make it a bit more
readable i will say that i want to
redeploy every time any of this patterns
on the one file names changes and when
it redeploys I wanted to rerun this
crate so I just say this and because i
need to change the permissions to make
it executable so I should have probably
don't see it oh it should be it's
greener so it's executable just by the
dish so the first time you just do a
maven package and then launch of a
deployment so when you see that it's
when using in your deploy mod it start
the application in background and kills
it run the process we started so service
for sure no leaks and so on so you can
customize now the way deploy pattern
customize over the prior action so if
you're using a different build process
like SBT or npm
grunt gulp it works you just say okay
which command you want to use so it's
really an opinionated since we are short
on time I've already prepared a bit of
the JavaScript side so what I just did I
copied a minimum minimal minimal game
library that you can find on the
Internet I copied a bunch of external
and Java libraries that this game will
be required requires and I have a base
simple style sheet and to speed up this
what I'm gonna do here I'm gonna wait
for the Edward sure to come up and I
will say every time I change the coffee
script files recompile them for me so
well because that's what what the
browser is expecting from so we created
this and we have now a way to serve we
have now filed like the show but as you
could see from the code itself we don't
have any web server yet implemented is
our code is still a hello world so in
order to do that I'm going to include
the vertex web component so to do that
so it would just be a maven dependency
about vertex web same version as
affection of the vertex core it's called
vertex web and it contains absolutely
everything to do a sophisticated web
applications using vertex it's a bit
like Express if you use node so you will
declare your roots and for every would
you will declare on low and the hunger
will be responsible for serving the
requests so here to our law is creating
a water which will be our entry point
and on this footer it will just register
a couple of of fruits and handlers such
as a static on low to serve static files
and we will see a couple of fruits too
and so this one which probably is a
static on low so to serve also
JavaScript and CSS and lips we have by
default the static on low is looking in
the web root directory and that's why
its resources / web words all those were
so see
will be packaged inside the phaedrus but
you can obviously use them load reserve
them from the file disk too so from the
first system the last line polo is
created on HTTP server in vertex is just
one line you just say ok create an HTTP
server who is going to handle the
request it will be the hooter and I want
to listen on the port 8080 SAT all 19 so
obviously we need enough jml page what
are always doing now i will use template
i have already pre-prepared again
because because all the time so
basically I it's a simple HTML page with
some title and empty colors so as as
soon as the file is saved the
application is redeployed so I can
quickly go here and i can do need to
localhost ETO sorry you guys raising the
marsh cash but I think you did on to
deploy right starting that's done ok
alright still
refresh as you have an empty canvas so
again now we have the base for for our
game so we're going to start doing our
game so to do our game we will have a
game that works with two modes we have a
spectator mode is what you guys can see
behind me in the in the in the big
screen and you will have an active
multiplayer modes that you can play on
your phone or whatever so it's really
two different mode so it will be a heat
game so you have on the spectator mode
you will see yellow squares which are
leaks and on your mobile phone or
browser you will have black square and
you need to hit we're so tap where are
the league's ha and you will scroll
every time you had a leak so it's a
massively multiplayer game because you
can all of you play on the same instance
one spectator of you for all of you so
the game is as Clemmie just text when is
quite simple and the game library as a
couple of helper classes so in this game
we have basically two classes a play a
game as we just eat just explain it
you're going to be you guys and leak is
what you guys need to find because the
whole concept is like let's find memory
leaks and you're always blind you never
know what to look for so what the player
code is doing like every time there's an
update so that there's a tick function
behind this effort and as an update he
needs to clear the screen if there were
any drone objects before and if there's
a collision with a leak then we will
show some some new particle with some
color red then you see ok I found it an
Indian cleared and the lake is quite
simple is just some some yellow square
they will slowly going down and you guys
need to get it so this is the code and
because we have our index HTML it's
quite simple i'm going to now import all
the JavaScript libraries that we had
before that I show you guys before so
again I will cheat a bit I'm going to go
here and hang on so it's pretty much the
same it was before but now there's a
bunch of scripts and in the end I have
the spectator GS which is the compiled
spectator if everything is going to
write this thing should be like doing
all the magic in the background so I can
just go here and of course because it's
demo it will never work as you like
Kofi's
me she's so spectator tangi OMG why he
isn't oh yeah so because I change the
file but it didn't then generate the
JavaScript for it so it should know yeah
yes there you go we have the our base
game so you see the memory leaks going
on and once we start the game we now
need to do the interactive part from
from with you guys so every yellow
square is Alex and your goal on the
player side is you will have a black
square but you need to find where are
the leaks obviously as you will see the
screen it will be a bit easier but your
day it's quite quite wet role as a game
but it's quite fun too so because I need
to identify all you guys I cannot use a
plain HTML file use a template for this
example I will create J templates are
gonna do template so again a vertex is
completely an opinion till you can use
any template and jeans right now we
support Jade's I'm leaf and a couple of
other other one too it's pretty easy to
add another template engine in vertex so
i just created this I don't need to
compile and the dynamic part is that we
will inject a player d generated by the
server so in order to get j to work of
course you need such a template engine
so we provide it as a dependency its
vertex web blah then cheat yes you know
I vertex two and we should have now Jade
support so so no we need to say hey when
you see when we asked for this page use
the Jade template engine so it's what
polo is is going to do here instantiate
a new jet template engine using the
great wizard and hoop some some code
here I'm going to do that when there's
HTTP GET request to game i will enter
your code with the template ancient not
to do not mess up this so what you have
here is you declare routes to get is a
HTTP verb and when you get your request
on this one you will call this hon lo
this on low here is implemented as a as
a lambda expression such one of the
reason why we need Java height because
we are using a lots of land expression
inside while you just get to play your
ID and then save the page using such a
template engine and another important
thing is that up to now there's no
communication between the web browser
and the server so we're going to include
here our sock chase breacher we will be
able to connect to the to the result to
world so so GS is a it's a library that
start using web sockets and will degrade
smoothly till long pulling and the idea
is that we can send events and the
clients can also the browser can also
communicate in vertex we go a bit
further the idea of the sock GS bridge
is that it's plugged to the vertex event
bus so all events that vertex is on link
will be will be accessible from the
browser and the browser can also send
events due to any of the components that
are plugged on the vertex event bus so
is adding a wood to say ok
and when you have a request on g7 bus on
the on these routes or / even bachelor
stars then create the event bus bridge
and with this configuration so in this
configuration we have to say which
address from the eventbus we accept in
inbound and outbound this is just to
avoid to float the zoo browser because
imagine that you have a really large
application with many many events than
the browser we get all of them all your
buzzer will get all of them that would
be terrible for the performance so
that's why we have this feature so we
just configure bridge options and inside
this we will add some in permitted words
and by default the breeze or bridge
options are always the bridge is always
closed so nothing is allowed in and out
we will later come to this but this is
the the server setup and I'm going to do
the the client setup so when the game
starts we need to do is this so we
create a new event bus object and when
it opens it will do something at the
moment we don't do anything yet so this
is what we need and we have the client
mode the so I also create now the tree
okay coffee and I
so right now it just developing the
player parts which would be very simple
you just eat some places send your
places to the server and the server
decide if you hit Alex on out so as we
said before by default as the bridge is
always closed so we're saying here when
event buzzes open we send a message this
measure will never reach the service so
we need to allow this and to do this we
just need to change the bridge options
so if I know so we just add the
permitted roots and the permitted
address and in inbound and outbound on
the so clears bridge in the driver side
so yes a spiral said by default we don't
accept anything so you really need to do
that it's like a small security from at
this moment everything is the way we
allow in and out because all the
requests need to be routed through
through the server application and if we
go to the browser well we have our game
running here I can create new one costs
80 game so that's what you will have on
your mobile phone or on your browser so
that's a player side oh I'm just going
to try to make it this split screen so
we have now something but there's no
interaction yet and that's because we
haven't called what happens when when
when this interact so on a spectator
mode we're going to need to keep track
of how many players we have and some
action will happen when we received some
messages and we have two kinds of
messages like join and he should shoot
yeah so if I go back to the spectator
said he replaced so I have the list of
players and when we connect me now
listen to these two events now wait for
the deployment i refresh I can start
this so if i go here you see a white dot
that's me already interacting with the
game so at this moment we have a working
a very simple game working so we are
almost done because all these options
are in but it's not a real game if we
don't save scores because well again you
need it's a competition so in Italy we
need to win so in order to do this we
will define a new address saying that
our web browsers are allowed to send us
so to another address so let's call it
school and now we need to do something
with this address so what I'm going to
do is vertex even so right now we were
listening inside a server to all events
that goes on this address and every time
we get we will get an advance for
simplicity will just display the skus
the idea of the user but you can imagine
serving a page or updating I'll just go
in the database or whatever you want I'm
going to gain a bit cheat because
otherwise how we miss typing a lot so so
what we get from inside the event it's a
JSON object in vertex we are using a lot
of JSON objects so it's a message
containing a JSON object and we just
display on the screen or on the course
or what was contained in this JSON
object of course now we need to receive
these messages and these messages
because it's a game we can of we can
never trust the player so we will send
these messages from the spectator mode
so if i go back to the code here
as I show you guys in the beginning
there's this like this this collision
test so if I'm glad if you the place
climbing with the lake we do some
animation and then we will send the
score to the event bus so that what it
means that your brother is sending
message to the server but to also
browser too so you can you can imagine
Riley scenarios where everything is
communicating with everything using
events so if i refresh and if i refresh
the player if I now try to get some
collisions on you guys see i mean if i
switch back to indulge a i get some it
and the player i did by d it was just a
counter it's not say but for the sake of
the demo it's it's a it's good enough so
but it's not really a good game if
there's no such sound so let's we need a
Widow's and we still have a few minutes
so let's make this a bit more fun so
what I will do I will go to Google today
yeah and I can do waster in a beginner i
wish' lies my drum machine i will set a
bunch of random random sounds and i
don't know if you guys will get some
from this HD my connection otherwise i
need to get really close to my laptop so
now i need to get close to me you were
here something that's very wet or white
you cannot be more wetter than this
music so if you now do something it's
still it's fun but you expect some extra
songs when you do this each so we will
well I will
stop this by switching to a different
air and what I'm going to do i need to
change a little bit the player class to
also have the knowledge about sound so
when the class is created i will create
a sound engine i will set a special
sound and here when we hit what i'm
gonna do i'm going to play that
generated sound so this is really old
school in the sense that it's miss
indentation yes it's fine so if you look
here think it's redeployed so if i go
back let me first refresh so yeah the
music going on here this oh I started
like scoring right away so if you guys
wait wait it and if let me see on fake
if you guys probably if you're lucky
with the wiffy if you go to this skinny
figure to this IP address i don't know
if it's visible so does your bait in
your brother maybe i can close it ship
if you go yo what
so that so in 172 17 to 23 173 very
simple on port 8080 slash game game you
guys will be able to interact directly
with the screen you so if you take your
phone drops out your owns the same
network and you start using this you can
start playing and that's now we don't
have favor but it's probably the the the
Wi-Fi so in because of we thought of
that problem we already deployed the
game online and well I'm we have it
running on so exactly is the same chord
with me but not you need the bucket yeah
wait wait I need to start spectating
mood here and I switch it to this side
and this is the bar code for probably if
you guys can yeah it's not me so we have
new players yeah so in 30 minutes less
than 30 minutes we are developing our
vertex or a game based on vertex and
vertex web on the sub GS allocates a
retro game but imagine what you can do
in one over at yours yeah so we have
many users now yeah that was not a good
idea no zombie I thought now that was
the last ritual where that now that was
so if you are interested by vertex we
also have a talk on Thursday ready on
vertex about these conservatives
non-blocking controls is a synchronous
features how you can deploy
Michael services applications web
application games with vertex vertex is
a sin canoes and poly clock so here we
did JavaScript and Java but we can use
JavaScript Java groovy Ruby soon we can
super salon we have community that of
support added support for scholar and
Python clicks in progress and even
cuddling so well if you are questionable
vertex or what the game we have a bit of
time or will be at your head up goes or
I'm thursday for the Afro installed
which were much deeper in the details
and really how it works and how
explaining why we can do that in a
couple of minutes thanks to the few
concepts that are used by vertex vertex
can be summarized in one slide seriously
any question yeah the Assad will be
shared on github we will prorate wit
about that so follow us so I was object
one or Clemmie plop on Twitter and you
will get the full chord with we have
sounds too so the songs are random so if
you will package it or we started it
might be a bit different but yeah ready
another question okay so thank you very
much thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>