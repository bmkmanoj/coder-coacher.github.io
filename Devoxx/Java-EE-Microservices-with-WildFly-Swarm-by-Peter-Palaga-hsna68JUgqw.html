<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java EE Microservices with WildFly Swarm by Peter Palaga | Coder Coacher - Coaching Coders</title><meta content="Java EE Microservices with WildFly Swarm by Peter Palaga - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java EE Microservices with WildFly Swarm by Peter Palaga</b></h2><h5 class="post__date">2017-08-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hsna68JUgqw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so I think it's time to begin
hello and welcome to this talk about
Java EE micro services and wildfly swarm
my name is my name is better bargain eat
my primary job is to be senior
sustaining engineer for JBoss EEP at red
head JBoss EAP is an application server
it's the flavor of white fly for which
you can buy support from red head my
relationship to what fly swarm is rather
rather vocational one of those occasions
being these presentations but this
presentation as I was preparing it I
found a couple of issues I could fix
some of them and that's why I may call
myself contributor except for that I'm
on the author of saw steps so steps is a
tool for for building maven dependencies
out of their sources at the build time
of the dependent artifact this is quite
new in Java other languages like Ruby
have it for for some time and this is
quite handy if you happen to deliver
something something big as big as Java
EE server and your codebase is divided
into several independent code
repositories and the components have
independence release cycles and with
these source dependencies you may you
have the option to define your
dependencies in terms of git commits
rather than releases and in an extreme
case you can avoid releases that was
about me my Twitter handle is at the
bottom I will post the slides later
today and you can post
we want they are treated to me today
we'll start with Joey and micro-services
very briefly then we'll cover various
form basics it's basic concepts basic
use cases configuration and then
depending that depending on how much
time we will have I'll try to cover a
few a couple of advanced topics such as
secure access service registration and
discovery load balancing circuit braking
and API documentation with swagger
so to Vollmar please raise your hand who
ever wrote or maintained Java servlet
and AGB egb jax-rs endpoint and the
persistence with hibernate great Terra
is different thing to different people
and because I assume most of us are
developers here we may adopt that
perspective for now so Jie maybe looked
at a set of API specifications such a
servlet
egb jax-rs transactions persistence and
so on these are packaged together and
distributed in form of application
servers there are several
implementations of outflow and JBoss EAP
being one of them there's quite a lot of
history the last part of it being micro
services of the last year
you'll come to it later does a few thing
without which it would be very hard to
think about micro services in first
continuous integration and continuous
delivery which su
do you have a certain automation in your
builds and deployments which is also
called pipeline this pipeline allows you
to work with smaller change sets and
push them because they are small you can
push them faster through the pipeline
and they reach customers faster which is
good from the business point of view and
which is also good to reduce some risks
such as it's much easier to fix a small
change or to revert back to the previous
revision then with is a huge change
Linux containers are those small nice
things that boot very fast and that
allows you to to spawn a huge number of
instances within seconds they tend to be
seen as immutable and ephemeral if one
needs to store persistently something it
needs to be in two separate volume these
immutable and minimalistic images have
the apparent benefits of fast
provisioning fast boot time and when
done properly they may be quite small
and with less code you have less surface
for security problems or whatever kind
of box DevOps culture preferably small
teams should take care for for for
software in its entire lifecycle from
coding through testing and provisioning
deployment and monitoring
and solving all kinds of runtime issues
so when we have these three things in
front of our eyes the notion of
micro-services comes rather from itself
so we want to divide the functionality
into reasonably small units that can be
handled by small teams and we should not
use other than language independence
ways of communications between each
other it's very common to use rest or
other other protocols when we do the
isolation right we may use distinct
languages to implement this thing
microservices basting runtime data
stores they may have fully independent
release cycles and of course the teams
as I watch our Java EE still measures in
this with this new mindset there's a
couple of good reasons for this so first
it's robust the major it will understood
mainly in terms of performance and
scalability it's turned out compliant
and there's a huge amount of many kinds
of integrations available beat databases
messaging whatever and which is very
important there's a huge amount of
investment investments being done into
Java EE in the past there's code in
production and there's a workforce that
knows how to code with Java EE and once
you have coding production you should of
course consider properly if it's better
for you to implement things from scratch
or to reuse a substantial part of what
you
how can Joey Medina is actually a
monolid by definition because to pass
the certification Java EE application
server has to package all the api's well
you may say that there's the web profile
which allows to package smaller part of
the of the API api's but most of
traditional EE servers deliver just one
package that tends to be quite quite
quite large in terms of disks disk space
it's civically a few hundred of
megabytes some of them are slow to boot
and required a lot of memory which is
not the case of whitefly in the last two
points so not every application needs
old of api's and that's exactly the
mission of Val fly swarm it's an
open-source project sponsored by Red Hat
and it attempts to decomposition but fly
into smaller slices that can be used not
independently but that can be packaged
together in such a way that an
application brings with it only the
parts it needs it's very important to
know that the way to distribute
world-class form applications is you
burn jar a self-contained jar that
contains your application the parts of
the world fly runtime that are necessary
to run your application an internal
maven repository with dependencies your
epic
requires and a piece of bootstrap code
there's also a related concept of Hollow
ajar it's like uber job but it doesn't
contain any application code a this
might come in handy if you work with
layering in in containers you may decide
to create a layer that contains the uber
jar with all parts that are needed to
run your application and to place your
application on top of it into the next
layer this may reduce the provisioning
overhead and boot time and this is
actually also how swarm implements micro
profile micro profile by the way is
isn't a attempt to address this micro
service use cases and at the moment it
contains jax-rs Jax be Jake's B and CDI
- for an application to require some
part of the multi runtime or both of our
capability it is necessary to have some
notion that covers this these
capabilities and parts of functionality
this is called fractions in the speak of
worthless form there are you can think
of them as mavin mavin artifacts well it
they are not only maven artifacts
because they provide a nice unified way
how they can be configured some of the
map to Vout fly subsystems think Java EE
specifications api's and some of some of
then bring external cold such as Jolokia
like Netflix Raymond swag and so on the
complete list of fractions is over there
on the wall flash form web page show
demo with a traditional Java EE
application this is a standard example
from our own Gupta I have cloned it into
my walk workspace as typical for Java EE
application its packaging I should unify
the output sorry okay so its packaging
is warm I hope you can read text vests
big enough is it and it's all
dependencies Java EE API when we build
it
the result is born and to deploy it is
we start without flight as you can see
it starts quite fast and we can deploy
it we deployed to see what it does it's
very simple it's strong seung-jae speed
page and rest and pointed returns some
list of names so to verify this one we
need to take what fly swarm plugin
place it into the poem safe
build again and look what's the one of
the thing is the Fed jar that ends with
- warm and to run it we just Java jar
so the default context application
context all what flies form a strewed
context so we have to remove this one
and see that it works that easy you just
add the plug-in package and you are done
so where are the fractions we edit just
plug-in and the answer is that the
plugin is able to auto detect the
fractions for you based on the Java code
and your dependencies in some cases you
may want to define the fractions
yourself manually in the poem file this
is what it looks like
you best import the bomb that manages to
versions and then you can use use the
fractions and veneer are not migrating
and all the EE applications you may find
this generator handy that allows you to
to prepare a stop for your project here
at the top you just
put your group by the artifact ID of
your project and here at the bottom you
can choose the fractions from the list
and you can see there the status of the
given fraction some of them are stable
some of them are experimental good let's
go through a few comparison comparisons
between traditional world fly and valve
as form in terms of disk space a freshly
built valve fly master zip is around 150
megabytes
unzipped it is 177 when you have just a
plain servlet in your valise form
Weber jar it's only 36 megabytes and you
see father figures over there so a small
rest endpoint we see the eye and JPA
requests a hundred megabytes poisoning
the differences are quite obvious please
what why you need to copy the zip unzip
boot configure the data sources and what
we need messaging queues and then you
can deploy the application with Wi-Fi
for me just copy the Fed jar and run it
it's not true that vault last form is
just another way of packaging wildfly
because there where deliberate decisions
done not to include some kinds of
functionalities for example about last
form will not run with a security
manager you will not be able to deploy
ears
there's no clustering there because it's
not really compatible with the mindset
behind microservices there's no session
replication domain management
distributed caches with infinite span
and so on any will not be able to build
distributed messaging broker out of
Atlas swarm instances this is still open
for contributions from community if
somebody finds it important enough
configuration both why swarm allows a
nice Java API to hard-code configuration
into your into your fat jar if you look
at this and especially if you know the
configuration model of the Firefly and
JBoss EAP you will find it very familiar
actually the fractions that map to Java
EE api's
are automatically generated out of the
management model management metamodel of
val fly so everything you can do over a
Val fly management interface can be done
also here like this directly with the
flu and Java API when we work with
continuous integration and delivery
there's a concept of stages each project
goes over stages from the development
through tests and whatever further
stages you decide to have to production
these stages may require a bit different
settings and these project defaults Yama
file is there for you at one hand to
provide defaults and on the other hand
to provide different values for the
individual stages to specify a specific
stage you will run with
as when you make migrating from a
traditional vat fly deployment you
probably have a standalone XML file or
at your hand and ways well transform you
can reuse that file you can either
specified on command line or you can
package it into your Google jar you
should ensure that you have all
subsystems in place that you try to
configure in the standalone XML because
we're standalone XML the valveless form
plug-in isn't there able to also detect
everything you have in your standalone
XML because it simply doesn't look into
it and the highest level of the
configuration are the command line
arguments there's a few of them like
bind to interface select the profile and
few others and system properties system
properties are quite powerful they may
they can override everything you say you
you set in defaults Yama file or through
the Java Java API there's a full
reference of the properties over there
on the valveless form web page so now we
come to the advanced topics time okay
so who have you know ski cloak cloak is
a JBoss community project - it provides
a single sign-on server and identity
broker it provides all those security
related things that are hard to
implement correctly and the very prone
to security issues such as some o of
open ID various social logins LDAP and
Active Directory Integration so to
secure a UI or rest endpoint whisky
cloak you just need to put the ski cloak
fraction into your pom.xml there's a few
settings you need to do ADA through the
defaults the AMA file or Java API such
as you need to select the key cloak
authentication method and tell key cloak
which parts of the application needs to
be secured there are also key cloak JSON
file where you actually specify which
which key cloak host should your
application speak to another topic is
service registration in cloud and micro
services environment where the instances
of micro services are being created and
destroyed very fast it's not very useful
to rely on IP addresses and host names
that's exactly the mission of service
registries
your application your your instance of
micro surveys is supposed to register
itself under a certain name in the
registry so that it's dependent services
are able to find the IP addresses and
hosts through the name under which the
service services service instances are
running and are ready to response
response to requests so console is just
one implementation of a service registry
that advice form provides out-of-the-box
to use it you actually don't need that
piece of java code this is just showing
what it does by default the name of the
application is equal the the name of the
service under which your application is
advertised is equal to the artefact ID
in the pom file this comes from example
is called ribbon console under valveless
form github organization follow this
Netflix ribbon which may be used to do
the the inversive part of service
registration which means service
discovery you either use Netflix reborn
or you can use console client manually
or directly in your Java code
Netflix ribbon does a lot of other
things in addition to service discovery
it's a general-purpose inter-process
communication library for pressed Mike
services it provides client side
load-balancing to other services and it
offers several implementations such as
round-robin response time rated random
as I said there's integration with
several service registries and there's a
building support for failure resilience
VR hystrix
to use Netflix reborn' you add the the
usual ribbon fraction to a poem and to
create a proxy or an ad-hoc client that
communicates through all the complicated
reborn logic you create an interface
with resource group annotation that
references the name of your the name
under which you have registered your
macro service and the lookup is done by
console fraction under the hood
at the bottom you can see how to how to
instantiate that you can do it we are
reborn firm and it creates an instance
of your interface dynamically okay so a
graph as usual you had the fraction you
configure it either a Java API or
whatever other option you have like a
system property or Yama file and once
you have it this is what you get
when you request the swagger Jason
that's basically it a small recap
pipeline white flies form is just enough
application server that package is just
the parts of traditional Java EE server
into an uber jar or into a hollow uber
jar there's an ocean of fractions to
specify and configure capabilities and
this valveless form plug-in and of
plug-ins for maven and Gradle to keep in
touch you you have several ways you can
read documentation with it examples ask
questions on the forum or our IRC
channels post issues or there's a
Twitter handle where you can fall thank
you very much are there any questions no
questions thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>