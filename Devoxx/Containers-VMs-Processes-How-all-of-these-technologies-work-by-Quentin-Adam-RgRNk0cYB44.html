<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Containers, VMs, Processes… How all of these technologies work ? by Quentin Adam | Coder Coacher - Coaching Coders</title><meta content="Containers, VMs, Processes… How all of these technologies work ? by Quentin Adam - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Containers, VMs, Processes… How all of these technologies work ? by Quentin Adam</b></h2><h5 class="post__date">2016-11-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RgRNk0cYB44" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay cool
so we start yeah sure cool
so hi everyone let's talk about
containers virtual machine and all the
things for those who don't know me my
name is Quentin enough it will be better
that way so my name is Quentin Adam I
have a weird soda on Twitter but it's a
viable everywhere so it's cool
except on Parker mango if you find the
one who just stole me my my nickname on
Pokemon go I I want to have a
description with him so basically my job
is to manage company called clever cloud
clever cloud is an IT automation company
so so what we provide is a very simple
way to people to just like push the card
and it just ran so people just use this
to keep their apps online the push on
clever clouds of card and we make it run
and the application is that working and
we manage the security fix auto
monitoring auto eating of application of
scalability auto everything basically
and it's very cool company because we
have customers in one thousand and seven
hundreds cities in the world
be customers small timers you know like
small startups banks very different way
to interact with us and we try to learn
a lot of what they do on their work and
how they interact with us and we try to
give back to the community what we learn
so this is a big picture but clever way
safe why are we speaking about
virtualization container and all the
stuff at the beginning computer was very
giant hardware like giant like this room
of hardware but basically we're in
Hubble to calculate a lot of things that
the capabilities of the art were very
slow and to run many software on the
single
hardware we have to manage stuff and it
leads to of a multi-process
multi-process is the time where at the
beginning you know the computer were
just super is where we put things and
the software is running and we have the
answer and then the adware become more
and more powerful so we need an
operation system to manage the software
we ask question to you so we need to
create the operation system to have
multiple process inside as the adware
and one of the bigger thing become the
process scheduling process scheduling is
really really really complicated stuff
it's all we do to manage to have
multiple process in the same stuff sorry
I lose very much
okay and then we invent UNIX UNIX is
what UNIX is the ability we have to
learn how we can make an operation
system work in the good way
so Linux are done a lot of stuff about
how to manage multiple process to run
along each other but it leads to the
spaghetti operating system management
when I spread about this package key
operating system management I want to
speak about like 15 years ago when I'm
doing some ops system you know we have
the servers and we basically install all
the stuff inside the same servers and
the documentation of the server's was
the ops who basically installed on the
servers and there was weird interaction
between several databases application
servers and stuff like that and it's
blow up like every time and we're just
like okay what we can do to improve that
so we start to burn stuff we start to
find a way to ending the outward
capability of you know a server from the
software who need it at a precise point
of the time and to do that we are the
process process is very interesting
because process allow you to process
allow you to just like what what will be
the next thing you will need so just
just giving you an insight about what we
can use as process
no not at all
process I will start quickly a vector
machine and inside it we will you know
work with process no we don't just just
background at this okay cool
launch it I just need it so the process
is cooled because every application run
inside is on process which is very
important to be able to not kill all
those application and not interact with
memory of others application you know I
don't know if you remember is the 19th
where we we can we can interact with the
memory of all that application just
putting some memory inside it so process
is cool because the operation system are
you to be sure that nobody is touching
the memory of another process is
basically how it works so when we go
inside this I have right
a bag of nadjia script we we need and
and we can use it
if I start the server 1 so we have a
server running there in that if I call
it
yeah ball to answer me something cool
but the point is admitting we have a we
have the problem on this error on the
server we can exact stuff running from
this this not system and for example we
can ask for date to be executed or more
we can just change what is the the file
system and with the the problem is the
vise system is accessible because the
process is not isolated from the other
part of the operation system so we
started to think process is cool but
it's a lack of isolation 3 I try to knit
okay cool
isolation is pre module staff first
there is a software dependency
did you remember being mandatory to
reconstitute all the all the dependency
of your system using aptitude because
basically software I need the lyrics ml
to add one version and software we need
Olympics ml to an inhalation this is
problem of isolation between the two
software because you need the
dependencies of the system will be
isolated and not binaries for the old
system the other point of isolation is
about the security like like I proved
the problem if in the process is
available to to just like enter and
write some data everywhere in the system
we will have a problem so we need to
secure a process to be sure it's
contained at what we do and the Artois
resource access
we don't want an application can it the
old hardware is just access from all the
users application at one time and this
three points I basically what we need on
the oscillation part to do that we're
starting to work on something called
route truth is something very only by
built on the 90s but it's very
interesting because it's all you to just
use what you need at a precise time to
easel eight your process so basically
what we can do is
we will moon a root system inside inside
the system so first I will kill my first
application and go on a base system I
built here we build a root system and
first we need to be good to do that
because should need a lot of stuff
building to be wood so I'm inside a hood
so basically if I do pass ox I'm still
on the outward but if I'm looking on the
under stuff I will wear is but anyway
it's not a point I'm inside the hood
what what is really interesting is I can
shoot another thing inside like that for
example I I say I wish shoot inside this
new file systems are basically the UNIX
point of view as all it is on the file
system
if everything is fine if I change the
root filesystem
I will change everything about a work so
system so basically if I say ok I will
need to do a system with I can use
shooting inside it
and I use this to to connect I will
create a system which is is elated
inside a root system which is kind of
different system so if I look at it
there my not judge yes is still really
completely isolated inside it should but
and if I try to do the same thing like
before for example my exact stuff there
I can see I am inside the hood and if I
want to create something it will not do
this inside the real good fight system
but it will be inside it will be inside
the Schrute fight system
I have creates here ok so I can't have
is elated the problem we should is it's
really dangerous you know because
shruti's build inside the system to be
able available to be shooted from
another shoot so you can shoot to be an
route to the preservation of the root
filesystem so basically you can enjoy
yourself and go back inside the good
fight system and this is a very big
problem because you are mandatory to use
root and anyway you will have a lot of
capability so the problem with fruit
downside is there is a weird
relationship with root there is a easy
to break out and more if you create a
new password file inside your Schrute
advice system you will happen to have a
situation where you can maybe be able to
log in as would in the in the first
system without to be root because you
change with its interact to be sure it
will not Apple the the way
Pam and also stuff inside the Linux need
to be touched to manage
good system and it's it's one of the
biggest issue with this kind of stuff
it needs the old new system to be
patched to work and there is no no depth
management like really and there is no
hardware resource management so
basically that's why people jump to
James and containers what is Jason
containers it's all the stuff you have
heard about before but visit Linux best
server
Alexei and you know the new high priests
darker rincey rocket and all the stuff
and the point is all of these are only
used Linux kernel as a runtime you don't
have like real difference of how these
things work
except of how you access them how you
start them all they can get their
dependencies but basically the runtime
is the same for everyone it's just the
Linux kernel basically a container
system is shoot plus Linux namespace
Linux namespace is something introduced
it first in in like 15 years ago in the
Linux kernel falsehood and it's a it's
an ability to make a map for a process
of this you think of this name of know
this name is an alias map of many
resources on the system the moon
resources because you need it on untruth
which is the ability to change the
architecture of a filesystem the PID so
change the number of PID of the old
architecture just at the point of view
for the or file system the user the
network the IPC the date and time and
all of these you can just switch it to a
new you know it's just a map of
traduction just for the process you need
and the other point is the C groups
many people think cgroups our security
it's not security anymore cgroups
is more a possibility to check what is
Hardware resource consumption inside the
system and its ability to just manage
the resource conception of the system
it's it's its main like more for Kota
and resource conception the other point
with Linux II groups is it's not perfect
it's not working like at perfection
because the Linux kernel have to be the
judge and the executor at the same time
and it's not like real-time so it cannot
it can be possessed by a process wanted
to use Android president of the CPU
because it cannot measure it at the same
time so it was a problem with Linux II
groups and
and the Linux capabilities Linux
capabilities is you know there is a set
UID sing inside Linux set UID is the
ability to say this program will use
some ability of high-level permission
for route but the point is set UID give
users access to everything so people
inside Linux kernel syncing it's not a
good idea so they start to try to slice
the authorization of the kernel in two
more small parts to be able to just like
give small parts of authorization to
each people and the capabilities are
basically that is the ability to give
like just some capabilities of the
routes users of the main access to some
programs and it's once does the Linux
capability which is on the heads of the
container security so just to be clear
when we see containers people are seeing
you know a giant metal box and wrapping
things inside it but now a container is
just a Linux process along all those
Linux process so if I try to just like
okay I am running some containers in in
this machine and if I want I can do I I
go inside a a new container and I start
an open to with a bash okay inside it if
I do pass oxeye three I have a bash and
I have a process ox and everything is
it's okay for me but now just taking
sometimes
we will go inside the docker for Mac
shell so yes for people who don't know
it docker for Mac is not native there is
a pure vision and docker for Mac is
using Linux underlying and the Linux
underlying is there oh cool
what's happening
maybe it's because it's just too big in
it okay so that's fun so anyway this is
this is the Linux underlying inside the
system and if you're looking at this you
have all the process running there okay
I would start everything inside another
analysis system like
sorry for that talk you're messing
around I think I have many donations
available yep
so basically I have some processing some
some things here to work and I can I can
run something like dr. Ron castle ha
just to be sure we have many process
running it will be just a little bit
time to just like catch the old gas on
high images no can you keep tickets
no you don't want because you know to
complicate it I don't know why it's so
broken here very weird
so no not yet I have to find everywhere
where there where there is the screen
open and it will work but anyway so you
talker is running and if I do a best ox
system what we can say is there is all
the stuff running inside your container
and there is just only process along
each other so it's just Linux processed
with special permission the problem with
this is the ease elation and the
side-effect of the insulation will be
not so good just explaining you what we
can be happening is so for example I
just run inside the open to I start
there but what I can do is launching
just a fork loop just give to the
container a problem to manage the
problem is inside an operating system
you have a number of find a script or
find the script or is something created
each time you open a file and ASRA in
unix everything is fine so each time you
have a process running you have a file
descriptor and the point weighs file
descriptor is you can add unlimited file
descriptor append so you will have a
number of i descriptor you can have and
the point is this number is shirt in the
old operation system so what's happened
here is if I go inside the Linux system
of the the the doctor for Mac and I try
to have docker Alps I see there is a lot
of Ruby process running there and in
just a few min in just a few minutes I
will not be able to
you I am not able to do that because you
don't okay the program is fine
descriptor are putting more and more I
will not be able to open more five so I
will not be able to open a new SSH
connection I will not be able to use a
new command line inside it because the
file descriptor resources will be full
at the old operation system which is one
of the side effects of using a whole
operation system for things you think
it's really separated another side
effect with that is you can escape for a
container if you go and watch this
YouTube video because the the act a
little bit of time you need to re-encode
things inside the memory and stuff like
that but you can escape for don't care
container and go back inside the Aust
because docker container rely on only
the linux kernel to be safe and the
problem with that is if you have an
issue inside the linux kernel you will
be able to pop up to the linux kernel
and to the asked like from yourself
without a problem and it's just a pan
like that occur was two weeks ago and
it's it's an issue inside Linux kernel
who who is able to give you some
privilege escalation stuff and this is
one of the biggest problem you can have
with your containers but there is many
way to make your system with a problem
for example inside a docker host all
your container will share the same
source of entre P you know entropy is a
hability to have some random numbers so
if everyone is using the same source of
entropy you can you can have situation
where you can predict what will be the
next one dam number for all those
containers in the system and basically
crack the crypto inside the system
and there is many although there's
system-wide possibility of face because
what you are running there is using
Linux at the boundaries of what he is
doing to do launching thousands and
thousands of process in the same time
very different with different binaries
is really really really stressful for
the system so you will have a problem at
a time and that's why and this problem
my most is the same for everyone on the
containers on the container way the
other part is more like photo here do it
respect the Linux philosophy when we
created annex we say okay it will be
kiss keep it simple and stupid the
docker binaries today is a reverse proxy
an orchestration system system will
launch daemons and ability to manage
containers I don't know if you can boo
you coffee but you know it do everything
it's it's a fat binary of fourteen
megabyte and we're just like okay what
you can do more is it a really great
idea is this the same people to say to
me you need to do some micro service and
have only fat binaries we do everything
and the other problem with the managing
process one of the problem with docker
is in managing the process inside the
operation system like he was a PID one
but it's not a PID one so basically is a
fight with system day all the time to
managing the process if you want to
managing the process it's okay just
launch and stop the process if you
please to do that the problem is
managing the process is not the only
role of the PID one the ID one have to
clean the zombie process two and it's
another problem inside the container you
the process you launch first think is a
PID one so busy
nobody inside the container is in charge
of cleaning the zombie process and all
the you know we'll stuff PID one is
doing so basically you are just running
an operation system without a process
manager and I think it's it's a big
problem the other part is a container is
all the operation system except the
kernel when you use the GFC and also
stuff like that you interact a lot with
the camera and when you use the curse
saying it will be exactly the same thing
running from the developer computer to
the production it's really not true
because on the project because on the
computer you're using the Linux kernel
of Dhaka for Mac which is pretty
particular and when you're running on
the production you're using I don't know
which kernel and you will you will put
in prediction and tested combination of
JFC kernel and all the low-level stuff
so I think it's a little bit complicated
only other part is the monitoring
you cannot monitoring a container from
inside it you need to be outside of the
container to understand what is running
inside so you need to read rebuild the
old monitoring system to be able to
reconfigure in all the time so it's
complicated
we are in the in the boundaries of the
Linux system it's really complicated to
just like manage that in the right way
so the search is not over when when when
we are looking for what would be the
next thing in in the emulation way there
is one guy who have right q mu q mu is
something very interesting
which is able to emulate a full CPU
inside inside another computer so you
have a software CPU and you can run
another operating system on top of it
and it's very cool because it seems to
have a new CPU so you have basically an
entire virtual computer inside your
computer then from another perspective
also sky at this time working on them
then was the power of utilization stuff
so basically they write a very tiny
kernel tiny operating system and they
they do a big patch inside the Linux
system and you will able with them to
launch a Linux kernel to just like run
stuff on an exam and then we'll hollow
you to have multiple Linux kernel
running on the same CPU staff and staff
become faster when Intel introduced new
instruction of the CPU called vertex V T
X is a set of CPU instruction will give
you the ability to run to operation
system on many operations system on the
same CPU without they knew each other
was running so the virtualization is not
about software it's about hard work and
what it's cool as the physics are you to
just run some operation system who don't
know all the stars running
among each other and a vertex can
control the access to the Edward when
Intel creates this at the beginning they
were they were showing you big the
computer with only one CPU and many
network cards because the thinking
people were by a network cards by Vitra
nation but basically it's not like this
we do we have an internal network stack
and we we use the same networks
same network card for everyone but the
basic idea of Intel when they do that
was using plain old operating system
inside the same physical risk advisory
sources and when we have look at that is
really interesting because the
insulation and the VM perspective is you
have the full software dependencies
because you can you can have a full
operating system for your application
there is a full security system because
the security is guaranteed by the
hardware and the hardware resource
access is guaranteed by the hardware
also so the isolation is perfect so why
we not use it because people are
speaking about performance who think
virtual machine is slow because you're
using Amazon Web Services starting a
virtual machine inside Amazon Web
Services it's taking you several minutes
at favorite cloud when we start of the
actual machine from the moment we ask
the orchestrator to build a virtual
machine to the moment the virtual
machines start to work for the customer
it's only five seconds you can have
really fast vector machine little
machine can be really fast if you're
doing it right and the point is that
with references yes what is the really
bound you have many people think CPU is
important of ham people thinking the ham
is important but we don't have problem
of boundaries of RAM anymore we have
memories it's not a problem the CPU is
not a problem to burn your CPU you have
to get really complicated stuff so the
problem is the input/output system and
the input/output systems the storage and
the network is where we need to have
performances and it's basically where
the termination are very present because
there is a native system using directly
access to the to the hardware you can
use
machine so just Childress's your fight
and starting to learn something new
about servitor nation the other part
with all of this is a linux low-level
dark magic many people using containers
of surprises because there is many
low-level dark magic inside Linux and
containers using a lot like for example
speaking about ALP in Linux
do you know alpha Linux do you know why
helping linux is so light now open linux
just rewrite the jdbc you know the
library everybody is running relying on
is revised by the people of IP linux
first on microsleep see and no unmuzzled
so basically when you're using alp in
linux you're just using another central
part of the system nobody is testing
there there is a software against for
example in the Java community nobody is
trying to compile the GDK with missile
because we don't care mostly just right
by I don't know 10 guys so it's it's a
dark magic of of Alvin Linux and you
need to be aware of this kind of stuff
the other part is the dependency limit a
monolith if your dependencies are
managing stuff to be like if you have
some differences you have to maintain it
and if you think about it if you could
have some dependencies it's cool it's
your card but if you have the libraries
as dependencies it okay so you're doing
a spring boot application you have a
Gradle build stuff and all your
dependencies are there why putting the
all responsibility of the OS to the to
to the cuddle dependencies because what
you do there is asking the developer to
enlarge the full stack stack of
dependencies to the old operating system
and for this the problem is developer
don't do updates on libraries why they
will do updates on the operating system
this is dangerous
and if you're thinking about that is if
you're using container that way you just
using giant binaries everywhere so just
to be clear about something else
they will never have something like
docker for Windows running Linux
containers you can start a virtual
machine inside Windows and run enix
containers but as docker is not semantic
docker is not knowing what is running
it's just a giant binaries at each time
you will never be Hubble to run the
Linux binaries inside the windows
because it don't work and is it likely
why when we see when I see docker for
Mac is native it's not real docker for
Mac is using a Linux kernel underlying
inside a very clever and a very amazing
pace of technology which is the
virtualization of docker for Mac because
it's this part is really amazing but
it's still visualization because you
need a Linux kernel to be able to run
you your Linux binaries so just just to
be clear just giant binaries everywhere
and they were parties just like when
you're thinking about going to DevOps
DevOps is not developer making the job
of ops its developer working with ups
when you go in the 12th century in a
castle there is one man this one was the
man speaking Latin doing atomist
and which was a doctor basically it was
knowing what humanity and all the
mankind was doing
if you're going today to have the brain
surgery launching a rocket on the moon
or fixing your car it's not the same
people you ask because it's not the same
job
I've developers making the jobs of ups
is not the progress
it's a regression it's against the in
story history going to specialization
with people knowing better the staff not
people doing the job of many houses so
when you do DevOps is not like developer
putting doctor and prediction because I
don't want to work with ups so just put
the current prediction I don't care
because you will have a problem so
please remember after tall containers
and virtualization is not the same thing
and containers are not like mayhem at
all and it will be a really dangerous to
sing that the container is elation is
not okay for running so practical and
it's basically like running large PHP
mu-2 a shared system you know you can
buy it for at OVH for 1 1 euro
Spearman's and if you want to be a
doctor special it's no problem just
start reading reading the kernel or it
is nuts because you need to understand
all the Linux kernel is working inside
it so thank you a lot for listening me
and if you have some question Amir</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>