<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Writing an InfoQ mini book with Asciidoctor by Matt Raible | Coder Coacher - Coaching Coders</title><meta content="Writing an InfoQ mini book with Asciidoctor by Matt Raible - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Writing an InfoQ mini book with Asciidoctor by Matt Raible</b></h2><h5 class="post__date">2017-04-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_1QzrojHnic" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right we'll get started thanks for
coming my name is Matt rayville grew up
in the backwoods of Montana no
electricity no running water of 16 years
had to walk two miles to the bus stop
every day sad story of a kind of fun so
writing a book is hard if anyone ever
has written a book how many people have
written a book okay so about half the
room it's enough you know trouble coming
up with the idea but then the actual
writing part is is pretty difficult in
my opinion and a lot of that is because
getting in the flow right and having the
tools to help you get in the flow and
basically get out of you know
distraction mode so you can do it in
word in the first book I wrote was back
in 2004 and i did in microsoft word and
you know i sent it off to editor and
they turned on track changes and then
they sent it back and you know we went
back and forth a bunch of times and it
works Google Docs is much better but
they still both suffer from the same
problem that is if someone turns or
doesn't remember to turn on track
changes or they don't remember to do
suggest changes in Google Docs then you
basically lose that and there's really
no history in there I think Google Docs
does a little better idea but you all
know that you know Microsoft Word is a
binary format so you're not going to be
able to see what changed and copying and
pasting code and images into Google Docs
is easy just like it is into word but
what happens when you need to change
that image and you've used it several
times throughout your document or
throughout your book chances are you
can't just search for an image name
right because it's just a blob so again
tough to maintain and so it's really
hard to basically maintain those
document formats and I know this because
when I wrote the spring live book back
in 2004 we did 11 releases and over
those 11 releases you know there was
just this word doc that went back and
forth and you would hope that the editor
turned on track changes for everything
but you'd never know like if they
deleted a paragraph or something like
that you just wouldn't know so as
writers were often limited by our tools
and chances are if you've written a book
and you've done in microsoft word and
you didn't experience the pain maybe you
didn't have to update it but there are
better ways to do it and ask a doctor is
one of those ways and there is some
confusion that I want to clarify there's
two things there's a ski dock which is
the actual syntax you'll use and there's
a ski doctor which is a ruby tool to
actually generate you know the outputs
so it's an open source implementation of
a ski dock and Ruby it's basically a
fast text processor and publishing tool
chain for converting ask a doc to html5
docbook and many more PDF mobile as well
as kindle and we've even done a ton of
work to make it work as a print book so
now what we've been able to do is
self-published pipeline going that no
one really has to get involved except
for some editors so you're right in
plain text import your code and your
images or you copy and paste your code
into the to the actual document and then
what we found is it's easy to do code
reviews and copy editing right using git
and it's one of those things that you'll
probably encounter people that do to
copy editing for you that have never
used it and they're probably not going
to want to use get right but you can
introduce them just some tools i'll show
you that makes it easy for them to use
git and so at info q my editor had never
used it before but he was a tech savvy
guy and he was using it you know within
a day and when he would create pull
requests maybe there'd be some issues or
maybe he would you know delete stuff by
accident but you're using source control
so you can always revert from that and
like I said you can publish in all those
formats so the beauty of less cost last
weighs less impact right versus the the
Google Docs or the word formats and when
I went to write this for info queue at
the end of 2015 I had a goal to write @j
hipster mini book and the reason for
that was I'd done a lot of work with
spring boot I'd done a lot of work with
angular and J hipster kind of combined
the projects and as an independent
consultant at the time I wanted to
market myself more and so the beauty of
a mini book for info queues it's only
like a hundred pages right and you don't
have to write the complicated stuff so
if you know something about a framework
or you know a particular hot technology
you can probably write a book for it and
if you're good you can probably do it in
a month or maybe you get your employment
or actually let you do it you know it's
part of your job so I chose a ski dock
because I want
to be like an open source project I
wanted to be able to you know use git
and and use my ID and use the tools that
I was used to writing code in to write
the book in especially because i was
writing a bunch of code for the book as
well and i kind of didn't want to switch
you know to a word doc and then back to
my code and stuff like that so there's
this ask a doctor to all example that I
used as a starting point and you can see
here there's a there's four dec jaya
sores epub 3 github pages so all those
but i wanted to do everything right I
just didn't want HTML I wanted PDF and I
wanted you know the print version and
all that oh now you lost it
and I use JIRA cloud to create my task
organized sprints and track progress so
that was just a personal thing for me i
could easily used like the bit bucket on
actual issue tracker as well I chose big
bucket to store my source code in
because I didn't want it out in the open
alright I wanted to be private and
bitbucket has private Rico's github
costs money for them and so that's where
I hosted the source control and I used
IntelliJ to write it and browser sync to
basically see changes immediately and
there is good enough tools now with in
IntelliJ that you actually don't need
what I'm going to show you like this
processing stuff but you still can use
it if you don't want to use you know a
particular ID or a particular plugin so
at the beginning when I took this idea
to info q they said you should use word
or Google Docs and then they agree to
ask you doctor just because they were
nice folks right they were like
basically you're going to give us a PDF
and it's going to you know take us a
really long time to convert that PDF
into epub into mobi and you know get it
out there and we probably won't be able
to print it and but you know we'll try
it's probably going to be the most
expensive book we ever created and then
we actually figured it out and it was
one of the first times that they'd use
this tool chain and they were amazed
because guess what they didn't have to
get any production people involved all
they had to get was an editor involved
and then the guy who actually created
the artifacts that they upload to the
site was me right and so that's pretty
cool because you know you eliminate this
whole bottle neck of people that may or
may not have time to work on it so then
I took that template from the book and
created the info cute mini book project
which is here on github and so you can
see you know the steps to build all the
different things so when we started we
had one process that would basically
build the the PDF and HTML and
everything like that but when you're
editing you really don't need all that
all you needs like the HTML version
right you don't need the PDF to be
regenerated every time so we ended up
creating you know little bash scripts or
everything but it'll output a number of
different files an index file for html5
a PDF pre-press and a PDF screen so the
default is to print the pre-press one
which is a PDF that has Marge
and stuff like that because if you print
a regular PDF like we sent the first
version to Lulu and guess we get back we
get it eight and a half by 11 like book
right with big text in it and the
margins are all whacked and stuff like
that so we had to adjust a lot of things
to actually get the margins to look good
to get the Print to be smaller and get
it to be like a six-by-nine book so then
dan allen is the founder of ASCII doctor
and and he works primarily on that
project his company opened / o does a
lot of documentation help for companies
and provides consulting on that so he
was great and really helping out in folk
you and myself in like figuring all this
out and having you know the different
PDF renders and an ascii doc FX was
probably the biggest reason it worked
for the editors because editors you
can't really say download IntelliJ and
run it I mean you can but they might be
a little intimidated versus ascii doc FX
is just this app that runs on javafx but
they don't know that and you basically
just open up files and it's got you know
the text on the left and then the
rendered version on the right and they
can see everything so for them it's very
easy so this is what some of the code
looks like and i'll go through a live
demo here but basically you just you
know you have paragraphs with just you
know breaks in them and that creates
paragraphs and then for source code you
can specify what type you know HTML
Javascript probably even type script
might be supported now and then this is
a way of giving a caption to an actual
image or a source code so I felt this
was nice because i always mention like
files that i'm going to edit up here but
i never want to specify the whole path
right so i think it's nice to put you
know that caption next to it so people
can see that and then down here you can
see there's a java version so if you
were to start with this project and
create a book you would clone you know
my github repo and then you'd run Gradle
w followed by Gradle wwatch and what
that does is a watch all your files and
sees if anything changes and if it does
it recompiled everything then you'll
install node and you only need note if
you want to do the actual building of
you know in browser sink and
refreshing your browser it does that
with dope and then you can use whatever
editor you like if you want to use
IntelliJ or just you know VI or Adam or
sublime text those will all work so let
me show you a quick demo of what that
looks like so here's the info cumin
ebook and you can see it's got a whole
bunch of files in it and basically what
happens is i want to show you what's
going to happen when you download this
project and try it for the first time so
i have to unset one of my environment
variables and then if you do you're just
like okay you said run Gradle w/o it
actually worked you should get an error
that says I can't find kindle gen so
that's one of the things that might
happen to you that's why I have this
build is h that sets kindle gen there it
is all right no file to load kindle gin
and that's because I haven't automated
there's like one open issue on the
project where you can automate the
downloading of Kindle gin for generating
your you know movie files and and I
haven't done that yet so if you use this
script then it does it for you so build
sh and it basically cleans and builds
everything and then all the docs end up
in this docs folder here so ask a doc
and then chapters and so many books are
typically really short right there only
like maybe a hundred pages so I just
have different chapters chapter 1
chapter 2 in chapter 3 and you'll notice
here this is the ASCII dr. plugin over
here that's rendering my pages so when I
originally created this they had a
plug-in but it wasn't that great like it
was based on the markdown plugin and so
that's why I use this technique which is
the watch and then gulp
okay that's watching this is not
building come on go mark all right well
I don't show you that because there's
much better tooling now where you can do
are there we go so it brings it up in in
your browser and basically if you edit
anything it'll show up in here that's
just you know a feature browser sink so
this is just the the intro and
conventions from my book so you'll
notice I put some two dudes in here like
replaces with yours if you have anything
then of course your dedication
acknowledgment the ISBN number that
you'll get from info queue and then the
chapters are down here which is you know
just empty at the moment so we went into
chapter one we said put some code in
there what you write a book can be
published these tools like I said didn't
exist on the right side when I
originally started this so you know now
that's a much better experience than
flipping back to your browser and make
sure it's in there right and so you can
also do code so this is kind of a cool
feature you'll notice it doesn't render
in there right it says hey unresolved
directive on the right side we go back
to there and it does work so there is
still some advantages to using you know
the browser sync tools and doing it that
way there's also some cool stuff you can
do where you can do like 13 and just
includes you know the first four lines
sometimes I forget the syntax maybes
three of them but what I found is the
problem with actually including files
and doing you know the line numbers that
you pull in is chances are when you
modify your source code it's not going
to match with what you have in your text
right so then what you have to do is you
have to go through all of your ASCII doc
files and figure out if the right code
is in there so what I've started to do
is just copy and paste the code into the
ASCII doc file because you want to be
able to dip it and you want to see what
code changes so it's it's not a great
scenario but if you're going to pull in
specific line numbers I think it's
actually better to do it that way if
you're going to pull on the full file
that's different right because that file
change and you don't worry about the
line numbers as much right that's
another thing I've seen is a is that is
in another ask you doc project I have
where you can put tags in there and then
you can just specify the tags so in your
source codes ends up with these tags but
you know they don't get seen right so
works out pretty well so the editing
process we went through is we just share
your git repository with the editor
editor creates pull request by section
so if they did chapter 1 or they did the
acknowledgments or whatever and then you
know you would work on collaborating on
that and like I said because the editors
aren't typically get savvy you do have
some hand-holding that you have to do in
the beginning but then you just accept
the pull request emerge for the
publishing process you need kindle gin
and you run that build sh and this ascii
dr. PDF extensions i want to show you
because there's some things that you
have to know about that so this is in
maine Ruby and I just hard coded some
stuff in here so if you were to use this
template you should know that stuff is
hard-coded and that is you know if the
section idea includes chapter for these
their chapter 1 chapter 2 and you'll see
up here that's the ID that it gives so I
just look for those names and if those
are in here then you know go ahead and
process this part and so for media
versus pre-press it does some different
positioning of the text and then for
these ones it creates a different
section header so if we look at the PDF
that's generated I go to generate it so
they can do generate PDF screen it
actually has section breaks between the
different sections so that's what's
going on here this is a golden
opportunity for any of you that would
like to contribute to open source to
take out the hard-coding if you would
like but you know it's just this is the
only real hard coded part of this file
there's some other stuff up here that I
was just kind of lazy and I was like if
it's a dedication or acknowledgments
then Center it and put a bunch of lines
on there
because that was in folk cused way of
doing things so now we have this PDF
screen if we open that up of course
you'd want to change the title image
right this is just the one from my book
that I left in as a placeholder but in
the in the sections it's got this kind
of syntax and that's just that's for
info key right that's a style that they
did for their books has have blue and
green and then the chapter name and then
you know moves on from there so that's
the part that that does and I mean it
was kind of cool because when I when I
did this project I knew that a ski
doctor was capable of all this stuff
just because you could hook into the API
with this ruby file and actually over I
things and it was cool to really see it
come to fruition without Dan Allen's
help I probably couldn't have done it
because he really knew the API well and
was able to go in there and change all
this stuff where is my presentation
there it is
and then the Lulu printing thing is new
and I think there's a couple other books
that info Q is use this template for so
you can print it on Lulu and it comes as
a real book it looks good and we went
through like three or four iterations
where they sent me a copy of the book to
make sure and now it's a six-by-nine the
font looks good the margins look good
and and it's cool because it's like it's
140 pages like that thick like it's a
real mini book right looks like one so
that works well if you're interested in
writing you can talk to me you can talk
to many books at info q and there's
author guidelines there and basically
you retain the copyright so I could at
any moment open source of this book
right at any moment put it on Amazon
under my own name and they don't really
you know care too much but you do grant
them an exclusive right to publish the
free online version and then if you want
them to remove it they will so you can
start writing on info qcom I'll take any
questions but I'd also like to discuss
if anyone's thought of it the process of
open sourcing a book like this I would
love to open source it but I'm afraid of
people like taking it creating PDFs like
selling it in other places right and
then there's all these different
versions around and how do you manage
something like that so first of all
questions
so Dan did most of that and and I
certainly helped him and you know he
gave me some guidelines so it was
probably six or ten hours right it
wasn't too bad but it was was painful
because it was like at the end right and
you're trying to push it out and that
was the other painful thing about in
focus I did a second revision of the J
hipster book this last summer and it was
done in November and they wouldn't push
it out for another month because they
already had a mini book going out and I
was like man if you wait too long it's
going to be out of date and so it was
published at the gang December J hipster
for came out in February and so I had
like two months whereas up to date right
for the editing you could use it just
like I used IntelliJ right to write the
code and then see it on the right and a
lot of times you need like dual monitors
for this kind of stuff right so you can
have your code and then your text and
everything
right and there is an excellent ASCII
dr. plugin on google chrome so let me
demonstrate that this is already built
but if we were going to like the source
code info cumin ebook and it's even a
better one to look at the presentation
and you were to go to you know one of
these files like index and you view the
raw version this plugin up here you can
disable it or enable it and then you see
exactly how it's going to look so that's
a pretty handy plugin I just didn't know
about it at the time right but also the
difference is they can't really edit
this file right there looking at it
versus having it side by side right and
we kind of went back and forth with like
github comments you know or pull request
comments versus like comments and the
code and stuff like that I'm just trying
to figure it out you know what works
best for that it or because we as coders
we can figure out most things
I mean you could do it in VI right you
could do it oh let's advantage in poke
you I mean I've had a lot of editors
right over in a few books and and they
helped me a lot right I've learned a lot
from them and just the style of writing
and stuff like that so even if you
weren't going to do it for a company
like in poke you I'd recommend like
having a friend or someone that's an
English major or something you know just
look through it because there's like
talking in the wii voice we're doing
this versus you do this alright so
there's good things I've learned from
having editors but if you already have
like that kind of background then maybe
you don't need one and you just hope the
open source community like contributes
back and tells you what you should
change you know and the one issue with a
ski doctor has like a documentation
framework for projects if you had an
open source project or something like
that it does run around github it
doesn't render as good as Mark down but
the HTML like if you did something like
this and you generate an HTML version of
this book it's one page so that can be
pretty heavy and they're working on
fixing that but they haven't yet versus
you know PDFs find to be big but not
really HTML well thanks for coming more
questions please that no one's leave it
yeah I don't know I mean I think in that
and you know over in some countries they
just might ignore that stuff right as
far as open source yeah yeah well the
one thing I've seen that pragmatic
programmers does well when they
distribute books is they'll put your
email at the bottom so that's one
technique right you at least know who it
came from but then you'd have to
basically generate a book for everyone
right it's like an annotation tool or
something right
I mean it wouldn't be hard but still be
kind of painful you know yeah
what's basically have you ever worked
with mark down so mark down in ASCII doc
are very similar I tend to like ask you
doc because I did a whole book in it and
so I know it really well now but you
know I do mark down as well so I think
it's good you know to collaborate on
using it on any sort of document because
you can see the discs right and you know
that people haven't changed much but at
our organization we're still having
trouble getting like our editors to
actually use it because they like Google
Docs but what we do is we actually copy
the markdown or the ASCII doc into
google docs just raw and then make them
edit it there and then you know we can
copy it back we can see the disks and
github and then go from there so it
works pretty well
sooo saying don't wrap the don't have a
big long sentence like wrap it at 120
characters or they're right yep that's
good point because when it renders in
the diff it's like that long if you
don't break it you know and it doesn't
kick right right it was mostly for the
editor and I was already a job editor
for in Tokyo and so it was just kind of
an opportunity I felt that they would
you know give me good publicity and you
know market it well don't know if I
would say they have but they do send me
books to take two conferences I just
forgot to bring in here so it was I
already had a relationship there and I
didn't really have to establish new one
and I was kind of you know if they had
said you have to use word or Google Docs
I might have been like okay nevermind
I'll go figure us out on my own all
right thanks for coming</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>