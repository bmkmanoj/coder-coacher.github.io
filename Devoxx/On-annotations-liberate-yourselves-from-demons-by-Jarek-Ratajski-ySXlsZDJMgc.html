<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>On @annotations   liberate yourselves from demons by Jarek Ratajski | Coder Coacher - Coaching Coders</title><meta content="On @annotations   liberate yourselves from demons by Jarek Ratajski - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>On @annotations   liberate yourselves from demons by Jarek Ratajski</b></h2><h5 class="post__date">2017-08-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ySXlsZDJMgc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Christo's is on editorial it means I can
start and by the way he has great with
huazi they have great presentation to
the evening which is about something
completely different but it's great so
first of all I will show you a couple of
things about myself so I live over the
lake under this mountain mountain it's
beautiful place and yeah work for a
company called CSS insurance
I am developer without an architect I
mostly work with Java based technologies
and if you for some reason like skiing
mountain bike general you love mountains
you like to swim over the lake
yeah you like all that stuff yes we are
hiring and there is one trick about it
you need to know German there are people
I know that think life's too short to
learn German now there is a trick hack
to that life hack I can show you who
knows this map or air quality index so
you know I won't just comment it comment
it much but just take a look at the
place where I live so it's right here
right here and wirelessly here is the
closest point they don't measure any
position there but it happens that you
will see something like 15 there that's
here is tarik for instance the most
polluted place and you see if you know
typical stay state from from Krakow you
see the difference so that that's the
way how you can win couple of years and
devote maybe one of them to learn German
but just a hack because maybe it's worth
it so that's the company
CSS positional insurance and ok I won't
be talking about myself for long I will
be talking about this
this is the machine I started learning
so who knows this machine commodore 64
and you pro i program i won't sing a
song about that re because my voice
today is not great but okay so this is
how programming on komodo looked like
like my first weeks i was programming
with basic and you know what one thing
is great about basic if you want to
impress colleagues with basic you can
just hack something very quickly like
you had a couple of lines you have some
nice effect whatever i want to show you
today great effects because i don't have
that much time but it's really a couple
of minutes and you do you are done so
for instance here my intent was i show
you basic and i want to greet you
somehow and there is a procedure in line
line 5500 you see already great thing
about basic you don't have to invent
names you spare a lot of times because
you don't have to invent names of the
procedures of functions
you just have line numbers how cool yeah
and then i will want to greet you three
times go sub means color process or go
subroutine it's simple so i will greet
you three times and we'll see what
happens first time hello the box was
what i in the wanted to do but then
hello hello that works what is this
who knows where is the back in this code
come on you know basic everybody knows
basic name is global and that may
exactly does the problem and that's the
great part of the basic you have
everything global so you don't have to
worry you just can access in every line
every variable and it's very fast if you
say a lot of time until the moment you
have back but if the program is like
thousand lines long you just read all of
them and you see quickly the back and
you are done and you are very fast but
there was a moment maybe two weeks after
I started programming when I reach these
thousand lines of code and I was
starting to do something bigger and then
I realized oh my god
basic isn't that cool anymore
so I was thinking about switching to
some other languages so in the mean time
for instance I switch to see because
what you have in C language you have to
declare variables not every net and not
every variable is global it's cool it's
also about problems so I switch to C but
then I had after couple here's some
problems with C because C was like oh my
god how to encapsulate thing you have to
remember what to call us which function
after another etc so I read about
object-oriented programming and slowly
through c++ i switch to java where i am
still and one thing about java is great
because in Java you have encapsulation
object-oriented things etc so just take
a look at this code in Java we have
great frameworks don't simplify our life
so that makes some things easier so
let's take a look at this code and maybe
I will show you that in a in my IDE so
oops right here so I want to write
simple service and this is a rest
service it is done with spring would I
have funny controller where I have under
this name hello I have this method hi
with I check for the parameter knowing
who and then I use this who bean where I
said set name and then set time then I
lock something
greetings done and done I call this give
me greetings so let's just take a look
what the who is who is this bin
string name local date/time getter set
us nothing interesting here it is funny
so what is the service these me
greetings simply says greetings who get
name who gets time easy so it's like
this if I call this service so if I
restart this with spring boot let's see
it works just a moment
somehow there yeah I am restarting the
Dom Spring is working spring it's great
I have everything so just take a look
once again on this whole set name name
time logging something and then give me
greetings it should be obvious what we
see on the screen but if I if I write
here something like who is deaf ox then
instead of greeting greeting devoxx I
see surprised who knows why just the
moment like let's take a look at this
code we can also store it not this
screen yeah
once again maybe I will just print a
line here I will do it println
system.out.println oh my keyboard
doesn't work anymore
today sis then oh yeah
what I laughing some println come on
and who this may be I switch to pink
mode and my keyboard doesn't respond but
doesn't doesn't matter okay i will
restart it
who gets name okay
but on tadam once again I call it 3
control refresh surprise ok and then I
go to the iai windows you see the box
was here but print is dead works so
the problem is it's devoxx this is the
distinct but then it's surprised what
has happened so I you know what has
happened with this cool framework it's
possible to change Java to basic
anything can be global and the thing is
that here I have something called logger
where I intended to log a message but I
also wired this who and because I was
evil
I set the name to be surprised how cool
so it's exactly what can you do if you
want to be efficient if you want to be
efficient you do everything go Bali and
you do a framework that makes it easy
for you which changes Java to basic it's
cool it works you can really impress
your colleagues and it works very well
unless your program is not longer than
thousand lines but because later you
have to look for those things and you
may think it's very artificial joke you
wouldn't see that in production yes
exactly
such things I find on productive systems
especially this kind is even my favorite
will when somebody works with something
which is so the who is requests code bin
who is using request convinced just
raise your hands nobody I don't believe
you because I see this session scopes
bins all of them are basically global
and basically bins in typical bin in
spring is just global singlet and ones
ok so that's just a beginning of the
story and we'll go further to to
container dependency injection so
basically you use Java EE or spring to
do letting the dependency injection who
is using spring or Java EE to do
dependency injection a lot of you cool
and then let's take a look at some code
so for instance this code this is the
user activity logger something again
based on some real sample I inject user
repository here then I have this method
store activity I call safe
how cool user ID action and then
somewhere in the code I see this new
user activity log in my user store
activity log who sees the back here what
yeah now point and why yes you know that
because you know if you have inject or
something like out of wire or ejv or
whatever the be in this class cannot be
created with a new new is kind of
forbidden for you so you learn quickly
that all your being all your classes
cannot be instantiated by new anymore
they have to be beans they have to be
created as a beans by container how cool
also we know that new is kind of broken
then a second problem let's take a look
at this this is all something we have
something scope request scoped user
activity logger user repository so we
logging some user activity but because
it's not really important for the moment
we don't it's just some kind of lock
maybe you wanted to do it in a
background so we wanted to do it a
synchronously so we call some executor
service and we call this user activity
store exactly store activity in a task
which will be called a synchronously who
sees the back here yes so basically if
user repository uses some session
persistence context it would file
basically you learn while using
dependency injection container you learn
second thing you cannot use stress
because threads are kind of broken they
don't really work well because your
transactions security context etc is
broken how cool
so the third third thing you learn is
that objects for instance who knows post
can't construct or things like that
method what is the post construct so you
have a constructor which in
object-oriented programming means the
after constructing object it's useful oh
no it has to go through post construct
to be really
it's how cool so we have our life cycles
of object which is not as simple as
before constructed and use useful now
constructed partially useful then after
post constructs etcetera really useful
how cool and there are even more if you
look at EJ be scopes it's really crazy
what can happen so the next thing I see
inner projects if you can inject
anything anywhere you will see this
example then quickly you have a classes
that for instance has 15 dependency
injections like Auto why it out why it
out well so it's really I see that
numbers in the real projects how cool
because it doesn't cost you anything you
just inject and then you get a help
furnishing about it if you have a
problem it's like in basic you can you
cannot be back it easily you have to go
to the runtime and just see oh there is
some of the bins is null why where you
put the the back line to find out why
it's now why it's not injected the code
is not even it's not even your code it's
some container how cool and that's
that's what I really like in Java you
have getters and setters everywhere
because we love to write such useful
code getters and setters for the win
like and then we have mappers one day
now our company we had a exercise where
we were doing we did our task was to
find some ugly part of the random code
project and refactor it it's cool
exercise to do and the funny thing was 9
awful of out of 30 10 teams randomly
found ugly part of the random projects
to be mapper something writing from
getters to set us how cool then we
arrived
ok maybe 90% of our code it are just
mappers and the broken encapsulation
that the problem yeah you can you can
inject everything everywhere you can
change and even though with this who
example name was like private field in
some kind of bin and you
I wasn't even passing this bin to some
service but this service get this beam
injection injected that could change it
how
so but maybe some of you know okay a lot
of this problems live with a synchronous
calls can be solved with just one
another annotation like if you want to
call something a synchronously there is
for sure somewhere annotation in Sprint
how you call a synchronous task I
forgotten it for the moment because I'm
mixing it with with Java EE annotation
which is due to be different and there
is annotation for everything you want to
do so that's cool
the problem is that's not Java anymore
if you don't use new you don't use
threads you don't use normal JDK you
have to use special another book read
another book with another language
language of annotations hopeful and the
thing is that what it really resembles
me like I am doing Java EE and spring
for 17 years really started with JBoss 1
how cool and at that time the
development maybe you've heard it from
your other colleagues was Java
development was in fact XML development
we had this big XML files and everything
was configured in XML and in one moment
I've seen okay we have annotations how
cool Java files are notations no no no
XML anymore how cool but then I realized
oh my god this XML is gone it's just now
embedded in Java code
it's called annotation but it's the same
same exam I'm writing in the second
language which is not really Java okay
so is there any solution for that
because I'm bashing something that's
really most of you right with that so if
you look carefully there is one great
post from Oliver Gierke done couple of
years ago about field injection bins
evil who knows this great so he simply
said if you have this code like inject
my collaborator then this code is
basically surely wrong because it might
work but it's like begging for line
point and exception because where do you
put the back line how can you check that
the bin was injected so he proposes that
we should write always container based
injections like this inject my component
collaborator it's a little bit this
and it's better for sure I do agree it's
way better right now we can put
somewhere our constructor we can also
put a session and in this post
Oliver gurkha is one of the outer spring
you see that this constructor based
dependency injection is means better the
stability yes you can simply create in
test this class without spring context
you see if you have too many dependency
injections in one moment you see oh my
god my constructor has six fields so
it's the moment where you start with
factoring not in the moment you have 15
and it's too late so it's cool it's way
better encapsulation because after a
construction you have really useful been
typically you then you don't need post
construct that much so there is this
great post Y field injection is evil I
do recommend it if we it's small and
it's great but I think there is we can
do better like this you see it's like in
the on this Oliver gear a post but with
one difference there is not this inject
there is missing this inject and it's
better because then it's completely
plain Java it works all the time without
spring context it is just compiler which
is prevent works works which works with
a keywords new perfectly and maybe some
of you okay but what if I have this six
dependency ejections like there was a
post on some Polish forum called for
programmers net which is like Polish
version of Stack Overflow
and one guy presented me this sample
magic service and then how many
injections 16 Jackson's and he said oh
come on how would you write it without
spring well who knows how to solve this
problem what exactly because the answer
is not how to write it differently with
something else without spring the answer
is how can you write that bad code if
you know something about clean code the
first thing you see oh my god for sure
this class breaks
single responsibility principle it does
to many things
so in fact I presented some longer
solution to this problem in many steps I
refactor this code to be this magic
service to be like depending on three or
invent to two different dependencies and
then some dependencies split it exactly
this class became six or seven classes
and that's the correct solution to the
problem not just another dependency
injection but this is easy I would say
simple Java solution but sometimes the
life is more complicated so there are
some patterns that sell few the
dependency injection problem so one of
the patterns is for instance cake
pattern who has heard about cake pattern
that's something popular in Scala and
surprise is you can use it even with
Java it's not that nice in Java but it
works so basically I don't have enough
time to present you this but the trick
is to use default methods interfaces for
instance user service component with
user repository component is something
where I have get user service with
default implementation and then at the
end I can use I can create different
interfaces like local user repository
component with LOC local authentication
or Mongo user repository component with
monkey authentication that's interface
with default methods and then at the end
I can for instance create finally
instantiate finite classes with and
create them with just choosen
dependencies which set of dependencies
I'm using so for tests for real
production etc this is this cake pattern
is quite productive in Scala in Java is
a little bit verbose but still works
maybe you have different problem like
you have a couple of classes and you
don't really know who you don't want to
pair which to instantiate first with
second there is a great pattern for that
lazy lazy container it's who is who's
using java slang core virus now that's a
great library I would say that the first
library in Java
that you should use it's better for
instance than java.util collection etc
for most of the problems that you have
and there is this lazy container which
means for instance I said I can use a
couple of I can create couple of
services and maybe this service one I am
even instantiated first but finally it
will be constructed later after service
two is instantiated how cool but modern
I would say that my solution to most of
the problems is doing simple Java like
this Fink
maybe so just to show you it is user
service that's that's the code you can
find on my github I will be showing this
code in fact later today on the other
session about rat-pack and I have used
their service with two dependencies I'm
doing something and then I create some
supplementary class typically called
model that's my pattern that's my
convention in this model I see I say for
instance that the default implementation
of the user services with these two
dependencies but if I am writing unit
tests and I don't want the real database
or things like that then I'm using this
constructor it's easy and it works and
you don't need any magic container you
just use Java independent constructor
and compiler everything is proven to
work all the time and if it's broken
compiler will tell you that not a run
time so basically that's my message to
you that container compiler is great so
but then you can make question if you
try to do it with Jack's arrest or
servlets you will see that oh my god
life is not that nice
why because serve let's have one problem
servlet so whatever you write with Tom
cards WebSphere JBoss you write the
classes that are already instantiated by
some container you can't avoid that and
is the problem if you if you have a
servlet that's already instantiated by
something else
you cannot how to call it you you cannot
really influenced this instantiation
then you have a problem but there is a
solution to that
my solute my answer to that is forget
about servlets today I have
session about Java web server called Rat
Pack who had heard about node.js so it's
a JavaScript server which people really
in small teams hug things and they have
real working services and they don't
don't do over engineering they do it
quickly and some I've seen a lot of Java
guys being jealous how could they do
that so quickly and why this thing works
so fast so you don't need node.js for
that you know you only think you need is
how to call it the common sense and use
Java and there is this serve server
called Rat Pack where you don't rely on
servlet specification which I simply say
is outdated you shouldn't use it in 2017
because it just is answering the
problems of 90s so that's a Rat Pack how
you create a cell rate with Rat Pack you
start this with a main method how cool
you just start main then you call wrap
back with some configuration maybe with
one thread that's cool you can create a
web server in Java that is using one
thread which is cool I will tell you on
the second session today why it's cool
of course you can use more threads like
for like eight but would you but you
wouldn't use like hundreds of them there
is a reason performance and maybe I'm
using here in here constructing the
shobana G server so under the prefix
fever are with parameter n I am calling
this seed ball handler and then I am you
calling this research Bonacci
what is great about Rat Pack is testing
that's the cool stuff if you do plain
Java testing is easy because who has
tested any enterprise use Java EE or
spring code with for instance database
how do you test that is it easy it's
horrible or how do you test rest
services how do you test if your service
service work with mocks I will I will
address this later but this time how to
call how to test rest service the best
way to test rest
service is to test rest service and it
looks like this I create a server and
exactly that's the method I created here
so I start my server here in the test
method then I'm using tests HTTP client
I'm using HTTP client I am really
calling this that's a real call over the
network and I check if the body responds
to the what I wanted is expected and
some of you may say oh my god how heavy
test is that how much time do you think
takes to start red box server with
configuration who knows ten seconds so
is for ten seconds five seconds how much
50 less than 50 milliseconds give me
numbers okay this server okay depends of
course on the machine but is around 10
milliseconds it means you can start
hundred such servers per second start
and stop them and test them how cool so
really and then you really test what is
working on your production not some
mocks what about what I haven't
understood the word yeah you yeah you
you can start in tests of ratrock I will
show you later you can for instance
overwrite use different port or or you
can for sure start them one by one so
they start on the on the yeah on the
same time on the same port every time
but the previous one is closed before
you start the next one okay but if some
of you I'm working from the insurances
in Switzerland I have WebSphere oh my
god
and I cannot drop it I have to leave
that but my team in fact has found a
solution because you when you have
problem you build the wall you know
that's a common world solution just
build a wall and our our wall in Java EE
is like this we have some beans we have
to we have to use
a JB's just we are forced and then those
ejbs have persistence contact with
entitymanager so similar stories in
spring whatever but what we then do is
we don't really code inside of beans we
call this that's our name convention we
create delegate classes
what is delegate what is delegate class
it's basically mirroring the bean but
it's a plain Java class doesn't it's not
a bean it's not broken it's it's just
Java class and it has entitymanager as
dependency injection and we are clearly
constructing this class here and it's
even more if this class this class is
maybe using database and then this class
is using some maybe real calculations
some logic then we write this logic in
the third class where we have plain Java
logic that we can for instance test so
we have in this my calculator class
where is playing without the database
logic we would do our business logic
would write test for that what our
business wants then in a delegate would
have this plus real databases things
like that and then finally only the
wrapper only the color of this inside of
EJB what it means for us that we have
very well tested this part we test we
have slow test because they use database
but in-memory database but they're still
slow with the force the service
delegates and finally quite honestly we
don't have those tests for these
wrappers because first this class is
trivial second testing that we were real
container is just ugly but we solve
solve the problem this patterning works
pretty well for us so it's not really
the clean architecture as proposal uncle
both by but I would say this is exactly
our what influences us what was our
motivation right clean business logic in
clean Java without any machinery without
any magic so you can for instance put it
inside spring project inside EJB project
or inside plain Java project it should
work
you can then on top of that you use some
nasty frameworks but not inside of that
that's the Duster at the core point so
does it mean that all inject EJB also
wired I'll bet I don't say I wouldn't
say so if you do are doing some plugging
all you have customers able deployment
so it means for this customer I'm using
this jar with these dependencies for
other customer different jar then usage
of such annotation is perfectly legal if
you have remote calls of HIV by the way
you know that EJB this original java ee
was done in order to make remote cause
that was the motivation to do that it's
only then stupid that we do ejbs
inside of a projects that don't have
anything remotely yeah it's just misuse
but ok so if you use that annotation for
these reasons that it's completely legal
and fine find it use useful yeah so
every time use something your compiler
cannot help you in that
and now another story so I found a great
book in French about it's translated
which describes things that young boys
do and then then I have this symptoms
these two methods of stomach digestion
vomiting you know who has these symptoms
I know if you will say but there is even
a great picture
to that how difficult boy looks like
this there a lot of such pictures on in
this book you know what I'm talking
about whom I'm talking about
Mokey's
really young boys and guests do that
where we don't watch so that's a sample
I found on the net
one guy asked simply he created his
first spring project that was a beginner
first spring project and then he asked
for how to call it review what and then
she showed his tests so that's a great
test so he has something something
called flashcards service where he had
method final and where he is using
flashcards repository just take a look
at it
flashcard service flashcard repository
method find all that's the service and
then the test of it that's the that was
probably the best test I've ever seen
oak quite nicely not but one of the best
should findt
all find all flashcards when flash card
service find all then return get
flashcards flashcards serve is final and
then a third you know what's great about
this test is the perfect test for every
developer and his managers it will never
fail but we always green no matter what
you have in your implementation can you
do better test absolutely not
it's not possible and you may laugh okay
that's just a mistake of a beginner now
now I seen such I seen such tests quite
often in a productive system it's driven
so we had a big system written with
spring with some ik by some external
company which they wanted really to
cover everything hundred-percent but
they wanted to do it cheaply so they've
written a lot of such tests it was great
because I was doing for instance
refactoring I've seen okay oh my god
it's all tested how cool so I may be for
for the first time I just delete all the
code tester green how cool done so well
it's really what happens if you overuse
mockito and a lot so I don't say by the
way that this those tests are useless
those are great test for mojito so every
time you write such test
sent you no greeting to step on who is
an outer of mockito you tested his
framework for the line under now
millions times so that's great and a lot
of companies are doing that really there
isn't something called London School of
test-driven development who else cares
about it like you simply mock everything
you just after every line you check if
the response of some other service is
you verify with exactly what you would
want to write so the problem is with
this could just take a look at this at
it their article there is a problem that
you test mocks only and then mojito is
the most tested and there is even the
best problem if you you can use very
fine mojito then you really test it was
this method called first than this than
this so really cool test everything one
inside the implementation how cool
because they come then come the comes
the day I'm doing refactoring I'm trying
to change something just split something
and oh my god I haven't even really
changed the logic but tests are broken
because I'm doing something in different
order so really is it even though the
method returns the same result my test
is broken because it's doing it in a
different for instance order so what's
the point of having such tests so
because why we write tests with us write
tests so that we can do refactoring
easier but if we have every time we have
such tests with London School of TDD
after refactoring we have instantly
instantly to change the tests something
I think doesn't really work here well
just think about it okay when the
mocking is really good so I say there is
one place where mocking is perfectly
okay if you test against external
assistance I think that doesn't belong
to you but if you mock your own classes
think I don't say it's always bad it's
often okay but be careful because maybe
we'll just test on the mocks and then
comes the question is a database
external system
who thinks you should test with a
database who things you shouldn't test
database you should mock repository so I
rise twice hand why because it really
depends if if your contract is just
register this user somewhere and later
on
check if somebody logs into this with
this user account he should be able
because it's somewhere persisted and you
created the schema of the database on
your own you are the responsible for for
this not know none else nobody else then
the the database is your internal part
it's your internal tool and you are
supposed to test that but if somebody
says that's our database it's
company-wide it has these tables
you should read from those tables then
store inside another tables then needs
external system and you even should mock
it because to check that your logic for
instance still works even though
somebody changed something in the
database so it's very simple is it your
or not and then you mock it or not okay
then comes the question of aspects who
knows this think pre-authorize
post-filter transactional who thinks
it's cool because you know I have my own
my transactions problem solve with this
transactional annotation how cool I have
annotation for security everything right
then even better you can write your own
in like aspects like this how cool is
that
so I have Java I have typed classes and
then I write aspect and all I can use
this object it's real object-oriented
programming of arguments or objects or
classes are objects cool that's the
point other case the thing is can it be
better because if we look at aspects
there are a lot of access transaction
cache validation and typically I see in
enterprise systems those are annotations
to solve those problems can it be done
better so take a look at it maybe
post-filter has permission really makes
sense so what
this I say is it Java is it decorate you
think because people says it's not
really declarative command what is that
is this is the pathetic string lis typed
programming so your real logic is in
strings it's really like that and you
can do better and there is for instance
if you this is from my sample
application somewhere else if you want
to use database transaction what can you
do you can really program that in kind
of generic way like here I am creating
session open session I begin transaction
and here I call something like a DB
comment and DB comment is my parameter F
function then I commit transaction and
in that case maybe I had constant
violation and I wanted to retry
transaction how cool try to do retrial
with annotations on JPA it's horrible
but if you want some such a method that
will just retry your transaction
automatically you can write it and then
how to use that in instead of writing
here transactional I just call it this
do transaction and that's my method
session says I have everything so it is
the functional approach
I changed a notation to first order
function really it's easy it's easy
pattern and maybe you say oh my god
writing that methods it's real just
insecure maybe I will do a mistake you
don't have to write them because there
are guys that written them for you so
there is a great joke library and the
author of this for instance had created
create transaction exactly makes that
and here everything you do is inside of
transaction and you have access to this
transaction through the ex-cons it's
great it's functional way of solving
aspect problem the same thing you can do
with for instance security like maybe
you would have one public method to do
secure which takes HTTP request
permission that you want and then the
final action that you would really want
to call inside of secure request and
then you use it very simply do secure
with this HTTP request I need permission
right and then I system checks
everything and then finally that's what
you want maybe DB service right and then
you can simply rewrite all those aspects
of those transaction to the functional
functions and yes that that is even
better because you can compose function
and functions working compiler functions
work perfectly inside a test day you can
test them you can debug them perfectly
you don't rely on any external engine by
the way there are good good annotations
so like overwrite functional interface
immutable new label not now do you think
not al is a good annotation who think is
good right hand
who thinks is good ok so the thing is
when would you use null in 2017 in Java
the answer is almost never
so if almost no field can be no label in
your Java code it means oh come on
you should not mark every field and
every argument not now just forget it
not now is a default in Java you
shouldn't you shouldn't just use null
maybe with some exception you work with
alt code just use null able and then
test dynamic test those all annotations
and one thing in common they help
compiler then help you to check that
your code is better then just there just
some marks to compiler the compiler
build time checks yeah like this and
there are other sets of transaction
lines this JSON this illustration create
original route those help to convert
something from Java to JSON XML the
different such annotations again this is
Java and Java collaboration and by the
way I don't think those are perfect
because for instance in Scala words they
already change this approach zone in
Scala it's possible to do JSON for
instance mapping without annotations
well on a compiler level it's way better
I would say but in Java we are we can
don't have that good stuff like compile
time macros ok because you know when
something is done by the compiler it's
proven under compile time not under
runtime so you have problem your for
instance Jason I think is just basic
broken cannot be you would see that on
the compile time in Scala not in on the
run time this is one thing I like so I'm
reading some historical books and texts
and if you look at the medieval texts
like the charter streets or parks you
would see that typical look like this
John by the grace of God King of England
Flores Island Ireland Duke of Normandy
blah blah blah blah blah is lot of that
and it's even more know that before God
for the help of a soul and those of
other bla bla bla bla bla bla bla bla
bla you know it's really funny because
this text is long you know this is the
famous text you know who knows this text
ok the John this is something called
Magna Carta it's one of the most known
English yeah charges so nevertheless
after such many preamble such many these
great texts in the introduction finally
comes the core what he is really wanted
to say is to say to us this is the cord
a yellow one the problem is then again
bla bla something and then this is this
text book like this and it's really hard
to find the real content inside of that
that's the problem and the thing is that
I realized one day that some of the Java
developers are really greatly how to
call it influence but these medieval
texts that's the class iPhone
unfortunately I cannot show you the code
it's secret
but basically in this code minified
until this moment we have preamble we
have annotations really that's a
notation up to this point and here
starts the class
it's almost 60% is annotations how cool
and you know what kind of framework in
Java creates this JPA
it's really it's the best thing so
typically it looks like this I've seen
it you know hundreds of ten ninth query
it's not even named query cache able
blah blah blah blah blah we don't leave
the etc and then finally starts the
entity which is just such small and it
is funny because if you have a problem
in one of these are not one of these
annotations how do you check by the
compiler it's only while you start the
maybe some of those selects are released
can't and you see sue see the problem so
okay that's JPA
so I would say for you
JTA is not really good framework for
Ford also for typical business
applications that you would write with
Java there are a why because there are a
lot of problems with JPA the notation is
only one of them the problem I see
typically is that really regular
developers know SQL no SQL they know SQL
the problem is the his problem
transferee to JP a query language
transfer SQL tables to mappings in
hibernate JP a whatever the lifecycle of
JP is very complicated of the entities
like you have data edge to manage etc
and first of my my best finger in
sometimes the best bugs and sometimes
Heisenberg's on production is where
somebody has nested transaction requires
new and inside of requires new he
creates an object persistent object and
then this object is returned to the
external transaction and attached to
some list well JP a really gets crazy
when it finds it so hibernate whatever
so there are a lot of problems with that
but there are easy solution just forget
about JP a JP a has some uses but there
are better libraries I would say for you
like Duke or mybatis which are very
simple and if you talk SQL you
understand SQL you can easily use the
full power of that with for instance
Duke or mybatis really
yes ago first time I have seen my bodies
I was lucky oh my god how primitive is
that but then I've seen that the project
was really working well because we were
not spending weeks trying to find out
what's going on why is null there or
whatever because we had everything just
written in code it's full it's no magic
no ask and we talk SQL like human beings
okay so I'm going to end this talk so
I've shown you a lot of problems with
annotation I'll show you some good
examples how to get out of this hole
with for instance functional code or
compiler there are resources you can
read about it's like Oliver Gurkha
mentioned one great presentation from
Mario Fusco is ganker for patterns to
lambda for how to lot of patterns that
you use that maybe you'll learn in
studies are just outdated because of
functional programming you can write
them way simpler just functions and
convert the major post about the
dependency injection inversion which he
also says about why to use container to
do that annotation manga is a great page
where you simply vary whether they are
just bashing annotations just recommend
to take a look at it because outer is
just this is the outer of Duke is
posting very funny things about it so
technology rudder who knows technology
rather so it's a great page and you know
years ago they published you should stop
using application servers it's now 90s
or gone come on
so it means also servlet etc forget
about it okay they proposed different
solution you can use embedded service
but I I would say there is even better
I think of embedded server things like
Rat Pack for instance if you want to see
the clean application really working I
will be showing in a couple of hours
it's a rat Punk it's on a github you can
look for the rat poking that punk game
web-based pong game done this clean way
without any annotations containers just
plain Java and you see that the code
really looks nice and about the notation
I would say once they were really great
and I was really happy to avoid XML and
start with annotations but then after a
year years I realized they bring another
problems and and those problem can be
solved with lambdas way better and we
should give our chance to compiler
because compiler is proven to work all
the time if it says it something is
broken then it's broken is and it works
it should work so give chance to
compiler ok Switzerland is the fixed
things test if compiler doesn't help you
then write tests and only only then if
test and compiler doesn't help you the
reflection or this magic magic of
container easel
last resource but you should use it not
that eagerly as you do it probably now
you should do it as a last chance if
anything else doesn't work yeah and by
the way using that you can really make
Java grained and funny again you can do
nice projects not of an ingenuity are
great Java so that's all I wanted to say
thank you very much unfortunately</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>