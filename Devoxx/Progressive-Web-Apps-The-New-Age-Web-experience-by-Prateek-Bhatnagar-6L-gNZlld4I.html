<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Progressive Web Apps - The New Age Web experience by Prateek Bhatnagar | Coder Coacher - Coaching Coders</title><meta content="Progressive Web Apps - The New Age Web experience by Prateek Bhatnagar - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Progressive Web Apps - The New Age Web experience by Prateek Bhatnagar</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6L-gNZlld4I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Birgit you play kit do it
thanks s hey guys I'm fatigued but Nagar
and welcome to progressive a bad session
I work with Google and I work in Google
cloud G suite team and Google Chrome as
well so a big part of my job is also to
build libraries and frameworks to help
developers build progressive web apps
but what are progressive web apps
I will give you an introduction take you
through all the api's take you to a lot
of code on how to build these things
hoping that you'll be able to go back
and build a couple of these but in order
to introduce these a quick raise of
hands how many of you use your male
clients maps and all sorts of these
application in a web browser on a
desktop awesome and just keep your hands
up if you use the same in a web browser
in a mobile device okay as I expected so
there are very few of us who use our
make lines or maybe our Maps application
and maybe our social networking
applications in a web browser so what
happened there why did we V we were
using these for a very very long time in
a browser on our desktop so when we
moved to mobile why did we switch to
native apps there were a couple of
reasons behind it so on my phone for
example my mail client even if the
networks not there it is able to show me
a couple of last my recent mails my
social network is able to show me my
recent feed which my friends have posted
even if the network is not there the UX
is much better and sometimes it does
things off for reengagement for example
sense we push notifications which web
for a very very long time was not able
to do on mobile surprise so with
progressive web apps you can do all of
this with your current mobile web sites
so just to put it in a nutshell
progressive web apps i or web sites with
these three points first they are
network resilient which means does not
matter if your user is on a 2g is on a
3G is on Wi-Fi or even if it's if they
are offline your web sites will still
work they will still be able to show
some content which you decide what
should be shown in case if there is no
network second response fast with
progressive web apps you can add your
websites to users whole screen and app
menu as an icon just like native as do
so in this case your users do not know
which icons are basically native apps or
which icons are progressive web apps in
which case the X they expect both of
them to respond equally equally fast if
they click your web site or progressive
web app should respond really really
quick under five seconds they should get
really interactive and with the help of
a new API called service workers you
have a very very fine low-level green
low-level control over your cache you
can decide at runtime which assets to
bring from cache which are sets to bring
from network and you can switch between
these two at the very runtime so with
such fine-grained controls you can
respond to your users need in a super
super fast manner
nothing engaging so PW is have been
proven to have better engagements with
the help of push notifications using
again this same serviceworker api you
can send push notifications to your user
who are using your websites they do not
need to download your native app to get
in order to get your push notifications
your web sites are able to get send your
push notifications to your users just
like your native apps to so just a brief
look what exactly are you missing if you
are making conventional websites instead
of progressiva verbs
imagine you are building a game so if
your user is bought and he is fiddling
he or she is fiddling with their phone
the chances I really really know that
they will go to a browser type a URL
expect something to pop up on their
screen they look into their icons that
they're on the home screen or on the
last menu and will probably give time to
one of those products so if you are
building a conventional websites the
chances of you landing on their home
home screen or the app menu are really
low
next the multiple businesses like if an
e-commerce or a cavalry Gator loses the
power of notifications you cannot tell
your users that okay we are hosting a
sale tomorrow or your cap is about to
reach your destination if you are
building a conventional website third
thing your web is responding really
really slow and your apps this may this
might be a one of thing and maybe a
little debatable but your apps are
really heavy to download in comparison
to opening of web page at once so if
your users are able to open a web page
and able to view it on bad networks
it's very better user experience than
downloading a particular app for things
your web presence goes on and off so I
am pretty sure a lot of us have already
witnesses if you are traveling in a
metro if you are traveling on a on an
airplane the chances are really really
high that you will lose your network and
at that point of time if your website is
a conventional website your users will
not be able to access any kind of data
because with conventional website you
need to connect to internet and then
send HTTP request and then response will
come but with progressive web apps you
can basically have the control of your
API as well as your assets of web page
are coming from which source either from
cache or from network - this is really
different from your older kind of
caching maybe HTTP caching did they are
very declarative up for
okay this asset is supposed to be cash
for X amount of time and do not come
back to network if before this
particular time with the API called
serviceworker which we will discuss in a
short while you can tell the browser
that okay if the network is present go
fetch the data from network get me the
freshest API response get me the fresh
user data if the network is not there go
first
fetch all the data that we last viewed
from the cache so in case just for
example if I open my social network it
should be able to show me the previous
feeds that my friends have posted in
case the network's not there and if the
network's there it should always be able
to fetch fresh data fresh content from
my servers another thing so if you are
building a conventional thing a
conventional web experience mind this
all your users are spending 80 percent
of their time inside a mobile in you in
their top 3 apps if you are building a
native app the chances are the use is
that your product should get is really
really low because users tend to get
stuck in top 3 apps itself whereas with
websites if you share a link and that
link has another hyperlink to another
website the chances are really high that
it is the user will just click to it and
navigate to some other website see some
other content and that content can be
one of yours as well so the barrier of
downloading a native app installing it
and then viewing it is is out of the
entire flow so again how can PWS help
you this is very specific to the aps
that I'll be discussing into this entire
presentation the first is network
resiliency firstly the API that brings
this is Service Worker API service
workers are basically a JavaScript file
that runs in a background thread of your
browser so now it has the capability to
run
you're some portion of your strips while
the user might have even closed the
browser this was not possible before
serviceworker any piece of code that you
write as your website was only
executable until and unless your tab of
your website was open now the
serviceworker is running in a background
you can do tons of stuff even if the
user is not on your website this is
really really taken care of in a very in
a very delicate manner that if you are
doing a very long pending task the
serviceworker or this background thread
is skilled and is only awakened on
certain kind of events that we'll
discuss
engaging for users as I told you now
since this thing is running in a
background thread your website's can now
receive GCM push notifications even if
even if the user is not active on your a
on your website so earlier what we used
to do is used to pull a poll the
particular server or tons of other
technologies that you should tell us but
they were only limited in the time that
I was using your website for the desktop
this case was not as big because most of
the times but now most of my tabs were
always open but for phones if I just
press the home screen all the tabs all
the websites and the browser itself is
closed so there was a die need of
something that was running in background
which serviceworker has actually brought
to the table okay so what are service
workers as I told you that it's it's a
JavaScript file which is downloaded
separately that you can tell when to
start downloading it's a separate
JavaScript file that is downloaded
separately and put inside a background
thread now since this is put inside a
background thread this JavaScript has a
different life cycle of its own this is
the serviceworker lifestyle the
serviceworker life cycle once you tell
the browser that this is my whatever
giving the path whatever is my
serviceworker file it will first
download that file and try to install it
there
multiple serviceworker files that is
that is affecting a page and hence the
browser makes sure that first your after
downloading your file is getting
installed in the background and then
it's activated so after getting
activated your new serviceworker file
will get the control of the of your
particular control page after it if
there is nothing getting executed it
will be put into idle so from idle
service workers are basically wakin up
by the browser on particular events so
if you are making a network request your
service worker will be notified here
this is the network request going out
from this website do you want to modify
it do you want to do something with it
and this is particularly the chance that
you decide ok I will first go and check
if the network calls are failing
I'll just grab it from the cache or
let's say if the network is healthy I
will just go to the network and grab the
freshest content or maybe the message so
a browser will also wake up your
serviceworker strip in case it receives
a GCM push notification on your behalf
and tell the service worker hey I have
received a push notification here is the
data and decide what you want to do so
you can create a push notification and
show on a user's device ok this is a
very simple code that you write to
download the serviceworker
and do something with it so in your
index dot HTML
you just write these four lines check if
the serviceworker is in navigator now
progressive web apps have the word
progressive for a reason
your website your progressive web app
will continue to work as is if your
browser's do not support the new APs
so hence all of this is protected in a
very progressively enhanced manner will
check if the Navigator has the
capability of serviceworker we will do a
serviceworker dot navigator navigator
dot serviceworker dot register and then
the path of your javascript file now
this returns a promise telling that pave
weather was this file successfully
downloaded and
or not also there is a option of scope
you can now serviceworker is like a
proxy sitting between your browser and
the network itself so it's a pretty
hefty thing so there are a few things
that you need to keep in mind you can
specify a scope or the URL of around
which the pages will be controlled and
also the service workers are only
available in HTTPS since they are a very
proxy kind of sensitive things browsers
only allow serviceworker usage in an
HTTP or a secure environment whereas in
the serviceworker file you can just add
an event listener as fetch and respond
with whatever custom response you want
so this code will basically get every
will get activated on every outgoing
request so any requests any CSS any j/s
any api requests that you make to your
jaws over at this point of time will be
responded with just with just a text of
hello let's look at a more real
real-world use case if in case a your
code executes without any error as seen
in the previous slide there will be a
serviceworker file shown in the
applications tab in your chrome dev
console that this particular
serviceworker is currently running or is
now activated and it's now running you
can also emulate a different kind of
events like a push event which is
basically generated when a push
notification is receive or a sync event
which is generated when you register for
a background sync that we will shortly
discuss and you get Network back now
there is how you achieve offline first
you declare a name of the cache you
declare particular URLs to be cached and
then in the install step as we saw that
the serviceworker has a life cycle the
first event in the life cycle was
installed while installing the
serviceworker what browser will do is
open the
and the line in line number 11 you see
cash is out open it will open a cache
with the predefined name and all add all
these URL and its responses inside the
cache now in order to use this response
will again add an event listener of
fetch and now whatever response is
coming to us we will do a cache assort
match event dot request now this will
tell that whether or not cache has this
particular request already cached
if in case the response is there we will
return the response now this response is
sent from the cache in case the response
is not there in case we have not cached
this particular request it will just
fall back to network as written fetch
event dot request now this line return
fetch event dot request what is does is
it will just allow your request to go to
network as if there was no service occur
between it so now this particular
strategy is called cash flow strategy
every outgoing request you first go and
see if it's already cached if it's not
cached let's go to and fallback to a
network basis particularly good in case
or you are following an app shell kind
of network where you where the user
comes to your website and you cast the
entire shell a blank shell of your
webpage and you only go out to network
for your API request so for all the
assets your CSS GS and other kind of
things you fall back to a cache and only
for your API responses you go to a
network this is a very similar kind of
approach what native apps currently do
okay now that was a lot of code to
handle a very small task
now now comes the helper tools the
import scripts is you can think import
script function as an equivalent of a
script tag in your markup you give a URL
of a script inside the import scripts
and what it will do is it will fetch
that script it will execute that script
and then execute the rest of the
code that you have what do you what
neckline toolbox or outer gate is
toolbox is basically a helper library
what it does is it gives you a express
like caching express like routing and
you can expand you can write which URL
should use which strategies so namely
there are five main strategies first is
cache first which is look for this URL
into the cash flows and then go to the
network if it's not there
second is network first look for this
URL first at the network if the network
is not available then go and look into
the cache third is cash only do not go
to network just always always return
from cache fourth is network only please
God always read get the data from
network if not just field do not go to
cache and look at it and this is a very
interesting strategy
that's called fastest you you send to
request one to cache and one to network
and whichever resolves first your data
will be first sent to the control page
via that particular source now you send
one request to cache and one request to
the network and whichever first comes
your page will get that response so here
what I'm trying to do is the home URL
its first given through cache first that
fir always look for index dot HTML or my
route HTML into the cache if it's not
available then go to network where as I
can also do some other kind of
properties to it so I can give a cache
name to where look into it I can give
the maximum number of entries and the
max age for this particular cache so
what it does is just suppose if you are
into an e-commerce and you have to store
last five searches of your user your
entire progressive web app all the
website is now served from cache and now
even your last five searches that your
user did is now into the cache you can
with max entries
as a number you can also control this
thing so for example I suppose suppose I
search for shirts t-shirts pants
trousers jackets sweaters so my last
five searches will always be in your
cache so even now if I am traveling even
if I'm in a in an offline mode on an
airplane mode I can look the last five
searches that you are particularly with
a particular website returned to me so
so here's a use case of what is other
than just the assets can you cash as we
discuss you can catch some of your last
used searches you can also catch your
last recent means just like your native
apps do you can also catch your last
incoming feed or maybe an entire game so
think of it like this now with a low
level API set like a service worker you
have the entire control written in
JavaScript and it's at your disposal to
decide what to do at what point of time
so some of these use cases are what it
what are easily achievable using a
serviceworker cache okay now comes
manifest serviceworker do the behind the
scene kind of stuff it does what to
respond and when to respond from where
to respond but in order to add your
website to users home stream it needs a
lot of settings like how it should look
what icon should it have what particular
name should it appear on the user's home
screen so a small link tag in your
index.html as link rel manifest /hf as
the URL of the manifest itself can tell
the browser okay hey here's the jason
that describes most of my progressive
web app or the information about the
progressive web app go fetch this and
when the user requested to add to
homescreen please take the settings from
this one so a few to name are the name
itself the name will appear on the home
screen the short name in case
there's a case there's a scenario where
there's not enough room on this screen
of the users phone a description a theme
color theme colors basically the top bar
in case of Android with battery icon
Wi-Fi icon and other icon appear so
whenever your progressive web app will
be open now the particular bar will have
a different color now by default it's
always a translucent black but you can
define whatever color suits the branding
of your progressive web app like next is
the background color so whenever the
user now taps on your icon the browser
itself will show a splash screen the
splash screen will have the name of your
product the icon of your product and
this background color in the backdrop so
while your page loads the user will be
shown a particular splash screen instead
of a white blank screen that that user
was seeing in case of a regular browser
okay so manifest is in case you want to
follow what is what are these be
capabilities of this particular manifest
follow this URL this is respect width of
the w3c and there are new capabilities
that are being added so which you can
follow there and in case you want to
generate one these are the two URLs you
can go to the URL just put in some data
give them the I upload your icons and
they will generate the full entire
manifest for you now this is
particularly what your progressive web
app looks like
first is the normal website open in a
browser with the URL bar and everything
if the browser sees that okay hey this
is a progressive web app it will show a
banner to the user if you want to add
this to home screen if the user presses
Add to Home screen an icon and a name of
your product will be on the user's home
screen so now at this point of time the
user can do not have to go back to the
browser and retype the URL on you or
even type a few letters of it
he can directly tap this and an
experience that is seen on the last will
be presented to him please observe there
is no URL bar there is no other browser
UI itself it's all like a native apps
open full screen but is your can of
website and these are the two properties
that help you do this the first
properties are display so you can be you
can choose if the user clicks the home
screen what will be the UI shown will
that will be shown to the user it can be
either full screen it can be either
standalone so full screen even the
battery bar and the top bar will be will
disappear this is mostly use in cases of
games so there is no UI of phone
altogether where as standalone is what
we saw this is a particular the one on
the last is the standalone it will still
have the phone's top bar but no UI of
the browser itself or minimal UI or the
browser as default as we see as you see
websites today next is the orientation
you can decide whether when tap on the
icon whether your PWA will open in a
portrait mode primarily or on a
landscape mode so in case you are
developing a game you may might want to
choose a landscape mode instead and this
is basically how the adding to home
screen looks like you can trigger this
banner and the this banner will be shown
to the user which again the user can
choose to opt out of or can choose to
keep it on the home screen okay but the
entire thing of home strange story has
no API to it there is no piece of code
that you can run in in your JavaScript
and show that particular banner to the
user so what how do we basically do it
so browser has a few checks before it
shows the banner itself there are few
heuristics like your website should have
valid serviceworker running and active
serviceworker running to it in the
background next there should be a
manifest added to your index.html and
every HTML that you that the website is
being added to a home screen from and
third thing is user should be user
should have spent some amount of time on
your website if these three conditions
match if these three conditions match
the browser itself shows the Add to Home
screen banner now the reason behind the
one of the main reasons behind this is
imagine that is if you if you are
jumping links from links and landing on
different websites and every web sites
are showing Add to Home screen first as
soon as you land on that particular web
site it would be really really obtrusive
for the user so in this case the first
the only way to do it is your browser
get satisfied with these three
conditions that it will show that
particular banner but there might be a
condition where it might not make sense
for you for example let us take an
example of a game there is a loading
screen at the beginning but you have a
valid serviceworker and you have a JSON
manifest in that case immediately the
browser will show the Add to Home screen
banner but your user itself has not seen
your product he has not seen your game
he has not played any game on Eocene is
a loading splash screen what to do in
that kind of case so in this case before
showing the banner itself browser fires
an event on the window object the event
name is before install prom so here just
as we have did it for ages you can do a
event or prevent default this will stop
the browser from showing that banner you
can store this particular event
reference into some variable and
whenever you feel that that this might
be a right time to show the banner where
for example user has played one or two
levels or played your game for some
levels or time or has shopped from you
from your ecommerce and you think that
this might be a very good time
to show that particular banners you can
just call window dot or whatever
variable you stored that event into it
dot prompt this code will just show the
banner now and you can get a promise by
your event dot user choice and it will
resolve in case the user has opted to
add to homescreen and it will get
rejected if the user has spread the
little cross icon and has rejected your
request to add to homescreen okay now to
push notifications now this is one of
the feature that web has really really
waited long for now web can send push
notifications just like a native app to
this is one of the example experiences
how web sends push notification now
before sending the push notification
this thing is guarded by a permission
model now the same thinking the same
kind of thinking of gets applied even
here so if you browse to five websites
and they all start sending push
notifications to you I am pretty sure a
lot of us will be upset hence before
sending the push notification every
website needs to get your permission
only and only if you say allow the
websites will be able to send the push
notifications to you and now the push
notifications are themselves powered by
serviceworker as I told before service
workers there was no one to receive your
GCM for notifications if your user has
closed your tab or your website now
since push notification sorry the
service worker is living in a background
thread even if your tab is closed even
if your browser is closed in case of
mobile your there is a script of your
service worker that will be able to
receive the push notification and will
have the logic to what to do with it a
very simple
example is in your service workers or
genius just do it this or self dot add
eventlistener the event name is push you
will get the event and event dot payload
will have all the payload that GCM is
sending to you but regardless of it you
can create a title you can create an
option which will have body or icon to
say show on the left your badge to show
just underneath the icon and the action
buttons that you want to show with these
are with the push notifications now the
icon the badge and the actions all of
these are optional you can choose
whatever fits your use case at that
point of time and a small code event or
wait until self dot registration got
show notification will generate a
notification just like this for your
users okay now this is a small code here
that is event not wait until why exactly
this so if the browser allows a script
to live in background there are ton of
things that a developer can do but a
user might not want hold on to the
user's device resources keep on
executing some code while user might not
even know it so in order to prevent all
of these browser kills your service
worker as soon as it finds out that your
service worker it sells is not doing
anything is not executing any code so if
we don't do event dot wait until your
entire function would have executed and
so the browser would have thought hey
the service worker looks idle let's just
kill it so in order to avoid this we do
service worker dot wait until this
function takes a promise and self dot
registration dot show notification
returns a promise so unless your
notification is constructed and shown on
the user's device your service worker is
told that hey I am doing something do
not kill me so it's a message sent to
the browser it's a way to tell the
browser that hey I am doing something
until unless this promise gets resolved
please do not kill the service worker
now now in order to get the basic
notification and to have the logic of if
the user has closely tab and show the
notification and if the user is on your
website and your tab is active
let's show instead of a push
notification into the bar let's show
something inside the app itself and a
lot more to solve cross browser things
to to saw to smooth out cross browser
problems you can use one of the products
as firebase so our to import scripts
that will bring the coal fire base code
and the fire base messaging kind of code
and firebase dot initialize app now
giving a message sender ID you will tell
that hey let's just initialize the event
listeners inside the firebase and get
ready to receive all the push
notifications now next is messaging dot
set background handlers log all of this
code is specific only to firebase if you
are not using firebase only I add event
listener and push should be sufficient
for you but if you are if the code
itself gets complicated this might be
the thing that you want to do again the
thing that a firebase needs is that it
returns the same self registration dot
show notification and you should be good
to go
you can still receive the payload as you
received it earlier and you can generate
the push notification here but this bad
set background message handler will only
be fired if your user is not active on
your website if they are active on their
web if they are active on your website
the firebase will aya send it to your
index.html listener and not to this
background message handler in order to
take permission from the user this is
the smallest code possible so when the
service worker gets registered it gets
resolved the promise itself gets
resolved with a registration scope and
with this registration there is an
object as
push manager this push manager you can
call the function of subscribe as soon
as this function gets called the UI of
taking the permission from the user will
be shown so now they subscribe has if
you notice this subscribe online number
five has an object of user visible only
as true which means at this point of
time if your web app receives a push
notification you have to show it to the
user you can not choose to not show it
at any point of time you have to show it
to the user
there is another spec of silent push
notifications which you can use after
some time to fetch a data from the API
at regular intervals or maybe refresh
your caches it's but at this point of
time if you if your web app receives the
push notification you have to show that
push notification to the user if not the
browser itself will generate a portion
notification that says that this app has
been updated in the background and will
be shown to the user if you fail to
generate a push notification now there's
also a case that you take the push as
you take the permission and then you
change the service service worker files
that file itself when you do this your
the token that the GCM token that you
get upon asking for the permission also
gets changed so for smoothing out all of
these kind of cases again comes firebase
in case of firebase what you can do is
you can just call a messaging rod
request permission and that itself
returns you the token of the user that
you have to send it back to your server
this token is used to send GCM
notifications to your users the targeted
GCM notifications if I have three
notifications from X Y &amp;amp; Z and I have to
send a notification to only Y I will
take his token and generate a post call
to GCM or in this case FCM which is
firebase Cloud messaging and only a
notification to Y user will be sent or
the Y user's device will be sent
this this promise also gets rejected if
the user presses cancel or deny in case
in order to give you permission if it
does not want to give you permission you
the promise will be rejected and you can
do something accordingly at that point
of time now these are the three things
the serviceworker allows you to get to a
very fine cache-control it also allows
you to send push notifications manifest
allows you to tell how does your website
will look if it's added to home screen
but there are certain things which has
not landed so this is considered this as
a sneak peek
very soon your if somebody does an add
to homescreen your progressive web app
will not only land on the home screen
but also on the menu at this point of
time in this menu there are three
progressive web apps added and they look
just exact as any other native app in
this menu I'll give maybe a lot maybe
some slag to people who can point out
which are the progressive web apps in
this particular screen now and if you
hold long press these icons and drag
them to the top you will also see that
they will have their own storage and
permissions in the Android settings menu
itself what more can we do with these
kind of aps let's say so where P is a
another image format which is really
really small in size but instead of you
adding the code into your markup and
detecting whether or not the browser
that the user has opened your website on
supports way P or not you can just now
you are fit intercepting all the
outgoing requests swim in a very similar
manner you can intercept all your
outgoing image requests check if the
browser has web P support or not if it
does you can alter the URL and get web
peas instead so this is like one single
code which fetches jpg Zinn older
browsers and which fetches web peas
because if there is a net request
intercepted in between known as
serviceworker for the same for the same
quote but on a newer browser background
sync now this is a case where you don't
have yo user do not have network and
they try to do some interaction maybe
retweet maybe like a status and but your
user do not have a network at today's
time what probably most of us will do is
we will go ahead and tell that hey
something has gone wrong please try
again later
or the network's not there please do it
please come back later with this diagram
sync event what you can do is if the
network is not there you can take the
request inside the serviceworker since
you know that the network's not there
put it inside an index TV and whenever
network comes back an event similar as
fetch in push and even known as sync
will be fired on to a serviceworker at
that point of time you can take up all
the requests or the queued request from
the indexdb and replay them so imagine
an experience like this I will just go
retweet as much as I want go like like
the status as much as I want and when
the network comes back your
serviceworker autoplays all those
requests so user does not need to know
that ok something has gone wrong here my
networks not there
whenever the network will come back your
code will take care of it your code can
now replay all those requests at a later
point of time now some tools which help
you to see whether or not you are doing
a good job a tool called lighthouse as a
Chrome extension is now available and
you can add to add that to your Chrome
extension bar and whenever you're done
coding you can just press it and see how
good I are you doing so it generates
some report like this it it takes if
your progressive web app can load on
offline a flaky connection
it takes how fast your first
meaningful pain takes place it also
checks if the site is progressively
enhanced or it's breaking because you
have loaded serviceworker and other
things whether it's not supported okay
coming on to where exactly these
progressive web apps can work at this
point of time so chrome supports
serviceworkers chrome supports push
notifications and background sync edge
the serviceworker implementation is
under progress and behind the flag so
you can toggle that flag inside an edge
and start using service workers there
Firefox has already pushed has already
published the versions with
serviceworker support or better
supported five sorry
you see Mini in there some versions
where they use blink already supports
that and a Samsung internet the Samsung
Browser default Samsung grouser with the
new Samsung phones also supports service
workers some examples that I have come
across and you should definitely take
them out are flipkart.com housing comm
and there's there's a game paper planes
dot world also there's a directory of
progressive web app as out web dot io
you can go to this directory and see all
the amazing progressive web app that
people are building you should
definitely go check these out add these
to your home screen and see what the new
is experience looks like ok so that was
all that I had and open to any questions
that you guys have okay so this question
is how does serviceworker currently
deals with security stuff maybe man in
middle cross-site scripting so
cross-site scripting is something that
we have been dealing for quite some time
as and the addition of Service Worker
does not really change into that
particular perspective but for the man
in the middle so as I told you
serviceworker controls every outgoing
traffic and incoming push notifications
and a lot more and it's very low level
so hence serviceworker is only available
on HTTPS so it makes sure that you are
what serviceworker that you have written
only reaches your user there is no man
in the middle that can breach in and add
some other code and take control of your
page so if the serviceworker is
controlling if your serviceworker is
active it is practically controlling
your entire page what's going out and
what's coming in so hence
HTTP is a very force and very basic
requirement of a serviceworker yeah
anyone else right hi you mentioned a
different browser support what about oh
s support okay so yeah be pretty much
chrome supported on Android and all
these desktop browsers Firefox the same
Android and desktop all of these have
pretty much Android windows and desktop
support Apple is currently looking onto
the serviceworker
spec and hasn't really come out with any
official word but it's in their
five-year plan that they've published so
they have a plan which goes out so they
call it a five-year plan so it's not
necessarily that they will take five
years it's just the name of that
particular or document is a five-year
plan
okay okay so one point that I would like
to call is serviceworker itself does not
bind to any particular UI library UI
framework because this is something
beyond your application logic so it can
set up sit on top of a jquery angular
react on whatever but a polymer and
angular CLI i guess yeah it angular CLI
has an option to automatically build a
serviceworker for you yeah sure since
the serviceworker is intercepting every
individual request if you any idea of
how big the the overhead that it imposes
is okay so yes we are intercepting every
outgoing request and the Delta is
definitely definitely greater than zero
hence the most of the best practice is
you do an if check that the wins event
itself has the request object so even
dot requests what URL matches whatever
URL you want to cache or intercept if
not just returns let them fall back to
network so the brace best practice is to
first check the URL if it mia if it's
the one that you want to intercept if it
does only then do whatever operations
you want to do with it
so depending on what operations you do
and what devices get as being operated
upon the particular Delta varies on it
but it's not really really high or even
like should not be in any amount of
hundreds of MS should be below that yeah
yeah so is there any design pattern oh
yeah that's project in the sense not to
make the code messy good choice question
is the entire API is very very low-level
so the code can get messy in order to
avoid that there are a couple of layers
of abstraction and as frameworks
sw-toolbox that one I've shown as a blue
precache and please look forward to this
I oh there's another abstraction that is
coming on top of it which also builds
your wrappers for background sync as
well so they're there to help you and
minimize your coding effort really
really though yeah okay yeah
is there anything preventing a malicious
website having a serviceworker runs in
the background does a little bit and
then at a later point goes off it and
download something on you does something
when you're not aware of it
could you long yeah so as I told
serviceworker itself is awakened only by
a few kind of events that is if your
page is making a request or your pages
it's getting a push notification or your
page has requested for a background sync
and the network has gone off and comes
back on these are the only three events
where when a serviceworker gets
activated if none of these three things
are happening so we circled eventually
the browser will kill the serviceworker
in a very small amount of time after the
user closes the tab so there is nothing
malicious that you or any spammy
developer can do in a serviceworker yeah
good like it sure thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>