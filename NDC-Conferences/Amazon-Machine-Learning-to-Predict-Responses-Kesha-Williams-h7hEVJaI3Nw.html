<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Amazon Machine Learning to Predict Responses - Kesha Williams | Coder Coacher - Coaching Coders</title><meta content="Amazon Machine Learning to Predict Responses - Kesha Williams - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Amazon Machine Learning to Predict Responses - Kesha Williams</b></h2><h5 class="post__date">2018-02-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/h7hEVJaI3Nw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning can you guys hear me we're
starting right on time
Minority Report is real pre-crime is
real I love science fiction movies and
after watching a science fiction movie
I'm always left with the thought now did
the movie inspire the technology or did
the technology inspire the movie so I
have a case to share with you today
where the movie actually inspired a
practical use of the technology so let
me show you a clip
okay Janowitz come double homicide one
male one female killers male white forty
cent of a permanent tomography
I'm placing you under arrest of the
future murder of Sarah marks new demands
have the future can be seen they produce
there's nothing wrong with perfect
murder
my report okay who's seen that movie I
love that movie it is my favorite movie
of all time
and so I've seen it a billion times so
this movie is the inspiration for what
we're going to talk about today for
those of you who have not seen the movie
it came out way back in 2002 and it
stars Tom Cruise and it was set in
twenty fifty four and so it introduces
this concept of pre-crime so this is
where a criminal is arrested right
before they commit the crime because the
police officers know a crime is about to
occur and in that movie they talk about
pre-crime predictions and I started
thinking so what technology do we have
today
that can make predictions so in the
movie they use psychic technology but in
this day and age we have machine
learning so in the movie
we have pre-crime and pre-crime is like
foreknowledge so you know ahead of time
what's going to happen and like I said
that's machine learning so what are we
going to talk about today so today we
are going to look at pre-crime in 2018
we'll talk about machine learning
concepts I'll give you a high-level
overview and then we'll look at how we
implement machine learning using Amazon
machine learning I will introduce you to
a very cool case study and I'll talk
about the social implications of
computing machine bias and then I'll
have a Q&amp;amp;A now before I get started with
machine learning let me tell you a
little bit about myself so my name is
Keisha Williams I'm sure almost all of
you in your head you were calling me
Kesha but it's not Kesha it's Keisha but
that's the story of my life I currently
work at chick-fil-a now who's heard of
chick
alais okay a few of you
well chick-fil-a is an american-based
fast-food company that sells the best
chicken sandwich in the world so if
you're ever in the United States you
have to try chick-fil-a I've been with
the company for about 13 years now so a
pretty long time I currently really have
two roles there so I have what I call my
day job and I have my night job and so
my day job which is boring I am a full
stack web developer so on the front end
I work with angular and on the back end
I work with Java and spring now that's
the boring day job now the the night job
the fun part of my job I actually get to
lead innovation teams as we research new
and emerging technologies like machine
learning IOT facial recognition virtual
reality so I lead teams and we build
prototypes just testing out the new
technology to see how it can improve
restaurant operations and customer
experiences while inside and outside of
the restaurant and so one team that I
recently led we won the think different
Innovation Award for using artificial
intelligence so a lot of the lessons
learned I'll be talking about here today
now I also invented a pre-crime
predictive policing machine learning
algorithm so inspired by Minority Report
and that's our case study for today so
we'll crack open the code on that case
study now on a more personal note my
husband is actually from London so he
grew up and made a veil I've been here
many times I love the city and he does
tell me on an almost daily basis that as
an American I butcher the English
language so let the butchering begin
so what is machine learning so the
technical term the official term it's a
subfield of computer science it was
coined way back in 1959 by Arthur Samuel
and it gives computers the ability to
learn without being programmed so what
does that really mean in layman's terms
the type of machine learning that we're
going to talk about today it's a program
that basically analyzes past data to
make predictions about the future it's a
pretty simple concept we all have heard
the phrase that past behavior is a good
indicator of future behavior and so
that's what machine learning does and so
the program finds patterns and
historical data and it builds a
mathematical model and then that model
is used to answer new questions or make
predictions on when new data arrives
now machine learning can help you
understand historical data to make
better business decisions it's really
cool so general uses of machine learning
now when I first started learning about
machine learning I was really surprised
to learn about where it's all used today
in society so who knew that sometimes
whenever you apply for a loan a car loan
or a home loan there's a machine
learning program that makes a prediction
on whether or not you'll default on that
loan and then that may say yes or no if
you get that loan employee hiring who's
heard about that I was surprised to see
that there are some companies that use
machine learning to see if you'll be a
good fit for a company you're trying to
work for healthcare now this one is
really amazing because it's actually
life-saving so there are some machine
learning programs that are really good
at predicting certain forms of cancer
long before a diagnosis
and that is like I said life-saving and
pretty amazing it's also used in
personalized marketing recommendations
who in here has Netflix or Hulu so every
time you log into Netflix it's always
recommending a new TV show or a new
movie that it thinks you may enjoy
watching so there's a machine learning
algorithm behind that prediction it's
used to combat financial crimes so there
are machine learning algorithms that
study pass financial transactions that
you make and whenever it notices
something that's out of the ordinary or
an anomaly it helps identify fraud so
that's called anomaly detection that's
really cool too and then law enforcement
and in the court house now this one I
was literally blown away when I learned
that there are some judges in the United
States I'm not sure about over here but
they used machine learning to help to
predict whether or not someone will be a
repeat offender and unfortunately if the
Machine says yes you're going to be a
repeat offender you may not get out on
parole and so that was really
mind-blowing when I heard about that so
machine learning is used all over the
place now machine learning can be
applied like we just saw across so many
domains and it's really good when you're
working with large datasets so there are
too many records for you to manually
review so for example if you're looking
at ten emails and you're trying to
determine if they're spam it's easy as a
human to review ten emails but what
about thousands of emails that's just
not humanly possible so a machine can
help with that
so when the rules can't be coded because
they're just too many factors that
influence your decision machine learning
is good for that and then also
data-driven learning now what machine
learning is not so when I started
learning about machine learning I
oftentimes can
used it with business intelligence who's
heard of bi or business intelligence
right so business intelligence the way I
think about it it deals more with the
past and it gives you charts and graphs
where you can visually see your data and
you as a human you make decisions so I
have a chart showing up here that's a bi
I'm chart and it can answer questions
like what percentage of crime in the
state of Georgia that's where I'm from
in the United States happens in Cobb
County
that's the BI question calculate the
number of vehicle thefts versus assaults
that again is a bi question now machine
learning answers the types of questions
like what's the likelihood of a crime
occurring in this County at this time of
day given these circumstances so when we
talk about future what can happen in the
future
that's machine learning so machine
learning can do amazing things but there
are instances where machine learning
would be an overkill like taking a
sledge hammer to a nail is just a bit
too much and so when simple rules work
simple computations when you have
predetermined steps that you can code
ahead of time and the steps will always
be the same that's when you should not
use machine learning now let's talk
about predictive policing who's heard
this term it's a really hot topic right
now
and so predictive policing uses
predictive analytics ie machine learning
to determine the likelihood of crime and
it's called an innovation that's capable
of stopping crime before it starts now I
don't know about you guys but that
sounds exactly like pre-crime to me and
there was an article published last year
by Stanford University it's a very good
article I recommend that you guys read
it it's called
artificial
intelligence and life in 2030 and so in
this article they talk about how within
the next 15 years society will heavily
rely upon predictive policing so I
started doing more research about this
field and I was really surprised about
what I found out so I mentioned to you
earlier about judges using machine
learning in the court house so this was
a study done by the University of
Pennsylvania and they found a 50% drop
in new domestic violence cases because
machine learning was used in the court
house that is a big number
UK Metropolitan Police have you guys
heard about the hotspot maps so the UK
Metropolitan Police very close to home
uses machine learning to produce hotspot
maps and so the hotspot map shows an
area in the city where crime is likely
highly likely to occur and so forces are
then deployed to those areas with the
hopes that it would reduce crime with
the increased police presence and so the
number is a 26% drop in violent crimes
using machine learning
that's pretty amazing even in Pittsburgh
Pennsylvania the police department uses
something similar to the hotspot Maps
here in this picture you'll see the
police officers driving around in his
car with a computer and so that computer
is running machine learning telling him
where he needs to go in the city to
patrol so it's the same concept of a
hotspot area an area where crime is
likely to occur even in Chicago now this
one did not go over well so by show
hands who's seen that it's an American
TV show called person of interest okay
so I am 100% sure that that TV show was
inspired by what Chicago did
so show cago created this using machine
learning you they created this strategic
subject list or heat list so it
basically identifies people that they
believe the algorithm believes would be
involved in a violent crime
so either you are a victim of a crime or
you are the person committing the crime
and so Chicago actually sent letters and
the mail to these potential victims or
potential criminals and some even had
police officers visit their homes and so
the backlash from the community it did
not go over well for Chicago so they
stopped the program but I'm pretty sure
they're still experimenting and trying
to figure out how they can use machine
learning to predict and prevent crime so
free crime in 2018 is called predictive
policing and predictive policing uses
machine learning so when you combine
predictive policing and machine learning
what do you get this is what you get
this is our case study for today so his
name is Sam don't laugh at me I just
happened to name all of my program a I
programs that I create so his name is
Sam Sam stands for suspicious activity
monitor okay so Sam is a predictive
policing machine learning algorithm that
I created using Amazon machine learning
so the way Sam works anyone walking down
the street can take a picture and tweet
it to Sam Sam then uses computer vision
to pull attributes from the photo about
the person so age gender some additional
information from the tweet and then all
of that information is then sent to
Sam's machine learning brain and so that
brain looks at those attributes I
trained him on
and Georgia Bureau of Investigation GBI
so he only works right now for the state
of Georgia that's where I'm from
I trained him on GBI data past crime
data and he uses all of that information
to make a crime prediction and so that
prediction is then sent back to the user
as a tweet and so the user may see
something like you need to run for your
life
or you're safe you know there's no crime
about to occur and so that is the case
study that we're going to crack open
today and walk through how to create
that using Amazon machine learning so
just to give you a quick demo of Sam so
let's say you have a Twitter account and
I'm giving myself away I love reggae but
let's say you have a Twitter account and
you want to send a tweet so you tagged
Sam and you put the county and the state
and then the photo that you took you
include that in the tweet
okay so now in the background there's a
lot going on and in a moment we should
see a notification appear here yep there
we have the response and so Sam's
politically correct answer I see several
factors that indicate the likelihood of
crime be vigilant so that is our case
study Sam so let's look at Sam's
architecture so as you can see his
entire well 90% of his ecosystem runs on
Amazon Web Services so he's totally
serverless
so let's look at step one so step one
you have the user sends a tweet with a
picture someone they believe is involved
in suspicious activity and so that is
stored in the Twitter database and then
step two over here within AWS there's a
lambda who's familiar with lambdas so a
lambda think of it like a function a
chunk of code that just runs in the
cloud and so there's a lambda function
that uses the Twitter API to retrieve
the most recent tweet and then that
lambda function pulls the photo from
that tweet and then sends it to this AWS
recognition service now we're not really
going to talk about AWS recognition
today but just know it's a computer
vision service and it allows a computer
to analyze a photo or a video pulling
out objects scenes sentiment just
information from the photo and so AWS
recognition extracts image attribute so
specifically it pulls gender and age and
also sentiment whether or not the person
is happy or sad so that information is
the
sent to the machine learning portion of
Sam and so along with age and gender I
pull County and state time of day day of
week and then up and so that information
is sent to the machine learning brain
and it generates a prediction that sent
back to the lambda and then the lambda
sends that prediction back to the user
as a tweet
so today will specifically look at the
lambda portion and the machine-learning
portion okay so how do machines learn so
there are three main ways that machines
learn the first is supervised learning
the second is unsupervised learning and
the third is reinforcement learning so
what does that mean so with supervised
learning and this is the type of
learning that we're going to really dig
deep into to today because that's what
Sam uses supervised learning
so this is where machines are taught
with data that already has the answers
okay
and we'll see this later with Sam so we
call the data with answers labeled data
and so Sam studies the labeled data to
learn what crime looks like and what
crime does not look like and so in that
data set we have records that indicate
crime and we have records that don't
indicate crime so he learns how to
predict crime based on analyzing that
data so when we talk about supervised
learning what types of questions can a
machine answer so there are three types
of questions
binary multi class and regression so
what does that mean and those are called
classification problems so binary a
computer can answer a binary question so
this is more like a yes-or-no type of
question you're predicting one of two
possible outcomes so examples would be
is this email spam or not that's a
binary question will this person be a
repeat offender or not
is this person a good fit for this
company will this person like this movie
will this person buy this coffee flavor
and yes I know my flavors missing the
multi-class so this is where you have
one of many possible outcomes so for
example is this item I'm looking at a
toy a movie or a book a computer can
answer that question will this person
like vanilla mocha or caramel flavored
coffee computer can answer that type of
question and is this movie a comedy a
thriller
or a documentary so this is where you
have one of many outcomes thirdly
regression so this is where the computer
is predicting a numeric value so what
will the temperature be in London
tomorrow for this new coffee flavor how
many units will sell what is this
person's life expectancy those are
questions that computers can answer
so that's supervised learning and that's
what we'll talk about more today
now there's also unsupervised learning
so this is where machines have the data
but they don't have the answers so they
really have to go in there and just
figure out on their own what's happening
what's going on and honestly this is
what causes the most excitement and buzz
in the industry when we talk about
machine learning and so Amazon machine
learning does not support unsupervised
learning there are other tools that just
came out on the market like sage maker
they release that at reinvent reinvent
handles a lot more complicated
unsupervised learning problems so when
we talk about unsupervised learning what
types of questions can be answered so
clustering and grouping type questions
customer segmentation recommendations
target marketing so for example let's
say you have a law
customer data set and you want to figure
out who your customers are you can use a
machine learning unsupervised program to
group and kind of segment your customers
find patterns and commonalities between
them so at the end of the process you
may have a group that's a working
professional or a stay-at-home mom or a
student it helps you just cluster and
identify your data
there's also reinforcement learning so
this falls somewhere between
unsupervised and supervised learning so
the data the computer still doesn't have
the data I mean the answers to learn
from but it has the data but at each
predictive step it gets feedback so you
see this a lot in robotics so let's say
you have a robot that's trying to make
its way through a maze and it hits a
wall the first time well the next time
it knows there's a wall there so it
doesn't make that same mistake
so that's reinforcement learning it's
where the machine learns from mistakes
and it adjusts it for the future so I
think that's a great life lesson so now
let's talk about the machine learning
process or the data science process so
once you formulate the problem or the
question you're trying to answer through
machine learning the process is
basically the same so first it will look
at all of these in detail first you have
to get your data you have to have your
data and then you have to explore and
understand that data then you prepare do
any data transformations and then you
load the data and then you train the
model so this is that whole learning
process that I mentioned to you earlier
and then you evaluate and optimize the
model you enable it for predictions and
then you start using it sounds very
simple right
so now this is where it gets fun
so now we're going to look at using
Amazon machine learning to go through
that machine learning data science
process I just explained to you now
Amazon machine learning is a service
that makes it very easy for developers
from all backgrounds to create and
utilize machine learning models so for
example I told you guys my day job I'm
basically a Java developer but over one
long Spring Break week I was able to use
Amazon machine learning to build Sam and
so that just goes to show how easy it is
Amazon machine learning provides wizards
visualization tools and it allows you to
use machine learning without really
having to get in there and understand
all of these complex algorithms and
technologies so it is a very neat
service and once you've created your
model basically Sam you can enable an
API endpoint so that any application
that can make an HTTP request can use
your model to make predictions so it's
really really cool
so the first step that's obtaining your
data so you need to have data that you
can teach the computer with and so for
me
I was looking for crime data and so
luckily GBI Georgia Bureau of
Investigation they have a website where
you can go in and download past crime
stats and I was very surprised when I
saw that all this information was
readily available online so I went
through the process of downloading
multiple files and then I had to go
through the process of combining them
into one file and then really just
exploring and understanding the data so
at the end of the day the model that you
produce is only as good as the data that
you feed it so it's very important that
you understand the data
and so what I did I went through and I
use bi business intelligence initially
just to understand what does crime look
like in the state of Georgia and so I'll
have some charts to show you but here
this is just a summary of vehicle theft
by county and then here this is a
breakdown of the different types of
crimes per month in the state of Georgia
and so I don't know what it is about
August and July maybe it's the Georgia
heat it just makes everybody go crazy
but August and July have the most crime
during the year in Georgia and then this
is a breakdown by county so if you're
ever in Georgia stay away from Fulton
County this is Fulton County over here
all this crime now if you want to come
visit me in Fayette County where there's
no crime basically Fayette County is a
nice place to live I'm glad I made that
choice but this just helps me understand
how crime breaks down by county okay so
what did I learn from the data so
there's a lot of burglary in December
and January I'm assuming that's because
it's around the holidays and you need
money to buy Christmas gifts I don't
know but December in January a lot of
crime most assaults are committed by 22
to 29 year olds vehicle thefts peak in
August again that's a hot summer month
most vehicle theft committed by 16 year
olds and under I guess they want to go
joyriding with their friends I'm not
sure and sorry guys it says men conduct
more crime than women and there are
certain counties that have way more
crime than other counties okay
so the next step is to actually prepare
and load your data and this is honestly
the most time-consuming part of the
process I had to go through a process of
cleaning up the data and then also I
wanted to break out the data so for
example what some of the crime data that
I received from the GBI it had a date
but I wanted to break out the month so I
could find patterns amongst the months
and then the day so I wanted to see if
certain crime occurred
more on certain days of the week so I
had to go through and manually break
that out for all of the records and so
this process of going through and
breaking out and transforming the data
it's really called labeling because at
the end of the day in that file I had
the answer to the question I was trying
to answer so does this row show crime
yes or no does this row show crime yes
or no and so the positive crime records
I was able to get from the GBI now the
negative crime records I had to create
myself so I had to show how to teach Sam
what crime does and does not look like
now in an ideal world like if I lived
here in the UK I'd work with the UK
Metropolitan Police does anyone have any
contacts there I'd work with them to use
their data and train Sam on their data
so I would have real data from the UK
Metropolitan Police showing crime maybe
arrests versus convictions and things of
that nature so I always say Sam is a
case study it's a prototype it's
something I created over a week so he
should never be used in a real crime
situation just I have to put that out
there ok so this is a good look at the
file that I trained Sam on so if you
notice at the very top I have what we
call variables or features so these are
the attributes that that are basically
used to I
identify patterns in crime for the state
of Georgia so we have county state time
of day gender age day of week month and
then notice here this is the target so
this is the answer and notice it's
binary so zero one yes or no and so like
I said this was really the most
time-consuming process creating this
training data for Sam so let's look at a
few of the observation so here's a row
that has Cobb County state of Georgia
Knight male 30 Saturday August yes that
row indicates crime so that's a positive
crime record a negative crime record so
Cal WIDA County evening female 50 Monday
August
so the negative crime records I created
in this row shows no crime so that's the
learning process for Sam he looks at all
of the records and he learns what crime
looks like and what crime does not look
like lessons learned so the very first
time I loaded the data and I went
through the training or the learning
process with Sam the process failed and
it failed largely in part because I did
not shuffle my data and so going back to
that Excel spreadsheet I just I like to
sort things I like things to have order
so I sorted the spreadsheet by the
committed crime and so we'll talk about
this later but when we go through the
training or the teaching process
typically how it works the machine
learning program will use the first 70%
of your data to learn from
and then it uses the remaining 30% to
test itself to see how well it it is how
well it's predicting crimes so because I
sorted that spreadsheet it through that
whole process off and I saw this big red
failure the very first time so lesson
learn if you guys play around with
Amazon machine learning
make sure you shuffle your training data
okay so now I have that data the
training data I have to load it to a
place where Sam can easily get to it
Amazon machine learning and so who's
used s3 before who started that okay so
it stands for simple storage service and
you basically you can think of it like a
file system on the cloud so a place
where you can upload documents and so I
uploaded the training data that Excel
spreadsheet to Amazon s3 so now it's in
a place where Amazon machine learning
can get to it so this is where we start
the training process so this is where
the algorithm actually learns and
studies and finds patterns and the data
to produce what's called the model and
you may have heard me say that term
before I'd like to think of the model as
really it's the brain of the machine
learning program so it's really the
artifact that's produced after training
and you use it to generate predictions
and so I used of course Amazon machine
learning and like I said earlier it
makes it very easy for developers to
build machine learning programs it
really takes away all of the
complexities and it makes it very simple
and so I always tell people Amazon
machine learning is a great place to
start if you've never used machine
learning before it's a great way to be
introduced to concepts
and then also tools when you reach a
point where you're very confident in
machine learning then I would recommend
that you look at Amazon sage maker like
I said earlier Amazon machine learning
does not handle unsupervised learning
and more complex type questions but it's
a great introduction so the model like I
said before it's really the important
piece I call it the brain of the machine
learning program and it returns
predictions so think of it like sending
questions in and getting answers back or
predictions back so how do you create a
model using Amazon machine learning it's
very simple first you create your data
source and we'll look at that sanity
check your data make sure everything
looks right and then you go through the
training process so from a screen
perspective the first step is to create
a data source so remember I loaded the
data to Amazon s3 so basically here on
this screen I'm pointing to that data
file so the data source is like a
pointer to the data file on s3 and so
once you point to that data file you
have to go through this data source
mapping exercise so for each attribute
in that spreadsheet what's the date
what's the data type so they have
categorical and that's like a list of
values and then numeric that's a number
and then binary so binary is it shows
the answer if you guys remember here
that's 0 or 1
that's the committed crime
and so after that the data source is
created so now Amazon machine learning
can see that data file and so the next
step is to explore your data and
understand it to make sure it looks
right so you click on this target
visualization here and you'll see a few
charts so here's just showing you the
amount of records that it found it's a
great way to sanity check to make sure
your data loaded correctly and then you
can also see it on a per field level so
here I just did a quick sanity check for
example day of week has seven unique
values so for example if this said ten I
know there are not ten days in a week so
that means something is off with my data
so it's very important to just sanity
check your data and make everything make
sure everything looks right and then you
click create train and m/l model and
then everything magically happens behind
the scenes but I'm going to show you
what happens under the hood okay so you
create and train that model and you'll
come to this screen here and do you guys
remember where I spoke about that 70/30
split so it's on this screen where you
really set that up so the default is the
model will use the first 70% of your
data to learn from and then it uses the
remaining 30% to test itself to see how
well it's doing and so that's the
default you can customize it using this
side of the screen but I just left it at
70/30 and it's important to note and
I'll talk more about this that after the
training process is finished you have
your model that model gets an accuracy
score so how well is the model at
predicting
and so it's very important for you to
analyze that as well okay so the magic
that happens behind the scenes for you
when you click that button there's a
learning algorithm and the way Amazon
machine learning works it basically
picks the learning algorithm for you but
let's talk about what is a learning
algorithm and so it's a part of the
training process and it consists of two
elements a loss function which is the
penalty that's incurred for guessing
incorrectly and then there's the
optimization technique that seeks to
minimize loss so during this training
process just think of it like making
sequential passes over the data
analyzing the data finding patterns
trying to minimize loss and really get
to a model that is good at making a
prediction so the learning algorithm
really it uses SGD which is the cast ik
gradient descent and it's just really
like I said it's making sequential
passes over the data to produce this
model so under the hood like I mentioned
Amazon machine learning automatically
picks the learning algorithm for you you
don't have an option you can't change it
so if you're trying to solve a binary
problem it uses what's called logistic
regression and that's what Sam uses if
you're trying to answer a multi-class
remember that's one of many it uses
multi nominal logistic regression and if
you're using regression that's that
numeric value it uses linear regression
so Amazon machine learning really only
supports linear based models but they're
again all of that is automatically
chosen for you underneath the hood you
don't have say over what hap
it's okay and so once you click that
button and it creates your model all the
magic happens then it's really important
for you to evaluate and optimize that
model so how well does that model
perform and so Amazon machine learning
assigns a quality metric it's called the
area under curve for binary AUC and
we'll look at that and so it's up to you
to really understand how well your model
is performing and then you have the
option to adjust it for your tolerance
level for errors so let's look at that
so for binary it uses the quality metric
is AUC area under curve and so for
multi-class it uses something called a
confusion matrix I guess that's how
confused is the model I don't know and
then regression it all it uses root mean
square error or mean absolute percentage
error so all these fancy mathematical
terms so for Sam he uses area under
curve that's his his quality metric and
when I first started learning about this
I was like okay so Sam actually grades
himself so that's like me grading my
homework I would always give myself 100
but remember when I said that 70/30
split so it's that last 30 percent Sam
uses two really great himself to see how
good he is at predicting because he
already has the answers okay
so Sam's a you see is 0.897
which is really good because the range
is from 0 to 1 and so when we talk about
AUC the area under curve it basically
counts how many times for particular
things occur
so if you see at the bottom we have this
true negative so that's where Sam
predicts zero no crime and he should
have predict that so it was right and
then we have this thing called a false
negative where Sam predicts a zero no
crime but he should have said yes a
crime so he failed to predict a crime
and then there's this false positive
where Sam predicts a one he's saying yes
there's a crime when there really isn't
a crime and then the true positive so
that's where Sam predicts the one and it
was a one so because Sam's a you see was
pretty high I left it alone I did not
adjust the tolerance levels but you can
so down here there's a slider that you
can move to adjust your tolerance level
for false negatives and false positives
and you'll see all of these numbers
change as you move the slider so when we
think about the model Sam there are two
mistakes that he can make one that's the
false positive where he can say yes
there's a crime when there really isn't
one and that's the false negative where
he says no there isn't a crime and there
really is one
so what do you guys think is is worse
false negative or false positive they're
both pretty bad when we talked about
crime it's really and that's the tricky
thing it's really up to the developer
right and so from me it's the false
negative so when Sam thinks there's no
crime but there really is one
so for me that's saying an innocent
person is being victimized and the
criminal is getting away so for me
that's not really good and so I could
change my tolerance level to say I will
consider more false positives on the
flipside that could be considered
harassment so it's really it's
a tough call it's a tough call but just
know that if you use Amazon machine
learning you have the ability to adjust
your tolerance level for false positives
and false negative so that's very
flexible okay and so that's it that's
all it takes to build a machine learning
model with Amazon very simple and now
that you have that model you need to use
it and you can use it to make batch
predictions so predictions in bulk or
you can use it for real-time predictions
and that's what I did with Sam and so
you can enable your model for real-time
predictions and then you'll get this
endpoint URL that you can call from any
application that can make an HTTP
request that's really cool
now I will say there is a cost to using
Amazon machine learning it does not fall
under the free tier unfortunately and so
there's a there's a a one-time fee that
you pay whenever you create or train a
model and it's basically how much memory
do you use how long does it take to
create that model so there's that
one-time fee and then when you enable
the model for real-time predictions
there's a fee for kering fee just for
having the model up having that this
endpoint available there's a fee and
then every time you use this URL to make
a prediction there's a fee so just to
level set to give you guys a baseline
when I created Sam I paid about a dollar
and 12 cents US dollars so it's very
cheap and typically I'll leave Sam
running whenever I'm speaking at a
technical conference because I just I'm
cheap I don't like paying a lot of money
but the most I've really ever paid to
have him running for a month is about 11
dollars now the more he's used
the higher that cost goes up but just so
that you're aware it's not a part of the
free tier okay and so the next step is
to actually use that URL in an
application so let's look at that and so
now we're going to look at Sam's front
end remember that lambda I spoke to you
guys about so there's a Python lambda
that's this piece here that actually
calls that URL do I have any Python
developers in here
cool so of course like I said before I'm
a Java developer but I love learning new
things so this was my very first time
writing Python code and I must say it
was a lot of fun I could actually get a
lot more done in a few lines of code
comparing to Java so the code that I
have developed it's on github and that's
the link and so now let's look at the
code so I'm just going to show you the
next three slides the code and then I'll
break it down section by section and the
following slides so that's the first
it's the second and that's the third
okay so now let's go section by section
okay
so in that Python lambda remember that's
just a cove code running in the cloud
think of it like a function I'm using
the boat o3 Python library so this is
the AWS SDK for ax X accessing Amazon
services so you can call AWS from Python
using photo 3 so here I'm creating an ml
variable initializing it to machine
learning and then I'm using the model ID
so back in the console when we generated
that model it gets a unique identifier
so you can find that
the console and you'll need it in your
code and so here this is the default
lambda Handler and notice here I'm just
setting those attributes that Sam needs
in order to make a prediction so this is
just a quick way to test them and then
the response
I'm calling this gate crime prediction
function remember that API URL and then
I'm passing in the data attributes now
you can omit these some of these values
like if I didn't have time of day I'm
not required to pass that in but then
that greatly reduces Sam's prediction
his predicting capability so I would
recommend to always include all the
attributes needed okay and so I saved
the response and if I get back a zero
from Sam he's predicting no crime if I
get back a one he's predicting crime and
so the response for no crime is I see no
factors that indicate the likelihood of
crime for crime I see several factors
and that's the one that we saw in the
demo okay so now let's look at this gate
crime prediction function so notice in
here I'm using I'm calling the predict
function on that machine learning
variable and I'm passing in the model ID
and then the record and then the
endpoint URL and that gives me back my
response in this prediction so that's
JSON that comes back and the value
notice here is stored in predicted label
so that's where I get my response back
zero or one
and then this is me showing the results
of testing that lambda in the console
and so Sam returns a 1 and it's I see
several factors that indicate the
likelihood of crime and so you can test
your lambda through the console and each
time you test it that's calling the URL
end point so there's a charge for that
just so you know and so like I said when
you're not actually using this real time
endpoint make sure you delete it so you
don't have a big bill so that's the red
X okay and so things to note data must
reside in Amazon s3 or on redshift your
model can't be exported and like I said
before it doesn't support complex
problems when it comes to unsupervised
learning like clustering and grouping
and recommendations oh and that's the
next bullet point it just doesn't
support that so in the last few minutes
I do want to talk about quickly about
machine bias and so who's heard of
machine bias who thinks it's a good
thing at no hands and so with great
power comes great responsibility
so Amazon machine learning puts very
powerful tools in the hands of everyday
Java developers and so when I built Sam
I wanted to make sure at least from a
race perspective he could never be
accused of racial profiling and so for
example let's say in his training data
set I included race and every single
time there was an african-american I
said yes that's crime so Sam is going to
learn that every time he sees an
african-american I'm predicting crime so
that's not good
so as developers we have a moral
obligation to make sure that the
programs and models machine learning
models that we create that they are
really
and fair because at the end of the day
it really could destroy someone's life
so you guys have a responsibility as do
I so what's the future of machine
learning
so Google recently announced they are no
longer a mobile first company they are
an AI artificial intelligence first
company so our reliance on artificial
intelligence and things like machine
learning will just continue to grow and
what's the future of predictive policing
well u.s. Mattila military surveillance
will continue with what we call
autonomous smart machines and I believe
that they will continue to get smaller
and smaller and smaller
and so I'm just very excited to see
where this technology takes us really as
a society so what's the future of Sam
there are a lot of cool things I'd like
to do with Sam
I'd like to make him more real time so
right now he runs every 30 minutes and I
also have an IOT button that kicks off
the lambda but using Twitter streams API
and AWS Kinesis I can make the flow
real-time so the second a tweet comes in
it flows over a kicks off machine
learning and get a response back facial
recognition so Sam already uses computer
vision so he can potentially identify
who that person is in the photo and then
potentially look at their criminal
history things like substance abuse and
that can help him make a better
determination
maybe one day kick it off with Amazon
Alexa that would be really cool a fun
learning experience and then I'm
actually working on this one using a
drone as the camera for Sam that's
really cool
so I know I've covered a lot today and
so everything that we've talked about
all of the sample data files that I used
to train Sam with and just the steps and
screenshots I've documented here on this
course the secrets behind Sam and I
usually charge for that but I'm leaving
on Sunday so around Sunday I'll turn the
price back on but right now it's free
so it's good to just if you guys want to
dig a little bit deeper and create your
own version of Sam you can use that link
and so that's it I'd like to open the
floor to questions yes
yes yes yes I created those yeah based
on my understanding of the crime stats
yeah and so like I was saying in a in an
ideal situation you would not want to
create your own data but I did it
because Sam is just really a proof of
concept to prove out what the technology
can do I have a dream to work with the
Atlanta PD to actually have their data
like arrests versus convictions and just
have real data to train Sam on but
really I created Sam just for the
learning experience I wanted to learn
more about Amazon machine learning so
it's not like a tool that I'm trying to
sell or make money on it was just all
about the learning yeah any other
questions
yes pardon me I test and up I play
around and there's a part that 70/30
split so that 30% Sam actually used to
grade himself and so his score was 0.897
that was the quality metric and so he's
really good at predicting crime yeah but
again I would never use him in a
real-life crime situation yes
yes so I was able to download all of
that information from the GBI the
Georgia Bureau of Investigation and it
include it includes like race it
includes age and includes gender and all
of that like time of day day of week and
all of that good stuff yeah and I
actually searched and I found somewhere
for the UK data that you could actually
download that would be really cool to
play around with yes yeah definitely so
that there is that that retraining
process of the very first time you
create a model don't think you're
finished as you get more data you should
retrain the model so that it becomes
smarter and even better at predicting
great question
any other questions okay so did I
butcher the English language I'm going
to tell my husband that thank you very
much thank you you guys have been
awesome</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>