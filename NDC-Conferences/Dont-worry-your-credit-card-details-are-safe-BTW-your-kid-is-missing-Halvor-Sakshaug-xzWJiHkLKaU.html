<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Don't worry, your credit card details are safe. BTW your kid is missing! - Halvor Sakshaug | Coder Coacher - Coaching Coders</title><meta content="Don't worry, your credit card details are safe. BTW your kid is missing! - Halvor Sakshaug - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Don't worry, your credit card details are safe. BTW your kid is missing! - Halvor Sakshaug</b></h2><h5 class="post__date">2017-07-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xzWJiHkLKaU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome this is going to be about the
little kids those who are old enough to
say YouTube and click the icon but still
don't know how to type it does anyone
here speak Swahili you do can you say
the word for this fruit that's right
it's just like the name of this
conference just put the stress on the D
in DC so after my wife and I learned
some Swahili a few years ago we have
referred to this as the banana
conference this is my first time
speaking here
I'm the application security lead at
confirm it here in Oslo and for us at
confirm it security is important because
we have data to protect just like
everyone else our customers use our
software to do political polls and
employee surveys and various other types
of surveys and for our customers and for
those who respond security is important
and then our customers may take the data
that they have collected combine it with
financial data or performance data and
analyze it make a report on it and
that's their product or that's their
trade secrets security could be life or
death for them and for us so first who
has kids it's a simple question just
raise your hand if you have kids yeah
well you know when you have kids you
immediately start to care about their
safety and one of the first things you
do you go out and buy a car seat what
you care about is does it fit in your
car and is it one of the most secure on
the market then you head over to Ikea
and buy a lot of stuff now after all you
don't know if this is about securing
your kid or securing your home and then
you start to buy toys and you learn that
well there are things that could be
dangerous with toys many different
things but if it's really bad those toys
will be banned they'll be
illegal they can't be sold because we
have laws and regulations for that but
then we have things like the Kayla doll
there will be a talk about Kayla
tomorrow here at the banana conference
and Kayla is a talking doll it's
internet-connected and it has crappy
privacy and security and German
authorities banned Kayla because they
classified it as a spying device now no
other countries were able to ban Kayla
if a child was strangled because of the
hear that would be okay but that privacy
and security that's okay
well there is one place we generally
don't film where we're not worried about
security and that's when we send our
kids to kindergarten we worry about
other things there but not about
security and often not when the
kindergarten start using online
communication services you may ask why
do a kindergarten need an online
communication service well this is one
of the reasons it's the door of text
this is the last door I see when I leave
my son's kindergarten it's a lot of
information there my kindergarten or my
son's kindergarten is using an online
service so this is mostly redundant for
me but in other places you're expected
to comprehend what's written here and
when do you see this it's either in the
morning when you rush off to work or in
the afternoon when you have picked up
one or more kids and you're all tired
and you want to get home so many come
many kindergartens have this as their
primary communication some of them are
kind and they copy it on a piece of
paper which where do you put it and the
calendar for this month it's on your
fridge but your fridge is not here or
when I
need to send an important message to the
kindergarten I could call them but if
you have been to kindergarten you know
that it may be a chaotic place at times
your message may not get through and
then these systems can also be used for
attendance because kindergartens need to
know which kids are here and they can
also be use for other purposes such as
telling the parents when the kids poop
or sleep and last fall my son started in
a new kindergarten and they told me we
use an online kindergarten service and
you will need to use it if you want to
have any information from us and
communicate easily back and one of my
first thoughts was well I wonder if
that's secure and I would later find out
and talk about it here
well this service that my son's
kindergarten is using has an old version
which is made for desktop browsers and
they also have a new API serving the
responsive page and mobile applications
and for a hacker this is fantastic we
have doubled the attack surface I'm not
going to name the fight but I'll call it
cloud kids dot n o if you have used it
you may recognize it but as we are here
at the banana conference to learn I will
use this service as some great examples
of what we should not do because the
only thing that's better from learning
the better than learning from our own
mistakes is learning from someone else's
mistakes but as I progress through this
talk please keep one thought in your
mind what would happen if these flaws
existed in my service or to put it in
the words of Jesus why do you look at
the speck of sawdust in your brother's
eye and pay no attention to the plank in
your own eye if my claim is that if you
haven't introduced a security
vulnerability you probably haven't made
software now some of the flaws we
introduced weren't as bad as what I'll
show you and some were a lot worse and
some we managed to fix in time now
speaking of in time cloud kids has now
fixed everything I will show you and
more so there will be no live demos
sorry for that so when I started using
cloud kids I could see this in the
address bar of every single page
everything loaded over HTTP that's good
and then the browser would tell me
secure and many people would think that
well yes then this is a secure site well
not necessarily it just means that
communication with the server is
encrypted and to know if it's a secure
site we'll have to look at the details
and we'll even have to test a few things
out and we'll start by looking at the
response headers if you want to look at
the response headers you can place them
desktop browsers you can hit f12 and
then you can hit the network tab or you
can use a web proxy I use fiddler I use
it for a lot of things and I love it so
when I loaded the login page oh cloud
kids the response setters looked like
this now this is not what I'm going to
focus on right now it's what's not here
and what's missing here is for instance
security headers there are no security
headers and this being the login page I
would at least expect this expects one
or more security headers preventing
framing of this page because if it was
framed it would be quite easy to steal
passwords well you still have to trick
users to your friend page but you could
steal passwords that way another thing
here is line number 3 server I never
seen this used for anything ever the
only purpose of this line is to tell
people that you're running a vulnerable
version if
you do so what I did was that I took
here open us a cell 102 a and copy that
into Google and added vulnerabilities so
I got a list of publicly known
vulnerabilities on this version 36 of
them because it was 22 and a half months
old and there were 10 newer versions all
with security fixes four of them had a
maximum score for the floss yeah then
the first lesson is always keep your
third-party software up-to-date so now
let's log in so I'm here at a login page
and I enter my username and password and
click login then I go to the first page
and on the first page I click on any
link to go to the second page and I go
there then I hit the back button in my
browser and I don't go back I get this
warning that I'm about to repeat an
action and I could of course be bad if
you are then making a double purchase or
it could be embarrassing if you double
commenting something but here you're
doing a double login well if this was
your computer and I knew about this I
could hit the back button until I got
this then I could hit f12 and I could
reload the page and I could just read
your user name and password
now let's kill a myth some people claim
that usability and security are
opposites
well if you fix this one well you get
both so it's not always true well I
guess it's true sometimes but in
everything I found here that when it was
fixed usability didn't suffer well some
people can argue about one point but I
guess most users would want security
so you may ask how do we fix this and
that's lesson two when passwords are
posted always do a redirect like a 302
even if the password is wrong that would
prevent it and the UI would be better
so we're eventually going to get into
some hacking people love acting of
course and I think that hacking has a
lot a lot in common with ARC now
advanced hacking and fine arch they
require talent technique tools novel
ideas and great creativity while other
times it's more like modern art it's
simple and this is how it was with cloud
kids it was simple it was just about
being first so getting there soon but
before that need to define something the
difference between authentication and
authorization because we tend to get
this wrong now of course we abbreviate
them to the same four letters off so
makes it harder and also if we read the
HTTP specification for status codes we
see 401 unauthorized and the explaining
text starts with the request requires
user authentication so authorized and
authentication
well they screwed up and we're still
suffering from this and we will keep
suffering from this sorry so what are
they authentication is about who you are
and you claim who you are to the server
first if your username and password and
perhaps other things and then with an
authentication token often the cookie
authorization on the other hand is about
what you're allowed to do so do you have
permission to see this page or to
see this object you have permission to
modify or delete this object and pleased
if you know region
remember back in January there was the
new amo app you could look it up what
anyone else had bought at the grocery
store that was pretty bad and around
that time I wanted to take a closer look
at the security of cloud kids so one
Friday morning I took my son to the
kindergarten and when he was happy I
talked to one of them and please there
and said is it okay if I send a few
tests messages to test the security of
cloud kids and is it okay and then I
walked down to the train station and
luckily I met two other fathers from the
same kindergarten in my son's group well
we all had something same group and we
sat down together and I told them that
well I'm going to test the security of
cloud kids can I nor may I send us a
message in the name of one of your sons
and when I said yeah go ahead so I came
to the message forum and cloud kids and
looks like this and I'll show you the
important request parameters throughout
here this one has the child ID and
that's the important one here so what if
I can change this one so specifically I
want to change it to the child ID of the
son of the father sitting next to me and
how do I do it well I use Hitler I could
stop a request I can change it and in
pass it on to the server if you use
Firefox you can use tamper data in
Chrome you can use tamper chrome then
you can change things before you're sent
to the server so I needed to find this
other kids specific trial ID
so where do I find all kids well there's
an address list but first a note on
privacy there is some information on me
here some it is real information on
anyone else is edited so it's bogus
I added that everyone else and this has
really still all the kids in my son's
group and then I could notice that this
picture of my son it has a few numbers
and those numbers are the kindergarten
ID the group ID or department ID
whatever it's called in English and the
trial ID so it's like and then lastly
have some random characters so if I can
just locate the picture of this other
kid I just look at the file name and I
get his trial ID so I can lower before I
pull like that in there's a lesson don't
leak information it's just like don't
ask for things you're not going to need
don't expose things to the client that
the client isn't going to need the
client will probably need my son's trial
ID not everyone else so I change the
child ID and the father sitting next to
me takes up his phone and he looks at
the messages that have been sent and he
can see that I have sent a message about
his son and the guy in the kindergarten
can could confirm that well it was
successful and it was not this message
was started with tests and was like
boring but there are kindergartens who
stayed online that we only hand kids
over to the parents people on the
pre-approved list or when we're notified
about someone else coming and picking up
and on the same page they mention cloud
kids
so another lesson apply authorization to
all non-public functions just do it you
just have to the alternative is
catastrophe so we were still on the
train I don't think we had even gotten
halfway so what do we do okay we'll look
at pictures of course we aren't looking
at pictures who are looking at the
security of pictures and pictures are
sensitive and I should only be able to
see pictures where my son is tagged or
where we can't really identify any of
the children and I'll show you one of
those pictures they had been on a trip
stopped to make a fire because they
wanted to eat black sausages now
pictures are great because pictures
cause people to interact I can comment
on pictures I can like pictures and I
can take one of the pictures and show it
to my son and maybe he can tell me a
story or what happened but we wanted to
test liking a picture it's pretty benign
so I looked what the request does look
like and it was just some numeric photo
ID so I thought well what if I just
increment and like a few other pictures
that I presumably can't see well this is
what the server gave me back I couldn't
see the pictures so I didn't know if I
if they were liked I just got this I
didn't get an error I got 200 okay which
is probably what I would answer if I
could code the server no matter what you
try it's okay
okay but then just filter out the
unauthorized requests but no matter what
just reply the same thing then you
wouldn't know if the pictures existed or
not yeah so we didn't know so we thought
well let's look at something else let's
look at the pictures themselves and
pictures and cloud kids are organized in
albums
and in this album my son was present in
two pictures and if you look at the
photo IDs up on top the two photos had
IDs ending in 11 and 13 so what about 12
and 14 and 15 and a bunch of other photo
IDs try this request and it was no
longer two pictures a lot more and there
are two important things to note here
one is all the hearts some of these
hearts are mine Oh pictures for my son
is not present so now I knew that that
worked the other thing to note is that
there are fewer pictures than there are
photo IDs why well I have an assumption
I could recognize a lot a lot of the
children in some of the pictures but not
in all that I could recognize the
background being my son's kindergarten
so my guess was I can see any picture
from my son's kindergarten but not any
other kindergarten so then we had
arrived at work what do you do well I
decided to contact the vendor and about
an hour before lunch on the same Friday
I sent an email I found the email on the
company web page and ten minutes later I
got a reply from the CEO yet probably
spent a few minutes reading my email and
then writing his own email and you said
thank you and we will fix these things
and sometime during that same weekend he
sent another email and said now
everything is fixed and I could confirm
it was that was good well security was
really bad but at least they took it
seriously and jumped at it and fix it
but in one of those emails he said
I assume you haven't found any
vulnerabilities exploitable to people
without a cloud kids account I had not
but I accepted the challenge so what
about the direct way can I do something
about the authentication tokens get
direct access this is what the cookie
looks like for the old version and the
value of this cookie is hex encoded so
that's 128 bits and 128 bits is good
enough for a session token but this
cookie is valid for 60 days it doesn't
change on login and it doesn't change
from logout and I can even change it to
my own value and well if the
kindergarten has a shared computer if I
can get the cookie value I can enter
into the session no any login user and
it will be valid for a long time but
there is something else that's missing
from this cookie and those are at least
two flags secure and HTTP only and since
the secure flag is missing I could set
up a rogue Wi-Fi access point close to
the kindergarten well this is illegal in
Norway unless for educational purposes
then I could have other parents go to
cloud kids on for instance their phone
and it would default to http
please if they haven't been there before
or well that's not a bit that's example
because then you wouldn't have the
cookies well if I manage to get them to
load a page on HTTP and browsers often
defaults if they haven't don't have the
autocomplete at least they may be sent
to HTTP and then I could sniff their
cookies the other one HTTP only or just
to say one more thing on secure secure
means that the browser should only
attach this cookie when you are on a
secure connection
so when you load a page over HTTP it
will be included if you go HTTP it will
not but they missed it so to be sent
over HTTP as well
now HTTP only that's an instruction to
your browser that this cookie should not
be available to script because if it's
available to script then CC to steal the
cookie and that's the spoiler alert and
lesson 5 is always apply HTTP only and
secure flags on cookies is possible now
the API had doesn't have a cookie it has
an X off token and that one looks better
if this one is basic before encoded or
something close it's 192 bits or little
below that's good the only problem is
it's not if you look closely you can see
that the first half and the second half
are identical so it's no more than 96
bits and it doesn't change then log out
or log in it's always valid and the
lesson is renew tokens on login and why
not on log off at least invalidate and
make them sufficiently random now I
could try to break into cloud kids
exploiting these things but that would
probably require some hard work Script a
lot and we'd probably be noisy on the
server and probably also have to harvest
a lot of these values and we have to
remember that laziness is a virtue
we are not rewarded for your taking the
extra mile in hacking as in some other
fields do whatever or that takes the
least to reach your goal you're not
reward for doing more
so I wanted to see if there was some
easier way to break in and one night I
was having a friend over and I told him
that well I had hacked cloud kids like
some initial stuff and gotten a lot of
interesting results and he was eager to
see how I was doing this and we thought
well let's continue let's just just do
it easy and look some for more for some
more authoritative laws so we started on
the contact information page so here
there's information on the kid to the
left and the parent to the right and I
tried to do this hacking in an ethical
way and there could be some information
on the kid that parents have written
here that I really didn't want to know
so I thought I will stay away from the
kids most likely there is nothing
stressful I can see on the address list
but there could be something parents on
the other hand most of it is in the
address list already the rest I could
probably find them LinkedIn Facebook in
the phone book and the remainders are
mostly communication settings checkboxes
not really sensitive so these two panels
load separately so I looked at the
requests to load the parent panel and it
looked essentially like this stripped
away a few things that weren't really
necessary here so it has a relation ID
that's on the parent and it has a child
ID and I know how to get the child ID
now how do I get the relation IV well
where could I find stuff like that well
there was the address list and on the
address list if you have entered your
address there's a little map marker if
you look at the code behind it for no
good reason it has two relation ID in
there and it even sends it off to Google
Maps so now I had it and it turned out I
didn't need the child ID I only needed
this relation ID
and if I when I use that I would get all
the information I like that you could
see on that page and I would also get
these things confirmation on the
relation ID I would get the user ID and
I would get the child ID so I found them
relation ID for one of the other parents
in the kindergarten and I could load the
page then I thought well I'll try
another random number and I got a random
person with an address in a different
part of the country probably not in my
kindergarten mix unless they had moved
and not updated their address well I
tried one more totally different part of
the country again so I could actually
look up any parent and that's the same
lesson as before authorization and there
was a button on this page contact
information page that said change
password now that's interesting I
translated it for you and now you can
suggest what's wrong with this one like
big things and little things anyone yeah
that's the big one the really big one
they're not requesting the old or
existing password anything else
no it's not clear text so it's a yeah
but it's it's HTTPS so it will be
encrypted
yeah well probably wasn't good enough in
last millennium please not now and they
also had max length 25 characters that
annoys people whose password managers
with really long passwords because it's
just cropped off and you're not told but
does that mean that you have set aside
25 characters in your database which
then means you're probably not hashing
the passwords it's interesting anything
else
yeah the parent ID or employee ID and
the kindergarten ID welcome cloud kids
if you have kids in two different
kindergartens both using cloud kids you
still have one user so kindergarten ID
has no use and really the user ID that
should be taken from your authentication
token not directly but you can look it
up based on who you haven't sent akkada
- so anything else now we'll leave it
with that because those are the most
important points in lesson 7 is
passwords are hard so when you implement
passwords you probably have to do
storing you have to do changing
passwords resetting maybe I remember
function and these are hard and you have
to get them right you can't get them
almost right because then you have a
vulnerability you need to get them
absolutely right so we of course had to
test this good - looked really
interesting so we did and my wife's was
sitting at the other side of the table
and I told her honey I changed your
password as is it's okay
because I knew her password so I thought
well I need to give you some context I
was logged in and I changed your
password and she said that's not good
and that certainly is not good but it
gets worse so let's go back a little to
the information on the parent and if you
remember in the request I had last time
I've changed it a little
I already removed the child ID this time
I removed the cookie and I could still
look up information on the parents which
meant anyone on the internet could look
up any parent on cloud kids
and if they wanted to check them all out
they would probably use VPN or tor or
something that would hide their IP
address just to kind of cover their
tracks and the lesson is check
authentication on every page after login
because if you don't have proper
authentication you can't really have
authorization you need authentication to
do it and I said it was going to get
worse and that's because the same thing
applied to well you guessed it - the
passwords anyone could change anyone's
password so first you could look the
parents up on by looking up the
information on parents and there you
would get the phone number which is the
username you will get the user ID which
you would need to change the password
and you didn't not need to know the
kindergarten ID user ID was enough then
you can just change the password and you
can log in great I didn't find the user
IDs for the for the employees too bad
well if you're a hacker you're probably
unscrupulous and you're probably greedy
and you want to monetize on your hard
work because you don't have a job you're
a hacker so how could you monetize on
this well you could do one thing that's
no risk no harm and that's just to build
a list of all the parents there are tens
of thousands of them and that list you
would have them phone number for all of
them you would have the postal address
and email address for a lot of them you
could sell this to marketers someone
who's eager at selling something to
parents of kindergarten age children or
you could be a little more nasty and
sell it to scammers now I don't believe
the scams being sent to me as a random
person on the internet but if my name
was in there maybe my address some
information on my child
picture I would be a lot more likely to
click on the link or open the attachment
and a lot of other people would be too
so you could get ransomware spyware
malware so what do a hacker want to do
when they get access they want to
persist
let's stay logged in and they want to
elevate their permissions and to persist
is quite easy because well when they log
in their cookie is valid for 60 days and
if they login to the with the API token
is valid forever so we want to elevate
their permissions and who has more
permissions well I guess employees have
more permissions how do we become an
employee because I couldn't find the
user ID of the employees there's an easy
way that's the fact that there are some
employees who also have children in the
kindergarten and they would share their
user between being a parent and being an
employee so there are a few leaves and
we could easily find the parent then we
would have an employee but of course you
want to have more employee accounts so
we go on hacking this letter type or
requests that I could send them cloud
kids it's more like that right now like
the instance requests not concerning a
specific date like the other one and
this one doesn't have any chili the
relation ID user ID so they probably
fixed authorization here but as with all
the other forms and cloud kids they're
missing something important and this is
vulnerable to cross-site request forgery
also known as CSRF Caesar for xsrf and I
wanted to test this out I kind of knew
that this would work but I still won
test it out so I built an HTML page and
the part in blue is an exact replication
of the form and cloud kids the part in
red is a script that submits the form
and in green there is an action that
then when this page loads submit the
form or run the script that will submit
the form so it's effectively an auto
submitting page when I open it the form
submitted and because I had valid
cookies for cloud kids the browser would
happily attach them and cross-site
request forgery is about exploiting the
trust oh that's not a definition of it
I'll take another one that you've caused
a user to do an unwanted action in a web
application where they're authenticated
so I was kind of attacking myself I went
to the kindergarten before my good
helper there had to go home and fetch
his own kids before somebody else did
and I tested this out with him and got
immediate feedback that well it worked
just as I expected and we need to
protect against cross-site request
forgery and what works in all browsers
today is to apply anti-seize serif
tokens
when forms are posted there are also
other things we could do most frameworks
or I guess all frameworks have something
you could implement it shouldn't do
these things ourselves so this works and
how can we use it well there's a good
friend of CSRF Percy surf and that's XSS
or cross-site scripting and here we have
some persisted cross-site scripting I
could send a message that would stay in
the database of course just like the
message is good and having an XSS flow
means that I can run JavaScript so my
choosing in somebody else's browser so I
sent this message and I think the
employees in the kindergarten thought it
was quite annoying because when they got
to the message list
they got this pop-up every single time
and it will also get it if they looked
at my message which was just hey Magnus
the guy in the kindergarden and then a
script tag with an alert box which is
how we prove that cross-site scripting
is possible
yeah and for a parent this would pop up
in the old version and in the new
version when I looked at the messages
there was some prevention or at least
that's how it worked I don't know if it
was really to prevent cross-site
scripting but it's at least limited me
from some of the things I wanted to do
and that was some rewrites or quotes so
a double quote became a single quote and
a single quote became a backslash single
quote but well that's what have you do
it to prevent XSS you need to validate
inputs unless it's like you accept all
kinds of crazy characters because people
can write in all different languages
then you can probably validate the input
or you can ban certain characters and
this you should do on the client side
and mostly for usability on the client
side and you should do it on the server
side and that's for security because you
could bypass the client side just like I
did with the cross-site request forgery
or I could do it with fiddler or and
there are various other tools that could
do that and after validation or in
addition to that you should output them
code for the correct context so if it's
going into HTML you need to HTML and
code if it's going into JavaScript
context you need to JavaScript encode
and if possible you can use content
security policy header where we can
effectively block all inline script that
is if your application isn't heavily
dependent them or inline scripts already
so now comes the fun part when we can
put all these things together
so we could start by creating a page
with the CSRs payload and of course
we'll do it a little more stealthily
that than what I had in proof of concept
I would take that page put in a hidden
iframe on another page so nobody would
notice and this other page could have
some legit content and I will try to
attract other parents to visit that page
and without knowing they would if they
had a cookie they would be sending
messages to the kindergarten or we could
of course just replace this point with
taking control over other parent
accounts like I showed you before and
then we send a cross-site scripting
message and my example is the one in
blue this one works with the quote
rewrites and what the code in blue does
is that it just redirects the browser to
my evil hacker site let's say I have
control over this site or at least I can
read a public log on this site and to
the URL I attach the cookies and as we
know the HTTP only flag isn't applied so
the browser will happily attach the
cookie and send it off now then I can
pick it up and just enter into the
session and that's valid for up to 60
days then I can change the password
because now I'm in the session and we
know it's not requesting the old
password so it's trivial and nobody is
notified on password change or email
change phone number change or anything
so this is how I could pretty much hack
any active employee that ever read
messages could probably improve this a
lot to not be notified that easily so of
course as a hacker what evil can we do
well there are vacation lists in cloud
kids and people sending messages saying
we'll be leaving early on Friday all
right we're coming to pick up the child
early on Friday that's when you know
their house is empty you could send some
burglars and there's also names and
birthdays of children who knows someone
who's using names and birthdays of
family members for passwords have people
stopped doing that that's good okay so
then we'll do something else
employees can post newsletters PDF and
Word files now we could booby-trap one
of those and to make it effective we'll
make it a form that parents should fill
out and return to the kindergarten so
they would edit it in the in Word or
just print it both cases both cases they
would leave protected mode maybe we
could give them malware spyware
ransomware any of them or maybe I could
kidnap a child now with all the
information that I can see I know a lot
of things I know the name sent out to
people what the kids look like and I
know a lot of things that if I started
talking to one of the children I would
quickly build trust in that child and I
would also know when the kids are
usually delivered and picked up and if I
manage to snatch a child I could mark
that child as picked up maybe nobody
would notice until I'm across the border
so what should I do
should I exploit it well I'm not 15 I
have a career in IT and I guess most of
you do too it's probably not the best
idea to start exploiting things because
you may go to jail for it maybe you can
create some more distance
if you're lucky can sell it to someone
well can you trust hackers it's my
personal information in there but I
guess maybe a pedophile Network would
pay for it and of course this
responsible option is to report it I was
getting quite scared when I used cloud
kids I didn't really want a guy because
I had to use it or my wife had to use it
if I stopped so I didn't really want it
to stay this way so maybe it was best to
report it but you also have to remember
there is none of the above option and
that is forget about it and I know
people who always choose this option
they have tried reporting again and
again and again and they're sick and
tired of it because they either don't
get through or they're not taken
seriously or security is not taken
seriously or the companies freak out and
start blaming them or threatening with
lawyers well I had reported before and
had a good experience so I thought well
I'll report again so I called them and
said well you know what
I continued and this is just so much
worse and they were really thankful that
I came to them first and I told them
what they should start on immediately
and what I also said would you like to
consult for us to give us all the
details of your findings and to fix our
code now to get all the details that's
good because just like with any other
bug you need to know if you actually fix
the problem or if you just thought you
fix the problem but me fixing their code
well I'm a friendly hacker turns out
well I've told them these things but
this could be of course the most
spectacular way our ways colliding my
privileges but I don't think that's the
most important point if I fix their code
I would fix their vulnerabilities and
they could keep on writing crappy code
because if they did they would miss the
single best learning opportunity ever in
security for their developers because
you need to prevent disaster and this is
my advice first need to educate you need
to educate your developers and you need
to educate your testers and pretty much
everyone else in your organization
including support because they may get
the reports and they need to know how to
escalate then you should get your hands
on a couple of tools or a lot of tools I
listed some here it's like the beginners
pack some of them are free and then you
need to put what you learnt and the
tools to work then you could also look
at your logs now if you remember back to
the where I could see the pictures I got
illegal access to the pictures now let's
say that you were running cloud kids and
your boss came over to you and then said
we suspect illegal access to pictures
you need to find out which pictures have
been viewed legally by whom well even if
your logs were good it will still be a
nightmare but with the logs be able to
tell you what happened and could it also
tell you when it is happening
and then you can also have a report
false you can state on your webpage if
you find something security
vulnerability here is how to report it
that could turn some of those forget
about the people into reporters if you
want to have a good example look at
Tesla's legal page you can also have
someone else test in certain
circumstances so you could have a
company penetration testing company or
whatever they call themselves or you can
have some freelance hackers you could go
on hacker one or bugcrowd
with a big bounty you shouldn't rely on
this well if you're like cloud kids well
first I told them a lot of things they
should fix then they decided to have
someone else look at it well because
they needed to know everything that's
wrong but going forward that's not a
good strategy you should at least do
this internal first to at least pick out
all the simple things then you can have
some pros to look at it but they can
most cases only look at it after your
code is in production which may mean
it's too late
have you heard about the GDP are there
will be a talk on its here tomorrow I'm
not so I'm not going to cover it there
is some new legislation coming into
effect may next year in the EU and
Norway and it won't make that privacy
and security in toys and and webs and
online services illegal it will just
find you to death for or after the fact
and this is a major change for the
industry and well as these there are
some big signs connected to this well
some prioritizations may switch towards
security and funds will go that way and
I hope the funds will not just go to
paperwork and lawyers but actually
to better application security and if
you will need to know what that's all
about how you protect your application
in all the different ways that it can be
attacked this is a good reference the OS
testing guide it tells you just about
not just about everything but a lot of
different things you should think about
to stay secure it may want you to
outsource things because it's a lot the
list is huge so I had looked at cloud
kids but I wanted to compare it or to
compare all the online kindergarten
services in Norway I realized that I
could find four major players and I put
them through the same tests mainly on
their login page so first I did as a
sell apps and it didn't look like this
back in February when I started three of
them had grade C or lower and the number
three told me when I reported it we are
aware of this and we will fix it on this
coming weekend during a service window
it's still enough and then we have
security headers IO by Scott helm is
back there
they're not doing too good they don't
have a lot of security headers on
security headers are good for the users
they protect them from vulnerabilities
not everything but certain things while
on security headers half of fights
get your F and these aren't doing much
better but they should some other things
I note that most at number four what's
missing cookie Flags it had strict
Transport Security which meant the
secure flag doesn't really matter but
they were missing HTTP only flag and if
they weren't renewing that cookie on
login
well one XSS flaw and there goes your
cookie number three for showing default
errors and the robots.txt file had some
interesting listings
like admin site admin enterprise admin
new password it's interesting so I'm
glad my kindergarten is not not using
vendor number three so my final advice
is to hack your own systems because
users are evil or one evil user is
enough know your enemy
know their tools and know what they're
looking for and detect the problem and
fix your system before someone breaks in
thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>