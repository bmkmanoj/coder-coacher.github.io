<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Security And Microservices - Sam Newman | Coder Coacher - Coaching Coders</title><meta content="Security And Microservices - Sam Newman - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Security And Microservices - Sam Newman</b></h2><h5 class="post__date">2017-09-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qw_Z5TyQIb8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay good morning everybody I hope you
all woken up I suspect some of you might
still be nursing hangovers from
yesterday I I had planned to go on the
harbor cruise last year it rained
constantly during NDC Sienese didn't
make it this year I plan to go put my
ticket went upstairs after the inner
confidence last night I sat down and
just thought I'd take my shoes off you
know maybe just click my computer and
charge it up and then I woke up at 4
o'clock this morning
so jet lag is a bitch so I hope you
enjoyed that the the the harbor cruise
thanks very much for coming along to
learn a bit about application security
and micro services my name is Sam Newman
I until recently was working for a
company called thought works they were
based just down the road here and
elsewhere and used to live around the
corner in like art I moved back to UK in
March I set up my own business now to a
training consultant consulting and
advisory work in the field of cloud
micro services and CI CD and so I'm not
gonna talk to you about my business if
you're interested come talk to me later
I'm coming back to Australia next year
for a month or so I may be available for
weddings Bar Mitzvahs and extremely bad
stand-up comedy but I'm actually here to
talk to you about security in the
context of Mercury services but I always
like to gauge the room a little bit
understand who it is I'm talking to get
a sense of of what you might know so
I've got a very simple question for you
who here is a doctor like a medical a
proper like a medical doctor not all
those silly physicists and also another
mathematicians who here is a medical
doctor anyone anyone study epidemiology
clearly there on conference for this ok
anyone that's like a nurse or anything
like that it's well I got one nurse in a
mixer and that's great fantastic
it's a grown up in the room ok that's
this let's lower the bar a bit as they
don't here play pandemic the board game
right a few of you okay so you're almost
medical professionals there you go
alright so we don't have a huge amount
of in-depth experience
in the medical profession someone else
got a different question who here knows
the importance of washing their hands
after they've been to the bathroom while
all of your hands not up right now okay
you know the question I ask is who here
knows the importance of washing their
hands after going to the bathroom not
who here actually washes their hands
after going to the bathroom because I
figured that could be an even more
embarrassing answer so here's the thing
right you're not all experienced medical
professionals some of you may be but you
all know the importance of washing your
hands after you've been to the bathroom
right this is this is sort of we've no
raises question is that when it comes to
security I think developers like you
know people like me like myself in the
past what we would do is when it came to
things like security we would abdicate
responsibility wouldn't mean we'd say
whole security yeah I said really yes
we're tough that isn't it's very hard
subject you've got a lot of experience
and be a dedicated security professional
so what we'll do is we're not will
ignore it all because we couldn't
possibly know anything about security
and we'll get someone to come in later
for us and sprinkle in the security for
us after the fact just like we used to
do the same with usability design yeah
we'll get some we'll get some people
that know usability and interaction
design they can sprinkle in the
usability and while they're at it we'll
get some testers in to just you know
make sure our code works but we're
developers and we've got more important
things to deal with right now and of
course we've changed our stance towards
usability we now think much more about
user centered design as part of our
development processes and we do the same
things around sort of our testing as
well we know the importance of testing
our applications in line but when it
comes to security we still sort of of
this mindset that we know we've got to
abdicate responsibility for security
it's still the role of a security
professional now I still think there are
spaces for specialists absolutely in
somewhere in the same way that their
roles for specialist architects and
operations people and usability
engineers but there is a base level of a
knowledge and awareness that I think you
need as a developer around security and
you're going to get that today just at
least a little bit of information
hopefully at the level of isn't a good
idea if you wash your hands
after you've been to the toilet without
actually to know about how diseases and
spread at least know the importance of
washing your hands so that's the that's
me GU up talking about how positive this
little stuff can be and how you're going
to come out of here empowered this is
also a talk about security so I have to
scare you a bit as well because that's
just that's how it works
we need to act in a slightly paranoid
fashion around security after all how
many of you here have seen this before
the North attack map it's a few of you
okay about a third of you that's pretty
good this is actually a great resource a
lot of you will need to justify why you
come to conferences right so when you go
back to your workplaces your bosses are
gonna say so what did you learn they
will justify the time you took away and
it's not enough that you feel good
they want to see output of what you've
done the north attack map is excellent
because you can launch this on a screen
next to you and and they can see it and
they can go so what are you doing and
you can say I am I'm doing security I'm
looking at all the attacks that are
happening in the world right now and
making sure that we're protected it
looks great right this is actually a
company called Noor to do security you
know actually have products in this
space and what they're doing is here
they're looking at some of the
background noise of the internet various
different attacks that are ongoing here
you see when I was screen capping this
oh there somebody in the Middle East is
really getting it really bad somebody in
South America is very annoyed at
somebody in the Middle East right now
it's sort of interesting when you watch
this all the attacks are on sort of
fairly old protocol there's actually an
awful lot of attacks happening on telnet
in this particular time you could notice
that nobody was attacking us here in
Australia I think that's partly because
when I capped this it was when it was at
night in Australia I think it's also
partly the network right I mean if you
tried doing one of these attacks you'd
probably just sever the link anyway
moving on this is always fun but this is
this gives you an idea of the background
noise of the internet if you put out a
service that is publicly available or on
you know on the internet it's available
over the public internet what you are
going to be doing is exposing it to
stuff like this some of these attacks
are targeted and some of these attacks
or not there is just things that happen
little bots out there that are looking
for vulnerabilities and systems that are
just opportunistically trying to find
holes in things the question is not when
will somebody or something try and hack
yours your publicly exposed service the
question is when and what's going to
happen when they do now no spinning
beach ball so before we go any further
talking about application and security I
like to talk about what forgive you
blimey
a brief discussion of what micro
services are just we're on the same page
now my computer is running really - so
there we go let's try that mm-hmm right
let's hope it's gonna behave so I'll
talk about very briefly about what micro
services are we're going to be talking
in this for the rest of time about how
application security applies in the
context of micro services and micro
services give us some interesting
challenges and opportunities regarding
security I always do all them as
hexagons they're a nice shape that the
definition I primarily used for micro
services is this is small independently
deployable services that work together
modeled around the business domain so
the most important characteristic I
think of micro services really is this
idea of BIM being independently
deployable that's something I think we
need to optimize for that work that's
what gives us the other benefits we look
for you know yeah teams being more
autonomous being able to release
independently from each other so also
what gives us some interesting
characteristics around security as well
because there is this thing with micro
services that we have effectively
decomposed what may previously have been
more monolithic the deployed solutions
now we have separate processes separate
processes with logic with behavior
operating on data which itself is also
now being separated from the whole with
a more monolithically deployed software
we sort of have a situation where all of
all of our stuff is in one place all of
our processing is in one place if you
compromise that single process you
potentially compromised all the
operations you get into one database
you've got access to all of the data
that sits in that database so in some
ways you sort of have just maybe more
vulnerable put another way it's like you
know
quite literally all of your eggs are in
one basket when it comes to more
monolithically more lib monolithically
deployed software now dual amargasaurus
architecture is that by breaking these
things apart we effectively limit the
scope of any one piece of exploit it's
only going to crack one server so I need
to get access to one set of data this is
this is sort of on the face of it then
is micro-services should offer us more
the ability to create more secure
software we have afterall the ability to
create multiple perimeters we don't have
a single perimeter around our system we
can now apply multiple perimeters if you
work on platforms that provide Software
Defined Networking layers for example so
Amazon you know you can create different
VP C's put your services into different
network subnets those things can be
isolated from each other that gives you
multiple points at which you can protect
your applications firewalling not just
at the level of the process but actually
firewalling at the level of the network
as well the flipside to all of that is
that we've actually drastically
increased the surface area of attack
when it comes to our micro service
architectures information that used to
flow but you know within a process now
is flowing over networks these are these
are opportunities for people to read
this you know sniff the traffic
manipulate that there's also more
machines that we've got to make sure I
looked after are patched are protected
we've potentially increased the amount
of places where someone can find a weak
link in our chain and so with micro
services they're not a universal good by
any stretch of the imagination I think
with when it comes to security I think
out of the box that are probably going
to create more problems for you than not
when it comes to security but I think if
you think about security while you're
building your service design while
you're building up your micro service
architecture where you're moving from a
monolithic system to a Marcus where's
architecture I think you can end up with
significantly more secure software but
we can explore that a bit further I said
I'm gonna give you a sort of a a base
level of knowledge or at least a basic
working model when there's going to
useful for you as a developer when
thinking about application security it's
actually a four part
model that III some colleagues of mine
thought works developed many years ago
and they say they sort of break it up
like this they say okay firstly we've
got to think about prevention how do we
stop a malicious party from gaining
access to our data gaining access to
processes that they shouldn't have
access to all too often when we think
about security this is the start and the
end of what we think about
I've just got to stop anything bad
happening but once we've done that we've
actually got to think about well what
happens if we let something through how
would we know if somebody has gained
access to our system so we also have to
consider detection once we've detected a
malicious attack once you've detected a
breach we've then got to know how to
respond and all too often response is
done very very badly and thankfully
we've got a huge number of examples
where people have responded very badly
to security breaches and finally once
we've responded we've got to know how to
recover how to put our system back up on
its feet so let's start by looking at
prevention and this is problematic from
the beginning partly because we're
actually as human beings quite bad at
assessing risk so I was working with an
organisation about four years ago four
or five years ago and this was just as
Snowden was bubbling along and so this
organization as a whole had become
significantly more concerned about
privacy of his data and specifically
privacy of information it hell's about
customers and their InfoSec team was
going around the world trying to
understand what they needed to do to
properly protect the information that
the organization was handling one of the
things they said was well look we've got
a lot of offices but none of our offices
have even basic CCTV on enough on the
Foy's so that's a very good sensible way
of deterring people from trying to break
come in just walk in through your front
door and it will also be a great way
that if think dad does happen like
someone gains access to our physical
network we've got a chance of seeing
that person walking in and identifying
that individual and they say so we think
we should roll out CCTV and our photos
of our offices wing and start doing it
actually we'll start doing it here in
Australia and I think they were going to
target the Melbourne office was going to
be the
for this and this caused a bit of an
uproar lots of people started getting
concerned do you not trust me this is an
invasion of my privacy you know you're
focusing on the wrong things there's a
particularly militant organization
internally lots of frothing at the mouth
this thing went on for a couple of weeks
the port InfoSec team was sort of hand
their hands over their heads were being
consoled by their colleagues well the
thing interesting happened and someone
said well before we spend thousands and
thousands of dollars on a CCTV camera
setup should we actually make sure that
our door lock works because in the
Melbourne office the door lock hasn't
worked properly for the last two years
in fact people would frequently lock the
door go home come back in and find the
door had blown open because it didn't
latch properly maybe it makes more sense
if we want to stop someone gaining
access to our physical premises to spend
a hundred dollars fixing the lock and
several thousand dollars building a CCTV
camera system this is this happens all
the time we are not very good at working
out where we're most vulnerable and how
we can best defend ourselves it's for
reasons like this that it's quite
important to actually do some kind of
threat model for your application
Microsoft do some great documentation on
this to know more about sort of more
complex threat modeling techniques look
at Stride and dread if you look at the
max or secure developed life cycle site
but one technique though both of those
threat modeling processes use it's
something called attack trees from Bruce
Schneier the idea behind attack trees is
quite simple what you do is you first
consider what is it that the malicious
party is trying to gain access to and
then what you do is you enumerate the
different ways in which they could gain
access to that system all that that
thing so let's imagine a goal in fact
we'll take the goal that that's in
Bruce's Bruce's original paper here
where the goal is with that this
malicious party is trying to open the
safe they want to gain access to the
safe well let's think about this how
many ways in how many ways could do you
access that safe well they could pick
the lock they could learn a cut the
combo
or that could cut the safe open all
right well let's keep going how could
they learn the combination well they
could find it written down or they could
get the combination from the target it's
all vacation born in now isn't it it's
all seems a bit like all this is gonna
be some Hollywood blockbuster thriller
how could we get the combination from
the target well they could blackmail
them we could threaten them when we
could bribe them and you keep going like
this and a lot of this the ways in which
people can gain access to stuff is
actually about the human side of it not
the technology side of it we often
forget that sometimes the human aspects
have technology solutions so once you've
done it's a numeration exercise what you
then start doing is attaching weights to
these mechanisms a lot of what we do in
security is not trying to make something
impossible what we're trying to do is
increase the cost of a malicious party
using some mechanism so to make that
cost so great that it's no longer
financially viable for them to use that
mechanism this is why I use really long
keys to encrypt data theoretically yes
an attacker could provision a hundred
thousand Joanne
ec2 instances on Amazon to crack this
key but there when they do so they get
access to one password that might net
them $30 on the dark web but they've
just spent $40,000 on ec2 instances
right that's that's the game we're
playing here and so you know in this
example we might overlay the weights and
we realize well actually the easiest
thing for them to do is maybe going to
find the combination being written down
okay great what can we do to stop them
people writing down that combination
actually quite a simple exercise and yes
absolutely security professionals can
help you do this but you can also do
this yourself and this is what's going
to help you focus your attention on
those aspects of your system that most
need protection and my system I mean the
technology and the human aspects of that
system let's take a look at let's
imagine though we'll look at some of the
more technical factors let's take a look
at a very simple example of Microsoft's
architecture so in its black box you've
kind of got the perimeter we've got a
few services that sit inside and we've
got like a third-party royalty payment
gateway we send information to and then
clients at the top we start thinking
about prevention field
Micro security with we're worried
actually about that thing I just
mentioned at the beginning which is
information that used to flow within our
process boundaries now flying between
services so what are we going to do to
protect our data at transport so let's
start with some real low-hanging fruit
when it comes to protecting your data at
transit let's start with something
simple like HTTPS Everywhere
there's been the mantra for a quite a
while now for public facing websites
with good reason and it's worth
considering for inside your perimeter
this used to be a bit painful to set up
but of course we've got lots of
opportunities to automate this now we
have let's encrypt for example I'm
pretty sure who here has heard of let's
encrypt fantastic great so people got
very excited when this came out was
about three years ago now and they said
this is fantastic and everyone was sort
of fixating on the really weird stuff
about it though it's like look it's
let's encrypt and look oh look it's free
ah it's free and I'm like so hang on a
minute the reason you didn't implement
HTTPS before was because of the $25
certificate per year yeah that was the
reason right now no that's not the
important stuff at all it's this isn't
it it's the fact that's automated that's
the huge shift here especially with the
Microsoft architecture you've got
multiple moving parts having an
automated tool chain to create an issue
install certificate is really important
so let's encrypt under the hood uses the
Acme protocol which they hang up define
so you have like one line commands to
you know it create a brand new
certificate renew that certificates and
install it in even two web services like
nginx and Apache because it's automated
that makes it so easy they actually do
things like have very short durations
these certificates as well which
actually helps in case they fall into
the wrong hands so let's imagine that we
start saying okay great we're going to
use it and now we're going to use that
for all of our services by default now
any communication over HTTP is actually
now going to go over HTTP
but we have to understand what that
gives us that's very useful on the
public Internet right where what you
want is a guarantee that the server is
who the service says they are and when
we want to make sure that the payload
isn't being
isn't being sniffed at isn't being
manipulated that's very useful the
public internet and it's somewhat useful
within our perimeter it stops a
malicious attacker masquerading as a
service which can happen there's an even
more insidious attack where a malicious
party on your network launches their own
kubernetes node and adds it's your
cluster then you start running your
services on it that's really nasty
doesn't happen as far as I'm aware of
it's a nasty attack to think about so in
this situation now HTTP inside our
perimeter we've stopped other things
pretending to be our services and we
stopped the data for going between a
client and a server being observed or
manipulated what we haven't done those
anything about the clients if I if
you're running HTTP on your internal
networks like this and I'm on your
network I can still go and make calls to
your services in this world and unless
your service also does some form of
client-side verification I could just go
and access all the information I want I
don't need to gain access to your
database do I if I can just go and use
your lovely documented REST API and use
curl to extract your data and in JSON
format no less rather than a nasty
database dump much faster for me thank
you very much indeed so you do need some
kind of client-side verification and
again here we're thinking of extending
this idea of certificates you can think
of things like client-side certificates
now of course historically we talked
about HTTPS being painful client-side
certificates are significantly more
painful there are some automated
solutions around this now some of the
service measures I think will start
adding support better support for
client-side certificate generation and
there's some people are doing some stuff
around using volt and hash from Hoshi
Corp to do this sort of thing but at the
moment these solutions aren't really as
tried and tested it's things like let's
encrypt our but nonetheless you're
seeing organizations like Netflix expose
things like their lemur system for
automating client-side certificates
we've kind of got to understand what
that gives us so a client-side
certificate now says ok the client is
who they say they are this is quite
useful when what you want is to have
service to service communication the
server is who the server says they are
the client is who they say they are the
communication between the client and
server is now protected and that helps
to move the game along
but though we know to think about our
something else don't we we need to think
about the off question and the human
orth question we've dealt now
potentially with the service with the
computer or 'the question now we've got
to deal with the human being
wolf question authorization and
authentication authorization
authentication authentication yes you
are who you say you are authorization
okay well what can you do in you know an
architecture like this it would be quite
common for us to use some kind of
earth-based mechanism at the perimeter
you redirect you off you're not logged
in or get you to login maybe using
something like open ID connect to verify
that yes you are who you say you are
that's great and so to access in this
example the music web shop I have to
validate that I am logged in as Sam and
that's great and then the music webshop
can then say yes you are Sam and then
make decisions about what I'm allowed to
do based on some information about me
this opens up some interesting
possibilities though especially when
you're looking for an especially clever
malicious attacker because what we have
is a lot of situations where you know
I'm in the web browser I'm making calls
to a service on the backend that service
in tool in turn is going to call another
service to fetch information for me or
to carry out some kind of operation so
in this example here if I'm logging in
and I want to access my user information
that music web shop on the back end is
in turn going to make calls back to a
user service to fetch the information it
needs and this opens up the possibility
of an interesting kind of attack let's
take a look at a really simple example
of what I mean here see how our lagdi
and I go okay hi I'm Bob the music web
shop make sure says yes great you're Bob
you're logged in fantastic that's great
so then later on I click a button then I
going to see my information and I see my
the information about my account and it
says so affects them saying give my
details please and the music web shop
says I can well Goff's and get your
details in the user service so the music
web shot goes hi user service it's me
and user videos our high music web shops
good to see you again and you want Bob's
details of course you can you're my
friend I trust you here's all of Bob's
details and then the music web shop
formats
nicely served up a seven-page now I've
got a nice view of my user details and
the page fantastic lovely everything
works well now let's think that Bob's
getting a bit funny and he thought he'd
try it on a little bit and maybe he
decides to do something like Clark
crafter a different request from the
client and it's gonna actually ask for
somebody else's information instead so
still logged in as Bob but I go so can I
see Alice's details and the music
webshop unless it's explicitly knows
that it shouldn't give access to that
information to Bob and it may not know
that right because ultimately the
information I'm asking for is actually
held downstream so how am I supposed to
know upstream what downstream services
are going to authorize Bob to do and so
a lot of what we times what we do is we
have this stance of implicit trust
because what happens is I go see music
web shots say can I have Alice's details
the music web shop knows I'm logged in
it says I gotta go ask so it goes
couldn't give me ices details and user
service goes are but you're the music
web shop you're my buddy I trust you
of course you can have their details and
bat goes Alice's details and that
information is now exposed this is an
example of what's called the confused
deputy problem and this is officially my
favorite piece of cliff and clipart on
the internet right now I have been
looking for years for this picture of
like a confuse looking for a confused
cowboy this is the closest I can get
right anyway this is a class as a common
type of is a well-known type of security
vulnerability in Microsoft architectures
the way increasingly we're solving this
is by using some form of token and
specifically people looking at things
like a a JWT token and so the way this
works in this sort of system is when I
log in what I'm going to get is some
token the represents my logged in stage
there's no dude this could be a piece of
information that might be stored in a
cookie and then that piece of
information can then be used on the
server side and pass from service to
service so JWT tokens well let me take
say adjacent payload like this that
could just be some one piece of
information maybe my ID and my username
but could equally include information
about claims if I wanted to I could put
the groups that alice is in here which
is information that services downstream
then use to decide what I'm allowed to
do it gets encoded like something up
this which you could sit in the header
and so when I'm making a request
downstream I pass that token downstream
to the user service the user service is
then able to validate that token without
any more round trips and say yes this
really is a token are this token is
coming from Alice and then what you're
allowing is of two levels of
verification of trust the first is are
you really the music webshop making is
called good I trust you now should you
really be asking on behalf of this
person the music web shop sees our hang
on you've given me a token for Bob be
asking for Alice's information and I
know locally that's not something I
allow you're not authorized and then you
can pass that back upstream it's
increasingly I'm seeing the use of Gerry
G tokens for this exact purpose we also
have to think about data at rest in a
way this gets easier for us because we
can now when we talking about
microcircuit actors we're talking about
their being single owners of data by and
large you're worried primarily about
where data sits at rest and how data is
communicated now here in this section
information for example may be the only
service I've got the stores PII if the
user service and in which case I can
just make broad-brush decisions like
well I'm just going to assume that an
entire database has got to be encrypted
at rest whereas I might not want to do
that with a more monolithic system when
I have a large you know database that
has all of my information in it
encrypting everything even doesn't need
to be encrypted it can actually be a
performance burden causes up to only
selectively encrypt parts of our system
that then opens us up to actually
leaking information that shouldn't be
encrypted that actually isn't than
vice-versa of course when it comes to
prevention this stuff actually is all
real high hanging fruit even HTTP is is
like kind of the second thing you should
do on your list or the third or maybe
further down because the very very first
thing you should be doing is patching
your stuff like patching all your stuff
so a little poll how many people here
know and I mean think I mean know that
they are patching all of their servers
and their application stacks once a week
two people two people how about once a
month better once a year how many of you
don't know
okay that's about a quarter the room
that's not good right so there was a
study done in 2016 that found that forty
four percent of all security breaches
occur when vulnerabilities of or and
solutions have already been identified
so a large chunk of that forty four
percent are there is a bug in this
operating system there's a CVE on this
application stack that CVE has been
shared a patch has been made available
for that CVE and you did not install it
so already a large cloud part of our the
breaches out there are caused by
unpatched services and that is at a
number of different levels that's your
operating system now if you're running a
contain and that's the operating system
that's running your container technology
then it's the operating system running
inside your container as well it's also
of course your application stack this is
where things get interesting in
microcircuit textures people using all
these kinds different programming
languages keeping on track of well what
needs to be patched it's not just your
your runtime it's also the libraries
those runtimes use now this situations
getting a bit better at least for the
application developers there are tools
out there like now like snick which I
really like
so what snick does is it look at your
github repo it looks at things like your
maven dependencies files of your gem
files and says well you depend on these
versions oh by the way I've just spotted
a critical vulnerability over here in
this version of the library you're using
and it can send you an email saying I've
found a critical vulnerability you
should patch that it can actually even
go further it can now actually send you
a github pull request updating your
dependency files to pull in the latest
versions that have those fixes in it and
this stuff cost you like 20 bucks a
month so there's no real excuse for not
using these sorts of things now so this
thing it's an activity you'll sit there
and watch and keep an eye on your
application stacks and tell you okay
even to make a change it's still up to
you then to then deploy that change you
can make the change in your github repo
you've got to push that change out
solutions for doing this stuff actively
in live production environments I'm not
seeing them out there there are tools
that will actually look at things like
docker images in production and tell you
you know what what if there's any CVS in
images that you've got out there which
is useful actually you can large amount
of the official images and the dock
for example have critical
vulnerabilities in them in fact if you
go look at the official Ubuntu images
every single one in official a bunch of
images on the docker hub when I last
looked had critical vulnerabilities in
them it's not that they were hacked or
anything it's just that when they were
uploaded they were fine and since then
Ubuntu have issued a lot of patches
darker images are immutable right there
there yeah it's gonna get you have to
rebuild it if you want to pull those
patches in so be aware of all that stuff
as well so when you're thinking about
patching you don't think about patching
at every level you're thinking not just
about the act of knowing for problems
occurred but patching it and knowing
what your patch level is at there are
also tools out there like Claire for
docker there's those things are getting
better in that landscape and docker
inspect as part of that but I think we
I'm hoping those tool chains will get
better let's push on now and talk a
little bit about detection knowing if
something's happened
as I mentioned keeping on track of of
CVS that are out there you know that
have been issued about the technology
platforms you're using is a good first
step actually reading those
vulnerabilities as well because it's
also possible that you've been affected
by things that happened a while ago I
remember back when Mia thought works I
was running the house helper only
internal systems and I was chatting to
our head of security
just after shellshock happened so if you
remember but shellshock was basically a
really really nasty exploit that was a
potential exploit that was spotted in
the bash terminal which basically
allowed for remote access to the
machines running a version of bash that
had been in the live in the wild about
two years so there's a two-year window
where an extremely common piece of
deployed software could have caused
people to gain access your system now a
key the key thing is is people spotted
the bulb I didn't see the attack I
spotted the bug and then worried have
people been using this and so we're
talking like well we've got everything
patched now we that was actually a great
exercise for us making sure we could
patch everything all were happy that was
has been applied but the question was
has someone actually used this exploit
on us we kind of actually john stott she
was running the team he said well the
first thing I would do is start looking
up
it's looking are the locks on our
operating systems we are getting your
logs all in one place you know maybe
something like the elk stack or or you
know or something like Splunk or just
you know good old-fashioned dancing of
your log files or whatever or our syslog
putting all your information your log
files in one place could allow you to
actually look at what's been happening
to your systems over a long period of
time an awful lot of malicious attacks
will leave traitors in logs sometimes
the traitors they leave in logs is the
absence of logs and that in itself to
somebody who's a security professional
who's trying to find out what's happened
is useful information some of these
attacks will wipe logs out but if you've
a great another words if you forward to
the table off those machines and store
them somewhere centrally they may not be
able to get access to that information
one thing to consider when it comes to
stuff like logging is the fact that the
retention policies that you might want
as a developer or a person working in
operations might only be a few weeks
whereas security stuff like this we
actually were looking a five year
attention policy for our logs to be able
to go back quite a long way to see what
had been going on starts thinking what
to consider you've also got things like
security appliances that can actually
run in your network stack IP based
security mechanisms that can actually
look for malicious attacks sometimes
stop them from happening but also just
flag up things that look a bit you know
dodgy mod security is an example of a
tool that can do both of both of those
things and of course you can then start
dropping those things enos or security
appliances and you know having those
things in it more than one layer can be
useful we have multiple different
potential perimeters here not just the
networks but also our process boundaries
and you may want to apply different
devices at different times as I mention
when it comes to this whole detection
piece a lot of it is just keeping up to
date with what the hell's going on and
some people are dot micro service
architectures with the explicit aim of
having a more polygon programming
environment I want to use the right tool
for the job and that's a lovely idea but
now I've got a ruby stack and a Python
stack and I've got a Java stack and I've
got a closure stack and there's only
four people here and we've got one
programming language each and keeping
onboard or up to speed with all that
it's really difficult so how is both
know what's going on now I do wonder as
a
to help automate some of this stuff get
better as we see more tools like snick
this will become easier to keep to keep
up with but if you're an organization
right now if you're one of the people
that didn't know how often your stuff
was patched this is going to be a worry
and I would actually say being polyglot
for you is probably going to be more of
a potential vulnerability in your and
your strategy than the benefit because
you're not going to be able to keep up
to speed with all these things the
flipside is once you get really good at
automating your stuff and making sure
things are properly patched and knowing
that those patches have been rolled out
polyglot could also be a benefit now
suddenly you've got different
technologies in the mix a vulnerability
that affects one kind of technologies
that may not be able to affect another
yeah sure they might better crack into
the catalog service because we were
running slightly older version of Java
than we should have or they found a
zero-day but the other stuff we've gots
running in Ruby so they're gonna have to
find some other way of gaining access to
that so you know this polyglot stuff is
again like Marcus services in general a
bit of a double-edged sword when it
comes to security moving on now we'll
probably talk about some of the more
human aspects and things that aren't
necessarily specific to micro service
architectures that's how we deal with
the response after some sort of
disastrous thing has occurred now target
is an organizer is a company that exists
in Australia the story I'm gonna show
you is not about the Australian target
it's actually about the the u.s. target
and they're actually quite different
companies so target in the US you may be
aware many years ago now had a rather
nasty security breach where basically a
large number of credit card information
was basically stolen their records for
about 40% of all US households were
actually impacted by this breach that's
a lot of households and what actually
the reason this story blew up is because
target found out about this breach but
didn't meet anybody and were eventually
forced to reveal what had happened it
actually got a lot worse than that when
people started getting the details of
what had occurred at the time target was
one of the few big-box retailers in the
u.s. to actually have their own internal
security team a lot of organizations
outsource that but it had their own
dedicated in-house team looking at
security and that team had spotted some
rather interesting things happening they
spotted actually
more we're being installed on the
electronic point-of-sale systems this
particular mall was quite clever this
was when they when the credit card
information is breached typically what
we think about is someone gain access to
your database and the information was
poorly stored or poorly hashed this was
actually more where that was running
memory resident on all these electronic
point of sale systems and as people's
cards are being scanned this mall I was
catching that information and then it
was actually forwarding it and their
internal team spotted this more being
installed and they went nowhere more was
being stalled mall where hello-hello
mall where every every no one okay
alright we'll go back then shall we and
then they spotted the credit cards being
shipped the credit card information
being exfiltrated I like using words
like exfiltration dark web and external
trace that's why I talked about security
so great it's just like an episode of
CSI cyber can't believe a canceled CSI
cyber
anyway and they spotted it being
exfiltrated and they go
they've data go data bye-bye they to go
bye-bye
and there's nothing like crickets it's a
great example right this is an
organization that hadn't actually
thought they said they've gone to the
effort of having a security team but it
hadn't properly connected a security
team into the organization as a whole
the information was not going weren't
needed to get to it wasn't being
listened to appropriately shares in the
company behind the software they used
fire I immediately went up and then fire
I were there that's directed like a
bunch of idiots later on about some
other stuff I won't go into and
interestingly a bit later on
Home Depot got hit with exactly the same
attack the CEO of target eventually lost
a job over this whole thing it was the
fact that they took so long to let
people know and the fact that even then
they should have spotted is happening
before it happened
cost them an absolute fortune a lot this
does by the way if you're interested in
security in general and stuff that's
happening out there I can thoroughly
recommend Brian Krebs his blog he does a
really great journalism looking into
this whole space and he can tell you how
much you'd get for a stolen credit card
number on the dark web just in case
you're interested a lot of this stuff
does actually just come down to the
fuzzy human stuff it does actually come
down
you know to comms to communications to
empathy to emotional intelligence and
actually really thinking a bit more
clear-headed Lee about this stuff I'm
sure some of you are aware of a website
called at Ashley Madison is a rather
interesting salacious story because of
the nature of the site but they were
hacked quite a worm two years ago now
and it was a great example and how not
to handle a response around a security
breach sees these sort of hackers came
out and said look we've got all your
information and unless you shut down the
site we're going to publish this to the
world and actually Madison said you
don't have all our data and they go yeah
we do we've given it to independent
researchers to prove it and actually
Mason said you don't have all of it
you've got a little bit of it you're
just faking about the rest and there you
go no we've got all of it and they go
all right you might have all the data
but that's all you've got you've just
got all the data you don't have anything
else all right you've also got all of
our emails as well okay you've also got
all the emails and all of our data and
all of our source code and it was just
drip feed of denial and obfuscation and
it just stretch the story out I mean
this would have been a hot story anyway
because of the nature of the site and
the way they handled the communication
around this just dripping stuff out
being very fuzzy about their
communication not actually thinking
about the people that are affected by
this they were thinking about themselves
not their customers in the hat' way they
handled the whole thing and it was much
more damaging as a result a great
contrary example to that would be it
what happened in the wake of the tylenol
poisonings in the US so it was a very
sad stories back I think was the late
70s in Chicago seven people were killed
when tylenol was poisoned in Chicago so
tylenol at a time is the it was the
biggest-selling painkiller I think it
still is in the US and so they never
quite found out who did it or how the
poison was injected but they these
people died in Chicago there was no
evidence that it was anything other than
a local issue but Johnson
John's the company behind tylenol
decided to withdraw tile from across the
shelves of every store in the US the
recall cost of around 100 million
dollars in late 70s money right that's a
lot of money they then immediately put
it into a great new technology about
having tamper resistant capsules
redesigned their whole supply chain to
make it more secure and they did it you
know they did quickly and they did it
right when they went on I went back on
the shelves it went straight back to
bigger number one painkiller in America
and Johnson Johnson got a huge PR boost
out of it that wasn't what they're
aiming for they knew that people were
worried they knew their customers were
worried and that people were dying and
then he had to fix it they did the right
thing it's a great example of how to
deal with response well of course we've
unfortunately got more counter examples
than good examples another counter
example be Adult Friend Finder Troy told
me about this story and another website
where adults can be adults for adult fun
and you would specify what kind of fun
that you would like to have in detail
and this information was breached and
it's quite specific I understand and one
of the main execs behind it came out
said don't worry don't worry I know
you're all worried but it's okay they
didn't get your credit cards yeah
because that's what all their customers
are worried about isn't it you know
because I lose my credit card Wow boy
I've got a phone at the bank and wait
five days to get a new card this
information doesn't go back in the box
if your coworkers are looking up to see
whether or not your email addresses on
this website right it actually comes
down to the fund is it's two things
right one and it's thank the see harder
to fix in a ways a fundamental lack of
empathy for your customers I think it's
not really forgivable especially not in
a scene exactly the website like this
the second thing though is that this
response is often done in haste you're
doing this when the lights are flashing
red everybody's running around like a
headless chicken you're getting slammed
on Twitter your phone's ringing off the
hook and somebody decides to say
something stupid and it's Nobel's the
best time to think about how you're
going to respond to a nasty security
breach
an attack is when you don't have us
attack going on right now get together
as a team say okay well let's come up
with a couple of scenarios of the worst
case things that could happen what
should we do what should we say can we
draft an email
who's gonna email gonna come from who's
gonna be the point person it's gonna
send the communication where are we
gonna send that communication is it
gonna go on our website is it gonna go
on Twitter let's draft that email now
because then one that when the hopefully
it doesn't happen but if it does you can
pull out that email you change a couple
of details and you send it and you've
thought it through a little bit more
you've got a plan to come back to you're
not running around trying to fix it work
out what's going on and handle your
comms plan all at the same time let's
now talk a little bit about recovery and
I actually think recovery in the context
of Marc services can be more difficult I
mean recovery here in terms of will you
have to get your system back to a stage
where it can actually work and run and
handle your customers load again and the
very first thing you've got to think
about you want to think about how to
recover your system is well you know the
basics backups
you've got backups right you've got
backups hands up if you test your
backups routinely we're routinely is
less than once every five years
right ok maybe 20 people in the room
it's pretty good though it's sad that 20
people in there is pretty good but it is
pretty good you get crypto lot but you
can recover your data now what I would
say is think about where backups are
have you heard of a site called code
bases anyone out there no you haven't it
doesn't exist anymore just start up that
got completely wiped out when their
Amazon credentials were leaked and then
no one's ever quite sure if these all
these Amazon resources were shut down by
a malicious employee or just some
someone looking access their API keys
but they their whole production systems
are wiped out and they said okay we've
got backups backup so on the same Amazon
account and so was all the source code
so the whole company was wiped out in
the space of probably a couple of
minutes right so there are people that
can tell you about how to do backups
where you store them there those are
tools that will help you automate your
backups now if you've got a manual
process around this with your existing
monolithic system that's gonna be really
problematic when you've got 40 services
each of their own databases now you're
trying to manage manual backups and
restores of 40 services you've got a
manual backup process I bet you don't
have a manual store process and you're
putting or automatically testing this
stuff so you've gotta think about this
this actually is one area where
standardization can really help if you
standardize some of applications that
you'll standardize your database stack
you can standardize the tooling to
manage all of this stuff for you but if
you've got backups and you know they
work you can recover more easily because
then what you can do is you can just
burn the whole thing down one of the
nastiest kinds of things is the advanced
persistent threat the person who sits
and hangs around on your network that
installs like rootkits on your boxes or
they patch PS and LS on Linux systems to
hide their either the fact that that
even exists and we know that that's what
these root kits do and that's why when
we've had an attack the only thing you
can really do is wipe all of your
machines start again from scratch now if
you're fully automating how you build
your systems and you how you build your
services and that the way you do that is
through stuff that's in source code that
can be looked at and audited if you've
got fully automated deployments of your
system and you've got backups of all of
your data that are tested and working
and can all be automatically triggered
then just just put a match to your whole
system burn the whole frickin thing down
spin it up on a brand new account from
source code you can scrub every last
traitor that attacker out but again if
your processes around this right now or
manual this is going to be really
difficult one of the best things that
you can do early on for other reasons
like you know predictability speed is to
automate the setup and deployment of
your software but from a security point
of view it's really really useful
because the worst comes to the worst you
burn it all down and you just start
again so coming back to our four part
model prevention detection response and
recovery and it comes to prevention
you're gonna need to do some kind of
threat modeling otherwise there's a
danger you get attracted to the shiny
object or we definitely need that lovely
IP based CCTV camera that's RFID tag us
all put the chips in our hands and so we
can wave it in front of the what about
the window that's open ice final s nice
breathe in and be okay we get obsessed
with the wrong things we often miss the
human factors to do some basic threat
modeling do some enumeration by all
means get an external party in to do
that sort of stuff for you but you could
actually you know do a lot of it
yourself so go read the stuff up on
stride and dread that you can find over
at Microsoft's site on that topic
detection think about software that you
can run IP based security software that
can run but also think about things that
can look your application snacks things
like snick that will tell you if you've
got software that needs to be patched
things like Claire for docker based
systems that could look at layers in
your service stack that might have
vulnerabilities and also you know work
out what tools your operating system
vendors might have for looking at patch
levels on running machines when it comes
to response there are way more examples
of bad response than good and so you've
got a lot of people from to learn from
but think about how you're going to
respond when nothing bad is going on
think about it now think about it today
it's an easy exercise to it when I was
thinking calmly and rationally and once
you've done that know what you're going
to do to recover and that you know if
you're practicing things like your
mutable infrastructure you're doing a
fully automated deployment to roll out
those servers in your systems your
response is actually going to be quite
straightforward to some of these things
but I hope this models been useful I
hope some of the material today is being
useful if you don't know any more I have
stuff on my blog over at Sam you endure
IO and you can ping me on Twitter I
answer any and all questions about Rugby
League board games and micro services in
that order and I think we've got a few
minutes of questions now if anyone has
any are there any questions out there
that question in the back there
you mentioned that you can should
automate the process of backing up and
restoring interest or as much as you can
but what about corporations that have
off-site backups and like deep backups
or anything wrong with the time to get
the actual backup that's gonna be down
to an organizational decision it's like
in a in a situation like this how long
can a system afford to be offline I mean
a lot of those off-site backups and
those deep backups are there for
different purposes that have different
retention policies as well so normally
any retention you what you might want to
do is keep fairly recent backups quite
local but also have a copy off-site as
well and then your long-term further
back backups can be off-site you know
you think about it when am I going on a
backup from five years ago I might be
okay they're being a bit of a lag time
for that but a backup from them today
I'm gonna want nearby and so your any
proper decent backup should policy
should keep that in mind because backups
are actually there for multiple
different purposes any other questions
all right
thank you so much your time I hope you
enjoy the rest of the conference
and if you're interested in consulting
or training I'm back in middle of March
next year but thanks your time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>