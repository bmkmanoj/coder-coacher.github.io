<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Web Application Security Risks: A Look at OWASP Top Ten 2017 - Christian Wenz | Coder Coacher - Coaching Coders</title><meta content="Web Application Security Risks: A Look at OWASP Top Ten 2017 - Christian Wenz - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Web Application Security Risks: A Look at OWASP Top Ten 2017 - Christian Wenz</b></h2><h5 class="post__date">2017-07-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/avFR_Af0KGk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right good morning oh but I can't
see anything with those lights so it
sounded like there were three people in
the room but still for those three
people I'll give my best yeah so thank
you for for picking this talk this
morning this is such a capacity crowd
and I do think it's absolutely worth
your time it's also absolutely worth my
time because this talk has been I think
a year in the making I will be talking
about the ovis top ten 2017 and if you
have followed that top ten list created
and curated by the open web application
security project Oh Beth then you may
have seen that you know there was a list
in 2003 and then one in 2004 2007 2010
2013 so you kind of see a pattern here
right so at last year's conference we
thought about how about we do a session
on OS top 10 2016 might an awesome idea
let's do that and then we waited and
waited and waited and then we did
something else of course and we were
really we were we wanted to do this then
in London at the London Show in January
still no list okay hmm
but now we are lucky because a couple
weeks back release candidate one of the
ovis top ten 2017 was released so
actually there is something to talk
about now basically the top ten list of
the overs is a list not of security
vulnerabilities that's a misconception
it's a list of security risks right so
things that might happen and it just
Europe provides a good overview of what
kind of risks out there for today's web
applications and how to mitigate those
with there have been some discussions
well recently and also since since a
while whether this list is still
relevant because how is this list
assembled basically security researchers
they analyzed the results of their
audits and they put it into a system
if they have found whatever a certain
risk that many times and another risk
that many times its put in and in the
end well the people responsible do best
for that list they kind of do the math
try to categorize everything and then
put out a top ten list now if you go
through that list some of those items on
the list they seem to be at the wrong
position right at least in my opinion
some of those items state they are kind
of really weird so you can really argue
is this list still so relevant today
right but I think it still is because so
many people so many developers are now
moving to to web development and
everyone needs to know about security
it's such an important topic so everyone
has to know what risk is and how to how
to work with these risk and therefore
this list even though I don't always
agree with some of the items on the list
or the ordering of that list is still a
very very blessed so what I would like
to do today this morning is I'd like to
go over that list you'll have a look at
the ten items on the list
I'll cover each of those items for some
of them we have a look at code or we
have a look at countermeasures and also
there are some wellmaybe attacks that
Quaeda do not fit in one of those ten
items so I've added them where I saw
them fit as well so again you should
have a very good understanding of what
to look out for when talking about web
security both old and well trusted risks
and vulnerabilities and also rather
novel attacks so that's the agenda for
today and talk about agenda basically
that is the agenda that's the 2017 top
ten list as of release candidate one I
expect the final version to be released
and fall but the the order of the risks
and also the names of the risk I think
they they should not they should not
change so we have injection rock with
application and session management
cross-site scripting and these three
items actually they are the same items
as in the previous list and then there
are some subtle changes Broca access
control that's kind of new security
misconfigure
result sensitive data exposure old
insufficient attack protection ok that
sounds a bit weird we need to talk about
that in a bit
that's kind of new cross the request
forgery is old using components with
known variability that's old and very
new and a new word which I didn't find
in Webster's dictionary under protected
api's so let's have a look at those 10
and let's start at number 1 and number 1
is a thing that I find a bit weird I
mean I I do web development since about
20 years now so I started really early
and you know back in the hay days there
was a lot of injection well I mean there
are different kinds of injections right
so alidev injection for instance xpath
injection or a thing I kind of invented
for a small paper I once wrote and then
I later founded in order about a year
later talked about inside reg X
injection so the idea of course we get
input from the user and that input is
then put into well a kind of a query
language most of the time right since
many query languages do not put both
commands and data in the same well
stream we might get an injection so a
malicious user could inject kind of
commands into our query string now when
you talk about injection I would say
over 99% of instances where we do find
injection is sequel injection right yes
in the 1990s sequin Junction was the
same and in the early 2000s sequin
Junction was the thing well injection is
still number one on that list hmm that's
interesting maybe because I find it so
confusing let's have a look at that list
so what you get as part of that list is
a nicely formatted PDF where for each
and every item on the list you get
information countermeasures etc etc and
you get this kind of matrix and you get
both you get like a color scheme so how
easy is it to
- well attack this risk how easy just to
exploit that and a transaction is easy
to exploit and the impact is severe and
because of you know those two red flags
here maybe that's why it's so much so so
far on top of the list but I mean
seriously those of you who work with
perfect application security or I have
followed web application security over
the years I mean how often do you see
SQL injection or sequel injection today
or in the last few weeks months years
since they I mean I regularly do audits
and seek injection is using the least of
my concerns because how how do we
communicate this database
these days I mean if you're using dotnet
and I think the majority of of you are
doing that then Microsoft is kind of
forcing us more or less to to use entity
framework with recent versions of entity
framework it's extremely hard to create
C congestion because it's extremely hard
to you know actually send commands to
the database at the idea of object
relational mapping is that you will use
as equal and longer anyway because you
work with objects right and empty
framework in that case does the mapping
and if use something else like an
hibernate or if you're not in the dotnet
space hibernate or propyl or whatever
well then the framework takes care of
that so really CQ injection I haven't
seen this in quite a while I do know
that there are many instances of C
transaction out there old legacy
applications that are written in let's
say classic ASP and are still running
somewhere I I totally get that and
that's that's really sad but but still
number one on that list I'm I'm not too
sure about it
however no matter which technology we
are using in Fanning again signal
injection is so easy there is no excuse
for having sequin gesture in the first
place if you use o our mapping then well
you should be safe if you have an
up-to-date version of the O our mapper
and we'll talk about that having an
up-to-date version in in a bit and if
not well the best
to prevent leak injection is to have per
my prepared statements or parametrized
queries right so you do not have
commands and data in the same string but
you have placeholders for the data and
then assign values to the placeholders
and the mechanism then automatically
does the escaping for you so really no
excuse for fuel injection really there
isn't but I also do not see through
injection as a big as a problem today as
it was before so still number one but it
sounds a bit weird right because it just
doesn't happen I also have some tiny
issues with number two O's because it's
so high up on the list it's broken
authentication settlement now I know
section management I mean just if you
talk about session management you talk
about things that are broken because if
you Lee read the HTTP specification then
you see there that and I think it's the
second sentence in that specification
that HTTP is a stateless protocol
meaning with HTTP you can't remember
anything he however applications do need
to remember something whether the users
logged in what what kind of items are in
the shopping cart cetera so well session
management was kind of vented well first
cookies were invented then session
management was invented and essentially
people found out you can do session
management without cookies but if you do
that your host so ok I have to use
cookies and you have session management
together with that now there are
different well risks and associated
attack vectors against the session
management the most commonly known is
session hijacking the idea is with
session management every session gets a
unique name or number the session ID
most sometimes it's calls so usually the
session ID is sent to the client as form
of a cookie and with all subsequent
requests the client sent back that
cookie sent back that session ID so the
application then knows okay that's the
session abc123
and oh yeah I've saw data about that
session okay that that user and the user
is these islands of the shopping cart
that's great
if the session ID remains a secret
because official ID is the only thing
that identify the user so if the session
ID is stolen that there are several ways
of stealing a session ID then the
session is hijacked so that's the most
common attack against session so we need
to protect our session IDs as good as
possible so one of the aspects and this
is also covered in one of the other
items on the list is if a session ID is
transported unencrypted because we're a
web application it does use HTTPS anyone
can intercept their traffic so here at
the conference if you have the
conference Wi-Fi a conference Wi-Fi
isn't it encrypted so everything you
load a request on the conference Wi-Fi
which uses HTTP can be seen by other
people in the same network as well HTTPS
not so much of course but HTTP yes so if
a session IDs transported via HTTP then
we have a problem then session hijacking
is possible there are other risks
involved other tax involved as well so
for instance you can configure your
sessions in in various ways one of the
aspects of configuring a session is to
configure a session timeout meaning
after which amount of inactivity is the
session considered well discarded or
expired and now usually have the scale
with usability on one hand and we
security on the other hand you have the
best security if you have a session
timeout that's as short as possible
because short session timeout means if
someone steals a session ID the attacker
doesn't have that much time to actually
use the stone session ID if the session
timeout is set to a low value on the
other hand that means you know if you go
to a page to page take some time to load
because you know conference Wi-Fi a lot
of people in network you go to another
browser tab do something you go back ah
session ID has expired we have two real
aughh in bad usability on the other end
great security so
it's kind of hard to get get both so
there are several things you can do but
basically session management is
something that is provided by the
framework we are using if you use a
pillow net we have session management
there if you use PHP the session
management there I mean the Thresh
management at least try to use as many
best practices as possible so the
session ID is not and I thought of that
an audit recently six digit number which
is kind of easy to guess but it's a long
string how to guess there are settings
to ensure that a session ID is only
being transported via HTTPS there are
settings that the session ID is not
accessible to JavaScript codes so there
are options well and usually they are
activated by default so not much can go
wrong the only thing you should consider
is that you implement your own
additional safeguards for instance you
could store in the session the let's say
the user agent it doesn't mitigate all
risks but if a user is using let's say
chrome of the time and then all of a
sudden the user in the same session is
using let's say edge or LLL take
Internet Explorer I mean though is a bad
sign if a user is using Internet
Explorer right but it suddenly the
browser changes then something may be
wrong so you might actually then
whatever logout the user or flag all the
actions that the user is doing from now
so that's number two and it kind of
important but I think it's pretty high
up on the list because if you if you
look at some security issues especially
at security issues there's one thing it
was part of to listen to so 2003 and has
a a top three position
ever since then and that's of course
cross-site scripting that attack is so
old that you would expect well nowadays
it should be soft but it isn't it just
is the idea of courses that we somehow
manage as the attacker to inject some
content on a page
and that content usually happens to be
JavaScript or you know in the old days
it could also be an object tag that was
loading and the young people in the room
doesn't know the term so apologies for
that there was loading a plug-in with
some content like you know flash or Java
because many of those plugins have
security vulnerabilities in older
versions so there was an easy way to to
well install some interesting software
there cross-site scripting is still one
of the worst attacks to get because if
you have cross-site scripting on a page
that only can be attack around arbitrary
JavaScript code but also it's almost
impossible to defend against other
attacks including cross-site request
forgery which will come 5.5 points or
further down on the list so cross-site
scripting really is a big problem
especially with modern single page
applications new vectors are opening up
so I find this pretty interesting too to
mention usually talk about cross-site
scripting we are talking about type 1
cross-site scripting and type 2
cross-site scripting Caban cross-site
scripting is well probably worst of them
persistent cross-site scripting so the
user sent something let's say javascript
to the server the server stores it in
the database for instance which is fine
because the database doesn't care it's
all about javascript the problem is that
the web application later can read out
the data from the database and maybe
puts it on a page verbatim without any
encoding so whoever then loads to
certain page does execute the malicious
JavaScript code so that's the worst
thing to happen the most common thing to
have miss non persistent or reflective
the cross-site scripting the user sends
something to the server and the server
echoes it back typical example search
page so you have a search field on a
page and you search for something
whatever let's say NDC and the resulting
page usually says your search for NDC
yielded whatever 100 matches and that
NBC part of the output is something that
comes from the user now what happens if
you do not search for NBC but for script
tag and then some code well if it
printed out without any encoding there
you inject the JavaScript code it's a
bit harder to make sure that someone
else is then getting that JavaScript
code but their way to do this right so
these are the most well important and
common versions of cross-site scripting
however there's an additional one and
the the overpass created this kind of
classification of cross-site scripting
and the first one was not very common
until while back but nowadays it's
getting more and more common dom-based
cross-site scripting where everything
happens on the client so the idea is you
have a single page application the
single page application read something
from URL maybe a URL fragment use it
that uses that information and puts it
on the page so no server interaction
well but if that fragment for instance
contains JavaScript code or if you're
using the same angular JS and the
fragment contains an angularjs directive
and that directive is then applied to
the page we still have cross-site
scripting without the server doing
anything right so there are a lot of new
new new issues coming up and therefore
it's super important to defend against
cross-site scripting we talked about
defending against cross-site scripting
in a second but that's just one thing I
need to talk about and that's the same
written policy because the same erection
policy is the sole security mechanism
javascript has two javascript credits
this security mechanism is available
since the inception of javascript so
there wasn't in cross-site scripting but
they already kind of had a hunch that
something might happen and it's
important to know because it kind of
protects us from some attacks but on the
other hand it makes attacks if they go
through extremely dangerous so if you
have a page and the page has some inline
javascript code and it's also loading
javascript code from their own server
then maybe from a CDN I was using jQuery
here as an example but this could be any
JavaScript library that JavaScript code
that's in line and the JavaScript code
that's loaded from your own server and
the JavaScript code that's loaded from
another server they all run in the same
security context and the security
context of the JavaScript code has not
to do with whether javascript code comes
from it only has to do where the
JavaScript code is loaded and JavaScript
code is loaded here at example.com port
80 using HTTP and that's the so-called
origin rich and consisting of protocol
domain and port the JavaScript code now
runs in the security context of protocol
domain and port so it may access
anything with these three well
attributes or values matching the
current HTML page so JavaScript code can
whatever XS cookies set for HTTP
examples of common port 80 which is a
necessity for it to work
it can also access all the elements on
the page because it's the same security
context that's also important because if
you load jQuery or angularjs or react
then you know the frameworks do want to
access the current page to do their
thing yeah but if you have malicious
code injected by a cross-site scripting
that code of course runs in the same
security context so it can do anything
your own code code is doing and I mean I
have written code that it's considered
dangerous but because it was so buggy
but you know if you are really creating
malicious code and injecting it on that
page it's it's a big catastrophe so the
same origin policy it's both something
that's a safeguard but on the other hand
it makes cross-site scripting even more
dangerous now let's talk about
protecting against cross-site scripting
in HTML we have five special characters
we have the angular brackets opening and
closing because they delimit tags we
have the single and double quotes
because they the limit attribute values
and we have the character ID represent
character for 5ml entities if we have
user data and we would like to output it
we have to escape those five characters
if we are in an HTML context I mean
technically that that's a blacklist
write a list of five forbidden
characters and what you learn in when we
talk about security
that usually black lists are bad because
one missed item in a blacklist meaning
security vulnerability better is a
whitelist a list of allowed characters
but this is I think the sole exception
where a blacklist is good enough in an
HTML context if your output user data in
in JavaScript then well my first
recommendation is try another approach
seriously try something different but if
you have to do it javascript has
additional special characters for
instance the backslash this needs to be
escaped as well but there are other
options too so Internet Explorer 8 yes
Internet Explorer 8 the greatest browser
ever written and obviously you're
laughing and you know I'm kind of
smiling too but you know in retrospect
actually it was a decent browser why
because it introduced a lot of security
features which first went can unnoticed
but were then adapted by most other
major browsers I will not talk about
internet explorer 9 10 or 11 these are
different kind of beasts but insects or
8 introduced among other things are
built-in cross-site script cross-site
scripting protection so the most
realistic and when is explore thought
okay this might cross-site scripting
then cross-site scripting was blocked
sounds like a great idea but you know
can we really trust that blocking
mechanism is may be blocking my legit
application so there was an HTTP header
X XSS protection and if you set that to
zero the cross-site scripting protection
was turned off actually Google did that
the day Internet Explorer 8 was released
because they were afraid that insects
fluoride is doing something funny to the
search engine a few weeks later they put
it back on because they found out well
it actually is a pretty good thing the
cross-site scripting protection is not
perfect because they want to avoid false
positives at any cost it's better to let
in a textbook through then make an
application alleged application not work
any longer because then people think the
browser is bad but still it's a pretty
useful feature it's also implemented now
in Chrome and Safari it's not
implemented so by default in Firefox
unfortunately
so that's why I often do security tests
in Firefox right because there's a
built-in protection but actually it's a
pretty useful thing but I mean truth
will be told it's pretty sad in my
opinion so the browser's have to come
with a protection because we as
developers are not good enough to
protect against cross-site scripting
that's depressing it really is but maybe
I have something to turn that depression
into enthusiasm and that is something
called content security policy or CSP in
short it's a w3c standard version 2 has
been standardized last year it is
supported by all the major browsers if
your interpretation of all the major
browsers means current chrome current
Firefox current Safari
it's a browser missing there Oh actually
current edge browser has it as well but
only if you have to create as update for
Windows 10 you know that one was
released in February March something
like that April well you know that a few
months back previous versions of edge
only support an older version of content
security policy which is kind of good
enough the major issue with content
security policy is Internet Explorer if
the Explorer versions 10 and 11 they do
support an old version of content
security policy but they only support
one feature and the feature is I
wouldn't say worse less let's just put
it that way the feature is not in use in
the real world right but still great
great technology I could talk for 4
hours on this but I like just like to
show you a quick example that you see
how generally works and I hope you will
be as excited about that as I am so the
idea is this the server sends an HTTP
header content security policy with
dashes in between and a policy telling
the browser where to load data from
where to load resources from what what
kind of code to execute and the
browser's then enforcing that right so
browser gets the center whatever only
loads images from that server and if
there are images being loaded from
another server the browser trust says no
about
and that can be really interesting now
actually let's let's have a look at an
example here so I have a page here's the
page excuse me
so that's a page it has a beautiful
image and it also has an alert window it
says in line I'm going to close that
window it says external well because
there are two types of JavaScript code
on that page or actually by the way I'm
a great designer so you see we have here
beautiful orange orange bullets okay so
let's have a look at the the code for
that I happen to have it open so what we
basically have is we have some inline
JavaScript here then we load an external
javascript file but it's you know it's
on the same server but that doesn't
really matter at the moment and then we
have two lists here and we have an
inline style for the list and what we
also have is we have two links one link
is just loading the page and the other
link is a pending CSP equals one to the
URL of the page now in the controller
that's an MVC application in the
controller what what we do on that page
is we check if these people's one is in
the query string and if so we set the
content security policy header to a
specific policy value now such a policy
looks like this we have a set of so
called directive these are those things
with the dash in between so the default
SRC directive what basically does is it
provides a list of URLs for well
everything we load usually with an SRC
attribute default SRC is so to speak the
mother of all directives we have more
specific directives for instance image'
SRC we have two the limiters from or
script SRC very low JavaScript from or
stylus SC where to lodestar sheets from
font SRC for web phones etc etc etc but
if it's a different as a receive this
kind of compasses most of the other
directors so I could provide a list of
so origins here or in later content
security policy versions specific URLs
or your fragments but when a conference
is due is hgp whatever local host poured
one two three four and then everything
can only be loaded from that server now
actually this sample page here is not
running from localhost port 1 2 3 4 but
localhost port I don't even know so
that's what a good idea but I actually
want to do is that everything is loaded
from the current domain the current
origin of the current page and for that
they have a constant and because it's a
constant it's limited by single quotes
so info itself means ok load it from the
current origin if it's not from a
current origin don't load it well if you
have a look at the markup again we see
that shouldn't be a problem because the
image comes from the current server
because a relative path as does the
JavaScript code so we might expect that
this content security policy the page
works exactly as before now let's try
this out so I click on the CSP link and
if you look very closely bottom left you
see that these peak was one is appended
to URLs ok so when I click on there what
I get is a pop-up saying external or
wait a minute what wasn't there like in
line before ok
very weird let's have a look what's that
about and then we see where the image is
still there but my beautiful orange
color is gone too
so the inline pop-ups the inline alert
window didn't show up and the color is
gone
why because both of those were in line
inline style
inline JavaScript code by default if you
have a Content security policy then
inline is disabled and that's a good
thing because how does cross-site
scripting work let's talk specifically
about cross-site scripting well someone
injects script alert 1 not possible any
longer with content security policy
because there is no inline code which we
can run
mmm okay I'm intrigued but there's
another tech vector
script SRC equals HC P attacker.com /
bad script ojs not possible this content
security policy because we're telling
the browser only low JavaScript code
from our own server so that attack
vector is closed as well third attack
vector
stripped SRC equals bad script of Jas so
yes we can load malicious JavaScript
code if it is already residing on the
target server on the other hand if we as
an attacker managed to upload some
malicious JavaScript code to a remote
server and cross-site scripting is
probably the least of the problem of the
owners of that server right so
technically with content security policy
we can beat cross-site scripting I mean
it does can come at a certain cost
disabling inline javascript code for
instance might be cumbersome for some
kind of applications so those of you who
have worked with let's say a few net web
forms in the past or maybe still now you
know that the mechanism behind every
unit web forms is injecting some inline
javascript code which is needed for for
running the page there's very work
reforms well this code then doesn't
really work very well well it doesn't
actually work when you use content
security policy there are ways around
that so we can enable inline JavaScript
code again so what we could do for
instance is we could add another
constant and I mean you know if I was to
write a specification I would say okay
let's use the clock let's add a constant
called inline which enables inline
because a standard is supposed to be
neutral this Center is not neutral the
confidence are called inline it's called
unsafe - inline so we do know that it's
a bad idea what we are about to do right
so we know by adding this unsafe
constant yes inline code is back again
but then on the other hand a new
cross-site scripting attack vector just
opened
so yeah there might be some issues 20
security policy version 2 added new
features that we can say ok you do not
want to allow inline JavaScript code
unless the JavaScript code has this sh a
hash right so if you know we always have
the same kind of inline JavaScript code
because the framework just emits it then
we calculate the hash and say ok if the
code has this hash then we can run it
and it's really hard for an attacker to
you know write malicious code that
happens have exactly the same sha-512
hash if not virtually impossible so I
think it's almost possible to create a
collusion here so that that is an option
only well done content security policy
version 2 so if you still have support
all the edge versions or Internet
Explorer that is not an option for you
in those cases for those browsers you
have to use on say Finland right or you
refactor your application - well
actually avoid inline Styles inline
JavaScript code which from performance
perspective is a good idea anyway
again I could I could talk for hours
about content security policy and I
think you also get the impression that I
am a bit overexcited about this but
still do consider using that in your
applications I've migrated so many
customer applications to contribute to
policy and it's always you know it's
always a bit of a struggle it's actually
it's a legacy application that we've
funny stuff this you know injecting
injecting code in the page but in the
end you know you have just an additional
very very thorough layer of security
that helps defend against number 3 on
that list so really it's a great thing
so please do consider using college
security policy to be cross-site
scripting the next item on the list
number four is a bit more on let's say
it's a mixture of two items of the
previous list it's called broken access
control and 2013 lists made two items
out of that because they made a
differentiation between accessing data
and xsm functions well you know they
using an MD
framework like ice to net NBC or ACL
core then basically the URL very often
maps to a method or a function on the
server and you know some applications
are very optimistic so they think well
my my URL so secret right so no one has
gotta get the idea to go to my website
and then does slash admin at the end of
the URL or question mark is admin equals
true so while I just do this to create a
backdoor in my application yes it it
still happens originally found something
like this
so access control to all functions must
be in place when you have a form and
that form can only be loaded when you
are authorized but when that form is
posted back to the server you just
assume a how should someone know that I
can there's a forum to post back so I do
need to authorize the post request oh
yes you do same thing goes for data so
if you have some secret information if
the only thing secret is LinkedIn or the
URL maybe it's not good enough I mean
the over stop 10 is a list of risks and
with all risks you have to risk
management and have to decide ok do I he
s to invest resources to mitigate that
risk
take take Facebook for instance if you
go to Facebook if you upload a picture a
photo and the photo is not public right
so only for your friends are you in
private still that picture gets a URL on
a different server and there is no
access control so if someone guesses
that URL they can just access the
picture without any access control the
URLs are so long that it's really really
hard to guess that URL but still extra
control the data is missing there there
are reasons why it's that way there are
also performance reasons and so you know
Facebook does the trade-off and very
often we do the trade-off as well but so
keep that keep that in mind now when we
talk about access control there's one
thing I like to briefly cover and that's
an attack called mass assignments so
this was on github a while back you know
and get have any open issue in the issue
tracker it says this issue was opened 20
minutes ago
issue was opened in 1001 years right and
the attack here is called mass
assignment or over posting now the idea
is this so this was done in in Ruby on
Rails but it's also possible in asp.net
MVC if you use modal binding so let's
talk about modal binding model binding
native net MVC means you have an HTTP
request let's say a post request and you
know you have some data in the post
let's say how I would this buck and if
you look like a title and the text and
an author maybe and so you have well
maybe the author's part of the session
so let's just say Thailand text so it
sent an HTTP POST request to the create
new entry endpoint and you have a field
called title with I'm bender from future
and you have a field called description
or text and well you have the text of
the DB entry now what model binding does
is you probably have a model class a
buck entry and the bar entry has public
properties like title and text and model
binding looks oh wait there is something
in the HDPE post that has the same name
as that property ok let's assign it oh
and then there's another thing that has
the same name as the property let's
assign it so model binding automatically
turns the tech space HTTP POST into an
instance of our little bug entry model
class now the problem is that that bug
entry model class will also have a
property called creation date the form
for setting up such a such an entry does
not have a date picker because in the
constructor of that model class which
has set the creation day to the current
date but what if the HTTP POST request
would also contain a field called
creation date equals June 15th 3,018
well first the class is accentuated and
then all the attributes and all the
members are set so in the end we have a
back entry opens on 15th of June
3,018 which is exactly in 1001 years and
that's what happened here same goes if
you if you add a user to a system and
you have a custom user management and
that user has a property is admin which
of course is stupid for various reasons
but let's just assume it because we all
know it happens well if you send is
admin alongside the creation HT post
request you have a new admin user if you
are using the the wizards in current
versions of Visual Studio to set up you
know corrupt views and controllers using
entity framework then what these
controllers do is they they set up those
methods for adding a new element in your
model class but they also suggest that
you use the exclude or include
attributes in order to specifically say
okay these are the properties I would
like to bind or these are the properties
I would not like to bind via model
binding those properties and those those
comments are in there for a reason
so if you have a model where not
everything should be set by the user
take care of that when the user is
adding one item in your repository that
not all the properties may be bound very
very important so that's why I put it in
here there is no actual entry for that
in India over September fear number four
is kind of the one that that fits best
all right I'm a developer so when
something goes wrong whose fault is it
no not my fault no no no I'm flawless
management your management is super
management it's always management's
fault I know in my company I do a little
of management so management is perfect
as well who is it yes of course it's the
admin the admin yeh exactly exactly I'm
not an admin so number five security
miss configuration no that's not my
thing but wait a minute don't be all the
kind of DevOps e stuff nowadays ok so I
am the admin Dennis yeah so of course
the server the operating system they
need to be hardened we have to make sure
that error messages are not shown to the
user
stuff like that so all of this is kind
of put in into number five which kinase
obvious and if you're lucky then there
is an admin that take care of that for
us if not you have to keep that keep
that in mind so rather show point number
six is called sensitive data exposure
it's basically means use encryption
using corruption everywhere
and well use HTTP let's talk about
encryption so for instance passwords
must be encrypted right and we'll see an
example for that in a bit what I also
find interesting is use HTTP why well
for instance think about session
hijacking if you use HTTP throughout
then at no point in time the session ID
is sent unencrypted so even near
conference Wi-Fi we cannot express
especially from someone else but what
happens if let's say our website entity
auto welcome let's just assume that it's
using HTTPS but what happens if I enter
NBC Oslo comm in the address bar of my
browser and hit enter well then the
browser sends an HTTP request and then
the server may be that some URL
rewriting or redirection and then goes
to HTTPS but that first request is
unencrypted so if I happen to have a
session ID that's also sent via
unencrypted communication channels and
there ways to avoid this but still then
well we have one unencrypted connection
but they are good news there's something
called strict HTTP transfer security and
that's also mechanism supported by
current browsers that forces the browser
to remember to only use HTTPS to access
a certain site even if the user was
entering an HTTP URL and the amazing
thing there is that modern browsers come
with a preload list okay take skubick
from a while to actually display that
okay increase the font size it's a very
long list it's about two nav megabytes
of je
which is then formatted here and that's
the that's the list of for Chrome and if
you scroll down there a little once the
browser reacts again we'll see that the
list contains a lot of domains of course
domains from Google but also domains
from private people from from
organizations from almost anyone yeah
once it's loading loading oh well
actually oh okay so I'm in the middle
somewhere so London dot dating I have no
affiliation with that with that site but
yeah if you go to lambda dot dating and
your significant others in the same open
Wi-Fi then they will do okay maybe maybe
not
yeah but so it's it's a pretty pretty
fascinating idea and why are there these
kind of private or let's say non Google
domains in that list
well that's because none of because of
that because of that you can add your
domain to that list so there's a
mechanism your domain has to send out
certain headers but basically you can
add yourself to the list which i think
is is pretty pretty useful if you use
https throughout there might be reasons
to avoid using HTTPS throughout so for
instance if you have all the clients
connecting to your application or if you
afraid of performance issues but
basically nowadays we should use HTTPS
throughout and with HTTP to from a
performance point of view HTTP is not
significantly slower all right number
seven and number seven pounds of it we
have insufficient attack protection okay
well you know if if I have an
application and I have a security
incident yes I did have insufficient
attack protection what sort of this
point all about now according to the
over geared years if someone is
attacking us we should find out so if
there are automated text if you get a
lot of requests from maybe in the same
IP address of the same type we should
have software in place
mechanisms in place that signs it out
and if you're really good you should
also have software in place that finds
out if someone does the manual attack
but well I would say at least the second
part is kind of wishful thinking but of
course replication firewalls and network
analysis tools state can help us a
little bit and also then decrease the
attack surface
another thing is quickly install patches
right yeah I know I know
why why change her running system I
recently went over to a dentist and the
dentist had Windows XP with a list of
patches that have not been installed yet
so I okay I know what I will do I go to
another dentist so I went to another
dentist and the other dentists didn't
have a computer at all so I felt very
comfortable actually
but seriously quick install patches
important you all heard I guess about
wanna cry which kinda hit worldwide and
what water cry was doing they were
abusing a security Valatie in Windows
that was I think closed in March the
attack was in May so well two months
passed without any patches being
installed so I come from Germany and we
have one big trained provider some small
ones but one big big crime price like
like the NSB here and that this were
there this place actually so you know
this place on all the stations
nationwide right and I was really angry
because I couldn't even see where the
trains were going because of the
ransomware thing being displaced
nationwide okay so a centralized IT is a
great thing because then attacks are
also system-wide all right so yes
quickly install patches or tell the
admin to do super important all right
the next thing is across that request
forgery and cross request fortress is an
interesting Beast because cross request
forgery is only on number eight and it's
so so dangerous so I think most of you
are aware of cross a vest forgery but
just to quickly reiterate what's
happening there I kind of prom
one of victims so let's say end the
attack and you're the victims I want you
to go to my website maybe because hey
the the slides will be will be really
bad be up there on the website I guess
there will be only on the free website
if not you know go to Twitter or send me
an email and I'd be more than happy to
provide you with the slide and but
anyway so I prompted to go to my website
right and on my website of what you're
getting is some JavaScript code and the
JavaScript code prompts your browser to
send an HTTP request to another site now
the other side might be your your your
router at home and the HTTP request
you're sending to the router is changed
wpa2 key because changing wa2 key in a
router usually just means is that a post
request with the new key you do not need
the old key right how do I know which
router you have well I just do the math
and just check ok what's just what's the
most common router in Norway sold in
Norway and since you're all my victims
and number of you will have that router
next thing how do I know what the
address of your router is well I just
you know go to the store buy the router
and then see what's the default IP
address then the only thing missing is I
need to kind of social engineer you into
logging into that router right before
going to my website and being in the
same browser but well you know since I'm
attacking all of you maybe one or two
will you know be so a cooperative and
allow me to change your wpa2 key now the
only thing you need to find out is where
you live because then I have free Wi-Fi
because I'm the only one who knows the
new wpa2 key but that's a problem I
might be solving as well so that's
basically cross-site request forgery in
short and the US says well cross request
forgery is so far back in the list
because frameworks have protection
against cross-site request forgery
ok why do I find cross request forgery
so often maybe wrong framework no you
have to activate the feature and still
you have to do it I mean
a few net MVC is rather simple you have
an HTML helper that sends out a hidden
form field with a token sometimes it's
also called nonce I know in the UK that
word is kind of offensive but it stands
for number used once but let's just say
token and then you have an attribute in
the controller that checks whether the
token is there so everyone here if the
router implemented that everyone there
in your router's you would have a
different token so I cannot Forge that
HTTP request to change the wpa2 key
because I do not know your token I
bought the same router
I got a specific token but you get the
different code so that protects against
Russell request forgery so protection is
easy but you have to do it still I don't
understand why this is a number eight
and let's say a fuel-injection is at
number one so yeah that's I take some
some I have some issues with that here
there are other aspect here so for
instance clickjacking which is an
advanced attack where I do it lure you
to my website and then do some crazy
redirection but I hide the whatever shut
down your router page in an iframe on my
page and when you click on my page on
the link you think that gives you the
download of the slide here you actually
do click on the shut down the router
button of your router which is loaded in
Nightrain so really really crazy
creative version of cross-site request
forgery and against that you can only
defend if you prevent your pages being
loaded and in the frame or iframe but
basically number eight should be it
should be it should be much higher on
that on that list all right number nine
we're almost done using components with
known vulnerabilities yeah that's the
risk but do you remember the image from
before I mean seriously that's kind of
the same thing so yeah
do check whether the framework you're
using a security I mean you may see that
NBC had a security issue that was fixed
by a patch so follow that and I mean now
safety net core and the the rapid set of
updates I know it can be
Payne but on the other hand issues gets
get fixed quickly and well finally
number or almost finally number 10 under
protected 80 ice
I mean English is not my first language
or not my second language even but under
protected I've never heard this but what
what this is kind of saying is that
nowadays we have a lot of AP is that
actually provides the functionality for
applications especially when we do
single page applications these eight
guys need to be protected as well so if
those API is write to a database then
yeah CQ injection might still be a thing
well I told you don't if these API is
returned something may be data that is
sent to the API might be cross-site
scripting so if we just know the API in
a browser we can err we can execute
JavaScript code so all these protections
we discussed and talked about they also
need to be used and in place for the API
is our applications have and that's
basically the top 10 list and still
since we still have a few minutes left
I'd like to show you one more thing
one attack that doesn't really fit here
but shows that even after after 20 years
of JavaScript and after 25 years or even
longer of HTML they are still kind of
new attacks that that are possible so I
brought one of those attacks for you and
what what's happening is this I have a
page here
it's called page one yeah I know very
creative just imagine that would be
let's say Instagram because I think
Instagram was the first victim of that
attack so when you will set up an
account for Instagram on your profile
page you can also put a link to your
homepage right to a page you control so
I would like to click on that link now
that link to the home page the title
page to and if you look at the lower
left corner maybe you can see that go
its own to know opener to HTML so it's
opening up another HTML page and
actually its opening up that HTML page
in a new browser tab
cause if you have a look at the source
code using target equals blank okay so
nothing fishy going on here
I am on page 1 and I click here on the
link to page 2 now here my setup it's
the same server but it also could be an
external server so in opening up page 2
so I'm here on page 2 I read all the
fascinating information on page 2 and
once I'm done I hit ctrl W to close the
browser tab that's what I'm always doing
right so I'm opening a new tab do some
reading and then I go back what happens
if I go back and I won't close actually
that that page I will just go back to
that tab here ok what do you expect to
see well you certainly do not expect to
see bogus page one here but why is your
bogus page one now let's have a look at
the source code of the other page and
what the other page does is it is
accessing a JavaScript API called window
opener that's around since 1995 which
gives us back then you know we still had
pop-ups and with that it allowed the
pop-up to access the opening window now
thanks for the same origin policy we
have very limited access to the opening
window especially if the target page is
on a different domain but what we can
access is the window object and thanks
to the window object of course the
location so we can redirect the original
tab and what that of course fishing so
you go to Instagram you set up a profile
you link to your home page and on your
home page you access the opener and then
you redirect from Instagram to a page
that looks exactly like Instagram
adjustments to double-check your
password for Instagram for security
reasons right typical fishing now why am
I telling you this
because Instagram fix that but well you
have to fix that as well and actually
fixing that is it's pretty easy once
once you know why so whenever you have
an external link to a page you do not
control
you have to add rel equals no opener and
that prevents that the target page has
access to the opener unless you are
using Firefox prior to version 52 we now
have I think 53 but up to Firefox 51 no
opener wasn't implemented so for Firefox
you had to add no referrer and then you
are fixing that for Firefox as well this
kind of attack is hard to put in the
wrist list of the OVA sub 10 because I
mean what's the risk here that there is
a weird browser feature that allows
users to redirect a page if that page
opens your page in a new tab I don't
maybe insert an insufficient attack
protection of something and you can put
it one of these very general terms but
yeah you see there are always new
attacks so thinking about web
application security frequently reading
up on web application security staying
up to date with a population's a web
application security is so paramount
these days and therefore in my opinion
the OS top 10 list is still relevant
today because it shows us all the chrome
risks but of course it's not complete in
a way that all risks and all attacks are
covered by that and with that I hope you
stay safe your website stay safe and I
thank you for attending thank you very
much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>