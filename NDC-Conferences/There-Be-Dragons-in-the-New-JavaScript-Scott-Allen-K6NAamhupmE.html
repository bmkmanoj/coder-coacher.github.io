<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>There Be Dragons in the New JavaScript - Scott Allen | Coder Coacher - Coaching Coders</title><meta content="There Be Dragons in the New JavaScript - Scott Allen - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>There Be Dragons in the New JavaScript - Scott Allen</b></h2><h5 class="post__date">2017-05-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/K6NAamhupmE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody how are we doing today
good
fine thumbs up okay seems reasonable
you're not an angry crowd then no good
not yet so I started working with some
of the features that were being defined
for what was at that time es6 but what
we came to know is echo script 2015
these new features of JavaScript I
started working with them actually in
early 2014 around January of 2014
because I was very excited about these
changes to the JavaScript language and
the beautiful thing was if you were
using a transpiler tool like back at
that time there was tracer and there was
I forget what Babel was called before
Babel right at the moment but when you
compiled your code from equity of 2015
this new syntax into regular es5 code
you could run it in any browser so I saw
a lot of advantages of trying to get
ahead of the curve and trying to use
these new features of JavaScript because
some of them are quite wonderful but
then I realized over the course of the
next couple years that there are
consistently areas that where people run
into problems with these new features so
in the old days cartographers used to
come up with maps that would try to
describe the world and they would
occasionally place these mythical sea
creatures and beasts that look angry
like they're going to eat someone they
would place those in the areas of the
map that were either unexplored or known
to be dangerous because there are rocks
in the water and so forth so my goal is
to give you a map of some of these XS
crip 2015 features and talk about where
you need to be careful and just some
things to be aware of tips and tricks
and things not to do which it's actually
amazing with these new features how many
areas that look so simple that create
problems and projects or behaviors that
you don't understand for example will
first talk about arrow functions which I
thought were very simple and it turns
out I've seen more people run into
unexpected behavior with arrow functions
than anything else so for those of you
that aren't familiar with some of the XS
crip 2015 features I'll just do a brief
review of each one that I talked about
so arrow syntax and exit script 2015 is
very similar to the lambda syntax and
Seashore
for.net developers I can create a
function definition where a parameter X
that was nothing expected behavior one
second have to remember how to use my
keyboard there we go
and now if I hit this key that's not
what I wanted let me try well let me
just try to use the mouse the I'm trying
to use a little red marker but something
Haydon well this function this is a
function definition square I'm still I'm
assigning a function definition to the
variable squared so function where and
takes one parameter X and that goes to
the expression x times X so just like in
c-sharp
you don't need curly braces you don't
need a return statement and of course
it's JavaScript so you don't need types
but I now have a function that I can
invoke and pass in the number three and
it will return to be nine and here's a
function definition that takes two
parameters so just like in c-sharp if
you have more than one parameter or if
you have zero parameters the parentheses
are required around the function
signature so two parameters x and y they
go to the expression X plus y I can pass
in two numbers and get a result so it
looks simple it seems simple there's a
couple things to be aware of with the
syntax though it's wonderful in
JavaScript because JavaScript is
basically a functional programming
language we have to write a lot of
functions functions are basically our
one unit of abstraction that we can use
in JavaScript and there's a lot of
higher-order functions in JavaScript so
if you look at the array one of the
built-in API is now is a mapping
function that I can pass in another
function that will be used to evaluate
and produce a new array will be used
against each element in the array so
this is doubling one two and three to
turn it into an array of two four and
six and it's nice that I can just write
a lambda expression there instead of
typing out the function keyword and so
forth but what sort of things can go
wrong so let's start with a simple one
what if I want to take that mapping
function and return an object literal so
for these values one two and three
what I'm trying to do is produce an
array that says value one value to value
three
but this doesn't work so the curly
braces are not required in an arrow
function just like a c-sharp if you just
have an expression
when evaluated and returned you don't
have to use the Curly's but as soon as
you do use the curly is the JavaScript
interpreter this doesn't see this as an
object literal it sees there's now a
block of code that has to be executed
and has to have an explicit return
statement in order to produce something
from that function so what I'm really
doing is I'm saying for each value in
the array pass it in as n and execute
this code value N and just throw it away
and you might say well what you know
what is value : n how does that even
work in JavaScript well it turns out
javascript has labels what the
JavaScript interpreter or runtime sees
is you have a label called value and it
points to this thing that just uses an
so anyway end result there's I get back
undefined undefined undefined to do that
properly one way to do it would be to
add an explicit return statement and say
return value : n or I can just wrap my
expression in parentheses and that will
produce the expected result value 1
value to value 3 very good what else can
go wrong well it turns out one of the
problems they tried to solve an echo
script 2015 is the slippery this pointer
in JavaScript if you've been doing
JavaScript for any length of time then
you probably know that the this
reference can change on you when you
have a callback function that gets
invoked from a different context so
quite often when we use something like
set timeout in JavaScript and we expect
that the callback function when the
timer expires to have a dist reference
that so points to our same object quite
often it will well it will point to the
window object in the callback because
set timeout is invoking that function
from a different context than where he
originally called set timeout that would
be a problem for example in this bit of
code where I say numbers dot for each
call this function for each N and try to
get to this top some what I'll get as a
result of this expression is cannot read
property some because V this reference
is not pointing to my adder anymore so I
cluster 2015 they try to help with this
behavior by saying when you write this
as an error function what an error
function will do is lexically capture
the value of this for you so you don't
have to write VAR self equals the
serve our me equals this or any of those
patterns that you've probably seen in
the past where people capture the dis
reference and form a closure around it
so that it saves somewhere in a
different variable instead what the
JavaScript one time will do for this
error function arrow functions will
always have a this reference that is
lexically the same as the outer scope so
if I'm inside of a method called add and
I invoked as do the adder so that would
passion that adder object is of this
reference I'm guaranteed that this
reference here will be the same as this
reference just above that line of code
right which is nice still makes me
nervous when I see this inside of a
callback function but it works always
works but because of that there's a
couple things to be aware of with error
functions arrow functions are not a
replacement for a regular function
there's a couple rules about arrow
functions they behave differently than
regular functions because of this so one
of the implications of that is that
first of all you can have too many arrow
functions so the difference between the
code that we see are sorry this is the
code that works this is a function
definition inside of an object literal I
don't need the function keyword there
but that's not in here a function the
arrow functions still inside of here
this will still reference my adder
object and this will still be the same
as it is outside of that but if I write
it this way where I place add as a
method on my adder using an error
function definition well again that
error function captures the dis
reference that is in scope lexically
outside of this definition which would
be the line right above adder which
might be your if you're inside of a
module the dis reference will be null or
undefined if you are in an es 5 file the
this reference will go back to being the
window so that's a little bit of a
problem you have to be careful about
what context what lexical context you're
actually picking up and then the other
big one is this code so what I'm trying
to do is define a method or define an
object called adder it has no behavior
on it net yes there's no methods on it
but I went to dynamically place some
behavior into this so what I'm going to
do is define a function called ad using
an arrow function and then I'm going to
talk tell JavaScript that I want to bind
adder to ad so the bind method if you've
never used it it's quite useful it's a
way of saying when someone invokes this
ad I'm going to bind it to adder so that
this reference can always be set up to
point to this object but bynes does not
work on arrow functions that's the
important thing to understand when the
JavaScript runtime encounters this arrow
function it permanently bakes the value
of this into the arrow function so the
value of this right here inside this
error function will always always always
always be whatever this was right here
into that space which could be null
could be window could be anything
and there's there's just no possible way
to change that value you cannot use bind
to change that value
you couldn't invoke the function and
arrow function was apply for example and
change the value of this like you could
with other functions and that has a
number of serious implications I see
this a lot in reactive where we asked
for a Myers will commonly use function
dot bind to try to take a method that
will handle a click event and bind it to
a component and then they'll try to
define that method or function using an
arrow function it just it just does not
work it also just introduces sometimes
subtle bugs so if you've ever used the
Jasmine unit testing suite for
JavaScript you might know that the way I
can set up a test context that I wear I
can share stuff between like setup code
and the test inside of the unit test
here it's just to attach things to the
dis reference so outside of here I could
say something like this dot test sweet
name equals foo and then I would expect
inside of here to say this dot test
suite whatever is and get that value but
it doesn't work with error functions
when Jasmine invokes this callback
function to execute my test it tries to
set the values of this reference to the
current test context but it fails
because you can't do that with error
function so here's another example I'm
going to be fancy and try using jQuery
to say when the button is clicked
then I went to change the name of the
button to click so if I would do that as
a regular function definition this would
work because when jQuery invokes your
event handling callback
it sets up these with reference to point
to the thing where the event originated
like the button unfortunately with an
error function the value of this will be
whatever is out here right electrically
in scope and jQuery cannot change that
therefore I'm probably setting the name
of the window object instead of the name
of the button making any sense all right
I'll keep doing that I had a ginger shot
right before this session which might
have not been the best idea because I
feel a little jumpy lately so arrow
functions are entirely different they
essentially be changed at this reference
and they're not normal functions for one
thing they have no implicit arguments
variable you know typically in
JavaScript and you invoke a function you
can look at arguments and it looks like
an array of everything that was passed
in but no not with error functions this
argument will be if you're inside of
another function would be the arguments
from the outer function so there's no
implicit argument evaluating that code
would say result that length of zero so
that's error function let's talk about
template literals another extremely
useful feature in echo script 2015 what
a template allows me to do is to say
basically string interpolation so it's
like the dollar sign double quotes and
c-sharp six they were introduced I want
to have a string where I produce a
string like 3 plus 5 equals 8 so I can
poke variables into my string I can
evaluate expressions into a string and
of course those are back ticks not
single quotes not double quotes you have
to use them have a back kick to have a
template but when people see the word
template they think oh I can define a
template and then reuse it in different
areas of my application unfortunately
that's not how they work in JavaScript
in fact in one of the earlier
specifications for Excel Script 2015
they call these quasi templates like
pseudo real templates
because the way they behave is when the
JavaScript interpreter hits this
template x and y have to be in scope
they have to be define they have to be
available so it's not like I can find
this template and pass it to someone
else who has an x and a y I know the x
and a y everything is evaluated right
there in place but you can make them
reusable for example if I have something
called templates that is an arrow
functions now it's a function definition
takes two parameters X and y1 out anyone
can reuse that template I can say
template 2 + 2 10 + 6 + 2 and I'll get
back the expected output like two plus
two equals four so that's good the other
thing you can do if you're familiar with
the destructuring syntax in equi script
2015 I could even pass in objects here
so I'm defining a template that takes an
object that has to have X&amp;amp;Y properties
the curly braces here I mean I'm be
structuring or ripping out properties
out of that object I'm ripping out four
x value ripping out the Y value putting
them into individual variable
declarations and now someone can invoke
my template and pass in a model object
so here's my model object for a point
and has a 2 and a 2 so I'll get out two
plus two equals four
crazy syntax JavaScript has always had
some crazy syntax so that destructuring
syntax is actually very interesting but
I've seen a couple places where it
becomes dangerous so there's object
destructuring and there's array b
structuring and there's some additional
restructuring that's coming in the
future but square brackets on the
right-hand side of an assignment that is
constructing an object right so we're
creating an object literal here with two
values 22 and 44 square brackets on the
left hand side of an assignment entity
structuring so this line of code is
creating two new variables that are cost
x and y and the way javascript will work
is to say oh you have this array I'm
going to pull out the first value and
put it into X I'll pull out the second
value put it into 44 thus this unit has
to pass X would be twenty two thousand
forty four very good and you can also
have object destructuring so curly
braces on the right hand of an
assignment that's constructing an object
curly braces on the left hand side
that's d structuring and
object so I'm creating a new variable
called States the default value will be
New York in other words if the object
under structuring from doesn't have a
state property this will get the value
New York and country would be USA and
this case state would be Maryland
country of the USA
there was no country in the address that
all seems fine and simple when you once
you understand these structuring and you
look at simple expressions like that
unfortunately you can do crazy things so
here's a more complicated object
employee has first name has an S object
address it has an array of favorite
numbers this bit of code here saying
create a new variable first name by
destructuring out the first name of that
employee okay so find that'll be Scot
create a variable state so we're not
creating a variable address we're
creating a variable States that will be
be structured by going to address state
on that object d structure a variable
called favorite numbers that will go
into the array and pick out the second
value that's ending array 55 so that's
all these structures out of employee on
I'll have first-name equals Scot state
equals Maryland favorite numbers 55
that's a little bit weird and you can do
things like this what is the value there
well we we are creating a new variable
length that will be be structured from
the string so what dot length would be
four right that looks a little bit weird
but it gets better I mean I think this
was hard to read that's just weird
but like it's that air so you're
familiar with the bang bang you're a
boolean type coercion in JavaScript
where you use two exclamation points
this is a way of saying I need to know
the truth D I need to know of values
should be considered as true or false so
I'm not what I'm going to do is apply
the negation operator which in this case
would return false and then I'll apply
the negation operator again to turn that
false into a true but what I get into
the result is a true boolean so bang
bang you're a boolean I want to know if
they're true or false that's weird but
we can combine that with other syntax
like destructuring to do better things
Oh actually so that's not destructuring
this is the spread syntax so dot dot dot
is a new feature of echo script 2015
where I can take an array and I can
spread it into another array or actually
it can also use it when I invoke a
function to spread parameters across the
individual parameters of a function but
the result of this expression is an
array one two three four five six so it
spreads those values out into the array
so let's combine bang bang you're a
boolean with spreading and a new feature
that's in coming up in extra I think
it's in the 2017 specification which is
an object spread which is actually
extremely useful what I want to do is I
want to build a result from an object
literal expression I want result to have
a name which will be a string whatever
and I want to take this data object and
spread it into that object as if it's a
so it's a part of the object I don't
want to say a result dot data I want to
say result dot X and that's exactly what
that dot syntax will do take the
properties out of data plug them out put
them into the feller object extremely
useful right there's a lot of places
like in react where you're always
copying little pieces of state around so
that'll be very useful so what is this -
so this is this is where we this is in
the reducti barrier and you look at this
expression bang-bang data and it takes a
second but the important part to
understand here is that the operator
precedence the JavaScript will apply
will first do bangbang data to get a
boolean value so basically I want to no
data there or not there I want to know
if it's true or false so if it's true
now we have this ternary expression that
will be evaluated next so let's say data
is true in that case I will take data if
data is false I will take this object
literal default true and then the last
operator to be applied because it's the
lowest precedence is this object spread
operator so basically I'm building a
result that if I have data will contain
the data but if it does not have data it
will have just name and default true
right so it's a neat little syntax but
the first time you encounter it you have
to go do some research with it
let's talk about Trump
I've already been using it because a lot
of people say never use var anymore
never use let always use Const unless
you really do have to reassign to a
variable declaration so what does cons
do well if I create a Const X equals two
and then I try to assign to X I should
have a type err at runtime assignment
constant variable I shouldn't be allowed
to change the value that is inside that
variable but it doesn't mean that I
cannot change something that I variable
references or points to so if I have an
array that is Const I cannot change the
reference in that variable but I can
certainly still change the array so I
could push and pop and slice and do
whatever I want to it if I really wanted
to make that array immutable there's an
object freeze API where I could say
let's freeze the array and then trying
to push into it that would you're tight
there let's talk about collections for a
second there's new collections and new
collection ap is an equi script 2015 one
best practice that has suggested now
there's never tried to create so so I
want to create an array typically I just
use an object literal but let's say I'm
in a more dynamic piece of code that is
trying to be very dynamic I'm not
exactly sure what parameters are people
are going to pass to me but I just know
that what they give me I have to turn
into an array so one way to do that is
to invoke the array method passing
values it will produce an array that's
good unfortunately if you invoke array
with just a single parameter though
array assumes that oh you want an array
of this size and I'll just fill in
undefined
you know so this one produces an array
this one produces
an array of ten things that are
undefined so there's this incongruity in
the behavior of array so suggestion as
of equal script 2015 is to always use of
if you expect to take a value and
produce an array out of it just use a
rate of passing however many parameters
they will always be an array and there's
also a rate up from which instrument
interestingly enough will work with
anything that has a length property so I
can I can say a rate up from
I'm going to pass in an object that has
a length property set to five and this
is a little callback function that'll
always just take a value and the key is
it's used and we're just going to write
out the key value so I get 1 2 0 1 2 3 4
from that expression that's the key
values as it iterates to do that there's
also a set or set map and I can script
2015 they're quite useful in a number of
scenarios but they are shallow in other
words if I create a new set and add the
same try to add the same value twice the
step size will just be one because it
will not accept the second 9 and 1 throw
an error just you know won't add
anything to the set ix already in the
set but if I try to pass in two arrays
that contain the values 9 you might hope
that it's smart enough to realize they
contain the same values but it doesn't
do that all it sees as two different
object references two different
references coming in so the size will be
2 there and but of course if I do try to
add the same reference twice so array is
pointing to this that was created from
an array literal that would be a set
size of 1 another common question is we
have these new collections map and set
they're quite useful in a number of
scenarios and we can create arrays using
object literal syntax we can create
objects using object literal syntax is
there and is there a literal notation
for map and set no the way you would
create a new map or a new set is to
invoke the constructor and with map the
Constructors a little bit weird but you
basically pass in an array an array of
arrays and so the first element here
would be mapping one to the string
representation of one and two to the
string requisition or two would be the
second element in that map classes so
the big thing right we when I explain
xmas Cup 2015 classes and same thing
goes for typescript ooh I
I always explain them you know these are
really just syntactic sugar for what
some people used to do in JavaScript
which is to kind of here on the right
when the JavaScript runtime or when a
transpiler once across this
this employee class you could implement
the same thing just by first defining a
constructor function that takes a name
and a signed name internally as a field
to that object and then set up the
prototype object on that constructor
function to have the methods or the
shared behavior that you want and it's
true the code over here and the code
over here would function pretty much
identically I can say new employee pass
and Scott and then invoke do work on
that employee they both do the same
thing but there are some subtle
differences that it's always those
little things that people run into on
certain projects so for example hoisting
if I do if I though in JavaScript you
might be familiar with this term
hoisting it is hoisting happens on bar
declarations and function declarations
it's basically a JavaScript runtime
looking through my file and saying oh I
see you have a function declaration down
here I'm going to hoist that up so
essentially that symbol like employee is
at the top of the file and that means I
can write code like this I'm going to
create a new employee so I'm going to
say quantity equals new employee and
this code of work even though the
functions defined later in the file you
know maybe it's a utility function or
it's a class but I don't really want to
think about it I'm going to push it down
beneath the code that does some real
work and that's fine but does not happen
with classes if I try to instantiate a
new employee an employee with a class
definition that'll be a runtime
reference there so your class
definitions have to come and appear
lexically before you try to use them and
the interesting thing is that class is
actually hoisted this is just a weird
thing in the JavaScript specifications
they actually say sorry let me go back a
second they actually say plot this
employee symbol it is actually hoisted
so that the definition is actually
available up here but for class
definitions let variables and
Constable's the echo script
specification describes this thing
called the temporal dead zone anyone
ever hear that term I love that term
temporal deadzone sounds scary
the temporal dead zone is what they
define as the area where above the place
where something was defined so if I say
let X equal to here in the middle of the
function yes X is hoisted to the top but
it is inside of its temporal dead zone
and if I try to do anything with that
symbol X I should get a reference here
so if I try to assign to it if I try to
read it even if I try to use type of on
that variable it'll throw a reference
area and your error is in the T DZ and
that goes for Const and that goes for
classes also here's another difference
if I define so this is a constructor
function human equals function and then
modifying the prototype human dot
prototype that do work as a function so
that's the old way of defining a class
or a type in JavaScript I can use a 4 in
loop to go through a new instance of
that human object and look at all the
things that are available but I can
index into and I will get out the value
do work if you do the same thing with a
class which is to define a class have a
do work method try to iterate through a
for n that will produce an empty array I
cannot get to be the method definitions
that are on an object using a 4 in at
least if you do want to write code like
that you can write code something like
this so I want Stan she ate a new horse
and invoke object ducted prototype of
and then I will use a for loop we can
talk about that too today but for ours
pretty simple to understand it iterates
the values inside of something instead
of the keys that are in something I
literally threw object actor gets owned
property names for the prototype object
of that and that will actually giving
back the methods that are available and
that will actually include the
constructor too so even if I don't have
a constructor to find it's kind of like
c-sharp where if you have no constructor
to find you could put the false
constructor same thing in JavaScript
I'll have a constructor and have a
method called D word
new is required so we used to do this
thing in the old days of JavaScript
where we'd write a constructor function
and then we would write defensive code
to make sure that someone invoked that
constructor function using the new
keyword that was something you could
check by using like the instance of
operator to make sure the instance of
this was the same as your constructor
function we don't have to do that
anymore we used to do that by the way
because of someone invoked a constructor
function without using the new keyword
the this reference would be set up to be
like the window object little variable
and so everything that happened inside
the constructor would be creating new
variable global variables which is bad
don't have to worry about that with
classes if someone tries to invoke
basically the constructor function for
this class definition there will be a
type error you have to use new but just
being JavaScript you can actually
implement a constructor function that
does not return a horse you can return
anything you want in JavaScript right so
I can have a constructor function and
return some object with the name of
jiffy that's legal yes shake your head
let's talk about modules so when I first
started reading about modules in equi
script 2015 I was so excited I thought
finally this language will have
something that has been needed since the
beginning of time of a feature that
every serious programming language has
to have I mean without modules
you just can't scale up in complexity
and then after a couple years of working
with them I'm reminded of this quote
from an Oscar Wilde play when the gods
wish to punish us they answer our
prayers so yes I have modules now but
there's times when I find them a little
bit frustrating so just to review
modules in the old days of JavaScript we
try very hard to constrain the scope of
the things that we're creating the
variables were creating the function
definitions and you know if you just
open up a j/s file that gets loaded into
the browser and you just start writing a
function definition it's very easy to
create a global variable on the window
object so
after a while people started following
this pattern of using and if he
immediately evaluated immediately
invoked function expression because
everything in JavaScript can be scoped
to a function and now anything that I do
inside of here any code that I place
will be local to that function but I can
choose what I want to expose by
returning an object or explicitly
attaching something to the window object
and then when ES 5.1 was introduced
whoops sorry
we got her EF 5 was introduced we also
started adding new strict on this to
place the JavaScript interpreter into
strict mode which would allow it to
perform a little bit better and also
help us avoid some common mistakes
however with excess scrip 2015 modules
all of the fields away when I write a
dot j/s file that is going to be trans
piled by something like web pack or well
not live hat by babel or the typescript
compiler even and i'm using things like
import and export in that file it's
assumed that I am writing a model so I
don't think about it I don't think about
it as a file anymore
and anything I do in that module is
going to be implicitly scoped to that
module it's not going to be available
outside of it at all I have to
explicitly export something like this to
make it available from outside of the
file so if I don't export work it
doesn't have to be in a nippy or
anything else it's private to this model
the file that I'm working here also you
strict there's no longer required that
crafter 2015 when you're writing code in
a module just assume to be in strict
mode so you never have to use that
strange object object literal again
anyway the export syntax an echo strip
2015 I can export multiple objects I can
put my exports down here I could have
also written export use the keyword
right in front of the class definition
to say export class person I can have
aliases so I could do something like
export work as sue
comma person so I could change the name
of this when I exposed it publicly
there's also the concept of a default
export which is a little bit confusing
because the way you import a default
export uses a different syntax than the
way you would import these
two pieces that were exported as not as
default but as symbols we will talk
about that and there's also this syntax
which is quite useful and this has been
been around for a while and angular
cheese this is quite a bit I think they
call it a overall lobs but basically
when I'm drew when I'm building a
JavaScript application now using modules
I might have a older in my file system
that contains a bunch of stuff that has
to work together to do something so
let's say it wraps an API on my server
and I have things in there to make HTTP
calls and I have things in there to do
special C realisations and AD off tokens
and all that stuff so there's a lot of
implementation details in there
someone's who is consuming that stuff
who's importing some things from there I
don't necessarily want them to know
about specific files that are in that
folder or specific capabilities either
so let's say all this is is any folder
called services what I want them to be
able to do is say import something from
services and just reference that folder
which is easy to do with most tools if
you just provide an index dot JSP
that exports just the things that you
want from inside of that collection of
things hopefully I'm making sense with
those the index dot JSP file could look
something like this I just wanted to
export everything from this other file
called creatures I can do it that way
export everything from humans or I could
selectively export things and by the way
in excess of 2015 you don't specify a
file extension here but implicitly this
would be creatures jas that's what we
would be looking for there and less
creatures is also a folder it has an
index file inside of it then I could get
the exports from everything that is
exported from that index batch is anyway
imports so I'm going to import things so
I'm importing person and animal from Lib
so not just backing up a second pretend
I have an export like this it looks like
the structuring syntax but never ever
ever consider this to be destructuring
syntax I'll talk about this in a minute
we are not creating new variables called
person and animal we're doing something
very similar but I'll talk about the
difference here in just
and that's a big point of confusion with
modules so I want to import person and
animal presumably they were exported
from this module as person and animal
this syntax without the curly braces
that is asking for the default export
from this module so unless this module
has a line of code that says export
default something I will not get
anything here for human person and
that's important and it's not like a
throw to runtime err you just get a null
value there
I can also import things by importing
everything sort of into this namespace
so I could say import everything from
react and then this becomes a almost
like a mean space to get to the things
inside of that module I would say Lib
that foo or live that bar live that
animal to get to the interval individual
things that were exported from there so
I'm making some sense so let's talk
about sorry back up one second let's
talk about what these are it's not
destructuring it's not like this thing
exposes a model of a module object and
I'm do structuring things out of the
exports now what I'm creating is what's
known as an immutable binding so yes it
is like a variable but behind the scenes
for people that have done things like
C++ it's almost like a pointer to a
pointer so let me explain what I mean by
that let's say I write a module where I
export a simple variable counter you can
export all sorts of different things in
JavaScript export variables export
functions export object literals export
class definitions so this is just
exporting a simple variable counter
equals 0 it's not com it can be
reassigned to so that means I can also
export a function increment where
someone invokes that I can say counter
plus equals 1 and return the new value
seems good now over here in some other
code let's try to import counter from
Lib creatures so yes it's like I have a
variable named counter but it's
immutable so it's almost like it was
defined with Const if I try to modify
that it's not like local to my module
I'll get a syntax here trying to change
the value that is in that module
variable in that binding sorry
but I can import both counter and
increment from creatures and this is
just proving that these bindings are
live so you might sing back on backing
up a second if I get a simple primitive
value like a number into a variable I
probably got a copy of it from that
module right that's what I would that's
what I thought at first I import this
simple valuable value from another
module well if it started off as a nine
the other thing could change to a ten I
wouldn't know but that's not how these
bindings work they're a little bit
magical that's why I say they're like a
pointer to a pointer or reference to a
reference if I import counter and
increment from this other module and I
invoke increment well this code inside
the module is allowed to change counter
inside this module let the counter is
just a simple variable so we can change
it inside of here and what I will see
from the other module is I will see that
new value of counter which to me was
amazing when I realize those so it's
almost like I can have a singleton here
defined in my module and when I make
changes to it the entire application
sees the changes in that making
something and the bindings are live so
let's take another example I'm going to
export an object literal creature this
object has a name of Oscar I'm going to
export a function X inspect just so I
can look at the creatures name and I'm
going to export a function reset which
will just give me a new object creature
dot name equals Oscar so let's do a few
things with that let's say I import
creature from this module and I say
creature name he goes winning that's
legal I'm not trying to change so if I
did import creature from this module
creature II is the binding and I'm not
modifying the binding I'm modifying
something that the binding points to so
from outside the module I can still
change the name of the creature and I
see the change and if I call into that
module it sees the change too so these
live bindings work with lay it truly is
like a singleton object that gets
exported and I can reset it and see that
change from the outside world to
what is the fault value of this inside
of a module it's not the window object
anymore it is undefined so when you're
inside one of these files writing import
and export statements and you refer to
this you'll get and will get an
undefined until you get like inside of a
class definition why do I not like
modules sometimes they feel like a lot
of bookkeeping this particular code
snippet was taken from the some unit
tests from the angular 2 source code and
I don't know if it's visible from the
back but these are import statements
that stretch for 30 lines of code before
we even get to the unit test so you open
up this file we're importing so many
things we can't even see the test that
we want to modify or look for what's
broken because of all the import in the
way instance in here the other thing to
be aware of is echo script the Standards
Committee was very purposeful when they
designed this import export syntax and
it has irritated a lot of people so when
they define this syntax
they wanted to start pushing JavaScript
a little more towards being a dependable
language that you can analyze for static
tools and when they designed the import
import syntax they provided no mechanism
to do things like I'm going to determine
what module I import at runtime by
passing in a string or evaluating an
argument so if you've ever done any
node.js programming or programming
outside the browser you might know like
the cut with command Jas the way to
import something is to require it and
require is very dynamic I can actually
have code and say I'm going to go
through the file system and search for
files and just require everything in the
sub directory there's no possible way to
do that with import and export reason
being again they wanted to make this a
toolable they wanted this syntax to be
toolable and to be able to analyze
things in a static manner so in other
words when a tool like web pack comes
along to build your code into a bundle
it can look at the top of the file and
say oh I see you're importing food from
bar importing creature from library and
I know exactly
your dependencies are and I know I have
to go out and grab these other modules
and put them together in order to be
able to run the code inside of your
module and it can do that with static
analysis and without executing any code
where something like the required syntax
how do I know what this is requiring
well I pretty much have to execute the
code at runtime in the correct
environment to know anything about
what's going on so the benefits of this
static syntax are that you can build
tools to do amazing things they can
analyze an entire dependency tree they
can tell you what you're using what
you're not using what could be thrown
away potentially because it's not
actually being imported and consumed by
anyone and that's really nice but there
are some times when we want some
flexibility and I will tell you that
they are currently working on a proposal
for an import function which would
provide dynamic capabilities so it's an
import function not like the import
keyword here had to go back to many
slides for import well doesn't import
here so instead of being a syntax where
I say import like that would be an
import function so parentheses and I
could pass in like an expression but
that's very early on right now it would
give me the ability to do some dynamic
imports and of course the biggest
stumbling block with modules and what
makes this new world so painful is that
modules don't work in the browser so
we're in this weird position where the
echo script 2015 standard has been
finished it's been filled
so this import and export syntax it's
with us it's not going to change
we're on firm footing we're on solid
ground when we use import and export but
they purposefully didn't define how
browsers should behave or forget
browsers any JavaScript runtime
environment they haven't defined how a
JavaScript runtime should use import and
export they only define the syntax so
let's put that puts us in this weird
situation where we can use the syntax
but we have to transpile it or change it
into a syntax at a runtime will actually
understand and that's why when you're
using angular 2 or you're using aralia
or any of these next-generation
frameworks that rely on things like
modules you have to use a tool like web
pack or roll-up that understand import
and export and can convert it into a
syntax for the browser will actually
work with or at a runtime that the
browser will actually work with and
that's where things kind of get crazy so
for a long time I was using a tool
system jas anyone using system junior
aralia was originally built to use
system jjf the nice thing about system
jf is that when I first found this
repository I thought this is the thing I
want to use because what system jf said
is that we're going to try to be as
close to the specification on how things
should behave as possible so there is
there's a specification out there that
says here's how imports and exports are
going to work in the browser and that's
what system j/s tries to follow and it
works and it's good unfortunately that
specification it keeps changing and
system jf will update to match the
specification so you think system j/s on
a production application can sometimes
be frustrating because you npm install
the latest version of system jas and
suddenly nothing works the other problem
with system jas is it can be unless you
pre build stuff using other tools it can
be a little bit slower than using some
of the other tools because it's actually
trying to well import things dynamically
for you behind the scenes but that one's
easy to avoid but the one interesting
problem we did when I run into a system
j/s once was it makes heavy use of
promises and the native promise
implementation in some browsers from
Microsoft
isn't that good and it was amazing
because just loading up an application
would take 300 milliseconds in Chrome
and it would take three seconds in a
certain browser from a large company
anyway that was fixed by the way in that
browser that's okay the tool I use most
often is web pack web pack in a way is a
very simple tool
its sole purpose in life is to analyze
the tendencies JavaScript CSS whatever
you have and a pack of stuff up into a
bundle into a single file or multiple
files if you want it something that can
be pushed down to the web browser it
doesn't do translation but you can add a
plug-in to it to transpile using Babel
or using types that it doesn't
understand how to minify javascript you
can add a plug-in for that it doesn't
understand how to read in an HTML file
and embed it in your JavaScript so you
even have a an extra template file to to
include over HTTP it doesn't understand
any of those things but there's plug-ins
for almost everything so at the end of
the day web pack can do just about do
everything but cook lunch through a
series of plugins
I like web pack a simple configuration
would look like this so I give a web
pack an entry point the entry point
would be the thing typically the
bootstraps my application or the thing
that is the you know the first bit of
code that I need invoked on a page and
web pack will look at that file entry
jas or entry TS what do you have and
it'll say what are the import statements
that is what does this file depend on
and it will follow them and it will find
other J's files and have imports and
will follow those so you know if entry J
s imports something from angular 2 the
end result would be webpack would
understand that you're using all of us
all these pieces in angular 2 and bring
all that code in and place it into an
output so in this case I went a single
output with a file name of bundled AF in
this directory and just all that
JavaScript code would be included and
placed into the file and everything
works perfectly there's no import or
export statements inside of it it's all
code that the browser would understand
so web pack is again just one of the
tools that can do this there's another
one called roll up roll up that I
evaluated just a few weeks ago but for
me it just wasn't the right tool the
criticism with web pack at least before
2.0 was that the code the way and
bundled things maybe the code to be a
little bit smaller as they did some more
optimizations and I haven't tried 2.0
just yet it was released last month and
I haven't wanted to try to upgrade any
things just yet my trying a couple weeks
they should have been proved on that and
the other thing you'll typically see
with our web pack is you'll configure a
series of loaders which basically say
okay
someone imported a CSS file which I'll
talk about just a second but someone
wants the CSS file to be part of the
bundle I know of a loader that can take
that CSS and format format in a way that
it could placed in my bundle in my
JavaScript file but then load it into
the browser as a CSS resource for to
understand the styles so this is all
about packing things down right I don't
want to have 15 requests for JavaScript
files and two more requests for CSS
files and 13 requests for HTML templates
that I have out there web pack to put it
all together what's the thing that
worries me about web packs sometimes
well it's not standard like we have this
beautiful world of web standards where
we define the syntax for import and
export we've defined the syntax for xml
httprequest
and fetch and all these other things but
yet we still need this tool that just
you know comes with this own way of
doing things and it allows you to write
code like this so this is an angular 2
component this angular 2 component
requires an HTML template which I could
define the template inline or I could
just define it without this require and
just say it's app component HTML but
that would mean at runtime there's an
extra network or class to go out and
fetch this template well if I'm using
webpack I can actually write a require
statement here and for those that use
common J's modules in the past with no
GS you'll know that requires like an
import it's a way of saying hey I
require this HTML file and web pack has
the right sort of plugins available
where web pack will recognize that
statement and say oh let me go out to
the file system read that HTML and just
place it into the JavaScript so that
everything is in line right I don't have
to do an extra fetch and what just so
just what worries me is when an entire
application starts depending on that
it's not standard I wish we could be I
wish I hope my grandkids I think the web
programming is better when my grandkids
are doing programming that's all hope
you figured it all out fairly doing I
don't know
and the other thing that people struggle
with is how it's on a library or
framework author and I need I want to
write one of these new libraries or
utilities it's going to be using
ActionScript 20 15 I'm going to be
putting in with import and export
statements should i pre-compile things
for you and if i do should i compile
them into common J's format or maybe
you're not gonna be using webpack I
don't Anna so do I need to compile it
into the universal module definition
which adds a lot of prefix and prefix
code every JavaScript function what
about polyfills so I'm writing utility
that's going to depend on a native
promised implementation or a promise
implementation being available in the
browser do I end up polyfill or do I
just tell tell you and the documentation
that you have to have a promise
available there's all sorts a question
so they're still being hashed out
there's no perfect way to solve these
problems in this world that we have
right now but maybe someday and that's
where I just get sort of frustrated the
tooling in this area is like living on
the ski sometimes it's very exciting and
you're in the boat and you're thinking
this is great
I'm although I'm in a wave and I'm still
living but in those days where you get
very close to that inner circle there
and you just want to walk out of the
office and give up and it's been a lot
better I will say the speeds and a lot
better over the last six months and it
was throughout 2014 and 2015 and most of
2016 things have settled down just a bit
and I think that's all I have for you so
maybe you could grab lunch a little bit
early but if you have any questions
about this I'll stick around that's my
email address if you have any questions
too you can email me I can point you to
an entire repository of github code on
github it's not well organized but it
has a lot of little examples that I use
to figure out or just document how some
of these things work and how some of
these things don't work and if you
really want to look at that just send me
an email and I'll send it off but thank
you for coming hope you enjoy</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>