<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Head to Head: Jon Skeet, Kathleen Dollard and Rob Conery | Coder Coacher - Coaching Coders</title><meta content="Head to Head: Jon Skeet, Kathleen Dollard and Rob Conery - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Head to Head: Jon Skeet, Kathleen Dollard and Rob Conery</b></h2><h5 class="post__date">2017-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TBtQqwyx-Fo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I think it's about that
I'm rule Inc okay thank you guys for
coming I appreciate you showing up at
this I guess it's not all that late is
it
I really quickly want to introduce our
speakers who need no introduction but I
also want to tell you what this is I'm
Rob Connery
this is head-to-head and the idea of
doing this is we have two lovely and
talented speakers up here who are going
to answer various questions caught up by
me and the idea was is I give them a
question they go and research the way
they would do it and then they don't
speak to each other at all and then get
together and show their solutions that's
the idea at least but what's really
going to happen is John's going to start
talking everything's going to go crazy
and then we'll go from there
so anyway this is Kathleen Dollard by
the way yay humming Marge and I'm trying
for got your name Jeff Jeff Jeff Joan
John Skeet of course this is John he
needs no introduction and I guess that's
about it we'll just get going here
oh also before really quickly before we
start if you have any questions we want
this to be interactive shout it out and
then I'll make sure to come and get the
question from you and ask our lovely and
talented speaker will be really boring
if you do not yes please so I'm going to
try and goose you guys I'm not going to
make you stand up he will but off we go
okay John check it out oh yeah so I had
heard some scurrilous rumors that there
were some software engineers that were
not straight white men but you know
looking else I'm glad to see it's
clearly not true I I see a11 and
Kathleen obviously um there are a few
out there this is our problem to fix I
repeat this at virtually every
conference I go to please make this
conference more diverse next year invite
your colleagues who aren't straight
white men say how awesome NBC is be
respectful of all people make it a very
inclusive conference run River I'm done
um sorry I just it it bugs me like crazy
uh-huh hopefully we can make things
better okay so the first question the
Rob came up with and I have a slight
advantage on very very slight in that
it's on a blog post that I wrote like
this six months ago and which was around
and Unix
and yeah I would try to demonstrate this
now but hey I've got a Windows machine
run Linux box and B I think the the
problem has now been fixed certainly I
think I submitted a patch for it so it
was really an exercise in Diagnostics I
had come up with note of time so my
date/time library come tomorrow at 9
o'clock to learn more about date
complains and and obviously this is
something that's ideal for running on
botnet core and so earlier this hero
saying right can I run the unit tests on
botnet core there are about 15,000 unit
tests in no time which is much more
impressive than it sounds because we've
got quite a few tests that just run
against all possible cultures on the
machine so you know that gets a thousand
tests per playing you actually write
tests um and I was horrified to see that
the Linux build was about ten times as
slow or six to ten times as slow as the
windows build so I normally run the non
slow tests I've got about three slow
tests but the rest run in I think about
twenty seconds or so except on Linux it
was taking forever really a very long
time
and I thought well clearly dotnet core
is awful and I shall abandon it forever
and I thought maybe that might not be
the problem so what's really interesting
to me about this whole process is not oh
I found a bug or a problem in an unit so
much as the diagnostic aspect of it and
so jumping coupling anytime you want to
mention something so just that the steps
involved it's all on my code blog but
this is something that can be applied
anytime you are going to ask a question
on Stack Overflow or anytime you run
into problems this is my way of thinking
about Diagnostics and it works pretty
well for me so hopefully you can do
something similar so I started off
anybody looked at this post anybody and
I looked at a couple articles look to
dispose
trying to get an idea of where they were
like telling you something you're like
yes totally already knowing you're not
about sufficiently few that it's still
worth procedure yeah no I think we
should definitely Krissy yeah so yeah
our step one is we think we've got a
problem and you need to make sure that
you actually do have a problem so if you
notice something going
oddly what's the first thing you do do
it again
yes try turning it off and on again and
then do it again and sure enough I ran I
think I ran it four or five times and
that was plenty to let me know this
wasn't my machine being crazy and I'll
give you one hint when it comes to
performance stuff it's really helpful if
you've got the same hardware I have two
Intel looks I five the looks they are
the sweetest little computers you've
ever seen they ship in a box that's
about the same diameter as a CD and
that's got some packing inside there's
plenty little things and I bought my
first one a few years ago and then I
specifically got on eBay the exact same
model so it had the exact same processor
not just another o5 but the exact same
process model and obviously about half
the price and so I've got windows on one
and Linux on the other obviously you
could dual boot but I've got these
permanently connected and so I knew that
I was running on reasonable performance
rigs and both of the machines were idle
apart from running these tests so we
know we've got a problem
the next thing is without disturbing
anything else how can we try to isolate
the problem so before you start changing
code how can you reduce the amount of
work that's going on and in this case
these are unit tests it's really easy
try to find a unit test that
demonstrates this problem well and
fortunately any unit can spit out some
XML that lets you say write well how
long did each test take and so I just
tried to find an example of a test there
were some tests that took radically
different amounts of time but I kind of
knew what though why they were taking
different amounts
time I knew they would be exercising
from different paths later in no time or
doing lots of work with the BCL and I
specifically wanted to find something
that wouldn't be doing much stuff in
system dot XYZ that I was aware of and
that was part of my test code if you see
what I mean so I eventually found let's
see the exact test name because it's fun
the omal kora year-month-day calculator
test get year monthly days since epoch
which just checks for some
self-consistency so I start at the start
of time and I add a day to the date
until I reach the end of time and I
compare that with zero one two three
four five six so in some ways it's kind
of boring test however it shows this
exact ten to one thing so I could now
run just that one test from the command
line you know remove all the writing
from XML so that it would really be just
running that one test and one thing I
would recommend about any unit is it's
got a really powerful way of saying I
would like to only run some tests you
put - - where equals and then you can
put a class that has a name a bit like
this magic of matching a regular
expression how many of you use X unit
okay how easy is it not from Visual
Studio to run a single test what would
you do so right is an end unit yeah I'm
a big fan of n unit for work I use X
unit but in X unit you can put - method
and then you put the fully qualified
name of the method which by the time
you've got for the whole namespace and
the class name and the method name is a
paint in any unit you can do that or you
can just put method equals tilde for
make it a red X match and then I as it
happens I do have a couple of things
that I'll get year month day day since
epoch but you know I could easily
whittle it down so I thoroughly
recommend the end unit sort of style way
if you're ever writing any tools think
about that kind of use case please umm
so I'm still in on units at this point
and I've still got no to time involved
so I've got three different bits of code
and I don't like that from a diagnostic
point of view so the first thing I tried
to remove was notice I'm sorry with n
units actually so I removed the
assertions at that point okay n Eunice
is starting my method but then the whole
method runs and then reports the result
in the end
no assertions going on and suddenly
Linux windows basically the same amount
to play okay this is very strange
so I've got an assertion in there and
the assertion is between two local dates
I think but you know it's a pretty
simple one and I realizing that the
assertion was something to do with it I
started getting rid of no design so I
ended up with a bit of code let me blow
that up a bit so here is a simple end
unit test no no time at all and that
takes ten times as long to run on the
nexus windows and it's only comparing
integers so at that point something is
very weird there's not a lot of bcl code
going on here you know we're not doing
anything with strange calendars that
maybe inefficiently implemented so it's
really a surplus or equal at that point
hey this is open source so you delve it
start delving into the code I don't
think do you have any ideas about how I
would work out the bottleneck here
without either using profiling because
profiling can be relatively hard doing
it on botnet core on the next there may
be profilers out there but I haven't
used them so it was right okay
anything else you two done at that point
honestly when I worded turn it's
embarrassing I would have done consoles
outright lines in there knowing I was
taking a small hairpin assuming that was
consistent across them it's ugly but it
probably is what I would have tried what
though yeah I'm before I'm asking I
don't know yeah and I'm switching us and
we're switching us there's somebody back
there switching can you switch the
monitors by market I just want to let
you guys know because
I'll make sure this available later what
I'm doing is I'm writing down the steps
that John's going through because on
this one honestly this is just like the
fact that any inand had a bug and got it
got fixed who's going to get excited
about that anybody John told him to fix
a bug and and unit that's awesome what's
awesome about this is the fact that he's
going through a very specific process
and I want to record that process for
you because I think it's the interesting
part of what we do happen right now I
want to show that I'm doing that we know
it's on end unit because I was typing I
was firing when you have to be that
question sorry wait I was just - so I
wasn't quite ready for that so I'm gonna
let you get back to work then we're
gonna go back to this machine but we'll
switch back and forth a couple of times
I don't know we'll be in touch
ok the voice recognition and I think the
microphones a voice recognition is near
rob if we call him something other than
Alan we still do it so um there are
various things I looked at any units of
quality and like many many test
frameworks there are loads of different
ways of doing equality so I won't bore
you with the details but checked a bunch
of different things and ended up with
looking at this was the only place I
could find a difference between a way of
checking equality that was fast and a
way of checking equality that was slow
because to be clear there's no way I'm
going to change every call to assert are
equal in no time to do something that I
know will be faster but is much less
convenient and I know people use assert
that and stuff but I'm not a fan of that
particular way of doing things for
simple equality checks so we've got this
constraint and something there is a
problem somewhere in here we know well
there's a bunch a bunch of different
calls going on but mostly yeah I can see
three calls to ends with and a couple of
sub strings and using get type butts
varies by this point I had thought that
it might be something to do with
reflection so I thought maybe it's get
type dot name and I just randomly
thought well I'll just try this
this was a lucky guess but this is at
this point you don't even need to have
any unit running at this point I can
have in fact Hut set six remove onion it
you can see the problem with our end
units at all yeah I haven't even shown
the code because it's so obvious you you
just write something that uses stopwatch
always you stopwatch rather than take
time dot UTC now or anything if you're
measuring elapsed time a it's more
accurate be it doesn't get affected by
if NTP decides to switch the system
clock you know system diagnostic
stopwatch is your friend for measuring a
maps time and you can basically run a
lot of iterations
this isn't modifying knitting this isn't
creating any new objects this is about
as pure a performance test as you can
get and lo and behold it's massively
slow on then it's compared with Windows
and so I asked the dotnet core team and
they said oh yeah okay it turns out
there's an optimization on Windows that
isn't present on Linux to do with the
current culture and so you can you can
look at the details on github but it's
one of those things where it's more
detailed than you really want to know
other than well at least someone
understands it and they can try to
improve things in the future as well so
I felt the core CLR bug but also it
tends highly work round able there's an
easy easy way of fixing it within and
unit itself so we don't really want to
do a culture aware comparison it's just
possible that there are some weird
cultures in terms of string comparisons
where it was actually a bug in and unit
in terms of behavior I can't imagine
that ends with would be effective unless
you had some very interesting attributes
but yeah as soon as you move to string
comparisons or ordinal it's actually I
think it's a little bit faster than
either the windows or the Linux version
on both of the current culture version
on both Windows and Linux
so yeah most of this by the time we've
got to this code we're really at the end
of the diagnostic process and we're
ready to start acting on stuff but I
guess my plea is if you're going to ask
about some strange behavior on Stack
Overflow go through these steps so
you've got something as short as this
ideally an online unit version and
that's when you can say hey I boiled
this down as far as possible I've
removed no time I've removed then unit
in a console app and now I'm ready to
ask the world widest if they're giving
Wiggly mmm
anyone have any questions for John about
what he's doing and how he's doing it in
way he's doing it and you think yes yep
right so I then changed to let's just
see what happens if we do it with
integers oh look it's still really slow
okay let's try all the different ways of
doing equality within the unit so the
question so I just want a really quick
okay the question was you know did you
override equals without you mean or
implement equals in a weird way is that
what you're saying yeah so the question
was how do I know it's not my code yeah
yeah and in no design that's an entirely
valid confirm because the equals the
Equality that I was checking was with my
own stuff so yeah get rid of that as
quickly as possible
basically try to shift blame as early as
you can yeah that's a good be somebody
else's fault
although shifting blame comes back to
something that whenever you're attacking
a problem on your computer you will
actually get further faster I'll keep
this very very short if you think of the
negative and you try to disprove
yourself I keep that pretty sure some of
the reasons the way your brain works but
in what John was doing he was saying
well I want to take note of time out
because he may have been even thinking
maybe it was know to time because he has
stuff in there that could be causing a
problem and he said well take it out and
then I'll know for sure so this
idea of dissecting things pulling things
apart divide and conquer but with the
notion of excluding big parts of your
application
that's a fastest way to get to the
bottom of any bug any problem that
you've got including this one um can we
go back to my machine for a second Adam
switch
I'm sure he's listening to you now many
points is having Rob here it's great
because I don't switch yeah if I said
well I'm slow enough and I don't say
Alexa first Alexa transfer a hundred
thousand dollars to my account okay okay
so this is kind of what he did all the
way through there and one couple things
I want to point out I did not get this
right John correct me I just I couldn't
remember the culture for the four digit
culture but he was in Great Britain this
problem doesn't happen in u.s. right I
believe that one of the things that you
ran across is that that's why the team
had never encountered it so you know
just remember that you're not in the
culture that was the first one that got
tested and then the other thing is that
you know sharing the knowledge is really
important and can we go back Adam switch
oh look I love that yes so much power um
this is something that the team could
work with actually if John had just
stopped here and done nothing else than
in just sent it to the team which all of
you can do you don't have sensor to the
team Senator John Army I mean it's
really easy to do which is walk you
through it it's just this little button
up there that says send something so
yeah I want to go back slightly on my
try to shift blame as much as possible
I was very tongue-in-cheek there and
actually the right attitude is it almost
certainly is my fault I have seen so
many questions saying I am a hundred
percent sure this code is correct but it
doesn't give the right answer right I'm
pretty convinced that the problem is
going to be in your code rather than the
compiler and sometimes there will be
compiler errors sometimes there will be
bugs in the standard libraries etc but
assuming that it is your fault first and
if you can try to disprove it being your
fault that's great but that's what I
would suggest is that I'm assuming
actually the John was thinking that
because he actually skinny has
less confidence in his code because how
many people have run his code versus
another time a lot of people are fun but
stuff this new very much fewer than ends
with much much fewer than answer with
maybe not ends with in Great Britain on
Linux but you know it's it the this
welcomes razor the simple thing is it's
in his code but if you try to prove that
you're going to waste a lot of time it's
going to be way faster to try to
disprove it and say I think it's in my
code let me just see if I can prove that
wrong and then he did prove he did
through it wasn't in this code and then
he got to go talk to the team and then
the other good thing as well as if you
can exclude like I tried to exclude
notice I'm not only do you have a better
idea of where the problem is or isn't
but you've actually made your your
environment simpler to do the next step
so it divide and conquer is awesome in
so many ways yeah yeah yeah chap chap
chap chap chap cool okay okay do you
have anything else on this question you
guys ready for another question do you
want to keep talking about this one for
an hour yeah I wanted the thanks on
Kathleen says she has something very
naughty to do we look like really
looking forward to it I see sharp seven
I promise something will be ok by
tomorrow morning at 9 o'clock but my
version of Visual Studio 2017 with South
twenty minutes ago so you're going to
help me on that one but let's get to the
question force in my apart you up you're
right
that's cool okay so we'll come to me in
just a second but let's talk about the
question here pretty quick and that is
pretty simple how do you enumerate
through an enum if you scroll down a
little bit isn't there an example of
what he wants to do right below them
yeah it's all tiny it's as simple as you
think the before you ever want to do
that I'll use you have okay you had did
you do it because there's a pretty easy
answer to this actually and so if we're
not on me we should be can we switch am
switch as their interests how many if
you know the obvious answer from if
someone asks you five years ago or if
someone else the you now that has all
the knowledge now how you would have
done this five years ago how many of you
know what you would say
Hiep tries welcome committee well that
surprises me actually that it it feels
like it's a part of the VCL that's been
there since 1.0 what I'm going to do is
Bend there since the beginning of time
I'm not gonna do anything fancy okay so
I'm just going to do speeds clubs I
don't know whatever he had a man I think
it matters diamonds and I need some
hearts in there okay so now I got the
the UNAM sitting there and I'm just
running a unit test because it's an easy
way from for me to do it
so what I'm going to do is I'm going to
create a variable if right now I'm going
to call it just Fred I just to get us
started there and now I'm going to use
the enum type enum and I'm going to say
get values okay so this can give me the
values that are in the Nina and then I'm
going to pass in a type and that's going
to be the type of the suits it's been
there like since the beginning of time
now that doesn't give me the right type
that returns in a Ray it's been there
since the beginning of time it's an
array it's just an array that's not what
I want but Narae is an ienumerable so I
can say got cast and then I can tell it
what I want to cast you with your suit
and then I can say okay that should work
if I spell get you guys come on this
method pair programming you can help me
it's okay it really is okay please okay
so as soon as I can manage to get rid of
that extra e this should be fine what is
the problem there that is probably
because I need to do using system that
link that slows you down for just a
second and now we've got that so now
let's do for each bar now I'm going to
change this to being suit members
because fred was a really bad name so
I'm going to say just a suit member in
suit members can there we go
and now what do you want me to do now
this is where this question actually
gets interesting in the first place is
that all they told us all he said was I
want to enumerate through it they didn't
say why and depending on the reason they
wanted to do that this may not be the
right answer so if they just wanted a
list of the names that could have used
get names so there's some other things
that they might have done
but I'm going to assume that this
actually is what they want and that what
they actually we're just dying to do is
consult our right line with their suit
and I'm just going to say suit member
because I want you to know it passes and
then just because I think you'd like to
see it to member dot type of get type
sorry two main languages in my head
Donnie okay
shows that sound good anybody want to do
anything else real quick we got it you
guys want me to see this around or do
you just totally trust me
totally trust me all right yeah all
right okay so um I will build it and do
you have two pools I do okay uh I'll in
full value couple wali aura yeah that's
it away and have that ready to go that
would be awesome
okay so if you don't know this is
another reason I want to do it that was
console dot write line is that in the
test runner this is how you get to your
console dot write line stuff spades suit
clubs suit diamonds suit hearts suit you
guys see why I did that it looks really
stupid it's really stupid output but you
see why I did it right because we just
interleaved those in a really stupid way
okay so got that so there's a couple of
other things you can do depending on
what you're looking for if you just want
an array of names you can just say get
names there's some other things that you
can do but what I want to do is talk
John through and John I kind of probably
know hopefully what I'm supposed to work
at usually it's just a surface book I
don't have much strange okay not like
when Bill Wagner had me or I insisted on
piping on Bill Magnus machine which had
code rush installed and it was suddenly
popping things up I'd never used
clackety two better than one on that one
is I honest to gosh was once in where
the Machine wouldn't hook up in the
answer was I was supposed to use the
venue machine which had a wait for it
yes a Hungarian keyboard and that's true
true story
Catalan Diageo saved my neck because you
knows a tiny bit of Hungarian those all
in Hungarian the other one is if the
other one is my son who if he touches my
machine is Dvorak on it and so if I hit
the wrong keys all of a sudden I'm
Parag world and so that's quite sad for
me okay so anyway we're in this world
and what I asked John about was whether
he has got a NuGet package in call value
to people you could we got tuples in
2012 we get two tables and I think 2012
and they were done badly I'm selling
they just were and we have a new tuple I
won't go into why that difference is
unless I touch on it tomorrow morning
but you even have suit in here I'm going
to create that it's in another car we
have that okay so we've got all that
okay oh I'm switch and switch all right
okay
just missed it okay so what I want to do
is I'm going to create an extra class
just because I just kind of feel like
creating more classes so this is going
to be just like a public static bad so
yeah by plus may not be where you expect
I knew this was going to go badly you
see if one more Keith one more typo and
he's going to type up so don't worry
bad extensions bad extension be very
careful be very careful these are just
an extension methods okay oh yeah yeah
this is not worth it okay creepy eye
pretty close public data class you need
to cut the word class in there I was
distracted by your keyboard public
static class we're going to create an
extension method that's why it says
extensions okay public static void and
then call it's very important name
deconstruct okay and then via this and
then a little bit this way suit and then
we're going to hand it back let's pan
back an ienumerable I wasn't out he knew
this because he's actually done this
before but isn't that nice being out
here and this is a very that's exactly
this diff syntax
okay and then give that and you have an
extra parentheses well I I'm what we
guessing what you're doing but oh you're
going to be even worse okay let's do it
okay and then close that and this is
what I have no idea whether you can it
it should work okay
this is a double tuple yeah we're gonna
have fun here I was gonna be a little
differently okay so that's cool and then
go ahead and we'll create a method here
so the bulk of the method is just pretty
much going to be what we just did let's
just say you know dot get values past
the type of suit and then let's do that
to a cast will give us an ienumerable
and let's but you know instead of a
cache there let's just do select when we
do it in one place if we can unless you
were getting me to do two constructors
own survival by the cast so we
definitely got a suit in our hand now we
have suit okay so now we can just return
actually how you knew this we're going
to do two times there's not a suit off
value not a little suit value well we
can do just do the suit and suit off the
string okay that's perfect perfect
perfect perfect so we're not exactly to
returning we're returning a suit
non-integer I was missed
I was trying to return the integer okay
so every file is so far right
that should work fine what do we do with
the Deconstructor and there has to be
set to value suits equal yep okay okay
uh it no compiler uh oh yeah okay and
make it a public ah public iam fine so
the public didn't match up we had an
internal and a public that was should
have been the whole problem we think
this should work what's it about um so
what is need to build safe okay yeah
there we go
move up okay slow slow slow that's good
okay so that's a Deconstructor so what
you care about is how you actually use
that okay so you can just say just be a
save our and then give it any any
variable name you want
we're not exactly they're not going to
be as fun as it could be so we might
change this a little bit more in just a
second equals and now we actually need
to hand it a suit so do you want to just
do 0 put put that in parentheses put
certain parentheses in double um yeah so
we're just passing at any suits is even
it completely invalid suit okay and I
don't think you need that one but you do
need
man everything should be fine there and
then Jeff should be the eye numerable
but that's not very interesting cuz it
doesn't look like a tuple and we wanted
to make a tuple here gentlemen surely
that Jeff is going to be just the suit i
deconstructing anything with with VAR
yes should be what is Jeff right now
Jeff should be an ienumerable oh no I'm
gonna say it's not an ienumerable so if
we you're right okay right ah there we
go
cannot implicitly convert okay that's -
oh another way I wanted I want to go
back okay go to deconstruct and before
the first out add another one which is
just string and name I don't know just
small just no what are you doing I know
you're doing a whole little demo no no
right here right here right here
okay right here let's just add an out
for a string the name okay okay yeah
that's right see that okay so that is a
good way to force us into yes thank you
very much I'm just given a name comma
Jeff yeah that's all I want to do yes
and I write where the word Jeff Jeff is
now misplace yes okay so now this should
be good yes it should be beautiful I
don't know why do we don't have any foot
name naming cool oh yeah suit up
strength flank uh yeah but we don't
really yeah okay sure I have no idea
what's yours going to give us I was just
going to suit I don't get a fades in
this particular case but because I zero
value of it completely cruising in it is
it going to give us something or is it
going to die now it's going to get
spikes okay yeah okay clap but if we
never we had spades equals 1 it will
give 0 as a string okay good okay at any
rate we can run this down this is what
we want all this aside stuff okay so
they believe it works okay so this is
actually the reason that we said bad is
because we have completely like
undermined the meaning of deconstruction
what the heck why would anybody walk up
and think that the way you would
deconstruct a UNAM called suit is into
the name of the value
you pass plus and ienumerable the other
values in the list I'm just going to
check that it actually works yeah I
think you should do that
whoa ah yeah and okay so one of those is
a string and the other is the value but
the value is being converted into a
string anyway you wanted to get the
values of intz than you so if we make it
in string so we can see the numeric
value for the name sound of it so now
wrong wrong one there we go okay okay so
questions so the reason I want to show
you this is to show you deconstruction
you can do anything you want with the
construction but for goodness sakes
don't have your deconstruction be
something which you walked up to that
value and you deconstruct it it makes
sense so a sensible deconstruction here
what's actually be that you pass back
the integer and the name as is showing
it in an integer that would be a
sensible deconstruction on the spades of
a suit what we did is a nonsensical
deconstruction so as you look at
deconstruction there are no limits
whatsoever on what stupid things you do
so I would suggest it for the good of
your friends and keeping their friends
and staying employed that you do smart
things with that feature but that is
that little just you know we're creating
tuples with the little parentheses there
you can see more about that in my talk
tomorrow morning I have a nice figure
out whose way to run give me a laptop
you have another one yeah all right ah
okay there is a problem with the 2017
with these cameras today thank you yes
today I'm getting it everyone Maura
office here at NDC so we can get it
fixed
yeah I may have a personal problem in
addition to that I'll be working on that
after this but if anybody has a version
of 2017 RC or later that is working
happily and you are willing to be my
code monkey tomorrow let me know I would
love to be okay monkey horrible acting
presenting other things yeah but I only
represent my talk tomorrow morning which
I haven't written yet if you want to
write it as well that we great then then
I can be cussing to go code monkey I
won't show you a different way of doing
this because I don't like enum bucket
values and because two reasons firstly
it gives you back an enum array and
actually that causes the second reason
so it's an enum array which means we
don't know that it's the right type and
so we have to call cast and also every
time we call it it's got to create a new
array because arrays are always mutable
so this feels like a great way that we
could have a an extension method sorry a
method that takes a generic type
argument and cashes a read-only
collection of enum values okay this
sound good so far so like I didn't have
to warn you stemming of a slight cliff
here was something that he said and we
to make sure that he gets this part
right which is that he's going to have
an extension method it's going to be
generic on enums
and so we don't have a constraint
against enums
you can't say where t is an enum yeah I
generally be able to know where the
caffeine's looked at what's coming up on
I I may have looked at your block okay
good yeah I was going to be so fun
watching your face when I write so it is
this one actually isn't an extension
method but I've got various other things
that are so I've got enum values suit
and that will return some kind of
read-only collection I can't remember
those it just returns an eye list of T
but I have documented that it's
read-only and indeed if you try to
modify it it will go back this is using
a reference to my unconstrained melody
um library which I wrote it's one of
these POI libraries that was mostly to
prove I could but it I believe it's
actually useful and some people may have
it in production I have no reason to
doubt that it works and there are even
tests and everything
however as Kathleen says this looks like
it's probably a dangerous call because
what's the stop us writing enum values
string well okay we could constrain T to
be a value type as we know all in um are
value types
let's let's try to write this class so
if we had class new enums and we have
public static a list of t get values of
t so we'll just return null turnout
because we're only interested in the
declaration really so we could do where
t is a struct now getting us and that's
not good enough because then we could do
get values of grid and that's not nice
where t is class doesn't help us so what
we want to write is where t derives from
enum and is a struct our way around not
that it matters because it's still
invalid so that kind of looks it's what
we want it to do and there's no problem
with having two constraints one of which
is the value types in shrink and one of
which is you know maybe ienumerable
of teeth for example okay so this now
will only return values for a type t
which is a value type which also
implement my enumerable of itself great
but i cant drean them because those
stupid down language designers said that
I couldn't and gia what the the most
annoying thing about this is if you look
at the CLI spec so not the c-sharp
language but the runtime it not only
doesn't have this silly constraint that
you can't derive from enum it gives it
as an example of a useful thing to do
and the other one you would want to have
is delegate anywhere enums up in an
elegant america charter yeah new
marriages harder and as soon america
wants that these two are easy
so my unconstraint melody seems to have
so i can't can't write that properly but
i seem to have something that has all
the right things if i try calling enum
values oh look you can't read this but
trust me the type int cannot be used as
type parameter t in the generic type or
method enum values there is no boxing
conversion from int to system dot enum
well
the compiler understands the constraint
even though I can't express it in
c-sharp now unconstrained melody I don't
actually have the project on this
machine but it's all on github and
fortunately unconstrained melody as one
word is very easy searchable there
aren't many other hits I mean I'm going
to suggest we let people look to that
yeah we don't spend too much time at
solutely because we have some other
stuff that we we are to look at the the
one-liner is it runs a old album does
yeah honking around just in the plate
area of the IL not for me any mono
settle or whatever but just run I'll buy
them handcraft the il then run I love
them again and you end up with right
complete I will definitely work that I
would also suggest that you know how to
go to user voice calm and say yeah
really please we want this yeah really
please we want this and and get those
voted up and because they're doable yep
they're doable not have numerix might be
harder they really whined a lot when we
talk about numerix yeah okay can I ask
you just comment on one more thing about
the spec and the fact that the languages
are such a hard time you guys probably
know that so you say protected internal
then the that item is visible in any
protected class in any other class
within that DLL so you're with me so far
right when it be nice and we had that
the inverse of that we could have I want
the only people I want to be able to see
this is I wanted to be within this
hierarchy to derive from this class and
also within this assembly wouldn't it be
nice to have you'd like to have that no
yes really seriously would you guys like
this okay that has been in the aisle
it's been and dotnet since the very
first release in 2000 within the Alpha
okay do you know why you don't have it
is anybody seriously know why you don't
have it you do does anyone else know so
why do we not have it because we can't
name it yeah
you think I'm kidding look we don't have
that feature because we can't name it so
please if they bring it out and they put
it out it doesn't matter what they name
it it doesn't matter if they name it
something as stupid as private protected
yeah
next on C sharp will soldier ass
invalidation and then we've done
everything in could we do act if we do
cache invalidation after naming with
we're sorted yes okay so uh I think
we're done question to you like we've
just beat that one totally I think we're
ready going you were going to gave her
question three I think I would many
question three what you uh okay so uh
yeah question three has to do with a
optimization do we have it up yes yes
good machines at my ears miles all right
okay so question three is actually why
does try can speed things up and the
short answer is first of all if you get
something like this and you see it then
trust the heck out of it and really try
to convince yourself be that you've got
it figured out which is exactly what the
poster did here so if you come down and
you read the rest suppose they actually
say really dude really it's consistently
sixty nine in one case with the try
catch and without the try catch it's not
so first of all I just going to say if
you've got something as cpu-bound as a
Fibonacci than thirty percent it's just
not much you think it is because gosh it
goes fast anyway but it's quirky and you
go why on earth and when it when you get
down to this you're gonna have to look
at some aisle and look at ya get deep
into things to find out that
implementations can be super funky
sometimes it can be really weird
underneath and you've really happy five
you care I didn't believe this question
to start with so I had it here or just a
question at site look okay you say that
it does it on your machine please give
us something that we can run to prove
that it works is that it does the same
thing on our machine so I think what
we're seeing now is close to this isn't
how you should use stopwatch you know
time the whole thing rather than just
one iteration of the loop
but this was after a few attempts to get
something reproducible and then find out
exactly which configuration they were
running on I think some people on
different architectures had problems
reproducing it so there was a fair
amount of back-and-forth but we got to
this stage where yes I could reproduce
that it really did run 30% faster with
try-catch and there were no exceptions
anywhere this was just bizarre my own my
own yeah if you could scroll down to the
question again really quick a little bit
me all right down to the question in
case anybody's wondering what I do here
because I'm not saying very much I have
to find these questions I just want to
point out this note if you go up a
little bit more up a little bit more or
down I'm sorry I go down down to the
question anyway I put a note in here I
had to note John's answered this
question now you try and find some
questions about T sharp on Stack
Overflow that John hasn't answered good
luck that's my job that's what I'm doing
here so I just want to point that out
cuz I want to be relevant you know I'm
saying X Y be relevant thank you that's
all that's all they talked me into this
for better or worse so yes yes yes yes
better or worse yeah how much you want
to do with this right now well so I
guess I want to say things are weird and
things are weird in different ways and I
can show you if you divide two by three
and you look at the answer for that do
it first and X to X eighty-six he goes
yeah man I knew that you know floating
point numbers are going to give me
trouble I should be using decimals all
the time and prove that to your team but
then don't try the next 60 in 64-bit
because then I'll be just fine and you
will think you don't have a problem with
floating points and it will confuse you
and there's these weird little tiny
things and get down to it and part of
this guy right York Reza doesn't matter
so that this 30% doesn't matter and now
it's curious is hack yes and I am this
is something interests me it doesn't
matter how irrelevant it will end up
this is how a rather I've me mad there
was a another really gnarly question
that maybe we'll look at another time
around dynamic typing and the double
ampersand operator where if you've got
two expressions of type dynamic and you
do yo D 1 mm plan D 2 well we know that
the double ampersand operator is only
meant to evaluate the right hand side if
the left hand side is true but there are
some weird situations where operator
overloading can affect operator
overloading and conversions can affect
what gets used
so in dynamically typed code you have to
evaluate the second operand in order to
work out how to evaluate the first
operand and there's really weird stuff
and that kind of thing ended up with
Neil and Mads
arguing for a little about a while about
whether this was a bug whether there was
any specified behavior for this kind of
thing so yeah not actually useful but it
will certainly get me straight on the
keyboard how many of you use dynamic so
as your hands I heart so actually I'm
always curious about that because I
think when it doesn't like a couple
things in c-sharp I really wish wish
wish wish had been different and one of
which is the fact of the VAR keyword
works against dynamic so it's really
tough to keep dynamic completely out of
your system if you have if you working
at something like Excel anyway just
curious about that cool so out of
interest can anyone think of the kind of
shape of answer that came out of this
and what you would do so Kathleen said
about going to Al and you look at the
aisle and it looks kind of how you'd
expect there are no obviously relevant
differences so what would what would
your next step be
yeah it might be CPU pipeline that's
what I thought it would be something
around that but how would you next find
out what's going on you need the machine
code yeah and I don't do this very often
so I had to first look up how do I get
the decompile you and if you run it in
the debugger you've removed most of the
optimizations so you have to do all
kinds of weird stuff to get the
definitely JIT compiled in the same way
it will give you the same result
assembly and then you see the difference
and but the answer is that depending on
whether you have try-catch or not
Roselyn does different things with the
variables here
it will use a different number of stack
variables basically and it allows
everything to be kept in registers in
one one version and another version
needs actual stack space and it keeps
referring to the SEC which is sort of
main memory okay it's a CPU cache but
it's not quite as good as a register and
therefore weirdness ensues
so yeah completely irrelevant and
arguably a Roslin bug and it's good Eric
Lippert said yep I filed a bug with the
Rosen team to try to do the more
efficient thing but it was from the from
the 30,000 sweet spot it looks really
really weird it is rude it's very weird
sometimes darn and it's weird
hmm yeah come tomorrow to my abusing fee
shop talk to see when it's weird are you
doing it using C sharp and 9:00 a.m.
no that's three o'clock good I don't
know I'm taking abuse C sharp at 9 a.m.
I think it's too early just way too
early
I've got time zones at my name I come to
my talk I'll find about seeing their
works but we have great jobs could John
John is the man on time zones if you
don't know that if you ever thought
about time zones you should go to that
talk you should clone yourself and be
able to our talks so do we want to talk
about this more and we want to go on I
won't go on more because we're right now
crying really fat man yeah if I got 10
minutes left I was actually going to do
that we kind of already did that I was
going to go with you constructors ok ok
so let's see what don't talk about deep
cleaning and said talk about deep
cloning because that is got so many
layers to it and do you want to eat well
where we get to do you want to deep
cleaning or do you want to do variables
inside or outside of loops deep cleaning
deep cloning I'll put it up to a vote
ok so the two questions on am i
uploading what do I do about deep
cloning or this is you isn't it yeah or
something that's sort of now obsolete
but is interesting to consider from an
old perspective of how changing whether
you declare a variable inside a loop or
outside a loop can make it it or use to
make a difference for each loop
did click on gun person see how much
difference want you a lot of the made by
Tom I show my friends you can make in
the workout you alone okay so I so
what's he planning so deep pawning is I
mean we can clone the the value types
the easy stuff on the top of an object
but if it's an object graph and it goes
deep okay now we run into a couple of
super interesting problems one of which
is simply how do we clone deeply and
let's start with a simple graph that
every time you clean deeply you just
find objects and enumerables
that have more objects that also just
have premise that's all fine now let's
turn around and look at a situation
where some of those guys need to be self
referential within the graph and that
makes it even harder so so that when you
sit and think about deep cloning you can
create reflection based solutions that
do the first case you can just write one
I mean you could all spend two hours and
get it done but if it's it's you don't
like this no it's sudden at least 2019
has died oh my gosh okay this is going
to be a long conference because all the
2017 talks is you walk in the door down
do you have a plan for this you know
because that was a I was on the internet
I was fine I was in on the internet ten
minutes later I was dead so we have this
challenge right now with their versions
of 2017 are you on a private billet or I
mean oh you're a nightly build yeah I
don't write it about financial just I'm
on RC yeah I'm on the same one you'd be
on if you wanted so if you keep your
machine live until tomorrow morning's
you have machine keep off the internet
come be my friend you can suit me my
code Winky otherwise I will be fine with
powerpoints if nothing else you will get
the concepts I will apologize for count
raincoat this one okay so you understand
the basic problem you guys have probably
all had this problems one way or another
this is a really super common problem so
the way that I saw this problem is
through through a UN name whatever you
want to maybe copy or whatever and very
specific methods so every object knows
how to make a copy of itself and call
that on its children and I would have an
I copy interface and then I would expect
in a system like that to just everything
I copy and I could just go through the
tree and start getting things copy it's
not a very generalized solution though
and John's over here typing I think I'm
trying to find my project I think it's
exited Visual Studio without saving the
solution I was working in
which is quite possible because it is a
pretty brutal you don't have a license
we hate you
and we should talk to the teams because
we demo and I'll do that I think you'll
find it yeah yeah all right it looked
like you had some code you want to show
so I was going to be writing code you
you keep talking I will write code of
the example that you were saying about
about references not working I thought
wow okay useful see what that looks like
okay yeah yeah so let's just just
imagine that you have a this deep column
that you're trying to make in your new
set you've got different people and
they're in the same department and you
want that department to keep referencing
to the same department instead of going
off to other departments and you keep a
simple version of this it's just
something that's up in the up higher in
the tree so for example if you have a
parent that refers to his child when the
child also returned refers to its parent
and one way to handle that is the series
of constructors and just passing in the
values and then if the value can't be
exist and it comes in then you use it if
it doesn't then you just use not another
thing you can do is how to have a
pattern where you can visit your entire
tree looking for something so let's say
we're looking for a particular city and
we have a visitor pattern that can go
through the tree or do that you have to
be able to find your children and
understand how you're actually going to
go through the tree and I'm kind of
running out of stuff until we get some
code in front of us are you in a
position to do that yeah I don't know
which magic oh and it's magic okay so we
have a person and we have a public his
name person person person okay and we
want to yes I ate my children goal but
okay okay so if we say John Doe child
equals Tom and Tom dot parent equals
John okay
so if you take the if we have a public
person we clone method and do the naive
thing of return new person
so I'm just going to switch to these
days I get absolutely yes creative
without expressional body members yellow
ever see chopsticks if you haven't seen
it maybe's claim and then we've got the
null conditional operator so we can do
child it calls child question mark dot d
clone yeh and parent it's a shame that
this gorgeous code won't work so yeah
that looks like the simple thing that
you do unfortunately that's going to
just go bang lets it feels suitable to
nearly end this with the exception we'll
get you know what we should really call
deep claim from the main method I carry
me sound so even if we had even if we
didn't end up with a stack overflow
exception highly suitable it would have
been bad because even if we could come
up with two different objects one for
the clone of John and one for the clone
of Tom those who wouldn't have referred
to each other so you would need some
kind of object tracking kind of thing
and if you use Javas object output
stream okay that has this sort of object
tracking it it remembers oh I've seen
the first person object so whenever I
see that again and I need to write it
out I'll just write a reference to the
previous one so this kind of thing has
been done great so what's a cheap and
dirty answer to this if some of you have
done this anybody know what the cheap
and dirty answer is what's the cheap and
dirty one what Sarah lies okay he said
Jason dotnet that was a little specific
I was going to so the cheap and dirty
answers you sterilized and you do
sterilized and it's not a terrible
 answer in some cases you don't
do this often and what the heck you know
maybe you can serialize you do
everything everything is generalizable
yeah okay so does recent dot that
support references nicely I haven't
looked at what I don't know whether
there is one well-defined you know
industry standard way of making one bit
of a JSON document refer to another bit
because that's what you would need in
this case in this case you may be
correct as me not serialize with
you would need in some way let's just
let's we only have three minutes Babs
over here looking nervous what right so
you have to have some celery from
trucking okay
isn't that necessary
nope you keep talking I'll see if I can
get it going I'll be fun so what was the
conversation you two were having there
you sorry the conversation is can we
persuade Jason net to do something
sensible with it
either to give up or ideally to have
some way of backtracking within the
Jason and say it's that one over there
so in some ways let's look I'm going to
make sure what yeah I think I'm going to
make sure the problems clear right there
while we're talking about this
backtracking kind of thing so you come
along and you say name and you say then
I forgot what it looked like let's just
say it's a parent and you get out of the
Jason what the parent is and now you
have that object you own that object and
now you build a child and you want the
child to have a reference back to its
parent but if you simplistically had
Jason net it might not do that and the
conversation was that I X haven't done
that with Jason dotnet but that it
should support it now you can do this
very specifically yeah I don't know what
a Jason I don't know what a good Jason
representation of this would be we won't
save the root of the document oh it's
some some all right okay so ID hash 0
and then parent is hash cereal in here
that would do okay
all right stuff to the serialization for
the other you're gonna have to
explicitly walk through it I'm running
around at a time Rob's walking up your
life like he wants us to be so we don't
get it right now in civilization
framework in the last 30 seconds oh darn
you do it was only like iris with your
some of the I complain it before and we
had yes yes that was not fun that was
fine for you it was yeah I just made me
feel about that big speaking of thank
you guys we did run just right up to it
if you have any questions I think you're
going to have to come up otherwise we
need to be nice to the next speakers
coming and thank you both that was
really fun do preciate all right thanks
so much guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>