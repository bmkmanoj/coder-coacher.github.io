<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The Future of Calling Microsoft APIs - Simon Jäger | Coder Coacher - Coaching Coders</title><meta content="The Future of Calling Microsoft APIs - Simon Jäger - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>The Future of Calling Microsoft APIs - Simon Jäger</b></h2><h5 class="post__date">2017-07-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AfrqYM-qRHs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys good morning and welcome to
the session on the future welcome to the
session on the future of calling
Microsoft api's - Microsoft class my
name is Simon Jaeger I work as a
Technical Evangelist at Microsoft and
what I do is pretty much what we're
going to talk about throughout the rest
of these 60 minutes a little heads up
I'm being very foolish enough to run
preview bits on this machine it's my
primary machine and since coming here
I've had about ten blue screens am I
worried yes am I freaked out yes and so
it may be that we're going to have like
a 30 45 second commercial break in the
middle of list while I reboot the
machine but hopefully it'll be fine I
have two goals with this session and if
I can achieve at least one of them for
each and every one of you I'm stoked I'm
super happy the first one is to give you
an idea of what you can do what does
that mean what is the future of calling
Microsoft API what is this Microsoft
graph why does everyone have a graph I
want to show you what it means and how
it actually could solve something real
how can it make your life better how
could it make a development cycle faster
how can you create wow factors how can
it make it easier for you in one way or
another the other goal is to show you
the learnings of this I realize that we
come here listening to a talk like this
in different ways some want to see how
this fits into what I'm doing and others
want to see well how can I apply what
that's what's going on here into what
I'm doing and take learnings from that
so I want to share some of the things
that goes into building this enormous
enormous thing called the mics with
graphs while still keeping it scalable
and consolidating so many different
things into one place I'm going to take
you on the journey we're going to go
from maybe I'll level
a hundred contents and slowly creep up
to two hundred and three hundred I want
to make sure that I grab each and every
one of you and get you all up to speed
and I said if I can achieve one of these
two goals with each and every one of you
I'm super super stoked
do we have troubles no it's fine
it's right I'm rocking my phone now so
it's all good it's all good all right so
the first thing that I need to do to get
everyone to up to speed is to talk a
little bit about what is it what is this
thing called the Microsoft glass why
does everyone have a graph this was born
as something that was called the unified
API endpoint and today I don't know if
any one of you were at build or even
watched the build conference whether
everyone here is built none one was
adult too was adult at build the Mexico
graph had tons of tons of love you
couldn't go anywhere without the much of
graph being mentioned and there's a big
reason behind it now is a very very good
time to look at what it is
so this board has this thing called a
unified API endpoint at this point it
was about consolidating all these api's
that we have a Microsoft into a single
API the reason wasn't just to to put
everything into a one cool API it was
really to make it easier make it easier
to engage with all these different
things because they're out there and
they could most likely be something you
could use to enrich those applications
and it was hard because each team had
their own way of building an API their
own ideas of how to do rest so what we
wanted to do at that point a few years
ago was to make one API and one
convention that was sustainable and
consistent so that we can make it easy
to access all that data at this point it
was about data but something beautiful
happens when you've got access to this
data that's where the real power comes
and that's why a graph
and the graph becomes one of these
buzzing things that everyone needs to
have it's sort of like machine learning
and AI and the graph everyone needs to
have it no one understands what it is
but something beautiful happens when you
finally have that data suddenly you can
start to realize there's a connection
finally understand that there's a
connection between this device be that a
Windows device iOS Android doesn't
matter there's a connection between this
device and this person and this file in
this email and this chat history and
when you start to do that you create the
graph you get to understand the
relationships out of these relationship
relationships we create wow factors that
is the common denominator for Yai
machine learning and graphs are the this
buzzing thing is to generate and bubble
to the surface while factors we need
while factors in whatever we're building
the reason is we're in a very mature
state of our industry if you were to
come to me and say hey Simon
I built this application that it's able
to stream bits from the server to your
device wherever you are and I pick music
so it's a music streaming service I'm
super excited about it I'm not I'm sorry
I'm not excited by a music streaming
service anymore but if you come to me
and I get your application I go into it
it is still a music streaming
application but every single day I go in
there you get me a song in the morning I
never knew it existed had no clue about
the band name the song name but every
time it is the best song I've ever
listened to if you can do that sign me
up I'm your next customer and probably a
million more because that's what we're
building these days the things were
discussing especially at conferences
this day our details are well factors
we're having Wars about frameworks and
and and ways to do rest and all these
things and it's about how do we make
these tiny awesome cool Wow experiences
that really make a difference they make
us competitive competitive against all
these other things I still expect that
music streaming service to be able to
stream music but now I expect that ten
years ago I was amazed by that but now
it's more about finding that derived
data from the large set of data so now
that you finally have access to it
there's a bunch of things that you can
start doing and we do it we do it in our
own stuff when you go and you want to
collaborate and you want to search for
someone else we're going to show up
front who is important to you who are
the top five people that are important
to you who are the documents that are
important to you and we figure that out
through these relationships and if you
want to use that if you want to use the
data if you want to use those what we
call insights the maximum class is your
way to do that it is your one-stop-shop
to get access to all these things is it
the data or is it insights and there are
tons and tons of things that you can do
I'm going to give you pointers to where
to go to find the things that you can do
we're going to go through a couple of
demos I've got code and all that but it
would be impossible to demo everything
instead you're going to get pointers and
you're going to get started and you're
going to see some cool things and some
silly demos as well I also want to point
out that I try to talk to some of you
yesterday and figure out what is the
audience here what are the tools and the
languages of your heart so I try to
adjust the content to to suit that but I
do want to say that it doesn't really
matter there's an idea right now of how
we build our SDKs and I'm going to share
so that you know how to use it once in
one language praises me showing it on
the screen and then you know how to use
it everywhere and it's not about
jeopardizing the programming language
flavor but it's about keeping a notion
as consistent primitives throughout
these SDKs so I'm going to go ahead and
share that with you as well and now I
totally
thought that I would forget this because
I have always done this my practice runs
I need your help for the last demo that
I'm going to do so assuming that I don't
have any blue screens and it all goes
fine we're going to have a demo where I
need some data so for one time only I'm
going to ask you to pick up your phones
and be this naive dude that things that
everybody has Twitter probably and what
I need you to do is to apply some data
for me that we're going to use in the
demo at the end and it's totally
friendly demo so you don't have to be
worried and what I need you to do is
send a tweet that starts with this line
right away looks good starts with hash
tag types of glass that's the way I'll
find you and then please do not break my
stupid red X with like a 1 in here or
something
and lower case with and then what you're
going to do is put in one word a
programming language the programming
language of your heart what are you
passionate about so for me I would
probably put in micrograph with c-sharp
so I'm even going to be as on now you
hearing and hit this and wait for
someone to send at least one
there's already one all right five
minutes ago that's my friend that
doesn't work are we getting anyone here
I see phones people are thinking hard
about this decision which language is it
alright nice oh this is awesome
beautiful so with that I'm going to let
this just flow in and all that is going
to get catched into a demo we're going
to do at the end so I want to get you
started now and showcase some of the
things or some of the ways you can go on
about engaging and discovering what what
is it that you can do what is this
abstract thing of a graph the very very
best and first place that you should go
to is the graph homepage now we use an
easy way to get there is through graph
Microsoft oh and this is your one-stop
shop to discover everything you can do
and there's awesome tools in here that
I'm going to show you which is a very
good way to explore and see what is this
fuzz event the first thing that you
should do is to figure out what are the
things in here that could work for me
what are the things that I could use in
my applications and my scenarios that
would be cool that would enrich empower
maybe a new solution or maybe an
existing solution so what you want to do
is to go into this place go to graph up
Microsoft I oh and hit documentation X
here go to the left and in here the
first thing you're going to see is a
bunch of different things that you can
pull up I I like to live on the edge so
what I do is go down to where is it is
my zooming the beta reference because I
have even more stuff that's coming in
that is a good thing to know about what
we're doing here is developed in two
different branches we have what we call
the version one that is production ready
stuff for anyone that's building stuff
for the enterprises and on that sort
yeah we need to rely on things that they
are actually going to say the skits
going to stay the way they are and we
aren't going to break you're not stuff
but if you like to build and check out
new things the beta reference the beta
branch is a good place to check out it
has lots of cool things in here and we
take tons of feedback on this as well so
whatever you're going to find in here if
there's something you feel like I don't
like this I don't like this the way that
I use this I like this information as
well you can provide that feedback
easily and we'll incorporate that into
the beta reference and you can see that
happening and you can see that happening
throughout the changelog on this page as
well so assuming you're in the beta
reference it doesn't matter which one
you go to there's tons of different
things you can do here you can do
everything from list users and
authorization to five and groups and
pull out things from Azure Active
Directory which is if you're using an
office 365 that is based upon an agro
Active Directory you've got an Excel
node in here and that's just not that's
not just making an excel file no that is
a rich deep API which allows you to
drill into a specific column in an excel
file and even apply formatting on a very
specific column the very rich API and
it's all through the rest on in addition
to that at Build we release our teens
under people and social you have much of
those insights where you can discover
relevance and relationships I'll
showcase some of that and we even have
things in here now in the Microsoft web
which you can't find anywhere else in
the Microsoft echo system they're being
API is added to the thing that aren't
exposed anywhere else some of you may
know that without your active directory
I've been able to talk to that for years
well there are now api's in here that
you can't access in any other way
because this is our way forward having a
single set of API and consistent
experience which makes it so easy for
you to just add features if you start
out and then figure out hey I want this
thing as well or something new comes
along you just plug it right in because
you're already set up you got onedrive
here which is interesting because if you
expand it you can see we
the notion of drives what I want to put
in your your hash here is you've got
different one drives right you get
different drives you've got one drive
for consumers you've got one drive for
business and who's asked this couldn't
be a SharePoint document library that's
the point as developers we don't care
what is it I care about maybe giving my
users the ability to store files in
their own cloud maybe it's about giving
the users the ability to look for files
using yours using your application in
their cloud storage that's the point so
if you can have a single way of
addressing all of that that's perfect
because that means it doesn't matter
where the users coming from if the user
coming from and signing in with an
office 365 great is he coming in with a
hotmail outlook live account great you
know one API to address all of those and
if you wanted to of course you can pull
down those drives and look into well you
actually come from not that it really
matters where it comes from because you
still have a unified API to to address
that in addition you OneNote you've got
extensions which is something we're
going to look at thread code expansions
is a great way of extending this graph
and putting your stuff in here putting
your data so that you could up offload
things that maybe you order you don't
need to manage database for what if I
just could store this little piece of
data or lots of data on existing nodes
in this graph and then just pull them
instead of managing a database and then
you've read more things like SharePoint
in web hoods there's so much stuff in
here and they're always adding things so
a great place to get started figure out
what you want to try and some of these
things we're going to look at once
you've done that your next step is to
hit the graphics port the graph Explorer
is a way for you to try out these things
that you found without having to fiddle
with code or SDKs or deal with tokens or
any of that you don't even have to sign
in and all and do that kind of stuff all
you need is just to go
and you've got like a fiddler experience
here I bet you're using Federer right
that's quite a few so it's a mini
fiddler so to speak that soul solves
authorization and all that so if I just
go in here right away you see that
there's a URL here it starts with graph
up Microsoft comm that is the endpoint
it's the one endpoint you need to go to
nothing else which if you're familiar
with OAuth creates a good experience
because if you've dealt with OAuth
tokens from the Microsoft echo system
before you know that there's a resource
claim in those that resource claim
points to the resource which would be in
this case of graft Max Ofcom so you have
one resource that you can use to access
all of that in the past that meant
having multiple tokens because that
resource would be different and it would
be invalid if I went to another resource
so you would keep juggling so many
different types of proteins and keeping
them off to up-to-date and refreshed
that this even just this in itself is
awesome
the next thing is to specify that branch
so as I said we've got to version 1 and
then beta and it's just as simple as
going like this hit beta and then you
change it because we're in the graph
you've got notes you need to start
somewhere a great place to start is the
me node so if you sign in if a user has
signed in in your application they have
the meed node which is yourself and if I
just hit enter and run that I'll get
some basic information about well who is
me and that could be that that differs
depending on where we came from in this
demo I have an automatically signed in
with an office 365 account so I get
details from an official 55 account if I
signed in with an Outlook alive or
something else I would have different
information here some things would be
consolidated like you've got display
names and males and first name and last
name so that its consolidated where it
makes sense
some things are specific to depending on
what the user is coming from and let's
do something like this me slash people
which is if you drill down and
documentation is one of those one of
those insights that you can get from
from pulling down and looking into the
relationship so now I'm getting the
relationship between me myself and
people around me and it's figuring out
that well manufacturing operations is
probably like a group that I'm talking
to a lot so I figured out that this
thing is probably very important to you
and then you can find sources you can
even find in here why was this thing
important it figures out it's important
because you email them a lot it's
figured out it's important because your
chat and I am with them a lot so you can
also understand why does this thing come
up here and both groups and people and
all of those are going to come in here
and you can find documents and all of
that in the same matter and that's the
experience we have that's experience we
provide in if you go to office 365 in
all those places this is what we use so
you can tap into and just pull that up
and what if you could just use that we
build lots of social things today
whatever app we have some chance of
communicating with someone else why
don't you just use this and allow you to
just show the top five users right away
which are the relevant people to that
person or maybe it's just a good way for
you to figure out who your next user and
customer is and create a person Alex
personal personalized experience and say
maybe you should invite this person
which is either a very creepy experience
or a WoW experience but it's all right
here and super easy to use the next
thing I want to show quickly in this one
is how do we go on about addressing
customers in different places we are
fortunate to be in a place where we have
a good internet connection I'm rocking
my phone here and doing this stuff but
there are the places where the bandwidth
isn't the same
so how can we be sure to actually build
our applications and call API is in a
manner that is responsible where we can
essentially pick out what is it that we
need so what I want to do here is
actually go into this person's mail so
I'm going to drill down into those mail
follower folders I know that there's an
inbox I know that there are messages
here if I hit enter my port phone is
working I've got the emails of this user
but this is a lot of stuff what if I can
just supply how does the supposin
supposed to look and they're great ways
of doing that already
Oh data for instance is a great way of
doing that it's an open standard for
doing exactly that and that is one way
that we've built this thing using open
standards not reinventing the wheel
using JSON or using the ability to
request what is it that what is the type
of data format that you want and to show
you how that owed Atta looks all we do
is to append a dollar sign we don't have
to anymore but I like to keep it and we
can specify parameters in here we can do
everything from filtering and searching
but this allows the graph to do the work
for us as you can see I've only got the
ID and the body now so I can be very
clever about what are the pieces that I
need to not be taxing on the bandwidth
here and maybe in this country it
doesn't make sense but in other
countries it does make a difference and
it may May or break the customer
experience for you
so with that you can do much more you
can do paging and what you'll also find
that we also provide little links in
here that allow you to help with paging
so assume you have thousands and
thousands of messages what you will pull
that down in one query but you've got
links in here what's called a next link
which is a prepared Oh data it hasn't
prepared Oh data statement which keeps
your selected things in here but also
allows you to skip ten and then work on
your patient so it's super super smooth
and then we added something here which I
love it was like a week ago or so so
what I'm going to do is is to sign in
because now I'm using this demo account
I want to use and see my own have my own
daylight here so if you go in and pull
up the developer console while in the
graph explorer and you type the
following token please you get a token
that you can explore and test with this
is awesome this means I don't have to
figure out figure out the SDKs to do
this we're going to look at that and
you'll see how that works and we're
going to look at how you do that with
HTTP requests as well so it's a great
way to just get that token and put it in
your code and get started this one's
going to work for about an hour so
you've got to make sure to stay within
that hour and then you're going to get
funky errors so what I'll do is just
carry on please copy that and to show
you that I know how to use fiddler it's
not really a machine I'll compose a just
pure HTTP request and you'll see what is
the graph Explorer actually doing here
so I took that token and I'm going to
just put in that end point class
Microsoft comm specify branch beta I'll
do me again and the only thing that I
really need is to put that pokken
authorization which is a very token Ally
that's not going to work
and now I flip them the barrier token
and execute the request it's going to
come back and that's the same data that
I got a bearer token is a token which is
like a movie ticket you can give it to
anyone else
and we don't really check who it is
that's using it and it's valid until the
movie has its back of you over so it
works in the same way so it's a good way
to get started you can get just grab a
token and then start pull up your code
in your favorite language and start
trying to make things happen so it's
good way to get started so I want to
ease you into this process of learning
what see what you can do I try to graph
explore get the token and then get
started in your code which is exactly
what I want to do and spend the rest of
the time with so I have nothing in here
in this little program that I have I
just thought that I went into an office
is a t5 tenant that I have and it's a
little boring it's all the parameters I
look into they're very businesses you've
got you know display names and all these
properties that are in the azure active
directory so what I thought is that I
would extend the schemas of this
directory and add some more fun
parameters to it so my idea was that I
would add a joke to everything in my
directory so every user and every group
is going to have a parameter which is a
joke it's a one-liner that you can put
in there which is going to make
exploring the graph Explorer and all
that a bit more funny so the first thing
I want to point out is that I have went
into nougat and I got the installed
Active Directory authentication library
it is library that allows me to sign
into that office 365 account you don't
have to use this you can use whatever
you want to use if you want to use it
all for short if you want to use
Microsoft authentication of library to
sign it out loud people is that or
Active Directory accounts as well you
can use that if you want to make your
own HTTP requests and for
os flows you can do that and we will do
that
the only thing I don't have in here is a
Microsoft graph SDK you could absolutely
just go in here browse and search for
Microsoft class and downloaded instead I
want to show you another way that I did
it
the only reason I did it like this was
because I wanted some more features
actually the graphs are open source that
are in github if you go to the
micrograph github repository
all yes decays are in here so what I did
was to clone it build it and then just
put it into my project the only reason
is because I went into the dev branch
and in the dev branch dev branch were
working on version one but 1.4 which has
schema extensions which is exactly what
I want to do I'm going to extend the
schemas with my silly parameters or
properties so to do that I just put them
in here and then I reference those so to
start off
I've got nothing in here let's go ahead
and actually get a little bit of a base
going so I want this method but I'm
going to run which I'm going to run this
in Kaunas I'm going to block it
beautifully terrible and in here we're
going to work in here
I'm going to first and foremost figure
out this indication and what I'm doing
is using the Active Directory education
library Adel and what's going on here is
that I'm putting in using this SDK this
SDK doesn't know have no idea what I'm
doing that I'm supposed to work with
Microsoft graph it doesn't care about
that the way this particular educate
works is that I put in what is the
tenant that you're trying to sign in
with I have an account in San Jose on
like SOUTHCOM so I just put in that I'm
going to sign in to this one and then I
say I'm going to sign in and I want to
token that token please thing for the
grass the Mike request and then I have
an application registration in that as
reactive directory which essentially I
just put in the ideas and then in there
I could specify anything because it's a
web view it needs to know when we're
done and I just said well when you get
to Emma's graph NDT also authentication
is done and I could put in just anything
in here and then I just make sure to
always prompt for a login because I'm on
my corporate machine and it always
thinks that I'm signing into my
Microsoft account which I'm not so I'm
making sure that I always prompt here
once you have that we can go ahead and
setup the microprocessor a client and
this is a way that we have been able to
structure these SDKs remarks of class
because you have so many different ways
of actually figuring out this indication
it all depends on what you're building
what can you do
are you building a headless solution you
have different properties and different
things that you can do are you building
a mobile app web app two different
things again that you can do so because
of that we can't design an SDK and it
would be foolish to design an educated
does it all
instead we allow you to pick your way of
doing it maybe you already have a way of
doing it and then just supply the result
of that into the graph SDK and in here
we just use a delegate to essentially
give you the request that the SDK is
about to perform and your job is to put
the token in there and we don't know
where that came from so that is the way
we go on about setting up every graph
SDK it doesn't matter what the platform
a programming language this is the way
you're going to do it and then you're
going to have other similarities as well
and next up let's go ahead and actually
get started I want to go now and get the
schemas that I have in this particular
tenant that I signed into the way I do
that is use the graph client and then I
have so many different things that I can
look into all pretty much many of those
things that you see can you see in here
I found schema extensions and then what
you build is a request it's going to
look similar in every language um you're
going to build a request and then you're
going to say all right you've got the
request what are you doing now I'm going
to get you could do more things like
adding is that which is a patching
oldest so that's the way to do this so
this way I pull down all the schemas I
then look at is there a schema with this
name micrograph NDC Oslo and then I have
some boring boilerplate code if I don't
have that schema well then I just create
that I create that schema with that ID
and I tell everyone to make sure that
this extension is useless it does
nothing and then I define how it looks I
have a name which is a one-liner the
pipe is a string what are the things
that I'm extending I'm extending users
in group so every user in group is now
going to have that property and then I
go ahead and just add that schema now
let's try to wrap this one up what I do
next is I want to then work with this I
have I have appended it to all the users
so then I go users I create a request
and what I'm doing here now is to do
this Oh data query I'm picking out
select but you can see that all those
old data operations that you can do like
filtering and expanding are also in here
so I'm saying that I want to display
name and I also want this particular
schema that I have created and then we
say get ready because now we should have
everything so let's wrap this up
we'll just loop it well look through the
additional data which is where that
schema data is going to be in
then we read that data and then we print
it I have prepared three users with the
data in that schema so everyone has the
schema but that doesn't necessarily have
any data in there if you don't put it in
there so to speak and then yeah so the
first thing here that's going to happen
is this sign in flow and I'm going to
sign in with a user that belongs to that
tenant that I pointed out and this is a
dolt doing its thing and hopefully my
phone is not going to break get ready so
now we've pulled down the users we know
what that data is so if we hit enter
it's going to look in the Simon user and
then it's going to pull out this one
lighter my software never has bugs it's
just a balance render features villagey
says unix the user friendly it's just
very selective about who its friends are
and the Finnish one is programmed today
is race between software engineers
trying to build bigger and better
idiot proof grants programs and universe
trying to produce bigger and better
idiots so far the university winning and
this made my tenants and my experience
with those schemas a little bit more fun
totally useless but for any developer
that goes in and pulls balanus data
they're going to have a laugh which is
my attention with this graph which is
the experience so in this one you saw
I'm using an SDK I've got a doll and all
that I've wrapped up in here to work
with that scheme and pull them down but
what if we had a little different
approach
so my next thing that I'm going to do
here is to assume I don't have the
Microsoft graph SDK available on my
platform or my language where I don't
want to use an SDK although I highly
encourage you to do because there is a
hiding seek champion which is the
semicolon that we all forget and then we
spend hours to find it and that's the
reason we use SDKs but what if we don't
what do they don't have it and what if
we don't want to use it but I still have
a told will have that active directory
an occasion library the reason I want to
show you this scenario is because it's
just highly likely that you'll be if
you're writing in an obscure language
that there is an ADA library because
it's been around for a long time the
able library has been worked on and
developed for years and they have very
good platform coverage but much of
classes decay is very new so we haven't
had a chance to get it everywhere
although it is and very many of the
platforms that exist in our mainstream
so to speak so we're going to start off
in the same fashion that I want to
create this beautiful runasync
guy and we're going to block it and for
this one I'm actually going to use and
be a little bit more sophisticated and
have some classes I'll explain what I'm
going to do what I will do here is to go
into the graph have a user sign in it it
doesn't matter what kind of user I'm
going to pull down that profile picture
and that could be a good thing for
anyone wanting to use that I mean if you
want to allow user to sign in pull down
their profile picture and put it in
somewhere it makes for a cool experience
it's personal and that's my picture it's
in your in your place without what I'm
going to do is take that picture I'm
going to sign send it to the emotion
api's because no session that this
conference is great if you don't have
machine learning in it everyone needs to
have some form of machine learning so
I'm going to send it to the emotion API
and I'm going to look into these
properties and see how angry do I look
disgust fear happiness and get a result
of that and then I'm going to take that
result and put it into my onedrive I'm
going to share that file and get the
link finally so it's just awkward back
and forth just to illustrate what's
happening and what's possible and what's
going on and how do you do this the
picture I think is is this one that I'm
going to send because I'm going to sign
into this account and then you'll know
which picture which is kind of like a
neutral picture and we'll see what the
emotion API is going to say so these are
meta helper classes it also pulls out a
face rectangle you know what when
Facebook knows where the rectangle of
the face is that's
I'm going to get here so to start off
I'm going to create whoops a couple of
methods and the first one is going to be
to get the set up so the gifting photo
method is going to assume that you've
got an access token and we're going to
pull down through Adel the difference
here has said was that I don't have a
grasp SDK so instead I'm just making a
bare bone rest call to pop will be very
familiar graph Microsoft comm I'm using
the v1 and point because I consider this
absolution to be very mission critical
to what I'm doing I'm pulling down me
and then slash photo photo has just made
up metadata for that photo you've got
sizes and stuff but if I do dollar value
I get the actual bits for that photo and
then I just pull it upward Lee into a
stream and then return the bytes next up
we're going to analyze that photo which
is using the emotion API in Azure it's
making an HTTP request I've got my key
here which is nicely hidden and pressing
to the emotion API which is located here
it's very straightforward on to do so
I'm just posting those bits essentially
to that API and then it returns me an
exact response which is going to print I
will see how angry I look and how I feel
how much fear I feel and how neutral and
sadness and all of that and it will be
your daily dose of machine learning
finally as said I will take that
response put it in onedrive my personal
onedrive and I will create the file and
I will share the fog and I'll get back a
link so we'll have this round-trip from
office 365 is emotionally guide back to
my machine and then up to onedrive and
let's go ahead and combine everything
which is doing the exact same thing I'm
using the ADA library same properties
all of that but then I'm taking out that
access token from the results and just
pushing that into
methods that needs it so that's the way
I could use this and do this without
having a graphic okay just make
bare-bones
super straightforward easy HTTP requests
to that endpoint super straightforward
let's cross our fingers because now
we're going to download images and we
will see how the phone is going to react
to this I'm going to use the same
account because you've seen that picture
so you know how to Lex but I could have
signed in with anything else here could
have signed in with in fact if I wasn't
using a dolt
I could have used the Microsoft with
some occasional library and then I could
have signed with this account and then
sign in with the personal Microsoft
accounts as well and that's a big deal
with Microsoft graph as well is this
entire thing of I don't care where
you're coming from let's just get to the
important stuff which is getting the
photos getting the one price I don't
care where they are I know that there
are fundamentally very different
services but let's have one place of
doing that because as developers it
doesn't matter I just want to bring the
features and functionality into whatever
I'm building so let's hope that this is
going to work
I've got a results it looks like I am
looking pretty neutral and and I should
have had a console.readkey there
oh well that works actually we don't
need to do this so I have a result there
it would be the numbers we're ranging
for one do two zero one being I'm very
sure that you are very angry and zero
being nothing is actually that's why you
saw very small numbers and what could
you use this for this could be very cool
also to be like say someone is uploading
an image a profile picture to your place
or you're storing that in the graph why
not you could give feedback and say what
profile picture looks a little angry
shouldn't you upload a more happy one
and fun stuff like that this was
actually not too bad because now I can
just show you if i refresh this one that
in here I have a funky file the weird
name which is a daytime tick and in here
is the response of that result that I
got from the emotion API so what I did
was just this funky run trip on back and
forth using the Microsoft graph and
again it didn't matter that this one guy
what this particular one drive was a
onedrive for business and let me show
you how that looks just make sure that
we can see this boom and then posting
I'm making awkward line breaks but it'll
work
so what I'm doing is I just make a putt
request and doing so to the drive I get
my own Drive and going from me to my
drive again don't care where that coming
from
I'm using the route and then I'm putting
in a file name and that file name is
defined just by the current tics and
then Flash content if I do a flash
content that is the file content if I
just do the file that's the metadata for
that file and that has navigation
properties to other uses users and
relationships from that file but this
way at this point it doesn't even exist
I'm just doing a putt request and the
grass is smart enough to figure out hey
you're probably creating a file so it's
taking those bits and putting them in
there and creating that file
what I'm then doing is using the same
name using the same path they're going
forward slash Creed link which is a post
request what I'm posting there is what
type of link are you creating it's the
same experience if you were actually to
go in there and click on share and then
you'd know that you'll have an option of
do you want someone to be able to edit
this do you want someone to be able to
view this this is the same thing you're
specifying is as a View link is it an
edit link and what's the scope of this
and then I just pulled that response and
then show the URL which is what you
didn't see but we could locate that file
and then the app and onedrive so with
that I want to get to the demo that has
your data which let's see how we do this
we'll do this the following way oh I
know when I miss
sweet well done here because I want to
showcase this as well
tada my flows so what I've done which is
what you'll see here let's just edit
this so we'll soon get to my very poorly
written red X but so far what happens or
what I wanted to do is to illustrate yes
sure you can create files and do schemas
and do pull the user but it's all kind
of basic how did can I actually go so I
want to show that how specific I can be
using the Excel rich ap is um when you
posted the tweet
I created a Microsoft flow the maximum
flow is sort of like a work flow
platform that allows you to build these
steps where things will kind of flow
through the starting point is the
following one when a new tweet is posted
with hashtag Microsoft graph and that
this search text is a little bit more
let's say sophisticated than what I'm
doing down there I could probably just
do hash tag Microsoft graph with but I
wanted to show that I'm fancy and I can
do a condition in here so what I do is
once the tweet is posted the tweet comes
into the next step with a condition and
I've got all the properties of that
tweet URLs and names and all that stuff
so what I'm saying here essentially is
well pretext if that contains with and
this is where you could go into an
advanced mode and do like lower case and
upper case and stuff but I got scared
then I got back into the basic mode and
then I forced you to stay with lower
case with also to not break my reg ex
and if this condition is met it'll go to
the yes stage the yes stage is an HTTP
request that goes into an azure function
that I've created what it does is just
posting a post through that function and
it uses I built a new request body that
has the tweet text and who tweeted it
and I also pulled in some super advanced
securing on this thing I will not forget
my password anymore if I do I'm stupid
so make sure that this this community
is solid between those things and so
that's contacting an azure function and
as your function is essentially its
business witnesses the other bus thing
right this is the server less compute
this is where we were able to just
upload some piece of code and then have
the cloud take care of running that what
it has is an HTTP trigger so it triggers
on an incoming HTTP request which is
what we're doing we're sending an HTTP
request and I've got mace - DP result as
well as an output so I'm just responding
essentially with the status code and
saying that I'm okay which tells
Microsoft row that I'm happy and then I
also wanted to make sure that I'm super
cool with knowing what's going on so I
made sure that selected HTTP methods
that are allowed our only posts so
because I know that's the only thing
that's going to happen so the code that
I have in here which is loading can I
have syntax highlighting is a JavaScript
world on I chose to do something else
because I also know that JavaScript is a
big one and this case is interesting
because in this case I don't have any UI
I can't have a user signing ends so how
on earth do I get an access token well
in this case we need the application to
sign in and we do that that when I
register the app in Azure ad which is
one place you can register you app you
can also register your app at identity
Microsoft comm which is more easily you
don't you can sign it with anything but
when you do that you get a client ID and
a client secret a client ID and client
secret is sort of your applications very
secret credentials so here on exposing
everything I own
by showing you the client secret which I
totally have to change after this but
that's
a good example of what would you do with
your building is server solution that
doesn't have it doesn't have the ability
to show any UI so the first thing that I
do because there's triggers on HTTP
requests I know that there's going to be
a request and from that request I grab
the body which is what we created in
Microsoft flow I log it and then I
create this little data variable or
constant which has familiar properties
what I'm doing here is exactly what the
azure a build library was doing it's
saying that you've got resource glass
you got a client ID you got a client
secret and then I specifying grant type
which is what is the way that you're a
cynic eating and if I was a signing in
with user that's a different that that's
what changes the way you're signing in
then I use the library access to to post
that to the following endpoint which is
this ID could have been Simon J on
Microsoft comm this is essentially a URL
to my office 365 directory because I'm
trying to sign it with account to that
and then the OAuth token end point I
will stringify that piece of data and
won't let me go
I have scrolled let's do this and now
I'm done I've got that I'm assuming I've
got the response and in the response
there will be an access token and now
I'm doing something very familiar Here I
am initializing the glass client by
providing well not a delegate really in
this way but I'm providing here a little
lambda expression that does sort of the
same thing it provides the result of
this indication I don't know where it
came from
just give me the result and this is the
way you do it now you've got the client
ready and here comes my terrible regular
expression that I've talked along that
which is what I used to pull down the
language that you you put in once I have
your language I know the three content I
know who tweeted I put in a date to this
and of course I put in the language in
here now I want to put that into the
file I wanted to add a role in the excel
sheets so in this case I'm being very
strict about where that file is but you
can obviously do queries and look at
into what users and files and see where
that file is but in this case I know
that it isn't this user remember I sign
file and notice how far I'm going here
thank you
notice how far I'm going here I'm
drilling down to that user I've got the
workbook I've got the worksheet I'm
dealing down into the sheet and then I
found the table and I go into slash rows
and then it's normal rest and crud
operations to whatever you want to do
here and that applies to anything in
here is it user is it rows is it
anything in between you can work with
that as you're familiar with so doing
your regular post up and gets them and
put some patches and deletes it works
here so what I'm doing is now that I
constructed this eight URL I will be
posting those rows there and if I had
kept the logs running you would have
seen that all those tweets coming in
here but I forgot about that now I don't
fully trust this one because it needs to
be refreshed but I have a few missing
here because I know I saw more um maybe
you messed up my reg X so again here are
at least a few of the tweets that I was
able to catch so bear in mind it's me
messing up and the flows and the reg X's
if you do it right they'll all end up in
here so in here are those parameters
that I just put in here and then it gets
keep they get to keep being added and
what I love about being in here is if
I'm in here and I'm editing in my
browser it's so cool to see that it's
going to actually say that hey someone
else is editing in here we're just going
to freak you but that's your API calls
also working in here so you could have
and build pretty cool collaborative
experiences in here
with services starting to work with
data and do things and and it's really
super cool and then you can do what I've
done here which is just apply charts to
it and have things happening what you
also can do is take those charts and
pull them down and use them in your
solution so you could just keep an excel
sheet and some form of computing power
and and chart engine and pull those
charts into your solution you can also
use those functions and have excel here
perform them those functions for you and
you could use that all oh yeah everyone
pick C sharp I thought I totally broke
so you could really use all those cool
features and the reasons why people use
Excel pull them into your solution and
use them there's nothing stopping you
from doing that so to end up or to
finish up and wrap up you've seen a
couple of demos quick demos and
different scenarios and again I said
you've seen it once and now you should
sort of understand how it works in
whatever you're doing so I'm doing
something crazy here like I'm writing
something and go I don't have any
language of SDKs in this case well you
can do this get that access token the
same way I showed you the JavaScript
I'll go out and make a request and pull
down users and do the things that you
want to do and the similarities if I go
to something else which I find scary
like Ruby well here you've got libraries
and then you have in this case this
sample is a server solution you've got
libraries in this case and I'm doing a
server solution which still allows me to
do that credential grants flow but I'm
doing it through the library so I'm just
applying the IDS and secrets and all
that again so there are similarities in
here and you know the structure but yes
you are keeping the flavor of the
language so notice for instance which is
something that a doll is doing as well
the way that we work with this
in Ruby is not something that we could
something that we came up with it is an
expected way this is how I expect
libraries to work in Ruby the same goes
for c-sharp with for instance is sync
keywords and capitalization of the first
word and in JavaScript you expect
something else we keep the same
consistent primitives for you to make it
easy and the takeaway from this is is
grasp Microsoft I oh it's your one-stop
shop to test see what you can do and
find little things that you can use in
your solutions to make them better to
make them cooler and create little while
factors or just offload stuff to make it
easier for you it's all out there
it's only for you to just grab and run
with so with that I hope you had a good
time I hope you'll learn something and
enjoy the rest of your conference thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>