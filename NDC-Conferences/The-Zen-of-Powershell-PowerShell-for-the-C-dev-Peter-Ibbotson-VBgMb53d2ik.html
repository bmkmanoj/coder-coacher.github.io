<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The Zen of Powershell - PowerShell for the C# dev - Peter Ibbotson | Coder Coacher - Coaching Coders</title><meta content="The Zen of Powershell - PowerShell for the C# dev - Peter Ibbotson - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The Zen of Powershell - PowerShell for the C# dev - Peter Ibbotson</b></h2><h5 class="post__date">2017-02-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VBgMb53d2ik" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay alright so I'm here to talk today
about the zener powershell it's
primarily a guide for c-sharp developers
so a little bit about me I'm a c-sharp
programmer I am currently working on
energy trading in the city we sweat with
pensions until George Osborne screwed
that one up my main use of PowerShell is
to deal with C ICD and historically I've
used emissaries management now wheezing
all the tools I'm not a powershell
expert I'm a thief oak so I'm not
brilliant to that and mostly this
particular talk is all about confusing
stuff for c-sharp developers Twitter IDs
there and eventually I will be tweeting
the URL of the github reports it got all
this stuff in so this is important and
it's kind of start PowerShell and this
probably is one of the little bits which
if you know this already great if you
don't it's quite important distinction
for those of us who look easy for those
of us who start out from C sharp so my
next trick is okay good you've been to
slide three great there we go
I've got obviously that okay I'm sting
snow probably a bit bigger yeah I'm just
I'm calling out to a bit of neck here
and if I run that I get a message box no
big surprise there
so what I think going to do is that my
programmer so I'm going to tear this
intro function general the core message
box and I'm going to put a dollar
message dollar title in here as
parameters for it
we'll put a cup of curly brace fit in
and right nice there and what I'm then
going to do is I'm going to call it down
the bottom is here now there and for
this bit here when I say dollar message
of dollar title okay so that's going to
call my message box I'm going to do that
I gave this POW shelf been trying to be
helpful here and what it's done is it
said mmm well actually when you passing
into power shell bash of a shell
so remember the parameters are not
separated by commas they're separated by
spaces and in fact what happens in
PowerShell is if you put commas in it
says ah it's an array so what time
she'll is done if it's taken my lovely
array are passed in and then said well
you want a string so I'm just going to
coalesce all this stuff down and just
turn in join the string together for you
because you pass in a string of a raisin
you probably just want to join them
together so one of the things you have
to be very careful of in PowerShell is
that now the other thing is because we
are in a prime at the base situation if
I slip these round so first and run like
that and the final thing is at this
point starts to make a bit more sense
because now you I can actually see if I
put some minuses in but really here when
I'm calling that function I'm really
calling something's a bit more but
command line parameter so you know as a
special to command the parameters you
put minus in front of them okay so
arrays a comma-separated basically you
don't necessarily to put the bracket
around the outside of the mesh you're
trying to prove them are some circuits
that we may need to put a bracket round
for us for priority versus calling net
code these parentheses somewhere and
then if you look in the PowerShell
perspective in Section seven point one
point three that's where it says if I
suspect the reason why this happened was
when they initially started somebody
said well how we gonna call net and we
said well we're going to call method
info dot invoke what does that take that
takes an array so that's why I think
somebody said well what bracket around
book commas in I can't actually think of
a good reason why when I look down
syntax charts whether actually happens
I'm fairly sure what calls method info
to invoke the coding core adapter dot CS
and it gets a bit convoluted so be quite
sure about that so in summary dotnet
methods put brackets put commas in
PowerShell stuff basically particular
the spaces in okay so on till next slide
returning stuff well that doesn't do
what you might expect so here I'm just
going to go to a simple example let's
get the mouse on the right screen there
we go good
I've now lost my headset this could be
entertaining
yeah so I've got a little bit of
function here I've got it's got two
functions of the top one which is
multiplied by four when it was about
five and a little test a function here
that does look surprised those and then
it's got a return statement at the
bottom of it so if I run this what
happens is the output that comes out is
all three of those down the bottom of
there and those three items illustrate
one of the problems with Ned with throw
with PowerShell which is this the return
statement here puts things into the
output pipeline now for PowerShell
functions what they normally return is
then always fact things up into a
pipeline on the way out and the proof
line which I can show here I say the
Loray equal to that which got a equals
has more like it if I say got a don't
get type one that if I run this won't
behave you can see basically the output
pipeline which is what comes out of a
function against basically when you pipe
things together it's just an array of
objects so it's not a bit quickly
special about it personally I think for
the return statement should not have let
the expression stay on the end it's just
confusing if you use the dotnet stuff so
there are two ways out of this one way
out is do an assignment so if I slightly
or if I find something outputs or sleepy
let's how if I'm in 2d so if I sign it
into a variable the other alternative is
to do this and pipeline the output of
that function into the middle and then
if I run it oops I'm not she displayed
funny
so let's display the party
Dondre there we go if I do that I get 36
back so it's a bit confusing it's one of
the things that people go all I want to
return the value back in the promise of
one of the earlier things left something
on the pipeline there's a really weird
results from it back out
people get strings appearing all kinds
of things happening so the slide the
output wasn't necessarily what we're
expecting so return just puts the output
on pipeline so everything else and still
there stays there stuff that isn't
assigned to or gets piped to out null
gets the output pipeline quite a bit
more on pipelines later on the talk so
now we're going to back to commercial
again for a bit of stuff about writing
things to the output that's one that's
going to go
Oh
thank you
get the right slide the end better
vo okay so this particular bit here is
I'm just showing there's a couple of
functions you can use one of which is
right to a house wall which is write
some output out to the outside world and
the difference between these is I'll
show you the difference actually I run
this down bottom edge let's hello there
world it's what I can do interests if I
say here dollar a equals test output and
as they right host not a and run that
what we see is that there's air is move
so basically right host right things up
to our house to choose cases of power
shall I both eyes and because of and
write output rights values into the
output stream so it's a difference
between two pair of them and some people
use them interchangeably there's some
other types of rights was right the bows
right information write debug write
error right progress which you can use
for progress bar so I'm just going to go
back to how shell and in here I'm just
going to put in with La Colonia right -
both which would help like a type
young folks I'm gonna do light of a
debugger statement okay so if I run this
I don't get anything and there's a
reason for that the reason is that if I
go to the bottom here and I'll just kind
of in dollar villalobos preference the
verbose preference we currently have is
to just slightly continue so it just
sighs we continue on and doesn't do
anything with the output there a couple
of ways around that I could assign a new
value to it which should be continue up
here the other alternative is something
nice and simple at this is if my script
takes parameters let's not have the
primitive block like this where you
define what they are one things I can do
is like states got commandlets binding
as an attribute like that and what that
does is it makes our demo pass plans
various values from the command line so
one things I can now say and here is
stop backslash like demo one and if they
do is the boast mode that's better
forgot to say that got mistaken
right now vote no they get their votes
bit in there if I say - debug I also get
this little debug pop-up things on a
continue with the operation so there are
so it does help so you put command let
bindings on it also means you get a lot
of these verbs for free and as part of
other ones like error scenario handling
want and you also get a lot about
information a lot sort of is big
otherwise you have to write something
the positiveness the various internal
preferences so I tend not to do that I
tend to put the parameter one on
it's an awful body here most of the time
right so now for the fun bit I want to
do a bit of pester so before I go there
what I need to do is mouse back away
just excuse me just a moment you can ask
the visual studio I have installed on
this machine the visual studio
PowerShell extensions so I've started a
little project here or does it rename
the file doesn't do a fat one else so if
I go over to my solution and doing add
item on there add a new item so one of
things I can do because I got in there
is I can say I would like to pass your
test believe okay and by convention the
test get named the same as whatever
script says you're going to be testing
passes of some sorts find it a bit easy
to work with if you keep the name of the
same scope you going to test so I shall
add that and here I've got a lovely
script okay so what I'm going to say
here is this cup here well what I think
I want to do is the 1rg check what's
going on
describing context are broadly speaking
the same sort of thing described wrap
the outer layer of the test for some set
of logic context wraps usually your
mocks what if you're going to create if
you want to share the moments multiple
test context of the pencil out the test
bit rename the describe density out of
it so in here I'm just going to say well
my context is I don't have a Texas says
that rename is called okay and one of
things I'd like to do about that is
another farming and I'm just going to
say it's econ by first temp that first
test objects
I want to mock item okay and my mock is
going to be I want you to mock rename
item please
it's the thing that renames in
PowerShell okay when it runs I would
like to run my script got renamed warmed
up PS one okay and I'd like to pass
parameters to it - pass dollar filename
okay and the other thing I'd like to do
is want this actually been called I'm
sure we all well I might say assert that
the mock was called okay so let's say
that my rename item mark and I can also
say at the end of here
some parameter filter bit and here I
could say well dollar pass is the input
parameter
Norman's your rename item self and read
all the farming and I got it wrong
because I've just pardoned equals in and
what actually sit is a minus PQ because
we're in a shell language and greater
than less than pipe things around so we
all know that - and let me just make
sure I get this right it's got a new
name equals I'm just going to put it
here the slash temp flash test block
text and I will now put in because I
forgot again there we go okay so if i
run this oops
in climbing to that I'm going to go back
to the test explorer here and I should
test plugins if I run that test it fails
it's not recognized so there is an issue
which if we go into there's a PowerShell
interact with Windows I'm going to match
the right place there we go
that's where my test is running from
it's running from that folder there so
I'm I'm Scotto completely different I
need demo I'm sure I'll do this too
close your eyes better be quicker right
so one of the things I can do in here is
the little helper that we get which
which will create as a new tester piece
if I go into demo and I edit my test you
may notice here at the top of the script
for pester it by default it puts in
bowler here which pulls where the
current path is and then here it
actually just loads that script in to
memory before it's call through says I
just need that line there and I'm going
to get back to have one
we go back to here I'm going to just
click on their Scrolls a bit drop that
in there and then I'm just going to say
set locations to be dollar here okay
I'll put that dollar in front of it all
right and now might be probably going to
run with the look actually you've saved
it well actually my test doesn't run
they failed because the mocks not there
if we looked at the code you may
remember there wasn't a fat lot of it
there okay so next thing we can do is
cheat so I'm going to go off to my
little git session which you can't see
and reset the world and make sure a
picture tracks fine there we go yeah
reload the world so now I've actually
put some script together in here I've
got four couple of parameters about one
part throw the path it's mandatory I've
got it oops we failed flag I'm going to
call rename with a try-catch around
because we're renaming stuff and that
does occasionally fails another person's
got something open or whatever then I'm
going to call so here we call the
function and if we fail we write
something out the output path there we
go so it's not the world's most
complicated thing if I go back to my
test Explorer again and I run it all
hooray past great so no real not a huge
surprise so the next thing I want to do
is well that was nice but we're running
with a mock object and so one of things
I actually want to do is I want to save
great I'll do with the mock warm I want
to do with a real one and pester helps
us with that it's got a lovely function
a lovely think this is for the lifecycle
of my context it will make me a new disc
drive called test drive
thank you so she'll now go away and
create a new item
she isn't my file name okay and you give
it files and keep it tight so the anta
type is going to be the file and I can
go at my mocking line because I don't
need that anymore okay
I don't definitely want to assert that
my mock was cool because there's no more
bets at all and here what I want to say
is well okay I've done all of that so I
want to say dollar file name dot back
okay well the way this works is you use
pipe and pestle and there's an assertion
function which is called should and what
I can then say is that should exist what
I can also say is well that's great
so a filename well that should not exist
okay so X is reasonably powerful and
that respect if I run all the tests well
it's on annoyingly my test is failed now
the reason why I take is so we can come
back to in a minute I'm not sure what it
is so what I'm going to do or I'm going
to attempt oh ok well some of the
problem
let's fix that up before we go thank you
that's not the problem cuz we never got
there and so I'll come into here and one
thing I'll do is I'm not sure what's
going on so I will just say in here like
the both we know me $2 new path I put
that long place a have a bomb on okay
and I'm pretty sure we're probably
getting an error somewhere in here so
what i'm gonna do here than a day right
for the boasts go I'm just going to say
error and so underscore a dollar
underscore is basically the exception
that we just caught so something got put
on the pipe which is an exception so
dollar runs for the things on the pipe I
thought we need to display out so safe
that way back to my test and one thing I
need to do on this on the end of here
I need to put a minus for both because
otherwise not going to see anything and
then if I run all the tests
well that's better and I get an error
which is coming we don't specify target
rubycles represents a powerful device
name
well actually I know what's wrong which
is that rename here in this particular
chunk here should not have still a new
path in it with a dot backing because
I'd be all the pathing stuff in there
that's what I actually want to say is
got a new name equals quit path and I
want to say it
dollar new path is willing to split I'd
like the leaf off the end of it please
okay
and Pastora you name on the end of there
and if I go back to my test up here so
this is going to screw up this bit over
here so I want that to be test up text
box so now no packing there right so all
of those right well that's good news
both just passed and one thing we might
have noticed wasn't so didn't feel like
why the hell does one get my failure
thing running around so one things I can
do back to here I need to be in now
she's not for me and you just go back
this one
you see
you're just going to be funny on me on
you today alright okay I don't think I'm
going to work from there
I would like to go back to pester and of
course you pop up on the wrong screen
that's not very helpful thank you go and
then see wonder
like it yeah so what I wanted to be in
so one thing I can say in here is I can
actually say invoke Casper from the
command line here today - code coverage
like so and if I put my script name in
like so it will run it and it'll tell me
well 70% of things didn't actually
happen in here and in particular the -
that didn't happen was my right for
BOCES for the error handling cases and a
bit where actually got the failed out of
it so one things I can also do is I can
about the script analyzer
okay and it says the variable failed is
a scientist never used so at this point
here I need to do a little bit of
talking about scope now come on behave
but probably on the wrong ground come on
the wrong branch sorry guys
didn't help me okay that's good let me
go provide all the lenders there there
we go I've got some code here I'm just
going to show one problems with scope in
here if I run this I don't get what I
was expecting to see really because I
was rather hoping that this assignment
here a magic number would change the
magic number down here after my tested
and run and the problem here basically
is when you do an assignment inside a
function we get I need to put script 2
colon in front of it like that
at which point I'm setting the scope of
the variable I'm setting and this is one
of those things again that is kind of
weird that uses the actual doing
assignment or something
create your local variable so you just
to watch out for that one and of course
it can be quite subtle so it's not too
difficult to fix
okay so we'll go back to your studio
over here yeah I want to reload
everything thank you very much okay and
one of the things I can do here is I've
got to test down the bottoms here my
error handling so here I'm just saying
well for the mock they can throw
something if it runs they should be it
should have as in the output should have
be like failed and I feel nice to make
sure that my actual service call so fair
side that locks nothing to do that meant
to run the whole test so here tonight
like oh hey oh well that's probably
because over here well hand them is I
need to put script kill one in okay I
run that it's really good they all
passed so yeah amazing just about
schedule what do we learn the pester
arrange if we say pets has got an
arranged act at the cert pattern on it a
range is describing context group test
and gives line so call for things like
marks and local variables acts well it's
run the command assert well should it
should those lots of the associations
we've got assert call which can check
for calls out to your mocks the optical
things are a test drive provide you with
an isolated filing system it does leak
so when you do a directory you can
silently before PAP temporary pass
script and Liza can get some useful
information out for you variable scoping
can bite you with script download is
configurable and you can get code
coverage from your test that's worth
doing sometimes just check that
somebody's actually got decent error
handling in unlocking objects can quite
easily force errors one of the problems
with mock objects is you can only mock
PowerShell objects you can't mock net
ones
so that can be a bit of a nuisance you
might just wrap them up so the other one
is pester does not compare collection
types well in fact PowerShell them doing
very well either go to this site here or
use them users to install modules tinsel
to the PowerShell gallery I'm going to
use one of those later on
so 2016 a very bad year for celebrities
like several people died maybe Barry
George Michael
Carrie Fisher died Prince died and this
guy died you probably all know who he is
he's actually quite famous barber and
that's photograph of him yeah five or
six years ago guy called dick Brad salt
and originally my talk was going to be
on later on the afternoon on Friday and
we did create these cocktails a espresso
martini bramble treacle with all the top
two of those are actually in the
International bartender association
cocktails competitions the espresso
martini was created allegedly and a
rather famous model came into the bar
that was working time said I wandering
to wake me up and then admit allegedly
Kate Moss but I'm not sure I believe
that to be honest with you
so those top two are in there and I
thought right I'm going to cocktail
based dinner because I want something
has got it some pieces in that was on
late on the afternoon I thought it's
fine definitely I should have find a way
to get some ice from so I'll make a
cocktail I'm doing the demo all for this
jeong's geek it's famous for drinking
girly cocktails and there's a picture of
him with a girly cocktail so I think
it's a legal company here okay right so
I'm going to cocktails and sort of a
semi homage to every master chef thing
ever
cocktails three ways so I'm going to
talk to my cocktail stuff do it three
different ways so back to the bed of
github let's put your get live it's on
now once exactly that way around there
we go
excuse me here I'm looking around
branches it's pretty good okay so like
this I'm just gonna so I'm mouths where
have you gone there we go better right
okay so how shells great not too bad for
talking to the recessed our web services
sometimes the syntax gets a bit clunky
but it's okay in general so the first
thing I'm doing I'm going to quit cert
I'm going to create a proxy for my
service which is talking to this URL
over here it's running on my local host
I've got a cocktail web service I wish
it delivered cocktails it doesn't it
just delivers ingredient lists and
recipes
- craft cocktail well this gets compiled
into an internal dotnet class you can
get some really strange error messages
out of PowerShell because that's dotnet
class lives around for quite a long time
and it gets both port number and the URL
into the class name and if you try and
swap puts what what you're talking to by
rerunning that you can end up with the
same a no sorry but it's crap already
memory I'm not whatever right you for
you anyway so thanking will do get some
results so I'm going to go and get
depending on the gradients here and I
put a little app in front of that
bracket there which has turn this into
an array so I'm passing in an array of
ingredients with names of ingredients in
and it's got tell me what the heck I can
bake so let's run it I can make Negro
needs in Americanos which is true
although it's written speaking of meat
and soda water make Americana
so other than that that's great on
things that's a now's good
unless so one thing you may have noticed
is that I'm tended to use single quotes
and double quotes pretty interchangeably
and that's probably didn't explicitly
points out maybe or do you know but with
in PowerShell if you put double quotes
around it it will do a variable
expansion for you so I'll expand the
results out there just are launched from
that one and look to make the grains of
the motor count it's not really moved on
to chart here so I'm not going to get
out the bottom here I'm going to do some
more pink so the first thing I do is
want to get a recipe on state dollar
recipe of course dollar service dot
which other foot at the end of it
dot it's got a load of stuff in here but
I want to get a recipe ok I haven't done
recipes text strings which is the very
handy this if I say stolen from that
dollar results and put a zero there and
I do that and then I see what my dollar
recipe looks like well it looks like
that and as you can see it does have
these god-awful ingredients bits in here
and they look pretty horrible it's had a
pretty good go at displaying it but it's
not doing your great bits it's not doing
anything great here so one things I can
try saying to it is let's see if it does
a better job if I say well I'd like you
to look at the ingredients please and
then I want you to point the output of
that through format table which will
display a pretty format for me and again
that's not great it's a web service so
again we've got kind of amount and
amount specified have sort of leak
through from my abstraction because it's
not able so
that wasn't good I can do some fairly
simple things so if you've got
reasonably sensible things you could say
I'd like to see amount unit and the
ingredients like so and then at least I
get a table that sort of got just a bit
so I was actually interested in but I
still got the problem of that now one
things that one without this because if
I note tie it up there you go
so together it sounds good my mum and my
palace I didn't want Iran to PFF ative
mistake
better one thing I can do is I can
assign it to a variable know what I'm
doing here is I'm creating an array
because commas in it which thing
contains some hash maps which then
contain a couple of key value pairs in
there what was the expression so I put
the amount out I put the label out xa if
the unit and then for my ingredient here
and bowler underscores has means the
current item in the pipe I can get it to
do ingredient name so I'll run that and
again come back to here again and if I
say those my ingredients now all I have
to do for that is they render since they
see in format ingredients on the end of
here and now I get us into looking lists
coming back out the far end of it so
that's probably my recommendation if
you're doing something where you just
trying to get sort of sensible looking
list back at the far end the original
the way doing is going to come out of
that later on
okay so one two three four five right
I'd converted this into something is a
bit more sensible it takes a couple of
parameters on command line so it does
put it passes those out for us it writes
the recipe out and then down the bottom
is here it calls thought service with
some results on it spit the results out
get the recipe write the recipe out to
the outside world so because I've got
parameters on I'll need to do from the
command line going back here so I'll say
dot cocktail five Cs one and the server
name will be the local host and port
number
we'll be so sound right I'm not sure if
you can read that here it says at the
bottom of here variable reference is not
valid was not followed by a valid
variable named character consider you
dollar curly brackets what the heck's
going on here what's actually
interesting is this bit down here with
this invalid variable reference with
drive now one of the things you may know
about URLs is they've got colons in them
one things about PowerShell is my $2.00
ends for the environment when I put
dollar and a cone in it does a lookup in
that environment variable so we use
cones who look at some hash maps and
things PS drives which is what dollar n
is in this itself so they get PS PS
drive that lifts all the drives that are
on my system my PowerShell environment
so we've got things like the AES so if I
put an alias in for clippings around sir
which is certificates n functions and
you may know down the bottom there HK
see you which is of course my registry
so if I go into my current user registry
I can do a dir in it I can change
directories I can do lots of things and
most of the commands which are calling
new item to create a file create item
all those sorts of you can run all of
those against the registry nervously I
look like the Caesar I thank you very
much so it's quite useful to know those
are all there so we'll just fix that
I'll take the suggestion and I'm fairly
sure I'm running PowerShell 5 because
I'm running Windows 10 I'm fairly short
early versions of PowerShell had much
worse error messaging on this and didn't
tell you it gave didn't tell you what L
to do so when I first started out this
was just irritating you think we'll come
back down to here I'll save it first
come back down to here
because there's a lot here we ppppp will
run that and hey presto I've got my
recipe for a Negroni down the bottom of
here
so next thing I can do
right I've got it fancy you now I've
split this stuff up I've got a function
which says get things by ingredients
I've got a function which here takes
like recipes in and down the bottom of
here I've got this where I'm going to
call get ingredients so these things
here are taking parameters from the
pipeline I've got another recipe wrong
down the bottom here that one derives
you to get my recipes so first thing I
need to do is ripped off this attribute
here I'm good that's my recipe one here
where it's got a parameter which is
cocktail name and put that tribute on
there so that basically says cocktail
name is going to come from the pipeline
guys so there we go the next thing I've
got is free time to mix so that but each
time this gets put on the pipeline begin
gets called first process then gets
called second once price and the things
on the pipeline and that end gets called
at the end of your list and clean up
stuff so in my case when I fly this bit
up
I let young at a service such as the
proper tool for doing that for cleaning
it up and then down here in my process
one I would like to say thought script
service get a recipe for tab thank you
my cocktail me okay and that will get
the recipe because I'm not finding any
we're all going to the output pipeline
so we come down to here so this goes get
the ingredients for my list of
ingredients which you'll put the two
recipes on there with em pipe it through
get recipes this gets called once to set
it up and then for each of the two
cocktails that gets called and then we
call right put recipes and I just get to
everything else pressed into it so if I
run that I get two recipes down the
bottom there you seethe an emoticon
under your growing scrolled off the top
so the final thing I want to do is
I'm just going to invoke the
stripped-down laser on this cocktail
number seven and see what it moans about
so the clan looks really should be
singular according to this dollar null
should be on the other side of the
equality I'm not even going to bother
fixing those we've run out of time if I
do that so that's a bit of PowerPoint
again I've done cocktails that way with
the web service there was a long section
of talk though I convinced it into a
PowerShell module stage at a time not
gonna bother I have already got time for
that all I have got time to just do is
get out Mickey Mouse come on behave I'll
go that way around I'll do
yeah we load everything I shall do is I
want to open recent projects and
solutions when I would like to open this
one becomes LPS n1 and so we're not
going to eat image about the other bits
and pieces I've got a test here I'm just
sort of the statistics book on that
system and I can't see if a looking
front that we get that song I have got
to test if I run this test it passes
which is wrong because by now I should
we should all know that this lot I
picked up two cocktails so here this
particular bit is now incorrect so I can
fix this by using the match array banded
okay which basically says which is one
of the install commands for the bit of
cellular on petals and get this right
and the other thing I need to do on this
side here is only to wrap this up here
like that to make it into an individual
item and the most important bit is a
comma at the front of the line which
basically says instead of taking the
array because PowerShell and expand the
route and single items to put passes on
the pipeline
don't do that wrap it up so our pipeline
contains a single item on it which is
the array so it means so it's wrap the
array in the rake so we've got two
dimensional array here if you don't do
that much of a when do the right things
for you and if I just run all of those
now I actually get a much more useful
error and if I just scroll back up a bit
I'm sorry and boundaries not about you
operator watch
that's was not unbounded unordered I
don't know why is it amounted unordered
that's better trying to get there we go
should match array unordered and it's a
it's money about facts got hello on the
end of it and if we scroll back up a
little bit here it'll actually show that
here missing the item hello
so if I just delete that just for some
C's sake run it again it's a PowerShell
module you can see here the top we're
doing but with you loading it in and
that's into that one so that's no real
fun so then all that and on its page we
will go for you oh right and I'll stay
impartial yeah we know
I want to let my cocktail finder so this
is actually the solution for my web
service and one of the last things I
want to do with this is I will actually
take my web service and throw it away I
don't really want a web service I've got
a perfectly good dll so why the hell
then I call it instead so to do that I
create a command lit I inherit from PS
command list attributes say what it's
actually called so get goes in front of
it and some common verbs like you invoke
an update ingredients the name of the
one I'm going to do it processes a
record in the middle of it I over ride
that basically I just read them in and
just write all the objects straight back
out as a pipeline so just grab a
linguine it's weakening smashing
straight back out again
I get recipe over here it's a little bit
more complicated not hugely so but a
little bit again you inherit from PS
command let's parameters on the command
line go in here is properties I've set
both of these as they come from the
pipeline so you can either pass it a
list of names or you can say get you can
pass it a list of ingredients and
they'll get the right one filled in for
me a value from pipeline by property
name we'll come back to in a bit so I
begin protesting here I'd base in there
I could just read it read the
ingredients in when I process the record
if it's a name I do a for each on it and
write out the objects if it's in stock
then I go round to there and write all
of those out so that's my bit over here
I built that
build that's good I'm going to go to
here okay and if I go back up one and I
go into the slide 30 yes it is good if I
edit this PS edit Unthank slash alcohol
it cocktails right so this imports my
module in are then called get
ingredients and thanks for the power of
the pipeline I can say go away get aware
object where the alcohol by volume is
greater than 30 because I want to find
out what all the value cocktails are the
ones I've got lots of our colleague and
I think all get recipe and I'm passing
Regents in here and I got a pile
colleague into it okay so if I run that
unfortunately there's only two of them
that have got that in and the reader
status most the moose I've got an
alcohol by volume about seventy percent
in them and they tend to get used a lot
for flavoring if I run it now would say
ten I get quite a few more I get big
like martinis as well so just going to
put that back to the particular item I
screw the world over a bit so down here
I'm going to say right great um I've
done all that I've shown actually does
something I'm going to create new
variable called dollars Negroni which is
going to be yet recipe and that's going
to take Negro me good okay so if I
display that dogs it rubbish yeah so do
the same thing with salt ingredients
looks a bit rubbish okay one of the
things that's nice about a proper a
proper PC sharp project one is I've got
this format thing in here and this is a
XML formatting file I'll just go to the
top and here I can say well if the type
is cocktail ingredient with quantity
format it like this for a table
any reciprocity name is item proximity
unit and here I've got a little script
lock in which will look up the
ingredient name because it's not a
property so I can work my way down a bit
further okay and I've got another one
down here for the cocktail recipe so I
go back into my IDE over here I have got
a little helper thing that reads that
for Mac in just display it quickly it's
not doing a lot especially calling that
well there it's the last phantoms work
to type in and if when I now do is have
a look at the ingredients hey presto
I've got my table back again if I worked
at dollar a Negroni well that's not so
great I've still got this problem of the
ingredients bits so my next store was
well maybe I'll get lucky and here we've
got cocktail and recipe PPTP DDD I've
got soul ingredients here so maybe if I
just pipe that through for that table
I'll get lucky and my table will get
formatted nicely for me so I'll come
back over here and I'll do an update
format on it and I know this opposing
Negroni no and it's worse actually many
ways because now it's gone from being
something I might be on some type of to
pile of internal point formatting bits
and pieces so I will now go back to your
studio and in fact I'm now going to put
on the end of here I'm going to point
that through out to string because now
it's going to be a string if I do this
over here I'll just might update the
format again and now if I look at mine
they grow me I get a reasonably nicely
formatted list where I put the table in
there now this is important this is a
nice and cheap and dirty hack if you
read this if you go and run to this what
lots of people say to do is you can
group things by path and there's a huge
XML file which has got all the file
format stuff in there everybody seems to
start off with the one for files because
when you do a directory listing that's
recursive you get the directory name at
the top which is one bit I'm going to
get those some items and make it when
people internet things together I love
doing good god that's not too much like
hard work that's a much cheaper way of
doing it okay so see we've done all
that's where I've ever done this with
semi that's a turd editor oh yes all
right
one small issues if I do this though
alcoholic and piped through get recipe
help I finished off talking it in
get nothing that's not good okay so I
better get back to visual studio
I'd like it listed cocktails please yeah
and one thing I'm going to do just
before I forget I'm going to go to my
cocktail module here and one of the
things I do need to do this is a
manifest for your PowerShell module it
gives you a ton of information in it I'm
doing some time not too bad and that
tells you please import this in at the
same times everything else happens so I
only go to my yeah only goes my test
Explorer here I'm a solution so I might
want some test twist Escott I know I
want to change D tttd yeah we cannot
change branch so I'm just going to close
this down close the window it's quite
fun with it there okay really we said
now choose progressive approach there
I didn't see that man no don't bother
saving the changes thank you very much I
really don't want you to learn it for
our visual studio for my foes and I've
got one across the right window we'll
put him on a Laker okay
this visual studio Kaluga gotcha right
I'm gonna reopen that projects I've just
taped loads of leaks feet and I've been
really weird affects what I've been
doing is in the past let me just open
that up again okay so I've got some
tests for that I put a testing module in
over here okay and when it actually
finally decides to open I've got some
tests over here they're doing all of
this slop so I've got a pile of main
tests here we run testing some names you
may remember I said about the value from
the from the object property name here
I'm creating a couple of properties a
couple of objects with the name and a
price in them and when I do that the
name will get pulled out when I pipe it
through down here and finally down the
bottom is here I've got a test where I'm
doing by passing in the on the input
object now input object is the normal
name for this sort of stuff it's not
only be called ingredients so I'm going
to comment that one out and I'm going to
uncomment this one here okay and if I go
to my test explorer oh well first of all
I better go to my get recipe here I'm
just gonna put a breakpoint here which
is one of the great things about the
integration and if I go to my test
Explorer and I open up my cocktail test
on bottom of here I should put some
greediest Epsilon be able to debug it
and that will debug through keep my
fingers crossed because this used to be
50/50 item whether it works or not
think about it partial gets invoked what
sort of things get invoked nervous and I
didn't work Whataburger okay you can
debug these things and basically our
problem we've got deep down is that this
is only getting called the process
warmth / and baking power shop splits
these things up so the quickest way to
fix this is up at the top I'm just
looking to my conscience I'm going at
our trouble here so one not on trying to
fix a debug bit I will just have that
private in variable called in stock I'm
sorry I'm list of ingredients
come on the egg and give us better which
I'm going to call in stock which will
set them null okay so when we start up
here in the begin I'm just going to say
in stock equals the new very much in one
of those
okay the end process down here what I'm
going to do is I'm going to say if in
stocks don't count
in greater than zero a couple of curly
braces Ali I'm almost done honestly
about what there you cut them out drop
me and get rid that bit there and in
here rather than doing that what I'm
going to say is in stock
don't add ingredients that came in I'm
sorry it's something that should be
input input object and again let me go
on the under there
I should be enough oh I'm wrong
I don't know I'm not going to fix this
now I got it sorry was that
I believe that thank you
nobody mining about um
I think up really Nancy embrace our mind
again have again I was happy
yes now we're happy I was not happy
other than someone's my hobby I'm going
to ignore that
that's perfectly slide with it on later
on I'm going to go back to my demo back
to my powerpoint slides you've seen most
of it anyway so we can write in c-sharp
learn what we learned while practicing
flexible pipeline really is the way you
should work for moment customers in the
higher modulus new functions variable
exporting c-sharp version it was worth
having a magic formatting bits I'm doing
a good bad weird lightning talk on
Friday which points all much more
pre-cancer I was going to expect
something slicker but we don't know at
which IV zeg github is there and whoops
final bonus item is a useful cheat sheet
the power shell which is making what all
the curly brace brackets papers do and
there that's it really
any questions fine if not you'll get
some food</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>