<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>A Security Tester's Toolbox - Niall Merrigan | Coder Coacher - Coaching Coders</title><meta content="A Security Tester's Toolbox - Niall Merrigan - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>A Security Tester's Toolbox - Niall Merrigan</b></h2><h5 class="post__date">2017-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2fCfUUe8qok" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so before we start this is
security testers to
the wrong room feel free to leave
screaming right now there's no problem a
little bit about me this is a level one
our little bit of solace level I rate
this at 200 to 400 going on insanity I
like to kind of suggest to people that
this is there's a lot of command-line
tools in this black screens typing
old-school kind of dos and bash scripts
and things like so if that confuses you
good because it'll make me look more
smart than I really am all right okay
this is skewed testers toolbox let's see
why isn't oh yeah you know what this is
always a presenters nightmare they're
wondering why the little clicky Mouse is
not working it helps if you turn these
things on tada
Mickey Mouse networks all right I am
Niall Merrigan I am a managing
consultant which Capgemini in Stavanger
in Norway all the way up from up north
and if you are wondering why the
Norwegian sounds a bit like a paddy it's
because I'm from Ireland and I just kind
of got lost in Norway just due to
various reasons I'm an MVP in dev tools
and I'm an ASP insider as your advisor
and if you ever find me inside in the
Baxters in that absolute mecca in this
country the last line is very
appropriate I approve my name when you
meet me in the bar is like what are you
having so it'll quite nice you can tweet
me attend Merrigan I'm at Niall
ameri-ghen that I know you can please
visit my company's website to show your
appreciation of how awesome it was to
let me down here for a couple of days
and you can also if you are a bit
masochistic you can go visit my very
dated web site I do put a lot of links
and stuff up there for different tools I
work with but you know so this is a
security testers toolbox and this is the
one where I teach you how to do the
blackhat style of attacks against your
neighbors against your family against
your coworkers I mean how seconds we're
recording crap don't do this at home I
mean do this at home don't do this in
work because your boss will get really
pissed off a funny story I have the
title hacker and residence inside in
Capgemini in Stavanger because I figured
out it's a secret Alya
into the database and job titles and my
boss doesn't know how to fix it um great
way to get a promotion right
why aren't whoa why on earth am I gonna
show you how to sniff Wi-Fi how to crack
open Wi-Fi how to write malware how to
do man-in-the-middle attacks against
banks because I am a true believer of
the following motto you can only fight
the way you practice because if you do
not understand the types of attacks that
can be used against your applications
and used against your network you will
not truly understand why there's a
little hacker running around inside your
in your network like a demented gerbil
now funny story there was a hack
recently where a guy managed to pop the
domain controller for a network domain
controllers where you could store all
the usernames and passwords and all
domain credentials for all of your
employees usually considered the golden
throne of the network and someone
decided to install a Bitcoin miner in
there rather than actually doing
something good so the thing is I liked
how many of you plays sports how many of
you play like I wouldn't say play
fighting but like to kind of martial
arts anyone here do any of that couple
of people right normally when you see
boxers and people do martial arts they
box against the bag to get fish the box
against their mates to learn how to take
a hit and anticipate the punch the same
way when you learn to drive a car it's
all well and good driving in Forza
around some like the Nurburgring but
when you want to go out and get milk for
a grab for granny it's not the same
experience unless you're driving with
Troy hunt I have another story on that
anyway this guy is a Japanese swordsman
from the 1600s and he did and I love
this this the quote for it is just
exceptionally good but it does tell you
why I'm gonna show you some of the
things that people consider very bad
things to know now I'm going to discuss
a lot about strategy and what way it
works you have recon the reconnaissance
phase is where you go out and you kind
of figure
how I'm gonna attack this what type of
vulnerabilities does this system have
what is the weakest point into any
single system so I'm gonna pose a
question to an Australian audience this
is always a bit of a gamble when you do
it in Norway generally you get it just
like crickets so I'm hoping like well
and if you get crickets in Australia I'm
pretty sure they'll kill you so where
was I going with us yeah what is the
weakest point in any system thank you
and to repeat for the people playing at
home he said people in my house the
accents I get to have a lot of fun down
here yes people are the weakest link
because they are very very vulnerable to
things like Irish people calling sure I
can help you with your internet that's
no problem
just plug this in goofy thing how many
of you am use Facebook a lot of people
use Facebook anyone not have friends on
Facebook that's okay um anyone not heard
of the Internet actually this is
Australia it's a really cool so all of a
sudden those green cards are just like
be ripped up they're all the way anyway
if you go into Chrome okay pretty cool
thing if you went to Chrome you press
f12 in on the Facebook page and go to
consult it has a big thing called stop
don't do this don't copy and paste in
what your mate says you should do okay
so that's a pretty cool thing that's
what that's because they found out
people are being stupid so they sell
okay let's how we fix this now I'm also
going to show you some of the
exploitation techniques what we can do
like creating some malware taking over a
box doing a bit of Wi-Fi pwnage general
kind of all good clean fun nothing
serious except this very important
notice for the love of God do not do
this in public like I'm about to do the
simple thing is this all these
techniques are on the verge of your
honor I'm really sorry I didn't think
that would happen type of things so
don't do this at home or do this at home
do it on systems you own don't do it
against systems you don't own or don't
have permission to do it against please
do not use these things like to annoy
your boss and try and get him to give
you a pay rise because it doesn't work
but I'm serious this is the the the dark
stuff a you don't want to be caught
doing this if you really want to just
look you should make yourself look cool
at an airport use hacker typer or
something and everyone kind of thinks
you're awesome and if you haven't tried
google hacker typer it's pretty pretty
cool and I found out there's a this
morning that there is an awesome little
kind of an Easter Egg Innes if you use
capslock three time it gives up access
tonight in a big green kind of red
letters sorry Riddler and if you use alt
I think three times it goes access
granted and that point you go yeah so I
seriously think you should do that no in
a hotel and just like sit around Mac and
you know we've got all got black hoodies
no yeah there you go there's the
judgments all there's like everyone is
sudden it's all gone black hat yeah how
are you doing doing nothing so well I'm
gonna show you today this is gonna be a
little tour of all crazy things we've
got Kali Linux which is a debian-based
Linux based operating system it is armed
to the proverbial
teeth with tools it comes out of the box
for about a thousand different tools you
can use to do any number of different
things it includes recon information
gathering web proxy attacks are web
attacks everything you could possibly
need to go into in a nice bag of tools
some of the things I'm going to show you
as well is like nmap which is the
network mapper this is a really cool
tool how many of you like have stayed in
hotels okay cool I do this a lot but you
know what the first thing is when you
get onto the Wi-Fi or whatever I run
nmap to see what's around now it's
everyone kind of thinks that's a really
bad thing to do but I'm always wondering
what other idiot is on with me because
when I want to stream Netflix it's makes
it much easier if I can just knock them
off you know you're gonna you can get a
better share of the pipe but I have
found things like cash registers on this
on the guest nests for some strange
reason I don't understand why I'm
usually probably because someone might
on that's a Crayola crew port plug it in
it works I'm not going to show beef I
might show beef but I don't know yet but
we've all seen down here called
Metasploit Metasploit is the granddaddy
of exploitation tools it is pretty
everything that you can imagine that can
be exploited it has a module four so it
does a lot of the remote tools and it
also acts as a listener and sends out
like remote Trojans and stuff it is
exceptionally powerful if this ends up
inside in some of your applications it's
really game over then I'm going to show
you like the bail framework which is a
antivirus avoidance technology that is
written with a five other tools it's
called what is known as the veil
framework comes the thing called veil
evasion for a Vav avoidance there's one
called veil catapult for launching your
applications into like SMB shares
there's veil ordinance for creating
weaponry there's a I think power splice
for doing PowerShell exploitation ladies
and gentlemen the best thing on a
Windows machine is PowerShell it is a
hackers best friend there are sixteen
ways to break out of UAC with PowerShell
okay now well know something cool so I'm
gonna give you a very cool little thing
how is it you never have GPO group
policy and it says this program is not
allowed to be run right here we got that
do you want know how to bypass that zip
the file and seriously zip the file okay
open the file in the zip file just
double click it it will load it into
memory it won't have the same signature
same access point and GPO will go that's
fine
it's how I got to get putty one in one
day when I couldn't wasn't allowed to
use it so I'm serious this is a very
very simple way of doing it and I will
show you may show you beef which is a
browser exploitation program because an
exercise framework which allows you to
insert random j/s hooks into things and
do all sorts of mad crazy things like
inject Clippy on to someone's friends to
your friends page because you know no
one really likes to see Clippy turning
open their page it looks like you're
trying to hack this site can I help now
if I didn't if you weren't if you
arrived lace or you're just have a
memory of a goldfish like the rest of us
again public service announcement do not
do this in public like I'm about to do
as I said do this at home okay please I
like cats they like you and you like
staying out of jail because you know
they say don't
the soap so yeah yeah this is being
recorded and I'll remember that okay
demos let's have some fun because you
know there's nothing more fun than
hoping to God everything works alright
so let's start with here now I'm going
to start a little bit if you can you see
that you can't erase so you are deciding
you want to hack something you've woken
up one morning you've had your Wheaties
or Vegemite or whatever demon on demon
thing that that they call that seriously
kids Vegemite it's another example of
the note of the Australian natives
trying to kill you yeah you want this
thing on toast
honestly I swear so what have we got
here we have the CVE
database CV common vulnerabilities and
exposures database this is where all
good things come to start and play and
live the CVE databases when you get like
a CVE number and it says that we are
recognizing that you have a bug or
vulnerability in your application I
missed it
try again come on that's so natural you
have the national vulnerability database
right so what you get is you get a CVE
database the CV link this is usually
what happens when you get like 2016 - -
and this is the where they say right you
now have a vulnerability in your
application and you possibly have
produced a either fixed read already on
average there was in 2015 there was
7,000 ish 8,000 ish CV is registered of
those seven thousand nine hundred and
eighty-eight of those was flash so PSA
number two disabled flash on your
browser now and follow very closely by
Java because we all know what Java
stands for don't we just another
vulnerability actually spot the
Microsoft guy anyway so so we will look
at a CV number 2015 - zero zero three
and this was the way
32 cases in kernel-mode drivers in
windows blah-blah-blah-blah-blah aka
win32 k elevation of privilege
vulnerability this is awesome it tells
you absolutely nothing of why this is a
problem it just says there is a bug and
you know what happens when someone
developer gets that there is a bug in
their code like you know if you ever got
a bug report it says someone says
there's a bug I will email back saying
there's a solution and see how this this
conversation goes because usually that's
where people are gonna go fine I'll tell
you what I did so then we have as was
known as the national cyber awareness
system and NIST is the national
vulnerability database and what this
does I might just minimize move down to
less blind view and what this does is
this gives you a better overview of what
the vulnerability was so in this case is
the same nearly replication it's got the
same text but it tells you how bad this
thing was so it's got a CBS s version to
score of 6.9 which means medium and the
reason it's got a medium it's got an
impact sub score of 10 meaning quite
possibly the most lethal thing outside
of Australia now and then it has an
exploitation bility every time I try and
say that I just make a it's got an
exploit sub score of 3.4 so these two
numbers magically put together give you
6.9 for some reason I don't know how but
it just does anyway then it means the
reason is it says because it's locally
exploitable victim must voluntarily
interact with the attack mechanism
ladies and gentlemen how do you get
someone to interact with an attack
mechanism you make them double click it
ie it had to be a bug or something that
was put on a piece of are put on a page
or downloaded or you did infect
something and then that's the reason why
this was a problem because it allows you
to again like a golden ticket or it's re
not able to get elevation of permissions
so you now know there's a bug in your
system you now know there is a good NIST
declaration of what's wrong
where do you go next you go to the very
aptly named exploit database because
nothing says better than
and what this does it can you see that
actually we'll try again what this is is
maintained by a company called offensive
security and what they do is they host
about as they say 335 thousand 484
exploits and what you have here is all
the different types of exploits that are
available for you to play with and
download and use so you've got things
like remote exploits web application
exploits local and privileged xsplit
escalation exploits proof of concepts
and some shell code and also at archives
security papers one of the things I like
to point out here in web application
exploits if we just zoom a little bit
here all right how many of you are web
developers quite a lot okay right you
notice the big words here where's it
gone oh my can I'm am I blind
I see sequel injection a lot I think do
I'm reading the right place here stored
XSS sequel injection see Cerf and other
different things but sequel I in general
is still a huge problem because
developers don't get it
apostrophes are important okay Irish
people know how to write sequel
injectable proof code you notice how I'm
saying in this very dead panting because
I used to I used to teach in University
and you would always find the guy who's
got a someone in our group which had a
guy named O'Connell O'Donnell and had
the apostrophe because they would find
this very quickly and get this on
escaped problem so they would they would
automatically escape their code but
sequel is still very very very very
prevalent and a one thing I'm I'm loathe
and kinda I do like giving a data that
sometimes there's quite a lot of PHP
still okay now that it's not a dick at
PHP as a framework it's a dig at PHP as
it is very low friction to get into it
so it's free there's a lot of good
there's a lot of sample code out there
are people just copy paste I think Troy
did a thing earlier on where people just
copy stuff from Stack Overflow chuck it
in code works yay I can go home and this
happens a lot and PHP is still
predominantly the most I'm exploited
piece of code and you can read into what
what you want
but if we go back to our guy here and
this is the MS 1510 this is the proof of
con artists the local privilege
escalation code that is exploitable so
you just have to inject this in some way
into an executable get this to run and
boom you have in min writes I like it so
you very little work to do now if you
want to go and find types of machines
that are vulnerable to this you can use
a thing called showdown and showdown if
we go back to the page and everything
closely works and I'm tethered still
awesome internet works this is a search
engine for the internet of things
labeled as the most dangerous search
engine in the world ever it is very very
cool what this does is a written by a
guy in Germany called John Maithili and
what he's done he's got a load of
spiders that run around the internet and
figure out ports and tell you what's
running on them so I'm gonna open this
up and I asked an ask a question how
long do you think it takes to scan all
the internet for four billion addresses
not from Australia Australia might Excel
like you talk like a boomerang how do
you think it takes to scan the Internet
anyone willing to like less than a day
well we're good that's a good start
arbitrary number less than a day it's
like how long am i telling my wife is
how it's going to take to clean the
house next hour go lower half an hour
ago a little bit lower 28 minutes that
was in 2014 at DEFCON the guys did live
with masks at all right 28 minutes they
have it down now to two and a half you
do need couple of gigabit NICs or
possibly ten gigabit NICs and a pipe the
size of googles to do it but it is
possible so the inference by that is it
takes two and a half minutes to find a
machine you have spun up without patches
all right if you're running an azure or
AWS or any other cloud providers and you
spin up a machine you've got two and a
half minutes to wrap it baby otherwise a
lot of very Dean
your spiders are gonna come licinus
alright nice it's crazy so what this
does is it goes scanning and downloads
all the banners has a ton of information
and you can go looking for things like
Windows Server 2003 Windows XP all
machines that are out of days vulnerable
and probably out of security patching
because the problem is many developers
what they'll do is the launch of an
application it's into production and
that's it done we won't we don't need to
do maintenance do we it's done it's
fixed software doesn't evolve like
pokemon it just sits there like my
Pidgey um have you done the Pokemon
around here there's just nothing but
zubats it's ridiculous but also
apparently there's a whole thing if you
go on - this is why I love being a
programmer sometimes if you're going to
github there's a thing called neck robot
which will go around the world catching
all the Pokemon for you so you just sit
there and let it off and it is there's
apparently a thing where it says it's
currently walking from Cornwall to John
O'Groats or something all the way up in
in England so you can get all your eggs
done the boss it's brilliant
programmers always looking for solutions
now to go do something like this we were
going to look at things like we can go
looking for databases because you know
what lives inside and databases data
it's awesome passwords things other
things I like and if I go looking for
MongoDB databases I can find this type
of thing and I'm gonna explain this a
bit more tomorrow but I've got you can
go cuz Mongo up until about 1.4 that's
something decided that security was an
optional extra and it was listening on
all ports and it wasn't secured and I'm
very I'm probably the reason it is this
is because you know no sequel no no
query we can't get data out doesn't
matter you know who's gonna find
anything so that is a very cool way I'll
show a lot of showdown tomorrow if you
come to my talk tomorrow I've got a ton
of things that will just make your jaws
drop now you can also go things like
looking for like this like port 9 2000
JSON which is more I think there's
elastic search looking for specific ones
you can do this for like Redis elastic
search I know other different caching
services and people have left these
devices open they are applications
running with on authentication BR no
authentication because they real they
don't think he can be found how
difficult is an IP to guess you know
it's for it's just for updates you're
done
now if you're in the kind of mood to
attack a website and let's see if this
works give me a second right there we go
if you're in the mood to attack a
website you know you're sitting on the
couch you just watch CSI cyber and
you're thinking I can do that you can
use punkspider punkspider is a little
bit out of date at the moment but it's
pretty freaking awesome still it is I
love this the goal is provide free
information website users and owners
regarding website security status we
take this very seriously use it wisely
or we'll have to take it to wait so
remember that we just click accept it
because I haven't read that and what you
can do is you can go looking for
different domains and different types of
structures new and what it allows you to
do is look for like for example blind
sequel injection sequel injection
cross-site scripting traversal XPath
injection for example and you can go
find websites who have this and it
actually even generates a nice URL for
you to use so you can see said sequel
injection in play now one of the
simplest ways to go find sequel
injection sites is to just go off and
use Google and use a nice Google Dork
the very nice guys at the exploit
database have even got a Google hacking
database with a ton of google dorks in
there and it's just it's just insane so
I'm gonna give you a piece of advice as
I give to a lot of developers and
programmers how many of you use build
servers couple of people great
how many do man internet-connected
outside available online everywhere else
one or two if you ever googled for build
servers login screens because you can
find a ton of unauthenticated build
servers alright that allow you to do
things to them they will accept whatever
you give them you can change how the
code is deployed you can change what the
code does you can inject your own code
and this is the IDE the problem that
people are they're gone no one will find
it Google finds everything and you don't
lie to Google you know it knows all your
habits so one of the big problems is
that people need to remember that even
though I it's not it's security base URI
is not a security procedure it is much
it's the equivalent of my son when he
goes playing hide and seek and he hides
in his asses out of the doubt of the
Bears and he's giggling away good oh and
he's thinking
can't see me because I can't see him
alright so don't be my four-year-old son
because that is just really weird if you
want to see XSS in action go to the open
bug bounty program now these guys what
they're doing is absolutely insane they
are hunting bugs at a rate of knots and
trying to get paid for it so bug
bounties are very popular XSS is a very
still very very huge lot of
vulnerabilities there you can see by a
lot of the kind of websites quickest
patched one minute ladies submissions
they used to have their kind of da Alexa
top 200 LinkedIn was on top their Yahoo
etc all these different sites and there
was in the last month that they were
still being accessed what they do is
they do responsible disclosure very cool
once you go in you can actually look at
the XSS vulnerability see how it was
done see how the person has finished it
we did a talk back in January in Oslo
myself Troy and a couple other guys and
some we were using slight o little kind
of a to do the presentations and we were
talking about different things and one
of the guys went through the exercise
cheat sheet which is not 15 things it's
about a hundred and fifteen things of
way of doing exercise bypass and managed
to do exercise live on stage to this
tool we were using so that's it still
exists now let's show you a bit of Kali
let's do this Kali wakey-wakey so this
is Kali and very secure password it's
the default instance yes all right no
okay it's the default instance you can
download Kali today from the Kali
website it's about a seven no is it
about between two and four Meg or gig
torrent file and if the quickest way to
get it down it zipped and then it
expands and you download you can
actually use in VMware it runs very very
quickly a really really powerful I'm
just gonna starting to minimize this
from the screen so you don't see what's
going on and get confused Kali has a
default username of ruse and a pound
default password of Tor this version is
only on - so you don't can't get access
to it but if you do put it publicly
change the SSH keys change everything
because someone will just go
yeah wait and you will be locked out of
your Kalima Sheen now Kali is
exceptionally powerful what comes with a
ton of things out of the box thing like
as this you can see here
information-gathering vulnerability
analysis web application analysis
database assessment password attacks
wireless tax reverse engineering
reporting and so on and what I'm gonna
show you here is some of the crazy
things we can do now I have have you
ever used and if you've never used an
nmap nmap makes red regex look same when
it comes to its command-line switches
okay there's a couple of people who are
they're going I'm giggling other people
going what's a regex and they're the
lucky ones
because the rest of us are like make it
go away man so what we can do here is if
you wanna learn how the command-line
switches work you can use a thing called
Zen map and then map does a really good
job of showing how it like the
command-line switches work so if you
want to do a in quick was a quick scan
plus it's like you know - SOR - dark SS
V minus t4 - OH - f - dash version light
because that is very obvious is why that
would be a good thing and you just put
in the IP addresses and it scans it off
for you and what we can do here is just
tuning one-ninth to the at this one and
we'll see how long this takes because it
could take a little bit and this will
give me the list of different devices on
my network what they're running the
services they're running and possibly an
OS as well if it can determine it now
how many of you have thought the hotel
Wi-Fi is a bit shocking today honestly
it's not my fault
what actually might be a little bit
ladies and gentlemen this is a nano and
it is a Wi-Fi pineapple it's one of the
baby brothers of the little nano now the
reason it's got really giant areas is
they give you this teeny weenie aerial
and I'm going to do the only joke I've
prepared for this that's not an aerial
this is an area
I honestly thought if I did that with a
spoon would anyone get it
I see you've played noisy Spoony before
then my favorite episode of The Simpsons
by a long shot
even the Irish piss-take doesn't imagine
anyway so what this does is it is a very
cool little device mainly because it's
got a giant battery pack on it I got to
join aerials what this does is it acts
like a router or I'm loath to say Rooter
because you'll all giggle like little
boys because apparently that's a naughty
word in Norway or no in Australia but so
what do you do is this how Wi-Fi works
you want a little Wi-Fi primer right
back in the days when Wi-Fi was new
everyone said how do we find if the
routers up so they said well get your
device to shout out everything it knows
and if someone's listening for that name
it'll shout back they'll do the
handshake and we're good and someone
says that's awesome that's really cool
and the problem is we ended the used
only have like five routers in the world
so it was fine you know there's five
guys with Wi-Fi but after a while do you
know people said well you know this
thing is at home I've got Wi-Fi at home
you know they say about home it's the
place where your Wi-Fi connects
automatically all right let's see III
come on wait Lee see me at PubCon man
swear to god much more crazy anyway you
do this and what they said is well what
we're gonna do is we're gonna make the
devices a bit more battery focused and
we're not gonna shout out all the
different things we're gonna listen for
all the different Wi-Fi points and if we
recognize one of them will shout out we
know you and connect so what this does
now originally dis used to just like
listen for all the broadcasts and reply
yes when you said are you and honors at
Hilton are you like Netgear it didn't
matter it would just say yes very easy
Rooter writer router anyway and then
what happened was it when the new thing
is they said right what are you gonna do
is I'm gonna listen for all the
different broadcasts of SS IDs you have
and add them to a list and start
broadcasting them back out so now all of
a sudden if you're looking at your
devices you will see possibly in the
region of two to three thousand
different asses
are broadcasting from this little device
and it makes it very difficult to figure
out which open network you want to
connect to you have a one in 3,000
chance of getting it rice and all and
your devices are very very good at just
going oh I like you and connect now the
problem is that this is just one of the
small ones I have a tetra which is its
bigger brother has four of the aerials
on it also does the 5 gigahertz range
now these things are very good because
they do pass throughs they allow you to
sniff different devices etc but it means
if someone's on on your network here if
I've got me connected I'm rooting out
towards out to the web from here I
control everything that happens at this
point because this is the question when
you go on to a hotel Network do you know
what they're listening to if they're
listening what they're changing use the
VPN kids it's a safe way to do it now
because otherwise you're going through
this and I swear to god you're not gonna
like it
anyway I'm gonna turn this off in a
minute just now you know what's there I
did tell the other speakers if your
Wi-Fi would go a bit Dicky while I'm
working and they just really so now we
have these these nmap returned we can
see here what the different servers are
running our computers are running on the
network I've got about five includes the
Gateway we've got here one to eight or
28 - this is my colleague box and then
I've got a box here which is Metasploit
able and it's got a great name called
medical because it is very exploitable
it's a training box it is a secure Swiss
cheese lots of holes those are things to
play with you can see the different
number of ports open you can download
this from the internet it's very very
quick to play up with do not for the
love of God and leave it on the internet
because it will just become a hub for
people hosting other things now you will
also see this one 131 and this is
Windows so if we look at the host
details it just says it's windows it has
fairly secure because it's Windows 10
1511 which makes my job a little bit
difficult to demo and I don't really
want to bring a Windows XP box in there
because that's just like cheating so I
do take it take pride in having to try
the
the ones now one of the cool things is
that's using nmap to try and find
different vulnerable devices you can use
it another network card like these
alphas with this other little aerial and
I just got excited and what you'll do
here is the Alpha is a very specific
chipset it allows it to go into a thing
called monitor mode and what will happen
is most devices what when you have them
what they do is they just look for
networks and they don't bother listening
for all the different type of traffic
well we do this isn't to go into
eavesdropping mode and you have to have
specific drivers to do it most intel
cards won't work certain raelynne cards
and these alphas that is a $20 card when
I plug this in I was away up in the 38th
floor or something and I plugged this in
and I can see like the Tower and I can
see the qvb and I was picking up all the
TVs around me I was doing my sniffing
and I was also picking up the qvb Wi-Fi
which was a good 80 to 200 meters away
through concrete and glass so these
things are very very powerful and what
you can do with it to do this it's quite
simple you just have to do airmon-ng
check and use kill now this very simple
command what it does it nukes all the
different networking so that you don't
have to worry about what's going on so
there will be no interference on the
different networking subsystems and then
you just do airmon-ng and I think it
starts wlan0 it's the wn0 p.m. I know
what this will do is it'll turn into
monitor mode and what we're going to do
now is we're gonna see what type of
devices and things are listening and
shouting out for stuff around here we'll
see what will happen
god knows could be anything crazy so
we're gonna do a thing called arrow dump
- I W land
1 0 or sorry Mountain Mon so what it is
done is it turn it adds a prefix our
suffix onto the name and gives it a Mon
and then we're just gonna do - -
manufacturer because I want to show you
something and - - WPS when I do
fullscreen I'm gonna see how long this
takes hopefully we'll find something
did I do the right thing wo man - I
don't - I we should find something
otherwise of a very poor demo it even
should pick up the Wi-Fi every driver
whatever is going on all right let's
have a quick look don't stop
mm zero mom might be just a something's
gone a bit funky if not I would just
pray and I'll just tell you what really
happens yeah never mind okay we will
every time I try and do this demo I
would hop upstairs it works fine every
time I do it down here it breaks so I
might take this out as a cycle right let
me explain with the through the hose it
called
interpretive dance how this works what
happens is this goes into monitor mode
it will tell you what's going wrong
what's happening the first six digits of
every single MAC address tells you which
is the manufacturer of the device okay
did you know that first six digits of
your MAC address tells you which is the
manufacturer your device so you use the
W - - manufacturer to find out what
version of the router it is and then you
have a thing called WPS everyone heard
of WPS Wi-Fi Protected setup it's an
invention because people are stupid and
think passwords are hard and what
happened was it was because after a
while web which is wireless encryption
protocol was deemed to be exceptionally
easy to crack it is stupidly simple to
break and then they came up with WPA and
wpa2 but people thought passwords were
hard at this point and to make life
simpler and devices easier to connect
they said well you just press a button
here you press the button here and the
two devices will talk to each other what
happens is it sends a pin over and your
router will send back the Wi-Fi address
and it will just load our the Wi-Fi
pattern we loaded back in certain
devices are vulnerable to repeated WPS
attacks making it if you only need
eleven thousand combinations to match up
and get the WPS pin of a router what's
even cooler is there is a chipset
problem meaning it only takes two WPS
attacks to do it that's called pixie
dust and this is affecting Belkin and
certain dealings and certain other
Broadcom devices it means you can crack
open a router in less than a minute and
it will send you the pin which will you
then send the pin back and it will send
you back over the password they find out
you're on your net
or if they changed the password you send
back the pin it sends you back the new
password it's a very simple system use a
device called Reaver
and it is very very powerful so if you
are using WPS at home and you are
technically savvy and not an idiot turn
it off because you don't want someone
just going ping ping ping ping ping and
they will get eventually it takes about
between 4 to 6 hours depending on the
speed of your router and how quickly it
had if it has flood detection or not so
turn off WPS because otherwise people
like me I have found WPS in corporate
environments and when I do that I just
go boom and then it hands me over the
password I'm like here you go
ok how did you get our Wi-Fi password I
always want to set I ask to CEO just to
see what happens I asked to see the CEO
CIO somebody you know with technical
levels or something just bit of fun so
at this point we've done our Wi-Fi recon
we've done other things we're now kind
of near the network we're I'm assuming
we're gonna be on the network and what
we're gonna do is we're gonna look and
see what we can break here and what I
want to try and do is I'm looking here
on the ports and I noticed something on
the FTP it's got vs FTP DD 2.3.4 now the
reason it has that very specific version
number is for demo purposes it's awesome
because it's very vulnerable to an
attack so what I'm going to do is I'm
going to fire up Metasploit and I'm just
going to do MSF console and this will
take a little bit of time a members of
console is the command-line interface to
Metasploit and it does take a quite a
bit of time here we go now once this is
up I will show you how to exploit my
Metasploit able box as it is very very
cool and very very simple jeez there we
go
so I tell people when they start this
the first thing you do is type in banner
a couple of times so you can get the
eventually get the Metasploit it'll cow
which is pretty cool I'm not going to do
that because it does take a random
amount of time how long it takes so if I
just do help here I can see the
different type of commands I can run and
I can see up a little bit of thing here
it has a lot of different things here
and I can go I'm just going to use a
specific command
cuz I know it works exploits and it's
Linux and it's FTP and oh no is it UNIX
sorry FTP and its vs FTP t 2.3.4
backdoor you would think I will written
this demo you press return you type info
and you get this thing here and says
this module exploits a malicious
backdoor that was added to the vs if TBD
download archive the backdoor is
introduced between this the 30th of June
20 2011 and July 1st 2011 so you have a
limited amount of time where someone has
not downloaded the update for this but
people will have just installed the
software think it's good realize what we
can do and this me and you know how many
of people the quick question how many of
you update the firmware to your router
very often as often as possible why
don't you do it more often
laziness it's not obvious really is it
also it's like you know I've got a reset
up a little bit higher password I gotta
do the backup I gotta do sir it's fine
no one will find me on the Internet two
and a half minutes later boom right so
what I want to try and do here is do
what it needs to run so it needs a the
basic options it needs is a remote host
or host so I need to set that value so
that is set or host and I think it's
just or host or host to 192.168 128 dot
129 I think that one was and if we just
do that that's done right I'll just do
exploit and we waste for the magic dun
dun dun da found shell fan shell opens I
now have a command shell on the
Metasploit able box so if I do now if I
just do return and do sessions I think -
I don't know if even have to do this
okay sorry maybe just do Who am I
I'm roof meaning I am God or how really
odd thing in Australia and if I do you
name
it tells me Linux I think it's you name
- is it you name - eh I'm running on
Linux Metasploit about 2.6 total blah
blah blah and I'm running as root what
can't I do very little so this point I
own this machine okay it's my thing to
play with I could do whatever I like so
I'm just gonna quit that but that's just
an example of how easy it is that's how
easy it is to remotely exploit a machine
once you find out it has a vulnerable
backdoor or vulnerable piece of software
so this should be an example to you as
developers who are deploying on
applications and go oh we don't need to
reply Windows updates I always love that
the guys who go who'd say you know we
apply updates one month after the update
cycle okay
this to me is always the most insane
thing I've ever heard except when it's
dealing with sharepoint because that's
just really dangerous don't ask me how I
know this the other thing is what is
really cool about the second Tuesday of
every month
it's Microsoft's Patch Tuesday what is
really cool about the second Wednesday
of every month its roll back Wednesday
there's my MVP gun anyway so what
happens is people will get the patch and
look at the patch notes will read Ian's
a reader sorry reverse engineer at the
patch figure out what has to go wrong
and then say okay we need to we need to
fix this and this is how we earn is how
we break it now I want to shun running
at a bit lower lysis of time say so I'm
gonna try and do something a pretty
awesome today so I want to show you if
you think Zen map and everything else is
difficult then we have this thing called
Armitage it blends Zen map and Metis
plot into one nice UI it even has this
amazing thing up here in the corner
called attacks called find attacks you
press it it will do things it will go
looking for the different attacks that
can be used against all the software are
all the different devices on your
network you can use nmap to
to host an nmap scan exact same way as
what we've just done find out the
different applications are vulnerable
find different things and then use this
nice thing because if you didn't know
that vsf TBD 2.3.4 was vulnerable this
will find before you know I'm gonna wait
on this does something cuz this is
pretty cool what happens come on baby
right you will now see an attack menu
attached to each host in the targets
window
happy hunting alright so here on one
this on here we can do attack FTP and it
should do this exactly the way all right
it will do everything automatically we
click Launch we hopefully everything
launches the cord in the plan come on
excellent wait for us wait for it boom
lightning now that's when you know
you're a hacker cuz that all when I did
the Metasploit ping everyone goes no
yeah that's fine but red lightning
around to your computer that usually
gets a round of applause hint hint and I
can interact with the exact same way I
do want to point out one thing because
this always gets a laugh at everyone you
have this thing called a Hail Mary
everyone know what a Hail Mary is you
throw the ball you hope to god somebody
catches us but what I think is really
clear is the way they've stated it here
says one start of the Hail Mary will
launch a flood of exploits at hosts in
the current workspace there is nothing
stealthy about this action if clumsy
launching a hundreds of exploits is what
you would like to do press yes no I'd
last time I try and did this did you do
it it broke the internet more than Kim
Kardashian's ass this was just really
bad no so at this point you can this is
how very simple where you've got two or
three different tools we plug together
to make it much easier for you to do the
exact same job this is like when I tell
people how to do sequel and they're
trying to learn how to do joins and
different things and I show them how you
should learn how to do it and then I go
into sequel manager and show them how to
do views and then it shows them how to
do all the different joints very much
it's simpler so this is a very cool tool
if you're kind of finding a Zen map or
Metasploit it's a bit difficult or if
you don't have you're a really good
knowledge of the exploit DB in your head
right
now I am going to I'm probably gonna
skip the malware a bit because I really
wanted to show our might see if I can
just show a small bit will do the
malware bastard so what I want to try
and do is a bit of malware concepts here
and I'm going to show you what happens
when you exploit a Windows 10 machine
and I hope all this goes according to
plan so I'm just going to check in
Windows 10 so if Windows 10 please here
yep sorry downloads and I have a page so
what I would normally do is I create use
veil to create a payload which just
allows it's a very similar to how stuff
works so and what I want to do is I'm
going to create a new payload here in
using veil so I'll just do CD for /opt
you can download veil from github and I
just install it into the tools veil veil
evasion evasion and for slash fail
you'll know this was written by a
Windows programmer because it's
capitalized no I'm serious every single
tool I use is lowercase except veil and
it's really odd it always kind of cracks
me up but it's very very similar it just
uses the veil framework you have like
for example if we list here I've got 51
different ways of and creating shell
codes that do things and what I plan to
do is run a handler I just need to find
out where it is other locations this is
always how you know I'm not really good
at this stuff
it's not like it's in user share I think
isn't it any questions while I'm just
frantically going around the internet
here anything at all real output and
then there's a handers and I think I've
got pay - yeah I just want to get out of
this - okay so it's user share all right
so what I'm going to do is normally I
would create this but I want to just do
a handler and just get this running for
you and I want to show you what happens
when you break - or /var knows a user
share and write share veil output
handers Hey
- isn't it and we see great so what I'm
going to do now is this is a handler
file it basically sets up Metasploit to
listen for everything for me and say
okay now when you do something naughty
on the internet I'll be listening for
you and I'll when you're that computer
that's infected with your little valve
virus or malware or whatever
I will then send a new payload to it so
what I'm going to do here is on Windows
10 I'm going to show you something you
just go run as administrator because
everybody should run things as
administrator all right and black screen
is gonna pop up hopefully according to
plan because it's a batch file because
their thing is I wrote the original
version with thee and if we go back into
Windows into Linux it should start
listening for this now if everything is
going according to plan
just worked a lot quicker upstairs
panic panic do something else
come on panic a bit more yes no did us
take it the right-hander I should have
got at them it should have just run
oh this was working upstairs it might be
just a bit odd what's going on there's
normally what happens is here and this
is where I'm gonna get really annoyed
with myself now but I'll just do it yeah
thank you I'll do another demo no ii
normally what would happen here is that
payload would just connect back up it
would send the payloads to Metasploit
are from Metasploit to the machine and
then you'll be able to take over the
remote control of the machine
God knows why it's done this I have done
it upstairs with a thing if you want to
see this afterwards I'll probably be
able to demo it no problem because
there'll be no cameras nothing going
wrong and the computer will go oh holy
Sh
sorry it's gone on the Australian
Internet it's gone over to New Zealand's
now I probably have two shells okay cool
so ignore it a little bit we can cut
that right Jacob please so now I think
I've got failed to launch them something
like that okay let's see what we have
here yeah
good sessions if I've got two sessions
this will be pretty cool
I've got two sessions so now you can see
that I've got a meterpreter session back
to desktop demo user on this particular
one I think this certain the first one
we ran is this administrator so I'm
gonna do that because that is you know
you what you say is you know that this
thing that pops up from IES are you sure
you want to run this file sure I want
just next next next and finish I'm done
and then it'll say you want
administrator rights and you go find
just take whatever you need I want to
play games this is the type of thing you
exploit with this so sessions - I won so
we're gonna get collects the first
session we are now connected back to
Windows just to just prove a thing of it
is I'm just going to do a PS should do
starting PS oh sorry is it what's the
slowest PS was it command line for this
but I'm gonna just do load es PA and
this is loading an extension called es
PA which will allow me to do a screen
grab of the desktop if I do screen grab
it should now pick up the desktop of my
computer it's not pretty awesome
now we can also do things like for
example key logger
as a key what if I to do for that one
load incognito
I'm having a problem way this is running
a bit slow please don't be dying No okay
well trying to discrete keikar this get
help there we go so I've got screen grab
hash dump get system I've also got
things like for example get system is a
really cool thing what allows you to do
is run as administrator so if we do that
it we're already running as admin and if
I go a little bit further up I should be
able to see like for example I think
that load incognito what incognito does
is is pretty awesome because we can run
and login as administrator or create new
users for ourselves to do mad things but
this is just an example of what happens
when you do crazy things against
people's computers my last one before I
go because I've got five minutes I
really want to do this one because I
think this is probably one of the
coolest demos on the planet because no
one has any idea what's going on
especially me
right we will go over here open up a new
terminal new window so I'm going to do
CD Kali scripts demo and I'm gonna do
dot four slash and dot forward slash MIT
MSH this is a man-in-the-middle attack
it runs the thing called a
man-in-the-middle framework how many of
you seen Troy and he does like HSTs
strict Transport Security there is a
bypass for this but requires a very
specific way of doing things so what the
man-in-the-middle framework does is
allows me to do an ARP spoof against a
particular clients which means that now
instead of you rooting out through the
Gateway you're rooting through me I've
just done my pineapple trick except I'm
on the same network as you and now I'm
going to run a DNS server an SMB server
and different things and do SSL strip
against different applications and what
I'm hoping will happen is when I bring
up this and we can go out the internet
I'm gonna show you what happens when a
bank does it right if everything goes
according to plan so your browsing
session did not do that ok hopefully
everything is going happy we still have
internet access and we should be able to
see something about Kenya and IKEA I
don't know what this is but apparently
it's a big thing here because it's the
other thing when you do travel a bit you
get oh good the people who helped Peter
fuss that's awesome not what I want to
be doing in a black hat talk um dark
humor now WWE --gel comment goes
according to plan it did brilliant
ladies and gentlemen the Google homepage
hey you get a tenner later now what did
I just do oh good I there's an extra W
it's a whole people don't what what W
where in the Google is there W W
www.google.com all right now it's also
over HTTP plaintext
and even cooler is this is life so if I
want to go into sign-in for example and
if this goes according to plan I will be
in HCP account google.com again over
HTTP right you with me still good let's
enter my email Nile dot Merrigan that's
me and we click Next and I'm gonna put
in pass one two three four I've called
this out so you can hack it and I'm
gonna click Sign In I didn't even think
of it in one three three four right
nothing the password you entered is
doesn't match Nile dot Merrigan password
is past two three four what the bloody
hell did the Irishman just do did he
just break Google no he didn't he
exploited a very specific thing a the
browser wasn't cached all right
the browser it doesn't recognize HSTs
therefore something is gonna I can mess
with the transport layer so I just
removed SSL I've now can get stuff over
HTTP and I want to do one last demo
because I think this is pretty cool and
I think is at WWE and Z comm personal
banking because this is an example of a
company doing it right even with my
stupid stuff dicking around in the
background and if everything comes up
and I may not come up but what you do is
if you run this attack on a and Z what
will happen is when I try and do login
here
something really cool happens all right
this page must be viewed over a secure
Channel boom that company's done at Rice
because they do not allow HTTP at all
and that is really cool when I see that
because that means the banks have done
it right they haven't got a HTTP
listener they are doing this and when I
was I'm super happy when I saw that
so Fairplay and kudos for those jobs but
this is exactly what you want to see
this type of error now this type of
attack is brilliant when you're inside
an internet cafe because no one will
see it coming because you may not even
see what just happened alright so be
very careful if you got if you are an
untrusted Network ie it's not your own
or it's not your Corp proxy root
VPNs out whatever you have to do do not
trust that the network here now after
this talk I'm assuming all of you will
be asked me what VPN you want I
recommend freedom it's a fantastic one
and I use it all the time even when I'm
on trial I'm travelling and I'm just
bang out of time for about one more
minute so I will take questions stunned
silence alright try again do you want to
throw a shrimp on the barbie sorry I
that was just I was like a cockney
Australian accent any questions comments
yes sir yeah oh you are a smart man well
done you so the question is would this
work in Chrome no it would not because
the big thing is we've got a list called
the HSTs preload list what she this
gentleman is I'm telling you about and
what that means is it is a list of sites
that are preloaded into into Chrome and
any of the chromium based browsers which
means they will not ever request over
HTTP ever this did it's a bypass I found
this out to my horror when I was working
with Visual Studio and I'd set up HSTs
for a localhost and couldn't understand
why I couldn't make it a standard HTTP
request
so HSTs on a preload doesn't this this
isn't this is not vulnerable to this
he's this the Chrome so chrome will not
be affected IE 11 is affected because it
doesn't have HSTs and preload boss edge
and IE 12 definitely will support that
and anything in firefox so this is a
very much an edge case proves the spawn
so yes i mean anyone else going once
going twice go get some coffee thank you
very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>