<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Adaptive Threat Modeling - NDC Security 2018 | Coder Coacher - Coaching Coders</title><meta content="Adaptive Threat Modeling - NDC Security 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Adaptive Threat Modeling - NDC Security 2018</b></h2><h5 class="post__date">2018-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LVrL4Jmn_10" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so Markov chains in Montecarlo
for breakfasts it'll be fun I promise
I'm really excited about this idea that
we're gonna go through today I'm excited
because it strings together a lot of
thoughts and a lot of ideas into kind of
one coherent thing all the way through
the business but I want to start off
with why why do we do security at all
what do we bother anybody have any ideas
on why we why we even bother with
security there are bad people yes but
what but who cares why don't why don't
we do it to make money well yeah I guess
that's that's definitely a thing I
should you know but you know for those
of us working as a business what what
why does the business want us to do this
protect their secrets you're getting
closer there are two things it turns out
we want to prevent the loss of money and
prevent the loss of life maybe it
depends if you do that most of us are in
the first part the preventing loss of
money right but at the end of the day
that's really kind of what it comes down
to we want to prevent the company from
losing money or people from losing lives
and that really is the end of the road
there's a lot of other reasons people
may say they want to do security but at
the end of the day this is why and I
want to make sure that we we ground
ourselves in in these reasons and my
message starts with one very simple
thing if there isn't a reason to do it
stop too many of us just kind of paint
security with a big broad brush and say
well we're gonna schedule security right
because because security with no intents
nothing behind it just a mandate to do
security right we have these big
compliance drives and these these these
things that we do without a real reason
and this is how we get really
complicated controls and really
complicated mechanisms that basically
slow us down and stop us for me being
able to do our jobs anybody work at a
company where you can't do anything on
your computer
because there's too many too many things
on it you know that's that's not
productive doesn't help us all at all
what we want to do is drive towards
intent and reason behind what we do and
what I really want to get to is this
example so it'll start here this is a
web request notice points of anybody
else with what did what it actually does
or just trying to do but I want to take
this log line that's from an engine next
web server a post XML RPC that PHP from
you know a public IP address and with a
Googlebot user agent anybody have any
idea what this is looking for a Facebook
application to see if it can poke it and
try to do some interesting stuff with it
but what I really care about is taking
this event right this is a malicious
request and I want to connect this
request with the boardroom so why is
that important why is it important to
take that that single event and connect
it all the way through to the boardroom
it's the entire reason we're doing this
so the reason we're doing this remember
at the beginning is getting back to
preventing the loss of money at a loss
of life so this is the motivation this
is what we should be doing right if
we're doing security and the the
executives in the business aren't aware
of what we're doing or why we're doing
it or able to communicate effectively on
understand what it is we're doing it's
even spending money on we've missed
something entirely we haven't done the
right thing yet and for a long long time
it's been a battle it's been difficult
to go to the boardroom with security
because they don't understand it and
that's our fault by the way
the the boardroom understands that this
is more than any of us must remember
will in most cases and we failed to
communicate effectively why Security's
importance it's become a cost center
right it's it's it's a I spend money and
I don't get anything out of it right and
it's because we haven't effectively
communicated what we're doing and why
doing it we haven't demonstrated the
return on the investment and we haven't
demonstrated why it matters and so what
I want to do is start to string these
ideas together so I want to go through
the details and this is gonna be the
kind of the outline for our talk today
as well so first is threat modeling
threat modeling as a via that thought
vehicle or experiment I want to use
threat Molly to determine how and where
somebody will attack so what what's
what's exposed what do we see how might
somebody attack us and and develop some
real concrete scenarios and want to
measure I want to create some scenarios
some risk scenarios what might happen
what could we lose what would be the
effect of this this threat model being
realized I want to create risk registers
this is the this is the output to the
business the business sees what is the
one of the total risk we're carrying as
a company and those are kind of the
either thought experiments and then we
have to connect them up so what I do is
start to create systems that capture the
threat model so we identified a threat
and a threat model we've measured we
design a risk scenario and now I want to
build some automation to capture those
events are they dented see how often
they're happening and how likely they
really are I want to create systems that
update those frequencies and and make
our risk models come to life and then
what I really want to do is update the
register in a real-time so that effect
that communication with the business
that risk register the how are we doing
what's our total risk look like should
update all the time every day
it should be a near real-time system
what is the current risk I'm carrying
based on the threats I'm seeing today
but we can take a lot of time to imagine
what might happen and that's great we
should do that we should never stop
doing that but what we really want to
communicate is what's happening right
now
what are we affected by right now are we
being attacked well the answer is yes of
course you're being attacked but how are
we being attacked is it is it valuable
to us to know maybe we should change our
strategy maybe there's something that
we're doing that we could stop doing or
maybe there's something we should start
doing that we aren't yet and what that
helps us do is as we go to the the
whiteboard design the next thing to
build the next piece the next feature
the next system we can take these things
into account and use those as we design
our systems they're used for our cat
textural tools what's our current risk
is a great way to figure out whether or
not I've spent a lot more time upfront
thinking about security of the thing I'm
building and finally I want to repeat
this right as we get to these updated
real-time registers we want to go all
the way back to the top and figure out
if those threat models we created are
still valuable and meaningful and update
them and we just repeat all the time
okay it's a constant cycle what this
does is it creates security with purpose
and intent and when you do security it
should be like any other feature or any
other thing you do there's a reason
behind it how many of you take and build
a feature of a system with no idea what
it's supposed to do any of us I mean I
do sometimes I suppose but this is how
people should be treating security -
there's no reason not to have a reason
right and purpose and intent should be
driving that you should figure out why
you're doing security and apply those
reasons behind building real security
buying a product from a vendor and
posting a box in the network doesn't
really solve a problem it's just buying
a box from a vendor and then a plot and
then how you apply is what really
matters you have to understand your
threats before you design your controls
so before we can understand what we need
to do we need to understand who's gonna
be attacking us and what they're after
you know we have to understand where we
need to fit in the whole equation right
a lot of us want to be on the left right
it's not that we happen to be the best
or the most secure when you're the most
secure you're a target and you know it's
it's you want to be somewhere ahead of
the last people you want to be a little
bit a little bit less attractive than
the most attractive targets and a little
bit less attractive than the most
attractive targets so you're somewhere
in the middle right in terms of the
easiest to attack and the hardest to
attack you want to blend it you don't
want really stand out
but that gives an understanding of where
you want to be we want to figure out how
we understand
Ratz truly understand threats so threat
modeling is my idea for this I love dart
modeling as a vehicle for thoughts
it's a lot of people who have tried to
explain throughout modeling and is still
it down into a sentence or a paragraph
or whatever right but I have a more
distilled version of it relief for me
threat modeling is duck is drawing
documenting and prioritizing that's it I
want to talk about threat modeling but
I'm not gonna cover methodologies just
to kind of understand where everybody's
at in the room how many of you have are
actively doing threat modeling right now
great okay so fair amount of people I'm
not gonna go after any of the
traditional term modeling methodologies
I'm gonna talk about kind of the basics
behind it you'll recognize some things
that do that are extracted from current
methodologies but I want to kind of just
ignore the rules and start with the
small ideas that make this work
and then you can apply that to whatever
methodology you use you know back back
your job so we have a couple of things
first thing we're gonna do is open our
diagrams if you don't have diagrams
now's the time to start making diagrams
so I know that for a long time we had
this rejection of big design up front we
don't want to design our systems up
front and spend too much time you want
to have evolutionary architecture and
build systems as they go and that that's
fine right there's nothing wrong with
that we do want to draw what we're gonna
make or draw what we have made so we
have an idea of what it looks like a
picture and when we have our boxes and
lines every time we have a line at a
protocol right how is that line
communicating how does this line talk to
this line and what's the what's
information traveling look like for
every box we want to label the assets
both in transit and at rest so what
information is traveling over that line
and what information is sitting in
between those boxes or storage staying
on those boxes and then if you have any
controls what controls exist on those on
those boxes and over those lines and
they want to draw boundaries around
logical network groupings so maybe you
have a data center and then you have an
office and you have another office and
you have a coffee shop right logical
network boundaries can be big they don't
have to be really really discreet but
you want to have understand where is
their open Internet in between you and
somebody else or or untrusted connection
next we have a couple more things to do
we want to identify any assets that have
either weak or missing controls so and
once you have that picture it's very
easy and obvious to tell where you're
missing a control and then you want to
figure out how do you get in you may
have exposed things on purpose like a
website but how else do you get in how
do you manage system is it SSA age is it
VPN how do you get in and talk to your
systems and manage them update them and
the next thing is the absolute most
important thing you can do because we
can all do this stuff pretty easily but
you want to understand what the business
objectives goals and risks are without a
business risk there is no actual risk
right if we go back to the beginning of
the talk preventing loss of money and
loss of life that's all you have to tie
this to you need to identify a real risk
that needs to be assets at risk and you
want to map those business risks to the
ass they're missing controls or have
weak controls so you're tying the
technical risk to a business risk and
creating a real tangible thing and of
course you want to prioritize write
anything that's really critical should
become first and that's why threat
modeling for me is that vehicle for how
do we get to focus so here's a picture
this is very start so obviously you can
you're drawing style as is yours to
choose but this is kind of what I mean
right I have a database I have a web
application I have to trust owns I'm
going to call one a coffee shop or maybe
a conference and one my data center and
so when we see this drawing we have you
know a single asset a single control
there's way more that should exist here
but this is kind of the start of this
and I want to make it really clear on
how we may draw and think about this so
just by looking before we go before we
go further there are at least two
problems with this drawing two security
issues that we can see right away what
are they HTTP what about it should be
HTTPS why there's open in that between
and why else
yeah the first ones at a coffee shop
right there's plenty of reasons why that
the coffee shop is one examples more
important right and now we haven't done
anything yet all we've done is create a
drawing so we haven't done any threat
modeling yet we've simply just created a
view of the system so this by itself is
incredibly valuable if you don't have
this make this you'll need this for
threat modeling anyways and the result
is actually kind of nice outside of
security so once you have the foundation
you then to create the attack scenarios
so then we start to put bad actors or my
little you know cyberpunk emoji thing we
put them in different places and and
then think about it no no they don't
always have to stick around but you put
them in different places you put
somebody else in the coffee shop you put
somebody on the PC you put somebody in
the web server you put somebody on in
the data center on the network you put
somebody on the database right we put
them in different places and think about
what could happen if they were there so
I said I mentioned there are two obvious
things what's the other obvious thing
here especially now that you see this is
this drawing with these actors in
different places look at the at the very
far side of the drawing here the right
side what's sitting on the database
login credentials what's not sitting on
the database right now any controls if
you were gonna store passwords in a
database what control may you want to
put to protect somebody from seeing
those passwords encryption close hashing
password hashing right if I was to
assume the passwords are stored safely I
would have a controller that said I
hashed the passwords right that's the
kind of explicit thing you need to have
an ear and your drawings right because
that makes it very obvious oh I'm
protecting against somebody being on the
database and looking at patterns in
plaintext because if somebody got there
I wouldn't want them to just know the
password right away I would want them to
try to apply some kind of effort before
they finally realize the passwords of
brute-forcing now again that's us this
is a small example a very simple example
there are other things we may
be able to figure out as we go here and
we may want to apply it we can get
really detailed but that's not for this
talk but as we put these actors in
different places all of these scenarios
here are reasonable right somebody could
be sitting in a coffee shop somebody
could have control of a computer through
malware somebody could have broken into
a web server somebody could have broken
into a data center and been on the
network and somebody could eventually be
in a database now it turns out if
they're on the in the data center
they're probably going to get to those
those different pieces those are all
real I want to make sure that as we go
through this we focus on reality right
if you're a small retail commerce
company you probably don't have
nation-states
trying to hacky right don't worry about
that right if you're at airline company
you probably will have that so it
depends on what you're doing and what
your business goals are what's your
exposure is you know when you think
about capabilities of actors and reality
make sure you ground yourself right we
could spend a lot of time thinking about
the most complicated and advanced
attackers on the planet but if they
don't apply to us don't worry about it
right focus on the things that you think
are real day to day because you want to
clearly define the capabilities of the
actor as well it's not just where they
might attack you but it's how good they
are and then how good you need to be in
response to that and you wonder of
course understand what that business
impact is what are the true business
impact of them getting in right
if somebody's stolen account if somebody
got access to your database if somebody
was able to manipulate data what are
those things look like what is the
results and what are the business impact
here if somebody it turned your systems
off right shut you down it made you
unavailable wouldn't you get there they
need to drive risk this is hard by the
way so risk is actually one of the most
complicated and misunderstood things out
there mostly because there's immature
models I want to apply a model of risk
here that I think is really valuable
it's born in technology it's not a
financial model it's a risk model born
out of cybersecurity it's called the
fair model the factor analysis of
information risk now it
has an ontology and that goes way deeper
than this this is kind of a top-level
ontology and I want to talk about it for
a minute I want to use his model on how
we derive risk so first thing is we want
to know how often grad event frequency
so risk into is made up in two parts
right how much and how often well you
are you likely to lose something so you
have a loss event how many times would
that happen and when it happens how much
of a you lose to get there we have to
take some measurements how often is
somebody likely to attack you is
definitely one of them
loss on frequency right that's a
combination of how often somebody will
attack you and how vulnerable you are
and I'll talk about how we get to
vulnerability and federer in frequency
in a moment but really that's - how much
so how how many holes do I have what's
the likelihood of somebody being able to
get through them and how often are they
gonna try and the next is how much will
I lose when this happens risk is a
guessing game it should be educated
guessing but it's still guessing and
well we do this we want to have a range
risk is never a number because we don't
we're not exact we have no idea we're
guessing it's a range it's between this
and that so you have a primary a loss
and a secondary loss and then of course
probable and worst case loss how much
weight likely to lose and what's the
worst case scenario right what if
everything we had was stolen and when we
have how much and how often we get risk
now the problem here is we went into our
first problem what do you think it is so
we can we can understand from the
business what the impact might be but on
that left side what don't we know yet we
don't know how often we don't know the
third event frequency what I mean by
this is how often will a bad actor act
in a way that could cause a loss how
often they will each try to do something
nefarious or malicious anybody have a
good idea of this yeah so I mean this is
our answer we kind of like like that
much right no idea so this is important
this is truly important to understanding
risk is how often will this really
happen so we draw a circle around
something and we check
guest right how often might somebody get
on and infect a computer and then make
some bad requests to our application
well that depends on a lot of things
right but how often let somebody try
that's what we're going for
I can make it easier and say how often
might somebody try at a coffee shop or
maybe a conference Wi-Fi rather be there
to calm the conference Wi-Fi right now
just sniff traffic unencrypted traffic
on our network anybody doing right now
we're at the security conference after
all right so if you're on the public
Wi-Fi this is the time to get scared and
maybe put the VPN button on or just
don't join it all so again this happens
a lot right likelihood of somebody doing
that is actually pretty high and if we
have unencrypted traffic it's very easy
right the risk overall risk if you have
sensitive information its unencrypted
it's actually you know quite should be
quite high so in order to determine risk
we still need to identify how often how
often will this happen
now we actually have the information we
just don't use it in effective ways we
actually need to apply the information
there's a lot of ways of did you this
right we can do it with a sim anybody
have an active sim in their environment
at the moment anybody not have no idea
what a sim is all right so the overall
majority in the room a sim is
effectively a secured security event
management when something bad happens it
records it so somebody tries to make a
bad request to a website that first
request I showed you that will get
logged into a sim a computer gets
infected with the virus the log into a
sim somebody logs in to an account from
a unknown place it gets logged to a
synth any kind of event that is
nefarious malicious it's logged and a
sim is kind of the aggregation of all
that so think of your whatever logging
tool of choice is Splunk log stash
Cabana the query analysis any of those
kind of tooling think of that but the
only view you have is of security events
it's effectively what it is
now those are great but sometimes we do
custom tooling we build something that
analyzes this and looks for interesting
things we may have custom tooling
partners there are lots of different
tools out there that will look at your
application logs and tell you when it
sees a malicious attack or maybe just
tells you when you have performance
issues right those can also be
indicative of an attack there's a whole
bunch of custom - that you could add
here if we have some time I'll show you
what I mean by custom tooling I written
log parsers and analyzer that kind of
parse events and look for nefarious
things but whatever you do here you want
to use that data you want to collect
that data and use that because when you
see it that becomes threat event
frequency how often will this likely
happen now you may have to aggregate
multiple sources to get that idea but we
have a data because we have the logs we
need to make sense of them once you have
that you can deliver value because what
you have now is a model a scenario you
have the event frequencies you have the
impact you can deliver some actual value
to the business and the result is
focused in prioritization when it comes
to security and you need to make a
choice how do you make a choice of what
to do next a lot of us like oh I think
that's the most important thing so we
all go over there right if we do this we
know what the most important thing is
unless we miss something which is
totally reasonable and happens but what
we do is make an educated choice on
where do we go next
in general securities like kids on a
soccer field they got to go after the
ball and everybody kind of locks here
because Oh meltdown inspector happens or
this thing happened and so we all rush
to the whatever we think is the most
critical thing in the world and it turns
out we probably forgot to lock something
like the front door right maybe have an
API endpoint if I'm authenticated it
should have been that's leaking all of
our data out right way more important
than patching for something that came
out so we need to be a little more
conscious and aware of how we make our
choices and how we how we organize them
but
this talk is about adaptive threat
modeling so let's pretend we're doing
all that and let's pretend we've gotten
good at this so you may have realized
that things change most of the time all
day long and they change a lot every day
actually the things I just showed you
take a lot of time to sit down and draw
everything and model everything and
create scenarios and create a register
this is several months of work to an
active company if you're just starting
out it may be a little easier but if you
thought about the time it would take you
to do this at your current job it's
gonna take you quite a while to get
there you're not gonna get there quickly
it took a lot of time to get here and do
this and then you have a snapshot of the
world as you saw it when you made this
model once a year usually right if
you're gonna do any compliance they're
gonna ask you to do this once a year so
that's really ineffective but that's
that's good for about the next ten days
right so you spent two months three
months of the work to get a view of the
world that's active and realistic for
probably ten days and maybe a month and
for that all those other eleven months
of the year it doesn't matter it's
probably changed so we need a better way
to deal with this right we want to be
able to think about this as it relates
to our business every day so you want to
actually automate this so we want to
start building those threat scenarios
automatically so it's the threat
modeling thing is a great start because
we think about it all and we and we
think about what might happen and we
write some let's I don't know wrong some
of the time that's fine
it's it's it's a guess but we want to
automate this in a meaningful fashion
and that might sound odd because I
talked about ways to get there but you
know the automation part is is
interesting for me it's about behavior
behavioral analysis
so both predictable and irrational
behavior can be mob what I mean by this
is that we design systems for people to
use them and in our design if we've done
it right they'll act in a certain way
this is where user experience and
security actually
incredibly useful they're the same thing
right normally user experience and
security are kind of at odds they're not
really great together but if you design
a predictable path that everybody
follows all the time
you've won because you design a
particular path that everybody follows
and if you're you know in business to
make money that's what gets a good thing
but if you do that in terms of security
it creates a pattern that everybody
follows so when they stop doing that
there's an anomaly something that's
different it's irrational you can model
both these things and when you have
anomalies that's where you start to
create a view of possibly new threats
you can think about this as a steer II
series of requests in a state transition
model so maybe a directed graph right
you end up in something looks like this
that's all this is right it's a directed
graph it's a bunch of requests that go
from one to another to an end state when
you have this directed graph you can set
to prove the Markov chains for
behavioral patterns a Markov chain you
can apply through centers of requests to
say Oh an actor is somebody's trying to
steal credit cards an actor is somebody
trying to do that Facebook attack I
showed you there at the beginning that's
a that's a one state thing but most
attacks have more than one transition
before you understand what they are and
in order to identify those attacks you
may need to understand what they do in
two or three requests or five or ten
requests now it might take you a while
to get there but you want to do that the
fastest way possible the least number of
requests so you could say oh well you
know they they posted to login and they
never got they never did a get request
so that's that's definitely maybe there
they're probably a robot so every time
they do something a little bit off the
chain you can see that and maybe they
they might take ten requests to to get
to prove they're an attacker but all you
need is the first three to know where
they're gonna go next because everybody
that does this always ends up here right
and you can short-circuit that path or
if you're not sure you can do something
called predicted Monte Carlo on the
Markov chain say oh well their choices
from here are these three things and
most likely - it for my sample size I
know they're probably gonna end up here
and you can bump them into buck
gets before they ever get that this is
really interesting because you know at
first these are manual analysis right so
I might create a few of these Markov
chains after I see some interesting
things in my log but we have the data to
create it automatically we can use
clustering algorithms to tell us kind of
what sets of actors are alike so I I
really I I use the word I hate it's a
whole machine learning thing but I can
apply statistics to this I can use
clustering algorithms k-means K nearest
neighbor support vector machine
algorithms to show me hey what sets of
actors look alike right show me pockets
of people who are doing the same kinds
of things and you'll have a big big spot
of people doing normal stuff and don't
have a pocket of confused users because
your design wasn't quite right or maybe
you changed and a pocket of users who
are doing a certain attack and another
pocket pocket of users were doing a
different attack and each one of those
pockets it probably represents a
different set of state conditions you
may want to look at right and so these
clustering algorithms are great to
identify pockets of users and pockets of
people you may want to put into these
diagrams or into these these models and
you can use that request information to
give you identified by malicious
transitions these Markov chains that are
super valuable and say oh yeah I
definitely know they're an attacker or
you can use them to know oh my name is
my new design is terrible because
there's no identifiable pocket of good
users people use this path and that path
and this path and there's business
intelligence outside of security here
but it tells you that your design sucks
so there's there's multiple uses here
even outside of security but when you
have this identifiably malicious thing
you record it when she find it you
record it and that's that thread and
frequency thing once somebody starts on
a no known path you watch them right
you're not sure the malicious yet but
they started down that path
now they've hit two of the two of the
five pieces of your chain you know
they're probably gonna end up with that
at fifth state you record it they're
suspicious somebody took that path
record when they go down that path
because inevitably wouldn't you start
blocking them they're gonna evolve
anybody done a cat-and-mouse thing or
back-and-forth with a robot before how
often did you win yeah they just keep
changing right so they might have a user
agent of curl Gotham to block the curl
user agent and tomorrow they see their
Googlebot and so you have to do
something else and then that path they
take you block that off and they create
a new one they update right there
everybody's after something they'll keep
going and it's not fair because your job
is to run a business their job is to
attack you they spend a hundred percent
their time attacking you and you spend
like five percent of your time defending
against them it doesn't it's not it's
not fair right and so they're gonna
eventually win unless you have
automation that makes them go away and
you can take this incredibly far you
know once you accomplish this you can
identify intent capability so what I
said what I told you was just how often
an attack happens but that doesn't
actually explain everything here right
what are we missing
what did I talk about earlier that's
vital to an understanding risk that we
haven't done yet we don't know the
capability of our tackle yet we've got a
bunch of stuff to tell you when an
attack happened we don't know who's
behind that or how sophisticated they
are right that intent and that
capability are incredibly important risk
analysis I'll run you through a risk
scenario in a moment but capability you
could be identified through these chains
as well right using Markov chains you
can show capability because let's say
somebody does this the classic scenario
they're a robot and they post the log at
endpoint and they post at the endpoint
they're trying to attack and those are
the only two requests they ever made
they're obviously not a human or
standards-compliant browser because they
would have done a get requests they
would have taken a little bit of time to
type some information in they would have
clicked a button to go to the next thing
right that behavior is obviously
anomalous right so a a scripted attacker
unsophisticated attacker would just have
a script that did this over and over and
over again
and you turn them away really quickly
but a more advanced attacker would come
from a a normal user agent a normal
browser they might even use a browser
and drive it automatically and they
would do a get request and they would do
a post request and they simulate latency
between requests they may even simulate
mouse movement well it turns out if you
put an overlay on your screen and you
look at mouse movement you can tell a
robot from a human because robots just
go to exactly where they want to go on
the page without really doing anything
but a human will have fluid natural
movement and so you can look at those
kind of behaviors as well and you can
create chains and behavior based on that
and know that oh somebody might be a
little more sophisticated they might be
trying to blend in try to go unnoticed
maybe they're the frequency of requests
is very low maybe they didn't hear from
a million IP addresses versus one or two
and so they might be doing things that
are way outside of your capabilities
identified but you'll get there
eventually and so you know these Markov
chains could not only show you that
attack happened but how sophisticated
the attacker is and once you get there
you can build these threat models and in
near-real-time right so it's obviously
not real time because you have it takes
a while to propagate to the system but
the goal here is to do this in near
real-time I saw a Markov chain that if
I'd won I recorded it and then when I
when I had a frequency update I reran my
risk model and I got the updated risk so
that's the path from the request or set
of requests to the board the board see
that risk register all the time I can
pop it open they can look at it and say
oh my company is carrying an million
dollars of risk right now and if you
think it's less than a million dollars
you're fooling yourself every company
from the start has somewhere around a
million dollars of risk at least and so
it's n million dollars of risk that I'm
carrying today based on the scenarios
I've seen in front of me today or over
the past 30 days or the past 60 days or
90 days after that it's it's it's stale
but we want to be able to do this
because you want to be able to show the
board and
the people that run our company what
they're seeing so they can make the
right kind of choices right this is
where you want to be no other us are
here yet including myself you turn this
into continuous risk analysis right
that's the whole point every time
something happens I'm running my models
because my religious models that
programmatic you can write the stuff in
any language I'll show you a couple you
know when we're done you know it allows
you to justify what you're doing
based on right now right you may have a
control in place maybe you have a
CAPTCHA on your site
anybody have captions on their site
thank you uh-huh they're horrible you
may want to take a control or add a
control based on what's happening in
front of you right now and honestly you
can do it on specific actors so maybe a
specific actor is posing more risk to
you than somebody else right a risk
model could be aggregate or it can be a
specific actor so maybe somebody's doing
something weird here not quite sure yet
and you won't you could run a simulation
and say oh this specific person I think
or robot may be causing you more
problems in their worth let me go ahead
and add a control and you don't add the
CAPTCHA please don't or I'll add
something that may slow them down some
friction right it gives you the ability
to apply control to certain scenarios or
maybe we're gonna build something new we
say you know what in the past we've
always done this type of authentication
it's really aggressive and people are
confused by it but we have never seen
anybody attack us in this way so maybe
this time this new system we're gonna do
I'm gonna drop that control we're gonna
remove it and we'll look at it and model
it and see you see how it goes over time
and if that works maybe the rest of the
systems that we have will then adapt
that model right so we evolve our
security based on what we're seeing
right now and we don't always have to
apply everything to everyone again it's
based on risk one control may be good
for one scenario or one group but it may
mean it may not be good for others right
maybe some people in your company have
no data that's important they don't need
all those super big controls maybe you
know what they're doing is looking at
competitor
all they're doing is gaining
intelligence of competitors they don't
have any access to data maybe they don't
have to have all these rigid sets of
control to do what they do but maybe
you're running the whole system maybe
it's really important for you to have a
check factor and everything you do
because if somebody gets your keys they
get the keys to everything right apply
it in the right ways active risk
registers tell everyone the story when
we have a risk predator that's updated
all day long we see what we want to see
right we see attacks we see things that
can help us inform the rest of the
company and how they should act but the
magic here is not in the technical
details the magic here is in the dollars
and cents at the end of a risk scenario
you have a qualified law if it's low
it's medium it's high but you also have
a written at that dollar range right I'm
gonna show you the example here you'll
see this ends in dollars and cents
that's the way it's supposed to be right
the CEO of the company can't make a
choice on how to spend a security if you
tell them there have a vulnerability
that's insane
when you tell them that they'll just say
so who cares right
what do you tell them you know what I
think we're gonna lose two million
dollars this year based on this thing
I'd like to spend $50,000 to make it go
away now what we have is a real
conversation that's a tangible
conversation that anybody in the
boardroom can say oh yeah that seemed
totally reasonable now a good executive
team will say well why do you think it's
two million in white or two thousand
dollars saving you need to have a good
you know a detailed story to sell but
these registers are part of that story
right because they can say well you know
what yesterday this wasn't the case but
today is the case what is why is that
what happened a new CEO we were attacked
yesterday this is a real data right
yesterday we had this attack we think
based on everybody else in the internet
saying they were also attacked this will
happen again soon right maybe in the
next month one of my examples is from
last year there was a very big DNS
attack was a pied attack I took out a
majority of the internet I was been able
to take out part of Amazon and that day
the internet stopped
for most people right Netflix is
affected Twitter was affected some DNS
services were affected it was massive
after that they called it you know kind
of the IOT meltdown we're all these
little Internet of Things devices were
attacking everything people decided oh
we don't want it to happen again right
before that happened
nobody thought about it after it
happened everybody thought about it but
the people that reacted or overreacted
we're wrong people it took some time you
think about what could happen designed
better controls and they designed him in
a way where didn't cost him a fortune to
prevent from happening again right
people saw the symptom the DNS attack oh
let's put a lot of money into fortifying
DNS and fortifying the number the volume
of requests we could have happened and
everybody else said why don't we turn
off UPnP on our routers so that the guys
that just can't get out when they get
you know where they get hacked right
very simple solutions that was simply a
setting on a router that already existed
they spent a little bit of time and not
much money to do it right it's more
about the impacts what do we do how do
we spend the least amount of money to
get the most amount of return and that's
where that discussion with the business
when you're really thinking about what's
the least amount I can spend to make to
have the least amount of loss or the
acceptable amount of loss that's where
your win huge valuable so doing this
right when you turn that risk register
into an active real time thing you're in
constant communication with the business
you might have not talked to the
business every day you probably won't
talk to your CEO every day unless you
work in a small company but they can
anytime that point in time pull up that
register take a look and say oh here's
where at and if they ever go above a
certain point maybe an alarm goes off
and tells a CEO hey by the way what
we're seeing right now represents a
larger risk then you're comfortable
carrying we've gone over our threshold
so our threshold might be two million
dollars
we have attack scenarios that are real
that are happening today but I'm putting
us in a place for MIT where we're seeing
what could possibly a five million
dollar a year risk the CEO gets a page
and asked to respond to and say hey
what's going on why is why this is
happening and you talk and when you get
that kind of reaction that kind of
conversation you'll always get what you
asked for any
ever as anybody here working in security
most days so how often do you get
whatever you want all the times in the
business rarely right I always do always
do I get what I want because these are
the kind of conversations I have right I
get what I want because I don't ask for
much
what I ask for is grounded in actual
numbers dollars and cents it's not hard
to get what you want as long as you're
speaking in terms of reality business
right yes I want to patch every server
and yes I want to have the best static
analysis tool for the software I write
and yes I want to have all the best
things in the world but when I'm there I
have wasted the business's time and
money
I haven't served the business well what
I want to do is just enough and what you
want to do is be able to react what
you're seeing in quantifiable ways right
guesses low medium high those kind of
things are important for us to talk
about things in relative terms but I'm
gonna go to the business I need
quantifiable data right a life insurance
company that's gonna ask a bunch of
questions and derive a model based on
quantifiable information and say yeah
you're worth the risk or no you're not
worth the risk right we have to get that
same level of maturity we talk to our
business is it worth the risk
all right should I accept it or should I
change it but it gets everybody involved
right we are not the only people
responsible for determining what kind of
security we should add to our company
I've talked to so many CEOs that say oh
I have no idea why they're doing that no
idea right we don't know I spend 10
million dollars a year in security I
said well why don't tell me Oh cuz they
told me I needed to spend 10 million I
can secure here and I trust them it's a
terrible answer right when you can say
oh I spend 10 million dollars and here's
my here's here's the amount of risk I'm
willing to carry as a business and I'm
spending 10 million dollar because my
risk is about a hundred million dollars
and I think based on the set of controls
that they've told me about and not
controls in terms of Oh MFA right oh
well what they told me is if somebody
gets my my login credentials
I have this thing on my phone that I
push the button for or like to have a
number in and that makes it sure that if
somebody gets my password they can't
reuse it right they understand the
control in terms of the effect in the
company not the technical nature of the
control right so you take time to
explain the controls and wait it makes
sense what does this do
oh why is this button here or why can't
I ever log into this thing why so take
me so long to get there and that's
usually a smell but it gets people
involved and makes them make informed
choices that's the most important thing
informed choices why are you spending
the money you're spending it's all about
these models and most importantly you
can't do it all there's no way to get
all the way there there's no such thing
to secur secur does not exist for lots
of reasons but mostly because we can't
ever get there right if you were to tell
me you were secure I'd call you a liar
but most importantly I'd call you a fool
because it meant you spent way too much
money on security right now if you
protects me from loss of life you
probably can't spend enough money if
anybody's doing that there let's do a
thing I said but if we're protecting us
lots of money there is such thing as
spending too much and you can't do it
all well right there are so many things
in computing in general that are deep
specializations a lot of us are pretty
general some of us go semi deep and a
few topics but we can't do all of it
well we can't be the most up-to-date
people in the world on antivirus and we
can't be the most up-to-date people and
software security and database security
and firewalls and network design and
everything and operate system security
and we've proven to ourselves that the
most insane things had happened over the
past couple of weeks where ship
manufacturers have crazy bugs in their
chip design but we never knew about it
existed for ten years right there are
things that come up that we could have
never predicted and so we definitely
can't do it all well all we can do is
react right so we have to learn to focus
on what matters that's the big part we
have to focus on what matters we only do
so many things do the right things so
before I show you a couple of examples I
want to give you couple links so threat
modeling book calm
mrs. Addams shows tax book on threat
modeling it is what I would consider the
best book out there on threat modeling
the ideas and topics that he talks about
are great
it applies more deeply to larger
organizations so you may have takes them
over the grain of salt and apply it back
to kind of a smaller company if you work
at a smaller company but again my
favorite book at modeling at the moment
the middle link unfortunately there was
no real good URL is my favorite book out
of risk analysis and risk management now
I know it can be a far topic in terms of
not effective to day job but I promise
you reading this book will get you a
little get too in a lot of places it's
great it's by the one of the guys who
created the ferry model in the first
place and so it really talks about how
you think about risk and so if you never
use the ferry model ever the topics they
discussed there and the way they talk
about risk it's awesome I highly
encourage anybody reads it now the
bottom link I created a Jupiter notebook
that is the fair model and includes a
full Monte Carlo simulation and
everything into it you type in examples
back it up and then you run into the
Jupiter notebook it'll do a whole Monte
Carlo analysis of that scenario and give
you a range and so I you want to play
with fair model it's a great place to
start there are commercial tools out
there as well from a company called risk
lens which is that creator affair he has
a company that does this and you know
grand fashion but this is kind of a
quick way to start and those are my kind
of getting started pieces and underneath
that Fair notebook it's all just our
code take it use it change it do
whatever you want with it
totally totally free to use but that our
code could be extracted into that you
know that kind of tool behind the scenes
that runs your scenarios and in fact
I've done that in several cases and so
you can extract that and make it the
start of your continuous risk analysis
and your register register creation so
with that I have about 10 10 minutes for
questions
I'll take time for questions and if we
don't have many questions I'll show you
what some of these things look like in
code so we'll start with that questions
yeah but final tricky to handle false
positives yes
false positives and false negatives are
both a big thing now measurement is hard
measurement is very hard we get things
wrong all the time and actually as the
environment changes our assumptions
change with half change with them and
the reason we have so many false
positives or false negatives is we keep
a basic set of assumptions and never
reject them and so we think about
measurements we also have to think about
the null hypothesis right what does
normal look like or or maybe even normal
what does an attack look like to us and
the way we have an event is when we
reject a null hypothesis right oh I have
a standing thought and this breaks my
standing thought now because I break it
doesn't mean it's bad it means this
difference but it means I have to change
my thoughts so I may I may I may assume
a new null hypothesis based on in the
new information and so what I find is a
great way to deal with those false
positives and false negatives is strong
beliefs loosely held right I have I have
a thought and it can change at any
moment with new information and we have
to be fluid in how we think about things
in order to adapt to false positive or
negative so yes it is hard but I think
the hardest part is that we tend to
stick to a basic assumption and never
change and if we can't do that we'll
never get there yeah how does it apply
to small companies same way right what
I've talked about you can do in a very
loose fashion a very small fashion it
doesn't have to be a big enterprise
thing you can still make drawings you
can still record events you don't have
to have a sim you can put things in your
normal log system right you throw things
into the log stash with other things in
a sumo logic or Splunk make a couple of
reports and views that are just based on
security and use those to update events
right take what you've got and make use
of it right the the fair notebook I told
her you can use that you would automate
you can extract the code out of there
and run that through his automation
right you can do it in in a loose or
cheaper fashion and
spent a ton of money to get there right
it was a small company you probably have
more access to the CEO and people to run
the company or maybe you are the CEO and
so you know think about the loose
definition of the tools they can still
be applied the concepts apply to any
company I highly encourage startups to
do this kind of exercise there's a lot
of startups will go through a period
where they're finding a market and they
find it and they get that first round of
funding and they've ignored security and
that's great
i every every startup should probably
ignore security until they figured out
whether or not the thing they're
building is worthwhile right because
otherwise they're gonna take too long to
get there but once you get there you
have to stop and focus and so it's
especially important for that kind of a
round series of startups to focus on
this stuff the right way because have
you've ignored it and now all the sudden
you start again you have to figure out
where to go first and so I've actually a
majority of my clients are all those
companies that just found their market
and getting in it said what do I start
what do I do
right this said this this stuff helps
you figure out what's a co first and so
as a small company it's incredibly
important to do that exercise as soon as
as soon as possible right yes it's great
to do it early on but I don't advise
people to do that until they know they
have a product that people want to buy
so find the market fit but then
definitely do these exercises are the
questions
yes the question is there any tools I
can drop in kind of build these Markov
chains not yet I'm certainly working on
them there are tools that will help you
identify attacks right and so definitely
you can use those tools like oh I
thought an attack and you look back and
see what they did and build a Markov
chain from that but there's no like drop
in law with extract Markov chains tool
and in fact that's an implementation
detail what you really want is give me
get let me know what an attack happens
right for me that part matters because I
can use that to do a bunch of things
let's say I have a Markov chain and I
said I have an act as a group of actors
and I blocked them and they evolved so I
have first generation and second
generation third generation and I have
my normal my normal flow Markov chain as
they evolved I know what their
possibilities are there's a finite
series of requests that can make I can
start to predict where they gonna go
next so I can say oh I have four
generations second generation third
generation oh they evolved like this
here's the evolutionary pattern that
they're taking they're gonna do this
next so I know that I'm gonna start
blocking this generation and the next
generation they're gonna go here I can
predict it so I can do some really cool
stuff in terms of knowing what they're
gonna what their next move is one of you
that I can always stay one step ahead
and I'm not responding or reacting I'm
actually planning when you get there it
becomes really way more valuable and so
while the Markov chains are an
implementation detail are useful for
larger things and just creating that oh
here's what it attack looks like I'm
gonna use it to be proactive so it's the
answer question in a long way know the
tools don't exist as far as I know
so you extract a Markov chain but again
I want to caution that's an
implementation detail couple more
minutes yes
you
yes so for small companies that changed
every day you have to automate right if
you're moving quickly the only way to
really get a good view of this is to
build the automation right if you work
at a bank that releases it once a
quarter these are these are easier right
you can do these on a regular cadence
but if you're at a startup that deploys
10 times 20 times a day and everything
you do is responding to everything that
happens daily the automation becomes so
much more important and so I would say
for startups the automation is way more
relevant than a bigger company that
moves slower make sense all right any
more questions so we're just about out
of time for me to give you an example
but I'm here all day so grab me if
you're interested in seeing some code or
seeing small examples I have a bunch of
stuff that I built and I'd be happy to
show it to you we have less than two
minutes left so it's final now it's time
to go to detail so thank you very much
and come find me if you want to see some
examples</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>