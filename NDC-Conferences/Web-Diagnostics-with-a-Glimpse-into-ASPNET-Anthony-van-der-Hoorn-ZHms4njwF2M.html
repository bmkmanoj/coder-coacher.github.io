<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Web Diagnostics with a Glimpse into ASP.NET  - Anthony van der Hoorn | Coder Coacher - Coaching Coders</title><meta content="Web Diagnostics with a Glimpse into ASP.NET  - Anthony van der Hoorn - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Web Diagnostics with a Glimpse into ASP.NET  - Anthony van der Hoorn</b></h2><h5 class="post__date">2016-09-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZHms4njwF2M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">that's also but you know to get that to
get us started because you know I think
this is funny you know with like Nick or
happening and you know open source and
all this sort of stuff happening within
the community I thought I'd show this is
it's kind of a little bit funny you
haven't seen it before they appear to be
the perfect family member melindam
slieve little minion slick a little Yin
Lee for a collective motion but
sometimes appearances can be deceiving
your first exam Audrey take these flat
literally alter Scylla also as a young
boy discovers a new world unfolding as a
daily lube is 64 tall vertical a Vorta I
learn why your chemical signal
may Allah open to the woman I for being
young is all about experimenting
multiple my design we're but a secret
can't stay a secret forever or what over
to learn more yeah blue key ova
but I do see if you can prove your
mettle spokes making boy forget your
windows fine double its head okay
whatever you tell you from Microsoft
Emma to say Microsoft usenet percent of
niggas all day so
but sometimes the truth comes with a
terrible price mashaallah la cosa don't
let a bad run over another night the
star on my crew so funny de llamar me
better the community in the setting a
role in setting issue Ichigo hairs from
Microsoft you're awesome from the clean
director of Java tar and duck not Eddie
larrison Scala Joe handsome two-time
golden do coiner William window the bars
run a compelling performance by mona
lisa drive and introducing Lenny Linux
java forever
has anyone actually seen that one before
Matt that's freaking awesome I think you
know it's just it reminds me of the
times we live in that you know that was
made I don't know five or six years ago
maybe even more now I remember seeing
when I was in like University and and so
it's like you know the joking about you
know cross cross platform you know
considerations and you know where net
can actually run and you know all these
type of different things I think it just
shows how far doughnuts come you know in
the years since something like that was
made so welcome to you know web
diagnostics with a glimpse into asp.net
so we've increased our numbers from like
to that we started to you know we've now
got six bring it on okay so but I do
have to say you know and maybe I'm just
being self-deprecating here it just for
everyone who was wondering I am NOT
Scott Allen so if you're expecting to
see scott allen talking that you've come
to the wrong room and it's okay you can
still leave if that's who you were
intending to come and see i will be very
heartbroken you think that guy had a
heart attack over like Jays some
programming Java like one sixth of my
audience leaving that would be extremely
heartbreaking to me so be careful of
what your decision is okay good no one's
leaving so who's actually from Australia
is anyone international here so we go no
you're from Australia yeah anyone else
so everyone's from here ok so it's
Sydney hands up no one person from
Sydney what about Brisbane yeah I'm from
Brisbane too ok and so what about
Melbourne okay three so Adelaide in the
corner with the yellow shirt perf
Tasmania
oh I asked who was international before
ah okay there you go anyway okay cooker
well I currently live in the United
States I work for Microsoft i live in
Portland Oregon and I spend all my time
working on Diagnostics for the web and
so I think that's pretty awesome and so
today we're going to be trying to figure
out what we can do to help make you guys
better and so welcome as I said my name
is Anthony if you've got any questions
we've got a small enough audience here
feel free to just yell out or put your
hand up and we'll get into it and if
you've got any questions feel free to
hit me up on Twitter or anything like
that post this talk and we can get into
it so you know today you know as I said
we're really looking at like how we can
make it guys awesome and making you
awesome is all about trying to help you
understand what's actually going on
inside of your web application and you
know how we're going to be doing this is
looking at Diagnostics for the web and
so if you've ever had that question
about like what is my application
actually doing you know what actually
happened to fulfill this web request
that I just made those are the type of
answers that we're going to be giving
you today or attempting to give you and
we'll be having a look at a vision into
the future of what's actually coming so
let's actually take a quick glimpse here
so who's actually heard or seen glimpse
before anyone so one person great so
let's actually have a look so I've got
mbc music store okay everyone's seen
that before it's kind of like a online
e-commerce store you can go by different
albums Adam to shopping cart and all
this sort of stuff really really typical
ecommerce sort of sight and the one
thing that's different here though is
you'll notice the bar at the bottom of
the page okay that's giving you
information about what's going on here
and what you'll see straight off the
get-go is that we know that the page
took 14 milliseconds to a 14-second
sorry to load okay and this is happening
because this is the first time we ran
you know the jet you know compiling
everything can whatever also it takes a
little while the first time and we can
even break that down to know that ok
well 235 milliseconds happened on the
server
verses 14 milliseconds on the server
okay and then on the client it was
actually pretty fast it was only 233
second milliseconds okay and so we can
start breaking that down and when we
break that down even further we can see
well the actual action okay took 822
milliseconds and then the view took want
just over one second and so you might be
wondering well where did all the rest of
the time go turns out that's all
happening with the compilation and jets
and everything like that okay and so
that's where that's going but we can
also know that we had three database
queries that occurred on this page which
in total took 25 milliseconds okay so
right from the get-go we can start
seeing you know some of the data
information about how our pages
performing you know where time
considerations are going wheres
different slow points might be okay and
here's another page which is probably a
little bit more typical of your
rendering that you'd expect okay because
we're not doing that compilation or
jetting or anything like that beyond
that we can actually kind of mouse over
these different sections and get deeper
data so here we know that what the host
name is if we were logged in would
actually get kind of a login credentials
that show up there too and then we can
actually break down the server even more
than that okay so we know from
previously that the server time action
was 229 milliseconds but we know how
much was the rendering how long was on
the server we can start breaking down
the different actions that occurred and
in.net core IKR asp.net core nbc's got
the concept of view components as
opposed to child actions okay so we can
actually see those broken down as well
we can see that each one of those items
had a database query within them okay
and we can see exactly how long that
took so typically if you didn't have
something like this and you're trying to
figure out like oh that page just went
slow who's ever had that occurrence
where you know you navigated to a page
and it's like it went slow and you're
like did that really go slow and then
you go back in your hit refresh and it
went fast and you're like well can't do
anything about that now I've got no clue
anyone ever had that before yeah okay
cool so with this this is where you can
actually go that felt slow okay and you
can actually start digging into
what was actually the cause of that
problem okay if we had Ajax requests on
this page would see the Ajax ticker you
know showing those different requests
that occurred and then if we want to
dive even deeper if this information
wasn't deep enough okay we can click on
the G ok and that opens up this web
portal and we can actually see a
breakdown of those requests even more ok
and so we knew from previously the
previous screen that we had the main
action that occurred and then we had the
to view components and we can actually
see that and we can see the sequel
statements that actually made up those
requests Mako those queries ok so is
this sort of making sense like we're
trying to give you of this visual
picture of what's going on within your
application oh cool now just to you know
as a stating up front you know all of
this is you know one hundred percent
free ok it's available today it's just a
nuget package that you can install
within your project one hundred percent
open source ok so if you're interested
in how we're collecting any of this data
you can go ahead and look for yourselves
ok so that's kind of like the basis of
what we'll be looking at today so from
there let's get into this and kind of
like diagnostics and this is like a
little bit of the history around how we
came to what we've got here and you know
kind of what makes some of this stuff
tech you know I really felt as if
Diagnostics is one of the hardest things
that we can do okay there's this famous
quote by Brian here that says debugging
is twice as hard as writing the code in
the first place therefore if you write
your code as cleverly as possible you
are therefore by definition not smart
enough to debug it who's ever felt that
before ok I know I have and this is a
problem because forty to sixty percent
of our time we spend debugging ok and so
this is not that great ok because when
we go into debugging mode we're dropping
out of that creativity mode I know that
you know when my mum asked me what I do
I tell her I'm an artiste you know I
create things and whatever else and she
calls BS on me but you know it
that's that's what I feel you know it's
like I'm really in the zone of what it
is that I'm doing so if I need to drop
out of that to try and figure out you
know what went slow or you know what was
a query that was actually produced there
that's a big issue okay and the other
thing is the web isn't simple okay it's
only getting more and more complex as
much as you know we at Microsoft are
trying to make things simpler the
landscape is getting more complex okay
and so the more the more ways that we
can actually break this down and try and
you know give you more visual guidance
and more tips as to what's actually
going on that's only a good thing so if
we take a look at like what the current
approaches and you know some of this the
reasons behind why glimpse was born was
out of this kind of landscape and so if
we have a look you know fundamentally
debugging and diagnostics hasn't really
changed in the last 20 years okay we
still have break points okay we all
we've all seen screens like this where
we've set breakpoints all over the place
to try and figure out what's going on
we've still got log files okay and who's
ever trawled through one of these log
files trying to figure out what's going
on the area and we've got kind of like
static analysis okay and reality is is
these tools aren't really good enough
you know something's kind of missing
here and so when I start thinking about
this and breaking it down you know I
start thinking well these tools are too
low level okay they feel like very very
blunt instruments okay and you know when
we have a look at like these break
points that we got you know it feels
even like a bit like a code smell okay
except this is more like a tool smell
you know the fact that we have full
command pallets and stuff like this to
configure your breakpoints something's
wrong with that you know we you know
it's the 21st century we should have
better tools okay we should have better
things here you know and trying to
correlate you know all the log
statements for an individual given
request you know that's not something we
can just do you know it's not just a
given and the other thing is the runtime
is dynamic okay like when we have a look
at how MVC does what it does you know
with different filters that can augment
what's going
on air even now in asp.net core you've
got different pieces of middleware that
can be a play and so something suddenly
changes your request to a 500 you know
what did that okay as far as I was
concerned when the action and the viewer
complete it was a 200 you know what
changed it to a 500 okay where did that
go wrong or it went from you know 200 2
or 3 04 where did that happen why did
that happen okay and so things are only
getting more complicated and complex and
reality is if with that complexity
static analysis can I only get us so far
okay because the runtime is kind of
where the truth is okay and context is
kind of king of you know what's actually
happening and so this brings up
something important questions that we
you know start to ask ourselves if we're
wanting to address this and you know
this kind of brings up a little bit of
the history around how glimpse was born
you know wasn't a product that came out
of Microsoft actually started about five
years ago when I was working in New York
now standing on a subway platform with
my business partner Nick and you know
we're talking about how do we educate
people about how MVC one works okay
because if you put yourself back into
like MVC one days or even you know under
classic asp.net trying to figure out
routing you know if you'd come from like
web forms background where an individual
page you called a URL you know that was
hugely different okay or even the basic
filtering that we had back there and
trying to understand how that worked or
model binding any of these different
things was really complex and at the
company we were working for we were in
charge of educating people okay so how
do you convey those condos concepts to
people okay and this is where we started
coming up with the concept of what
glimpses turned in today and into today
and will continue to evolve too so
literally we were saying well we as
developers have a mental model of how
the application is put together okay and
that mental model is typically informed
by the different frameworks that you
actually use so how can we build a
physical picture of what's going on
within your application based off what's
actually happening at runtime
okay and the other thing we were trying
to do is how do you know if things are
running as expected and we've had a
we've had had some use cases back when
we were working on this like a you know
in terms of like educating people back
at before glimpse was created where it
turned out that one of the issues we had
was that this user in Turkey was
complaining about a particular issue and
it turned out that the way that MVC
processes data sent by the in the post
rather than the get is interpreted
differently in terms of cultures okay
and so that works really well if both
cultures are English but as soon as one
was Turkish and one was English it
started to play up okay and these were
the types of problems that we were
wanting to to solve so what if it's
possible okay and this is where you know
we started thinking okay well what tool
could we actually build to do this and
that's kind of like enter glimpse and so
we started we're on that subway and
we're like okay well we know we want to
get this data okay so we've got to start
aggregating this data together and kind
of saying to crunch it and try and you
know figure out how we can actually
build the mental model okay we'll build
the physical version of the mental model
that you have we also wanted to bridge
client and server okay so a request
isn't just what happens on the server
okay it's also what happens on the
client and so what we were trying to say
is ok well if a request isn't just wine
or isn't just the other how do we build
something that gives you that mental
model of everything that happened from
the click you know over the network onto
the server maybe you've got some micro
services to other services that are in
play back over the network to the client
and continuing on past rendering that's
what a request is and at the moment our
tools it give us one or the other a
visual studio gives us a server very
nicely okay and f12 tools give us the
client very nicely but both have a black
box as far as the client is concerned
okay and the other thing that both of
those tools tend to suffer from is what
I was saying earlier on and being very
blunt instruments they're very low level
okay so you know we're wanting to raise
up the level of abstract
here in terms of you know the way that
we think of things we also wanted to
have like framework level insights okay
so based on the frameworks that you're
actually using how do we inform what's
actually going on you know what happens
if Visual Studio could actually change
based on the knowledge that any of that
you're using entity framework or that
you are using MVC you're in hibernate or
whichever framework out there that
you're actually using or even you know
angular versus react you know what would
you want to see okay and so this is the
path that we started down so let's start
having a look at okay so what we're
actually looking here at here is early
beta version okay of glimpse v2 okay and
so glimpse v1 is kind of the mature
product that we have out there for the
moment okay that targets classic asp.net
scenarios and so let's have a look at
that and this is something that anyone
can take a look at and get up and
running and kind of like demo if you
want to have a look at things once you
once you get back home okay so this is
as your website okay and so if anyone's
got a laptop you can go there now and
start playing around with this stuff if
you want to okay as we've already stated
we've got this bar at the bottom of the
page which is showing everything that we
have now the experience is a little
different as I said this is a v1 that
I'm showing at the moment okay for
classic asp.net I think it's running on
an MVC 5 app okay we'll show you this
first okay because this is more feature
complete because what I've got for asp
net core is much more in its infancy
okay and so we've already seen kind of
the guts of what these different tabs
can do when we mouse over them here we
can actually see a news ticker okay of
Ajax requests that are going through in
real time and so this is something we
didn't see earlier so as this goes tix
through we can mouse over these and we
can actually see those requests
happening in real time now the reason
all of these have got the same URL and
pretty much look all the same as it's
just pinging
loop you know the particular news feed
to try and get the data back ok so these
results are to be expected but you know
if we wanted to see any one of these in
deeper detail we could by just clicking
on these but for here now we want to see
the actual detail of this particular
request so for here we can click on the
G and up will pop this panel ok and so
from here we can start diving into a lot
more information ok about what's going
on which actually make this request so
kind of starting off we're looking at
configuration settings so in classic
asp.net we have web config in a spinet
call we've got your configuration system
you can imagine this working the same
for.net core as it will does for.net
classic so here we can actually see
we've got our app settings and so who's
ever been in a situation where you don't
necessarily have access to production or
something like this and you've got a
small update which might include a web
configuration change and you've done the
deployment ok but it's someone else
who's in charge of doing that in like
DevOps or something like that and so
what you've actually done is you don't
know whether or not the change is
applied has anyone ever you know been in
that sort of situation yeah ok and so
here what we can actually do is go in
and actually see ok what the settings
actually are again how they've applied
so here we can actually see you know
whether or not this particular setting
is disabled or not ok or likewise you
know we've got some glimpse particular
settings here we can see what's at play
there we can also see what our
connections strings are ok and so from
here we can see not only the raw string
ok as it was registered but we can
actually see how the system interpreted
that ok so for here we know how the
system is actually interpreting our
query string and we can see that the max
pool size is actually 100 here let me
try and see if I can increase the font a
little hopefully that's a little better
ok so we can see that as we continue to
go down we can even see how our
authentication is set up ok and this for
this particular app it's not very
interesting
d but if you add a more complex
authentication setup we would see all
the information broken down you know how
that's actually process we can see the
role manager okay you can start see a
pattern here we're seeing everything
that's registered within the system okay
and finally we can even see like the
HTTP modules and handlers who uses HP
modules or handle is inside of their
apps we've got 12 so it turns out these
things are actually hooks okay for those
who haven't used them or seen them
before of you know how you can tap into
different parts of the page lifecycle
you know arbitrarily or how you can
actually serve up assets okay which is
the handlers and it turns out like you
can't really predict the order in which
these things will run in any
deterministic way okay so there's a
class of problems that you can have the
reliant on knowing you know the order
that these things have run or registered
or if they're actually registered at all
okay so here we can actually see that
glimpse itself is actually registered as
a HTTP module okay that's how we
actually know what's going on and where
the different parts of the page are
actually loaded and stuff like this
track in the beginning and end of a
request we can also see h2b handles okay
and again we can see glimpses registered
here because actually got an endpoint
that serves up these assets okay because
everything that you're actually seeing
here this isn't a browser plug-in or
anything like this this is just
JavaScript and HTML and CSS injected
into your page and we render this bar
into the bottom damn so that's what
we're actually seeing here and again you
can see the my new details of how all
the stuff is actually registered okay so
from here we can start having look at
environments ok so again kind of in that
like deployment scenario you were told
you were going to be migrating from one
machine to another machine did that
actually occur okay have I actually gone
to that other machine you know I was
expecting a particular operating system
to be there okay has that happened you
know when was the last time the machine
was restarted and all these sorts of
questions that you might be wondering
when you go to like test or production
and we can start unveiling those even
though you might have
you know access admin access or rdp
access into the machine to be able to
manually verify these things we can see
the version of windows server or
versions of net and again here's kind of
like the cultural information starting
to be serviced surfaced so we can
actually see that we can see the process
breakdown so if you're trying to tie
that back to a process that needs to be
killed or something like that we can see
that pretty easily timezone settings
who's ever been in a situation where you
know the time zone of the server was off
or something like this and hence you're
seeing or like the invoices being
processed before they're actually
ordered or something weird like this
yeah okay so we can actually see these
details ago without having to do that
our DP we can actually see to what
application assemblies were loaded okay
so these are kind of like the different
dll's that you've manually added to your
project you know versus all the various
different system assemblies that have
been loaded what their version numbers
are you know from nougat and all this
type of things okay where they've
actually been loaded from as well right
so really really important environmental
data so what we've seen so far is a lot
about how the environment that you've
been in how its configured you know
answering the sort of classes of
questions that we've talked about so far
yeah but from there we start walking up
the stack a little more again we start
thinking about well how did this page
what actually executed to make this page
run okay and that's where we actually
come to something like the execution tab
so here we're actually seeing you know
the different filters that actually ran
so we can see the first thing that
actually executed here was the
unauthorized filter for the home
controller action and we can see that
that actually took 20 milliseconds okay
because that's just a empty core that's
just an empty signature that you can
override or an empty method that you can
actually override versus on executing
okay versus on executed okay and then
you've actually got the core action
itself which is where most of the the
fun here happened
and so when we're having a look at you
know why did this page take the time
that it did it wasn't the core action
that took the length of time here it was
actually the cart summary that took up
the majority of time here 175
milliseconds okay and it wasn't the
actions or sorry it wasn't any of the
filters or anything like this so if
you've got your own custom filters that
are at play you'll actually see these
registered okay and you'll see them in
there in the order that they've actually
executed and because I challenge anyone
in this room given like global filters
action level filters control level
filters and other sort of stuff to list
the order in which all of these things
are supposed to execute and again that's
kind of that static analysis view of the
world doesn't really offer you what you
need if you're trying to debug this sort
of class of problem runtime is where the
truth is we can also start getting into
like routes in this particular route you
know for this particular system isn't
all that interesting if we can imagine
once you start getting tens twenties you
know fifty routes trying to understand
why did a particular route match okay
why didn't another one okay we can
actually have a look and tell you okay
let's say you've got constraints
registered you know each was how it
evaluated each of those different
constraints and for individual
constraints what if a pastor over failed
yeah because you might have the same
let's say a URL registered okay for
multiple routes but the constraints
might be very different between the two
and this is where that sort of thing can
start telling you why one yet try
figuring out where to set a breakpoint
to tell you why that happened okay you
can't unless you start working from the
MVC source code and then you get in that
situation where you've set hundreds of
breakpoints all over the place to try
and figure out things we can also see
you know for these different tokens what
was the placeholders that it picked up
from that so understanding how it
evaluated what you'd actually registered
and what were the default that it
actually set there okay and then we can
actually see what did it actually and
how did it actually evaluate that so
from here we can actually let's say go
to another page okay and we can
either instead of have been matching on
home and index okay it's that that was
the default but it actually matched on
store and browse and we can actually
even see how long it took to evaluate
these turns out there's some edge cases
where you can get into where you can
actually create a route that's really
expensive to evaluate okay so here we
can start seeing you know well am i
doing things efficiently you know for
the system that I have we can even start
getting into abuse here okay so in this
view in this system at the moment we've
got both the web forms view engine ok
and the razor view engine registered in
the system which is what NBC or classic
MVC does by default and you've got
multiple view engines registered and the
vast majority of people only ever use
the razor view engine okay so you can
probably disable or remove the other
view engine right out of the box okay
now it turns out MVC actually does some
optimizations here so the difference of
actually doing that isn't going to be
significant okay but it is there and we
can see the order in which it tries to
do things okay so because this is in
production things are optimized and it's
cash the results and all this sort of
stuff so we can't actually see that at
the moment here okay but at that time
what you'll actually see is the
different places that have actually
looked on desk okay for the different
views okay and whether or not they're
actually matched or not why they were
actually not matched okay then finally
we can actually see that right we didn't
find a match okay and what was actually
passed through to that view okay and
what were the value is in the types and
everything like that they're actually
passed through and so we can see that
you know we've got these two entries for
brows card summary and genre menu okay
so we can follow that through through
the system we've also got things like
request data so here we're looking at
kind of like the headers and the values
and the query strings and other sort of
stuff for the request and response and
you know you might be saying well I can
get this from the f12 tools well it
turns out the f12 tools give you this
data from the perspective of the browser
okay it can tell you what the browser
sent
and what the browser received that but
that can be very different to what their
server actually received and what the
actual server actually responded with
and I've been in situations before on
client site where it turned out they had
some proxy in the way which is modifying
headers okay so this is where you could
actually use this data to start figuring
out okay well if something goes wrong
what's the service perspective on this
okay and start actually breaking that
down we can get into like model binding
you know how is that actually
interpreter and like looking at like
that as I said before like the culture
and you know the different ways in which
it tried to match the values for the
action that you've got metadata okay if
you're doing cool things with Auto with
binding to input elements okay and using
the metadata system to help provide that
okay we can actually start getting right
into that and into the details there
okay so from that we start realizing
that okay cool would now have a pretty
good understanding of the server okay
how MVC's working yeah but what about
our database okay what data can we
actually get out of it okay and what
understood what what understanding can
we actually gain here and so from this
we can actually go to the sequel server
tab and we can start getting out some
details here so right from the get-go we
know that this page actually has three
different connections okay that we're
cause and three different queries that
were executed and so from this we can
start correlating what actually happened
here so we actually know how long the
total connection or all of our
connections were actually open for and
how long we're actually executing on
them for so in this case we can see well
the connection time was you know a 530
milliseconds and total query time was
526 milliseconds so we're pretty optimal
like we only really opened that
connection for the length of time that
we needed it but you can get into cases
where you might have opened that
connection for a thousand milliseconds
and you've only got 50 milliseconds
worth of execution on it okay so that
raises question can we closest
connection earlier you know
how can we do that and again without
tool so there's how would we actually
know whether or not that was the case
the other thing that we know here is
that we're opening a connection / query
that we actually have okay and you might
be in a position to go well you know can
I actually pull those together okay so
i'm only using the one connection you
know maybe you can't but you know maybe
that's something that we can do then we
can start breaking things down into the
actual queries themselves okay and so in
this case entity framework is actually
we're using a new framework as our
provider and hence why the queries kind
of look the way that they do but that's
where we start going okay well this is
the entity framework query that I wrote
it's not working the way that I expected
it to you know how can actually tweak
this and so even do some small niceties
here where you know the the underlying
queries might has this actual parameter
that it puts in here but we can actually
put the value in there so you can copy
and paste this and execute it directly
against the bug database if you're
trying to trying to tweak things or you
know see what the raw values were and
all this sort of stuff we could see
those parameters broken out by what
their types and values were and things
like that as well we can see how many
records were returned what its
individual duration was because remember
up the top here we could totaling all
the durations for all the requests for
all the queries but we know this
particular one wasn't the one that was
expensive here we can see the offset of
where it occurred where there was a sink
or denied etc etc so you know trying to
dig down on why this particular total
query time here or execution time was
526 milliseconds if we come down we can
see well this last query here was only
one point seven milliseconds so the
problems are not there okay turns out
this is our expensive query now in this
particular case line I don't have an
idea of why this would be slow okay but
what we can actually do is we've now
identified that this page was slow
because of this individual query so
pretty much with excluded the rest of
our app is the root of the problem again
we've narrowed it down to this one query
and that may be the case that we need to
do some better end
xing or you know who knows what it may
just be a freak occurrence of what was
going on there but we've really narrowed
down and isolated that problem so from
here you'll have noticed that on these
various different tabs we've got a lot
of timing data okay and so the question
starts coming well you know Anthony you
showed me over here on the left you know
filters and executions and routes over
here and model binding you know this is
really good but you know these things
relate together how can I kind of get an
overview of everything that's going on
and that's where kind of like the
timeline tab comes in okay and so from
here this might look a little familiar
from like the f12 tools okay but what
we're seeing here is from the service
perspective okay and so we can see like
right the request started up here but
then we've got those different filters
that were executing until we actually
came to the controller within that
controller we can actually see where the
database connection open when it was
closed how long the query actually
executed for this is the particular
command oh sorry query that took five
hundred twenty milliseconds so we can
actually see where that occurred in
relation to everything else and again as
we kind of navigate around the system we
can see this information updating in
real time as we go from tapped tab so so
you can see that updating and again this
query is the one that's slow so I would
have a pretty good hunch that as we've
gone from page to page this one's been
consistently slow this is where would be
best to kind of put our energy into
trying to fix you know the perform
potential performance problem that we
have here and even down to things like
we can start getting into trace and this
particular app we're going to go a few
trace statements in here just kind of
the demo the feature but at the moment
if you do like console logging within
your application is kind of hard to
correlate the log statements back to the
individual requests that it came from so
what we can actually do is listen to the
logs that have been generated for a
particular page okay correlate those
together and show them back to you
so really trying to make the logging
information that you put out or
different frameworks that you put out
really trying to make that sort of stuff
useful okay finally we start thinking
about things like Ajax as I mentioned
before and we've got this Ajax tab that
we can come to and so as Ajax requests
actually happen within the system will
see them appearing here in real time
okay and so for any one of these we can
click inspect okay and we'll see all of
the data that we've been collecting here
for that particular Ajax request yeah
that's because an AJAX request is just a
request there's nothing particularly
special about as far as a service
concerned and so what we can actually do
here is click on this and when that data
actually comes in okay we can see all
the tabs pulsing kind of meaning they're
updating the UX isn't the best here we
can see the URL is change so if i go to
like kind of like the timeline tab now
we can see that's a lot simpler okay
then a lot of our the tabs ago or a lot
of our the pages that we're looking at
and that's because the data that we're
feeding up here is really simple we
don't have any you know child actions
that we're executing on here or views
that we're going through or anything
like this this is just kind of like raw
files that were kind of serving up here
okay kind of like the minimal MVC
pipeline that you can possibly have and
so that's what we're that's what we're
trying to show and then you can kind of
go back to the origin request if you
want okay and now we're seeing you know
the the root page that we're looking at
again and so we could do that for any
one of these Ajax requests now one of
the interesting things that you start
getting to when you start thinking about
this stuff is okay I remember when we
came up with this feature and in co were
demoing it to people and stuff like that
I said to Nick you know i think i can
get glimpse working for the mobile okay
I you know there's this thing called
responsive CSS and you know I can make
it so the glimpse you I will pop up at
the bottom of the phone how cool would
that be it's like you're an idiot okay
and so I was like you're probably right
about that okay but what we're actually
doing because we're recording a history
okay of the different requests that are
occurring we can start recording a
history for the
quests that are happening from your
phone for instance okay so you can be
doing development on your dev machine
okay open up your phone go to the or
connect through to the server that
you're debugging on and come through to
history and we can start seeing the
requests that are happening on other
devices okay so if I actually came in
here on to the phone and we start going
through to play the get glammed calm so
as I've typed in the URL there did you
do I Hilton Wi-Fi wants me to connect if
someone else was some talking can
connect through that would be good Plato
get glympse com will actually see that
pop up in real time okay we can actually
watch those people navigate around okay
and so you can see us a couple of people
have open phones here so we'll start
seeing those proper-- pop in and a sec
now this is really interesting not only
from kind of like a local debugging
scenario okay we'll also that's also
useful when we start to debug other
people okay and so you can imagine that
scenario where that uses in in Turkey or
whatever else and you're like hey I want
to help debug the problem that you have
and so here we go we're watching Safari
nine here navigating around so someone's
got an iphone out there and i would say
someone's got maybe android or something
like that and so from here you know we
can actually click on any one of these
and again all these tabs are updating
and so what I'm now seeing is all of the
you know timeline details for that
particular request that Safari 9 here
made yeah
yes yes so the question was is you know
if anyone can go to this plate I'll get
glimpse URL and see what's going on here
you know who is that a problem which is
what I'm guessing you are thinking in
your head in terms of like security and
yes so when the tab pops up at the
bottom of the page okay this bar okay
before we open up claims you're seeing
just your activity okay so this is
restricted just to you so it doesn't
matter how many different people are
using the website you'll see just this
when you open up the G okay and by
default when you're looking at any of
these other tabs you'll just see just
your request likewise for Ajax just your
Ajax requests where that behavior starts
to modify is when we look at history ok
and that's where we start looking at
like the clients and you can give names
to these different clients by setting a
cookie ok so if you've got multiple
people and say in a test environment you
could set the name to be the user ID of
the of the person ok so it's actually
useful and but you know anyone that
would on that machine would be able to
see each other's requests which kind of
leads down the path of like how does
security work for glimpse ok now in this
case if anyone goes to play glimpse ok
they'll see glimpse but that's not the
default behavior I've actually cut out
all the security mechanisms within
glimpse so that we you know anyone
wanting to come and see how glimpse
works can actually do that but by
default it's locked down ok so it's
locked down to localhost so do you know
how you've got like yellow screen of
death will only give you useful
information if you're unloading house
kind of like by default that's the same
as what we've done here so you can only
ever get this data and the data will
only ever be recorded by default if
you're on localhost additionally even if
you are on localhost you have to set a
cookie in order to see the information
that's just flagging to glimpse hey
please start recording my sessions if
for some reason you might want every
request
collected here so the way you do that
and to make it easy is in your
development time you'll go to glimpse
the your website / cleanse day XD okay
and actually click you know the turn on
glympse button okay and that essentially
just runs some JavaScript which sets a
cookie and then you'll start seeing
glimpse okay within your app and this
security is actually pluggable so if you
wanted to have some logic that said only
you know all this is good but then I
want it to be actually remotely viewable
okay because I don't want to give all
the devs rdp access to my server so the
way you could do that is then set up a
policy that restricted people by AP or
you know some other arbitrary logic
which you could think of we essentially
give that extension okay all that
security mechanism the HTTP context and
then you can use whatever's available
off that and whatever other data you've
got available to determine whether or
not you know close should be turned on
or off and you can even get in some to
some really interesting scenarios let's
say we've got that user in Turkish we
want more in Turkey we want to profile
what they're doing but we don't want
them to see it okay meaning we don't
want them to see glimpse because there's
potentially sensitive information there
so you can turn glimpse on in a right
only mode which means we'll record what
they're doing but they can't see it but
the new will have the security to be
able to write and read okay and so that
you'll actually see them pop up in the
list in real time and be able to track
through with what they're doing so this
sort of stuff is really interesting and
really useful let's say you're in a
government department you've got an app
that you're supporting which has got
like 100 users or something like this
and Sally comes over and says hey look
I've got this issue you can go right you
know either you coordinate on the phone
or take over your laptop and you can sit
with her you know and actually debug in
real time and actually see it without
having to try and figure out well how do
we set a breakpoint on the production
side without you know killing everyone's
experience and you know this sort of
stuff so actually say that you have
really useful information
this and so that's kind of like an
overview of those top features I haven't
gone through every single tab here okay
but it's something that you can explore
now what we've talked about here as I
said is this is all glimpse v1 okay this
all works with classic asp net you know
MVC there's a whole bunch of different
plugins out there to support the
ecosystem because i said the vision was
you know this should work regardless of
whether using entity framework or in
hibernate or any of these sort of sort
of different frameworks so you can go to
nougat and actually do a search for
glimpse and you'll see a whole bunch of
different plugins actually show up for
glimpse so here we've got like over a
hundred different ones that the
community is actually contributed so you
know depending on what you're using
you'll actually probably find a package
out there for what you actually need
okay so that's going to be one but what
we've actually got here haha someone's
trying to do a sequel injection attack
there a cross-site scripting attack
thank you very much for whoever was
trying that yeah yeah I got you I got
you so that brings us to glimpse v2 okay
so what's going to be to about okay
glumes v2 is kind of the next evolution
of what we're thinking here okay and by
default will make it work for a speedo
core to start with okay and so from
there you'll notice that that experience
even though the bar at the bottom of the
page is the same okay the experience
when we open up glimpse is very
different you know that's where we start
to get this full page experience okay as
opposed to GS the panel at the bottom of
the page and a lot of that was born out
of our experience where it's kind of
hard to design UX for a little panel on
the bottom of your page okay so we've
actually realized is that well you know
we can kind of gear this experience
towards kind of like your dual monitor
sort of setup when you've got your app
or your website running on one screen
and you've got glimpse on the other and
you can actually the tool will be in
lockstep as you're actually navigating
around the web site so let's actually
see what that might look like do
do so bring this one down here and then
you know we can see that glimpse it's
actually sticking with us here oops a
little harder on a laptop screen okay as
I'm going through it sticking with me in
real time so this is kind of the
experience that we're gearing towards
the UX for this you know for the final
product will be extremely different to
what we have now that what you're
actually seeing here is kind of the
result of myself and neck prototyping
here we now have a team of about eight
people working on this okay so what we
actually have is leaps and bounds ahead
of what we have here now and this is
going to be a full product that
Microsoft is going to be delivering but
you know this is kind of very very early
bits that we wanted starting to get
feedback on here additionally what we've
started to do is previously you would
have noticed that in the individual tabs
very much felt like you know and this is
kind of I can say this because I created
it but kind of like we're spewing up
data okay it was an exercise in like hey
what information can we get what would
be useful for these different scenarios
okay let's dump out that data okay oh
let's dump out this data okay whereas
now we're really starting to think about
okay how do we produce a representation
of you know or a Diagnostics picture
here that actually starts really matched
that mental model that you have in your
head okay so for instance ninety percent
of the time you don't care about all the
routes and how all the routes were
individually evaluated you care about
the route that was evaluated for this
particular request ok that's the ninety
percent use case and in terms of model
binding you don't care how each
individual value was evaluated meaning
in this case I don't care ninety percent
of the time how it got three I care the
fact that it did get three again that's
what it actually found for ID okay now
you should be able to dig into that if
you want to ok but this ninety percent
use case is what we're trying to get to
and so then we can actually see ok cool
that's a model binding information
happen and here's the sequel query okay
all in context okay without having to go
to you know a whole bunch of different
screens to try and patch together what
actually happened here okay so this is
the direction that we're heading in and
you actually see this get much much
richer and we can even see that this
starts really work in scenarios like
this where i went to this page the first
time ride the lightning and if i refresh
it okay we'll actually see that we don't
have three sequel queries anymore okay
so if i go back to the previous one
details three here we had the three
queries okay but then you know the
action here didn't have that database
query okay and it turns out that's
because we're actually caching the data
so this is a bit of a vision of the
future you can expect this to get much
much richer much more framework support
yeah sorry for this so I've okay so
currently what we have on nougat org
okay support RC RC one okay of donate
core that's a problem so what I've got
on this machine and what I'm hoping to
deploy tonight actually supports RC rtm
so that's first step then in terms of
the next evolution of this okay which is
as I said leaps and bounds ahead of
where we are at the moment that'll be
hopefully before the end of the year
okay it turns out some of this stuff is
quite complex and we've got some pretty
grand visions and so trying to tie that
all together is important so trying to
wrap this up what do we actually have
here okay what we've realized is that we
have information and this is kind of
looking back at this stuff we have
information at different levels okay so
one of the things he's ever heard of a
guy called Martin Fowler yeah yeah okay
if you I was in a talk that he gave once
actually in Brisbane and he was talking
about the fact that you know what would
you want to see if you could fly in a
plane at 10,000 feet over your code ok
and so I use that analogy you know for
this if for the debugging and
diagnostics what would I want to see if
I
could hop in a plane and fly it 10,000
feet over kind of the live running of my
page you know at development time and so
here kind of the 10,000 foot view is HUD
that bar that sits in the bottom of the
page the 8004 viewers timeline 5,000 for
viewers the tabs you know trace tabs
specifically and then kind of like the
existing tools that we have kind of the
one foot viewers the breakpoints and log
files and stuff like this I'm not saying
there's no place for a break point
there's times when you need to know what
I equals okay but there shouldn't be
where you start to figure out which
route was matched now surely we can do a
better job than that we also realize
that we have different modes of
development you know we've kind of
gearing this towards is the learner kind
of like the person who doesn't fully
understand how MVC works or ND framework
or whatever else what information can we
actually give to do that the debugger
okay so the person who has actively has
a problem and is trying to sort this
stuff out and then the developer who you
know it doesn't necessarily has a
problem is doing his day-to-day work
okay and in this case you might have a
junior developer on the team who just
introduced an N plus one query okay
which is where you're in a loop okay and
you're executing the same query
effectively over and over again where
you just have one parameter changed okay
the values just updating and that could
be done as an end cause okay or is
instead of a or as an end rather than
hundreds of query is executed over again
how would you know that without this
we're trying to create a Diagnostics
platform for the web okay so eventually
I don't want to be in the game of
writing individual Diagnostics for MVC
or entity framework or whatever else I
want to create a platform where people
who have different frameworks whether
they be you know things like an MVC or
Nancy whether they be message buses or
whether they be whatever it happens to
be okay how can we provide a unified
view okay where these different authors
can come together create these
experiences okay and those actually work
together if I've got a message bus over
here that I write a tool for okay and
I'm seeing that data and isolate
shin how does that reference the fact
that i'm actually using MVC over here
you know what happens if we could join
those two together okay and give you
that kind of holistic picture we have a
multi framework ecosystem okay and
that's kind of like what we've just been
talking about how do we get these things
working together we're really trying to
create information targeted
understanding okay so it's not just the
breakpoints and log files you know what
is that mental model that you have how
can we get that on page and we're
looking at some of those cross-platform
a cross-browser cross-platform full
stack so as we start to get into kind of
like a dinette core that runs on linux
and mac and windows you know we've got
the net we've got node you know we've
got you know on the different browsers
edge chrome you know how do we get this
you know holistic picture end to end and
so you know in terms of kind of like
finally something up for the store you
know what's this all really about for
you guys you know what we're trying to
do is save your time okay if we can cut
that you know 20 foot for forty percent
debugging and diagnostics time you know
down to single digits that's huge okay
and it'll make you guys better you know
saving you money if we do cut that time
down okay it's making you guys even
better and better and more efficient in
what you're doing and trying to make a
kick-ass okay in general so go ahead and
try it if you've got existing you know
dotnet classic apps you know glimpse v1
is out there you can try that get up and
running in Deb time and see what you
think and give us feedback you can go to
get glympse com as I mentioned
everything we have here is free and open
source okay so if you want to contribute
if you want to get involved we're more
than happy to you know you show you the
ropes you go forth and be awesome please
leave feedback and thank you very much
are there any questions thank you thank
you very much yes
yup so going back in time glympse was
started as a community project okay then
we started to get sponsorship okay we're
lucky enough to be in the position where
we had red gate software you might know
them from different developer tools and
database tools came and said we want to
sponsor the project so effectively paid
Nick and I to work on a full-time okay
then you know when that eventually ran
up we started talking to Microsoft and
saying hey look we've been we're a
valuable part of the ecosystem or we
believe we are you know we'd love to
continue working on this where can we go
with this into the future okay and so
effectively what you'll find is that we
will essentially have something that
looks very similar to like chrome and
chromium for instance okay so we'll have
the version of glimpse which is free and
open source one hundred percent but then
you have chromium okay which is pretty
much exactly the same as Chrome we just
fully digitally signed and you know
validated and you know you know backed
by google in that case so for us we've
got vs code okay for instance which is
completely free and open source you can
go to github download it compile it run
it yourself but then there's an
executable okay which is you know
available which is the actual you know
official distribution as it were and so
you'll find something similar to that so
yeah we still own you know the open
source project and all that sort of
stuff for the community is I guess and
you know so as far as all that's
concerned it's it's it's not as if
Microsoft bought glimpse if that makes
sense that they couldn't it's free so
it's open source which is more important
yes
yeah so good question the question was
you know what are we planning to do to
support kind of like Nancy effects and
stuff like this that's we have a very
long history with the nancy FX guys and
part of the issue is glenn's v1 is we
have a pretty hard dependency on system
web at the time when we started five
years ago that seems like not a problem
I was like one of those things like hey
you know system don't web that's kind of
important you know it's not going
anywhere it turns out that's the one
thing that did go somewhere over time
and so we actually have to pretty much
all we had to rewrite blooms from
scratch pretty much to get rid of that
dependency because it's not just you
know how do we access the URL or the
headers and stuff like that so how do we
serve up our resources handlers don't
exist modules don't exist you know and
so we went down the path of you know
trying to abstract those concepts out
okay so that we had kind of like you
know our own common abstraction and then
we had like a nano burner implementation
and like the classic asp net
implementation of the system web
implementation turned out that was a
complete nightmare to try and maintain
and so then we went down the track of
saying okay well I've been a cause
coming out okay let's support it ok
because it's a win and you know there's
support through to you know with the
adapters through to kind of Owain now
and then you know that's kind of like
being its own bundle of fun so the long
and the short of it is that will we are
a hundred percent you know on working on
asp net core ok and system web and so in
terms of nancy effects on dotnet classic
as a where is Peter classic we don't
have a good story at the moment is along
the short of that so what you know we've
had some conversations with them you
know in terms of like you know are you
looking at going to asp net core the
timing of that you know when do we want
to start looking at this and stuff like
that but you know going to asp net core
is is a big deal for them to
yeah I'm just saying in general that
that's been a big effort for them as
well yeah yeah and so it was you know
similar amounts of work for us as well
to go to do the switch and so you know
in terms of trying to support their
efforts you know I'd say that will once
we get this stuff out the door at the
moment we'll start talking to them and
saying okay well we've got these cool
insights for you know espinet how do we
get similar sorts of stuff for Nancy and
some of the cool things that we actually
have in like v2 is at least four major
community products you won't necessarily
have to download additional packages to
get those things to light up which is
really cool then we've done some cool
magic stuff now that we're a part of
Microsoft and we can say hey look this
sort of debugging and diagnostics is
really important we've actually built
and contributed infrastructure in to
donate core to make the style of
debugging and diagnostics that glimpse
actually does far easier to implement
and so that's really exciting as well
but you know that's the sort of thing I
care about not necessarily everyone but
yeah so cool time so I don't to answer
your question I don't have an exact time
frame on that but it's probably
something we should start talking to
them about and trying to make sure that
we line up because that's definitely the
sort of thing that we want to have or
provide support for I should say any
other questions feel free to come up
afterwards I do have glimpsed stickers
okay if people who want any of the
original glimpse stickers before they
all disappear feel free to come up and
get some of those if you have any
questions feel free to come up but
otherwise thank you very much I really
appreciate it I don't always get to
speak in Australia and so it's really
cool to be in my own country so thank
you very much for coming along I know
it's late so thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>