<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visualizing Olympic Medals with F# and Fable - Tomas Petricek | Coder Coacher - Coaching Coders</title><meta content="Visualizing Olympic Medals with F# and Fable - Tomas Petricek - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visualizing Olympic Medals with F# and Fable - Tomas Petricek</b></h2><h5 class="post__date">2017-04-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/M9xk7KkSY1A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so today I'll be talking
I did which is visualizing Olympic
medals and it's sort of a part of a
bigger bigger plan and it's part of a
bigger bigger plan that I'm working on
at the Alan Turing Institute which is a
recently set up on UK research institute
for data science and I think one of the
really oh yeah no threats very good one
of the really important things about
data science it's not just the service
fancy mathematical models but also
building things that people can actually
understand and hopefully sort of
increasing the data literacy in in the
in the world and as you might guess from
my past history of talks at NDC it's all
going to be using a sharp but the
project is actually running as a webpage
with most of the work most of the
interesting work happening in the
browser so I'll be talking about observe
and fable which is what I've used to
implement it and fable is a f-sharp to
JavaScript compiler and aside from the
alan turing institute i'm still also
affiliated with observe works where we
do observe trainings and such and the
other important part aside from the alan
turing institute if google has this
digital news initiative which is sort of
funding interesting digital and news
projects so they gave me money for doing
this which was very nice yes so you
can't quite see this which is good you
can see the shades you can see more of
it in the news and when I started the
project I sort of didn't really I was
like half a year ago because before post
factors everywhere and so it sort of
fits very well with with what's
happening in the world and I think
they're sort of you can read a lot about
how people are
sort of less interested in in fact these
days and I think that's partly there's
there's a lot that could be done there
to make people a bit more interested in
facts and when people sort of complain
like what's what's so bad about world
they will often say that it's like let's
blame Facebook because Facebook created
these social bubbles and I think that's
partially what happened but what really
happened is that Facebook just made it
really easy for people to sort of share
their opinions so if you're you have a
lot more sort of options these days to
actually say what you think and get
people to listen to you and it works
really nicely for having opinions but it
doesn't really work that well for
certain facts based on data because you
can't really go to Facebook and say
given this data coming from the
government data set I'll make encase
factual claim and you can derive other
factual claims from it so I think what
really would be sort of where the
project is coming from is this idea that
maybe we should make it a bit easier for
people to work with facts and work with
data and see what they can find in the
data to just not have opinions but also
be able to back it with some with some
with some data and there's been sort of
a recent trend where more and more news
and more and more sort of stories are
data-driven so this is really a nice
example of what New York Times did
around the Olympic Games where they did
like in a visualization where you can
sort of see over the entire history of
the Olympics
who was winning what number of medals
and it really makes you think about
what's happening in the world because
you can see the two massive gaps there
that's the two world wars where no
Olympic or no Olympic
games happened and then there's this
weird spike with Soviet Union and us
which is the Cold War where first u.s.
didn't go to the Olympic Games in Moscow
and then the Eastern Bloc didn't go to
the games in the US so you can call
service it's a really fun way to explore
some information and I think this is
really nice piece of work but it has
quite a lot of problems and first of all
you have to trust the New York Times
that they did the analysis right
they um I don't know if I think they
didn't give give you source code for
everything they did so you can't really
sort of run it and get the same thing
you sort of can but you have to be
really good developer you can't really
see if they're if the visualization is
sort of doing some obvious mistake like
you can count a football as one Olympic
medal or as twenty Olympic medals and
that will skew the data quite a lot so
you can't really sort of immediately see
it when you go to the website and you
can't also say well this is a nice chart
but what if I only care about athletics
so you can't explore it further and this
is what I'm so just trying to trying to
do differently and I'll just give you a
short demo and you can then have a look
at this and play with it on your own I
think this is what I wanted to show I'll
give you links as well but the project
is all online and it's there's a couple
of different visualizations about
Olympic Games so let's start the day on
a on a simple easy note this is the
table of the the medals awarded over the
entire history and it's calculated from
a raw data set which is just a CSV file
with every single medal every
word it and what's interesting about it
or what's different about it is that you
can have a look at the source code and
there's some bit below which I which is
sort of a heck a visualization to make
the medals look pretty but this is the
this is the core of what's happening
so take the Olympic data groupid
biathlete sum the number of medals
sorted by gold take the first ten and
this is the best is the interesting bit
and I'll get back more to it and but
right there's a few more fancy
visualizations so this one is showing
over a time line how the medals have
been changing so if you wait until it
loops around you'll see that early on it
was pretty much just Europe and then it
keeps getting bigger and there's more
more and more medals from other places
and this one is fun so this is some
someone in the in a newspaper actually
did this where they took Michael Phelps
and compared him with with all the
countries and now he's winning over all
these different countries and that's
because I did the visualization before
the Olympic Games and he will not s'more
so now he's like way way on the left but
you can change it and say let's skip
only 40 countries and let's get more and
then I can refresh it and I will
immediately see the different results so
you can see like if Michael Phelps goes
Olympics again he'll have to beat Mexico
but he's already beating like Czech
Republic for example so the interesting
thing here is sort of the idea that you
should really be able to modify it and
it's like in the good old JavaScript
days when I was learning JavaScript when
you would just steal someone else's
rollover effect and put it on your web
idn't creators of derived derived
interesting things and I could talk a
lot about like what's interesting about
this and why everyone should be using it
but I think there's a lot of things that
are sort of interesting from the
developer point of view so what's what's
behind this and I'll talk about some of
that and there's there's two things one
is I was sort of trying to figure out
what's really the common theme that
appears in many different parts of this
project like it's a fairly sort of it's
a project that does quite a lot of
different things but there's one
repeated theme where I think what you
get from using f-sharp for this kind of
thing is that you can really focus on
the domain like you can really focus on
what is it that I'm working with what
are the kind of data transformations
what are the kind of visual elements and
so on
so I think the really important
technical bit here is to focus on the
domain and when people sort of talk
about object-oriented programming
functional programming any other
programming they'll often get distracted
and focus more on the on the mechanisms
so with functional programming I'm going
to attack my own lines because people
will start talk talking about functors
and monads and that's all just sort of
the technical stuff and I think what I
found really nice here in the project is
that you could really start by focusing
on what is it that I'm doing so this is
one thing I'll get back to a couple of
times the other thing is fable so fable
is the Xserve to JavaScript compiler for
the 21st century and that means a couple
of things it means that it generates
reasonably nice JavaScript for sort of
things that translate well to JavaScript
it's nice JavaScript for things that
don't translate as well to JavaScript
it's reasonably nice but what table is
also doing is that it's well integrated
with all the modern JavaScript
ecosystems so it generates it it's using
this thing called Babel behind the
scenes which will then sort of generate
nice idiomatic JavaScript in the thing
that runs in the browsers or es6 or ES
whatever and that means you get sort of
easy access to all the other fancy
JavaScript tools I'm not really a
JavaScript developer but I managed to
use roll-up to package my my my script
and make it easily sort of a small small
JavaScript you can put in a web page you
can run it through all the nodes stuff
and so on it generates source Maps as
well so you can sort of debug it in a
browser the fatal project has a really
nice and welcoming community there's a
git er page where you can get lots of
help and in a way I think it's for many
people it's possibly easy the easiest
way of starting with a serve because if
you if you have done some node then this
will just work and if you want to learn
more about Sabol go to Sableye oh
there's plenty of documentation and lots
of fun samples so now now I'll get back
to what I was talking about the domain
and I'll go to three different parts of
the project and the first one is the
data transformations and I'll go back to
the demo and show one more thing that
you can do here
so the fun thing is I can look at the
source code at elf any of these and just
delete it start from scratch and this is
using the Monaco editor which is what vs
code is running and I built a little
language that's running here and lets
you compose these transformations and
it's using the sort of nice ideas behind
type providers so when you do group data
it will tell you well here are your
available grouping keys so let's do what
did I want to do I think a fun
visualization is to find the number of
teams per games and how that's been
changing over the past years so are
there more teams coming - or more
countries coming to games these days so
we can groove this by the games and then
here you'll get like all the available
transformations so I can count the
number of distinct teams and I'll just
say average year because per games this
is always going to be the same so we'll
get the year of the games and then I can
say then and do some other
transformation so I'm going to sort this
by year and then I'll get a series which
is key value mapping with key being the
year and value being the number of teams
and this is my data and then I'll be
able to say chart think area and run it
and here's here's my chart you could
fiddle with it a bit more
like add a title but yeah you can you
can see some interesting things here I
think the the the sort of v-shape in the
80s is the as the Cold War so but when
you see when you sort of see what I was
doing you can you can roughly get some
idea about what's happening there but oh
yeah there's there's one more there's
one more important thing which is it's
all been using dope driven programming
so this is one sort of joking term that
people use when talking about F certain
type providers which is that you just
type dot and pick one of the things but
I think this is actually a really nice
way of doing things and it goes all the
way to actual values in the data set so
you can you can even filter by athlete
and then it will give you the athlete
names which I think it's just a sort of
curious idea because you can do quite a
lot just by typing dot so those driven
programming is nothing to be ashamed of
um but I was showing you nicely driven
programming and you could see how it
works but really when you when you want
to write this when you have this idea of
what it should look like you have to go
back or step back a little bit and say
what is really the transformation like
as I'm doing the dots what is it that
I'm actually composing what is it that
I'm building and so you have to sort of
slow down for a bit and really think
like what is this and this is where I
find absorb extremely nice because when
you say what is really this
transformation well it ends up being
just a discriminated Union in absorb so
transformation that's the second bit
says a transformation is either and
dropping some columns which is one of
the operations you can do or you can
sort
the data by something or you can group
it or you can do paging and if you if
you look at this you'll sort of figure
out after a little bit of staring what
what's going on so grouping that the
sort of most interesting one takes a
string list which is the list of the
column names to be used as the key so I
was grouping it by games and so the
string list would be just games and then
it's a list of aggregations so this is
what I want to calculate over the group
so I do a grouping by game and then over
every single group I apply some
aggregations like count all rows in the
group some a specific column or average
and as your as you're using this you're
really just composing a list of
transformations that define sort of
sequence of of steps that you want to
that you want to run so I talked with a
colleague who is doing something very
similar and they basically ended up
having exactly the same structure but
for composing some dynamic queries to an
SQL server and really once you have the
once you sort of start thinking what's
the domain this is the this is a really
nice way of expressing what's behind
this now I could write the whole code
without having this definition by would
be a complete mess so this is what is a
transformation and once you define the
transformation you can do all sorts of
operations with it because now we know
what we are working with and I have a
little demo so I'll just show you a
little bit of this which will illustrate
some of the things that are happening
behind the scenes and
I'll run it in F sharp interactive so
here is slightly expanded version of
what I was showing a value can be string
or number this is my actual runtime data
and then here I just edit all the other
aggregations that I can do and I also
added sort direction so I can sort by
sort of ascending or descending order
and when I do page Inc I can take a
number of rows or skip a number of rows
and then the transformation type is what
you saw before and there's one bit that
I'm going to skip and the bits that I
skipped what it's doing is that it's
it's a parsing URL query so the green
bit in the middle when I write my query
in the browser by doing dot it will then
build up this discriminated union
serialize it into string that looks like
this and send the string to the server
and the server has the data and we'll
evaluate this query so here I'm
filtering do you have only games only
data for real and I group it by athlete
and some gold and I'm going to get the
top three athletes based on the number
of gold medals so what I escaped with
the the bit that parses this census
string and then I can load some data so
here this is roughly what my data looks
like that's just a collection of rows
but I pre-processed it a little bit and
then the key bit that I need to write is
actually really simple function which
will say given a data given given the
data and one of the transformations
apply the transformation to the data and
so what I'm doing here is I take the
transformation and I look at the
different kinds of transformations that
I need to implement so I do also have an
empty transformation and if the
transformation is empty I just return
the objects without doing anything so
this is easy but I do have some more
interesting transformations so I have
paging which takes a list of take or
skip and there could be several of them
so I'll take this list of skips or takes
and what I have to do next so this is
this is a where it gets functional
because what I need to do now is to use
fault and what that means is that I'll
sort of iterate over all these
individual operations skip or take and
for every single of them
I'll get my data on my object and I'll
have this paging operations paging
operation and just so that it compiles
I'll finish the structure so what I'm
doing here is I take the data the
objects and iterate over all the actions
I want to apply to this and then I have
to look what kind of action is this so
if this is paging dot skip I want to
skip some number of rows then what this
objects means is
it's a sequence of of array that
represents row that effort that
represents individual row with sort of
key and value pairs so really what I
need to do here is to say escape this
number of elements in my data and for
the other one I need to truncate or I
could say take truncate and now the
observe compiler is telling me I'm doing
it wrong because I didn't change this to
the other option so if I want to take an
element I'll have to truncate and so I
think what was nice here is that you
really have once you have the domain
model that represents what is your
transformation you only have to follow
what the domain model tells you like if
it's paging I have to get given my data
I have to evaluate the paging and all
the other ones I'm not going to write
all of them but they'll they look very
similar so for sorting what you have to
do is that you take your fields that are
supposed to be used for sorting and then
we sort the data and we compare two rows
depending on the fields that we
specified then the second one if we want
to filter we are given a list of
conditions and we iterate over all the
conditions and filter the data that
we've got based on the condition and
just check that the that the actual
value matches the one that we want it
and finally the grouping
finally the grouping is again pretty
similar will construct well will get the
object use the XOR function to group it
and then for every group we apply all
the aggregation x' so I don't
necessarily produce I'm not showing this
to explain to you how every single line
of this function works but the reason
why I'm showing this is that you can see
like this is entire function to evaluate
the aggregations and if I then parse my
request and actually evaluate it then I
get Michael Phelps Catala dead Suki and
Simone biles or my pronunciation is
probably wrong but there you go and the
reason why this works so nicely I think
is that you really had the domain model
there that explains what is it and you
can then sort of nicely decompose the
problem where one problem is take this
nasty URL turn it into the nice
structure another problem is take this
nice structure and the data and
transform it and so on
so it sort of all built around the
structure and the other fun thing is
once you have this definition I showed
you a piece of code that will actually
evaluate this on in-memory data but
equally you could write a piece of code
that will take the query and generate
SQL and run it
so you're decoupling the the actual
operation from the Sergius idea what it
actually is so this was one of the
examples the other one is so this is
where we will have computer science
because the other bit is modeling the
program structure and what I mean by
this is the P
of code that I was writing in the
browser it looks like some sort of
program as a base some sort of program
but when we parse it we'll build some
representation of this again and that's
what people call abstract syntax tree
because everything has to be abstract
and the reason why I think this is
interesting is that this idea that we
could treat an article in the newspapers
as a program has really lets you do a
lot of fun things so when you look at
newspaper and you read the article like
that's the only thing you can do it or
you can sort of tear it apart if it's
printed and use it for drying stuffs but
but if you have a program there's lots
of things you can do with programs like
you can install resharper and let it
fiddle with your program so we know how
to do lots of cool things with programs
and what you could do with programs that
work with data in the news well you
could actually go back to the original
data source and check how credible that
data source is and if it says bright
bar.com then you'll just display a red
flag or you could provide some usual
programming tools so you could sort of
let people fiddle with the program and
help them and say do you mean this or
what if you also like wouldn't you also
want to see this for this other data
point and you can sort of let the users
play with it and find some other
information which is what I was showing
in the previous demo and so there is one
so one other thing that I was working on
that I did as part of this was you can
look at the visualization so this is
plotting just metals for table tennis
and you can see the source code and if
you're a programmer you'll figure out
how this works and you'll be able to
change things
but really most people reading the news
aren't programmers and so what you can
do instead is and this is where the
program structure is really important
because you can do analysis of the
program structure and figure out where
are some places in the program where we
could have done things differently and
so what this is what this data is that
it looked at the code and said well
you're saying let's say in the grouping
you're saying count all dot some gold
dot some silver and there's other
members that were available there so
here's a drop-down and you can add some
of them or if you're not interested in
table tennis but instead you're
interested in cycling then you can go
here and say is there some more I think
this is it give me the visualization
just just for cycling and I picked
cycling because I know it's going to go
very well for the UK pretty soon or just
have to wait but the idea here is this
is all coming from the code or yes and
not only it's generated from the code
but it also changes the code so as I was
clicking on things here it changed the
piece of code that was selecting what
I'm doing and this is really just like
what resharper does when you're writing
code except I'm now doing it on a on a
visualization that's telling me
something about the Olympic Games and
this is another fun part for the for the
implementation because what I had to do
was to take the source code and build
some structure that I can then analyze
and again this is where F serve is super
useful so here I'm saying clad input
equals 42 and then doing some
and when you parse it into a three
structure you'll end up with something
like plus is a node in the tree where
the left argument is input the right
argument is function foo applied to
input if you build this tree from your
code and it gets even fancier because
one of the things I want to do later and
I'll show you in a little bit as to be
able to evaluate this sort of lazily on
the fly so as you're editing the code I
want to be able to see what's changed in
your code and evaluate only the base set
that I need to reevaluate because this
has changed and again I'm doing this
with my Olympic Games visualization and
with a project to sort of make data more
transparent because that's something I
care about
but the same pattern you'll see in any
financial system which keeps the track
of some pricing models and whenever a
bit of your data change you re-evaluate
some of it so this is really something
that many people are doing in slightly
different context and so the next sense
a bit you can do is that you can look at
the tree and build sort of a dependency
graph where the white arrows represent
what depends on what so in my tree the
the green circles are both depending on
input which is initialized to 42 and if
I change 42 to 43 then the input changes
and therefore I have to reevaluate these
bits of the tree and so the interesting
bit here and you show some code again
oh no I changed my keyboard so while
this is starting the entire project that
I'm talking about is all on github so
you can go and have a look at it and
settle with it but what I wanted to show
you is just this bit and again you'll
see the same the same thing I was
showing before just just the
discriminated union at the core of some
really important part where the program
is actually a list of commands and the
command is either left something equals
something so it's a let name equals
expression or it's an expression where
we just say like charge that line
through and an expression can be a bunch
of things it can be a variable it can be
access property of a thing or call
method on the thing it can be a strength
number boolean you can even write
functions it can be a binary operation
that takes one expression an operator
and another expression or it can be a
create list of these things and again
like this is something that links a lot
of different part of the parts of the
project together so yeah you give me
text I'll turn this turn the text into
this and then once I have this I can
write older or I can write the resharper
the resharper stuff just by sort of
walking over this and figuring out what
is where and changing it and so the bit
I wanted to show
the bit I wanted to show a testing I do
have tests on one of those people it's
all written in our serve and I still
have tests so what what what what's the
interesting thing that I'm that I'm
testing here is how the parser works so
here's the string the the green stuff
which has Olympics that groove data by
team some the number of gold medals and
get the data and I want to make sure
that when I turn it into one of these
nice trees then in the tree there is
somewhere a property called some gold
and somewhere else there's a property
get data and currently I haven't
implemented that yet but the bit I
implemented is this assert
sub-expression function at the top where
there's a little bit more stuff here but
it basically goes over all the commands
and checks if they're sorry da da da so
what it does is that it goes over all
the lines of the program and check if
there is some line in the program such
that it has this sub expression and then
in the sub expression I just have a look
at the sub expression if F of E is
checking if this sub expression is the
one I'm looking for if it is then this
is true otherwise I have to look at this
expression and see if there's some more
nesting if there is some more nesting I
look at all the sort of sub nodes in the
tree and if it's not the one I was
looking for and there's no more I can go
and it just Falls but then the nice bit
is here if I want to check whether the
expression
if property then I can really just say
latch e with one of these things in my
in my definition so if this is property
this is taking the instance name so
instance I can ignore and then name
there is actually some more information
attached to the name like where is it in
the source code but I think nodes dot
name will actually give me the string
and then I'll just return if the if the
name matches the one I'm looking for
otherwise it's not a property then when
checking for call
I'll see recall and this again I need to
check the name but then call also has
arguments and for the argument I have
some other some other other arguments
that will check whether the arguments
are correct so this is only there is a
name if the if the thing I'm calling has
the right name and it has the right
arguments and finally it it's test if an
expression is a value I'll have to say
is it know which one is this it doesn't
like me all these copy and paste last
better I'll have to see if the
expression is actually the one of the
one of the expressions that represents
number and then I only have to check if
it's the right number so the idea here
is once you have the right
representation it's really easy to write
all these different help
furs to do things with the
representation and if I parse this code
sample and say is there some gold it
will work if it if I say is there get
the data it will work but if I say is
there FFF then it fails because this is
not in a lot in the sample code so I
could say FFF and now this will hold as
well and the same thing for the second
example so here I'm checking this is
actually a more fancy test here I'm
checking that there is a sabich's sub
expression somewhere in this code that
calls a method called take with an
argument 10 and if I run this this
should hold if I look for another
argument then it would fail so the key
message here is again once you have the
nice representation of what is it that
you're actually doing you can do a lot
of stuff with it and here I'm showing
how you can write some test functions to
make the testing easier but this is the
same thing that's happening when I was
modifying the when I was modifying the
visualization to change some of the art
reviews because it's really just looking
at this tree structure and doing some
operations over it and the last bit is
related to the user interfaces and one
thing that I was on I was actually sort
of thinking about quite a bit when
working on this is that we programmers
are really used to working with code and
we are sort of quite quite happy with
that but there was a there's a really
nice talk by Celine Herman's who does
some research on how people program in
Excel and when you think about how
people program
we in Excel they can do they can do
crazy things like be careful but don't
give your mom Excel because you'll
destroy your your IOT and hack your
fridge but the really nice thing in
Excel is that when you're doing some
work in Excel you actually always see
all the values like you can write some
programs but you never have to deal with
abstract things you're always working
with concrete numbers and that sort of
made me wonder is there something like
that we could do for the data
visualization and this is the last date
I want to show you so this is um on the
project homepage there's actually a demo
right there
and this works a bit differently so or
it works it works a bit differently it
has more stuff in it and what it does is
that as I'm as I'm typing the code it
will actually give me live previews so
let's have a look at only the real
Olympic Games and now I've got just the
part of the data set of all the Olympic
medals for Rio and what I can do next is
I can group it and let's group it by
country to figure out what what country
get the largest number of medals and as
I'm doing this you can sort of see how
it's changing and I can do some the
number of gold medals and see it here
the other thing that it's doing is that
it actually lets you modify the code in
the editor so here I can say well I also
want to sum the number of silver medals
and sum the number of bronze medals
where's bronze
there's some somewhere here and I can
add more transformations like sort this
and let's sort it so who's the most
unlucky country and has only bronze
medals
yeah u.s. still has still has the
largest number of bronze medals but
Germany has as many bronze medals as the
state and three times less gold so just
to finish this let me remove this and
sorted by gold and then I'm going to get
the data and create and that's what what
I want
let's draw a little chart so we are
going to get a series where the key is
the team and the number is the number of
gold medals and then I can store this
somewhere this is data and do a chart
while there's plenty of countries here
isn't it so let's skip some of them top
ten
and here's the chart with top 10
countries yeah so the nice thing here is
that you can sort of see all your values
as you're editing the codes which
hopefully should make it much easier to
use and you can even in the editor
fiddle with things and this is all this
is all doing quite a lot of custom
handcrafted JavaScript which I obviously
didn't want to write in JavaScript and
this is where this is where label comes
in and this is also where elm style
architecture comes in so if you're
staying in this room for the next talk
you're here you'll hear a lot more about
elm but l at the core is doing this
really nice and simple thing which is
that you write your programs just by
writing two functions so you define some
state which is basically what you can
see on the screen and you define some
event which is an action that the user
does and then you write two functions
one function that takes the current
state what happened and what is the new
state and the other function which will
take the current state and produce an
HTML and I twisted this a bit so the
render function also gets another
function to trigger events but the key
thing is it's really simple model you
have your state something happens you
get new state and then you render it
based on the new state and the only
tricky thing is this wouldn't really
work if you will replacing the entire
page every that every time the user
moves Mouse and Elm solves this by
having there's a there's library called
virtual Dom which will take this HTML
that you produced compare it with what's
on the page and only apply small changes
so this is really nice trick and if you
wanted to implement something like
to do list well your model this is your
state it's just a list of items and the
current text in the text box and then
you have a couple of events the user can
create a new item they can remove a
specific item by clicking on X or they
can change the text in the input and all
you have to write is a function that
will render the current model and a
function that will calculate a new model
when an update happens and let me show
this here so um I need two things
I need my editor and I'll need to run it
and the L model is serviced it's been
really popular in Elm but it's actually
something that you can quite easily get
to work in sable and so what I'm going
to do here is Allah over a note sorry
Brian
you're not going to be very happy about
this but my talk includes note and all
I'm going to do is to say run sable in
this directory and watch for changes and
whenever I edit my absorb code table
will produce a new version of the Java
Script and and this is all going to be
running in the background
and then the other bit I need is to find
my folder and open index.html so here's
my to-do list at the moment it doesn't
do anything and if I go in here and open
my to-do fsx then you can see here's my
definition of an update event and the
model and here's my render function
which currently produces
first fake work item and second fake
work item those are the two here and
then I have some initial state and I'll
start up and the first thing I'll need
to do to make this work is that is that
I'll need to change the rendering so
that it works with the real data so if I
go over all the ID and work items in
State DOT what is this items and for
every single one hour channel I'll
generate an Li element where the text is
going to be the work and when the user
clicks will generate or trigger an event
so trigger is a function that takes an
event and I want to trigger remove event
with this ID and I save it now fable
somewhere here in the background
recompile my java script and i refresh
it and now I don't have fake items but I
have the ones that I actually entered at
the end of the at the end of the script
now it's still not handling any of the
events so I'll need to go here and
change this and this is actually this is
actually quite easy so when the action
is input that means user change the
string in the textbox then my new state
will have input set to this new value
when the action is create then what I'm
going to do is that I'll create a new
state with items set to the original
items so we are not removing what was
already there and I'll append a new item
which will have a new ID together with
a current input and I can save it table
will recompile it and let's see if I can
add hello hey there it is that's just
not really work item and there it is and
the last bit that I need to do is to say
if I want to remove ID then state is
going to be a new state with items that
are filtered so we're going to do filter
and we have the item which has item ID
and the name and we are going to keep it
if the item ID is not ID now I could
make this a bit nicer by adding at least
one new line somewhere
but I can so now I can also remove items
and I think this is really amazing
because it also did it also do follows
from the nice programming model that you
had behind this and it also really
beautifully links to this idea that what
you need to think about is really this
model is this domain where once I figure
out what are my different events and
what is it that I need to render the
right state then the rest of the code is
just you still have to think about it
but it's sort of driven by this key
capture the key bit that captures your
understanding about what you're doing
and I'm not really going to show you the
whole code for during this interactive
interactive editor but if you look at it
then you saw this you sort of figure out
what's the what's the key bits of the
domain and what
the key actions like the two plus
operations on the on the right hand side
are option are sort of buttons that
display the menu and then in the menu
you have some items which are the
individual actions you also have as part
of the state what's the current program
and which of the tabs is currently
selected and if you look at the full
code for this so this will be somewhere
in here if you look at the full code for
it
it's definitely going to be a bit longer
but ah not that much this is this is the
full state and under actions of the
editor that I was showing before so I
have some menus and the current state
has some code the body of the code where
where it's part what's the current thing
in the preview what are the sections of
the of the editor which is the selected
entity in the editor
what menu is displayed and I think the
last bit I should have deleted long time
ago and then you have all sorts of
different actions what can happen user
can ask you trimming some element select
a bit of code and really from this and
you can figure out the rest of the the
rest of the program so this is the the
third case where the domain really helps
you to understand what is it that you're
doing and you can use it as a sort of
glue that put combined together all
sorts of different parts of the program
and I think this is all I wanted to say
so in summary I think the first
important message is that we should be
working on making the facts great again
and I think one way to do that is to
sort of encourage people to actually
press
with data or understand data and if we
can make understanding data as much fun
as arguing about random stuff on
Facebook then maybe people will care so
this is the one message of the talk
there's the technical message which is I
think thinking about the domain and what
is it what's the core sort of
representation of what you're doing that
really helps you build the applications
in a sort of nice and easy to understand
way where you can separate different
aspects and you can go to the Gama
website and use it if you have some
interesting data you can use observe
which has really nice language features
for focusing on the domain and if you're
into web use fable and make channel
scripts fun and that's it Thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>