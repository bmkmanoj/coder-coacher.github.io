<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a real-world cross-platform app with Xamarin and MVVM - Gill Cleeren | Coder Coacher - Coaching Coders</title><meta content="Building a real-world cross-platform app with Xamarin and MVVM - Gill Cleeren - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a real-world cross-platform app with Xamarin and MVVM - Gill Cleeren</b></h2><h5 class="post__date">2017-02-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6nn5o1-2FaI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so we're indirect given the
green light to get started good evening
everyone and thanks for staying for the
last session of the day I hope it's
going to be a lot of fun thanks for
being here so in the next 60 minutes or
so I'm going to going to be talking
about building a real-world application
across that form of course with xamarin
and mvvm so we're going to focus on an
architecture which is heavily relying on
the mvvm cross framework and I'm going
to try to talk for 60 minutes I have
quite a bad cold so it's going to be
very tired to see if we get the 60
minutes or not so let me quickly
introduce myself so my name is Sergio
clay and I'm coming from Belgium and
where I work at a company culture or
Deena and I focus mostly on the on the
mobile projects there that we mostly
tend to do with Cameron if you have any
questions about this talk feel free to
send me an email from each week or check
my website a snowboard OBE and I'll be
happy to help you with any questions you
may have and the good news for you is
also we only have about 60 minutes
together and I'm also a politicized over
and there is actually a five hour
version of this that actually goes a lot
deeper in many of the details of the
application that I'm going to simply be
showing here today if you want to check
that out and check out my courses on
pull aside I have the link here but
simply go to blue 5 search for my name
and you'll find it as a marine mvvm
cause of there as well so what are we
going to be doing today it's actually
quite a filt agenda so I have to make
sure that I don't lose too much time
here we'll start with a very high-level
overview of some of the concepts that I
do think you have to grasp I hope many
of you already do but I'm going to give
them to you anyway to make sure that no
one goes overboard I'm going to show you
first the final application some of the
concept touches what is mvvm such as
data binding and I'm also going to give
you a brief introduction on the am/pm
cross framework that will take us about
15 to 20 minutes and after that I'm
going to focus on the meat or
applications I'm going to show you the
full architecture we're going to see
what we can share how has reached the
level of co-chairing in my application
that I've done here I'm going to show it
the Android app has my pc with me so
it's hard to run on iOS app on there as
well so I'm going to focus on the
Android part I've mentioned there is a
blur aside cause we're all so stro how
the iOS specifics are built and if we
have time hopefully we'll look at
plugins and as well as unit testing this
whole set up now before we actually
continue let me give you a very quick
look at the application so the
application is called my trains it's an
imaginary train company or trains
application that allows you to book via
the mobile app take a full train journey
till you can search journeys you can
then view the journey details save it to
your collection of of journeys and then
there's a couple of settings as
mentioned it's fully based honour the
mvvm cross framework and it works both
on iOS and Android so I'm going to do
here as the first thing is I'm going to
show you the application running here in
the Emily pad splash screen we'll see
later how that builds this is the this
is the search journeys screen from where
I can search the journey I can select
the city here I want to go to on this
particular day I can select the time
let's say 9 a.m. and then hit the search
button then I arrive here on this search
results page for where I can click on
one of the journeys I see the details of
this journey that I selected I also am
able to enter here the amount of
stickers I want to order I can add it to
my face journeys it's giving me a dialog
and when I hit the close button is
automatically popping that screen again
of the sack and I arrive back here in
the search results screen I also have a
Hamburg icon that opens a menu here on
the left
for reference jump to other pages such
as the my saved journeys which is a
place which is very similar to the one
that destroying the results that is
including the one that I've just added
somewhere at the bottom I think it is by
the way sample data
I'll show that later on and then I can
also here go to the settings page for
where I can change the currency within
the application as well as go to the
website of the creator of this
application which in this case is my old
website so that's the entire application
and it's actually a trimmed-down version
of and actually based on an architecture
let's say of applications that we've
been doing for customers for quite some
time now already so it's actually an
architecture which has proven itself in
quite a few real-life for real-world
projects so I hope this is interesting
for you and the code is available via
github or also via Pluralsight you can
also download it so this includes all
the screens are both for iOS and Android
and the full architecture of this
application so simply go to my github
and you can valid code from there
alright without further ado let me first
give you a couple of the concepts that
are lying behind this architecture that
I've mentioned this is going to take us
about 15 minutes or so and then we're
going to take a look at the code so of
course this application like a set is
built on mvvm now the model view
viewmodel pattern is all about is
actually based on the fact that we have
data binding nowadays our binding for
the people I think I know everyone knows
data binding still there's a couple of
people who never know what data binding
the data binding is just infrastructure
that allows us to link data that is
living in objects with with the UI
elements so we can link the first name
property of a user object to the text
label text property of the label now the
data binding is always made up out of
four components and if you look on this
slide here on the Left we have UI
element that has the UI property that we
are going to bind to and on this on the
right here we have the binding so that's
my data my in-memory data that is going
to be the source folder but as mentioned
the data binding always needs these four
elements those four building blocks to
actually work so the binding object or
binding source objects and a property
and on the binding target site the UI
element with you
subject there's abundance it's in
between and make sure that the data from
the source is slowly floating to the
targets there on the left
you also see that the errors are
bi-directional meaning that we can also
enter data there in the UI like I've
done with the amount of tickets in the
damage that you've just seen and then
that data will also be sent back and
data binding can also do that for us now
the data bindings in general also can do
other things it can also for example
apply a conversion on the data for
example if we have a date which is
coming from a database somewhere here it
is fully unformatted and we want to
display it in the UI we can also ask the
data binding engine through converters
to convert the date into a more readable
format data binding is a bi-directional
thing and can also make sure that the
data remains in things synchronization
is a very important feature of data
binding as well if the data changes here
it will automatically be updated there
in the UI also in the other direction if
I change the data in the UI I can make
it so that the data binding engine
automatically updates my source is this
floating and this automatic
synchronization of data only works if I
have a couple of conditions which are
come to later on now very often and like
we had for example in the application
that I've shown you we have a lot of
fields on the UI is there a problem
ok such a problem at the microphone take
it we good all right thanks
so I'm where was I and now in many
applications we will have screens like
this I imagine this is that journey
details screen I will have a lot of
elements that actually are binding to
the same source in most most of the time
when we use data mining we are going to
actually bind a number of fields to the
same source in that area we'll talk
about the data context we set the entire
screen link to one source object and
then all the fields within here can
actually bind to that single object that
we are binding to and that object is
often referred to as a data convict just
keep that in mind we'll see later when
we look at the code in the second
part of this presentation here now we
can bind to single objects there you've
seen the data binding you see actually
in the application that I could show the
journey details screen then I was
binding to a single journey but I could
also data bind to a list of juries when
I had the search results screen for
example there was a list of items being
shown
data binding can allow us to buy both to
single objects as well as collection now
already jumping a beta hat when we look
at xamarin and in this presentation I'm
going to focus solely on on the class
exam or in the traditional dimension of
summer in form we're going to do data
binding and I prefer to do data binding
and mvvm in all applications in our
build and we look at cross examine well
there is basically no support out of the
box for data binding now the good thing
is that the creators of amphibian cross
has enabled both summer in iOS and vomer
in Android to allow us to do data
binding in the UI what you see here is
actually a piece of Android XML that is
coming to this typical living in a
summer in Android application where I am
actually doing data body if you think
about it well this is my UI element that
I'm going to be binding to that text you
and I'm going to use something that is
called MVX binds about MV x will see
that popping up quite a few times is
actually the one of the classes all the
classes of every year because starts
with MV x so this is actually something
that is coming that is added with an PBM
cross and it is doing a data binding so
that the text property of this textview
is going to bind in this case to a
journey date so to mvvm cross we are now
capable of data binding to this journey
days declarative lives in android xml
out of the box it's not possible with
xamarin android now summer in iOS is it
difficult it is actually a different
thing now you have perhaps for example
storyboards that you can use but you
shouldn't be editing storyboards playing
in the XML that is going to cause a lot
of issues so you can't declarative leads
creates data bindings in general
iOS however the creators of emperium
cross this however make it possible to
be data by me in this case encode behind
let's say so inch is in c-sharp code in
the control will have to write some code
that you see here we are actually also
creating a data binding between this
view and an object which is going to be
a view model don't worry about few
models just yet I'm just showing the
concept of data binding here and then
I'm going to also create a binding
between the UI element and an object
that I'm using as the bindings source so
this becomes possible because of the
fact that I'm meeting MVP across and
what I also shows you what I also
explained to you is that data binding is
capable of making sure that the data
source and the data target remains in
since there is automatic synchronization
of data possible only however if the
object for the binding to object source
for the binding is actually expo or
implementing an interface called I
notified property changed interface it's
a very common interface nowadays in
dotnet it's a very simple interface well
if you simply have if you implement it
here this adventure at the bottom needs
to be in your class as well what you
also need to do is when the value of the
property changes you need to raise that
event and automatically in plane and
plane's ammo and in plane WPS for
example we automatically say data
binding the UI remains in things with
the source and here through an Trivium
cross it will also be possible to just
automatic synchronization and this will
leaves us from having to write code that
says well if something changes then the
text property of this particular label
should be a basic statutory error prone
code we want to avoid that data binding
does it for us and in the case of mvvm
cross the antigen cross framework gives
us this support as well now also with
data binding data can flow in different
directions I've already mentioned them
so by default if the flow from the
source to the target
there's actually two options that we get
there it can float one way or one time
one time means that only initially the
data will go from the source
target what has gave the data source
changes and you I will be updated we
need to specify the binding to be a one
way binding and when the source and
changes the UI will be updated as well
if we however implement this I notice
our property changed it is also possible
to actually create a two-way binding
like I've done with entering the amount
of stickers I wanted in the demo I can
specify the binding to be a two-way
binding meaning that the data will also
flow from the source to the target sorry
from the target to the source and the
one racist source is basically for a
data binding that only allows me to
enter data in the UI and let that slow
back to the data binding force to do
that in code if you know sam'l well you
see that creating this or specifying the
motor on the binding is actually done in
a declarative way
in summary Android as well I can simply
specify the mode here to be two ways and
my rival or also objective and last
thing here I think is the converter like
I've already mentioned it is possible to
actually invoke or it says create the
hook in the data binding process it is
possible for me to convert the value rev
when going from the source to the target
typically we do that example with
converters and examining in mvvm cross
with in November and iOS and Android we
also just the ability to convert the
value when going from the source to the
target and that is done through a cloth
which has to inherit from MV x value
converter again the cloth starts with
nvx meaning that this is going to be a
closet is coming from MV b across it
asks it accepts tilt height parameters
the day time and strain in this case
meaning that it is going to convert from
day time in the string and in this case
is going to return is the formatted
string now if you see the class you
define date time today converter when I
use it in my data binding things a
marine and a marine learn or is having
call it again
okay it's not my voice okay
okay
yes can hear Meghan alright so when we
call this clause they time today
converter we actually can involve that
converter to be used by specifying on my
data binding statement converter equal
date/time today so we have to leave off
the convert we'll see that again later
when we look at the code just keep in
mind that through amphibian cross it
becomes possible to actually create
conversions on our data box now that is
data body data binding is actually deep
enabler for the MVVM pattern of the view
model pattern again out-of-the-box and
with the general forms has support for
mvvm but out of the box as class exam
range the traditional summer in iOS and
summer in android do not so that is why
we are going to see how we can do that
in amphibian cross now for the people
who have never heard about mvvm and the
VM is actually just a patterning it's
called a model view viewmodel
atom it's actually a variation of the
MVC pattern which basically lives
because of data binding and Kamala will
see that when we look at the code in
just a couple of minutes it became very
popular
I've actually invented with the with
examine and became very popular at the
time of Silverlight which is also when I
started building my applications based
on this pattern now what every VM does
is basically remaking it making possible
that we are going to be able to build
codes which is much more testable and
both maintainable as well so typically
what we have what we read is coding code
behind and code behind out of the box if
code is doing everything it is going to
the model and it will then update the UI
and try testing that type of skirt it's
going to be very hard because all of the
code is just one monolithic block that's
what we want to avoid now again the VM
that becomes possible or we can do with
mvvm is actually still create the same
view code and a very little tiny bit of
code behind in in general and that goes
behind is actually going to only do UI
in related stuff but all the linked
directions with the model are going to
be handled by a separate class here and
as the view model the remote can be seen
well as an abstraction of the view
typically what in the view model will
have
is state and operations state is
basically data a property that we are
going to be binding on an object that we
are going to be using and to expose data
to the UI that is state typically it's
exposed as a property so in our case it
could be for example the journey details
it will select a journey is a property
on or an object that I'm going to be
binding on steady state operations are
come on and I'll show you commands from
you look at the code and that is
basically available in my view model now
my view is actually going to be binding
through data binding of course on to
that view model and that view model has
interactions with the model it will go
out get data and when it has changed it
will raise a notification and then the
view which is data bound onto the view
model will know about the change and it
will automatically update and that's how
the circles basically are created here
sorry
now how do we ask you a vision such a
view model well it's actually simply a
cloth now in mvvm cross and we'll see
that's happening I mean look at the demo
in nvvm 12-hour view models need to
inherit from a base view model that
comes with the framework in fact nvvm
cross will search your assembly for all
classes that implement inherit from the
NZXT view model base cloth that's what
you see here in there I'm exposing do
things like I set and select the journey
is a property that is going to expose
state all my journey detail of your
model and that was the one where we
could see the details of the journey and
the selected journey is just state that
my UI is going to be binding on when I
hit for example the close button I'm not
going to invoke code in the code behind
on the contrary
I am actually going to invoke code here
that lives inside my view model and then
it exposed through a cloth again as
commands the pipe MVX command and
built-in command that comes with the MDM
cross framework now as mentioned quite a
few times already for this application
of this architecture I'm using mvvm
cross it is an open source framework has
been around for quite some years already
any of course enables us to build
xamarin applications classic
an application with amphibia it's in
both the source framework and can get
the current kidnapped and it's it
actually promotes co-chairing to a level
which is not possible out of the box
without entry vehicles you'll see that
when we look at the code
it's also available for many platforms
of course under in iOS and banner 100 it
also has support for WPF for example it
also supports genre forms but well in
terminal form does not actually made use
of of the a medium cross framework the
creators have advised against it and
they said well they are rewriting them
with under the improv to create better
support for MDM cross now what is the
framework come with well like I've
already emphasized here there's data
binding it enables data binding for
class examine applications which we do
not get out of the box it also is built
around IOC so inversion of control
that's actually an IOC container as well
as a service located in the framework
available and I'm going to use that as
also the framework itself uses it and we
can actually hook into it to be using it
in our applications as well and there's
also rich support for plugin that's an
extension point of the framework if we
have spam I'll show you a couple of
plugins in the application again you can
take a look at it afterwards as well so
these are the basic concepts and I
wanted to explain you before we actually
look at the application architecture I
hope that gives you some background to
follow along with the rest of the talk
all right let's do this
so let's now take a look at the
application architecture now the
application architecture really isn't
all that special if we take a look at
the layers that I've used for this
application well there's really nothing
spectacular going on the application
typically will talk with a remote
service that could be a Web API has some
rest
back-end that we are going to be
communicating with that's the remote
service in this application in the code
you can actually find the generic sarira
but I'm saying that there is actually no
communication with a real source but
it's very easy to plug it
the actual application sites are
everything above this line here is
actually what is in the application so
at the very bottom of the layers we have
a repository layer that is actually my
layer which is going to do the
communication with the backend in
typical real applications I also put my
caching here so I will first check the
cache if there is a local version which
is still valid if not I will go out to
the service store that version in the
cache again and then return it to the
upper Lakes to the consumer place a very
good implementation here could for
example the at refresh that's something
that I often use in this layer I'm not
going to show that here but that's what
we typically do here on top of the
repositories we have the layers of
services data services which are going
to communicate well but they are going
to be the consumer of the Republic Tory
layer that is your typical business
layer I also put here other services
things like a dialog service for example
could go in there
typically separation of concerns it's
very important for me
I put small pieces of functionality in
separate classes here as well that is
something that goes in that order
services block and then on top of that
we have few models of course we're
building with mvvm so we'll have two
view models and you see mvvm cross there
on the left while every game code is
going to be used in those layers that
you see so it's going to be used from
the View mode and also from the services
based quite a bit of schools I have my
models here I'm going to show you a
couple of these things in just a minute
so all this code and we go
so all this code is going to be shared
and on top of that we of course built
the actual application so the three
application heads the iOS the Android
and the Windows uwp application which
also will have references to nvvm cross
so that's basically application
architecture well let's dive in and take
a look at some more detail for this now
the application if you look at it from
the solution perspective has a couple of
projects in there the first one is a
unit best project we'll finish this
presentation by looking at the unit
tests then I have the my trained look or
a project which is as you can see there
a portable class library and that is
containing all the share
so all the services the models and stuff
like that they go in there
well let's zoom in this is actually a
screenshot of the solution Explorer here
make a project open it has the model the
repository of the services the view
bottles and also two very important
classes that I'll come to in the demo
the act and the app start classes and so
basically all this can be shared of
course keep in mind view models as well
so we get a lot of code that we can
actually share then I have the drawer
and the iOS project and I also have the
localization project but I'm not going
to be able to talk about it with the
short amount of time that we have
together again that is also covered in
the purified code for the core project I
have used a be CL a portable class
library I'm not a really a fan of shared
projects myself and I imagine doing it
in the future which standard libraries
but for now this is being done using a
portable class library another standard
shared project are not saying that this
application cannot be built with shared
projects I prefer portable 12 levels
I've been a fan of those things they
were created of course the application
shared code to the core project will
require quite a few references and quite
logically those are M deviant cross
references so mvgame cross references
you can see them here highlighted I'll
show it in a register your live in just
a second simply go to nougat and you
will find all the entry and prospective
that you will need and there's quite a
few that you actually need and this one
is actually built with a version which
is required except a few months old now
but everything is still working pretty
much in the same way so I don't go to
visual studio and trick and let's take a
look at the dissolution so if we zoom in
on the solution explorer here what we
see here is that test project that's
unit test project then we have the core
project which has all the shared code in
there so the view model the services
repositories and of course also quite a
few references which are specific for
amphibian cross then we have the droid
project and the iOS project which of
course have also references
and remember as you can see here and
also of course have a reference to the
shaft DCM to the my train core and I've
mentioned the margins of course is in
fact a portable class library so that's
the solution of structure of the of the
sorry that's the structure of the
solution let's go back to the slides for
just a minute and then we'll start
diving indicate about the different
layers so let's take a look at the
corporate so what is in there two very
important classes are at the root the
app and the extra cloth I think you can
detect from the name that they have to
do with the setup of the class well is
actually correct I'll show this in the
demo in just a minute what else is in
the share in the core project model
cloth my models are simply pocus and so
plain old CLR objects which have no base
class whatsoever I think they have a
base model class in there but I mean
there's no real reference to some from
some framework library in there it just
paid playing poker I also often um
request that my things build the
applications with a client-side model
meaning that I do a mapping to a
client-side model within my application
I don't always use the direct mapping
with what I'm getting into in JSON and
that deserialize that into something I
use no I let it stop in at a very low
layer and I will use the client-side
model typically that does require some
mapping sometimes but it actually makes
my application more independent from
changes in the backend so a program very
simple and some properties as you can
see here on top of that we have the
repository layer as mentioned that is
actually my data retrieval this is the
code that is going to go out to the
service and download some JSON
deserialize it into models instances
probably and realize applications there
will be some mapping that needs to be
done into the model that I'm using in my
opposition that depends on the
applications complexity it's an
asynchronous interface and it's code
base to get the boot of the leaf it's
buffering that is in that and typically
with a repository layer might Ross is in
there are concerned with one single mode
that's typically the mapping data
then is also the reason why on top of it
I will have my services relation what
your senior is a sample repository
notice that there is an interface on
there I will talk about the IOC
requirements in just a second but that
has to do with I see that that's the
reason that I put them there an
interface it's a it's an asynchronous
interface as you can see it has a
tasting talk in ienumerable of safe
journeys and that is going to be part of
the safety journey repository in this
case so nothing really special going on
I think here that's my repository layer
on top of my repository layer I have my
services layer and my services layer is
basically the consumer of my repository
in some occasions like in this
application it's just a pass-through but
it can of course have more logic applied
to it as well it's very well possible
that you will have a service per unit of
functionality meaning that it could be
that the single service a single data
service is going to have to communicate
with different repositories with
multiple reporters that is very not
possible it will apply some business
rules and again it also will have an
interface applied on it again which I
seek in mind and I'll show you that in
just a second so a service in mica my
application like I said has an interface
applied on it and also has an
asynchronous and interface or an
asynchronous task which is going to be
returned to you to get all cities but
this of course needs to have a
repository reference I'm going to show
you that in just a second so it's all
about taking a look at is already in
Visual Studio so the models I don't
think there's a lot of effort that we
need to put in there so the models are
just playing poker classes for example
sitting here like I said I have a base
model here but there's nothing in there
so this is just a plain cocoa cloth that
I'm using that is a client-side model
and optionally I have to map my mind my
responses from the service into this
model that I'm using throughout my
application then it's going to other
models are going to be returned by the
repository for example if we have the if
you take a look at the city repository
as mentioned have an interface and in
this case has hard-coded data
the demo at the orphanage conferences
and you don't always have a reliable
Network so that's why we're using hard
coded data here there is however if you
take a look at the code there is a basic
pod story in there which has some basic
client HTTP client communication in
there I'm using the HTTP client which is
coming from the system not a new guest
package the microphone that the new cat
package which is allowing me to pass the
string that I want to download the data
from and I am deserializing that using
JSON but net into objects of my
pro-gross from our model layer what do
we have down here at the bottom is like
I mentioned an asynchronous task based
interface which is going to in this case
return my cities and city my IP this
repository is going to be consumed by my
services layer and in the services we
have the data services as you can see
here now you can see it to the data
services as well as general search let's
first take a look at the data services
for example the city data service is
going to work with a city repository has
itself an interface applied on it and in
this case like I said is just a pasture
but could be doing some more business
logic on top of the map of the data that
is being returned from the repository
alright so that is basically already the
services layer now this is using an ICT
repository how is it getting in that ICT
repository well that's a very good
question let's go back here and so I
already mentioned that one of the key
functionalities of the mvvm cross
frameworks is that it comes with ioc
built-in it has it actually is built
itself on top of a minus B framework and
it uses what it allows us to use the IFC
framing that comes with it um I think by
now everyone is familiar with IOC and
it's basically the central location for
the dependency store and and in
dependency retrieval and it's very handy
when of course you want to be during
unit and you see that at the enter we
look at the unit tests that we can
actually benefit from the ioc container
point Elijah said is built into mvvm
cross and there's a couple of ways that
we can a couple of things that we can do
with the built-in and the ioc container
and we can actually work with the built
in and receive nvvm prop ioc container
through the NZXT clause in vehicle is a
very large cloth and it's among others
gives us access to you working with that
icy container and that's what you see
here for example i can register a single
meaning that i will always work with the
same inches throughout the run of the
lifetime of my application through the
nvx register singleton attach the
interface and then i say what needs to
be returned in this case a single new
city data service i cannot also later on
from wherever i want within my
application are and reacts to resolve
the i see the data service and that will
return me this city date of service
instance that is how MV Imperium cross
allows us to work with our UC and it
also supports and three our contractor
injection that's the word I was looking
for as you see here I'm using the I user
repository in my aya user data service
and then is going to be put in through
constructor injection so the imperium
cost is legal Danis also support
constructor injection and there's one
other thing that it does and allows us
to actually plug platform specifics into
the shared code as well so imagine that
you have some some some feature that you
want to work with from shared code but
it is platform specific how can you do
that
well to the ioc container you can
actually from your platform i also
specific codes or android or the iOS
project blog functionality into the
shared code through this ioc container
as well i will see that near the answer
will look at plug let me show you how i
use the mvvm crop i will see container
let's go back here there's a couple of
places where i am actually using it for
example here you're actually seeing an
application of the ioc container I'm
using the ICA repository and I'm not
moving that up on the
contrary I'm allowing it to be plugged
in through IOC s r2 constructor
injection otherwise I would create a
type dependency between my CT data
service and message repository I'm not
doing that here I'm injecting it through
I see
truly I see container 2 constructor
injection now why am i doing all these
registrations I remember that I said
that the still very important classes
here the app and the app start and they
haven't spent time looking at these yet
having to do that now first take a look
at the app class in the app class so
that the app Clause has a couple of very
important things it's a class which
needs to inherit from mvx application
wine because the Imbrium cross framework
will search for your class that
implements from MVX application and when
it finds it it will automatically invoke
this initialize method and typically or
IRC needs to be created at all the
container needs to be created at this
very beginning of your application so
the initialize method is a good place
because you'll see later that it gets
improved very early in the cycle in here
and creating or I'm setting up my ioc
container I'm using a couple of things
here that's called creatable pipe it's
actually going to a mass register with
the ioc container everything it can find
in my assembly that ends with repository
and it's going to useful that the
interfaces and i'm also going to pass
register as late as singleton meaning
that all the classes can find that
entity repository are going to be
registered by their interface and it's
going to register them using the latest
singleton only created when a tree or
when it's needed the first time and i'm
doing the same with my service
so as - registers all my dependencies in
this case wait my container the lines
below is actually they make the specific
registration here that has to do with
the translations that i'm not going to
go in there because i'm I don't have
time to specify how their translations
are done the loss winder is actually
calling register at start passing in a
new app start which is also going to be
invoked automatically
that for now because I'm going to come
back in this one in just a second so
yeah I've already seen how we do
registration and you've already partly
seen how we actually use added
constructor injection here to use the is
C containing a transferred mvvm code it
doesn't stop there
it also is used in the view models I
will fully take a look at the view model
at jump back to the slides for just a
minute and that we'll take a look at the
view models in detail so view models
probably the most important link that we
haven't talked about yet what do they do
and like I mentioned the expose state as
well as operations
well State is just data properties that
I'm going to be binding my UI to
operations are c'mon let's take a look
at some code like I said a view model in
an aggregate cost application and needs
to inherit from the base class gold and
v8 the view model what i'm viviane cross
will do at the application launch it
will search your assemblies for classes
that inherit from
MVX the view model and it will register
those as view model later on when you
build the view it will actually search
that list of registered few models for
the view models that's me that's how it
actually works in this case the state of
my view models my journey detailed view
model is selected and journey which is
simply a property that I'm going to be
data binding to I a soft actually I also
have this race property changed call
here in so when the value of selected
journey is step so that my real mower
race and it will cause the data binding
in the UI to update the UI automatically
force that the state the second part is
a command like I said a command is also
something that comes from mvvm cross it
called the MDX command and AB so
typically in the constructor for example
you can do is that you can register the
code that needs to execute when the
command is going to be invoked this is
the command basically it wraps all the
functionality that we are going to
invoke when the command is being being
triggered also
can register this for example to a
button tapping legalize to a new user
tap the button in UI well then the code
within this command so this part here
will be invoked at the later times
basically what the commands pattern is
all about and of course and notice that
it the command implementation is
specific to an Vivian cross it's an MV x
command then I'm using here like I said
the view model does two things state and
operations and actually it is also a
third thing the view model let's say is
excited more or less like a controller
and we see in your application and a
controller is also um also has to take
care of the flow of the application for
example when I tap on a button I may
need to navigate to another screen or I
may need to show a dialog those things
are flow of the application and what you
see here is that navigation F flow will
also because that we are writing inside
of our view model now mvvm Trust has a
very handy method called show view model
in the shared care to think about it
this the navigation is all done in the
shared code my view model a is going to
say now we need to navigate the view
model B and we can do that by calling
shows you model mvvm cross is actually
using something called a view model
first approach a view model first
approach is saying that we are
navigating to a view model and then the
framework somehow needs to magically
find the view that is linked to that
view model that will become clear and we
look at the Android application but do
keep in mind that all the code that
you've seen now is in the share lock and
that is all being reused across the
different platforms and it is this code
that is going to make sure that we can
navigate to a different screen and show
every model is flow of the application
and the same for example case if you
want to invoke a dialog that too is
going to because that is shared and
that's how we typically reach out a lot
of code sharing a highest code sharing
respect percentage when we apply mvvm in
ours a marine
okay let me show you this in this in the
demo okay
so let's go back here and let us now
dive into the view model folder I'm
going to open well let's take a look at
the journey detail view model so this is
a class like I said and it has to
inherit from
MVX base for MVX Remo and I'm inheriting
here from base view model which is a
class that I've created myself that
inherits from MVX view mode that that's
the main condition to become a view
model for mvvm crop in here I'm not
going to show you everything but do keep
in mind that's - a very important cause
about pudding here called reload data
async as well as a virtual initialize a
sink and the reload data I think is
going to call the initialized async it's
virtual it doesn't have an
implementation here I'm going to add it
in the actual implementation so let's go
to the journey detail of your model as
mentioned what does it do it exposes
state the selected journey and it
exposes commands for example this one is
a very simple one the close command and
we tapped on that close button it stops
the screen of the stack that's what i'm
doing here i'm initializing the command
to actually invoke close this which is
going to pop the current screen of the
stack what when the user is going to
invoke this commands we'll see later how
it's being invoked we also have the add
to safe journeys command which is
actually a more complex implementation
it is going to use the journey data
service and a dialog service how is it
actually going to get access to these
the journey data services and i'm going
to do stuff with the data we've already
seen that but take a look at the
constructor here as you can see here in
the constructor you actually can see
that this is again accepting quite a few
constructor parameters our journey data
service safe journey data service and so
on so these are again through IFC being
plugged into my few models that's what
we see here automatically because of
emperium cross this code here is going
to be invoked
when this few model is is actually going
to be invoked when I somehow say that
this few moments going to be running
well then the start method is going to
be invoked in here I'm calling the real
note data a sink and a reload data a
sink in turn is going to call initialize
a sink that was the one which was
spiritual here but in my actual
implementation I'm using the journey
data service to get the journey details
of the past in journey ID and that's how
I specify the selected journey to get
its value right so that's how my state
is actually built up in my view model
now this is actually all the shared
codes we now have few models we have
communicating view model the custard can
actually perhaps navigate will see more
on that in just a second but we haven't
really seen how well we can actually
build the Android and the iOS
application on top of it as well let's
change that so all this up until now was
shared kids no I'm not going to show you
is the Android application
well the Android application is in fact
just a plain Android application nothing
special going under apart from again a
couple of references allow me to act so
if you look at the application structure
because we're nothing special going on
it's just a plain Android application
and it of course has a reference to the
core project and it will have the couple
of references to mvvm cross optionally
to 10 trillion cross plugins as well as
typically also some xamarin android
support packages but that is not really
specific to the MDM course and all right
general Android application knows about
the share the core project but how do we
actually then start the the whole chain
of of execution well basically you have
two projects we examine real Android
application and your core project the
salary's Android application is still
the thing that is going to be sparking
although it is I'm to be across nothing
special is going on here it is your
summer in Android application which is
starting as if it were a regular Android
application it is effect
a regular comfort application the effect
that Android application has a specific
class called second I'm going to show
you that class setup in just a second
actually we need to build it it's a
closet inheritable base clause and that
clause is going to call into the core
project remember in the core project we
had that ab cloth and i specified that
there was a method in there called
initialize when i instantiate the app
initialized is going to be called by the
framework that triggers the setup of the
ioc container and also called let's
register app scott at last line that
went into that app start are showing in
just a second and there is some code
that i haven't shown you yet that is
going to call ratings which means
average view model needs to be shown by
default and that's how actually my view
models are going to be started with
those have reviews yet we'll add that in
just a second but at this point we'll be
able to see how the first view model is
going to appear on screen well instead
of showing it here let me go to the demo
so in the android application which is I
guess adjust a plain Android application
add a couple of very important things to
show you the first is this setup class
here like I said the set that God is a
closet we need to add ourselves and and
it needs to inherit from Penn reacts
Android second so when angry encoded
text this it will call this class here
and in there it will automatically
invoke the create app the first method
that you see here and this is going to
call into the core apps that was the one
that I showed you earlier the one that
inherits from MVX application that sets
of the ioc container registers
everything in the ioc container more
specifically and then calls register at
start and then to that one actually pass
a new app start and that new and thought
is done very importantly i'm going to
have start method again let's start
method is invoked automatically by the
framework
it has that last Lander show view model
that show via model call is actually my
call to specify which should be the
first view model of my application and
at this point
well everything starts rolling because
I've specified which the view model
should be the first view model that my
application is going to navigate to in
this case it's called main view model
that the first two models that my
application is during the show now I'm
still missing something because I'm
showing here I'm going to be able to
show main dream model but how does it
know which view is associated with that
remote it doesn't know that at this
point
well for that of course we need to
specify which view goes with which human
after that we have again entered in
costs than giving us some Hollander well
how does it do that well basically mvvm
cross can work with planes a marine
Android right by just any other summer
in Android application so we can use
views there are three activities as well
as fragments now in my application have
used fragments but like I said you can
use plain activities in exactly the same
way and what you see here is one of the
fragments of my application that has an
nvx fragment as its base cloth and
notice that I specified as a type
parameter here the view model that this
fragment is going to be visualizing and
that's how it actually makes up the
entire applications structure because
here I'm registering that this
particular fragment is the visualization
for this view model so whenever in the
shared code I now ask show view model
showing a journey detail view model
xamarin under the impress is going to
know that this is the visualization for
that particular view model so when I
call show view model with this one it's
going to show this particular screen
online in my application and that's how
it actually makes up which views it
needs a rich view it needs to search for
in my application as you can see in this
view code it's really not a lot going on
well the only thing that it does here is
actually inflating the
view that we want to inflate we this is
actually the zamarons Android view that
I want to invoke well let me show you
that in the sample so let's take a look
at the view code so let's go over here
and let's go to views for example the
earth or let's take a look at the
journey details for a fragment so what
do we have we have a fragment there's a
plane fragment of course it needs to
inherit from MDX fragment we're still
running with MDM crop and we pass
through it the view model that this is
going to visualize in this case journey
deep the view model is the view model
that this fragment can visualize of
course if you would register multiple
views for the same view model and the
Gymkhana is going to crash because it's
going to say well you have specified
multiple views for this particular view
model I can't decide for you you can
only have a one a one-on-one relation
between your view models and your views
in this case this one is the
visualization for the journey detail of
your model and if you look at what the
code for the rest in this in this screen
what is really not a lot going on I am
inflating a particular view the journey
details view let's take a look at that
one so in the resources layout we have a
view called journey details view that's
this one so in here that is plain
Android XML what I now have here is the
ability to data bind to one of our data
mining well to my journey detail view
model for example let's take this one
over here this is a text view that is
going to display the departure time and
as you can see here through the lvx bind
attribute that I'm using here has
specifying that this text you is going
to get its text value from the selected
journey both departure time so if we go
and take a look at the journey detail
view model so that is this particular
selected journey
tops departure time that's a property
over here that I'm going to be visual
over here in my android xml codes and
I'm doing batting here conversely as
well to actually convert the time into a
more readable format in this case than
just a time part and also down here at
the bottom somewhere over here the view
model expose state and operations while
the operations will command
I'm also capable of binding for example
in this case a button that I'm binding
it to by me it's click event let's say
to a command in my view model in this
case 3d MDX binds a attribute again I
specify that the add to safe journeys
command should be invoked on my view
model and that was the one we had here
at the top and so that is how everything
is actually linked together we have the
view models they have to inherit from
MVX view model they are searched by
every being across every game because
also knows which view is used to
visualize which view model and when you
call in your share code show view model
to this particular view model it knows
which view model it needs to get and it
automatically will search for the
corresponding view for you that's how
the entire circle is made up I hope it's
clear for you because that is actually
how Endymion cost is is doing its thing
right now just what we have about five
six minutes left that says that that's
great I'm going to skip a couple of
things so the iOS part of course we
don't have time to look at that and now
what else does that medium cost come
with well it has a very rich support for
plugins for things like the name implies
it just extra functionalities that I can
pull it into my applications through a
very rich set of slides just search I
get up for for a brilliant cross plug in
the specific side and get up to our
specific repo for those plugins and they
can basically add extra functionality
for your application they're just an
extension point for you so there's a
couple of sample a couple of possible
plugins or using plugins that you have
well in fact when I was showing you the
application earlier we were
looking at a plugin remember that I
could click on that view size button
that is actually using a plugin that
allows me to open the browser natively
in the platform but triggered from
shared code well let me show you that so
in the in the core project scroll all
the way up there is in the references a
reference to and over here LVM and
william cost plugins both web browser
now that web browser actually gives me
the ability in my view model that is my
settings view model to actually over
here
use the the ifexp web browser task
that's part of an interface that is
added through the plugin and that allows
me to call show web page passing in the
page i want to do i want to show but
think again what is happening here from
shared codes and defining slow i am
going to open the web browser in one
this command is invoked now opening the
web browser is something which is very
platform specific I cannot do that from
share tilt that is why I'm using in the
shared code a plugin and the extras that
the actual functionality let's say is
also added is plugged into the core by
another plugin actually the same plugin
but the Android and the iOS specific
implementations of that plugin if you go
here you'll find that there is in fact
also a reference here to the adverbial
cross plug installed web browser and web
browser droid the web browser droid
contains the implementation of that i
web browser tasks interface but for
Android specifically so it will contain
the code that knows how to open your
Google Chrome browser on your Android
phone or the web browser on your iPhone
in the case of iOS right that's what
plugins are all about and like I said
there's quite a few plugins available on
the github on the specific site there
and the last thing I want to show you is
actually and can we basically put this
thing too
it is now built in a way that we can
actually make sure that we can unit test
this this entire architecture well let's
take a look so I have here in my
solution and let me collapse everything
quickly because there's way too many
things open so I have here the iridium
cross core unit test project which
contains well quite logically some unit
tests and I have unit tests for the
different layers but typically I suggest
that you start by testing your unit as
earlier your humans because it is not
possible to test you I related codes
because we don't have you my references
we can test our view books what am i
doing in here I have a test for example
called the load from cities correctly on
my search journeys the view model so
let's go to that few model search
injuries view model let's deform and
that has a from cities property over
here and I want to test that they are
loaded correctly now if you look at the
dependencies for this view model it has
a messenger you haven't talked about the
messenger but here and the city data
service a connection service and a
dialog service well so working with the
from cities I only need an
implementation for the city data service
that's what you see here so I'm actually
going through the use of the maquis
framework creating my own City data
service and that's what I'm doing there
I'm not going to show you the
implementation let me quickly show it
it's actually a very simple hard coded
implementation using the mock you
framework that is going to return half
period couple of hard to the cities tree
in this case and that's a three here I'm
using a mock implementation for the
messenger the connection service and the
dialogue search for my view model and
then I'm invoking my view model and I'm
passing to those the mock version of all
the dependencies as well as the mock
city data service then on there
I'm calling the load cities that was
this particular call here
loads this one and I want to make sure
that my frontages has now been
successfully initialized so I can do
that in my test over here by asserting
that my search journey we model from
cities property as a service frenzy
discount is actually equal to three and
that's how I've now been able to unit
test my view model and that should
actually make our circle round because
we've now been able to create unit tests
on the code that is actually level the
burden let's say if we didn't use the
amperior better so with that we are
exactly on time it's great so I want to
finish by hoping and expressing my hope
that say that I've given you an overview
of how we can actually build testable
maintainable applications and all of in
my opinion solid architecture and with
the mvvm cross framework and it actually
of course still improves on the amount
of code that we can share and we can now
share everything up until the View mode
which is of course great with the actual
view layer in the summer and Android and
the Cimmerian iOS application
it could fairly thin so there's not a
lot of work to do and well I hope that
you like modest the way that answer to
that if you want to take a look at the
code and you can actually download it
for your own learning maybe it can be a
starting point to build your own memory
application if you have any questions or
remarks let me know the fastest is via
Twitter and I'll give you an answer very
quickly very natural and then as I
mentioned if you're interested in
knowing more about tribalism I have it
in full in this Pluralsight course here
is going very deep also in the iOS
project and it takes you about five
hours so if you if you're not tired of
hearing me talk well this is what you
should do this evening thanks for being
here
I hope you had a fun day and I hope to
see the motor vessel thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>