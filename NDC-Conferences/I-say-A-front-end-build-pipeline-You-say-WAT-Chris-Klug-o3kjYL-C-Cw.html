<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>I say A “front end build pipeline” – You say WAT!? - Chris Klug | Coder Coacher - Coaching Coders</title><meta content="I say A “front end build pipeline” – You say WAT!? - Chris Klug - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>I say A “front end build pipeline” – You say WAT!? - Chris Klug</b></h2><h5 class="post__date">2016-08-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/o3kjYL-C-Cw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're gonna start calling it three
o'clock and get started if anybody who
wants to watch this and is not here
please let me know okay
no way hello everyone everybody having a
good time
good conference for being the first NDC
ever and down here so you don't get many
comforts down here right you used to
have tected Australia which was not even
in Sydney as far as I know okay so the
topic of the day is I say front-end
build pipeline you say what which is
basically front-end build pipelines
using gulp and explanation of why we
need front-end build pipelines and why
they make sense so just before I get
started how many of you guys are using
gulp today in production so all of you
can just go and get to another session
there are a lot of other sessions out
that are good it will be a fairly
entry-level thing but I'm also going to
try to explain why we need them and why
they're interesting so my name is Chris
Klug I work for a company in Sweden
called nama trucks and yes I am Swedish
so if my Swedish or English is a problem
and you don't understand me that's gonna
suck because I can't do much about it I
do I'm a Pluralsight author so I have a
horse of course out there if you want to
go and look up a win and win your stuff
you can go to Prasad and watch that that
would be awesome
I get paid for that paying me is good
and a strokenet MVP as well and I spend
a lot of time traveling around the
conferences it's kind of cool to me down
here again and do doing conferences so
front-end build pipelines anybody know
what this is
anybody geeky enough to know what this
is first website ever online 1991 this
was as far as I've been told hosted on a
machine at Tim berners-lee's office and
there was a note sticker on top of it
that said this is a server do not turn
off we've kind of moved a few steps
since then but I pulled this up because
it's actually available online stead
and then asked you do you press f12 to
check out what it's doing and you figure
out that there's like one single page
being downloaded and it is 2.4 kilobytes
that is the way the web was intended to
work right then this guy comes along
Brendan Eich he decides that we cannot
just do that we need to have something
else he decides that javascript is the
way to go it was actually not called
javascript it's called live script but
back in the day Java was cool and they
decided JavaScript would give it better
traction and then they launched that in
netscape navigator in 2.0 - and hit
the fan
pardon my french cuz all of a sudden you
get this when I go booking tickets I use
this website I've tried to remove so you
don't know where it is but it's a fairly
big website
and you go in here and you search for
where you want to go and all of those
bars go up and down and they're flashing
around that things are loaded and
information is flying here and there and
everywhere and it's pretty useful I I
completely agree and then you press f12
and you get this doesn't it's not very
visible I know so I'm gonna go ahead and
look at that you in the back can see
that's let's go ahead and do that
298 requests for that one web page and
also 1.2 megabytes of data flying over
the wire anybody here been doing web
development since early 2000 if you keep
your hands up how many of you feel that
this is not good there's a few of you
likely because if you've been doing it
for that long when you start out doing
web development you looked at something
and you went oh no this this picture is
probably 20k I need to get that down to
like 8 and you would optimize the crap
out of it and it was like you can you
can you can barely say it's it's a dog
ish might also be a bird but it's a
picture now we don't care we just we
just go ahead and do this we put stuff
out there we don't care 298
that's fine 1.2 Meg's and that's fine I
I do agree to 98 requests for this is a
little bit saturated because this
includes me actually searching and it
does a whole bunch of things so it's not
just loading the page but it still ends
up being a lot of requests so I've got
some numbers here they are the
connections per host and max connections
for web browsers on the market today 6
for Firefox and Chrome and 13 for IE
and edge is the amount of outgoing or
outbound connections you can have for a
single host at any point of time inside
one of those browsers so if you start
serving up 298 requests from the same
host your going to be royally screwed
because you're going to be you're going
to be setting them up and doing them
sequentially 6 or 13 at the time one
cool thing here is that Microsoft
actually has two bus connections so they
do something right forints in the space
of Internet Explorer 17 and 10 for
Chrome is the amount of connections that
you can have out going all together so
if you start dishing things out in
different domains and different hosts
you actually get performance increases
in perceived performance of downloads
should actually get higher download
capacity so it might be a good idea to
spread them out which is easier with
build pipelines as well but if we look
at the 298 requests the first thing we
need to do is we need to take all of
those requests or a bunch of them at
least and start bundling them up and
making it like one big request instead
of a multiple small ones so how many of
you have looked at the TCP spec how TCP
the network protocol works one two three
it's always scary saying that because I
haven't but I have facts about it that
I've made up and I hope they're right
I've googled this and Google said I was
right so that has to be right right TCP
works in the way that you send packages
back and forth we all know that what
most people don't know is that when you
do TCP you will send a request to a
server and it basically you'll send
packages
it will start sending packages back to
you with the information in it it will
start out with the tiny package smallest
package possible and it will send that
back to you your your network card will
then go and say yes I got that that's
fine it will send back the server then
goes ahead and sends another slightly
bigger package twice a size and that
goes back and then it goes yes I got
that and he keeps going like that so he
keeps increasing the size of the package
for every package you sent until it
finds crap I'd sent a package that was
too big to be transferred over the web
and then you start scaling back again
but it means that you're actually
transferring quite a lot of data over
the wire at non optimal speeds before
you get up to that perfect speed that
your network can handle which means that
if you're doing a gazillion small
requests you're paying a massive penalty
for every one of those whereas if you do
one big request for one big file you're
paying that penalty which is much much
smaller in comparison to the size that
you're trying to download does it make
sense is it true I'm asking two guys who
have actually read TCP oh yeah
it's a person Peter I tried I tried
check Vic checking it next one so
we got rid of the 298 requests made and
smaller in in theory and 1.2 megabytes
that is the one that actually scares me
the most because 1.2 Meg's is a whole
heap most of you actually all of you
seem to be old enough to remember disks
like floppy disks that's the same thing
it is kind of scary the amount if you've
been around for a while and also by the
way you're down here you have like no
internet connection in this country it's
like if it's as long as it's hosted down
here it's fine I used to live in New
Zealand I know exactly what it's like
it's long as it hosts it inside New
Zealand it's dandy there's fibre all
over the place as soon as you leave New
Zealand oh that hurts
so you want to get this as good as you
can anybody recognize this actually
sorry let me turn it around anybody not
recognize this this is Super Mario Bros
Super Mario Brothers was released in
1985 and it was 40 K and I'm not talking
about the picture I'm showing us on on
screen I'm saying the whole game
everything was 40 K okay
stupid picture online today 2016 163
kilobytes of data our some fun hey hours
of fun my entire childhood yeah see the
difference just imagine what we could do
with 163 k9t Nintendo 8-bit today that
would be awesome okay
bootstrap how many use of bootstrap in
the web applications how many love
bootstrap you're wrong no it's okay but
there are other options as well
bootstrap is interesting because
everybody just throws it in there you
start out a website you default to going
I'm building a website I need a few
things I'm gonna start out I'm gonna
throw in jQuery or whatever you're doing
jQuery might not be the hip thing right
now it would be react or something
and I'll just throw in bootstrap for
good measure bootstrap uncompressed and
I'm minified in version 3.1 one was a
hundred and eighteen K if you add a few
images to that and then you add a few
JavaScript libraries and everything you
end up with you 1.2 Meg's
so people come out and go let's minify
it and all this on you goes from 118 298
k whoo just gained 20k and then you sip
it
you gzip bill thing the only sudden it
goes from 98 to 17 how many of you gzip
your resources like a few little hands
going up
why don't you the ones that don't I
looked at this now I'd like that's
really cool but I assume that all
browsers potentially like ie doesn't
support this and that's true it doesn't
if you go before version 1 a 5.5 we
don't support ie five point five minutes
Whedon I assume you don't either
so you can use this all over the place
and it will save you a whole lot more
than just minifying it so build
pipelines whatever size what I was
supposed to be talking about not not
this but it's before mr. only reason for
us to do build pipelines and manage our
clients
resources differently and no it's not
it's a good start and it's where
everybody starts basically you start out
going oh crap I need to minify it and
bun bundle my JavaScript files and I
need to do a few little things here and
there and it's that's where you start
out with your build pipeline and then it
starts growing the next thing you figure
out is this anybody know what this is
it's a picture for one of the best
presentations on tech ever if you
haven't seen destroy all software talks
you should go to and YouTube it after
this session because it goes through
JavaScript explains why javascript is
broken because things like if you take
an object and you add an array to it you
get zero obviously a number and if you
turn them around you get object instead
which this just makes sense so when
people figure out the JavaScript was
broken they decided that the way to fix
that
it's apparently not removing javascript
and getting something that's better in
the browser instead we get a bunch of
other languages that we can transpile
from that language into javascript
because javascript is the most widely
used language in the world because it's
everywhere so they come up with
typescript and CoffeeScript and dart and
clojurescript and hack C and then and
some and some is there a whole heap of
them and depending on what kind of
background you are you have you find
different things that you like I like
typescript does anybody do typescript
quite a few anybody I need to do any of
the other ones up here none okay
oh there's one hand anybody do hack C
okay um just curious because I have no
idea where this I found it one in
googling it and then once they figure
out that we can do better JavaScript
using another language they also came up
with hey that that whole CSS thing is
pretty broken as well we can treat
switch out CSS but we can build
something else better and transpile to
CSS so they come up with less and sass
and there's other things out there as
well so to do that we do need to use
some form of pipeline that does all of
these transformations and bundling and
minification for us and we want
something that does that automatically
for us and that's when it starts getting
really ridiculous
I was out of the web game for four five
years doing Silverlight development that
was a really good investment I am I'm
one of the few silver MVPs in the world
I'm not anymore about used to be and I
came back in all the sudden this was up
there I was like I came out of asp.net
webforms and when I come back it's MVC
and there are JavaScript libraries and
CSS transponders and things like I
freaked out it's actually not that hard
because node will help us node will do
it because the solution to JavaScript
sucking is creating another language
that is not JavaScript but transposed to
JavaScript and then write a tool in
JavaScript that will do it for you so to
be able to transpile to into language
you don't want you use the language you
don't want right makes complete sense
but nobody's kind of cool because it's
very very lightweight we can just pull
up a file write some JavaScript and it
run it and it will do things for us node
comes with NPM NPM is a package manager
if anybody is not aware of where the
package manager is is basically nougat
we all know nougat because it's been
shoved down our throat by Microsoft for
quite some time which is awesome I love
it if you have any problems with it
Martin Balio is outside he he is on the
team for nougat so if it doesn't work go
and blame him for the rest of you NPM is
awesome
NPM will help you get packages for node
so whenever it's anything you want to do
in node you go to NPM you download and
you stole it it's early so you install
node NPM comes along you go into your
command line you go NPM install and
whatever package you wanted and you got
done it downloads it into a node modules
folder and you're happy and then you
figure out the checking in all of your
modules into source control is gonna
suck because all of a sudden you've got
110 Meg's of node modules that you check
in and then you get versioning
collisions and and it takes forever to
download things so you go I don't want
to check in my resources like I don't
want to check in my nougat packages I
just want to check in my config file it
says what packages I depend on so
instead we're going to say NPM in it
that goes through a little
walkthrough of creating a little
packaging file and then you say npm
install your package and - - save - dev
and it will install the package but it
will also add a reference in a
package.json file that says this
solution depends on package x y&amp;amp;z and
then you please check that file into
source control and when people check out
from source control they do npm install
and it will install their this MPM
install it will look at package jason
get all of the package for you in one
swoop it's nougat it works in exactly
the same way I love that you go ahead
and you install that and then once
you've installed the package manager you
use the package manager to download
another package manager which is in this
case Bower for me you've also got
whatever that one is called I can't
remember now javaScript jeaious JSP m
thank you and there are a few others out
there it's more and more it used to be
that everyone put all of their resources
front and resources in bower it's now
actually moving away from that and more
and more people actually putting their
front and resources into NPM straight up
instead of going through Bower so in
some cases you might not need Bower in
some cases you do and but the idea is
that you have another package menu
potentially that that is responsible for
downloading packages that includes
client JavaScript resources and CSS
resources or anything client-side
resources you need how many of you are
today using new get to get things like
jQuery and bootstrap and things like
that stop go home after this conference
go back to the office find all those
projects remove that reference and go
and get it from somewhere else because
we shouldn't be using new get to
download the client-side resources it's
not the way it's supposed to be they
even removed it out a new gate for a
while and then people started
complaining and it came back but
client-side resources comes out of
another package manager package managers
like that are quite easier so you do ask
you npm install - g and whatever package
manager you want so for example bower
so npm install - g Bower install Bower
on
your machine so that you can go into any
console line and say Bower and then
install and your package of choice all
of those package managers also support
the idea of an init and then save save
save save save dev to create one of
those files that will keep track of what
packages you are using once you've got
all your packages then you then have to
go and get another thing which is your
task order
it's another NPM module and you've got a
heap of them to choose from right most
of you have heard about grunt and gulp
right used to be grunt Danny Gault came
along and gunk was the thing and
everyone choose that and then all of a
sudden there's broccoli and there is
brunch and there's mimosa and there is
this and that and everything there's
basically one coming out every week you
just take a choice of one and go with it
I've chosen golf golf it's the way that
I think uhm or I should mention that a
lot of people nowadays are moving away
from package managers and writing
everything in pure NPM and node the
problem with pure node script is that
you have to figure out how to execute
all the things that you need to get
things done whereas gulp comes with all
of these plugins and these plugins are
already pre-done for uses like oh I want
to transpile s awesome I just get a gulp
plugin for that and it will do it for me
so you can get this whole ecosystem of
help from other web developers from
around the world so you're gonna install
it you install it both globally and
locally in some cases so dash G and then
a local one and then you run your task
runner with whatever task you want to
run does it make sense surfer lost
anyone so for anyone sleeping okay it
started out really good everybody's like
hey this is cool and I started talking
you all good quiet so I'm gonna turn you
into this
I love stock photos my goal today is
that one of you guys will sit here and
look like the guy second to the left
because that is one that is enjoying his
presentation right
so I'm gonna skip out of presentation
mode and I'm gonna go into Visual Studio
which we all love I have started up a
project here it is pretty much a very
very simple application
it's an MVC application it includes a
single controller I just want to show
you so you know that I'm not lying it is
a single controller with no
functionality in it it's got a single
view with nothing in it can we agree on
that
it includes some styles unless and you
can see that I was supposed to become an
aide art director before I became a
developer so this is what comes out of
me it's just pure gold it's a little bit
of styling that will make everything
look better and finally there is a
typescript based
angular application doesn't really
matter that it is angular if you don't
know angular it's just it's a typescript
application I built a lot of angular app
so that was the simplest way of doing it
and how many of you are doing angular
applications okay so for you guys I just
want to mention a few things first of
all it's written in typescript which is
a little bit different would not well
not everyone is doing it and also I
don't bootstrap my application using the
data - ng - app like you're told to do
on with angular
instead I actually bootstrap it manually
inside of my types root file so I do
angular element I get the element
document and then I say when that's
ready I want to bootstrap my angular
application the reason for this is that
I'm gonna be dynamically downloading my
resources later on so I can't bootstrap
it in the way that we're used to I just
want to highlight this so that when
things work and you're sitting there
scratching your head that is the reason
why it's working okay yes that's okay
good Chris awesome
so first thing I need to do is I need to
get the resources I need so I'm gonna
I'm gonna do a bootstrap in angular
application so I'm gonna go in here I'm
gonna go to open folder pull up my come
on line go Bower Bower is already
installed on my machine so I'm just
gonna go Bower in it can you guys in the
back
see this you've got good eyesight and
I'm getting old I'm gonna go Bower in it
press ENTER then it goes name I'm now
going to tell you the secret to building
a really good power init file for the
things that we are doing because there's
a there's a certain art to it it
includes basically jamming the Enter key
as hard as you can until you end up here
because that will give you Bower in it
fell all that come includes exactly
everything you need it looks like this
let's go ahead and show all files
include Bower JSON including project it
looks like this I have now cheated a
little bit because you don't actually
get all of the dependents down here it
looks like that normally I am cheating
because I can't trust the internet
connection in this country it's been a
little bit flaky and I didn't want to
spend all of my time trying sitting here
looking at the black screen trying to
figure out if it's installing or not so
I decided to it but basically you get
something that looks like this what does
all of this mean I don't really know
when you don't have to care because
what's in here except for the
dependencies is things you would use if
you were building a node application
you're not you're just using it for
Bower resources so you can just ignore
everything in here so I do Bower Bower
in it to get that file next one I go
Bower install I go bootstrap - - save -
dev I'm not gonna press ENTER because
I'm cheating but if I press enter here
it runs off to Bower and it gets hold of
bootstrap for me and it installs it into
a folder that is called Bower components
so if we look at the file I've already
got a bower components folder here I
made like a TV chef I've got something
prepared and if we look here I get
bootstrap inside bootstrap I get this
folder inside the dist folder I get CSS
and fonts in JavaScript I get the CSS
file here is my bootstrap stuff so if I
go ahead and I open my view
I pull out my bootstrap Minh CSS and I
push it in up there I'm happy with that
I'm gonna close this down remove and I'm
gonna go and say Jumbotron there is
there's gonna be a bit of snippets in
here tip from having done this many many
many years do not take on clients that
want projects that you don't have
snippets for it makes everything much
much easier got this in here control f5
control f5 there it is tada
it's beautiful right this is a bootstrap
website they all look like this pretty
much all of them look exactly like this
there might be and added some other text
in there not just for the world but this
is a bootstrap site can always tell a
bits website now that we've got that I'm
going to turn my fantastic boost website
into a angular application which
basically means I'm going to make sure
that the title comes out of angular and
says something else so the next thing I
need to get a hold of angular and that
as well would just go be go out here say
bower install angular - save - tab and
it ends up in my Bower JSON file since
I'm cheating that's already in here so
let's go ahead and pull that out again
Bower components angular here is an
annoying thing all of your Bower things
will come down with completely different
folder structures there's no logic to
where you will find the JavaScript or
CSS file that you need inside of a bower
package it can be wherever but I happen
to know that for this one it's the
angularjs that I want don't click it
like that cuz that's not gonna work drag
and drop it like this and you always put
JavaScript at the end somebody told me
once I got that I can go ahead and I can
go to my body and say data - ng - can -
controller equals my ctrl as ctrl so my
controller if we
look at the typescript stuff is I've got
a my controller here it's a class that
includes one single property called
grading the grading comes out of a
greeting service a greeting service that
I will be injecting and I will have two
different modules so I will have my
services which is a which is just my
greeting service and a an angular module
that will be we run JavaScript module
that will be downloading and then the
app will be in another module so I will
have a more modular application with two
files it's a big big application this
thing once I got that I'm gonna go in
and I'm gonna make a little change here
and I'm gonna say curly brace curly
brace ctrl dot greeting like that so
that's basically my application it is
now going to look and work like that so
it's kind of broken so what I need to do
is I need to make sure that I get my
Styles in there and I did you get my
JavaScript or my typescript transpile
and then bundled and minified so I'm
going to start out with the less so did
it less I would go and say NPM NPM in it
NPM will then go through the same thing
here and there's a trick to this there's
an art to creating these files and now
you think I'm just gonna slam the enter
key but you're wrong because they cannot
have an uppercase letter in the name so
you have to press X and then slammed
Enter key because that's the way it
works once you've done that which I'm
not going to do well I'd rather not do
that I'll just kill that because I've
already got one and I want to keep that
and I don't want to write it so I
created one of those apparently I
haven't I thought I had that's trying
create one NPM init X master keyboard
there it is have a look at where he
creates include
and you get it looks pretty much the
same right and then when you install
things it will add a dependencies node
in there and tell you what things are
depending on as well if you're not
cheating like I am right now but you
just do npm install - - save - they
haven't it will work once I got that I
need to install gum iíve chosen gulp
because it's easy to work with and I
like it so I'm gonna go and say npm
install gulp - - save - dev that
installs gulp gulp in my project locally
for this project already done that so
that's happy I'm gonna go ahead and I'm
going to do NPM install another project
that's called gulp - less so all gulp
plugins are named gulp - something so
when I want to do and transpile from
less to CSS I just go NPM install gulp -
less and I will guess the less
compressed transpiler once that is
installed in my project I can go and
create a new file I'm going to do add
new item and in here you actually have
gulp file configured all configuration
file as an item in Visual Studio she had
one of those remove some of the stuff
that they've put in here so the way that
gout works it's just an NPM script
inside something called a gulp gulp
follow J s and you use required to get
references to other modules so I'm gonna
save Orgel vehicles require gulp saying
I need gulp then I use gulp to create a
task it by default you have a default
task in here but I'm gonna create a new
task and it's gonna look like this
transpile s so I I require another
package or another module called gutless
I'm going to name my task transpile :
less and I'm gonna have a transpile : j
s and that's the name of it and whenever
that is called I want to execute this
and what I do is I use go to say can you
get all the files that fit into this
glob pattern and this glob pattern says
any file with an extension of less
inside styles or in any other folder
below it once you've got all those file
it starts with cold streams so you take
what you get out of that request and
then you pipe it on to the next thing
you want to do so I take those files and
I pipe them into less what I get back
from that less call here is a new set of
files that are now transpiled CSS and
then I go and say I want to pipe that to
this function which says I want to
output my files that I've got right now
into a style solar so if I go out here
and I go gulp go transpile : less enter
it will run through this and we open up
all files all the sudden there there is
now a CSS value so there's a slight bit
less and there's the CSS version of my
last file okay impressed
not very it gets better take this we
throw it in here but there save we just
make sure that everything is working and
that my awesome designer skills shine
through it's blue with white text so
I've got my less transpile so I now have
less in CSS for Miller got my less into
CSS format and everything looks good
next thing is I need to transport my
typescript so if I install golf - less
to transpire less I assume you've
figured out that transpiling typescript
is installing NPM install golf -
typescript once you've got that
installed you go and install or you go
and run I'm actually gonna I'm looking
at the right thing the wrong thing here
yes sorry I'm trying to get my head
around all the things I need to do
transpile j/s transpile - yes so I
pulled out another node gulp module
called gulp I script and all that really
does it just wraps the TSC Exe file like
that transpire the transpiler that's
insider in
typescript so I do the same thing
another transpile : TS it gets all of
the TS files inside of the typescript
folder and folders mini that I pipe that
to the typescript transpiler and telling
it that I want to have es 5 so I want
JavaScript that runs in browsers today
you have the choice of es 3 5 &amp;amp; 6 &amp;amp; 6
won't run in your browser so 5 seems
like a pretty good choice and also I
wanted to produce modules so I want to
do in module JavaScript loading so I
want to use the system module loading
there are a few different versions of
module loading in JavaScript and finally
the result of that which would be my
JavaScript files I want you to pipe out
and write them into the build folder if
you don't know it like going out here
right in gulp transpile : TS you can
also pull up the tasks run or Explorer
which is in Visual Studio it will find
your gulp stuff you can right-click the
transpile TS and go run and it runs gulp
in here for you which is quite nice that
seemed to worked and if we have a look
at our files in refreshness there should
be a build folder and inside that we
have my JavaScript version of my touch
script once again there's not a lot of
code going in here it's just this little
things like little gulp will do most of
things for us next thing is I am doing
this and what I called a modular loading
which makes everything a lot easier
you'll see it then but it means I need
to use the module loader
because there's nothing built into our
browsers today that will do javascript
module loading so we need to get a
helper for that and I've chosen to use
something called system Jas system but
Jas can be installed through Bower so I
just do bower install system Jas - - dev
- dev if you're doing it - system Jas
don't do the massive mistake of just
writing system Jas without the dot
because you will get a completely
different library and it doesn't do
anything you want once you get that that
ends up in your Bower components folder
so I'm gonna pull that out system Jas
it's in dist and I'm gonna get that file
I'm gonna throw it in there and I need
to configure that so I need to tell it
what it's supposed to be doing and you
do that by having a little config
raishin so i'm gonna do systemjs config
the corporation here is actually quite
simple your system config and you tell
it this is where you'll find all my
JavaScript files it will be in the build
directory and whenever somebody asks for
angular angular is located at this path
and also whenever you load up to Jas
he is dependent on module Jas which is
where all my services are because
there's no strict contract between those
two there's no strict reference between
app to Jas because it was dependent on
interfaces it doesn't know that it needs
to load that file as well so I have to
tell it that when I load this go and
load that other thing as well and
finally I have to tell it that angular
is little bit specific angular uses a
global format and it exports something
called angular but once you've got this
going you go and say system import app
Jas it's all you need to do I don't have
to tell it about all of the other
JavaScript files I just tell it about
that one file that I want to start my up
with and we go out here press f5 no
record I love how it you just stand up
and finally somebody will buckle and
clap their hands it's awesome and this
cool thing is actually not that I know
it's it's not cool or old but ooh so
actually I do want to get rid of that
now cuz I'm not trying to load it twice
rather again what I want to show is
actually network so I'm gonna go in here
and go F okay so what happens here is
I'm I'm going in and not let's have a
look at this go away I started out by
loading index in the index and then I go
in long bootstrap system J s site CSS
brush the link you can ignore cuz that's
official studio doing its thing then I
tell it to load up J s then systemjs
figures out that that is dependent on
module j s and oh they're also dependent
on angularjs and oh yeah I need to get
my controller J s as well because app j
s needs that one and oh wait grading
service needs to be
as well so it figures out the whole path
of all the files that need to download
for me I only point at the entry point
and that thing figures out the rest of
it and I don't have to add it to the
view in the right order is that sweet
very sweet because it simplifies things
and it gives me some abilities you'll
see in a little while of changing the
way that I load things so the annoying
thing is with this I often do a lot of
type script stuff and I really don't
like the idea of sitting there and going
gulp transpiled
and going out and f5 and then I go back
and I make a change and have to go gulp
transpile instead you can do and watch
so I can tell gulp to watch files for me
instead so I go gulp watch so I created
a new task called watch and in this
syntax the second parameter is an array
of other tasks that I want to run before
this so when I go gulp ha got watch it
will run transpile s and run transpile
TS for me to transpile everything and
then it will setup a gull watch saying
that whenever anything in that with a
less extension is changed i want you to
go and run this task call transpire less
and whenever you change something in a
typescript file I want you to go and
transpire my Typekit for me and then I
can go to my task runner explorer and
just say hey dude run that for me and it
actually locks this thing up completely
and if I go in and change something like
for example go in and change my less
here and show off some more of my skills
like hot pink save and we go out here
you'll see that it's actually run
transpire less for me down here without
me having to undo anything and it's also
reloaded this for me since browser link
is in the background the notes that I've
loaded that started that site but CSS
whenever I changed less file
gulp says to change it goes in and
recompiles my lesson to CSS browser link
sees my CSS file changing tells browser
link to reload the CSS file in my web
browser and it reloads here so I don't
have to do anything so if I go in here
and I change this
to black and press F just save it
pressing nothing else is already black
out here because browser link is seem to
change so we can do really rapid
development for the UI things when it
comes to CSS through less and also if
you have a slightly less than optimum
memory like me you can go in here and
you can right click watch and you can
say bindings and say project open it
will change my gut gulp file by adding a
little comment up here saying binding
project opened watch and that means that
when Visual Studio opens the project it
will see this and it will start running
that task for me when the project was
open so I don't have to go in and start
the watch task because I don't know how
many hours I've spent on projects where
I've gone in and made changes and not
figured out why they don't come through
and I forgot to start the watch task it
takes it a while to figure out trust me
so what else can we do in the build
pipeline how many of you are doing
typescript development how many of you
know what a JavaScript source map is
it's not the same people but it would
kind of source maps are awesome because
they can point your JavaScript to
something else so if you minify your
javascript files you can get source maps
that will take and point minify
javascript execution things to
unmanifest
so when you do debugging you can debug
in your non minified files instead of
your minified ones but you can also do
source maps that will actually let you
take JavaScript and debug typescript
because the javascript file comes out of
touch whit files right it's the only
thing you need to do is npm install gulp
- source maps which is another node gulp
plugin and then you go ahead and we're
gonna change this thing here transpile -
yes to transpile TS - we get another gut
plugin called source maps work gulp
source maps and I changed the pipeline
here for my transpile TS into having a
source maps in it
right before I do the transpile and a
pipe to a source maps right right after
my strands pile
so these transpilers have been built in
a way that they actually emit
information about what they are
transpiring so this is the original
thing and this is what I'm outputting
and things like that and then the source
Maps plug-in can can plug into that
information and keep track of what's
happening and that means that we can
just use this source Maps thing for
different things if I'm transpiling from
typescript to JavaScript it will figure
it out if I'm minifying it will figure
it out and it will write out the source
maps for me having done that I can go to
my test run or Explorer I can run
transpile - yes you will see that it
generates in my build folder if we
refresh here it generates now J's map
files as well and using those J's map
files I can now go back into my browser
I can go to sources I'm just going to
refresh this once you'll see that
actually out here it now loads up
typescript even though I'm not calling
any type of adding anything from the
typescript folder in my view it figures
out that with those source maps they are
located in that folder so I pulled that
out I take my my controller being zoomed
in here is just gonna make you sick take
my control and I set a breakpoint on
line number five refresh this thing and
it breaks into my typescript and I can
debug my type crypt that's pretty
awesome in my opinion and you can go
ahead and do all the things you normally
do when you're debugging your JavaScript
but you do it in your typescript instead
because you can once in a while be a
little bit tricky to figure out when you
have taken your type script and
transpiled it and minified it it is a
little bit hard to figure out that
calling the function au with parameters
B and C actually means calling function
do this with two values right this will
help you out with that
but I also started out saying bundling
and minification was important so
bundling bunting is where most people
start and bonding and minifying things
so bundling the way that I'm doing
things here is a little bit different
because I am using system j/s right to
do all of my modular loading so when I
do my bundling it would be kind of nice
if I didn't have to go and figure out
what order to do things because system
Jas manages to do that on the client
there's a little tool that will do it
server-side as well or when you do
builds there's a tool called system Jas
- builder so you go NPM install system
Jas - builder and once you have that you
can then create something that looks
like this fun no sorry I need one thing
first you need to create a configuration
for it I always forget that add
javascript file bundle config then you
do bundle config this is like the like
in the web page I did a system dot
configuration and basically told it here
system dot config that this is the
information you need to know to be able
to do your modular loading I'm going to
create something that's similar to that
in here
but in this case the only thing I need
to really tell it is that angular should
not be built so whenever you see a
reference to angular do not include
angular in that module I want to load my
angular separately instead I don't want
to bundle that into my own stuff you can
add a bunch of other things in here so
you can configure in the same way that
you would do your browser once you have
that file you can say bundle module so I
created this little helper first of all
it pulls in a gulp plug-in called system
JSF builder or it's an NPM module and I
create this helper method called bundle
module that takes an empath and out path
and a minify bullion whether or not to
minify it I tell the Builder I create a
new builder and say this is where you'll
find all my JavaScript files and this is
where you will find the configuration
that I've set up for you and you could
obviously have different configurations
for different things
I'm just have one here
and also the default extensions I forgot
to mention that before by default system
Jas won't add Jas to the end of file
cities trying to download and
unfortunately when you'd go from
typescript to JavaScript when you
transpile it the module of stuff that
ends up in your JavaScript file doesn't
include Jas attained end of things so
this thing here is just saying please
add dot J s to the end of everything
that you try to load then I used the
Builder to say I want to bundle whatever
is in the end path I want to output it
to the output path and also when you
fetch things it's another one of those
trying to correct the fact that it's not
adding dot G is it's just a little fix
around a little tweak so it adds dot Jay
yesterday and if it's not there and I
want you to minify it if I've told you
to minify it does that make sense
not not hugely complicated but the most
important thing is you sure get the the
idea of bundling using this once you've
got that and then go ahead and create a
bundle JJ s create another gulp task
called bundle yes before I can run bonds
guess I have to run run transpile TS
because I have to transpire my type 50
JavaScript before I can bundle it right
and inside that I just called bundle
module and I want to bundle the app.js
file and I went out party to up to a
bundle of jeaious in the bundle folder
and then I go in a bundle another module
with my services and I pass in false so
I don't minify that just bundle it
running that will if we go in here and
we run bundle j s will generate a new
folder here called bundle it includes my
bundle with my app bundle and it
includes a services bundle with my
JavaScript in it can then go out here
and I can say I'm gonna replace this
with system J as a config to all I've
done here in this nipple is I've I've
moved the base URL out in
a separate variable up here and I've
changed the map here to map like this
instead same thing as before I've just
moved into different variable I can then
after I've done that go in and do system
j s config three I comment that out and
then I add this I just changed the base
URL to go to bundle instead I tell it
that oh by the way whenever you try to
load angular how about you go and do
that from the CDN node instead so now
I'm actually pushing it out to a
different host gaining more connections
to my machine or to my host whenever I
try to get up jeaious download app
bundle jeaious whenever you try to get
services let's slash module J s go ahead
and get services slash bundle j s go out
here that's just that little change just
changing my pad mapping and my base URL
go back out here go to network tab
I should be freaking out now but I know
what's wrong and the problem here is
that I'm in Australia because I can't
get anything off the CDN because the
Wi-Fi is broken so I'm just gonna go
ahead and still load this from my local
machine instead so I'm gonna go ahead
and replace that with dot Minjae s
actually we can do J s here go back out
here I load it again and it works but
the cool thing is that little change
it's just a little config change and all
of a sudden it's just loading system j s
app bundle services bundle and angularjs
it's not trying to load all of the
different things but I can always go
back to the previous configuration and
load the unbundle files with just a
little config change minifying things is
pretty much as simple you just go in you
go to the gulp file it looks like this
mini Phi J yes it's the same call as
previously new Taos mini Phi J's but I
pass in true at the end that sets this
little parameter down here that says
minified for me
that mean if I run that generates
another folder with with information in
it this folder inside the disk folder I
have my application in minified format
make sense not very complicated I get
these two minified files I go back out
here take this
I'm gonna say system J is config for
comment that out and say instead I want
to go to this folder this time and I
want to load not that cuz I'm in
Australia I want to load this that
should be flag in all applications I'm
in Australia and it just stops loading
things off the web I gonna say angular
is still from that other place it should
be the CDN and then up J s is up Minjae
s module j s is in services Minjae s
ctrl s go back out here press f5 and
wait for it it doesn't work anybody know
where it doesn't work didn't you say you
were working at some of you were working
with angular what happens when you
minify things in angular that uses
dependency injection because dependency
injection in angular is dependent on
variables parameters to functions having
specific names when you minify them it
goes poof and doesn't work there is a
cool feature or a cool little tool that
you can use so you enter a typescript go
into my my controller which is the one
that uses dependency injection
/ / @ ng inject I add a comment in here
so as an annotation it's not a proper
annotation it's just a comment but it's
kind of an annotation then I go ahead
and I install another a type gulp
plug-in and I'm gonna go and see if I
can find my transport yes there it is
so install another gut plugin cool ng -
annotate and then after I've done my
touch script compilation I do ng
annotate ng annotate will go through the
JavaScript file find all of the slash /
@ ng inject figure out the variable
names add the other dependence injection
syntax for angular which is the dot $8
injector whatever it is I've done in
ages because I will use this and make
sure that when I minify it it has two
correct syntax for doing dependency
injection even if it's being minified
run this thing and if i jus run go out
here f5 and it works and it was fast and
down here you can now see that it's
loading my minified files so i got this
simple way now everything is building
here nicely I've got this simple task
that I can run they can be automated
that they can be put into your build
servers it will generate the output you
need you have different configurations
of abilities you can easily in your view
here go in and change your view work
your configuration to load minified or
bundle or individual files depending on
what you need so the last thing I
generally do is in here I will go and
take out this as a system JS config 5
and I will add this little piece of code
it's a mix of client-side code and
actual MVC code or a short we're a
tracer code
so if HTTP context or current thought is
debugging enabled I will load it from
the build and I will load angular
locally and that will mean that I will
load individual files I won't be
dependent on bundle of bundled things I
will just run the the individual files
but if I turn off my debugging I can go
in and say if it's turned off I want to
go and load the dist I want to go to the
CDN instead I want to load the minified
files so I can now configure what
loading I want to use if I want to go
minified or bundled or individual files
by based on a config flag in web config
quite napes
currently so there are a couple of
things to think about when you're
running gulp what I've been showing you
here is first very simple
they generally scripts tends to be
longer and all the sudden you're gonna
run into the fact that all gulp tasks
run in parallel if you go ahead and say
this task depends on this other task it
will be a synchronous call but if you go
and say inside of a tasks a gulp go and
do this gulp go and do that
those two tasks will run in parallel and
you will end up having tasks running in
parallel and breaking and you're gonna
get the best one is when you start
getting half files out there or you get
something that's half transpiled and
half minified because it's basically
running everything in parallel you can
use something called merge stream which
is another tool or another module that
will actually do things synchronously
for you so you can merge your streams
and get things to get synchronized but
think about the parallel stuff go tap is
another one who is awesome little
modules where you can go because when
you start doing this it's really hard
once in a while to see where in my
street my gulp pipeline am I losing
things because all of a sudden I'm
filtering out files and all sudden
things are not coming up properly go tap
allows you to go in and console right
out file information so you can see what
files a my work is this this pipeline
working on at the moment so you can
debug whatever you're doing wrong
general got just with we're doing this
thing is if you're doing angular or any
other form of dependency injection like
I showed you it breaks so you need to
figure out a way of if you're minifying
you need to make sure that your
framework has a way of sorting out
minification ordering files I've shown
you a module loader which makes this
demo a lot more complicated because I
use system D is I could have skipped
that but the problem is for a demo like
this with 4 files it's actually quite
easy but what happens when you have a
project with 4,000 typescript files and
they need to be loaded in the correct
order for them to work it always ends up
with files being loaded in the wrong
order and it explodes so I would suggest
doing a module loader if you can Visual
Studio typescript transpile is different
from TSC which is the command-line
transpile for
some reason Visual Studio transpose
things slightly differently in some
cases just to be aware because
typescript will transpire sorry vicious
dude you will transpire typescript for
you on the fly on save in your project
if you don't turn it off I have
specifically turned it off in this
project to not have JavaScript laying
automatically generated but if used to
go ahead and you use the visual studios
transpile and then you check it in and
your build server uses gulp you might
end up with it breaking on the build
server because they're loading
dependencies slightly differently
pipeline needs runs throwing during your
CI and CI CD builds so if you've got a
build server which I hope you do you
should be running this on the girl on
the build server you should not be
checking in your bundled or minified
files you check in your raw files your
typescript files only not javascript
files and then you run the transpire
bundle minification tests and whatever
you need from gout inside of your build
server if you don't know how to do that
you won't have a look at it I have
blogged a little bit about it to get it
to work mostly around asher and how to
get it to work with github deployments
but also how you do it with teams
foundations Louis the name of it now
team foundation services vs vs TS is
that the proper name for it now okay
Misha studio team services so you if you
use VSS there's information how to do it
in there as well and also if you wanna
do it generally there's actually quite a
bit of information as well remember if
you're bundling and minification becomes
really important it's actually important
to begin with but it gets even worse
because it once in awhile it it doesn't
cause a problem when you change the file
that is still being cached somewhere
because it might not always be used but
when you start caching your whole
application it becomes complicated so
you want to add a little when you
include your JavaScript files you want
to add like a question mark something
equals something something unique for
that version to make sure that it's not
cached in some proxy along the way last
one I've got about 30 seconds to go I
have another feature a system config
that I've been using or if included
manually I add a prefix
my web config file it's just an
upsetting with a unique key in there or
rather it's an empty string to begin
with and it basically means that I can
add that and say normally there's
nothing in there and it will just load
with base URL slash but I can go in and
say by the way I want to prefix that
thing with something else so I can go in
and change my web config to include the
URL to my CDN and then to see the end
URL is added in front of it so all of a
sudden instead of going to slash I'm
going to start got food com slash and
then I get my files from there so it's
very very easy for you to move around
from loading files locally or from a CDN
or from blob storage or whatever you
want by being happy having that little
prefix before the path right gzip is
awesome didn't show it but there are
gulp plugins for that as well
typescript testing should definitely be
done linting not really important in my
opinion depending on your team however
you do want to do JavaScript testing as
well so sorry that way run linting is
not important in JavaScript testing it's
not 100 set important in typescript in
my opinion I will do it all the way
around I will test my my things when
I've compiled into JavaScript and I will
I will do my linting on my typescript
there's no reason for you to lint your
JavaScript because the javascript comes
out of a transpiler that's automate it
so don't go ahead and do extra work in
your pipeline unless you really have to
that was it one minute over sorry about
that I hope you got something out of it
thank you for listening if you have any
questions I'm up here and I'll be around
for another 45 minutes before I run off
to the awesome liquid nitrogen ice cream
bar which is in Chinatown</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>