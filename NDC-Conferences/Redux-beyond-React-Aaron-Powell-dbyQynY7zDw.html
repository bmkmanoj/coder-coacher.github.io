<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Redux, beyond React - Aaron Powell | Coder Coacher - Coaching Coders</title><meta content="Redux, beyond React - Aaron Powell - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Redux, beyond React - Aaron Powell</b></h2><h5 class="post__date">2017-04-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dbyQynY7zDw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right looks like we're good to get
underway I know that I'm the only thing
standing with
nice and quick welcome to react beyond
redux my name is Erin Palin hopefully
the next hour I'm going to teach you
some other ways that we can look at the
readouts framework so like why are we
here why are we talking about reacts so
Redux without react well redux it was a
lover II was created a couple of years
ago by a guy named Dan abramov and he
actually works for facebook I don't
think II was working at Facebook at the
time he was just a reactive user you
know works at Facebook with inside of
the react team or the various teams to
work on react pieces he first demoed it
at react European 2015 and the premise
was it was looking at an alternate way
to do flux and and that was one of the
underpinning reasons for reactors that
he wanted something that was very for
really wanted something to work with a
react application but he wasn't quite a
fan of the way flux worst and and some
of the patterns that were involved in
that so we put together this really
simple framework and diamond it off and
demoed a bunch of really interesting
things around how would working inside
of a reactor application but today I
want to talk about redux when you're
wanting to use it with inside of a
different app application architecture
own maybe you're not using react maybe
using another JavaScript framework
because it turns out that Redux is
actually not specifically tied to react
it just happens you're really popular
with inside of the react community and
that's where the author and a lot of the
contributors have come from and but it's
not specific to Redux to react I'm going
to keep saying react instead of redox or
read out instead of reacting it's going
to be really annoying throughout the
rest of talk because I'm just going to
keep going back over my own words but
bear with visas there's only 58 minutes
left to go we'll be fine we'll get there
so yes I just talked a bit about Redux
for those that either i'm not familiar
with it or haven't used it in any great
depth there's three core pieces to it we
have actions reduces and a store
this is kind of the Iron Triangle of a
redux architecture these three core
components actions in reacts this is
something that has happened with inside
of the application that's using redux
it's got a unique identifier on it so
it's commonly done with a type property
on the object that's being passed as a
redux action but basically it's it's
some kind of an event thinking about it
from a dotnet perspectives and that's my
background is a net developer it has a
lot of similarities to the kind of
events you arrays inside of a donate
application fee that a desktop
application or a mobile application or
even with server-side events inside of a
web application and what I've got here
is a very simple action creator function
it's called echo action it has an input
to us and returns you an object which is
the actual representation of the action
you'll see that we have a type property
here that has value echo so this is the
action type that's being raised by our
system we have some kind of data that's
being passed to it in this case I've got
a payload property which is the the
value that is to be echoed out so the
reducer this is something that listens
for actions or a single action it
receives the existing state of your
application so the state has been
produced based off any previous actions
that have been executed and it combines
it with the current action to then
produce new application state so the
idea of this is that it's a pure
function if you've done punctual
programming the idea of pure function is
probably fairly fairly well known to but
at the end of the day a pure function is
something that receives all the input
that it would need to be able to do
something it has no external
dependencies in terms of global
variables or global state outside of
that that function and internally it
will not mutate anything that it doesn't
own so the
the state has passed in it doesn't
change you produce new state based off
of that so here's a reducer function and
see we've got two arguments that go to
it we have an action we have the state
and we have an action we then doing a
test here to work out if this particular
reducer is capable of handling some kind
of an action so in this case is this
reduce able to handle the echo action it
does so if it does it returns the action
payload so from the previous slide but
it might not actually deal with there
might be other actions are being treated
with inside of our system that this
reduces doesn't care about it's got no
ability to work with them it doesn't
need to do anything with them so those
will just return the current application
state because we're not going to change
it so we're just going to part it
becomes an operation essentially so then
the store is kind of the cornerstone of
your architecture it's where everything
lives data so it's the only place in
your application that state would then
mutate so an action gets triggered the
reducer producers you state the store
knows about that and then it has the
state it's the one that's updated based
off of the the new state that was
produced by the reducer it handles the
marshaling of an action or multiple
actions across to the reducers that are
valid for them so it will do that sort
of that pass through you can have
middleware applied to it so kind of if
you if you're familiar with many of the
web server approaches that are happening
at the moment the asp net corby that web
api on top of katana be that express or
any of the other no jeaious ones middle
where is the idea of being able to just
plug into a pipeline and have something
executed at some point in time before
the final part of it so we receive some
at and something we do something with it
and then we pass it on to the next stage
of our pipeline so that their middleware
is handled entirely with inside of your
store and the final thing that does is
it has to tell people that the action
has happened and that state has changed
it be all well and good if it's just
internally updated state and then no one
knew about it application still going to
do anything now how does the
do I respond to data changes if you're
not able to tell it so that's what
subscribe to notifications are all about
with inside of the store the store
actually is created from a function that
comes from Redux itself so this is the
first time that we've actually had
something provided by the Redux library
everything else has been and ceremonies
around how Redux would work and it's a
method called create store it receives
up to three arguments in this case I'm
passing in just two arguments the first
argument is the reducer that this store
users we pass in some initial state of
the application so in this case the
initial state is empty string because
we're just going to echo out and things
that get get dispatch to it the third
argument would be if using middleware
obviously it's a distributed example i'm
not using middle way you see I know
after we've created the store within
subscribing to change events this we
pass a delegate function to it and this
will be triggered every time an action
is dispatched here where this one is
just really obviously simple it's
updating a UI in the form of a dev tool
console so when the application when
action dispatches console dot log will
eventually get executed with the state
of the current application down the
bottom there were triggering off in your
new action so the system has done from
the event has fired we're invoking the
echo action so there's some interesting
quotes about the way the Redux
architecture works so in action needs to
have a type as I said before now this is
a little bit problematic inside of
JavaScript kazoo we need some way of
being able to identify different kinds
of actions in JavaScript because we have
a very simplistic type system the
easiest way to do that is just a
property on the object that we're
passing around the type property that we
saw before yeah reduces they can't
change the state that they're given so
your state could be really large you
could have tens twenty hundred
properties on it and you're getting two
hundred probably properties on your
state you've probably got some other
architectural decisions you need to
think about but with all that data you
need to then build an entirely new
object based off of that reduces can't
return undefined your application should
never get to a point where the state of
the application is undefined if you're
if you're
application doesn't have a defined state
will what is your application actually
trying to represent and the everything
that happens with inside of a store
happens synchronously so when you
dispatch an action it goes straight
through to the reducer it might pass for
a middleware sure but everything happens
synchronously now this is interesting
JavaScript if you're doing something
that is asynchronous a lot of what we do
in javascript programming is
asynchronous you we're using fetch to go
out and pull something down or dolls
Ajax if we're using jQuery room that's
an asynchronous operation and this is
where middleware starts playing in you
would have a middleware that can handle
something that's asynchronous attend an
asynchronous operation into several
synchronous operations we've started an
AJAX call we've finished an AJAX call
and our applications then can respond
differently to those i'm starting an
AJAX call wish i was spinner to indicate
a loading state hey Jess call finishes
we hide a spin on that sort of thing now
you might be thinking that you've heard
this kind of an architecture before well
it's not a unique system but it's
basically an event store this this
architecture is very common across a lot
of different programming languages and a
lot of different design paradigm you
know the idea that you have a single
place where data lives and that's the
that owns state as it is I said it's
basically an event also congratulations
the JavaScript community you have read
this rediscovered something that we've
been doing a long time particularly in
server-side programming well done and of
course being JavaScript we have to give
it a funky name so that everyone knows
that we did it first and it's awesome so
relax in a nutshell that is now I said
the premise of this talk is we want to
look at Redux beyond react so with Redux
so the create store is kind of a cool
thing that you would work with and then
you need some way to plug it into
whichever UI framework that you're
working with there's actually bindings
out there already for non react
frameworks so things like angular 1
angular 2 and angular 7 which I think
I'll announced yesterday version is hard
but you know I think they're up to 12
there's things like backbone there's
bindings for that same bindings for
polymer and kind of picture p
you big popular you I javascript
framework and there's probably there's
probably a rare there's probably a
retouch binding for us out there or you
could create something for a less
popular framework you could and it's
actually fairly trivial to create
findings so that's what I've gone and
done and I've created a binding for a
very well I'm not going to say unpopular
better less than popular or less than
common framework so it's going to open
up doodle-do code and who remembers
knockout jas yeah we've got someone over
here the remembers not get Jesse I look
I'm going to admit that it's quite a few
years since I've written anything with
knockout but I thought this was a good
illustration of how it doesn't need to
be used with you know any particularly
fancy JavaScript framework nothing that
has massive ceremony around it like like
you get with angular or polymer or react
or anything like that I'm just going to
start up some code launch our browser
and so I click a button and the counter
goes up excellent Kodomo has succeeded
while i'm clicking on the button and
this is a highly technically complex
application that I've got right here so
I have an action to find up on line 28
it receives a value and has a type of
increment or ink payload which is a
value and then that gets passed through
we have a reducer which i have defined
with some initial states there and has
the number of clicks that are in there
which starts off 40 unsurprisingly and
then the action if the action was
increment then we create a new object
based off of the existing statement now
admittedly the existing state is
probably only going to have that number
of clicks property but if it didn't have
the number of clicks property I'm using
object to sign online 37 object to sign
is a very simple way to create new
objects based off of other objects and
then override properties on them so I'm
having I have an empty object which is
the first argument I have an object
which is state and then I'm passing
another object which is going to
override so the number of clicks
property would override the number of
clicks property on state which would
override the number of clicks property
on the empty object
that's how you build up a new object
based off of an existing object now
we've got Redux create store with our
reducer I'm not passing default state
because i'm using a default argument
instead in our reducer just kind of
illustrating different ways that you can
do that and now we need to bind this to
DUI but I want to take my store and
subscribe to the events that are
happening with it the dispatchers that
happen and then push those up to the UI
so when they happens I'm going to unpack
the states and this is a common way that
you would work with reacts and redux
together you have a method that the
bindings of you call connect you connect
a redux store to a react element and you
do that by mapping the state of the
store to the properties that are passed
in so I just kind of used some some
common naming that you might come across
if you've looked at existing Redux and
react tutorials but the thing is that
I've written this for nokia so it works
slightly differently so i have our store
The Dispatch two profs and state two
props and that takes sort of the first
one takes the use this new state and
then returns a new object based off of
that doesn't really provide any
particular value but it still works and
then dispatch just produces a click
method that we've my knockout binding I
can bind up here at the top so how does
this work internally I have knockout JSP
model not particularly complex doesn't
really do a whole lot of things other
than and has an observable properties
that has an initial state passed into it
it has a method called register click
that when you click on that it triggers
the dispatch on the store which is what
happens there online in line 57 you
create that method so I created some
bindings for Redux to react we have a
connect method that receives a store it
then returns you a new function that you
pass in dispatch to props and state to
props which then returns your new
function that you pass interview bottle
the originally hind you would do so the
reason
you would do something like this is you
might want to connect one store to
multiple of your models so I could pass
in or you could first off you might want
to take one store and remap the the data
with inside of that store differently
depending on which you I so you might
have a different implementation of the
state to props method for example so we
could be unpacking that slightly
differently now so I could invoke lips
back on to here so I can invoke read us
KO connect store and then use that
multiple times just catch that as an
object I could execute up to these two
lines and then pass that with multiple
different view models in knockout so
that I could use the same underpinning
set of data but render that differently
based off of the needs of a particular
part of of my application and the final
thing is I'm passing in the view model
so that gets done we create this is the
view model we give it the initial state
of the application and then I subscribe
to the store change so every time this
patch happens we subscribe to that and
we unpacked state on line 18 we then
create the new properties by using the
state to props in the spatula props so
unpacking the new application state and
then I go over the view model find all
of the observable properties of that
view model and then update them based
off of the store so and so based off of
the application state that's what's
happening on line 26 down so we kind of
hide away all this guff about updating
multiple sections of the UI and and if I
had a more complex view model I might
have more observables on there and more
parts of state that I could be mapping
back and forth and that's how kind of
simple it would be to plug this into
just a different kind of UI framework in
this case I picked something right
knockout.js but that that's the
underlying premise you might have
something that you've internally written
inside of your company that has no the
same sort of analogous components which
is view models that you want to be able
to update and that's and that's a very
simple way that you could use Redux with
a different UI
it doesn't have existing bindings now
redux actually works quite nicely with
something like angular it helps you move
away from the idea of having dollars
scope everywhere with inside of your
application if you've got a controller
and then you've got multiple say ness
directives underneath of that and you
want to pass data down and you've got a
pass data backup from the directives
you've rely on things like broadcasts
and watches to do all that and those can
have some performance impacts so being
able to do everything is one-way data
binding push it down and then just push
down dispatch methods that you can
invoke that then updates the the top of
the controller and then it just pushes
data back down that can really simplify
the way that you can understand how data
is flowing throughout an application
alright so redux is actually pretty
simple it turns out oops wrong them
there's only really three core concepts
to it you have create store which is the
one that you would use most frequently
without creating the store you don't
really doing a whole lot with redux it
has the ability to create middleware
combine multiple functions together to
produce a chain of middleware that would
be executed it also has the ability to
take multiple reducers and combine them
together to then allow you to pass
actions to that as though that it was a
single reducer and it handles the
passing that across to multiple
different to the appropriate reducer
it's mostly about the architecture is
how things will interact with Redux
itself you it describes how an action
should look and how you provide that
into a reducer that kind of stuff is
what is really what the core of Redux is
so it can easily translate it elsewhere
beyond react so it turns out that
relapse itself is actually a really
small library it's got slightly bigger
over timers and smarter people have
worked out better ways to do parts of
the architecture they've continually
optimized that sort of stuff but at its
core it's really quite simple so a
little while ago I had I had an idea
that I wanted to learn how reacts works
a lot better so I decided to create a
library called reacts
pause for dramatic effect on the humor
and continue on so yeah I created a
library called Redux to users a learning
experience for myself and to share
hopefully to share with others about how
the internals of this works so let's
just have a look at that and have a look
at a way that we can use that in a
different application style yes
terminate the task let's close that one
down so I'm just going to open up a
different tab and will open up vs code
yeah so this is a implementation of
Redux that it works pretty much the same
as redux and that's going to get really
properly confusing for everyone now but
my implementation the quacky one it
doesn't have all the validation checking
internally that is that the actual
implementation does but he does most of
the same things and i created a demo
application that we can use for this so
i will just run that Redux dash demo and
this time i decided to create a console
application again just to kind of
illustrate how this application
architecture is not specific for web UI
implementations of relapse and you ice
so I have some applications 8i oh I've
created a to applique to do application
because so far they see i have not
demoed a to do application so at some
point in time i needed to do that it's
the only way you can really illustrate
complex software problems is with to do
so we've got a couple of different
actions that air system could dispatch
dispatch are added to do dispatch let
marking all the ones is done and
changing the visibility so we'll
dispatch to do which is right a talk and
then we'll add another one be awesome
now is that some additional actions that
I could be dispatching so i could find
this one i'm pretty sure i've written
the talk i can just I can click on a
triple interact with it which dispatch
is an action that has then removed
the list market is done so if I toggle
visibility dispatch a different action
we get the different states we're seeing
a different representation of state with
inside their application based off of
the action that we've dispatched other
than that Omar call is done and oops
quit so this is reasonably simplistic
internally I've done it in a way that I
can use redux or i can use Redux work
out which one was which in that
statement because I'm not sure either
but similar things that we've seen in a
couple of demos and things I've talked
about so far we we create stores we
subscribe to state this time because
it's a console application UI we're
using console dot log too right to the
UI and a couple of different ways that
we can do colors ones inside of that
don't errors and things like that we
build up a series of prompts which gives
us a bunch of bound a bunch of actions
that can be despatched oh we're
dispatching those against the store
using action creators all that's fairly
simple so let's have a look at the
create store method I said this is
really the cornerstone of working with
reacted you you need to have a create
store method Redux because you need to
have a create store method without
creating the store you're not creating
anything for with redux Oh bit of null
checking a bit of type checking at the
top of the the function we then have our
state which as I said that's the only
part of the application that's mutable
we have subscribers so the list is that
are going to be listening to to
dispatchers getting done and at the end
of the day there's some stuff that I'm
not going to talk about inside of here
just because essence of time and it's
not particularly interesting if we have
enhances so enhancers are just the
terminology for middleware that I used
when I was copying pasting code or
reading there's a source code of Redux
that they use the term enhances but
essentially that's middleware talk about
that in just a moment the subscribe
method is kind of interesting it was
this wasn't something that I noticed
until I really dived into the sort
code is that when you subscribe a
function to a store it returns you a
function which is the unsubscribe method
so you might be from a memory management
perspective particularly if you're
working with a console application you
might want to unsubscribe when something
has been removed from state when your
master to do is done we you might be
actually removing that instead of just
you know hiding and showing it like i
was doing so you want to remove some
kind of an event listener against that
thing so you could be you can be calling
the unsubscribe method so it it returns
you something that you can actually use
as the dispose also what it does is when
when the subscribers are executed so the
dispatch method is then how the kind of
really cornerstone piece of making
medicine cornerstone like 10 times I'm
sorry it's the brains of it so this is
where you pass in the action it checks
to make sure that you've provided a type
of the action so that we know what we're
dispatching will then pass that across
to the reducers with the current
application state and here's where
mutation happens online 49 you'll see
that we're updating existing state and
that's the only places that should ever
happen with inside of your architecture
we then go through the the subscriptions
execute each of those just so anyone was
listening better is updated the very
last thing that this does on line 62 is
it dispatches an initialization action
that you really shouldn't be listening
to if you read the Redux docs but I just
it's done by their implementation so I
did it I can't think of a decent reason
as to why it's being done they just say
it's a complete Andy patent to ever
listen to that action it's really
difficult to listen to that action
because you can't subscribe until after
you've created a store but as soon as
you create the store of dispatches that
action so it's a chicken and egg problem
you you can't really ever actually
listen to it because it's five before
you could ever subscribe but yeah it's
there they do it so I had to do it as
well no but it was quite interesting
because I said it up here on line
fourteen we invoke the enhancer and we
actually passed through create store
you see here so that actually passes a
reference through to this function
followed by the reducer initial state
that we had up top so the way that works
is we have the collection mill where's
that we're going to have with each other
application we receive create store with
reducer and state and it then actually
invokes that so we've gone from this
file we've gone to create store we then
realize we've got middleware we've then
gone over the middleware which is then
go back to create store but this time
we've dropped off the the the middleware
here so it actually just creates the
store as though there is no middle where
it will then grab the dispatch method
and then walk through all the middleware
and wrap a function around them that
eventually will call dispatch so it
basically builds this chain with an X
function and the next function either
points the middleware or to dispatch so
just it's essentially a a loop that is
executed and if as long as you keep
calling next you'll eventually dispatch
in action so that's how kind of readouts
works internally and this is how you
could take redux and not use it with
inside of a JavaScript web UI
so observing Redux saws now we've used
the subscribe method so far we've seen
how that can be used either console
application or it could be used inside
of a web UI to listen to events that are
happening and changes that have been
done and things like that but it turns
out that a relaxed store is actually an
observable object so under the covers it
also implements symbol dot observable
which is part of es2015 I think those
under the symbol was introduced I don't
think was 2017 I think pretty sure as
2015 and I'm so under the covers what
that gives us is it starts to look and
operate a bit like a stream or it allows
you to combine it with something like
our xjs and if you've done stream based
programming and observable based
programming in the browser RX is
probably the most common way you would
go about it's a simplest way to get
started so what that means is that we
could take it take a stream and we can
listen to that in different ways we
could do some sort of subscription to
that that applies a filter it does a
conditional subscription to that and
that's executing it's kind of like
middleware bit after the action has been
done after the reducer is fired we might
want to do something different to that
to what's happened at the end of the day
so we can listen to that and produce a
conditional subscription we could remap
the data after the state has changed so
after something like convert state to
props has been invoked we can then remap
that to create an entirely new data
based off of that stream or we could
combine it with another stream so say
that you're listening to a web socket
and the web socket is just pushing data
out that you need to display stock to
here is a classic example of that it's
just it's firing data down to the UI now
you don't want that inside of a redux
store because this is really fast
changing data it's really continuously
incoming data and you might want to be
doing some processing on there are we do
we need to slice out of it do we want to
put a some kind of a buffer
that we only get data in a every five
seconds even though the server is
pumping me out every single second that
kind of stuff we can we can combine
multiple observable streams one of which
happens to be a redux or so let's have a
look at how that one would work back to
vs code and open up another demo cool
alright so let's run this one in chrome
family phone crashed awesome ah alright
so i wrote a clock this clock actually
that's just font size that a touch so
the clock is showing minutes and hours
on it then underneath just to show that
there is continual data being pumped to
the UI have the it's showing the seconds
as well that's taking over continuously
and and every minute the minute hand
will tick well at least in theory and
that seems logical that the minute hand
changes at least once a minute so i've
only got 23 seconds left that i have to
keep talking to make sure that this demo
continues to work but the fundamental
thing that i wanted to show here is that
this is the same underlying store and i
can do different things to that to
render out the UI I don't want to
continuously be checking with inside of
my SVG going no I actually don't want to
tell me I'm not showing a second hand so
you don't have to do anything actually
want that element completely ignored
until the minute has passed and there we
go it should have moved but I was
probably talking so you didn't even
notice damn so how does this look if we
scroll down reducer I just have the
ability to stop and start time yeah man
my jokes is it too late in the day for
like really terrible dad humor I think
it must be some we have an action that
could be fired that tells us to draw the
clock so when when the system first
starts up the reason I was this is kind
of where I realized that you couldn't
you
is the unit method you can sorry the
interaction you can subscribe to that I
was like I wanted to just subscribe to
that because you know the stores created
I want to be doing so no it turns out
you can't because well that action
doesn't you can't subscribe to that
action having been fired then we have
another action time when time has
changed so now we're no longer drawing
the clock because otherwise we just
continue drawing the clock on every
second and we'd end up with a lot of
clocks but we have the previous in
previous tick of previous second and the
current second and that's just so I can
work out whether or not to change the
minute hand I have the redox devtools
enabled here so that's an example of
using middleware i'm subscribing to the
store just plain old subscribing to the
store and every single time in action is
dispatched i will check to see if there
is a time component associated with that
if there is update an element to
choosing moment for some formatting that
displays the hours minutes and seconds
we there i just realized don't know I
was like that is it actually 6pm yes it
is 6pm well moving on from that one
after after after we've created that one
so like I said that's firing
continuously at that subscribe is
continuously happening on line 62 i'm
using RX observable from and passing it
an instance of that store now this is
our x version 5 not eric version 4 which
is what i found out when running this
demo and it took me probably an hour to
work out why my store wasn't being while
I was getting errors trying to subscribe
to the store and because it's just like
just you can it's an observable just use
Eric so I go to reactive extensions and
I've download our X and it's not working
and then I go back in our original IQs
Eric's from our x / RX j it's not our x
extensions jason it's like thank you for
making that horribly confusing but still
we can observe turn-offs are in
children's overall and then on 64 of an
example of using filter so this is a
conditional and this is a conditional
state change so if the state is if the
state draw a clock is true then we'll
subscribe and we'll pass through
the draw clock better so this one only
happened once obviously because thats
that's the only time that action is ever
fire I have then a couple of other
observables that I'm doing so I'm
observing while there is states so while
there isn't a previous and there is a
current time then we'll update the clock
with the current time so while there is
previous and there is current time we'll
update the clock and then I just wanted
to use an example of you could chain
multiple filters together so if you had
multiple things that you could be
conditionals as to why you would be
interested in state changes happening
here ok we're filtering as long as there
is previous a previous time and the
previous time minutes is not equal to
the current time minutes then i'm going
to use map so unpack that state object
even further and then we're going to
update the clock so redraw the minute
hands um I just realize that those two
are basically the same so I'm actually
updating the clock twice hmm well moving
on and then at the bottom I have a
button to stop and start the clock which
just clears intervals and things like
that because i'm using a set interval to
do the continuous running so that's an
illustration of using observable streams
to then combine that with a redux store
to make an observable you I
okay so step back forward through my
slides all right now we've kind of seen
how this all works with inside of
JavaScript I really wanted to challenge
myself when I was putting together the
idea of this talk about how could we use
Redux even further than just kind of
JavaScript view eyes and either that
console application versus a
browser-based application so I thought
well what if we wanted to try and using
Redux without even using javascript so I
set myself a challenge to implement
Redux in f-sharp why because I just felt
like writing something even more complex
than just a sharp implementation also it
turns out that someone had already
written a c-sharp implementation of
redux and if you're in my talk esa
morning about bad ideas you would say
that just because someone's done it
doesn't mean you shouldn't do it anyway
so that's what i did i have written an
implementation of redux in f-sharp and
also this gives me a chance to talk
about F sharp and I just like doing that
and sorry to anyone that doesn't like f
sharp but you're going to like sit
through at least a couple minutes of of
that so let's open open up this file and
we'll marvel in the joys of angle
brackets and no semicolons and type
inference so we have a couple of types
of those are fine and generics in
f-sharp fun and interesting and give you
all sorts of pain but the important
thing here is we have a store which has
state and payload as generic arguments
now this is where start getting
interesting to think about Redux on a
compiled language so it could be soo
sharper could be F sharp it could be any
other it could be typescript even I
compiled to language for JavaScript or a
so a non browser-based compile compile
language because the Redux action has to
have some kind of a type when we do that
in Java with the type property well this
is an actual type system that makes
things even easier doesn't it now that's
one less property we have to worry about
advantages of type systems right there
now as we have get state we have
dispatch
and we have a subscribe method and
apologies to anyone that is either not
familiar enough with sharp I'm going to
not particularly dive into the syntax
here I'll try and cover all things that
are relevant to understanding what's
happening but you know there is
obviously a lot of arrows and things
like that in weird locations that might
not be familiar if you're not not an
f-sharp user we have a method that
builds up our middleware and builds up
that thing where we dispatch and then
execute the mill we're in sequence to
finally dispatch an action but the
create store is the really important
thing that we have at the end of the day
now remember our JavaScript
implementation that if we have
middleware we then need to re-execute
create store but without the middleware
and then we do some stuff to it after
the fact well to do that in f-sharp we
need to create a recursive function so
in f-sharp we have a record that tells
it this function is going to be
recursive that so the compiler
understands as a recursive function and
can do some optimizations we then have a
function that takes a reducer it has
some initial state passed to it and then
we have a sequence of middle where's the
pass to it I've just because this is
about 100 characters of type definition
i created a type on line 12 represent
that but it's a sequence of middleware
functions that would be executed now if
we have been provided with samil where
then they're even so the first thing we
do is got like a switch sort of
statement and match them in f-sharp if
we receive middleware so if we don't
receive middleware then we call create
store with the initial state and no wait
no sorry that's if there is no way so it
is empty is false so if there is
middleware we then reacts acute creates
doable without the middle where we then
grabbed a dispatch method we then build
up our middleware chain and so on and so
forth and then we return the store at
the bottom if there wasn't new web
provided we get the initial statement
you know so this is mutable because
state can only be changed with inside of
with inside of the state so with inside
of the store and in f-sharp everything
is immutable by default so we have to
explicitly make this mutable which is
it's kind of a really good way to think
about mutability and immutability inside
of a redux or is you kind of have to be
forced into choosing what you can and
can't change we have our subscriptions
which is a mutable collection because
you can add and remove subscriptions we
have a dispatch function which will
invoke the reducer take state with the
state in the action and then update the
existing state now we have our
subscribers that will then iterate over
and execute and then we return the
action just that's how Redux works
internally we have subscribers which
subscribe methods and then we return a
store at the end of the day so how would
we use this in a server-side application
while I was trying to think of it it was
all kind of well and good to write an
implementation of Redux that it should
theoretically work and write an in
f-sharp but what was I going to do with
it it lives on a server at the point of
Redux is that it said it's for doing a
stateful application I'm a web developer
so the idea of a stateful application in
net that's living on the server well
that is not there you don't do that with
the web the web it is stateless so how
would you do this well WebSockets I
decided to go with WebSockets and what
do you do with WebSockets you create a
chat application because it's the most
useful thing that you can do with a
WebSocket server so I correct out
signaler when I so I have a signal our
servers of running in the browser oh so
simmilar server running on the server
signal our clients running in the
browser that will connect when they're
connected they subscribe to changes
they're going to happen with inside of
the store so state entirely lives on the
server and every time a dispatch action
happens we will then notify the
subscribe so actually pushed something
down via the web sockets and this is
where we can start seeing the advantage
of a type system with redux I have the
payload which is the action that's being
dispatched I know
need to have a type I can just have a
payload and then based off of the type
that it is is it someone typing is that
a new user has joined the chat system
has the user posted message so you
typing so Johnny's typing a user is
joined John has joined chat post message
someone has hit enter to actually send a
message over the chat system so that
then would come in to the way that we're
using redux and this should hopefully be
started making me starting to sound like
a broken record we have a reducer it
receives state and actions and all those
sorts of things here we but instead of
having to do if action type we can use a
match segment which if it's a message if
it's a new user if it's a typing action
that's been dispatched we do different
things we create new state based off of
the existing state and change the parts
of it that that particular action should
change so when a new user online 26 when
a new user joins we take the existing
state of the application but we update
the users by adding the user who is just
joined I've also got an example of how
middleware works so when a new user has
joined it will just do a comfortable
right line essentially if it's a non if
the action that was dispatched is not
new user then we just perform a no-op we
create our store and then that should
all be up and up and running so let's
run this and hit f5 let's hit f5 again
come on demos we just check my solution
Explorer and I have the wrong project
set as the startup project let's change
that yeah five and we'll start up our
signal our server now remember that
state entirely lives on the server the
browser's are just essentially taking
messages that are being sent to them and
displaying them or they're going to
display them in a UI so we're coming to
our browser and we are level host 8008
8888
and I will join the chat and then let's
duplicate this tab and John conjoin and
let's just pop these side by side so we
can see a bit of font size so hello John
then and we can send messages back and
forth and John can type something now
this is entirely living on the server so
if I was to reload this tab and this can
be genes we get the existing state of
the application because state is not
inside the browser the state is
elsewhere this also then opens up for
some really interesting quirks of it if
Aaron if someone joins again as Aaron
let's just pop that one down here and
we'll start typing in there saying hey
guys and single shared state you'll see
that both errands and now fighting and
we send the message and now we've
updated state but everyone sees the same
thing but Oh shared state something to
be mindful of though if you're doing
this inside of an application now
obviously this is this is a fairly
trivial example and a fairly silly
example of what you might be using a
server-side implementation or a dotnet
implementation of redux but a more
realistic scenario for this would be a
mobile application mobile applications
are soon we use it generally speaking
they're going to have some kind of data
that lose with inside of them you're
going to have actions that happen when
you interact with those that you need to
change data with inside of that
applications send it around maybe update
different parts of the UI and econ
application is a good example you click
Add to Cart we need to update the card
in the at the top of the application we
need to change the amount of the amount
with inside of our card costing you all
those kinds of things so that's this
where it get back to talking about it's
really it's events we're triggering
event with inside of our system so that
that could be a non JavaScript usage of
rid us and this is why
I just how i came across that there was
a c-sharp implementation of redux so
like I said I'm well aware that I'm the
only thing standing between everyone in
the after party so hopefully your minds
are blown with the possibilities of how
you can use redux and not just have to
use it with inside of a react codebase
you don't even have to use it with
inside of a browser you don't even have
to use it with inside of a JavaScript
application is it's a very simple
pattern it's really just an inventing
system events or kind of system
underneath that it can be very quickly
written in whatever programming language
for whatever application architecture
that you're working with in whatever
application target platform you're
working with a biet web via desktop via
console via mobile thank you any any
questions if not I believe there is a
party happening outside or if not we are
going to go start a party happening
outside I obviously be around as well if
you want to ask me questions or say why
would you do any of this in f-sharp I'm
more than happy to answer those
questions thanks everyone</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>