<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What To Expect When You Are Elixiring - Johnny Winn | Coder Coacher - Coaching Coders</title><meta content="What To Expect When You Are Elixiring - Johnny Winn - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What To Expect When You Are Elixiring - Johnny Winn</b></h2><h5 class="post__date">2017-07-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/KrAnFSKNBSI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">testing testing insisting on okay are we
ready to do this alright so this is an
intro talk to a lick sir
how many people have used the lecture
before good how many people have heard
of elixir before how many people were
looking for the you know coffee shop and
they thought it was back here just kind
of stubble did okay alright and so I am
Johnny Lynn most most commonly known as
Johnny rudder gets confusing the people
they think my last name is Rutger but
it's not that comes from playing rugby I
did it for a number of years until I
retired
well rugby in retirement if you've ever
played rugby basically means my life
told me to stop playing so every once in
a while I'd go out there and I run
around and let's just say I'm getting a
little old
so I host a podcast called elixir
fountain have anybody heard of it listen
to it enjoy it love it okay one nice
okay well I would say everybody go out
there and check it out it's on
soundcloud you can also get it on
whatever favourite app you have for
podcast it's available there's an RSS
feed currently I work at Ambala Power
Networks I really enjoy what I do
we're actually building virtual power
plants to manage renewable resources
it's a very complex thing to handle
there's a lot of ins and outs and
actually I'll probably talk quite a bit
more about that tomorrow if you come to
the talk on peyote basically these
systems are large you know they're
distributed systems that have to
calculate cost and try to find the most
effective way to use these resources to
handle grid problems now as far as the
licks er goes I've been using elixir for
just over four years now yes I'm one of
the few people that started way a long
time ago I know last year I believe it
was at NDC Oslo the my elixir status
hashtag was like the second top hashtag
or something like that from people
coming from here so I remember seeing a
post on it I actually started that
several years ago as a way to help kind
of bring everybody together because
don't lick sir a great language for
doing distributed programming but it's
also was very distributed network
everybody was scattered around we were
all kind of like all over the place it
kind of sometimes felt like there was
five of us all chatting and the elixir
fountain started as a newsletter to try
to drum up kind of interested in elixir
and so it was really hard to find
articles back in that day if you googled
elixir chances are you were going to
either find elixir strings if anybody
plays guitar there's a literal strings
that came up all the time there's also
and of course if you google ruby elixir
there's a club in tampa florida called
Rudy's elixir that came up all the time
so didn't say it's been hours trying to
find articles and searching for the few
things that were out there and so what I
did is I came up with the hashtag my
elixir status if you're doing something
in a lecture or if you want to find help
with something you can tweet something
with my elixir status and people will
follow it I tend to retweet those quite
a bit from the elixir fountain twitter
account so if you're out there if you're
learning elixir that's a great place to
start you can find tons of articles and
things like that there's also several
newsletters out there including one from
plataforma tech looks at radar and
there's a looks or weekly these are all
great sources for learning now before we
get too far into this I have a little
disclaimer I'm not a big fan of intro to
language X talks mainly because they're
kind of very specific and I came up with
this idea for this talk called what to
expect when you're lecturing based on
the idea that how many people have kids
how many people have one kid two three
four five six seven I've been there once
or twice
but one thing that I notice oh sorry my
feeds Thunder for a second again one
thing I noticed it's there's kind of a
bit of a parallel between when you're
going to have a kid and when you're
learning a new language by no means are
you creating life but you're learning
something new and everything else out
there is very generic it's like well you
know if you know trimester one expect
this trimester to expect that oh they
don't bother to tell you that once they
turn 18 that's a whole nother ballgame
by the way I had two twenty year olds so
you know it's like everything is so
generalized that you don't really get
much out of it like maybe you kind of
spark a little interest maybe you kind
of pick up something here there but now
there's a funny story I've got for this
is that so my daughter who's 10 now so
this is 10 years ago you know of course
my wife has read several the books and
all that kind of stuff and I've read a
few of them myself when she was born we
decided to do a home birth how many
people have had home birth on purpose
not on accident so as we're going
through this whole thing and I feel at
this point now I had several children
that I kind of know my responsibilities
I know what I'm supposed to do well then
my wife decides we're going to a home
birth and so there's a whole nother
ballgame we're going to a midwife we
have a doula and all sorts of things
like that
but I'm still feeling pretty confident
in what I know the day my daughter was
born so that evening the night before my
wife was starting to not feel so good
but she wasn't sure what was so maybe I
just need to sleep maybe I need to rest
where I was it's fine she wakes me up at
seven o'clock in the morning and she's
like I've been up all night and I think
I've been having contractions and I
haven't been you know going so well I
think they're pretty close I so well how
close are they sick well about you know
every 10 minutes or so or something like
that I was well how long has that been
going on the past couple hours did you
call the Midwife no I didn't want to bug
her it's the middle of the night so I
was like let's call the midwife so we
called the Midwife this is my wife on
the phone
uh-huh okay all right
oh yeah I'll let you talk to him she
hands me the Sun any way I could get
some Sun she is having that baby any
second now you better get ready because
you're going to be getting that baby I'm
trying to get there as fast as I can but
I don't know if I'm will be preparing
time all of a sudden all that
introductory knowledge that I had went
out the door now I am getting ready to
birth a baby which I have never done
before and actually I didn't end up
having to do it that time either luckily
the Midwife showed up at door but in any
case so that brings me to win I came to
sit down to write this talk now the
conference organizer is going to love me
cuz I don't actually have any slides I
wrote the entire talk using a lick shirt
basically I have one application that
runs in the background on one node and I
have another application that runs in
the foreground and another node it's
actually what's going to be displaying
things and talking to you the one in the
background is actually going to be doing
all the work and we're going to do some
kind of cool things because honestly I
can show you and I will some of the
basics will cover the basics just so
everybody gets an idea but I want to
show you some of the cooler features
some of the features that I enjoy and
really I'll kind of go into more depth
on them tomorrow if you come to the talk
but this is actually kind of a good
little quick view of them so let's tell
Victoria that it's time okay what is it
like sure
essentially elixir is a dynamic
functional language by the way most of
these like basic slides I stole from the
getting started site the getting started
site it's a great site great material
it's easy to follow it's easy to get
through them but it's basically it's a
dynamic functional language built on the
Erlang virtual machine you get to take
advantage of all the power the Erlang
has without necessarily having to write
early how many people had to write early
how many people enjoy writing our lane
thank you too we're like the few out
there most people are like I can't stay
in the syntax but it's it's not that bad
I don't mind it and I'm you know I kind
of decide with the Jo arms throwing idea
where it's a syntax really doesn't
matter if you enjoy it you enjoy it if
not you know it's not that big of a deal
so but like I said elixir is great for
scalability fault tolerance which we're
going to see some of that stuff really
cool features that the language has
built into it because it was written on
beam now basic types and curiosities I
love that voice because it's like just
so monotone because of my basic types
hey guess what guys
elixir has types like every other
language out there so yeah so we have
integers of course we have binaries now
one kind of little thing to note is that
everything you can actually compare one
type to another type of if you see on
there everything has its place numbers
being the smallest we go all the way up
to bit strings but you can actually
compare one value against another even
though they're different types and see
which one is greater now Adams is one of
those tricky bits that we want to talk
about because they are not garbage
collected now if anybody's used other
languages that have symbols things like
that the name is actually the value of
the atom and those aren't garbage
collected those are written in local
histories it stays there they never go
away this is one of the things that you
want to keep in mind because you only
have 1 million 48
and 576 of those now you can configure
that and of course that includes all the
atoms that the system Oni has so you
don't want to let users generate atoms
because you can do that now one of the
things that you can do when you're
trying to protect yourself from things
like that if you'll notice in my example
code is we have the atom atom and we can
say to existing atom which means it's
going to reuse the atom to there if we
try to use the two existing atom on and
create an atom based on a binary that
doesn't exist it's actually going to
throw us an error and say no that
doesn't they're you know they're not
because you can do string to atom but
that goes back to that you're generating
atoms and if you're doing that
dynamically based on user input
somebody could pound your system now of
course you're going to run out of the
number of atoms before you run out of
the number much memory but if you're in
there tweaking your configuration to
where you're bumping that up you could
run into problems lists lists are
another thing and how many people have
done functional programming before nice
ok so you're familiar with lists we
won't cover it too much this is
basically what a list is it's a list of
lists going all the way down but you can
do things like grab the head you can do
pattern matching on that to grab the
first element in a list it's really easy
to get through anonymous functions ah
now we're getting to the good stuff
anonymous functions so now functions in
functions and Elektra and Erlang are
identified by the name in the era T so
there's a couple of cool things that we
can do with this now yes we can create
anonymous functions you can actually
pass them around you can set them to you
can match them the variables or bind
them to variables and then pass those
and as arguments to be executed later
but one of the cool things there's also
a syntax on I don't know if you're
familiar with it if you do know elixir
is the the shorthand for anonymous
functions where you just use the
ampersand then you actually give the
number argument that you're passing in
so the first if you passing in one a
narrative one you can be able to send
one and I'll give you that value and
then of course you can execute it by
calling dot friends passing the pram
as far as the actual arity goes we can
do one of the things that we can do is
as we're actually looping over we can
pass in an ampersand the name / the
arity and that actually passes that
function in so you can pass like if your
mapping over something you could
actually iterate over and it'll call
that function for you over and over
again I that's pretty common as in the
early and we use it a lot and you'll
probably see it some and some of this
code GREEN think Kundun modules now
modules this is one of the things about
functions that's kind of odd is that you
know anonymous function you can use
anywhere if you open up ie X you can
create an anonymous function execute it
no problem a named function on the other
hand has to be grouped in modules now
one of the first things if you come from
an object-oriented language background
or object oriented which you see modules
you think class it's not a class it's
just a grouping of similar functions
with similar functionality or purpose
now we can create one here's a simple
one where we just create a map one of
the things that we're doing this in this
module that we've created is we have two
functions zero question mark where one
we've actually set 0 and so if it's 0
the value is 0 it's going to be true
because we're asking if it's 0 if it's
anything else and that's an integer it's
going to be false so we're doing some
pattern matching there on our actual
arity to say if a 0 gets passed in we
know always what it is so we can kind of
get around using some conditionals like
if although ifs are there they do use
them I try to not but now let's take a
break everybody ready come on oh let's
go you guys look so this is a fun
conference right everybody's having a
good time right yes we're having a good
time so I gave a talk in Sweden last
week and it's funny because the same
thing everybody just going mm-hmm and
you come on interactive but feel free to
ask questions too I don't mind I
actually had this whole thing time to
where Victoria would actually push me
to keep going through because I don't
know if you noticed this but I tend to
talk a lot so I had heard kind of goat I
was like oh this is never going to work
because I'm going to be off time all the
time I'm gonna be constantly having her
go back and stuff like that so let's
take a little bit of a break and we're
going to actually look at some code
because we're going to need this later
everybody can see this all right right
the beloved for the notches here so what
we're going to actually do is I have
this class or this module called
sequencer and we're going to actually
determine a sequence of Fibonacci
numbers based on the link that we pass
in now I'll also want to introduce you
to execute it which X units basically
the testing framework so we can actually
write our tests we can execute our tests
and of course I've got them up coming
out because as you notice if there's one
fun thing about our Fibonacci function
right now guess what it always passes
because we've hard-coded values come on
interactive yeah so we kind of want to
get this to pass but before I do that I
want to make a note of something on line
three the dot test one of the things
that we do is we actually have doc tests
so if you'll notice in the actual sweet
winter there's on line 9
we're actually executing the code well
the doc tests will actually execute that
code so if at any point in time the code
changes and that is not true we will
actually get an error so we know that
our documentation needs to be updated
and or we broke something in the code
it's kind of handy that makes sure your
Doc's are always right because everybody
loves writing Docs right Yes No
so let's run this real quick just so
that everybody knows that I and running
it we run it with mix tests now mixes a
tool kit that basically does a lot of
this stuff when we create projects we
run our code we have mixed tasks that
actually can be written you can do
custom tasks when you're actually trying
to do some things there's a lot of
custom tasks when you look at libraries
like ecto and things like that where
they're actually doing like your
migrations or you
running other processes you want to kind
of run outside the scope of your
application new test is one that you
will use often Hey look our test pass
let's ship it right let's do this
well add one more test now so we're just
going to basically assert that we have
what we think we should have when we
pass length of six so that means we want
six numbers oh so it's funny and I don't
know how many of you are Emacs or space
Mac's users it doesn't lead the way but
yes everything on the screen is big but
if you look at the very bottom that's
what I'm trying to leave and the very
bottom is actually where it tells me
what I not I actually wrote the file um
so anyway so no I did not write at that
time this Oh see it's broken
well I'll begin to call it two in the
morning so let's go fix this now one of
the things that we did was or I did with
this function was actually underscored
in front of the parameter meaning that I
don't really care about this value if on
one hand I took this out and try to run
this I would actually get a thing saying
unused parameter hey you did something
wrong so if you have our passing in
parameters and you don't care about them
you want to ignore them you just
underscore them and then it sends - then
it doesn't worry about them at all this
is also true in pattern matching so say
you're trying to get the head and you
don't really care about the end of the
list you can just do head pipe symbol
underscore and then it'll match and then
it'll put the head and head and
everything else will just be ignored so
now let's see him now we need to want to
pass our legs and we're going to start
this by giving it an empty list to fill
so when we do this now let's run it just
to make sure we should have a passing
test
and actually because I'm so handy for
y'all there we can get them all pathing
yay let's kind of evaluate this a little
bit so we have a module that we've now
added our primary function which is the
Fibonacci where we pass in a link that's
going to be actually our public API for
this module it's going to let us
everything else is private we have two
types of named functions we have def def
two and def p2 remember I said name and
arity so our private functions can't be
called from outside this module or
outside the context of this module but
our public ones can be so in our case
what we actually did is we call the
function calculate with passing links
with an industry the first time is there
we know what it's going to be it's going
to be zero so we put this there zero in
and then we actually kind of have an
accumulator that's kind of building that
list for us remember I said that you can
underscore if we don't care about the
end of the list we'll see our pattern
matching on line 23 what I did was I
wanted the first two values and then I
don't care about anything else so I can
set those to a and B and I can kind of
move forward from there and then I can
add them on and add them to the list and
then we just iterate over it of course
at the end our list is reversed so we
need to go ahead and reverse it so that
we have the list looking the way we want
it to look never mind what's on 29 we'll
get to that later everything else you
can pay attention to so that is a trip
through some modules and a look at some
testing what's next
graduating processes process is what
everybody loves right so one of the
things that you have to get used to
really quick and elixir is dealing with
supervision trees and gem servers and
our supervisors this entire application
is dependent on understanding how those
work now we can create a basic gem
server and in fact our mailbox for our
session app the session applets in the
front all it is is a gem server that's
see she gets impatience you just move on
to the next thing so the way we do that
is we use gems server and then we
actually have a start link which we can
connect using the supervisor which we'll
see in a second and then we call Jim
server dot start link we give it the
module that it's in we can pass in
anything that we want to start up and
then we can use either a name and in
this case we're using the module which
it the name can be any atom and actually
had them listed out they can be an atom
which module names or atoms it can be
the global term if you want to do like a
register globally you can also use the
via via tuple which the via tuple is
actually really convenient and if you
use G proc which allows you to globally
register processes you can actually use
the name G proc is built on pets which
is the short term and memory storage and
it'll actually record the name of it
matched up with the pig so if the pit
dies if your process dies and has to
restart it still still uses the name you
can get the NIT you can still get the
process on new process whichever one it
goes through those are a little bit out
of scope of the beginner track we'll get
to those waiting another advanced one
callbacks now there's actually six
callbacks that are important that you
actually have to implement but when you
use Jen server the nice thing is those
are already kind of taken care of for
you you don't have to worry about it the
main ones that focus on are the handle
call handle cast and handle info the I
use
these all the time you kind of have to
handle call is actually when you want to
do your synchronous calls so if you're
actually wanting data back if you don't
care about it you just want to push
something to a process and let it deal
with it you can use cast if you want to
send a generic message to it you can use
handle info now that being said you can
send any message you want to a process
if the process doesn't know how to
handle it you're going to get an error
that it's got a message that it doesn't
know how to deal with so what you end up
having to do is you end up doing a
catch-all to say hey if I get this and I
don't know what to do with it
just they can order move on or if you
want to say hey you should have been
sending me that why'd you send that you
can do that as well
this is actually really handy when using
something like Jen event because Jen
event is basically a gym server you can
implement events on your own and gyms
are and Jen server but the idea is
you're going to be passing messages and
you want to make sure that you deal with
if you pass a message that you don't
know how to deal with you want to know
what to do now that might be just
ignoring it all together which I do a
lot of times because if you don't know
what to do with it why bother you don't
necessarily know where to send it so our
supervisors now of course as you would
imagine a supervisor is pretty critical
for a supervision tree but you actually
add Jen servers and you can add events
and things like that to as workers to
your supervisors to kind of build out a
supervision tree and in our case one of
the things that we're going to see a
little bit of is we have a supervisor
that not only monitors processes but it
also monitors other super another
supervisor which monitors other
processes so you tend to get this tree
structure built out one of the things
that I'll show you is a handy tool
that's provided by the beam called
observer so you can actually see all
your processes and see which ones are
there comes in real handy when you get
those straight processes that aren't
dying and you don't know why and you see
that they're all there and you're like
maybe I did something wrong I'd forget
the killer process so but here's a quick
look because what we're going to look at
today there's another way to do
Supervisors you can actually do a
supervisor spec if you create a new
project with a supervisor it'll be in
application and you'll see supervisor
dot spec that's a different way but what
we're going to be most
looking at most today is going to be the
module inversion where we actually use
supervisor we have a start link it
basically follows the same patterns as
gym server where you have a name you can
name it the module or you can name it
the atom same thing you provide the
children which in our case we have this
background calculator for our sequencer
I told you it's going to get good trust
me now one thing to note on here is the
restart for this so you have different
types of restarts when you're when
you're supervising these workers you can
do permanent which means that the
process dies always restarts you can do
temporary or in our case you can do
transient what transient means is that
we don't necessarily want to start a
process we only want to start a process
when we're actually trying to calculate
something so we're going to actually
tell it to calculate it's going to spin
up a new process that will handle the
calculation and then when it's done
it'll die and I'll go away and drop out
of the tree why is that handy well when
you think about the cases where you have
these long-running calculations that you
don't necessarily want to bottleneck the
app you can spin up a process send it
somewhere and start letting it do its
work and then when the next request
comes in you spin up another one and
have it execute a different calculation
maybe with different parameters so
message passing in state ah date so I
want to quote Joe Armstrong here and say
that early is the only true
object-oriented linguist week and it's
all about message passing so these
processes actually manage their own
state you'll see when you use when you
create a gem server that it always every
one of your callbacks for like your
handle call handle passed everything
they always have state as the last last
argument sorry she gets so impatient she
just tries to rush me through this it's
actually good because it keeps me on
track a little bit so in our case right
here we're going to have the our gem
server itself when it starts up we're
going to initiate it with some state we
know that our first step is going to be
the intro you guys already had that
we've already had the first examples
and we're going to pause it there so
that it doesn't continue running through
the script and then of course we have
our handle info because these messages
are actually being sent in from from the
session why are the session on a
different node to say hey go do this
thing and then it will kind of run
through it if you notice we have our
send dock at the end of our call back we
have to do no reply because like I said
info is just an inbound message so we
have to tell it
you're not replying to anything and
you're passing back the state now in the
case we do a call we would actually have
a reply what we want to give back and in
the state in a cast we also do the no
reply and then passing state now in our
case we want to use our state is
actually a map which it tells us what
the current step is and the next step is
and whether or not it's paused so we
want to update that state at the end of
this handle info to say hey we have a
new state processes are the only one
that can actually update their state you
cannot update the state of a process
from outside you have to call in to it
to make changes to it so in some weird
way it's kind of like a class but it's
not it's not but it is kind of funny did
like you know it's all about state when
it comes to processes now there's three
ways to call into it or three ways to
send a message to a process that we want
to look at one of them being send which
sends a message to a process that's the
one that's going to hit your handle info
the send after will also hit your handle
info but it allows you to send it at a
later time so say you know you're
executing something and you know at some
point you're going to want to send a
message to a different process or back
to yourself you can give it a time frame
so some some of these like if you're
doing a timer every five seconds or so
you want to send a message you could
actually give it the five-second
five-second time frame and then it will
send it at that time zones now the other
thing is the directly call gen server
dot called dense overcast and pass in
the correct area T and then they'll
receive those messages but
have to have your callbacks for those
now let's look at I told you we're going
to do something kind of cool with this
sequencer so let's look at that
okay good on that that's good okay so
our background calculator because your
keep in mind you know doing a sequence
of ten numbers and for the knot she
doesn't take that long doing a hundred
thousand can take a little while so if
we wanted to do that multiple times or
several times over we don't necessarily
want the same machine doing it maybe we
want to kind of distribute that so one
of the things that we're going to do
here today is we're going to actually
create this gen server now the first
thing that I wanted to talk about with
this gen server is everything that we
mentioned it's gem server we do call
start link it's a module and then we're
going to actually pass in the code we'll
get to that in a minute but we're
actually setting the initial state of
this as being code which is going to be
kind of cool we'll get to in a second
and then on the initiative are a knit
we're going to take that code and we're
going to set it to state and we're going
to call we're gonna send a message to
ourselves to load that code that's our
handle info we're load and it's going to
receive the state it's going to do some
stuff that we'll talk about in a second
and then when calculate is called we're
going to actually call calculate on it
we're going to pass in the link that we
want to do and it's going to run the
Fibonacci code and then it's going to
give us back a number it's going to
return that result there's that reply
result and then of course the Matar
module which is our code after it's done
we have that process send after because
of course if I on a call if I try to
kill the process remember we don't want
to keep these around we want them to go
away when they're done doing their
calculation if I try to call beforehand
we're not actually going to get a chance
to return your sticky back and we're not
going to actually finish that
synchronous call so what I do is I say
well just wait a second and then die off
is basically what I'm doing I call the
send a message to exit and then of
course the process exits exits with
normal status there was no reason to
have an error just dies now does anybody
have any questions on that code is
everybody following me
everybody good all right oh wow
y'all can all see that right here's our
supervisor for our supervisor all we're
actually doing is starting up the
supervisor and then we're adding on our
net we're actually adding the worker
which is going to be our back our
background calculator we pretty much
solved this code before so I won't spend
too much time on it and then we're going
to have our function called start
calculator which is going to take code
and it's actually going to go ahead and
start one of those child processes and
then we can go ahead and execute it so
that is I have no idea what to do with
oh shoot
alright give me a second because I
forgot something here real quick so see
this is what happens when you plan
thoughts and you try to do it and of
course then you get live coding and
something always goes wrong doesn't it
and let's see here I had commented this
out okay well so the problem with that
is is if I kill this Victoria you start
all over and who wants to see this talk
again right so let's do this let's do
system suspends
all right and then
let's see oh it's wanton code uh-huh
sorry I did that one so anyway so what
we just did we had a running process
that was running that was up there and
working and one of our developers I
don't know who it was commented out some
code that we actually needed didn't know
how to handle it now we didn't blow up
because we had that catch-all because
that message came in and didn't know
what to do with it and it just said hey
I don't know what to do with this but we
could also put some code in there to
where we said send some message send an
email hey something's not right whatever
we wanted to so what I actually ended up
doing is I suspended the service for a
second and recompile the code that's
what that C is that allows us to
recompile that file and then I resumed
it so it kind of unpause the service and
then I could actually continue on
without having to restart the process
all together now there's another way to
do hot swapping of code which I tend to
try to like everybody loves the idea of
hot swapping code it's like a really
cool thing to do the problem with it is
is there's a very particular way you
have to do it so when you have a
function if you want to be able to hot
swap code within say a process you have
to you have to do an absolute name so
you have to call like module dot
function and that's going to force it to
reload the code so you can actually have
two versions of the code running at the
same time you can have one old version
and the new version that you just pushed
out but until you actually force it to
reload the code it's not going to reload
the code it's just going to keep going
on now if you push another version out
it's going to get rid of the oldest
version and so you can actually drops
off the older versions you can only have
two as you can see it can get a little
complicated and unless you really need
to do it for some reason I would try to
avoid it but this is a cool little thing
that you can do did I fully all at all
no no no it didn't nice okay cool
all right let's see good loading on the
move node now remember I kept telling
you about this code loading stuff so
what we actually want to do is we want
to read the code in from that module and
we want to pass it over to another node
somewhere else could be some Google
cloud somewhere and execute that code
and get it
mom's bag so let's take a look at that
real quick so start with our sequencer
now get code so if you notice that this
is a funny Adam dot function well what
we're actually doing is we're calling
the Erlang code now the I guess but not
so little secret is that underneath
there are things in a liquor that still
are basically early calls and a lot of
at some point is in Erlang call you just
have to go down deeper than you used to
four years ago four years ago it was
pretty easy you'd open up a file there'd
be a function and boom it would be
calling into early but now what we're
going to do is we're actually going to
utilize a beam and our DP to say we're
going to get this code we're going to
give it the module that we want to get
so it's going to basically read itself
in and it's going to create what we have
over here our module the binary which is
the string value of the code and then
the file which the files you don't
actually need and I'm not sure if you've
been a long time earlier you might know
I mean I'm sure there's a good reason so
that you know but I mean I thought is if
you're passing it over to another node
it doesn't necessarily have access to
that file so really once you load it
into memory it's in memory now I would
assume that you could persist it to a
file if you really wanted to but the
idea is that we're going to actually
load this code up into memory and so
that is now the same code that we wrote
on one node we're going to send over to
another node and then that code is going
to be executed from that node and then
it's going to report back to the other
node hey I did a value for you so let's
see if this works
all right let's do something well that
only took 37 microseconds oh oh I know
what I did not have some code on the
session testing testing testing on okay
are we ready to do this
good loading on your remote node let's
try it this time
wow that only took 873 microseconds so
we just did about 100 well not only took
20 milliseconds okay this will wow that
only took 1793 so as you can see we're
now taking that code we're sending it
over and I'll show you the code itself
the other thing that we can do was just
kind of fun anybody can do it once right
let's do it ten times
wow that only took one step 746
milliseconds wow that only took 3202
milliseconds wow that only took five
days on your off side milliseconds wow
that only took 2007 take some of the
recycles let's stop her cuz she will
keep talking to thousands oh oh oh
that's right why because we have the
code running on another node and so I'd
have to actually crash the other node
no I'll just turn her down no recycling
Wow 1700 a neighbor was just talking
talking talking talking worse than I am
so anyway you can see we'll actually
look at the code while she's talking
about it all right so this is kind of
how it's controlling the whole thing I
was doing Jen server cast I had the my
messenger on the other node the I would
send the message over to the other node
I would send a start restart or whatever
pause my next is actually just a call to
start but our calculate sequence
basically we take a link and then we
have a default value of 1 so if I don't
pass an account it just does it one time
now
we're iterating over a range here that
we're using task now tasks and agent or
two other types of basically wrappers
around Jen server tasks are meant for
doing asynchronous things you just want
to fire something off and forget it
agents are used more for storing like if
you wanted to have like a data store or
something like that like a temporary
data store and you want to put values in
there so the tasks are really great if
you want to do asynchronous calls so
basically it's going to send out each
one it's just going to keep loop
throwing are looping through them until
they're done and then of course you see
our Jen server cast because this isn't
going to this does not want to wait for
a response
this just wants to send it over there
our messenger on the other node will
when it's done it'll send something back
to us to report back in but it's done
and give us those values and actually
let's see mailbox like this expose a
little bit of what was actually working
here is basically how I ran the whole
thing messages would come back from the
back are in the background and if a
message came in that I needed Victoria
to tell us they would just call say on
the command line and spit out the
message when those examples were run
now all that all those slides that you
saw basically I utilized wood elixir
already put in there for the for IO anti
anti helpers and so it basically grabs
the dock of the module dock reads it in
in the binary and sends it over and kind
of formats it for you so it looks all
nice and pretty you can use print header
print dock and stuff like that so this
entire talk was written using a lick sir
I did not use anything else and I did
not use any external libraries or
anything like that and when I first
started thinking about doing this talk I
was going to include things like echo
and Phoenix and things like that but
those are all things you can explore on
your own there's plenty of documentation
on them most of you are probably
familiar with MVC pattern saying that
this is a dotnet conference most of you
are probably familiar with link which
ecto is very similar to link syntax it's
not hard to pick up so let's see where
we're at because that's all I got so you
are on your own now oh great
all right so there we have it now this
was not your typical intro to elixir I
know I kind of covered some stuff that
you probably wouldn't get into in that
first trimester maybe not even the
second trimester but I hope that it was
an interesting look I hope that there
were some things that you could have
picked up on that kind of went beyond
the hey look here's here's binding
because you can figure that stuff out in
ten minutes why span up here and take up
your time talking about it so I want to
kind of show focus on some of the cool
features not to mention my talk tomorrow
I use a lot of this stuff in what coyote
does
so what coyote basically does and I'll
just kind of give you a preview is that
it's it's basically routing traffic
between nodes so when an application
comes up it registers with the leader
server the leader server can then pass
messages over to it to have all that
working so I'm using code loading I'm
using node connecting I'm watching the
nodes when they go down if you notice
like when I dropped one of these nodes
when it came back up she started over
she realized that something was going on
she tested the connection to make sure
it was there and then
on so but I'll get into more that
tomorrow what I want to do and I hope
that I've that I kind of help with that
is spark or curiosity when I first got
involved in the liquor the big thing was
I was curious and I think his developers
were intrinsically curious like we want
to know a little bit more we're not just
happy with what we're doing today we
kind of want to see what else is out
there now I did that net for a number of
years I was a c-sharp developer for 10
years prior to that I did Perl PHP and
various other languages along the way
but I kind of came around that curiosity
tetany moving from language to language
and it wasn't even those languages I
looked at that I didn't never I would
never use actually when I first found
Erlang living in Jacksonville Florida I
realized that there was no way I was
getting a job in Jacksonville Florida
using Erlang and this is at a time
before like a big remote like the big
remote push so I got into Ruby and I did
that for a while but functional language
is always kind of called to me and I
think that like I said developers as a
whole are curious people and so I want
to show you something that's going to
make you curious if I stand up here and
talk about the basics of elixir and kind
of what you can get on the getting
started guides it's not going to get you
to go up and so that's a good question
what kind of systems the impede just
goes might look what kind of systems is
this we could fit for honestly it's I
think it's working its way to a pretty
good general-purpose language like you
can do most things you can you can write
scripts and have them executed things
like that it's you know it's picking up
a lot of steam because of Phoenix
because of web development and things
like that but I treat Phoenix a little
bit different than most people I go by
the idea that Phoenix is not my
application it's a key to my
presentation layer it allows me to put
stuff on the web so I build these small
applications that I can then distribute
sometimes across multiple nodes
sometimes on the same one when there's
not you don't nest
thoroughly need to distribute everything
but like systems that I'm working on
currently we have large amounts of data
that need to be processed and so it is
kind of handy to spend something up and
push it over to another node but it's
also really fast on a single node if
you're building just a web application
or if you're building you know that
there's even like one of the things that
I had looked at doing a few years ago
was I guess with the electron the
desktop applications running licks or
backends on a desktop application and
using electron I kind of went down that
path and then backed out of it
Rob Connery actually who's important was
trying to convince me to do it as I yeah
it sounded fun but I'm not a huge
JavaScript fan so I don't under that I
shouldn't say I'm not a fan it's just
it's one of those things I write bad
JavaScript so I try to avoid it which is
like everybody here don't lie so I hope
that answer your question but I mean
it's pretty much I mean it is actually a
good fit for a lot of cases I mean it's
definitely working it's easy and fun to
use I don't know what languages are
using now but I mean it does have that
kind of Ruby feel to it the most funny
is I hear a lot of people like in the
Erlang community complain because of the
Ruby syntax you know but it's you know
teacher says you know if you want user
only user election that's fine I'm not
stupid
yeah pretty much I use it's the language
I use the most now I haven't I've been
pretty much 100 percent elixir for about
two years some Ruby sprinkled in there
but it's been a while since I've really
written any other I mean of course you
had like the Java scripts and stuff like
that and sequel and but for the most
part all right I guess any other quotes
pretty much what I got what you get
do I have an example of a system that I
couldn't build an elixir wouldn't up
atop my head no I think I haven't run
into a case where it wasn't necessarily
good said and if I could remember back
in the early days there were some things
that I noticed it like there was other
languages that were definitely faster at
doing it but there have been so many
improvements to the language and the
speed of the language in the last few
years that it's kind of getting a little
the lines are getting blurred between
what isn't a good fit and what isn't
or what isn't what isn't I think the big
concern right now is like how people are
building because we do have that influx
of people coming from object oriented
languages that kind of get caught up in
building things a certain way and this
is one of the problems that I kind of
solve for us all a few years ago is that
you come to come to the language and you
start implementing old habits and you're
basically just rewriting the old
language and I'm a firm believer of you
know
bring what you know into the new
language so that you have that kind of
to fall back on but respect the paradigm
of the languages you're working on and
try to figure out how it wants you to do
it because I think too many people try
to force the old paradigms of their old
languages on the new language and then
they're like hey this is broken it
doesn't work this is not anywhere near
as good and it's like using it right you
know so I think that that kind of comes
into play any other questions yeah
I'm actually going to just put the
project on github and then I'll you can
I'm in you are ug ger zero seven the
regular zero seven on github and I will
just push up this with the rain meet it
kind of walks through how to set it up
and how to walk through it I think
that's probably the best way to do it
and then that way you can look at the
code you can play with it you can fork
it and tear it up and you know criticize
it Oh everything is wrong so I think so
and actually there's in the states I
know that there's a few groups that are
starting out one there's if you're
familiar with the rails bridge project
there's like an elixir bridge project
that's starting up to try to bring
people in to women into code but there's
also I saw something about a program for
kids teaching kids elixir from the start
and functional languages from the start
to try to get you know people on board
with it and things like that it actually
I mean it is a really good language it's
easy to use it's you can get up and
running with it in five minutes and
start working in it you don't
necessarily have to traverse the the the
trials and tribulations of OTP right
away in fact a friend of mine that got
into a lick stirrer a couple years ago
actually mentioned that you know he
spent a year using a Luxor and never
used OTP like processes and gen servers
and things like that and then of course
once we started getting into it he it's
to each instant like you're going to
find the project that you do you can get
into it you can use it you can get into
pattern matching and binding and
understanding immutability and then work
into the OTP stuff because it's D the
OTP stuff is deed so anybody else
alright well thank you I'll have you
enjoyed it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>