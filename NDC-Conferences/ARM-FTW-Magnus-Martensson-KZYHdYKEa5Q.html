<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ARM FTW  Magnus Mårtensson | Coder Coacher - Coaching Coders</title><meta content="ARM FTW  Magnus Mårtensson - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>ARM FTW  Magnus Mårtensson</b></h2><h5 class="post__date">2017-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/KZYHdYKEa5Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alrighty now that we are all here let's
get going with this and that's have fun
with it so literally running your
applications in the cloud it's not
exactly the same anymore as when you did
not do cloud there are some things you
need to know there are some things you
need to do to do it well and I work see
consulting myself and I see a lot of
folks going the carefree way they just
deploy stuff to Azure and have fun with
it and you should have fun you should
that's good having fun if it is
essential and after a while it is a
forest of things in you don't know who
owns what anymore in the cloud or you
can start to figuring out some more
facts and details and getting the really
really good knowledge that you need to
run really good things in the cloud so I
want to begin by asking you how many of
you Hanson at one hand in the air or to
have a production deployment in Azure
that's about half assuming then the
other one other ones in room are kind of
interested in a sure but you haven't
gone through production just yet okay
all right cool this applies equally to
both because I've these basic skills the
way I see it a lot of folks don't
actually know how to use a sure well
even though they might have been a
natural for a long time and they're
doing good business on a sure they may
still be spending on maybe a little bit
too much on their bills and they kind of
between a chaos mode so that's what this
presentation is about my name is Magnus
martinson I am so happy to be here I
love getting on stage talking about
things that I'm passionate about I was
the first one to be an azure MVP in the
Nordic countries so I've been an actor
since day one and I love it really I'm
going to say good things about Asher and
Microsoft you know on this stage it said
I don't actually work for Microsoft it's
funny cuz and I have this title
microsoft regional director sounds like
I work for Microsoft that I don't work
for Microsoft I don't really have a
region and I don't direct anything but
the title is for it's a very
partnership with Microsoft so I use all
their stuff and I get on stage and talk
about it but I do run my own company
loftus off that's me my company and so
you know that's about me and I'm this
crazy user group person I love community
I love user group stuff so in case you
don't know what the global Azure boot
camp is it's happening again for the
fifth time on April 22nd all around the
world this crazy event is happening and
anyone any user group leader anyone can
throw an event and join this it's got to
be a couple of hundred locations around
the world on one specific day starts you
know in Australia time zones over here
and it ends in like Holland little and
all these user groups do an event on the
same day it's really good fun it's like
at least 10,000 attendees on this thing
and you know I would be a Miss if I
didn't actually mention that when I go
on stage I cannot have to it's my
passion and I love this stuff so this is
the reason we're here I'm not going to
linger on it but the big reason we are
here the big reason people are
interested in learning about what the
cloud is in a way that we can do it well
is that we have hits sort of the the
mainstream those two blocks in the
middle there that's where technology
goes into the eighty percent of the
market before that it's curious people
having fun early adopters and if the
technology is bad it's going to fall
into that little gap it's called the
chasm of doom that's where bad
technology goes to die but if it jumps
the chasm and gets into the mainstream
which asherz or the cloud certainly has
now then a lot of folks wanted so
there's going to be of course a big
uptake in people needing to learn how to
do a sure in a good way so Microsoft
have built this cloud platform and when
you look at this slide I'm sure some of
you have seen this slide before it's
kind of a canonical slide that Microsoft
used to show how much stuff we have a
little bit daunting
what do I do with this I don't even know
well lots of worry I mean you can very
easily go and deploy just a virtual
machine if that's what you need if that
what you want but you know still how do
I handle this when I look at that myself
is like okay what you need to do is
figure out how to do the fundamental
things you need to worry about who has
access to my resources how does that
work you need to think about how do i
deploy my environment in a good way and
make sure that I don't make any mistakes
and maybe automate that in some way and
once I do have lots of things running
out there in the clouds how do I know
what the status of my things are how is
it feeling and when something is wrong
if something goes wrong in the middle of
the night do I have some alerting in
place that can you know in a worst-case
call me up and say listen you got to
come into the office or turn on your
computer because something is horribly
horribly horribly wrong so alerting is
important and then a lot of folks I see
this as a big adoption blocker a lot of
folks are concerned with the fact that
they don't know how to split the bill
inside of their corporation maybe you
have different departments and
everybody's using a sure how do we know
how much a sure is spent by R&amp;amp;D or how
much a sure is spent by this production
environment or that how do we know this
well that's stuff that you can solve
with the stuff or the following pieces
you know in my in my talk and then now
that we are in the cloud the IT guys
it's a big change for IT they no longer
go and you know by hardware and put it
together and pull cables around they're
sort of part of the dev ops ii team this
world now we're making go on provision
stuff in the cloud but they still need
to maintain it and all of those
developers have learned cloud skills and
they're not showing up with applications
that are running in the cloud and we
have to maintain them in IT we still
need to know how to do that so this
falls into sort of the realm of of
configuration or your infrastructure and
your configuration ask
code and what does that mean well you
want to deploy the same resources
multiple times you want to deploy them
to multiple environments you want that
to be easy and automated and super comfy
and and so that you can have confidence
with what you're doing for these reasons
and i'm sure many more Microsoft's have
created the azure resource manager so
what is that well just quick
architectural sort of lay the groundwork
all of those resources you saw in that
big blue we'll all of these different
icons all of them have to implement a
contact they are resource providers to
Azure and it's not only Microsoft here
other companies as well offering
services in Azure such as bent grid such
as clearly be not Microsoft companies
but they're offering stuff in Azure as
resources for us to use are implementing
the same model implementing this
provider contract so that they can
become a provider of their service and
Azure and from the other end we're
coming towards this with all of the
tooling that is being built or has been
built and being improved all the time
for Azure and then you know there's an
API which is exposed by this provider
contract that's so that's how we do it
the Rivas manager helps us again then
deploy application resources in a very
fast and very you know standardized way
it helps us to organize her stuff so
that we know you know have the
conversation that database over there
who's databases that we deployed it is
costing us money but we don't know if
it's in use can we delete it is it
important who knows that conversation
and then also to be able to control
access to resources let's say that you
have consultants coming in and out maybe
you want to make sure that you can't
even make a mistake but you can't even
deploy to the production system by
accident oops i meant to deploy to dev
and I accidentally chose production
whoopsie-doopsie no that's that should
not be possible that should not be
possible to do and you can set it up in
such a way that that this is prevented
if you feel more comfortable and secure
in a sure resource management everything
starts with resource groups and they
really like empty buckets you create a
resource group and into it you will put
resources the fact that a resource group
has to have a location is
inconsequential you can have all the
resources in a resource group in
different regions around the world
Microsoft has nine 138 regions two in
the UK right i'll be using the UK south
region for my demos today and it's kind
of close by here but i might as well use
australia so you can put lots of
resources inside of your resource groups
and every resource has to be in a
resource group so it's kind of a bucket
right it's not a fence or anything you
can still communicate with everything
around you it's just an organizational
thing so in order to and this comes back
to that infrastructure as code
conversation in order to deploy your
things to Azure you've really should
look into using templates of course you
can go to the portal and say plus BM and
create yourself a virtual machine yes
you can do that but then if you want to
do that all the primer you need to do
that all the time after a while honestly
the portal you know pretty as it may be
starts to feel a little bit I need to do
this again so you really want to
automate a national resource management
is for templates so I have here mr.
studio code and this is not the simplest
most template because this is actually
like a null template this is an empty
template is it large enough you can see
no larger yep Thank You larger there we
go so as you can see these things that's
all that is in a template it's the
parameters for stuff that you send in
it's variables it's the list of
resources that you might want to deploy
your database if your virtual machines
whatever that is and then sometimes some
outputs that's it it's not more
complicated than this so the hello
template the know that one the hello
template this is the simplest most
templates that I could think of
it deploys one single resource so it
does nothing else except deploy one
reefer and that resource in this case is
as you can see it's a Microsoft storage
/ for storage accounts so it's an azure
storage account where you can upload
blob files and other things right it has
a name and has a location so you see i'm
using UK south here and i can go and
deployed it so why don't we do that so
over here and i have a little bit of
PowerShell then I'm going to execute to
deploy this the first thing I'm going to
do is create myself a resource group and
let's first go over to the azure portal
and see that I don't have anything I'm
focusing on the subscription where I'm
going to deploy to theirs it's empty
there's nothing here so if i go and
execute create myself a resource group
that should show up here there we go so
now i have an empty bucket into my empty
bucket i'm going to put my resources so
we'll open up and see yes it's a brand
new empty bucket i'm going to use this
low template file and as to begin with
and I'm gonna execute that I'm now
firing off a template which is doing
nothing it's essentially accepting my
template checking that it's valid and
then let's see what resources we deploy
oh no resources I guess we're done so
really that's that's a trivial mode
right but let's let's do this first
template thing instead I'll choose the
other template file and I'll fire it off
and it's now going out there to say
what's in my template yeah i'm going to
commission a sure to provision for you a
storage account and then I'm going to
come back and check in five seconds
actually I don't know how long this is
going to take I've had varying times
usually it's like five seconds 10
seconds 20 seconds but as for some
reasons sometimes yeah this looks like
it's taking long I've seen this tick for
for a long time currently maybe it's
just the UK data center it's done I
don't know but if I go back here and I'm
refresh this I now have a storage
account
okay and so what happens if i go and
reacts acute this thing again what do
you think happens when i do that i'm
running it again now what happens
nothing correct nothing happens because
it's checking to see that that Forge
account is there if I had changed
anything inside of my inside of my
deployment here inside of my template it
would have changed things to be the way
I want it to be so I could go and say
well honestly I don't want that in UK
south I want to have that in rural
intelligent loading interesting huh okay
and having to know we have what do we
have West Europe this is actually a
valid name as well if I go and change my
template to say West Europe and and
execute this thing again and that's
actually going to work and what exactly
what's going to happen is it's going to
move this thing over to West Europe
which is a little bit crazy it's not
actually moving it it's probably been
deleting it and putting it somewhere
else but we'll leave that aside that's
so that's what happens you can redeploy
your template however many times you
want templates are as you can see
declarative use you declare quite
clearly this is what I have be for my
resources and this is the shape of them
I want to expose this endpoint for this
IP address is what I want you know
things like that you'll put everything
in there to declare very clearly what
your your environment is and as we just
saw this is idempotent if I execute it
again I'll get the same result now
honestly nothing could be easier here
you can just go and deploy multiple
services I just did one storage account
just to show you the basics I've seen
templates with you know 15 more
different resources and you just deploy
them like that and and anywhere in the
world and it's very stable right always
works basically and of course as you can
imagine this type thing you saw there
for a storage account that's extensible
to the end of days I mean they can add
whatever services they want to add
and it's going to extend and it's going
to be great so literally there again you
deploy and manage and monitor your
resources as a group right and you can
repeatedly deploy your solution over and
over and over again and that means that
you manage your infrastructure as
templates not strips anymore I don't
mind scripts you know PowerShell skills
are amazing IT guys that are proficient
with PowerShell they're like many gods
they can do all kinds of crazy things
with PowerShell but this is more
declarative this is a little bit more
clear and easy and in that sense more
shareable inside of your organization
right that's important too so let's have
a quiz or let's see if any one of you
can answer this question clearly these
resources we have a web application
there and that's a virtual machine with
the database maybe we're running oracle
or something so it's in a virtual
machine and then it's a storage account
and they make up one application should
i deploy them to one resource group or
should i maybe create separate resource
groups for Maya Maya different pieces
you know the answer to the question is
if they have a common life cycle and
management right that's when you
probably put them in the same resource
group if they don't then you might
consider putting them in separate
resource groups so maybe if you decide
that you need to remove that web
application for some reason maybe you
have another thing coming and you want
to remove the web application odds are
pretty good that you might still want to
keep your database with the data and
maybe the storage account with some
files and stuff you've uploaded probably
won't want to delete those so it sounds
like a lot like maybe the web
application should be in one resource
group and possibly the other two in one
resource group you know what at the end
of the day it comes back to that dreaded
it depends it's up to you you can do
whatever you like so long as you
understand that you can do either and it
really doesn't matter you can do it each
you both
with all of them in one or in separate
research groups it's absolutely fine so
when you deploy stuff when you work with
your projects how many environments do
you have surely you have development and
production and maybe even more than one
production environment right you have
testing probably some testing
environments seems likely now I don't
again I don't actually work for
Microsoft so I don't care if you use a
sure for production you can go wherever
you like with your production
environments where ever you need to be
but if you don't use a sure or the cloud
for development and testing and I'm
going to go out on the limb here and say
I think you're kind of doing something
wrong because nothing could be easier
than using the cloud platforms for
development and testing you can just
spin up any develop any testing
environment you want just for a few
hours and do some testing and then
delete them again and they're gone you
can do fancy stuff such as may be eating
removing your development deployment
over the weekend or over the holidays
when nobody is using them it's too easy
to use the cloud for development and
testing not to do it and there's no
possible way that anyone can come up
with a pricing model that's going to
beat that just super simple so
definitely use the cloud for testing and
and and for the for the development
maybe then also use it for production
and and maybe you have a staging
environment for that so you have
multiple environments does that mean
that I need one template for each amount
of my environments then gosh that sounds
like a lot no it does not mean that
here's that here's actually a really
cool you know consequence of the fact
that you use one template for all your
environments and then you create what's
called a parameter file for each of your
environment and parameterize your
template so you know you can fire off
the exact same template that you use for
your production environment you can just
change the parameters and create
yourself an identical copy of that
and then when you're testing stuff when
you're deploying to your test
environment testing stuff you are
testing on an environment which is 100
sent identical to your production
because we know what it's been like
before the cloud right you had a
production environment for something and
then after a few years or after some
time that environment got replaced there
was a new investment a new IT budget
year and there was a spending on buying
a new infrastructure for for the new
environment more powerful machines right
and then the IT manager looks at that
old production environment eagles huh
that stuff still works and it's actually
I if I throw that out it's like throwing
money and you know just out the window
let's keep that old production
environment and turn it into what
testing environment right so now you're
effectively testing stuff on an
environment which is not equal to
production right so how do you know what
it's going to be like in production you
don't or you spend money on two
identical environments at least so you
have a testing environment which is
identical to production well in the
cloud you can just forget about all of
us all that hassle oh that's all that
problem and do like this instead I have
a new template it looks like this it's a
little bit bigger longer than the last
one so it has a website name asked you
name as in which size of them which size
of websites do I want to deploy and
there are quite a few to choose from it
has a skew capacity how many instances
do I want of my website and it really
only has in the bottom here to resources
it's funny because any web application
in Azure needs to be in what's called a
nap service plan and when you look under
the covers a nap service plan is
actually called a web server farm so
every dev every tech person knows what a
server for ms and then when you ask
marketing guys like a farm is that
really the word we want to use farm now
let's rename that to a nap service plan
because it makes more sense to everybody
except the technology the tech guys
right and then the same thing happens
with web applications
it's actually underneath the covers is
called a fight but that wasn't cool
anymore because it's all about the apps
so we have to rename the website into
web apps all right so we're doing that
but anyway underneath the covers you can
see the real things so here's the
definition of a server farm and
underneath that a definition of a web
application okay and then i have my
parameter file so i have my development
parameter file that's just going to
specify a website name and that what
does that mean then well if we go back
and see defer defines a website name and
that means that we are going to default
to the few sides of being f1 that's the
free tier the smallest possible web
application for development perfect
we're not doing any testing on that
environment and then the sku capacity is
going to be one okay cool so let's go
recharge testing environment and we
notice that we're now adding as a
parameter for the few nay of the few
name as in we want we don't want to
freeze here anymore we're moving it up
to the basic one tier a little bit
larger web application for testing
purposes makes sense and then production
what are we doing while we're moving now
up to the s-1 size which is expanded one
science it's still a reasonably small
web application but it's now in a
production stage sighs it's really it's
a real thing right and the sku capacity
is too so we have redundancy so I can
deploy with these different parameter
files different environments so let's do
that here's a little script which I'm
sure should be bigger huh looks good to
zoom in here as well awesome right so I
have three different environments and
I'm actually I'm putting these in
separate resource group because then I
can give access differently to these
make sense and then I'm going to just I
just had to like do a for each in
PowerShell I'm not a PowerShell with
there or anything but I can can do it
for each at least and so I'm creating a
resource group for each of my
environment and I'm deploying each of my
environment so if I f5 this and in fact
this one is doing them
serializing them so it's creating one
environment moving on to the next and
creating that and moving on to the next
so it's now creating the first one if
dev well if I go to a shiur close this
down my list here is going to at least
have increased with one more so it's
currently deploying my dev environment
and then it's going to continue to do my
test environment and it's going to do my
production environment and and if we you
know we can if we drill down and look at
them yes there are going to be different
sized websites and there are going to be
different numbers of instances in them
so it's really just parameterize and we
use and the cool thing is that you are
actually using the exact same template
for development and production so you
know those environments will be having
the exact same resources may be
different sizes and stuff where it makes
sense but still so it's almost soon we
have deployed the whole thing all right
now we also need help of course we don't
want to go PowerShell all the time but
seriously it's like to PowerShell
command lets its create resource group
and create deployment if that's it it's
not difficult but sometimes we need some
tooling support and of course I mean
this is Microsoft after all and we'd
expect there to be lots of lots of
tooling which there is there's the
portal and all of the Ides that they're
supporting visual studio which is video
code that I've shown you and and also of
course miss to decode and and eclipse is
there as well so their support for
different kinds of bodies with the
command line I'm showed your power shell
and there's also something called X plat
the cross-platform command-line
interface but the bottom line again as
you saw in almost the first slide
there's a REST API a management endpoint
that's what this is so for powershell
it's really funny i did you guys notice
when microsoft open first powershell so
they did on April on August eighteenth
PowerShell is open source and available
on Linux so yes Microsoft do love Linux
yay
I just wanted to point that out I think
that's pretty cool so now we can
actually do powershell from online stuff
on linux how strange is that odd world
but also there is the command line
interface for anywhere you can run
python this is the the bottom one is a
python implementation anywhere you can
run Python you can run that X plus or a
sure CLI or whatever you want to call it
now I'm going to tell you a secret I
will tell you the secret sauce of Asher
right when you know this it's going to
be like hi there is the rest api okay
the rest api is key to everything here
and when you go to resources that Asher
calm you'll get a site that she looks
like this where you can drill into all
the resources that you have in a sure
okay so if you start digging into this
clear yet well I can list all my
subscriptions let's actually go to my
corporate website just just for fun it's
in there as well never browse to my
corporate website is really ugly but
here's my lofty soft corporate
deployment to see that down here I have
a web application and I can open it up
and see ya there it is so when I drill
all the way down here when I get well I
get the exact template for my web
application I can get the template for a
whole resource group of resources all of
them and it's right there every property
that you can put on a web application
you can go and drill down and look at
them and see what's going on there you
can even there's the documentation tab
there at the top so you can read some of
the books some of the documentation of
stuff if you want to but what you can
also do it is this is a let me okay so
here's the secret okay this if you look
at the URL here you see we're on
management.com and then we go /
subscriptions and that's my unique
subscription ID for for the subscription
we are in and then we go / resources and
you know we need a resource group name
and that's lovely soft corporate cool
and then we go / providers to see which
resource are we using what do you think
micro
 web / sites okay cool and then the
last / is the unique name of my web
application so what is this well this is
a URI for a resource a unique identifier
for my resource my web application the
unique global locator for this thing
it's also a URL right it's not only a
URI is the URL as well because it's an
endpoint to the management API oops to
the management API where we were over
there see zooming on a on this screen is
a little bit difficult there we go
management API endpoint right so we can
talk to this end point but now that we
have seen this this kind of a secret
right or little known fact that the
cloud is really just let's say that
let's call one subscription one tree
right with all the resources hanging you
know the branches would be resource
groups and the individual resources
would be the leaf on the tree well then
all of your subscriptions makes up a
little forest right so literally all of
a sure is just the tree or a forest if
you will that's what it is I can and now
that you know it's like huh that makes
sense all of a sudden so not so daunting
and dangerous and scary anymore right
now it makes a lot of sense so you can
talk to these endpoints and do stuff
with them I'm not going to do a lot of
things here now but in the interest of
time and everything but really what i
can do is i can do things such as well
see what we have here i can do start and
stop i can start and stop my web
application using the HTTP endpoint and
that would look something like this i'm
going to go to my excuse me I'll go to
that URL which is the URL for my my web
application furthest to the right here
you see lofty soft and / some command /
stop to stop my web application / start
to start it and that sounds dangerous
but it isn't because you have to be
authenticated so I have to be signed in
as somebody who has access to do this
but the fact that I can do it yes
question
yes I I need to be I have to be
authenticated as an organizational user
in the app in the active directory which
controls access here so I am currently
finding as me so it's certainly not
insecure it's it's the opposite it's
absolutely very secure so there you go
I'm signed in as my corporate identity
here but I also were already
authenticated in this browser session so
yeah if you can literally make a call to
your ad receive a token and apply the
token there's a job so can put that
token on your HTTP request and have it
authenticated and then you have access
to do the thing sweet so I think it's
pretty cool and I think this is a again
it's a little known fact that Asher is a
forest mr. suited code I kind of showed
you it already what I wanted to show
what intelligence that you have tooling
support inside of it and see if it works
now see if we can go back to for some
reason it didn't work before and go back
to my hello template and see if I can do
it no that one I wanted to he needs to
connect to the internet here it seems so
I don't know why it's not working right
now but normally would get a list of the
possible that would be then most
probably be able to the list of the way
of the I'm authenticated so it checks to
see which regions am I am I available to
to deploy to could be that but anyway
it's not it's not coming up it doesn't
matter truly support is there there's a
bunch of a bunch of extensions 1 i'm
using here is the and the official
actual resource management tooling from
microsoft so you can go and and get that
and just just apply it to seeing you so
so I've been talking to Microsoft about
this which tool should i use if i'm an
IT pro guy right how do i get good
tooling because visual studio would be
the flagship that's what they're putting
the most of the effort on tooling but
they're also putting effort on tooling
in other places and if i'm a typical
pro person I don't do development work
it's unlikely that I will want to have
visual studio installed on my system
it's a kind of a big footprint and then
there's this licensing issue as well but
I might need to work with templates with
the team because I'm also responsible
for the resources in the management of
the resources which means that I'm
involved with the I ops and the
day-to-day management and monitoring
which tool is that while the answer
right now is actually Visual Studio code
and I think it's unfortunate that
special video code is called code but I
think Microsoft needed a name for
something which was you know not they
couldn't be sued for it or something I
guess code cannot be a protected name or
something iono but anyway it is that and
since it has support for gits and it has
support for tooling and templating and
that sort of stuff and that's that's the
small footprint little development tool
for developing quote-unquote right or
maintaining resource templates okay and
i actually just learn it love it it's
actually quite handy i use it a lot
because i find that it's small it makes
a small footprint on my machine and just
works and does the thing but you know
let's not forget let's not forget that
that changes are not for everyone right
we're human we don't like change it and
I keep this picture as a reminder there
of you know when and when wagons started
to roll down the streets without a horse
in front of them when they were able to
be automatically mobile on their own you
know these were autumn mobile really
scary stuff and some people got scared
of that change so they had to put like a
horse's head on the wagon to sort of
take the edge of that problem for people
you know even some of those designs had
a whip holder on them because you're
honestly if you don't have a whip holder
when you put the whip right it's
important so changes is that's scary and
I think I'm going to be very very
respectful I love IT and there is a big
change for IT but the change is not for
the worst I guess if the only thing you
ever want to do is put hard drives into
blades then you're going to be sorry
but if you are willing to take that step
and change and and become somebody who
has like a cape of power now you never
have to say no again when somebody comes
me I'd like a database you just just 1
i'll give you fifty databases now it
doesn't matter used to be the case that
you fill out a form and put on a pile
and then in a couple of you know weeks
when we've got get the new hard drives
for the sequel server we're going to
install them and then after a while then
maybe you'll get your database and
what's going to take like three months
now it's like yeah okay powershell
script there you go it's just too simple
so honestly I see gets the most power
out of a sure it's not even damn its IT
it's empowering and really cool and I if
anyone feels like oh my god I can't have
my servers anymore and while I'm sorry
get over it they're gone and if you want
to get started with this i really want
to point out this resource because it's
super good and it's not own entirely by
microsoft it's actually community
contributions if you want it whoa excuse
me if you want to get into a templating
and see some examples you should go to
the github repository for the quick
start in place and these are community
contributions and there's like you know
there are hundreds i think over 400
different templates and odds are if you
need a template for something if you
need a place to start go and check here
i'm sure there's going to be something
similar to what you need use that as a
baseline try to understand what the
template is about on what you need in
there if you're going to do a vm if
anyone has ever deployed have you do
anyone has deployed a vm to azure have
you use the portal probably yeah you
look at a VA you go and provision a vm
and azure and you look at that in the
portal you get like wow what's always
I'm a damn guy okay so i understand i
need a vm from time to time that's okay
but when I zip when I provision of vm i
get what i call a big bag of crap but i
get my vm but i also get a V net and a
subnet and an ink and an IP and as ice
like this whole list of things I just
provisioned one thing and I got all that
stuff what's up with that right but
that's what it looks like so you can go
down here and check all the
place you need Microsoft even went so
far as to make that into a pretty sight
which where you can search and look for
the Quick Start templates that you need
and I think you're listening at 447
templates maintained by the community so
really there's there's a good place to
start so I want to call that out I think
that's the most important resource and
for templating honestly so you can also
of course use code and this is an
example of the latest version of the
dotnet SDK of course there's one for
java etc etc but here's one with a
fluent interface you could of course use
fire off a template from code but here
you can actually go in code and say I
want to have that with that with that I
want to have it in this region with this
resource group and then I want to have
this network and so on and so forth okay
so that creates call at the bottom will
effectively provision of Windows Server
2012 r2 datacenter edition and and some
settings on that it's pretty cool so
anything you need to do I don't have a
demo of this even even today but but i
just wanted to show it yes of course you
can build like a portal experience for
your customers where they can go and
provision things or you know something
like that that works as well so these
are the basic fact to farm and I want to
spend like the rest of this session
talking about what does this mean arm
and templating is a very very
fundamental it's a baselining thing okay
it's the baseline anything and on top of
that you can start taking advantage of
it and do really cool stuff they also of
course added role-based access control
to the cloud and you can sort of
combined templating and access to your
resources which role based access
control gives you a way to set very
granular permissions on things you can
assign that to users to groups you've
got built-in roles to get started if you
need a special specialized rule or roll
you can create your own custom ones and
apply them to your subscription you can
see okay and now have this role which I
can assign
users to groups which gives them exactly
the permission they need it's very very
flexible and quite cool so I turns into
this hierarchical thing well we all
understand how a corporate pyramid works
there's the boss at the top there with
the red polo that kind of looks like
scott guthrie let me have his managers
and their managers managers and you know
that's a deaf guy because you got a
black shirt with 404 on the front but
anyway they're trying to be over over
explicit here in fact let's let me just
remove that do you know you know that
trick in PowerPoint you can pick B get a
black screen yes cool if you hit w you
get a wide screen and then you can do
like like shadow figures and stuff but
if you if you'd be I just want to talk
for a while people don't have to look at
those pictures and can just talk that's
cool anyway sorry I digress right so
what you would typically do of course
you would have an owner of a
subscription and that owner would then
dish out ownership to like a resource
group or a small space where a project
might be working and put an owner on
that product on that resource group may
be a project manager somebody as the
owner on that and that person would
create groups of his teams in the active
directory and grants them maybe
contribute to access to the development
environment may be read-only access to
the production environment stuff like
that you can put very granular details
access control rules here for in just
one example you can have a dev team with
a research group for their development
they can do whatever they want in there
then you have a production environment
they have read-only but you can add a
staging environment in the production of
space for deploying web applications and
then allow the development team to do
staging deployment but maybe they don't
have the permission to swap the staging
into production maybe that's the DevOps
guys role he has that special permission
so that he can do that swamp you can do
this detailed set up to enable not only
all in constrain your employees that's
not the point the point if you can
really give them the security of being
able to move freely without accidentally
nudging something over and spilling the
coffee right that's what you want we
want them to feel secure so on the
enterprise space of things you should
focus on organizational accounts you
should never use the Microsoft account
to sign in and should use your corporate
credentials I use only my core
presidential when logging into a sure
all the time never my workshop account
you should focus on resource group
access and manage those groups in your
Active Directory so that you're able to
grant last least privileged access and
then whenever access changes you keep
tabs on that it is actually just basic
cleanliness if you ask me but the fact
that you can do it is brilliant the fact
that most people are not doing it it's
actually true right I've seen it every
all the time and so a lot of folks don't
know how to do this now on the billing
side of things you can add tags to any
resource in a sure keyvaluepair tags
right that's what you can do it's really
really handy you if you have a growing
Service Catalog you need cost control
maybe you want specific resources and
specific regions you tag them you can
put tags in your templates and you
deploy and and you can go to the portal
and open up the little tags a blade or
properties window where you can edit
your tags so you can have department are
indeed Department something else finance
whatever that whatever that is and that
means that you can then effectively
filter out all the resources with a
specific tag easily and you can go and
find out who owns this resource while it
belongs to our MD i see well now it's
not a mystery anymore so now we can
actually go to the army if the R&amp;amp;D
department and you guys have a database
out there with your name on it what's it
for and also of course grouping the cost
at the end of the month you
unfortunately get a bill right and then
you can give that to the excel people
and those people love that
they can go and filter on co this is my
how much are these crossing us and this
is how much by discussing that's perfect
you can break it down and get all the
numbers that's what you use tags for and
then it's nice to be able to see that
everything is tagged in proper order but
you can actually enforce a lot of stuff
on your subscriptions using policies and
policy is very handy especially if
you're an enterprise maybe you have
rules in your company that there are
certain things we are allowed to do and
certain things we are not allowed to do
okay maybe we're not allowed to deploy
databases in Asia we have to deploy
databases in Europe compliance reasons
it's important to us maybe a developer
thinks it's really cool to create a
godzilla-sized machine because it just
thinks it's fun while fun costs a lot of
money because the godzilla-sized
machines in a sure they're awesome and
also very expensive you can actually
constrain and say no we're not allowed
to use those machines it's just well if
it is funny I grant you that but it's
also very expensive right so you can
enforce all kinds of conventions and
rule you can limit to what types of
instances need to be deployed which
regions are we allowed to use require
tags for departmental chargeback you're
not allowed to deploy unless you have
the proper tags sorry we're not doing it
okay and very simple stuff it's an if
conditional statements and then
something happens deny what is this
append change it so here's some here's
an example of that if the location is UK
west or UK south then deny we're not
allowed to I don't know why but we're
not allowed to deploy to UK okay so if
you apply this policy to your
subscription or to your resource group
or something that will be evaluated when
somebody does a deployment against it
and that will effectively check to see
if there's any UK deployment not
happening here's another one and to deny
if you don't have the proper tags then
deny has to have cost Center tags
otherwise no go this is a very mean way
of doing it it's like you either play
ball or you don't
play at all another way of doing it and
this is a little bit smaller but I
wanted to have that extra example
another way of doing it is to say well
if the tags if there are tags and
there's a and that doesn't exist a cost
Center tag if that's not there then
append the cost Center tag of R&amp;amp;D so if
you have an a resource group which
belongs to rd those folks will go and
create and delete and do stuff there are
indeed that's what they're supposed to
be doing right and they made me want to
do something quick and simple in the
portal and you know forget about it and
stuff right and they get to that's okay
they get to do that but we still want to
charge back to R&amp;amp;D all the costs of R&amp;amp;D
so that resource group can have this
append thing in place so it means that
the only folks don't have to worry about
that tagging thing when they're just
doing quick quick quick things back and
forth and it gets automatically appended
so this is that this is a nice manager
version right the other one just deny
and this one is okay fine I'll fix it
for you right so both of them works so
after a Polish is evaluated the
important thing on this slide is that
there is an audit trail and you can also
of course have alerts on this if
somebody deploys to Asia alerts right
Edwards so you can do all those kinds of
alerting and things and audit trails are
being kept some people need the audit
trails for for compliance right and the
audits offer audits resources can look
like this it's a bit of a bit of JSON to
define exactly what happened here and
you can you can determine from these
audit trails all these things like who
initiated this operation when did that
occur on what operation on what
resources did that happen what was the
result of this so it's all audited
everything you do with your resources
it's good to know and let's quickly just
just go into that and see because I have
some I've made some deployments even now
right so if I go into the thing called
monitor i urge you guys definitely take
a look at mana
it's an awesome place the first thing
that pops up is in fact the activity log
being that thing and and it actually
does an automatic search on the latest
hour of things that I have done you can
see that I've done update website site
here I've done validations I've done in
these are all the things that I have
done during this session it's right
there the stuff that I did actually was
not prevented so in this case it's all
and all works but i do have on the slide
here a couple of examples where it
didn't work some red stuff and if you
have an error you can get alerted on
that so when somebody is messing with
stuff they shouldn't be well then you'll
find out so really why do we want this
well of course we want this we are
removing human error we're making it
automated we're making it more secure we
get cost-saving spent control we get we
know that we have environment parity
between production and testing and it's
all there simple fast and and the last
one when you know that whenever you say
that word you actually have to say it
three times Automation automation
automation that's the key you have to
have that yeah it is so simple I've
shown you how easy that is obviously
everyone wants this I know I know I am
drunk in my fair share of too late this
morning I can't help myself so guys what
do you think you have any questions you
like this it is good yes thanks so any
any thoughts any additional questions on
this we got time we got ten minutes yeah
if the company's policy is that it can't
really cost anything you can't host on
the cloud why well like I said before
you don't have to go to production in
the cloud that's fine but you I'm sure
you can do development and testing in
the cloud yeah I get that I get that but
you don't have to have the real database
in the cloud right you can you can
randomize database with data which is in
secret and then you can use the cloud
for development and testing that's going
to still save you so much it's crazy I
know it like a very large furniture
company in Sweden I'm not going to say
which one they have about they have in
their basement they have about a
thousand test servers can you imagine
the cost of just running and maintaining
a thousand physical machines for testing
purposes that's crazy talk right you
should just go to the cloud and get it
get done especially the fact that you
can just delete environments and and
come back after the weekend and spin
them up automatically again there's no
comparison really nun and and if you
have issues with this call me out or
I'll be your nice right yeah yeah I know
I know compliance I get it it's not easy
certainly it's not easy but it's fun
yeah well that's the first step yeah
yeah this is perfect for testing I just
wanted a test machine just right now
linux box some special installation 3-4
hours delete I'm done perfect thanks yes
yeah that's true that's true if your
production environment is not in the
cloud it will be different yes at that
point you will need to have a testing
environment also not in the clouds and
that kind of sucks it kind of beats half
the purpose here but yeah you can still
run almost the same stuff in the cloud
and do your initial testing there and
then move to a proper testing
environment even though we don't want to
right yes I agree I agree when the best
the best of the best is when you can do
your development testing and staging in
the cloud and have all your environments
there that's that's sweet spot did you
have a question as you're on prem oh
yeah that's a completely different topic
so yeah so ashram frame is the current
incarnation is called Asher sack and if
you do have a suspect you get some of
the features of Asher definitely not all
of them you get like wet storage web
applications and some you know there's a
handful of them so this big charge goes
down to a handful or two and probably
that the number is growing but that it's
actually quite a bit of an investment is
there you need me there are some pretty
big requirements on those physical
machines you actually actually get and
install yourself and then you install
the azure stack on that which gives you
the arm model so you can actually you
can actually literally deploy the same
template to the public Asher cloud as
you would to your private Asher cloud so
that kind of helps but it's not cheap
you know and it's for some organization
still feel like a deal yeah so that's
what that is but in house yeah yeah you
can even let me I don't know for sure
but I was talking to them a while ago at
that point you actually had to have the
public Asher Active Directory you
couldn't use a private ad or offline the
whole thing but that's coming if it's
not there already might be since I
talked to them like you can go
completely off the grid just remove the
internet from your servers and run your
perfectly fine local cloud inside there
you've probably run that against the you
know and on the ground 80 and have your
resources
might be good if you're like the
government or like a you know the
military or somebody and then then you
that would work yeah the public Claudia
they need a private cloud yeah well show
them the bill for that and see if they
change their mind all right we have time
for one or two more questions yes yes
yes yes yes the question is if you have
a resource and it depends on other
resources is there a way to figure that
out I just showed you the most basic
thing like 12 resources and actually in
the one that I did show the web
application has to be let me go to go to
that the web application has to be
inside of a inside of a web farm right
so the that one here you have a nice
still trivial level it's 11 wafers
depending on one other resource so and
still trivial so the web server farm
here has a name a unique name and such
and you can resolve that name and then
say I depend on that other resource okay
so if you upload the template to Asher
Asher will first validate is this a
valid template but everything makes
sense you didn't make a sin tactical
error or something like that yes it
makes sense ok what do we have two
resources ok one resource depends on the
other I will go on provision of course
the one resource first and the other
resource after and these dependencies
can be really complicated if you do a vm
you are dependent on one or two or more
storage accounts you're dependent on a V
net and a subnet inside of the Venus
well the subnets dependent on the v-net
and in observer bubbeleh so sure go and
look at those samples they can become
you know couple hundred lines of
template and they can become complicated
sure you can always make it arbitrarily
complicated well the trick is if you can
make it simple but yes you it validates
this and takes care of everything for
you and if it can then so Indian in
parallel Isis things if it can go and
create the storage account in the Venus
and the Nick and stuff parallel it'll do
that and then
all of those are done it's going to
create the vm there no not outside of
the tab well what do you mean I
documented us in the azure documentation
you sure I'm sure they are if you go and
read about a vm you understand which
ones like which resources you also need
if you need a vm you need a place where
you store the vhd for the OS disk well
then you need a storage account and then
you need a and then Anita yeah that's
what I said you know when I said that
you get this whole box of crap when you
i want a vm and get like six things
weird that's crazy yeah final question
anyone yes yeah yeah all right so the
question is on the tagging thing and if
you apply tags to a if you have a tag on
a research group you also get the tag
applied to the sub resources inside of
there and and can you also use the tags
for something else well the main thing
for using tags is obviously the to be
able to to group things together across
you know even across subscriptions even
across so they have the same these are
your key value pairs you control them
you decide what makes sense inside of
your organization you define which tags
you use and then you can go and search
and get all the resources belonging to a
tag that's the main reason for having
them and of course that applies to
splitting the bill at the end of the
month that's the main thing can it be
used for something else honestly tagging
is an organizational thing it helps you
make sense of your resources in a sure
if you're an enterprise and you have
hundreds of VMs wow you kind of need
tags now you kind of need to be able to
figure out you can put a person's name
there right bob is responsible for that
machine yes
yes yes yes yes that's correct so good
observation and I didn't actually answer
your entire question I did not say so if
you have a tag on a resource group it
doesn't automatically apply under
resources in the in the resource group
and yes you're correct a research group
is like a grouping thing where you put
things that logically belong to one
another and that gives you a way to
control access to those resources
resources perfect because you typically
want to control access to them as a
unity and then the tagging is more like
I want to put a little label here that's
what we did we used to do tagging in the
in the physical data center right there
was a little tag this server is name is
Hilda right it's the sequel server right
that's the same thing we put a little
tag there to say what it is exactly
right perfect you did you did my summary
for me thank you so to round things
things off here I I love this stuff I
hope you notice that I'm excited about
the I really do I this is the most fun i
can imagine to to be allowed to talk
about things that I'm passionate up
there are some new challenges in the
cloud here and learning to use a sure
the proper way will pay back simple as
that if you learn these skills that is
going to help you so much it's going to
come back to you it's worth it right and
and you know I don't mean to make this
whole presentation sounds like a sales
pitch but I do have a training course on
this in case you're interested that was
I couldn't help myself I apologize thank
you guys I am out of time thank you for
your participation cooperation the
questions loved it thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>