<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Redux, beyond React - Aaron Powell | Coder Coacher - Coaching Coders</title><meta content="Redux, beyond React - Aaron Powell - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/NDC-Conferences/">NDC Conferences</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Redux, beyond React - Aaron Powell</b></h2><h5 class="post__date">2017-09-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TYjosLQ3yDE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right welcome everyone to redux
Beyond react
I'm pal I work for ratify and if you
want to fall onto my random ramblings
you can follow me on Twitter but that's
only recommended at the point of a
conference where I'm going to be sharing
the content that I've done within a talk
and maybe not general-purpose
following of my ramblings so today I'm
going to be talking about redux
obviously but I discovered this is I
want to talk about how we can use that
without being tied to a specific web UI
so first off though I want to talk a bit
about who how do we get to this point of
the play why are we talking about a
library like redux and why are we
talking about it without reactor and
that kind of stuff I also want to clear
up a couple of misconceptions about
Redux first up
now obviously Redux in react if you
follow on in the JavaScript community
are fairly closely related the reason
for this is that Redux really did spin
out of the react community
it was first demoed at the react EU
conference in 2015 I was I was actually
kind of a subset of a larger talk about
time travel deeply that was the the
context of the talk and Redux was used
as a way to represent how you can do
time travel debugging I'll talk a bit
about that when we get in some live
demos later now it's got a lot of
traction with inside of the react
community reacts as as a librarian as a
way of doing front-end web UI
architecture one of the main reasons
that it grew in popularity was it was
kind of pitched as an alternative to
flux which was the and kind of still is
the Facebook backed way of doing data
management with inside of a react
application so that's not know why it
grew out and and had that kind of strong
connection to to react and why it's kind
of perceived as you're doing Redux
you're doing it in a reactor application
and I want to break that perception
today but before we get into how we can
use Redux in other UIs
I just want to talk a bit about how
Redux works itself and get through to
the the kind of fundamentals of what
Redux is
so there's three core pillars to a redux
architecture we have actions actions
flow through two reducers and this is
all tied then back to our store so an
action this is essentially something
that happened with inside of our
application we could think of it almost
like an event an action that is
dispatched which is the terminology used
with inside of Redux of how you trigger
Redux action or how you you add one to
what's happening is you have to give it
some kind of unique identifier we need
some way that we can address what type
that action is and as it's going through
so that it can be understood when it
gets to our reducer this function here
on the right is a very basic action
creator function so the role of this
function is that it's going to create a
new action based off of some value
that's provided in and that action is
then provided to the dispatch method of
our store so the reducer a reducers
listening to actions that are getting
dispatched with inside of our store
going to do something with them it
receives the current state of the
application so what has happened to this
point in time what does the data look
like with inside of the the react
application that we're building this
with it gets the action that was
dispatched against the store takes these
two together and combines them to
produce new application state now the
point here is that this is a pure
function so it's received everything
that it needs to receive to make
decisions on what it's going to do next
now it's it's receiving the action and
it's using the type of that action to
determine whether it can do something
it's a receiving current state to work
out whether or not it can to change what
the current state looks like to produce
new State and that's what's returned
because this is a pure function it makes
it very easy to create tests around we
can have our call logic of our
application or of our data lifecycle is
very easy to test
and this is a reducer function we see
it's got two arguments action state in
action we're doing some kind of check to
see can this reducer actually handle the
action that's been provided to it yeah
yeah this one in this case it's looking
it can handle only a single type which
is the type echo and if it receives that
it's just going to create new state
which is the value that got passed in I
think back from our action creator the
final piece is our store this is really
the most important part of our react or
have Redux architecture it's where all
data flows around it's also the only
place where state truly lives it's the
only one that's able to modify state so
I mean it's the only one that's able to
say this is the current state of the
data that is in the side of your
application it's also the one that's
responsible of taking the action and
then giving that across to the reducers
so if you've got multiple reducers
inside of your application it'll work
out which ones that to pass that action
across to and then they can do their own
logic in and of themselves it's also
responsible for handling middleware so
if we want to do something that can
intercept an action before it's passed
to a reducer it can be it can apply
those middleware steps in a very similar
way that the middleware works in like an
asp net core pipeline or a known
pipeline for asp net full framework and
middleware is obviously a very common
concept across quite a number of web
your web server frameworks the final
thing that the store does is it notifies
anyone that's interested that data has
changed when data changes happen because
it because it's the only one that
actually owns data it's the only one
that has any kind of mutability to its
data it's the one that's responsible to
say hey web UI data has changed you want
to do something with that data the new
data or tell some kind of back-end
system that your data is changing and
you need to persist something or
whatever it might be so this is how we
kind of connect all of this together we
create a store for the function that
redux gives us
keep saying react instead of relaxers I
use them so commonly together and it's
gonna be really annoying for anyone
that's like but it's not related to
react so I apologize for that
so from Redux we get a create store
function we we pass it the reducer or
the reducers that we're using with
inside of our application
the second argument I'm passing to that
is initial state so initially the state
of the application is an empty string
and then subscribing to any changes to
the data straight after that and if
something changes I'm just doing console
dot log of the current state of the saw
and then finally dispatching an action
against that using the action crater we
created two slides back so there are
some interesting quirks about the way of
Redux works as I said actions need to
have some kind of a type so that we can
identify them now this is a JavaScript
library so we haven't been of a problem
with that because well JavaScript is a
very loosely typed language and there
was until the introduction of classes
but they're not particularly prevalent
so we still trenders a very loosely
typed language where it's no slightly
less loosely typed these days so inside
of JavaScript application we would do a
property of the object that's being
passed in and that probably would be
called type and that's what we then you
know users that identify what type this
action is now as I said reducers can't
change the state that they're given all
they can do is produce new state based
off of the information they receive
which is the current state and the
action that was dispatched so this can
be a little bit of a challenge in
JavaScript because everything is then
passed by ref so we can actually mutate
the state object that's been passed in
but if we do that well we are in a
situation where we can't guarantee that
we have consistency as actions are
dispatcher if a reducer has actually
changed the previous object well others
aren't going to know about that so
typically what we would do is we would
do something like object assign in
JavaScript to create a new object based
off of the current state object and then
send any properties on that with the
third argument and if you've seen
a sign basically it takes a bunch of
argument and smashes them left to right
so we build up and replace properties as
we go along the other thing and if
you're using a transpiler like all the
cool kids are with babel and web pack
and about 30 Meg's of node modules you
probably you see something like the
spread operator and dokdo dokdo we dot
the dot on the current state and then
set any additional properties and
replace properties of the current state
and the other option you can go with is
something like the immutable j/s library
which is another one that has come out
of facebook which creates a purely it's
really a mutable object with inside of
JavaScript that you can anytime you try
and change values that actually creates
an entire new object and stuff like that
but there's that introduces other
complexities into the way the
application works a reducer can also not
return undefined now I'm going to assume
that most people here are familiar
enough with JavaScript to know is it
undefined can cause all sorts of
problems with inside of our application
and really do you ever want the data
state of your application to be
undefined
and what's that representing about your
application what's happened in your
application where all the data about
your application is there's like no idea
what it means but you
so essentially you can't return
undefined from a reducer Redux will
actually stop you from doing that
similarly you can't return null and
everything that we send to a store every
action that we dispatch has to be
synchronous now in JavaScript this
couldn't introduce another bunch of
problems because we do a lot of
asynchronous operations any time we talk
to a server and we're using fetch or
we're using xhr those are asynchronous
operations well how do we do with that
if we have to make everything
synchronous well in the example of doing
a cervical either that with fetch or
with an xhr we can decompose that as a
couple of different actions so we start
and a gesture and then that Ajax call
completes either successfully or
unsuccessfully so it's really two
actions and we can then do different
things based off of whether we started
an ajax call
load a spin at the shower spin up a Jess
school is completed remove the spinner
now you might be thinking that you've
heard this before now it's not a eunuch
system
it's an event store we're essentially
probably about veg sorting here you guys
well done JavaScript community you have
invented something that we've already
been doing and you think you're cool
because you gave it a funky new name and
it's got the letter X in it which means
it's extreme and all that kind of stuff
but yeah the JavaScript community loves
to reinvent things that have already
been invented so Bravo JavaScript
community brother okay so the whole
point of this talk is not to talk about
react so what happens if we want to use
Redux
with that react we want to go beyond
react well what if we want to use Redux
in a non web scenario and jump over to a
demo and realize that that's not a great
resolution but we might have to accept
that and carry on touch more okay so
this is almost a simple a way of using
redux as I could come up with about 20
minutes ago yeah I'm not kidding I wrote
this earlier today so what I have is an
application that has no UI at the very
top I'm grabbing the crate store and
apply middlewares functions off Redux
I'm making an action creative function
that has a type of Inc increment and
then we pass in a value that becomes a
property called payload we have a
reducer that has a state and action
provided to it so some initial state
with count of 0 if the type is Inc then
it will be able to use the spread
operator whoops
use the spread operator to take the
current state and then just replace the
count property on it now I don't have
any other properties of that but if I
did have a more complex object then
would only override the count property
I've also created some middleware here
this is just a logging middleware that
intercepts the action as it's being
dispatched it will start a console group
put some information in that and then in
that group so we can do some inspection
of every single actions being done we
create the store subscribe and then just
using a set timeout to recursively
invoke this so if we have a look at how
that works or how that looks in the
console my console a little bit bigger
we'll run that and I'm realized that I
disconnected my network so it's not
actually going to run which is a problem
so just bear with me while we reconnect
the network and talking about yourselves
people this is not too big a problem
normally I keep my network off for
conference talks because the last thing
I want is a notification to pop in
because someone is probably on Twitter
and sending me messages or something
like that and not looking anyone in
particular in the audience like my
colleagues okay cool so we're about
connected to the Internet
all right so there we go well so we
don't actually have a UI well I mean we
technically do because we're looking at
to the console but this is like this is
Redux in a nutshell it's actions are
being dispatched reduces about votes
subscribers are listening to that middle
words being applied and all this is
continuously going along in the
background and it's doing something
nothing particularly important with this
example but it's still doing something
for us so that's like that's the crux of
Redux then and how it can be done
without any sort of UI reload that stops
that running in the background okay stop
back to our slides all right so as a non
web scenario of how we could use react
so I used web because I probably could
have done that in node if I want to do a
bit whatever so when we're looking at it
reacts without using react now there's a
lot of different web UI frameworks that
people are using these days angular one
or angular seven I think it is now I
don't know the version numbers of
angular is too hard to keep up with
backbone polymer the other ones that are
now kind of niche where it's kind of
really like angular and react seem to be
the the ones that are sort of winning at
the moment this node modules that you
can there's NPM packages that you can
download that you can add to your
application to essentially apply this
with with angular what it does is it
replaces the way that you would use the
the controller hours or the dolls scope
injectable objects and you instead of
you inject a Redux store and that's what
you subscribe to and you dispatch
actions against instead it can be also
used with less popular web UI frameworks
and I'm going to jump back over to a
demo of how we can combine this with a
less popular web UI framework so I'm
going to be using knockout apologies to
anyone in the audience that is still
using knockout and that I'm just like
ragging all over it
I'm it was popular awhile ago in my
opinion but I wanted to show how like
how you how easy it is to kind of
shoehorn this into a basic application
architecture so you can see that it's
it's not that different an idea or
complex an idea so here's how our
increment and all that kind of stuff at
the very top on lines 21 and 22
that's my knockout code so I've got a
data binding the text of the span is
going to be the number of clicks that
have happened
it's a click handle that I registering
on the button that every time you click
that it's going to dispatch a new action
so so the action reducer that's all
created they're creating the store is
down here on line 46 now I don't want my
not my knockout view model to explicitly
be tied to reiax I don't want it to know
that that exists so the way that you
would do this and this is using some
terminology that is very common when
working with it with react is that we
have two functions not state two props
or really this should be probably
renamed state two observable so that's
state of the current store two
observable properties
view model and dispatch to props so this
will wrap around the dispatch call
against the store and then turn those
into just normal functions that can be
invoked from our view model now just
open up the view model and have a look
at how that looks there's kind of no
signs that this is doing anything with
redux in here really the view model
takes some properties when it's
initially created it has some
observables on it the register click
function is just a function that can be
invoked that uses the property prop
stock click function that's passed in so
this is now something it's a view model
it's very testable it's not tied to a
whole bunch of external dependencies
it's just tied to something that's being
passed in so we can easily knock that
out and when looking at this from maybe
an angular perspective you see a lot of
that same sort of overlap now the final
thing that I've got with inside of this
script block is not going to apply
bindings to set the set the view model
onto the UI and is just apply into the
body I've created a connector function
which will connect the store that I've
got copy the code that connects the
store that I've got I created a few
lines up using a couple map the map
functions that state two props and/or
say two observables and dispatch two
observables or just about two props to a
particular implementation of the view
model or a particular view model in this
case if we just open up that have a look
at how it works so the connect function
is it receives the store etc etc what it
does is it gets the state of the
application from the store so when you
initially do the bind I passes that
through state two props it passes that
through dispatch two props it then sets
up a subscribe on the store and then
finally it creates an in sorry it
creates an instance of the view model
passes through the mapping of state two
props in dispatch two props so that's
how we get that kind of constructor
argument passed to knock out and then we
subscribe to the store
anytime the subscribe is fired so every
time an action completes and the reducer
does its thing we then get all the
properties back out of the view model we
get all the state back out of the store
we then pass it through state two props
and dispatch the props again and then we
find all the observables and set those
back onto the view model with the new
values that we've got by doing this
SUBSCRIBE call so what happens there so
that's fairly condensed in under the
hood this is what pretty much all of the
bindings that you'll find for whatever
web UI framework you're working with
they work this way essentially just
subscribing and taking away that
unpacking what's in current state of the
store and then somehow setting that on
values that you've got with inside of
the components that you're connected to
so we come over to the browser we have a
look at how that works
rocket science demos here where we click
buttons and counters increment I don't
have any console logging middleware or
anything like that so you kind of just
have to take my word that's happening
but essentially yeah every time we click
then that's going through all of that
subscribe method call and all that kind
of stuff so that's how simple it is to
connect to any kind of web UI framework
that you might be using all right and
back to our slides
okay so Redux is pretty simple there's
only really a small number of concepts
that you need to understand know how
Redux works and that's it if you've been
doing server-side development you're
probably familiar or probably come
across the idea of events tours and
stuff like that so it's not that
different from that as a concept being
able to introduce it to an hour-and
application again is not that not that
complex you've probably been doing
something similar in most applications
anyway the main difference that Redux is
brings in is the idea of data is only
mutable in one location rather than
multiple locations which is particularly
angular applications that's kind of
every controller has its own scope that
works with data it's really more about
how does everything talk to redux
how does my knockout view model talk to
redux or how does you know a set timeout
dispatch actions and stuff like that
that's that's the differences that you
find between different frameworks again
it still comes back to the the core idea
of being able to call stored up dispatch
but how you get that dispatch method you
know that changes it depending on how
you're working with it also the core of
redux itself is actually really quite
simplistic it's quite nice code and easy
to go through and when I first got into
to Redux oh I really want to understand
how it worked under the hood so I
decided to create a library called redox
pause for drew
the naming of this moves on because it's
not getting the kind of humor that I was
hoping for I just want to talk about how
it works internally then Wow
so that we can get an idea of how this
can be used in in other scenarios so I
have a little application here that I
can run of redux demo there's minimal
cracking involved in this so don't worry
and when I was going through building
this oh well what what is what is the
most complex application I can build
from a command line there could be
useful for people to understand so I
build a to-do list
no one's done that one before good a
to-do list using redux again no one's
done that before so this is this is just
a replica it's got a UI it just happens
to be a console UI it's not a web UI so
I can interact with this and say write a
talk or at least I probably should have
done that one before right now we're
going to add another to do of be awesome
and then a final tale to do of Haeckel
richard so i could go up and mark off a
couple of things things is completed I
still haven't read my talk so I'll leave
that one is I'm done I could change the
visibility now all these are actions
that I'm dispatching against my store
and especially in action to mark
something is completed that's just a it
flows through redux deserve is pipeline
that goes to a reduces the reduce it
goes well this object is now complete so
I'm gonna set that and then update the
state to be all of that so it's too
simple really but there's this is all
done from a server-side application
definitely well it's not really browser
client side so how does that then look
internally if I find the right Visual
Studio code instance this is kind of the
crux of what Redux is it's for
JavaScript files and in index J s I've I
think the actual implementation on
github combines these all into one file
or I think it's only two files maybe but
I broke this out because I was writing a
blog series just to try and understand
how it worked internally because we were
in the process of teaching a bunch of
new developers to developers new to
front-end programming and react and
redux we're teaching them how that you
go through it so did all the building
blocks of this is this is how you create
the store this is what it's in doing
internally so on and so forth
so we have a function create store which
takes a couple of arguments internally
in here we have a subscribe function
which is basically just waiting until is
adding things into a ray that we're
going to iterate through later we have a
dispatch function that does a bunch of
our type checking so make sure that you
have a type property on your action
because we need to be able to identify
it somehow throws an error otherwise we
then invoke the reducers with this the
current state of the application and the
action that was dispatched will you go
through the list of subscribers invoke
each of them and then return we have the
ability of a true state and so on and so
forth in a nutshell that is redux it is
a tote like taking middleware aside
Redux is 70 lines of code with some
white space but it's it's not that
difficult internally and then the way
that you would say combine this to a
console application is I've just got a
wrapper function to start with that uses
either the the actual implementation of
redux or my implementation of redux and
it gets really confusing when I keep
saying redux and redux because they're
two different things and you notice the
inflection you can work out which one
I'm talking about we subscribe to a
store and then we update the command
prompt based off the store change the
state change yeah it's still running to
some kind of a UI which do we know is
some kind of UI change based off of
what's happening it just so happens that
this UI is a console application UI you
can quite easily drop that into any kind
of sort of server side application that
needs some kind of State
okay so observable stores another thing
that a lot of people don't even realize
it and it I didn't realize this for a
long time is that Redux stores are
observable objects so what do I mean by
observable objects we'll be talking
about redux well under the hood they
implement this primitive in JavaScript
called system dot observable which
basically allows you to create an
observable stream so you can create a
stream of your store that you're going
to listen to and perform operations
against based off of what's happening
inside of your store has anyone played
with the RX framework cool cool enjoy
our excellent cool a number of people
have played with with our EXO you might
be familiar with the concept of an
observable from rx there's a JavaScript
implementation that Java implementations
it's done implementations there's
bindings for different web UIs their
angular being one of them stuff like
that but still at their core they're
observables that implement this
primitive type system not observable so
what you can do from that is sorry one
of the advantages that you can do with
observables is you can combine multiples
together to create a single observable
stream of multiple different data
sources so if you're already using
something like rx inside of your
application to observe particular set of
data streams you can also then create
our Redux store turn that into an
observable object and just add that as
another data source to your rx stream
and other cool things you can start
doing with rx is you can do conditional
subscriptions so we haven't seen any of
the demos so far but let's say that I
wanted to subscribe and only do updates
based off of like I wanted to update
part of UI based off of a particular
branch of my application State well
every single time the subscription
function is invoked I'm gonna have to
you know can i oh I need to do this yes
or no based off of there and if I've got
a deep state object I might need to walk
a bunch of stuff so it could be
could essentially make our subscription
function a little bit more complex or a
little bit more tedious than I would
actually need it to be so conditional
subscriptions inside of our X means that
I can just I can observe the stream but
I can you know slice out parts of the
stream and and drop no further down the
chain based off of things that are
happening and things that I'm not
interested in so essentially it Maps the
current stall state to some kind of a
stream and that I can perform operations
against and as I said you can combine
streams together and despite what
Ghostbuster said it's perfectly fine
quiet crowd today is this thing on all
right so another code demo or another
demo so I've created a application here
it's a clock though the clock face
itself is written to by rx the time
below that in the bit of text which
touch difficult to see that is done
based off of observing the store itself
subscribe so let's just start that okay
so we set the current time and then you
say that the the ticks happening
you have 53 55 56 seconds so on and so
forth and then the minute hands moved so
that's that's all happening quite nicely
I'll come back to what's on the right
panel just a moment I'm gonna go through
some of the code here all right so we've
got a reducer I've got a couple of
different actions one which is called
set up which determines whether or not I
need to draw the clock face just for
reasons if the so if the action type is
set up I set a property of draw clock to
true if the type of the action that was
dispatched is time then we're going to
set draw clock defaults cuz I don't need
to keep drawing clock faces I understand
what the previous time the the previous
time observed was the current States now
value and now is the action value that
was passed in and then I return new
state based off of
that stuff that's happened I create the
store down here I subscribe to it
against state if there's a now value on
the state then I'm just going to write
that out to the time tag using moment
just to get some pretty formatting but
then we start getting our observable
stuff here on line 62 through Eric's not
observable from so I'm giving it an
object that I'm assuming as implementing
systems I'll reserve all this will grant
me an observable stream I can then start
doing things like filter on the stream
so on line 64 I want to I want to only
draw the clock face if the state draw
clock is set to true so I can put a
filter in that before I do the
subscription to the to the stream so
that means that every second I'm firing
off this action but it's only going to
draw the clock face once so it will hit
this filter function many times but
everything after that's kind of it
doesn't continue down the chain which
gets a bit more obvious when we look at
from like line 70 down where I've got
multiple filters we're using a map to
then map is kind of like the map state
to props function so we're going over
the state pulling stuff out of it that
we actually need and then sending that
across to a subscription function in
this case we're going to update the
clock when the previous minutes and the
current minutes are not the same so
that's kind of how the the clock face
then takes a long we finished off by
dispatching a couple actions which is
the current current time and the initial
setup sorry and in the current time
there's a bit of a bug in this
application because the initial dispatch
doesn't the the initial state doesn't
have a previous time we know we don't
draw the initial clock face that's why
it's it's it at 12 o'clock because we
when we initially render out it doesn't
know to redraw the clock face because of
the filter functions that we've got on
line 71 and 72 then I just got a
function that's bound to the the button
click that runs the clock and it will
keep dispatching time every second
so now if we start that up again times
jump forward quite nicely and we can go
forward now I said I've got this right
panel here so I'll talk about that in a
moment and that moment is now I don't
know why I did that but okay
so I plug this into the Redux Chrome
extension that allows me to actually
inject a piece of middleware that's
watching what's happening inside of my
store you'll see that I have all these
this time stuff down here and what they
represent is all the different actions
that have been dispatched with inside of
my application I can see if I click on
one of them the reaction that was
obviously a couple of seconds ago but at
32 minutes past the hour of the current
day and stuff of that though so and I
can see the type of that I have this to
also have this timeline here at the
bottom which if I hit play you'll see
that the clock face is actually on
backwards and we're stepping forwards
now we're replaying every single action
as we're going along you see the seconds
is ticking over
then we over ticked over a minute and
this is all just happening because every
action was synchronous so I can replay
every action in the order that they
actually happened in my application see
why this is I say this is like events
awesome so if you see a fairly you know
common concept to many people it's just
fast forward onto immediate I can also
say dispatch a whole new action let's
grab this one and then we need to do a
new date 2017 of the 816 and let's make
this 14 actually yeah we're 14 2000 now
if I hit dispatch we've just gone back
in time
so we've round the clock backwards
because we've just like that
basically what Redux is doing or our
application is
going dispatching this action it doesn't
care that this is supposed to be a clock
and especially going forward so we can
quite easily do that I can also turn off
points in inside of this so if I come on
skip that one
so if I've removed that from the list so
now this is what the application looked
at that previous point in time forward
backwards this is what essentially what
Dan was presenting at the react au cough
was in the concept of time travel
debugging I can rewind and replay him
play forward my application see what's
happened I also do things from these
tools like I could export all the
actions the what the what the values of
those actions were what the state was at
that point in time to a JSON file and
let's say that I've got an application
it's in UAT
manual Chester has gone through and
found a bug or it's in production and
someone's found a bug we've got this
running or we've got this available we
can download the JSON which represents
every action that's been done you can
create a test open up that JSON file
pull each step out pull each action out
dispatch dispatch dispatch dispatch all
the way through and then assert on the
end we give them a cert fail because
we've got a bug in our application I can
fix it my test now passes based off of
how the user actually got to the point
in time that they did it that to me when
I realize you could do that was kind of
like the mind blowing pointers like this
is so powerful I I can quite easily get
a regression check that in write a tear
of write a test check that in and avoid
having that regression problem to come
up again in the future because I'm able
to reproduce everything that the user is
done via I would observe and this isn't
required for observables this works with
redux
just plain so I could put that back into
the console example that I did early on
I can connect this up to an angular UI
backbone UI and knock out UI a react UI
all that kind of stuff
it's very easy to plug in and then we
can just you know this dev tools just
what is just running observing and I can
do all kinds of interesting stuff so I
can say like this is the state of the
application it's
it's currently stopped it's not try and
draw the clock the previous time was
that the current time is that quite
powerful and this saves a lot of time
from a from a developer's perspective I
know I like the fact that I can just get
an actual repo not uh yeah here's a
couple of screenshots well what did you
do yeah I'm gonna have to see if I can
try that again we've all been there
we've all been back and forth with a a
user or a test or a colleague of it
worked on my machine
thanks sure it did I trust you okay so
that was observables with redux and also
how we can combine that with the redux
dev tools and how we can use the redux
dev tools to sort of monitor what's
happening with inside of our application
and you know get get the power of the
insight that that can give us so what
about redux without JavaScript and one
of the things I said that we need about
an action and this is why when I was
doing my implementation of redux I
started thinking about it was well
because we have a loose type system we
have to rely on a property called type
and that's that's how we do do it what
if I was doing it in a language that had
a type system like F sharp because F
sharp
I wanted to essentially set myself a
proper challenge and and write this in
there in F sharp so I had a crack at
rewriting this in in Don in F sharp
because I was trying like all the stuff
we've said and all the demos that people
talk about is it's all in browser UI's
well could we use Redux on the server
and not in the browser like could we
represent state because it really
requires it's like you use the state
essential or it's application state well
what if we want an application state to
be on the server
I'm just gonna like full disclosure this
this wasn't the first time someone
written Redux and on there there's like
a c-sharp implementation if that's more
your cup of tea then but I thought I'd
have a crack at writing any an f-sharp
because I like to give myself a proper
challenge if you're not an f-sharp
person or you haven't used the f-sharp
yeah don't don't concern yourself too
much with the the language of the syntax
so stuff like that this is more of kind
of I will astray ting the pushing the
boundaries of what you can do as a
design pattern so I create a couple of
types to represent middleware the
middleware API and the store and stuff
like that have a thing that completely
broke my brain when I'm trying to do a
whole bunch of fallbacks
and stuff like that I then created this
enormous type definition along here
which is basically the same generic
argument being passed about five times
in a row and that just that hurt to try
and write also because I'm not
particularly good at F sharp but here's
our create store function the full
implementation is 53 lines of code for a
type safer implementation of redux I
thought that was kind of cool I thought
that was oh yeah we had many lines in
JavaScript I've managed to shave almost
20 lines out of that and a bunch of that
is type definition it's cool so this
works is it's a recursive function
because when you provide middleware you
either create the store with middleware
or you created this all without a
middleware when you create a install
without middleware you actually create
this sorry when you create this tool
with middleware you actually first
create this all without middleware and
then add them then recreate it with
middleware over the top and we replace
the dispatch function with all the
middleware chains so in F sharp I have
to create a recursive function to
achieve this so that it works and
JavaScript that's obvious a whole bunch
a bunch of simpler I had to break only
one kind of rule in F sharp about
nothing should be mutable because well
somewhere data has to change so we do
have mutable data and a mutable
collection of subscribers is that those
I tried to do as much immutability
inside of this as possible
and I was like okay cool everything that
what am i doing with it now well I'm
trying to do something server-side so
I'm gonna write a chat application I've
got to demo up here of a chat
application Rindy an f-sharp the user
signal R as its as its chat protocol
essentially cool so that's up and
running let's open up a chrome instance
it's closed off these tabs that I don't
need anymore localhost of 5,000 and my
name is Aaron cool let's just dump that
up touch then I'm gonna create another
tab over there and we'll connect to
another localhost instance and we'll
call this Richard and then I'm gonna
create wine you know a different browser
whoops
where'd my browser go there it is it's
just resize that one really doesn't help
when the browser wants to resize itself
off screen on I want you to small down
here alright we'll come back to that
browser and remote and we go awesome
talk and because that's what rich is
going to say after this so so this is
anything back and forth because well
these are just dumb clients and our
state is on the server so that's that's
pretty neat thanks Richard now if I was
to reload this browser and I'll just
connect back as Aaron because state
exists on the server and not in the
client
it just goes well here's the current
state of the application when you
connect and I get back my chat history
suite that's kind of neat
it also introduces some other
interesting quirks
let's connect another one and because
well names don't have to be unique we'll
connect another one called Aaron now
here I also have my history because I've
connected and that's the current
application state the way that it works
is that every key press sends a action
back to the server because if you if you
close the tab you
you come back you want to be able to
connect as the same user you want to be
able to pick up where you left off but
if you're ever in two tabs is the same
user you know isn't and they both have
values in them because it's just the one
application State hey we're we're now
for sitting everything server-side and
as I type into one well anyone that's
also listening on the same unique user
key it will you know it's it's all
connected and it's just the same
application anyways well Aaron's typing
stuff here which means whoever is Aaron
is also saying all of that yeah um
that's something that you've obviously
got yeah that is that's true that's more
like a normal conversation than Richard
I would be having and then you know
they're just like someone would just
fall over i but kind of silliness aside
in terms of like we're doing a chat
application that's got this weird
internal state why what would a dotnet
implementation be useful for examination
building something on the phone doing a
win ten applications hololens
application something that has like a
single user context to it maybe you're
building over like a really complex like
server job that runs it's got some
application state that needs to track
over time you have one place where that
data lives flows down xamarin
applications or mobile applications and
desktop applications they're kind of
what I say is the kind of the core use
use case for this I said there's a
there's a better implementation or
probably a proper implementation out
there on you get mine lives in in a
github repo because I wasn't going to
inflict it entirely on the world but
oops wrong button
hey internally it works the same way as
we would use anything else so we have a
not that file we have a signal our hub
to get started when it gets started
oh wait sorry I gotta fine I got AB in
the correct file if I remember where I
put that it's this one
just click randomly in files until I
find the code that I'm after so we
create a store it actually has some
middleware inside of it that when a new
user connects it will pump out and say a
user has joined the conversation so it
does that it actually dispatches a new
action from the middleware I don't think
we saw that because I didn't have enough
unique users joining we set up some
initial application state which has got
no users connected there's no current
message and current message is being
written there's no users that are
currently connected but you could like
have it you to create an it's
automatically got a couple of different
users because you've hydrated that
information out of a database we have a
reducer that sits up here that just uses
the the power of a full type system and
not JavaScript to do things like pattern
matching depending on which actions
being dispatched we're going to invoke
different things we're going to do stuff
with the states and whatnot
when you connect a signal our hub all
it's going to do is it gets the store
and subscribes to that so any changes in
the store we're just going to push that
out to the currently connected clients
it exposes a dispatch method which we
actually call from the within side of
the browser so we call the signal our
dispatch method on the server I'm not
going to go too deep into the signal but
that's how that all works and we
dispatch a bunch of different actions
against that so that's how you could
implement a like a server-side
implementation or a dotnet
implementation of redux in F sharp as a
console application cool that sounds
like a use case that I'm sure that
everyone in the audience has
that's Redux in a nutshell that's how
you can use Redux without having to rely
on react we can add it to any web UI
that we're looking at or even non web UI
is just anything that might have a some
kind of a UI associated with it or if we
really want to stretch ourselves we
don't even need a UI something that is
just a stateful application to me like
when I realized like all that stuff
comes together and that it was
essentially just an event sourcing that
was the you know mind blown
sort of moment I'm Aaron Powell that was
Redux beyond react thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>