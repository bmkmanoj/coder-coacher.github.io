<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Modular Javascript #2 - Converting jQuery to an Object Literal Module | Coder Coacher - Coaching Coders</title><meta content="Modular Javascript #2 - Converting jQuery to an Object Literal Module - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LearnCodeacademy/">LearnCode.academy</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Modular Javascript #2 - Converting jQuery to an Object Literal Module</b></h2><h5 class="post__date">2015-07-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/m-NYyst_tiY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so this is the second video of a modular
Jas tutorial series and you definitely
will want to watch the first one if you
are not familiar with the object literal
pattern or what a JavaScript module is
we're basically going to convert this
jQuery what I call spaghetti code into a
module that makes more sense that you
can look at and kind of really quickly
see what's going on and it's going to
work together a lot better with any
future code we have this is not it's not
like this is the end of the world but
imagine if you had 50 times this and
it's just jQuery function after jQuery
function all just splattered onto a page
that's just a pain or honestly even if
it's just this file looking at it you
can't immediately tell what's going on
you have to actually read through to see
what's happening and there's much better
ways of organizing that code so let me
show you what kind of module I got here
this is that people add or let me show
you the HTML for this let me add a
couple people so I have a div with ID of
people this is kind of my wrapping div
for the whole thing
I have an h1 inside of it probably not
necessary I have an input I have a
button and then I have a UL the UL is
basically just has a bunch of allies in
it for each person and so then here's an
Li for each person it has a span and a
delete button in it that's it I'll show
you my actual HTML on the code here's my
input button ul now instead of a bunch
of lis the Allies have to be dynamic
they have to be created so I created a
script tag with a type of text template
and when your browser sees this it does
nothing it's not JavaScript it doesn't
do anything with that so then I can code
any HTML in there that I want and then I
can get that out and it's basically a
JavaScript string which is what I'm
doing here ver template equals let's go
find that element and get the HTML I
could do this instead I could do all
that mustache stuff here that that weird
stuff that you're seeing that's mustache
J s so if you're not familiar with
mustache or templating well you'll get
an intro to that here so for each person
in my people object or for each item in
my people array I'm going to create an L
I and I'm just going to add the value of
that in there so that's basically what's
going on there and that's mustache so I
could code it like this but it
pretty limited you don't want to add
much more than one elements otherwise it
gets a big messy string and you don't
see the pretty syntax highlighting and
then I'm putting HTML in my JavaScript
and it's just that's not a very good
practice you want to kind of avoid that
as much as you can so here my HTML is
still in my HTML I just have to get the
template out that's a good way of going
so I just had to at least mention that
for people who are not familiar with
what mustache was so let's go ahead and
convert this spaghetti code into a
module so starting off let's just create
we'll just call it people equals and
we're just going to create our object
and then our people array can live on
the object so I could go people is an
empty array and then my template can
live here as well the template can live
yeah let's just snatch it out for now
there we go so now automatically just
kind of incorporated my people and my
template into my object and what's cool
about that is I no longer have these two
global variables yippee I can get rid of
you now a simple way of getting rid of
global variables would be to wrap this
in a self-executing anonymous function
there we go so I just created a function
and I can have it execute itself so if I
were to actually put this down here if I
were to wrap this code in a
self-executing anonymous function that's
kind of one way to get around it let me
move this down here now where people is
scoped to this function so it's not
global anymore this isn't global anymore
if I do very temperate outside of that
function blah blah blah then this is not
overriding this so that's kind of one
quick and dirty way that you can at
least get rid of global variables it's
kind of a module but it's a spaghetti
code module still so we've got that so
that's that gets rid of global variables
but it doesn't really give us better
coding practices and once again most
times you're going to have more code
than this so these are just my two
functions that I'm using to illustrate
module or JavaScript so then I'm going
to go ahead and have an init function
and it stands for initialize or
initialization and in it's kind of
to be how we kick off our module so what
we're going to do is let me comment out
all this code is we're going to define
our people module and then we're going
to run people dot in it and you know
what I'm also going to do I'm also going
to keep this people module wrapped in
this anonymous function just so there's
still no global variables we don't
really need a global variable for people
and so now this ver people is not global
either yippee so we've got people our
object defined and then we're going to
run people in it and so that's going to
run this function that kind of gets
everything kicked off so let's kind of
start addressing some of the issues and
our ground rules let's take on this one
efficient Dom usage I do not like that
there is Dom getting searched here Dom
getting searched here Dom getting
searched here so we're actually going to
do is we're going to cache Dom at the
very beginning so let's make a cache Dom
method and we're actually going to find
some things will go this dot e l equals
people module and so basically we're
just finding people module and then
we're saving it now it's on our object
and whenever I store a jQuery wrapped
object then I always like to add a
dollar to it instead of just calling it
vicio let's call it this dollar L so I
know that that's a jQuery search and I
can do all the jQuery things on it like
show/hide toggle slide you know all that
stuff so let's see what else do we have
to do we have to find that button so I
can do this button equals this DLC now I
can reference the CL I don't have to
search the Dom again I've already saved
it somewhere find button let's see what
else are we doing in here we're finding
an input so let's go and find an input
let's use some multiple cursors to do
that slick and fast there we go we're
finding you the inputs we're finding the
UL let's do that there we go and I think
that's it that should do it for now so
now we've saved a lot of Dom we only
have one of these going on in our whole
module that's
a good sign I only want to see one of
these green dollar signs so that's a
really really good thing I've got a
second one for my template so I guess
since my template is inside of my people
module I could actually forget template
here and I could actually cache the
template if I wanted to let's get rid of
that and let's do this template equals
that's not a dollar because this is just
going to be an HTML string dot e-l find
and then we're going to find that within
it and get the HTML that do it right
yeah that should have done it okay so
this template is now set as well so the
only thing I actually have going on up
here is people so then let's actually
create a render method render is the
function and the method it's very common
name for let's take the current state of
my module and let's let's commit it or
let's translate that into my HTML Dom so
let's take that javascript module let's
print it to this ul is basically what's
going on so this is going to be the
point in time where we take every person
in our people array and we're going to
create an Li out of that it's basically
what's going on here on this click on
this click method so let's go ahead and
what does this render method do I'm
going to uncomment this it basically
just takes all the people and it creates
a data object and then it does an HTML
dot HTML on our UL so let's go and do
that mustache render here so we're going
to go data equals there's going to be
this dot people so I'm making a data
object if you're not familiar with
mustache here's what mustache does you
just go mustache render and you give it
a template so the template might be name
or it's that maybe it'll say hi name and
then you're given an object that object
could be named will and it's basically
just going to take oh it's looking for
name let's find naming the object okay
there's name so then it's going to just
going to create a string that says hi
will that's basically what mustache does
it takes
you know values and spits them into a
string so in this case we're just going
to take our array of people is all we
need
and for each person we're going to spit
that value dot is basically
representation of the whole value of
what's in the array so for each person
we're going to spit out an entire Li so
that's what's going to go on and we can
just go this dot ul we've cashed that up
here so you don't need to search the Dom
for that this ul HTML we're going to
render this dot template since we've
already stored this template and we're
going to put the data in there so that
should work so let's go ahead and maybe
add a start up person maybe we'll and
Laura and let's say on an it we're going
to cache the DOM and then we're going to
render so what kind of render right away
let's see if that worked yep we got two
people will and more button does
absolutely nothing because we haven't
programmed that in so I could also say
we'll and Steve and there we go we have
we'll and we have Steve excellent so our
app is kind of working so far already
it's a lot cleaner one thing that's
great about modular JavaScript is you
can look at it and each method has a
name so you can see what's going on
based off the name I know this is
initializing the module I clearly know
this is caching the Dom and I clearly
know this is rendering so ideally this
is going to be the only thing that ever
touches the Dom itself everything else
talks to this module maybe changes this
people array but nothing else actually
interacts with the HTML except for my
render method this is very clean so far
so I'm liking it so now let's make this
render on click on click we want to take
the value of our input push it on to
this people array and render again so to
do that we need to bind some events so
let's bind events and if you're if
you're new to modular JavaScript you're
probably thinking oh my goodness this is
way too much thinking I'm not used to
thinking this much when I code yeah well
if you're not thinking when you code
then that's kind of probably the next
step you've learned how to code now
let's learn how to think about how we
should code and it probably looks very
foreign to you because this is new
but if you write one or two modules then
everyone's going to have a cache down a
bind events a render so this is not
exactly crazy this is actually preparing
you to learn backbone JFS which is very
very similar to what I'm doing today so
let's do a bind events function I just
want to like give you that warning I
guess in case you thought I'm crazy and
I'm going to make your life miserable
and very complicated
so as you guess the bind events method
is for one thing and one thing only
binding events so let's go ahead and see
what do we do we are going to on the
click on the buttons click event then we
are going to add a person so let's go
ahead and make this dot input a note
button on click and we'll make an add
person function that seems like the
right name for it so add person there we
are because I don't want actually make a
function in here because now this method
has several things it's binding an event
listener and it's adding a person I
don't like that ad person this is only
responsible for binding events so
whenever the click goes we're going to
add the person over here this is also a
very good pattern you usually don't want
to write functions directly into an
event binding it's just not a good
pattern for a lot of reasons and I think
that's all it has to happen for now yep
so ad person let's go ahead and go we
need to get the value we're going to
push that right there I'll just copy
this in so this dot people we're going
to push the input value this dot input
bow there's going to be a problem right
here which I'll show you in a minute
this will not work correctly this will
actually have some problems so let's go
ahead and save this and test it out and
we'll see what my problems are let's go
to my console looking good let's add a
test app error this is not that it's
giving me all these weird things
something is not a function okay let's
go ahead and find out what's going on
here here
one thing that you got to know with
events whenever you're binding an event
the context is going to change so that
this value of AD person is no longer
going to be people so if you know
everywhere I'm saying this this really
refers to people this is people cached
um people doubt bind events people dot
render well when an event fires it sets
this value to be the item that the event
was bound on so this will equal the stop
button so this will be the value of
button inside of add person I can get
around that by simply binding it to this
and if it's confusing basically just
realize when you're doing modular j/s if
you want a method to always run in the
context whether this value points to its
module then you have to bind it because
as soon as it gets called from an event
listener from a click event the context
of this will change the value of this
will change and in our case we don't
want the value of this to ever change we
want this to always mean the people
module so in that case I'm binding it to
this this this this I know that's a lot
of saying so now it's going to work
add person dot bind is outside this dot
add person there we go
test and okay so it's adding it's kind
of working
we are now adding a person to the array
and then we want to render let's
rerender again so add it to the array
rerender let's go ahead check it make
sure it works test and we got a new
person test too awesome
excellent and you would also want to do
is I also want to clear the value this
dot input dot Val equals nothing so once
that renders I want to clear the value
of my name excellent so that was very
easy to do test two so now my name value
clears out every time so next up we just
got to delete our stuff so you see we're
getting a little bit more code we're
definitely getting a few more functions
going on but it's extremely clear if I
oh if I know that there's a problem
whenever my person gets added let's just
take this back out I'm not
clear this value let's say we've had our
to-do list working for a year and I have
to come into it a year later I've
forgotten most all the code but my
manager says well now I hate how test
stays in here this should always clear
when I add a person it should be empty
so then you just open this coding and
say ok on add person other go add person
well that's really easy to do you can
add in your line of code to add person
and you know everything else is
separated out and nothing's going to
break so that's the biggest reason that
modular code is a big win is because it
separates out your code I don't have to
worry about the module initializing I
don't have to worry about the module
caching the Dom or binding events all
that's happening I just want to add one
feature to when the person gets added so
I only have to worry about this piece of
code I don't even have to worry about it
rendering or any of that stuff so
modular code big big big win so let's go
ahead and get this delete event going on
right here and then we're done so my
delete event is a delegate event on the
UL if you don't know about delegation
I'm going to add a little bit to my
jQuery series in there so you can see
what delegation really is
so this ul is going to delegate to the I
delete click so let's go up we already
have in a bind events method going on
let's just add one more event this dot
UL delegate I delete click let's go
ahead and call this delete person so
when I class delete gets clicked we're
going to go up to that Li we're going to
find out which number we are are we
number 3 we're going to delete number 3
from our people list and then we're
going to re-render it's pretty simple so
once again let's go ahead and go this
dot delete person and let's bind this
same thing we got to make sure we bind
that so that was easy we were able to
just add one more event and now this
method is going to fire when we click on
delete person let me see if that works
make sure that's going delete hey always
fires oh and look that also tells me
people splice is not function oh that's
because I was wondering how that was
working all of a sudden
it's because I uncommented my codes let
me go ahead and comment that code bag
almost done here last method so this is
this is correct I want to keep this very
move this is the one that I want to
remove so I'm going up to my closest li
so when I click on here I'm going to go
up and find my closest li okay that's
this I want to remove that except for I
don't actually want to do it like this
no no no more HTML touching in the other
methods this is the guy that touches
HTML this guy does not touch HTML so you
go away I'm just going to call you
remove since I you're still actually
you're still a jQuery selection so I'll
keep you as the dollar signal and then I
want to do let's see I want to in ul
this dot ul I want to find the lis then
I want to get the index of my current li
so this is going to find out hey what
number am I the guy that got clicked and
my number three and my number two so
let's find that I that's the guy I want
to remove and then this dot people let's
splice it straight out and then let's
render again so basically everybody's
just calling render only boot up we're
going to render when we add a person
we're going to render when we do leave a
person we're going to render so here we
go let's see if it works will goes away
app he is not defined that's because I
didn't add a in there that's my event so
if I want to call it that it's a little
clear for people are not sure exactly
what's going on
let's reload it there we go there we go
all gone and my module is working so
this is a module this is kind of how you
do modular JavaScript and in the next
video whenever that comes out I'll show
you kind of how to do a revealing module
pattern so we only have maybe a few
things I don't really I don't really
want to expose cached all bind events I
don't really want to expose all these to
an API but it would be cool to do add
person delete person let me go ahead and
get rid of this let me make this global
again this ver people so now I kind of
have this API here I can go people dot
add person
so maybe another part of the program up
here wants to add a person to my list
well I can add a new person there we go
I added a person to the list except for
that didn't really work because I
actually have to send it a value let's
go and do something like this
let's go value or so if a values passed
in will actually do that if not we'll
look it up from the input that's pretty
easy so now I have this API going it's
called people add person there we go we
added Laura and now Laura can still go
away so that's kind of cool I can add
add a bunch of people so now a module up
here could actually talk to my other
module but I don't want them to be able
to call cash Dom I don't want them to be
able to call bind events I really just
want them to be able to call I don't
want them to call render either I really
just want them to be able to call these
two events so in the next video we'll
get into a revealing module pattern
where we only allow people to have
access to these two and all the rest is
internal because once again people can
hack this as well they could go people
dot people which is the array and they
could push something on there themselves
oh that's a bad pattern god but it
didn't render Oh crud so now what
happens so now I delete lor and all
sudden God shows up so that's that's not
a good pattern for people to be able to
automatically talk to to the pieces on
my module so again next up revealing
module pattern I'm going to stop you app
in for now</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>