<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DRASTICALLY IMPROVE YOUR WORKFLOW WITH CONTINUOUS DEPLOYMENT | Coder Coacher - Coaching Coders</title><meta content="DRASTICALLY IMPROVE YOUR WORKFLOW WITH CONTINUOUS DEPLOYMENT - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LearnCodeacademy/">LearnCode.academy</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DRASTICALLY IMPROVE YOUR WORKFLOW WITH CONTINUOUS DEPLOYMENT</b></h2><h5 class="post__date">2016-09-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RdOhgdnIhQI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we are going to set up
continuous deployment for our
application which is an incredible way
to improve development workflow in
productivity to pretty much any app now
a continuous deployment means is that
whenever we merge to master or push code
directly to master that's going to
automatically get deployed out to
production if we set up other branches
like a staging branch whenever we force
push something to staging or merge
something to staging that'll
automatically go out to a staging
environment automatically get deployed
all the time it's a great way to manage
your deployments you merge it to master
it's out on production so masters always
in sync with production and so to set
this up will be pretty quick and easy
we're gonna use semaphore CI to do it
which is very fast very easy to work
with
and you can follow along with the readme
here now we're going to give you two
examples in this video we're gonna show
you how to do static content which is
HTML CSS and JavaScript so for that I
have this sample index.html which just
says hello world and when we make
changes to this that will automatically
go out they'll also also show you how to
do it for web applications like nodejs
or something else that requires kind of
some startup commands when you actually
push the code to your server so here we
go let's go and get started our first
step is we're gonna create an SSH key
that's gonna allow semaphore to securely
connect to our server and run some
commands there so let's go SSH key gen C
and you just give it some sort of
identifier I'll just say semaphore and
then we choose where the file is so I'm
gonna call that exactly this folder here
that they want and then I'm just gonna
call it ID RSA dot semaphore oh it's
unique key and I'm not going to use a
passphrase that's important so this
created ID RS a dot semaphore and ID RS
a semaphore dot pub so let's go ahead
and copy the contents of that public key
we can use cap for that ID RSA dot
semaphore dot pub we're gonna pipe that
to pb copy there we go now it's copied
to our clipboard and now I'm gonna go
ahead paste that off-screen so we have
it
and we can go ahead and ssh into our
server root and i'm matt is 45.5 5.15
3.2 to 9 so now we're in our server we
just need to paste that pub key into
authorized keys so we can do this really
easily we can go echo and then paste it
there's the pasted and I'm gonna close
those parentheses so I basically wrapped
it in parentheses two arrows so I'm
going to append it to the SSH authorized
keys file so I now appended that in so
if there were any authorized keys I
didn't erase those or you could just
edit this authorized keys folder and
paste the file and paste that in
yourself however you like to do it so on
this server right here let's go to the
IP address you can see it says 404 not
found I'm running nginx and it's set up
for static HTML content which means that
it's going to look in the USR user share
nginx
HTML folder and of course I have a type
of there so if there were an HTML folder
here that would be my HTML website I can
make that directory
I could echo a file in there let's say
okay so let's make index.html whoops
I save that in the wrong folder let's go
to echo HTML let's put in the HTML
folder there we go now we have an HTML
file index.html and it says okay so any
changes to that index.html well real
time be changed on nginx
so I'm going to do is I'm let's go to
remove that HTML folder and let's clone
our repository straight on in there now
if you are doing this and this is a
private repository you couldn't just get
clone it you'd need access somehow so to
get access you simply go to your
settings and you add a personal access
token you can generate a new token let's
call it semaphore token give it access
to our private repositories now that
token can be used whenever we're cloning
I could copy and paste that but I'm not
going to use it because this is a public
repository everyone has access to this
I'll show you in a minute how
you would use that token so now all I
can do is I can go to the cloner
download and you'll want to use not SSH
you'll want to use HTTPS so that's
important let's go to copy that and now
I can get to clone that's into the HTML
folder and if you had a token if this is
a private repository you put that token
there or whatever that token is at
github.com so token at github comm and
you'll have access to your private
repository so let's go to clone that
boom that's done now if i refresh my
site
hey there's my hello world which is
index.html so now what semaphore CI will
do is it will whenever changes happen on
master
it will SSH into this server it will
tell git to force pull down the latest
of master if any changes were made on
the server at all it's going to
automatically overwrite them and I have
those commands right here in this one
file called deployed SH we're gonna CD
into this folder we're gonna fetch all
and we're gonna reset hard to origin
master simple enough
so basically semaphore is just going to
SSH into the server and run these three
commands whatever's in deploy SH will
get run so let's switch gears go over to
semaphore and get that going and that'll
be really really easy so let's go to add
new project we'll pick our user and this
is called example deployment example
deployments will build off the master
branch and this will take a minute to
just analyze my project real fast there
we are now I noticed the nodejs code in
there because if you remember I have a
node.js project in at the same time
that's okay all I have to do is say no
we're not going to run npm install we're
not going to do that setup now if
there's a node.js project or a project
with dependencies this would be where
you'd run the dependencies command which
in this case is npm install i said
cancel go away thank you
and then npm test would normally be what
you do to run test cases on no GS we're
not going to do any of those so let's
just go echo ok and save that since this
is just an HTML file we don't need that
but that's where you change your know
Jayesh settings we can go ahead and
build with these settings and then there
we go
it's gonna automatically run the build
that's gonna be simple enough that's
gonna build it's only gonna take about
eight seconds because we don't have any
test cases that we're running that's
gonna happen really fast while that's
going let's go ahead set up deployment
now so I'm back on my project and let's
set up our deployment we're gonna scroll
down and do a generic deployment and
we're gonna do this automatically so
every successful build if it's on master
it's gonna go out this is going to build
on the master branch and what are our
deployed commands we're gonna paste
these to which I have in the readme
we're going to say hey allow us to SSH
into this server which this will change
to your IP address or your server name
your domain name I'm in same right here
we're gonna Sh SSH in and we're gonna
run deploy sh so whatever changes in
deploy sh we don't have to ever change
our continuous deployment setup and then
we just need our private SSH key which
is that IDRs a dot semaphore not pub
semaphore so let's go ahead cat that
we're gonna PB copy that
that's copied to the clipboard let's
paste it in there we go that's our
private key now it's semaphore we'll be
able to SSH into our server let's just
call this prog almost call it production
create that server and let's go ahead
deploy boom let's let's deploy
index.html here or deploy all of that
straight out
it's setting up our environment and
that's going to run our to commands and
we will actually have a continuous
deployment going there we go command one
ran and command two ran and it worked
but you notice there's no changes let's
go ahead make a change to index.html and
see just how long it takes for this to
actually end up in production here we go
I'll just go edit it hack it in straight
here in github x' user interface let's
add some exclamations say I'm feeling
emotional today there we go
i merged that let's go back to semaphore
CI and see what happens you can see
there we go
a build is already queued up that's
gonna start building here any second and
then it's gonna deploy once that build
is successful while this is going on as
well I think it's important to note that
seven for CI gave me a coupon for you
guys it's not a kickback coupon I don't
really get anything from it but I told
him I was doing a video and they said
hey here we'll give all your viewers a
coupon so I'm gonna throw that coupon
down into the description so that way
you can actually save some cash if you
ever do need to use the the more premium
features of semaphore CI with your
company again that's in the description
thanks to them for that and there you go
the deploys already going out you can
see that it's deploying and it's
deployed do we have the exclamations
absolutely yes we do that's excellent
now one thing worth pointing out is if
you were doing nodejs
let's go over to no js' there's a little
bit more that you have to run you don't
simply do a get pull you also have to
start up your server I'll go to my
editor here you don't just do a git pull
you actually start up your node.js
server probably run an NPM install so
the actual script looks something a
little bit more like this for a node.js
application not much more complicated
let's CD into whatever folder my app is
in let's get fetch get reset everything
let's maybe do an npn vm install if you
use nvm to manage your node version
let's run an NPM install then and let's
kick off the app whatever you use to
start your app in this case I'm using PM
to so I'd stop the app and then start
the app and that's the only difference
this will totally work for an ojs
application as well so as you can see
integration continuous deployment not a
scary thing works really really well
probably the biggest thing you have to
get used to is when you're doing pull
requests you merge them down to master
they go out if you have a mistake and
you have to roll back roll back normally
you're like okay let's push out that
code and trigger the deployment manually
well in this case you just revert the
pull request merge it to master and then
you essentially just did a roll back you
did it completely in github every pull
request can be reverted with a click of
a button and github and so that's kind
of the mental process you go through
with reverts and quick roll backs when
you accidentally blow stuff up that's
usually the thing people are the most
scared of with continuous deployment is
what do I do when I have to roll back
quickly
well you just make another pull request
to merge it to master it's really simple
and it's awesome it's so nice to not
think about having to manually trigger
deployments anymore
so that's continuous deployment in a
nutshell hope you enjoy the video have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>