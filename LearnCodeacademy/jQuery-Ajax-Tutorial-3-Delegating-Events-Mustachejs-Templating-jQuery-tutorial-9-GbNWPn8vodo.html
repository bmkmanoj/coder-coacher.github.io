<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>jQuery Ajax Tutorial #3 - Delegating Events &amp; Mustache.js Templating (jQuery tutorial #9) | Coder Coacher - Coaching Coders</title><meta content="jQuery Ajax Tutorial #3 - Delegating Events &amp; Mustache.js Templating (jQuery tutorial #9) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LearnCodeacademy/">LearnCode.academy</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>jQuery Ajax Tutorial #3 - Delegating Events &amp; Mustache.js Templating (jQuery tutorial #9)</b></h2><h5 class="post__date">2014-06-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GbNWPn8vodo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right here we go with our third and
final jQuery AJAX tutorial our our app
is in the place where we can now load up
all the orders when we arrive and we can
add new orders Lauren wants a latte
there we go so we can add new orders we
can refresh our app and our orders exist
because they're coming from the backend
so we need to do now so we need to add a
delete button so we can remove orders
and we also want to fix this right here
this is kind of a messy hacky way of
piecing together a string in order for
us to build out a template it works
totally fine with something this small
but if we want to add three or four
elements and a lot more markup that's
going to be messy really really fast so
we've got to do a better way of doing
that we're going to use the mustache j/s
templating engine so let's go and add
mustache JSON to our page done that's
easy and let's go ahead and create our
template all in all the template is is a
string and so we can go li name and then
what you'll do is double curly braces
anytime you want to insert a value so
instead of doing order - name we are
going to pass order into our template
and we can do name right there and so
it's going to look in order for the
value of name and spit it out right
there and so that would be the same as
order drink so that's our template for
what we have right now let me close that
Li tag and let's go ahead instead of
doing this we're going to go mustache
dot render and you pass it two things
you pass it your template and then your
object of values so we're going to go
order template and then we're going to
go order which is our object right here
which has all our values in it let's go
ahead and refresh and it should look
exactly the same excellent no change at
all but what we've done now is we've
given ourselves the ability to add a lot
more complicated templating to this and
so what you can actually do is a sneaky
way if you have a template that's not
too big and bad you can build it by
adding a bunch of plus signs and as long
as you start off with an empty string
you can do new line breaks so I'm going
to go L
I I'm going to go strong actually do a
paragraph P strong name is my name there
you go and I'll add some more do another
paragraph strong let's capitalize those
and I'm also going to add a remove
button and this is actually a pretty
annoying way to do a template this big
there are many there's grunt plugins
there's a lot of ways to make a better
template that's in an actual HTML file
and import it in and use mustache to
render it but for now this will this
will have to do for our example let's do
a button and we're going to go data-id
we want to print the ID and i'll show
you why in a little bit ID there we go
so let's put an X here in this button we
could style that a lot better with CSS
but we don't have to for this video
let's give it a class of remove let's
call it remove so there we go let this
should work fine now and now we have our
larger order and we have our X button
which CSS should put over there or
something but whatever it's good for now
and when we click this we want it to
remove it so let's go ahead and look at
our back-end teams update and it says to
delete an order just send a delete
request to API slash
orders slash and then your ID of your
order that you're wanting to delete so
that's why we're printing this ID here
let's look at what HTML we're actually
creating is we're adding a paragraph tag
with named paragraph tag with that and
then a button with the ID of 3 and a
class of remove so now we can do
click or we can do on click I like to do
on click I feel like it's more
consistence on our click function we
simply want to do Ajax
type is delete and then our URL is going
to be API orders and then + now I can
get the attribute out was that data ID I
think I was calling yep data ID I can
grab the data ID so this will be if I
click here on ID number one it'll be API
slash orders
slash 1 so that's grabbing that
attribute out and this will not work and
I'm going to tell you why so here we go
I'm going to do this and I oh
something's broken I probably have
something bad in my code somewhere
unexpected token on line 58 oh yeah
there we go got that ok so this button
will not fire any requests let me show
you let's go to the network tab click
this all I want and no requests are
firing why are no requests firing this
is one of the most complicated things to
figure out if you're new to JavaScript
and jQuery is I have the selector right
I have this remove selector correct but
when I'm firing this when I'm running
this JavaScript there have not been any
things added to my page yet because my
page loads up with no orders my page
loads up it starts a get request that's
in process let's go get the orders
remember I said it's asynchronous
JavaScript and XML it's asynchronous
meaning it doesn't block your code so it
starts that get request and then it
starts these other things going and then
it looks for all the remove items and it
tells to listen to those but there's no
remove items added yet those are going
to get added three or four milliseconds
later on this success function so how do
we make it listen to the remove items
that aren't there yet what we do is we
listen to a click on remove items within
the parent
tanner so my parent container is my
orders ul and I've already cashed that
right here orders equals that so what I
can do is instead of listening to remove
I can listen to orders ah and I instead
of on I'm going to go delegate delegate
remove click so this is going to listen
to any click events on the orders thing
and it's going to only fire if it's a
part of a remove class it's going to
listen for any clicks on any remove
elements to come both now we're in the
future and it's going to fire them all
now our JavaScript will work if i
refresh let's refresh there's my get
request this should fire a delete
request there we go a delete request to
API slash
order slash one and now this is still
there but if i refresh my page my order
is gone awesome so now we need to do is
on success of that we need to remove
that element okay so you'll notice a
couple of my items are gone it's because
I had a code error and I needed to fix
it real quick but what we need to do now
is we need to delete these items from
the list
once our delete request is successful so
we need to hit the X it makes the
successful delete request to the back
end and now we need to remove this from
the list so we don't have to refresh our
page to see our changes so what we need
to do is we need to on success we need
to get the parent Li from this button
that was clicked so I can store that
here this closest li so that's going to
start going up the chain until it finds
in Li it's going to be this button it's
going to go up then it's going to grab
it really quick so I've stored that and
now on success
I can go li dot remove let's see if that
works
refresh yay it's gone and it's gone lets
out a new order
let's add that let's add a few more
wheel coffees refresh make sure they're
there make sure they all go away it's
gone let's refresh it's still gone
it's gone and it's gone let's actually
make that a little cleaner let's go Li
fade out 300 and then I'll call back to
that fade out let's remove it there we
go let's do that add s'mores again ah
the fade-out
oh the fade-out much better so there we
go we have built a complete application
now a few things that I need to specify
that are very very very important is you
cannot use this inside of a success
function let me tell you what I mean is
see how I did this closest li if I did
this closest Li in here that would not
do anything because this no longer
refers to the remove button that was
clicked this now refers to the Ajax
operation that is in progress so what I
actually have to do here is I have to
grab the Li up here I have to refer to
this at when I'm inside of this function
and now I can pull the Li here if that
made sense I have no way of knowing
which element I'm in when I'm inside of
this and when I'm inside of the success
function I cannot use this to find out
the element that was clicked I have to
use this when I'm in here and now I can
store it as a variable and then I can
access it later on if you need to use
this inside of success the way you do
that is you go by yourself equals this
and so now I'm saving a reference to
self calling it this and now I can do
self so it's accessing a variable it's
going to look at my scope and find a
variable if it looks for this this
already exists inside of the Ajax item
so it's going to pull the wrong this if
I do self there is no such thing called
self yet so it's going to start looking
up my scope and it's going to find
something called self which refers to
this
I know that was a tongue twister foria
but that's why I did it the way I did it
right there
it's a scoping issue it's one of the
trickier issues of JavaScript I really
need to do a whole video on it but this
is about Ajax so I'll leave you where we
are have a great day and good luck a
Jackson</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>