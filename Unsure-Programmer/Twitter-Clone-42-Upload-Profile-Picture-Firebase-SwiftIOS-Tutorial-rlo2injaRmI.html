<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Twitter Clone - 4.2 -  Upload Profile Picture - Firebase + Swift(IOS) Tutorial | Coder Coacher - Coaching Coders</title><meta content="Twitter Clone - 4.2 -  Upload Profile Picture - Firebase + Swift(IOS) Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Unsure-Programmer/">Unsure Programmer</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Twitter Clone - 4.2 -  Upload Profile Picture - Firebase + Swift(IOS) Tutorial</b></h2><h5 class="post__date">2016-08-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rlo2injaRmI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in the last video we had set up the
layout of our profile tab which is the
me tab here in this video let's go ahead
and set up the code required for the
parts to work so let's begin I just want
to start by showing you the final
product that we'll have at the end of
this video so coming to the me tab you
can see it's trying to load a profile
picture it loads a custom profile
picture of the user the users name and
the users handle is showing up from the
database we can select the image view
the picture will show us the bigger
picture
you can select the image click on photos
select a different photo and upload it
in displace the image there and it shows
that it's uploading and the image will
upload into our database and storage so
let's start with the logout button let's
create an action for the logout button
and call it did tap logout of type
action connect it will basically sign
the user out from the firebase
authentication system and also move the
user back to the welcome screen so for
that let's first import firebase auth
the code we need is tri fi r auth dot
dot sign out then we need to move the
user back to the welcome screen for that
include a reference to the main
storyboard of type UI storyboard and
we'll say name would be main and bundle
is nil
the last credo reference the Welcome
storyboard let's call it welcome view
controller UI view controller is equal
to main story born not instantiate view
controller will identify identifier name
will be welcome view controller then we
do self dot present view controller pass
in the welcome view controller that
which is created animation will be true
and
don't need a completion call max we call
that nil come here to the welcome
viewcontroller
and give it a storyboard idea of welcome
viewcontroller that's the storyboard ID
that we passed in here and let's run
this it should work
coming to the me tab let's tap log out
and then we're taking to the home screen
and the user is logged out we can see
that by the permission denied messaged
over here next what we do is we get the
data of the user from the database and
display his name handle and profile
picture and also the about date of the
user with the user has stored any data
so let's begin
so that will first import firebase
database and import firebase storage
let's create outlets for these things so
first control drag from the profile
picture let's call this profile picture
the next will be the name handle and the
about field
let's create a variable called logged in
user of type any object and this would
store straw the logged in user once the
page loads also let's create a reference
to our database and a firebase storage
so if I our database tour data based or
reference to our storage death is equal
to fi our storage or storage tour
reference in the viewdidload
let's store the currently logged in user
into a variable that we created the self
dot logged in user is equal to Fr auth
dot r dot current user and let's get the
data from the database it's a slightly
bigger and say self dot database ref dot
child go into the user profiles node dot
child under the self dot logged in user
dot u ID not observe single event of
tight value and in the with block it's a
snapshot of type fi our data it snapshot
in the code let's set self dot name dot
text is equal to snapshot dot value name
dot sorry as string and self dot handle
dot text equal to snapshot dot value
handled as string now initially the user
will not have and about data so we say
if snapshot dot value about not equal
equal to nail then
sati about X equal to the snapshot value
about as string otherwise we leave the
data as a default about text also in the
beginning we user will not have a
profile picture so we'll check if
snapshot or value profile pic is not
equal equal to null only then set it
it's a let database profile pic equal to
snapshot value profile pic as string and
we'll say let data equal to NS data
contents of URL will say nsurl from
string and it passed in database profile
picture because the URL is stored in the
database as a string so we get it for as
a string and then we convert it back
into and is data by using this line of
code over here and it force unwrap the
profile take then we say self dot set
profile picture
your profile picture I will say image to
set UI image of type data and it passed
the day time we have to still create the
set profile picture function so let's
create that let's come out of the bottom
and let's say internal function since we
only want this function to be accessed
from inside the class set profile
picture and the first thing we'll say is
passed the image view where you want to
set the picture and secondly pass the
image that you want to set so that will
be of type UI mhm and we say image view
dot layer dot corner radius equal to 10
so that we can put a corner radius to it
it's a image view dot layered border
color equal to UI color not white color
dot cg color to give it a white border
it will say image view dot layer dot
mask to bounce equal to true and we say
image view dot image equal to and
finally pass set the image to set so
coming back here we've passed in the UI
image view here we passed in the UI
image data here and we do just force
unwrap this as well so this will set the
profile picture for us before we try
this out I just want to show you a
database once coming to a database you
can see we've gone under the user
profiles tab under that mean gone at the
user IDs tab they get the user's name
and handle as of now we do not have an
about node or a profile pic node because
we haven't uploaded that data to the
database once we do that we'll be able
to see those as well so let's just run
this out we should at least see the
user's name and the handle coming up
going to the me tab you can
see that the name of the user has come
up and the handle has come up now let's
have the code required for the user to
select a profile picture we look for a
tap gesture recognizer here
drag it onto the profile picture from
the tab gesture recognizer control drag
to create an action select action of
type UI tab just a recognizer and you'd
say did tap profile picture here will
basically create an action sheet which
will allow the user to either view the
picture select the picture from the
photo gallery or select the picture
using the camera so let's first create
an action sheet which I let my action
shape equal to a UI alert controller you
give it a title of profile picture and
say message will be select and default
style will be UI alert controller style
dot action shit then we have set up the
options that we need
so we'll say let view picture equal to
UI alert action title will be view
picture night style will be default and
we call this action and in that we'll
say let image view equal to sender dot
view as UI image view and it's a lat new
image view which will be the bigger
profile picture equal to UI image view
of that image view dot image and say new
image view dot frame is equal to self
dot view dot frame equal to the size of
the me view controller then we say new
image view dot background color equal to
UI color dot black color and the content
mode which will be equal to scale aspect
fit it's a new image view dot user
interaction enabled equal to true so
that we can dismiss the image of the
user tab set so that is a left at equal
to UI tap just recognizer target we self
action will be selector self dot dismiss
full screen image we have to set this up
and we'll use a new image view dot add
just a recognizer and it's a tap we'll
also have the sub
view to the view so the self dot view
dot add sub views and will add the new
image view now we have to setup the
function dismiss full-screen image so
it's a function dismiss full screen
image that with the sender will be of
type UI type just a recognizer and we'd
say sender dot view dot remove from
super view this will remove the larger
image from the view now let's also set
up the other options which is let photo
gallery equal to UI alot action call
this one photos type will be default
again action and in the code will say if
UI image picker controller dot is source
type available so Skype will be saved
photos album now what we need to do over
here before we do this is you need to
add the uiimagepickercontroller delegate
and the UI navigation controller
delegate for this to work so let's do
that
it's a UI image picker controller
delegate and UI navigation controller
delegate we also create a variable for
the image picker so let's call that
image picker is equal to UI image picker
controller coming back here you don't
need this here come here with a self dot
image picker not delegate equal to self
and we will say self dot image picker
dot source type is equal to UI image
picker can
sauce dot save photos album and is a
self-taught image sticker dot allows
editing equal to true in case we want to
use allow the user to edit the image
then we need to just show the image
makers which is self dot present view
controller and that will say self dot
image picker animation will be true and
completion callback will be nil and
lastly we'll add the camera option which
will be let camera equal to UI alert
action title will be camera style will
again be default and handler will be
action and in the code will say if UI
image picker controller dot is so stripe
available dot camera self dot image
picker your delegate equal to self self
dot image picker dot sauce type equal to
UI image picker controller sauce type
dot camera and self dot image picker dot
allow editing equal to true and again we
need to show the image picker which is
self taught present new controller self
dot image picker animation will be true
and completion will be nil now that the
options are set up and again we don't
need this source type over here we need
to just add these options to the action
sheet and show the action sheet which is
my action sheet dot add action and wheel
add view picture
similarly my action sheet dot add action
will be photo gallery and my action
shaped dot add action will be camera we
also need to add in a cancel action so
let's do that my action sheet your add
action will say UI alert action of type
we'd say cancel style will be cancel and
handler will be nil let's present the
action sheet say my action sheet
animation true and completion nil so
let's try this out it should work going
to the me tab let's tap the image and
there we have the action sheet coming up
profile picture select it says view
picture let's view it there the bigger
picture has come up tapping it dismisses
the image if you go to photos it brings
up the photo gallery let's select an
image choose it as you can see the image
is not getting updated over here because
we have one last function to set up
which is basically called after the
image is selected also this camera
action will not work in the simulator
will only work on an actual device let's
add the last function that we require
this is basically the dude finish
speaking image method of image picker
controller so is a function image picker
controller did finish picking image
inside this we call the method that we
created set profile picture and in that
will add self dot profile picture as the
image view and the image to set will be
the image that is picked what we'll also
do is win upload this image to a
firebase storage and save the image URL
in
hobbies so let's do that since the image
is a UI image we've first converted into
metadata so let's do that
we'll say if net image data of type NS
data equal to UI image PNG
representation self-taught profile
picture dot image force unwrap that
let's create a reference to a profile
picture node so let's say let profile
take storage ref equal to storage ref
which was the variable we created in the
beginning not child go under the user
profiles tab inside that go under the
self tour logged in user dot UID tab and
under that store it under profile pic
then just upload the image say let
upload task is equal to profile pic
storage ref output data of type image
data inside that metadata nil metadata
comma error in if error in uploading is
equal equal to nail store the download
URL of the image and save the URL in the
database so we again call a database
available that will create it in the
beginning go on to the child's node
under that we'll say child self dot
logged in user dot u ID dot child you go
to profile pic set value let say
download URL and convert that to an
absolute
else if there was an error we'll just
print the error in our console for now
using localized description also to
indicate that the image is being
uploaded or added we will add an
activity indicator view on top of this
we'll add the constraints will say
Center horizontally create an outlet for
this call it image loader self dot image
loader not start animating and at the
bottom we'll say self dot image loader
dot stop animating this add two values
to it which is call it large white give
it a color of blue and behavior we'll
select animating and hides when stopped
and here at the bottom we'll put self
dot image loader and thought stop
animating after the upload task is
complete and I realize that we have to
add one more line of code here which is
soft or dismiss view controller animated
true the callback of nil which I've
added this earlier after the user
selects the image automatically that
image window should close and should
come back to a me time so this is what
helps us with that and let's finish up
the image loader by giving it a
different color let's make a large white
and give it a color of blue and also
we'll add one more property to it which
is animating and hides when stopped now
we're good to go let's run this out and
try it I'm into the me tab let's click
on the image first let's see view
picture as that is working let's select
photos now let's select this photo click
on choose the window closes the
set and as you can see the image is
currently being uploaded and the images
are floating let's go check in our
database and storage if we have the
image they're coming here we can see
that the profile picture URL s come in
here and let's go into storage we have
the user profiles tab like we set up and
under that the users ID and inside that
we have the profile picture which is
uploaded it's a high-resolution profile
picture as you can see even though I was
trying to keep this video short but I
realized that the video has become quite
long there are still more parts to cover
about the profile tab and thinking I'll
cover them in the next video so that you
guys can at least try this out to learn
so the next video will cover up the
About tab the about field and how to use
these tabs and show the users tweets
median likes over here and then when you
get on to the other parts of the
application till then you guys should
try this out and thanks thank you once
again for watching and please like and
subscribe</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>