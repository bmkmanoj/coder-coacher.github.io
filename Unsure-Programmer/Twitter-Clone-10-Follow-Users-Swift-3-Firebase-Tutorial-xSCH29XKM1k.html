<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Twitter Clone 10  - Follow Users - Swift 3 + Firebase Tutorial | Coder Coacher - Coaching Coders</title><meta content="Twitter Clone 10  - Follow Users - Swift 3 + Firebase Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Unsure-Programmer/">Unsure Programmer</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Twitter Clone 10  - Follow Users - Swift 3 + Firebase Tutorial</b></h2><h5 class="post__date">2016-10-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xSCH29XKM1k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so today I'm gonna teach you how to
create a Twitter like following system
using firebase and Swift firebase
basically uses a JSON database so it's
not as easy as it would be using an SQL
database so what we have to do is you
have to plan out the data and make sure
that we can retrieve the data the way we
want to display it so for this project
we're going to be using Swift 3 and
Xcode 8 the startup project is going to
be available in the link in the
description so what we have in the end
is basically a login system available
using email and password which will
bring us to the straight application
here if you click on this button over
here you'll be able to see the users
available once you click on the user and
you bring you to a page where you can
just follow on follower user so as you
can see I'm already following this user
I just unfollowed the user and our
database gets updated and if I follow
the user again a followers tab is
created a following tab is created and a
count of the followers is updated in the
user profiles also if we go back here to
the users profile we can click on this
following count and it'll show us all
the users that were currently following
and also if we click on the followers
tab we'll be able to see all our
followers for people who've been
following my tutorials we know that
we've created this application on
scratch so you guys can go and find
these store Orioles under the Twitter
clone playlist available on my channel
so let's begin the first thing we're
gonna have to do is we'd currently
embedded this find user table view
inside a navigation controller we're
going to get rid of this and we're going
to embed the whole view controller
directly into a navigation controller so
now we have the navigation controller at
the root which is how it's meant to be
and then we'll connect this controller
which is the home controller directly to
the find user controller so let's do
that and we'll click present modeling
and let's rename this segue
let's call it find user segue come to
the home view controller and will
override the prepare for segue method
you will set override prepare for segue
inside your it says if Segway tour
identifier is equal equal to find user
segue since a let show follow users
table view controller equal to segue dot
destination as follow users table view
controller so basically fitting a
reference to this table view controller
then we'll say show follow users table
view controller dot logged in user
create a variable called logged in user
and we'll pass in the currently logged
in user as a file user so you create a
reference to that table view controller
and passed in the data is giving us an
error because this variable does not
exist if you come here self-taught
logged in user is if I are on tour
current user so now let's go into the
following users table view controller
here in the follow users controller you
create that variable of type f-fire user
and we will also import firebase here
now that I rebels would have gone now
let's create a view controller that
shows the profile of the user so come
here draw drag a view controller place
it here and connect it to the prototype
cell and we'll say show also it changed
this segue from present model II to show
since it's under a navigation controller
so that way we'll come up nicely here
we'll just put in a label
call that label show user that's what
clear horizontally Center this
and also let's put in a button below
this will just call this follow just our
constraints for this and lets us create
a class for this view controller it's a
file new file cocoa touch class and
let's call this user profile view
controller come to the main story board
Inlet set the class for this
here let's control drag from the show
user label and call this name I will
display the name of the user and let's
just drive from the follow button and
call it follow button again we'll rename
this segue over here and let's call that
show user coming to the find user which
is the follow users table view
controller you override this prepare for
segue we'd say override prepare for
segue
who's going to fast forward this code
because it's the same like the previous
code we just wrote again we set up the
variable for this so come back to the
user profile view controller then create
that variable here called logged in user
and this import five is here also we'll
create another variable here called
other user which is the user's profile
that we were viewing I will see other
users of type nsdictionary coming back
to the find user here what we do is this
should be user also since we've already
declared logged in users type FR user we
don't need to three downcast this over
here now we need to just pass the other
user along with the segue so we'd say if
let index path since we're getting it
from a table view it's a table view dot
index path for selected row and we just
take the user out of that we'd say let
you say equal to users array
it's the array which stores all the
users index path dot row and we already
have the controller so we say show user
profile controller dot other user is
equal to user now let's go to the users
profile controller and write the code
required
start following or unfollowing a user
coming here that's also create a
variable called database reference we'd
call it database ref and will be of type
F our database reference and we create a
variable called logged in user data
which will be of type NS dictionary they
see the logged in user just gives us the
details available in the authentication
system which is the which is the name
the email address and the UID but you
also want the handle of the user and the
email address in the profile picture
stored in our own database which we have
a quick look at a database you can see
over here this is what we get from the
for the logged in user data so first in
the viewdidload let's say surf tour
database ref is equal to fi our database
dot database not reference so let's get
the user's data let's say database ref
dot child wanted to use a profiles node
under that going inside the shaft or
logged in user not UID not observe event
type dot value but snapshot and with
cancel will just say error print error
or localized description and we say soft
or logged in user data is equal to
snapshot or value as NS dictionary and
then let's say self-taught login user
data dot set value will say surf tour
logged in user dot UID for key will be
UID so basically we have the UID in the
Psalter logged in user dot UID but we
want to also add it to this logged in
user data because this is real from our
database and doesn't contain the UID
already
next same thing we'll do is for the
other user will say database ref not
child user profiles third child self tor
other user UID as string dot observe not
value snapshot error and print error or
localized description and here we'll do
the same thing we'd say let you ID equal
to self-taught other user UID as string
just to make it easy will already store
it and then we'll say self-taught other
user is equal to snapshot or value as NS
dictionary and then self dot other user
dot set value will say new ID and four
key will be UID so for both the user the
logged in user and the other user we've
got the UID and the beta stored now we
check if the user is already following
the other user or not so we'll say
database ref no child will assume that
there's a following tab that we create a
check under that we'll check if the
logged in users UID is existing or not
so we'll say logged in user
Todd you ID dot child and inside that
we'll say self dot other user get the
UID
as string will observe let's say dot
value with snapshot and error as always
print error or localized description
here we'll check that if the snapshot
exists that is this particular load
exists we say self dot follow button not
set idle and we set it to follow set or
unfollow sorry and for state will be
normal else we'll say self dot follow
button dot set titled follow first state
will be normal again so basically what
the data structure we create is will
have a following node and inside that
will have the user ID and under the user
ID we'll put in all the users that that
particular user is following so the
currently logged in user will check what
if he is following this other user then
show the button is unfollow I'll show
the button as follow all so now let's
set the name of the user to display on
the instead of the show user label so
let us say self dot name dot text is
equal to self dot other user name as
string okay now before we try this out
remember one thing that here we're
trying to pass the self toward other
users UID as string let us go back to
our home view controller direction of
follow users table view controller over
here if we see we're getting all the
users from our user profiles node and
sorting them by name what's happening is
if we have a look at a firebase console
like I said here from the user profiles
we only get the users data
not getting the users user ID so we need
to add that over here as well
so let's do that what five bills does is
it returns us the key of the data that
we've asked for so we can access that as
by syncs let T equal to snapshot key
this is the user ID because in a
firebase database a key will be the
user's UID which is stored here followed
by the data which we're getting back
that's the value and then what we do is
we say let's snapshot equal to snapshot
value as nsdictionary what we've done
inside the bracket over here and before
we put that inside will say snapshot dot
set value and we will say key for UID
which will be UID you know here we'll
replace this by just snapshot also we
will do another check over here
we'll say if key is equal to self dot
logged in user dot UID that means if the
user Urd the same as the logged in users
ID obviously we don't want to show that
user in the find user tab we just print
a message saying here same as logged in
user so it will not be showed else will
show the user and we add the user which
is by this line over here inside the
table and here it should be else now
let's come back to the user's profile
view controller and here let's create
the method to start following the user
so let's control drag from the follow
button let's call this did tab follow
connection will be of type action here
what we'll do is we'll create a
reference called set followers ref and
it will be the reference to an ordinary
this so under followers it will go under
self-taught other user under the UID as
string under that is a self-taught
logged in user data
UID as string and similarly we will have
let following ref this will be following
followed by self tour logged in user or
DITA or UID get a UID of the logged in
user and inside that will put in the
user ID of the user that is being
followed not will do is we say if self
dot follow button dot title label dot
Tex is equal equal to follow that is
when it will staffed at sure it was
follow then we want to follow the user
so you say let its followers data equal
to we'll do a multi path update so it
will be named probably the name should
be self tour logged in user data and get
the name and we have to make sure that
it's a string similarly we get handled
self or login user data handled as
string next will be profile pic which we
self taught logged in user data profile
pic
since the profile pic can also be empty
instead of downcast you know the string
will autumn will just put it inside a
string like this similarly we will setup
the following data so basically the
following data it'll have the other
users name the other users handle and
the other users profile pic for
followers data it will have the
currently logged in users profile data
you'll you'll understand this more once
we see it in action then we'll say let
child updates equal to followers ref
under that we'll put in the followers
data and inside following ref we'll put
in the following data followers ref
updates inside that followers node
following data updates inside the
following node then you see database ref
dot update child values and we pass in
the child updates here we should change
follower to a capital F so that it
matches exactly with this now if you
want to show the number of users that
the user is following
instead of count getting all the data
counting the children and showing it we
can just create a node called following
count and followers count inside the
users profile so let's see how we will
do that we just create a variable called
let followers count of type int and let
following count also of type int here
we'll say if self dot other user
followers count is equal since we're
trying to follow the other user is equal
to equal to nil then what we'll do is
we'd set the followers count equal to
one that is the user had no followers
initially because that node doesn't
exist it will show as nil and we'll set
the value to 1
else followers count is equal to self
Laura the user followers count if it
already has some users that of its
followers and say as int and we'll add
one user which also will check if self
tor logged in user data the user that's
trying to follow other people if it's
following count is equal equal to nil
then set the following count equal to
one else following count will equal to
self dot logged in user data following
count has int plus one now let us update
this in the database will say database
ref dot child under user profiles dot
child under sundar self dot logged in
user data
UID as string dot child following count
not set value and we'll just say
following count and for the other one we
will just say database F dot child under
going to users profile self for other
user and add its followers counter now
if the user clicked the unfollow button
the users already following the user
then what we have to do is I just copied
the code here I'll just explain it to
you
first we need to reduce the following
count like we'd increase the following
count over here we need to just subtract
the following count by one similarly
followers count also needs to be reduced
by one similarly we need
ketta followers ref and following ref we
could've just declare this outside so
that it was accessible everywhere but
for now we'll just copy this paste this
in here you get a reference to that and
what we do is we set the values to null
which is let child updates equal to
following ref set that to null by using
NS null and follower ref also two NS
null now to say database left dot update
child values and pass in child updates
now let's just try this out here we have
the simulator in front of us here we
have a database so let's try and follow
John Doe it it won't follow followers
tab was created which had John Rose user
ID followed by the user that is
following him
secondly the following type Lee of the
currently signed in user ID and the
people the third person is following
also inside the profile ID we have
followers count under John Doe and under
I don't logged in profile we have
following count also some of you might
have been confused by using this NS null
over here basically if we set a value to
null in the firebase database it is
automatically deleted so now if it ran
unfollow John Doe you'll notice that the
followers and following tabs are deleted
the followers count is now set to nil
correction zero and following count is
also set to zero now all we need to do
is to display these followers and
following count on the user's profile
page so coming here let us follow John
Doe again and to the rest of the part so
instead of actually showing you step by
step video of these views I'll just show
you created version and walk you through
it this is not very difficult if you see
here we've got the me view controller
which is embedded in a navigation view
controller now and in the me view
controller
you replace the hundred and hundred that
was written here with following followed
by a button which whose value is zero
and followers was followed by a button
whose value is also zero we've linked
these buttons to views following this
link to the following view and followers
is linked to a followers view both our
table view controllers and then segue is
also named accordingly show followers
table view controller and show following
table views controller now if we come
here to the me view controller starting
on the top these two buttons are linked
here as number following and numbers
following and number followers sorry
coming down here in the viewdidload
along with the users data that we're
getting from under the users profile
followed by the logged in user ID we're
also getting the followers count and
following count now because these are
created inside our user profiles node
we'll check if the followers count is
not equal equal to nil only then should
we set that buttons value equal to
followers count that means this value
will get updated to the followers count
if they are not equal to name or it will
remain zero similarly with following
count we check if it's not equal to name
we'll set its value otherwise we'll
leave it at zero coming right here at
the bottom basically we just linked up
the me view controller
with the following in followers table
movement rollers so if the segue
identify is equal to show following
table view controller it opens up the
following table view controller and
passes it the logged in user as a user
variable and if it is equal to the show
followers table view controller then it
passes the user to the show followers
table view controller coming out of the
followers table view controller it's a
basic table view controller we've
created a variable on top called list
followers we have created an outlet for
the table and we've created a reference
to the database over here also the data
of the user
is being passed from the previous view
that is a me view controller is stored
in the user variable coming the
viewdidload what we do is we check the
database for the followers tab and we
see if for this particular user ID there
are any followers get the followers
append it to the list followers array
which is an area of NS dictionary like
we've done before and add to the table
view coming down here we return section
as one and we return the count of the
followers as the number of rows
similarly we just set up the rows with
the user's name the handle and return
the cell this is no different from
setting up the find user table view
controller which has the same methods
similarly coming the show following
table view controller we've created a
variable called user which gets the data
from the me view controller off the
logged in user along with the segue
created database ref and you create a
variable called list following we check
under the following tab here if there
are any people that the logged in user
is following we will get the value store
it in the array and add it to the table
view similarly set the section to one
and set the roll number to the count of
the array and display the user's name
and the users handler now let's just
test the app out go to the find user has
also follow the other user so now we
have two users that we're following come
out of the meet am following gets
updated or two tab that you can see that
both the people that we are following
are displayed over here similarly if you
go back and unfollow a user the user is
deleted the count is also updated come
back to the me view following count is
updated if you it we only have one for a
person that we're following left okay I
know this is taking a long time for this
video to come up I had it ready quite a
long time back but because I was really
busy I couldn't
this I'm gonna try and update upload the
other videos much quicker now and then I
hope you guys try this and let me know
how it is it is a little complicated to
implement this in a new SQL database as
compared to a SQL database but we will
dig deeper into this if required thanks
for watching guys and please like and
subscribe</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>