<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>#3 Apple Music UI Now Playing Pan Animation | React Native | Adding ScrollView | Coder Coacher - Coaching Coders</title><meta content="#3 Apple Music UI Now Playing Pan Animation | React Native | Adding ScrollView - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Unsure-Programmer/">Unsure Programmer</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>#3 Apple Music UI Now Playing Pan Animation | React Native | Adding ScrollView</b></h2><h5 class="post__date">2018-03-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pVBflgy5wG8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we have most of our parts set up now
the only thing that we need to do is add
the data that comes here add a scroll
view and give last finishing touches so
let's begin by adding the data here so
we'll come down here the first thing
that we do is we'll remove this band
Responder from this animated header
height view and move it to the outside
view which is the absolutely position
view what that does is that gives us
access to the pan responder in the whole
view otherwise here is only available on
the top half so inside the view that has
the pan responder on it we put in
another view which would be the bottom
half once this is expanded so we'll say
an animated view
let's give it a high which is equal to
half the screen height so for that we'll
say height is equal to animated header
height because that takes up half the
height once it's expanded the opacity
that will give it is animated song
details opacity we had to create this so
let's go ahead and create that so here
I'll just duplicate this in fact I'll
just duplicate the animated song title
opacity because the range is the same
premium this too animated song details
of facet II the input range will remain
the same it's just that the output range
will get reversed so it become one zero
zero so that it shows up only when the
screen is at the top coming down here
inside this we'll put in another view
with a style of flex equal to to a flex
direction of row aligned items of center
and justify content of spacer on inside
this with Brina icons which other
previous song next song and the pause
icon through use ionic ons name of the
icon will be MD divined size would be 40
let's duplicate that this will be MD
pause and MD fast-forward let's give the
middle icon a slightly larger size once
we save that let's test out as we see
this nicely shows up once the screen is
fully expanded below this we want to
just add two icons one is the plus icon
on one is the more icon so we will do
that below this below this view put in
another view for the Flex direction of
row again justify content of space
between because you want the icons to be
at the two far corners I will just add a
padding horizontal of 20 so that's
nicely spaced and also a padding bottom
of 20 inside this the first icon would
be MD ad with a size of 32 and we'll
just give it that pink color again
let's duplicate that the one on the
right corner will be MD more there we
see those two icons also showing up what
we're left with is the slider here and
the name of the song with the artist so
let's do that here above this so above
this view put in another view with a
style of flex of 1 align items of center
justify content of Flex end because we
want it to be at the bottom of this view
that comes here inside this you let's
put it put in the first text which will
be the name of the song so Mattel
California life
let's duplicate this and change this to
the band name which is Eagles and the
name of the album which is hell freezes
over
that's a stylist excellent it's a style
font weight of bold font size of 22 and
similarly here with a style is equal to
font size of 18 and a color of pink
let's see if that works and there that
looks really nice we need to just put
the slider in here now so the slider I'm
just gonna copy in the slider that's
given in the docs we'll put that inside
another view right below this so it's a
view with a style of height of 40 a
width of screen width and aligned items
of Center let's place the slider in now
we don't need these two functions that
come with it I will also change the
default value to the minimum value
that's given by default of 18 as we move
this up we see we can see the slider
there as well the last thing that were
left with is right now we can't scroll
this it just goes up and down so let's
fix that and we fix the ranges of the
scroll as well so we just wrap this main
animated header height view here inside
a scroll view
and we give some properties the scroll
view so it's a scroll enabled for that
we create a state on which we'll check
if the scroll as if enabled or not so we
say this dot state dot is scroll enabled
this we just set that next we say scroll
event throttle of the minimum that we
can give which is 16 so that every 16
milliseconds were given a response and
we can also put our on scroll event
which will map on to two values which we
just create here on the top say at the
top will at the state which is scroll
enabled and by default we set it to
false inside the component will mount
we'll say this dot scroll off set and
set that to zero now coming down here
inside the event method will say this
drop scroll offset is equal to event dot
need to event dot content offset dot y
because we're only concerned about the
y-axis so what we're basically trying to
achieve is just like in the pan
responder when we pan we set the panned
value to our value here as we see this
run animation offset value X of 0 and
justice year dot dy similarly what we're
going to do with the scroll view is as
they use the scrolls once this becomes
bigger will enable scrolling on this so
when the user Scrolls the amount that is
scroll will get set on the scroll offset
now depending on the scroll if the user
is right at the top then we should allow
the user to close this if the user is
not right at the top we should alarm to
continue to scroll up that can be done
in our own move should set pan responder
right now we're passing it true because
we're allowing the user to always be
able to pan the screen but we'll change
that so let's pass in the event and the
gesture state here instead of true we'll
pass in the function so in this function
our aim is to check when to enable the
span responder so depending on certain
conditions we'll do that so the first
thing we'll check is if this start state
dot is scroll enabled
it's a to true and and they start scroll
offset is less than zero that should be
another F and and the user is trying to
swipe down so we'll say gesture state
dot d Y is greater than zero so these
three conditions are correct will return
true so yet to set this is crawled
enable to true anywhere so come down
here inside our animated dot spray here
in the first condition if just estate or
divides less than zero what we were
doing is we were animating it to the top
so when in animates to the top we want
to enable the scroll so we'll say this
dot set state I will set is scroll
enabled to true and in other case when
it animates back down here there is no
reason the user would want to scroll
here so we'll set scroll to false so
we'll say this dot set state is scroll
enabled false so now we know why we're
setting the scroll enable here if you
just come up we're just considering the
fact that the user is trying to swipe
down and here the scroll offset should
actually be less than equal to zero
because when the user has crawled right
in the top the scroll offset will show
zero we need to add another condition
here to make sure that the swipe is
enabled at the bottom so what we'll do
is we put in or value here and we'll say
or if not this dot state dot is crawled
enabled and and the users trying to
swipe up which is just a state nor D Y
is less than zero then also return true
so to test this out let us add some more
data inside a scroll view so that
becomes longer so inside a scroll view
we'll just put in an empty view of
height equal to one thousand let's save
this out now and test this so scroll is
currently disabled and the user swiping
up so this should work once this has
become completely full we should be able
to scroll which is happening here when
the user hits the top again the user
user should be able to swipe down there
are two things that I'll have to do now
one is to animate the background color
when the user is falling and also to
handle some particular use cases one of
them is when the user swipes down and
then swipes up here and if you leave it
this goes off screen the other one is
when the user swipes up and then swipes
down again and leaves it it tends to go
off screen so let's handle this first
and then we'll animate the background
color so come here in our animated dot
spring methods in our own band respond
early is what we'll do is we add another
condition will say if chester state dot
move Y is greater than the screen height
minus 120 which is the height of our
bottom bar that is if the user has
spanned beyond this proposition what we
want to do is gonna say animated dot
spring this dot animation dot y2 value
will be 0 and tension would be 1 and
we'll start this so it just comes back
to from where we started and see if
gesture state dot move Y is less than
120 that is the user has swiped beyond
the 120 threshold at the top you just
copy this base this in here and then
instead of putting in if we'll put this
into an else if as well and now who test
this out we can see that when the user
comes here at the bottom it doesn't go
beyond and when the user comes here at
the top first Pan's down and then pans
up it doesn't allow it to go beyond now
the last thing let's just animate our
background color so here that is create
another value let's duplicate this call
this animated background color so when
it's at the top we wanted to have a nice
black color will say RGB a zero comma
zero comma zero comma zero point five
and let's get rid of this middle range
as it reaches the bottom we want it to
become white let's add this animated
background color change this to animated
background color now as we see the
background color animates to a black
color coming down it turns back to a
white color I know this has been a long
series I hope you guys have learned
quite a lot from this
please stress this out and please
subscribe and like thank you for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>