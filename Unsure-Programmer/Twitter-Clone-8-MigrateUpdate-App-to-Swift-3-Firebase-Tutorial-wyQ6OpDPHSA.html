<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Twitter Clone 8 - Migrate/Update App to Swift 3 + Firebase Tutorial | Coder Coacher - Coaching Coders</title><meta content="Twitter Clone 8 - Migrate/Update App to Swift 3 + Firebase Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Unsure-Programmer/">Unsure Programmer</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Twitter Clone 8 - Migrate/Update App to Swift 3 + Firebase Tutorial</b></h2><h5 class="post__date">2016-09-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/wyQ6OpDPHSA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so in this video we're going to be
converting the project that we've
created till now into Swift 3 I realized
that since one day we're going to have
to convert to that we might as well do
it now it does require a few steps
though it's not that complicated but
I'll guide you over it one by one and we
should have a working project by the end
of it as always the starter project and
the completed project are available on
github and the links for the same are
given in the description the only thing
that will require for this video is
Xcode 8 which is now readily available
from the App Store
before we head into Xcode let's start
with the pod files we need to start by
updating the pod files that we had
installed earlier so let's open up our
pod file so it is CB into our project
directory then with this nano into our
pod file and we can see that we
installed firebase and its dependencies
all we need to do is wing to restaurant
pod update this updates all of our veg
dependencies to allow us to work with
Xcode 8 and with latest Swift 3 syntax
now let's open up our project in Xcode
the moment we open it up we see this
alert which says convert to currents
with syntax so let's click on convert it
it asks us whether we want to convert it
to Swift 3 or swift 2.3 we're gonna take
the plunge and go directly with Swift 3
now what we're also going to do is we're
going to select these frameworks as well
and click on next it's gonna give us a
preview of all the files after it's
finished converting it so in front of us
we have the app delegate as you can see
one of the changes is that when you call
a function without the first parameter
you would write it as a normal function
but now when you want to call a function
without naming the first parameter you
need to put on Disko before that it's
the same for all the functions like here
for the DTaP start tweeting we don't
write sender when we call the function
so it's put an underscore before that
and the firebase code we can see that
instead of making it up
observe single event of type and then
putting the type in the value it just
made it observe single event and off
goes inside
similarly lowercase thing is now lower
cased perform with Segway has now split
up into perform and with segue with
identifier goes inside the bracket and
dismiss view controller animated has
become dismiss so its swiftly has cut
out a lot of the verbosity that was
there at the language and made a lot
clearer and streamlined we have the same
things with the home view controller
also now for the index path we don't
need to call NS index path number of
sections we don't need to say number of
sections the in table view and then
table view again in goes inside the
bracket this as index path will have to
remove when we edit the code because
it's not required anymore UI color dot
black color is not required anymore and
can just be UI color dot black scale as
portrayed used to be with a capital S
now it's only going to be with a small s
and like user interaction enabled is now
become easy user interaction enabled
which makes it clear up according to the
people who wrote solution which come in
the home table view public classes are
now called open classes and as data is
no longer required instead you can just
run a try block and say data contents of
URL instead of NS URL and get the URL
data directly makes it a lot more
streamlined not mixing up NS data along
with data now it's more sounds more like
Swift
similarly the similar things have been
changed here dismiss view controller
observe single event self tour perform
segue in the new view controller again
observe single event of type has become
observed single event and also dot value
is now in small case instead of having a
capital B and inside should view
controller with identifier instead
should view controller with identifiers
go on inside
similarly with this
so most of the changes are made to make
the language a lot more clearer which i
think is a good thing and it's not gonna
break a lot of things like you see you I
like color grey colors now just light
grey hidden is now is hidden cgrect
value becomes cg rekt value without
function parenthesis here put data
becomes put and not put data
similarly enabled is is enable now and
add earth state did change this's now
add state the change listener a lot of
this code has not exactly been updated
very well on the firebase a
documentation yet and the examples are
not exactly updated like this should be
so we'll go through whatever changes we
need to make to try and make this work
so we'll just save this out as always to
begin with you to copy the Google
service info dot P dash file into your
project folder the instructions for this
are given along with the starter project
on my github page once you've got the
Google service info dot P list file we
can start so let just try and build this
project first we should surely get an
error as you can see we've got a couple
of errors it says build failed so let's
start with the first one as you can see
we've said var logged in users equal to
any object this is not no longer allowed
we need to do it the exact Swift way
which is just put a colon and say any
object and put a question mark after
that for an optional the next error that
we've got is the similar thing for this
variable so let's do this for all the
variables this is also going to become
any object in the question mark come
down CG float will also not be equal to
it'll have a colon and does not require
the parentheses any
a logged in user will also be in any
object without the parentheses coming
further down but you remember we had put
in this code to catch the invalid email
address error this has been fixed by
firebase now so we can get rid of this
message here it automatically just
displays invalid email address if it
catches that error let's try and build
this again so the errors that we had
corrected are gone but we still have
some more variables that we need to read
Eclair so let's get the variables first
in the home view controller we can see
here okay the logged in user let's just
change this also and the logged in user
data building this again let's see seems
like we've got a hold of all the
variables now now let's start with the
other part of it let's come to the me
view controller and select this error it
says type any has no subscript members
so basically earlier what you are doing
is we were getting the data from our
node Andras of type F IR data snapshot
and you directly it is extracting the
values and putting the data and showing
it but now Swift needs to be sure what
type that details so we can directly
just extract the values from it so for
this what we do is we'll say let's
snapshot equal to snapshot dot value and
we'll force down cast it we know it has
a string as the property name and after
that we'll say any object to it the
value of that can be any object then
what we'll do is instead of snapshot dot
value will just say snapshot and put in
the name in the brackets down
I started a strain again here let's say
snapshot handed down cast out of the
string and similarly for the rest just
remove value about remove this and let's
bury this so as you can see once you
convert it the snapshot to a dictionary
so it has no problem with us extracting
the values let's come to the next error
it says heterogeneous collection literal
could only be inferred to as string any
so basically what it's saying is that
there's only one thing that this can be
converted to which is that the first
parameter is of type string and the
second parameter is of type any so you
must insert that to indicate that is
being downcast to that exactly it can't
be left ambiguous so that's what we're
doing we just put that in similarly for
this will say as string any and if we
build this the error should go away so
no longer you can you leave things
ambiguous for swift to interpret on its
own you need to explicitly declare the
type of data that Swift is working with
so now let's come to the next error
which says index path is not convertible
to NS index path so let's get rid of NS
index path and just make this index path
dot row
and let's build this out as you can see
even after we've corrected that the NS
index path method error is gone but
another error has come up which says
self not tweets short count it says
ambiguous referenced remember count this
is working perfectly before in the
earlier version of Swift so let's see
what we have to do here basically here
again we're getting the snapshot when
we're directly appending the snapshot to
the tweets array we cannot basically put
a count method to an any object anymore
it has to be of type NS dictionary or NS
array so let's convert this and say var
to each is equal to an array of NS
dictionary and since the show's gonna be
only an NS dictionary that'll be added
to the tweets would remove the question
mark to make it mandatory now coming
here if you build this then telezart
cannot convert value of type FR data
snapshot to expected argument type NS
dictionary so let's do that ourselves
with a snapshot value force downcast at
2 and NS dictionary if you build this we
should see that either go away coming
down the error of the count value is
also gone but it cells cannot force
unwrapped value of non an optional type
and as dictionary since we converted
into a dictionary you can get rid of
value from all of these and since it's
non optional we don't need a exclamation
mark and let's build this out and we no
longer need to put two equal to zero
it's just not equal to little fill this
out and that's okay it's working now now
if you come down here we have another
error that's come up here which has
ambiguous referenced remember value for
animated key the same thing we have to
do for the logged in user data over here
it says of type any object let's make
this of type NS dictionary and here
served or logged in user data will be
snapshot or value as NS dictionary
and since some values can be nil we'll
just put that as an optional coming down
here we get rid of value and we just
leave the bracket with the parameter
name if you build this there should be
gone
now that we've corrected all the errors
that had come let's run this out as we
see it looks like everything is working
but this home view does not turn up
what's happening is also if you come
here and check out the error log it says
failed to fetch default token error this
is an error that's being caused because
the simulator in Xcode II does not have
access to the keychain directly so let's
enable that first come here to to tell
or go into capabilities and put on
keychain sharing once you put this on
this error will be gone but there's one
more thing that we need to do to make it
display we need to come to the home view
controller I need to change the code
here for child added basically earlier
we used a forward slash and if this and
it worked but now we basically have to
put it under child to make it work
so as we child tweets node under that we
need to go to the child which is the
self tour logged in user tour UID and
then observe the child added event now
this would work let's run this and there
you see our home view controller is
displaying perfectly now home view
controller is displaying perfectly but
if you go to the new tweet and try and
add a photo that to the tweet it will
give you an error that's because there
are two previously options that have
been added which are the photo library
usage description and the camera uses
description which needs to be added to
our info dot pedis file it will
basically give a prompt to the user
saying that the app would like to use
your photos on the app would like to
access your camera and the user has to
see
yes or no and only then it can move
forward so let's just add those in here
click on this plus button here go under
privacy and we'll put in camera and you
can give a description you are saying
click a photograph for your tweet next
we'll put in privacy privacy and select
photo library usage description select
photo from gallery also come into the
new tweet controller we need to firstly
move the let raw low res image data
value that we had created we have kept
this outside but if the user does not
add an image that will give us an error
so let's copy this and put this inside
this one which is tweets tweet length is
greater than zero and images is greater
than zero and also put it inside else if
nominee image is greater than zero so
now it won't give an error if the user
only puts in text also from Iestyn
onwards we need to force unwrap the user
ID of the user over here otherwise it
will get stored as an optional in our
database let's run this out now
here we have the home view controller
select an image it says see this brings
up this option of would you like would
like to access your photos allow or
don't allow you say okay select a
photograph choose and that the image
comes up and now you can click to it and
you will see the image and that tweet
has come up so we finally got a have to
be working using Swift three I know it's
been a little hard and we had to make
quite a few changes but it'll be worth
it because from now on we'll only
concentrate on Swift three and build our
application using Swift three only I
promise you that the next videos will be
coming up much faster than this one came
up and we'll quickly finish up this
application I hope you guys like this
and please like and subscribe and thanks
for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>