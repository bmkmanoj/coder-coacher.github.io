<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 2 - New Firebase + IOS(swift) + Facebook Login Tutorial In a Real World Application | Coder Coacher - Coaching Coders</title><meta content="Part 2 - New Firebase + IOS(swift) + Facebook Login Tutorial In a Real World Application - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Unsure-Programmer/">Unsure Programmer</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 2 - New Firebase + IOS(swift) + Facebook Login Tutorial In a Real World Application</b></h2><h5 class="post__date">2016-06-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tt2xfrRk3Ck" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in a first video we learned how to
integrate facebook login on our iOS app
along with firebase as the backend the
facebook login at this point though is
quite pointless only aligned the user
login and logout as you can see where
you click on login it just logs the user
in and then it just shows the logout
button also the app does not store the
user in a firebase authentication
database in only logs a user into the
Facebook app so this is not a practical
example of using this login and this is
not how we would use it in a real world
example also just to confirm that it's
not logging into a firebase database if
you go into into your console you can go
into the section auth and you will see
that even though we just logged in and
logged out we it says the new views it
has no users for this project even if we
refresh this we get no users for this
project so you need to set up this code
so we'll start with that we'll start
with first logging the user in to a
firebase database before we do anything
else so to do that we come into a view
controller dot Swift we go down into the
login button we see here it just prints
user logged in here we will put in some
code that's provided by five is for us
as you can see facebook login and it
shows him after a user successfully
signs in in your implementation of
complete with result get an access token
for the signed in user and exchange it
for a firebase credential so let's just
select this code put it here and paste
it's going to use the Facebook token to
get the credentials and we're getting
this error which is going to because we
have an imported firebase auth and that
should be fixed
next we have to get next we have to sign
the user in using these credentials very
simple just put this in here so use the
credentials that are received from the
access token and then sign the user in
and for now we'll just print user logged
in to firebase app and let's just run
this and see
so let's log this out first and we log
in with Facebook icon okay and as you
see it shows user logged in and then it
shows user logged into firebase app we
can confirm this by going into a
firebase console refreshing this and
then we have algebra gamma and we have
which shows the providers Facebook and
this roses unique UID as you can notice
it does not show the details like the
name etc but that can be extracted from
this provider and I'll show you how to
do that later in this video okay so now
once we've got this we have to now do
once the user is logged in we have to
make the user go somewhere go and oh
like a home screen and if the user logs
out we need to make him come back to the
login page so let's try and implement
that let's come in here and as you can
see there's a set of code that we can
put in if you go into a documentation we
go into manage users it shows us that
the recommended way to get the current
user is by setting and it's now the
author
object so this code here will check if
the user is signed in or not let's put
this in here so if the user is signed in
what people want to do is move the user
to another college asset to the home
screen and the users and if no user is
signed in and show the user the login
button as you can see here right now
this logout button comes but we don't
want this logout button to be there we
want to have implement our own logout
button we want the same login button we
want our own logout button which we can
probably play somewhere else in our app
so you'll know how to do that so for now
once the user if suppose the user is not
signed in then we wanted to show the
user this facebook login button
otherwise you want to move the user to
the home screen right so initially let's
start by hiding this login button we
hide the login button it checks if the
user is logged in if it is it will move
it to the other screen for which we will
just put in the code and if it's not
then it will add the login button and
display it
so we also add sulfur to explicitly
reference that and over here we'd write
the code for actually moving the user
for the other screen so we'll say a let
main storyboard UI storyboard equal to
you guys storyboard name and then we
have two guys main to reference the main
storyboard and bundle will be nil it's
the second option which we don't require
so we set that in it and now we need to
reference the controller the to which we
want to go to so we want to go to Oh
first we have to set that control up
which you forgot so let's go to me in
storyboard and let's add this here let's
add another view controller and just for
simplicity as last time we're just going
to set the size of this okay
that's like this and I'm going to set
the size this for decimal 7 inches bring
this here this quickly put one UI label
in the center to indicate that this is
the home view just quickly not be Center
it in the container and we pour in
constrain and also we will put enough
button
which we will call logout and for that
also we put this in okay there you have
it might not be the exact constraints
like we need but just for now it's okay
okay then we have it so we're going to
name this storyboard get the storyboard
name and we're going to just you know
name it home view that's what it's going
to be and we're also gonna add another
label so I'm going to add a class for
this go to file new file iOS cocoa touch
class let me name it home view
controller subclass of uiviewcontroller
and click Next and save it in a folder
okay there we have it so go back here
select the view controller and give this
the class off home view controller that
is so coming back here we have now
reference the controller to which we
want to send the view so let's see we
won't name it let home view controller
of type UI view controller equal to main
storyboard dot instantiate view with can
view controller with identifier and the
identifier we're going to use is the
identifier we give the storyboard home
view and the last thing we need to do is
we need to present the view controller
so first argument Equus if you see first
argument is the controller that we want
to present cycle we're going to set this
to true the animation and we don't want
any completion callback so
when I set that a nil and they should
move the user to the home screen okay
and in case the user is not logged in it
should show the login button and let's
see other books let's see how that works
see there we were logged in and it's
taken us to the home screen obviously
right now if you click the logout button
it will not do anything as we haven't
set up the code for the log on button so
there's no way of dinging I user back to
our home screen so let's do that now
let's set that up with you so if we just
go to our home view controller sense -
home view controller we just create a
reference for the logout button here
and we call it date tap log out and we
set this to action connect there we get
this now what we need to do is we do the
opposite of what we did last time we're
going to move the user back to the home
screen but we also need to sign the user
out from our firebase app as well as our
Facebook app so let's go here and let's
go into Facebook log in this and if you
right at the bottom we see this line of
code which is try firewalls dot auth dot
sign out so what this does is signs the
user out of the firebase app always good
to comment your code and now we need to
sign the user out of Facebook app come
on import
okay it and import 5s auth that you
get pull them and what we're going to
recruit Facebook SDK access token you
basically the only way to log the user
out of Facebook app is to set the access
token to nil set current access token
they said otherwise we have to try and
get to get a new access token which
technically means try and lock the user
in again once these two are done we need
to move the user back to the home screen
so for that what we'll do is we'll go to
view controller and we will copy this
line of code here go to the home view
controller or sift and paste this in
here so first thing that means the same
we need to get a reference to the main
storyboard
that's what we get but we want to
display a different controller this time
which is a just fixed which is called
view controller and the ID is got is
let's see if you give it an ID so we'll
go here and which I or does not have an
ID so we just name it as main view
always say we call this as a login view
that will be better so your whole view
controller and we say view controller
after I Bui view controller me and story
about on instantiate view control over
that enter fire login view and then we
want to show add view controller and and
animation equal to true and completion
callback equal to nil so they should log
I use out and move us back into our
login screen
let's check it out
so here we already logged in left click
on logout let's see let's hope it works
and then we're logged out and it shows
the login button with failed login with
Facebook button again login logs us in
and it takes us to the Lord to our home
screen as you can see there's a bit of
an error that once we bit of a glitch
once we log in and it comes back to the
screen we have this log in with Facebook
button is still displayed so let's
correct that let's go to our main story
board here what we do is let's start
with let's come here and okay let's also
check if by any chance if there is any
error error or not equal to nil we'll
handle handle errors here else if I'll
show you why I am doing this result is
canceled if the user presses the cancel
button in the face book dialog box which
is here this one we have nothing we have
no code that shows anything so see it
just comes here and gives us an error
right now so what we need to do is you
know set that up as well you go to back
in storyboard and here so if result dot
is canceled we just
and as a cancel event and the only only
about these two things don't happen then
we go to the third one which is and if
let's put that in here and get this to
the bottom then we lock the user in and
this should be else not elsif okay no
sorry run of it as if this should be
else there and just format the code once
okay there it is so what we need to do
is once the user the moment the user
clicks the login what we do is we hide
the set the Facebook button login button
got hidden equal to true okay if the
result gets canceled or it has an error
then we display the button again login
button got hidden equal to false and
self dot login button not getting equal
to false in this case we don't want to
show the login button earring here again
so let's try this out
login to Facebook okay as you see there
is no login button would be nice to see
an animation dad oh and we log out log
in with Facebook and cancel and then we
have log in with Facebook comes back
again so one thing more we can do is
just to make it look nice and more
appealing for the user is we can add
something known as activity indicator
view it's just a spinner fancier name
for the spinner and set the size to a
large white and color to red and we
Center this horizontally and vertically
in the container so now what this is we
need to get a reference to this we just
call it activity indicator view loading
spinner and display an outlet and what
we will do is the moment the user clicks
login we start start the spinning so it
is an activity indicator view loading
spinner out start animated in case as an
error we want the activated indicate of
you to stop animating and also if they
use a cancel you on the activated
activity indicate of you to stop
animating and once it goes to the other
screen we wanted or disappear for that
we don't need to put in any code we
provided really easy way to do that
which is hides when stopped if you go
into the settings go to the attributes
inspector you can see hides when stopped
so let's try this up now
click on login to Facebook okay and we
should see a spinner that comes up which
goes Wow same way if we click login with
Facebook and we click cancel the spinner
is not there and it goes away only the
last thing now that we need to do is
display the users details like the
user's profile pic and the user's name
on the home screen so to do that what we
do is we first come to the home view and
we add like an image view center this in
here give it like a height width of 200
and just soar exactly Center it in the
container and we're also explicitly set
the width we also just put in a UI label
to show the user's name right below this
let's put this in here you vertically
spaced it and we were totally centered
on the container and we can just give it
like name this will obviously be
replaced by the actual name of the user
so let's get references to these two
things let's call this UI image view
profile pic
and let's call this oops that stephanie
says UIL and name as you can see I put
these two tiles here mark properties and
mark actions for mark properties in mark
actions does is if you click here you
get these bold highlighted tabs just
properties and all the properties come
under it just a nice way of presenting
it now that we have this let's just make
this a little nicer so what we do is
first thing itself dot UI let's make the
profile picture round very easy to do we
just set the corner radius to half the
width of the actual image and we also
clip it to the bounds so that anything
that's overflowing outside the round
part is deleted now what we need to do
is we need to just check if the user is
signed in and get the user's profile
picture in its name and display it on
the screen so for that will go into the
fibers or documentation there are two
ways of checking the users signed in we
can either use the auth state did change
listener or we can use the auth current
user so for now we'll use this because
we already move the user into this page
using autotune listener let's try this
one out so okay if flat use a equal to
Fr auth dot or current user the user is
signed in and we can get the user
details how do we do that you can get
the user's profile like this here it's
given easily here and we just copy and
paste that here so it says let name
equally user or display name email for
URL and UID UID is the firebase UID and
not the Facebook ID now all we need to
do is we need to just go self dot UI
image sorry let's name the UI label
first is equal dot text is equal to name
so display the name the user next week
let data equal to NS data contents of
URL and we put in photo yura URL this is
for the image and then we just put the
image in and display the image which is
self dot UI image view put a profile pic
dot image equal to UI image and sense
data of type and s data which is data
and we need to unyk we need to
explicitly unwrap this the removes that
error and also here we need to
explicitly unwrap this as well and that
should be it this should be able to show
us our name and a profile picture let's
check it out there we go we get the name
of the user and we get the profile
picture but as you can see the profile
picture is blurred because the size of
the profile picture that we returned get
from facebook is 50 by 50 pixels there
is a way that we'll see in the next
video of how to change this profile
picture to a larger size it's a little
longer and it uses the firebase storage
it will also cover the firebase storage
tutorial so till then why don't you try
this out and see how we can you know
actually use it use the login in our
application because now it gives us and
it separates out button and it also
shows us the users details which makes a
lot more sense than just being using the
login and logout buttons</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>