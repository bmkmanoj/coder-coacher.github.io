<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Ionic Creator Tutorials // Using APIs with Angular $http // Part 2 | Coder Coacher - Coaching Coders</title><meta content="Ionic Creator Tutorials // Using APIs with Angular $http // Part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ionic/">Ionic</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Ionic Creator Tutorials // Using APIs with Angular $http // Part 2</b></h2><h5 class="post__date">2016-10-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZvF2_ZpqZpk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everybody I'm Matt from the Creator
team and you're watching our weekly
workshop last week we started out with a
survey example where people can fill out
their name their favorite color and
their favorite pizza topping and we
stored that using Shih Tzu in a Google
spreadsheet this week we're going to add
some functionality to that app so the
first thing we're going to add is a
results page that allows you to view all
the surveys that have already been
submitted we're also going to allow you
to delete survey results from that list
then we're going to add a search screen
where you could actually narrow down and
search for different survey results
based on name color and pizza topping so
this week we're actually going to go
through a lot of different features of
creator we're going to use buttons and
headers we're using list item delete
buttons we're using route parameters
with that are optional as well as have
default values and we're also going to
use the ion refresher component from
ionic through our HTML component so
we're gonna go through a lot of stuff so
this might be a little bit of a longer
video but I'm hoping you stick with it
and so I can show you how to use this
Shih Tzu API to start making a very
full-featured
app now like I said in the last video
all these techniques can be used with a
variety of variety of API so you don't
have to stick with Shih Tzu you don't
have to stick with Google Spreadsheets
you can use all this same information
with any APU API you'd like even one
that maybe is coming off your own server
so let's get started with this results
page so we're gonna switch over to our
results page here and last week we
didn't do anything with this page yet so
right off the bat I'm gonna want to
start designing what this page looks
like okay so we are going to actually
use let's use an avatar list item here
now like before I like full with lists
so on this page we are actually going to
remove padding so that those list items
go full width and then for each list
item here we are gonna want the person's
name that filled it out what their
favorite pizza topping is and then
instead of a picture here we're gonna
make that into the color that they chose
as their favorite color so now the first
thing we need to do is get access to all
this information
through the results controller so we are
going to set scope that surveys equal to
an empty list okay and then we're gonna
do a function on scope called scoped out
load data equals a function and here is
where we are going to actually get our
data so let's import the surveys
controller that we've been using okay
we'll just double check that that is
actually singular not plural so the
service is actually called survey so
let's get rid of that s okay and here we
are going to want to kick off survey all
which is a function we already program
that returns all of the results from our
Google spreadsheet so it's going to
return George's line here and Frank's
line as well so survey all and then that
returns a promise so we can use dot then
function and this returns a result okay
I will set scope dot surveys equal to
the result that it passes back now the
reason I put this in a function is for
that refresher that we're gonna add
later on so that the refresher can
actually call this function but right
away we're just one going to want to
call scope download data so we'll this
page has the data right away when the
page loads so let's save that and then
on this item we're gonna add some
directives okay we're gonna add
ng-repeat survey in surveys and this API
is actually going to return the surveys
as they are ordered in the database
which is actually oldest to newest but
we probably want the newest survey
results at the top so we are going to
use a pipe to add a filter here okay and
that filter is going to be order by okay
and that order by we are actually going
to pass it using a colon and then a
string the minus symbol and end string
and what this is going to do is it's
actually going to reverse the order of
the array that is passed in so it's
going to take surveys order by negative
reverse it and then set survey to every
single survey for this thing okay so now
that we have access
to our survey information we can go to
our content here and here we can put
survey name and for line two we can put
likes surveyed favorite underscore pizza
so it's gonna say like Mike likes
pepperoni okay now let's actually test
this just to make sure we are working so
far so let's preview we're gonna give it
a second to get the results from our
database you should pop up in a minute
here so we see Frank likes pepperoni
George likes sausage so far so good so
let's get the color to show up here so
the next thing we're gonna want to do is
I'm gonna do something a little bit
weird we're gonna actually set style and
we're gonna do background color is
template tags survey dot favorite
underscore color and template tags and
then a semicolon but we're not gonna
want this on the parent element okay
we're gonna want to click this and move
it to the image so that image which
would normally be a profile and we're
just gonna have background color survey
that favorite color we can save and
close that so now if we preview we
should see the colored circle for each
survey result from our database so Frank
chose orange George chose pink okay so
now that we have that all set up we're
displaying our survey results straight
from the database we're gonna want to
actually add the ability for you to
remove those survey results now this
gets a little bit more complex so bear
with me as we are going to add a button
to the header to turn on a universal
delete button for all of these list
items so the first thing we're going to
want to do is select the page and start
adding our list item remove button so
we're going to enable the left header
button we are going to change it to a
minus symbol okay and we are going to
make sure that this is just styled
regularly right here we don't want to
style it as a button that way it's a
nice large minus symbol okay
now that that button is there we're
actually going to want to go to our list
here the overall list not the list item
and we can see that we have access to
delete and reorder buttons now these are
slightly complicated they do have there
tutorial if you want to follow along
with a separate tutorial there however
this one we're gonna do pretty simple we
need to select the set the delete button
to actually be a variable that we toggle
on and off which will toggle on and off
the delete buttons for all of our list
items so back down in our controller
here we are going to add scope dot show
delete equals false okay
and scope dot toggle delete equals a
function and in that function we're just
going to do scope show delete equals the
reverse of scope dot show delete so
it'll toggle it on and off okay so make
sure you save those changes and now
we're going to need to do two things we
are going to give the delete function
function the variables show delete and
it's going to use that variable whether
or not it's true or false to show the
delete button and then we are going to
need to rig up the actual button from
the page to this toggle delete function
so click on the page
and we're gonna go down to angular
directives here and add an ng-click
toggle delete okay and we are yet again
going to move this directive to the
actual delete button that has that I on
iOS - outline tag on it
so I on that button side left this
button that's where we're putting it the
directive we're gonna save and close
that so now if all goes well they're not
gonna do anything yet but we should be
able to preview we'll wait for the
results to load here and as I click
delete you can see those delete buttons
pop up for each individual item and they
toggle on and off so now let's make
those delete buttons actually remove the
item okay so we do not have a remove
function in our API yet but I'm gonna
write some code ahead of time here okay
we are going to just set scope dot
delete item equals to a function and we
are going to pass the index of the item
from this original list okay and here's
where we're going to call that delete
function from the services we're gonna
write in a minute but first let's rig up
this function to a button so let's do
click on your list item and now it's a
little bit interesting so let's back up
two seconds actually so the list enabled
the
the items for each individual list item
but the list item is in control of what
those buttons do because once we go over
here and add a directive for ng-click
we're gonna do delete item and pass
dollar index now dollar index is coming
from this ng-repeat survey and surveys
the index is just like 0 1 2 3 the index
and the actual list so we're going to
move this directive all the way down to
the ion delete button that was created
by the parent list but in the list item
so I undelete button in the list item
nas ng-click delete item dollar index
save and close that okay now we could
test this if we want we could alert
dollar index okay save that and as we
preview this here and wait for the
results to load we can see that once we
get these results what's going on here
is they're just taking a long time all
right so our results loaded we can see
that we can toggle on this delete button
hit - we get 0 as the index back hit -
here we get 1 is the index back so we
know that that's actually passing the
index to this delete item function now
let's move over to our services here and
you might notice that this looks a
little bit different than our first
tutorial if you go to github use creator
com that's where you can find the code
that I'm using in this tutorial and the
previous tutorial we change the way the
promises works so we no longer import
dollar queue we instead use promise
chaining where we return the data we
want to this promise which can then be
used as a promise later so this code is
slightly different you can find that in
github not use creator com but what
we're gonna do here is we're gonna add a
delete function okay in that delete
function we are actually going to pass
it an ID so we're gonna pass that ID to
the delete function and this one's going
to be super simple so let's go to the
spreadsheet API here this is on sheets
use documentation and look up the delete
function and we can see the delete
function is
standard API URL okay where a column
equals value it is going to delete that
entry okay so back here we can do return
HTTP delete okay so we're just using the
delete HTTP type here our API URL plus
slash ID we're gonna delete on that ID
field where that ID is equal to the ID
that was passed to this function so this
is really simple call off a delete
function to API URL slash ID slash the
ID we passed to it
okay so we can see this capital delete
here that's kind of letting us know
which kind of HTTP we're using which is
that delete that post that get okay so
we're gonna save the changes to our API
go back to our results and here we're
gonna do a couple different things okay
let me scroll down here okay so we're
gonna call survey dolly scope that
surveys dollar index so we're getting
the actual information from scope dot
service dot ID so the index we passed to
this function grab the ID from that
that's what we're going to delete then
after it's deleted and the reason we
actually passed the index is now we want
to remove that from our list okay we
don't want to recall and go to the
database and get a whole new version of
the list we're just going to remove this
list item okay from the actual list that
we've maintained locally so we're gonna
do scope dot surveys dot splice dollar
index minus one and we're taking one
element off okay now if we save this
what should happen is we will get a
delete response from the database which
will remove it from our spreadsheet over
here okay and then we will take it off
of our actual list so it disappears from
the app okay so let's preview this and
wait for the stuff to load here and then
we will delete Frank so now that request
went off to the database and once it
comes back you can see that it gets
removed from our actual list here now I
want to show you something a little
interesting about the shih-tzu api other
api's are going to behave differently
you know the
is kind of your mileage may vary for
whatever API are using if we preview now
that that has been deleted and we wait
for the data to load we're gonna get
something a little bit unexpected now we
have a blank value here Frank likes
pepperoni but we got a blank value now
why does that blank value exists let's
look at our database we can see our
database here deleted the row but the
row still exists and shih-tzu doesn't
care whether or not there's valid data
here because it's a very simple API so
we want to make sure that we don't show
any empty rows in our dot all function
okay so let's go back to the services
API here and I'm going to create a new
function called function we're gonna do
filter blank rows and we're gonna pass
this an actual list of results
so we'll do rez here we'll call that L
okay and so here we are going to use the
list filter function to remove anything
that has a blank ID okay so we're gonna
do return l dot filter function for each
object we are going to return true or
false based on whether or not object ID
is not equal to a blank ID okay so what
this is gonna do we are going to filter
it based on true or false whether or not
an ID is equal to nothing now we're
going to need to edit our all function
to use that so we are going to do here
we're going to do VAR results equals
filter blank rows RESP data and then
we're going to change all of our arrests
data here to results okay so there's a
couple different places we have to
modify this okay this one as well put
results now when we load this the API
will still be returning blank rows but
our service is not going to return them
to whatever calls dot all so as we
refresh here we should see that we only
get Frank we don't get the blank row all
right so now we've got something that
shows all the survey results you can
delete them and we make sure we don't
show blanket results so let's move on to
the next step I want to
show you guys how to use an advanced
search feature so we can build a search
page that lets you filter based on name
favorite pizza favorite color anything
you want and we are going to do that in
this other search page okay so let's
start off by building this search pages
form okay so I am going to drag over
just a regular old input box here we're
gonna call this one name then I am going
to drag over to select boxes okay one
there one here and we are gonna let you
choose a favorite color from a drop-down
as well as favorite pizza from a
drop-down now each of these I'm just
gonna go ahead and add some options here
so for favorite color we are going to
use the same colors that we used in our
other drop-down but we're going to add
one to the top which is any color
because by default we don't actually
want to have a filter so any color then
we're going to do green yellow we are
going to do orange pink blue and black
okay and then for favorite pizza
toppings we are going to do any topping
then we are going to add sausage
pepperoni and cheese okay now after all
of this form here we're gonna do a
button and I like to make any kind of my
buttons separate color so we're gonna
change that to green and this button is
going to say find matching surveys now
let's go to our search controller here
and I want to start rigging this up to
some temporary data that we can then
sent to the other page okay so what we
are gonna do here is we are going to do
scope dot fields equals name is set to
nothing by default okay favorite color
is set to any color by default favorite
pizza is set to any topping by default
all right so let's rig this up to the
data so I just like I like showing you
guys that the data is actually rigged up
to something so let's actually show
fields down here as we're
and this name we are going to add Angie
- model is equal to field stat named for
favorite color we are going to do ng
model is equal to fields dot favorite
color and for here same kind of thing ng
model is equal to fields dot any topping
okay
so let's preview this and we can see
that name is nothing favorite colors any
color favorite pizza is any topping we
could put Jo here automatically updates
we could put orange and here I must have
spelled something wrong maybe pepperoni
is a default let's see why favourite
pizza oh I put fields that any topping
definitely meant fields dot favorite
pizza here all right so if we preview
that any toppings should be the default
here and favorite pizza should update to
pepperoni there all right so that's all
good to go so now that we have this
temporary data here I'll delete fields
we don't need that anymore we're gonna
want to pass this somewhere now I've
already got a results page and I don't
want to have to reprogram an entire
results page just to show you these
search results so what we're gonna do is
we're actually going to go to our
results page and we are going to add
some route parameters to this page so
we're gonna add a name round parameter a
favorite color route parameter and a
favorite topping route parameter the
default value for these I'm gonna leave
blanks so the default value is actually
going to be an empty string when you
just visit the results page so now even
though this page has route parameters
now if I preview results it's gonna get
no parameters we're not even really
doing anything right now but it's
actually going to go out get the survey
results that we currently have from the
database and show them here if it could
load my connection must just be a little
bit slow right now
there we go Frank likes pepperoni all
right so now we want to send these over
to that other page okay so we are gonna
want to do scope dot search it is a
function okay but the thing is I don't
want to send any color or any topping
over to this page because those don't
actually exist so we are going to do VAR
params is an object
we're name equals scope dot field stat
name okay we're pulling it from that
other object and that we're gonna do if
scope dot fields dot favorite color is
not equal to any color then we are gonna
add it to params so we will do paramah
it color equals scoped field stuff
avorite color and we're gonna do that
same thing for favorite pizza so let's
just actually copy this and this is
favorite pizza okay change this to
favorite pizza change this to favorite
pizza and then it the defaults not any
color it's any topping so now we have a
params object that has a name and
potentially has favorite color or
favorite pizza we're gonna want to use
state go to send you to the other page
so we're gonna import state first of all
and we're gonna do state go now I
actually don't know the UI Esref of the
page that we're sending you to so
results page is selected and you can see
up at the top by the title here you can
see the state or s ref is equal to tabs
controller dot results so we're gonna
copy this until state dot go that that
whoops I used a if I could type right
dot results that's where we want to go
and we want to pass these parameters to
that page so we're gonna hit save now
over on our results page we want to make
sure that these results are actually
getting sent so just to show you guys
that they are we are going to want to do
I'm just going to create a dummy
variable here and do scoped params
equals state params okay and save that
and then put a paragraph at the bottom
here that says params alright so let's
go to our search page let's preview this
and let's see how we're doing
okay so named Bob favorite color orange
favorite pizza pepperoni find matching
surveys we actually didn't link the
button up to the search so let's do add
an angular directive to the button ng
click there's going to be that search
parentheses function that we did earlier
okay let's preview that Bob orange
pepperoni fine matching results and we
see we got named Bob favorite color
orange favorite topping is nothing we
must have not passed that correctly
let's look at our search results here
favorite underscore Pizza favorite
underscore pizza results page is put
favored toppings so favorite pizza
instead of favorite topping alright
because it's only getting accept so good
thing to know here if you pass
parameters to a page and you haven't
defined them they're not going to get to
the page you have to make sure you
define them in here correctly so
favorite pizza not favorite topping now
if we go to search and we'll do a simple
one here we're just going to set topping
to pepperoni and make sure it goes
through we will get favorite pizza
pepperoni can we go back to those
results now the interesting thing is the
results page here still exists and
that's still going to go and get all the
results but here we are linking to that
same page but we're staying in the
search tab with a back button back to
our search page and that's all handled
automatically by creator for you all
right so now that we've set this stuff
let's go to results and let's first of
all delete this little indicator here
that helped us out and let's add in the
ability to instead of all let's add a
query option okay that uses these
parameters that we've sent as the query
so let's go back to the shih-tzu
documentation here and scroll all the
way up and here let's do let's see they
have get slash search so let's see what
get slash search does it's our standard
API slash search and it says that we can
have column and names in each request
handled as get parameters so here's how
it looks it looks question mark whatever
we're looking at equals whatever we want
it to equal and more different options
as we go along soon we need to turn
those route parameters into a request
like this that we handle through our
service so let's go back here and let's
go back to on to our service and let's
start adding search function in here I
mean you just make sure I'm copying
things over right we as that search will
take four
Rams okay now we are going to go to
results here and we are going to change
this load data function okay so we're
gonna do an if statement on whether or
not we have been passed any parameter
equal to an option that is not blank so
we will do scope params dot name or
scope dot params dot favorite color or
scope type params dot favorite pizza so
if any of these options have a value
other than nothing we're gonna want to
call a separate function we're gonna
want to call survey dot query okay we're
gonna pass those scope dot params to it
dot then function and that function just
like all is going to get a response
where we do scope dad's surveys equals
that response so we're doing almost the
same thing but we're setting off to
query instead of all so let's go to
services and let's write this website
called it search so let's call us query
query function params okay and we have
to turn the object that we've gotten
into a URL that we can send okay so
we're gonna do VAR actual params is
equal to a list and you'll see what I'm
doing in just second here we're gonna do
for VAR the key in the params we've been
sent we're gonna do if params K so if
the value of every program if it's not
blank we're gonna do with actual params
dot push so we're pushing an item onto
this list where K plus the equals sign
plus params K so that will do you know
name is equal to Bob we're adding that
to this list so at the end of this we
have a list full of our parameters so
let's set actual params we're going to
override it here is equal to a question
mark plus actual params dot join with
the ampersand okay so this will create
question mark name equals Bob and
favorite color equals orange okay we're
building this URL that we're going to
send to shitzu so now she too
said that it was a get request to slash
search with this data at the end of it
so we are gonna return HTTP begin our
API URL from above plus slash search
plus actual params that we are going to
send dot then function RESP return
filter blank rows just like we did in
our other query we don't want any blank
rows to be returned just in case rest
data and we're gonna save that alright
so if all goes well we're gonna pass an
object turn it into like a URL like
string send off a search request and get
no blank rows back and then we're gonna
display that in our result here so if
anything is set we're gonna query to
this function and get everything back
from the database okay so let's look at
our database real quick right now we
have a frank orange and pepperoni let's
add a couple of results in here manually
so I'm gonna add for Bob his favorite
color is actually yellow he likes
sausage ok and let's have some overlap
here so let's do 6 his name is or her
name is Sally let's do an overlap here
so let's make two of them have yellow
and let's make two of them have
pepperoni okay so now we've got three
results in there in our database so
let's just go to our results page let's
preview it make sure all three of them
load and that they look appropriate so I
know my data and the database looks good
so Sally likes pepperoni Frank likes
pepperoni too but his favorite color is
orange Bob likes sausage but these two
are both yellow okay so let's go through
actually I could preview there let's go
over to the Search tab and let's do
favorite color yellow now yellow is
going to get past that other page we're
gonna call dot query and we should
hopefully only get back the two people
that have yellow now we could also do
yellow but name is Sally and send this
off that should only get us the one
result now we can get rid of Sally here
change yellow to any color change our
topping to pepperoni hit Search we
should only get back to two people that
like pepperoni so as you can see we
could even do two here we get pepperoni
and yellow by matching survey results we
only get back the one correct result now
this still works with our delete
functionality and everything because we
use the same
troller both of these results page are
tied to the same place now you might say
maybe we deleted one of these and I want
to refresh my results so the last thing
I want to show you today is our
pull-to-refresh functionality that you
can get on any list ok so here's what
I'm gonna do on the results page we are
actually going to add an HTML snippet
alright let's actually take the list
okay we're gonna move this list below
HTML there we go okay so move the list
to below HTML now I have this HTML at
the top right but we don't want this P
tag we don't want anything here we are
gonna want to use the ion refresher
element from the ionic 1 ducks so all I
did here is I you know googled for ion
refresher from attic or you go to our
Docs see all the different things that
are available to you and we can see that
ion refresher has to be the first thing
inside of ion content ok and that then
we have to give it a non refresh
function some pulldown text and then we
also on that refresh function have to
make sure we broadcast a scrolled out
refresh complete so let's do all those
things
let's here ok let's go and do this
okay so ion refresher ok and here we
want pulling - text equal to pull to
refresh dot dot and we will do on
refresh is equal to that load data
function that we have in results the
results that load data we're just going
to recall that load data function ok so
now we need to go here and we also need
to broadcast that event that they wanted
to broadcast so let's just copy this
straight from the doc scope dot
broadcast scroll that refresh complete
we're gonna add that to both of our
callbacks here alright so let's preview
ok and here's our results page and just
to show you this we have Sally we have
Frank we have Bob let's go here and
let's just manually delete Frank from
the database without telling without
deleting from here so we know Frank is
still there now when we pull and refresh
we're gonna see that refresh
icon as it goes there it refreshes and
now we have our new list we can do this
same way where if we add Matt's favorite
colors orange he likes cheese pizza
submit we wait for that to respond now
our results page doesn't know about Matt
yet so we refresh and now Matt orange
likes cheese is at the top of the list
so overall we did a lot of stuff in this
tutorial but our survey app is getting
very close to complete ok now we have a
results page that shows you all the
results we can delete those results we
can actually search and narrow down
those results from the Shih Tzu API so
we're very close to done in the next
tutorial series I'm going to show you
how to do some stuff like maybe
error-handling we're gonna do a few
minor tweaks to this and then we're
going to call it a complete app so
overall I hope you've enjoyed kind of
this second part of our api's series and
I look forward to catching you guys next
week</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>