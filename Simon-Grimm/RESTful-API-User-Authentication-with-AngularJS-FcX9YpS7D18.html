<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>RESTful API User Authentication with AngularJS | Coder Coacher - Coaching Coders</title><meta content="RESTful API User Authentication with AngularJS - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Simon-Grimm/">Simon Grimm</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>RESTful API User Authentication with AngularJS</b></h2><h5 class="post__date">2015-12-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FcX9YpS7D18" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everyone what's up this is i'm from
deaf tactic today i will show you how to
create a easy front end with angularjs
for accuser authentication inside an
ionic app and this video is the second
part of the series so if you haven't
watched the first video make sure to
check it out i will print the link
inside the box below this video so grab
that little back end with nodejs and
MongoDB so you got this little server up
and running this is for signing up new
users for locking authentication and all
that stuff using REST API alright and
for this video I already started a new
blank ionic app like this and I also
edit some files so I added a constants J
as controller services J s and also a
templates folder with four templates so
if you want the complete structure also
check out the blog post there's also
little image of this and I also started
with some coding so I edit all of those
three JavaScript files inside our index
and I also change the body of our index
to be an ng app which is standard and I
also assigned an controller which is a
controller all around our app and inside
we only have a UI view so all of our
views will be rendered inside here
alright let's close this as I said I
already created a Constance J s this is
to have a defined event so an out event
in case the users not authenticated so
we can easily broadcast this event I
also edit a constant
or the API endpoint and this is
interesting because it's pointing to
eight one zero zero but in fact our
back-end is running on port 8080 so why
not 8080 because we will get course
issues inside an ionic app when we serve
this and try to exist
port 8080 because ionic is running on
this board so therefore at this URL and
also open the ionic project file inside
your project and add this little proxy
snippet so whenever we call an HTTP
request with API our proxy will route to
80 ad API and this helps to contact our
local REST API you can check it out on
my blog you will find all the stuff
there again all right so those are the
constants and I already explained our
index let's see inside the controllers
we have four little controllers we have
a login control or handling the login we
have a register control for the
registration we have an insight
controller which is in fact the member
area or the inside area inside our app
and we got this app controller I already
assigned to the complete app surrounding
everything okay inside the services we
got an hour service and this will be
very much like in one of my tutorials
before so if you've seen the angular
hours tutorial you will know a lot of
this code also the out interceptor for
caching yeah for catching some HTTP
requests we will see what comes in here
later
and finally we push our out interceptor
to the HTTP provider which means they
also intercept
starts to work once we have pushed him
and he will recognize all those events
all right so our fjs is clean and first
of all let's start with some views so as
I said the index only shows something
inside here and our outside view is ion
enough right I only need the bar all
right so this is the first time I wanted
to use this and now it's not working
perfect so outside we want to have bar
because when we navigate to the register
we want to have a back button and this
will make life a lot easier
interesting I have everything inside but
not this but we have ion enough back
button and we will make it a clear
button with an iron left yes just like
this we can remove the back so we just
have this little back arrow all right so
this is our navbar and inside we have
okay so enough 5u is okay whatever so
below the enough bow we have tuned up
view slide left right and the content
will be rendered inside here we can also
start already with a little bit of code
for routing so in your fjs put in a
config
so state provider and also the URL route
provider and state provider touch state
so we define the states for our app and
as I said the outside state is what we
see when we open the app so the URL is
well slash outside this is an abstract
state because all of our children will
be rendered in this or all of the
outside children and the URL is
templates slash outside dot HTML okay
the next state will be outside lock in
so this means this is a child state of
the outside state and this lock in state
will have again I'm lazy so this will
have the URL login it's obviously not
abstract and it will use the lock in
HTML and it will also have a controller
which is our locking controller all
right yes it's the problem and also we
can define what happen if nothing is
matching so put in otherwise and this
will be slash outside slash login so if
no root is matching we go back to login
just in case all right
our outside as I said is the base for
the locking and the register view so
let's go to our lock in
you inside the lock in view we will have
an eye on view thanks title is please
sign in and we got some content let's
put in a bit of petting as class and we
want to have a cool login interface so
again let's apply some list styling and
some labels
and inside the label we have our input
type text first of all placeholders name
and we will assign this value to
username inside our controller later on
okay we need a second one but this one
is type password well you won't see the
placeholder but anyway you will see some
stars at this point alright so those are
our two labels and below we have a
button which is a button full this looks
pretty cool and let's make it green
because this is our login button saying
login and right below the login button
we want to have a second button but this
time it's a button clear button positive
yes button full as well and this will be
a you is rev to the state we will create
very soon which is the register state
and let's say register now on the button
so this uses the states we defined and
this will bring us to the register state
all right I think we can already serve
this
let's give it a try
yes and there it is so our login view is
rendered inside this outside basic
nephew and we all have this register
login and our input field with some
padding perfect just like we wanted to
have it okay
we can also make it a bit shorter yes
like this and code next to it this looks
fancy I love it when people do this in
their videos so I will do it as well all
right the register view is a lot like
the look in view so let's first of all
copy this and say create a new account
which is the title up here again we have
a username and a password but this time
we only have one button yes can stay
like this but the action will be sign up
and it says sign up ok so right now this
is not yet connected inside our state's
so let's jump to our app j/s and craft
another state which is register and
obviously a different URL a different
template and a different controller so
let's see create a new account with all
our fields sign up and the back button
taking us back to the login so this is
exactly what we wanted to have right now
before we jump into the code let's
finish up with our inside HTML so this
will be an ion view
again I love this so this will not be
inside our outside HTML this will be as
you can say right inside the UI view
because it won't have a parent state but
this is no problem
we still want a ion header bar and so
this one will be member area which is
just like the title in our I love yous
and button will be a button clear with
an ng-click event for lock out and it
should also say lock out alright this is
the header bar inside our member we
currently can't access there because we
have not defined the state but yeah hold
on we will come to this soon
all right so we will also have content
some padding
and inside this content we first of all
want to have a little card to display
some information and this information
will come from our controller or come
from our back-end later on but right now
it's empty and we will also have two
buttons so a button full an assertive
button because this will destroy the
session and this is to demonstrate how
our app is really working I will show
you what this performs later on so we
have a second button this time again
balanced everything is cool with this
one and this will get our member info if
you've seen the first video or read the
first article you know that this will
grab a string from the back end with a
little greeting and the username but we
can only get this if we have an hour's
taunton set on our request so this will
only work if we are locked in or if we
have the JSON web token inside our app
alright that's the complete inside view
maybe we will come back to the later
first of all let's define this last
state which is not a child state but
only inside
and this is inside inside HTML and also
inside controller all right perfect
now the fun begins
even more so we need a service which
will perform some actions with our
back-end and I already have the code so
let me just check it out alright so this
is a lot of code and this is much like
in a previous tutorial so I will paste
it for now and let's go through it so
this is our our service it returns a
login function register function a
lockout and is authenticated which
returns just the variable is
authenticated
alright so unlock in will return a
promise and let's make this big again we
connect to the API endpoint URL which is
this one so it's slash API slash
authenticate and it passes the user
object and if we get a success from our
back-end we're a successful logged in
and our back-end returns the total
inside this data object which is the
JSON web token denzel's and resolve the
promise
otherwise we reject the promise with the
message we got from the backend so our
store user credentials method only sets
this item to our local storage using
this key so you can put whatever you
want inside there and also uses our
credentials and how to close this again
use credentials says okay the user is
now authenticated and the old stalking
is the totem we just got and the most
important part is we set this auth token
as default headers comment authorization
so this might change in your case if you
have a different back-end this might be
exhaust talking or whatever string for
my little note J as back end this is
exactly what the note backend expects so
very important line let's go through the
other methods destroy user credentials
well set everything to undefined false
removes the keys sets this key back and
register just like lock in contact the
API slash st. sign up with our user
object and again if we have a success
where you solve it otherwise we reject
it all right logout function calls this
and one more special thing we're not
using right now that this is copied from
the first tutorial when the service
loads it also called load user
credentials and what load user
credentials does is looking for a
storage token inside a local storage and
if we got this token we call again use
credentials just like in the other cases
so on startup of your app or whatever
you could check if the users already
authenticated and just pass the lock in
so the user does not have to lock in
every time again but check out my other
tutorials on how to use this for now we
will just leave it like it is I hope
this was not too fast and you can check
out the code also on my blog or download
it directly from there but this is very
straightforward or well not very
straightforward but it's just like
before there's nothing really new only
that we know contact a real API
instead of a dummy back-end so let's
take a look at our house interceptor
again this is also just like before and
this one will have a little function
response arrow so inside here we say
route scope broadcast and we broadcast
on 401 art events dot not authenticated
right um yes that's the only thing we
need and we need to check the status of
the current response so this might be a
bit critical I will explain what it does
in a second after finishing this line oh
sorry
okay is there yes this might be too much
all right so what does this ours
interceptor whenever we'll make an HTTP
request we will get some response from
the server including the status and if
this is like 401 we obviously are not
authenticated to access that resource
which means well the user is not locked
in and in this case we broadcast this
event so our app controller or whoever
is registered on this event will catch
it and handle it this is important
because we don't want to have UI logic
inside a factory or service so we just
want to say hey there's a problem users
not Artic ng authenticated please handle
it and the way we do it is inside our
app controller which is as you know
assigned to our body
let's go back to it and put in scope dot
on earth events not authenticated a
function this should be event and what
we do is we call please log out the user
although the session might be over the
credentials are invalid whatever still
call logout just to be safe and we also
say state dot go back to login users not
authenticated he needs to login again
and we also don't want to do it yeah
without informing the user so put in a
little Lord and say title session lost
and also a template sorry you have to
login again alright so this is the app
controller to catch the not
authenticated event before we come to
our other controllers let's put in one
more security feature so go to your fjs
and put in a run config and this will
also need the root scope the state the
our service and our out events and
inside this block we want to check for
another event which is called state
change start I also have this in my
other tutorial and this is to catch
whenever the state changes so if you
navigate to any point or especially if
you change the URL inside or from
wherever you might be able to change it
so then this will event will get
triggered and at this point we have to
check if our current user is
authenticated because if he's not
authenticated he is not allowed to
access some resources and the only thing
or the only time he is allowed is when
the name of the next root is outside dot
login
or so I said this all in the complete
opposite but I will tell you why in a
second so if the user is not
authenticated and he wants to go to
login
we should not prevent this event or if
he wants to go to register I'm not sure
if this might be an or so if the next
name is login now this is fine
so if only one of those would be true we
will have a problem so whenever one of
those things is true we don't want this
to happen and this means when the user
is not authenticated and tries to access
inside or anything else than those two
things you will be not allowed and he
will be sent back to the login page and
this is exactly how angularjs handles
authentication or how you should handle
that authentication this is very
important you have to make your back-end
sure as well but this is the best you
can do to secure your front-end all
right we can close our fjs no more
changes there the constants also yes
all right so now we only got our few
methods so first of all we need to have
user object on our scope because we
called ng-model
username and password so give this user
a name and also a password and unlock in
we don't have to do very much because
our all servers we'll do everything we
need and again this is the best practice
logic for handling stuff should be in
the services the controller is just well
the middleware between our login view
and the service so okay if the login is
successful we are very happy and can
send the user or interesting what is
this well we can send the user right to
the inside page and if for some reason
there's an error we got the message from
our back-end and we copy the little
alert pop-up and this will say login
failed and we can just use the error
message for the user in this case all
right so this is everything we have to
do for our login and all right we should
use scope that user obviously and let's
copy this because the signup is more or
less just the same but we call register
with scope user the register obviously
also need a user object and okay
register fail with error message add one
success we want to guide the user back
to the login page and what we also want
to do is let's promote the success to
him so he knows what's happening he's
not only guided back as you can see the
controllers are really really short all
of all logic is inside the services and
this is just like we want it to have
now if the user is for some reasons
inside and we have this little get info
route we make an HTTP request I'm not
putting this right now into our services
because this is a very cool class and
boilerplate you could use so I don't
want to put any of this dummy demo logic
inside that one but obviously you should
have some service for this like yeah
server manager which handles all of your
requests or something like that in place
remember the inside template we had this
member info inside the card and now is
the time we set it to resolve data
message okay we don't have to take care
if this request is successful or not
because if it's not successful it will
be broadcast at an event with not
authenticated so finally unlock out we
just need to call also I was log out and
we are very kind because we take the
user back to outside the login if we
don't want to stay inside our app so now
I only have this destroy session on
which we will call lock out to see what
will help and I think we are finished
right now so let's see I open the
console because who knows so let's see
it don't pass anything all right
user not found that's totally true
so let's register Simon know how to fill
and let's say the password is test ok
successful created user and we're back
on the login page now let's see Simon
know out of here come on
test no I don't want the password saved
so we're inside a member area because a
login was successful
we got the logout button we got an empty
card to destroy and get memorable let's
give it a try and this is coming
straight from our back end as you can
see this was the request I can do it
again and again there it is so here we
have it and let's see we destroy our
total nothing happens right now but if
we want to get the member in for now we
do not have a valid token anymore and
this is exactly what happens we get a
401 from the back end and we get
broadcasted event this session is lost
which we have defined right inside the
yes session lost right there as you can
see we got a beautiful login with
register page and egg button we can lock
in e inside the member area you could
obviously craft many more views inside
and make sure they are all inside you
could make an abstract in stay inside
state and well yeah that's in general
how user authentication with angularjs
and the node.js began works so I hope
you like this little series I would love
to hear your feedback about it
or if you want to see anything more
about those logins stuff and I would be
really happy if you subscribe to my
channel right now to follow on more
great tutorials like this and also make
sure to check out my ionic or
if tactic courses on courses def tactic
on the link will be below this video
stay tuned happy coding and see you next
time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>