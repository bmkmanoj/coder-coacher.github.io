<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make iOS In-App Purchases Inside Ionic | Coder Coacher - Coaching Coders</title><meta content="How to Make iOS In-App Purchases Inside Ionic - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Simon-Grimm/">Simon Grimm</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make iOS In-App Purchases Inside Ionic</b></h2><h5 class="post__date">2017-07-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cmuD9KG0PVs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everyone Simon from deaf tactic and
the ioniq Academy in this video I will
show you how you can easily integrate
in-app purchases to your ionic app and
in specific we will do this for iOS for
Android it's a bit different so perhaps
we might cover this in a later tutorial
I started a blank in you app and the
first thing we need to do is actually go
to our iTunes Connect app so I have one
existing app which is on the App Store
or I have more apps but I took this one
and you have to go to features in app
purchases and from here you can now
create new in-app purchases which can
then be consumed from your app and there
are a few different types so consumable
like fish food something like coins for
your app non consumable which is
consumed once and does not expire so for
example you unlock levels or you disable
ads for your app and then there's
subscriptions Auto renewable and
nonrenewable and you can create whatever
you like
perhaps we create this one but I've
already created one just showing you how
it looks once you create it so you have
to add a name and a product ID and this
Product ID is actually important later
and we got the pricing we got display
name a description and you need some
screenshot I'm not completely sure sure
where this will show up but I've created
already three so consumable non
consumable and a subscription and from
the product ID you can see that the
first part is the actual bundle ID of my
app so come deaf tech tech crossing
numbers this the bundle ID for the app
and then you as the name for the product
like at
and so crystal monthly level or a
special game mode and this is the name
and they have some description and it's
enough to have them safe we don't need
to submit our app we can directly test
this in order to get these in app
purchases we also have to make sure that
our app has this bundle ID so normally I
would be in the crossing numbers app
which already has this but as I started
a new app I have to go to my config.xml
make sure that my ID here is the bundle
ID of my app because otherwise it won't
work later on ok so this is the first
part make sure to have some purchases
set up for your app inside iTunes
Connect and have the correct bundle ID
on your app then we can go ahead and
install the Cordova plugin which will
give us access to our in-app purchases
and we can use this plugin for both
Android and iOS I said before setting up
the purchases for Android is a bit
different but the plug-in is the same
also the ionic native NPM package of
course and once this is done we can
close this and go ahead to import our
in-app purchase from add ionic native
in-app purchase and also edit to the
providers just like always so now we are
ready the config is set and we can go to
our actual page our app should still be
running somehow but of course we can
directly test our behavior inside the
browser now so first of all let me copy
in 3 constants here and as you can see
and these are the product IDs of my
items and you need to have them inside
your app because we need to query
the iOS iTunes Connect app store for
these elements and then we will get the
data back so it's a bit a different flow
and let's go ahead and also add here and
the platform because as we only have
this one controller it's a good idea to
check if the platform actually is ready
and only then perform our stuff here
inside a platform ready event we use now
the in-app purchase plug-in so yay peeve
in purchase and we will see that we got
a few options here to buy consume we can
get products we can get a received I
think this only works on iOS I'm not
sure restart and subscribe but first of
all we need to get our own product and
here we will craft an array of our
product IDs so I specify them at the top
because we need them again later on
perhaps you can put this in a different
file as well but you need them then you
will hopefully get some a product back
from the in-app purchase plug-in so this
will give us an array of more
information and we will keep them inside
our class so this dot product was
products I can also perhaps lock the
information here so we can see later
what we get in our array of course we
can also add a catchy vent just in case
my era oh it's too early in the morning
okay close close close okay perfect so
this is the first pot then we got a few
functions we got a bye function with a
product and we also need a restore
function more on this in a second
and finally enable items for item
actually but let's keep it like this for
iOS I'm not completely sure for Android
is the same but we need to restore
button to allow our users to restore
previous purchases so perhaps from is
one iPad he purchased that he has this
special game mode and now if you're
locked in enya in his iphone we need to
be able to restore the purchase and
unlock the level again okay you don't
want him to purchase this again so this
is why we need a restore and finally
enable of course we need some way to
handle on the purchase so you we can
check against our keys again
so if he buys some crystals this is a
very super simple example so crystal
count is zero of course normally you
would have some kind of back-end where
you would increase the crystal count or
whatever the user purchased and how
example we will just add this up here if
the ID is the game mode key in that case
we will have something special game
which we can set to false and every
purchase is this we can set the special
game to true and finally we got the
what's it
something along monthly yes monthly
lower key and also monthly subscription
falls and now this dot monthly to true
again normally you would perform this on
your back end and reflect the changes to
your app but in our case we keep it
super simple also for debugging we add
previous purchases and once we restore
we will set them so inside restore we
can use our plug-in again and this time
we choose restore purchases we don't
need to pass in anything here we will
just get a promise back with a purchases
and we can set our previous purchases to
these purchases and also we should make
sure that we enable all of these
previous purchases start enable items
and it should be in Product ID hopefully
like this inside the previous purchases
we will actually not get a consumable
like this hundred one hundred chaos
crystal back so we will only get the
other stuff back so we're safe here to
call this function like this now finally
we got to buy function and this is super
simple now just called by with the
product ID so we need to pass in the
product ID to this function from all of
you and then we get a data back in this
data as you can see from the interface
it contains a transaction ID result
signature product type but in our case
we just call
our enable function again to enable this
product if you need to handle some other
stuff perhaps send it to your back-end
or do whatever you want at that point
and for Android this part is a bit
different because on Android we need to
call the consume function so after
purchasing a consumable we must consume
this product actually so it's marked as
consumed so this is a tiny difference on
Android and also sorry setting up the
items on your Google developer console
is a bit different than for iOS I think
it's even a bit more trickier than for
iOS because this is quite
straightforward just add your items in
you're good to go but anyway we still
need our view so let's go here ionic in
app and inside our content we first of
all at a simple ion row because we need
to display our well I call it resources
okay so our user gets some crystals so
this is the crystal count and then we
got two more second one is the special
game mode which can be consumed only
once or s restorable then so this should
be special game I home yes and then we
got the monthly subscription
and this is like this all right so we
can now display if our user has
purchased these things and update all of
them what we also need of course is to
show a Buy button for all of our
products so let's product of products
and these are the products we get back
from the plug-in and we will lock out so
we see what's contained but I can
already tell you that product has a
title and of course the product oh you
should write content right that the
content is the product that is
corruption all right and finally the
most important part of course is the Buy
button so button I on button let's make
it a pull up button and in this case our
click event cause our buy function with
product dot product ID so this will
again be this ID we've defined in the
beginning perhaps at some text by now
and then what's also important here is
to use the product price we get back
from the API so you might think oh I
know my price it's I don't know one year
or five heroes but it's better to use
the price you get back from Apple I
think this is also then localized for
the user so make sure to use that price
finally we need an option to restore our
purchases so add a button this would be
restore I think perhaps color is
secondary so a bit different and an icon
with the name of fresh so all of this
should look nicely now we can also
restore our purchases and the final part
is more or less just for debugging so
here we will print out our previous
purchases so let's prep of previous
purchases and again I own card header
purchased and this has now a date you
can use the date pipe at this point so
we got the purchase date and for the eye
on card content we just use the prep dot
product ID okay most of the time I have
some type error anywhere but let's see
if the app is still loading a code or
was not defined okay I couldn't care
less at this moment if you want to
prevent these errors you can use
something like this dot platform is and
then try cordova and completely sure it
if it uppercase or lowercase let's see
okay of course if it's called over okay
let's wait a second anyway if you change
your config ID bundle ID and you might
need to remove the platform so ionic
Cordoba platform iOS sometimes I get an
error with this so again I only
Cordova platform and iOS and we can also
see that our app seems to have no bigger
issues we got zero crystal the special
mode is not enabled and also our monthly
subscription is false so I think we
should be ready now know that some space
here yes now it looks a bit a bit better
and also tech Center just minor issues
ionic Cordova build iOS will build our
app and then we are ready to try out our
app on a device alright so on the left
side you can see my app on a device and
we can see that we got three cards with
our titles and the information we got
and also we've printed out this array so
we can see that we got the description
on the price the product ID and the
title for all of our items also my
mouths are disabled in the beginning so
what you now need as well is let's see
it
a sent box user for your app so go to
users and roles and there's a tab for
send box users and create yourself a
sent box user which you can use to buy
your own stuff so I will try to buy some
chaos crystals and now I need to confirm
my in-app purchase of what is it 1 100
KS crystals so let me enter my password
and buy this ok if I now hit by we are
hopefully back inside our app and yes we
are asked if we actually want to
purchase this and from button you can
see that my environment is sent back so
I'm not
anything here so I can go ahead and buy
it and you already see it was successful
and also our crystal count went up I can
do the same for the special game-mode so
I've actually purchased this before so
it's also recognized and then our game
mode turns to true because of our enable
function if I hit restore I get a long
list of stuff because I've tried out a
few things before recording this
tutorial but as you can see only monthly
levels on special game mode so the
consumable of our crystals is not
displayed again ok one more thing
actually I learnt this at the end if you
have some type of subscription and the
sandbox mode works a bit different so if
this is a monthly subscription the time
inside the sandbox is a lot faster so
I'm not sure how fast but I think
perhaps a week is five minutes or
something like this so you can better
test your subscription stuff inside your
app ok I hope you enjoyed this video you
learnt how to add in app purchases
through iTunes Connect how to load your
items through the product ID and also
how to actually buy and enable your
stuff so you can now build ionic apps
and let users purchase awesome stuff
because this is kind of like the current
way to make money with your app add some
work that good anymore and inner
purchases are actually what's bringing
in the money so make sure to subscribe
to my channel if you want more awesome I
own a coding videos and also make sure
to check out the ionic academy calm for
ionic training video
courses project and an awesome community
I'd love to see you there
take care and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>