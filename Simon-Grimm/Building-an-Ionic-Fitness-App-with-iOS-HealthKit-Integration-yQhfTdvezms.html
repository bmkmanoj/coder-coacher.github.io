<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building an Ionic Fitness App with iOS HealthKit Integration | Coder Coacher - Coaching Coders</title><meta content="Building an Ionic Fitness App with iOS HealthKit Integration - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Simon-Grimm/">Simon Grimm</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building an Ionic Fitness App with iOS HealthKit Integration</b></h2><h5 class="post__date">2017-08-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yQhfTdvezms" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everyone was up to the assignment
from this tactic and the ionic academy
in this video i will show you how you
can add the iOS health kit to your ionic
app so we will be able to add data to
our health kit app and we will also read
data from there we start like always
with a blank ionic app and we go ahead
and add first of all the Cordova plugin
for health kit and then we also install
the ionic native package like this for
health kit this only works for iOS so
health kit is only available on iOS
there's a different Cordova package
which tries to map both the health kit
and the Android version
I haven't tested that yet so you can
give that a try as well but in this
video we will only focus on iOS health
kit so first of all after installing we
need our ionic native health kit inside
the app module and right here and we are
good at this point
let's continue with our home layout so
let's call it theft active health and
inside our content we need a few input
elements so eye on item and the first
one is in label and this one will be set
8 so we will be able to set our current
hate from this F the input of the type
text will be connected to an NG model
and this will be hate and perhaps
placeholder Mary hate today might not
change so much but anyways you could
also of course that you await or
whatever you like
then we need two more but so this will
be the current hate and also be current
hate and we will also make this read
only because we will only pull some data
in from the healthkit app and display it
here and below our current age we will
also display our steps of the last 24
hours
so this is our step count then also read
only then we need two buttons iron
button full and the click event for the
first button is to save our hate if we
enter a new hate we will send this right
to our health kit and update our labels
and the second button will be to save
workout so there are few different
things we can do so we do some of them
in this tutorial they're all kind of
metrics you could read out and also
different stuff you can set so this is
just an example there's many more you
can check out the tutorial there's a
link to the iOS documentation but I
think these are some current common
patterns to save whatever property of
your body the step count is very famous
of course and the workout also makes
sense if you do some kind of sports app
and want to save your workout session
directly to the health Kiev below all of
this we will craft additionally tiny
list of ion cards and we will look over
all the workouts that we get from the
health kit so at this point there are a
few things we can read out from the
workout so for example workouts calories
and also if you create an ion card
content you can do all kinds of things
like activity and this will be the Apple
type of the activity so you might need
to wrap this later active with keep type
I guess and a few more for example the
duration which is the duration and we
need to divide it I think by 100 or by
60 I'm not completely sure
perhaps it's 60 if it's related to
minute 60 what make sense right so let's
hope for this also a start date in
combination with the angular pipe for
date and directly transform it and if
you covered some kind of distance you
can also show the distance but in my
tries I always got miles back so if you
need something else you need to convert
it at this point so this is our current
view and we see we can set our hate
these values are empty and read-only we
got set AIDS set work out and now we can
continue to our home TS and implement
the actual logic first of all we try or
we need the platform and of course we
need the health kit so import both of
them at the top of your file then we
have some properties we had the hate we
have the current hate which reflects the
value we get from the health kit so in
the beginning perhaps no data and then
we also had the step count and an array
of workouts good so far so now we need
to use the platform very quick today I'm
sorry ok let's make this a bit slower
now so we try and check if the platform
is ready because we need to ask for some
permissions of the health kit we could
do this at a later point but I'm doing
it here so you know how you can use it
so first of all you need to check if the
health kit is actually available and if
it's available available then we try to
request some authorization for different
properties and let me copy this in
because quite a lot of typing can also
import it from up here and this options
now means we want to read all of these
types and we want to write to these
types so let's see we want to read the
hate the step count on general workouts
we want to read a negative energy burned
and distance cycling because this will
be needed for our safe workout later and
we also want to write the head we want
to write workout energy burned and
distance cycle you can find all of these
identifiers on the page of the blacken
or on the iOS page so now we call our
healthcare again and type request
authorization for all of our options so
this will bring up a dialogue to the
user if he allows that we read and write
those data from his or her healthcare
and if we're fine we want to call our
load health data function
so if this is successful we call this
function okay this is the start but
let's before we load then let's make the
easy stuff so to save the haze it's
actually super simple we call again our
health care we say safe hate so there
are some specific functions for those
kind of things and we need to specify a
unit I'm in Europe so I have like the
normal part of the world centimeters and
also we need to pass in the amount which
is the hate we did set in our input
field so once we're done with this we
again reload our data and this is
already it you can also set the hate to
null after sending it or saving it so
the input field is cleared again then we
got work out so work out is like a
session at the gym
cycling spinning whatever swimming all
kind of things and before it's a bit you
need to create this workout object with
all the different parameters it's only
typing so let me copy it in and explain
it
we got the activity type tivity type in
our cases just cycling then we got the
quantity so we want to specify the
distance of cycling start date is today
and date now not needed when we're using
the duration a duration energy burned
the unit of b energy distance and the
distance unit so you can specify
basically everything you need to track a
solid workout and then you call
healthkit again and say safe workout
with our work
object and just like before after saving
it it's time to call our load health
function to reload our values okay we
can save the hate we can save a workout
we got B all the read and write types
set up so now we only need to fill all
of our different fields from our load
health data function and restart with a
hate because this is quite simple I
think it's read exactly they see read
weight is also possible but we want to
read the head and again unit centimeters
then we will get back an object and this
object will contain a value and a date
when this value was set so we need to
use value of that object also I got some
arrows all the time so perhaps put an
error log here but as far as I know this
just means we were not able to get any
data for what we requested so hate
weight workout steps whatever to receive
our step count we again need a little
options object and in this object we
need to say the start date and the end
date so we know in which duration we
want to get the step or the step count
so the start date and make it to 24
hours ago so new date from get time and
then then we need to subtract 24 hour 60
minutes 60 seconds
in JavaScript and the end age is in that
case just now we also need the unit
which is count very simple
and finally the simple type of this is
okay let me copy this before I make it
wrong quantity type identify us Def Con
that's exactly what we also specified up
here for our permissions and once we got
this object we can go ahead this dot
healthcare and now we call something
query simple type is there some
explanation well not really but this
query our healthcare app with the query
options we specify here and in this case
we will get back an array of lock
entries of our step count so we got like
quantity 5 at the day 2015 and all these
locks of course we want to sum up this
data so we use reduced on the array we
got two values a B and we want to always
add from the second the quantity and the
initial value is zero so you could also
do this as a for loop but we just use
reduce now we can set our step count to
be calculated steps on and finally at
the error message just for our lock and
so we don't get any JavaScript error
okay we hate what a bit easier because
it was already defined but query sample
type allows us to query different sample
types units states whatever and make our
queries really flexible to get all the
data from health care that our F needs
finally workout is actually again
function and we will get back all the
workout data from our health kit app so
again this is some kind of area array
and we set it to our workouts now I'm
not completely sure why but for some
reason I got and the result of fine work
out inside the arrow block this is
somehow confusing I'm really not sure
why this happens but setting our work
out array to this array fix us or yeah
it's a workaround so perhaps you could
check if for some reason you still get
an array back inside the arrow block and
set it then I will just do it like this
so we can see our data again I'm not
sure if you don't know why perhaps add
an issue on the github page or something
I will also change my name here my app
ID just because I don't know I had some
problems with my Xcode profile so I had
to change the name to get everything
working now we're ready and we need to
build the app for iOS because inside the
web preview you can see Cordova is not
available so this won't work on a
webview
this is only working for iOS I'm pretty
sure you're on a Mac otherwise you
cannot build for iOS if you are on
Windows so let this build run through
and then we will check our app alright
so I've deployed my app through Xcode
and there's one thing you need to make
sure so when you open the project go to
capabilities and enable healthkit down
here I thought this was automatically
enabled through with the Cordova plug-in
but it is not so make sure this is
checked for you otherwise
it won't work now our app is up and
running
and you can see that on the initial
start I get requests to allow access to
all this stuff so we got the right
permissions and we got the read data
permissions they're a bit different just
like our arrays were you can turn all
categories on and then allow access so
we see for the hate I haven't specified
anything so we get back this arrow of no
data and for workouts also an error with
an empty area so let me set my hate to I
don't know 100 like this and then we can
see my current hate directly switches to
this new hate also we can see my step
count of the last 24 hours
yeah it's a bit low I made some
tutorials
I feel bad I'm going to sport after this
video so we were able to set our hate to
receive a step count and now let's also
set a work out so as you can see for
some reasons I get it inside the arrow
block but this is the data for our
workout and you can also see it right
here
the activity type is exactly what we
specified when we start our activity and
also we see duration 100 minutes oh yes
I think it's right they'd also miles
okay so this is all the data here but
let's check our health app now so here I
am in my health app and if I go down you
see my hate is exactly like I locked it
and also if we go to work out and we
find a work out and we see it's our work
out type in the duration the start time
the calories burned and all the locks as
we sent them from our f
so that's already it for today I guess
just to recap make sure to request your
everything you want to read and write
perhaps do it upfront so you just have
this dialogue coming up once if you
don't do it it will come up when it is
needed but this can be annoying if it
comes up like five times
saving your hate is pretty simple saving
a workout needs a bit more constructed
object and finally loading our data it's
also quite easy with some predefined
functions and also with a query simple
type where you can create your own query
for a time and a specific sample type to
get all your data so then you're in sync
with the iOS healthkit app you can put
your data there you can read data from
there and you can build all kinds of
cool fitness apps so I hope you enjoyed
this video if you did make sure to
subscribe to my channel and also check
out the ionic academy com if you want to
learn I on ik with videos courses
projects and the community so you become
an ionic developer I'll see you next
time have a great day and take care
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>