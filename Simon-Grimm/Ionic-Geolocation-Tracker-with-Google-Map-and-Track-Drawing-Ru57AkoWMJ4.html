<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Ionic Geolocation Tracker with Google Map and Track Drawing | Coder Coacher - Coaching Coders</title><meta content="Ionic Geolocation Tracker with Google Map and Track Drawing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Simon-Grimm/">Simon Grimm</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Ionic Geolocation Tracker with Google Map and Track Drawing</b></h2><h5 class="post__date">2018-05-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ru57AkoWMJ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everyone what's up to the sign from
deaf tactic and the ionic academy in
this video we will build a cool ionic
location tracker so you might know apps
like runtastic or other fitness apps
that track your GPS position while you
do a walk outside and that's basically
what we will build today so I've started
a blank new ionic app and first of all
we add a cadaver SQLite storage plug-in
not so much related to the actual topic
of this video but we will use this to
store our previous walks or runs or
whatever it is just the GPS coordinates
so we can load them back again because
we also want to display a Google map
with the actual path so we have both GPS
tracking and watching the location and
then drawing on a Google map inside this
video ok first plug-in was storage
second plug-in is the actual geolocation
plug-in and you also need to specify a
very able for the geolocation usage
description so whatever to track your
walks or whatever you want to specify
but that is not all for iOS and we come
back to this in a second for now finish
this by installing also the ionic native
package of course I said it's not enough
for iOS because you will get a warning
or error when you upload your app
because there's something missing inside
your plist file and you can fix this by
going to your config.xml and inserting
this little piece so what this does it
basically edits the configuration inside
your plist which will be merged and the
most important thing is this so NS
location when in usage description I
like the variable names on iOS so we set
this to a string and then Apple is happy
because we've specified why we're
actually using this description and when
you now run
I only cordova built iOS you will always
get this entry automatically right
inside your plist so this also this
approach with edit config also works for
other targets in here but we just need
to write this right now all right we've
installed the geolocation plug-in and
therefore we also need to edit inside
our module geolocation from an ionic no
auto-completion today there it is
geolocation and then we also want the
ionic storage and therefore we need the
storage module from add ionic native
storage and if you spell it right you
also don't get any error all right put
it to your imports for route and then at
the geolocation to the array of
providers so geolocation goes there now
we also want to use a google map inside
our view and that's actually pretty easy
the only thing you need to do is go to
your index.html a file we rarely open
and put this little snippet in here so
this loads the SDK for the Google Maps
and you also need a key for this I think
it also runs in the browser without a
key but it is better to get one I think
on the real device you would get an
error otherwise so you can easily obtain
one simply check out the tutorial link
below this video and there's also at the
position where we add this link to the
Google page I can also bring it up right
here so whatever develop as Google Maps
documentation javascript get API key and
then you will simply get a key for one
of your projects okay let me get this
and then it's time to go back to our
actual home page
so our view consists of three areas I
would say but first let's add a bit of
color because it's always good when
they're already it looks nice so first
of all we have a button at the top to
start our geolocation trekking you can
imagine something like start my run or
whatever and unclick we will call start
trekking and I on I can name perhaps the
locate icon and then start tracking also
we only want to display this button if
we are currently not tracking so nut is
tricking we will add this variable later
and then of course we need a second
button which will be displayed when we
are trekking to stop the actual walk
let's use the hand icon and let's call
stop trekking then this is the first
part to start our trekking then we got
the actual Google map and this is
basically I don't even know if we need
ID map I don't think we need this this
is simply a div and we will fill this
using view child inside our class in a
second so that's the area we will
display the google map in then finally
below this we will also add a list where
we can show our previous blocks and load
them back into our views so let's call
this previous tricks and then go ahead I
on item ng for let root of previous
tricks so we will load them from the
ionic storage and then display them
inside this nice little list we will
also add a bit of information so we will
add a finish date so we can see what's
going on or when we have added the book
and then also the root will
have an area of coordinates so let's
show how many waypoints we've added to
this more or less for debugging reasons
I guess this wouldn't be is super
interesting for a real user and then at
the end of this button let's add a
little click event to show history route
and then we pass in route that path
which will be the array of the waypoints
and let's call this mute I can also
start the ionic flap I think because
that's basically what our view looks
like and then for the map we should also
add a little bit of styling so let's
make it 100% in width and then this is
also the app as you can see the map is
not really displayed by now so 100 and
hate whatever 300 is it there oh yeah
that's why I had ID map I think all
right so there will be dragons there
should be a map somewhere and soon so
let's go to our home we're finished with
a app module setup process we're
finished with a view and we can focus
now on everything else that we need to
implement let's start the controller by
setting up the different properties so
first of all we need a view child which
is map so we can get our map element
which is of the type element ref auto
import pretty cool today huh then if we
want to use our google map we need a
little trick up here you have seen this
before perhaps just to prevent some
typescript errors when we use something
with Google I'm also not sure if there's
perhaps already types for note
perhaps you can leave a comment below
this video also we want to have a
reference to the map later on and also
to the current metric so this is what's
currently printed or drawn on our map
and we will fill this later this
tracking is false in the beginning we've
used this inside our view and also the
currently trek route is an empty area
where we'll add the different way point
also we keep track of previous routes so
they will be loaded from the ionic
storage and therefore they are also
empty in the beginning and finally we
got a position subscription so this will
be the subscription can I use import
here perfect
this will be the subscription to the
geolocation plug-in therefore we can
start it set it and then in the end
unsubscribe again so we don't waste
anything from our precious memory so we
also need the platform to know when we
can use the ionic storage we use the
actual geolocation plug-in which we've
installed that was the wrong import
geolocation there it is
then we need private storage of course
which is not this storage but this
storage and then we might also perhaps
let's do this in a few more lines then
we might need the alert controller you
never know you always need an alert
controller at some point in your app ok
so let's start with Ione you know I am
you did load an inside eye on view this
load we check if our current platform is
ready
and then we can start by checking our
storage and see actually let's craft
this in another function let's call this
load historic roots and let's simply
call this because it's not really super
important in the beginning but we want
to get the roots and then when we get
the data back and if we actually get
data back we will set our previous
tricks previous tricks where is the
previous tricks
I spelled this wrong so previous tricks
equals data and then we've set them and
our list will be displayed at the bottom
and we don't have to think about this
too much now all right but also what's
more important in here is setting up the
actual map with a few map options so
let's craft a new object called map
options and this is the object we want
to pass to our new Google map and we
also created this variable which is of
the type any to have a reference to our
new Google map and we can do this by
calling new Google dot Maps dot map so
this is a bit tricky as we've just used
this through declare VAR Google but this
works it should work if you've imported
the SDK within your index.html and then
we pass our element native element and
also the map options right to this call
and then our Google map will be
initialized for the map options you can
have
I don't know many things but let's start
by using a zoom factor by using a map
type ID and this could be googled maps
that map type ID dot Road map so this is
just a basic road map and then I also
wanted to disable some of the controls
because you don't really need them all
the time like Street View control
odds full screen control lots of faults
we don't need all of this and this is to
change between different types of map I
also wanted to disable this alright we
got the map setup and now we can also do
a little trick in the beginning to get
our current position from the
geolocation plugin and then we will get
back a position and to focus the map on
this new position we need to craft a new
Google Maps dot lot LMG object and then
the latitude is inside position
coordinates latitude and then position
chords Longley - there it is so this is
a new object and we can directly call
this on our map set Center so all of
these functions are of course somewhere
documented I didn't came up with set
center is if you look into the
documentation for the Google map right
there and then perhaps if we get our
Center we could also set the zoom to
whatever I don't know 15 is pretty near
we could also catch the arrow but we
will leave this out for now let's see if
this is already working
I don't think so okay interesting okay
yeah the geolocation plugin seems to
work pretty good inside the browser so
normally I would advise color equals
primary very funny sound normally I
would advise to use this plug-in or use
the geolocation plug-in on a device and
also this map this is not where I live I
live a bit closer to the city right
there but anyway we can see that we get
the Google map it is somehow focused on
the place this was in Germany and now I
can see all of you coming from
everywhere Africa India where you are on
this little map anyway we're ready to
track our routes and this is now a bit
more tricky and will only work on a
device or emulator but let's start by
adding our start tracking function and
also another one called redraw path and
then at some point we might want to stop
tracking and then we got this function
show history route which is pretty easy
but let's keep this open for now alright
so when we hit the start tracking we
first of all set our tracking variable
to true and also we want to overwrite
everything that was inside the trek
route before so we start with an empty
array then we use our position
subscription or we actually set our
position subscription to this start
geolocation watch position and this
watches the currently device position
and always delivers the latest values
and we then want to apply a filter to
filter out some errors
and since I think angular 5 we need to
wrap this in a pipe
therefore filter whatever comes in P dot
no completion ok equals undefined so
only we we only want values if this is
undefined let me bring in this as well
so we got filter from rxjs operators and
this from subscriptions that is fine
where were we
okay this is not yet a subscription
subscription is if we subscribe to it
and you can see now it is fine no more
errors and in the SUBSCRIBE block we get
back some data and let's set a little
timeout so this is automatically applied
and the changes marked on the map so
first of all we add a new Waypoint to
the array of our route so we push an
object with two values first being the
latitude set and guess what right so
this means in the end we have an array
after the run or also meanwhile with
these objects and this is also what we
need to draw a line on the Google map
with exactly those two values and that's
why after we've pushed the value we call
redraw path with our current trek route
and this should be a path so then we can
redraw the map ok now we've added where
is it the current metric right here and
if this current map track is already set
we want to clear the map one time and
therefore we need to call this function
set map Nam so the first
this will not be called but whenever we
got a new Waypoint we clear the map ones
otherwise we would have multiple lines
on the map as far as I know so then if
our path is longer or has at least two
elements where is it on my keyboard what
the my brain okay so if we have
more than one object we can draw a line
and we can set this line then to the
current metric so you see how all of
this works together and again new Google
Maps and now we use polyline to draw a
new line and again we can okay we should
use the name we can specify a few
informations and the most important is
the actual path so the line will be
drawn along path which consists of these
objects okay then we get actually I'm
not completely sure what this value does
but if you know it please leave a
comment below then we got the stroke
color which is the color of the line and
you could also set the stroke of peso T
let's use 1.0 and finally the stroke
weight okay so we got our new line and
then we use this current map track which
is more or less a collection of
polylines to apply it on our current map
so a bit confusing not completely clear
but you can find more information on
this inside the documentation all right
we are able to watch our position we add
new positions to an array and we also
immediately redraw the line using the
array of locations and creating the
polylines which we then set to our map
we're very close to finishing
so let's add the stock tracking in this
case we will create a new route from all
the information we gathered and we also
add a finished date so date get time
works fine and then also add the path
which comes from the trek route so all
the waypoints we've added along the way
once we got this object we can also push
this to our previous tricks so we don't
need to store it and then load it we can
immediately set it like this and then on
the storage call set four routes this
previous tricks have we used routes
before yes perfectly okay where am I
there then we need of course set back
the values so we're not tracking anymore
we use our position subscription
unsubscribe to you finish getting new
data and we set the current map track to
an empty map again so the map will be
clean again so this is just clean up and
storing the stuff of our route and
finally showing a historic route is
basically accessing this value which
already comes in here and then calling
this dot redraw path with the route
specified in here ok for now
I can't run with my iMac through the
streets therefore I will bring this up
in a simulator and also you might need
to move a bit more around than just
inside your room to see the actual
effect of this app but let's see how
this looks inside the iOS simulator
where we can fake our GPS position all
right so here's the app on my device and
on startup we're asked for the GPS
access and of course I will allow it so
right
now we are in your Hannah's burg in
South Africa okay so let's start the
trekking okay it's running and then we
go to the Xcode settings and from here
we can change it let's say we want to go
to London and we see that immediately
aligned to London is drawn on the map so
let's also go to New York City and there
we are in New York cities so let's stop
our route we've already covered a few
kilometres so now we're in New York City
we started again let's go to I don't
know Tokyo Oh interesting line and then
perhaps also to Russia Moscow and then
perhaps back to Mumbai and there we are
so another path another trick and let's
stop this and now we can use our
previous tricks to view the initial
route we had from Africa to London New
York and the second one from New York to
Tokyo to Russia to India so of course
this is a very huge distance covered by
the tricks and normally it would be
somewhere inside your streets but anyway
this is just for testing showing that
this plug-in is actually watching our
position and applying the line to the
next coordinates as the coordinates are
very far away we get these strange lines
which are due to the round but if you do
it in your neighborhood I'm sure that
you will get a nice trick of your next
run right within your ionic app and this
little plugin okay I hope you enjoyed
this a bit longer tutorial on building
an ionic location tracker with
life trekking and will historic
viewpoints and also drawing on a google
map so we've covered a lot actually in
this tutorial if you enjoyed it make
sure to subscribe to this channel for
more ionic videos and also check out the
ionic academy calm if you're interested
in learning everything ionic including
videos courses projects and the great
community right there so have a great
day and I'll see you inside the next
video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>