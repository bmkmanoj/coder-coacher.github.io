<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2015 • How We Hacked LinkedIn &amp; What Happened Next • Ruben van Vreeland | Coder Coacher - Coaching Coders</title><meta content="GOTO 2015 • How We Hacked LinkedIn &amp; What Happened Next • Ruben van Vreeland - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2015 • How We Hacked LinkedIn &amp; What Happened Next • Ruben van Vreeland</b></h2><h5 class="post__date">2016-01-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OvspPZlilkQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm going to talk about security and
especially like some practical security
well exploits I pulled off to some
companies the title to talk is how we
act linkedin and what happened next
linkedin is not the only company we will
be talking about we will talk about ebay
and IndieGoGo as well and especially on
how we broke the security in a new kind
of way and at last we will talk about
how you are safe against these types of
expectations and just a little about
myself I'm room for free learned a lot
of web application security and
especially in the heck of a of like the
art of exploitation I usually had web
hosting web infrastructure web
applications and web platforms and a
started programming in like fish up a
success csharp each p.m. doing java now
i'm co-founder of bits sensor we do it
bit sensors we give company security
inside because usually takes companies
nine months to detect I've been hacked
and we want to bring it down to 50
milliseconds and last year in Amsterdam
was volunteer actually and i really love
like they go to conference i used to
watch like many YouTube videos of like
speakers speaking here and like I think
it's ready to be speaker here as well
now there will be many many demos soul
just like to start off with the
IndieGoGo demo and just show you a
little bit about what we did on linkedin
on the on indiegogo how we hack them and
just like show you yet show the exploit
so this is indiegogo it asks you to fill
in your password you click on login the
router ought to fill your your password
as well so truly really feel stressed it
and suddenly you get redirected to a
page that thank you for credentials and
in the back your credentials are
exported to our control system so if
your password in plain text
and just to to show you that we're not
like messing around with anything
besides the web application it's on the
full HPS connection so how did their
work is it
is this black magic or what kind of
attack do you do you think this is like
anybody from the audience what do you
think ooh scary it's in the it's a call
side scripting attack and it's not
really likely usual side scripting
attacks that you see it's kind of more
advanced way of doing cross-site
scripting so I like to dissect this
specific attack in five steps so first
going to do small introduction about
cross-site scripting keep it really easy
then we do official demo with HTML how
are you styling then we show you how to
do a whitelist bypass or like kinda
bypass and I'm going to show you a cool
trick that you can pull off from
Internet Explorer and on the especially
on the pass without the complete
function of internet explorer and then
we do demo combining everything so there
will be a lot of fun and so cross-site
scripting usually comes in the form of
like this pop-up box it says oh like
cross-site scripting and we security
people to say oh well if you have this
power box we can do a lot of cool stuff
but the only often see this despotic box
and it's like okay show you we can
execute JavaScript in the context of the
application inside your browser but like
what can't really do with that and so I
prepared the demo for you with browse
exploitation framework and to better
than really work here so I I did it in
the in a PowerPoint in a in a demo so
what you see on the left is the web
application and then on the top layers
like the browser then you have the web
page and then this disgusted scripting
vulnerability and we use attacker we
control beef and beef stands for the
browser expectation framework so we have
to console scripting vulnerability we
use we go to beef and ask for more
JavaScript more malicious JavaScript
that we can go back with to the page and
executing the page so now we have to pay
load in a web page what we do now is we
use the payload to actually take over
the web page now this is not this is
like cool but we can do
more stuff than that we have a commenter
control server with beef so we can
interactively go to the webpage change
things get stuff and and export data and
what you have is the user data you can
change data and you can have access to
passwords if you want if with these
really specific exploitation types and
so what we do is with to the web page we
can go to your user day that we can
change data using just cost xhr xhr
requests and we can have access to your
passwords if you have like password auto
completion and stuff like that it gets
even better if you act if you attack a
company that has web application that
are protected from the outside you can
use beef to get access to these
firewalls and firemen's so like one
slide on like what the typical cost of
scripting factors are let like usually
have like script then you put in your
payload and all you like an image source
and then like there is no like
sanitation right there so many ways that
you have the the link version so you
have 48 href and they say a JavaScript
and then execute like this JavaScript so
when somebody clicks on the link you
will execute the JavaScript then you
have like you can do it in the
JavaScript payload and then you can do
it in the interstellar actually in the
last one is really interesting it works
only on all the version of internet
explorer but if you have access to this
tell attribute then you can pull off
JavaScript from there and so like just a
short demo this is like with a net with
a link you have JavaScript to a alert
expert me you can execute JavaScript you
can like have access to all these cool
stuff from the web application but in
reality like nobody click this link
nobody is stupid so hey click on this
malicious link and get boned lose my
credentials so you have to be a little
bit more creative in the way on like how
you trick users into exploiting or
get into a clicking on your exploit and
like to exploit the user and one way to
do that is you styles to use CSS and the
CSS would which is here we just have the
same link but what we did with CSS we
made sure that the link is not only like
one word but it's actually spans the
full page so its way from high two
hundred percent you get a position fixed
and like left and like full on the top
and I made it red here so you can you
can see like ready link is let me switch
to the demo so here if the zoom out a
little bit so this is maybe yeah your
typical web application like years like
big name company the hello user and you
can write something about your fantastic
project and well the program is forgot
to sanitize the the input so we're
inserting or link here and let me assume
in know like how this link works so we
have the JavaScript here say confirm so
when you click this you say you execute
your JavaScript you can ponad user and
the way we did it is now we have this
background so you actually see its files
the full page because like if you don't
have to style you get this out and say
hey exploit
like know which you click the link now
probably probably not so putting the
style let's change the background so you
actually don't see anything right now
and everywhere you click your payload
gets triggered and you can execute
JavaScript in in an application however
this is a small problem we have here and
there has to do with cross-site
scripting in the Indus tell attribute
and so actually nobody allows the style
attribute TV set because like
everybody's afraid of like disgusted
scripting attack to that and so this is
a whitelist and people use widely to
only allows like specific elements that
they know that they're safe and lock
style is not one of them so we have to
figure out a way to still get a link to
spawn a full page but we can't use tell
so what do we do so indicated i showed
you this like this one line it says hey
import the style sheet and this is
actually just bootstrap i use bullshit
because you find it in a lot of websites
and you can like easily recreate these
proof of concepts that i'm showing you
today and in that style sheet we have to
CSS selectors that are created at better
than them and like actually there many
more but these ones are the two I need I
want to have like the top 0 and left 0
to be like in the corner the position to
be to be fixed and I want to have the
jetty necks as high as possible so like
my exploit always floats on top of the
page so just combine these two CSS
selectors to substitute the style that I
had before so he is the exact same proof
of concepts except we don't you still
here but we use the already loaded CSS
to do the same thing so how does this
look
here's the same thing with in height and
a percent the same JavaScript execution
and instead of like the style we now
have class and here everywhere you click
the payload is executed and that brings
me to to the ebay demo so this is how we
pull off this trick on on ebay.com and
you actually see like WWE be calm and
the content of the of the website is not
available mates it's bit sensor it's us
so how do we did it like we showed you
how work with the with the link but we
can do the same trick with an iframe and
eBay actually allows iframes to be
embedded and usually these iframes are
like really really small like just to
embed like it's my youtube video but
because the class attribute was white
listed I found some style that was
loaded on the page to make this iframe
not really small but really big and
small a full page so if you would now do
an attack on the use of ebay and say hey
go to ebay.com actually is ebay.com you
can ask this really effective phishing
attack and maybe if somebody to your
attack will make a payment you can
intercept the payment like it's really
really hard to notice actually so we can
do more now we're getting closer and
closer to the to the IndieGoGo demo we
can use the CSS that's whitelisted to
recreate a pixel perfect copy of the
original log in form and you see like
small demo with the same thing you see
class attribute and to get to the full
IndieGoGo level exploit we actually
abuse in explorers passwords how to
complete and how index for works with
the password how to complete is if it
finds a form that's loaded into the page
and the connection is secure HTTPS
connection it will pre-fill always
fulfill your password for you now this
is very interesting from like an attack
is perspective like you saw it really
feels trusted to fill in your password
if the
also does it for you if you have one
hundred percent pixel perfect login form
except this one thing we do on the form
action we actually send it across domain
so we send it to bits answer that I out
instead of indiegogo com and i'll show
you like how to recreate this so in
order for this to work you have to have
like a more liberal whitelist and that's
why you can't always pull this off but
if you can it's a really really
effective exploit so what I've put in
here all this HTML code I just copied
this from the login bar on this on this
website and I have to zoom out this is T
this is the original login bar and now
it's an attacker we're putting this and
this is our fake logging bar if we now
and we will actually pose this to you
can like make this your web application
to capture like the data and if you're
not put in some fake stuff sign in you
will send us to bits answer that I oh
and it means you have access to the
credentials and what we did with
IndieGoGo is when you post this data we
actually sent you back to indiegogo.com
like instantly so you don't know that
this happens in the background just so
with all the information you have let's
look again and how does how this works
so this is the using DF hijacking the
wonder-percent pixel perfect clone your
boxes in explorer so we will pre fill
your password and notice when we hover
on this you're like you sit really
really tiny but only here this is slight
indication it's not posting to
indiegogo.com but to your external
attacker control domain now you can
click this what happens in the
background is redirect you back and we
got your data and notice how we exploit
the IndieGoGo but if you think about
like but we've learned using a CSS and
the way this works we can actually go
one step further and I notice a demo of
that but what you can do is use the
login button make the form completely
transparent make the login button spawn
the full page just like the link and
then when you click anywhere on a
website you'll post this form to the
attack control domain you will have the
password and you actually don't see
anything changed on the website you
don't even see like the login form pops
up because you made it fully fully
transparent so linkedin linkedin was in
a pretty tough one because we couldn't
use the JavaScript length my friends
were allowed but not cross domain and
what worked was to create an iframe and
let us spawn the full page and like then
it gets interesting because we're
getting closer to software something
that we can actually use an attacker to
like to exploit this but I couldn't find
a face it was allowed and that has open
redirect working so we tried like using
SoundCloud and do like opera direct on
soundcloud back to like bits and so that
I all didn't work so we had to be more
creative we had to covering link working
so what's kinda nice but it's not
everything so what we ended up with is
using image and combining with the link
that covers the full page I'll show you
so this is a linkedin and we actually
using like the blogging platform that
you have on linkedin and like we call it
like clickjacking with like return
oriented programming course is that kind
of the same thing and now you see like
everywhere Hoover if I click it I go to
a tube it's a villanelle as my former
company now let's make this model more
interesting for fishing and what we did
was just like get a screenshot of the
linkedin login page put the screenshot
in there put in the image made it fully
covering and that's what you what you
see here it's like the legging log in
the image and like it's not school it's
the other two exploits but then I think
it's like Picasso's creative and the
linkage security team really likes like
what we what we did here is a people
like load right now you see the login
form you check oh it's AIT's on XP on
linkedin com we redirect you to another
website it's really hard to notice that
you're now on the bit sensor that I owe
you fill in your password you click
login we sent you back to LinkedIn so
it's still hard to notice and you just
lost your password in the process like
here it is in plain text
so for you as developers like what can
you do against these types of attack now
well the first thing is when you're
whitelisting make sure the wireless is
really really strict like a strict as
possible because if you now download the
white listen I'll show that with them as
well if you have a whitelist the class
attribute is whitelist by default the ID
attribute is white listed by default and
I use it as an attacker so I would like
strip them from your white list I would
also really be careful if you allow an
iframe and like you have the iframe but
you now also see that a lot of OEM bad
functions in web applications like we've
ever owned break it also has to be very
very strict because we used it to hijack
pages as well and things what's easier
and always works is to put it into an
iframe so you now have HTML 5 50 cent
box and if you put this in the sandbox
it won't work because the sandbox is
smaller than the full page and we can
spawn outside that the sandbox so the
text like this that you've seen will
never actually work so if you have any
questions about the security can always
email me the info bit tense up when I oh
and if you like to see a product that's
a bit sensor doing with big data
elasticsearch and the IBM our partners
to do like actually instant response
I'll do a quick demo if you like but for
now any questions about like security
and these ways of exploitation
hi when you change it the content of the
pages howl like you did it using men in
the middle or because I saw when you
when you change the content in the blog
probably you just injected some script
using the post in the block but when
it's not the case how do you get to
access to modify the code and insert the
scripts yes good question so for the
demo i just used like in an HTML ID but
actually what what you would do like in
route case scenarios is for example to
give the linkedin scenario you are you
could post HTML in your blog post and
that's the place where you put this in
and now somebody reach a blog post like
your HTML is in there and you can spawn
the full page and the same thing on
indiegogo you create like this product
page a little bit of HTML one's allowed
to us enough to pull of this district
and on ebay the same thing you could
write a little bit with HTML styling and
we pull this off so that's how we use in
their practice and that's why the HTML
widely sing comes in more questions
have you checked those exploits behind
one of the common application firewalls
do they actually filter out or have some
solutions to this approach no absolutely
not because you have to learn like batch
aloud and like none of the web
application firewalls detected is and
that's because the attack itself it
doesn't execute JavaScript and that just
make this attack really unique and
really hard to filter out and with a bit
sensible work on a way to actually like
filter this out by learning what's like
normal HTML and sees what's allowed but
like normally your package file won't
detect this more questions
just gonna show us again how did you
resize the iframe size and the ebay
example sure if you don't mind I'll just
use the link that I've here so here if
the the link were five hundred percent
and we use the class so let's now use
just an iframe
yeah but you usually you don't have
access to change the iframe size to set
it to one hundred percent yeah I can
teach it a little bit to make it easier
to show and that's what you might see
like in the impact is that it's a little
bit harder to get this hundred-percent
hundred-percent width and height but you
can go to like the CSS and just like the
so many lines of CSS so many selectors
that you just have to find one that says
with one hundred percent and one with
height one hundred percent the same way
as this here you see the glass top down
backdrop and not bar fixed up you would
find other CSS selectors that allow you
to have this hundred percent and this
one percent width and height so I just
have to look better but for the demo
just use like the the quick way to show
it to make it really visual thank you
more questions about like other security
topics as well maybe if you're with an
issue okay cool if you like I'll show
you a little bit about what we're doing
with realistic shirts and we're like
building the security inside product
would like to help companies like noted
architect even before the data is
breached and with like loaded in 800,000
Apache log files and we like analyze
them on security and we now have like
and for security wise I think it's
really interesting because you have like
this skill chain and so many who doesn't
know what a kill chain is well yeah I'll
just explain a little bit like a kill
chain in security we say okay the first
step is somebody like pro wearing your
surf and sees what like running on your
server and all the way like four steps
two steps to the end it's like somebody
actually getting the data so the more to
the end of the kill chain you are the
closer to the data you are from that
specific company or the close to
exporting the company you are and so we
loaded in like a bunch of Apache log
files and we visualize them in
elasticsearch Kabbalah and what you see
here is like all the way in the top you
see this big dots well this
maybe maybe interesting and I can like
zoom in really really quickly you can
see a lot of detail with we have like
recreated the kill chain here like a
little bit less nicely visualized you
can just zoom in and what we detected
for for this customer was you see these
two spikes they're actually like tactus
sequin injection and after those two
spikes you see this is a minute to
minute visualization of like the attack
and then in the end like 1715 she like
huge spike in the discovery attack and
what we did we can do is now zoom in to
disappear is because I wish all
disappearances closely correlated to
this attack and we now can move to a
connected graph visualization and now
this is interesting because like all our
data is indexed in elastic search and we
now visualizing this full data set all
of our offense that we have to see how
this specific attack really happened and
how all the dots are connected so if i
zoom back in to our thread attacker now
we see here is a Fiji and I'll just
explain little high Fiji for like the
non-security people have fig is a tool
you can use it's really easy to get
access to a database system so if you
have sequel injection you have the Fiji
tool it's like one click you pull down
the full database you just download the
full database and we saw this attack
executed on this application and from
their own we saw more and more IP
addresses connected this like we're fun
here and this I creative as you saw
attacked with other I Peters as well so
it's like quite a sophisticated attack
and we make Incident Response really
really easy for for security people but
even for a little like less technical
people so if you like to know more about
like instant response and like the other
way about security and like using lesyk
shirts or like doing big data stuff like
let's talk to us and
will be cool so thank you for your time
if you don't have any questions about
like why they just show you then thank
you all for for coming</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>