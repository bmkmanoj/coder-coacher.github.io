<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2012 • The R Language The Good The Bad &amp; The Ugly • John Cook | Coder Coacher - Coaching Coders</title><meta content="GOTO 2012 • The R Language The Good The Bad &amp; The Ugly • John Cook - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2012 • The R Language The Good The Bad &amp; The Ugly • John Cook</b></h2><h5 class="post__date">2013-03-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6S9r_YbqHy8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in case you're wondering where the
title comes from how many of you've seen
the movie the good the bad and the ugly
oh my word I'm surprised I've never seen
it until the flight over here I watched
them my laptop well at least I've made
amends now all right so yeah so this is
a spaghetti western from 1966 the
Italian actors said their lines in
Italian the American actors said their
lines in English and they just dubbed
the opposite language for each for lease
so I thought if things go bad just
pretend that I'm I'm speaking Italian
and dubbing myself in English all right
all right so just a little background
about where I'm coming from my
perspective how I came to R I started
out my career in working in math I then
left academia became a software
developer and more recently come to
doing statistical computing so I have
sort of an outsider's perspective on
statistics and the our language and you
know I've written a little bit of code
and maybe a dozen languages and R has
been the hardest one for me to learn not
because it's an intrinsically hard
language if you know nothing and you
pick up R then you just learn it but if
you know other things R is just kind of
strange and you kind of want to make it
into something it's not and it's kind of
hard to learn
you don't learn are the same way you
learn Perl or Java or something you the
right questions ask is not okay how do i
do loops where do the datatypes where do
how the classes work that is not the way
to learn are in fact that information is
kind of hard to find out and a lot of
people who use are the most probably
couldn't answer those questions are is a
domain-specific language and so you have
to understand the domain learning are
purely as a language is be like learning
PHP as a language without being
interested in web development or
learning sequel
as a language okay what are the data
types where the structures like this I
don't care about databases I just want
to learn the sequel as a language okay
that's kind of what it would be like
that was my mindset coming to are okay
I've learned programming languages
before I'm going to apply my standard
template and our didn't fit
so what is our it's open-source
statistical language and maybe wondering
why do statistics need its own language
we'll get to that
it's the facto standard for statistical
research now not statistics in general
not statistical practice but more
statistical research the people who are
doing standard statistics applying
well-known methods to well-known
problems probably use something else
like maybe SAS but the people who are
doing research into statistical methods
are using our it grew out of the s
language s for statistics that makes
more sense than our what is our stand
for it's just a little s - - I guess so
grew out of the project from 1976 and
then revised in 88 from Bell Labs so
actually so yeah the languages
influenced by scheme and by Fortran we
just think how that's kind of a weird
mixture how can be influenced by both
our was first written in either scheme
or Lisp I forget which and had this
scheme like syntax but then it became
imperative to have compatibility with s
that had more Fortran ish syntax and so
our adopted that and so that you can
also see some Fortran influence like
array indices start at one and matrices
are stored by columns all like Fortran
and as Dennis Ritchie said about C it's
quirky flawed and an enormous success I
would say compared to see it's even
quirkier even more flaw
but very successful in its niche okay so
really what is our what I've given you
before is just kind of the standard
Wikipedia article this is what blah blah
blah but to explain someone share a
quote from a science fiction novel the
canticle for Leibowitz he says you don't
have a soil doctor you are a soul you
have a body temporarily
it's my Epiphany and trying to
understand what R is all about is that R
is not a language R has a language R is
an environment for doing statistical
kind of work and it has a language it's
sort of like VBA excel has a language
but studying that language in isolation
wanting to study VBA not to program
Excel is just kind of strange
or another example might be Emacs Emacs
has a programming language Emacs Lisp
very old dialect of Lisp that I don't
think many people love it's a full
programming language you could write a
web server in Emacs Lisp I suppose
though I doubt anybody has we I
shouldn't say that never should say that
had Damian's up there thinking well do
it me I was like and I'll do it only
using characters with straight lines now
but I think a lot of people think of
Emacs Lisp as the price you pay for
getting to the functionality of Emacs
and I think are sort of like that
enormous amount of functionality and the
our language is the way you glue it
together so just help how popular is our
here's an example from a data analysis
competition what languages people used
are came out the most popular and if
you'll notice sort of mainstream systems
I'm sorry oh it has
okay good for them all right so if you
look left-to-right you have to go pretty
far down before you get general-purpose
languages like Python kind of in the
middle C++ Java at the far end so people
are not using system languages for doing
statistical analysis they're not even
using mathematical languages notice
Mathematica is pretty far down on the
list now another data point this was
from a survey in bioinformatics where R
came out on top but I'll have to say
something to explain why I think Perl is
ranked so high here bioinformatics means
different things to different people
it's a subset of computer science to
some it's a subset of statistics to some
it's who knows to others so some people
who come under the umbrella of
biostatistics are doing a lot of file
munging so a lot of people use perl for
processing DNA sequences as strings and
I would imagine that's what accounts for
the popularity of Perl here the people
who are doing statistics with in
bioinformatics are largely using are
okay so what's it like to use R well
here's a quote actually using R is a bit
kin to smoking the beginning is
difficult when I get headaches and even
gag the first few times but in the long
run it becomes pleasurable even
addictive yet deep down for those
willing to be honest there's something
not fully healthy about it another
comparison from Drew Conway and John
miles white their recent book on machine
learning are has a unique and somewhat
prickly syntax and tends to have a
steeper learning curve than other
languages okay so if if R makes you gag
and has prickly syntax why do people
like it well as someone from Google said
the best thing about R is that it is
written by statisticians
the worst thing about our is that it's
written by statisticians okay so to
understand are you really need to
understand a little bit about what is
statistics that ax stations are like and
they have a very different view of the
world than programmers they may be
programming in the sense that they are
spending their days in front of a
monitor typing in things and running
things but they see the world very
differently and if you did a functional
MRI of a programmer sitting at a
computer and a statistician sitting at a
computer different parts of the brain
light up because they're just they have
very different views of the world and if
you're not familiar with statistics you
may be surprised that it's actually
quite different from math you think well
it's just a branch of math but really
it's very different as sort of an
expatriate mathematician living in a
stat Department I can tell you that it's
taken a long time to learn the lingo if
you know different jargon for everything
a different perspective on what is
acceptable what's not and so you don't
see statisticians using languages like
Mathematica the very popular math
departments like we saw on the previous
slides
not so much in statistics and a lot of
people in statistics learn are as they
learn statistics and if you go looking
for a book on are you'll probably find a
book on statistics with are I know of
only one book that I'll mention at the
end that's really about our as a
programming language because that's not
how most people think of it most people
learn the are to carry out concepts as
they learn them in statistics and so the
our programming language becomes
synonymous with the statistical concepts
to some extent and it becomes
unthinkable to use anything else so R is
a domain-specific language and to
understand a domain-specific language
you have to understand the domain you
start with the domain not the language
so the alternative to our is is not
something like Python or C sharp or the
alternative is SAS so using a mainstream
programming language is literally out of
the question for most statisticians if
they didn't use R they'll use another
statistical language and often people
who know are only know R and they love
their domain-specific language and they
use it for things outside the domain I'm
sure somebody's written a web server and
are just like they've written one and
Emacs Lisp if I guys I answered some
question on I guess with Stack Overflow
about R and said well you never use R
for a web server you know you'd use it
for this and then somebody wrote back
well I've implemented web server
entirely okay so why does statistics
need its own DSL well from one thing I
mean pretty basic thing you want
statistical functions to be accessible
if you if you could imagine a house a
statistician would feel using C sharp
and say writing math dot log every time
they have to take a logarithm it would
be like having to use conditional dot if
or branch dot or whatever in your
language gets to be really annoying data
often comes in tables and so table
manipulation is fundamental baked into
the language because it's something that
happens so often vector operations
everything in statistics is vectorized
because you have multiple observations
you have observations on multiple things
multiple people multiple cats whatever
and those are your vectors so everything
is Viktor oriented missing data is a
fact of life any real data set has
missing data and so you want your
language to handle that smoothly and not
just oh my gosh we've got missing data
what are we going to do throw an
exception call the police you need to
have a need to have a language that
doesn't freak out with missing data and
just like you know something like pearl
has patterns for text munging R has
patterns for common statistical tasks
and we'll look at a little bit that in a
minute
okay some advantages of our Python
people like to say Python comes
batteries included meaning you download
Python and you've got everything you
need to get started well that may be
true for some kinds of Python
programming but if you're doing
statistical computing in Python it's not
batteries included you start with the
Python language use matplotlib for
plotting things you Syfy if you need
mathematical functions use ipython as a
shell so really that's more of the
typical Python environment for
scientific computing R is not like that
you open up are you have all these
things in one giant namespace everything
that you're likely to need is right
there if you're doing that kind of work
if you're not doing that kind of work
you wonder why things are missing
okay R is designed for interactive data
analysis it's not intended was never
intended for crunching you know enormous
data sets it's very much meant for
someone who starts with the data set
plays around with it let me see how this
works what if I plot this against this
that's sort of noodling around and it's
very good at that
it's easier program than some of its
competitors haven't programmed SAS but
from what I understand the language is
about as sophisticated as das batch
files where it's really more of a macro
language than a traditional programming
language so that would account for why
people who are happy with what comes
shipping with SAS use SAS people who are
needing to write their own stuff tend to
gravitate toward are of course R is open
source which is a bigger deal than you
might imagine like my institution we're
flushed with cash we can buy software
but it's tedious to buy software
nice thing about open source is not
saving money it's avoiding the
bureaucracy of getting a purchase order
and the same is true around the world so
wherever you have a collaborator they
can also download it without going
through their bureaucracy okay and you
could imagine if you're dealing with
with data all the time you want to
optimize operations like querying and
filtering because it's something are
going to do a lot we'll get to linear
regression a couple examples here so as
an example of how you can work with the
vectors in our suppose you have no
elements and you want to set them to
zero you have a nice succinct notation
that says in the array X those elements
that are RNAs set them to zero or you
have more complicated expressions inside
your index operator you could say for
those elements of X whose corresponding
index in Y corresponds to a value of y
that is bigger than seven select those
things and take the log of them so this
kind of notation allows for some very
succinct tight programs it's also
bewildering if you've never seen this
before so another example you know
linear regressions very common tasks in
statistics you have some data you want
to see well what kind of line could have
fit to it so let's imagine a fairly
complicated scenario here we have three
independent variables XY and Z we want
to fit a linear model to these and we
want to include some interaction terms
meaning we don't just want x y&amp;amp;z as
independent variables we also want to
consider X Y or Y Z but we don't want to
consider X Z for whatever reason so we
want to build this kind of linear
equation we want to find the least
squares fit to it we want to look at
different residuals and stuff like that
well
it's very succinct in our ours
linear regression notation is analogous
to regular expressions for text munging
a statistician we do something like this
as often as other people would grep on
something and so you have this kind of
sub language within the language that
makes these things easy to express so in
a little more detail you're fitting this
set of six variables so when it says X
plus y plus Z squared
that does not mean literally take
interpret that as a polynomial and
square it doesn't mean that at all it
says this is shorthand for saying I want
to include the variables XY and Z and I
also want to include products of pairs
but I don't want to consider the X Z
that's what the - at the end means and
implicitly there's a constant term a so
very nice succinct notation for a
lengthy problem to describe I'm sorry in
SAS you would do what but you knows will
be bleeding okay okay so here's a simple
regression example this is some data on
butterflies looking at the effect of
tannins in their diet on how well they
grew so a read in a text file that has
my data I'm telling it header equals
true meaning interpret the first line of
the file as headers for the columns when
I say attach data I'm saying I want to
use the column headings as variable
names and I say just to make sure I have
what I think I have let me say names and
prints out that okay then all the code
necessary to fit a line to that data is
a model equals build a linear model
regressing growth on tannins and when
you do you get if you look at the
summary you get a copious amount of data
you don't just get the inter slope and
intercept you get far more than that you
get these p-values for the coefficients
you get residuals you get all kinds of
detail that you might want to see all
this is contained in an object so when I
say summary it's printing an object but
if I were just interested in pieces of
this I could say model dollar sign our
uses of dollar sign where you might
expect a dot like model dollar sign this
or that to get two pieces of this object
that represents the regression output
now another example look at some a data
set that comes with our when you
download our it comes with several data
sets these are sort of like the
equivalent of the Microsoft Northwind
database you know there's some standard
data sets that people use in examples
and one is this motor trend data from
1974 looking at among other things
mileage and weight and whether something
has manual or automatic transmission so
you can call help on this data set and
this to show you something like this and
if you look at the data there's twelve
columns the two that we're interested in
were three we're interested in weight
and the gas mileage and whether the
transmission is standard or automatic so
here's an example of a an analysis of
this data so you have one line for
automatic transmissions the the red line
the steeper blueish line for manual
transmissions you not only fit the lines
to the data you plot the data these gray
bands around the lines represent
uncertainty get this nice gray
background with white gridlines so that
the grid is there it's visible but it's
not real not real obvious it kind of
fades into the background doesn't
obscure
data and here's the code for producing
that the code is very declarative so I
tell it what data I want I'm using a
library ggplot2 Hadley Wycombe it's a
very nice library I'm telling it
transmission is a factor that means it's
some it's some data that I'm treating as
categories when I see a 0 and a 1 in the
file that doesn't mean no transmission
or 1 transmission it means these are two
categories that I'm looking at so inside
the plotting routine I tell that I want
to plot weight in miles per gallon from
the data set MT cars and I want to color
code the I want to color code my data
and show it as points I'm going to fit a
linear model that's the LM X tilde Y
says I want to plot y as a function of X
and so forth okay some language features
are is dynamically typed yes first class
functions has closures so you can pass a
function as an argument to a function
that sort of thing it has an object
system in fact has two object systems
one called s3 and one called s4 whereas
s3 the older system is sort of
pearl-like
where you have a list and you bless it
into a an object it's very permissive
convenient loosey-goosey the s4 object
system is more rigorous where you you
have to say what your fields are and if
you type in something it's not a field
you'll get a warning well that's not the
case with the older system neither one
is going away anytime soon
the majority of objects are using s3 the
older system s4 is newer it plays better
with interfacing the other languages
like C
both in common use but the older system
is still more popular in fact if you
look at Google's style guide for our
they say avoid s for classes so R is
vector oriented for better for worse
there are only vectors in the language
there are no numbers if you type a 7
that is a vector of length 1 containing
the number 7 so everything is a vector
for better for worse for better you can
it's very convenient to just say X plus
y and it sums the components for worse
yet when you get something you say well
is this thing a number I mean ie is
it'll have length 1 or does it have it
linked more than one so how should I
treat it and everything is passed by
value that can reduce mistakes but it
can also lead to a lot of copying and
everything is nullable because we said
you know it's important in a statistical
language to have the ability to deal
with missing data well you can deal with
missing data two ways in R you have an
in a and you have a null so an in a
means I don't know this has a value it
makes sense I just don't know what that
value is so you have sort of this three
state logic you can also have an unknown
I'm sorry you also have a null that
means pretend I don't exist it's like
the line from Harry Potter where he says
I'll be in my room making no noise and
pretending I don't exist so if you in
some context when you see null the
function will just ignore it as if it's
not there but if you see an in a it
depends on what you've told it so do I
ignore na s or do I take them into
account
alright so an example of vectorization
suppose I want to generate a million
random variables random random samples
by a normal distribution our norm does
that so X contains a million random
samples from a standard normal and then
I
make there some this idea of pre
allocating a vector of everything that
you need is good our style but it would
be poor C style because it's wasting
memory so if you're a C program are
coming to our you might say well this
this is a bad way to do things
yeah it's tight code but I'm going to be
clever I'm going to generate one random
value at a time and add that to my sum
and I'm going to save allocating all
this memory well the second example runs
25 times slower than the first example
so what's bad practice and R is good
practice and C in languages like that
and vice versa so the people I've worked
with who've learned our first and then
come to a newer language they write like
the first example they save everything
before they do anything with it and say
no no you don't have to do that here in
our you don't have to do that but you
almost have to do that because it's more
efficient it uh for loops are very
inefficient and are anytime you complain
about the efficiency of our the first
thing someone tell you well
have you gotten rid of your for loops
which is really kind of strange to think
of a programming language of discourages
for loops I mean not just sometimes you
don't need them but you really don't
even want to use them if you can avoid
it alright so some of the drawbacks are
is slow so just to give a number maybe a
hundred times slower than C++ but it
varies if you have naively written code
maybe it's a thousand times slower or
maybe it's twice as slow it can vary
tremendously depending on what you're
doing a lot of our is written in C in
the back end and if you're passing a
large amount of work to do in see that
it chews on before it spits back it
might be pretty efficient but if a lot
of the work is actually happening in our
it could be very inefficient tool
support is a real problem if you're
coming
from visual studio and this is your
expectation of what language tools
should be ours about 20 years behind
it's starting to get some of the tools
that we took it took for granted about a
couple decades ago safety our is
designed for interactive use is not
designed for production and these are
intention there are a lot of things that
it lets you get away with assuming that
you're interactively dealing with a data
set and you'll know if you've done
something wrong so Who am I to complain
so that's what you said I guess that's
what you meant and I'll let you do that
so if you want to assign a value to one
of the languages keywords well I guess
that's what you meant so a problem with
all this is people use our outside of
its sweet spot they a lot of people only
know are so they use it for whatever
task they have all right so if you want
to learn more about some of the darker
spots of our there's a report called the
our inferno that says if you believe
you're in our hell here is your guide
so it's 126 pages it's sort of modeled
on Dante's Inferno there's kind of
medieval artwork in it and and so forth
but it has a lot of detailed information
about odd corners of our and how to deal
with them right so the book I wish
somebody would write is are the good
parts I mean if you're familiar with
JavaScript the good parts this is a
great book Crockford takes takes
JavaScript and takes a very cold eye
view of it these are features that are
just bad but inside JavaScript there's a
really nice language and here's what I
think that is here's the subset that I
think is the good language inside of
JavaScript well wish someone would write
such a book for our there are a lot of
things that are does really well there
our land mines in ARDS like their land
mines in in JavaScript the languages are
similar in that way in that people use
both languages before learning them and
there's there's pitfalls for the unwary
so whenever I talk about this book I
have to show this picture there's the
JavaScript on the left and then there's
the good parts the little book on okay
so some lessons from our data analysis
is very different from system
programming more different than you
might think
people will put up with a lot to get
their work done if you say you point out
some of the problems with our it has
this weirdness has this this fails
silently this doesn't work people say
yeah but I gotta get my work done I
don't care how elegant your programming
language is I can't get my work done
with it so I'm not going to consider it
and people will use a familiar tool if
at all possible okay so some resources
for our you can download our from the
our project our - project org I've
written a guide that is a sort of a
programmers view of our if you've
written C++ Java Perl these common
languages this tells you the some of the
things that you might find surprising
when you first look at our and this is
the book I mentioned earlier the only
book that I know of that treats our as a
programming language is the art of our
programming this is a no starch press
book that came out maybe a year ago I
forgot it's fairly recent but it's a
good introduction if you want sort of a
programmers eye view of our and on
Twitter there's a an account our Lang
tip I started this some time ago with
one tip a day on on our and then I
turned it over to some other people who
knew more about our to let them run it
they've kept it going growing alright so
that's it from me
questions
yes sir right the problem is not binary
compatibility you can get other
languages to call or get our to call
other language just the problem is more
cultural compatibility for example
you're building a c-sharp interface on
top of our where you pass it in a vector
or maybe worse the other way around
so you're writing C C++ and bypasses you
an R vector well this is a vector of
numbers you assume it has numbers in it
well not necessarily maybe it has n a s
maybe it has nulls
so if somebody says I've written this
code it's just great here use it you got
to watch out for these kind of things or
for example what does it do on an error
well maybe it crashes and that's fine if
you're interactively exploring a data
sets not fine on a server yeah what was
the question question is Archer
incomplete yes yeah yeah okay so within
the our world
you can wrap stuff that's been a module
and distribute it that way and they
actually have a pretty nice module
system if your code is written in C but
wrapped in R it will be compiled on
install and everything just kind of
works but that's within the our world if
that's not acceptable you want to
interface with the wider world or you
want more performance than that's more
difficult so if you need to speed up or
one way to do that is to rewrite things
in C++ maybe write then rewrite the
entire thing or maybe strategically
rewrite a hotspot yeah well about a year
ago I looked into how can I speed up our
and I've read all these papers on well
you know sometimes if you reverse the
order of these two things on a full moon
it might get 10% faster and the only
reliable way I know of to improve the
performance of R is to remove it from R
and there's a couple ways of doing that
there's a C interface
where you can call C or Fortran there's
a higher-level interface through this
module called our CPP that gives you a
very nice high level interface you take
in an R object and cast it to a C++
object and it takes care of all the
marshaling and reference counting and
does all that for you or you can brute
force something you could run are on
many servers there's a package called
snow simple network of workstations
people use for just running are on many
machines yes Scott
no I think for a lot of people they
learn our width statistics from
statistics 101 here's a theoretical
concept and here is the art to implement
it at least some people teach it that
way in some settings you may have a more
theoretical class first
in fact the class I'm teaching right now
is a graduate class that does not use R
but the people in their head are as an
undergraduate
right so if you're wanting to learn are
along the way I guess the most common
reference is a book by Venables Ripley
or Venables I think it's Venables it's a
springer verlag book I forget the title
but it's one a lot of people use there
been a few books that come out lately
there's a book called our inaction from
Manning the Motor Trend plot came that
example came from that book so our
inaction would be a good one if you're
wanting to learn our for data analysis
and graphics the quote about are having
prickly syntax came from a book on
machine learning using are now it's not
an art tutorial it's a machine learning
tutorial but it kind of gives you a mini
introduction to our and then shows you
how to use that as you go alright well
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>