<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2013 • Defensive Programming - A Look at how to Break your Web App • Niall Merrigan | Coder Coacher - Coaching Coders</title><meta content="GOTO 2013 • Defensive Programming - A Look at how to Break your Web App • Niall Merrigan - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2013 • Defensive Programming - A Look at how to Break your Web App • Niall Merrigan</b></h2><h5 class="post__date">2014-04-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_3q4xayI-I4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay this is defensive programming 101
my name is Niall Erika and I will be
your host on the stupidity Channel today
if you are tweeting please use go to arc
and America Merrigan that's me
first off I'm Irish I'm very very live
in Norway what's this networking oh
there we go I'm Irish no seriously we've
done that and I live in Norway come on
there we go and I have that their last 7
years my Danish is crap but when which
is good I work with Capgemini instil
honor as the head of custom self above
there I'm an asp.net MVP maybe not today
anyway or more because they buy where we
find out whether I'm big enough and I do
another bit of work with register so I
have to move a little forward to the
console
how many of you are developers ok how
many of you are not developers why do
you
sorry it's a joke okay for those who
take the whole game as hope and the
recording stick nearly every week
developers so that's a good thing right
now
why don't developers write secure code
anyone willing to show yes sir we're
lazy and we don't have the budget for it
come see me afterwards I'm giving you an
Xbox 360 subscription per year well
that's exactly yes I reward people who
interact with me it's very funny it's
called bribery in my country our
politicians are very good with we as
programmers don't like don't write
secure code because generally we're
amazing that's maybe not always I'd like
to think that you guys are actually
quite good at what you do
generally it's because it's hard but
mostly because we are a very trusting
Bunch
I've written this code it's my child
why would I want to break it you know go
out there son and play with the cars on
the little white line if you come back
in you can be like Sparta
you know the Spartans did that's exactly
what we have to think of our code
sometimes we don't write secure code
because yes it's very difficult to write
it takes time we don't have the money
sometimes a guy in marketing or sales to
come in and go hey now I got a new job
say yeah what is it
we need to CMS written cool when you
want to buy four hours okay I'll do you
want to security with that yes no we're
not getting that we write code for these
lovely people our nice users they're
very happy as you can see that's because
later on in life she will discover that
perms have gone out of style I'm trying
to figure out what the little let's see
if this works
yeah it does the little kid here is
doing hmm now users as we'd like to say
if you say go a b c they will go ABC
they won't ask why there's a B they will
just do it
we make money from these people be nice
to them all right I know it's a very
difficult for most developers looking
users sorry isn't as can you believe
that I was
as an Irish person I find it very hard
not to swear for the American I'm sorry
they're very by the way sorry your
country shut down thank God there was a
Yank in the room to do that for Ivy like
how I really wish there is well
democracy health care sorry okay before
I get myself into an international hit
slits hackers and by he's a posh hacker
he's using a tie right how many of you
if I asked you today to turn off the
mouse on your computer would go oh boy I
can't use my stuff why are you here
one guy you're brave enough to say okay
that's cool learn to use keyboard
shortcuts they're awesome it's quicker
than using copy paste by clicking for
your coding hackers crackers advanced
users all the same really
because they're gonna look at your code
and go ABC why the hell do I need B if
you put them on a plane with a button
that says do not press this button
planes wings will fall off repeatedly by
the way never tell kids that did you
know that's the C thing it freaks the
hell out of them yes I'm a parent I'm
telling my kid that as well stop it
anyway we write code to defend against
this if you saw Aaron's talk he was
doing about the outsides of things and
telling you how to prevent against this
- about the internal bits these are
they're kind of the people we have to
try and go against they're very crafty
very nice people honest sometimes
they're just a person sometimes they're
an entire nation states so you kind of
have to think a bit crafty you kind of
have to kind of as Norwegians say what
would the Fox say I don't really know
they the thing with this is that as we
get smarter they get smarter
for every single thing we think will
block them they design something new
Apple with their new little of thumb
print scanner a gummy bear you know it
comes down to what type of attack vector
are we going to look at next who thought
it would you could actually hack an
iPhone through the electricity Channel
how many of you seen rubber ducky
general it is from hack five rubber
ducky is a USB pen USB stick that you
plug in and it registers to Windows as a
keyboard but execute script and someone
go why would you do that because you
didn't say I couldn't remember this is
like dealing with children don't do that
why because I said so so what do we do
we fix our developers and not the same
way you fix your pets yeah this one
person got a hold on we're talking about
education because the web is an
absolutely terrifying place we forget
sometimes that we're not all nice people
some people were going to break our
things they're gonna try and really get
aggressive with our stuff and what this
talk is about is showing you the stupid
stuff now this is the probably the fifth
year I've done this talk not here but in
general in Europe and it's probably the
last time I'm gonna do it in Europe and
in five years I have had never had
anyone come up to me and said we had
zero mistakes out of your talk okay I'm
hoping that this really big room will
provide a cool Flint clean sheet for me
and I will actually get away with after
five years of presenting this talk with
no one with zero this is a kind of a
collection of the OS top ten done my way
it shows you some stupid stuff
it'll make you laugh it'll make you cry
to make you go what were they thinking
when they decided to do that okay please
what your main takeaway from this
session should be is go look at your
applications afterwards reevaluate what
doing maybe kind of challenge the gifted
wisdom inside there in your app and say
why are we doing it this way is there a
better way has it been circumvented
since we decided to put it in so number
10 I will ask you a lot of questions I
will hopefully try and get feedback from
you I was explained to iearn that like
Nordic countries give you very little
feedback you get a little golf clap well
done that was a good session and that's
about it thank you for laughing by the
way you'll all be bribes later free of
spite your beer number 10 it involves
leaving administrative info on your web
server now we'll ask a few questions how
many of you have deployed a web
application to the world the internet
thing big place how many of you rang
your friends and said I've done it one
person and that's you're a security guy
so that doesn't really matter the rest
of you all put your hands down why we
can do this all day folks
generally I think it comes down to I am
not telling anyone I put my stuff out
there they'll bloody break us yeah but
the general yeah that's what you've done
isn't it most of us do that we don't
want to tell people we put stuff out
there because they'll try and break it I
will but I'm an asshole sometimes so
it's like it's my job
how many of you've done like for example
did trick of like I'll back up the side
I'll zip it now leave it in the
directory I'll put my hand up I've done
that how many of you tried googling that
afterwards let's have plugged into the
Wi-Fi here but I'll show you something a
minute the thing we do is sometimes we
forget that we leave application info on
the server and we just forget that it
can actually be Google to our dong we'll
go back to take the piss out the
American again do you remember this
thing called the White House if we
forward shut down cool and remember this
guy called Bush yeah did this I was
gonna say the smarter one but no I'm
sorry the one double yeah remember the
robot start text from there if you've
never seen it go google old
whitehouse.gov robots.txt robots.txt if
you're not familiar with it it is it
tells search engines where not to search
this told him it was like it was
basically like here's the map to area 51
you Inc don't search here no nothing to
see here folks just Korea looks doable
yeah it was it was I was thinking the
webmaster was like an ad master that day
it was they just did not get it and when
it was found it went really really viral
very quickly because it proved something
very simple that even very smart people
can make stupid mistakes by leaving that
type of information out there we're
gonna see if this works and if it does
great and if it doesn't for well the
tintern s where is that yes can we can't
see that can we no we're gonna try and
do something here all right if I look at
this
you can see filetype config in your l
web config in your L FTP now there's a
couple people trying to figure out what
I've just shown them but what I've just
shown you is someone who's left an FTP
server site open with access to the web
config and for those of you who are from
the real asp.net web config is how you
configure your application all right now
I had a look at this last night because
I'm of course nosy about it all and if
we go a little bit further down here we
see applications that mercedes-benz code
at za that's the South African
mercedes-benz trainers inside there I
don't really want to show this on a
public forum I'll let you google it
yourself and dish it's inside the
web.config complete with connection
strings to the database ladies and
gentlemen go buy yourself a merc you can
Google any amount of information it is a
really powerful tool provided you start
using advanced queries and actually
going looking for stuff now some of you
are going why would you leave FTP open
well I want to FTP stuff up and down
it's pod easier and I kind of want to do
it it's you know I don't have access to
HTTP archive Mac the drives are not
using web published or not using web
deploy or whatever okay leaving that
type of information open very stupid can
happen I've seen the IAS start page I've
seen like the administra p--
seen people where they've enabled it so
they can be run from remote servers
because it's easy don't you doesn't mean
you have to do it okay sometimes it is
come down to don't leave your min if
this is a very difficult one for web for
a web folks because we're so used to the
application we forget on the server
we're running sometimes we'll forget it
and then it'll go unnoticed until
someone kind of breaks in and does
something with us you know watch that
one number nine passwords this gets me a
lot because I hate this when I forget my
password
how many of you do that how many forget
passwords cool how many of you use the
same password for Gmail Hotmail female
baseball something I have no idea
Facebook how many of you changed them
regularly
now there's probably there's one person
I'm just getting a really tired arm we
don't do it because we're human
passwords are hard we make one complex
one and we kind of use it for everything
we make a simple one which for is it
kind of like a throwaway bond we can use
things like LastPass keepass whatever
you want they'll all do the same thing
but we still in general for guess that
passwords are kind of ours and we just
kind of throw them out more often than
not you'll use the same password on
multiple sites attached to your email
now all it takes is one compromised
server and one compromised database to
get that email and password combination
how many of you kind of seen like when I
forgot my password I'll email it back to
me and it comes back and plaintext how
many of you hate that how many of you
want to go back and shoot the developer
there's a lot of blood in this audience
ah the Vikings are back you know what it
would be great if we could actually
leave a really bad developers head on a
pike outside the door you be stupid this
is what happens you know I think you
used to do that to the Irish I don't
know passwords in general caused us a
lot of problems it's very easy to forget
to encrypt them okay hash them whatever
I'm sorry I'm gonna be very specific
here hash the passwords don't encrypt
encrypt is reversible hashing is Nasim
okay get that into they're all kind of
sensitive data should be it should be
hashed the basic asp.net provider uses
sha-1 replace it use something like
bcrypt
uses sha-256 it's a quick new guy to
install off you go good luck and you're
done you'll change the provider you've
now got really strong encryption on your
hashing on your provider you can do a
lot more stuff with it the idea is this
we passwords are now becoming the kind
of standard issue kind of security
gateway how many of you use two-factor
authentication with like Twitter or
Gmail or angel not maybe you should
start investigating they're not just
those who don't use it just do it
it's a very simple trick it's annoying
but it does work it's kind of this is
the problem to trade off between what
the trade-off between security and kind
of usability number is probably where we
guess the most cos a number ace is not
patching our server or allowing our
admin's to do it for us what happens the
second Tuesday of every month
well done
normal better known as Patch Tuesday
what happens the Wednesday after the
second Tuesday of every month
it's called roll back Wednesday not zero
day hacks but close enough it's like
crap it broke something you ha more
often than not what you'll find is
administrators will patch about a month
after the update comes apart comes out
mainly because they need to check it it
never happens that you kind of go oh
we'll just roll in this but on this
crucial server we'll update it and see
what happens we'll do it on the test box
and we'll do everything your question
are you just waving at me oh you do that
yeah you're honest yeah because like we
I used to work with share points I still
get in the shower it just doesn't come
off feel sad for me come on those of you
working with SharePoint not gonna hire a
man''ôs they're being through it
sharepoint had a very common thing when
you would apply an update it would
generally break something the User
Profile Service would break something
would break you had to fix it it just it
was held so now no one ever patched it
on the day because they had to wait and
test everything out same problem happens
here people don't patch servers because
of the fact that they don't know what's
gonna happen they need to figure out if
it's going to break they want to try and
see what happens it's very very cautious
and so for that Microsoft had the Oracle
padding with asp.net and stuff that that
came out very quickly because it was a
qfe release quick extension earring it
had to be done because it was if it
didn't have broke so much other products
it just needs to be fixed
that was one those ones where you kind
of said yeah we'll screw the results if
it breaks it breaks but at least we
won't be compromised generally as web
developers
web application developers whatever we
are not overly concerned with the
deployment platform we do we kind of it
has to be this but we don't really kind
of check the state of patches on us
you can google for machines that are not
patched you kind of have to put in like
for example try and throw an error
message and see if you can get the
correct asp.net version number from us
you know it's very simple is six running
asp.net 200 for example and you can
probably kind of guess they haven't
patched this box in a while very simple
looking for kind of an header
information off servers now the funny
thing is if you go looking at like is
this is it Survey Monkey there's their
header information comes back with like
you know powered by bananas and Rome
marvels is like running on Wolverine or
Cyclops or something that I can't
remember watering them does have a drop
tables in it in the header thing so
watch out for that that's kind of fun
let's see what we're doing number seven
I'm running through this a little bit
I'll slow down a minute
number seven is authentication quick
show of hands again ready how many of
you turned off JavaScript on your
browser and browse the web how many you
thought it sucked
javascript is the standard for kind of
scripting and stuff of that it's also
the standard for writing authentication
routines the problem is that if you turn
off JavaScript and you don't have server
validation turned on or anything like
that
all of a sudden your gates are open
sorry we're going to take the bouncers
away for awhile just so they can have a
smoke and a cup of coffee you guys be
good and show your ID when you're going
in right going all through the problem
is that you should have double double
authored was a double factor
authentication normally also
authenticate come on get with the
program arson two-factor validation on
the client and on the server if it's
gonna go to your database if it's gonna
go to your file system it's going to go
anywhere
your server should validate us and
reject it if it's not rice you should
use a central validation source for
everything main reason is if ther
tomorrow decide they're gonna change how
email works and change how the mail
addresses are going to be perform added
you only have to change one place not
everywhere you won't miss some state you
won't make a mistake validate against
the RFC rules validating XML against the
Dom against and what's that thing called
an XML can barely spell us and you
should also look as when you're doing
your validation and so for that that
people can't bypass it you know very
strict kind of line I have seen the kind
of SQL injection script where the person
has a Java Script on and it says if you
find the word select ignores or if you
start putting in kind of funky
characters at all does that we then
turned off the JavaScript and of course
then we could do SQL injection on a
server but you've got to be very careful
javascript is the way we work with this
stuff it's very simple to make a mistake
with us you can do two side validation
and things odd but please you know make
sure your server validates at least
there's an there's an Irish joke of like
white as an Irishman wear two condoms to
be sure to be sure and it's very true in
this case with them you want to be
doubly sure nothing gets through number
six we have a nice little thing have you
all gone to sleep everyone wake in
general I had to find the IKEA thing
because this is a Swedish error you
actually to put this together yourself
it came with a manual the problem with
error messages how many of you see a
stack trace and it's for the asp.net
guys now how many of you who see a stack
trace can read us good is there anyone
who didn't prop their hand in asp.net
developer nope okay just because it
looks all funky and stuff of that does
not mean I cannot read it this has come
from Media Inc something in the XHTML it
tells me a lot of information straight
away for those who can't read it it says
could not find files see clients ima ima
updater
breadcrumbs XSL it chronic you can
amount of information you can get from
this is absolutely stupid it gives you a
very simple idea of what they're doing
you also can tell a couple of other
things one they haven't turned custom
errors on okay number two they haven't
turned customers on so that means you
can probably start looking at other
attack vectors very quickly it is I
found this on the Irish Examiner website
something like this and it was written
in VBS and I thought okay there's my
first mistake number two this thing
comes up and I'm like oh God I emailed
the webmaster and said listen you're
doing this wrong by the way there's a
bug in your code here here's my bill
consulting screwing people about money
all the time
I mean we're being good the main issue
with this and it's very simple to
actually fix this type of error is turn
remote errors only so allowing that you
when you're on locally working and Deb
you'll see the errors but when it gets
pushed to production it automatically
gets set to this now if you've not seen
a thing called slow cheetah
it's a XSL the apke web.config an XML
transforms it's a tool written by Sahih
Hashimi in Microsoft as part of the web
deploy team he has written this thing
which allows you to basically say okay I
want to when it gets deployed to
production change all the following
values it's very simple it makes it very
easy so that when you push this out to
production you can be guaranteed it's
going out with the correct settings you
don't have to remember it's just just
work the tools are there just use them
you shouldn't also leave trace dot ax T
on how many of you ever tried to look
for that on an application I've actually
been looking for it and those who kind
of they appear it gives you a good
indication what's actually going on and
Elmer dot a XD and you're familiar with
Alma logging system if you in config
there if you incorrectly configure it
and if I leave a little bit open it does
show you a hell of a lot of amount of
data in absolutely his horrendous what
it did it just says how here we go
tell you everything good luck goof go
break stuff glim study XD now you seen
glimpse the product from the guys
working abroad guys not seen glimpse
please go check out get them stork
fire bug for your application in the
browser and if it natively it's it's
quite secure but if you do say for
example I want to see what's happening
why is something slow and you're a
consultant you log in you just changed
it so it's visible to everyone else it
will show you things like they for
example the connection string so be very
careful when you define it turn your
debug off turn a remote errors on
minimum but should have customers are on
number 5 permissions this I think is
probably the trickiest part in the kind
of 2010 plus era of Windows development
most developers from the 90s and around
that area were familiar with how ntlm
works and understood how windows
authentication worked and its
interaction between iOS and Windows
itself because in that stage you hadn't
had to understand how Windows
authentication did work for example do
you have you ever gone into a client or
a customer are ever ever set up an
application whereby you have windows
authentication working against the
database you log in it works you publish
the deployment and it says it can't log
in with network service haven't done
that you sir do you know how you fix it
remember the error message the general
way that a lot of people fix it believe
it or not is they add the computer named
to the database server and let it run
that way this was known as the old
double hop authentication problem and
it's because of the way Windows doesn't
allow you to pass credentials without
using a thing called Kerberos or what's
known as delegation of rights this is
where most developers and web developers
will go Poland I don't know what
happened it broke it worked on my
machine
nice big star published in production
doesn't work you'll see things like
they'll move the database to the same
server
they'll move something around they'll
have to try and figure out what's going
on the general fix is that's what
they'll do and you're going oh did you
not understand one wrong no but this is
how I fixed it back in the good old days
before open xml and all that kind of
thing if you wanted to do like creating
excel files on the server you normally
installed excel on the server and then
you gave a domain administrator rights
to the box i have actually seen the
asp.net worker process with enterprise
admin rights in a domain now the people
are laughing or now understand anyone
asking those you're not laughing it's
equivalent them saying here's a headless
rodent running around our business with
full rights to just pay anything and do
anything it doesn't matter it can do
anything at once and that password and
stuff can be hacked have you guys seen
how to hack the IAS meta base anyone
know what I is is I have to ask these
questions I've got this very much the
Danes going I'm okay
we all are drinking last night without
me the ia is six compatibility stores
means that I can go inside and actually
query the meta base and actually get the
s am username and I am password out of
it which means which is I've actually
done before on I is I you can just use a
straight query you can actually get that
information back out I'll give you the
username and password in plain text so
it was actually how I recovered domain
admin password one day because someone
week forgot of this type of information
out there and permissioning makes it a
problem then the normal question I ask
is how many of you use like two
connection strings for your application
one for read and one for rice the shifty
I look here is means that very few
people have done it one gentleman I can
see there why does search need write
permissions that's a question I'm going
to ask you is because as you're looking
at defining informations very specific
permissions for a very specific job
don't give it any more than it needs
start from the ground up and then reduce
are sorry and then add as you need never
go from the top and reduce because what
happens there is people go oh it's still
working still
I'm still working still working it's
broke I've gotta go back up one and it
might be too much fine-grained
permissions do it like that you should
be using like a - connection string
process if you're using one one for
search one for reading one for write
debut DB rider DB rider take away
permissions you don't need evaluates
actually in your application do I need
to run it as this specific user or can I
kind of work as something else we're all
thinking which as you're sitting here
you should all start to be kind of
thinking about your applications and
going yeah maybe I had something like
this before where I had I was doing this
in I think when the first one was ever
did it was in in Scotland a gentleman
sitting in front of me and I said how
many of you use give permissions like
this and then he goes I have sa running
on my connection string and I meant rice
I said what's your site and he goes www
dot and I was like we're about to see if
we could do an SQL injection attack
because it s a level I'm going to show
you something later with an SQL
injection attack and how much actual
information you can get out and it's
frightening because I was trying to
figure out why would you need sa our
system administrator level permissions
on a database to do a simple query
there's nothing that you should need sa
for thank you yes it is ignorance about
how to set up a SQL server the problem
is like as we say developers will go it
works don't touch us you know how many
of you have actually done that where it
goes it works and then leave the testing
to someone else people like me we as
developers need to be more conscious of
these type of problems price we're
starting to get into the fun bits
I don't do some demos work now have you
heard of directory traversal anyone one
person there two three four directory
traversal is where you can access up and
down where you shouldn't go for example
we the basic example is directory
browsing is enabled you can't go
bouncing around it doesn't show you
anything
boss consider the following
the web.config cannot be downloaded from
an application correct sorry if you have
directory access is still won't allow it
because IAS will block because it's a
block file type but let's see if this
works
come on kiddo is this is yeah okay I'm
sorry I have to kind of search around a
bit here and we will see if this works
and this might go somewhere hello oh boy
come on demos hello right that's there
really do you know what as a developer
I'm really complicated screens are
complicated to me okay this is just
gonna have to go somewhere here it's not
the right one yes can we debug this
please there five are you running oops
there we go
alright and I'm just to enhance this a
bit can everyone see that in the back
even though is open up nosebleed seats
okay this is a very simple site I call
this project Swiss cheese it's the most
secure site in the world as you can see
running over HTTP this is a very simple
site this kind of demos some
functionality that we would in general
have in an application so I have upload
a file I'm going to choose a file it's
called bad stuff aspx
and even show it should show as an image
but it's not because not an image open
image a new tab oh what's that
that's my dear friends is bad stuff dot
aspx this is a just a simple file
browser written as a single as a single
page and what it allows me to do is
bypass fairly much everything I want to
do so I want to download web config will
open that we'll see what version of
something oh there was come on website
config downloaded now I don't know about
you but it tells me a lot of stuff I see
a machine key
I see membership providers I see
connection strings I see everything
this I know this is a very trivial
example what this actually is doing is
someone has allowed an upload and not
checked what type of files they're gonna
upload I uploaded the file found out
where was gonna be put and then just
said right let's do this
it's a stupid example but as one floor
says why would you do that because no
one said I couldn't now right as you can
see what I if I'd written that code a
little better I'll show you what a code
actually looks like if I can move my
mouse a bit this was this one here we go
and this is complicated doing it like
this
this must be what pair of programming is
like someone stopped moving my mouse
okay stop - I look so stupid right now I
was like I'm gonna do something stupid
here and we're gonna put this over here
so I can actually use it on this no
that's wrong bear with me for a sec well
I try and make a bad situation worse
uploads bad stuff to the aspx run back
over here Ariel okay when you load the
page just does a quick look for what
current application path I'm in it
checks gets a list of all the files
searched optional directories just gets
all the wrong directories all below this
binds the files and turns out finds out
a repeater something that's stupid
number two for the download which is the
most interesting part is it just gets
thing and just sends file read all bytes
and then just output streams it so it
bypasses the IAS filters and just sends
it through asp.net this is a common
thing when you want to try and force a
file download if you want for example
not display a text file but actually get
them to download us download the PDF
download something where I would
normally natively open the browser this
is a common scenario people will
actually use this in what in my case
what's made the difference is I've told
it ignore all that and just kind of just
download the files out ever I want I
don't care I'm whatever link I click on
download it now it's a stupid example
but to some people is probably a
revelation that you can actually do this
type of thing and when I show this one
the first times I had a person actually
say we do this and I said do you
actually tell what files do it he says
yes in the in the URL and I said oh boy
because it worked and at that point the
problem was solved and the person
thought next problem and did not
consider what would happen if someone
went and did this now it's a as I say
it's a stupid example someone probably
wouldn't allow a file upload of an aspx
file but in this case they do but if you
do allow all multiple file uploads or
types of things do you actually check
what files you're uploading and this
kind of idea of like being able to kind
of go up now let's extend this one more
and say I am running this application as
a very privileged user something that
has access to route C or beyond
and I go in to see winter system32
drivers are some types around there and
I go looking for the Sam and security
databases does anyone know what I've
just found I'm gonna heard of yes sir
you did you just found all the accounts
and if I gave you those two pieces of
information could you break them it's a
question I'm not I'm gonna wait here but
he was the machine key if you've got
information use off crack brute force
one GPU and you're kind of going through
all this there is a thing called Radeon
City if you've not heard of us go look
it up it is a 25 GPU cluster running
Radeon graphics processors it currently
processes a 186 billion passwords and
minutes now for those of you doing the
maths and the guys at home with the
calculator that's about maybe you know
25 passwords per person per minute I
don't have 25 passwords even that many
combinations this thing is just chunking
out stuff it can crack nearly every
known password in Windows in about six
hours just by brute force and a small
nuclear reactor going beside it and
given that you can probably buy a
nuclear reactor because we'll sell it
we'll buy it from you to provide money
I've got 10 minutes is it sweet yeah
actually anyone want to buy a nuclear
reactor from the angst they'll probably
put him back in business
ok no more jokes at you I'm sorry okay
where are we at that's number four
that's our demo number three SQL
injection no it's actually exercise
injections injection attacks are still
very prevalent even in this day and age
okay it's stupid we should be kind of
getting better at this information and
better at this stuff but we're not we're
actually getting worse because people
are kind of going I I'll be fine
everyone else is doing it that way so
why should we worry the amount of times
you get caught with this script
injection
there's three different types there's
the Dom which is very common
there's non persistent less common and
persistent which is the least common but
the most dangerous it's the one where
you just type in something you expect to
get script back and it does all that now
I've seen people say okay we'll use SQ
we'll use scripts and try and avoid this
we'll use JavaScript and trying to get
this working out and avoid this but then
you can start putting stuff in an HTML
characters format especially whatever it
starts getting there's the attack
vectors out there and there's like
there's tools written for this they're
just going to go off and scan your site
as you pointed out earlier on and
there's tools written for this which
will actually just kind of start hitting
your site with every type of crap it can
imagine and give you back a report
saying yeah they're probably sub septa
Ballou the following code try it it's
very simple and cheap now as cookies we
with the EU and the cookie directive and
whole lot of things that does not really
sound like a dodgy 80s bands the cookie
directive oh come on someone give me a
bat for that Jesus there's a simply left
see that's a Jew you ask them sorry you
have do you not do you know what the was
at the asp.net webforms authentication
that in general if they're on the same
server they'll use the same cookie type
and if you kind of don't have the
correct name on it it'll actually is the
same one they kind of get stuff stored
together and it's a bit odd so be very
careful about your cookies your cookies
should only be accessible to server-side
code never accessible to client-side and
your HTTP cookies should only be set to
hate to be only cookies equals true
don't use session cookies on the browser
take it from a person who did send out a
link to a new size with a full
administrator session cookie in the URL
and it was a government size contracting
yeah causing problems session hijacking
is very very simple it causes a problem
so make your ugly cookies go back and
make them happy and they'll all be good
the number two I'll skip to that but
I'll talk about a bit more number two is
still believe or not SQL injection
attacks and this
makes me cry a lot because it's so
simple on what we can do so let's have a
bit of fun as my owner is my site still
running
come on Chrome okay we will search
let's try IRL hips searches are out no
that might be the wrong one and Erland
yeah
so it's a very simple search you'll
agree nothing crazy
okay let's try something else
this mouse is not having a good day
today squeeze me
oh well the players are well played
it's always one second smartest there we
go okay what happens here search ooh
what I find here sorry it's telling you
what sequel servers are running on my
computer what matrix that was the glitch
in the matrix you all saw that right now
it wasn't just me
you are the ones how the freaked out of
a presenter make the screen go black
there's some guy actually out there a
little zipper going PPTP okay that's a
very trivial example of something stupid
let's just bring up SMS here yes and see
where this on-screen goes I have
multiple searches for this five minutes
okay come on computer
all 16 gigs around let's do it I have to
find another query now if I was to show
you something here
and where am I going to hear what does
this look like anyone
straight login screen asp.net forms off
kind of standard issue login wizard yeah
okay right
what could you imagine then they've done
they've run and don't enter let's see
we're going to the search again and if I
do the following Union this is what's
known as a Union query and I'm hoping
this one works whoops I forgot to do
something there that's how I would find
out if it was actually something wrong
and I need to do at the end a nice
comment ok so now I've just told I've
just queried the database to find out
what tables are running in there ok as
you can see asp.net applications
membership paths so I know they're using
the asp.net membership provider now so
far so good
what is do we know about the asp.net
membership provider it's table schema so
if I do a nice big another query here
search
we can now see the users and their
passwords now for those of you kind of
wondering well what good is this they're
all encrypted in this case they are
actually encrypted not actually hashed
we will bounce up another piece of code
but first and to prove that everything
is actually aboveboard
stop doing that that freaks me out
project we'll just do the a so you don't
make configuration okay security create
a user username go to password so much
out a letter hey
not a letter B I can see which way this
is going okay hi in a second
this might get complicated so a B two
more letters
okay Q just do that it's I know it's a
four character thing it's not it's
rather not easy to guess but it's I will
say go to hotmail because you know
hotmail is spam okay create user so
users being created I'll go back here
we'll f5 this confirm resubmission yes
please continue so go to is sitting
there which is nice password and because
we've already downloaded the machine key
of this machine and we will try and
bring up this nice piece of code fine
and this brings up a nice come on that's
in front of me here we are going to go
back to here and try and copy this with
my dodgy mouse stopped using the
keyboard
why you shouldn't encrypt your passwords
no no get a round of applause for doing
this the stunned silence was good too
though thanks there's probably something
gone can you swear oh yeah you can do
that in Denmark Chris they don't speak
English sure so it's alright yeah that's
one the first things that got me in or
in Norway when I moved up that there was
swearing it like very early on the day
anyway that's our demo done number one
the number one reason we're stupid okay
we make mistakes stop making mistakes
stop being stupid the problem is we
forget stuff we don't do it right we'll
just make mistakes it leave you so
frustrated by what it'll cause the
problems that cause it'll cost you money
it'll cost you I had a lot of problems
it may even cost you your job so there's
an asp.net resources the OS 10 by Troy
Hunt is free go please download it and
thanks to him for rejecting to do this
talk so that's why I'm here
thanks Troy some basic security
principles safe web and all that these
are all gonna be on my blog afterwards
security guidelines watch out for your
else can it could get a bit hard it can
harden it too much for you image credits
this could take a while
if you are can what contact me come back
screen yeah you can get me on any of
this or even catch me afterwards I am
running for a flight after that so it's
gotta run um questions one question how
do you get your hair so red
I gotta love it kerberos I miss
land man love stop face can I use to
correction strings with a norm very good
question
some you can some you can't that's the
basic thing and give you how would you
design an arm layer what multiple
connection strings the same thing what
books to read go read buried or ins
beginning asp.net security and Troy
hunts Oh a stop ten and ladies and
gentlemen thank you very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>