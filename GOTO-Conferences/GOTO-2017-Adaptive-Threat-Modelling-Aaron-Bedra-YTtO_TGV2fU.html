<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2017 • Adaptive Threat Modelling • Aaron Bedra | Coder Coacher - Coaching Coders</title><meta content="GOTO 2017 • Adaptive Threat Modelling • Aaron Bedra - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2017 • Adaptive Threat Modelling • Aaron Bedra</b></h2><h5 class="post__date">2017-05-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YTtO_TGV2fU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I want to talk about a whole bunch of
stuff today we're going to go through a
whole lot of concepts and whole lot of
topics but I want to start with some
really foundational stuff which i think
is super super important really starting
with why do we do this why is there
security tracking software conference
we'll start there why would we have a
circular track at a software conference
what really is the answer because the
job just like everything else we're
going to do it's our job it's the
responsible room there's a whole lot of
really shiny stuff going on and go to
you this is the stuff you need to be
they listening to you right now go tell
everybody else that and you know it's
fine if they didn't go to this track but
we'll go watch the videos right and not
to this conference all the conference's
that have security tracks go watch those
those videos they're really important
but in the why right in the why do you
do this it kind of boils down to two
answers in most cases those these are
the two answers will speak in terms of
emoji for most of the time money I lost
thereof and loss of life right those are
big you can you can what you'll get
asked wide you can give yourself a bunch
of super superficial answers this is
pretty much why right at the very bottom
of the stack you don't want to lose
money and you don't wanna lose life I'm
not going to talk so much about the loss
of life and protecting lots of life
because it's a whole different
philosophy there and I don't tend to
play in that space very often so I'll
tend to focus more on lots of money
where I'm comfortable and nobody's
nobody has to die
and I will tell you this if there isn't
a reason stop doing it I want to start
there this is one of the first things I
do when I go anywhere as I tell them to
turn off some stuff off because there's
a bunch of stuff that happens in the
name of security that's just insane when
you have seven factors to place your
lunch order there's we have a problem
right that's there's differences here
now that's a lots of money out lots of
life
maybe there's a there's a point in
protecting lives that that matters but
security has to have reason it needs to
come with purpose and intent the things
you do in security should have a reason
doing the security thing because
security is not the way to do this
you're going to spend too much money on
the wrong things that's why I want to
talk to you about modeling Zig this is
one of the vehicles that gets us to
being able to focus and figure out what
really is important right you have to be
able to understand your threats before
you can figure out how to apply controls
against them if you just are applying
controls and not understanding who your
threats are you might be doing
completely nothing right just just it's
doing something but it doesn't have any
value right you have to understand where
you are in relation to where others are
and how far away you have to be from
that threat it's important this thing is
very true you just have to be faster
than your friends that's that's it right
most financial breaches are crimes of
opportunity right very very I mean it's
increasingly often these days but for a
long time it was just they happen to be
vulnerable something that the scripts
figured out right and they got in and
they did some stuff and you just got to
be hard enough right the barrier has to
be just high enough if they go somewhere
else that's it it's not you have to be
perfect you have to be annoying enough
if they go somewhere else that's the
goal that's where you want to be but I
want about understanding threats that's
step one is figuring out what's going on
and I go girl for threat modeling and
it's a bunch of words and they have some
meaning but what I want to talk about
today is a distillation distillation of
all that what I really want to talk
about is drawing documenting and
prioritizing that's it that's what I
want to start with we can get really
complicated later but I want start here
I'm not going to cover that allergies
and start modeling if you came here for
a lesson on methodologies I'm the wrong
person to talk to because I don't like
any of it it's possible to you know
stride down the block on your trike and
get some pasta but I will ask you to do
that on
your own time because all that stuff is
complicated if you say tomorrow I'm
going to go back into a threat Melanie
at work and you have to read a book on
threat modeling you're going to fall
asleep boring but we can ignore all the
rules and we can start with a few things
so these this is what I want you to do
when you're done with this conference or
maybe just when you have a break a few
simple things to get started and then
we'll build a foundation from that first
thing to do
open your diagrams I don't have them
start them that's fine too but it starts
with drawing and every time you have a
line at a protocol so I'm this box
connected this box how what's what's
how's it communicating when you have
every box in place label the assets
what's on that box and what may be going
over that bat line or maybe what may be
staying on that box job draw boundaries
around network groupings I have stuff in
my data center and I have stuff than a
customer does not think it's super
granular but you know big picture stuff
just draw some some kind of trust
boundaries start with just that that
will give you a probably better diagram
that you had in the first place which is
awesome and that's good for just general
purposes but now the next thing I want
you to do is label all the controls for
every asset figure out what controls you
have in place for those assets anytime
you have an asset with no control
there's nothing to think about
notice I will not say there's a risk
here there's something to think about
identify the points of entry
how does somebody get into the system
how do they communicate with the system
a lot of times you know a web app has
you know a web part of it and there's
probably some kind of management but
what else how else could tell us with
somebody get in and that's that's not
malicious people that's everybody how
does everybody get it next we just like
stop a tech stuff entirely we talk to
products and business and figure what
their goals are right what does the
business want to do in the next six
months what are they trying to go what
what products are they going to
introduce you to you're going to have
then figure out that may change that
those boxes and lines Wow my bad picture
be different integral months one of
their goals one of the risks what are
the business have to lose if you don't
understand what the business has to lose
you can't do security actually you
probably can you shouldn't do security
if you don't understand what you're
protecting you're in the wrong game you
will do the wrong things because you're
uneducated this is so and so important
you have to know what the business wants
to do and hopes to accomplish and and
really what can happen if something goes
wrong you've got to be intimately
familiar with that to spend time with
the business and then when you're done
take those business risks and map them
to the tactical rescue fund right
all those little areas where there were
the lack of control our weak control
figure out if that weakness in control
maps to something that could hurt the
business because I will tell you that if
you don't have an intersection of those
two you did not have a risk because it
doesn't go back to money or loss of life
it's just a thing maybe it's a missing
control that's okay maybe you're fine
with that so you want to find that the
most important things this is about
focus not about what all is wrong and
that's we can go in and say all these
things are wrong what I want is these
four things are crucially important to
the sets of our business because that's
what matters and that's how you get
buy-in to do what you need to do and
again that comes that comes to credit
ality right it's ranking things so just
you know if you have 20 things make a
list of three but three most important
things if you a list of 100 make a list
of two right the more things you have
the shorter your list should be for
those things to focus on because it's
just too big and it looks something like
this
this is just a sample that's a tiny
sample it doesn't have all the things
that could go wrong but this is kind of
what I'm talking about right we have a
couple of trust owns we've got a couple
of things communicating we have a
computer talking to a web application a
web okay web application talking to a
database and we have a login credentials
right we have login credentials and we
have one control authentication right
that control is saying I'm going to
I'm gonna ask them to authenticate which
means we have to have a username and
password or a token or something
traveling across the wire to get
authenticated immediately this should be
super obvious there are a couple of
things but wrong here where are they
what then
protocol why miss internet doesn't it
right but how obvious that's super
obvious we drew a picture but Oh duh
right we really really should be doing
this and when I say protocol I mean
protocol
don't say HTTP it should be HTTPS or
HTTP label it appropriately
they're definitely separate protocols
when you look at acid there's other
things too right what about what about
the database that asset that those
credentials are on the database
there's no I didn't put there's no other
control there what might we want to do a
database to protect that asset hmm no
not encryption what may want to do no he
was close
hashing yes yes I will be pedantic about
that yeah you want to have it if you
want to have those passwords right you
don't wanna put a sign in plain text and
there's there's a whole bunch of things
we can go down the list and do a whole
bunch of more just this little tiny
example but that's that's the point
right you look at this and it should
make it obvious to you right the point
of this drawing is how obvious are the
things that are missing and if you look
really hard you can't find it move on
that's fine right down the road you'll
get better at this and down the road
you'll probably hire somebody to help
you with this right there are
professionals that can help you do this
exercise a lot more effectively but we
can all do this tomorrow
every single what person in this room is
equipped to do this and that's why I
challenge you to start here so once you
have this foundation right I haven't
talked to Eddie at all about threat
about what people are capable of I've
nothing nothing at all yet right but
once you have that foundation where you
have drawing assets controls protocols
all that stuff then you start to create
the attack scenarios that's where you
find the emoji for the person that looks
like a weird cyber hacker thing and you
plop them there you put them in in
different places right you put them in
in the trust zone which happens to be a
coffee shop and that's where it becomes
super obvious why that s matters right
you put it on the network and go oh
they're just an area here let's say I'm
in this coffee shop and I'm about to log
in and this other person's on the
network the real threat here is somebody
could sniff this pass or that's going to
be on the network considering this
password what's the pain ability needed
to do this how advanced somebody has to
be to do this the answer it's not at all
right anybody can download a tool and do
this so marginally capable so the threat
is a large community there's a large
people isn't anybody in this room could
do this right now
if easily right so the control is very
low the threat the threat capability is
low but it can overcome the controls we
don't have any controls in place really
other than just you know somebody that
maybe can't open a browser and sell a
tool so you know we can change the
control and make that attacker have to
work a little bit harder right we change
the capability requirement to that
attacker we add the s now the attacker
has to do something different their
capability requirements go way way up
well maybe not way way out but you know
up a little bit more than just nothing
well that's what you think about you
know on the PC how did I could get on
your computer what are the capabilities
an attacker to get on the computer to
steal them
what are the capabilities of somebody
being inside the data center or inside
the web application or inside the
database what do they have to do to do
that right what are the capabilities an
attacker would have to do to get there
also think about the controls you might
have to stop them which is going to
basically increase that what they have
to do to get in and no nobody's Fort
Knox everybody can get in but if you
know maybe 1% of hackers could possibly
get it here or you know the Mossad
because they can always get in you know
maybe we're going to be ok with this you
know and this is where the threat
modeling kind of ideation comes into
play who am i protecting myself against
right there are very few people in this
room who need to protect themselves
against nation things you know maybe
somebody's gonna attack you but you
don't want to play that game if you
don't have to
you're going to lose you just are unless
you're also working for the government
you kind of want to win but most of the
people in this room you know everybody
doesn't have to play that game you want
to play the game against the people who
are driving by or maybe have a vendetta
against you maybe you work for a
publishing company or you know a
newspaper online
yeah social media lots of angry people
accusations things can happen right so
you have to think about who those
threats are and this exercise is where
you start to think about who those
threats are and what the what they're
capable of doing and the next thing is
what are they after
what do they want to get what are they
trying to get from me that can cause
this loss and I want you to focus on
reality this is not this weird game
where you play you know mr. robot and
try to figure out you know the deepest
darkest nastiest hacks somebody can do
those off the table right focus on the
stuff you can happen but anybody could
think of right now right do those first
those are the most obvious and that's
where most of the breaches come from
it's not the super advanced you know
malicious hacker it's a drive-by because
somebody for have to patch something but
that's where a lot of this happens the
easy mistakes and those are the ones
that get capitalized on almost all the
time and again it's about defining the
capability to the attacker because in a
minute I'm talking about risk and risk
is a game where we have to understand
how capable an attacker is and how
capable our controls are and we're going
to do some simulations and that
capability is super important and again
back to business without a business
justification without a business loss
there is no risk I will say that full
stop every time now if you go you loss
of life space of course that's part of
the risk as well and you want to account
for that but you have to have an impact
that really is as a tangible observable
loss if somebody breaks in and sits in
this chair here what's good what's the
problem is there a loss maybe they go to
conference didn't didn't get didn't get
their money for the ticket but is it
that bad maybe not right so you have to
think in those terms right and one of my
favorites here is the vault
fire if you have a ball of its higher I
think there's no tread it you can see
the inside the tire coming out what's
the risk sure that depending on a car I
just set up the ball tire if I attach
that tire to a rope make a swing out of
it what's the risk it's going to fall I
didn't I get anything like human right
there's a scenario that has to be
complete here a bulb tire isn't there's
nothing I don't care about about tire
small tire can anything it'd happen to a
ball tire right it does it doesn't
matter right I haven't applied it to
something that could create a loss yes
if you add it to a car you could have an
incident the car has to also be driving
right
you could add somebody in the Rope
swimming and they could maybe the Rope
is frayed they could fall off and get
hurt or die right something else has to
happen in order for that to be real
tangible right so if you think about
loss events you have to think about what
you stand to lose not what the
vulnerability is vulnerabilities this
much of a giant equation and that's how
they get the driving risk so there's a
rich methodology there's lots own out
there the stuff I'm going to identify
with close or closer than others it's a
fair framework and you can do this any
way you want to I'm not telling you to
go out in use fair tomorrow I personally
love it and I tend to kind of adapt to
that but the equation kind of fits no
matter how you do this and there's a few
things right how often am I going to
have a loss event may being something
impactful and how much is it going to
impact me when it happens right so I'm
going to lose this much money or this
much life this many times a year
it's kind of an annualized function and
down below there's a whole bunch of
stuff we got to do and this this chart
actually goes way way deeper than this
but we're going to start here and so the
stuff on the right that's the business
stuff right how much is it going to
impact us is how much money are we going
to lose and at the end of the day that's
what you're gonna communicate but
how often is the trick here that's the
technology piece of it
so vulnerability is effectively just how
often does can the attacker overcome the
controls I have in place plain and
simple I have a control they have a
capability chemically ability overcome
my control if it does we will have a
loss of it the threat of it trick would
see is how often am I seeing contact how
often are people trying to overcome my
controls it's not how often are they
hacking that's that's one frequency how
often are they contacting me how often
are they trying to do these things and
so when you think about this federate
frequency is one of the things we have
to focus on because we have to quantify
this till the qualify loss you know or
our risk to the business that loss of on
frequency is something we can we
actually have the data to do we can we
can we can take these measurements and
I'll show you how in a minute there's
business stuff
worst-case improbable risk of the range
versus ever a number because you
actually did it this was a number and
you were accurate every time there
wouldn't be so much money spent on risk
we know what it was risk of the range
right how what's the probable loss and
what's the absolute worst-case thing it
could happen because my risk is
somewhere in between there and maybe I'm
wrong but you know at least I have a
range and so to curb risk or the curb to
satisfy risk even either lower that or
you can load you can narrow the margin
right a risk rains are very hello to
very high tells you nothing it just
tells you you've got a lot of you paused
you might have a lot of risk you might
have no risk so you know you can focus
on loading the margin or lowering the
the actual impact in some cases you can
but ultimately we end up the risk now
the business stuff we can talk about and
we can we can actually put real
information in there you know every risk
every company's going to have a loss
tolerance table like how much money
could I lose the fire to shut the doors
and kind of go work back from there you
can produce that stuff that's out of a
sequence II that's a little bit more
tricky right you can identify your
controls you can you could have a pretty
good idea of what it takes to overcome
those controls but we actually have our
first
barrier here how often how many of you
right now could tell me how often how
many of you think that the problem a
couple hands really know this really is
the problem right this is on the last
talk he talked he talked about this how
many of you know what normal is right
this is super important this
intelligence is super super important
how many of you have ever seen a
security issue and had somebody say a
probably not a big deal you know we find
out one investment right now more hands
right so this is really important those
of you who just raised your hand should
have also raised your hands and say you
think this is important because when you
have quantifiable data you can show
somebody why if you have a guess you
don't have an argument if you have data
you have an argument or part of not give
anyways and that goes better in
frequency how often so let's just start
here right back to our our hacker emojis
if we start with our very simple threats
the the the the the the listener in the
coffee shop we know the threat event
frequency of this it's probably
reasonably high happens especially in
big cities people do this all the time
they sit there and just sniff stuff out
or you know one of the employees is
doing it all the time I guess somebody
paid them to or they're in school and
they're learning about this stuff is
really cool I'm gonna go do this right
and the capability is so low that you're
going to you're going to have an actual
risk here how many view in the
conference Wi-Fi today just kidding
yeah how many of you joined the
conference Wi-Fi and and then
immediately VPN into something too yeah
okay
more Han the rest of you activity for
tomorrow or XM you go to conference
consider a VPN you know pay the five
dollars a month to the VPN service so
you have to manage it that's fine
there's not be technical but probably
want to do that or tethered to your
phone right conference Wi-Fi plaintext
not the greatest
and with that same scenario that exact
same thing that I'm talking about that
last slide is happening right now to you
there is somebody in this out on this in
this hotel it's probably like through
the traffic it's a good chance anyway
but the thing is the answer to how often
is usually this right this is the answer
to how often most times yeah and so what
do we do when we don't know and we're
trying to derive risk what's what do we
do we we guess right we make guesses how
good are humans at guessing provably bad
actually terrible humans are awful at
guessing now there are ways to you know
be better at guessing
but humans suck at guessing and North's
identify risk we have to know how often
we absolutely must know how often or at
least be reasonably close to an order of
magnitude let's say right we want to
know reasonably close somebody how
far off we are it is incredibly
important so we have this information
it's coming to us when people are
accessing applications right the
information is presence whether we
record it and watch it is different but
we can apply the information so I don't
frequency is a solvable problem we have
the data we can record and generate real
metrics on Twitter and frequency so I
promise a couple things I will show you
the quick and dirty and this is
something again you can do this tomorrow
it does not take much time as long as
you get a hold of your logs that's the
the gotcha and get all your logs well
we'll do a ll decay right elasticsearch
and logs - we can pull these two tools
that free you can demo them and run them
on your on your machine grab the log
files locally boot them up and you want
to feed let's just say web server logs
start there feed that into laughter
search and let me show you real quick
what that looks like
so doesn't like that but on beer for a
second here
some
with just a little bit of code ok
configuration really not even go to
configuration you boot up logs - oral
exit search with no anything right just
boot it up give it a path to files tell
you where you want to start and tell it
how you want to parse it most web
servers will fit in the comment patchy
log even though it's called Apache even
into next we'll do this okay you can
create your own custom patterns or
whatever you want but this is good
enough to get you a start right now if
you just you could do this and you can
turn logstash on and it will suck
everything in the elasticsearch with
just the small amount of stuff right
here that is literally the barrier for
starting to ask questions and then of
course we want to ask questions so once
you have an elastic search then you just
you you ask some questions right how
many failed logins do we have going back
to laughs talk how many successful
logins do we have how many how many
patterns of failed logins with a single
successful attack or attack login do we
have right those questions are trivially
easy once you have them searchable so
I'll go a few starter questions but I'm
also going to go back to a quick
demonstration I was just some things you
may want to look at I'll bump the font
up a little bit here I took these from a
static website how many times that I
have a bunch of floral force more than
10 for a force how many times that I
have an invalid request invalid requests
on a static website is anything other
they get that's all I'm going to do and
so you look at things that are just not
supposed to happen you can start with
the obvious stuff these are questions by
the way these are not they'll give you
the answers but they give you some
questions they don't give you capability
they don't get the intent they give you
something to think about but they also
give you how often right so I had you
know these people in that period of time
I think it was maybe a month worth of
logs this many actors had excessive
fluoro force now if I look and I
really dig in I might find out that one
of them was a scraper one of them was a
you know perf suite or in a kinetics or
koala some kind of security scanner
you know you might figure out more about
what they were where you dive in but you
know immediately hey I have a bucket of
things and I can do I can derive maybe
some maybe some intent maybe some
capability but also I can derive an
event frequency how often are these
things happening you know how many
people and how much they put them in the
bucket and of course you dive in from
there but that but what I had here after
I sucked into all this stuff was just a
couple of really simple filters right
the invalid request filter was just tell
me who didn't have a get request and
aggregated by client IP right if
something very simple to ask the
question doesn't take much but you get
into information so these are the kind
of things like I said you can set this
tomorrow there's nothing complicated
about this and I this stuff I'll get
published so you can actually steal it
404 same thing right find me you know a
response of 404 and then Gripen by IP so
very simple things to ask of the data
once you sucked it in oh yes this stuff
gets way more complicated in this it's
not actually that easy all in but these
is where this is where you want to start
just asking some simple questions you
get it you get the hang of what you're
seeing what you might be experiencing
but then again that's always - how often
this is all the goal of how often solve
that Betemit frequency problem
couple separate questions right how fast
velocity you can say hey show me
everybody who was making requests of
more than more than one request a second
or show me everybody who was making
uniformly distributed requests right
humans don't do that humans don't make a
request to once every second I went 35
seconds that's that the humans don't do
that at all I'm looking for BOTS traffic
how fast is the thing you have normal
patterns right did they follow those
normal patterns I'm gonna talk about
that much more certainly I was the
user-agent you Jacobs spoof able but if
they're not you know clever enough to
spoof it and the user agent with curl
you know it's probably not human or you
know look at the user agent there's a
whole bunch of user ratings you can
kinda just knock out immediately they
fail the intended action whatever that
action was did they succeed or not did
they fail to log in they fail to add a
credit card do they fail to check out do
they fail to update something right any
kind of a failure of action you know
there's reasons for that but why right
why did they fail that maybe maybe they
failed the update profile 10,000 times
why would somebody fail to update the
profile 10,000 times probably because
they trying to figure out how to do a
sequel injection or a cross-site
scripting and they're they're attacking
that form right usually if you can look
at the contents but you know it's kind
of patterns are not normal right
somebody might fail to update a couple
times and they might just say AB done
I'm going away or they might succeed
after a couple of times now that success
is just as important as that failure in
a lot of cases but you still want to be
able to record both and then the exhibit
a known malicious pattern there are just
things you know to be malicious right
away I'm going to take credit cards how
many of you getting carted all of you
should raise your hands so carding is
basically the exercise of testing stolen
credit card data against a validator
you're that validator if you take credit
cards you authorize the credit card you
say yes or no they get a response to
whether the card valid or not there's a
very identifiable mostess pattern here I
go to that thing and I hit a whole bunch
of times right you can see it's easier
to identify behavior you can you can
demonstrate that you can love that
you've grabbed a behavioral pattern for
that right so you're going to have a lot
of those
but again you can see a thread actor
with a clear intent and capability and
that's that's where you can drive that
risk so make the goal determining how
often at first solve that problem right
off then you can get more advanced than
what you're detecting but figure out how
often then finish those assessments
example and I'll this is something I
will push out as well
Jupiter notebooks I love them they're
wonderful things mostly because I've
been a fan about matica for a long long
time they finally made it
not a million dollars by having somebody
else do it but I made a little dupe in a
notebook for risk assessments and all
you do is plug in some data and this
text is important right you identify
what asset this is goes to tangibility
right what am I going to lose you have
to have an asset if you don't have an
asset you don't have a risk and at first
you're going to go oh I have a missing
control I'm missing password hashing I'm
a database that is not a risk that's a
control I will I'll then I'll talk about
a couple books at the end and I
encourage you to read those and I risk
and understand it better but this one we
go when we say we have a tech community
who are they what are they after they
have a capability how how strong are
these attackers and you start to fill in
to numbers and and how confident you are
in them and then you describe your
controls what am i doing to keep that
this threat community from doing what
they want to do I have firewalls and I
have antivirus and I have the Olas top
10 implemented and I have monitoring I
have alerting and I have all the stuff
that I've done you list you list
everything here and you talk about how
confident you are in your controls and
then and then you subtract some of that
confidence because you're overconfident
and that's true you should write you
either reduce your confidence level or
reduce your control one of those two
numbers should go down from where you
think you are because you've probably
not that good and then of course that
that mission equation betterments we qin
see how often right and this is an
annualized thing so maybe you say it's
never going to happen in a year so you
cut it down the fraction right maybe
this is once every 10 years so it's
point one right and that's that's real
you want to think about how much you
want you might lose a year on this and
you annualize it and then again
magnitude how how what's the problem
with the worst case how much money do I
think I'm going to lose and then you
qualify that right how much money can my
business lose before I consider it high
medium low what is my business take that
as if you're a giant company ten million
dollars is no big deal probably right
okay that sucks but me move on it might
not even be material so you have to talk
to your business and figure this out and
when I tell you go away you gots most to
know that information then go to your
boss and say to help me figure this out
right because you may get a blocker
especially the larger company if you go
to CFO or you go to the financial folks
and go hey how much money would we have
to lose to close the doors right like
why are you asking that question that's
insane so you're going to get some
challenges in the smaller a larger
company so you know work the channels
find a way to get the information
explain to them what you're doing have a
security team help you if you give bring
a security team this stuff they're going
to love you so they will help you I
promise and then of course we had some
science so it's very common and risk
community to do Monte Carlo simulation
alright so taking those numbers it's
going to generate a distribution of
samples and those samples can be used
though that really is the first part of
a money college simulation and that's
what these numbers means control
strength parking ability I'll become a
distribution and then you derive
vulnerability from that so you take that
and you and for every single point you
sampled you say did the threat overcome
the control that's it so this is greater
than that that's that's really the
volatility function you do it for all
the samples and at the end you have a
vulnerability here's how vulnerable I am
based on a hundred thousand Monte Carlo
simulation samples here's how vulnerable
I am when you're done with that all you
do is just multiply that by the amount
of times do you think it might happen so
I have vulnerability I multiply it by
the number of times the year is going to
happen and here's the frequency of loss
here's the number of times a year I
think this might happen
now we're started to get into actual you
know math and we're talking about
guessing right so again this is where I
say it's a challenge to quantify
by this stuff because they're going to
put it in numbers and apply real math to
it when you do that you have to be
fairly accurate to get to get a
reasonable result that you could act on
this is where I say automation of these
events sources and and signals is it is
almost vital it is vital to making it
work so giving yourself real you know
trust where the data this is a hard
problem it's not easy
and then of course at the end you get at
risk and the risk of the range it's in
dollars and cents why is it dollars and
cents why is our risking dollars and
cents huh because we have to go to the
business and ask for money and then and
we have to demonstrate I think I'm going
to lose this much money or we're gonna
lose money this year I want to spend a
fraction of that because we say more
than that you they're gonna tell you to
go away I want to spend a fraction of
that to make this go away or to reduce
it right maybe reduce the margin may
reduce the top-end whatever that is I
want to somehow reduce the risk and then
of course you treat it like I said I'll
publish the stuff so you guys can play
with it but more importantly the idea
here is trying to quantify this risk you
then are able to deliver value by
focusing on these specific things you
threat model you've assessed the risk
for all these threats you've come up
with and you said here are the top few
that I think are going to affect my
business in a tangible way this year and
then you go to the business day I would
like to attack attack of these problems
the answer would probably be okay
I mean almost every time I've done this
kind of an exercise the answers okay
seems reasonable right you're not
getting a giant list of to do's giving a
bunch of technical nonsense are you
saying
I try to say the business money or
reduce the amount of loss the business
could have that's a very reasonable
thing to work with in a business you
will be much much more successful than
oh my god we never passed our systems
and eight thirty days now so we got to
patch all our systems right that's a
terrible argument to make this distance
they're going to go okay why this group
is in critical response that you pass
the system when they go down
somebody might die right so no I don't
care about that right
this this goes for greater than that
risk so bye-bye I'm speaking in terms of
real risk the business we can look at
what you're doing look at what they
stand to lose in other places because
they know more about other places than
you do and go mmm this one right and
that's fine you've done your job now you
can move on then we get better at this
right so we're going to fast forward
where to go and we're gonna pretend that
we're great at this now so we walked
away we've done this tomorrow and we got
good at this we're all doing this
actively we're focusing on the right
things life is good and then you realize
that things change and in fact they
change a lot like every day what you're
doing what your controls look like what
your threat landscape looks like it
changes almost daily right and then you
realize the exercises that I just talked
about they take a lot of time like these
take excessive amounts of time and
resources
most companies to do this once a year
because they satisfy a checkbox says we
spent a month doing this for a year look
at our architecture and our risk can be
did this big table and we feel confident
about it right and what good is that six
months down the road right it's probably
not true six month down the road at all
it's definitely true a year down the
road now what do we do right we've got
this cool product that's cool process
that we do but it's inefficient and it's
out of date all the time except for that
month we do it I hate that that's
terrible to me so I want to automate
this I want to take all others
everything we just did and put some
automation on it I want to apply a
little more science what we're doing I
want to build the threat scenarios
automatically that's that's what I
really want to do I want to generate my
threaten capability in my threat model I
don't want to just have a threat model
and we'll start at a manual that model
but I want to move to something
automated right this is where it gets a
little weird that's all about behavior
and that's I want to key on behavior
both predictable and irrational behavior
can be modeled it doesn't matter what it
is you can usually find a way to model
it there's outliers of course it always
is but mostly time you can model this
you think about the require the clear
request
all the things that come in and this is
this is more of a web application thing
there are other things on the network
that apply differently but it's the same
behavioral pattern right a series of web
requests of the state-transition a
directed graph you just are making state
transition matrix is I'm going to go
here
then I'm going to go here then I'm gonna
go here and then I might go back to here
but all it is is just looking at what
they're doing and plotting it if you
such a pretty firm Barkov change for the
bed behavior right a Carter has a Markov
chain or maybe 10 right there is a clear
Markov chain that you can apply to a
credit card scammer or a credit card
verifier somebody doing a brute-force
login attack there's a clear Markov
chain that identifies that and you can
even go further right are they silly are
they just using Adobe's breach
dictionary and going you know one by one
down the list right there are lots of
things you can do where you take the
behavior and apply it to a series of
state transitions and you can do this
automatically you have the data right
you have you know where they went next
you isolate them you identify them you
plot them you then create reproducible
behavioral patterns and it first to do
is manually it's totally fine to do it
once or twice just kind of on paper or
you may you may create a model in code
you test it and then you figure out how
to produce these but then you have a
data to automate this and automatically
produces Markov chains then you then you
create a big threat model you know
through your entire corporation or your
entire you know application around these
identifiable Markov chains and you're
going to miss some stuff then that's you
should expect you but you have
automatable threat intelligence now
right what you've done is create a
series of things that there's a threats
that you have identified that you see
and you can then test frequency on so I
say oh this many times a year I'm seeing
this these patterns emerge and what you
then get is something interesting right
we identify malicious and good behavior
right we also want to do this for good
this is not just a few people out thing
this is to make security go away thing
if you're in retail commerce online what
is one of the worst things you can do
in terms of not getting not capturing a
sale friction of any kind for security
logging in typing a credit-card number
any of that but it really logging in
let's say somebody goes to your site
maybe once or twice a quarter they're
going to forget their password most of
the time let's the reusing patch it
everywhere and then they probably got in
breach but they you might not remember
that password and that thing might not
be compelling enough for them to go to
that reset process and go right but if
you know where they come from what
device they were on what the behavior
looks like you just let them in you
don't have to make them login nobody
says they have to log in after 45 days
that's insane
there's a login after 45 days you don't
have a good enough control to figure out
they're them or not
that's why right the real why is
something different
so you can say turn off the login if
they come from the same location the
same IP address the same device whatever
that is and then go straight to make a
purchase we'll be fine
right let them go don't put the friction
there there's good business waiting for
the business there at the same time you
can say oh they lot they went in and the
first thing they did after they made
their sale was change their shipping
address okay red flag maybe I'm going to
cancel the order right so it's not that
you have to prevent the login from
happening or the purchase from happening
because that's not a loss event the lots
of ends you ship the thing and now you
can't get it back so you lost the thing
and you get a charge back for it that's
a loss event right so you're still going
to prevent the loss of it the you never
ship the good right so it's a different
thinking about what it down that loss
event what am i doing to prevent the
loss event now what am i doing to
prevent the login the login is a thing
to the loss event to piece that chain so
you want to think differently about how
you buy controlled and why you apply
controls right turn off those CAPTCHAs
if you don't have to do the login turn
off the login and no don't go to your
business tomorrow and say this guy told
me to turn off the login please don't do
that
uh-huh but there there are things you
can do especially around this
identification of behavior that allow
you to be less aggressive with security
and the business will love you if you
can intelligently do this I've seen can
lists and conversion list and sales
skyrocket
you're doing things like this and some
of it was we're going to do this deal
with it it went oh crap and that's why I
forget some of this stuff because I had
to just deal with it but that's also
okay you know constraint is a creative
sometimes but then again your block
people when they do dump stuff and when
they're on their way to doing stuff
actually first you record that because
you wanted to happen but when they start
doing going down a known path right
they've hit a few of these things yeah I
think that's probably what they're doing
right okay fine I'll watch them I may
not block them yet but I think they're
going on the path that's going to lead
here you can actually you know what
they're going to do this is so cool
right you record it but you can take
this so far right you can start to
predict the next move there's a whole
bunch of scenarios so I can go oh the
next arcs quick is going to be that and
at this point in model enough that I can
just I can look at ten just tell you
before you get a you're looking at a
model but you can start to predict the
next event what's really cool is now
these mountainous narrow with evolve and
so as it evolves you can start going oh
I think you're going to go here you
didn't go here let me let me put a
little bait out there and see what you
do and you start to basically bait him
and then you then you update your models
in real time
oh version next to the Mel other that
malware or that BOTS came out I
automatically adapted to it updated my
my chain and then moved on so you can
identify things to the version not only
am I seeing it what versions am i seeing
of this thing that's really cool but
this becomes real intense real
capability and a lot more quantifiable
then mmm this office right so I'm going
to go quick here and wrap up identifying
intent capability is super important
this is vital risk analysis good risk
analysis has to have that capability and
also the intent what are they after
right what's that asset and how good are
they and how often if you can answer
those questions you really can't
quantify a risk and a reasonable
tangible way but these Markov chains can
show both of these for you right
generator in these chains are really
really important to being able to just
automate this stuff and then you build a
trap model in real time every day you're
generating threat models from your data
and every day you're running into these
scenarios you have
these bank of Riskin aerials I gave you
the code you can just run this code it's
our code you don't have to do in the
Jupiter notebook and you get a range and
you can apply the day's events to your
current risk scenarios and figure out
whether or not your risk of going up or
down you literally do this I mean in
real time but I would say bashing every
day right so real time is you know ish
but this is where you want to be every
day you're just generating threat
scenarios threat landscapes based on
automation and evaluating your risk and
spending it all the way back to the
business the securities team sees that
the business sees that the development
team sees it you're seeing what's
happening right now
you're creating continuous risk analysis
based on actual actionable data and this
is this is really kind of this is the
holy grail it's kind of a we all want to
be here kind of end State this is a goal
right all the time
what's going on are my controls good
enough that's what a secure didn't ask
if you can see the security team how
good are my controls based on what I'm
seeing they can adapt and you can adapt
this development team as well right you
can do things based on right now and
that doesn't mean adding the trolls also
mean subtracting controls right you can
say oh maybe I don't need to do this
maybe I'm just not seeing this threat
anymore it's gone away I can turn this
off because it was causing me you know a
decrease in conversions or some kind of
substantial impacts so you don't just
say I'm easy to add your controls use it
to remove controls to just as important
security the delicate balance it's not
just about security in fact it's never
about security it's about the business
and this allows you via communication
with the business and say here's how
we're doing here's our health check what
do you what do you wanna do next and so
quantifiable information is awesome and
that's where I want to get to write all
that manual stuff is awesome get to
quantifiable this is where this is where
our automation our tooling puts a big
part of this and you can't do it all and
you can't do it all well this is just
true so you have to figure out what
matters and learn to focus and that's
the set modeling exercise take it all
the way through is focus if you take one
way one thing away even if it's not that
modeling just learn how to focus this
abyss apply it some way more in security
but in security especially you learn how
to focus identify and then call for help
you need it that's fine it's okay to
call for help you don't have to know at
all figure out where to call for help
I'm the most
things that's it for me
modeling book calm is a book on threat
modeling it's probably the best book up
at modeling out there and take with a
grain of salt but there so there's a
good enough good ideas in this book that
I think it's worth reading if you want
to know if you want to read it and take
a review John who speaks next actually
wrote a really good review of the book
the bottom doesn't have a good you know
comlink this is the book to the this is
basically the book on fair and
understanding risk its I but I've had a
chance to work with the authors of the
book before I really appreciate what's
in there and this is my you know kind of
opinionated view on a risk I happen to
agree with them don't take my word do
whatever works for you as long as you're
doing it that's what I care about
on that note I will thank you all
remember to rate the talks please we
love the feedback for the conference
especially if you didn't write last talk
please go ahead and do that and the next
lot as well have a happy lunch thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>