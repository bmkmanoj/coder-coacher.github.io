<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2017 • The Current State of Automotive Security • Chris Valasek | Coder Coacher - Coaching Coders</title><meta content="GOTO 2017 • The Current State of Automotive Security • Chris Valasek - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2017 • The Current State of Automotive Security • Chris Valasek</b></h2><h5 class="post__date">2017-07-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jUmus4v1F4o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right everyone hear me
I promise you my slides won't be as cool
was that video I thought they should
have more memes or something but so just
to start off a little bit about me I
went to school for computer science in
Pittsburgh I was a pretty student
so I didn't go to class very much but I
did get a degree and eventually found
myself in the development world I was a
software developer writing C code for
inline IPS appliances so if you ever
heard of a IBM prevention device my code
still was running out there somewhere
which is terrifying because just like a
student I found that I wasn't the best
developer in the world I was surrounded
by a lot of talented people and they
were so much better than me but what I
did have a knack for was breaking things
so instead of writing the code to stop
the attacks I wanted to figure out how
to do the attacks and that led me off
down the path of reverse engineering and
if you know what reverse engineering is
it's basically I didn't have the source
code I would have an executable I would
put in a disassembler you sit there and
read assembly code all day rip your hair
out because it's super frustrating but
this is how you find vulnerabilities and
from there you write exploits right so
in my mind this is really computer
hacking you know it's not the movies we
are furiously typing on a keyboard
you're basically sitting there almost in
tears for like weeks on end because you
can't figure out this code and then you
do i hack Windows computers for a long
time I wrote a bunch of research papers
that you're ever interested there's
hundreds and hundreds of pages I wrote
about the heat managers for Windows
operating system Microsoft once accused
me of stealing code because that's how
good my reversing was so that was like
one of my biggest accomplish a cost of
accomplishments in life but after after
doing all that it kind of got boring
right you're you're looking for like
something bigger and that's when a
friend of mine dr. Charlie
and I decided cars or cars are full of
computers these days let's hack cars so
I'm going to talk about how we hacked
the car and and in my spare time I like
to do wake surfing we don't have any
oceans in Pittsburgh but we do have
rivers and if you get a big enough boat
and you kind of fill it up with enough
weight it produces an endless wave and
you get to surf an endless wave behind a
boat pretty red I'm going to use this
the g-pack and a lot of people are
familiar with it because it got a lot of
attention as the basis for my discussion
about automotive security today
long story short Charlie and I hacked a
car over the airwaves we could do things
like disable the brakes turn the
steering wheel turn the windshield
wipers on basically whatever the car did
we could do but over the airwaves
without the driver having to do anything
right pretty pretty scary stuff I guess
what a lot of people don't realize is
this isn't this wasn't just a problem
with the Jeep Cherokee the the head unit
where you would see your maps and
everything and you would mess with the
radio it was made by Harmon and Harmon
actually had that device had the
cellular modem in it so this is how we
initially gained entry to the car this
is something that Jeep didn't make they
purchased from someone else and put in
their vehicle so Harmon had code running
on this thing lo and behold I'll show
you later how we ended up getting on the
head unit that's ominous and that was
basically that and so on but what we did
do is these things are on the internet
but not you know the Internet you're
going to access from your cable modem at
home they are on the seller network but
the easiest way to get on the cellular
network is go buy a phone and that's
what I did I went and actually purchased
this really crappy Windows Phone from
Sprint got locked into two-year contract
so I just paid that off recently which
is great and we were able to use that
phone to touch all the cars that were on
fiat-chrysler sleep so you can imagine
there were
millions of cars out there and you might
think to yourself Wow shouldn't you try
to like separate the network so my phone
can't touch the car that's what I would
do too but apparently they didn't right
how did we find all these vehicles
obviously I want to say that we only
hacked one car which was ours I wasn't
going to hack a stranger's car you know
it's probably illegal I don't want to
cause anyone else any trouble but what
we would do is we use a tool called
masscan written by Rob Graham to scan
for cars and the port it listed on was
six six six seven and if you are used to
IRC that's the port for IRC server so
we're like well crazy these are either
chat servers or cars so either way we
thought it would be cool to find them
all and this was the easiest part of the
research because this took a very long
time we had that tiny little cell phone
its bandwidth wasn't that good so we
would start a scan and those are two
class a network so kind of large address
ranges we would go to the bar the whole
day sit there and drink tell stories and
come back and see that indeed it was
only halfway done so we'd go to sleep
wake up the next day go to the bar again
and after two days we go to the bar all
the scans completed and we found
ourselves a bunch of cars out there
that's when we realized that this wasn't
just a 2014 Jeep Cherokee indeed it was
multiple year runs of Fiat Chrysler's
entire fleet in the United States so you
had anything from dodge vipers to to
pickup trucks to Jeep Cherokees to cars
so basically any car that had this head
unit from Harman Kardon
was on the cellular network whether the
person knew it or not essentially it
works like this if you can unlock your
car with your cell phone your car has a
cellular modem that's just how it is you
may not know it but it's active and it's
used right so most cars these days have
this type of technology and we found out
indeed there's a lot of cars out there
to to send messages on the car we had to
send these things called can message and
basically can is what most automobiles
use
to do computer-to-computer communication
maybe I'll briefly explain that there's
not just one computer in a car right
there's tens of computers modern
automobiles like a modern Mercedes has
like a hundred plus individual ECU's
electronic control you into the car
everything from controlling the brakes
to the human vehicle interface to the
windshield wipers like computers control
everything and a lot of the time they
use this thing called can to communicate
controller area network it was developed
by Bosch in the late 70s and early 80s
and it's really simple it's zero to
eight bytes and it's broadcast messaging
so there's no real addressing it's just
like hey I'm ID five and here's my data
and if you're a computer interested in
ID five you read that data you don't
care who sent it there's no cryptography
there's no authentication there's no
anything right it's written by Bosch in
the 70s and 80s there's you know no
concept of this so what we did is we
figured out from the radio we we could
craft messages and I'll talk a little
bit more in detail later about how he
did that but crap these messages say
like hey turn the wheel 10 degrees to
the left or like hey I'm a mechanic I'm
about to work on the brakes why don't
you turn those brakes off real quick
right so we were able to send all these
types of messages on the vehicle which
produced you know actions on the car
that was a cool part of hacking cars it
wasn't just popping open a calque or
another process running right like you
saw the wheel turn or the car
accelerated the thing was with that head
unit I showed you it was literally air
gap so if you looked at it it was two
two daughter boards and if you were an
engineer you would say this is air gap
there's no way you can go from this CPU
to this other CPU but there was actually
not an air gap there was a serial line
in between the portion that was
connected to the Internet and the
portion to a microcontroller that sent
those can messages so we were able to
reprogram the microcontroller that did
the can messages things like you know we
could send to control steering or
braking with our own code
and again you might say well shouldn't
they like sign the code or authenticate
it I would also do that but they didn't
right so we were able to write our own
backdoored firmware and reprogram this
microcontroller if you've never had to
write v8 50 assembly code by hand with
no linker and no way to test it we had
to do that and I'll explain how we've
messed that up on on several different
occasions so what happens when you mess
this up because you're not linking the
code you're not testing it you write it
by hand you look at it you think it
looks right you write it to the
microcontroller and the radio dies right
this breaks so luckily our car was under
warranty Charlie would drive it to the
car dealership and he would say the
radio doesn't work which wasn't a lie it
didn't we knew why it didn't work but we
just said it didn't work and they'd say
like okay well you know we'll test some
stuff and go ahead and they would test
it they would come back and honest thing
the radio won't work all right so they
give us a new one this happened three or
four different times and eventually the
mechanics were like you had the worst
luck with these radios were like I know
don't know what happened but their
service was super great have you got a
new radio every time we brick one but
eventually we got the code right and
we're a little bit more careful after
the third time of ruining one all right
but these are types of things that you
can do after you accomplish these goals
nothing hockey there you go you're free
to stop thank you so Charlie was in the
car with me but he was able over the
cellular network to turn disable the
brakes in that vehicle as you heard that
like loud during sound that was me
pumping the brake but but there's
actually a message that mechanics use
these days to bleed the brake lines so
they don't actually have to do this with
manual tools latest type of computer
command in the brake line bleeds and
they can service vehicles much more
efficiently unfortunately for them they
never thought of like hey what if two
weirdos driving a jeep decide to send
this message while driving and while
this was limited to low speeds it's
still dangerous Charlie actually wrecked
through his own garage while testing
this the one day he put it on and the
funny thing is the way you can make the
brakes work again is speed up so he's
sped up and then he realized he was at
the end of his garage and went right
through the back of it so you can ruin
your own stuff doing this but it's just
need to know right it's not that it's
not that cars are designed to have their
brakes turned off it's that cars are
designed to be serviced and to be
serviced efficiently and what do we do
to make everything more efficient in
life right we add code we add technology
we make it easier and this is a
byproduct to those things the next one's
a bit crazier all right three two one
shockingly we were both okay we do that
was coming so Charlie lives in st. Louis
Missouri and we went out to the middle
of nowhere and some cornfields and that
was our test of are we able to turn the
steering wheel at speed over the cell
network and as you see indeed it was we
actually put the car into a ditch and
we're stuck there for like a half an
hour because no tow trucks would come
get us so we just went on Twitter and
luckily some locals came by and said
like hey do you need help getting out of
like yes they're like $10 like okay so
we paid them $10 so they got their
pickup truck and and towed the Jeep out
and that we got out but you can see
right this is for us it's fun and it was
it's a great project we and we laugh
about it but this is us testing on our
own car as we know it under his control
conditions as we're willing to take it
you know we just wanted to get out the
middle nowhere so if someone did get
hurt it was only us and and it didn't
matter but you can imagine if this
happens when when it's not you doing
research why is any of this possible
right why that's usually what the the
first thing that we could ask is why
should you be able to do this type of
thing and a lot of it relies on on kind
of the way we've just made cars as I
described before Bosch invented can back
in the late 70s and early 80's and it
was made to be a robust reliable system
and it still is but at the time anyone
putting in ECU a computer in the car
controlled that right if your BMW or
Fiat Chrysler you build these things you
put them in a car and they interact with
each other but at one point we decided
like hey let's put one of these on the
Internet
right so then it adds complexity you're
using a system that was designed for no
external influence but putting it on the
internet and you can see where you could
go kind of go astray there right we're
using antiquated technology and putting
Internet on it I think this is a whole
Internet of Things problem but but cars
specifically contain this problem
refactoring is really difficult
if you don't get the architecture right
you may never be able to fix it right
with even Windows so you can release
fixes for the kernel you can rewrite
file systems you could easy to fix user
land code you get Windows updates or Mac
updates every month right this is part
of the process well if you were to
design a car where the radio that was on
the internet was capable of talking to
the components that do steering or
braking or acceleration you can't really
change that not with just software you
would actually need to do Hardware
modifications and a car company is not
going to recall all the cars in and
physically put new components on them
and then send them back out because it's
super expensive it may not be possible
to do you have to go through a ton of
regulatory compliance to do such things
so you have to retest it so what we'll
do usually is say like that's the next
year's problem right because they have
to it's just not possible to fix so the
stakes are higher
normally you make some code you mess it
up you release the next day and then
you're all good it's kind of not
possible with with automobiles right now
to my knowledge there's like zero
forensics for cars right if you're
running a laptop and it's a managed
machine like mine is you probably have
carbon black and your event logs are
getting sent somewhere you know pushed
out the Splunk for processing later
there's nothing like this on the cars
there's the two hashes for the firmware
that one is from the manufacturer and
this is our backdoor word one right but
the car didn't know if you've got that
car after an accident and didn't know to
check these hashes you wouldn't know
anything went wrong right there's no
kind of forensics for automobiles
someone should do that I'm really lazy
like I literally think someone should
like start forensic packages for
automobile hacks it's probably a good
business to be in so there's all these
can
like cities but why do we why does any
of this stuff need to happen it's
because cars become more complex and
we're more demanding people at one point
there were wires all over your car right
and wires going from your headlamps to
the switch to the you know the rear
lamps to the wheels all over the place
copper is really expensive right coppers
heavy so if you can replace this you oh
not only save money on the raw materials
you're getting better gas mileage for
your vehicles by lightening the vehicle
load right there's a reason people are
switching to aluminum frames instead of
steel car weighs less it's better gas
mileage everyone's happy that's really
where CANbus came in now you have these
two wires just twisted pair wires that
are multiplex you can have multiple
computers on a single pair of wires and
they can all communicate and
everything's all good but to get this
stuff to work you need these
microprocessors right and as I said
before Ken was invented a long time ago
and there was never really any security
consideration put into it not that I'm
saying it's their fault it was a time
before anyone thought about it
so it's broadcast no addressing no
authentication no guaranteed deliveries
you can actually build protocols on top
of it that's how you'll see like tuners
doing firmware reflashing and stuff over
can that's how they do that but
essentially how it works is there's not
a switch that says turn your headlamps
on if you're using can really what
happens there's a message that happens
periodically we'll survey every 20
microseconds that say your headlamps are
off your headlamps are off your
headlamps are off your headlamps are off
and then you turn the switch a one turns
the zero a zero turns til one now it's
your head that's are on your headlamps
are on your headlamps are on if you can
out shout that message you win right so
you can just basically flood a can
network with invalid messages and you
end up winning because you're sending
them faster
additionally cars aren't cars anymore
right there they're not purely
mechanical devices if you look at just
this one everything that we know about
like I said you have telematics which
are your cellular modem theirs in car
Wi-Fi I don't know if that's popular
here in Europe but be it that Americans
want kids to shut up in the back as I
Drive to Grandma's house
they want their kids to be connected in
tend ODS to the encar Wi-Fi so there's
Bluetooth you know while everyone thinks
of these things as features like me as a
hacker I think in them as entry points I
think of it as a tack surface so
everything that can touch the outside
car the the inside the car from the
outside is an inch point even in America
since 2006 or maybe 1996 I forget
there's tire pressure monitoring systems
that means each tire has a little radio
and that radio sends the tire pressure
to computer in the car to let you know
if they get catastrophic Leeloo right
great technology totally saves lives
again from my standpoint that's just a
way into the vehicle can I forge radio
signals can I is there an overflow in
there processing of IDs can I use that
to get into greater points in the car
right so you have a lot of entry points
additionally the new technologies that
we use just as you were speaking before
things like adaptive cruise control
things like automated driving we now
take cars that are on the internet to
communicate internally in an insecure
fashion and we let them drive themselves
right so again these probably save way
more lives than they put in jeopardy but
as an attacker that's the technologies
that we leverage to do things so when we
turn the brakes off that was a
diagnostic routine we were able to turn
the steering wheel of the Jeep Cherokee
because it had the ability to park
itself you ever see those fancy
commercials you hit a button the car
appeal of our parks itself we looked at
that as computers control the car we
have computers therefore we can control
the car and we ended up being right as I
said before functionality user demand no
one wants to go out into a cold car in
the morning right at least if you're not
extremely lazy like me you want to hit a
button on your phone that turns on your
car that turns on the heat so that way
when it's you know zero degrees Celsius
in Pittsburgh I can go out there and my
car's all warm and comfy when I get in
that's an awesome feature but it's a
time you now have connectivity to some
internet over some cell modem right and
that's just how these things work
a lot of the argument I always got
before where well why should you be able
to talk to the steering controller from
that head unit and that's a very good
question
logically would seem there's no need for
it to send and receive the same type of
messages right we can just firewall it
off but if you've ever used a backup
camera you'll see that it shows the
projected wheel angle right those are
the red yellow green lines in this in
this diagram up here that means the head
unit needs to receive messages from
probably the steering controller because
it's going to tell you the angle
probably the the wheels because it's
going to have to get true ground speed
and ten other different things so while
in theory it sounds like it's very easy
to design secure systems for cars it's
actually quite hard if you want advanced
features much like any other application
you're going to write right yeah no
one's going to hack your hello world
program and see but if you make it
sufficiently complicated someone
definitely will we're even adding things
to cars that make them way less secure
than their design it's quite popular in
the states now to put a one of these
dongles that do Wi-Fi or cellular
communications for your insurance
company so they can basically spy on you
to see if you're a good driver that way
you can get better rates me I just
rather pay the premium and always break
the law but that's just kind of how I
roll but some people would love to have
this thing in their car but this thing
actually communicates over the cell
network and not only could you
potentially hack it people have proven
that you
they have hacked these devices before
there's actually a little good research
the worst part is when you're in that
diagnostic port in the car you're in a
very privileged location imagine being
on the spanned port of network switch
right you get to see everything and you
get to send everything so we're adding
these things to the cars that make them
even more secure even if the designers
and architects
equals tried their hardest you may
subvert their entire security paradigm
by by adding something yourself we're
going to move into time two very soon
where these things talk to everything
around it right it's not just internally
talk to all the computers but they're
going to talk to traffic lights they're
going to talk to your cell phone they're
going to talk to other cars and this is
going to influence the behavior of the
vehicle while the first specks of these
are just kind of warnings like hey
you're about to crush that guy in a cell
phone not looking at you
maybe someday this would say like okay I
have to stop this car now because I'm
getting too close things like this if
not done improperly again can be forged
who are all these people as you see I
have a highly skilled graphic design
degree as I came up with this myself
explaining a lot of legend is out at the
time I want to get some Triforce on
there but you know who is response to
this because a lot of people just like
to blame the automobile manufactures
right because it's easy they have their
logo on the front of the car they take
that responsibility but in our example
I'll show how kind of all these three
parties failed to do entry level visas
of security and and how they all played
a part as I before said the the Harman
head unit was the one that had a
cellular modem there's a Sierra Wireless
that's very popular in in automobiles to
do cellular communications additionally
there's the other microcontroller on the
separate board that does can
communications he sees the Harmon head
unit we were able to jailbreak this head
unit and read a bunch of the scripts off
I actually wrote most of it in Lua so
these may be the same software
developers that wrote Angry Birds wrote
this I don't know I don't know why you
do Lua in the car but they did and we
were determined to find some kind of
weird buffer overflow that we'd exploit
for these memory corruptions and it
would be super complicated it would take
us forever
as we start pouring through these Lua
scripts we find the comm Harman service
novel service
Naville service exposed the method
called execute can anyone guess what
this method did you're right you would
pass it a command and it would execute
but what happened if it didn't run his
route don't worry it did run his route
right so I was like these are these are
things that we've known in the tech
space for decades that they're still
getting used to so we found this method
to execute it and we would send the
command and it would execute it one of
the biggest problems though was as I
said before we could we could
communicate with these vehicles on the
cell network by buying a cell phone as I
said before I got walked into your
sprint plan Charlie was a little bit
smarter than me he went to the
convenience store and bought a $20
sprint burner phone and it could also
communicate with it so he spent $20 and
I spent like $2,000 but that's me
learning my lesson of not signing into
cell phone contracts I realized that's
not a thing here is it well it's big
it's big mess is terrible anyway we were
able to use a commodity cell phone to
talk to a vehicle fleet I find that kind
of disturbing right you would think that
you would segment these things out you
would think there'd be enough
communication between the OEM and their
carrier to stop these things but there
wasn't and there was a bunch of ports
open right so this is the only one that
was the easy one maybe there was
something else there the the that
complicates things right you're
depending on this carrier not only to be
a bit broker but to be involved in your
security additionally as I said before
we reprogrammed this microcontroller
with our own backdoor code there's a
reason that these things are super
secure right like Apple does a very good
job you know this only runs Apple code
it doesn't run Apple developer sign code
at least not on these production ones
right car manufacturers aren't there yet
to them this was just a blob of stuff
that was binary who you know who the
hell is going to spend six months
reversing the engineering that to figure
that out like people like us well and if
you don't do cryptographic sign of these
things it's easy for you to modify them
and update them so what eventually
happened FCA basically took all the
blame right if you
got to see any of the news releases it
was basically like the Jeep is hacked
SCA blah blah blah blah blah but they
didn't write all this code right and
they didn't make all the parts and they
sure as didn't make the cell
network that was carrying the data right
so it's not entirely their fault that
being said they were super nice like
they never threatened us legally I'm
sure they hate us but like you know they
were never never tried to get
retribution on us or anything but it's a
shame that they had to take all the
blame because they had a lot of partners
involved that were just as implicit
sprint actually fixed made the biggest
fix for this before a patch was even
released for the car sprint blocked they
fire Waldport six six six seven on the
cell network right that basically
stopped the hack from being remote where
I could do any car in the United States
to I would have to be close to you to do
and you would have to have Wi-Fi on so
that took the the risk factor from here
down to here right and before there were
some arguments that they couldn't do it
and we just said like well we're at
least our I'm frozen
two weeks so you guys can figure that
out and lo and behold they figured out
pretty quickly so they had the biggest
impact Harman never got really anything
but right they had this head unit that
had a seller modem that had a method
called execute that ran is route that
you could pass commands to you could
also do GPS tracking without even
executing him and it would just give you
the the vehicles coordinates right so
there's a lot of people involved and
Harman probably didn't even write that
code right they probably outsource that
to someone else so there's a lot of
responsibility on on how this all works
well what's the impact all this for this
specific instance
fiat-chrysler recalled one point four
million cars after this so that was kind
of a big deal it was cool from us from a
hackers perspective because we kind of
broke the barrier between only being
relevant in a small tech space to being
relevant on kind of a national or
international stage right code cause
this recall it wasn't that it was a
faulty airbag or a bolt wasn't strong
enough that they didn't test it was
software code that was written was
insufficient and had the potential to
cause bodily harm so we've like we've
entered this brave new world of
programmers and hackers and everyone not
only being responsible for funny cat
videos but also for the safety of the
people that are is using our code there
was a tweet by Matthew Greene it said it
caused jeep 14 billion dollars to do
this recall I think its order of
magnitude off I'll say it's 1.4 billion
I'm really shocked that for 1.4 billion
dollars they didn't send a hit man after
me so that's cool that I'm still alive
and they didn't kill me because I would
have killed me if I would have cost me
that much money right but you can see
the magnitudes now like this isn't this
isn't a couple hundred dollars or a
couple thousand dollars this is a huge
amount of money and people have to
realize that the code you're writing
depending on what you're doing with it
can be a massive financial risk for
people so we have to think about quality
code and secure code as we move on with
all this stuff in America the National
Highway Safety Transit Authority started
actually trying to give security best
practices for automobiles so it went
from something that no one really cared
about to getting the attention of
government agencies within the United
States additionally some of our
congressmen we're trying to formulate a
bill to have stricter cybersecurity
standards for vehicles right so again
one of the cool parts to this is that
like two guys in a garage that we're
working their nights and weekends hack
in a car made a nationwide difference
and that's the cool part of the internet
age like for me from a hacking
perspective we can change the world from
you know if you're developer like you
can write stuff that affects a large
amount of people so oh it's a cool time
to be alive if you're a nerd thank God
right rough before but we never break
anything without giving sound advice on
how to fix it as I said before there's a
lot of different approaches that people
want to take to securing via
and I don't really want to go over them
but it basically it's general stuff that
we do on your IP networks you want to
secure endpoints right you want to make
commute make sure your communications
are authenticated or there's
authenticity you want a segment right we
have DMVs for a reason your web servers
outside so it doesn't have to touch this
stuff inside lastly is something that I
worked on before at IBM was detection of
attacks and detected attacks on a
regular computer network is hard because
the traffic is so header Oh genius right
there's just so much different thing you
could op take JavaScript HTP is
complicated but for kin it's actually
really simple because it's zero to eight
bytes and they comment constant rates or
you you know what the values should be
so what we did is we decided to come up
with an algorithm that basically did
simple anomaly detection let's take a
sample of the traffic on a car we're
going to measure all the IDS that we see
and for each ID we're going to measure
the frequency that way if we see an ID
we haven't seen that might be bad or if
we see an ID at a greater or lesser
frequency than where we know about
something else is fishy right remember
before I said you could just flood the
bus and control these things well as you
can make it detect the flooding you can
stop it and if you see things like we
did to turn off the brakes which was a
diagnostic mechanics routine you should
be doing that while you're driving right
so we made this little prototype device
here programmed their little
microcontroller
and basically our plan was since we
weren't auto manufacturer was if we saw
anything bad
we just short out the can bus literally
like cross the two wires nothing would
work but at least you wouldn't be hacked
right that's essentially kind of the the
premise of this was so can you press
play on the video back there so here is
the note brake attack
we'll start it mm-my can stop right now
here obviously that's a very dangerous
attack now I'm going to turn on the
detector here and this is in real time
so right now it's learning the dynamics
of the can Network so this is when we
work for any car it's not specifically
designed to prevent this attack it's
just looking for abnormality so now once
again I try to run the same attack the
attack fails this time my brakes still
work so the car still has steering
brakes everything's cool obviously those
are something wrong because the
computers can no longer communicate with
each other but the important thing is
I'm safe from attack I can safely drive
the vehicle to a repair shop much like
you want to do in your regular corporate
networks right is we can't rely on
perfect code like until Skynet's writing
all of our code and it's humans versus
machines like we're just going to have
flaws that's just how it's going to work
but what we can do is come up with
different measures to secure these
things like sure in an ideal world you
want perfect code but we're not going to
get it so we decided that you know in a
weekend Charlie and I kind of threw this
thing together and showed that if if
these types of attacks were to happen
this device could actually detect them
in real time and stop them and we're not
OEM right this is us just kind of
hacking things together and make it a
little prototype board I'm sure you can
make it work much more clean like in a
real automobile and not just shorting
out the bus everyone's usually at this
point was like wow I'm terrified you're
going to get two different schools of
thought with all these things the first
thing someone's going to tell you is
like security experts say car hacking is
easy as someone who's hacked a few cars
I am going to go with this latter one of
near this latter one of why hacking cars
is nearly impossible it's really hard
right now because the barrier of entry
is pretty high
first of all too
hack a car you need to have one I can go
look for bugs in Google Chrome all day
because I can go down let download that
and read it on the plane home right but
like to hack a car you're basically
going to need a car additionally we're
dealing with a lot of real-time
operating systems in these
microcontrollers that are doing specific
tasks right like the steering controller
isn't running Linux right it's just some
real-time OS that sends bits and
receives bits your head unit on the
other hand is Windows or Linux or
communiques or some variant that people
are familiar with but if you want to
reverse engineer the things like we did
to figure out how to send these messages
it ends up being different every time I
know more about internals of Toyota than
I would ever like to admit I feel that I
could put like the jumpsuit on and
become a mechanic at this point because
I've spent so much time reading
documentation and looking at their
microcontrollers in reality there's only
three groups of people that have live
hacked a car remotely number one was the
group of researchers from the University
of Washington they did this before we
did love that whole team they're amazing
but they didn't release any other
information they just said we did it
trust us we did it and they did and and
they actually did it on a GM car and GM
didn't fix the problem for five years
Charlie and I on the other hand went on
the different route of full disclosure
where we're like okay we're going to do
this we're releasing all bits of our
data all our tools all the research and
you know everyone else who wants to
figure it out can our stuff got fixed in
like six months so I think you can show
like how if you want to push people to
improve their security as a researcher
as an independent person you can force
it other one is the Qing team those guys
just did the Tesla I think they used a
browser exploit and then did the full
chain to do much like we did to
reprogram a microcontroller to send
messages and they're awesome too
they're there out of China so what again
when everyone's like hey is everyone
hack cut it's right now it's not
happening but you know what ten years
ago people weren't hacking mobile phones
either right
it's just things transition we move on
hackers going to hack people going to
write software going to write shitty
software and the world turns right what
does this all mean
vehicles much like anything else like I
think you can substitute vehicles for
anything that we use now they're
becoming more connected more complex
right my refrigerator at home is is on
the Internet does it need to be no is it
awesome that it is yeah I think so but
but these things are all becoming more
connected more complex what you really I
think from my standpoint should be
concerned about again it's not things
like a refrigerator but things like a
car or things like a pacemaker or things
like a control system that controls a
damn right if you can cause physical
harm or physical damage just with code
then it's quite concerning especially
when it's remote as I said before we're
really bad at writing secure code it's
kind of funny because people will just
say well like we'll just make the code
better and like call up Apple or Google
or Facebook or anybody right these are
software engineering powerhouses they've
you know they write the most amazing
things ever and every month they have
patches for bugs or security Vaughn
Billy's right it's it's saying we need
to write secure code and and leaving it
at that I think is naive at the very
best like we're bad at it let's take
into account that we're pretty bad at it
luckily right now hacking things such as
cars are pretty hard but this complexity
is bringing security concerns the best
piece of advice I can give anyone for
writing code and I said I'm a crappy
software engineer so I know all about
putting crappy code out there is if
you're going to have it touch the
outside world have it updatable by the
upside by the outside world and by that
I mean if if you're going to have this
car the Jeep touch the Internet you
should be able to update it over the
Internet one of the biggest problems
that FCA had with the Jeep is we could
remotely hack it over the airwaves but
they couldn't remotely patch it over the
airwaves we thought about writing
software we thought about writing a worm
to like go patch all the cars but then
we
they pass and they're like yeah that'll
end in jail too so like okay that's fine
but you know the moralist story is that
if you're going to touch the internet
you might as well develop some
infrastructure to update over there and
that goes for a car and app a Furby or a
smoke alarm like that's generally how I
think about things because we're so bad
at writing quality code we just needed
sure that indeed when we do mess up we
can fix it in a quick and reliable
fashion with that being said thank you
for getting up early and coming in here
it was super great to talk to everyone
and it's a beautiful venue and I
appreciate your time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>