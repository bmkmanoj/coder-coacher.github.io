<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2015 • GS Collections &amp; Java 8: Functional, Fluent, Friendly &amp; Fun • Craig Motlin | Coder Coacher - Coaching Coders</title><meta content="GOTO 2015 • GS Collections &amp; Java 8: Functional, Fluent, Friendly &amp; Fun • Craig Motlin - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2015 • GS Collections &amp; Java 8: Functional, Fluent, Friendly &amp; Fun • Craig Motlin</b></h2><h5 class="post__date">2015-07-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BaBjXMpnbJ0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is crying on I have been an
engineer at Goldman Sachs for about 10
years I've worked in a number of
projects there JS collections has been
kind of a side project of going for a
number of years today here's the agenda
I'm going to talk about some of the
eight guys that were lost and now are
found with Java 8 a little bit about the
street is a pif in Java 8 and strings
are religious the tip of the iceberg
there's a lot of features that we have
in Jesus collections that we would also
like to see make it into this in turn my
race or language so some of the iceberg
is AP is fluency memory efficiency and I
have a short section about meth
references and a short career record
person right so when is Gia's
collections it is a consumer strong
collections burner developed internally
for since 2004 we open sourced it in
January 2012 it's there I'm give up
under the apache license and it is meant
to be either supplements to the drama
collection
much the same way that belies a
supplement or it can be a complete
replacement for the Java collections
printer so we have our own list sets and
maps as well and the launch of other
things alone with the library itself we
will desserts the training materials we
call it the JS collections cod cod it's
set up as a series of unit tests which
fell to have blanks which are terminals
and you fill in the blanks so it's kind
of a fun way to learn JC collections and
that's our second repository out there
and get up and all of our new hires go
through it so we have over 1500 people
open to the training and rising all
right so I need to take a trip down
memory lane and I'm going to stop before
was my manager gonna rob was the creator
of the framework and he is a small talk
developer performer small tactical and
who hears work with small talk before
you know how you can tell there's
someone's worked as small talk before
it's it's not a trick tell you about
so here the iteration patterns that were
in the small town collections from we
called the dr seuss api because it
rhymes so I collect exact objected to
and these are names are familiar with
like another going to dislike filtering
map or transform but they're the same
times that were used in many other
languages and when javab one came along
and collections from Earth shortly
afterwards all of these patterns were
missing and if you came from a small
type of background it was it was
upsetting to see all the aeration
parents are gone and in these two books
book I came back they're separated by a
decade a full decade later the patterns
the best practices are really just only
focused on the containers and as late as
java 7 i'm atlas and said but all
behaviors are more gone so geous
collections was really built around that
idea but we you know an anticipated
lambeth but we didn't have on business
already so on this slide a look inside
you can see these small talk 85 ever
forever and in the middle column here's
the code that we've been writing in java
through java 7 to achieve the same thing
but with more lines of code and usually
the intent is buried on the inside of
the loop on the right hand side we have
gist collections it's a disposition
missions backwards compatible to java 5
italy repair shop but here we're using
the java 8
use it with lambda seamlessly and syntax
differences aside the retina left logo
must I found one tab at Harry's for the
last two plans collect and injecting too
we're actually using the new method
reference insects and I'll talk about
more later we r who loveth references
one interesting thing about the
streaming guy is that it is a user's
lazy evaluation and for a lot of times
that's exactly what I'm if you're going
to build up a complicated pipeline with
competitions you want it to be lazy and
of course evaluation and when you don't
want lazy evaluation if all you're going
to do is one filterless a and then you
want record collection it's not ideal
and in that case eager valuation can
lead to much more terse code so in JS
collections we have both as lazy is the
equivalent of stream and so here you can
see side-by-side they're pretty similar
they both indicate laziness through
their return types so in stream if you
call method like filter which returns
industry that indicates laziness as long
as you're getting on the stream it has a
divorce attorney competition and
similarly just collections we have
the other crimes like for example any
satisfy me mash which returned sure
thing about a condition they return of
billions of is moving in for that
competition anymore that force its
evaluation when you do want eager
evaluation like we want to collection
back because you're going to store it in
the field then you have to jump through
bummer and that is determining the
street using the operator called collect
there's a name flesh there we have
collected me something different but
collect takes a collector and in the
three vehicles here for filter and from
now we're passing in the collector to
list to terminate the stream so there's
two we call it like the bun and meet the
blunt operations are the stream and the
collector collect and then the mean
evaporation is alina if you want eager
evaluation it's nicer than threat oh my
gosh but that was weird that we've been
too difficult to do in job itself the
reason bolo blends difficult they would
have interfere with people's libraries
they cook the streams a guide a smooth
surface by adding one with it onto
collections which is called stream and
all new methods are there if it have put
a lot of methods like let's say they put
group by for example right
collection it could interfere with
anyone else because that's goodbye and
that doesn't even accept any collections
implementations like ours it could be in
or as for example since provides a
concept for so it's it's very nice of
the streaming API has a low surface area
but it does mean that sometimes the code
gets a little bit longer as you see here
so we've seen a taste of Java extremes
and you know it's been out for around a
year so if that's a tryout and my
impression is that it is a great
addition to core job it provides a lot
of these iteration tires which we have
been missing for a long time and as the
interesting design decision is lazy by
default but in a lot of cases that's
what I want it also supports with serial
and parallel iteration and again Martha
car alliteration there and it has some
limited support for primitives as well
and if we have in-stream long stream and
double stream and it's expensive there's
only a few minutes on stream but it's
extensible through that collects pad
wearing cussing collectors and we'll see
a little bit more of it but overall I
would say that the streams that guy is
really just the tip of the iceberg
there's so many more features that we
want and kind of you know give me an
angel on mild all these things are
features that are either ingeus
collections or
their collections libraries that are out
there and I think it's important to
think about in future versions of Java
how can we advance the same guy even
further strings is a huge step for
forward but I'm thinking in terms of
Java 10 what additional features should
make it into the core libraries Java
nice feature set is pretty much that's
recycled content islands here so as I go
through some of these features think
about which ones would you really
support being in the poor which are push
that we really know at this point are
solid and really belong in the spec so
here's some of what is another lottery
iceberg eager advantage i mentioned
covariant return types of the
collections protocols what I mean here
is that when you string every method
return the string not like a list stream
our century you're responsible for
keeping track of the uniqueness and
things like that look if there's an
ordering in Iran there's no new
collections as everything is new API new
methods new behaviors but the renewing
of containers so we don't have bags full
circle multisets there's no line apps or
multi nap see some of these they're very
libraries because like ours set an appt
the hatchling dimetrodon
memory fishing all sides of the problems
with the orientation and there were only
minor changes to them so they still have
performance problems there are primitive
streams but no new primitive containers
so that means that you can avoid the
garbage of our boxing in the middle of a
confrontation but at the end you still
have to do something or less straight
streams are like iterators easier than
once and then they're done so if you
want to store it and use these
primitives that you've computed again
you have to be something else other than
user straight and there's no miracle
containers I also metrics here when I
figure through all of them with the most
interesting one to me is the last one
it's lines of code which is not the
greatest metric in the world is what we
have and the interesting thing to me was
that the string Takai added about 15,000
lines to for libraries which is an
incredible accomplishment there's a ton
of new behavior in just fifteen thousand
lines and cereal and curl and and it's
extensible so they've accomplished a lot
of very few lines and got great could
reduce by comparison JS collections is
quite big as warm as a dozen lines of
and within that there's templates that
generate the primitive collections the
reason is that an ollie printable lists
for example are very similar so we
generated from a single template and
even Biggers maps where we have ever
created for the key in every primitive
for the value so multiplies up and it
generates over a thousand million last
more so it's quite a large library and I
don't think that all of his collections
could ever get into the core libraries
as why I'm very focused on finding which
are the most important parts ever they
belong in the Jacob's gone through some
of the iteration patterns like filtering
that and those are all streams but the
ones that I've show them this slide are
pretty much it there's not a lot of
iteration pattern string these other
patterns that we've seen other languages
and libraries that you see up here you
have to get them through collectors and
I have a few code examples of collectors
collectors of our societal a class which
we saw earlier by static utility I mean
it's a class that you don't instantiate
you don't write new collectors use the
factory method it's similar in a way the
collections class grateful sort you
don't say
sorry ingeus collections we discover a
long time ago the futility till date
comes to learning the only way you know
about you static utility is by reading
the horsing a presentation about it but
it's not discoverable in your ID I new
method onto an existing interface is
much more learnable because you just
typed odd and you control space in your
any show your own methods that are
available to you there's other
advantages of writing on returning to
photoshop i'm going to go into its kind
of others butts I agility is a little
bit harder to find it started optimized
since the data doesn't live with the
behavior it can be harder to read
whenever you come across the collect
Power Move to read the collector before
you understand what it's doing so it
doesn't read especially loved right
that's an aesthetic daughter I want to
go through the code examples you could
decide yourself away from career here's
the first example here we are comparing
enjoying using streaming data versus
mainstream inches collections so we're
setting a list of things and we want to
convert each one to a string and have a
comma-separated string since this isn't
a pattern right on stream the next place
you look at some collectors and there is
a collector called joining you created
this way and the other thing you have to
do is first converted right onto a
string to me that there's a conversation
you got obviously if you're joining
you want to convert long string objects
into strings so I would have turned this
into a different collector the collector
that works on any outfit but it's not
too bad you can tell what's going on in
JS collections to be a mythical main
string directly out of collections so
you can see that autocomplete would be
easier here for example both of similar
options and that you can replace the you
have options of note parameters a
separator or also starvation the second
example is similar except that we
immediately terminate this industry we
call stream immediately terminated with
but here what we're doing is we're
taking a list of employees and we're
getting their salaries its own so again
some is not a high- final string so you
go to local collectors find the swimming
into collector and custom the function
to get the seller JS collections are
give me a pattern fall right on all of
our collections call some of it one
other point here is the return type I
think that sewing integers are returning
in Haines is mistaken it along and
that's what we have on JS collections
this sort of thing is very hard to fix
outliers release so this might be a
permanent
the sum against collector will say now
we're looking at a bit more complicated
our urban body so here we're going to
take the same collection of employees
and we want to group them by their
department so we're going to get back
structural or with your query for this
department and get all the employees in
that apartment again create a string and
immediately terminated with a collect
operator and we're building a collector
similar to that we did before where
we're just passing the function that
function gets the key for James
collections freakin providers to pattern
right on the collection super just call
it directly and the other interesting
difference here's the return types like
I mentioned before job I need to not get
multi maps and so grouping by eyes can
return on map where the values are lists
that means you have to deal with the
fact that you might have known
watching the other problem with this in
my opinion is that I didn't say that
employees it's a list I could have been
a set in that case after grouping the
employees there's the groups are still
going to be unique and they're in a
random order they're still going to be
in around pseudo random order and so in
that case I would walk back amount of
sets of employees to indicate that
they're silly any kind of harm but
that's not how grouping by works we have
one time as soon as you hopped into the
string API you lose some of the compilot
of information ingest collection since
it's a returns that on an interface we
can have full covariant between types
and multi neither is the most generic if
employees were a mutable set I would get
that immutable 70 and we had all sorts
of multi knives this pattern is its
aggregation so it's even more
complicated and goodbye we start out the
same way we want to group the invoice by
their department but now instead of a
list of employees I'm doing this second
aggregation I talked about before
someone i'm going to send their salaries
within each requirement so i'm still
going to get back on that like structure
not multi-month though because I've
aggregated something about all the
employees again I have stream that I can
we terminate and now the grouping but i
still use a grouping by collector but
it's an override it's not the same one
before we start with the first parameter
at the sandwich is to get department
function and now I passing a second
lecture so I have a collector
collector so these collectors as you can
see they can build up NASA can become
quite complicated and you can build
really a very functional Attica on the
other hand this one might not be the
most intuitive I think it's a little bit
harder to learn how to do this ingeus
collections we're still doing
aggregations with still gonna be more
complex pattern but at least some my
aunt is a method right on container and
you can see it shot out separately and
you can see that that it takes two
functions also will give returns an
object long nap which is one of our
primitive collections so the lungs are
not Autobots internally they are
primitives and the same problem int vs
long for a song that i mentioned before
applies here since it is someone into
collector is embedded here we get back
on map of wraps integer obvious when
wheezing streams it where I really want
unwrapped blonds my final code example
is parts of the partition tire so here
we have a collection of students and Mr
Justice separate out the passing and
failing ones based on some freshman so
the function is the same for both and
the most interesting difference here is
that return types with streams I get
back in now where I'm going to have the
two boolean operators keys and the
values will be again lists of students
it doesn't matter if I started with a
set of students after calling stream I'm
going to get back on that book lists
again for JS collections we have
specific Kovarian are two types so in
this case students was a list after
partitioning I get back a partition list
which is our own type that has methods
to get the selected rejected items and
we will maintain a work so if everyone
passed I went up with a list in the same
water in the selected students any
questions on these codes it was before
how do they stack up we took a
screenshot of the stack traces
intelligent and all we did to get these
was put break points inside the lambda
that we're using on the last example
partitioning and there's some
interesting things that you can finally
the stat tricks on the left hand side we
have the stream spectryx and at the
bottom is our test at the top is the
liner so just reading up from the bottom
we're immediately terminating with
collect so a lot of the stack trace is
going to be the same for everything
using a collector because good to
collect evaluate I didn't start with a
cargo stream to stream stream so that
actually is it evaluates a question we
rappin copy to copy to and fruit
remaining twice and exhausted all of
that is the same for all the patterns
because they're all just using clouds
after that we're stepping into the
exception if it of the lambda and lambda
was actually built from the collector so
that's restarts immediate and you can
actually see the line that's a
partitioning it's kind of abandonment if
you want to stuff like this which I did
because I really want to learn the
streams API and set out its lover to
step through when you're just looking
for West
collection but it is understandable the
gist collection spectryx is a lot to do
with partition in this case and it's
because of the fact that it's just a
fact oriented as a method on every
collection so here after the tests are
separate into a partition on abstract
list that we share and from there it
goes into our house that utility that
actually performs the partition on a
random access list and mr no mana so
this actress is a little bit easier to
understand but this is sort of it comes
out of the fact that we have more code
you know we've written partition for
every type differently where strings
that she's better code sharing but we
have basically the station stack trace
for everything
so I sure the cultural examples that
show the differences in the API you're
going to feel free difference in fluency
too but I have some code examples that I
might show that really emphasize fluency
for this example I'm going to use the
anagram tutorial which is part of the
Oracle documentation it was written
around the time with Java file and it
hasn't been updated it still shows a
Java 510 pounds so users generics but
not James and I'm not going to show the
old Java file solution you can just find
it online but we updated it as best we
could to use streams and our own yet
they actually Oliver them is to start
with all the words in the dictionary for
each word compute its alpha Brown alpha
room is just the sort of letters so to
hannah grams will have a same calendar
so in this example we have alerts and
stellar a new circuit letters it's the
same key so that becomes the key in the
map all the anagrams become the value of
one collection of noise after grouping
them all we filter building the groups
that have a threshold so it's at least
eight patterns then sort descending and
print them a lot starting with the most
so here the most entrance is loving and
you see the whole prep anonymous wrong
so we rewrote the tutorial using streams
and this is the solution that we came up
with if you can do them better than us i
would like to see it we start with i
getting the words which is
just a collection and we need to opt in
Simple Touch stream then we collect
using a grouping like lecture we saw
before so that gives us back a simulated
multi-member but if you remember it's an
app with lists as values since we're
only after grouping by the key we're not
interested in bikini morning we only
care about those collections of diagrams
so we use the values that's an old
method it's been a map forever and that
means it returns a collection not
straight right dollars gives you data
collection so now we continue fluently
calling more methods you have to call
streaming the second time to get back
into the stream avi and then we can do
the rest of the audit we filter we call
sorted and the interesting thing or
Christmas orders are using company
compared with us to use of primitive
comparator so I'm going to auto blasting
their map each to a string and then
finally print it up in real life I
probably wouldn't do it this fluently
without any intermediate herbs but you
know I'm just trying to point your mouth
fluency for JS collections is slightly
shorter because we don't have to call
strength two times but that is the main
difference but i think that the
intermediate return types if i did a
sexy two variables are interesting so
much a walker than here so as i
mentioned before a group i gives you
back and perennial tina and it's
specific to the technical side so words
is a
example so I get back immutable is multi
map where the key is my alpha grams head
and the value the value from your
strings once you have the multi luck we
have the use of the keys values key
value pairs the one I'm on here is
multi-valued view and this is the
collection collection sits a similar
amount in this case and here we run into
a limitation of the Java type system
it's kind of a curiously in that you
don't run too frequently but generics
and jela are inherent and so that means
that even though I know the inner type
here i have a list of lists basically
they in turn i'm actually not right that
it's list so roughing it is but i just
can't express that a java step system so
i have to say it's an internal variables
and richard or rulers just our top of
our higher it's the arrow 2 plus all
these iterations episode of the scene
next time control select is filtering it
down based on the size mushroom and that
the filtering never changes that the
tightest so I've still got Richard your
little perch intervals here I'm sorting
by size and I really just wanted to show
off it to start a list by
but this does sorted in ascending order
on a descending so I now need to reverse
it and i'll use it as reverse method we
thought all this name information or
anything that says as it is going to
return a rapid object and anything in
such a constant time or lazy operation
anything that has two in the name is a
linear operation does the full operation
to fully automation so as reversed is
one of the ways you can opt into our
lazy okay so here we go back lazier lazy
interval of Richard rebels and we still
know those rich intervals are lists next
I'm going to collect and this is our
collective a strange plant so this games
map I'm not vacationing to string and so
Ivana battering the inner collection for
lists because I can do that on a meter
interval and finally I print out using
each all right that's a four different
texture a note on the lazy evaluation
one of the cool things about streams is
that you can just replace the method
stream with parallel stream and adopted
into parallel valuation that's that's
really cool it's not a separate thing to
learn seems I think in fact it's the
same return type extreme doing have a
separate interface called parish and
that's good that it's a smaller guy
easier to learn but it means that you
have to keep track yourself that this
thing it will execute a perm that the
land is you passing has to be stateless
or pure functional for JS collections we
also have a car loan lazy API you opt
into it with the ass
and it doesn't default things for either
the fragrance so you passing your
executor in your batch size and then the
important thing here is the return type
we have a specific return type it's a
perilous terrible see you know that even
after collecting in this case each
person's address I still have a car
almost there it still hasn't evaluated
because I nope it from the return type
it's lazy but I know that when it does
evaluate I will still have something in
work still is like in this talk I'm
really focusing on API and I'm not I
don't have time to get into performance
but I've given a talk at Q browser um
folks solely focused on paralyzing the
firm's and so the video is aligning with
you and I go into the performance of GS
collections extremes of course and
scholar our collections as well as you
can check out that video if you're
interested in performance
next I have a new on memory efficiency
so I have this church on memory usage of
maps and on the x-axis I have the size
of the collection up to millions and on
the y-axis I have megabytes the top and
oranges the job hashtag failures I have
two convenient mask our own which is
called univ I'm at Aunt Rose as well and
they have different growth strategies
the ones for so hash map and Arlene
finally have this Pilar they grow with a
slow slow that's when you're getting new
collisions they both use chaining so
that occlusions go into a linked list of
collisions you know that slowest Lopez
the collisions grow and then there's a
shark so when we double O king sized
correctly trillions is a different
strategy it uses open addressing so
collisions go right into the array using
program and so that you know this flat
line as collisions are being added and
then a doubling in size of realism so
even though the freaking size the group
is different if you take it to the limit
you see that javascript is using on
average twice the ramp the other two so
why is it going
there's a very well hash map is built on
top of the table of entry objects an
entry is an interesting class it holds
the key in the value of course it also
holds a next pointer that forms the
linked list of collisions so if there
are no collisions next is written all it
also catches the hash code which is an
interesting time memory trade-off
obviously it uses memory to cash it but
every once in a while while you're
growing in hash map it has to double its
size and pretensioners which is pretty
much the most expensive operation can do
on a hashmap and so casual enough about
greatly reduces I cost in terms of
memory at least it's much better to do
away with entries completely that's what
we've done in unified map we just have a
double size array where we alternate key
values in that array directly when there
are two collisions are marked in bucket
we replace the key with a sentinel
indicating that the solutions and value
with an array which is similar it has
key values alternating this strategy
uses half a memory on average but if the
watch out for this one method in Teresa
and she said is none of those leaky
abstractions it as soon as that you are
facing your mountain on a table entries
and if you have that table you can just
return it but if not you have to create
them on banana so it turns entry set
from a constant time operation to linear
operation for us it is much better to
just use our method for each key value
which takes a lambda that expects a few
or anything last night to an entry on
guys the picture for sets is even worse
hash set uses four times the memory that
it means do on average the reason is
that hash set is bath high fashion which
is a good strategy for reducing code but
it's not so efficient everything I said
about a tree is still applies and in
addition within each entry the key is
used in the values not use so the
buildings are pure waste of memory
multiplying the doubling for both we get
a four times memory based on average
this picture just shows the headers and
stuff on each entry operator and if you
do the math that it comes out to that
this is a map says the two times memory
waste that I mentioned now there's
little point to make about the memory
waste it's that these types not only
really not replaced in Java 8 or
improved but if you want to build on top
of them if you want these other
collections that I've mentioned like
bags multinational vimax you need to
build on top of mass so these features
as well but since they target being a
supplement to job they didn't do
anything to replace a front menasha so
their little teen ops have a very severe
API and is very nice API but they have
the same memory problems as the jdk
when we r memory is primitive
collections I hinted at this before I
mean this journalism totally fair
because I'm comparing an ArrayList of
crap arrives with a printed list for a
new trailer for JS collections and of
course it wouldn't want to wrap
initiative with it up at all costs but
think about where your choices are if
you're using strings you do have these
primitive strings now but like I said
before there they're like iterators you
use them once they've done so we're not
appropriate to the store in a field
what's that if it's in a field you're
going to want to access the little x or
you're not going to know how long my
lips so if you do this competition and
use during their strings in the middle
and you want to store them not to
terminate it was collecting you have two
choices were there for what you can do
you can terminate an improved if array
and that's what I think most people
would shoot us because it's obviously
memory efficient or you can create it by
boxing objects and then you have box the
litter box that I think most people
would opt for the premium of the rain
but then you're losing a little semantic
information even know if there's
duplicates in area
you don't know how solicitor so so I
like the pre- strings are huge step for
but i looked at supreme of collections
as well the problem is how far we'll
take it I Queens have all eight
primitives for lists and all 64 for maps
even more cuz object eternity reveal
yourself and that's too much code I'm
entering the code generation I don't
think all about could make it into the
JK itself is just too too many methods
so we need to pare it down the strategy
of using just the three employ a double
like a nice compromise I have a section
on method references we love method
references they are really cool I
haven't seen a future like this and
other languages that I've used even once
that happens when in Java 8 came out we
wanted to play with the new features and
so we just used our training materials
and kind of operating them to jogging we
saw what we could do with new features
and one of the brilliant things about
the implementation language is that they
just compile these functional interfaces
that we've always used like comparator
and so it works with our types too like
I said the juice collections we comply
luggage up to five but it works love
with each other hate features so one of
our exercises that you see here we start
with your sort of customers
which is when I collect their cities and
that one translated very naturally they
used to have an anonymous near class of
function we just in fact the ID will
auto and intelligence and ice autofix
just replaces it with method reference
or alive so here just replaced it for us
with customer at City and the head
reference other ones didn't naturally
convert into method reference so in this
second example we have the list of
customers and we want to filter only
those that are from London and so that
becomes is landed here which is still a
lot nicer than Thomas in your class I
think got us thinking like why is this
one not as a reference could we use a
method reference here and you can kind
of force it with the so you're right a
method lives in London that's the right
shape so you can do it but of course no
one writes methods like this because
it's not abstract or you can coded the
city right right in a method that
doesn't make sense in a real code but
it's interesting like we have to
confirms this shape when we saw this
week it reminded us of a problem that we
had in Korea Java 8 days keep in mind we
been using these functional planets
forever a reason our own function in
around predicate so we would always be
instantiating the multiplex and they're
usually stateless objects so going back
to the example of customers that are
collecting your cities here's what we
would do in realistic production code
where we've had functions that we've
ever used we have this function that
goes from a customer no city we were
turning into a constant because this
function it's an anonymous inner class
it's very small but it's still an object
that lives on he's still instantiated
with you it's still gets garbage
collected and so if you're going to use
it which is very close
singing higher music gets used by
collective group i publish brothers we
were just stuffing and our coding
conventions would be filled a function
from custom ernest ranglin lives put it
on the customer class as a constant
naman by what is going to go to city and
we were already doing this for years and
the interesting thing is that this code
raised in customer to city looks
remarkably like method references and it
was a trick we've been doing just to
avoid other publication now the second
example with the filtering we can run
into the same example the same exact
problem when trying to reduce garbage
creation here we want to filter the
customer by some city and up here at
embed in london is a constant but you
have to imagine that one is a variable
or grammar and this is going to close
over it in terms of the bytecode the
predator had a hanging feel for that
that's in it in this case you can't just
extract the predicate is a constant
because it has to close over city and
it's different for each city's different
instance and when we were in two
examples like this in loops we really
had a garbage creation problem some of
our most perform associative apps and so
we actually came over the second time
address this and we call it our
witnesses because its name slept with
collect with etcetera instead of taking
a predicate it takes our credit to type
which takes the object t plus an
arbitrary manner which in this case is
that City of London and so now the
predicate is stateless but it takes two
arguments and so we can start as a
constant it's called lips in which is
simple because that matches the method
that it delegates do and instead of
select I call select with lives in
London doesn't creating a garbage this
is a trick that we've been using java
file for java 7 now these methods just
happen to work perfectly with method
references in the place we're going to
use that constant is tell lizzie and the
bytecode for this stuff can be
complicated it doesn't actually create
an announced in your class but you can
presume that this sort of pattern would
perform dead and the java 7 code so this
increases the number of places we can
use method references and we really love
our syntax so this is kind of exciting
so i would like to c times like this on
streams as well filter and filter with
the name isn't important
to use that with the naming convention
but the idea i think is important all
right i have this framework comparison
and i'm not going to go for every cell
here but the important point about this
the feature matrix here is that these
features stack on top of each other it's
more than some of its parts so i
mentioned for example one of the cells
here except you have optimized sets and
maps when we built our by maps multi
maps and Babs we built on top of our
optimized containers when we when we did
apparel el evaluation as well serial
evaluation it's on our interfaces it's
not free collectors for example so we
wound up with every choice I couldn't
multiply that by the library so vague if
even losing elevation your serial and
parallel direction and we have all of
these iterations that are you have you
seen on every choice and every container
type so it is a big library but it's
very feature-rich of these things are
important in our occupations stink of
the wishes these features you would want
to see in the core job so that you don't
have to use as many collections rumor
all right to wrap up here's where you
can go for more information you can
reverse reach out to me directly I'd
love to see more questions on stack
overflow we've created a tag and we just
started answering questions on stack
overflow so if you watch that time
that's a great place to interact with us
you can check out all of our code on
github there's the two repositories and
are looking to install of our clocks the
two talks I wanted to highlight the word
the performance woman from cucumber
where parallel lacy performance which
out of eight versus a lot of persons JS
collections and we have more info on
remembering suspect remarks i just
showed three today but everybody told
entrance you can also check out our
engineering site where we have a few
articles about JS collections as well as
other engineering problems that myself
all right that's what i have like to
open it up for questions</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>