<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2017 • IoT &amp; Microservices in the Home - Technical Marriage Made in Heaven • Fred George | Coder Coacher - Coaching Coders</title><meta content="GOTO 2017 • IoT &amp; Microservices in the Home - Technical Marriage Made in Heaven • Fred George - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2017 • IoT &amp; Microservices in the Home - Technical Marriage Made in Heaven • Fred George</b></h2><h5 class="post__date">2017-11-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-AIEtv6UNzQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I think we originally started this
morning talking about you know running
micro services at scale this is not that
although I always feel that if you're
running is you know scale means one more
micro service and you know how to work
with and that kind of means it's scale
for me so I'm going to talk about this
and obviously please you know ask
questions through the app I tend to be a
early pioneer and a lot of technology so
a lot of stuff I play with and talk
about it's probably not ready for
primetime with a lot of clients I'll
okay with that but chances are I have a
pretty good track record here the next
four or five or six years a lot of
things I talked about become becoming
more practical um so I started out my
career did a lot of work in that but you
know when agile came along I got excited
by agile and one things about agile was
the in certainty of requirements we used
to drive us nuts back in the waterfall
days and I did a lot of code back in
those days and I kind of had this sort
of model in my head that says you know
around you know around y2k when we
started talking about agile this is
concept of certainty all the way to
uncertainty and it was kind of like you
know waterfall worked really well if he
knew exactly what you wanted to build
and all the processes were around that
stuff and if your requirements are
stadium works really well but what was
fine he was I could actually agile will
allow me to handle a little uncertainty
that he didn't quite know exactly what
you wanted to you still want to change
in mind some agile provided significant
competitive advantage and I went to
climb after climb developing systems
around agile because they didn't exactly
know what they wanted to handle but if
they really did had no idea what they
wanted to build he was kind of like a
giant graveyard and it was kind of
easier to sort of project I would walk
away from because you have no idea what
you want or how you gonna pay for it or
anything else like that so it's like I
don't anyone engaging you so a certain
level uncertainty I could handle but not
so much and this is where I stood you
know it's again at the turn of the
millennium the world has changed a
little bit about that first of all you
have the more processing power more
clever at some level but we are so now
handling different type of problems
problems on we call fuzzy problems and
sort of fuzzy
sort of coming this sort of flavor this
is the connection model from Dave
Snowden he describes various problems he
says they're problems that are simpler
the cause-effect relationship is very
straightforward this is the world of
best practices
there's complicated problems where you
need an expert there is a
cause-and-effect relationship but it's
also more than one way to do it so it's
kind of the world of good practice
there's no kind of best practice when it
gets complicated that's like saying oh
Java is the best language for doing
everything in there and everything else
is inferior no language sort of you know
holds that title but he stopped there he
didn't stop very basic said they're also
complex problems was a cause-effect
relationship is not discernible that is
just because this happens I can probably
figure out why that happened
but I can't predict the future based on
that it's not useful for that and that
was kind of very very very telling for
me because it sort of said you can't
really push these problems into
complicated it's not because I'm not
smart enough it's nobody as smart enough
to solve this and these are your
financial domains use your financial
markets this is Google advertising this
is all your recommendation engines
should I loan you money these all these
sorts of problems fall into that complex
domain and these are problems that turn
out to be very interesting this all
right now uh Jason would also say you
got disorder which basically means you
don't know until you watch the problem
which type you have and you got to be
very careful cause you tend to be
prejudiced about the ones you want to
work on so if you sort of get a look at
this problem in space you tend to
organize yourself differently to solve
these types of problems
so again if you're working on us sorry
let's get one might work picture there
we go so we're getting a simple problem
this is York structure that makes sense
you know what you people are doing the
work and your manager who tells you how
to do it best here's a very precise role
and the manager manager tells the
managers how to train people as well so
this is the right organization structure
if you're solving a simple problem it
may look George storey draconian but it
is the correct structure then when you
get to the complicated problems you need
experts somebody that really understands
this and there's tend to be rare birds
and to some degree you need an expert
they're very expensive because they're
expensive then you have another team
that does what they tell you to do and
so you put a manager in place and you
put any employees a place to do that
so in certainly in software development
we tend to call those guys you know
customers or call them architects
whatever they feed stories to the team
and the team bump us the stories that
get told to do again this structure
works really well for solving these
complicated problems because there's
somebody that understands how to solve
it he puts his knowledge through stories
or other mechanisms back into the team
and we solve the problem but we get over
to complex problems there is no concept
of expert because the cause-effect
relationship does not exist people may
think you're experts but they're lying
they're not real experts and customers
may say I know exactly what I want but
they don't you have to humor them
sometimes say yes I'm sure you do they
don't now for this sort of problem so
again sort of the role of that expert it
doesn't exist as nor nor does this kind
of what sort of manager do in this
environment so you wind up creating a
whole different structure to solve these
complex problems one where you basically
say here's some problems and talk about
the high level here's what I success
criteria make money long page retention
times whatever it may be and you turn
them loose and say start doing it and
when something who do works you say
thank you and you try it again the next
day it works fine third day it fails
fine stop doing it try something else
this is the nature of complex problems
so this becomes so you Bears basically
begin to get this sort of the manageress
processes these new aggressive agile
process or solving those complex
problems so you go back to these
requirements uncertainty this sort of
graveyard that I thought existed you
know in year two in y2k that now
basically becomes too fuzzy problems and
they are actually solvable you can
actually do things with the systems to
make these things solvable partly
because they have a lot of processing
power get better languages and various
other tricks like that so now I think
this is actually a savile but but it has
to solve it a different way
all right that sort of brings me up to
sort of talking about what's sort of
coming now obviously as
a jury was talking about we're moving
into the sort of what I call the age of
agents where this people think is out
there running on our behalf and they're
very fuzzy things and they're suggesting
how we can do things better and where as
they get a lot of press associated with
sort of trying to help you do things you
see a lot of things about the voice
interface to them this is kind of like
the marketing part of it the true power
is kind of under the covers where
there's various services interacting
with other services trying to make
guesses about what you want to do and
the voice interface is just kind of the
icing on the cake it's not the really
important part a little very sexy stuff
but not the important part
and so we have this working in an but
again solving these fuzzy problems um
I'm gonna switch over see if I can get a
video running so I I look at my house
and say well you know I I don't exactly
sure what I want to do in my house
in terms of automation because it's
fuzzy and by the way even if I figure
out exactly what I wanted to do it's
probably not where you want your house
so I think I want to play with this a
little bit and see how it feels and I
want to play with microservices in
particular so this is my flat in Vegas
and you know it's like a magic button
and all of a sudden all my lights change
colors not a terribly interesting trick
but it's kinda interesting because it's
way easier by the way to paint your
walls with paint with with a colors
lights instead of paint painting takes a
lot of processing power but if I went to
have a red waling if I have red wall if
my favorite sports team which is a Bronk
Broncos which are orange and blue are
playing my room goes orange and blue and
it's not a big deal to make that happen
so that's sort of stuffs available to
you now the question is is that really
interesting to do and again I have
colleagues that sort of say okay that's
right it's kind of interesting forever
but why would you ever do something like
that back to play
why would you ever bother to sort of do
that stuff in your house well actually
plays nicely so I got a lot of toys to
play with and one of the reasons I come
to conferences to talk about this is
because I can now take a tax deduction
for all my toys thank you so I have a
hewlett system i got about 10 meters of
light strips in various places in the
house got about nine lightbulbs i guess
there's a little nice little Hughes
phillips switch this little round switch
here it actually has no battery has no
wires it's actually powered by the
pressure of your finger will create
enough energy to send a signal and so it
kind of never runs out of battery it's
very interesting device alright do you
have the amazon echo got an apple TV
sort of it's typical devices you have to
wear interface into the world and i want
to play with these things to sort of see
how they work out i also have someone
yeah we most switches I have the magic
AWS button it says hit the button and
something magic happens in 80lbs cloud i
don't reject it sure what's happening
but something usually happening in the
cloud but all I can do is push the
button
I actually figure out what figure out
how I hooked that to my own network so
is you know this is all very nice a lot
of toys out there a lot of people
getting involved with that but why why
are they getting involved with this
stuff to some degree it's the soda gates
kind of high volume potential if you can
solve this problem with IMT devices you
have a lot of devices out there you can
scatter your cost across this stuff it
gets very very cheap to do it everywhere
so that's why I think a lot of companies
are getting excited by it I think also
the home is a really tough place for
usability because we're not all
programmers sitting back there writing
micro services back in our houses there
are other people out the world that
don't do that can you make it that easy
for them to use they don't require a lot
of training associated with that and
there's kind of the fun aspect
especially you are a programmer so I
have a colleague and in Silicon Valley
who basically said you know Fred I can't
understand why anybody would want to do
this and I found it a bit disingenuous
when he said that because I actually
brought my phone I did a little sniff
about how many devices do you have
hooked to your system he's got 74 things
hooked to his wireless network
and he's got this triple high rack in
the basement running it I'm like dude
you know you think this is not important
but you got a triple high rack no I
haven't got room for that in Vegas I
don't have a space for a triple high
wide rack there so I'm gonna see if I
can do a little bit less less than that
now a lot of guys out there sort of
contending for sort of I'm gonna be the
control center of your devices you
certainly have
you know the Amazon echo they you know a
very a very popular product very
surprised hit I think at some level and
it works really well for that
of course then of course Google has to
clone that so there's a Google version
of this also quite successful moving
quite a bit of volume of those as well
uh Microsoft is once says you know what
you're just here every act Fox do this
now it turns out you'll program into
your xbox to do this is actually a
little more difficult they kind of have
dropped off the radar a bit but not has
Apple I mean apples sitting there were
there Apple TV saying this is our device
of course they just announced their home
port so their version of sort of the
same low speaker to sort of do the same
sort of job but they are contending for
the beat of the guy who's running your
house for you and of course the Apple
devices fit very well with the iPhones
and the and the homekit sort of stuff
interesting enough actually Phillips was
contending for this for a while they had
a nice hub Iran's the lots of devices
and it was a good container for doing
this they had an open API and then they
had a release where they decided I
really want you to buy Philips devices
not these other guys and so they locked
down the API and a new version and of
course we the programmers we're like
screaming bloody murder about this we
kind of completely walked away from the
device completely so we just kind of
basically and they figured this out
really quickly themselves good reviews
from Philips so a few months later they
opened it back up again and other people
kind of attached but frankly it was too
late
we'd already got enamoured by these
other platforms that are much more open
and a continue to be open so they kind
of lost out I think one of the most
interesting guys that came along with
Samsung about how do the Samsung think
they should do this and their answer was
get your refrigerator so this was
Consumer Electronics Show last year
have a new version of it this year but
basically they're saying look you have a
refrigerator in your house yeah I do
well you got lots of power there so it's
not a problem
and by the way it's a great place to put
a big screen on there that you can touch
and I'm like that's actually really
clever now the Clarks not clever part is
it costs $3,000 but it's a really
interesting way to think about it
because it's always there
and it's kind of handy and it's got a
screen and everyone else has to have a
little help to make that work so I think
it was a very clever entry but all these
guys are continuing to be the guy that's
running your house of course each one
has their own protocols and and you're
sort of getting into this Tower of Babel
in your house so of course you have all
these different api's and and even
articles are starting coming out about
how much API clutter there is just in
IOT just running your house don't worry
about industry just in your house by
itself and of course that means of
course it's gonna be some middleware so
now as a whole family middleware coming
out so instead of having it maybe six
different API is used to we know how 12
different API is we could possibly use
because Miller we're just creates more
it doesn't ever solve the problem so
again I don't necessary want to play
this world I kind of want to sort of
handle it myself I don't want these
other guys to try to run my life for me
so I said okay well let me try use micro
services myself in the house I've played
with micro services for many years it
seems really like something would be fun
to play with a bit so it is uncertainty
because I don't know what I want to do
so it has that fuzzy nature that's
really good for micro services try to
solve because they were right really
primitive micro services I can rearrange
them in various sundry ways to try to
solve my problems I'm also trying to I
want this replace ability because this
is a fast changing environment I want to
be I know all the time these API is
going to be changing and I want to
isolate those changes as much as
possible and I basically want to layer
on top of these primitives the things I
want to do with it that I think would be
much for us which were less volatile so
to speak so a big fan of a stickers
micro services to handle these sort of
situations because I like the decoupling
you get with asynchronous micro services
the idea is basically you're only going
to be talking to an event bus and unlike
these synchronous sir
where you have to basically sort of say
I know who you are and you register with
me and how you do some of these things I
like to I like the a cigarettes it's not
as common as synchronous in many cases
but it's kind of consistent with this
whole movement to reactive and agent
based programming and all these other
things these movements that we're moving
toward asynchronous is very much in tune
with us so I'm feeling pretty good about
that choice they also these services can
be very small very very loosely coupled
and again that allows me to deploy very
very fast and it is about how fast you
get deployment done I don't need this
restful registration process because
everybody's trouble coming only to the
event bus and that's all you were not
talking to and it does allow me to do
the experimentation this is kind of my
my metaphor when I build a synchronous
systems like this especially the ones of
this size it's relatively small it's
basically the idea there there'll be an
event bus called it I call the rapids
which is basically every event running
is going to publish on the same bus my
log message is gonna be there my message
from services my traffic user journeys
however everything's gonna be on the
same bus this allows me to write an
application very easily because all the
information is there most of that
information I ignore but I'm able to
sort write a new application without
having to go to five different sources
to get it so again using the philosophy
it says you do something interesting you
publish it well this sort of a
second-tier that says I want to sort of
carve out a set of these messages which
is services care about so in figure of
service will care about a certain set of
messages I will pull those out it with a
micro service and put them into a river
and finally there's a concept of you do
need at some point the current state of
every entity I needed out your latest
email addresses and so there is a need
for have reporting and reporting
databases and frankly sequel makes
particular reporting engines so there's
a concept of ponds which are static
information it's not the dynamic nature
that information has been lost but it's
kind of very important to have entities
this way so that's kind of the model by
which I sort of think about what I
designed these systems
this gives rises of new patterns of
usage so this happens we call the need
pattern and the idea is you're sitting
there with a high speed bus in this
expresses some need to the bus it could
be something like hey dude should I loan
you money and I don't know if anybody's
even listening in fact you have to
handle the case where nobody's gonna
listen to the question that's the nature
of asynchronous algorithms in this case
I got a couple of guys who are listening
to that maybe the blue guys will get
your bank account sees the fact you make
rigueur and deposits you never go
negative kind of feels like you're
pretty good we're pretty good bet for
the loan
the green guy could be running off to a
service bureau you could write it
another guy it says gee I think if you
go university graduated and you went to
a good university you're probably more
reliable I could check that make a vote
based on that and keep adding them in
the idea is these things completely
independent of each other
the yellow guy doesn't know the blue and
green even exist he hopes they exist but
he can't count on it he doesn't know how
many of those guys exists and basically
all they're doing is voting about yeah I
think you should loan the money or not
loaning the money you're sitting back
here deciding whether you want to take
advantage of that or not so again new
architectural patterns associated with
asynchronous algorithms the nice thing
about this is it's easy ad version to a
blue service just put it on the bus I
don't have to turn version went off
because stay there compete for the
business but think I got a better blue
service I can put it out there so a be
testing is kind of built in which is
important from my domain and the green
guy goes down I'm still getting votes
things are still happening now somewhere
degrade at some point but I'm still
working and that's important also for
robustness this also allows me now to
build what I call incremental
applications where I can start with just
a few things that work and make it
better very aggressively I teach a
workshop where we basically do car
rental examples we're trying to fill in
advertising only car rentals and so we
write ourselves some a little some some
services down here that all put offers
on there to put more advertising on your
page and then that works really well I
could get that working you know in a
week very easily and then I say well I
could make a better answer if I know if
you're a member I figure in our program
or may have done some segmentation
analysis about what type of things you
do tend to like I can add that
information to give you a better answer
but I'm constantly running through this
whole process I'm constantly running
experiments very aggressively and again
incremental application has become a
very powerful part of this this by the
way continuous deployment absolutely
there continues integration not
interesting canoes deployments where
after I don't need to integrate all the
time I need to get the code out there
and try it out alright so for my home I
made some technology choices they
weren't the most aggressive technologies
I cited I'd use rabbitmq for my event
bus I don't really need the storage
nature of a Kafka bus I don't need that
persistence nature of it
rabbie queue has some better bindings in
some cases so I'm gonna run Ravin queue
and then my home system we use Jason for
all the races that Adrian talked about
versus XML there are some better you
know Jason formats right now some very
compact stuff I don't need that yet I
just as soon be able to read so it's on
the wire so I'm gonna stick with Jason
for now I will use docker and I'll use
swarm because swarms got a lightweight
kubernetes and I don't need anything
more heavy than that at this point and
at some point I will actually grab some
dedicated Linux boxes and stick them in
some closets a couple of them for
redundancy and just put my doctor
instances on those guys that comes
that's sort of my technology for running
my house I do believe that we are we
sort of make design decisions on the fly
I like dynamic design decisions I like I
actually make a lot of architecture
decisions on the fly but if some agree
the architectural principles you kind of
have to decide those upfront and so I do
spend time thinking about what
principles behind the architecture I'm
trying to implement so I can actually
make good choices on technologies and
other things I'm definitely gonna take
advantage of I have no idea what I
wanted to do I'm going to design on the
fly but since I started this big trip
I've been traveling basically
continuously since about mid mid
February at this point so I've had a
chance to go home and play with this but
I have a whole bunch of new ideas from
various conferences and talking to
various customers and their situations
so me the process of rewriting
everything which is kind of kind of nice
with a just-in-time design I do build
behavior oriented services which means
my servers gonna be very small but you
have to do something
they're just not just pumping raw data
out I don't believe in NC based services
I don't believe this something called a
customer service understands everything
about a customer and he's the only thing
that understands about customers I'm
gonna scatter the information to
everybody who needs it
so sort of behavior oriented services as
a design philosophy if I do something
interesting we will publish it even
though I don't have a use for it yet
this is an idea we stole from Google
this is how Google did a lot of their
early early thinking and it paid big
dividends for them and I'm gonna get
reliability through two tricks first of
all my mess there's gonna be idempotent
which means if I get the message twice
that's okay I don't care if you tell me
to turn the light blue and it's already
blue I'm gonna say hey I'm fine and
happy with that that's not a buck and
when you have that you can actually just
bring multiple instances of your buses
up muffle instance your services up
because it's idempotent so we have two
guys assigning you turn the light blue
and they say turn the light blue and I'm
perfectly happy with that now run one of
those instances on each one of the Linux
boxes so if something goes wrong I still
get blue lights Oh
frameworks there's not a lot of
frameworks out there for a cigarettes
microservices so I'm gonna steal a
little bit of code I used in my workshop
the workshop is code is actually it's
open source it's up on the only my
github account as long as you don't use
it for training you're feel free to use
it
I'm also developing some ruby gems and a
little more sophisticated that I'll be
using in my class and in this situation
but I'm using some frameworks from that
just give you an idea what some of the
clock code looks like this is the Java
version I'm not doing it in Java by the
way but this is the sort of the Java
version you can sort of see that you
started out by saying yes I'm gonna
listen for a river because that's the
paradigm I'm looking at rivers I'm going
to establish connection to the rapids
because that's why I always publish back
to the rapids so I establish that I make
myself a new river and the river is
gonna have some filtering criteria
associated with it so I only want
messages that meet that criteria and at
that point now I'm ready to start my
service up so i bringing Eunice's my
servers up attach it to that River and
now I start getting messages and when I
get a message basically comes into this
packet API which passes the packet of
course that says it's a packet
here's the here's the river to publish
to if you want to publish something back
and here's a whole bunch of things I
didn't like about it these are warnings
in this case if something's really wrong
again Eric Hall and I get more
information about what's wrong with it
good for debugging but most of the time
you just comment that out and that's all
it takes and it by the way I think as we
heard about moving to functions and
lambdas and like like this this is two
lambdas one lambda for defining what I'm
interested in
and another lambda here defining what
you want to do with it when you do find
one so these are sports very well into
this next generation of technology as
well so that's my framework I don't
anything you heavier than that give me a
rabbit name ik you give me these little
frameworks I start writing services
there won't be much bigger than this all
right so how do you start building this
system it turns out most of this IOT
hardware usually has about two
interfaces that's sort of a primitive
level interface where you really control
things like lights very carefully and
most of these are trying to be better
than that they want to provide you more
functionality so they have a higher
level functionality API most cases they
called seams which seems to be the
terminology for that I'm setting up a
scene associated with how my my Maya
house looks I'm gonna put myself mic off
my rapping cue bus in place so I put an
event bus on top of that and then I
start writing some services and I call
these two tier one services are the ones
that are interfacing to the raw hardware
I need some way to take that all
hardware and turn it to something
interesting on the event bus and so I
would write services that do that and it
probably a different service for reading
from that hardware versus writing
because there's two separate jobs and I
can separate those two things out
independently so I'll write some
services at the interface to the
hardware and put put sort of the summary
what's going on with that hardware on to
the event bus they don't have sort of
tier two servers as which will have sort
of higher-level concepts like scenes I
think scene is not a bad way to think
about a lot of these things in your
house so again most of the time he's
just pulling off the bus but
occasionally you may have to actually
try to interface back with the API I
want to try to avoid that because if you
don't try to avoid that you're gonna get
sucked into their version of what's
higher level stuff looks like and I
don't we get sucked into that because
Apple has a view and
I'm sure Google home has a view and an
Amazon echo has their own view and they
keep changing all the time
I don't want playing that game with them
but maybe a couple of times where I
think I may need to do that what happens
to be the case with these few things
when he's a little button here on the on
the hue system it sends a signal to the
hue Hub and you hub picks a scene as far
as I can tell so far I can't get I can't
get a trigger based upon just hitting
that button and a primitive trigger it's
gonna be a scene gets changed so I may
have just sucked the idea see got
changed and then kind of ignore the fact
it's the scene just take it as a button
and so I'll sit up that way so I may
have to do a few things just to suck
things out like that tier 3 services are
ones that are actually trying to higher
level things sort of across devices like
what happens if this particular time of
day I walk in from walking in middle of
the night towards the bathroom maybe you
want to turn on a light really dim so
don't trip over something or I walk in
the house and it's after dark and
probably turn on some more lights sort
of putting together lots of different
things to sort of build sort of a
choreographed system so I'll have those
there's also a really need for a lot of
sort of monitoring because one things
about event buses there's lots of things
are going on and you want to know what
really happened
nice thing about an event bus is if you
sort of record everything that happened
it's easy to debug because here's a
here's a time sequence of everything
that went on here's the message I sent
to you you sent this garbage back
seriously it's like I know exactly where
the bug is debugging complex systems
today model this in particular you got
to put all the logs together didn't see
well what happened relative the logs you
put this time signals together now I can
start debugging with avid buzzes you
start debugging at that point already
and in my experience about 90% of my
effort was getting that time sequence
right then I can figure what the bug is
a card off 90% of the time just by
having event buses I also have things
I'm looking for problems it could be
yeah where somebody tells me to turn the
light red the other guy says turn it
blue and we go back and forth I want to
be able to detect those situations I
probably won't write any of these until
I actually do have a problem I can think
of lots of things to go wrong but until
it goes wrong I'm probably gonna spend
the effort doing it
and finally if I figure out if it
happens a lot I want to actually
correct it and again that's something
I'm not gonna do initially I'll just
make sure I can find it but if I find it
a lot and I figure out how to correct it
and can do that reliably I will fix that
so only one of the earliest Corrections
is one of these services Goes Down and
stops heart beating I'm gonna bring it
back up I may actually bring it back up
on the other Linux box in particular but
again that's the sort of thing I'm gonna
do error correction on so lots of
different types of services each of
which will be very very simple easy to
write so one of the problems I have to
have with this is maintaining state
let's see actually the video actually
works I love it so here's the house it
turns out if you turn off the switch on
the hue light bulbs which used to be
blue and turn it back it on everything
goes back to white there was the bulb is
forgotten what state it's in so I really
wanted to sort of be insistent if I'm
saying what's the light blue I wanted to
be blue so let's see how I might do that
with my new system because clearly the
hue box doesn't do this for me so I'm
gonna show you what the choreography of
this is and choreography is kind of the
right way to talk about this there is no
orchestration engine here there's no
sort of god service that says I
understand how you wouldn't run the
house because every time I change my
mind I have to go into the god service
and all the other services that he talks
to every little service is doing this
little part but there is choreography
going on there's no guys sitting there
saying this is everything you have to do
different philosophy in general so I got
a choreography for sticky colors so a
little flow about how this actually
works I got my event bus I got my hue
hardware and I'm gonna write myself
basically a little micro service that
just pulls the state of the hue Arden
where it tells you what it is there's
what lights are on and what colors all
day and that's his entire job and so it
turns out you have to pull for this you
know get total automatically so every
few seconds I'll pull figure out what
the colors of the lights are and I'll
polish a whole bunch of messages to the
bus it says they're here so here's the
lights you know the colors but I'll also
say oh by the way the hue system doesn't
know about this light it was registered
with a hue system but it's not there
anymore basically when you turn the
switch all
it loses the light so at least I'm gonna
say all of that also by the way here's
the light I have no idea what it is it's
it seems to be all for this right now is
an unknown state that's information I'm
gonna publish it to the bus I don't care
how who needs it yet just publish it to
the bus so again the streamer message is
coming on the bus saying here's the
lights that are on and their colors and
oh by the way here's some lights I have
no idea what the state is I would know
the service that actually sets the
colors and it's again sticky sort of
thinking so it basically says if you
tell me - the lights should be blue he
says oh boy
it says the light is red and say no no
no right should be blue so I'll turn it
blue if you says the light should be
blue and I say oh but it's already blue
I'm perfectly happy with that so I won't
say anything so now I have enough
actually to make it sticky so the guy
turns the light switch off all of a
sudden these lights gonna be declared
unknown well the guy turns their back
call and it's gonna say oh by let's
light is white this little servers gonna
say white no no blue blue and I'm here
with a blue message so I guess sticky
colors with that that's kind of all it
takes curse now we can sort of add more
behavior I want to set the scene up so
that lights have maybe by my favorite
football team colors on the right time
and day so I set up a scene concept it's
a higher level concept it's sort of a
tier 3 service or a tier 2 service so if
somebody actually it's that little hue
button by the way I want to take that I
basically have figured out so far I have
to think after Pole to get that hue
button pulling scenes I think I've found
a way I can actually get it to be more
not polled but we'll see if I work when
I get home meanwhile always says hey but
got pressed I have no idea what this
means but this button number one got
pressed and it turns out button number
one is what light seeing cares about he
says that's all that means I should wake
up and do something and you'll say oh by
the way these are the colors two collars
light should be it just publish that to
the bus
he hopes somebody's listening but he
doesn't care I mean some of these lights
he's telling it to be colors may be off
not his problem his job is over when he
says oh by the way these are the colors
you should turn your lights on of course
this guy's gonna get all his best chiz
if he actually can't control the lights
he'll actually change the ones Ness
I know I have scenes again not a lot of
code associated with doing these little
things very easy to sort of keep playing
games with this stuff well it turns out
also it's kind of interesting to sort of
know what they are if I was especially
I'm traveling here be nice to know
though you know what the lights look
like so so I kind of build sort of a
basically a dashboard service this is
kind of like a monitoring service at
some level and all he's doing is sitting
there receiving messages about what
color the lights are and then he turns
that into a Jason packet that summarizes
that pushes it back to the bus that's
the end of his job now I filled out I
can write myself a web page that sort
fix-up that Jason and renders it in some
sort of map of my house if I want to
play that for a game I could push that
to him to my iOS device and render some
other way all based upon that Jason
status but also I have a little status
message to send me on my bus it's
getting logged all the time it says oh
by the way this is what the colors those
lights are all very powerful stuff so
again very easy to sort of build these
things with very tiny services and you
build it from very sophisticated
behaviors with just a few small services
ready some very simple code choreography
so my observations at this point do a
lot of messages flowing around that's
the nature of asynchronous stuff I have
a bus that can take a lot of messages
rabbiting queue can take a huge amount
of messages especially at this sort of
scale and I don't care I'm not trying to
save messages I'm trying to make it easy
for me to program I think one of the
things that we that I think was actually
was Netflix I'm quoting Adrian I think
he's gone that's good but we talked
about how you organize your systems and
the question is do you organize your
systems of yours got like Netflix do you
organize them to optimize your Amazon
footprint because that's very expensive
or you're trying to optimize for
customer experience and the answer comes
back no no no we're trying to optimize
for programmer productivity we want to
be able to change things quickly and try
ideas out aggressively so I will waste a
lot of messages I'll write lots of
services I'll throw lots of extra docker
instances around I don't care I'm after
my productivity you see there's no
restful interfaces so there's a
registration process
it makes as much what's easier can I've
got that God service it and understands
what services are running right now
don't need that I really have no
constraint I find having multiple
instances of every service running in
parallel I will demonstrate a two guys
watching the Hugh box running on
different Linux boxes I'll bring him to
guys they'll set them because it's easy
to do it's allowable and it's idempotent
I don't need a unit test because code is
so small how do you need a unit test
let's just a point see what happens and
that's one things you do we writes very
small things and basically the system is
designed to catch failures so between
the monitoring and very specialized
error detection that's why we can
aggressively deploy into a system I
don't need acceptance tests I don't mean
don't need my acceptance test framework
I don't need my deploy testing system to
deploy into or my integration sister
deploy into I just point to a live
system and the live system and as a bug
it's gonna figure it out really quickly
when the lights start flashing strangely
I know something strong so let's go back
talk about process a working this sort
of environment again there's sort of no
rules here and so you wind up having
sort of a different sort of a process
now in terms of XP values and extreme
programming all these things are true
whether you working on a fuzzy problem
or working on a traditional problem
these are things that are still
important to you when I look at sort of
the traditional agile practices and the
roles associated with agile you sort of
make a list like this I'm sure it's not
a complete list anymore but these are
sort of the major things you're
associated with agile practices and
these are sort of the guys are playing
the roles and stuff like that when
you're doing agile systems but when I'm
playing these fuzzy domains basically
you kind of wipe out a lot of these
things is unnecessary because we're
experimenting and we don't have experts
and the idea of having sort of you in a
business analyst it's going to tell us
what we need to do is nonsense because
he doesn't know basically whether we
wanted for is a customer who says I
here's what success means to me here's
what it possibly means to me and in this
case I'm the customer I want cool light
stuff and they need a developer that's
it
so it turns out he's solving the fuzzy
prop problems the roles and
responsibilities and the practices are
radically different same values
we still value all those things but I'm
in a different world again and think
back to the kinetic model I just an
example this in action
um I guess not where all those X's went
well ignore that chart so basically
fuzzy and viable if you sort of look at
what agile is is about stories and
specialists and TDD and and just solving
those sort of problems traditional
problems using agile practices instead
of waterfall this is still the right way
to do it I still tell my clients to do
it this way for solving those practical
problems but when you get into fuzzy
stuff I'm about ideas we're focusing on
how fast I can try an ID out I don't
need a requirement that says it's too
important I just need the ideas
full-stack developers guys who
understand every part of the system
because they're doing things very
quickly I don't want to have handoff
between my design team and my architect
and my QA guide no I don't want these
handoffs I want to just do it move
forward with it the system actually is
designed to fail fast it's an inherently
fail fast system we write a lot of code
to make sure it does fail fast versus
I'm not sure I make sure it never fails
I gave you think about Netflix and how
they design your system it's a fail fast
system microservices work really well
for these fuzzy problems because I can
write something in its hole here I'm
talking to the Hugh box I can change my
mind about scenes and everything else
I'm still turning to Hugh backs the same
way my code doesn't have to change when
Hugh box changes our API it's the only
place I have to touch the isolation is
very powerful there and the event based
architectures allow me not to have to
worry about registration and a be
testing is easy and lots of other things
are there so different type of problem
on the scale different attack to this
problem is necessary oh good um in the
future I'm gonna get some more boxes
there's a nice few motion detector this
will let me turn the lights on when I
walk to the bathroom in the middle of
night I've not got a thermostat put in
which is interesting because I live in
Las Vegas and it gets really hot and
when I get home I don't want to be you
know 35 degrees inside the house so I
need to put that one in there clearly
quickly and I need to get always sees
these
these linux boxes because I'm right now
I'm running this on my my Windows gaming
machine which runs docker really well
but not a lot of docker instances future
is you thanks again I will also worry
about some problems I'm looking forward
to trying to solve is you need something
that is very easy for you to define how
a house works something that you know
the people in that own houses that are
not programmers can figure out how to
use and I think the roadmap for that
it's actually pretty clear at this point
this is the IFTTT guys only I don't want
necessarily to tell everything about my
house to some external vendor somewhere
in the cloud I want to keep us down to
me can i generate micro services based
upon these specifications apparently
somebody told me that in one of the
conferences that somebody's already done
this with nodejs so it looks very doable
and so I'm looking forward to tackling
that problem as well um the other things
going on is obviously you know doctor
can run a raspberry pi the Raspberry Pi
is actually a really powerful machine
after all so I'm looking forward to sort
of playing with that as well so you can
get started with this you build yourself
a little you know cluster of raspberry
PI's and if kind of looking forward to
bringing my friend from California back
out to me and say look at my cluster
versus your Arak and it says oh but I'm
doing everything you're doing here with
my little raspberry PI's hopefully it'll
be a little jealous of what I can do in
my little flat oh that's kind of the
story of micro services and IOT lessons
I would say walk away with is micro
services worked really well for for
little small experimentation things
it's nice way to get your feet wet
asynchronous works particularly well for
that but be wary no matter where you're
using micro services particularly
asynchronous rethink your process if
you're solving fuzzy problems and you're
using with micro services you need to
change the process by which you're using
thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>