<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2014 • The Best of ngAnimate in AngularJS • Matias Niemelä | Coder Coacher - Coaching Coders</title><meta content="GOTO 2014 • The Best of ngAnimate in AngularJS • Matias Niemelä - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2014 • The Best of ngAnimate in AngularJS • Matias Niemelä</b></h2><h5 class="post__date">2014-08-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5vA6aomUPNw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're going to talk about animation
and web apps and
sucks about it and then angularjs just a
little
for those of you who are familiar with
it Angie animates some demos about the
animations and then some new ideas about
animation in general so what's really
good about animations there's a lot of
locations well transitions and keyframes
are really good like they they handle
the animation bits that you know would
be expensive non-reusable javascript
code and they do a really good job of
doing that but they're very limited but
alguns that detail soon but for now
they're assume that they're very good
javascript libraries are very advanced
as well if anyone's use green sock
before or even jquery's animation
libraries good and the hardware
acceleration and browsers really
optimizes animations especially in the
CSS world with each new but release of a
browser and then the animation API is
that have specific browser animation
helping like helper code for example
like requestanimationframe or fragment
izing the Dom so that when it gets
inserted you can have one animation
instead of multiple animations and then
finally with the new web animation in
pad it's assumed to come with dowsers so
what's bad so synchronization is really
hard as in I want this animation to run
for a specific amount of time and then
it has to stop that's it but the CSS
detection to run that is very tricky
because you have to do get computed
style or you have to check to see if the
properties of the style have updated or
listen on a transition event and it's
really tough and this tends to kind of
ruin your HTML code you tend to have too
much HTML code that has been sort of
style in a certain way so that CSS and
animations can kind of hook into it
there's no way you can really isolate
your animation code like how many people
here we use CSS code between projects
and I'm not including like a library
like bootstrap or something but like the
code that you've made it's been so well
crafted that you copied it over and put
it into another application we're
probably not right and the same goes for
animations because you tend to special
case things that kind of find to the
animations and then after that it's not
reusable and yeah
so let's talk about a typical css3
animation like I'm assuming keyframes or
transitions something happens in the
page user clicks on the button the view
changes new data gets downloaded into
the page and then when that occurs some
class changes or a pseudo classes active
for a property and then the animation
kicks off right this is basic stuff
there's really not much more that we
need to know but it's as soon as you try
to tap into this that things get
complicated because you want to wait for
an event called transition end but
transition end depending on what's going
on at the transition might not run
properly and then when the animation is
there you remove the CSS classes the
animation is done right what could
possibly go wrong so here's a code for
example to facilitate an animation by
changing a class in JavaScript and
making the CSS kick in you know this if
you copy and paste this code you know
make the code for start and end emission
it should work fine right but there's a
lot of problems that this could happen
the reason why I'm familiar with these
is because putting together ng animate
and it discovered a lot of flaws with
browsers and animations so let's talk
about these problems a transition might
not kick off if you have a font size of
20 pixels for say the body tag and then
you add a class on to the body tag
called big font but the font is the same
size you would expect to transition to
the animation to kick off but actually
won't because there's nothing to change
so this is a huge problem there's no way
to detect this in a browser and then if
you haven't transitioned on an element
and then you try to put another
transition on it you might not get the
same result as you expect it might end
the previous animation both animations
might burn at the same time and multiple
transition had and that's been occur and
with these multiple transition events
some browsers treat them differently
like for example if I animate something
on opera versus animate something on
Safari or ie let's say Menna mating the
border property on an element and
there's a top there's a left there's a
right there's a bottom chrome will see
that as one animation but ie might see
that as four for each border on the page
so there's all these annoyances that you
have to deal with when you train
to really push the in additions on your
own and then finally you might get false
to that data and if also that did I mean
like the event object that's returned
for animation might not be appropriate
that big corrector might just be
incomplete some browsers don't handle
this properly and then finally how can
you pause and resume it more of a
transition and like a o'ciock
transitions handle things but keyframes
are more for animations specific stuff
right but even keyframes have their own
issues primarily how can you run two at
keyframe animations on the same element
at the same time in a manageable way and
the nice thing about transitions
compared to keyframes is that you can
give it a range of properties that match
and a keyframe animation can only match
a certain few so here's a code that we
have to put together for angular's
animation ending detection event and you
can see it's a lot more complicated than
the example before and like if you look
at this for example this specific bug to
Firefox had to match the elapsed time
because Firefox instead of returning you
know 10 seconds or it turns like 9.8 88
or something and it has to be run it up
so basically what I'm getting at is that
animations are way too tricky to trigger
and maintain on your own and using an
animation library is very good however
with the state of animations browsers
are getting better and better but it's
very tricky to do this all on your own
even with the regular Dante PS so before
I continue look at this code right here
for example this is the code that when
the animation is completely done we have
to do all this cleanup code and ingénue
animate for angular to take care of this
okay so let's talk about angular then
how many people here use angular on a
regular basis have developed out web
applications with it how many come here
a brand new to it don't know it never
seen it before right
okay I'm gonna give you just a couple
five minute demo quickly okay so I have
a folder here called test and I'm gonna
open this folder and in this folder I
don't really have anything I just have
angular angular animate and index so
let's create an index page and
the purpose of angular is to basically
instead of having the server process all
of the complex template related building
like for example PHP how you would build
a forum page it would sort of build the
HTML and serve you this big clump of
HTML and then with a traditional website
like that you would have JavaScript
which hooks in there updates a little
pieces of the website and then that
makes it dynamic the paradigm that's
happening right now if websites is that
the browser is handling a lot more than
the server the server is job from here
on is going to be just to give data just
to expose the database in some way to
the clients and the client itself is
going to handle how the UI updates
according to that data so I'm gonna
include the angular file to here but
before I activate it let's imagine that
we had these capabilities in the web
page let's say that we had hello and we
can pass in title right so you can see
your name on a server what would happen
is it would print out the name into the
HTML yo download it so when the client
gets it it's actually really static h2no
you know considering that it's a dynamic
server that's generating and then when
you want to change the name you're gonna
download a new page so if we have this
functionality and browsers using this
binding mechanism where we have some
variable in the browser and the browser
would read that variable and then
whatever changes would update it without
the need for JavaScript websites will be
a lot more advanced so with MVC websites
and VC frameworks the push has been to
have these sort of features in the web
sites that exists so how can we make
title work for example so if angular we
have something called a scope and
basically a scope is this sort of memory
shared memory in the application where
every place in the scope you can expose
the template so let's put title let's
put my name matthias now let's see if
this actually works
so see here how we have hello title
there's nothing here so angular hasn't
kicked in yet so let's add the angular
tag right here and ng-app just the
default application and there we have
title now my name is showing up in the
page right if you look in the actual Dom
we can see that JavaScript automatically
put my name into that page it rewrote
the Dom to do that but if we look at the
HTML code like what was downloaded from
the server you can still you can see
that we have the complicated
well not that complicated sorry the
template specific HTML code okay so you
know let's add another piece of data
here let's put an input field and let's
make it so that and whatever we type in
here will show up so now if I type into
new value here you can see that updates
automatically and so far I've only
really had four lines of code
considering the script file so this is
the whole point of any other the point
of this is that all the complex stuff
that happens inside of the server is now
in the browser but it's done in a way
that you don't need to have you know
hundreds and thousands of lines of
JavaScript code okay let's do one more
example let's make it so that we have a
list of numbers
and let's initialize a list of numbers
and let's say numbers is equal to 1 2 3
4 5 6 7 8 9 so we have nine numbers so
here we have the numbers below let's
remove our hello statement and it's
actually make this field filter off the
results of the numbers so we pass in a
filter here and we put filter will
change us to Q now whenever I type a
number here it's filtering out the
numbers so already I've created a
complex app with really four lines of
code this is the paradigm of angular and
what I'm going to be talking about today
is how to enhance these angular things
these angular directives features
templating stuff with animations and
then we're gonna go into other things
with animations of how you can really
think outside the box with this with
these features okay
so it's a nice and easy framework when
it comes to building web applications
that have a lot of data it's really nice
you have forms form form effects that
really I don't haven't found them in any
other JavaScript library to the extent
of angular and the whole purpose is to
extend the behavior of HTML so that
instead of having to write tons of
JavaScript code here is writing more
template code or HTML code so we saw
that basic demo of angular let's talk
about ng animate so in addition to what
angular is there's an animation library
that gets put on to it it's called ng
animate anything with an NG means
angular so instead of saying a n that
just shows in G and ng animate it's a
module that gets added to it it's been
around for about a year it's being
consistently improved if angular but the
first version was announced in 1.14 now
we're close to 1.3 so before ng animate
the way that you would animate something
is that you would create some sort of
JavaScript directive and now directive
and angular is basically one of these
things like a repeater is an extension
of HTML you create something that would
latch on to whatever your turn animates
and it would somehow pick up on that and
animate it and those made way too
complicated to to do that
so you end up having a lot of JavaScript
code to do this and then your HTML code
just looks brutal so what does animation
with ng animate do the last has happened
to transitions and keyframes and you
basically set up a CSS class make the
CSS code for that class and then angular
will pick up on that and perform the
animations you get it in addition use
JavaScript callbacks all the states all
of the cancellations enable and
disabling all that stuff is handled by
animates within within ng animate on its
own so what does this really matter well
since it only uses CSS classes its
plug-and-play
meaning that I could just make the CSS
code put into stylesheet and then it's
in there then I can copy the style sheet
put it to another angular application it
could work and then all that complex
stuff that I showcased with transitions
and detecting events in the lot that's
all handled for you and it's highly
performant there's a lot of smart sort
of logic put into ng animate so that it
could speed up websites so let's see how
we can put this into our example with
angular we're gonna including angular
animated to our file we're gonna set the
module as a dependency and then we're
gonna place with CSS class which is kind
of tie the animations together so
continuing off where we left off for
this page let's make a style property
and let's add say slide alright so we're
gonna have a slide animation and we're
gonna do a transition one 0.5 seconds
then you're all but so far still don't
know how to put an animation here
because you know that CSS doesn't have
like when an item is entered into page
when item has left the page those kinds
of specific pseudo classes so ng animate
what it does is it adds these extra
classes on to your elements that's being
put into the page or moved from the page
or showing it hidden from the page and
in this case this would be ng enter it
allows you to have a starting style and
a destination stop okay so let's copy
that over let's do slide ng enter slide
ng enter active
and let's say that we want to say let's
say they want to animate from something
that's invisible to visible but we also
want to slide it from negative 100
pixels to that okay this shouldn't work
right if we come back here this should
work fine but no there's no animations
because we have to have the angular
animate file and then we have to include
it as a dependency we have to make a
module
and then we reference the module up here
we call it my nap alright let's see what
this works now oh so they're out the
code there's something missing that's
right yes okay so let's see what happens
then
you can see that the new item is kind of
slide in from the side of the page let's
make a comparable animation for the
items are leaving the page so we have an
enter animation when new items come into
the page we have leave animation when
old items have left the page and for
this one let's reverse the animation so
that the new items start out by being
visible and then and the old items that
are getting put in the page slide away
so you can see the new items come in so
we added animations very easily we're
still not that there's less than for
about 40 lines of code on the page
there's actually a more CSS code in the
page and there is HTML code we're gonna
have we have one line of JavaScript code
to reference the module so this is the
way that we place animations in angular
okay let's let's add one nice little
effect to this let's put a stagger
innovation stagger animation is an
animation that has a slight gap between
each item that follows so let's do a
transition delay that much 100
milliseconds and let's put this about me
right here so that it knows this is a
requirement for staggering but let's see
how this works you can already see that
we've added some complex and additions
to our page but it's all in CSS Cobian
have to add any JavaScript code so how
do we do JavaScript code well before we
get to that let's look at keyframe code
so key firm quote is the same thing with
transitions you don't have a destination
class you just reference the keyframe
animation instead if you're inside of
the first CSS class so since that's all
CSS code that means that we can make a
media query we can have an additional
stylesheet that's loaded based on the
resolution of the browser we can run
keyframes and transitions together an
animate will
smart enough to pick that up because it
checks to see the styles on the element
each time that's run so what about
JavaScript animations so you saw the
module he created earlier or basically I
referenced the module and G animate on
that same module I can define a
JavaScript animation so that the
animation is running and then when it's
done it calls the done function and that
can also provide a closing animation in
the event that the animation was
canceled early on okay so which
directives supported angular and repeats
and GOG switch all that all of the
directors that take out content input
contents the page support it natively
and you can put into your own directives
using the animate service as well as
ng-show and ng-hide that they're adding
or removing ng-hide class which you can
tap into to fade out or fade in the show
and hide animation so what are the steps
involved so with angular the scope data
changes and the scope data is something
that's on the memory of the page like we
saw off the title of the numbers but
those values change then angular picks
that up and it says okay I'm going to
insert and remove this particular item
from the Dom but before it actually does
that the animation kicks in it's like
okay I want to animate this transition
in between so it looks at the CSS
classes and C's checks to see if there's
any transitions or keyframe code that's
attached to those CSS classes or
JavaScript code and then it runs and
emissions one by one and then it finally
closes the animation and all the data
has been removed and the Dom operation
commences
so let's actually put some animations to
use and we're going to use the animate
service and then we're going to talk
about another library that we could use
and they were going to talk about some
cool ideas coming potential in the
future of ng animate all right so in G
view so we know that entry view is the
view of the page it's this little it's
the component of the page which shows
the contents and I put together for this
talk as a simple github browsing tool on
here I'm going to disable the animation
so you can't see anything yet we have a
gist page and the gist page
this guy's got a huge just right here
look at all these files from this guy
like I'm almost curious to go visit his
page to see what's going on here
he's got no idea what this is this is
the random Geist from github and this is
crazy but if we go look at some other
files so these are just random files
from gist okay that's cool
it's a way for the page to load okay so
let's go to the home page browse in
trance a little slow
okay there we go all right so if we go
to a particular repo we can see that
people evolved on the repo and if I type
in my name right here you can see that
I'm highlighted in the list of users for
that repo and then if we type in values
right here we type in for example Y cats
which is cats you can see all the new
items getting all that matching items
that don't fall into that search
criteria or getting taken out of the
list nicely back into the page these are
examples of innovations try to save all
the animations the animations are
completely gone from the webpage so
let's actually take a look at how we can
do a few of these so the first one we're
going to look at is with the view the
view changes the new view comes in how
does this work well we've already seen
an example using CSS transitions to
animate the view and take it out of the
page starting out from the pasady hero
putting into one and vice versa if we go
into that application
this was the view code for that starting
transition the new one gets put in the
old one it gets taken out okay
that's simple stuff let's look at
something else what about a repeater so
we saw at the numbers repeater how we
had data in the page and then we took it
out of the page and there's an animation
that comes in but we didn't see a key
for renovation how could we do that
alright so in this same file I have here
a list of the repos on the page so this
listing of repos we're gonna do an
animation which would set the maximum
height from 0 to maximum I have 200 so
they kind of fold and collapse on the
page and believe this needs a little bit
of work to get this to work basically
leave it if you say overflow why hidden
you say box sizing for their box let's
see if this works no no seems to be just
fading the mountain fading them in okay
if we have time we'll get back to that
one later but the point is that we're
specifying the inter event we're giving
an animation here we're giving animation
here its keyframe animations and they're
defined right here okay what about
something like ng if ng if is where you
can have one block of Dom code in the
page and then once the expression
changes if it's false then the content
is taken out of the page and anyone
comes in well what happens if you want
to have a Java Script code so notice how
we have slide right here this is our
JavaScript code to hook into that slider
basically we have an enter function and
then we're setting two CS up CSS code
and then we're fading them right but
let's in this example of the gist you'll
notice that when I click on this you can
see it collapsed expand how does that
animation work and if you notice if you
look on the side you see how these items
faded yeah there's supposed to be
multiple of it let's look for one file
that has a lot of elements aside I don't
want to touch this one again because of
you my browser crash
all right so this one right here so we
have that animation happening and then
these four items coming into the page
how does that work so we're using a
library called green sock and green sock
in addition to jQuery allows you to
animate chop you can animate using CSS
but triggered from JavaScript so we're
getting a hold of all the files for that
particular element and then we're
setting some additional styling styling
to hide them and then we're setting the
height to go from zero to the full
height of the full head of the container
to have the opening and closing
animation and now we're gonna explore
this animation how can we do something
like this well if we look in the HTML
code I have this thing called the
carousel the carousel is the special
directive that I put together that when
the contents of the carousel change its
going to make a new copy of the carousel
and take the old one about the new one
it kind of like a repeater so this code
right here is calling it's calling the
slide animation so the slide animation
we're actually calling a different
library called animate dot CSS so we
have a roll out slide and then we're
just adjusting how long it take a long
runs for so this library called animate
that CSS basically has a collection of
animations that you can put into your
application right off the bat so if
anyone's new tangi animate or wants to
put these effects into their webpage
just go to this website and you can copy
the stash and reference them in your
code ok so what about I just shown in
jihad since ng-show and ng-hide are
class-based animations basically you
have a class that's being added and then
some meditations occurs in between this
particular style ng-hide will make the
element completely invisible on the page
so we have to add the special CSS code
to make sure that whenever it's
animating the block is visible ok so
let's talk about this animate surface so
in the directive that created the app
carousel directive I'm including the
service and that I'm calling one of
these animations on their interleave
move out classroom class so all of those
animation events are called in by the
angular directives for example a gif
will conjure
ng-show will call add class or remove
class so how can we use this if we go
back to the code with the app carousel
this is a bit of a complex directive and
there's some complex angular specific
code in here but notice how I'm
injecting animate and then inside of the
animate KO and I'm calling leave and
calling enter this is the whole purpose
of it there's no animation code in here
at all but the animate service is what
can you add control so it combines the
directive code with the animation code
okay so how can we disable enable
animations on the page well the first
thing you want to do is remove the edgy
animate module and you can do that by
doing animate that enabled and sending
the boolean to true or false next thing
you want to do is if you want to enable
it for a specific element you can get a
whole the elements and then enable for
that element in all of its children and
then the class name filter can be a plot
so a class didn't filter you can you can
sort of weed out which animations you
don't want to run or you do want to run
okay so the animation internals that
with animations if there's a one
animation that gets called and another
one gets called right after it cancels
out the previous animation and if it's a
child animation it blocks the middle the
parent is done and then it caches the
calls to get computed style and there's
a there's a browser specific animation
function called requestanimationframe
and basically what that allows you to do
is that instead of using some time on to
facilitate animations it gives you this
special function that you can call what
you can update the animation code set
and if it uses all of this internally
but what happens we want to test this
out in your own code if you use the ng
mock anim module in your code you get
these two special functions trigger
reflow and trigger callbacks so how do
those work let's take take a look at
some code
there's a lot of test code right here
not going to go into too much detail
about this but the idea here is that we
have an animation that we set right here
called add class and then we want that
capture that animation when the Dom code
updates so the reflow is triggered and
the reflow case basically starts off the
animation and there's another one for
triggering callbacks which will end the
animation okay so what about
asynchronous testing now this this stuff
is really complex and I feel like when
it comes to testing animation code and
unit tests or browsers or whatever
there's really no consistent way to do
so
because you can't really have your
animation called wait therefore every
animation to run and and how can you
guarantee that it has been has been
tested properly like for example let's
say that you had an animation that took
you know one second to run and then he
had 1,000 tests you know that's gonna be
15 minutes of waiting for these
animations to run how could you how
could you check this to see that they're
actually going they're actually running
in the background so like this is an
actual issue that I'm dealing with we're
working on ng animate because we a
change updates to angular how do we know
that that change has worked properly so
Luxor's sure we need a better way to
test these animations out so new ideas
with angular and it's new ideas with 1.3
that we have in mind is to sort of allow
parts and pieces of the application and
into update and so for example if you
click on an element it click on an image
and the next page is a profile page you
can have the image sort of expand and
then that's in the next part that's
something you can't do if website sign
is because the view and the page that
changes is delete it remove from the
page so let's actually look at some new
concepts for the four new versions of ng
animate
so here's a example or allowing an
emissions in JavaScript to have a
before-and-after function that gets
called so you can do animations like
this in a page it's a little choppy
because it's a prototype but the idea
here would be that before the animation
comes up you can do calculations that
you can do calculations after that's one
idea okay cool here's another idea
so the idea here is that instead of
blocking animations you can kind of
combine multiple animations on the same
level together so that we click on here
and you can see that these two things
work together so hopefully this comes
around for 1.3 and then finally the
issue of CSS is that it's too limited
it's returning abused CSS no way that we
can do these extra features like with
the staggering animations and so on but
CSS doesn't really allow us to do too
much because you know it's not designed
for this right so the reason why there
aren't too many features with ng animate
so far is because we can't express them
with CSS and we don't want to put them
into HTML because then it's coupling the
HTML CSS together so if anybody's
interested in like social sharing ideas
are contributing to this let me know
because once again just they're kind of
stuck on this at the moment but yeah so
I have a lot of time for questions it's
actually ended much earlier than I
anticipated
so if you want to see the demo the this
demo code right here and you want to
download it play or anything the address
to that is right here at yale-new PDC
demo and I will upload these slides too
to the USB stick and they'll be
available on the website to download and
thank you very much was a pleasure
talking to everybody here</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>