<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2016 • Appsec and Microservices • Sam Newman | Coder Coacher - Coaching Coders</title><meta content="GOTO 2016 • Appsec and Microservices • Sam Newman - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2016 • Appsec and Microservices • Sam Newman</b></h2><h5 class="post__date">2016-10-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/wlt7nCRWx_w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Sam human I'm the track hose
for the microservices track today you're
in the big room for the small services
there's lots of great talks coming up
throughout today I'm not gonna give the
next speaker too much introduction
because I am the next speaker and that
will just cut into my time which would
be selfish before we go any further you
should have been told by now there is an
awesome app you can go and download the
app you can rate the talks speakers
really love like more notes about
feedback so rather than just the votes
if you could leave a few comments that
would be great
that's also where you ask questions so
during the talk if you ask questions I
will ask myself questions at the end of
the day based on the questions that you
send me
so anyway I'm here to talk about
application security and micro services
and we should probably start off and
let's get a sense of the room find out
who is in here again and get a level a
baseline a level of where we're at
I get affair it's a shared understanding
of who we are so to start off with hey
how many people here are doctors any
doctors different doctors this thought
adopter any of these doctors in the room
anyone can't quite see from the light no
sir no are there any virologists in the
room all the house lights came out that
was lovely is there any sort of
virologists in the room any doctors in
the room no because no one thats knows
about bacteria any bacterial researchers
no okay how many of you know the
importance of washing your hands thank
you yes this is good right I just needed
to check out some basic stuff so we are
not all of us collectively we're not
deep you know we haven't spent years
researching how bacterias travel around
and how viruses are spread we haven't
spent years doing medical research and
cutting up cadavers but all of us know
the importance of washing our own hands
around controlling the spread of nasty
germs and diseases the reason I start
off talking about this is because this
is a talk about application security in
the context of micro services and I have
a feeling that we are with application
security
where we used to be with testing say 15
years ago we used to have this idea as
developers that somebody else did the
testing because testing oh yeah very
specialist very oh yeah real specialist
skill ah oh yeah they're really valued
people uh oh I don't do that kind of
thing no no I have somebody else do that
for me
and over time we realize yes there is
value in having specialists but there's
some base level of testing that we
should be doing for our own application
and yet when it comes to security we
sort of abdicate responsibility we say
oh no no no there are specialists for
that kind of work you have to pay a lot
of money and get someone in to do some
penetration testing which sounds very
exciting I say sound III in but but we
have got the equivalent in the security
sphere of washing our own hands there is
some base level of understanding about
what application security is that each
and every one of us should have some of
you may have been at Jace's talk
yesterday he says if you've got a in one
of the statements he made is if you have
a a system out there on the web it's
easy it's either already been hacked or
is about to be hacked all your system
has no value if you are out there
somebody is going to try and do
something to your system and so many of
the practices that we as developers have
don't set us up well to survive that
inevitability so I'm starting with a
little bit of a G up you can do
something to fix it there is an
equivalent of washing your hands out
there for security but I also need to
scare you some of you may have seen this
map before hands up if you've seen this
before right any of you want to say you
know make it plausible you're doing deep
research into security attacks at work
just go to this website and have it
running on a spare monitor why you
actually you know play minecraft or
something your boss will come over we'll
be transfixed by this map and here's
what this map will show so live updating
attack graph of what's happening around
the world these are various different
exploits being launched from different
places and attacking different locations
it was quite interesting the moment
Australia of sleep nothing's really
happening over there in a moment and in
a minute
there we go I was screen capping this on
my laptop my laptop got very slow while
this attack was kicking off so what's
very interesting you see where they're
coming from with who the targets are
the different vectors these are pretty
indiscriminate attacks these are people
running you know using their their low
energy ion cannons and all these sorts
of things skipped kitties botnets that
sort of work fairly low-level basic
stuff but this is the background of
what's happening out there on the
Internet
hopefully you're not under one of those
points up there but maybe you are this
is a talk about micro services mostly so
I could get you in the room to talk to
you about security so we should talk
about what micro services are of course
and this is what micro services are to
me which is small autonomous services
that work together modeled around a
business domain you may have your own
definition you can write that in your
own book I have a book there's lots of
them outside please buy some I've got
I've got a kid I've got Center
University this is an interesting
context to operate security in we have
this idea that we are breaking up a what
we used to be a more monolithically
deployed system into smaller units that
can be deployed independently and this
is both a blessing and a curse when it
comes to security it starts off as a
blessing in a way because we start to
avoid the all your eggs in one basket
problem we don't have all of our code
sitting there in one place all of our
code all of our processes all of our
data in one location you chop the basket
you broken all the eggs you crack that
one process boundary that one database
you've got access to all the data all
the process what we allow instead is we
can actually look at these things
independently we get to target security
protections independently to these
different units we can look and reason
about the security profile the attack
vectors of an individual's part of our
system and apply the right protections
for that unit not having to worry about
protecting everything we avoid the
problem having a lowest common
denominator we can do things like find
different perimeter models rather than
having one perimeter because you have
one deployable unit we now can have
multiple different perimeters for our
services you might be doing things with
you know software-defined networks and
you know programmable VLANs you might
have multiple layers of different
routing protection systems you could be
running these things on differ
cloud providers mixing services that run
on premise and off premises we have a
huge array of new opportunities
available to you to protect your
application from malicious users for
malicious attacks and this is the good
side this is the opportunity that micro
services give us unfortunately the great
god of micro services gives and takes
away with equal measure because not only
do we have these multiple new
opportunities of how to protect our
applications from malicious use we also
have a larger attack surface area what
used to be in process calls are now
going over network boundaries is a
network that could be observed that
could be sniffed that could be
intercepted that could be malformed we
have multiple machines that we've got to
make sure that we patch any one of these
now potentially becomes an attack vector
and if we design our system without any
protection in terms of how services talk
to each other if I crack into one
process I may well be able to exploit
your entire network of connected
services the other problem with security
is that we often lack a sensible
framework to reason about it and we
actually put too much of our effort into
stopping bad things from happening and
I'm here to tell you that the bad thing
will happen and so you've also got to
give some thought to how you handle that
situation I was until very recently a
consultant thought works I spent 12 many
happy years now I'm now in a startup but
even so I know how to have a good
quadrant every now and then and I'm
going to share with you a really useful
model that we used to the thought works
and thinking about security we're going
to use that to look into what can we do
in a context of micro services around
application security to come up with a
bit of a balanced approach to dealing
with application security and we start
off where most people start and stop
their journey into security we're going
to talk about prevention this is
stopping the bad thing from happening
but if something bad does happen if our
prevention mechanisms don't protect us
we also need to talk about detection do
I even know a bad thing happened once I
know that a bad thing has happened I
then need to know how to respond
and once I've responded I
need to know how to recover and you need
to be putting effort in all of these
places maybe not the same amount of
effort but you need to be able to be
thinking about a balanced approach to
application security and this is
something that everybody can be part of
let's start talking about prevention so
many years ago I was working at an
organization that had just started to
take a bit more serious approach towards
information security they set up an
InfoSec team and InfoSec team started to
look at things like premises security
this organization had multiple offices
around the world and they were thinking
okay we've got three different
approaches to how people gain access to
our premises and they started suggesting
you know what we need to do is actually
have cameras on our on the front doors
of our property to deter people from
coming into our premises and in if
something does happen we've got a chance
of finding out who the actor was and
maybe understanding what the impact
might be now this organization was sort
of a fairly you know had a really lively
internal debate about these sort of
morals of polling sort of CCTV on the
front doors of these premises
they say this about invasion of privacy
is because you don't trust us bla bla
bla and this went on for you know a few
weeks and then someone rather meekly
stuck their hand up and said her before
we put CCTV cameras up on our front
office in I think it was Melbourne
because we put a front camera on our
front door she'd be she fixed the lock
on the front door first maybe turned out
for many years the front door lock had
not closed properly the door would often
be left open while people went over over
the home overnight and anyone could just
walk in and is push the door open this
is often the problem with prevention we
see a potential problem and we spend a
lot of effort fixing that potential
problem without realizing there are much
easier exploits that someone else could
could use elsewhere that might be much
easier and cheaper to fix we don't
really have a rational way sometimes of
approaching these preventative
mechanisms aside from the privacy
implications of the CCTV camera it would
have been much cheaper to spend maybe a
hundred dollars getting a locksmith in
to fix
door lock there are a bunch of different
techniques out there for giving you a
rational model to think about your
prevention of where you suspend effort
and most of the time when we're talking
about prevention what we're talking
about is raising the cost of an attack
so high that a malicious party would not
want to use it because the benefit to
them is much lower than the amount of
effort that they're going to incur right
that's normally what you're talking
about
Bruce Schneier many years ago you know
in a paper report it was an article for
dr. Dobbs back when dr. Dobbs do the
thing talked about this idea of attack
trees it's a quite a simple method there
were others out there but it gives you
an idea about how you can start thinking
about prevention in a more rational
sense so he starts off with some goal
that you're trying to achieve in this
situation we are going to try and open a
safe so then you start enumerated the
different ways in which a malicious
party could open your safe well they
could pick the lock okay
however what else could they do well
they could learn the combination so or
they could cut it open how would they
learn the combination well to learn the
combination they could find it written
down or they could get the combination
from the target it will gets a bit
noirish now how would I get the
combination from the target well like a
black male there mike has threatened
them and I could bribe them suddenly
InfoSec seems like a really interesting
pastime right to get to worry about
people being blackmailed and friend I I
worked at a rather large bank in the UK
and your login name was a nine digit
number there's nothing to make you feel
at home like having your login name as a
nine digit number how many nine digit
numbers can you remember in your life
not too many these were so long that
people would write them down on a
post-it note and they would also write
down their passwords because the
password policy was so complicated and
obviously you might as well put them
both together and this high street this
was investment bank you could actually
walk on the streets around each cheap
look through the windows and see
people's as two post-it notes with both
the username and password on there so
you know before you worried about
premier security and bioinformatics are
accessing premises maybe stopping people
from writing things down is good so on
enumerated your different attack vectors
that you can install applying weights
how how hard would it be for an attacker
to use one of these axes and maybe you
decided actually picking a lock is
impossible because we've got the best
lock you can but actually finally get
written down is really quite easy so how
do we avoid people writing it down in a
place that can be found this is useful
you start thinking about the different
attack vectors that people can have you
start thinking about how easy it is for
somebody to exploit them and then you
start looking at what you can do to
cheaply increase the cost of that attack
vector such that no malicious attacker
could use it think about an example
microservice system those of you read my
book and I often use this domain as fake
domain of the music web shop and so here
we are we have a bunch of services in
the perimeters what the boxes we start
looking at this and start thinking about
well how could people gain access to our
stuff what the opportunities
straightaway we start thinking about
more Transport Security that thing I
mentioned earlier we've taken what used
to be in method calls there now Network
calls those things are potentially much
more vulnerable to people so what can we
do about protecting our transport
security should probably start with the
basics right we all now are prey in the
world of HTTPS Everywhere hands up is if
if in your corporate network all of your
in corporate network goes over HTTP
there's like ten people it's a nice idea
we don't tend to do it though do we
right this is this is the low-hanging
fruit people right this really is the
low-hanging fruit we should we talk
about why I hate CS can be useful
because it's not a panacea
what was it give us it gives us server
guarantees this can be useful it tells
us that the thing we're talking to is
really the thing we think we're talking
to that can be useful a really smart
attacker might stand up a service that
looks like your service because the API
is a very simple I can write something I
just intercept we were traffic right so
now we at least know when I make a call
that I'm actually talking to the person
I think I'm talking to we know that the
payload hasn't been manipulated the
middle attack hopefully but we have no
client guarantees so I get inbound call
I don't necessarily know who it is does
talking
to me unless I've applied some other
auth scheme on top of that and the
certificate management at the server
points can be quite painful the the
process of issuing certificates renewing
them especially in a world we are doing
automatic deployment of services can be
painful now some of the certificate
management stuff is a lot easier to deal
with now how many people here have heard
of let's encrypt excellent this is
fantastic
look year and a half ago I probably had
about ten people and now two-thirds of
this room probably know about let's
encrypt so let's encrypt sis to be clear
are a free automated certificate
authority people fixated straightaway on
the word free these people will issue
you a HTTPS certificate for free and a
good one at that and people thought
freeze grapes that's not the interesting
thing the interesting thing is the word
automated because they've also provided
in instead of this now this actually
protocol a a tool chain for
automatically creating issuing and
applying and renewing certificates
drastically lowering the barrier to
entry to automatically issuing when unit
if occurs as part of a normal automated
deployment process it's a very very span
a very easy way to get going so I would
encourage you take a look at let's
encrypt if you're looking at reducing
the the Barrett entry if you're an
Amazon Amazon has similar support with
its own certificate manage and stuff now
those excuses around complex automation
around these stuff is kind of falling
away okay so HTTPS is good I guess it's
so far maybe maybe we just decide to
like on backwards
maybe we just decide to adopt HTTPS
within our network as a default position
we can and once you've automated it once
it's done for everybody let's move
forward okay what next well what if
actually we need a higher level of sort
of certainty about say combined
guarantees like when I see a client
cause they won't know who that client is
well then we can start thinking about
things like client-side certificates so
now you know a client has some sort of
certificate they use that to sign the
request they send the server is able to
say yes the person who did that really
does have that's difficult therefore I
have some level of certainty as to who
they are this is a lot better we now
have client and server guarantees we
know that somebody's in pretending
to be us problems of course client-side
certificates if you thought that
server-side certificates of HTTPS were
painful oh my god are these things more
painful I have met people that have
spent months if not years trying to
automate PKI infrastructure using chef
and puppet and stuff like that many of
them have gone insane
more recently Netflix did open source
their lemur framework which is a
pluggable framework for doing automated
provisioning of PKI infrastructure the
reason automation is so important the
context of micro services is because you
do not have one thing anymore you have
multiple things and when you have lots
of things you don't want to have a sort
of linear scaling of manual work you
need to automate to get rid of that
automation becomes incredibly important
in a micro service environment to the
point where I would actively not use any
technology that could not be automated
so lemo is sort of still failing you I
haven't heard of many people expanding
it beyond the initial footprint of what
Netflix use it for but that's
potentially showing us what the future
could be for this stuff and maybe fir
things like that I might use require
client-side certificates force a trusted
external parties this particular example
I'm sending a royalty payment data to an
excellent third party I really want to
make sure that I'm not sending it to the
wrong person and so an additional level
of guarantees might be required there I
did sort of mention the word author
there there's client-side and
server-side guarantees and that just
says yes this program I'm talking to
really is the program I think I'm
talking to it doesn't really do anything
beyond that it doesn't actually say that
program is really allowed to do what it
says it wants to do this is this
difference of authentication and
authorization of 40 Aaron was good to be
doing a talk about that today and he
hasn't been able to come um but we have
this other level of authorization
problem oh yes the customer service that
is the customer service talking to
inventory service and they're asking for
some stuff should they be asking for
what they're actually asking for again
we can think of the simple stuff we're
thinking about our perimeter we can
think of things like a wharf so I have
some mobile token that I use to
authenticate with my application I might
use some base form based authentication
and so there I am I arrive at the music
web
no yes Sammy's logged in and that really
is Sam and he's allowed to see Sam's
information that's great
and then the music webshop decides to go
and make a call downstream to fetch
information from the user service and so
Ivan to Kate admire through sequential
the music webshop says yes you're good
to go and it's made a call downstream to
another service what a lot of people do
in this situation
is they assume implicit trust the user
service in this world says well I'm just
going to assume that any calls that have
come to me from the music webshop I've
actually been verified that those calls
are allowed to be made you're putting a
lot of reliance on your upstream party
what you're opening ourselves up to here
is something called the confused deputy
problem it's actually a quite complex
problem in security engineering it's a
situation where you can trick an
intermediate an intermediary into asking
for information you shouldn't be able to
ask for so a simple example I log in as
Sam I then ask the music web shop for
information for Praveena and the music
web shop doesn't revalidate that I'm
allowed to do that it makes a call
downstream and pulls back praveen's data
now that is quite a tricky problem to
solve historically people have tried to
solve this using things like nested
sam'l assertions they have also gone
insane so don't do that
increasingly what we're seeing the use
of things like JWT
JavaScript web tokens that's a way that
when you do the initialization you get a
token back that represents your
credentials for downstream calls so when
the music web shop makes a call on your
behalf to say a downstream user service
it passes your credentials downstream
the downstream service can validate that
not only are there valid set of
credentials but can also interrogate
those for what things you're allowed to
do so effectively passing those
credentials on through your chain that
becomes more challenging when you're
using say asynchronous we different
services potentially you have to find
some way of passing those claims through
but the system we're using at the moment
we're using JWT for this purpose we also
have to think of course about data at
rest here again we get some nice
benefits at micro services because data
at rest is have sort of a complex
problem when we have a large monolithic
database
you often don't just decide to encrypt
the whole thing because that Houston has
performance implications and so I've
seen systems where certain tables and
databases were encrypted and the rest
were not this then becomes interesting
because I've seen situations where
although our tables data was encrypted
you could actually get information
leakage from the foreign key
relationships between those tables and
other tables and so you can often make
mistakes that way you always have the
problem of course with encryption of
databases which is where you put the
keys and but of course with the
microservice system if your practice
you're following the approaches that I
recommend of keeping you know your data
inside your service and not sharing
databases you could at least just say
you know what the only data at rest that
we really are super care careful about
is actually the stuff that I use as
service has so what we're going to do is
we're just gonna encrypt that whole
database and the rest of the other
systems will just leave a lot and we'll
keep them simpler so again we get to use
micro services for us little aside when
talking about prevention
we should put just mentioned docker
because micro together some of you may
have seen this old paper now from a
while ago but Banyan ops did some
research on docker hub and found that 30
percent of all the docker hub images
contain critical vulnerabilities these
weren't situations where people were
maliciously going and poisoning docker
hub people just created images on docker
hub and it didn't update them they
didn't patch things and there are loads
of organizations that are taking images
from docker hub and then deploying their
software on them they're not checking to
see if these things need to be updated I
would suggest that running stuff for the
docker hub on your public on your
production systems it's sort of akin to
finding a USB Drive in the in the gutter
plugging into your production systems or
copying and overthinking yeah that'll be
right so I wouldn't necessarily
recommend using pass staff the docker
hub their tooling and the trust molds
around us are improving but until then I
always write my dock recipes from
scratch for prod systems we are around
prevention starting to get better a
while a talling that we can build into
our pipelines these prevention
mechanisms a lot of tools like fine
Bolton checks tile will do some level of
looking at secure coding practices
you've got similar tools for Ruby and
Python out there they can look at a code
and say you're doing something that may
not be sensible here and those are
starting to happen more automation in
the security space is still lacking
somewhat a lot of the traditional tools
in security space don't really lend
themselves to automation starting to
change I think I think we're seeing the
same thing we're testing no mercury used
to be the testing tool and then when
developers decided that they need to
start doing testing they looked at
mercury and thought oh my god this thing
is horrendous you can't automate it it's
a very expensive and selenium was
created selenium was called selenium
because it's the antidote to mercury
poisoning believe it or not I think it's
starting to happen our security tools
but they will some from some frustration
in this area and of course I do want to
say when we talk about prevention we
should talk about the basics how many
people here patch their production
servers once a week once a week how many
of you perhaps your production service
once a month how many of you don't know
how often you patch your production
systems yeah more people right
this by far will be your biggest attack
surface area for most of you I would
imagine a large amount of the
indiscriminate attacks out there a lot
of those things I was showing you
earlier from that Norse map those sink
just flying around are just you know on
mass exploits looking for unpatched
systems and often just one patch system
on your network can be a way into the
rest of your your your estate there are
tools out there like tripwire and art
garden spacewalk and things that will
look at your your premises and look at
the patch level of things the key diode
guys are doing some great stuff around
docker actually looking at patch levels
of machines this that's getting better
but just basic stuff here please people
patch your stuff right let's move on
let's talk to about detection we've done
our best to stop a bad thing from
happening but sometimes a bad thing does
happen and then how do we know it even
happened in the first place first things
first
keep around when you do need to apply
patches look for your CV ease subscribe
to service like qualies know when
there's a new CV on your Java stack that
needs to be updated this isn't just good
because you no need to apply a patch but
you know that an exploit happened some
of you may remember shell-shocked this
was a an exploit that was in bash that
was their free a number of years the
interesting thing I was talking to one
of the internal ops people at
ThoughtWorks and and he was saying well
the thing is we know we were vulnerable
for a good two-year period because
everyone was vulnerable to shell shock
for a good couple of years what we don't
necessarily know is whether or not we
were exploited but when you were
exploited by shell shock there were
traces that you could look through in
your systems and actually what we did
was we found we actually had our logs
aggregated and into one location so we
could go and look and see if we saw any
traces of the shell truck actually being
used and actually logging is one of the
best things that you can do in terms of
making it easy to detect if if problems
have occurred if you've had attacks
aggregate all of your logs pull them off
of the machine stick them in one central
location you may also want to think
about retention policies and how long
you keep things for a lot of teams I've
worked with only one to keep their logs
for say a month or so because they get
too big if you actually want to
understand if you were affected by an
exploit two years ago you may need
longer log a lot times so yes by all
means run something like the elk snack
on your own premises run something like
Sumer logic or paper trail or of course
the the new puppy oh you should go talk
to the guys around the corner this is
stuff that's useful for anybody the
microservice system it becomes a really
essential tool in detecting security
issues in your systems other things can
help some of the application firewalls
out there like mod security can also
pick up attacks on your system and so
running these sorts of things as
perimeter security detection mechanisms
are very useful I've used snort in the
past which an intrusion detection system
and some of those systems will stop
obviously bad behavior and they'll warn
you about potentially concerning
behavior so those are good things to use
and the context of micro-services though
we do have some interesting questions to
ask a lot of people talk about Michael
as being an architectural style that
gives you options people like options I
get to do lots of things now I get to
use lots of languages polyglots is the
future I'm kind of not so sure for a
number of reasons but in security space
I'm especially interested if I have say
five different technology stacks in use
that's five different stacks I've got to
keep up to date with with the latest
versions of patch it's not only for the
core runtimes and the core libraries but
any community libraries I've now got to
patch I've got to be really really on
the ball about keeping that stuff
up-to-date and understanding how to
write software on this technology stacks
in a way which is secure this is art you
know I'm adding a lot more work so there
is a there's a question here it's about
whether or not polyglot micro services
systems will be less secure than their
so the systems that maybe have one or
two technology stacks the flip side to
that is if you've got really good at
managing your polyglot environment you
might have a different sort of property
which is now you've got more things that
have to be broken a malicious attacker
will not just have to now find and
exploit that works against you a Java
stack but also maybe against your Ruby
stack or your go stack that is a puzzle
for me and I'm not quite sure what the
answer is I do though see a general
pattern micro service organisations that
they start off with a high degree of
polyglot ism and over time that normally
subside especially for teams that are
over about 50 P organizations have more
say 50 developers or so SoundCloud saw
that pan they start off a large number
of language and over time they're mostly
now a scarlet and closure shop mostly
because they want to reduce a sort of
overhead for people having to
re-implement libraries and common code
across different technology stacks let's
talk about response so we've found out
something Bad's happened and now we need
to go and let people know and do
something about it the great thing about
response is a great number of examples
of how response has done very badly how
many people here have heard of target in
the US right target big retailer for
people who don't know it they were hit
with a particularly nasty exploits
this was a piece of malware that was
loaded onto the tills and when you
swiped your credit card it would capture
it was a memory resident bit more aware
so it captured the credit card
information as the transaction was taken
this more were then sat it collected
loes amount of credit cards and in an
actual trade to that back out of the
network and something like 40% of all US
credit card holders were affected by
this that's a big deal this is kind of
an interesting example in terms of
terrible response for a number of
reasons unlike many of the large
retailers in the u.s. target did
actually have a dedicated in-house
InfoSec team that team was running
software that detected that this mall
work was installed and when that mall
ware was installed they alerted people
that software detected when that mall
that when that mall where then took
those credit cards and took them out of
the network and they raised the alerts
the problem was inside that organization
those alerts were completely and utterly
ignored it gets worse he actually ended
up I believe being a Congress person who
actually made target make this public
because target found out this had
happened he didn't tell the public most
countries around the world do not have
mandatory data breach reporting laws so
target had to keep trying to keep this
quiet so you had a mass data breach of a
large number of credit cards and one of
the biggest names in retailing in the
u.s. kept quiet about it the CEO
eventually lost his job over this
Home Depot also got hit by exactly the
same breach face recently this was
actually quite good for the software
fire because the finai software did
actually detect this more where was
being used unfortunately what happened
was the InfoSec team wasn't properly
wired into the reporting structures of
the organization and so their
observations were completely enough ly
ignored this is an organization that had
puts a lot of effort into prevention and
detection and no effort into thinking
about what happens when we do detect
something it's a great example of how
not to respond I I really can encourage
you to go and read
Brian Krebs our blog he's found his
fantastic Krebs on security he talks
actually about whole story about how
this thing unfolded and there's a lot of
examples of how not to do things on that
blog comms actually really is at the
heart of this when something bad happens
you need to know what to do have you
even thought about who you're going to
tell who is going to have the
conversation who's going to tell
publicly your customers is that going to
be a CSO do you have a CSO is it your
CTO is it your CEO who's gonna write
that what are you gonna say when
something bad happens how quickly are
you going to get a bit of conversation
out comms are essential ultimately comes
there are some great examples of comms
being done very badly how many of you
heard of actually a lot of people
pretend not to know about it a few of
you have yeah okay Canadian site hook-up
site for people who are in relationships
and so what happened was a hacking group
came out and said we've got all your
data and actually Madison said no doubt
you do we do we've definitely a date and
I said okay you might have a bit of our
data and I said oh no we've got all of
your data
I say you haven't got all of our data
okay you have call of our data okay
that's all you've got but it's all
encrypted you can't read it all right
you can't read it okay that's definitely
all you've got you've just got all of
our data and you can't read it
oh you've also got one of our emails as
well oh you've also got all of our
source code as well
oh isn't that bad and what happened was
a blanket number of denials were coming
out no this data isn't real
no they don't have this information no
it's not the full records no you know
and it went on and on and these denials
came out he's a nice guy
and they stretched the story out by
handling those comms badly for weeks and
weeks and weeks there was always going
to be a lot of visibility in this
particular case because of how salacious
this particular story is but the this is
a classic example of how not to do coms
around a data breach
it was trivially easy for
Ashley Madison to have got hold of this
data breach because it was circling
pastebin and it would have taken a small
matter of time to look at that and know
whether or not this data was accurate or
not a great count of example would have
been that of Tylenol
so tylenol in the u.s. Johnson and
Johnson's the parent company tunnels the
biggest pain medic medication in the
market it was now was a really sad
tragic story many years ago where
bottles of Tylenol were being poisoned
and many people in Chicago died and no
one kind of knew how if this was getting
into the system they didn't quite know
if people were doing it the
manufacturing plant if people were going
into the stores and tampering with it
but Johnson Johnson decided right
straightaway
we're just recalling tylenol from across
the whole of the US we're putting it all
back putting it out of every single
store so the number one brand leader in
pain medication we're pulling from the
world stores we're gonna redesign the
packaging we can redesign the capsule to
make them tamper resistant the recall
cost them over like a hundred million
dollars or so the PR bubble for this was
huge for them they did the right thing
and the public rewarded them they
suffered no loss of market share if it
anything their brand increased because
they went out and they did the right
thing this is an organization that had
their shit together they knew what to do
when a problem occurred he is the kind
of interesting thing when you find out
your system is being hacked
you are not necessarily going to be
thinking rationally you are not going to
come up in that moment with a coherent
coms plan that's why what you should do
is when things are calm have a
conversation what should we say who's it
going to come from let's draft something
now and stick it in Evernote because
when the oh shit moment comes remember
are we talked about this grave was gonna
send it out we'll copy and paste it you
know we'll update it and we'll send that
out that's far more likely to be useful
to you than you try to come up with a
comms plan in the heart of a disaster
like this going on you can also send bad
messages to people inside your own
organization I got into a small amount
of trouble around this particular story
so in you in Australia where I live
Telstra is the big
telco they operate across the whole of
Australia they were sort of the
previously the state-owned monopoly they
had a failure that took out cell and
just had wide access for most of
Australia and they came out very very
quickly which was good and they came out
very very quickly and they basically
said ah it was it was some guy's fault
this statement I love is is a the
employee responsible didn't follow
procedures and clearly that's not a good
thing but I wouldn't want to preempt the
proper investigation it sounds like
you've already done your investigation
and you've decided that guys to blame
will figure out what the right thing is
to do once you had a chance to dig into
detail so this is a great example
straightaway yet the thing to do is to
blame an individual I mean this is just
boneheaded comms you get out quick great
you say we don't know what the cause is
great we blame one person now what do
you think in this point you're the telco
of one of the lot well you of the the
biggest telco and one the world's
largest economies and you have a system
where one person can make a single
mistake and take out the whole network
for everybody
so step one it sounds like your network
is shit now think what happens if you're
a Telstra employee and there are a lot
of Telstra employees out there how do
you feel my CEO goes out and bags out
some guy and you know that everybody
into helps you know who that person is
now don't you I got in a bit of trouble
because I blogged about this and said
that if I was working at Telstra
I'd look for another job and found out
that there was a client of four works
which wasn't great for me for a moment
anyway um the CEO no longer has a job I
don't know if these things are related
but tells we continued to have a
succession of failures after this and
the coms got a bit better about it
afterwards it's pretty worth reflecting
on this blame culture stuff around this
sort of response the the problem I look
at this beyond the fact that you
immediately went and tried to blame an
individual is it's the nonsense of
having a telco who is completely
dependent on one person never making a
mistake in his
context Sydney Decker talks a lot about
systems being to blame when you have a
failure the system allowed that failure
to happen you created a situation in
which an individual making a mistake and
we are all human we have all made
mistakes but you had a system in which
an individual making a mistake allowed
that failure to occur I can thoroughly
recommend his keynote from DevOps taste
and under many years ago Joe Nall spore
says you know finding the root cause of
failure is like finding the root cause
of a success when something bad does
happen when you do have a breach it's
never going to be one thing you are
gonna have to look a bit widely under
the system that you had in place and
allowed those things to happen so you
need to think a little bit beyond just
blaming one person there was a silver
lining to the Telstra story by the way
so one of the things they did to try and
recover Trust is they gave everyone a
free day to day on a Sunday not work day
they're not stupid that'd have been too
useful so he does Sunday when they data
usage was lowest and one guy managed to
do a terabyte of downloads on a on a 4G
mobile dongle which I felt like you know
okay cool least someone got something
out of this whole story so just do a
little bit of prep still a lot have a
chat
have a conversation think what's gonna
happen who's gonna say something what
are we gonna say so let's talk now about
recovery so we try stopping the bad
thing from happening we in stop all of
it
we now spotted the problem and we
handled it properly what do we do next
well recovering from situations the
first thing to say is do you have
backups this again can get more
complicated in the microservices world
now we've potentially scattered our data
into multiple different databases
potentially running on different
machines a lot of the issue is if you've
had a malicious persistent attacker on
your network for a period of time you
may need to roll back state of your data
a long way especially if you've been hit
by a cryptolocker your data's being
captured and encrypted and somebody else
now has the keys backups become
essential those backups need to be
off-site not on your premises some of
you may know the story of
start up a couple of years ago where a
the Amazon credentials were leaked in
the whole production system was wiped
out that's okay we'll recover from our
backups of our backups we're in the same
account I was okay we can rebuild the
system okay Oh elsewhere the source code
was stored on the same account the whole
startup was wiped out in the matter of
minutes just by something getting into
credentials your backups need to be
off-site somewhere and they also need to
work because you've recovering often the
earth what you'll often want to do is
just scorch the earth you want to burn
the whole thing down rebuild those
systems from scratch reconstitute your
data from scratch knowing you've
expunged any malicious party burning it
all down implies that you can build it
back up again that implies automation
again in a micro-services environment
you probably do have a high degree of
automation but this is something you
should practice organizations that use
immutable servers that actually rebuild
their servers as part of every single
deployment are often in a really good
place here because every time they push
and maybe push two or three times a week
they tear the service down and rebuild
it this is just a no-brainer for them
they know how to do this on the other
hand if what you've been doing is
incrementally applying patches and
service releases onto a onto the same
machine for multiple years this is gonna
be quite a scary idea to you there is a
question again with micro services we
have more of these things if this is a
manual process the process of rebuilding
your infrastructure is the process of
reconstituting a backup is a manual
process and now you've got 30 of these
things where you used to have one you've
just made a rod for your own back um
other things when it comes to response
many people are quite good at doing post
mortems they'll write down what happened
in a way and they'll come up with an
action plan very few organizations I
work with that actually go back and look
at them and say did we follow that did
we do what we said we're going to do
it's depressing when you read some of
those post mortems and realize oh yeah
we said would fix that last time and we
didn't and the same thing happened again
go back look at what happened
do it every six months or so
six months since this issue happened
have we really done the things we said
we're going to do because what's going
to happen is at the moment after the
panic you'll come up with your action
plan you'll go to your c-level exactly
we've got a delay some new features so
we're going to go slightly to implement
these security Prevention's they say yep
great that's fine cuts the most
important thing right now and days past
and weeks past and then the pressure
comes back for you to get back to doing
what you were supposed to be doing
before your old features get done and
though that work you're going to do gets
pushed to one side and six months down
the line it all happens all over again
so do look you're all post-mortems so
what I was hoping to do today was to
sort of give you a bit of introduction
almost of what application security is
it isn't just as one faceted approach to
stopping the bad man from coming into my
network even within the context of
prevention it's much more nuanced than
that
so think about models like attack trees
that allow you to think rationally about
the different ways of militias party can
gain access to my system and actually
make sure you spend effort in the right
places and maybe the majority of your
effort in application security does go
into prevention maybe it does but it
shouldn't only go there you need to know
if a bad thing happens you need to know
when you've failed to prevent something
a basic amount of thinking a
conversation with your your higher-ups
about how you're then going to respond
is going to be essential to avoid making
bad calls in the public eye when
everybody's running around in the panic
you always need to accept that this
stuff is going to happen and you do your
best to limit the damage of this and get
better at building systems that are
resilient to these forms of attacks I
hope I've just given you a few ideas
about how every one of you can be part
of making your systems better we don't
have to just offload this to specialists
and say it's not our job we may not all
be doctors medical doctors in this room
but we all know the importance of
washing our hands and we are
increasingly in a world in which it's
not acceptable anymore for us to
abdicate responsibility for application
security and assume that somebody else
is going to do it for us I didn't
mention I do have a book
being translated to the the English
translations available outside I've also
got a blog post I saw a podcaster magpie
talk show calm I interview interesting
people I just had a couple of NASA
scientists on who might be interested
and she'd Bridgette little day so she'll
be up on a few weeks but without further
ado I think we've probably got time for
questions so if you should be asking
questions via the app please do remember
to rate the session I'm just going to
take a look now that's that's the app
and see if he knows ask me any questions
not found yeah see at this point the
track host would leap into action and
would fix his problem for me I was
assigned me out the irony of me talking
about you know security and
authorization when the conference app
logs me out doesn't let me see the
questions I've been asked to track host
page it's all very exciting
I see notes already excellent thank you
it's like you have a few questions so in
no particular order is one thing to view
the logs and another to actually
understand what one is viewing how do we
counter fit this given the million
exploits out there counteract this maybe
it's a million exploits out there I
think it's a very valid point I you know
I you we often I've seen a lot of logs I
don't necessarily make sense to me and
this is true but the first thing is to
say if you don't store the logs you've
known any chance of ever reading what's
in them so I would stall first
understand later in general around this
stuff I actually can't start up I'm
operating out I actually do go through
the logs and purposely I go into parts
the code base I don't understand and I
look in the locks and go what's going on
here
when you first start aggregating all
those logs together it's gonna look like
an unholy firehose of noise and mess
but you won't see that until you get it
into one place so you've just got to
start that process it does become a fun
piece of archaeology who's about
detective work that's often you know
some people say yeah it was a great
tweet recently you know he says I I've
turned my system into a micro service
system so that every production outage
becomes a murder mystery it is that kind
of thing right you would sort of trace
down where the hell things stopped
happening logs are often the best places
to go okay next question
your opinion of Yahoo
after two years of silence about the
world's largest data breach technically
I think Expedia no experience in the US
was the world's largest data breach in
terms of number of Records but yes it's
the big one it's not a good one either
right my opinion of them it's not high
it's not really not high here's the deal
right countries don't have mandatory
data reporting laws a date a data breach
reporting laws the US doesn't I mean
Germany which is the most savvy country
around data in Europe for example
doesn't Australia doesn't the UK doesn't
and so the only sort of incentive for a
company to come out and be open about
this is often the penalties that they
face from the you know your data
protection officers and often the fines
that they can be levied against these
organizations are quite small and so
really the biggest disincentive this
information getting out there is is like
losing public trust and at the moment
the penalties for this stuff is not are
not high enough I think as our customers
become more savvy about the implications
of these breaches I think we'll get more
whole companies to account more I
actually personally think that the law
has a part to play I think organizations
should have to tell you if they have a
reasonable explanation has been
compromised by a malicious party and I
think I think the fact that people argue
against that he's a bit nonsensical to
me okay I did I think that the timing of
it was quite good as well with a
takeover did make me chuckle
you propose using HTTPS between service
requests how do you reason when using
other protocols for communication yeah I
think it's it's a fair point so a lot of
people will use alternative say
synchro's RPC mechanisms over just a raw
TCP rather than HTTP some of those
protocols actually have built-in ways of
encrypting those payloads so it'd be
worth looking into that Google's are
late RPC to technology actually just
uses HTTP to out lahood which is binary
and so you can just use HTTP in fact
it's by default HTTPS Everywhere I've
done stuff with encrypting payloads on
on other sorts of transport but yeah the
more you drift away into other more
bespoke transport mechanisms you're
almost going to have to look at what
they provide out of the box in terms of
protecting them there's not like a lot
of easy answers there okay we see if the
other questions if you still log me in
so can you explain how a sink is so to
do authorization using jmt access tokens
you can't you just need to find a place
to pass that token around in the payload
it's the same as sort of effectively you
don't have the obvious headers to pass
that's for us through with still gonna
need to find a space in your prope low
to pass that genuine to you web token
around and then as long as the
downstream service has the ability to
reinter agait that and we've elevate
that token you should be fine okay and I
think that's all we have time for a
little bit over thank you so much I'm
available on Twitter at Sam Eamonn if
you want to keep sending me questions
I'll try and answer stuff over the
Twitter's I hope this is being useful
and I hope you enjoy the rest of the
conference</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>