<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2014 • Fast Delivery • Adrian Cockcroft | Coder Coacher - Coaching Coders</title><meta content="GOTO 2014 • Fast Delivery • Adrian Cockcroft - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2014 • Fast Delivery • Adrian Cockcroft</b></h2><h5 class="post__date">2015-01-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hvFo3Q2PIQ0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">very happy to be back here I was in over
here two years ago and I was just
telling jazz there was a incident where
at the end of my talk that was mostly
about Cassandra somebody asks me a
question about solid state disks in
Cassandra and the on AWS and they said
well what if these disks we're out and I
go I hope I don't care I rent them from
AWS I don't have to worry about SSD
we're out then I moved on if any of you
have seen Scott Hanselman do one of his
key notes in the last year this has been
turned into an enormous piece of
performance art where he goes on about
it for about 10 minutes but it happened
here on this stage so I'm wondering what
will happen from this time maybe someone
in the audience will write a keynote
yeah maybe it won't all right okay so
I'm going to talk fast delivery
hopefully I'll keep you awake since this
is the after lunch crowd so who am i
what have I been doing recently so this
this is really my summary of my career
in the last four or five years I've been
baffling late adopters and I do it as a
service so that's basically it I was the
cloud architect for netflix i was at
netflix for seven years and i'll talk a
bit in in a minute about what I'm
currently doing but what I got next is
all the different talks i was giving
over that time and what were the
reactions to it back in 2009 netflix
said we're going to go to the cloud and
most people thought we were just making
stuff up there was just you know no way
but we started we ran some encoding sand
back some non customer-facing stuff was
actually running in on AWS in 2009
because we'd run out of space on our
data center for movie encoding in 2010
it moved onto ok we believe you are
doing something in the cloud but it's
not going to work and at the beginning
of 2010 the very first piece of customer
facing code was actually running on AWS
by the end of the year all of the
customer facing code was running on AWS
basically all of the user interface the
website and the API is for supporting TV
based devices so that was kind of nice I
and then there started to be a few
outages and things like that that
happened in 2011 and Netflix kept
running when AWS was down several times
and so people kind of got that in their
minds that maybe this is useful and
maybe it does work but it only works for
netflix and netflix is sort of a unicorn
were a very very unique thing no one
else will ever built anything like this
so that was kind of the summary that was
the year that we took the backend of
netflix and moved it all the Cassandra
and moved all that to the cloud and cut
the links that were working back into
the data center behind everything so it
kind of looks good so for the neck we
moved on a little bit more and people
said well it looks like it scales it's
highly available it looks kind of
interesting we'd like to do it in fact
it kind of looks like some things we'd
like to have but we can't get there from
here it's just too big a jump to get
over so in 2012 Netflix started
aggressively open sourcing its platform
and I was sort of project managing that
process product managing it effectively
trying to get all of the different
pieces out that would make a complete
platform I gave a talk yesterday
afternoon on the 40-something projects
that netflix has so last year when I was
going around giving roughly the same
kind of talk I ran into people that said
okay we're using your code and we just
need to understand it better we're
trying to get our heads around it and I
found a lot of people would really
started piling into the code base that
we'd built so that was an interesting
set of progressions and what I learnt
from the time I was at Netflix is that
speed is the thing that you want to
optimize for now if loose is a small
company with lots of really big
competitors and the way it was going to
survive was by dashing around really
quickly and not letting any of the big
competitors kind of go and squish it
right and the speed of development in
particular of the product is a key
competitive advantage that netflix has
and it's still from all the companies I
talk to it's one of the most productive
companies in terms of you have an
engineer they can get more done in less
time than almost anywhere else I really
have not seen anywhere that that can go
that fast you do that very removing
friction from product development you
take all of the steps out and you do
that with a high trust low process
environment where there are no handoffs
between teams you just self-service
everything that comes from a culture
based on freedom and responsibility that
goes across the entire company everybody
there has the freedom to do what they
need to do but they're responsible for
the outcome right so if you keep making
bad decisions and the outcomes don't
look good now you've got a bit too much
freedom let's switch you out for
somebody different right so that's the
peril built built into this system is
you have to have good judgment you have
to show good judgment and you can assume
that everyone else has good judgment and
there's a uniformly high quality of
people in the environment now to make it
possible to concentrate on the things
that really matter you have to get rid
of all the stuff that is the same
everywhere and doesn't really matter so
we call that undifferentiated heavy
lifting things like running your own
data centers capacity planning all of
that kind of stuff and a lot of higher
level functions so what anything that we
could get a double us to build us to do
we would use and that was basically the
idea now as an architect what I was
trying to do was rather than having an
architecture review board where I said
you know everyone came in and we had
projects and I had to approve everything
we didn't work like that what I did was
I tried to dig out the things that were
working and spread them around and talk
about them so what I was really looking
for was the simple patterns that worked
and then get people to build tooling for
it if they weren't already and to tell
everybody to use that tolling if and
then try to get people to not do the
things that didn't look like they were
working so that that was basically
spearing it and an emergent architecture
rather than imposing an architecture on
everything else so most of the
architecture of Netflix is the work of a
very large number of people and I
sometimes get credit for inventing
things that are not nothing to do with
me there are some parts of the
architecture I had a lot to do with
but in general what I was doing was
gathering all the good ideas and
organizing them in explaining them back
to everybody else one really interesting
way of doing that is to take your
architecture go to a conference like
like the go to conference and present it
to people has two good things one is you
get comments back to see whether your
ideas are good the other one is that
other people in your company see that
you did a talk read the slides watch the
video and the answer it's actually a
very strong way of influencing what
happens in your own company because
woods that are published outside have
ten times the weight of you sending an
email internally just the way people's
minds work like if you write something
in a book and you say it to people and
you write it in a book the book carries
more weight because it's written on bits
of paper and you went through the
process of doing that so things do have
it more bait now the other thing is the
other thing I learned was that you can
do impossible things instantly things
you can take cloud and just use it to
speed up the way you currently do stuff
take whatever you did in your data
center and just implement it more
quickly and you know sort of copy what
you did but the interesting thing is
when you do something that you wouldn't
dream of doing in your data center let's
say you know I think we need to try
putting 50 machines in Brazil for a few
weeks to see if that works right let's
go hire an entire team in Brazil ships
and machines there that's not happening
right you fire up some machines on AWS
takes ten minutes you try out whatever
you wanted to do you shut them down
you're done right you can try
infrastructure experiments on a global
scale from you know just your laptop
here without involving anybody else
that's incredibly powerful we also
created a two hundred terabyte
solid-state disk distributed database
now 200 terabytes of SSD was created as
a we were walking out of a meeting I
said we really need to benchmark this so
we went and set up a machine actually
the other manager went by an engineer's
desk and she created that in 20 minutes
right that was in six data centers on
the east coast and west coast of the US
and it was just provisioned and then we
did some benchmarking for a few days
then we shut it down again right so
if you have an IT ops department you
know go and ask them for 200 terabytes
of solid-state disk sometime and see
what answer you get right we do have a
large enough amazon account that we
could get 200 terabytes of SSD on it so
that may also be a problem alright so
what's happening out in the rest of the
world well this is what Enterprise IT
looks like systems Simon worldly first
of all they ignore things and then the
rest of the world starts to adopt it so
they say no me since I think of things
like iPhones and any other technology
basically and then the rest of what
really starts doing anything I said no
damn it and then oh no and then oh crap
that we have to do it so Netflix was
really bit ahead of this so in 2009 we
were really ahead of the cloud rest of
the world started catching up and
copying it and the big old enterprises
were still going no no no we don't want
to do cloud well what's happening now is
we are actually at this point this point
here where enterprise IT is sort of
colliding with cloud so here's mike's
twitter icon is a cloud unicorn and this
is where i am now I basically I have a
new job and it's really at this point
where Enterprise IT is trying to adopt
cloud and continuous delivery and DevOps
and update all of their systems because
of mobile and Internet of Things and
competitive pressures of trying to get
stuff done quickly and all of these
things are causing enterprises to sort
of go through a huge upheaval and
there's a massive investment going on as
they reach all everything so that's
interesting from a venture capital
company where I work now they're trying
to forget which startups are going to be
the ones that make a lot of money in
this new wave of technologies the timing
was good as well so because this is a
year or so ago enterprises were kind of
still tinkering around doing experiments
but but a large number of them have over
the early part of this year they adopted
a amazon as a primary supplier a
strategic vendor right so they get this
list of strategic vendors you've got
your IBM and oracle
and Microsoft and VMware maybe and then
you now have a WS as a strategic vendor
for most Enterprise IT companies and
that is a huge change because now they
haven't necessarily finished their roll
out but they are on the way so this is
the this is what's really going on here
this is this has been the year 2014 as
the Year enterprises just got over it
and actually started building cloud so
what happens when you when when you
start disrupting things there's a
problem here and this is a good summary
for him lots of people have said this I
think Mark Twain said it as well but
what the quote thing said that Will
Rogers said it first so isn't what you
know isn't what you don't know that will
give you a problem it's what you know
that isn't so it's the things you think
you know that aren't actually true and
the problem with incumbents and
enterprises is they think they know
things but those things aren't true
anymore and that's where you get the
opportunity as a start-up or somebody
with a new idea to come in and come in
with a different assumption so this is
really what separates the incumbents
from the disruptors it's the assumptions
they make and it's the optimizations
they have in their business model that
they based on those assumptions so you
optimize your business model on the way
the world looked five years ago and you
have multiple billions of dollars of
revenue and you say well why should I do
this thing over here because there's no
money in it right it turns out that
those things that have no money have
loaded developer adoption they're going
to be the next wave of applications so
it's just look at one assumption this is
the assumption that process prevents
problems if anything ever goes wrong
let's have a rule that says you're not
allowed to do that anymore right let's
have a process step and let's have a
gate and a check and you know so you get
your company HR manual is basically a
selection of scar tissue it's like
everything that anyone ever did wrong is
somewhere in that HR manual and your
development processes are every time
anyone crashed or blow up production or
have anybody complained about something
you'll have a rule that says you can't
do that anymore so you get these scar
tissue the
slows you down if you see some you know
you know an aging athlete right somebody
who was an athlete in their 20s you look
at them when they're 40 or 50 they can
barely walk right they are so covered in
scar tissue their joints are worn out
they're just too slow so what you have
to do is build processes that don't have
that scar tissue so how do you do that
now there's sort of two groups in the
audience I assume there's probably a few
of you working for sort of start up a
fairly fairly aggressive companies that
are doing agile and are on the bleeding
edge and there's a few of you working
for big old companies enterprises banks
government departments going this like
cycling your Adrienne's an alien from
another planet so this is this is the
book for the for the people that need to
convince their management who's read
this book people a few of you this is a
novel it's actually a horror story and
about DevOps basically it's about a
company it's about to go out of business
and it's just a story this guy turns up
to work one day and his manager and the
CIO her both quit and he's now the
senior ranking guy in IT and he says the
CEO wants to see him right oh by the way
Wi-Fi is down and they've corrupted
payroll and the developers and the
security team and the operations people
are basically having pitched battles so
pretty typical of a large enterprise and
the first half of the book gets worse
and worse at some point the the security
guy basically loses his mind and goes
around they find him drunk in a ditch
somewhere so but the second half of the
book gets better due to the magic of
Kanban and DevOps and all those cool
things anyway so let's look at this
process what does product development
process look like in a big enterprise
well to make sure everything when
nothing can go wrong you have a
waterfall you have you know I a business
need and to ensure that i really do have
business need I will write documents and
I will spend weeks writing these
documents and then I will go and have
meetings with management and spent weeks
finding a time when all the managers can
get in one place to actually look at
these documents and have to make some
arbitrary set of decisions and then you
have to go and argue with some vendor
ism by some hardware you've got to
develop a it's probably about two days
worth of software development somewhere
in this year-long process if it takes
weeks to write the spec so then you
deploy it and it keeps getting problems
you go back and forth and then finally
the customer says it sucks we hate this
and you go back to the beginning and you
find that the product manager is no
longer there the development seems
working on something else and there
isn't any sense of iteration here you've
got this thing you have to start a
completely new project and justify it
again to fix the thing and do it again
so quite often they don't get fixed so
you send it with bad products so let's
see if we can speed this up using a
little bit of cloud as well as some
slightly better processes so let's take
a piece out of the middle then chop that
out and say we're just going to go
straight from business need to
developing the software and this is kind
of a typical you know too weak to a
four-week sort of agile process sort of
scrum like thing so the product manager
works for development team they develop
some code that gets given to QA who
integrate it the work from all the
different members of the team operations
stick it in production in the BI team
measure whether it works and you can get
around a loop here that actually is
reasonably productive so now it looks
like this maybe it takes a few weeks to
go around this loop but when you get to
back to the beginning of the loop the
product manager is still there the
developer is still there and you can
actually get little course corrections
in there so that's really the key thing
and to do that you use you know clouds
either public-private whatever although
eucalyptus just got bought by HP so that
has to change the logo on that one let's
keep updating my slides as people keep
buying other people but this is section
in the middle here that's still pretty
slow so let's try and speed that up and
instead of just working at the
infrastructure level let's try and work
at platform level so we'll replace that
with a platform cloud and now we've got
we're basically doing continuous
delivery at this point because we now
developing features with a developer
using a platform and you can go around
this loop much more quickly you've got
kind of got rid of the hand
two operations because operations
operate the platform but there is a P is
for the developer to use the platform
and that's what a platform as a service
is really think of pa's as developers
that no longer need to talk to
operations people to get their work done
you've removed a bunch of handoffs so
this is much more quick much quicker and
this is kind of what Netflix works how
Netflix works so you have your future
development you use Heroku or cloud
foundry or Google App Engine or Netflix
open source projects or apps error or
darker or continuity except that Sarah
just got a major investment in this sort
of kind of owned by ericsson now and
continue to just change the name to cask
for some reason I'm quite sure why
continuity's a pass for big data
development it's sort of HBase as a
serpent Hadoop as a service ok but if
everyone's building the same apps over
and over again because everyone has the
same HR problems and the same kind of
stuff then why build custom versions of
them so we can replace this with SAS or
business process as a service and we can
move along to just we have a business
person doesn't need to talk to a
developer say a sales rep fires up
Salesforce enters his information into
it now he has an application there was
no developer involved in the thing so
think of SAS or as the business end
users that don't need to talk to
developers and you can get stuff done in
minutes you can get stuffed near minute
seconds if you change it it's ours
whatever Salesforce is the best known
one of these one of the companies I've
been working with because battery
ventures is invested them is mendax
which is sort of business process app
builder platform is a big data sort of
build it yourself by the down lists over
there's thousands more specific ones so
it's just summarize going around this
loop we want to do continuous delivery
and get around this loop as fast as
possible so to start with we're going to
try and innovate faster so we're going
to build to measure customers see the
land grab opportunities make see
competitors make a move you want to
respond to and see customer pain points
that they're prob things they're having
problems with maybe your customer
service team says where we had four or
five customers hit the same problem this
week so you go and figure that
and then you want to analyze what to do
about it and model some hypotheses about
different different remedies you've got
different options you could put in there
that's really where big data comes in I
went to answer a question that nobody
has asked before and I want to answer it
as quickly as possible so that's what I
think big day so the value big data
brings through an organization that's
why I could dupe is good a sort of
unstructured data you can just make your
cluster bigger until you get the answer
soon enough the next thing is plan a
response just do it tell other people
you're doing it because this is just a
feature and this is just a developer and
we didn't have to go and ask management
for permission to roll this thing out so
that's the culture getting out of your
way and then finally use cloud to deploy
incremental features they get
automatically deployed around the world
and you launch an a/b test to see if
this new thing is better than the old
thing typically right so then you
measure customers again you go around
the loop again and when I gave this last
week just pointed out that the actual
odor loop goes doesn't just go around
the loop in one way so we've got a few
more place you know you're occasionally
you while you're orienting you go back
to observing and when you're deciding
you go back to orienting or you go
backwards for me so there's you go back
and forth a few times it isn't just how
fast you go around the loop it's how
fast you navigate through this sequence
and get something done but the ACT part
is where you change the customer
experience and you want to do that as
quickly as possible but also by you know
it by going back and forth here make the
best decisions so what does that look
like if you have a small team of
developers this is kind of a typical
thing where you have a release plan you
have a bunch of developers and the QA
team or integrates it and then ops
replaces the orbit than you that's a
pretty standard monolithic deployment
the problem with it is if you get a bug
in found in QA it has to it blocks the
whole release you have to go back one of
the developers broke something so they
have to go fix it all the other
developers code doesn't move forward yet
and then you get to operations and they
try to roll out the new release and it
doesn't work and they have to
roll back and they wrote back all the
work of all the developers just because
one thing was broken and this gets worse
and worse if you have a hundred
developers you know one thing block one
developer can block 99 of them because
you've got to wait for everything to be
ready and you keep rolling back and
forth and it gets harder and harder to
get through QA it gets harder and harder
to get production to work so everything
takes longer so what people generally do
here is they just make the release
cycles longer because it's painful so
we'll do it less often with just the
wrong way around what you want to do is
do it more often but what what you can
do I mean this is the best way to start
if you've got a small number of
developers and you're just building a
little monolithic app to get something
done you're iterating on your business
model you haven't figured out what
you're doing yet this is the right way
to start but at some point you have to
scale up a bit and that looks more like
this you have several product managers
and you have several release plans and
you have developers working in different
languages each building independent
systems that are deployed separately so
you've got they're all randomly
deploying whenever they're ready they're
using some kind of container to just
wrap it up so your platform knows how to
deploy a docker container I don't care
whether that docker container has go in
it or Ruby or Python or PHP or whatever
right what Java doesn't matter right but
you say your platform just automates
that and you but the other thing is the
old release is still running come back
to that in the next slide now you get a
bug in this piece the bottom one and we
just redeploy that one then the rest of
the system was already out there so a
bug in one developers microservice does
not block the others so this is why
microservices are interesting this is
why they're starting to get some
traction partly that the tooling for it
is getting better docker in particular
is helping promote the idea and also it
scales with large teams as Netflix now
has sort of five six hundred engineers
and you can't do a monolithic deploy
with that many engineers it's just too
big the other thing is more diverse
platform you want to basically try out
new technologies and with the monolith
it's harder to do that so I'm gonna go
look at the non destructive thing here
so this is sometimes called the
immutable code pattern you develop code
you do a build you put in production and
you never update that machine again that
Tanner was just running and you can what
the only thing you ever do is delete it
and replace it with a new one right this
is very different to the model we use
puppet or chef or whatever to change
stuff in production now they're
obviously configured and there's data
that changes in them but the key thing
is the code is immutable you route
traffic around to make sense of what's
going on so there are a be tests there
are feature enables there's version
routing you can have 10 different
versions of a service in production at
once and just route different different
flows of traffic to different ones to
get the different behaviors that means
your traffic routing system gets quite
complicated but there are tools for
doing that and the asgard console from
netflix basically automates dealing with
all of that for netflix developers so
that makes it quite easy so the first
thing you first person to use this is
basically testing in production you
stand up a new service and nobody's
talking to it so you could say I could
stand up a piroca nice of code in
production with no impact to anybody
right that's safe to do that and then I
connect to it see if it works if it
works for me maybe the product manager
has a look at it if he likes it then
turns on the turns on a test cell and
you know 50,000 customers will see the
new code and compare against the old
code and everything sort of moves
forward so that's the kind of tooling
that's built around that finally you
remove the old versions and give
everyone the new code so what we tried
to do here we're basically speeding up
change by reducing the cost and the size
and the risk of that change and doing
everything much more often so that's the
key thing and this is very disruptive a
lot of big companies are finding that
their competitors are doing things in
this way and they have to keep up and it
isn't it doesn't give you sort of twenty
thirty percent improvement it gives you
100 x things that used to take you know
six months are done in a couple of days
things that you know it's it's
ridiculously quick once you get
everything else out of the way and that
speed is now the benefit because the
cost of software development isn't
really that high the cost of hardware
isn't really that high historically the
cost of delaying your products entry in
the market is far higher that's that's
the trade-off that's being made if you
can get a product to market
or two earlier than somebody else you
can capture a market and that's the
really powerful value and the cost of
doing it is is something that comes you
get a much more revenue to pay for
things okay so talk bit about
microservices so let's do a quick
definition on that loosely coupled
service-oriented architecture with
bounded context a lot of people say it's
just another SOA we've seen that's the
way before it's all hat well what do I
mean by loosely coupled is that you look
at it backwards if you have to update
all your stuff at once it's not loosely
coupled right loosely coupled means i
can update any individual microservice
independently of the others and that is
what gives you the ability to roll
forward rapidly at different paces you
know some people are updating once a day
some people at dating once a month
whatever doesn't matter and the bounded
context comes from domain driven design
by eric evans who if you've been to
enough of these events you've seen our
give his talks you want to you become
incredibly productive if you only need
to know a little bit to get something
done right I don't need to understand
the entire system to make my piece of it
work because i can write a micro service
that uses the language i know and it has
interfaces to things that I know about
that are around me but I don't need to
understand beyond that this is the same
way the applications are developed think
of developing a mobile app where you're
using lots of our external services
you're typically talking to sort of the
Facebook API in the Google API in the
Twitter API and all these different
things and you don't get to go and have
a conversation with Google about the
google maps api you just use it right so
all of the other teams in your
organization become like api driven in
the same way that external companies are
api driven so you just need to know how
to use them you assume they're stable
but you assume they might go down
occasionally so you put a bit of
defensive code in there right so that's
when you get into this bounded context
and it's just one or two people working
on a very single function piece of code
you can build it incredibly quickly
because you don't have to interact with
lots of people you doesn't take you
don't have to learn too much to get
productive
so how are we doing this we're
separating concerns with microservices
and a lot of this comes down to the way
you organize your your company you've
got to build a sort of the DevOps
approach is to build an end-to-end team
that owns everything about a particular
service so in the micro service you'd
have a product manager or maybe a line
manager that owns that service you'd
have the developers you'd have the
people that run it in production are all
part of one team and that's the only
thing they do right so you build your
company by using Conway's law backwards
you basically let your company out in
the way you want your code built so you
assume each team will build some number
of micro services and typically
gengineer will build a series of micro
services and that's the so you get your
software architecture and you put it in
your organization chart so the other
thing is that microservices not really
about micro meaning sighs its meaning
micro function just if they do one thing
at a time and you can even build you
just don't really care what the
container is netflix has been using am
Isis containers that's just because a
few years ago that was the best thing we
could do I think nowadays Dockers the
right container it's just things in
seconds that building am eyes will take
minutes to do and the other thing is
capital rather than pet so people heard
that analogy it just goes through it a
bit so yeah I left home about four weeks
ago and there's a cat at home that's my
pet right pretty I think it's still
alive my son's been looking after it is
pretty grumpy when we get back but you
know I care about that individual cat
being alive right so if there were
machines you have in production that
have a name and when they go down
everyone gets unhappy that's a pet right
that's a pet machine now on the other
hand someone out there is a herd of
cattle that I'm getting milk from right
gallons of milk a couple of the Kyle
died one one day I still get gallons of
milk slightly fewer gallons so I go
replace a few of the cows and then my
gallons come back up to where I expect
it right that's a very different thing
now I have a named hood where every
element in the
it's just a numbered animal that's
somewhat disposable so that's the
deployment model here you deploy a large
number of disposable ephemeral instances
that together provide a service that is
very resilient and any individual member
of that service can go away and
everything will keep working okay and
that even applies to the stateful layer
the Cassandra layer uses ephemeral
instances that Netflix we use onboard
disks and they can die in they get
replaced and it's all automatic so this
is the sort of just summary I gave a
talk yesterday two sessions on netflix
OSS so i won't go spend long on this but
it's an entire platform for working in
this way and there's new projects coming
out all the time some of them a big data
some of them my sequel no sequel based
some of them based around cloud and
there's all different SAT use cases here
so it's not all AWS Pacific this is all
open source and there's a very important
principle here the open source
ecosystems have become the best way it's
the best code you can get it's the most
scalable code you can get and the best
people in the world are working on it
that didn't used to be true you know 10
20 years ago the best people in the
world were working at sort of IBM
Research working on relational databases
or or a call or whatever the best people
now are working on these open source
projects and you can get their code for
free because they work at places like
Google and Twitter and and Netflix or
whatever you also think of github being
your online resume and also your
company's online resume and one of the
reasons Netflix put out so much stuff on
github it acts as an attractor for
developers and a lot of really good
developers have joined netflix because
of its open source program you're trying
to build an ecosystem and the other
thing is to give up control to get
ubiquity apache license is the right
license to use if you're trying to work
in this way there are other licenses
where you get more control but you'll
find your talk your code just doesn't
get traction
okay let me see where time I've got here
mmm how much more time do I got 15
minutes okay all right so when you're
developing microservices there's an
argument that always comes up about the
interfaces and should you have a client
library for it or not and they were very
you get quite heated some people say no
every interface should be
self-describing and anyone can use any
in any language to talk to it and other
people say no you should have a client
library for it so my observation is that
you'll end up with a library because as
soon as somebody writes some code that
talks to your service they'll give that
code to their friend and that code will
wander around and it'll end up being the
standard pattern so build it for the
from the beginning own your own client
libraries and your interface to your
your code is the client library not the
not the protocol it's much you're going
to end up like that anyways you should
just start that way okay so the other
thing is that when you call a service
it's going to try and call lots more
services right so we've got fan out or
maybe 10 things you need to call we
can't call them in order you don't know
order to call them in you want to call
him in parallel so they have to do
threading or maybe call backs or
whatever right it's a big messy thing
you get futures then you get futures
embedded in other futures and it just
gets messy so RX job of the reactive
thing which is thing there's been some
talks about it those conferences about
it now basically is a very clean way to
solve that problem it makes everything
into an observable and behind that
observable you can implement it any way
you like but it means that the code the
business logic code is working at a very
high level thing I wish to observe the
results of these things and I will
compose that once there already I will
compose them together and return it it's
a very nice way of looking at it and
then the other thing is that if a
service breaks one of the dependencies
breaks you want to be able to wrap that
dependency in something that can be a
bulkhead in a circuit breaker so that's
the this is another patterns from the
Michael no guards release it book so you
want to say if it's broken I don't
really trust this code I'm just going to
stop calling it for a while and wait for
it to get better and once it's happy
again we'll call it again or call it
occasionally to see
forgot better but generally speaking or
you'll turn this thing off so there's a
few ways of doing that there's some
Twitter mechanisms and some Netflix
tools for doing that and historic siz
been adopted outside the netflix
ecosystem I think the scholar acha
system is now using it there's a few
people it's sort of broadening out
beyond the the core system that Netflix
belt now you if you've split everything
into micro services but they all talk to
the same database you discover you have
to update them all at one time because
then still couples right I was talking
about loosely coupled microservices and
if they all talk to the same database
they're not loosely coupled so you
actually have to split your database up
and this is where the computer science
purists have to kind of I don't know get
over it or something you have to
denormalize everything instead of all
those things where they taught you how
to normalize everything in school well
you have to forget about that and
denormalize everything and you end up
this big messy inconsistent pile of data
sources but because every micro service
has its own specific data source it can
be updated and developed independently
and it's very low coupling so you can go
faster it's Messier but you can go
faster and you have to build tools which
will rummage around in your system and
keep all these data stores in sync and
you had to do that anyway as soon as you
had more than one database so it's not
that that unusual one of the neat
projects that we built at Netflix was we
had so many times we would build a
service in front of a database that we
just built a standard one and it's
called stash so that's storage tier as a
service over HTTP stash with 2 a's in it
right as opposed to the atlassian
version that has 1a in it does something
completely different the one that
Netflix built has my sequel and seat and
cassandra CC sorrows cassandra and from
a single code base you can actually use
this as a migration tool if you're
trying to migrate data sources from say
a big my sequel schemer and you're
trying to split pieces of it off into
cassandra you can use that as a mech
and then you have to really get used to
distributed systems and yeah I'm a
physicist so I'm kind of you know my
physics degree tells me that there is
actually no such thing as consistency
anyways that due to Einstein and
relativity and all these things so I'm
actually more comfortable with that but
it seems like a lot of people really
really want their systems to be
consistent and you know there isn't
really such a thing there are just a few
ways to fake it and depends how well
you're faking it and what happens when
the faking breaks that's really what
happens that's really what the
discussions about and if you look at
affairs actually Kyle Kingsbury who's
known as Twitter Isaiah he has a series
of tests for databases than was the
jepson series carly rae jepsen call me
maybe perhaps the song it's based on and
he systematically tortures to death just
about every large-scale distributed
system you've ever seen so definitely
where we're seeing so let's move on a
little bit you built all these systems
but you got to monitor them and they
look a bit different to monitor the
problem here is that there's a high rate
of change right your machines are coming
and going there auto scaling maybe at
midnight there's a hundred services and
a peak traffic there's a thousand of
them so it comes and goes every day code
pushes caused floods of new machines so
you're monitoring tools tend to die
under the weight of new machines coming
and going new metrics coming and going
so it makes it difficult if you've got
hand tweaked nagios servers you know
you're going to go crazy trying to keep
this stuff up so you have to build
something that automates it so the act
of launching something in production
causes it to appear in your monitoring
system automatically that's the only way
you can do it and the other thing is
you've got these end-to-end calling
patterns where microservices call other
microservices need to recapture the
request flow so in all of your requests
you throw an extra good in the header
and you pull these out and log them and
then you can actually take any one
request and you can track it through the
entire system the tree of requests as it
spreads out and returns back in so
that's the netflix platform has all that
built in there's a number of ways to do
that but it's built in then you try to
visualize these and they get
overwhelm there's no good way to
visualize hundreds and hundreds of
services so how many microservices
should you have this is from gilt groupe
if anyone's used guilt it's our online
shopping site and this is I think about
one year's worth of development from
adopting microservices and to roughly
the end of last year they were just
adding new ones like several a week and
they are up to 450 and then they said
well this is our diagram of how r
microservices talk to each other and
there's only 12 of them so not sure
where the other 438 went but if you
include the other 438 it looks something
like this this is the netflix
architecture diagram as of a couple of
years ago when it was still fairly
simple and this is the Twitter version
of the same thing with just using
finagle and all of their visualizations
there's quite a nice one this was apt
dynamics basically losing its mind as it
try to keep up with everything so if
that's your architecture diagram how do
you deal with this well for anyone
service here you grab that one service
you can see who's calling it and who
it's calling so for the just the bounded
context that you actually care about
it's no problem i have three consumers i
have ten dependencies I'm done and okay
what the rest of the world is doing but
let is my world right I have security
group set up so only those three people
can call me and I know who I call I'm
done so you get this bounded context and
every team works in that bounded context
and then it's only the aggregate level
everything has to actually work so okay
so continuous delivery you're making
these changes they're small but their
frequent and any one individual change
is more likely to be broken because it's
actually got less impact so you're
throwing code out there and seeing if it
works but what you're when the change
hits a customer it's not usually new
code it's not a code push it's a feature
enable its flicking that switch on that
enables this feature for all customers
is when you go you know whoops I didn't
mean that I need to turn that off again
right now if you fit that on switch and
you look at your monitoring system and
you get these one minute updates and you
wait another minute it hasn't actually
it's still showing you five minutes ago
you have to wait five minutes and then
finally you see a thing that looks bad
was only one data point let's look wait
although I got two or three data points
right well what actually happened was
you didn't bother waiting five minutes
he went got a cup of coffee you know
standing by the coffee machine chatting
to some people and you suddenly realize
everyone else is running around because
the site's down and then you finally
realized it's because of what you just
did and you have to rush back and turn
it off right so that happened a few
times and Netflix so two things one is
that there's a central monitoring system
that collects all of these toggles
whenever and whenever you change a
production variable it's logged
centrally so that's the first thing we
did and then we realized that I wasn't
sufficient you have to remember the old
setting of the value you can't just say
you know verbal a is set to three you
have to say variable a was set from two
to three so that when you switch it you
can switch it back to what it used to be
so you have to build that and the other
thing we did was build stuff which
worked by the seconds instead of by the
minutes and this is what the historic
turbine circuit breaker looks like this
is a JSON based web page that you get by
connecting your browser directly to your
micro service there's no intervening
system your browser you go to URL that's
connected directly to your micro service
it pushes you know this page directly
into your browser and it's updating
continuously it's a WebSocket it's just
pushing JSON over a WebSocket so this
thing is changing second-by-second it's
30 seconds of history these things are
wiggling around these numbers are all
changing at all it's fine and then you
push you flick a switch and it goes oops
you can't get hip get your history book
marks anymore this is broken you broke a
dependency and you go oh whoops okay
let's flick that switch back off and
then it goes back to that again right so
that's what you want you want it to be
like 10 seconds which means you have
time to go get coffee right you just got
to sit there and wait five seconds for
the data to flow through
okay so there are few tools out there
which actually do do one second
monitoring's just want to highlight them
to try I'm trying to encourage all
vendors to have at least part of their
data collection at the one second level
vivid cortex is a my sequel monitoring
tool you can see here it's seen a
one-second long spike in my sequel
latency and here's a boundary which is
one second base data second by second
collection they both actually look at
the network layer and make sense of that
but you know go think about that so what
I'm basically saying is your metric to
display from a something happening to
you be able to see it needs to be less
than say 10 seconds you know less than
your attention span okay so to summarize
I'm really talking about here is old
stuff right separation of concerns but
separating concerns along project basis
you have micro services that implement
features that are parts of a system and
each of those features is the separated
concern and abounded context rather than
saying you know my sign admins separate
their concerns from my sis admins and
separate their concerns from my dba's
and you have to do handoffs to work your
way through the operations team that's
the wrong kind of separation of concerns
that may be more efficient but it's too
slow I mean what you want is to have a
team that is responsible for getting
something done and that is what makes it
go fast all right so a few things just
looking forward what's happening next
I'm look I work in a part of the
industry where lots and lots of things
are coming through i'm seeing all these
companies with ideas and seeing what's
happening so what I'm seeing is that
almost all the new things that I see are
written in go and i have my go t shirt
on today just because it's a cool
t-shirt and I'm a developer conference
and I can wear a cool t-shirt you know
dockers written in go Cloud Foundry is
being rewritten in to go from Ruby
Apsaras written in go vivid cortex is
written in go so these are large complex
SAS platforms they are you know bits of
tooling there's an awful lot of stuff
and there are still a few things written
another language is coming by but I'd
say the majority of new stuff written
this year that I'm
is written in go and why is that so I
actually went and I learnt go and I
started coding it and I discovered it's
a small fast he's quick to learn
language that has it's quite nice modern
features and it's relatively fast to
pick up and get something done with so I
think it's a very productive new
language for building system software
and it's got google behind it and
there's a lot of people using it so
that's worth looking at the next thing
is yeah Jess how's that book coming
along yeah by the end of the year yeah
so the Lean Enterprise book is really
summarizes everything I've been talking
about here is this enterprises adopting
continuous delivery devops and lean at
scale that is you know what i'm seeing
happen and the book is that keeps being
rewritten and you can get a like a PDF
version of it but you can't get the
paper version of it yet so i've been
pointing people at this book for since
late last year that jezuz beavering away
trying to finish it and the other thing
is really just this move from monolithic
services to microservices is becoming a
hot topic if you look at anything to do
with docker its people are talking about
microservices so maybe some we may have
heard of work day that's HR software
right it's a SAS platform for HR
software i read an interview with their
their CTO i think or CEO he said we're
taking this software and we're
rebuilding it all as micro services and
we're copying the netflix model and
we're running Karis monkeys against it
and this was in some business you know
Forbes article after talking about all
the business stuff as I well we finally
the ideas did get purchase people are
paying attention so that's really cool
all right so i can take questions and
here's some videos event so i did
monitor armor as much more about
monitoring there's a few other talks
that are somewhat similar to the one
i've just done I'd like to highlight
this one the DevOps enterprise summit
coming up
in about three weeks this this was
amazing i was on the program committee
for this i'm on the program committee we
said we want the big old enterprise
companies to tell us what they are doing
with dev ops and we got a hundred and
seventy or something submission some
huge number of submissions from banks
and insurance companies and government
departments and you know big old
complicated companies that were
internally trying to figure out how to
do devops and we've got them all on
stage to some amazing presentations and
i think this is going to be one of those
conferences that just like it's a I
opening event to see what people have
done we basically ended up excluding
just about all the vendor presentations
this is just end-users talking about how
they are actually doing this but it's
like to say instead of the unicorns like
Netflix and Etsy and whatever where the
unicorns of DevOps you have the pointy
horns were very special this is the
horses it's like there are millions of
horses and there aren't really any
unicorns so that's gonna be fun and
those of you from Germany I'm going to
be in Berlin november six giving a a
version of this so you can tell your
friends to come along and finally
reinvent I'm doing I've been doing
versions of this talk for a while I'm
starting a completely new talk which
actually have to start writing soon
because they're complaining that they
want early abstracts this is going to be
on optimizing cloud optimizing the
efficiency if your cloud and trying to
figure out how to get your costs down
and run it more efficiently that's so
that's my next phase of presentations
that i'll be working on going forward ok
any questions we actually don't have
time for questions please vote on the
app and please give warm thanks to
Adrian Cockroft thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>