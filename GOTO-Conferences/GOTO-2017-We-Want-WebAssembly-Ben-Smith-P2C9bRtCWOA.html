<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GOTO 2017 • We Want WebAssembly • Ben Smith | Coder Coacher - Coaching Coders</title><meta content="GOTO 2017 • We Want WebAssembly • Ben Smith - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GOTO-Conferences/">GOTO Conferences</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GOTO 2017 • We Want WebAssembly • Ben Smith</b></h2><h5 class="post__date">2017-05-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/P2C9bRtCWOA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi hello everyone my name is Ben Smith
I'm a software engineer at Google I work
on the chrome team and I'm going to be
talking about web assembly today just
might show of hands kid who's heard of
web assembly at all
alright everybody is heard of it who's
actually compiled something to
webassembly one person yes an excellent
ok that's that's what I wanted to hear
okay so um this is our logo we actually
had a fun logo contest this is the one
we ended up with you can't see here but
the reason it's got that little notch in
the top is because javascript is
supposed to be on top and it's actually
a complementary color as well the idea
being that web assembly works together
with JavaScript so just as he was saying
it's not about replacing JavaScript it's
about working with JavaScript sort of
supporting JavaScript so the tool that I
primarily work on for web assembly is
called rabbit it's kind of fun name
stands with a web assembly binary
toolkit and does a number of different
things
converting to and from the web assembly
text and binary formats and has an
interpreter it has a number of different
tools that you can use to explore the
web or something format so what I'm
going to do for this talk is do a little
bit talk a little bit about web assembly
the module format talk about some new
languages that you can use with web
assembly and then I'm going to talk
about the future of web assembly so for
some of the basics of web assembly this
is a really great talk sorry it's not a
talk it's an article by Lynn Clark of
most
Deborah auditing she did a nice cartoon
intro to whether somebody there's I
think 7500 words it's like very long and
but but interesting because it's got
nice pictures she talks a lot about
assemblers and just-in-time compilers
and all the sorts of things that will
help you understood understand what is
web assembly why is it fast and why
would you care but I'm not going to
really talk about that the one thing I
am going to steal is I love this art
style so I'm going to steal that for the
rest of my talk there you go um so
interesting thing about web assembly
actually is that it's got kind of a
silly name first of all it doesn't
really have anything to do with the web
it's more of an executable format so
also it's not really an assembly
language it's more like a binary format
so it's kind of a silly name
but it's works in it and it's nice and
so for sort of something that okay so
what assembly module overview I'll go
into it now so there's your module okay
so basically the idea of the module is
that it's just the container for
everything that goes into a web web
something executable think of it like
being an X see if you run Windows or a
well I don't know what you call them on
on Mac but yeah it's just the container
for everything that goes inside the
executable so the most important thing
that goes inside is functions this is
primarily the thing that will take up
the most space in a web assembly module
and this is what some of the particular
function might look like this is a some
of the assembly code
I know you can probably not read that on
the side but this is actually a
factorial function and it's the full
function and it operates on 64-bit
integer types so yeah a function so
obviously functions can call other
functions inside the module just like
any other function but you can also
import functions from outside so that's
kind of what I'm trying to get at here
is that you know you can call something
else so what you might be importing from
is for JavaScript in this case so
another thing that a web assembly module
has is memory and you only have one
because you only eat one and it sounds a
little bit weird right because for
JavaScript you have a bunch of objects
or if you are customer to writing a lot
of languages you're you see that you
normally have different objects in
webassembly what you have is actually
just one piece of memory that has a lot
of bytes
it's just raw data and you sort of think
well what can you do with that well
actually you can do quite a bit
everything that you have all of your
objects basically get put into this data
so if you're if you've ever seen
something like C or C++ before the stack
goes here the C++ side if you if you
allocate memory the heap goes here even
static data goes here all data goes into
into the memory here so obviously your
functions can read and write to this
memory that's primarily how you interact
with it the other thing you can have is
Global's but actually I'm going to take
a step back here for a second so the
reason that you that you have this
you're probably looking us and saying
like well ok what am i what am i what is
this all about what's the purpose of
what
showed me the purpose is think of this
like a module like you would have for
JavaScript you can import it and provide
these pieces of functionality we haven't
gone to get that the idea is that
eventually if you will be able to access
these functions alright I'll get to it
so another thing that you have inside a
web assembly module is Global's and the
idea of the global is that it's a it's a
way to store some data that multiple
functions want to access but you can
also pull from outside of the web
assembly module so in this case you
might store say a stack pointer inside a
global or you can store any value
actually you can store any number of
Global's here and obviously a function
can read and write to the Global's as
well there's something actually a little
bit special about this though because
the current implementation does not
allow you to write to an imported Global
that's a that's a current limitation we
will likely be reducing that limitation
in the future okay so the next thing you
have are tables tables seem like they're
not super useful but really what they do
is they allow you to store a reference
to a function so the idea is that one of
these functions say this one here might
be referenced here so you can have a big
table of functions and the only reason
you have that is that you can do
indirect calls so if you've ever written
C++ this allows you to do something like
virtual functions be able to call into a
table hit a reference and then call back
out very useful for being able to
provide an abstract
interface to to your code and then
exports so the idea here is that finally
we have this module for the longest time
it's been self-contained it couldn't do
anything it's sort of like just a black
box finally when you have an export what
you can say is okay I've got these
certain things inside my module I want
to export those two to mine better in
this case JavaScript and allow them to
call those functions allow them to use
those those functions so what you can
see here in the little purple boxes I've
exported these two functions here and I
exported this global as well these are
all things that are now I can give to my
JavaScript function I can say call this
so again if I go back to the function
here you could say I have this factorial
function factorial is kind of a dumb
function no one really actually needs a
factorial function normally basically
it's the one that you can multiply all
the numbers down it's the okay anyway it
doesn't really matter but the point is
imagine you want a really really fast
factorial function well you could build
it inside your module and then export it
here so the idea is that now you have
your web assembly module that's
contained inside JavaScript right so
this is sort of where everything gets
wired up you can see on the left side
that's the imported functions and the
imported global that is imported into
the web assembly module then the web
assembly module exports those functions
to JavaScript then then JavaScript can
use it so it seems like kind of a
pointless thing but really what you gain
here is this self-contained unit and the
web assembly unit allows you to do
something that you
would have trouble doing in JavaScript
via is that javascript is actually
written in such a way typically that
it's very hard to optimize because any
piece of code could do a number of
different things for example if you say
a plus B well if those things are
numbers then you add them if they're
strings then you have to append them if
they're an array then well I think it I
don't know I'm sure you know what it
does but I have no idea what it does
javascript is very complicated in that
regard the nice thing about web assembly
is that everything is very low-level so
the idea is that all you have are
numbers so when I say add two numbers
well there's no guesswork you say add
the two numbers and those two that those
that operation is something that you
could already do in your hardware so the
mapping between what webassembly does
and what your harbor ultimately does is
almost one-to-one that's the reason why
you get a lot of optimization there is
because you don't have to do any
guesswork your JavaScript engine doesn't
have to do anything clever so let's move
on to some of the new languages that are
possible with webassembly and actually
um they're not really languages they're
more like compilers because typically
when people are doing is they're taking
languages that they've already
implemented that I've already that
already exists and they're trying to
figure out ways to make them work for
web assembly so this first one is
actually very interesting it's called
TVM and it's uh it's been around for a
little while and what it does is it
takes
Java bytecode and it compiles that to
JavaScript there's an experimental
back-end that allows you to compile that
to web assembly so what this is very
what's really cool about this is that it
allows you to take code that you would
have written in Java which you can
obviously use to write Android apps or
or server applications or anything and
then bring that to the web because you
can choose between javascript and web
assembly now you can support browsers
that don't necessarily support web
Silvia
or even support browsers that do and
it's very likely that you'll get better
performance actually on his website he
has some benchmarks that that shows some
some of this very very cool another
thing that's very interesting about this
is because it's using Java bytecode as
the mechanism for converting you can
also support languages like Scala and
Kotlin so any Java bytecode language
could be supported um another one that's
very interesting is a newly developed
language called turbo script and what's
interesting about turbo script is that
it's actually written in such a way that
it's it looks very much like typescript
and the developer of this language sort
of forked from an original experiment
called thin script when we first started
developing web assembly and made some
changes to it but he has what what
amounts to a very interesting pipe
languages because the length the
compiler is written in typescript you
can actually compile in the browser and
he has a very cool demo where you can
see that maybe I should have showed some
of those demos Wow
but the point is that you can actually
take code that's written in in in what
looks very much like typescript and you
can compile to webassembly you can run
it directly in the browser and so this
of course also means that you could take
that same code and run via npm in node
and use that to to get a nice
performance boost that's the that's the
promise there the reason it's got this
logo here is because the I guess the
logo is a snail I'm a knight in the
colors though that was my choice this
one this one's got a lot of text this is
a this is a very interesting experiment
by a person named Misha Arizer and the
idea is that you can take something that
looks very much like typescript and it
actually is typescript it uses two types
two compiler and when you annotate
certain functions and you say with this
you speed ejs you annotate the function
you say I want you to compile this in a
different way and what it does is it
takes this code and it actually parses
it converts it to an LLM representation
LLVM is a a very popular compiler
back-end and then it uses the L VMs
back-end to convert it to to web
assembly code which is what I've drawn
in very very tiny fonts on the right
there so what's very cool about this is
that now you can you can take your
typescript code which maybe there were
certain components of it that we're
running a little bit slower and all you
should have to do is annotate that and
say I trust me I want this to run fast
and then it will convert it to to a very
low-level code that will just run faster
for you it's very very cool he started
this experiment I think only just a few
ago so it's still very new but pretty
interesting okay so let's talk about the
future the future things that you might
see with webassembly so currently with
webassembly we support languages that
look very much like C and C++ and rust
so probably languages that I mean I do
does anyone here use those languages on
a regular basis one person yes umm right
you're not the most popular languages
and that's because if you're writing a
hook for the web they don't really work
very well one of the reasons why web
assembly is not super interesting that
people just yet it's because it only
does support languages like that it has
to be something that's very statically
typed it has to be something that
doesn't use garbage collection it has to
be something that is pretty low-level
and so what's cool about some of these
new features is that we will be able to
support new languages more than just
what I talked about here but potentially
languages like L potentially languages
like Oh camel languages like typescript
supporting it fully any number of
front-end languages we should be able to
support and what will be great about
that is that you'll be able to actually
get a performance boost because now
rather than compiling to JavaScript and
then sort of hoping that your JavaScript
engine performs well you can actually
look at the code and say well this is
this is exactly what's being generated
it's not going to do anything clever
because I don't want it to so garbage
collection is one of the best
their exception handling again kind of a
no-brainer right but you can't currently
do it in webassembly this is like being
able to throw and catch exceptions so
being able to integrate that directly
into webassembly means will get a lot of
much better performance boost you can
currently do it it's just it ends up
being sort of a little bit slower lower
level Cindy Cindy is a complicated topic
and I won't go into too many details
about it but but the basic idea is that
your computer actually is mostly only
doing one quarter work a lot of the time
because you're only doing operations on
one value your computer is sort of set
up in a way that it wants to operate on
many values at the same time and that's
what Cindy is so if you can tell your
computer like oh by the way I'm
operating on four things at a time then
you should be able to get quite a bit of
performance boost and so actually we're
going to have a CG meeting a community
group meeting in the United States in
California next month where we're going
to talk about some of these issues and
so if you are particularly interested
and dedicated you could you could fly
out and join threads and Atomics are
actually one that's near and dear to my
heart actually because I've been working
on a proposal to add threads and tommix
to JavaScript as well and and so what's
great about this is that it's sort of
another one of those no-brainers when it
comes to computers right like the
computer that you have even in your
pocket usually has multiple cores often
those are being used to run different
processes but why not allow them to be
running the same piece of code if you
have very high performance code that you
want to have
you're on your phone or on your computer
then you can't currently do it in the
page it's not really possible so one of
the things that you can get out of
adding this to web assembly is now you
can create another thread and you can
run things in the background so one of
the things that you currently have to do
in JavaScript quite a bit is you have to
yield to the event loop you call to the
you call to a function that says I'll
tell you later when I'm done when you
have threads you can actually do it in
an amount of different way you can just
block you can say you know what I'm
going to wait here until I'm done then
you can give me my results and then we
can keep going and that's a much
different model but it's um it has its
own benefits so some pretty exciting
stuff that we'll be able to do in the
future was whether somebody and that's
how I've got but I also would love to
have questions because I imagine that I
I realized now that I probably did not
explain maybe the some of the simpler
stuff as well as I could have so there
are some questions I would have happily
well let's give Ben a hand
I did have a question over there yes
no you yes indeed yes how do you wait
for a mic ok thanks a lot oh so the
questions because they used to be that
go she would flush and the Qi Adobe aku
I don't think you like ok you as Google
are doing this but that reminds me of
Flash so much and then what's the kind
of it's going to be you see like issues
when it comes to mobile devices when you
know people who has certain fractures
who start walking it or fully supported
as I kind of run the bar yeah so that's
that's a great question and actually
it's one of the probably the things that
I should have led with was that actually
was very interesting about this
technology is that we've been working
together with with other browser vendors
to ensure that everybody is on board so
currently it's supported in Chrome and
in Firefox it's behind a flag in Safari
so we're sorry it's inspect for a
technology preview which is where they
sort of demonstrate a lot of their new
technologies and it's behind a flag and
edge and then all the meetings we meet
regularly with people from Apple and
people from Missoula and and others and
like I said the community group we're
also meeting with Intel and arm and nips
and everybody to try and make sure that
everybody is happy with what what we're
producing and it doesn't end up in a
situation like flat for people say well
we don't want supportive so we had
another third question here yeah so my
question is just that you said that you
can compile script than the like to
webassembly yet you don't support an
exception and so how do you how do you
deal with that yeah that's a good
question
um so we don't support what we call zero
cost exception handling it's a bit of a
technical distinction there but the idea
is that you can support
exception handling by calling out to
JavaScript and then calling back into
web assembly and JavaScript and then
anytime you want to throw an exception
you call back out to JavaScript and you
throw and then it gets caught in
JavaScript at a higher point in the
stack and then do you see how that makes
sense maybe well if you do then awesome
but yeah the basic idea is that you can
you can support a lot of this stuff and
you can support garbage collection too
like when I was showing you that slide
about how memory is laid out you can do
garbage collection in memory like that
it does work it's just that it's not as
fast as you might like it to be so
people have already taken Python for
example compiled into web assembly and
you can run it you can currently run it
in the browser the problem is is that
it's slower than Python already is right
because it's because it doesn't have the
functionality to do some of the things
that would make be able to make it fast
so what we're going to do is add some of
that functionality in the future and I
think that's the thing that people are
really excited about as soon as we add
like first-class garbage collection to
the to webassembly now you can support
languages like typescript more directly
okay
one final question so like you said that
well mostly is not a language is not a
massively snotting interpreter so and
for me it's not super clear what we have
assumed is right now but maybe that's
not the question like can you tell me in
two years
what am I gonna do with whether
awesomely how am I going to use a module
like what the module is gonna be is it a
- maybe it's something that like library
that I already find in the user browser
and I don't have to
through HTTP or what's gonna do for me
yeah that's yeah again probably should
have left with us for the next time so
what I would say is that yet the
important thing is that you probably
won't if you're a typical developer you
probably won't even need to use
webassembly because a lot of times what
will happen is someone will make a
library that you use and they think to
themselves well if I make this into web
assembly library then it'll be faster
and they do that and you use the library
and you call the functions and you don't
know how it works at all you don't
really care because it's just it's
faster so that's one way that people
that you might Kirk that you might use
web assembly in the future is that you
just get a library and now it's fast you
can do let's say a face recognition in
in a on client side because it's fast
enough that you can do that another way
that you might see that people use web
assembly is what I was describing here
about new languages it might be the case
that you'll be writing in a language
that compiles the web assembly so again
maybe you don't care as much that it
does that because you care more about
the language but what webOS only has
done is it is enabled you to be able to
to use that new language because
normally all you can use is JavaScript
right if you're running client-side so
um so yeah I guess that's that's how I
can answer that question is that it's
probably the worst work best when you
don't even notice that it's there okay
let's give Ben another hand</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>