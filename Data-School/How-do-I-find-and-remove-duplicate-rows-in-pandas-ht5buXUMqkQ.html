<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How do I find and remove duplicate rows in pandas? | Coder Coacher - Coaching Coders</title><meta content="How do I find and remove duplicate rows in pandas? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Data-School/">Data School</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How do I find and remove duplicate rows in pandas?</b></h2><h5 class="post__date">2016-07-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ht5buXUMqkQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome back to my Q&amp;amp;A video
series about the pandas library in
Python and the question for today comes
from a YouTube commenter who asks I want
to count the number of duplicates in a
particular column in a data frame okay
so let us talk about duplicate data okay
so let's just start by importing pandas
as PD and then as our example data set
I'm actually going to pull some code
from a previous video so I'm going to go
to the github repository for this video
series and there's a link in the
description below and here is the
repository you can scroll on down and
click on under code this link to the
ipython slash Jupiter notebook and
you'll be taken to this on Jupiter
notebook and if you want to see the
commented code for a particular video
you just click on it in the table of
contents and I want a piece of code from
video too so here I am in video 2 and
links to documentation and whatnot and I
am going to copy and paste this line of
code or this cell cell number 4 and copy
it and paste it to the notebook okay so
I'm going to run that in a second but I
do want to add one thing I'm going to
say index call equals user underscore ID
okay so having run that let's take a
look at this data set and this is a data
set of movie reviewers okay and let's
take a look at the shape users dot shape
and 943 rows four columns okay so let's
say that we want to identify duplicate
zip codes okay the method we're going to
use it's a series method and you just
say user
is dot zip code dot duplicated okay
and when we run that we get back a
series of trues and falses okay and the
logic here is that it returns a true
like in line twenty nine returns it true
if there was an entry previous to it
meaning above it that was identical in
other words whatever zip code that user
29 has was also the same zip code that
was somewhere above here okay we can't
see which one it doesn't tell us that
but we know that it is a duplicate to
something that was previous to it okay
now because this is a series of boolean
x' we can add them up to count the
number of duplicates like the commenter
asked for and I can just say dot sum and
what will happen is that the throughs
get converted to ones the false is get
converted to zeros and it adds it up and
says that there are a hundred and forty
eight duplicate zip codes okay now let's
expand this a little bit let's look at
duplication in the data frame as a whole
instead of just a series so for example
I can just use the data frame method
duplicated users dot duplicated okay and
what we'll see here is that it will
output a true if a an entire row is
identical to a previous row again
meaning one above it okay and just like
before we can sum that and there are
seven rows in which the values in that
row are also the same values as a
previous row in the data frame okay so
now you might be wondering well what are
those rows what do they look like so if
we want to see them
we can use the lok method and we passed
a lok what Rose do I want to see we can
pass a series of boolean's and it will
show any row in which true is present in
that series okay so if we say users dot
duplicated and then I want to see all
columns that will allow us to see the
seven rows that were identified by
duplicated now let's be very clear about
the logic and to clarify it I want to
show you the default argument for a
parameter called keep so I'm going to
say keep equals first as a string okay
so that was the default nothing change
but the logic for first is as follows
mark duplicates as true except for the
first occurrence okay so the first
occurrence gets kept and all others in
the data frame get identified as
duplicates now you can change the logic
and say I actually want to keep the last
okay and now we are seeing the seven
rows that are counted as duplicates
keeping the later one the lower down one
in the data frame which is why these
have much lower numbers okay there is a
third option you can use for duplicate
it and it's keep equals false and this
is not a string this is the boolean
false and keep equals false means mark
all duplicates as true and thus they
will show up when we use the loke method
so as we can see this row 17 male
student 604 o2 is also found down here
okay now let's pretend that we want to
drop the duplicates from the data frame
now in this case we don't actually
believe that like this
user is the same as this user because
they have unique user IDs but we're
going to pretend that we're going to
that we think they're duplicates and we
should drop them from the data frame
okay so how do we do that we're going to
use a method called drop duplicates so
users dot drop duplicates and the
default is keep equals first but I'll go
ahead and write it and I'll say dot
shape and if you remember it started out
as 943 now it's 936 so it lost those
seven rows okay um this by the way does
not occur in place by default you can
change it to in place equals true if you
like but we see that it drops the seven
rows with keep equals first we can
change this to keep equals last and it
also drops seven rows it just drops a
different seven rows it keeps the last
version of the duplicate and of course
we can also say keep equals false in
which case it will drop both versions
and now it's down to 929 meaning it
dropped fourteen rows okay so as always
we're going to end with a bonus and the
bonus is as follows what if you only
wanted to consider certain columns when
identifying duplicates okay you don't
want to consider all columns just
certain columns so for example let's
pretend that we believe age plus zip
code should be a unique identifier in
this data set okay age plus tsypko so
what we will do is we'll say users dot
duplicated and we'll say subset equals
and we pass it a list of strings we say
age and
zip code okay and let's go ahead and
just say dots um okay and what this
means is that if we tell duplicated to
only consider age and zip code as the
relevant columns there are 16 duplicates
in the data frame okay similarly you can
use drop underscore duplicates with this
subset um parameter and let's just check
the shape and that is the data frame
with those 16 rows that we just
identified with those rows dropped okay
so that's it for today thank you so much
for joining me as always please click
Subscribe if you'd like to see more
videos like this I'd love to hear from
you in the comment section below if you
have a comment or a question or a tip
for others and we can all help each
other to learn but that's it so while I
hope to see you again soon</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>