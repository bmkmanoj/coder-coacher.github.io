<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How do I apply a function to a pandas Series or DataFrame? | Coder Coacher - Coaching Coders</title><meta content="How do I apply a function to a pandas Series or DataFrame? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Data-School/">Data School</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How do I apply a function to a pandas Series or DataFrame?</b></h2><h5 class="post__date">2016-08-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/P_q0tkYqvSk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome back to my Q&amp;amp;A video
series about the pandas library in
Python and the question for today comes
from a YouTube commenter who asks about
two different concepts number one loke
i'll oak and IX when to use each
differences etc and then second apply
map and apply map okay I've already got
a video about the first of these two
which I will link to in the description
below and that's a very important
concept how to use loca specially but
today we're going to focus on the second
apply map and apply map now before we
get into the content I just want to let
you know you should stick around to the
end of this video for three important
announcements okay so let's dig into the
content as always we will import pandas
as PD and we need a data set and we're
to use the training data set from kegels
Titanic competition okay so HTTP fit dot
Lee slash kaggle train and let's go
ahead and look at the head ok so each
record in this data set represents a
passenger on the Titanic okay and we're
going to first go through the map method
so there's map apply map and apply so
we're going to start with map map is a
series method okay and here's what we're
going to use it for let's say that you
need to create a dummy variable for sex
and what that means is I want to
translate sex which is male and female
into 1 and 0 okay so we're going to use
map and map allows you to map an
existing value of a series to a
different set of values so what does
that mean I'll show you what that how we
do that
we're going to create a new column
called sex num
and so we'll say train dot sex map and
we're going to pass it a dictionary and
we're going to say female : 0 which
means translate or map female 2 0 and
map
male 2 1 okay so we'll run that and then
let's compare a sex and sex num ok so
I'm going to use the loke method dot lok
and say I want to see row 0 through 4
and I want to see columns sex and sex
num okay and what we see is that male
has been translated to 1 and female has
been translated to 0 now ah there is
actually more you can do with the map
method but what I have just shown you
mapping values is what it's best for and
so that's actually all I use it for
alright so we're going to go ahead and
move on to apply now apply is actually
both a series method and a data frame
method so we're going to start with
apply as a series method okay so what
does apply do it applies a function to
each element in a series okay so let's
see this in action let's pretend I want
to calculate the length of each of these
strings in the name column the length of
each string and create a new column
called name length that contains that
integer value meaning how many
characters are here and here and here
okay so we're going to use apply for
this and again we're gonna use it as a
series method so we're in our new column
is going to be called name length
and we're going to say train dot name
dot apply okay when okay so we're
applying the Len function pythons Len
function which when applied to a string
checks the length of that string okay
so let's compare name and name length so
use dot loka ghin so first four rows and
we want name and name length okay and
what we see is that we've now have the
name length column this is twenty-three
characters this is 51 characters this is
22 characters etc okay so the apply
series sorry the apply method um
when used as a series method applies
this function to this series and outputs
the result okay it applies it to every
element in the series
now notice you do not say Len with like
parenthesis you just pass it the name of
the function okay let me give you some
more examples of applying so it's
actually relatively common to use apply
with like a numpy function okay so for
instance let's go ahead and import numpy
as NP okay and here's one example I'm
going to say I'm going to look at this
the fare column and this is the fare and
dollars or some currency and let's say I
want to round it up okay so I want to
round this to eight around this 270 to
around this to eight etc okay I'm going
to use numpy ceiling function c e IL
okay
so here's how we'll do it i'm going to
create a new column called fare c l
equals train fare dot apply MP dot c l--
okay so let's run that so I applied this
function to this series and save the
results here and again let's compare the
two columns train doubt lok 0 colon 4
and i want to look at fair and fair seal
okay so it was indeed rounded up okay
and there you go alright now let's use
apply to solve a harder problem okay
let's extract the last name of each
person into its own column so what do we
need to do well we need to get the part
before the comma alright so how are we
going to do that you might think well we
can probably do this with a string
method if you've seen my video on string
methods so um we're going to say train
dot name dot stir meaning string dot
split and we're going to split on commas
and I'll go ahead and put head okay so
I'm splitting name on commas alright now
this looks very similar to what we saw
up here uh Braund comma mr. Owen Harris
bran come in mr. Owen Harris but they're
actually very different and this is very
important okay so up there it was a
string this has now split it into a list
of strings so the series that is output
is a low is a series of Python lists
each list is made up of strings so in
other words this is a list of length two
and here's the first element comma
here's the second element and actually
includes a space right there okay so
that comma is not like the comma in the
string that is a comma separating list
elements all right
so we've successfully
lit it but all we want is the first part
so how do we just get the first part
what we really need to do is say hey
pandas I want you to take this result
and I want to pull out the first list
element from each series element so I'm
gonna actually write a function to do
this and then we're going to apply it
okay so I'm going to call it get element
and you pass it a list called my list
and a position okay and what happens
it's simple we're going to say return my
list bracket position so if I pass it a
list and I say position zero it will
return to me element zero from that list
okay so what are we going to do now well
we're going to take this and then we're
going to say dot apply get element and
and say position equals zero so I'm
saying
pandas take this series apply this
function to the result on every element
and pass it keyword argument position
equals zero so pass position equals zero
to this function I've created okay and
we'll put dot hat on the end
okay and that actually does it here is
my series of strings that is just the
last names of these people now you might
be thinking um we could actually do this
with a lambda function if you're
familiar with lambda functions and so
that's what I'll do I'll rewrite this
you don't actually need to make your own
function called get element for
something so simple you can actually
rewrite this as lambda function so
lambda X colon X bracket 0 okay
and that'll do the same thing if you are
familiar with lambda functions this will
be pretty clear and lambda functions are
actually
used a lot with apply methods okay so
that is that is it with apply as a
series method now let's move on to apply
as a data frame method
okay so we're for this we're gonna use
another data set and I'm going to say
drinks equals PD read CSV and vitaliy
slash drinks by country okay and what
we're looking at is a data set of
alcohol consumption by country okay
so apply as a data frame method what
does it do it applies a function along
either axis of a data frame okay so I'm
going to actually use a subset of this
data frame I'm going to say drinks Lok I
want all columns and I'll sorry all rows
and I want the beer servings through
wine servings columns okay so this is
the data frame we are working with okay
so what am I going to do if I do dot
apply here I'm using it as a data frame
method not a series method I'm applying
it to the entire data frame so what I'm
going to say I'm going to say apply max
axis equals zero
now what am I saying I'm saying I want
the apply method to travel on axis zero
which is this direction the down
direction okay and I want you to apply
the max function Python's max function
okay so apply it in this direction okay
and here's what results beer servings
376 spirit 438 wine 370 so it figured
out the max value in each of those
columns because it was operating over
axis zero okay so ah now we're going to
change it to axis equals
one okay and that will be I want the max
value in each row because axis equals
one goes this direction okay so now we
see the max value in those three columns
is 0-1 30 to 25 312 so those are the
results we are seeing here okay and I
will show you one other trick I use
quite a bit which is um sometimes you
don't care about the maximum value in a
row but you want to know which column is
the maximum this is where NP Arg max is
super useful so I run that and this
tells me that um well there is no which
is largest for Afghanistan well any of
them but it will default to the first so
it says beer servings is the largest
here spirit servings is the largest for
the second beer servings is the largest
for the third wine servings for the
fourth etc so that's a neat little trick
you can do with NP dark max okay all
right finally let's get into apply map
so we covered map which is a series
method we covered apply as a series
method and we covered apply as a data
frame method so now let's get to apply
map which is also a data frame method
okay so um I'm just going to show you
one example here and what apply map does
so let me change that apply map what
apply map does is to apply a function to
every element of a data frame okay every
element of a data frame okay it doesn't
go this direction or this direction it
applies it to every element okay so for
instance if I do apply map float
it will change every element in this
data frame to a floating point it's
actually starting out as an integer
changes to a floating point okay now you
can actually use this to overwrite the
existing data frame columns okay
so I'll just show you if if you just say
what we want is just drinks dot Lok all
this stuff equals during start lok the
rest then we can do drinks ahead and we
will see that now the data frame has
changed from integers to floating point
numbers and we have accomplished our
objective in that case okay so there's
no bonus for today but as I said I have
three important announcements for you
number one this is actually going to be
the last video in the pandas Q&amp;amp;A series
for now okay now why is that well each
video takes me between four and eight
hours to create and I have some other
projects to focus on right now so I'm
not able to devote that time for the
time being however I might be creating
more videos in this series later on so
please keep asking questions please post
in comments I will be happy to interact
with you there and keep answering your
questions that way
okay so announcement number two I have
other videos you can watch so if you
didn't know this is video number 30 in
this series so there's 29 other videos I
have a video series called introduction
to machine learning with scikit-learn
that's almost seven hours long I have a
very popular series called introduction
to get and github and I have some other
videos I will link to all of this in the
description below this video ok and
finally third announcement if you didn't
know I teach online courses in data
science and machine
with Python okay if you liked this video
series you will love my courses so what
do I want you to do I would encourage
you to sign up for my email newsletter
right now okay there's a link in the
description below for how to sign up
what do you get by signing up number one
you'll get priority access to my future
courses number two you'll get access to
exclusive content I don't share publicly
and a lot of other stuff okay so please
do sign up for my newsletter um that is
it so thank you so much for joining me
for this entire series it has been a
real pleasure teaching you so take care
and I hope to see you again soon</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>