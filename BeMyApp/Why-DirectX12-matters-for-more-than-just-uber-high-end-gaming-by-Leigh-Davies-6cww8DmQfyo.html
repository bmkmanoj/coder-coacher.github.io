<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[Why DirectX12 matters for more than just uber high end gaming] by Leigh Davies | Coder Coacher - Coaching Coders</title><meta content="[Why DirectX12 matters for more than just uber high end gaming] by Leigh Davies - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/BeMyApp/">BeMyApp</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[Why DirectX12 matters for more than just uber high end gaming] by Leigh Davies</b></h2><h5 class="post__date">2015-07-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6cww8DmQfyo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">why it matters for more than just
high-end uber gaming because I've seen a
lot of news about Direct X 12 and it's
usually focused on that very high-end
like people trying to sell six hundred
dollar video cards but I think we're
going to find the direct x matters for
more than just that so the first
question is how many people are actually
interested in might be doing DirectX 12
in the next 12 months a few how many
people might be using things like metal
or Vulcan that's a different I OS a few
more okay it gives a lot of the first
half the talk is anything is really
general-purpose stuff about why these
low-level API is matter to more than
just like high-end gaming because they
have quite a few impacts for like a lot
of different devices the last bit of it
is a little bit more direct text 12
centric so yeah we've got the guy that's
on the the posters of the phone we like
to sure if you made him an Intel or what
he's there but they put him on front of
all the slide decks so hey and it gives
me some time to talk in ego all right
and as you said my name's Lee Davis I
actually work in the UK I've been
working with games developers with into
at Intel for last 10 years 10 years
before that there's actually game
developer myself so the agenda and I'm
going to have to go quite fast I pull
slide from GDC some slides from it two
or three different speakers no matter a
few things on my opening to here as well
so the things harder cover is why Direct
X 12 why these graphics API overheads
matter what it actually means for power
and performance and then a little bit of
bit more Pacific for Intel directx on
our hardware at the moment something
called R asteroid views which I gave a
talk at GDC about and there's only a few
slides I find them really interesting it
solves some really key graphics problems
in the computer industry today and Intel
supports is on more than just a new
hardware with action been supporting it
for the last two years and then some
best practices for DirectX 12 so the why
most people talk about this first point
I mean DirectX 12 all the low level of
api's whether it's for can whether it's
metal it's all about trying to improve
performance first and foremost there are
games out there that see
new band and obviously we don't really
want that and we also need to improve
multi-core scaling most of the graphics
API is there out there today are very
much designed around a single threaded
model and of course hardware is becoming
more and more multi cool then let's
spoke about its power that one of the
actual goals for things like DirectX 12
is to actually improve the performance
the power the power actually cries to
drive these games we've got a lot of
paca strange systems out there these
days wasn't that long ago that if you
were playing pc gaming you had actually
been pretty much guaranteed to be on a
high-end desktop system with great video
card these days more and more people are
playing on things like ultrabooks even
tablets and that means power is a bigger
and bigger concern all of these actually
come down to one thing and it's about
reducing the actual overheads of the
actual CPU API calls and the actual
overheads have always been very
undesirable I think in the 15 20 years
I've been in the industry people have
always been talking about how to check
if your game to CPU bound how to try and
make sure they're not CPU bound and I
can remember about 10-15 years ago it's
just over 10 years ago CNN video on
stage saying like you know with the
hardware that was available that day you
have you were limited to effectively
1000 draw calls and that was a lot if
you had anything more than that you like
to be end up being cpu-bound the numbers
have gone up but they haven't gone up
massively but gained to become more and
more complex so you still often end up
with people that cpu band and of course
most games today don't scale with
multiple threads be usually a profile
games but with Intel for ten years it's
almost always the case the limiting
factor is the time taken to submit the
draw calls so we wanted a way around
that and previously GPU vendors
especially when they were dealing with
like discrete video cards used to spend
a lot of time on their CPU side drivers
doing really clever tricks to try and
make the graphics look like it was going
faster but it costs CPU time it does
make it look faster from a GPU
standpoint but
problem is today we were actually in a
situation where an awful lot of PCs out
there effectively combining the CPU in
the GPU together and that actually means
that even if we're not cpu CPU bound
directly in the game we are actually
sharing power between both the CPU in
the GPU and effectively if you can save
power on the cpu you actually get more
to dedicate to the actual GPU so you
often find and one day i can actually
quote colleague of mine was working with
the games developer trying to get games
running on a 15 watt system and they
found out they can actually get an extra
3 24 frames per second which is a
massive thing when you're dealing at
slinging rain when it's running at 25
you trying to get to 30 they could get
almost the entire game they needed by
just turning down the sound quality I
wish you'd think would be totally
irrelevant but because the sand was all
mixed on the cpu that's what effectively
was pulling was drawing an extra two or
three wats just the cpu just for that
like they speed the game or by just
changing what they were doing on the cpu
these are some slides we gave at GDC a
few years ago when i was talking about
why it matters on things like ultrabooks
most people when they go out and buy a
pc these days especially if they're
looking at specs trying to figure out
the best thing they can run on don't
look at you know the frequencies the cpu
runs out if they've got a built-in GPU
in there they'll be looking at the
frequency for the GPU and you'll see
very high quotes you knowing CPUs
generally run run like two three even
four gigahertz it's great but today most
of these pcs will actually sharing the
power envelope between both the CPU and
the GPU and what that actually means is
that what you can have a maximum cpu
frequency and a maximum GPU frequency
it's rarely you get both maximum at the
same time unless you're running up a
very high-end desktop system and when
you actually look at benchmarks like
3dmark it always looks very much like
this graph here if you have profiles and
like that you'll see that the CPU
workload it's really tiny it probably
only issue in like a few hundred draw
calls unless it's a test designed to
stress the API and what that means is
the GPU gets to run as fast as you
possibly can so the benchmark numbers
always look really good but real games
look
like this where the CPU workload is
significantly larger obviously games
they've got audio as I've already
mentioned a I physics the graphics
themselves are more complex but what
that actually means is all that power
needed for the CPU is the GPU can't run
as fast as often the benchmarks suggest
and the more aggressive the lower the
parrot system the more aggressive that
trade-off becomes so it becomes very
notable when you get 9 to 15 watts and
when we start looking at tablets and
tubing ones but now have gbps like for
wat it makes a really massive difference
how the game has been constructed and if
you're actually burning time on the cpu
that's not actually required it can
really start to bring down the actual
GPUs performance so it's very clever you
can see why things like Direct X and and
vulgar and metal all can make a
significant difference for these systems
are working in these very low power
envelopes a thing they actually look
back and one of the reasons Direct Taxes
DirectX 12 is going down this route of a
much simpler API if you think back to
what I mentioned earlier is very common
for GPU drivers to spend a lot of time
on the cpu doing very clever
optimization it could be doing
additional cooling on there for the
actual geometry as it was submitted it
can be testing which shaders have been
set and sometimes like trying to make
changes based on the actual hardware to
get best possible path but the problem
is the driver doesn't usually know what
application is running so it's doing
like the attacks on all applications
it's doing tests so like we know we can
make it go better in this game and we
think this might actually speed it up so
we'll always do this test and make these
changes and because if you've got a very
well written application you don't need
any of those things so the drivers
especially like burning power that will
work will speed things up but it's going
to be an issue for just about everyone
especially as you get on to the low
power system so a few years ago in till
I should release the new set of drivers
to coincide with 4th gen core called as
well where we took out an awful loss the
actual low-level optimizations for that
type of thing and so it became the
responsibility of the developer
right well behaved in applications we'd
no longer try and do all the redundant
state checking behind the scenes and he
went a long way well written
applications got a lot faster for us but
directx 11 still has a lot of cpu
performance on the floor there are just
unavoidable overheads in the API itself
and point with DirectX 12 is to try and
address this now it's interesting to
point directx 12 actually is running on
a lot of different hardware today
already inter actually showed DirectX 12
running at siggraph last year so it's
nearly 12 months ago now on
current-generation hardware so when we
talk about DirectX 12 it's going to be
supported by everything from our 4th gen
5th gen core so everything for the last
two years so you're looking at like four
five hundred like million pcs out there
but potentially could run Direct X 12
just from Intel the point of it is it
will actually be able to take it another
level arm the API is significantly more
power efficient even needs current state
and obviously they're still working on
the drivers we're already seen very big
gains and what it also means is no
everything's been taken out to the
driver and that's as thin as possible
from an application point of view the
things that we use that used to be done
by the drive it you can selectively do
those optimizations yourself where they
make sense this was a demo that was
shown I'm not going to run it would take
quite a bit of time again but in survey
you can actually see videos love it on
the web and I believe this is going to
get published babies you know fairly
soon to go with like all the release for
like DirectX 12 and Windows 10 it was a
stress test effectively it showed what
will happen if you're trying to do like
four or five days and draw calls a frame
it was just simple spinning asteroids it
looks quite pretty and it showed two
rather important things it showed that
both if you were actually running in a
totally frame rate unlocked manner
Direct X 12 would give you a much higher
frame rate which is obviously one of the
things you want to achieve but the other
thing it showed you was if you actually
lock the frame rate at 30 frames per
second then the power consumption for
the application running DirectX 12 were
significantly lower than Marine
the same application at 30 frames per
second under direct x 11 and the graph
show why if you're running like Tony
unconstrained as fast as you possibly
could you can see that the actual CPU
overheads meant that two-thirds the
power in the system was actually going
just driving the CPU only a third of it
was actually rhian for the actual GPU
power I see the graph on that side
that's going to be less painful so
that's the 30 frames per second on the
left hand side 30 frames per second you
can see just how much time to actually
spend in natural cpu under direct x 12
obviously the graphics they're being
drawn at the same so the GPU power stays
constant but the CPU cost-effectively
like effective bat third on the right
hand side we've got what would happen if
you were originally running on directx
11 that's an unlocked frame rate and
then you move over to Direct X 12
obviously as the CPU costs come down the
system can now dedicate more pad the GPU
so the frame rate can go up so you can
win win both ways you can either end up
saving power running at the same frame
rate or you can just up the actual frame
rate your choice it depends very much on
the platform you're running on so
basically directly explore on intel at
the moment we're already seeing very
very significant power savings and say
we're running on like 500 million pcs
already there's going to be a large
market for all of that and the benefits
are going to be shown not just on the
high-end hardware but also on things
like ultrabooks and tablets and two in
one in fact I think there might actually
more important for those types of piece
of hardware because the power savings so
that all actually counts for quite a
great deal there's also another thing
about Direct X 12 especially for Intel
hardware that's been around for the last
few years and games developers have been
asking for a couple years now they've
been trying to solve things like order
independent transparency volumetric
shadow maps that type of thing depth
peeling algorithms k buffers a few years
ago yeah an Anderson it dies were saying
until it introduced a really cool
feature with the fourth-generation core
called pixels
which actually sold a lot of those
issues for him problem was it was only
supported by intel on 4th gen 5th gen
core hardware and he wanted to see it
everywhere and effectively DirectX 12
brings that feature set to all hardware
it's called raster audit views
effectively for DirectX 12 the nice
thing for us toward abuse for Intel is
it will run on those five hundred
million pcs and the other nice thing for
anyone developing algorithms and wants
to look at this feature it also means
intelius have been writing samples for
last two years and you'll see some
actually on the you know some videos
playing with a few of the samples that
relate to this on the wall but with
these things have actually been
integrated into games for like two years
running so we know that these features a
brand new Direct X 12 actually ruin on
hardware even at 15 watts in existing
games and give real visual benefits and
the samples are all out there and a GDC
I spent some time explaining exactly how
you'd port between pixel sink and raster
order views and effectively I like least
about 15 minutes work so you know it is
really really trivial you can pick up a
sample and you can just probably 15
minutes later have it running with
DirectX 12 just to show you what the
visuals actually mean when we talk about
some of these features on the on both of
these come from codemasters for various
grid titles from the last year on the
left hand side we've got something
called avsm this is what the game looked
like originally with the smoke effect
when they were down watching the car
adsm affected he is a volumetric shadow
map we can actually do self shadowing of
a particle system and you can see what
happens when you actually do this and
it's relatively cheap to do it was
really really difficult with traditional
techniques there are some some samples
that used to do it but you'd need three
four hundred dollar video card to get it
running it in real time we got this
running effectively down to 28 wat
systems we'd be turned on by default you
can see the difference it makes the
other one that we had is link or program
it will blend it this sample that show
it but they go to code masters used to
have a problem that they didn't use a
normal frame buffer they act rather than
just being straightforward RGB like
normal back before they've actually
wanted to compress everything down save
bandwidth for their HDI rendering and
everything would work fine that compress
everything down in the post process that
unpacked the actual the stuff that
actually got there use it for their tone
mapping the problem was when they had
transparent objects in the scene they're
effectively trying to it that already
got sleep in their back buffer that was
a compressed data format and they wanted
to blend another pixel on top of that
and they need to put that in the same
compression format and that you couldn't
just do a normal linear blend between
the two he just basically would not work
and what the image would look like
normally if you actually cut to the in
cuts I'd carve view inside of grid to
grid Autosport you can see the Sun up
there and that's not the way it's
supposed to look it should have looked
like that that's what tone mapping
should do where you get the nice
blooming effect and as soon as they
actually had the ability to do
programmable blending they could fix
that and again they tell you it on by
default on 15 what systems and above so
there's things out there that you can
solve today with the raster oil review
or asteroid views even on low-end
hardware and just to actually through
the point ABS em we actually got working
on an Android tablet because very
similar extensions are available in
OpenGL s 3.1 we actually make to get
that same sample running on four walks
on a bay trail tablet so if you can run
it on something like for what Bay Trail
tablet imagine what your better to do
with DirectX 12 where that extension is
available to everyone and you're running
on systems going from obviously from for
once again for the yoga pro all the way
up to a couple of hundred watt so the
actual you know the features that are
there and DirectX 12 actually available
and can be used on hardware today and
that there's already lots of use cases
where you can do some really cool things
and basically though I always want
people to walk away from here
understanding that there's stuff on the
Intel website you can use and it's
ready-made samples for you guys there's
a couple of things that r asteroid
reviews do these little bit more little
so this is a bit more R&amp;amp;D side of it
they're not actually in working games at
the moment but I've seen samples that do
them hair is one of those challenging
things too
she looked right in games and there's
been various samples from different
hardware vendors and ways to do it and
mostly does actually involve some form
of order independent transparency to
make hair look really nice r asteroid of
use is a way to actually accelerate that
significantly and get nice looking here
in which quicker it's basically comes
down to the fact that obviously you need
the hair at the bottom near at the
actual school needs to look significant
than the hair at the top so you need to
render that effectively in order to look
correct and it's always tricky as you
move the head around you can't sort all
those thousands of like hair strands or
two independent transparency means you
don't need to there's also R&amp;amp;D in things
like Jack L blending if you imagine
you're writing normal maps into your
your world bullet holes onto a wall they
tend to look quite nice which you just
splat them into like a normal like g
buffer the problem you've got is if the
g buffer already has an actual like
normal map in there that isn't flat it's
like how do you actually blend the
normal map that's lit just a flat
texture over the top of a surface you
can't just do in normal blending
operations you can sort of project or
look okayish but the correct way is to
actually do programmable blending again
then you can read the normal from the
existing surface and interpolate the new
decker by that amount and ride you back
in so it'll look technically correct and
it means the rest of the lighting
algorithm for your game can actually
like pick up on that and I've seen a few
people start to do this now and as soon
as they've got proper deck out blending
in there suddenly you find that things
like things that would normally use
those that Gator like screen space
ambient occlusion and all those sort of
like nice lighting effects that will
pick up on it the light it looks so much
better for the decals because they are
actually in proper world space and
there's no little artifacts that show up
when you try and get close to them in
addition to that voxels is one of the
big deals for like ray tracing you can
use raster audit views to potentially
accelerate the way you build a voxel
structure it does have some trade-offs
that was in the GDC talk if you anymore
download it
you know because I know Nvidia's made a
load of time accelerating this type of
stuff and what things that they're
accelerating don't necessarily reflect
directly the way you would use R
asteroid views but there are trade-offs
you can make their with r asteroid views
that are later insert much more complex
data structures inside of when you
actually building your vauxhall grid
they could actually give you a win in
certain circumstances so there's some
very interesting things out there at the
moment okay so that was just a very
brief thing on the raster all reviews
the last few slides are just
general-purpose programming stuff for
DirectX 12 I won't go into them in too
much detail it's not too many people
using DirectX 12 but some of these are
interesting points about what this means
in terms of developing games going
forward on all the low-level API is
probably the most important thing when
it comes to all of these like DirectX 12
and i'm assuming Vulcan and metals going
to be the same it used to be the case
that graphics drivers would spawn their
own threads and upload a load of work
and I know a lot of people writing games
with if they're running on a fork or
system they would actually have three
actual threads in their main game and
they'd always leave one free because I
knew the graphics driver would be doing
a lot of work and that used to be one of
the best way to do it otherwise you'd
have an oversubscription if you have too
many threads in your own game and the
drive was off going try and do its own
stuff as well these new API is they just
don't do anything like that they don't
spawn any threads it's up to the you as
a user to decide how to use the
resources in the PC so you have to make
really good use of multi-threading in
all the new API you're going to get the
best out of them because the driver can
no longer try and do anything behind
your back the other thing about a lot of
these new API is is they try and make
sure that they've got large data objects
the travelers much context for rendering
into a single place as possible Direct X
12 calls it like pipeline state objects
and it incorporates all the blending
parameters that you'd normally use it
would incorporate your vertex layouts
your pixel vertex shaders and its face
it all gathered into a single like data
object a what it means is the driver can
actually
look at that and precompile and optimize
that you know at creation time where
before the drive was trying to actually
figure out all the different state in
the game and every time you changed one
it would you have to try and figure out
the best way to configure the hardware
that's where the time was going Direct X
12 you it's really is a case of trying
to figure out the best way to make use
of these bundled objects because you
could actually very quickly get state
bloat with creating a new like pipeline
state object for just about everything
in the game and I've seen people doing a
naive port from a directing c11 to a
directx title they let their 12 title
weather pretty much created one of
everything you know every time to make a
state change so I need a new one of
these and that's just going to bloke
memories you've got to start thinking
about it there's an awful lot of data in
here it's great for context but you've
got a thing about the best way to make
use of it the thing a lot of these new
API is they work on the idea of command
lists and the command lists tend to have
to be like local to each thread if you
were to try and share it command list
across multiple threads you effectively
having to make sure that's all
thread-safe yourself so a lot of the
samples actually show that you'd end up
with one command x / thread other things
to bear in mind is you have things like
the script of heaps which is you
allocate your you are responsible in a
lot of these new api's for how you
manage the memory yourself when you
change the one thing you people
sometimes do it ray a lot of different
heaps problem is when you actually
change the heap your flip basically
pushing the pipeline so he's trying to
actually get as few heaps as possible
within the actual scene so yeah figuring
out how to actually organize your memory
will make a significant difference when
you actually change the command list
especially free to change the actual
descriptors so it's a case of trying for
you I descriptor yep okay i think the
inheritance well actually comes down to
this the idea of the bundle is it's got
an awful lot of state inside the game
and if you actually got stayed setting
outside of the bundle the driver can't
know about it and it causes these shoes
when it comes to the optimization so it
actually recommends you set as much
state inside the driver even if you
think you've said it before in the
engine I know because it allows the
driver to actually
demise what you needed for that
particular end at all multi-engine this
is just something I've seen a few game
developers doing at the moment
especially when they're using console as
their primary dev vehicle it's true that
the next-gen consoles a lot of people
are actually running compute shaders in
parallel to the normal rendering
pipeline that actually doesn't make much
difference to Intel there's no big wing
to gain there but I've seen people going
to almost pathologically extreme cases
to do this where they've actually tried
to like pipeline entire things like
post-processing as a compute shader and
running that so on the previous frame so
everything's ringing parallel it's like
that's there is no winner Intel for that
that is it something that some people do
on the consoles to try and get the best
utilization of that particular hardware
architecture it's not something that's
inherently more efficient than DirectX
12 last two points just to get about
memory if anyone just try and start
experimenting because we obviously
support DirectX 12 from 4th gen core
which is has well and above only got
your own has well is there is a limited
amount of virtual address space that's
not quite the same as actually like the
physical memory there is because the way
directx actually allows like the the way
exposes the virtual memory addresses
directly to you can actually move stuff
around there is a limited amount that
you can actually access on fifth
generation core the stuff we've just
basically released this year and
everything going forward we fix it so
you actually can address the entire
virtual address space of the PC there's
another one I'm not sure the rep whites
here but I know Andrew was a put this
indirect deliberately for GDC try and
make sure you're reusing 64-bit
applications if you're doing development
for things like Direct X 12 now a lot of
game developers were still shipped in
32-bit stuff if you're moving to directx
12 and Windows 10 try and make sure
everything is 64-bit apparently you'll
thank him later for that advice so
that's basically summary Direct X 12 in
fact most of these new API is that beg
beg great because they're
giving more control to the end user
anyone talks about the high performance
aspects of them the fact you can write
games we like four or five days and draw
calls a frame without being limited by
the CPU that's all true but there's also
a really big Kate use case for going
down these new AP is to save power when
you've actually got a pair constrained
system like a two-in-one a tablet or
even a lower end that laptop they say
another the actual point was made here
is a lot of know few people that did
offload in between CPU and GPU it's okay
so think about the most power-efficient
place to do the actual algorithm
nothing's free when you've got like a
like a built-in shared system</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>