<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[Ultracode Berlin #3] How to code &amp; optimize a video game in an hour by David Roulin | Coder Coacher - Coaching Coders</title><meta content="[Ultracode Berlin #3] How to code &amp; optimize a video game in an hour by David Roulin - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/BeMyApp/">BeMyApp</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[Ultracode Berlin #3] How to code &amp; optimize a video game in an hour by David Roulin</b></h2><h5 class="post__date">2013-09-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-DxyTMC6neA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so i'm going to reuse actually a
demo I i did in the best I did a little
game and i have already all the assets
that's why I'm reusing it so some of the
assets I completely ripped from this is
from a corona sample actually when you
download coroner you have a lot of games
samples already or very small snippets
etc and this is part of the samples it
will rock or coconut this team is
something I ripped a sprite sheet I
ripped from a game you might know and
she's called braid right game an
independent independently developed game
so I'm going to use this sprite sheet to
have an animated character I think I'm
doing this illegally just just for the
record but I don't think he would mind
and just to mention that the sound we're
going to use our our and basic very
basic mp3's I have a son for wind it is
it too loud or it's okay okay and here I
have a music so the fee that the topic
is we're going to play a sort of Indiana
Jones the guy who is entering a
mysterious temple okay and so I rip the
music from youtube you'll see it gets
weird after but we'll see that later and
just to show you the last asset this is
something i did quickly with my ipad
doodling you know with my finger with a
a nap and then i put i put that on
photoshop and i did two or three like
operations and I get that and this is
great for prototypes like it while using
and this is also once I did exactly the
same way okay let's get started so in
corona you start sorry up check when you
start a corona sdk it opens this and if
you start with the terminal you get that
on windows you have also a terminal this
is very useful to debug you know you can
print stuff here while your program is
executing in the simulator i'm going to
show you that immediately this is the
final application you say you have a an
emulator like that and you can you can
print stuff here why it's executing here
so that's like really really useful you
can simulate different devices like
iphone 5 up gather the screen resolution
of the Beamer is not perfect that it
looks good when I deep like the other
thing you have ipad the old a good life
form and you have a be of course so
we're going to simulate on a android of
course tonight okay let's choose maybe a
smaller one not sure I can yeah okay
well that's good actually okay and to
create my program i'm going to use a
very simple text editor so i'm gonna
Mack and I happen to have textmate i'm
not trying to sell it there are a few
solutions out there but textmate is one
of the solutions who have a corona
bundle that you can download add and
then it recognizes the corona functions
etc and it's a it's going to
autocomplete etc
so that's that can be very list okay so
first thing we're going to load the
spritesheet yeah much better we're going
to hope the sprite sheet and add little
features to control our guy so add the
spreadsheet and you make the guy and add
a basic gear I to to go left and right
and okay so how do you do that in corner
our first story to create a project a
new project in corn on your application
and just create a new folder you call it
super game go inside and then you create
a new file
called main dot lua and that's it you
have an application so if i go here and
i reload open yep
I charge the device orientation in the
other project I had a configuration file
that said this application runs in
landscape mode so that's why
automatically the emulate or was in
landscape mode just for information
we're going to do that here actually to
adjust so you see i have here you see
hello printed so that's how you debug
very basically in corner I'm not going
to spend too much time talking about
this I just need the configuration file
and you know what i'm going to do i'm
gonna cheat since we don't have a lot of
time i'm going to copy it from the other
project and put it here
and that's weird
I yea sorry it's the only one there are
two configuration files the other is
built that settings
yeah that's this one okay so
there
okay so since we don't have time and I'm
not going to talk about this okay so we
have should be like that we have a file
here which is our spreadsheet I just put
it in the in a folder like that and now
I'm going to load it yes I told she died
i reuse code and I have my cheat sheets
for almost every function so don't be
surprised so what you need to do here is
first import an optional library that by
default corona is not loading because if
you if you don't use spreadsheets it's
going to use a lot of memory for nothing
so that's why you have to manually
import it and we're going to load a
sheet first so the is basically
this fine so it's pride that new sprite
what i'm doing here is i'm pressing
escape and you see this is also complete
from the corona bundle in this program
there are other programs that work with
Corona in this in a similar way but just
so you know it makes my life easier and
I avoid the typos ok so the name of the
file now is team team too for some
reason and I have to enter the size of
one frame so usually if you don't notify
like that you get all that information
or you can rip it from the internet and
guess with your with photoshop and stuff
so in this case I know it
and it's 30 pixels wide on 34 pixels
high heat and now I want to load all the
frames in what we call a set so it's
bright dot no sprite sorry sprite set I
reuse the and I load the frames
from 12 I think it's the last one okay
so i think it's all those ones these
plus this basically ignore I ignore this
and and that so it's from 12 27 now I
think I'm rights it's from the first one
and this is the number so it's 27 so
it's yeah so that's it I don't know why
I'm ignoring this one but ok so now I'm
going to add animations and when I defy
my own animations give them a name a
custom name for later use in my program
so from the set I'd like to define run
it's from nine to twenty seven this is
100 milliseconds and this means loop
forever you have many options here like
minus 1 minus 2 12 you can do like twice
all the frames and then stop you can go
until the end of the frames and then
bounce back and stop etc here I want to
loop forever since it's the running
okay now I want to define I'm not going
to talk about local in this example in
this demo you should have to come to one
of my trainings to learn more about Lua
and corona why use local or not or okay
so I'm going to keep it simple i'm going
to call it hero and the hero is a sprite
yep and what we want to do is display it
so display it running okay let me just
try to insert it first you see the guy
is here this is hero if I remove this
line did not hear any more so at the
moment I put this line I'm creating a
graphical object and by default he is
displaying I think yeah the first frame
of my set of this so it happens to be
the first frame of the spreadsheet but
it could be any frame at this is the way
I define it sorry and now just a quick
break usually I always at the beginning
of my program create those two shortcuts
because the way to retrieve the well no
I don't want polish so the the way to
retrieve the width of the screen and the
height of the screen that are very very
useful I uses them all the time it's
very long so I prefer to define them in
in constants that are just one letter so
I'm going to say display viewable
content with so this will be W and the
other one display viewable content hate
will be the hate of the screen so this
is in pixel and what is great about
programming this way using of course I
ok I put those constants that's just
because I want to have a compact code
but what I'm also doing is that I'm
going to program my graphical engine
depending on the the actual size of the
screen which means on an iPad and I
phone I don't care anymore about the
number of pixels but I care about how my
world or my graphical user interface is
feeling in proportion the screen there
are also ways to detect the device and
if you want a tablet you want to have
different display etc this gets more
complex but it's possible you can detect
the device in my case I'm going to have
exactly the same display on every device
just proportional ok and what I want to
do here is simply Center the guy so
kinda like that
oops hmm yeah thanks ok and now what I
want to do is hero prepare the animation
I call it run so this does nothing and
what I'm going to do is play para can
you see it's a little
the last browser you can distinguish the
other guy anyway we're going to put some
background because now he's on a black
background so okay I wouldn't worry too
much actually okay so now the guy is
running what we want is to have a
background so what do not cease to have
a background that moves when we had goes
right all that the world is simply that
the character is always going to be
Center on screen and everything that's
part of your world will move okay that's
when artistic decision we make the
project so
and you know okay ya shred i should add
the world first okay so i'm going to use
this column and i'm going to define a
variable here that i will call my world
with all sides if you want but i'm going
to put it in pixels so that's why I call
it with and it's going to help me later
for many things so let's say it's going
to be w times I don't know 16 so the guy
can cross 16 times the width of the
screen before reaching the end of the of
the level that's a very basic example
it's like but in the end platformers
it's a it actually works if you want
more advanced level design of course you
do it differently and what we're going
to do is every so this is the character
columns and we're going to put a Colin
every i don't know i think in my example
it's 150 pixels so column x equals so
the first one will be at Ione why did i
put here yeah let's say 200 and while
common x
so now I want to load this image what
I'm trying to do here is put all the
columns in the temple what I want to do
here now is just to load this image so
there is nothing easier in corona and
into it like that display new image
right name of the file so it's calling
124 dot PNG and I have to put when I use
this method the actual size of the file
so i get like that
wanna
and I just put a local here so you start
to guess what local is for
ok so it's dummy but you get the idea
we're just going to put down a little
lower so it looks less stupid will that
work ya know also we're going to find
you later what I want to show now is
that I'm going to have a world here it's
going to be a group a display group I'm
going to put all the columns in that
group and when the guy will move to the
right I'm going to translate just the
display group world to the left and we
just have to translate one graphical
object the group world and everything
that is inside it will translate and so
there are two syntax to put the columns
the graphical objects how inside this
group so the most clear syntax is to do
this voila there is a shortcut and I'm
going to use it because I need space the
screen is really I can have a lot of
lines so I'm going to quit this is the
shortcut very convenient so now you it
seems like nothing have changed but
actually now all the columns belong to a
parent group that I can translate and
what the main thing I need now to do the
the only thing I remaining is to define
what happens in my graphical refresh
loop you know so
you do that this like that
so I create a anonymous function how
many among you are familiar with the
creating functions like that you know
it's something that you do a lot in
jquery or well javascript in general
like you know you know what i'm doing
right now with this function here hmm so
basically when I what I'm doing is that
function on enter frame do stuff ok and
here i'm doing this i'm registering
interframe and i put the name of the
function but instead of doing this so
this will do ok first i explained that
this will register this function to be
executed every time the graphic engine
refreshes and it refreshes refreshes 60
times per second it's 60 FPS if your
device is really slow than corona at
that and it's going to be 30 FPS but in
most devices you get 60 FPS so you can
live really fluid animations that's why
in in this function if you are moving
objects and we are going to move the
columns the background you want to move
them like pixel by pixel because you do
that 60 times per second you know
so yeah and what I was doing previously
was that so I don't give the function a
name and instead of referencing it here
i put the definition so it becomes
anonymous and I hope I'm not confusing
are you know it's okay okay good and I'm
cheating just to be sure my maths is
good so yeah so on every frame what I
want to do is move the world we're going
to do a simple test okay okay so this is
one one way I'm going to do the more
elegant way
oops I think it's like that yeah what
so if I want the guy to go faster of
course I do this maybe it makes more
sense like that then then you test you
know etc okay now what I would like is
to have a very simple UI you know
graphical user interface to be actually
able to control the guy told me it yes
so this is very simple actually I'm
going to add two buttons i'm going to
use simple rectangles and register them
to react on touch and it's going to do
stuff okay so go left will be a
rectangle
yeah ok I'm going to put it here I'm
just going to define a variable for the
the head of the my GU I go home I want
to put it here actually the buttons left
and may be here right and i'm just going
to define the height of that i'm
deciding it's ten percent maybe it's
even too much I don't know so this will
be now h- do i hate and the bottom will
be I don't know up 100 this also could
be a parameter and you I hate times wait
for instance yeah so this will be my go
left button okay let's like this bigger
um now i'm going to register an event
and depending on what I'm doing here and
I want to do various things ok so first
I'm going to check it works ok so for
instance I can do hero I think it's
stopped let's not stop pose maybe I
count three there is not enough right
let me try both yeah that could be a
game concept and ok so it works the
button is wire so what I want to do is a
when I press on the left button I change
direction and I move on the move to the
left and if I really is the button then
I stopped ok so I want to move only if
I'm pressing the button continuously so
this is when you need the face of the
event so began means you you start
pressing which I don't need that
and ended means you release the weapon
okay so
here I'm using a little trick to change
the direction I don't have other assets
the to go left or right I'm going to use
exactly the same spreadsheet and just
I'm going to mirror the spreadsheet this
is a trick that happens to work in that
case maybe with other assets it won't
but here it works quite fine to us both
right okay so here I stop pressing I'm
still pressing and now our release and
he's stopping okay so that's we're
targeting the right events and phases
and now we want to do more intelligent
stuff of course so what we're going to
do is define simply a control dot or I
don't know ok well what I can do is
actually attach a variable to the guy
and to declare it I simply have to oh
you know what I can even I can even
music xk since i am storing an
information here about the direction and
it will be either minus 1 or 1 in that
function I know what direction he's
running you know so I can move the world
accordingly so I'm going to reuse that
variable actually so basically what i
can do is that bonus
that's just a simple trick okay in
actually in this which is something i
showed in paris i had like three
variables like am i moving left true
false am i moving right true false and
then i do if and then I translate the
left or to the right end this is
actually much faster and compatible
might be a little hard to read reread
you know so sometimes you want to have
those variables and or at least comments
but anyway okay so that's good and now
we want to go right so this one is going
to be quick since the contrary we're
going to put it diagnose 10-100
basically it works now we have to take
care of the animations okay so this is
where we go back to our spreadsheet and
we need the animation when he actually
is not moving okay so
i'm going to call it still and from the
info I have on here because I don't want
to spend time looking at the spreadsheet
it was number 28 so it was the 28th nah
okay and now we don't want to do pose
what we want to do is because pose means
that you stop animating you stop using
the spritesheet features what we want to
do is prepare the animation steal it
sounds a little odd but this is on the
technical side what's happening and Lara
now of course I have to take care of two
more things the work should not move so
I'm still going to need a variable
in here
yes
if here is not still so it's really
weird but in Lua the nut is this
character I'm sorry it sucks you know
you know can you see what it is it's a
shield right guys ooh so this is the
Nagus negation in Lua don't don't shoot
please but it's really counterintuitive
it sucks and on Mac with a certain text
editors it's really hard to type so this
is a nightmare actually okay so if the
here is not still then I translate and
heroes sorry no now okay yeah you use a
used it sealed when you do this ok this
is the equivalent of ! in javascript but
if you're directly using a boolean here
then you can use not so ok let's try
then we stopped so I didn't care of the
animation of rerun again but I'm going
to do that in a second basically it
works and you see it's really really
quickly implemented
ok so here we have two and here we can
optimize a little by putting that
outside not optimized sorry make the
quad core compact
why not
mm-hmm
okay so i have a spreadsheet ague I I
have a world that that moves and I have
yeah I have animation etc how much time
do we have left Alexander is always good
I mean it okay because i wanted to i
mean in my program there parallax but
let's vote okay because i have to show
you criminal things next would be
parallax but there is a ton of parallax
tutorials on the internet so i don't
know if it's interesting or not i can
show how to do it in corona but after
parallax i wanted to add some sound and
after that i wanted to play with light
effects to create the impression that's
when you enter the temple it gets darker
and darker you know and that looks
awesome actually so who is ok to keep
the parallax hmm ok you decide our
example now I'm proposing that because
we have only 20 minutes left yeah let's
keep ok I get back at the end if I can
so the sound actually is really easy so
I'm going to add those my projects all
right and I want to load them at the
beginning why do I do that because
loading can take time so I do it very
early in my program that's why it's the
only reason so i'm going to call it wind
sound equals audio download stream
I wanna offers you the ability to load
the handle differently the music that
will be load stream and sfx sounds you
know that are very short sounds that
don't occupy a lot of memory and it's
simply that the the stream will be read
you know with a buffer etc it will point
to the file while the sfx will be put in
memory for fast used like it's when you
heat with us war and you you need to do
it several times per second like
teaching teaching so you need that sound
in memory here we're going to use mp3s
that can be read slow slower and scary
music it's wasn't in the track okay and
i have to play and the where is it again
okay yeah I'm not going to talk about
this with just so you know you have you
have you can use several channels for
the sound so you can put a lot of sounds
and mix them and have different volumes
and etc you can fade the sound here I'm
going to do something simple and I'm
going to play it immediately so wind
sound it's so now it's audio play sorry
and at the beginning I want my hero to
not move so I'm going to initiate it too
and still no so he's at the entrance of
the temple and what I want to do is as
he's entering you know the the sound of
the outside of the wind fades away so
you have the impression and just you're
going to see but just with a simple
effect a trick with the with sound you
can create extremely powerful atmosphere
more than with images maybe some of you
already know that but it's it goes the
same with movies sometimes a shitty
movie is really impressive just because
of the music and the sound effects ok so
to do that we're going to update a
variable called how much r value is
inside you know and and what we want to
do don't have a camera right a sec i did
a little drawing so can you see I of
course it reverse what I want to do is
that if I'm at the beginning of the
temple I want one hundred percent volume
and I want it to fade for like I don't
know two thousand pixel whatever and
then to be zero and to do that it's very
simple math actually but this is going
to be this cleaner this number is going
to multiply the volume of the sound on
the way okay this is the beginning of
the temple and this is like the deep
inside the temple
okay so i'm going to call it again local
&amp;amp; % % outside equals so it's 100-100 by
the i said it was to two thousand pixels
let's say it's a twice the size of the
screen okay and it's to do them times
the position of the hero yeah that's the
math now the problem with that is that
it's going to be B is going to go below
zero so I want like going to do this
visit way it's going to go like that you
know so I wanted to stop at zero you
always with a little Matt's to do games
probably you know that already so I'm
going to take that maximum between this
and zero so I'm sure it's if it reaches
zero it stays there and I'm gonna adjust
the volume simply so since I I don't
know by heart I'm just cheating and
looking at my yeah okay
okay so owed you and that's set volume
okay so I want this to be one okay
so the volume has to be between zero and
one so that's why I'm securing the math
here like that and what I'm doing this
doing that
oh sorry Knights
then that should do the trick that's
right
doesn't seem to work so for faster
testing i'm going to use only once
ah ok I know what might be happening
yeah of course I know that because we
don't have time ok so it's possible that
i'm not targeting the right channel so
first I'm going to take care of that and
the way we do that yeah so
where's the soap
I'm just guessing
could be that
mm-hmm no just to no good
right so it's the minimum between
okay let's try this out of curiosity
ok so it doesn't work huh now because
the thing is i'm using a very very
different math in this example so I'm
just trying to dynamically do it it's
okay let's do that
and I'm going to actually manually
adjustable oh wait what did I do
what even you take us
ok
so 50 oh yeah this is just not working
this is okay that's why that's
why nothing's happening because this
this number is not moving enough right
oh my god us to get here oh that X is
always the same value yeah I have to
correct with the the you know it's where
the X actually something like that this
would be one hundred and slits yeah
that's what I want ok so let's try again
yeah
I'm going to do clever again okay and
let's say that when i reach constants
here here again please when I when I
reach let's say fifteen percent you know
I still have some win and then I start
the music you know so I still have some
wind but then boom I have the music so
so if % outside is below 15 and not
start music style then we'll do looks
like it was a scary music right
so I ripped this music from youtube it's
it's an actual religious music from my
think Bali Indonesia but it's they
started saying it it just sounds very
Indian a Jonesy but it almost scary I'm
going to let the music
so just so you know in the in the
example I made out in Paris I i tweaked
i tweaked everything so when you hear
the first voice if you are going
continuously and when you when you hear
the first singing you see a statue that
is like this so it's a and with all the
darkness and etc i'm going to show you
actually the the one i did previously
that i'm redoing now yeah also with it's
also a doodle the area yeah and the next
step is to animate every arm yeah you
can do that actually there is a tool
very cool tool called spain spine 2d and
it's actually not on only for corona
that i'm trying to sell now it there are
really cool guys and they did so you can
do skeletal animation so it's not
spreadsheets anymore where you have
friends it's actual an actual skeleton
that can react to physics events and
stuff like that so you can have like an
arm that false and that crushes
something and it's it's crazy but that's
a lot of work
and if we still have a little time how
much how much do we have yeah nobody
tell me like five minutes okay so what
I'm going to do is simply show you what
I did with the other app you know yeah
because if you have five minutes then i
can show you like what the code looks
like if you want so i'm going to change
the project so here I use the API of
corona called storyboard that allows you
to have a menu screen etc so this is
just some done the image to figure that
you here you will have a menu typically
or a story or something then you click
then I did nice buttons then this is to
jump and at the beginning you see
nothing you're like where am I yes
you're going and there are many things
so there is parallax on the parallax
mountains and columns they are parallax
to these the brass zeros they have a
little shallow here that is an image
that that on every frame moves x 1 pixel
right and left additionally and if you
look carefully you see that i have
several layers i have two black layers
and one white layer that's helped me to
simulate so the the white layer is the
fog the snow that is outside so if i go
by the entrance I get the snow again and
it's blocking my vision it's like it in
the top of Himalayas or something
you see and this is like the volume of
the music i adapt the Alpha of this
white layer with the position of the guy
like like we did for the volume
percentage and then inside I have two
black layers so one is a displayed
behind one is displayed behind the
Collins and it simulates the fact that
when you enter more deeply you cannot
see outside anymore and one is something
that is on top of everything and that
has a hole here with a little gradient
you know so it's it's transparent here
and it's black here and and I use it as
a basic mask you know and this is very
mask it himself as I enter more deeply I
make it more opec when I'm outside I
just put it transparent completely alpha
20 but when I go deeper it simulates the
fact that the darkness is like closing
on me you know and those both effects so
this mask and if you see you know now
the mountains are fading and that's
because of the other black layer that is
behind the columns and here Oh what is
that so you see when i'm nearby I have
this icon that appears and oh I forgot
to mention that this is jump
and I can take it and then I'm cursed
and like in every injections movie when
I run you know so i cant with the mouse
switch you know that if i were with a
device I could like jump and the point
is now to escape with jumping and all
the obstacles voila I hope you like it
and I propose the following since we
should be over now if you're interested
in seeing like the snippets of this they
have two ways I can it you can either
come and ask me and I show you or
actually this whole project the one can
give inish is on my ex on my github so
again just download it and run it in
corona on your computer i'm going to
give you my its github.com / silver so
for oxfam court yeah and it's in coram
demos gigamesh okay I'm going to leave
that here what up now let's oh yeah ya
know as I was about to say let's drink
no sorry not yet thank you
the question may be a baby after if
somebody had any question we are
permitted food in a dream we can excuse
about it def tracking of the tellers go
so we keep on time yeah and we do
questions after okay good okay</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>