<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# Tutorial 76: Send Attachment / Multiple attachment file in email using C# | Coder Coacher - Coaching Coders</title><meta content="C# Tutorial 76: Send Attachment / Multiple attachment file in email using C# - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ProgrammingKnowledge/">ProgrammingKnowledge</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# Tutorial 76: Send Attachment / Multiple attachment file in email using C#</b></h2><h5 class="post__date">2013-06-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ui4X_qoA7Gg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys welcome once again in the
last video I have shown you how to send
an email with the help of your windows
form application in c-sharp in this
video I will show you how to attach
attachment or any file like PDF or text
or any attachment in your email using
c-sharp so let's get started if you
haven't watched my last video just watch
it because I will use the same code as
the last video and I will add just the
new code for the attachment in this code
so what I will do is I will take a text
box for attaching the attachment and I
will take a label and I will change the
label text as
attachment and I will change the name of
my textbox as attachment 1 because this
is our first attachment okay just change
the name now go to this send button
action perform method so just double
click it and this code we have written
last time for sending the email right so
in this code just after you declared
this client SMTP client variable or just
above this client variable just after
the Declaration of this mail message
variable which is mail in our case I
will just copy it and after just this
declaration I will paste this mail and I
will add dot attachments dot add and in
the bracket and break it closed and in
this bracket what I will do is I will
add new
attachment and then in the bracket I
will pass whatever path which is present
in my attachment text field so I will
copy the name of my attachment which is
attachment one once again to the code
and I will copy it and paste it here dot
txt okay so mail dot attachment dot add
new attachment and in the bracket pass
your attachment dot txt now for
selecting your attachment we can make a
button so take our button from here and
instead of this label I will change its
text as attach and I can place it here
and when I click double click this
button I should be able to choose the
path of the file so we can use it with
the help of Open File dialog so if
you're watching the this video series I
have already told you or I have already
shown you how to use open file dialog
with your C sharp application so I'm
just copying and pasting this code for
Open File dialog and you can just watch
the video in which I have shown this
code to you for open opening a file okay
and I will just copy this attachment and
paste it here
so write this code for attaching your
file and showing in it into your attach
text box so this is the name of my
attach text box dot txt and I am passing
the path to my attach text box okay so
like this and if you want to add some
filter to your open file dialog you can
just add the filter so it will filter
for some file like jpg or PDF or PNG
whatever you like I am just commenting
this code so let's see my code works or
not just click this attach button and I
want to send this text file so I will
click it and it takes the path and
copies into my attach text box ok now I
will give the user from to subject
attachment for example SMTP server so s
and T P dot gmail.com I think that was
the some TP server
and then your username which is same as
your email ID and then the password and
I will give some content so maybe
attachment itself and some text and then
I will click the send button send and my
mail is sent with the attachment so let
us check my mail contains and the
attachment or not so I go to my email so
I can see my text attachment here which
I have attached a bit with my file it
shows me the attachment which I attached
so attachment is successful now I will
show you how to add multiple attachment
so for example you want to add more than
one attachment then what can you do just
go to your code I delete this attachment
file with a label so because I don't
need it I will take one more text box
here and I will name it as attachment to
okay so this was attachment 1 I copy it
and once again in attachment 2 text box
I change the name as attachment 2 okay
and I will take one more button
so I change this attached as attach one
because that was my attachment one and
for the second attachment I change the
button text as attached to for example
and I will just double click this attach
to button and I will just give the same
code as I have used in attach one right
I just need to change this textbox name
which is attachment 2 for attach to
button ok just change this text and in
your send code which is this send code
just double click it and wherever you
have written this attach code here just
copy it and paste it here and just
change this attach one to attach to
because it will take the attachment from
second attachment right now when you run
the program and now I will attach first
attachment so for example this text once
again and second attachment which will
be for example for example this PNG file
so a text file and a PNG file right now
the prom attribute to and the user name
is same in my case you can change them
and then subject you can write multi
attachment so name is as M T P dot
gmail.com and the password and the text
you can write anything so
okay now I'm ready to send the email
with two attachments so I click the send
attachment button send button and it
gives me some errors so let's see what
is it so what I have done is I have in
this mail attachment code after this
attachment one dot txt I have added two
strings to this code and in the second
attachment also to string so just change
this code for the attachment and I run
the code once again I attach the same
file once again here and I provided the
same username password and subject and
this body and when now when I click this
send message button it sends the email
so multi attachment it sends so let's
check if the email is received or not so
if you can see here the email is already
received I open it and it shows me the
image and it shows me the text file
so both attachment are successfully sent
so in this way you can send multiple
attachment with your c-sharp application
I hope you have enjoyed this video
please rate comment and subscribe and
bye for now</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>