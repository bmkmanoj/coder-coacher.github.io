<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# MS Access Database Tutorial 6 # Insert/Save data to database | Coder Coacher - Coaching Coders</title><meta content="C# MS Access Database Tutorial 6 # Insert/Save data to database - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ProgrammingKnowledge/">ProgrammingKnowledge</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# MS Access Database Tutorial 6 # Insert/Save data to database</b></h2><h5 class="post__date">2014-07-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/njusjZHSUkM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys welcome once again in the
last video I have shown you how you can
open a second form when your validation
of username and password is correct and
whenever you give or press this login
button so I give this username admin and
password and when I click this it shows
me first of all username and password is
correct and then it redirect us to the
second form now in this video I am going
to show you how you can save your data
using the second form into your database
right so let's see how we can do it
so I will go to the second form right
now it's a blank form so what I'm going
to do is I will take 3 labels 1 2 and
the 3 in the second form and let's see
what we have in our database and I will
open this database first and by the
meantime I will add three text boxes
also here so search for the text boxes 1
2 &amp;amp; 3 and I will add a button by using
which people say Barnato so let's see
what we have in our database and we open
my database this is our database so
suppose I want to save some data into
the database for example right now I
have 13 employees I want to add one more
employee or other employees 14 15 with
the help of my c-sharp
windows form application so for this
simple demo for saving I am going to use
this column called first-name lastname
and maybe pay so I am going to save
these three column data and rest of them
will be the same of proceed
for simplicity I am going to take only
three P columns first name last name and
pay so let's go to our forum and I will
change the text of these labels as first
name second label text as last name and
third label as P okay and I will change
the name of this textbox first tick box
as T X T underscore F name second touch
box named as txt underscore and name and
third textbox named as txt underscore P
okay and I will also change the name of
this button as VT and underscore save
okay and I will also change the text of
this button as text of this button as
save data save data okay so now we have
these text boxes and we have this button
so what we can do is I will just change
the font size of these so that we can
see them
select all go to font size 16 okay so
now we can see them okay
so we have first name last name and pay
column
now we want to save on bottom so I will
just click the save data button here and
we go to the code-behind of this form -
so similarly as we have done a in our
first form when we have created the
connection with our first or form to the
Access database we have imported this
username space form for connecting to
the axis thought of the switches using
system dot data dot oledb I will just
copy this namespace and I will go to the
code for this form too and I will just
paste this same namespace here also
using system dot o le DB right and I
will also create a connection in the
second form with the Access database so
similarly what I have done in the first
form I have created this private oledb
connection is equal to MU oil in DB
connection object so I will just copy
this and the same I will do it in the
second form so I will just go to this
form to class and just inside this form
to class I will declare this connection
also it just private oledb connection is
equal to no new oledb now I also need
the connection string so similarly what
I have done in the first form I have
given this connection dot connection
string and our connection string to the
exes database I will just copy it and go
to the second form and paste it in the
constructor of form to just below this
initialize component if you don't know
how I have done that you need to see my
earlier videos where I have done all
these things ok
now for example I want to open and close
the connection with the database
whatever I have done in the first video
I opened the connection with the
database and I created a command and
then I executed it I will just copy this
code and I will also explain you once
again I will go to the forum to just
select this save data button double
click it and paste this code and what
this code is doing just it's opening the
connection with the database so this
connection is this object connection got
open and then we create the command to
execute using this connection so I
created well EDB command is equal to
know you all adb come on and then this
command connection is our connection
which we have created and then in this
line command dot txt this command or
text is a query which we want to execute
with the database and for now I will
delete this query and we will create our
query new query so I will just leave it
as lang just two double quotes and
because we want to insert a data in the
database
that this reader will be on non credi
so well e DB reader so this reader will
not come here so what we are going to do
is I will show you in a moment so in the
first or in the earlier videos I have
shown you whenever you want to select or
whenever you want to execute a select
query which will give you some data you
use execute reader so that your data you
can read but whenever you want to use
insert update or delete commands they
will not give you any data in return so
you will not read anything you just need
to execute the query so you just use
this command command dot execute non
query this is for inserting updating and
deleting data and this when a DB
the data reader we don't need it because
we are not reading anything so we can
just write command dot execute non query
right and we will enclose this clue
poured in try-catch block if any error
occurs then it will be catched right so
I will use this and similarly in the
first video I have shown you how you can
catch the exceptions by using this
trying catch blocks in so if you
remember in the first video I am
creating this code so I will just copy
this and paste it here
alright so now if any exception occur
you will see an error now we will write
the query to execute and to save the
data in the database so I will write the
query the query will be insert and what
you want to insert you want to insert
into your tables so your table name is
employed on point
so I will write insert into my table
name which is employee data and then I
give whatever column I want to insert so
give this these bracket and I'm using
first name last name and pay columns
right so in this bracket I will write
the name of my first name last name and
pay column name this will be exactly the
same as the column name in the Access
database so first name comma the last
name poppy and paste comma the P right
so this is the pay column name which is
P and then just give this little space
here and get the right
what values you want to insert in these
three columns right we-well use and in
the bracket we will pass the values so
values we are getting from these three
text boxes one two three so I will just
select my first text box copy the name
of this text box go to the code and in
this query I will just write let me just
close this so we have the space so I
will write here single quotes
first of all single quotes and then in
between double quotes and between these
two plus symbols and in here we will
write our code this will be single good
we will write the name of our text box
for the first name dot text right so
this will be like this then comma I will
just copy this two times more comma once
again comma and I will just change the
password or last name field which is the
name of my last name text boxes and name
and the name of my pay text box is text
underscore pay okay so this query is
like this insert into your table name
and then in the bracket you want to give
the name of the columns in which you
want to insert the data so I am
inserting into first name column last
name column and P column from my
database so that within the name of
those columns and then space the values
you want to enter into the database so
values and in the bracket just give the
values which you get from the text boxes
so first name the sequence will be same
first name is first name dot txt last
name last name dot text then pay pay dot
txt so it will be like this and this is
your
while and then this query will be
executed with this command and if
everything goes okay I want to show some
matches
so I will write message box dot show and
I will show data save okay so let's try
and run the program but first of all
whenever you want to run your program
just close your database or which you
have opened in this axis because you can
only make one connection with the
database whenever you are using Access
database so you need to close the Access
file which you are using first right and
I will run the program and I will give
the username and password and and I will
click this login button
username and password is correct we
reach to the second form and we want to
insert some data in the database so
let's insert some data dot the first
name is for example programming last
name is knowledge and P for example $40
per hour and I will save the data I will
click Save data and you see if you see
this message dot are saved then you know
that your daughter is saved and no
exception occurred now you go to your
Access database wherever your access or
database file is you can open sorry this
will not be like this but I will just
open it and I will open this X starter
base open
and you see the new employee is added
here with just 14th employee and the
name is programming and the last name is
knowledge and the age is $40 per hour
once again and we close this database
once again I want to add some new data
so I will give programming for example
one knowledge one last name is
programming all knowledge one and the
pay is $45 per hour save to see the
exception and what it says connection is
not closed right we haven't closed the
connection so right now we need to close
the connection you see whenever you open
the connection you always need to close
the connection otherwise it will give
you conflict
so just connection dot closed so this
will ensure that you have closed the
connection and then now you can run the
program
give your username password and you can
just go here and you can see programming
one one one all is one one one for
example and fee is $50 / / save that I
saved open your database once again open
open and you see programming one one one
knowledge one one one and the pay is $50
per hour
right you can also add one more feel but
it will give you an error why I will
show you
two two two and seventy save data that I
saved so in many cases when you open
your database in the access and whenever
you want to access this with this also
it will give you error because access
cannot make multiple connections but
because you are closing the connection
just after opening it and executing your
code and when you refresh the data you
will be able to see this data here so
it's always a good practice to open and
close your connection so whenever you
open your connection just close your
connection so that you only have one
connection at a time with the database
so in this way you can save your data in
the database using your c-sharp windows
form application I hope you have enjoyed
this video please rate comment and
subscribe and bye for now</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>