<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# MS Access Database Tutorial 2 # Create Login Form with Microsoft  Access Database | Coder Coacher - Coaching Coders</title><meta content="C# MS Access Database Tutorial 2 # Create Login Form with Microsoft  Access Database - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ProgrammingKnowledge/">ProgrammingKnowledge</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# MS Access Database Tutorial 2 # Create Login Form with Microsoft  Access Database</b></h2><h5 class="post__date">2014-07-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/72POpCW5-zE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys welcome once again in the
last video I have shown you how you can
create your first project in C shop and
connected to the Microsoft Access
database so we have written a simple
code so whenever our form loads and if
the connection is successful we will be
able to see this connection successful
of label here now in this video I am
going to show you how you can create a
simple login form and check or validate
your data against your database so in
the last video I have shown you that I
have this employee info database in
which I have this table called employee
data and I have these columns in this
database I have added two more field to
this database called username and
password and this username and password
we are going to validate using our
c-sharp form so let's go to our form
here and this is the code I have shown
you in the last video to connect to the
Access database so in case you don't
know how I have done the connection with
the Access database using c-sharp
just watch my last video now in this I
am going to change this code a little
bit so that we can use this connection
globally or everywhere in the class so
what I am going to do is this all the
code I have written it in the form load
event in the last video right but if we
want to use the same connection in other
events for example whenever we click
login button or other other button click
events then this has to be a global
variable to this class so what we can do
to this code ldb collide connection is
equal to new connection just copy and
cut this code and paste it inside
your form one class just below this
declaration of your form one class here
and we are going to make it private so
that this led be connection is private
to our form one only and no other form
will be able to use this connection okay
now for this connection string this is
also going to be common for our form one
so we don't need to connect again and
again to the signal form so what we can
do is just copy and cut this connection
string and go to the constructor of form
one so constructor form one is just the
name of the class itself and this method
and here you will find initialize
component which is automatically
generated by C shop for you and just
below that just make some space and
paste your connection dot connection
string and whatever your connection
string is this I have shown you in the
last video right so what we have done we
have declared our oledb connection as a
global variable which is private to the
class form one which is our form one and
we have pasted this connection string to
the constructor of this form one class
okay and now in this form load event we
only have the connection open and
connection close so whenever we need to
dis use this connection we will just
open the connection and close the
connection and we don't need to you know
write declare this connection and
connection string again and again in the
button click event okay
now let's check it if it was okay okay
and it works connection successful
now let's design our form for a login
page okay so go to this design view
I will open my toolbox from here and in
here what I'm going to do is I will take
two labels and I will take two text
boxes Xbox one Xbox two and I am going
to take a button okay and I can enclose
these three these things in a group box
so it looks okay so what I can do is I
will go here and I will right click and
I say send to back okay so this will be
our login page so I will just change the
title of this group box as login and I
will change the title of these labels as
so go to the property of the label and
change the text as user name and second
label text is password and we can change
the text box names also so just select
your text box and go to text box name
and just change the name as txt
underscore user name so that you know
that this text box is for user name and
same we will do for this second book per
second text box and we will name it as
txt underscore password okay
and this button name I will change this
button name as b TN underscore login and
the text of this button I will change it
as
login okay so all the things are done
let's change the font size of all these
controls so that we can see them so we
just select all and I will go to the
property called point bold and let's say
60 so now our tools are little bit
visible okay so resize all the buttons
and text boxes and labels and now it
looks fine now what I am going to do is
I'm just going to double click this
login button here and in here in this
button click event I will write the code
to check whether user name and password
is present in my Access database and if
it's present I am going to show some
message that username and password is
correct right now in this button click
event we will first open the connection
with the database and close the
connection with the database as we I
have shown you in the last video
connection open in connection close and
this connection is object of our oledb
connection if you remember right so I
will just the copy and paste this
connection open in connection close
codes from our last video so what we
have in this connect login button click
event connection open in connection
close and in this connection and cut
open in connection close we want to
create a command which we can execute so
that it can validate our from our
database so what I am going to do is I
will create a
the B command object which will be our
command so I will read command is equal
to MU oledb command and now we want to
give this command the connection for
connection is this or this connection
object right so this command has to know
on which connection it has to execute
the command right so I will just copy
this connection object and I will say
not not this but I will copy the command
object which is this one dot and I will
seek connection is equal to my command
right so not command but the connection
right so now our command knows that we
have this connection and we need to we
need to use this command for this
connection which we have created this
connection right now in the next line
what I am going to do is I'm going to
create a query so I want to give a query
text so I will use this command object
once again and I will say command text
is equal to this command text is a
string or a query which we want to
execute so just give these double quotes
and in here we will write a query to
query this database right so here I am
going to write a query
select s tricks s trick means a wild
card which will give you all the column
data from your database so select s
tricks from your database name so what's
your database name employee info right I
will write the name of my database
employee info database right and what I
want to date against my database
username and password okay
and let's see all the columns in the
database username and password text
fields right so I will save in my code
select star from employee info where
username username means the column name
of the username is equal to and then
just give this I will show you so is
equal to give two single quotes not
double quotes but two single quotes
single quotes and single quotes and
inside those two a single code give
these two double quotes and then inside
these do double quote give to this plus
sign plus symbol and in here we are
going to pass our and the name of our
username text field so our new username
text field is text username so I'll pass
in these two plus bracket or plus and I
will say dot text I will explain the
query once again so don't worry and and
so just give end here this will be a
code first and just give an and then
copy your password column name which is
password and is equal to once again
single quote in between double quote in
between plus plus and copy the name of
your password
field name which is text password dot
text
okay so now our query looks like this
select districts from your database name
where username is equal to whatever we
enter in the username text box so this
is this one and your password is equal
to whatever we enter in the password
text box okay now this is just the
Declaration of the query but we need to
execute our query also right so what we
are going to do here is we want to
execute it
so we will write command dot execute non
query right so non query is the query
whenever you will use this non query
with your command whenever you want to
get some data from the database so for
example you want to sorry once again so
whenever you write command dot for
example non query it will give you the
insert or you want to update or you want
to delete something which will not
return you anything then you will use
non query with the command and if you
want to read some data from the database
for example in the case of select
queries then you need to use execute
query or execute reader which will give
you some some values and you will read
these values from this Institute reader
so in our case we use select query so we
will use execute to read in our case but
whenever you want to insert or update
or delete you will use execute non query
so let's use execute Rhydian uh and
select query case and then I will give
the semicolon so whenever we execute our
command and it will give you some data
we need to read some this data from
oledb frida object so i will write oledb
vida let's see where this oledb dot
areeda is so just search for already be
dot areeda and we will say this Tata
reader object image reader is equal to
our command
whatever we execute now this reader will
contain the data which comes from the
execution of this query so we want to
read the data right and how we can read
the data using this while loop and we
will say reader while reader dot next of
V dot dot read dot read then we want to
do something in the while you okay so we
will just give this curly braces and
this reader dot read will give you a
boolean result so until and unless it
gives you true reader doctrine gives you
read give you true this node will
continue in the loop right and in here
we want to read the data
so what PR use we are creating the login
page right so what I will do is I will
create a variable int here
Perle declare int count is equal to zero
this is a variable to count the values
of which are coming and I will say count
is equal to count plus one okay you can
do it like this also but I think you
already know the basics okay so you can
do it like this count plus plus also you
can do count plus plus it doesn't matter
if you do counting can't count plus one
one hour count plus one okay now go
outside the your while loop and check
the value of count so just care if and
just check the value of count if count
is equal to 1 is equal to one then we
will say username and password is
correct and I will tell you why I am
doing this in a moment when I complete
my code and we will just check if our
count is greater than 1 and we will also
check if count is not is equal to 1 and
not greater than 1 then we will show the
else condition now in this if count is
equal to 1 you will show the message
message box dot show and we will show
the message that our username and
password is correct
name and password is correct
now if the count is greater than one
that means it has found duplicate entry
in the database so I will say duplicate
duplicate username and password okay and
it s our username and password is
correct not correct so I will say
username and password is not correct now
we give you the demo why I have written
this code so why I have a declare
discount variable to count the number of
result which are coming from the
execution of this query and if this
count is equal to 1 that means we have
only single entry in our database for
whatever the user name and password user
has entered so this for example he
enters admin and whatever the password
and which if admin is username admin and
password
ABCD E is present in our database only
once or only for one employee then only
we want to show that our username and
password is correct
otherwise if this admin and password is
duplicated and used for other employee
also we will show this message that the
entry is to blick it and then it cannot
be true so let's try and run the program
first and let's check whether it really
works or not so we have our connection
successful and we have this form
let's go to our database we I opened my
database and let check against this data
so for the employee 1 mark
we have username admin and this password
so I will write the username admin and
this password is abc' IDI a b c e d and
when I say login hopefully I will get
the result but it's showing a Microsoft
Access database cannot find input so
let's see what is the problem
so the this table name is not correct
and that's true because I have given the
database name but not the table name
right select star from database but this
query is not true we want to give the
table name here employee data right so
we'll just change this database name
from the table name employed data and
let's try to run it once again and I
will give the user name once again admin
and a b c e d which is our password
login once again and now you can see
username and password is correct
ok and username and password is correct
and once again
for example this employee 1 username is
duplicated at two places and this
password is duplicated at two places in
the database right and I will save this
and let's try and check once again I
will run the program and I will give
this username and password which is
present in the database two times so
what happens
EMP one username and password is one two
three four five and when I say that you
see the message comes duplicate username
and password that means that if your
query finds any duplicate username and
password you will show this message once
again duplicate username and password
right so what we have done we have
created our login page for our project
which validates against your username
and password in the database so that's
it for this video in the next video I
will show you some some more things in
this project so stay tuned and please
rate comment and subscribe and bye for
now</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>