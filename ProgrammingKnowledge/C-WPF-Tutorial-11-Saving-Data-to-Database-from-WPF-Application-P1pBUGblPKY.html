<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# WPF Tutorial 11- Saving Data to Database from WPF Application | Coder Coacher - Coaching Coders</title><meta content="C# WPF Tutorial 11- Saving Data to Database from WPF Application - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ProgrammingKnowledge/">ProgrammingKnowledge</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# WPF Tutorial 11- Saving Data to Database from WPF Application</b></h2><h5 class="post__date">2013-07-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/P1pBUGblPKY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys welcome once again till now
we have made in our WPF application a
login page which looks like this and
when you enter username and password and
press login it says whether your
username and password is correct and if
it's correct it opens the second form
which is blank right now so in this
video I will show you how to save data
in the database in this second perform
so I will use this form to save the data
in the database so let's see how can I
do this
so I have shown you in the previous
videos that how can you make this second
XML file and I want to give the same
appearance as my main window so what I
will do is in the second video I think I
have shown you how to set the image
background to your window so go to that
code and which you have set the image
and just copy this image source and the
source location the whole code from here
in the grid section and then go to your
second dot XAML file and go here in grid
once again grid tag and paste it here
and once you paste this your second XML
file will look same as your login page
so this is setting your background now
for saving the data in the database I
need some text boxes and
the button so I will take first of all
from here text box 1 2 3 4
for
okay see
and I will take four labels also for
employee-id name surname an age and I
want to assemble it in proper way so
like this so now I assembled my labels
and text boxes and I have given labels
in employee ID or or eid name surname
and age so you already know i think how
to change just go to the properties here
and go to the content just select your
label and change the name or content
from here in a similar way i have
selected this text boxes and i change
the text box name from here so first
text box name is employee ID e e ID text
second text box name is name underscore
text third text box name is sir name
underscore text and fourth text box name
is age underscores text so four text
boxes and four labels I have taken now I
will take a button and I will name this
button as BT and underscore save and I
will change its content also as saved so
this button I will use for saving now we
need to make
first of all connection to the database
with this page we have made the
connection with the login page now we
will made the connection with this
second
X
file so in my SQLite database I have
these fields called a ID name surname
age user name and password so I have six
field but I want to just save four
columns EW Dean Eames or name and age so
I choose these four columns from here
now I go to my program once again and I
go to the main window and here I have
written the connection to the SQLite
database so I go to the code I just copy
the code in order to save the time so
you need this system dot SQLite
namespace so just double click this Save
button and at the top just import this
namespace system dot dot dot SQLite now
once again go to your mean XML file and
here we have defined the connection to
the database in the login page video so
I just copy this same code for the
connection our database name is database
dot DV and version of SQLite is three so
I just copy this string connection and
paste it in my code here after this
public second method so this is my
connection now in here in the Save
button click event what I will do is I
will first go to main dot XML file I
will click this login button and you can
just copy the login page code as it is
because we will just add it this code so
it will be faster just copy all the code
which you have used in the login
Paige go to your second or CS file and
paste your all code in button click
event okay now in here we don't need
this three if conditions so we delete
this and we don't need this count
variable so we also delete this so the
basic code looks like this so here is
the connection and in the first line of
your button click event you are creating
s collide connection SQLite con is equal
to nu s collide connection and pass your
configuration strings or connection
string from here just copy it and paste
it here and here we are opening our
connection so s collide con dot open and
here we need to change this query this
time we want to save the data so what we
will write here I will write double
quote and then close first of all and
here I will write insert in
insert into your database name so my
database name is here employee ID so
this is the table in which my data is
there so I will copy the table name and
go to my code and right here so insert
into the table name and then we will
give the table names so what table name
we have in our database ew d name
surname and age so we go to here insert
into E I D comma name comma surname
comma
age and then we write values here and we
pass the values so give the bracket and
here we are going to pass the value so
we will pass the value in the same
sequence as we provided the name here
one name of the column here so first for
the Eid I will go to my exam XML file I
will select this Eid text box name I
will copy this text box name from here
and once again go to the code and in
here in the query value I will write
this so this will be like this but we do
not want to write this like this so
right single code in between double code
in between plus plus and then right here
your employee ID text box name and here
write this dot text box and after this
text box name right text okay so we have
passed the value for the first text box
so it will go into this Eid column in
the same way I will make three other
columns so I will write comma and then
single quote double quote and plus plus
and my second text box name for name
copy the name for the name textbox go to
your code paste it here before right
this dot and after right dot
text okay
two more text boxes we have so I will
just copy these copy this code once
again plus up to plus
and paste it 2 times 1 &amp;amp; 2
and we already have this plus sign so I
delete this and the error should go and
here also we have this plus sign already
so we and then just copy the name of the
surname textbox and pass here and the
age textbox and pass here so our query
basically looks like this I will break
it into two parts so you can see this
or I will leave in same
so I have written the query insert into
employee ID and the column name a ID
name surname an age and then I passed
the values for Eid name surname so write
values and pass all the values from the
text boxes okay now I am passing this
query in the SQLite command as in the
login page so this line I am not going
to change and then I have this create
command execute nan query this line will
also remain same and we will leave this
code also same in while loop we are not
going to pass anything the most
important thing in this code is the
query so write your query correct now
once you have written this code I think
we are not going to use this while loop
end this so we can safely delete it so
we just have this code for saving our
data so once your data save you
definitely want to show the message that
the data is saved so I will just show it
in the message box so I write message
box dot show and then double quotes and
I will write saved so I know that my
data is saved into the database okay so
write the query and write this code if
you want you can pause the video and
just write the code one thing I also
forgot once you open the cook this
connection you must close the connection
also so the database is not busy with
this connection so once you open the
connection you just close the connection
here you are closing the connection
you need to close the connections when
you are in the login page so when you
log in here and your login and password
condition is correct and you are opening
the second page where you count is equal
to one just go after your message
message door show username and password
is correct and paste it here also your
connection so you close your connection
and then you go to the next page one
more thing you can do is you can hide
this page so you can write this dot hide
bracket and break it loose so this will
hide your login page and show your
second page now when I run the program
now so in my database I have this three
employee ID one employee ID one employee
ID - an employee ID 3 and I want to add
one more employee ID so what I will do
here first I will login with my username
and password which is correct and you
see my previous form is gone and new
form is open and now I will add employee
ID 4 so employee ID for his name is
so name and age and I press save and you
see the message that my data is saved
now we will check in this s collide
database so once you go to the SQLite
database you need to refresh your
database so one way to refresh this
database is just go to this structure
tab and just come back again and your
data is refreshed and you can see
whatever dot avi eventer it is saved in
this database one more data if you want
you can add for example five and his
name is
any name and age age is too much okay so
we have employee ID five also and save
it
my daughter is saved and i refresh my
database go to structure once again and
my data is here once again so in this
way you can save your data into the Dopp
database using your WPF application okay
so I hope you have enjoyed this video
please rate comment and subscribe and
bye for now</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>