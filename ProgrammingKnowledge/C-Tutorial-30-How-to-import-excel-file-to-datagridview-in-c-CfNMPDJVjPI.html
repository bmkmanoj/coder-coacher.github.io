<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# Tutorial 30: How to import excel file to datagridview in c# | Coder Coacher - Coaching Coders</title><meta content="C# Tutorial 30: How to import excel file to datagridview in c# - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ProgrammingKnowledge/">ProgrammingKnowledge</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# Tutorial 30: How to import excel file to datagridview in c#</b></h2><h5 class="post__date">2013-04-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CfNMPDJVjPI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys welcome once again in this
video I will show you how to import the
values from excel file and load it into
your data grid view so first of all let
me show you what I'm going to teach you
today so I have this button from which I
will choose the file let me choose some
excel file like this test XLS and the
path will be copied in your text box and
here I will write the sheet number in
which my data is present as you know
excel file contains contains number of
sheets and in whatever sheet your data
is just write the name of that sheet
yeah and then when I click load Excel
all axial values or all data which is
present in the excel file will be loaded
into my data grid view so this I am
going to show you today okay so first of
all let me show you the excel file which
I am using I have this text excel file
here and when I open it I have some data
here which has a ID named surname and
age and some data for that okay and
I will show now the code for this what I
have done is I have taken two text boxes
from here so take two text boxes from
your tool box and I have named first
text box as text box underscore path
because it will contain my path and the
second text box I have named text box
sheet because it will hold the name of
the sheet and I have taken two button
one to choose the file and one to load
excel file to the data grid view
just take two button and rename them
according to your convenience so first
of all we will write the code for choose
file this code I have shown you in
number of previous videos also so just a
short review right open file dialog give
a variable name is equal to new Open
File dialog bracket and bracket flows if
this open file dialog dot show dialog
bracket is equal to system dot Windows
dot forms dot dialog result dot okay and
then in the if condition you will write
this dot text box path dot text which is
the name of my this text box this one
text box passed path so this is this dot
text box named dot text is equal to open
file dialog variable dot file name so
for what this code will do is it will
open a file dialog and it will copy the
path of the file and put it into your
text box okay so write this code second
thing we are going to do a
is we are going to load the excel file
so just click load excel file button and
we will reach to the load click actual
file but before that we need to import
one file so write this above your code
right using system dot dot dot o l-e-d B
okay so this is the important you need
to do in order to load an excel file
into your data grid view now once again
we go to the button click event and here
I have written some food ok so I will
show you what I have written so here I
have declared a string and I name it as
part corn my mistake it's not see you
PNN so path corn this will contain the
connection part of my XML for excel file
and in the string write this double
quote and write provider is equal to
Microsoft dot dot dot o LED in capital
please remember that it's case sensitive
so please see and write the code
carefully once again provided is equal
to Microsoft dot Jett dot oledb capital
dot 4.0 and then give this semicolon
then right data source is equal to W
code so this is one string which is
completed so this is in double quotes
this from this to here and in the plus
plus sign in between the + plus sign
here I'm writing the path text box path
so this is flexbox name who's name is
textbox path dot text plus I will add
some other strength
so here right double quotes and then
semicolon close and write extended
properties is equal to slash double
quote Excel 8.0 semicolon and then write
h dr is equal to yes semicolon / double
quote semicolon then double quote and
then close your string so I think you
just copy this string I will just move
this screen to this string once again so
you will be able to copy okay copy from
here to here
now in the second line right oledb
connection pawn is equal to new oledb
connection and here are this string
variable okay and then in the next line
right oledb dot R dr. give a variable
name my daughter dr. or whatever name
you want to give is equal to new oledb
data adopter and in the bracket right
select star from this square bracket and
the Bellport
and then plus text box sheet this is the
text box name of the text box where I am
going to write my sheet number so text
box dot text plus double quote this
dollar sign and then square bracket and
then double quote and comma your
connection which you have declared here
okay and in the next line write data
table DT is equal to new data table
bracket and bracket closed and then
write my dot dr. which is this da da dr.
dot fill DT which is this variable name
and then take the name of your data grid
view so this is my daughter grid view
which I have taken from here I will show
you
this one so take a data grid view and
drop it here and then just copy the name
of this data grid view so in my case the
static view name is thought a grid view
one and once again go to the code and
here this is that a grid view dot data
source is equal to DT which is this
variable okay so just write this code in
order to load the excel file so if you
want you can pause the video also but
it's not covering the whole code and
just write the code now let's see if it
runs or not but first of all I want to
give some suggestion to you if you are
using excel file so for example I want
to create a new excel file because I
have installed Microsoft Office 2007 so
it will generate an excel
sorry so once again I will create a new
document I want to create a Microsoft
Office Excel worksheet and I will not
change its name so because I have
Microsoft Office 2007 and if you have
Microsoft Office 2007 and later version
of Microsoft Office it will generally
have the extension XL x excel sx this
extension but our code is made for only
s XLS extension these three letters and
it is not made for as Excel as X so now
there is a problem for you because it
will not load this xlsx file but it will
load XLS file so how to convert this
file into XLS file just open this file
and go to your file options go to save
and save as Excel 97 to 2003 worksheet
so just click it and I will name
something weird and I will save it and
if you can see here come here
down here this properties of this now
it's saved as dot XLS file so you can
change Excel egg s X file into XLS file
by this trick if you are having
Microsoft Office 2007 or later now let's
try to run the program so I will choose
the path of the file which is this test
dot XLS file and I will give the sheet
number sheet 1 because my data is
present in the sheet 1 and I will press
load Excel and all data from that sheet
will come here
ok so
if you can see here my data is present
on sheet number one so cheat number one
is this here so I hope you have enjoyed
this video and learn something new this
time please rate comment and subscribe
and bye for now</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>