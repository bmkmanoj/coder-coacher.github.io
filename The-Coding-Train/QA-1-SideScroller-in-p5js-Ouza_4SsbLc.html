<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Q&amp;A #1: Side-Scroller in p5.js | Coder Coacher - Coaching Coders</title><meta content="Q&amp;A #1: Side-Scroller in p5.js - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Q&amp;A #1: Side-Scroller in p5.js</b></h2><h5 class="post__date">2016-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ouza_4SsbLc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm attempting to create a moderately
functional side scroller using different
forces and whatnot but the acceleration
of my object seems immediate and abrupt
going from zero and zero to acceleration
to an immediate constant acceleration
yada yada yada etc etc I'm looking for
advice how to simulate gravity so that
jumping can be implemented such as when
a user presses a key to jump a force is
exerted displaying that job okay I think
I get this question this is a great
programming problem I think we could
spend some time working it out okay so
let's talk about what I think we're
gonna program here to answer this first
question so let's imagine this is your
canvas and you have this sort of like
scene where you have this stick figure
and the stick figure is moving across
like a platform this is some standard
kind of game I think right somebody can
post in the chat not a plat for a game
it's like a side scroller maybe that's
what it's called and so this person is
moving this way and maybe there are like
different obstacles and what you want is
for this person this character to be
able to jump over those obstacles not
too dissimilar from like flappy bird
also I could flappy bird there's like I
just wanted to see if I could draw a
bird I my alien bird look with some
weird crazy dragon wings or something I
don't know oh my god I lost I lost in my
own fantasy imagination there for a
second sorry
oh so you can imagine this bird flying
this way and you press the key and it
pushes a force pushing up so one of the
things actually in most of my examples
any of you go back and watch all my
nature of code videos that are on
YouTube or the videos that are for this
cadenza course generally or see that I
have these forces being applied
continuously like gravity is always
there or an object is always seeking a
target so I think this is an interesting
thing to discuss what about a kind of
instantaneous force for example I'm just
standing here and suddenly this great
force just instantaneously pushes me up
from the bottom and I jump so um how
would you sing you like that and of
course like a key press or a mouse click
could do something like that so the
other thing that I think is interesting
about this problem is that you know what
what's moving right yes in the in the
world right if I move this way I move
this way right I'm right
here's this pen and I'm moving oh no I
can't do it I'm moving towards the pen
but what's not to say that the I can't
do this optical illusion the pen moving
am i moving or is the pen moving me you
can see because the back the point is
that was a terrible demonstration the
point is what happened what if I want
the background to move I want it to
appear that this person is moving but
they're actually in the canvas staying
in the same place so that's kind of an
interesting question as well so let's I
guess some let's go see if we can let me
come back here so let's see what's to
figure out where we're gonna program
this so one thing I should do I think is
let's not start from scratch so what I'm
going to do is I'm going to go to github
and I have a lot of code and a lot of
places what that means that sounds a
little weird
and I want to go to repositories and I'm
gonna look at this one for right now so
I have a lot of different nature code
repositories for various simulation and
physics examples this has some code that
goes specifically with that particular
online course so I'm just going to start
from there and I'm going to just
download it as a zip if you're wondering
about git and github for only zero
dollars and zero cents you can watch my
github tutorials is it popping up here
no because it doesn't do that but I do
have some good github tutorials they are
free you have to watch some ads I might
turn off the ads I don't know what to do
about the ads okay so I think I
downloaded that and what I'm gonna do is
show in finder I'm going to open up this
folder and session one session - let's
put this folder on the desktop just for
right now over here and let's find an
example to start with session two three
examples which to begin with let's do
the particles array one and I'm gonna do
but what we're doing is actually quite
different than these examples so I'm
gonna use this p5 editor even though I
haven't actually been using it recently
in these video tutorials I've been using
atom or sublime okay but
let's just let's look at what this
example is doing click it says here
click to add particles so ok so you can
see what this this is how my examples
typically look right my examples
typically look like okay there's a bunch
of things in the screen and there are
various forces one force is gravity
another force is wind so I think when I
click the mouse you can see that there's
this wind force suddenly being applied
so in that sense a force is being
applied one force is being applied
continuously the gravity force another
force is being applied only when the
mouse is held down but none of those are
just like a single one-time force but
let's at least look at where in the code
that's happening and then I'm going to
completely restructure this example to
do this platform thing ok so here here
in the sketch we can see this happening
here so there there are these particle
objects and the particle objects are in
a particles array and an apply force
function is being called on each of
those apply force gravity is always
being called apply force wind is only
being called if the mouse is pressed
basic structure for an example and now
if I go to the particle object here is
the key thing that I want to show you
this is the apply force function so I
you know I I don't know who's watching
this for where you're from or why you're
here and or if you've already left or
what but just to mention briefly these
examples are built on Newton's second
law of motion which is state it as force
equals mass times acceleration the
definition of a force is a vector a
thing that causes an object with mass to
accelerate so if I push something with a
force that object it has a mass it's
going to accelerate so that's written
this way force equals mass times
acceleration it can also be written as
acceleration equals force divided by
mass so if I go back over here to the
code you'll see that's exactly what's
happening here the apply force function
receives a force variable it divides it
by mass and it adds it to the object's
acceleration now there's a lot more to
say about that and so if you want to
kind of go back and what's a vector and
how did it get all the way to this point
then you could go and watch either my
it's just like a walking advertisement
for myself which it's kind of weird but
you could watch the nature of code
videos that I have on YouTube or better
yet you might just go and watch the
videos that are with on the cadenza
website for this particular course where
are we okay so now I need to completely
restructure this example because if
you're still with me what I'm trying to
build is this let's pick a game why not
let's make a game where you're a little
person or a big person or an alien or
whatever it is and you're running and
obstacles are there you have to jump
over that okay so here we go so I've got
a I don't know if it was so great to
start with this particular example
because it's got a lot of extra stuff in
it but I'm gonna do I'm gonna do save as
and I'm gonna just put this on the
desktop right now and I'm gonna call
this the running game this is that a
thing running game I don't know what
that is I hope it's not something like
weird that I just called it okay
so what I want to do here is now have a
person and I'm gonna say I'm gonna just
say the person forget about this mouse
press thing ah
Oh how's this font size I feel like this
font size needs to be a little bit
bigger uh that looks good I think you
could read that let me know if the font
size is okay uh Wow and this is
definitely a record that they're 80
people watching this on youtube right
now it's just kind of an mm okay the
person is a new particle and oh I have
this like I've so many things that I
want to do in these videos I you can see
how much time we have today it's 11:30 I
got at least to 1 o'clock 1 p.m. then it
will be attending there is an exhibition
at ITP of experimental storytelling
things anybody wants to stop and say hi
okay oh it's a little hot in here okay
so now what I want to do as I'm just
going to say let's I'm gonna simplify
some things this particle object is
going to be my person and I'm going to
take out this idea of mass because that
will make things a little bit simpler
and I am going to and I will review all
the pieces of this code one
I'm gonna say once things are kind of
going I'm gonna say person dot update a
person dot is it show or display let's
see what's the name of that function
display person dot display and and let's
just see and the particle and let's just
rename this a person and and I'm gonna
say new whoops I'm gonna say then new
person okay and let's see so what do I
have now if I run this good I don't see
any errors let's go no and then I'm
gonna go here I'm gonna just get rid of
this click to add particles from the
HTML file and run this okay that's
strange
didn't I delete that do I not save it
there we go okay there we go okay so now
I've got my empty canvas now okay so
what I love this person let's just make
the person a rectangle you will do this
someday on your own and make this more
interesting and actually I'm gonna just
simplify things and get rid of these
arguments and say the person is going to
be at pixel 50 and the location will be
at Y is height so I'm gonna draw this
person this is I'm everything is always
so tricky I'm gonna draw this person I
want to draw this person just as a
rectangle kind of sitting on the bottom
of the screen so let's see the so the
location is am i back here yet no the
location is the bottom of the screen so
now I want to in the display function I
want to make this a rectangle so a
rectangle at this x and y is the height
but let's say a height let's say that
the person is 50 pixels tall so this dot
Y minus 50 like 20 pixels wide and 50
pixels high and those should be
variables but let's just see if at the
very least we have I don't see the
person yet so what's what's missing
let's let's let's get rid of update for
a second let's don't see the person
let's see let's oh this
pause is the name of the variable it's a
vector object not individual X's and Y's
of course there we go so now we're
getting somewhere
we have a little square there at the
bottom and I want that person to move so
let's put let's put sorry let's put
update back in okay so I well I I'm at a
point now where I can take a moment to
breathe and kind of I just had to
restructure that example I probably
would have honestly been easier I mean
just program this from scratch but
that's the example we had so the person
has is an object with an update and a
display function let's look at what it
means to be this person the person has a
position which is where that person is
on the screen a velocity meaning it's
current change in position and an
acceleration which is the thing that's
going to be how does it velocity change
which is a change by a force so let just
to get a sort of experiment going here
what if I were to say in the what the
person's velocity instead of being zero
zero was is 1 comma zero so now if I
were to run this again we can see
there's the person moving so we could
see that velocity this velocity vector
controls the person's movement now
interestingly enough let's place an
obstacle in the scene I want to kind of
tackle this weird a viewport question
problem first before I get any too far
into this so let's let's place an
obstacle on the scene and I'm going to
just say obstacle equals I'm gonna say
I'm gonna make a variable called
obstacle and I'm gonna say obstacle
equals create vector and you know what
I'm just gonna have the yeah there's
totally different ways I could do this
I'm gonna say you know I'm gonna do I'm
uh we're gonna I think we're gonna want
an obstacle object so for right now I'm
gonna do something totally silly which
is just hard code something in so I'm
gonna make this a nice some sort of
purplish-pinkish color and I'm going to
say rectangle where this window is 640
pixels wide so let's stick it at 400
pixels make it 50 pixels wide
and fifty pixels high so I'm doing the
same sort of thing here like this
oh no 350 ah so this would be height
minus 50 okay so I'm just trying to draw
another rectangle that sits at the
bottom and so what I want is the idea
here for this example as this thing is
moving I want to press the spacebar and
have it jump over that obstacle this is
what we're going for
you guys still with me Oh ninety-four
people my my head is exploding oh my god
this is totally insane this is not very
good okay it'll get better maybe or not
okay so okay so here's the thing right
now we see the person moving towards the
obstacle what if I go and because the
person has a forward velocity so I want
to keep my physics kind of true to form
with that forward velocity but what if I
want to see the person in place on the
obstacle moving instead well
interestingly enough I think you know
I'm kind of honestly I'm not really like
a game programmer and they're like
they're by some very standard ways of
doing these things and then I might be
missing here but I might also just be
coming up with these sort of things on
the fly in exactly the same way but the
way that I would approach this would be
rather than setting the velocity of this
to zero and have giving this a velocity
what I might do is just move almost our
view of the scene always to be centered
on this particular character and the way
I can do that is with translate so the
translate function I'm going to write
this down the translate function and
this is a kind of function that exists
across most computer graphics
environments any type of OpenGL
programming environment processing p5
openFrameworks probably like three J's I
don't know they have their own way of
today is there are they with three J s3s
it whatever it has its own way of doing
things okay so what translate allows you
to do is move the point of origin so the
point of origin by default in a canvas
in the browser is the top-left corner
that is zero zero so this character is
drawn relative to zero zero but what if
I sort of think of instead of drawing
the character relative to zeros
but I always position the origin
relative to where the character is so in
other words if the character moves over
here then I just want to move the origin
kind of over here as well so that I
always see so then I always see the
character sort of staying in place now I
know that it may not have been the most
succinctly of explaining that but
hopefully that made some sense to you
and oh my god I think I might actually
hit the hundred people today and so what
I think I can do here is right here I
can add a train so let me just show you
what I mean by this what if I were to
just say translate negative 100 zero so
I move the origin negative 100 pixels to
the left what does this do to our scene
well everything is shifted over you can
see how right let me do that again so
and I'm gonna make this a variable I'm
gonna do something crazy uh yeah
I'm gonna show you some wacky JavaScript
debugging craziness because I just I'm
feeling like this is whatever today I'm
just I'm warming back up to doing this
on a weekly basis okay x equals x equals
zero so I'm just gonna put a translate
here and what I'm gonna do is I'm gonna
run this and I'm gonna go to this little
gear icon here so that I have a nice
little JavaScript console and right now
if I say x equals negative 100 you can
see how I'm shifting things over right
so I'm live updating that value of x to
kind of move where that origin is to
move my view of the steam like I need to
move the cants kind of like moving the
camera over so I think a nice way of
doing that wasn't the greatest
demonstration I thought was coming much
more interesting I think what what would
work really well here is what if I just
say person dot position X what if I
always just offset the view by that
person's x position only not it's
expedition negative its x position
because as that person's moving I want
to offset the view further back so let's
do that let's run this and you can see
look at that
now the obstacle is moving so the
physics haven't changed right the
physics of this scenario are a hundred
percent the same it's just our view is
changing and I could
like weird stuff like I could say like
times 0.5 and then you kind of have this
like weird like the view is it's like
the cameras moving but not as fast
anyway that's kind of that's kind of
crazy it's hard to see it just looks
like they're crossing but if there are
multiple things moving at different
speeds
you might even get some kind of crazy
parallax effect but anyway I'm going to
keep things simple right now and just
keep this only I don't want the person I
think all the way at the left I like
them kind of shifted over so I'll just
shift it over by like fifty pixels so
you can see this is now my view of the
game and what I want now is when I press
the spacebar for the user to jump and
guess what this is actually super easy
it's not super easy in general but it's
super easy because all of the work of
building a kind of mini physics engine
into this example is already there now
admittedly I haven't I didn't do that
work in today's session but if you're
following along and the other materials
you're kind of that's you're sort of
ready for that so in other words we are
this is easy because I already have this
apply force function so I have a
mechanism for saying here's a vector
stick that vector in the object and
normally that vector is put in normally
I don't know it normally means but as
you saw in my other examples that vector
you might be put in draw so for example
if I were to say a force is create
vector and I'm just gonna give it like a
little push to the right so that it goes
faster actually let's have it let's give
it a little push to the left so that it
slows down this will be interesting
and then if I say person dot apply force
you can see now how the person is
slowing down and suddenly moving
backwards and it's weird cuz it really
looks like that other thing is moving so
hard to like get your I think you know
like more complex scene with lots more
things you would have more the sensation
of the of this particular character
moving but you can see here now if I
could also do something like if mouse is
pressed only then will I apply this
force so here the person is moving I
want to slow down slow down slow down
slow down
go back up back up back up back up you
know it would also help if the person
was a little animation of like a running
person you know obviously there's visual
cues you could add to this to me
is better okay so you can see this is
how we apply a force now what I want to
do is apply not a continuous force in
draw over and over again but a force
only when a certain event happens so
what I'm gonna do is I'm going to add a
function this is something specifically
the p5.js library that function is going
to be called key pressed ah
okay boy I'm usually such a good typist
in today it's just a disaster and what I
want to do is I'm just gonna check like
if the key is the spacebar that's a
really easy way of just checking like
what key was pressed if the key is the
character space then this is where I'm
gonna apply this force so what should
that force be and I'm gonna call that
that a variable jump and I'm going to
say create vector now I want the user to
do what jump in the air straight in the
air so I'm gonna just give it a force
pointing up which is 0 comma some some
negative number now normally if you
don't really in a lot of my other
examples you'll see generally forces
have very small amounts point one point
zero one point zero zero two three seven
nine eight four one I had a joke there
that I forgot to do but I'll make it
happen later it was a terrible joke
anyway um so I just like lost my breath
for a second train of thought okay so
normally you want to like a small number
because if a force is something being
applied continuously that thing is going
to the objects acceleration continuously
and numbers can get out of control very
fast and that kind of canvas animation
environment things going crazy but this
is an instantaneous force for it to have
an effect it needs to be something
rather large so let's make this negative
one and then I just want to say person
dot apply force jump okay so let's see
if this is enough for us okay here comes
there we go I'm jumping now
interestingly enough I win I fly to the
heavens I was an easy game a no obstacle
will ever hit me again so why did that
not appear to do anything like you might
imagine it should well remember if if
you apply a force to something moving up
it's gonna move up and if there's no
force to push it back down it's not
gonna move down that's like Newton's
slow motion so we need to have gravity
in this world and so and that is a force
that should be applied continuously in
the opposite direction so I'm going to
create a vector and I'm going to make
this sort of a small vector and I'm
going to say person dot apply force
gravity so now I want to continuously
apply gravity oh I hit a hundred people
that's very exciting hundred and three
people are watching YouTube I should
check the chat is it still working okay
now so look at that what happened now
who knew right we've got a problem
gravity was applying and there's
apparently this is a quicksand
simulation right so I don't have a sense
of the ground here now this is where we
get into a lot of trouble with our
wanting to be true to the physics of the
world you know in truth gravity is a
force on me so my body is applying a
force to the floor and then there's like
this like the third law of motion with
the equal and opposite and there's you
know tension force because the floor is
attached to some beat I don't I'm lost
already but I think this is a scenario
where oh it's just a rectangle on the
screen so I think we could probably just
say you know what don't go below the
bottom so in that sense one of the
things we could do and I'm this this
particle this person object actually
from the previous example has this edges
function and so let's use that function
and let's forget about this this aspect
of it let's just say okay what do we do
if this object is going below falling
below the the window itself so this old
code here this old code like this old
house anybody ever watch this old house
on PBS I kind of is this kind of like
this old code instead of coding rainbow
master just called it this old code
anyway let's see if anybody gets that
reference I don't even know if I do it
should sort of like this weird childhood
memory that like popped into my head
so this old code I did have a point here
was a bouncing code so something is
falling it's velocity reverses direction
and turns around so it's for bouncing
but I don't really want bouncing here
right now I mean I might want bouncing
what I want is jump and stick stick the
landing kind of gymnastics stick the
landing so so what I'm going to do
actually is
just going to multiply its velocity
times zero meaning if it hits the bottom
its velocity multiplying its y component
of its velocity makes its y velocity
zero I mean it's instantly stuck to the
bottom that's like the least accurate
physics simulation thing I could ever
possibly do but I think it will work in
this case and then I also just want to
like let's keep the position at the
height so let's not get into like a
weird thing where it's like a little bit
below if it goes below at any point stop
it from moving set it back to the bottom
so now if we run this up okay person is
not defined so I must have a syntax
error somewhere so this is this is a
good thing to happen because this will
happen to you let's look what about what
what did I add let's oh I think I added
I think I lost a curly bracket that's
all I did
so look this this closes this curly
bracket this closes that curly bracket
and then I needed a curly bracket for
this whole person constructor function
okay so let's run this now up by the
quicksand is still active okay so I
think we have a problem which is that I
just didn't call that edges function
here so I also want to after I update I
want to call edges to do that test for
the edges you can see the person is not
ball anymore now I could press jump oh
boy so that force is way too weak I'm
not making it over that square any time
soon so let's kind of just play with
some numbers here
let's give it like make it ten times as
strong there we go
whoa that was a really high jump Oh
quick okay so that worked so you know
maybe let's try half split the
difference it's pretty good
I might have to actually time this
correctly okay so I'm kind of a basic
idea I would love it if some of you
watching this perhaps when I post this
code later take this code and kind of
kind of put your own spin on it try out
an animation add a character at a sound
add multiple obstacles maybe think about
the view the view is like a little bit
weird right now
but anyway</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>