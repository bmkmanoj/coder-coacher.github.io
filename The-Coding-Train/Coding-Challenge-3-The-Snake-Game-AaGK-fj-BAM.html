<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Coding Challenge #3: The Snake Game | Coder Coacher - Coaching Coders</title><meta content="Coding Challenge #3: The Snake Game - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Coding Challenge #3: The Snake Game</b></h2><h5 class="post__date">2016-04-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AaGK-fj-BAM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to what today will be
a 15-minute coding challenge I am going
to attempt to program from scratch in
JavaScript the snake game I don't think
I've ever done this before perhaps I
have certainly made stuff that resembles
it but and if you're not familiar with
the snake game pause this video google
it play it I think you'll find it ok so
let's just get started we don't I don't
want to like spend some time getting to
know you but I can because I only have
14 minutes and 30 seconds right now so
the first thing that I want to do is I
mean P I'm using a JavaScript framework
called p5.js and p5.js requires a setup
function and draw function and the first
thing I'm going to do is just make a
canvas that is I don't know 600 by 600
pixels and we're going to go over here
to look at this page there we go there's
a canvas there it's empty boy I got to
move faster than this and now we're
going to give it a background I draw and
make sure things are up and running
that's good so I've got a canvas you
know maybe I need to move this over it's
kind of under the timer but whatever you
get the point
there's the canvas I timed the way okay
that's fine well it'll get better next
time so so let's see what do we want to
do here so I'm going to do this with
some object-oriented programming and I'm
going to write something called a
constructor function I have some
tutorials about constructor functions if
you don't know what that is and what I'm
going to do is make an object that has
an X and a Y and I'm also going to keep
track of an X speed and a Y speed
because what I want and let's just make
this one what I want is for this snake
object to have some functions like an
update function and what happens in that
update function is that x value simply
changes by the X speed value and the y
value simply changes by the Y speed
value now I want another function I'm
going to call it show because what I
want is for I want to draw I know I'm
going to draw a rectangle a rectangle at
this dot X this dot Y that I don't know
ten by ten and I'm going to make that
tango white so the point of this is I
want to have this simple object it's a
snake object it has an x and a y &amp;amp; x
beam and y speed it's going to move
around the window and it's x and y move
based on that x and y speed so at the
beginning of the program I can create a
variable I'm just gonna name it s maybe
I would want to name it snake in a sort
of more normal day of my life
but this is a little bit of a rush
little project here so I'm gonna just
call it VAR s and I'm going to say s is
a new snake and then I'm going to say s
update and s Joe and I want to move this
snake object to another file javascript
file at some point but I'm not going to
worry about that too much so I'm sure we
got some stuff wrong but say I look
there it is there's my snake it's moving
across the window I sneak go come back
no going okay whatever okay so um now uh
so that's pretty good okay
what happened to the snake game I think
if you press the up arrow it goes up
press the down arrow goes down left
arrow so we can add something in p5 we
can add a function that's just sort of
like a global event called key pressed
and I can say I think if key equals up
arrow oh boy I hope that's right
Oh key code I think with these you want
to check a built-in variable in p5
called key code then I want to say to my
snake I'm going to give I'm going to set
a direction like move a zero along the
x-axis but negative 1 is up so you can
see kind of this idea that I'm doing
here which is a boy I hope these are
right which is this idea that the the
snake is going to have a new function
that's going to allow me to set its
direction and if I press up I want to
set its direction to zero negative one
down zero one and then I also want to do
right and left so let me quickly copy
and paste this two more times and I need
a right arrow and a left arrow and if if
it's moving to the right it's X is 1 and
it's Y is 0 if it's moving to the left
it's X is negative 1 and it's Y is 0 so
of course this isn't going to work now
we can we can run this and I can start
hitting keys but it's going to say FDR
is not a
so I made up this idea of a function
called dir for direction but I need to
actually add it to my object and you
know what let's let's be ambitious here
let's take this object and let's make a
this is a little bit dangerous what I'm
doing here
let's make a separate file I'm going to
call it snake J s I'm gonna paste it
back in there and in my index dot HTML I
am also going to add a reference to
snake J s this just allows me to
organize my code a little bit
differently so I can have sketch J s
which just has set up draw and key
pressed and I can have snake dot J s
which is just the snake object o my
timer thing is in the way of my code a
little bit I got to work on this bar
okay that's a little bit better so you
can see this is to all the code the
constructor function for making this
kind of object but what was the point of
doing that I need to add another
function called this dir and the point
of that function was to receive two
values and x and a y and to use those
two values to actually set this object's
direction so now if I receive an x and a
y that's what the X B and Y speed become
and if I go back to sketch J s I can see
here there we go that's what I'm doing
here okay I got we got worried that my
audio stopped working or something but
it seems to still be working I do feel
like I'm a little bit loud today I'm
gonna turn this down a little bit it
shouldn't be doing this live and roll
the video but whatever okay so now if I
do this we should see press down.press
to the right press down.press to the
left you can see now let's do something
here and let's - let's think about this
for a second we want the snake hmm one
thing we need to think about here and
there's a lot of different ways we could
implement this but the canvas you would
really want to think of it as a grid
because the snake is actually going to
be a large rectangle and as it moves
it's going to move to the next spot in
the grid the next spot it moves down the
next spot so we need I want some sort of
variable to keep track of the size of
this grid I don't know what to call it
call it R call it R let's just call it R
let's call it let's call it s CL to
stand for scale I don't want to call it
scale because scale is a built-in
function in p5 so I'm gonna come back
over here and I'm going to add a
variable I'm going to call it SC l for
scale and I'm going to make it 20 and
then actually that's kind of
that's a global variable and in the
snake I want to have everything based on
that so I want to move by the X speed
and this is really just the X mean Y
speed is really just the direction and
then I want to draw the snake at that
scale and now if we go back to uh the
browser and I hit refresh
oh it's so fast right so oh you know a
couple things let's just add some code
really briefly to constrain it this dot
x equals a p5 has a function called
constrain where I can say hey take this
value like X and constrain it between
zero and the width and you know what the
width - scale because I don't want it to
actually go off it's a rectangle drawn
from the top left and this dot Y I'm
going to contain it to constrain it from
this dot Y to the height - scale how do
I get seven minutes left we're getting
somewhere
okay so now we can see that this is kind
of working this is ultimately going to
be my snake now you know I might not
like what I'm about to do next in most
cases but I think it's going to be fine
for me to just really reduce the frame
rate because the snake game is kind of
this like low res throwback thing it's
gonna so I'm just going to globally in
p5 in my setup I'm just going to say
like frame rate and I'm just going to
say 10 and now I'm going to refresh it
again and you can see this looks sort of
like what the snake game might be okay
so we've got that I can now press arrow
keys and move it around what are the
things that are missing now the snake
game random bits of food appear when a
bit of food appears the snake tries to
eat that food when the snake eats that
food it gets a little bit longer and if
the snake ever runs into itself it dies
oh boy that's a lot of stuff to do with
6 minutes let's get started ok so the
first thing I want to do is let's add a
piece of food so um I want to whoa boy
this is a little fine fine it's fine
it's fine let's just do it no problem no
problem - problem let's want to make a
food object but we don't have a lot of
time maybe I'll refactor that in later
let's let's just make a let's let's make
it a vector so I'm going to use create
vector which is a quick and easy way to
store both in
and of course I didn't use the vector
and the snake but whatever it's fine
we could be a little messy for fun today
create vector and I'm going to give it a
random spot in the window and I'm going
to in a draw I'm going to I'm going to
make my food a nice like purple or pink
color and I'm going to draw food X food
Y and I'm going to make it the same size
and now we can run it we can see up
there's my food I want to come and get
my food now it's not exactly on the grid
so I should probably deal let's make
this correct so what I actually want to
do in terms of its location is I'm going
to make a function that us call pick
location and what that function is going
to do is first we need to know what are
the number of columns so it's the width
of the window
I mean divided by that scale and then
the number of rows which is the height
of the window divided by scale and then
now I want to create a piece of food
that is a random column and a random row
and I also want to use floor with both
of these oh boy you know this is getting
to be a very long line of code here but
so what did I just do I wrote a function
that picks a location because I wanted
to I want it to be only one of these
spots in the grid so I have to divide
this is spot zero one two three four
zero one two so I need to divide by how
big that scale is by the width to pick
one of those integers and then I
actually need its actual location I want
to multiply it by that scale to expand
it back out so and the floor function is
everywhere just because I need these
things to be whole numbers for this to
work well so now you can see this should
the food let then don't seem to work
oh sure we sure acted that correctly
that's right uh it's a little bit off
maybe I'm not going to worry about that
right now somebody will somebody will
correct me correct this later it's close
enough I'll fix that later because I
only have four minutes left so what I
want to do now is figure out I want to
write a function
se2 food I want to do something i
expanded myself by five minutes a day
clearly that's not enough time
I want the snake to eat the food so in
the snake object I need to add another
function called eat
technical difficulties but I'm back and
we're I what I'm doing right now is I'm
writing the function where the snake
eats the food so we need to check if the
snake is at the same location of the
food and uh okay actually I thought I
was having technical difficulties I
realize I'm missing something important
which is we have this whole pic location
function but I didn't actually call it
up here I need the foods location to be
at this thing that I spent all this time
doing is to make sure it's on the grid
so now that should solve that problem
where the food is perfectly aligned on
the grid with the snake but let's go
back to where we were
snake eat location so in the snake
object this means I need to write a
function called eat and this function is
going to receive a position a vector for
where that food is and I could check if
they're in exactly the same space but
I'm pretty sure that if I just use the
distance between like where the snake
actually is x and y to the where the
food is x and y and if I just check if
that distance is less than like one
pixel I should probably check two pixels
or three pixels but whatever I'm going
to say return true in other words I want
this function to tell me whether or not
the snake reach the food and if it's
true what do I want to do with this
information so I'm going to come back
here and I want to say oops
if the snake eats the food then I want
to what pick pick a new location oh you
know what I realize it's not eat food
does not equal pick location this
function I wrote just set the location
for that food itself so I could just
call pick location again it's not
returning anything boy my mind is
getting fuzzy towards the end of these
videos there's only two minutes left
let's see I think we're going to be
really close now so now we should see
I'm going to move come on be on the grid
look at that it's right on the grid and
I can eat that piece of food and it'll
go somewhere new oh this is fun to play
I don't have time to play this right now
I gotta keep moving okay so what do I
need to do if it gets the food it needs
to become longer how do I keep track of
a snake that has a length to it well I
need some sort of array some sort of
variable to keep track of how long is
that snake so let's go back to the code
we got to go back to the snake object
and let's add something called this
total and that equals one because the
snake and you know
let's actually I'm going to do something
a little bit goofy which is that I'm
going to keep the X and the y is the
current location and the array that I'm
going to store the length of that array
is just its history so at first it's
zero because it only has its current
location and the rest of it this is
actually going to be useful later I just
realized and I'm going to make another
variable called tail which is going to
be an array so one thing for sure is if
it eats the food total should go up by
one so total should go up by one now as
it moves I want to have a loop what goes
in this loop well I definitely want to
loop through that total and actually I
want to do all of this right before
right before it moves oh boy I kind of
need to work this out only have 38
seconds if I need to work this out a
little bit in my head here so if this is
the array and this is the snake's
current location maybe what I want is to
put its current location pre in the in
the last spot and shift everything down
the history down so this is this is
where it was four times four moments ago
three months ago two moments ago one
moment ago
that'll do so the first thing I need to
do in this array is shift all the spots
so I really actually want to loop
through total minus one and I want to
say tail index I equals tail index i + 1
that's going to do I'm sure my time is
expired now we're gonna see how long
this takes I'm going to just click a
little window here I'm gonna hit OK it
stops it one second and it's gonna say
time expire you know what yeah no leave
that there what's the what you'll see
how long this video is and that's how
long it took okay so this is going to
shift everything over by one and then
what I'm done I want the very last spot
which is tail total - 1 2 equal create
vector this dot X this dot Y so this now
allows that's its current location and
then it can move and so now
when I'm drawing it in addition to
drawing the rectangle at its current
location I need to also say draw all the
rectangle draw its tail so I want a
rectangle at tail index IO and I realize
I've made a classic javascript error
classic javascript error I've got this
thing called tail which is really
important but it's this dot tail tail is
part of the snake so everywhere I put
tail
I forgot this dot tail this is this
happens to me all the time this is like
the bane of my existence everyo in vista
total also oh boy so I think I probably
I'm looking around this detail this
detail this detail this total this total
I should just have a big blinking sign
in front of me that just says this dot
this dot this time okay let's run this
and see if this works now hit refresh I
don't know I'm sure I missed something
and come on eat that food ah total is
not defined on line 12 so there's a
place that I forgot it
line 12 this dot total plus plus let's
hope we didn't miss okay I gotta try to
look at the camera to make eye contact
with you oh no look at that
the snake is Oh cannot read property X
of undefined snake Jan has 42 okay it
extended by one but how come when it
extended by two it didn't work line 42
line 42 this seems totally reasonable to
me so what happened this this show is
always happening okay let's think about
what order all this stuff is happening
maybe that's the issue oh boy I look at
it okay look at this one this video is
going to be a little bit long because
I'm going to debug this now
back again a little bit of splicing and
dicing here but I'm going from where I
I'm going from where I want to add bits
I want to add the tail of the snake so
when the snake eats the food the total
goes up total is keeping track of how
many bits of history of the snakes
length do we have left so I know it what
I want to do is anytime this total does
not any time so okay one thing I need to
do is I always need to shift and
actually have a diagram I'm going to
just add to sit here okay what I need to
do here is I always need to shift the
tail down I need to shift everything
down in the history so I'm going to say
this dot this dot tail index I equals
this tail index I plus 1 this is going
to shift the spots down as the state
moves all of its all of its spots shift
down so I can get the new spot in the
end of the array right because what I
want is to then say this dot tail index
total minus 1 equals the new location so
I have this array that always shifts
down and I get I have this array that
always shifts everything back and then
the new spot goes in the end so let me
explain to you what I mean you have this
diagram from my technical difficulty
parts but I'm over here now come oops ah
boy everything is falling apart today
come on over here button so in other
words I have this array let's just
imagine for a second that this is the
history of where the snake has been so
the new location is going to go in the
end and all the other spots will shift
down and the oldest location will be
deleted so this is what I'm doing here
now if however the if however the snake
is eaten a piece of food it should
actually get bigger and the new location
should go over here
so if you
about this what I'm saying is there's
two different possibilities if this
total equals this tail dot length
meaning no food has been eaten so the
total is the same as the existing array
length then just shift everything over
and give me my last spot otherwise only
put the new spot in and I don't need to
shift so in that sense this can go over
here so the shifting this is a small
tiny nuance but the shifting only
happens the shifting only happens if we
haven't eaten any food because the new
spot has to go in here everything else
to get shifted over if we've eaten food
we just add a new spot on and now whoops
a tripping over like now we should be
able to run this and see ah but you know
what I need to add to draw I need to
also in in show in the show function I
need to also draw a rectangle where
where everything is oh I'm losing steam
here today okay so I need to draw a
rectangle at this dot tail index I dot X
and this tail index I dot y all these
will be white and I was mucking around
with this make this 20 refresh oops
total is not too fine I forgot the Vista
and somewhere here underline 30 this
total classic JavaScript error always
forgetting that this dot okay here we go
now run this again come on I'm going to
eat this piece of food and my snake is
going to be two rectangles long I'm
going to eat another piece of food it's
three rectangles long another piece of
food it's four rectangles long guess
what now
now we need to figure out when should
the snake die now I should do something
if it hits the edge but I'll add that in
another day what I'm going to do right
now is if the snake hits part of its
body then it's dead so this is something
we can really just write a new function
for this dot death I don't like the word
death it seems so this die will find
we'll just use it that's how that's what
it is
so what I need to do is loop through
every spot in the tail and remember the
tail does not include its actual a head
this taught this dot tail dot length and
what I'm going to check and see is if
right so I'm going to look at each
position which is this dot tail index I
and let's look at the distance again
just like how we checked if it ate the
food let's look at the distance between
the X location and that particular spot
on the tail if if distance is less than
one like if it's really gotten there if
really want to check if they're exactly
equal but I'm just since they're going
if it's less than one then I'm going to
set total back equal to zero and this
dot tail back equal to nothing so we're
just going to have it go back to nothing
so this is now checking if if if if it's
front location as ever right if it's if
whatever is in the new spot is connected
with any of these and we need to make
sure we do this before we shift anything
in because we don't want its current
spot to actually have shifted into the
array so now we should be able to go
back to sketch and I should be able to
add right up here after update let's do
this
yeah I think I don't think it should
matter but I'm going to check it before
I update it that makes sense right
actually you know what I think I need to
do is I need to check it no no no this
is no good this has actually got to be
thought to be thoughtful about this I
actually want to check it when I want to
check it right here the moment X moves
to the next spot which is fine because I
want to check it it does this after and
then I check and then I do all this
shifting so that should actually be fine
so we're just going to say s death right
here we're going to run this now I got
to get it to be a little bit long so
to play this for a little bit and get
good at it
3 Oh big problem I can't hit the edge
hitting the edge is very bad let's start
over
and let's I'm gonna deal with the edges
later let's just not hit the edge ok I
think I could probably once I'm for a
length four I could probably uh go
backwards that I should oh no no I just
died there because I went backwards ok
everybody hold on let's let's let's
let's have a little bit of a let's
actually let's go back to this and let's
console.log starting over there's a
really easy way to test this I should
which is just to be able to go backwards
which I probably should protect against
so let's be let's be a length 1/2 yeah
you can see I started over because I
just went backwards so we should
probably not allow the snake to ever be
able to go backwards but let's so I'm
going to add something in right now
which is I'm just going to add a mouse
pressed and I'm going to say s dot when
it sort of cheat by just saying every
time I press the mouse I'm going to as
if I'm eating food so we can really test
to make sure this is working so I'm just
adding a lot of spots and now we can see
that works so if I ever intersect one of
my existing spots I have to start over
so there's I'm going to end this now
because that's took on we kind of have
the complete game basically we have the
snake object it has a few bits of
functionality right it can check to see
if it found a piece of food by checking
the distance between it and the food if
it is it increases its size we can move
it which means it keeps track of its
history shifting everything down it
moves to the next spot
and it's keeping itself on the screen
and it's also now checking to see if
it's intersecting with any of its
previous spots so what's missing which I
will add later after the fact if when
you look at the code for this is it's
missing number one is it shouldn't be
allowed to go backwards maybe it should
be but you know your as the user of the
game should just not know not to do that
and also I need to deal with the edges
so I should also add something in this
death function that if you hit an edge
maybe of the window you also you also
kind of lose your life so to speak which
actually I just realized is happening
because of this constrained because
constrain keeps it in the same place as
it was previously which means it'll then
we figure out that it's just that it
that it's intersecting where it was
previously and and and call starting
over so that's actually working okay
this is um so and see</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>