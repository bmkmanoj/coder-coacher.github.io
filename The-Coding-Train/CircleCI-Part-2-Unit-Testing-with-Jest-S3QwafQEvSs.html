<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CircleCI Part 2: Unit Testing with Jest | Coder Coacher - Coaching Coders</title><meta content="CircleCI Part 2: Unit Testing with Jest - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CircleCI Part 2: Unit Testing with Jest</b></h2><h5 class="post__date">2018-02-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/S3QwafQEvSs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right you've returned perhaps from
somewhere else or I don't know some
weird machine learning algorithms sent
you here if you haven't watched my
previous video which introduces the idea
of unit testing and continuous
integration I would recommend that you
do this tutorial is sponsored by circle
CI link to find out more right here
maybe I don't know I don't know how this
magical post-production stuff works and
but what I'm gonna do in this video is
I'm actually gonna make exactly what I
talked about here I am going to make a
sketch dot JS file that has a little bit
off script code in it I'm gonna create a
node project so I can run a unit test
I'm gonna push that project to github
and I'm going to link it with circle CI
so that the test will be run before I
can merge any changes now github merge
know what do all these things mean I
will also provide some links to videos
that you might want to watch before
arriving here if you haven't used any of
those tools before but yeah I'm just
plopping you right in the middle here if
you've never programmed before no maybe
maybe maybe this thing will be
interesting here but yeah okay that
gonna be right so what what do I got
this is my coding train github
organization and so what I want to do is
I want to make a new repository but I'm
gonna do it in a slightly different way
I'm not sure why but I'm just going to a
first one I'm gonna do is I have a nice
folder here on my computer called
testing test test testing death test is
the name of my new project cuz it's all
about test test testing it's testing and
I'm going to make a file in it and I'm
just gonna call it sketch j/s and I'm
going to this by the way I'm going to
use the testing framework that I use in
the MoMA I'll show you something called
jest I'm basically gonna do the example
that's in the getting started tutorial
and jest not my invention here so I'm
gonna write a really simple function
called the sum and what its gonna do is
it's gonna return the sum of two numbers
so again I'm showing you a completely
trivial example that's kind of silly and
and and and obvious just to unsee what
all the pieces are and how it works and
then hopefully what I'm gonna do is
after this I'm actually gonna add some
unit tests to my neural network library
thing that I've been working on in some
other video tutorials but I'll get to
that later so I'm just writing this now
what do I need to do well in order to
run the tests I need to I need to make a
node project so one way that I can do
that is by by the way in terminal and
I'm in my directory testing test test
and I'm gonna say NPM in it that's a way
to create a node project in that
directory really all this is doing is
making the package.json file which is
the configuration file for your node
project and again some other node
tutorials I have go through this a bit
more so I'm gonna do this and it's
saying this utility will walk you
through creating a package blah blah
blah I want the name to be testing test
test it's version 1.0 it is all about
all about testing test testing test test
an entry point is sketched yes we would
even auto-detected that was in there
test command whoo the test command now I
don't have to do this here because they
always change it later but I know what
it's gonna be it's going to be just just
is the amande like JavaScript test test
just anyway just get repository oh I
don't have one yet
hit enter keywords testing test then
author is the coding train license MIT I
don't know and then I would say okay and
then now if we look back in Adam look at
this this new file has appeared the
package that JSON file and that is the
file that has all the configuration
settings for my project this is the main
file there's a test script I can run
called jest it's all about testing it's
by the coding train in its license MIT
etc okay so now let's go to the jest web
site and I'm gonna actually click on get
started so one thing that I can pull
from here is if I want to run a test
with jest
I must install the node package jest and
again I'm we refer you to my video about
node package manager and a lot of you
who have experienced this will be
telling you why aren't you using yarn
because supposedly that's better for a
variety of reasons I'm sure I will hear
about but I'm still in the world of NPM
so I'm gonna grab this and I'm going to
paste this into terminal now I just want
to mention what the I
shown in other tutorials what - - save
means that means I want to use this node
package in my project for example I'm
doing something on text analysis so I
want the no natural text analysis
package I'm going to say npm install'
save node natural but save dev means I
am using this but only for the purpose
of development my project itself when I
publish and release it is not doesn't
mean the gest package I need just just
for developing it so I'm gonna hit enter
and what put on my waiting music did you
get only finished okay and now we're
good now just to double-check this look
at this package a json now has dev
dependencies jest version 22 point one
point four so that - - save - dev put it
here in dev dependencies so ID now I
have my testing framework now how do I
write a test one of the things you might
remember from when I was looking at the
p5 project is the source folder had all
of your JavaScript code and the test
folder had all of your testing code and
they were the identical directory
structures for every directory or
JavaScript file there was a
corresponding directory JavaScript file
for testing and this is a fine way of
doing it from what I understand it can
become a bit unwieldy after a while to
kind of keep these duplicate directory
structures just provides a bunch of
different ways of doing it through
basically the keyword test and there's
there's a way of having a folder that
has tests in it but what I'm going to do
here that's the easiest thing in the
world is I'm just gonna make a new file
and I'm gonna call that file remember if
it's test dot sketchy-ass or sketch dot
test such as pretty sure it's sketch dot
test touch ass let's try calling it that
and then let's go back to the getting
started page and see what it says some
so this is example that by the way I'm
doing exactly the same example I'm
creating and it says the kre-o file
called some test is so you can see just
is going to know that this file is
associated with this file these are the
tests for this file so now I need to
write those tests boy so I am going to
go and just keep falling along with this
and I'm just going to to be honest with
you copy paste the code
the example and later I'll try to write
my own test in a more interesting way
and we can see this makes sense
there is a function I wrote called some
that receives two numbers and returns
those two numbers added together so you
can see this is now the syntax the API
to expect as a function to be as a
function those are functions that are
part of jest right some is my function
test is part of jest and this is written
with a really nice lovely es6 arrow
syntax just just just to like unpack
this for a second even though I like the
way this is written I will try to write
test this way to you what I'm gonna do
is I'm gonna just break this out into
multiple lines of code just so you can
just so you can see it in a slightly
different way and just give me a second
while I do this in the most convoluted
manner so what this is saying here now
you can see it's like I want to run this
test this is the name of my test and the
function to run the test is called some
test and it's down here so this is just
it's exactly the same as this but it's
just written in a kind of more
long-winded less traditional like less
fancy newer way of writing JavaScript
all right so I think we're kind of ready
I missed some stuff here which I'll get
to good I wanted to fail these first I
have my JavaScript file and I have my
testing file so there's no reason why I
couldn't now and in package that chase
saw Jason it says test jest and I have
the dependency okay let's let's try it
so now I'm here I'm gonna hit clear and
I am going to say here we go
NPM test
one failed now
I already know I failed cuz it kind of
did that on purpose because I don't be
nice and like see the test fail but we
can actually see why did it fail hmm
constant sum equals required dot slash
some Oh what is that cannot find module
dots some all right so here's the thing
I'm making use of a feature of node that
is not necessary when just doing
client-side programming which is a
client-side program might have an HTML
file which just imports all of the
JavaScript files I'm using but know we
need to do this more explicitly and this
is a little tricky here because maybe
you could make the argument if I'm
writing client-side code I should run
like tests in the browser and there's a
whole big world it's like possibilities
here but I'm trying to stick to the very
very basics the simplest possible
scenario and if we look here in sketch
that we can see constant sum now for it
well constant that's a I could say let's
sum but this is good it's not going to
change now can it not gonna be
reassigned constant sum equals required
dot sum well what this really should be
in my case is dot sketch this is a way
require is saying I am going to require
another JavaScript file dot slash in the
same directory called sketch touch yes
then that's do you think that would be
better now I'm still missing a piece I
mean I'm not even going to pretend that
because I know this is gonna run it
didn't fail some is not a function so
that's a different error message the
reason why imported that file correctly
but I didn't export it so this is one of
the things I do I just say export dot
modules no module dot exports module dot
exports equals some so this is again
there's a lot more to this in terms of
how you can link in reference different
files but on a very basic level this is
saying this node module should export
the sum function that's the one I want
to testify it multiple functions I could
export multiple functions there's a
variety different ways I can do this so
now here we go
whoo-hoo okay so they test pass so this
is basically if this is MIT alum I've
kind of come to the end of the testing
component all I've done so far is
created this I wrote my code and it
could have been a p5 project I the
module thing is gonna muck that up a
little bit so maybe I'll show you a
little trick about that in a second but
all I've done is write this part so the
next things that I need to do is send
this project up to github and then
figure out a way to allow anybody
contributing it to it to have the tests
automatically run be a circle CI okay so
that's going to happen in the next video
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>