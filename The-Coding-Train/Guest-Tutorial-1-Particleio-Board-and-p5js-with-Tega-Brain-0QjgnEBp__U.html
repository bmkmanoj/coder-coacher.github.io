<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Guest Tutorial #1: Particle.io Board and p5.js with Tega Brain | Coder Coacher - Coaching Coders</title><meta content="Guest Tutorial #1: Particle.io Board and p5.js with Tega Brain - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Guest Tutorial #1: Particle.io Board and p5.js with Tega Brain</b></h2><h5 class="post__date">2016-11-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0QjgnEBp__U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to another video tutorial
in this video tutorial you will not be
listening to me as I've mentioned on
many of my previous live streams on
their videos I'm hoping to have a
playlist of many guests coming in to
present on a variety of topics in
particular topics that I might not use
in my regular programming life and so
I'm excited to try this new experiment
with essentially we I had a guest before
the interview but this is the first
guest tutorial with tika brain so this
is teeta's website tiga is an artist and
educator she teaches at a variety of
places including school for poetic
computation which is the school where I
am standing right now SFP CIO that
you're interested in if you're
interested in that's the URL and tika is
gonna show you some stuff about physical
devices and sensors a topic of which I
have a sort of pathological fear of
anything physical which is why I tend to
stick with software so excited to
introduce and have tiga here in the
studio with a couple different video
tutorials and here she is
hello today we're going to be talking
about environmental sensing and how to
connect a couple of different forms of
microcontrollers to p5.js and we're
going to be making data-driven
animations so because we live in this
time where there's a lot of excitement
about the Internet of Things there's a
lot of excitement about wireless
technologies there have been a whole lot
of different options and different
boards that have come out that allow us
to connect a microcontroller wirelessly
to a server somewhere and then using p5
we can connect to that server and use
the data or control that little
microcontrollers that little computer in
various ways this is exciting because it
means basically if you think about a
microbrew control microcontroller is a
little computer it means that we can
build circuits on these microcontrollers
that allow us to collect data and place
sensors in different weird places to
collect information about the
so imagine if you wanted to create some
sort of animation that is using data
from a particular environment or a
particular location of your choice if
you can set up a wireless network here
in that place you would be able to set
up a sensor network or collect
information from that site put it onto
the cloud you know online and then
create some sort of p5.js animation that
can allow you to use that information
coming from that particular site so this
stuff is really interesting and there's
been lots of sort of examples of
communities who set up environmental
sensing networks in order to like find
out more about what's happening in their
in their local environment so we can
sense things like pollutant levels we
can sense things like noise levels light
levels motion if you're interested in
looking at sort of I don't know but
animal populations or like sensing
something that's happening in a bird box
or so on
these sorts of technologies may allow
you to prototype that sort of thing so
the two boards that I'm going to look at
first in this tutorial and then the one
that follows is the particle board which
is a little microcontroller that plays
really well with Wi-Fi and has a whole
lot of GPIO pins general purpose in our
pins that if you're familiar with
Arduino you all have used and so we can
set up our own sensors and circuits on
the particle and then put this data in
the cloud so let's just walk over to
this whiteboard so basically what we're
gonna do is we're going to set up a
circuit on this is the particle and we
set up the particle to talk wirelessly
to you know our Wi-Fi router wherever
that is in our in our situation in our
house or whatever and then that Wi-Fi
router
it is connected to you know the the
cloud or the Internet out here and then
we have our little computer with p5
running on it that then is going to be
getting information from the internet
right so I'm just going to show you a
particle board with a light dependent
resistor so a light sensor that is
attached to it so this light sensor is
on a little circuit and basically it's
going to give us a value that indicates
what the light levels are at the
location of the board and so this value
is then pinned up to our Wi-Fi router
and the nice thing about the particle is
it comes with this whole platform that
deals with the management of the data on
on the server and on the internet so it
saves us from having to set a lot of
that stuff up for ourselves and so the
data that we collect on the light sensor
goes through our router to the internet
and then at the other end we will use
that data in a p5 sketch to animate
something ok so the exact as I said the
exact the circuit I'm not going to spend
too much time talking about setting up
the circuit on the actual particle board
because I'm just using the sort of basic
example that they have very well
documented on their website so if you
end up getting one of these and working
through their sort of getting started
tutorial what I'm working with here is a
circuit that has the light sensor on it
and a circuit that has an LED on it so
I'll just spend a couple of minutes
going through the actual particle
documentation and website to see if we
can have a look at it
so that's a particle dot IO and the
boards look like this there's a few
different types and there's also one
that actually can connect to cellular
cellular cellular network
okay I can't dog today and so that that
if you used the cellular one it means
that you could set up say is since
somewhere where there isn't even a Wi-Fi
network and if you buy a SIM card you
could get data that way so if you wanted
to do some you know online project where
you need information from like a remote
site somewhere this is an option for how
you might manage that because the data
can come over the network that our
Mobile's operate on so we're going to be
using the photon today and there's all
these sorts of information about getting
set up connecting I'm not going to go
through the whole Wi-Fi connection
process course it's pretty
straightforward so these this board is
already on the Wi-Fi network that I have
we've got here in the studio the we
program the particle board using their
web api so they actually have an API
online so their web IDE so their web
integrated development environment so
this is a place where we can actually
write the code that we want to run on
this little microcontroller you know
listen to this pin send me this data
turn the LED on turn the ID off all that
sort of stuff and this code is uploaded
to the particle via the Wi-Fi network so
it's there's quite a nice workflow
because they have this web IDE we can
use and down here you see the examples
that you know it ships with so you can
go through and have a look at the
various things that can do by uploading
these examples to it so if we just have
a look at the you know 101 physical
computing example which is always the
blink LED if I bring that up you can see
the code there in the editor and up here
these icons are sort of the place where
we send it to the board so if we're
writing code for ourselves we would
verify this code so that we're not
sending
you know terrible syntax errors to our
board and then once we've figured out
all our debugging you know our errors we
then flash it to the board so if I click
flash you can see that the codes now
going over through the Wi-Fi network and
hopefully it's arriving down here at the
particle and we can see some lights
flashing it should the data is coming in
and the LED that I've get set up now you
can see it's blinking so we know that
we've got our Wi-Fi network set up
correctly and we've got this blinking
LED which is awesome so that's that's
basic setup this example is the standard
example that is explained really well on
the particle website so I didn't write
this code and you can see it's commented
really well so I don't want to spend too
long on it but if we have a quick look
you'll notice that the syntax is very is
basically the same as using Arduino so
if you've used any kind of like Arduino
boards and done any sort of projects
with Arduino you'll be quite comfortable
with the functions you see here so
basically we've got a variable called
LED which equals D 0 so this is
referring to the pin that LEDs on on the
particle board we've got one for our
photo resistor as well on a zero so
that's on one of the analog pins is on
our particle board we've got one some
dealing with some power and we've also
got a variable called analog value it is
a variable that we're going to capture
the value coming from our light sensor
if we jump down to void setup you'll be
seeing all these you know nice familiar
functions if that you'll recognize from
Arduino so pin mode we're sending all
our pins to either output or input
output if it's if they're going to be
pins for actuators things like lights or
mode
input pins if they're listening pin so
if they're listening for data from
census so you can see that our photo
resistor is on an input pin what the the
line that I think we need to talk about
is this particle dot variable function
so within the particle environment
there's a class the particle class that
has a whole lot of functions in it that
allow us to program how our board is
talking to their software that's running
on a server you know in a desert
somewhere and this particle dot variable
so we're using a function called
variable that's in that class and you
can see that it has three arguments the
first argument is a string and it's
defining our variable name so the
variable name that we are setting up on
the actual particle cloud or particle
server is called analog value here
there's a there is a second argument
which is analog value and then we're
saying that this is an int so this
function is unique to this particular
system we're using and it means that we
can then call that variable analog value
when we set up our p5 sketch later
because it's actually like a spot in
memory that we're kind of like reserving
on their system on their environment so
just jumping quickly through this you
can see in void loop we are reading
values from the photoresistor pen
there's a delay so that we don't do it
constantly and then there's also a
little bit of code at the bottom where
they're also toggling the LED off but
basically that's irrelevant to us so so
once we're happy with this program and
it's sensing and we've set up the
reading and writing to the particle
board as we want it we then go up here
we verify our code it's going to tell
if there are any errors in it you can
see code verified great work so we're
good to go
and then we can flash this to our board
so the code is going up into the
internet and there's arriving at our
board now we're going to look at this
part so we're going to look at writing
the p5 code that's getting the data
that's sitting on the particle cloud
okay so now is the p5.js part and I have
this really simple example set up in p5
that it's allows us to get data from the
internet from our the variable that we
set up to hold our light sensor data
back into our p5 sketch so we can do
something with it so how do we do that
let's have a look at this sketch so you
can see I have a number of global
variables set up we have one that's
going to contain now data we have one
that's going to specifically contain our
light reading and then I have a variable
called current M which is containing the
milliseconds the the reading takes place
so I've got a canvas here of 500 500 as
you can see and then this is the
important bit this is the interesting
bits so we have this URL call so as I
mentioned particle uses the rest a REST
API and if you don't know what a REST
API is go and watch summer dance videos
on REST API s but a REST API allows us
to call it and get some data from it and
so we use an HTTP call to do this and
let's take a look at how we construct
this HTTP call so if I jump back to my
browser we can have a better look at
what what how to construct this URL so
this HT you can see this HTTP API dot
particle dot IO so we're talking to the
particle api and for the different ways
you can construct calls that is
documented in there
v1 slash devices and then this number so
this number has to reflect the device
number that is associated with the board
that we are sensing on if we jump back
and have a quick look you're you I think
I mentioned before that this device
number is listed on their web IDE and we
can copy it and then paste it into this
URL analog question mark so we want to
specifically get the variable that we
set up called analog value on that
server
and then we need the access token so we
need that authentification part again
which we can see here on their web URL
access token so you will have your
unique one you need to copy it and place
it in this in this URL and so if I call
that URL that we've constructed from
using all the different values that we
have for this board you can see that
it's returning to me some JSON data and
it's returning to me the data in this
JSON format that is specific to that
analog value variable that we set up
before again if you're not sure what
JSON is or you can't really remember how
to deal with it
Dan's done some videos on that so pause
this go check them out and then come
back to us but you can see that the
particle API returns us these values in
the format with the name value of name
value pairs which is you know
fundamental to to the JSON data
structure and when we ask for that
information you can see we get some
information a thing called name which is
our since a variable name the value and
it has a bunch of other information in
it like the last time that the data was
logged it is it connected or not some
more information about time and the
device ID and some information about the
product so all that's there coming in to
our p5 sketch so after we put that
URL together we can then use the load
JSON function in processing in mp5 and
so this load JSON function is really
handy when we need to talk to REST API s
and again there's a number of videos on
how to do this so if you need a
refresher on api's go and have a look at
them but the load json function is that
lovely the lovely thing called a
callback function right so it helps us
deal with the asynchronicity
of javascript and in this case we want
to send the specific URL that we're
using out to the internet and we don't
want to do anything else until we've got
the data back so we're going to use the
callback function to manage that process
so we send the URL load JSON sends the
URL and waiting waiting waiting
eventually the data comes back and the
data then gets passed into this variable
we've got set up called data so it's
gonna have all that JSON stuff that we
just looked at in it and only once that
data's come back will it then run this
second part the second argument which is
a function that we can see set up at the
bottom of the code here called pass data
and so this second function then gets
the JSON data we just specifically get
the reading the dot result part of the
JSON data around and we put it in a
variable called reading jumping back
over here you can see that the there's
this line three there's this value
called 4:29 and it's it's name is result
which is why we are going data dot
result right so we get that number and
then it's going to just print out in the
console so if I run that you can see
that oh it's a little bit a little bit
hard to read there so you can see we're
getting this thing called reading and
it's 418 so if I say you put shade over
my sensor eventually we will see that
number or then I have to reload my sense
of my sketch you can see that it's come
out to be a different number because I'm
you know playing around putting my hand
over it getting lower if I completely
cover it up we should see that reading
go way down so there is at 41 right so
I'm doing just a little bit of like
checking that everything's working as I
think it should but we've successfully
set that up so from that JSON we're
pulling out the reading result and then
just printing it out in the console so
what can we do with that now you can see
there as I was playing around like it
almost updates in in real time there's
sort of like a little bit of a latency
but it's not too bad I'm a little bit
cautious of doing this whole API I call
in draw because we know that draw runs
you know about 50 60 loops per second
and most api's have rate limits on them
and so if you violate the rate limit you
know sometimes you can get blocked or
whatever so I'm going to set it up here
so that we are querying the API like
maybe once every second or two just in
case so basically our sketch at the
moment is just calling the API once and
then printing that reading out to our
console so we want to call it multiple
times now so what I'm going to do is I'm
going to write a new function called
call API and basically it's going to
have all of this stuff that's in setup
in it it's going to take our URL it's
going to use the load JSON function to
get the data back
it's then once it has that back it's
going to use the function pass data and
it's taking note of the time so it's
putting the current milliseconds so the
amount of time that's passed since the
start of the sketch into this variable
we've got called current and and to
understand what moment this happened in
and so now if I want to see that data
respond
we need to set up an if statement so
that we can call it every second or good
or so so if we go if and I'm gonna use
the Milly's function which is the
millisecond since the start of the
sketch
so if Milly's minus current M which is
the milliseconds that the the moment the
value familiar is when we took the data
reading so if Millie's minus current M
is greater than 2000 so that'll do it
every two seconds cuz there's a thousand
milliseconds in a second
then I want to call my API so then I
want to call that that lovely function
that I just wrote it all gets our data
in so let's let's see if that works for
us so I've got the reading if I cover up
my you can see that right so now I am
printing it out to the console in every
second or so as my data is changing so
that appears to be working
so let's now then do something with that
data I'm putting the data in the in the
variable called reading so if we want to
just print it out to the screen we've
got a reading and we'll just place it up
there at 2020 and then how about we also
write an ellipse so that changes size
maybe with the value that's coming in
off the sensor so width height is
reading reading and we'll just place it
in the center of the screen width into
height on two and then perhaps I want to
just refresh my background every time I
get some new data so that it doesn't
look too crazy so I'm just going to put
a background call at the top of my past
data function which is the function that
only gets
called when the data comes in and I put
it made it made it read there so what's
going on I drew my lips at 0-0 because
there wasn't any data there yet and we
can see so I've got that put my
background in the wrong place again so
let's just pick it up and I think if we
put it at the top of call API it should
look a little bit better there that
looks a bit better doesn't it
oh and I've done this I've got my
ellipse function all mixed up we
actually want it to be XY width height
so it's actually gonna be width on to
height on to reading reading so that
will fix my ellipse location that's
looking better all right so now you can
see that my lips is changing size just
slightly with my different readings
coming in if I put this sensor in
darkness I'm covering it up you can see
that my lips gets really nice and small
and then bigger again so it's it's
responding quite nicely if I wanted to
be a bit more responsive you know I
instead of every two seconds I might say
every 500 milliseconds so every half a
second and so there you can see it
responds much much quicker and so I mean
the great thing about this sort of setup
is even though you know I have this
particle tethered to my computer the
only reason I have it tethered like this
is for power so we could get a battery
pack pop it on the particle and throw
the particle up into a tree nearby and
as long as it can hear the Wi-Fi it will
then broadcast these light sensor values
to us which we can then play around with
in a sketch such as this one so it
really kind of expands the questions you
can ask and the sort of information that
you can collect about the world and then
you
in your projects to create you know
things that are interactive and
responsive to a particular environment
so I think there's lots of potential for
this in the world of data visualization
and also you know sometimes I make
public arts so thinking about making
interventions that respond to their
location or respond to a site of
interest these sort of technologies will
allow you to do that alright thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>