<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Coding Challenge #62.2: Plinko with Matter.js Part 2 | Coder Coacher - Coaching Coders</title><meta content="Coding Challenge #62.2: Plinko with Matter.js Part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Coding Challenge #62.2: Plinko with Matter.js Part 2</b></h2><h5 class="post__date">2017-03-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6s4MJcUyaUE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to part two of Plinko coding
challenge I actually just during the
little break I just took the pre park
water parts who I made a quick list with
help from the chat here's the things
that I'm going to do I'm going to
increase the gravity of the world so the
things don't look so sluggish as they're
falling I got to make sure I delete any
particles that leave the window although
at some point I'm going to put
boundaries so actually I might hold off
on that because I was going to add
boundaries around the whole world so
that they can't leave the window because
the idea is to fill up the buckets at
the bottom but then I don't want to add
buckets at the bottom to fill those
things up and then I actually might make
this a part 3 let's see we can add a
little bit of sound which they hit the
things this will like ding ding sound so
whatever maybe I can record the bells
really quickly and use that sound ok so
let me look over here and see what I can
do so gravity is part of something so
there's conceptually there's a world and
there's particles and there's plinkus
gravity is not part of a Plinko or peg
or a particle it's part of the world so
I can actually look here in the console
and I could just type whirl to look and
see what the properties of the world are
there's bounds which is thing I want to
look at which has a maximum and a
minimum X&amp;amp;Y whoops which is I click the
wrong thing come on click again you see
those are acidity because I haven't set
any bounds and then there's gravity
which has a scale I know what that is I
should look it up in the documentation
but I have an x and a y so one thing I
can see is the Y is 1 right now I can
actually just say world gravity dot y
equals 2 so let me double the Y so it
points down a little bit more and you
can see can you see that that's moving
let's just make it work strangest so you
can really see let's make this 10 and
you can see that gravity is so much
stronger right now so that's kind of
useful in terms of getting things to
fall a bit more ok so changing the
gravity to 2 I'm gonna leave it for that
right now the next thing on my list over
here was add bounds and there is a thing
in the world object in addition to
gravity called bounds but I'm not going
to use that that's more I think for
where you're doing collision detection
instead what I'm going to do is just add
some objects myself so I'm going to yet
again I'm going to just from particle J
s I'm going to do a save as and I'm
going to call this a boundary boundary
is I'm going to make an object that
has a X a Y and a width and a height
it's going to be and this should be a
boundary and it has its it is something
that's static and instead of making a
circle it's going to be a rectangle
again I'm doing a lot of redundant code
here but and then I'm going to keep
track of the width and the height in
separate variables and I'm going to say
boundary prototype dot show and this
should be a rectangle with a width and
height so what I've done very quickly is
show you how you can create a
rectangular body by using bodies doc
rectangle keeping trapper wrist and
height instead of radius otherwise
everything else is the same
ah I need to add rotation at some point
don't let me forget because these things
are rotating as they're moving around
okay so for this what I'm going to do
just really quickly is I'm also going to
make an array call it down and I'm going
to at the end of setup just put one at
the bottom VAR b equals a new boundary
and so the rectangle is actually thought
of based on its center matter guess I'm
going to say with divided by 2
it's going to be at height and I'm
actually going to like push it off so
what I want is its location to be at
height plus 50 because I want its width
to be the entire width of the window and
I want its height to be its plus 50 I
want to try to be like 100 so it's
actually not going to show up on the
screen but and I'm a boundary is not too
fine because of course I forgot to add
it to my index.html so I have another
JavaScript file come on boundary Jaya
here we go and boundary is not defined
and set up so what am I missing here new
boundary up what did I probably boundary
boundary boundary that looks right
index.html I've got boundary
is sketch B equals new boundary let's
try that again
syntax error line number three boundary
Jaya sorry about that is static true ah
there should not be a semicolon there
creating an object in JavaScript you
separate the properties with commas with
only one property I don't even need the
comma okay apologies for that
and here we go so now what we should see
is I got to wait a little while but when
so the halt falls to the bottom there
you can see that it's there's now a
boundary down there
so that's perfect that's what I want and
I guess I'm not going to make this 800
because it's kind of going off a little
too low down so let's just make this 600
by 700 just to push it up a little bit
okay that's pretty good okay another
thing that I could do here is if you
notice every other and I don't know if
this is really necessary but it does
feel like there should be another
particle right here another tag right
there so that is the odd row so in the
odd row what is well what if I just did
this would anybody really care yeah
that's fine there's an extra one also
for the even one I could be more
thoughtful about this but that's what
I'm gonna do right now okay so we've got
the stuff falling down and landing in
the bottom okay I definitely need to do
something I was wrong I do want to
delete particles that fall off the edge
because maybe they're not all going to
end up in the bottom so I should add
something where I check if anything is
way off screen to remove it to kind of
keep things more efficient so let's add
that next and what I need to do to do
that is I need each particle the only
thing that's moving so I'm going to say
particle dot prototype dot off-screen
equals a function and I'm just going to
say what makes it off-screen if X
returned X is less than 0 let's let's
say X is less than negative 100 and not
X ok so first of all x equals this body
position dot X so that's actually the
object's location it's the bodies
positions X right of physics the physics
engine matter AF is controlling
everything y equals and you know I kind
of wanted to make a nice statement that
I just
turn of a boolean not a statement a
boolean expression that returns true or
false let's just make this simpler if X
is less than negative 50 or X is greater
than I'm just going to use a buffer of
50 y plus 50 then return true else and
I'm doing this in a radically
inefficient way but I don't actually
ever need to check the top so I can
actually just say return if any of these
is true if any of these are true
then it's off the screen so I can use an
or return the result of all of these or
Y is greater than height plus 50 I'm I'm
like hearing the YouTube comments
already don't use a long-winded if
statement what you could do it in one
line of code but this is that kind of
cryptic to watch to read but it's an or
statement if any of things in an or
statement are true like false or false
or false or false or false or true the
whole thing is true right if I'm you
know you need yeah ok so if one of these
things are true the whole thing is going
to return true so now what I need to do
is in this loop here where I'm dealing
with all the particles if particles
index I that is off-screen then I want
to say particles index particles dot
splice I comma 1 I just did this enough
mattered a s tutorial earlier I'll link
to it where I kind of went through the
pitfall here because I'm moving taking
things out of the array while I'm
iterating through it so really a quick
fix that I can do here is just that I
did in that videos I could just subtract
1 from I because the problem is if I'm
removing the I element the other
elements slide into it and then I add 1
I end up skipping over it so this is
going to cause me not to skip anything
and this should remove anything that's
off the screen and of course I have an
error particles index I is off-screen is
not a function why is it not a function
particle I just called it off screen
let's call it is off screen there we go
so one thing I want to do just to be
sure this is really working is let's not
check let's not check the bottom let's
check
let's check you know to see if they go
over 100 pixels so we should see them
removed now I did I forgot something
really important in addition to removing
it from my array I need to tell matter
AF that's not part of the physics
anymore so what I'm good to sorry I'm
having like a Groundhog Day deja vu
thing where I'm removing it I also need
to say particle to say a particle gun in
a world world got removed world
particles index I body I think that's it
so I want to tell the matter das world
so I want to remove something from the
matter da chance world the world
function is named space in the world
object so we removed from this world
which is my world this particular
particles body so take this out of the
physics world then delete it from the
array then go back one so let's see if
that works
so one thing one way to check if this
works by the way is now what I'm going
to do is I'm not going to I'm not going
to remove it from my array but I will
remove it from the physics world so
let's just take that out this is a good
way of debugging to see if it works so
let's see if after one hundreds of
physics top so that that actually did
work
now I get I probably got like a weird
why did it that's interesting how it
stops doing anything but I can see
plainly that this is doing what I wanted
to do I'm pretty sure this is right
anybody pretty anybody tell tell me if
I've done something wrong but I think
I've got this in the right order and I
can go back to my particle objects and
change this to like height I don't
actually need to hide it all only
character goes because on the bottom is
the bottom has a hard boundary so I'm
just going to take that out I don't need
that at all so I actually don't need to
check I'm going to check if it's
off-screen on the Y Oh something froze
who I crashed this particular let's just
see if this comes back and it works
again ok so this should be doing fine I
want to check here's actually a way that
I can check so nothing
been removed so far I can say particles
length there's six right now particles
not length seven particles not length
seven come on leave the world people
checking if it's working
let me be bugged to see if this is
really working and I want to be
thoughtful about this Soho because I
really want to make sure that I've done
the code correctly and I think this will
show you a good way to debug this is
what I'm going to do is actually
completely take out all the plane codes
so now I have to have this oh look at
that oh that's oh no no I got to do this
okay now there's no Plinko okay so now
that there's no cling code and I'm also
going to remove this boundary and then I
actually unfortunately now need to go
back and add this Y back in or Y is
greater than height so the way that I'm
going to know that this works is put
this back in the way that I'm going to
know that this is actually working is by
looking at the length of the array so
particle dot length is one it's never
going to be more than one because by the
time the next one comes one's been
removed the question is world doc bodies
is what matter jeaious thinks is there
is that also one it is so things are
working right because if I took out my
if I took out this world dot removed if
I didn't remove it from the matter Jas
world I could look at particles that
length and I'm going to continuously see
one but now there's going to be three in
the world's body so I need to make sure
it's being removed from both places so
now that battle that I'm feel confidence
that that's working
I can put my boundary back in at the
bottom and I can put the plecos back in
here okay here we go now looking at my
list what do I have left
I've increased the gravity I'm removing
particles I added a boundary at the
bottom I need to add buckets so what I
want to do is just add some little
separators here
and I probably want to align them right
with that first with that first row that
probably is the way I'm supposed to do
it although I'm sure there's a specific
layout okay let's add those so how many
of those need to let's add those okay so
what I need to do those are also going
to be boundaries so I'm going to use
that boundaries array boundaries push B
and now I'm going to write a loop that's
similar I only need to do it for one set
of columns so let me say I equals I
equals zero eyes less in column I'm
going to do all these columns and what I
want to do is say the X is I times
spacing right that's what it is for
let's just see let's see what goes
alleging to us X's X's I times spacing
the Y is the bottom so let me think of a
height here I'm going to those buckets
are going to have a height they're going
to be rectangles that are going to the
height of like I don't know let's just
try like 30 pixels and a width of like
10 pixels so the Y is going to be if I
want it to be a boundary that sits on
top of the floor the Y is height minus H
divided by 2 because I need erect oh
this is confusing but basically it's
business the bottom this is my rectangle
this is its height this is this is the
canvases height - height divided by 2 is
this location here so once I do that
then I can create a new boundary and I'm
reusing a variable name which is
probably a bad idea but I can create
another new boundary which is at X comma
Y with come height because I calculated
all that already and I can also say
boundaries dot push B and the reason why
I want to put it into an array is
because I also want to say I also want
to display all them so for all the
boundaries
boundaries index I show now what does
the boundary show function have it shows
a rectangle and let me I have let me say
fill zero stroke zero maybe have a
different color here and uncaught
reference error boundaries is not
defined at set up boundaries boundaries
arms did I not make a boundaries array
oh I called it down so that's nice
because it's a little bit shorter of
course now I have to change it
everywhere so balanced push bounds push
and then I need to look through that
bounds are right okay there we go
those are so tiny look at the tiny I
really okay so those are going to be
have to be much taller I guess I wasn't
really thinking and I don't know why
let's make it be white I don't know why
I was like I had to change their color
so in the where am I boundary let me
make the color white and here on the
color white and then what am i doing now
I'm sketching where I create them let's
make the height 100 my goodness why I'm
being so stingy okay this is so and then
I could use one extra one right I could
use one extra one here not cut that off
of my laptop I could use an extra I
could use an extra one so I already said
call this plus 1 columns plus 2 wait why
am I not getting oh because it's there
but it's right off the screen no but let
me just offset it a little bit 10 plus
yeah I just see minus 10 just to offset
it yeah yeah it's there so I just have
to finesse the spacing and stuff a
little bit so I'm going to just leave it
at that because there's one what I want
is but it should be at the center right
so X is I times spacing so X is 0 and
the width is 10 so I should see 5 pixels
on and 5 pixels
if I change this to 20 what what am I
doing wrong here oh I know what I'm
doing wrong I had I'm not drawing it
correctly no wonder so I don't know if
this some of that think it could be
edited out I need to move this up again
too low for me but I forgot a really
really key thing if I go into the
boundaries
look at this I'm drawing the rectangles
in the default way that p5 thinks of
rectangles with zero zero in the top
left and that's why they're actually so
short I'm just drawing them in the
completely wrong place
where as a matter dot us thinks of
rectangles with the registration point
in the center so I need to have like I'm
drawing match what matter chance things
which I need to say rec mode Center so
here we go there we go so now it's right
and you can see I that's what I expected
it to do it had 1/4 1/2 off at the edge
so you can see here are my plink own
things let me just do this books no let
me do this so you can see it a little
bit better ok let me make it a little
bit wider sketch jf just to give us some
more stuff to work with 700 common 800
let's try that there we go so now let's
take a look at it ooh I did something
weird
oh the spacer lines what I change this I
didn't mean to do that let's go back to
what it was okay so here we go
Plinko so this ends the second part what
I'm going to do is what I'm going to do
right now is take a short break and I'm
going to come back and add a few sounds
to this and during that short break I
might also oh one thing I really got it
to fix is look at it always goes to the
left up there and the whole point of
this is the verse of 50% of the time go
to the left it's 50% of the time go to
the right so I need to I'm going to add
a few features to improve this in the
next video you could think about maybe
how you would do that yourself and look
at this so really they're all landing
basically in the same spot too
so I need to work on adding a little bit
of randomness to allow for for things to
change
ok so I'll see you in the next third
part where I'm going to improve
a little bit you there</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>