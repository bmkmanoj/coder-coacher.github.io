<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>10.6: Neural Networks: Matrix Math Part 1 - The Nature of Code | Coder Coacher - Coaching Coders</title><meta content="10.6: Neural Networks: Matrix Math Part 1 - The Nature of Code - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>10.6: Neural Networks: Matrix Math Part 1 - The Nature of Code</b></h2><h5 class="post__date">2017-07-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uSzGdfdOoG8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello Here I am whoo so I'm trying I'm
moving along here through this journey
of trying to program this neural network
library again I might suggest skip ahead
find some videos where I'm just using
the library but I'm I'm doing this I'm
exposing this process of a person
struggling to make sense of the world
but for this video I did actually make
some notes and I wanna reference
actually uh there's a nice medium post
about kind of what linear algebra you
need to know for deep learning that I
will show you on my laptop in a second
and link to it in the video where I read
that post this morning it helped me kind
of gather my thoughts for this
particular set of video so what I've
done so far is I've established that we
need this idea of linear algebra in
order to perform some of the math in the
neural network library that I'm building
so what I want to do is take a break
from the neural network stuff itself and
look at the linear algebra stuff in a
vacuum and yes finally actually
hopefully write some code because I want
to talk through the math and implement
the math in code in a generic way and
then apply that to the neural network
whoo we're gonna get through this
everybody ok so what are the core so I
have I have two broth I found my old
linear algebra textbooks from 20 some
plus 25 some amount of years ago so I
brought these as props I was reading
them this morning but here's the thing I
this is not a course in linear algebra
there's actually some great linear
algebra videos on Khan Academy on
probably there are some other ones out
there I will link to additional
resources in the description of this
video I want to do is cover the aspects
of linear algebra that are necessary or
relevant to the neural network stuff and
kind of leave out the rest so I'm going
to give that an attempt and see how it
goes and write code along with it and
you'll let me know how that goes
ok so here's the thing
there are two key concepts in linear
algebra there's the idea of a vector and
there's the idea of a matrix now a
vector is actually something that I
expect a lot of time in previous videos
in this nature of code playlist talking
about the idea of a two-dimensional
vector an entity with magnitude and
direction in a two-dimensional space we
use this vector for forces velocity and
all sorts of physics simulation all
sorts of stuff but ultimately this
vector is just an x and a y that
two-dimensional vector from an of course
could be a z for a three-dimensional
vector for all the computer graphics and
animation physics simulation stuff I've
done in previous videos we could think
though about it we can we can consider a
vector as just an N dimensional list of
values and I could make the notation
like this and I could say X 0 X 1 X 2 X
3 X 4 X 5 so this is a five dimensional
vector there you go so this is the idea
of a vector now one thing I should note
is that you will see a variety of
different kinds of notation you might
see them I still might see things
written like this X Y you might see it
written like this X Y different
textbooks different styles I'm going to
use this square bracket notation for the
algorithms and examples I'm going to
demonstrate in this video and in future
videos okay so that's the idea of a
vector now if you also recall we can do
math with vectors and there are a few
different kinds of operations there's
the idea of a scalar operation like
let's say I have the vector to come 2 3
and I multiply that by the number 2 I
could take this scalar value the single
value and multiply it by each component
of the vector and I would now have 4 6
there also are operations that are
referred to as element wise
this is the kind of operation that I did
over and over again if I had a velocity
vector in a position vector so if I had
a position vector that was something
like you know 2 3 and then I had a
velocity vector that was you know
negative 1 5 I could add element-wise
add these together so the first element
add to the the first elements get added
together so 2 plus negative 1 is 1
the second two elements get added
together three plus five is eight so
these are element wise operations now in
addition to that there is also something
referenced referred to as vector
multiplication and there's like a dot
product and the cross product there's
like the hog how do you say that had
miroux
anyway there's so I don't so I'm not
kind of reminding you of some things and
I have a bunch of videos on the dot
product the dot product I use in a
videos to look at the angle between two
vectors there's a path finding example
we really needed the dot product to
figure out how to get a moving agent to
follow a path and the way the dot
product works is we take two vectors and
get a single scalar value so you can see
these scalar operations a vector by a
times a single number we get a vector
these element-wise operations a vector
plus a vector we get a vector the dot
product and the reason why I'm going
through this is I'm going to use this
again once I get to matrix matrix is
where the new stuff is the dot product
if I have two three I just use these
same values negative 1 5 so the way that
the dot product works is we actually
take the if these were x and y values we
take the x's and multiply them together
and the y's multiply together and add
them together it's kind of like that
weighted sum thing that I was doing
earlier in the sort of neural network in
the perceptron stuff so I would take 2
times negative 1 we
negative 2 plus 3 times 5 which is 15
and I would get 13 so that is the dot
product so I could take the next step
and I could start to write code for all
these operations for vectors but I'm not
going to bother with that because
ultimately what I need for the neural
network library is the matrix stuff but
i starting with the vector stuff because
it's all going to translate it's all
good it's going to be analogous but i
should point out that this is all in if
you're in p5.js for example there's p5
dot vector j is the source for the p5 is
all on github and you can actually find
all of these operations here's the dot
product function you know if I look for
the add function here's you know adding
two vectors together so you can start to
actually go and unpack for these 2d and
3d vectors how that math works in the
source code but now what I want to do is
redo this but not for vectors but for
matrices so the idea here is what I want
to now do is I want to understand well
what if I'm storing numbers in a matrix
and why would I do that well there are
so many reasons pixels live in a matrix
but data in a spreadsheet isn't a matrix
the weights of connections in a neural
networks can be in a neural network can
be stored into matrix so there are so
many scenarios in programming where the
numbers that we're working with are
stored in a matrix and we can think of
that like a two-dimensional array that
we want to perform these kind of
mathematical operations very very often
so what is a matrix a matrix instead of
a linear list of values is a
two-dimensional grid of values and I
could think of it like this a b c d e f
and this would be a two by three matrix
typically we refer to matrix by the
number of rows and the number of collies
two rows three
so in that sense we can redo all of
these mathematical operations so let's
look at these kinds of mathematical
operations now with a matrix so I could
do a scaler this should be a scalar
operation so let's say I have the matrix
2 a 3 negative 4 9 and if I were to
multiply that by the number 2 a scaler
operation will just double all these
values so this would give me then the
matrix 4 6 negative 8 18 okay
so let's actually let's pause for a
second I'm not really going to pause and
let's before we get to these other
operations let's start to write some
code okay so what I want to do is have a
library that allows me to create a
matrix of values and then perform a
scalar operation let's go write the code
for that now I should point out that
what I'm doing the nature where I'm
doing is kind of ridiculous because
there is a math KS this is an extensive
math library that includes an entire
matrix implementation there is also GPU
rocks which is a GPU accelerated
JavaScript library for doing matrix
operations and you know talk about GPU
stuff in a little while later but
there's also I think matrix J as there's
p5 as a matrix implementation but I am
going to write my own just to kind of
understand how it works and then later
as part of this library probably to swap
it out to have something more efficient
that's going to actually you know Optive
do these matrix operations optimally but
so let's create a new file I'm going to
call it matrix J s and I'm going to
write a constructor function and I'm
going to call that matrix and the
constructor should get a num a certain
amount of rows and columns and I should
say this dot rows equals rows
and so long since I typed this dot feels
good
this duck calls equals columns okay so
the idea being that I want to be able to
say var is a new matrix three by two
something like that right that's the
idea here
I want to be able to just generate a
matrix okay so for example I can do this
just here in the console now
oh let's actually go to index of HTML
and add in the neural network library
and the matrix library now and I should
be able to say var M equals a new matrix
3 comma 2 and I can see there we go I
have a matrix object with three rows and
two columns okay now we got to come up
with a way of at least initializing the
values and this is this is 2 by 3 and I
said 3 by 2 but whatever so let's
initialize all the values as 0 so how do
I do that well ultimately I need to have
a variable and maybe I'll just actually
call it matrix you call it values I
don't know what to call I'm going to
call it matrix equals an array now there
are all sorts of sophisticated
JavaScript ways the you know I'm only
ever going to put floating-point numbers
in these I can have fixed size to
allocate the memory in some optimal way
but I'm just going to live in the breeze
code this in the most good easiest
loosest friendliest way and then we're
going to come back and optimize to you
some more efficient and optimal data
structures later so what I first want to
do again the traditional way to think
about a matrix is rows by columns so I'm
going to start with a loop through the
number of rows and I'm going to say
every single row
is also an array and then I am going to
loop through all of the columns and I
have a J here an I here by accident and
say then every single row column
location is a value and let's just
initialize them all at 0 whoops so this
is me now making a matrix of values
everything with 0 let's go back to the
browser and let's refresh the page and
create that matrix again and I should
now see matrix has 3 rows and 2 columns
and then it has an array each one of
these rows has two values 0 0 0 0 0 0 so
this is now we can see the data is
actually stored in there so I've got the
beginnings of a matrix library nothing
about this is optimal or efficient but I
have a librarian object that stores the
number of rows in the number of columns
and creates a two-dimensional array
filled with zeros okay so now what I'm
going to do so we kind of now we have
the ability of a library to create this
matrix the next thing that I want to do
is add a function that performs a scalar
operation so for example let's add a
function that's called multiply which is
the warning of this is a little bit
tricky because ultimately vector matrix
multiplication can mean a lot of
different things but just for right now
I'm going to write a function matrix dot
prototype that's part of the matrix
object all matrix objects I'm going to
call it I guess I could call it scale
let's just call it scale for right now
equals a function that's going to
receive a single value N and what do I
want to do I want to I'm going to do
this a lot loop through
every single row loop through every
single column and say this dot matrix I
j x equals that value
let's call i'm going to call this
multiply and then I'm going to add
quickly add another one for another
scalar operation called add and I'm
going to say plus equals so again this
is this idea I've written two functions
these are scalar functions I just want
to take a single value and multiply
every I value in the matrix by that
value or I want to take a single value
and add it to every single value in the
matrix that's what these two functions
can do
so let's now come back here once again
up I've got a syntax error I guess I
have an extra close curly bracket so I'm
going to create that three by two matrix
again I'm going to say add five now
let's look at it and I should see the
values in it should be all fives right
now again we're not really seeing the
nuance of this because there's not
different values but it started to
zeroes and then I added fives to it and
now I could say M multiplied negative
three oops oh I call it multiply and if
I look at M again now and I start to
look at those values we can see all the
values are negative 15 so what do I have
so far I have a simple matrix
implementation that allows me to
initialize a grid of numbers by rows and
columns and perform scalar operations I
can multiply or I can add so I'm going
to pause here and in the next video I'm
going to do element wise operations and
then we're going to start to look at
other vector multiplication which is
really no longer the dot product
but I'll talk about uh sorry matrix
multiplication so I'm going to kind of
break these out into separate videos and
I'm going to show you some interesting
things about building a JavaScript
library where I can actually determine
what's coming in I could reuse the
multiply an add function to determine am
i adding a scalar on my adding a whole
other matrix so I'm going to get to that
in the next video
okay thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>