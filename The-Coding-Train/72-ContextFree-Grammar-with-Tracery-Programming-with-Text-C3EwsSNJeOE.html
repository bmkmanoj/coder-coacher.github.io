<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>7.2: Context-Free Grammar with Tracery - Programming with Text | Coder Coacher - Coaching Coders</title><meta content="7.2: Context-Free Grammar with Tracery - Programming with Text - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>7.2: Context-Free Grammar with Tracery - Programming with Text</b></h2><h5 class="post__date">2016-10-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/C3EwsSNJeOE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to another video tutorial
this is part of session seven
programming from A to Z and I'm all
these videos are about grammar
specifically context-free grammars so
today I want to talk about a particular
grammar generation library for
JavaScript called tracery tracery
tracery is by kate compton at galaxy
kate on github it's a wonderful project
it allows you to be really creative with
generating text generating stories
making a Twitter bot just by putting
together a bunch of possibilities in a
way a grammar so to speak so first I'm
going to show you an example this is
actually this is called once upon a time
stories it is by a five year old and an
eight year old who happened to be
related to me or my children and they
didn't write the code for this but they
wrote the grammar so I'm gonna just
generate a story and read it to you once
upon a time there was a princess and
that princess was very happy and the
princess liked hamburgers the princess
was very jealous then the princess met a
lovely sad chupacabra and she killed the
trooper crop right Yahoo and then the
princess ate the burrito and she was so
sunglasses and she was heart eyes too
today I know let's generate another one
oh here's a princess again dragon okay
once upon a time there was a dragon and
that dragon was very angry and the
dragon liked shrimp so you can see this
is one way of using a grammar like
tracery to generate and there's a little
bit of like color and emojis and stuff
going on here but to generate text so
let me just look into the code for this
for a second so that I can point out to
you what the grammar actually oops I'm
in the wrong place what the grammar
actually looks like so this is what the
grammar actually looks like and the
grammar is simply a JavaScript object
and remember if you watched my first
video about context-free grammar
everything is about production rules
take this and replace it with this and
if you have this replace it with this if
you have this replace it with this and
you got to start with something so if I
come back to here you're gonna see here
there is a start now there's some
strange syntax there's a hash symbol and
a bracket colon and a character there's
a story there's characters but you can
see there's a selection of food options
a selection of monster options that sort
of thing
I should point out to you one thing
you'll notice by the ways you can in
JavaScript if you want to have emojis
you can just stick emojis in a they are
read just as text like anything else I
mean they're how they're interpreted and
displayed depends on what the
environment you're living in but the
Unicode character the characters
themselves are there for you to use okay
so okay so let's make our own let's
let's make our own tracery grammar and
then we'll come back to this one okay so
what am i doing here I want to go to my
example which is over here this is some
blank code I'm gonna go here make sure
it's running great so the first thing I
need to do is get that tracery library
and tracery as a library is just this
javascript file tracer ejs so I'm going
to grab this file and I'm gonna do
something silly which is just copy I
could download it I'm just going to copy
paste it into a new file which I'm going
to call a tree I guess I could have done
this not in the video tracer ejs I'm
gonna copy it there and then I need to
make sure if I'm using another
JavaScript library that I want to make
sure that I also reference it in the
index dot HTML file so just like I'm
using p5 Dom I want to use tracery now
another thing actually by the way is
tracery is dependent on jQuery so it
uses jQuery behind the scenes so I also
should make sure I download and grab
jQuery so I also have a reference to
jQuery here one thing I'll note by the
way is that you can reference JavaScript
libraries either as local files like I
have a local copy of p5.js here in my
folder but you can also reference
libraries through something called a CDN
or content delivery network meaning if
it's a really popular library somebody
might have just hosted it somewhere
instead of having to downloaded it I
could just reference the URL and you
know there's good reasons for doing one
or the other and I'm kind of mixing and
matching here but I just want to get
stuff working so now I should have the
tracery library and the jQuery library
and I'm ready to start making stuff
happened with tracery ok so let me at
least just go here back to my example
and wherever that is I lost it here it
is I'm hit refresh and I'm going to
back to my code and what I want to do is
start writing the grammar so I'm gonna
make a variable called and let's make it
a story and what I need is to have now
tracery by default looks for something
called start so I'm gonna you don't have
to name it start but I'm gonna call it
start and I'm gonna say start is and I'm
gonna I'm gonna need the chat by the way
to start giving me ideas for story
things but I guess I'll just be making
this up as I go right now it was a dark
and stormy night so now if I have this
javascript object which it essentially
holds the grammar I should be able to
make a variable called grammar oops
misspelled grammar AR okay so I'm gonna
have a variable called grammar and I'm
gonna say grammar equals equals tracery
dot I think create grammar story boy I
don't actually remember if that's
correct so one of the things when you're
working with a JavaScript library you've
got to look at documentation so I'm
gonna just go back to the github page
for tracery and just to like kind of
remind myself yes tracery create grammar
spell book by the way if you're looking
for an idea certain things like a
cooking recipe or a spell book there's a
wonderful Twitter bot called art
assignment bot I don't know that it uses
a grammar but these kinds of highly
structured types of narrative scenarios
can work really well to have a gram or
generate different possibilities I'll
also show you at some point that you can
use a grammar to generate you know haiku
patterns or certain patterns of certain
syllables it's another way to use a
grammar grammar okay so a tracery dot
create grammar story perfect so now I
want to look at the result and I'll say
I'll save our result equals grammar dot
flatten so again why the word flatten so
there's two words that involve
generating text from a grammar one is
expansion and the other is flattened so
this is the idea of an where am I here
this is the idea of an expansion right
I'm expanding out from the sort of start
and you iteratively applying these
replacement rules now krei Surrey behind
the scenes are
grammar system is probably keeping track
of the entire tree that's being
generated but all I want is the end
result so I want to flatten it and get
the end result and that's what's
happening over here
so I can say console dot log result and
if I run this come back to my example
that didn't work now I thought it would
automatically use start maybe it doesn't
so I'm going to add this in there you
know oh yeah okay the point is what I
want is to give that axiom that seed
phrase start in I want to pass that to
the grammar and the grammar the grammar
object the tracer grammar object is then
going to expand it out based on all
those production rules now right now and
you'll notice that those syntax for
tracery specifically is a non-terminal
element is wrapped in the pound or hash
symbol so this means please replace me
as opposed to the word start and so if I
did something like this we would have a
real problem because this would kind of
generate to infinity I almost want to
run it to see what happens I do let's
just do it what's the worst thing that
can happen maximum cost attack see so
you can see that this idea of replacing
but what I can do is say it was and and
I could say adjective and then I could
add another rule adjective some
possibilities are it was a dark shout
out your adjectives in the live chat
that's going on right now
dark sleepy somebody or hoped it was a
quiet so right if I give all these
adjectives now now I have two
non-terminal characters elements I
should say they're not characters start
which generates this sentence adjectives
which has three possibilities and so now
if I run this you can see it was a
sleepy and stormy night it was a sleepy
it was a dark it was a sleepy it was a
sleepy it was a quiet so each time i
refresh I get a new possibility okay so
this is level one here
of using a tracery grammar even this is
like plenty to play with a couple one
thing I should mention is that each one
of these has a one out of three chance
of being picked and another reason why
you might use a system or you know
modify tracer you know think about
programming your own sort of grammar
generation system from scratch is you
might be interested in playing around
with those probabilities what if it's 60
but of course I could do that also right
here by just now I've played with the
probabilities that dark has a 50% chance
of being picked we're sleeping quiet
only have a 25% chance of being picked
okay so let's write a story with a
character and what I'm gonna do actually
I'm gonna do something different because
I'm gonna say I'm gonna have a story a
and I'm going to just use the same kind
of story that my children wrote last
night which is a and I'll call it a hero
a hero fights the monster go hero go but
what I want is for this hero to be
picked so what I and I'm running out of
space here so let me open this up a
little bit what I want is what so let me
give some options for a hero and I'm
gonna say dragon unicorn rainbow these
are the possible heroes okay so the
story is a hero fights the monster go
hero go so what I'm going to do now is I
am going to change this to a story so I
want to flatten starting with story and
I'm gonna hit refresh
a dragon fights the monster go dragon go
so that's good a unicorn fights the
monster go unicorn go well this is kind
of working by accident a rainbow fights
the monster go dragon go so you'll
notice here what I haven't done is
secured that I pick the same hero both
times so you know the sort of Mad Libs
way of thinking about this sometimes I
want to have a different adjective so I
could say a adjective hero fights the
adjective monster and so in this case
right refresh a sleepy unicorn fights
the dark monster go unicorn go
a dark dragon fights the
quiet monster go unicorn go so I do want
a different adjective I want a random
adjective for the hero and the monster
but when I say hero I want to get the
same hero twice so one of the wonderful
things that tracery has is it has a
mechanism for you to assign a production
rule essentially like almost have like a
variable that holds something that's
picked in the grammar over time across
the entire sentence that's a story
that's being generated so in that sense
what I can do here is I want to I want
to start with start and what I want to
start to to render so to speak to expand
is the story
so start expands the story which is this
so you should be the same I'm just
getting these little stories here and
now though what I want to do is put in
here bracket I'm going to assign hero
and this is the hero actually is going
to come from this list so I need to give
this list another name this is uh let's
just call this character's hero
character so what this does is it says
render the story with a character being
picked as the hero so first it will pick
dragon unicorn or rainbow assign that to
hero and then use hero throughout there
so now as I render this you can see a
dark rainbow fights the sleepy monster
go rainbow go a dark unicorn fights the
quiet monster go unicorn go
so this is basically it this is how
tracery works you know I could keep
going and it would be sort of like an
interesting experiment maybe what I'll
do actually is we could create on github
some type of collaboratively edited
grammar I find I polish this example may
well include a link to the grammar in in
this video's description if people want
to contribute to it because really the
creativity now lies and how far can you
go with this how long can you make this
story what is it what is the story how
what types of other things might you
assign and pick randomly or assign in
advance but I would you want to show you
one other thing
there are also tracery also includes
modifiers so for example if i put dot s
here i cant dot s will
realize whatever character is picked so
this isn't gonna make a lot of sense but
you could say a sleepy dragons fights
the sleepy monster go drag and go but
the reason why this is a nice quality is
I don't have to include you know a
particular rule that's like plural
character or I don't have to like
include dragon unicorn rainbow dragons
unicorns rainbow so there are a bunch of
modifiers I can also use I believe dot
capitalize is a modifier that's built
into tracery which will capitalize the
particular word so if I'm picking that
hero and putting it at the beginning of
the sentence I can always make sure that
the grammar generates in such a way that
that word is capitalized and if you look
through the documentation I believe here
we'll find also some part there'll be a
list of modifiers okay I also should
mention here by the way right one thing
you might look at is under here there
are many new examples of tracer and use
and it also have an exciting new
interactive tutorial so it also
encourage you to check out this tutorial
tutorial excuse me which allows you to
sort of type the grammars into these
boxes and hit reroll and see what kind
of possibilities you can get and the
features are kind of explained through
the various various possibilities here
okay
so there's so much more here that I want
to look into that I haven't so maybe
someday I'll come back and show you some
other additional advanced so-to-speak
features of the tracery library so this
example will be published for you I
encourage you to write your own grammar
of course you can use emojis as
possibilities as you can see and we can
go back now by the way I might as well
go back just to return to the beginning
of this video and show you now the code
which we can see here that this
pronounced with a hero picked from a
character a villain picked from a list
of monsters and then the story is once
upon a time there was hero dot a which
means a hero it's always going to modify
it with a and that hero was very
adjectives and the hero liked food and
the hero was very adjectives and then
the hero met an adjective active villain
and she killed the villain exclamation
and the hero ate the food and she was so
adjectives that she adjectives that she
was adjectives to
des and if I go back to this we can
generate one more story thank you
once upon a time there was a bear and
that bear was very funny and the bear
liked ice cream and the bear was very
pretty then the bear met a happy lovely
dinosaur and she killed the dinosaur
monkey face and then the bear ate a corn
walnut I don't know what kind of nut
that is and she was so smart and she was
green heart jealous to today okay so
thanks for watching this video on
tracery um if you make something with
tracery please thank galaxy Kate on
Twitter I would say or contribute to the
tracery project or support it in some
way and I look forward to hearing what
you think and what you make and in the
next video I'm going to look at the
reader library with context-free
grammars oh oh before I leave you can
also use tracery as an ode package so
maybe someday I'll return to that but
you can npm install tracery and there's
documentation for that on the tracery
github as well ok thanks and see you in
another video sometime
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>