<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Coding Challenge #43: Context-Free Grammar | Coder Coacher - Coaching Coders</title><meta content="Coding Challenge #43: Context-Free Grammar - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Coding Challenge #43: Context-Free Grammar</b></h2><h5 class="post__date">2016-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8Z9FRiW2Jlc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to another oh my god I
can't believe I'm making cup fourth or
fifth I've lost track video about
context-free grammars so in this video
I'm gonna do something a little scary
which is instead of using an engine or
library or framework like tracery or
Rita I'm just going to program a little
context-free grammar expansion system
without anything at all just my own wits
and fingers or you see how that goes
right so remember the idea here is that
I have a system a language that has
valid elements of it valid letters of
the alphabet so to speak there are and
set of production rules so and I'm going
to use a very simple set of production
rules and try to write a recursive
function a function that references
itself to recursively expand this
grammar tree it'll be like magic
I think port or there's gonna be a lot
of problems that are gonna happen okay
so I haven't pre-existing examples where
I've done this but I think I did that
many years ago and I ported it from
somebody else's examples namely allison
parish's wonderful Python examples link
to Allison's or resources on a course
called reading and writing electronic
text in this video subscription so the
first thing that I want to do is I know
I'm gonna need some sort of object
probably a JavaScript object that has a
set of rules in it so and I could I
could just write these in maybe I'll
just write them in so I could say I'm
and if I'm kind of like going off of
what's here I could say okay a sentence
becomes the envy and a well I have to go
over here and look the a noun is a cat
or a dog and a verb is a meows or barks
so again this is my incredibly lame
grammar boy we could do so so much
better and we also have to think well
what really is going on here should I be
what syntax should I use like maybe it
makes more sense I
might make more sense I would sort of
prefer to do this like have these all be
an array because an array is going to be
easier for me to work with ultimately so
I'm gonna do that right I don't want to
like have to parse this like pipe symbol
and all of that so what I'm gonna
consider is an array is an array of
options with equal probabilities and
right now the only possible sentence is
the envy the only possible ends are cat
and dog and the only possible V is meow
mark so what I want to do is I want to
figure out now I need some sort of
expansion algorithm so what I need to do
is have a start so my start is just
gonna be the sentence s okay now what I
need to do is let's just make sure this
program is kind of and I have some
errors here like I'm missing a comma
here so let me just kind of say result
equals start and see what happens here
whoops I'm in I don't know where I am
and you want to be I'm probably but I'm
probably running we're editing the wrong
code don't I always do this no I'm in
the right place oh I just didn't
console.log anything and I'll just gonna
say create P result so the idea here is
UPS s so I want to get more than s so
how do I do this well there was a
variety of ways I could it could sort of
think about doing this but I think what
I want to do is I want to sort of build
out an array so I'm gonna say expansion
equals you know I could try to use a for
loop and maybe run a for loop a nested
for loop to do it multiple generations
but really this type of system I don't
really have anything in here that's
nested but if I add some nested stuff to
it I'm going to need a recursive
algorithm so I would love to refer you
to some videos I have about the concept
of recursion which typically in other
videos I've made I've used for graphics
drawing I could make a recursive tree
structure and a self-similar shape a
recursive something is a recursion
that's defined recursively as a function
that defined it that calls itself
so now I'm gonna come back to that but
let's just start let me start writing
this code this is a coding challenge I
think it is ok so I have an expansion
and what I want to say is I want to say
expand start expansion because what I
want to do is I want to call a function
and I'm gonna say here result equals
that so I want to have a result and that
comes from starting with this and I want
to pass it an empty array because then I
want that array to be filled as it's
going through and and expanding based on
the the rules so to speak so I'm gonna
write this function up here and it gets
I don't know what to call this a Fritton
element to phrase I'm just going to call
it a start so to speak and I'm gonna
call this expansion which is kind of a
little awkward that I'm using the same
variable names but I'm gonna do that
anyway ok so what do I do here well
first I need to determine is start
something in the rules is it terminal or
not terminal if rules start right it
doesn't exist is it something in the
rules if it is what do I need to do well
I need to expand whatever I need to
expand one of the possibilities that it
might pick so first what I'm going to do
is I need to pick something and one of
the lovely things I can do in p5 is I
can pass an array to a random function
so if I say give me a random value right
that's going to be picking if it's as
getting n it's going to pick one of cat
or dog and then I need to expand that so
then I need to expand what it picked and
then I need to continue to pass this
expansion array because this expansion
array it's just getting filled
recursively as this kind of function
unfurls this is I would have to like
come back and and and this is going to
be sick I can tell already this is going
to be the not the kind of video that you
need to watch over and over again but
this is gonna be the kind of thing that
you're gonna wanna list with like hand
write this code and play act it out or
something with a friend to sort of
figure out what's going on here
now what if it's not
something that expands then what do I
want to do I want to add it to that
array expand push what I picked so the
idea is that I want this to keep going
and we can think about what the tree I
wonder if there's a way I can diagram
this to help you to help make so first
I'll let you see if this works
and then I'm gonna what I want to do is
I'm gonna say result join with it's a
it's a it's a let's console.log the
result it's going to be an array let's
see if this even works because I might
have made a mistake
undefined hey undefined there we go tada
all right so what went wrong
looking at the chat rules tart no I
thought someone was saying I made a typo
there so let's see if we can figure out
what's going on so let's let's
console.log pick see if that's even
working ah so that worked
we got V on I don't know why I can't I'm
zoomed out we got the envy sketch line
10 so that works and then pick
oh-oh-oh-oh-oh-oh so here's something
that's kind of important right this
would have this would work I haven't
been paying attention but these when it
these are three different kind of
elements that I need to expand so I hate
to do this to you but I really kind of
feel like what this should be is an
array inside the array I could start to
spew split and stuff but I want to I
want to think about a way that might
make sense and I've missed something
here oh I need that quote there let me
just make this change and then we'll
kind of discuss it this is my own
strange way of encoding this I'm sure
any of you watching will come up with a
better way and you will share it with me
in the
comments and I will feel embarrassed
that's part of programming feeling
embarrassed although you shouldn't feel
embarrassed it's okay I'm gonna feel
embarrassed cuz that's I generally
operate in life by feeling embarrassed
but coding is about figuring stuff out
and playing around and and iterating to
refine things later so the reason why
I'm doing this whoo look at that it auto
formatted it for me
the reason why I'm doing this is because
what I want is to have a bunch of
options but one of the options this is
not three possible options
this is expanding s into three tokens so
to speak
this is expanding n into one token or
this other one token so you know I could
say this or something like the funny cat
whoops and it would look like this you
know but the reason why I need to
separate this out is because the NRV
might be things that need to be expanded
and the truth of the matter is I could
just do this but not if I need to treat
these separately as things that might be
expanded so you know I could do
something different with splitting but
I'm gonna I'm gonna keep my train of
thought here and what I'm gonna do now
is once I pick something here I'm
picking an array right and so what I
need to expand is each one of these so I
need to say for VAR I equals 0 I is less
than pick dot length I plus plus and
then I want to expand pick index I so I
want to go through and expand the then N
and then V and then push so let's look
at this now and see what happens and we
can see are still getting undefined at
the end so but I'm getting something
promising where I got the NV then I got
cat then I got barks so it looks like
things are working correctly
oh I'm constantly logging results really
what I want to console.log is expansion
undefined undefined undefined it's
promising so let's look up here ah pick
hmm oh no no no I want to push start so
there we go sorry so this is the thing
coming in if it is part of the rules
then I need to split it up and expand it
otherwise I need to add
to the end so that's what I was missing
there and now we can see I get the dog
barks and what do I want to do now
the thing that it results in is a an
array of elements and I want to and so I
wonder it by the way if it makes sense
for me to just say return expansion and
in that sense I can have the function
also sort of return that array which is
sort of unnecessary but yeah that makes
sort of sense to do that and then what I
can do is I can also say return
expansion join with a space and then now
you can see I'm getting these sentences
the dog barks so now what I have is
console.log result create P oh there it
is the dog barks so you can see I'm
getting these and I could do this a
bunch of times
just to get a bunch of different
sentences to make sure this is really
working and now I'm gonna run this we
can look at this craziness ah what's
going on here I made a mistake and I've
got to start over each time so I want to
do that ten times so we can see the dog
barks the dog meows the dog meows the
cat meows so this in theory is working
right now and what I would like to do is
take somebody else's grammar and apply
it in here to see if we can get
something that's a bit more
sophisticated so I'm gonna pull an
example grammar file from Allison
Parrish and I believe that is this so
this is a much nicer grammar and what
I'm going to do is I'm going to just
paste it to the top here and I'm gonna
put it in comments just to sort of make
the argument that and I feel like this
cooking show thing should happen where
now this video is gonna get edited where
all of a sudden you see the results down
here I'll be translating it but I'm
gonna walk through translating one at a
time in the archives live stream and
we'll see what happens in the video
later okay so you didn't have to watch
all that but I went and converted that
this grammar which is from
sample from Alison Parrish Thank You
Alison Parrish and I converted it to
this syntax that I developed which is
probably and you can see now I have a
slightly more complex sentence first of
all I have two different options noun
phrase verb phrase interjection noun
phrase verb phrase and the powerful
thing here is that a verb phrase can
also include a noun phrase or no noun
phrase so there's the recursive nature
of this algorithm of kind of expanding
this sort of nested tree is much more
apparent now so let me go and I think
what I should do is quickly create a
nice little button to do the generation
so where am i I'm going to say button
and I'm going to say button equals
create button generate and then button
mouse pressed CFG like The BFG but a CFG
and then I'm going to say function CFG
and I don't I'm going to expand this
grammar and create a paragraph so let's
look and see I have a button that
economy that wins for grounds that tames
seagull the corsage for grounds the
corsage that for grounds this amoeba the
corsage ameba wines I feel like I messed
something up but I'm sure I probably
messed something up in the grammar but
you'll have a you get the idea here so
this is the key piece of this is a how
are you deciding to format your grammar
right how are you creating terminal and
non-terminal symbols I've chosen to use
this sort of set of nested arrays and
the real key here of course is this
recursive algorithm so as I'm starting
with one element I expand that and then
I look over those elements and call
expand on those elements and call expand
of course there's function just calling
itself calling itself and just like
computer just keeping track of
everything and then at the eventually
it's going to finish doing all that and
at the end it's going to have this big
array of all of the terminal elements of
this new sentence and will join them
with a space bar and give you that
result back which is displayed in the
browser so again just to summarize I
think if you want
work with context-free grammars using a
using a JavaScript library like tracery
or rita or both great options if you're
interested in digging into the algorithm
itself um this is now an example that
kind of shows you that and just to kind
of make this point a little bit more I
want to show you that I you can also
find a whole bunch of examples of mine
that do this and a little bit more so if
you go to the ADA Z github repository
you'll see that I have context I have I
have this same exact algorithm but
packaged up into an object so this is a
context-free object that has the rules
object it has an add rural function so
you can even look at this if you want to
kind of think about organizing this
context-free grammar into its own kind
of library so to speak much like rita
does Rita's more sophisticated than mine
so you can look at these examples they
do much in the same way of things that
we this is the exact same grammar
actually you can look at this one which
actually reads it from a JSON file does
the Haiku generation there's this other
example that is I want to show you
because what it's actually doing is it's
taking this is doing something more it's
using a text and a file I could upload
or drag or paste in but it's actually
generating the grammar on the fly based
on input words so here I have the text
from the rainbow Wikipedia page and I
could sort of generate haikus with that
particular text you know if I made up my
own text if i refresh this and said
generate some haikus one two three one
one two three happy dancing rainbows
unicorn what else what else
purple pink right we could sort of see I
could generate the grammar and I could
generate some haikus and you can see I
don't have any I don't have enough stuff
so I'm kind of getting some of the these
became terminal symbols because I don't
have enough stuff but if I had you can
see haikus to unicorn pink pink dancing
too so this is also something you might
want to think of this by the way also
has a little button word that allows me
to save that and I can actually look at
the JSON file itself
that the program actually generates that
grammar and you can see here it's
calculates and it sort of you couldn't
find any four syllable or five syllable
words in the C text that I gave it so
I'm gonna see if there's any other yeah
so that's I want to make another video
where I sort of maybe tie into
context-free grammars with L systems I
encourage you to sort of look at some of
my other videos about L systems which
are a context-free grammar but the the
idea of them is to create graphics and I
will do one wrap-up video to talk about
some exercise ideas that you might make
and certainly one of the things that
I'll talk about I'm mentioning this now
because I don't know if I have time to
pick that video today but it'll come
eventually is you might think of what if
the elements of this grammar right
aren't words but musical notes or design
elements color form how could you use a
context-free grammar to generate visual
designs generate music other types of
things beyond just text okay so I hope
you enjoyed this coding challenge of
kind of coding a context-free grammar
from scratch and I'll see you in a
future one at some point in the future</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>