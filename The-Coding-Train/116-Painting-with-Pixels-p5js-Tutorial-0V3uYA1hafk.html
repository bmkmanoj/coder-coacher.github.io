<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>11.6: Painting with Pixels - p5.js Tutorial | Coder Coacher - Coaching Coders</title><meta content="11.6: Painting with Pixels - p5.js Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>11.6: Painting with Pixels - p5.js Tutorial</b></h2><h5 class="post__date">2016-04-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0V3uYA1hafk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello I am here to make a video to show
you how to program a certain kind of
thing that kind of thing like the thing
you see behind me which is oh I have to
stand still for this to happen but what
you see behind me is a flocking system
there are all of these little squares
floating around the screen and what
they're doing is they're picking up
pixel values color values from a camera
that's in front of me and smearing those
colors onto the screen so this is a
project that I actually I think that I
made around 14 years ago I'm running a
updated version of it that runs in
processing and what I'm gonna do is show
you how to actually make something like
this happen in the browser using
javascript p5 GS html5 canvas
so let me just mention a few other
things about this that you'll see is
that so if I if I click the mouse here
which I'm now I'm clearing the
background and what you'll see if
they're just all of these squares moving
around the screen now they're using this
kind of like bees swarming insects
swarming sort of kind of like motion and
you can see that's what the camera is
actually seeing up behind me and so if I
let go of the mouse instead of clearing
the background these agents will just
simply you know keep drawing those
colors but they're they're trails are
being revealed so how does how do you
program something like this let's so I'm
going to close this down and I'm gonna
minimize processing here and I've got a
p5.js example that I'm going to start
with and the example just has a couple
things it has a live video and it has a
single particle now those particle comes
from a previous video that I will
magically have an annotation pop-up that
references where I showed you how to
have something move around the screen
and draw a trail of itself and you can
see there and it's gonna move randomly
so yeah you know in the swarming thing
they're swarming like insects here just
gonna move randomly but if you decide to
take this example and do something with
it you might think of different kinds of
motion spiral etc or whatever that you
might think of doing so let me run this
particular example right here and you
can see this is all it is you can see
that there is a video Dom element giving
me a sort of low resolution image of
myself that I can use to pick up pixel
colors and there is a thing moving
around the screen randomly a single
particle so the first thing that I want
to figure out how to do is how do I have
this particle actually grab colors
that video and so notice that I say
video dot load pixels one thing that I'm
gonna do just right now for a second is
put background back into draw and I'm
gonna run this again so you can see this
is what's happening so what I want is
for that particle to be colored
according to what's in the video so this
is actually kind of an easy thing to do
surprisingly enough in the particle
object itself notice how it gets a fill
color which is always 255 comma 150 so
it's white with a little bit of alpha
but I don't want this to be 255 rather
what I want is to get some sort of color
from the video get this X this dot Y so
this is kind of the idea here what I
want is I have the canvas with a
particle moving around and I have this
particular video with a portrait you
know of myself so this particle should
look up the corresponding color in the
video and set its fill and this
particles location is at this X this dot
Y so I should be able to just say give
me the pixel value at this Tex this dot
Y in the video only I can't write
because if you notice this canvas is
actually 640 by 480 and my video is
actually 40 by 30 so what I need to do
is I need to scale down so wherever the
particle is its X&amp;amp;Y and you just scale
it down dividing by 16 to find the
corresponding pixel value in the video
so let's come back over here and do that
so what I think could be useful is to
get make another variable I'm gonna call
it px for like pixel X I just made a
weird like arm motion that I don't know
what it means
pixel X px and I'm gonna say this dot X
divided by V scale if you remember V
scale is a variable that I have that
keeps track of how big is the canvas
relative to the video and I'm gonna make
another variable called py which is this
dot Y divided by V scale and I'm gonna
say now give me the color at P X py now
there's a slight issue beef
your p5 actually doesn't care let's keep
going there's an issue which is that I
might get the number four point seven
nine eight three one two five which is
not a valid pixel value pixel values are
only whole numbers integer values pixel
for pixel seven there's no pixel seven
and a half so I might need to add
something to this to correct that but
let's just sort of see at least what
happens now what is in this variable Co
well let's just see if this even works
and I'm gonna I'm going to add a console
dot log the color and by the way I'm not
using the word color even though I have
a variable that's describing a color
color the word color is a key word in p5
it's an actual function so I'm just
saying Co L for kind of short for color
so let's now go back and run this again
we have a view of our console here we
can see I'm only ever getting black that
doesn't seem right
I don't think it should be black zero
zero 255 so let's go and let's add this
thing that I want to add which maybe
will fix it same floor so what floor
does is it takes any number that might
be a decimal number and locks off that
decimal number so three point eight
becomes three three point three becomes
three three point nine who comes 37.2
becomes seven just takes that and gives
me a nice integer whole number which is
what I need and let's run this again
still getting only black oh there we go
just took a minute for the video to like
come alive so you can see this is
working and that it's pulling out color
values you can see they're all very
green because it's probably wandering
around the green screen behind me so
what can I do now I should be able to
say and notice by the way that this is
an array so the get function gives you a
single pixel and it gives you an array a
red green blue and alpha value so what I
can do is I can say now fill now fill
the red there's a bunch of different
ways I could do this but and this might
be sort of a silly way but I'm just
gonna say let me actually now take the
red green and blue values to color that
particular and I can take out console
dot log I can run this again and you can
see come alive video you can see look
it's green and you can see if my face
gets in there there we go it's picking
up colors so good we're getting
somewhere now
let's go back to
is let's put let's take out background
and draw and put background back and set
up and you can see now it is going to
start painting me if I stood very still
but rather slowly and who knows how long
and how patient we can be here
to kind of do this so what what we might
make this better is to have a lot of
these in the window so what I think
would make more sense is for me to make
an array called particles let's start
with 100 of them and let's say particles
index I equals a new particle so instead
of having a single variable particle
let's have an array of particles let's
make a whole bunch of them and then
everything I can do a loop here through
all the particles and just say particles
index I update particles index I show
and now I could run this again and we
can see there we go as I move around you
can see I'm kind of getting this like
very pointillist like portrait of myself
now there is no swarming there is no
flocking it's just random motion also
these particles they're leaving the
window they're gone forever let's see if
we can just make a few improvements to
this at least to keep it a bit more
stable so one thing that I think is kind
of important here and might be worth it
might be worth actually making like a
little slider for this I'm going to add
a slider is that that alpha value is
going to make a big difference in what
it looks like so alpha goes between 0
and 255 let's start in the middle at 127
and so I'm going to make a slider and
then I'm just going to take this alpha
value alpha value and have it be the
value of that slider so we can sort of
see what happens here with like less
alpha you know no alpha like less more
alpha what is it you can get that so
it's fuzzier or harsher so that's one
thing that's sort of important to see
the other thing that I think might be
good to do is add some kind of
constraints like
this dot x equals constrain its values
between zero and width I could probably
come up with a better solution this dot
y 0 dot height so I don't ever want it
to leave the window so I want to keep it
always on in the window and so we can
see now and they're all starting from
the middle
maybe I should maybe I want to have them
all start from you know a random spot in
the window just so let's do that so you
can see here and now that's working
let's see what happens if now I go and
make 500 of them this is even going to
run come video so you can see well
there's an issue here which is like
performance is a bit of an issue even
though I have so many more now that I'm
kind of more quickly seeing the image
resolve whether or not I want that I
don't know but it's running rather slow
so there is a limit to how much we can
really draw on canvas let's try 200 and
see if it's kind of a smoother animation
there we go so 200 seems pretty good
another thing that I might add to this
stop and is maybe a variable for a size
so I'm drawing them all as a 24 by 24
but maybe I should make a random size
between like 4 and 32 and so each one
these particles will actually be a
different size which might be kind of an
interesting effect to have sort of like
smaller dots and larger dots I don't
know if that's really helpful I'm going
to try to stand still for a second you
get the idea I could keep going with
this so what I would say there's a you
know there's there's a few things that I
want to mention here number one is
there's a couple things that I'm doing
in the in the original example that I
showed you that maybe I won't add right
now but I'll mention one thing that you
might that that can be an issue is that
if you have depending on what your
motion is if you have a particle that's
here and then the next frame that's over
here there's going to be this sort of
jump so one thing that I didn't do in
that you could consider doing is
wherever the part of
moves to also draw particles in between
them so you always get this continuous
line you could also use actually just
the line function and keep track of its
previous location and its current
location that's one thing that you might
consider the other thing that you might
consider is averaging color over time so
let me let me let me explain what I mean
by this so let's say there is this is
the figure that the camera is seeing and
this is the particle and it's moving
this way and this is the painting that
it's making so and this is a red sweater
and this is a black background what
you're going to see based on what I've
done here is red red red red red black
right this being that edge the particle
is going to instantly change to the next
color because it's literally drawing the
color it sees with the pixel but if
every time it moves you just average in
a little more color then that creates a
smearing effect so what you would see
instead is red red red red red less red
a lesser Lewis red black or black or
black or black or black or black or
black black black red a little more red
so it's going to a verge the color as
it's moving so in order to do that what
you would need is for your particle
object to actually store a color and
when you get the color from the video to
average that new color with the color
that it's storage so I'll leave that as
an exercise I mean I'll try to post an
example that does that there's actually
a p5 function called lerp color that
will do this math of averaging for you
that you could look at using boy really
look at it right now I'm not going to
but and then the other thing I would say
is to really think about is what is the
motion so you know if I go back really
quickly just we remind ourselves what
this looks like with the background on
right you can see this is this is the
motion of my particles that are painting
the image but what if all the particles
just move left and right or up and down
or they use a flocking system or they're
all bouncing off of each other or
they're all spiraling around so what are
some other ways that you can think of
how those brushstrokes are created and
in addition like are you just drunk
circles are you smearing like you know
image textures or rectangles there's a
lot of possibilities here so
think about all those possibilities
maybe make some sort of painting thing
pixel whatever and share it with me on
Twitter or in the comments and ask your
questions and I look forward to see what
people make under 50 minutes thank
goodness okay</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>