<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>6.2: Steering Behaviors: Seek - The Nature of Code | Coder Coacher - Coaching Coders</title><meta content="6.2: Steering Behaviors: Seek - The Nature of Code - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>6.2: Steering Behaviors: Seek - The Nature of Code</b></h2><h5 class="post__date">2015-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4zhJlkGQTvU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I forgot what I was gonna say hi
steering behaviour this video is going
to we're going to walk through our first
we're gonna make an autonomous agent
it's going to have a steering maker
mount off of the work of Craig Reynolds
and it's going to be very exciting so
let's take a look we're going to start
with a basic scenario let's say we have
a vehicle which is represented by a
triangle this vehicle has a velocity
also in this vehicles world is a target
as represented by this plus with a
circle around it this is our target the
behavior we are choosing to simulate is
seeking remember Reynolds says there
each vehicle is going to follow three
steps action selection steering and
locomotion locomotion is just our
physics engine we've got that action
selection where's the action we are
selecting is seek this target so now we
need to calculate the steering force and
here we go we have a formula for that
steering and this is like the greatest
formula ever written to me I just love
it so beautiful so simple and yet so
powerful it's just like a happy formula
look at that desire steering wheel is
desired minus velocity I can do that
it's subtraction right so we this is
going to be our formula steering equals
desired minus velocity here's the thing
there is something a little more complex
at play here and that is this desired
desired desired velocity this means when
we go to calculate a steering force we
need to determine what is that vehicle's
actual desired velocity and this could
actually be quite a complicated thing to
figure out for say for us in this
scenario it's not going to be too hard
so let's try to imagine for a second I
desire to seek that target what is my
desired velocity you think about that
for a second okay I got it I just
the targets over there I want to move in
the target's direction as fast as
possible so we could represent that as a
vector by saying a vector that points
from the location towards the target and
what is the length of that vector it is
as fast as possible or something we're
going to call maximum speed or max speed
so one of the things we're making a new
class in our
code in our examples called vehicle and
again we were just doing this is like
some strange Sisyphean like thing we're
doing like a let's just make the same
class over and over and over again this
is just another mover another particle
another thing whatever it is it's got
location velocity acceleration but we're
going to add two new parameters to our
vehicles one is maximum speed and one is
another one is maximum force so um this
is useful I mean there's a lot of these
these parameters these values that are
going to allow us to really tweak the
behavior of our system so maximum speed
against think of it as a top spilling
how fast is this thing able to go
there's a race car versus a truck save
the maximum force it's like how good at
how good is it at turning um what's its
handling a car racing example is a
perfect scenario for this hopefully
you're thinking of smarter more creative
use but car racing we have a car is a
maximum speed and a handling that's what
these variables are going to control but
this is how we're going to scan
calculator desired velocity so once we
have our desired velocity we need to
apply a steering force now deep breaths
and pause for a moment and stand over
here and look at it from this direction
we did something like this
several many videos back another time in
our life in fact several times over we
have looked at attraction behaviors what
is an attraction behavior it is when an
object is attracted to some other object
or in this case this thing that's moving
is attracted to another location on the
screen so with an attraction behavior
with a gravitational attraction or
something you might have found a toxic
lips we could have just stopped there
and said hey this vector we made up
that's the force that's going to point
at the target I mean it's the force
that's gonna be applied to the object
but we're doing something more here
remember okay I really want to write
this down andand I'm not going to I'm
just going to say an autonomous agent
has the as a as an ability to perceive
its environment to know more about its
environment than just the just sitting
around experiencing a force in other
words it's able to look at its current
velocity as it relates to its desired
velocity and it's able to say like
what's the error here what's the
difference here that's the force it's
able to
compensate for how far off the path it
already is going I mean think about it
if your goal is to move as fast as
possible to a target over there and
you're already moving as fast as
possible to target over there why do you
need to apply a force to yourself you
don't if your velocity equals to your
desired velocity your steering forces
has a net steering force of zero now
okay so let's actually take a look at
what the force looks like that we're now
applying to this vehicle so let's let's
do this
we're desired minus velocity so this is
our desired velocity right here and
remember when you add vectors you put
them end to end
so that's desired and now this is our
velocity if I were adding it I would put
the velocity over here but to subtract
it I just need to reverse the velocities
direction and put in point at the other
direction so this is desired minus
velocity and this is the resulting
vector that we get so you can see here
that this is the actual force that we're
applying which makes sense if we're
already shooting in this direction we
need to compensate back to steer towards
that target so this is kind of the power
of this formula this formula says let me
look at what it is I want to do let me
look at it how currently moving and let
me apply a force to myself which is the
difference of those two so in this
scenario pretty simple stuff but as
we're going to see when we start to look
at flow field following and path
following in flocking behaviors and all
these other steering behaviors how we
calculate that desired velocity is going
to sometimes get a little bit harder
okay so let's kind of map this out a
little bit let's write let's let's sort
of figure out a little bit about how
we're going to actually do this in code
we're at six minutes which i think is
pretty reasonable for a video well just
have a few minutes more perhaps so a
perfect art get a little bit closer so I
have more space over here so let's just
remind ourselves how this kind of
calculation works with code right we
know we we need to get we need to
calculate that the steering force
ultimately is what we want to calculate
but first we need to calculate that
desired velocity so that we can
calculate steering okay so how do we
calculate that desired velocity first we
just need a vector the points from the
location all the way to the target
how do we do that would say p-vector
desired equals P vector dot subtract
what target - location target - location
now I have a vector that points all the
way from here to there now I need to
make its magnitude maximum speed this is
so easy desired dot set magnitude to max
speed now behind the scenes what's
happening here is that vector gets
normalized and then scaled normalize to
a length of 1 multiplied by maximum
speed to scale to maximum speed but here
we have a quick function in the
processing P vector class set the
magnitude at maximum speed once we have
this now we just need to apply Reynolds
brilliant formula P vector steering
equals P vector dot subtract what do we
now in our track desired - velocity once
we have that all we need to do is send
that force the resulting force through
our physics engine ah oh I forgot I
forgot a step so this is something to do
it this is calculating it this is
sending it through the physics engine
but we do want to add one little extra
step here and that little extra step is
saying hey this is not this perfect
vehicle that I can just steer however
much it needs to steer that force that
this forces magnitude is limited and so
what the step that we're going to add
here is say steering dot limit maximum
force so we're putting some limits if
that maximum force is very low it's kind
of like rule after really trying to turn
I can't do it if that maximum force is
very high I can turn on a dime really
really fast
so these variables as we're going to see
in the code example maximum speed and
maximum force are really really key to
tuning how you're how your vehicle is
going to behave alright so hopefully
this scenario makes sense to you
hopefully you now see how Reynolds
formula is applied how it is that the
crucial thing here is saying
this vehicle has a goal that it wants to
accomplish and that goal is translated
to a desired velocity vector once you
have that you got Reynolds formula
you got a force and your vehicle's
moving so let's take a look at how this
actually happens in processing and I'll
meet you over at camera to that camera -
I don't know maybe that's camera one
there's only two cameras so I anyway hi
so here we've got the sketch excellent
let's run it I hope I didn't like screw
it up before um no it seems to be
working so you can see here if the fact
that my head is in front of it that's
something I need to work on here I'm
sure I could improve this okay so as I
move the mouse around you can see that
this vehicle is moving towards it you
know it's nothing too thrilling but it's
an implementations favor one thing it's
interesting to see is hey it's always
sort of flying past it then it has to
turn around and come back this is
something we're going to investigate in
the next video we start to look at an
arriving behavior what it means for that
vehicle to slow down and stop when it
reaches the target which is something I
want to look at I think at this point in
the next video although if you're
looking for an exercise that book is
that you try to implement just on your
own
Kumble with a scenario for that before
you move on ok so let's look at just a
few key things in the code here number
one is here we have our vehicle class
and you can see what I'm talking about
we've added just a couple variables
maximum speed and maximum force and not
to overemphasize this point but if I
make that maximum force really really
large you can see how this vehicle now
is able to just instantly turn and one
of the things that we're that I want to
emphasize here is that you know you have
to ask yourself a question like why are
you doing this in the first place is
your goal to have something just move as
fast as possible towards a target if
that's your goal then maybe this kind
then maybe you don't need all of this
elaborate steering for stuff you could
just like set its velocity headed
straight there the point of what we're
doing is to create this kind of lifelike
and improvisational movement and and the
fact that we have these parameters
maximum speed and maximum force really
allows us to have a wide range of
possibilities or remodeling a cheetah or
a turtle or a ant or a you a tricycle I
don't know there's so many possibilities
and how these how the system behaves it
you know can be can be affected by these
parameters and so yeah so
so that's I think mostly all that I
wanted to show you oh yeah let's just
take a look and just prove the point
that here we now have a function in our
class which receives a target we make
our desired velocity which is target -
location I did it in two steps here
normalized and scale by maximum speed
but actually we can just as we saw over
here we can simplify that by saying set
magnitude and then we calculate the
steering force desired - velocity limit
it to maximum force and apply it so this
is hopefully a kind of a good model the
beginning first step hopefully you can
understand it see how it works you know
your real project here is to come up
with your you know why are you doing
this what's your what are you building
why are the things moving what are what
are the goals of the elements in your
system and how can you translate those
goals into desired velocity so you might
have some creative idea here that you're
already ready to explore come up with
your own does that way of calculating a
desired velocity and then translate that
into steering but if you're looking for
an exercise in the next video I just
said this we're going to change the
desired velocity so then it slows down
so that it's the closer to the target
the smaller it is that's the arrived
favor right when I'm close to the target
I desire to be moving very very slowly
at that point so see if you can add that
actually into this example and get it to
slow down and stop at the target in the
next video I'm going to talk through
that fairly briefly I think okay this is
this I was recording this whole time
which is good and soon you will be
watching this maybe and I think okay</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>