<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>8.15: Drag and Drop a File - p5.js Tutorial | Coder Coacher - Coaching Coders</title><meta content="8.15: Drag and Drop a File - p5.js Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>8.15: Drag and Drop a File - p5.js Tutorial</b></h2><h5 class="post__date">2015-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/o4UmGrPst_c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video I want to look at a
feature of web browsers and something
you can do in JavaScript in general but
also this thing is built into the p5.js
library in a rather nice way that I
enjoy and this feature is dragging a
file into the browser and making use of
that file and that file could be an
image it could be a text file it could
be some sort of data file data is a
thing that I'm going to get into in some
future videos there's different kinds of
data formats so there's lots of
potential to what you could do if you
ask the user to say hey give me an image
and I'll do something that's really
exciting and interesting in the browser
with that image or give me a hundred
images and even that so let's look at
how that that works so first of all what
I mean by that and I guess I probably
don't need this diagram but from the
draw it anyway is on the web page and
going to make an area on the page right
so I'm going to have a canvas and I want
an area on the page where if I have some
sort of file if I drag that file and
release it there and if this is an image
I want to see that image then suddenly
appear and be drawn into the canvas so
how do you do that let's go and look so
I've sort of set this up in advance I
have this particular example and you can
see it's got exactly what I'm talking
about this canvas is made with the
create canvas function and you can see
background is called so you can see that
it has a black background then they're
above the canvas is this like dashed
area on the screen that says drag your
file here now where did that come from
that is written into the HTML file so
I'm going to go over here and look at
the cancel look at the HTML file and you
can see there it is there's just a
paragraph element drag your file here I
gave it an ID called drop zone because
I'm going to need to refer to it hey
that's the paragraph element that I want
to be able to drop something onto and
then also I've just written some Styles
some styles referring to that drop zone
and maybe just so it's a little bit more
visible I might say font size is a 36
point and maybe I'll do something like
width is 50% so by the way this is also
something that you might not have seen
before there's all of these units that
are happening in CSS
px for pixels so actually like the
number of pixels want that padding
point for something that has to do with
typography I'm sure somebody understands
much better than I do but you know the
larger the point the larger the font
size but also percentage being relative
so this Dom element is always just going
to be 50% the size of the page which
you'll see now if I hit run again you
can see as I resize the page that Dom
element doesn't have a fixed size it's
always just 50/50 percent of the page
that's a nice little tidbit that I'm
adding into this video so how do I make
it so that I can drag a file there
incidentally what happens if I drag a
file right now I drag this file over
here and I drop it and I'm lost I'm gone
from the page look and you can see that
what is it it that that file is just
literally opened up in the page so filed
bacteria I don't know I'm trying to do
something other than rainbows and
unicorns but maybe bacteria I went the
wrong direction but it's interesting
okay so so I need to I need to get this
working so first of all I need to add
some JavaScript events to this element I
want to handle the event so the browser
handled that event for me right when you
drag the file to the browser it assumes
like oh I'm a browser you're dragging me
a file I'll open it I want to say to the
browser no no no no no I'm in charge
here don't do what you're going to do I
got something else for you I got
something else planned so if I come over
here and I first I need to do is get up
and make a variable and I'm going to
call select so select and let's make
this a global variable because I might
want to access it in other places I'm
going to say select the drop zone now
something that I'm doing here which
might you might find a little bit
confusing that I find this to be just so
convenient I like to just name my
variable of the same name as the ID it's
absolutely not required the ID can be
told like that and nobody knows whether
there cares whether the same just you
the programmer for me it's a little bit
convenient but I don't want you to be
confused that there's some like matching
happening there that's just I happen to
name the variable the same name as the
ID okay so what's next you know that you
can attach an event to an area by
referencing that event
as a function called on that object so
the mousepressed event the changed event
the input event the mouse over the mouse
out these are all events that i've
looked at in previous videos i've got a
new event for you i don't remember what
it's called but i do know there's one
this drat dragged over so the drag over
event let's handle that with a function
called highlight okay
so I'm going to say a function highlight
drop zone dot style a background color
and let's give it a little gray zoom
back out here so now this should at
least I've handled one event drag over
okay so now if I take this file and drag
it over here you can see it becomes
great now it's never not becoming grey
but at least I've got that event so this
by the way has nothing to do so far this
has nothing to do with the file I'm just
handling an event if you drag over it if
I move the mouse over it doesn't do
anything if I drag the mouse over it
without a file it doesn't do anything
this is an event only for when I drag a
file over it you can see it becomes gray
so that's one thing I can do now what if
I want if I'd like dragging a file then
I'm like good to know bad idea if I
didn't take the file out maybe I want to
unhighlight it right so I could then say
I can't remember what it's called but I
think it's dragged out unhighlight and
I'll just reset the background color
oops
I'm gonna write another function and I'm
gonna reset the background color to
white now you might be asking yourself a
question and I need to get to this in
another video but you might be asked
questions like what do I need these two
functions for I could really have just
one function that accepts an argument
white or black I mean white or grey and
then I could say drag over call that
function with great white gray drag out
call that function with white this is
actually quite possible in JavaScript
I'm doing it this way for convenience
because again the other way requires a
sort of some trickiness for how do I get
an argument kind of into those functions
would love to get to that remind me
remind me
me I will remember I'm gonna think of a
good scenario and try to make a nice
video that it's because it's sort of
like a fundamental aspect of JavaScript
it uses this thing called a closure okay
so but we're not doing that right now
I'm not doing that right now I'm gonna
leave this as two separate functions but
you're right to ask that question just
you being the metaphorical person who I
think I'm talking to I mean you're yeah
okay so undefined is not a function line
eight drag probably drag out is wrong so
how do we figure this out I should stop
being so like I'm just going to imagine
what the p5 Dom API has in it and I
should probably go and look this stuff
up so if you were doing this and you got
this air and you wanted to figure out
how to find it you could open up a
browser you could go to p5.js org I'm
gonna click on write this you should be
able to find this on your reference and
I'm sure that will change at some point
soon but an easier way to find them you
go under libraries and I'm going to go
to p5 Dom and now I'm going to see oh
look at all of these look at all of
these methods and look at that I called
it drag-out but we can see here the mess
the the the event is actually called
drag leave that's the name of the
function drag leave by the way there's
add class and remove class interestingly
class I'm thinking something happened in
a previous video and I wonder if that
should actually be changed but anyway
that's a side topic I'll have to think
about that in my own time so drag leave
is the name of the function that I
wanted so I'm going to minimize that and
come back and I could clicked on it to
see some more information but I don't
need to do that right now I feel
confident that I could just type drag
leave here and now I can run this again
and here we go file leave file look at
that what a nice little I'm so good at
user interface attraction design I'm
being sarcastic because I'm not good at
that um but you can see this is a bit
more intuitive at least to be able to
handle these types of events of when you
have that thing over when you have the
thing out so but we're missing kind of
the exciting this is just like nothing's
going to happen like if I look that's
the same thing happened that event the
drop event when I let go of the mouse
when I perform this release action this
is me miming the release action I need
to handle that event and that event is
handled with the drop function
now what goes in here let's think about
this for a second so let me comment this
out and run this there there are two
things that have to happen and this is
tricky one thing that has to happen is I
need to read that file the other thing
that needs to happen is I might want a
this is okay well actually there really
aren't two things I always thinking
there there aren't intuitively there
aren't two things there's one moment
right I drop so the moment I drop I want
to handle that event by like applying
some style to it like unhighlight in it
and then I also want to read the file
that's been dropped but those are
actually divided into two separate
callbacks and there's a really good
reason for that and the good reason for
that is that I might want to take all of
these images what if I drag all of these
images into the browser
I need a callback to handle each file
one at a time but there's only one
moment of dropping so so in that sense
and I forget which is which let's go
back to the reference so let me go back
to the reference here and I'm going to
click on this drop event and you can see
we could read this a callback callback
so look at this call but the first
callback is triggered when files are
dropped so that's the event the actual
event of dropping the files then the
second callback is to when the file is
loaded and actually these also happen at
separate time because what if you drag
and drop a like 500 megabit megabyte
image file right that dropped moment
happens instantly but it might take the
browser quite a while to read that very
large file so that's why those are two
separate events so I can go back to my
code and I can say you know what when I
drop it I also want to unhighlight the
box right that's I want to unhighlight
it and then I want to handle the file so
I'm Alex doing two things when as soon
as I drop it unhighlight the box and
also trigger a new function got file
function got file file now interestingly
enough so let's just run this and at
least see now when I drag the unicorn
over here let's just only the unicorn
please it highlights it unhighlight it
highlights it on highly
let's drop it it unhighlight and I've
overridden the default browser behavior
the default browser behavior would have
been to open that file but I've now
overridden that by whatever goes here so
now I can do whatever I want and not
only can I do whatever I want I can do
whatever I want with the data in that
file for example I could say create
image file now I don't think this is
actually going to work I know it's not
going to work is that so but let's let's
try it with this rainbow alright it
something appeared there but it's like a
broken image so this thing here the
argument that comes into the function
this might be actually something rather
new to you I'm realizing because most of
our call backs like highlight or
unhighlight don't have data that arrives
with it
so this is a new scenario this callback
p5 is not only triggering the callback
when the file is ready to be loaded but
it's also handing a variable and inside
that variable is just valve it's like
such a nice wonderful friend like PV I
was like look I'm going to hand you I'm
going to call this function of and hand
you this variable and I'm going to fill
that variable for you with all the data
associated with that file so this file
variable is actually an instance of a p5
file object and there's all this
information like I know how big the file
is what its name is there's lots of
metadata social ways that file and
something that's in that file is a
property called data and that data might
just be the text that's in the file it
might be the the other some other data
format that's in the file or it might be
image data so if I say create image file
data now watch this
oh ok we have to look at the reference
nice - sure I save that I ran that I'm
pretty sure that was right but you know
we have a little bit of a problem here
it's not working so let me go back to
the reference and I'm gonna go to the
reference and I want to look for file M
file this is where this is this is this
where's the p5 file object somebody find
it for me quickly p5 image p5 dot file
I'm not seeing it so you know it's some
reason it's not in the ref
which it probably should be I'm gonna
I'm taking drastic measures here and I'm
gonna go to the p5.js github repository
I should actually just look for it you
know what I should look for an example
that does this there's actually an
example that a good guy was going to go
into the buzzer just get a look you know
fast-forward through the video like 30
seconds or a minute you could skip this
part but I'm gonna go look for under
learning maybe or under Dom let's look
at let's under p5 element I'm gonna look
for the drop this is probably not the
right place yeah no I went under
examples Dom random random Dom I dropped
there we go file dot data well by golly
I was right wasn't I create image file
that data so that's what I meant to do
why didn't that work let's just okay
let's be a little bit more methodical
about this maybe something else is going
wrong that I don't know about so for
example let's look let's see if there's
some of the metadata is there I'm gonna
say create P file name create P file
type create P file dot file dot size and
so they're they're all a file has all
this metadata so see with its name its
type of size those are all strengths
that's just data and data should
actually be the image stuff so let's run
this and let me drag in this rainbow
file and you can see undefined drop
undefined oh you know what I wonder if I
guess what I think I might have done I
know what I did I probably reverse the
order of those I reverse the order of
those uh callbacks so this is a very
common thing with cabins aren't you
enjoying the fact that I just messed the
stuff up all the time I really hope you
are so this is this is something so you
know we've looked at this in realize
like the callback is triggering I mean
of course it's triggering because there
are two callbacks both of them are
triggering but I'm triggering them
probably in the wrong order so let's go
back to the p5 reference libraries Dom
and let's look at this drop function
right here and let's read this again
the first callback triggers when the
files are dropped the second callback
triggers to receive the loaded file
isn't that the way I did it first
callbacks but but I have a feeling the
reference it wasn't entirely my mistake
I have a feeling the reference misled me
let's switch the order of these it's
probably the first argument is the
callback to handle the file and the
second argument is the callback to
handle the event that's just a dropping
event so let's try this again
and here we go yay so I've caught my and
let's let's do something where I save
our image equals create image I say
image dot size 100 100 and I'm gonna do
create P I'm gonna just join one string
so I'm going to take this out just to
make this a little shorter now let's
look at this again I'm gonna make a
bigger window we can have this a nice
moment where I drag the unicorn here
there's our unicorn I drag the rainbow
here there's the rainbow I drag another
rainbow here there's that so you can see
here the files are coming in I'm adding
them to the page and also I get
information how big was the file what
was the name of the file I could use
that information I'm just sort of like
spinning it right back so this is
interesting hopefully you mean so I'm
not really doing anything with that and
also I should mention let's just prove
that this works I'm going to refresh
this page to start over let's drag all
of the images all at once and there you
go all of them appear so it's handle
that callback was triggered many many
times for each image so I'm going to do
one more thing which I think it's just
kind of like makes this seem a bit more
magical so you can have a Dom element
that has like a dotted line and says
drag your file here but anything can be
a Dom element that you drag stuff onto
any there like a button code or a slider
code even that barely makes any sense
but let's actually do something to this
example I'm going to do save as drag and
drop to I'm going to say you know what
forget about this drop zone thing take
that out of there take the
there why not store the canvas in a
variable and say canvas dot drag over
canvas drag leave canvas drop so look at
this if I run this now I can just take
this image and drag it over the canvas
drop zone is not defined all right we
don't I don't need any of this styling
stuff anymore to be honest with you I
don't I'm deciding like not to care
about that I can do something much
simpler I can just use the single
callback of dropping it you know I'm not
just skipping the visual feedback part
right so anything can be a drag-and-drop
element and now let's think about this
even more in a different way what if
when I drag the element onto the canvas
I want to see the image in the canvas so
what can I do I can just call the image
function image 0 0 width height so this
is the difference again between making a
Dom element image and then drawing and
versus drawing an image into a canvas
the image function draws that image
whether it's through load image or
create image into the canvas create
image makes the Dom element so now we
should be able to see this that now I'm
only seeing the top left corner of the
image because they're kind of small I'm
surprised about that because I'm drawing
it supposedly with the width and height
of the of so I'm kind of surprised I
feel like that's a little bit of a p5
bug there I don't know why that's not
working I have to examine that but also
the thing I wanted to show you is that I
don't even though I might have to do it
this way to create the image via this to
create the image as a way of like
getting the data from the file I can use
I can use the p5 function image dot hide
so I can make that Dom element purely to
open that file and then I can hide it
instantly and then draw it into the
canvas I'm actually sort of surprised
this is working because I realized that
I was sort of thinking I mean that there
might be another problem associated on't
know what I missed with the width and
height before maybe that size thing
probably messed things up but you can
see look at this that was a trance
so you can see now the as I drag and
drop the images onto the canvas I see
the image there so that concludes this
particular video where what I was hoping
to demonstrate I think I did which is
the idea that you can create an any
element on the page and you can handle
when you dragging a file over it when
you decide you're not going to drag that
file over it and when you actually drop
that file and if it's an image file you
can use that image to display the image
data and in a term another video in the
future I'll probably show you how to do
it the text file and do something like
word counting the text file but that's
that you might investigate the load
straightness function and sort of see
how you might do that I don't have a
good exercise - can't think of one I'll
write something in the description ok
thanks and I think I have one more sort
of Dom video to make after this one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>