<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Coding Challenge #47: Pixel Sorting in Processing | Coder Coacher - Coaching Coders</title><meta content="Coding Challenge #47: Pixel Sorting in Processing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Coding Challenge #47: Pixel Sorting in Processing</b></h2><h5 class="post__date">2016-12-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JUDYkxU6J0o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to another coding
challenge this challenge I am going to
attempt something called pixel sorting
and pixel sorting is an algorithm that
takes all the pixels of an image or a
video or anything and reorganizes them
in some order may be ordered by
brightness or ordered by hue may be they
spiral out from the center are they kind
of get ordered across or up and down and
you can see if you google an image
search with pixel sorting you'll see a
lot of artists and people making art and
crazy projects with a pixel sorting
algorithm so I am now going to try to
express it make pixel sorting in
processing which is a Java based
programming environment it looks
something like this you can go to
processing org to download it yourself
and the one thing that I've got going
here is in this the code is in a PDE
file called pixel sorting PDE check this
video's description for a link to the
code I also have an image a JPEG in the
data folder so you could use any image
I've just grabbed off of Wikipedia an
image of a sunflower and that's what I'm
going to pixel sort so if first thing I
want to do is I want to create a pea
image variable and then I'm going to say
image load image and it's sunflower JPEG
and then I want to draw the image image
zero zero so I want to see here might
the canvas that you're going to see is
800 by 400
the raw image on the left and the sorted
image on the right okay so I've got part
1 now here's the thing what I want now
is another image called sorted and I
want to create a blank image equals
create image and I want it to be the
same width and height and I want it to
be an RGB image as the image so this in
processing is how I load an image from
the file here's how I create a blank
image so now and so let's just do
something really quickly now all images
oh look at this there's a weird bar here
I don't know that's a glitch with my
camera I'm just going to have to live
with it but all images the pixels we
think of them is organized on a grid
like here's pixel like 0 1 2 comma 0 1
that's pixel 2 calm
the computer stores all the pixels in a
linear list 0 1 2 3 4 5 6 7 so to the
computer this is actually pixel index 7
which is actually the 8th pixel because
I started counting from 0 so and in
processing I can look at all of the
pixels of an image that array by saying
the image dot pixels itself so I'm going
to come over here I also need to do
something like say a sorted dot load
pixels this is kind of like a little
announcement like hey I'm going to look
at the pixels now and I'm going to say
for I'm going to write a for loop I
equals 0 I is less than sorted dot
pixels dot length I plus plus and I'm
going to say sorted in dot pixels index
I equals a color random 255 so
processing has a function called color
and if you give it a single number it'll
make a nice grayscale color and we'll
put in that pixel net image and then I
can say sorted update pixels I'm not
doing the sorting yet I'm just showing
you how this works
so now if I in the draw function I say I
drop the image and I draw both the
original image and this quote-unquote
sorted image which is now just random
colors I should see this so we can see I
have an image that's loaded from a file
and an image with pixels that I made up
so now what I need to do is take all of
these pixels and put them in this one to
sort it to actually something that I
could do right here is I could say image
dot pixels index I and I could say image
dot load pixels so now this is being
manually one at a time copying every
pixel from image into sorted here we go
there are two sunflowers by the way I
love sunflowers do you love sunflowers
tell me about your favorite flower in
the comment and then you can all of you
can write all cringe cringe this seems
to be the thing that people write
whenever I talk about flowers or kittens
or puppies or rainbows or whatever but
you know these things are nice things
can we have nice things please
ok so now I need time by the way I'm
avoiding I'm like stressed out here and
progressed in hitting I got to get to
the sorting so here's the thing most
programming environments will come with
some kind of function to sort an array
and Java is no exception even processing
is no exception it has a sort function
but the thing is I need to do something
kind of custom here because this array
is like this crazy array of colors and I
want to like organize it it's their
arbitrary numbers a color is an R a G
and a B value and an alpha value
sometimes so how I'm going to sort it
I've got to write the sorting algorithm
manually sorting algorithms are the
domain of people's PhD dissertations and
lifetimes of study there's something
called a bubble sort there's something
called a selection sort there's even
something called a quicksort
I probably four what I'm going to do
could make great use out of a super
fancy efficient fast sorting algorithm
there's a great write-up I believe by
Mike Bostock who the creator of d3 about
animal sorting algorithms is how they
work I'll link to that in this video's
description but for what I'm going to do
right here just to make things simple
I'm going to implement a selection sort
and so I think the way that I can do
this right I have two arrays who you
can't see all that I'm cut off but
that's fine this is my first array I'm
going to look through the entire array
for the brightest pixel when I find the
brightest pixel I am going to put that
over here and what I'm actually going to
do is I'm going to have to you know what
I need to do I actually need to copy the
whole image because I need to rearrange
the pixels while I'm sorting but I don't
want to mess with the original pixels of
the image so I'm going to copy the whole
image and let's talk about the selection
sort again I think I realized you do
this a different way than I previously
imagined I'm going to look at all the
pixels of the image find the brightest
one let's say this is the brightest one
I'm going to take this and put it in the
first spot and take that first spot and
put it there
that's called a swap then I can start
from here and now look for the brightest
one and take that one and put it in the
second spot then I can start from here
and look for the brace one so I've kind
of looping through the entire array to
find the brightest one to put it in the
first part then I'm starting at the
second the third the fourth so I always
getting a smaller section of the array
because the beginning and that will grow
is the sort of sorted part so let's see
if I can do that
and one thing I can do by so this this
is a way that I copied all the pixels
just in case you're wondering I could
actually I could actually I believe say
sorted equals image get so that's a get
is a function and processing that just
gets a copy of the image let's see if
that works great so that's a little
easier than copying the pixels manually
just so you see that's there and now
what I need to do is I need a selection
sort
so let's think about how I'm going to do
this again I'm going to say for and I do
need sorted out load pixels I'm going to
say for int I equals 0 I is less than
image sorted sorted pixels dot length I
plus plus okay so this is looking at
every single pixel but for every single
pixel I need to look at all the pixels
that come after it so I need to say for
in J equals starting at I J plus J is
less than sorted pixels dot length J
plus plus okay right because I want to
start again if I come back to that
diagram I want to start at 0 and look
through all the pixels then I want to go
to 1 and look through all the pixels
then I want to go to 2 and look through
all the pixels ok so that's what this
nested loop is doing so the first thing
to do is let me sort by brightness so
I'm going to say B equals the brightness
well let live its first let's get a
color pix equals sorted index J of know
sort of dot pixels index J that is the
color at that particular pixel the
brightness of that color you know I
could compute it but processing has
these nice functions that'll just it's
just the average of the RGB values so
I'm going to get that brightness now
what do I need I need to find the record
brightness of any pixel for each time I
do this so I'm going to create a
variable called record and I set it to
negative one right because no pixel can
have a brightness less than negative 1
less than 0 so I want to say and then I
want to have I'm going to say brightest
into you know I'm going to do because I
might change the algorithm I'm gonna say
selected pixel
equals equals a I because I can start by
default I'm going to start with the
first one selected pixel equals I so
what I want to do now and say if
brightness is greater than the record
then that's the selected pixel is now J
and the record is now that brightness so
this is like looking at every pixel from
J to the end and see if it's brightness
beats whatever previous brightest one I
found storing as a selected and storing
a record so now once I finish this loop
now I want to do is swap selected pixel
with I so I need to take whatever was
selected is the brightest and put it in
the eye spot and then whatever's in the
eye spot stick it back somewhere else so
how do I do this
basically what I want to say is sorted
dot pixels index selected pixel equals
sorted pixels index I and then sorted
dot pixels index I equals sorted in
pixels index electrical so this is this
won't work by the way this is a problem
so um but but this is like a next idea
right I want to take what's in I and put
it in selected pixel and what's hot what
and what's at what's in selected pixel
and put it in I here's the problem
though and I actually I prefer to write
it I don't know this is like kind of
nonsense but I need to I need to feel
like okay about things in life generally
summaries I need I to be first that's
just how I am I want to take what's in
selected pixel and put it in I and
what's an i and put in selected pixel
the problem is I just over wrote what
was in I so I've lost it so what I
actually need is something like a
temporary variable to store what's in
sorted pixels index I and so that I can
put that in temp didn't make any sense
let me say that again
I need to save what's in I because I'm
about to overwrite what's in I so that I
can grab it again and put it in selected
pixel this is an algorithm for swapping
two spots in the array and then once I'm
done I think this is everything
this should actually work I have no idea
how long this is going to take this is
not a particularly efficient algorithm
and this is a this is you know there's
this thing called Big O notation that
people talk about in like computer
science of like how fast is an algorithm
this is like an N squared algorithm
because for every pixel I need to check
every pixel so if there were just ten
pixels I have basically got like 100
checks but there's a hundred pixels I've
got one zero zero zero zero 10,000
checks so I hope I did that math right
so this is kind of with with with a 400
by 400 image there's going to be a lot a
lot of pixels to check so let's run this
and see what happens
did it to do okay I'm back that took a
really long time because it takes a
really long time there's 400 times 400
pixels there's a lot of pixels to sort
so this I'm going to have to I sample
the image down to a 200 by 200 image
which I think it can sort it in Java in
about 14 seconds so I'm going to run
that now and you can see the windows a
little bit smaller but I'll zoom into it
one 1000 two 1000 diptych come on pixel
sort come on to the pixel sort cringe
that's what you do while you're watching
you complain type in the comments there
you go
so you can see this now sorted every
pixel horizontally by brightness let's
see if we can sort it by hue which I
think will be interesting to try okay so
instead of looking at the brightness
why don't I look at the hue so
processing has a function called hue
which will give me the hue value of a
particular color so I can actually look
at that and I believe this should take
just about the same amount of time do
the pixel sort by hue do the pixel sort
by hue this could get edited out maybe
some day too and it could just up here
so you can see look at that this edited
nicely by hue and so you can see I have
all of these sort of like orangie colors
at the bottom yellow colors were getting
this nice sort of palette so this is
pixel sorting now the thing is I'm just
doing sort of like the raw basic
algorithm you should take this code find
milling to get up and be creative with
it so first of all you should think
about um what's it different what's
another way you could imagine sorting
the pixels besides just brightness or
hue
here's another thing I'm just ordering
them horizontally what if I order them
vertically or what if I order them
spiraling out from the center are coming
in from the edges what types of other
strange what if I only sort part of the
image and you'll see lots of art if you
go again if you google image search
pixel sorting art you'll find a lot of
creative examples of this and I hope you
make something and send it to me but
before I go I want to add one more thing
to this because it takes so long I think
it would be interesting to watch it sort
animate the sort so in other words the
sorting happens right here this is the
so I'm going to save this and I'm going
to save a new version called pixel
sorting animation so what I'm going to
do now is I'm going to the processing
has a draw loop right it's actually
drawing this stuff over and over again I
did all the sorting and setup and was
finished but what I want to actually do
is do the sorting in draw so everything
single time through draw what I want to
do is sort but instead of having a loop
draw is already looping so I is
something that can become a global
variable I'm going to call it index set
it equal to zero I don't need this
anymore I don't need that outer loop
anymore this is going to do one one
pixel per frame of animation so the
selected pixel is index J starts at
index and then whoops
and then I swap at index index and then
what do I do I say index plus plus and I
should also check if index is greater
than or equal to sorted pixels dot
length you know I don't want the eye
kids belt leg how do you spell length oh
my god
if it's greater than length minus one I
could if it's as long as it's less than
length minus one I can increase it by
one okay so now let's run this
you can see like it's very very slowly
you can see it kind of sorting up there
right I'm zooming all the way and it's
happening very very slowly sorting by
hue now again this is such a tiny
resolution image that we're barely
seeing it so now I can actually let me
go with the larger image I'm going to
change this to 800 by 480 row so now we
can run this and I can sort of see here
there it is you can see it sorting the
pixels now here's the thing I'm doing
one pixel at a time per frame I think it
would be much nicer if I at least did a
bunch so I'm going to actually just
write a little loop inside of draw to
say hey whatever I was just doing do
that like I don't know 100 times 100
times is not that many there's a lot of
pixels so and so I'm going to put that
like so I'm only doing a hot now I'm
doing 100 pixels at a time and let's see
what that looks like is it going any
faster let's let's try let's try a
thousand pixels at a time ooh that's so
a thousand pixels is actually quite slow
per frame so I think I've kind of lost
one thing I want to look at is what the
frame rate is so I want this to run I
want to do the most amount as I can the
most amount of pixels I can but still be
running it like 30 frames per second
which I'm clearly not so let's do it at
100 and we can whoa why is this so slow
you know what's the load oh you know it
might be the problem no anyway I
I need to I'm gonna I'm gonna up update
this get very CPU heavy and it's just
very slow I you know I think there could
be some more creative ways I could think
about animating this we could let this
run for a little while and see how far
it gets but for example all right so
this is now animating at 30 frames per
second which is quite nice and doing
like 10 pixels at a time and you know
it's doing 30 frames per second so
that's the
pixels per second still going to take a
very long time to finish the whole thing
but there might be some other creative
ways like this might actually look more
interesting if I didn't draw the
original image and you just saw the
pixels getting filled in the ones and
the ones that have actually been been
swapped or I might like if I was doing
it out from the center so I'm sure you
will come up with some creative rifts
off of this please share them with me in
the comments share them with Twitter
share them with me on Twitter at
Schiffman I hope you enjoyed this coding
challenge in processing about pixel
sorting you could do this at very high
resolutions it'll take a long time to
render but then you can export it out as
an image or something and make a big
print and let me know if you make
something and I'll see you again in a
future video goodbye hey guess what
everybody I'm back
look at this that doesn't look right I'm
getting this interesting strange smear
but it's not actually sorting the reason
why it's not actually sorting is I
didn't notice when I move stuff around
to animate it look where the swap is
happening the swap is happening inside
this J loop I want to look through all
the pixels find the brightest or the
ones with the highest hue and at the end
of that swap it's oh I just had like a
typo essentially where this closing
bracket is in the wrong place I need to
close that J loop here and now it should
actually sort by hue okay so now we
should see something more correct so I
had that mistake and you can see now
that this sorting is actually happening
correctly now what I'm wondering is if
having the swap inside was somehow
making it also run slower and if I could
actually manage to have it run faster
yeah it's still pretty slow it will
slowly gain speed over time because as
it gets further along
oh you can't actually see my frame rate
I just noticed as it gets further along
OOP as it gets further along this is the
frame rate here as it gets further along
it has fewer pixels to check because
it's getting further and further into
the image and you should see that frame
rate go up and up and up and up and up
but you can see now that the sorting is
actually now happening correctly and it
actually sorting by hue again I'm you
know by hue is not necessarily the well
is it so the most I there are lot so I
think this is a challenge to you is like
I just picked you and I just pick
brightness as arbitrary numeric
indicators of a pixels value as a single
number
but you might think about other ways of
thinking about how could you order those
pixels and so I'm gonna let this run for
a while and hope you enjoy it and also
you know you could pick a different
image on the sunflower you can mess
around with how you're sorting it I'm
sure you'll come up with something
creative and I'll see you in a future
video I think this might really be the
end goodbye
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>