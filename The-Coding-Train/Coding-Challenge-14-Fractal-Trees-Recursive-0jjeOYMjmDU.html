<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Coding Challenge #14: Fractal Trees - Recursive | Coder Coacher - Coaching Coders</title><meta content="Coding Challenge #14: Fractal Trees - Recursive - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Coding Challenge #14: Fractal Trees - Recursive</b></h2><h5 class="post__date">2016-05-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0jjeOYMjmDU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to another coding
challenge in this coding challenge I am
going to build from scratch in
JavaScript a fractal tree and I'm gonna
do kind of you know you can see once
we've made once this video is over and
I've made one example of it you can see
sort of variety of images here of things
you might be able to make from it and
you'll also see that there are a few
different follow up videos after this
one that show other techniques for
generating trees in different ways but
let's just get started first by let me
just draw you a diagram to sort of so
that we can kind of understand what's
going on so the core idea of a fractal
tree is we have a recursive definition
so what is a recursive definition a
recursive definition is something that's
defined in terms of itself and actually
there's a math function which is known
as factorial 4 factorial equals 4 times
3 times 2 times 1 you know 10 factorial
equals 10 times 9 times 8 times 7 times
6 times 5 times 4 feet I 1 now 3
factorial is equal to 3 times 2 times 1
so you could actually say that 4
factorial is equal to 4 times 3
factorial or that any number n factorial
is equal to itself times n minus 1
factorial and this is a recursive
definition I'm defining factorial in
terms of itself which seems like
something you shouldn't be allowed to do
but it is something you are allowed to
do in fact you're encouraged to do and
all even though you might send us get a
headache all sorts of wonderful
beautiful elegant things can arise out
of recursive definitions one of which
being fractal trees ok back over here
that was completely unnecessary but I
did it anyway so what is the recursive
depth this is like some math stuff and
some numbers look what does it mean to
have something that's visual defined
recursively well we have this idea of a
branch so I'm going to say a branch is a
beginning and end point and it is
defined as having two branches attached
you probably can't read that doesn't
really matter
this says branch is defined as a line
that has two branches attached like this
so let me draw that over here this is a
branch and as two branches attached
oh but these are also branches so they
have two branches attached oh and these
are all also branches so they have two
branches attached oh oh and these are
all also branches and they have to rent
etc etc etc so a branch is defined as
something that has two branches and
those have branches this is known as
recursion now one thing you might be
thinking about is where does this end so
in the theoretical magical world of
fantasy this would go on forever and
these branches are getting shorter and
shorter and they would get infinitely
small but in the world of pixels and
programming we have to stop somehow so
we need an exit condition and actually
that's built into this up here I just
didn't explicitly state it whenever you
get to one you stop counting down in
this multiplication for a factorial and
the same thing is true here we could say
continued branching each branch has two
branches attached to it until it is less
than some number of pixels long so this
is the idea and the way that this ends
up happening in code is if you have a
function whoops that's not how you spell
function in code if you write a function
and you call it something like branch a
recursive function in code is defined
according to itself meaning somewhere in
that function you're going to actually
call itself so you're calling the
function you're defining from within the
function and it results in this word
loop I'm gonna call branch which calls
branch which calls branch which calls
branch and eventually stops at some
point so this is the idea of recursion
and how it's implemented in code let's
go and actually write this code now dare
I say I'm a little bit afraid to do this
but let's see what happens okay so okay
so what I have here is a p5.js sketch
p5.js is a JavaScript framework links in
the video description of where you can
get it and get started with it and the
only thing that's going on right now is
that html5 canvas has been created and
I'm drawing a gray background there so I
just want you to be able to see that I'm
going to go back to over here where I'm
running it and you can see what you can
see there's my 400 by 400 pixel
background so I won't have the trunk of
the tree to start with so just to kind
of get that going let's draw a line that
goes from
the center 200 and the bottom two to the
center and the bottom minus some length
so I'm going to make a length variable
which starts at a 100 and now and this
line I want it to be white and so now if
I run this again you can see okay I've
got a lines about so I have the trunk so
what I want to do now is actually put
that code that's drawing the trunk into
a function so I want to call branch and
branch is actually going to draw that
line so let's do that so the next thing
I'm going to do is rake this a function
and one thing I want to do with this
function is I want to give this function
an argument and that argument is how
long to draw that branch so I'm actually
going to put that variable here in the
function and then I'm going to say line
200 height to 100 height minus length so
UPS so now here I actually want and I'll
just say stroke 255 here now what I want
to do is say branch I forgot what I was
doing 100 so you can see here that the
idea here same same result is that now
I'm calling this function branch and I'm
giving it the value 100 now here's the
thing the way that this is going to work
is I don't actually want to only come
over here so I want I want to do is
actually instead of drawing the the
trees starting at this bottom location
which is 200 comma height I want to move
the origin which is here all the way
down to here I always want to be drawing
the branches relative to the origin by
using the translate p5 function which
sort of moves that zero zero point
around and once we start doing a little
bit more of this you'll see why that
makes a lot of sense so let me come back
over to the code and what I'm going to
do is right here I'm going to say
translate to 200 comma hight branch
100 and now this becomes draw a line
from 0 a 0 to 0 comma negative length so
now if I run this program same exact
result so we have a very simple
beginning we are translating to the
bottom we are drawing a branch from the
bottom straight up so what do I want to
do next I have drawn a branch from the
bottom straight up will guess what I
want to do I want to rotate and draw a
branch to the right so what I want to do
is now say let me rotate by like I don't
know 45 degrees let's start with 45
degrees is PI divided by 4 and then let
me draw another branch 0 0 0 negative
length oh you know what I also need to
translate ah so before I write I I'm
down here and I drew the branch like
this and now I want to start drawing
from here so after I finish drawing the
branch I need to translate back up to
here ok so before I rotate now I need to
translate up 0 comma negative length so
we're drawing that bottom line we're
translating up to the top we're rotating
and drawing another line let's see what
that looks like
there we go second branch now I want
that second branch to be a little bit
shorter so maybe I'll make it 2/3 of its
size so multiply it by 0.67 so you can
see now it's a little bit shorter but
have I done anything recursive here yet
so am I really going to go and draw
every single line of the tree is a
separate line function no what do I
actually want to do I just want to call
branch again and what I want to call
branch with a slightly shorter branch
now I'm tempted to run this and I could
run this but if I run this I browser is
going to crash most likely let's just
try it
Danger Danger let's live dangerously I'm
going to run this so you can see I would
we got an error
maxximum call stack size exceeded so
what happened here you can see it
started doing it but it's just like
decided it couldn't do it anymore what
happened it's calling branch from within
branch and that's an infinite loop
branch calls branch calls branch calls
branch cross branch so I need to say at
some point
don't call branch anymore what every
time I call branch length is shrinking
so I could actually just say something
like only if length is greater than like
four pixels should I actually bother
calling branch again so now you can see
here I'm drawing the first line and then
I'm calling branch again and rotating
calling branch again and rotating so and
we could see here I could continuously
I could I could make that angle of
rotation a variable so I said it was pi
divided by four and I could rotate by
I'm going to call that angle actually by
an angle and one thing I could do just
so you see is I can I can make a slider
let's just do this really quickly
but there is a p5 in the p5 Dom library
I can make things like a slider and I
want to have a slider from zero to 2pi
oops I can't spell spell 2pi and i want
it to start it maybe pi divided by four
and then what i want to do is say in
draw angle equals slider dot value so
what I what I'm doing now is if I run
this yep ah so create slider is not
defined probably because I need to
actually reference the Dom library in
the index file so now you can see whew
oh look at this
so one thing by the way it's working but
notice how the slider it can only move
up by units of one so one thing that I
forgot is there's an argument there's an
there's a fourth argument which is the
step size for the slider so I want to
move it up by like lower increments and
you can see here now I can sort of play
with that angle and I can turn what that
angle of rotate
is for this tree thing but I've only
branched to the right now there's a
couple issues one is this butter if this
pie is not defined error on sketch line
one you know what sort of strange as
looks looks is that actually this is
sort of a little weird thing but pie is
a built-in variable part of the p5 Dom
library of the p5 library not the Dom
library and the p5 library none of its
stuff is available in setup just yet but
it doesn't really matter because I'm
getting it from the slider so let's
change that to zero so I can go back and
we can see okay so now I have this tree
that I can change the angle with this
slider you can see all the way from zero
to 2pi and I probably actually just want
to make it from zero to pi divided by
two or whatever but we can change that
range later now that's only branching to
the right so what if after I branch to
the right I also then rotate by negative
angle and branch to the left now really
what I want to do is actually have this
if statement around all of that so the
idea here is that for every branch
here's the recursive definition of a
branch draw a line and then as long as
it's still long rotate to the right and
draw another line rotate to the left and
draw another line and do that for every
single branch let's run this it's not
going to work and we'll figure out why
it did something kind of interesting and
crazy look at this crazy thing now do
you see what's happening everything is
connected everything is connected it's
like this
what did I do I went like this like this
pen I went like this and then I branched
to the right and then I branched to the
left and then I branched to the right of
that until I don't know what I did but
I've always going whatever that
recursive order is I'm always going from
where I left off but actually what I
want to do is I want to go to here and
branch to the right and then they need
to come back here before I branch to the
left and then this branch is to the
right and then come back here before I
branch to the left so the way that I can
come back is by using the push and pop
functions in p5 because push is a
function that says save the
transformation state so if I move from I
translate from here to there
and then I say push I save I can draw
this to the right then I can say pop to
restore and then draw this to the left
so if I come back to the code you will
see that all I need to do is add a push
right here before I rotate and branch
and then also Anna pop right after and
also around here so the idea here is
that for every single branch every
single branch is defined as a line and
then when you get to the end of that
line you save where you are and branch
off to the right restore where you were
and branch off to the left now the way
the order of things happen is not
exactly that because once you call
branch you're then into the next one and
then you're the next one then you start
popping back all the way I encourage you
to try to like do some sort of acted out
physical demonstration or drawing like
try to be the computer following all the
pushes and pops but you'll see now if I
run this I believe it will work and you
can see now we have this lovely fractal
tree and I can sort of like change the
angle now you know this is only so this
is really finished I've only really
scratched the surface here there's a
bunch of things that I might encourage
you to think about doing number one is
can you keep track of which level your
of the tree you're on and draw the
branch with a different thickness using
stroke weight so that's an interesting
problem I'd be happy to demonstrate a
solution at some point to that you might
think about well what if the angle isn't
the same with all of those branches what
if there is a variable
of branches instead of always - always
with equal angles angles and you can see
that in this Google image search for a
fractal tree you'll see that you can you
know with various other ways of kind of
doing this you might be able to get to
start to get different types of more
chaotic or out in some ways organic
looking qualities rather than than this
very exact perfectly symmetrical fractal
so this concludes this part of just
doing this basic fractal tree I'm going
to do this again in the next video in
another video but instead of using push
and pop and translate I'm actually going
to use sine and cosine of some math and
you'll see what doing it that way allows
you to do something a little bit
different which might interest you based
on how you could then modify the tree at
a later point okay thanks for watching
and I'll see you in another video maybe
or maybe not
good bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>