<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Coding Challenge #8: Solar System in Processing - Part 2 (3D) | Coder Coacher - Coaching Coders</title><meta content="Coding Challenge #8: Solar System in Processing - Part 2 (3D) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Coding-Train/">The Coding Train</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Coding Challenge #8: Solar System in Processing - Part 2 (3D)</b></h2><h5 class="post__date">2016-05-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dncudkelNxw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to part two of my solar system
simulation generator thingamabob so this
is turned into a multi-part series I'm
probably going to do one or two more but
this part what I'm going to do is take
this 2d solar system orbiting thing and
turn it into 3d so instead of circles
we're going to have spheres instead of
rotating just around in a two
dimensional plane are going to rotate in
a three dimensional space so now before
I get to that I want to make a couple
small improvements here I think I could
be a little bit more thoughtful about
how I pick the sizes of the planets and
how I pick how far they are from the
thing they're orbiting so let me dive
into the code real quick before I make
this a 3d version and just go down to
where that happens that happens here
every time I make a new planet it gets a
radius that's based on the previous one
it's they're shrinking they're shrinking
they're shrinking and it also gets a
distance from the previous one which is
some random number and this is what I
could really improve so one thing that I
want to do is say okay the distance if I
wanted it to be perfect
right I lost my oh here it is a myopic
over here sorry for this okay so if I
have this planet and I have this thing
orbiting it if they were exactly
touching each other then I their
distance would be the two radii that sum
of the two radii so first thing I could
do is just show you that and I'm going
to change this to radius plus R so let
me run this now we should see see how
now do you see how the first one worked
I don't know what happened with the
second one let's think about this what
did I miss here oh the distance I'm
dividing by level so I should actually
just say that and now you can see that
they're in a sort of precise location
every single circle is rotating around
the edge of the other one that's kind of
a nice effect I almost want to keep it
this way and by the way you get some
really interesting patterns if you drew
like trails where the circles are going
you try that on your own who said it to
me but I'm not going to go down that run
but what I'll do is I'll just say why
not make distance be random between that
exact spot and that distance and that
amount
times two so in other words I'm saying
let's make a random distance between
let's make a random between where this
would be exactly and then this exact
amount times two so over here so the
sort the planets will orbit somewhere
between being exactly touching the
original planet the orbiting the thing
and a little further away okay so uh
here we go uh okay so now we can see I
don't know I just kind of like how this
looks better everything has kind of a
more thoughtful spacing and I don't know
if the ratio of the sizes it's good but
we can worry about that stuff later
because what I really want to focus on
is moving to 3d okay exciting now is the
time three minutes into this video we're
going to add 3d so the first thing I'm
going to do to add 3d this is going to
be a magical thing is I'm just going to
go here and I'm going to say 600 comma
600 comma P 3d Dada 3d solar system
there you go so this is actually now
rendering in 3d using processing 3d
renderer but of course I'm still just
drawing circles and I'm still just
placing everything along that
two-dimensional plane but it is
important to note that processing one of
the one of the reasons I like to use
processing is that it lets you sort of
blend and blur the lines between 2d and
3d because all the 2d drawing stuff in
3d but let's look let's look a little
more carefully at this and and and start
going making this even more 3d so first
thing I could do to make this more 3d is
instead of drawing an ellipse I could
draw a sphere so the function to draw a
sphere in processing is just the word
sphere and then sphere takes a diameter
or radius I'm not really sure let's try
radius so it lips notice how I said
radius times two because I know for a
fact the radius the ellipse function
requires a full diameter as the argument
but I think sphere maybe just once a and
I does this look right to you and now
first of all it's sort of hard to see
what's going on so first of all you see
what a sphere actually is everything in
3d is made up of all these kind of like
polygons and shapes and you can see it's
just this mesh of all these kind of
rectangles with a line divide but it's
really like a
triangle mesh but we don't want to see
all that what we want to just see and so
one thing that I'll do is here in where
I'm drawing it I want to say no stroke
and I'm going to just say fill 255 and
I'm going to do this again and now look
at that this nothing about this looks 3d
because I'm just staring straight at
these spheres that are pure white
without a texture without some shadowing
and lighting I don't really even see
that 3d effect so one thing I could do
just to kind of see the 3d effect is
just add the very generic function
lights so lighting in 3d is it ik
interesting and complex topic and you
can have spotlights and directional
lights and ambient lights and different
colored lights and all sorts of things
I'm going to stay away from that maybe
someday I'll have the courage to a video
about that but lights the simple lights
function just generically adds kind of a
wash of light into the scene and you'll
see what that's going to do so now we
can see that now this has the appearance
they have the appearance more of spheres
it's very subtle but there's some
shadowing on the spheres based on the
lights now this is almost like hey we're
done I made this simulation in 3d look
and in a way it looks kind of 3d and I
could add some camerawork and do some
other things but everything is actually
happening all on one plane and what I
want to do and this I'm going to try to
draw a diagram here just to kind of like
work this out in my head is let's say I
have a sphere what I want to do is
arbitrarily now again I'm not doing
anything that has anything to do
necessarily with how the actual universe
works just trying to create something
that looks kind of interesting and
figure out how stuff works in processing
but I want to arbitrarily create a
vector out from a particular planet and
create another planet and then maybe
rotate around the planet so there would
be all of this would happen I'm drawing
in two dimensional space so it's very
hard to do and I have no artistic talent
whatsoever so I can't even really draw
this 12 but you can sort of imagine I
want to arbitrarily place the planet out
here and have it rotate like this or one
out here and have it rotate like this so
the idea is that I want to make a vector
a random vector so let's do that
and I'm going to go into the planet
object and what I'm going to do is I'm
going to add a variable I'm going to
call it V just for lack of anything else
that I can think of right now I'm going
to say V equals P vector dot random 3d
so this here is a particular Fobo I'm
not in the right place sorry everybody
that was a little awkward moment there
but yeah I don't know big something like
CGI magic and fix that someday but so
what I created here is a random 3d
vector so any vector pointing in space
that is of length 1 and so then what I
want to do is multiply that vector by
distance so in other words I want to
scale it by the distance that it should
be so again if only I had like good
spherical things here my fist will be a
planet then I make a unit vector of
length 1 pointing out and then I want to
scale it by some distance that it should
be and now I have another planet out
here visual a boy this is quite pathetic
I need to I need props somebody send me
some props ok so then when I'm drawing
it let's look down here I don't want to
translate simply along the x axis by
some distance like I did in 2d I want to
translate by that vector V X V Y V Z and
what I'm going to do here is I'm going
to take out rotation for right now and
just translate and we can see what's
going on here and you can see that there
are a bunch of spheres and let's let let
me fix if you think you know what I
going to keep going so let me fix a few
things to make this sort of easier to
figure out number one is if you recall
the planets are picking a random number
of moons so I want to just change that
to 1 so every planet just has one moon
and I'm also going to have fewer levels
so we can see now that when I run this
whoops
what happened here
okay wait pause timeout timeout
oops so I forgot that in the original
Sun the original planet has five moons
around it so I just want to have that
start with one also and we can see now
that we have something simpler to look
at which is just one Sun in the middle
one moon around that and one moon around
that okay
I'm realizing something I'm realizing
that this would be a lot easier to look
at and understand if I could just really
quickly like drag the mouse around and
like spin the planets and turn the
camera so even though I intended to do
this in a separate video right in this
video right now I'm gonna add something
called PZ cam to this example okay
so how do you add PZ Campisi cam is a
library and I'm going to do sketch
import library add library OPG cam has
already added so so I've already done
that I don't know when I did that but by
the way what you'll need to do is here
Oh go to add library search for PZ cam
click this and then you'll be able to
hit you'll be able to click install so
that it's installed and then you
shouldn't need to restart processing but
if you run into any issues just restart
processing okay so once you have PZ cam
installed I can do sketch import library
and just select here PZ cam and you can
see it added some import statements to
the top a library being something that
allows you to bring in additional code
that's not part of core processing to
call automatic functions and what PZ can
does is it automatically adds now
Interactive Mouse camerawork to your 3d
thing so then all I need to do is create
a PZ cam or maybe it's just a PZ object
no PZ cam object no what is it called
Oh PZ cam there we go a pz cam object
called cam and I'm going to say can
equals new PZ cam and I think I have to
say this to refer to this sketch because
it's going to control this sketches 3d
view and then I give it like some number
which is basically I want it to look I
want the camera automatically to look at
the center of the world zero zero zero
from one
hundred units away so by the way if I
wanted to look at a different part of
the world I could say I want to look at
zero comma 100 comma zero I could add
that in as well but I'm just going to
say this comma 100 and I'm gonna run it
and now you should see now where is
everything
ah it's all weird so wide am I not able
to like find the stuff and kind of
rotate it around it in a way that makes
sense the reason is because I had this
extra translate in there with divided by
2 height divided by 2 so that that was
my kind of like camera work just like
move the origin to the center of the
window now that I'm using peezy cam I
don't need this anymore I can run this
and we can see oh my goodness look at
that it there it is
I'm just like a hundred pixels away and
I can't I think if I hit like command
but I can pan or control I can zoom in
and out but this is what I want to see I
want to see something like this really
easily and so what I'm going to do is
just start 500 units away start further
away so now we can see this is what I've
got and you can see now the shadowing
you can see there's two each one of
these has a this planet has one moon and
that planet has one moon let's even be
let's even remove this and just start
now with a single moon so we can see
here I have the Sun and a single moon
how can I get that moon to rotate around
the Sun okay here's how we're going to
do it now I'm sure there's some really
excellent 3d thoughtful smart way of
doing it I'm gonna do it in a sort of
tricky way that I thought that I know
works better that I hope works and I'm
going to use something called the
cross-product okay so let me come over
here and let's talk about the cross
product the cross product is let's say I
have two vectors here is a vector here
is another vector the cross product of
two vectors is this a vector that is
perpendicular to both of those vectors
so if I if these were my vectors I would
still also get this particular vector so
the reason why I want to do that is
remember this is the Sun this is the
vector where my moon
is and what I want essentially is for
that vector to rotate around the Sun
like this so what I need essentially is
a vector that's perpendicular like I
want it to rotate around this axis like
this so in other words let me try to do
this in three-dimensional space
I don't know prop I have I have some
tissues I'll be my planets right here's
the Sun I'm going to go I'm a vector the
moon comes out and then I have my fist
is a sign I have just perpendicular
vector I want to rotate totally lost
myself I want to write I think if you
would just imagine it or sort of think
about what I'm doing it makes sense
right because I need like I can't rotate
if I rotate around this axis this is
just going to spin right this is the
vector if I rotate around that axis it's
just going to spin like this I want that
whole vector to rotate so I need a
perpendicular vector to rotate around if
this makes any sense to anybody then
I'll be surprised and very pleased okay
should practice explaining that but so
how do I get a perpendicular vector so
right here what I want to do is make
another vector I'm going to call it P
for perpendicular I'm gonna make a P
vector V and I would I want to say V dot
cross so to get a perpetuity vector I
want to take the cross product with
something well what should I take the
cross product with honestly I could be
smart about how I'm doing this but if I
just pick some arbitrary I mean there's
a lot of that in three-dimensional space
there's a lot of vectors that are
perpendicular this vector this one's
perpendicular this was perpendicular
this one perpendicular this would
perpendicular right any of these vectors
are perpendicular so I just want to get
an arbitrary one so if I have some other
vector I'll get something and I do the
cross-product I'll get a perpendicular
one so what I'll do is just say v2
equals new P vector and I'm going to
just arbitrarily pick a vector that
points straight out and you know maybe
I'll actually just pick something sort
of arbitrary and I'm going to make P P
the cross product of V the vector that
is actually coming out for
this planet to wear from the Sun to wear
this planet should be and now I've got
some perpendicular vector and now I can
use something here I can use
Processing's rotate function in 3d you
can say you can say an arbitrary axis I
want to rotate around so if this is the
x axis rotating around the x axis would
be like this if this is the y axis
rotating around the y axis would be like
this z rotating around the z axis would
be like this so the functions rotate X
rotates around this axis rotate Y
rotates around this axis rotate Z
rotates around this axis but if you want
rotate around this axis you just need to
give it the vector and then the angle
and what's the vector I want the one
that's perpendicular to the planet
sticking out so I'm going to say rotate
px py PZ so rotate around the vector
from the x y&amp;amp;z by angle and let's run
this now and hope we get something that
looks right am I not increasing the
angle
I don't think oh no the angle is
increasing what did I miss
ah time out everybody let me look let's
look is angle first there we go
okay so the angle is the first argument
so look at this now I have this planet
perfectly orbiting this other one so
lovely now let me just look to be clear
let me draw these two vectors so you can
see what's going on because I think this
will make things make a little bit more
sense so let me draw a line from 0 0 0 v
XV wat Y VZ let me draw that and do I
guess I need to give it a stroke here
and I should say no stroke down here and
let me just get the stuff where it
should be going can you see it it's very
hard to see it in there because it's not
the plane that's not very far out so let
me draw it a longer so you can see it
and multiply that vector by ten there
you can see that is the vector that is
controlling where that planet is now
let's draw the other one the
perpendicular one this is the axis
around which I'm rotating and now you
can see that's the axis around which
it's rotating it's a vector that's
perpendicular to that one so this is
just a quick and dirty way to get a
sphere arbitrarily rotating around
another sphere at some arbitrary axis
that's random so again you might have
some other algorithm by which you want
to calculate this stuff and I you know
the cross product that I picked is just
some arbitrary vector I probably could
be more thoughtful about that but this
works okay so now we can start doing a
couple things one is let's make sure
this is really working by adding two
where do we pick let's add another level
and you can see now in addition this one
now has this this other smaller one is
rotating around that one you see all of
the perpendicular vectors maybe what
I'll do right now is get rid of this x
10 thing and you might still be able to
hopefully see everything kind of you can
see these vectors here and maybe let's
get rid of I'm kind of like I'm lost in
my hope this is like become fascinating
to me and I like forgot that I'm
recording a video talking to anybody you
know my god we drive it but you know
it's useful I think to see the the lines
drawing the vectors but the point of
this really is to do what is to not have
these lines and to just see these planet
arbitrarily orbiting each other so now
you can see here we go and I can I can
whoops I can zoom in and out to kind of
get a closer look and now I'm going to
do the exciting moment how long have I
been recording this maybe like 20
minutes or so I'm going to do the
exciting moment where the whole point of
doing this was to allow each planet to
have like a bunch of things so like for
example what if I give it the first Sun
to have two
orbiting it you can see now we've got
something a little more interesting here
and you can see that the rotations are
could be weird enough that you could
start to like it almost looks a little
bit the speeds could be very slow the
way one is rotating around another while
the other one is rotating could make it
kind of have this optical illusion of
not rotating but I can assure you that
if we that everything is rotating around
everything else and then I can also
let's let's give it a four to start with
and then let's also allow them when we
when they when they create their moons
to do what to have a random number
between zero let's not give them too
many and too so we can see now look what
we've got here we've got a nice system
of many planets orbiting other planets
everything's spaced out and everything's
at random angles along random axes so
hopefully this gives you the idea of how
to get started with creating a
three-dimensional sort of nested solar
system where you have a sphere with
spheres rotating around it with other
spheres rotating around it and with
other spheres rotating around it and
this code you can find if you look in
the description this video you'll find
the code for this and what I'm going to
do in part 3 is I'm going to add
textures to these planets so I'm going
to show you how you could draw the
spheres with other textures and maybe
put a background or something else like
that to make it feel more Spacey okay
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>