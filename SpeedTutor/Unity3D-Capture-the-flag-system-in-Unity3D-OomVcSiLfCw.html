<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[Unity3D] Capture the flag system in Unity3D | Coder Coacher - Coaching Coders</title><meta content="[Unity3D] Capture the flag system in Unity3D - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/SpeedTutor/">SpeedTutor</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[Unity3D] Capture the flag system in Unity3D</b></h2><h5 class="post__date">2014-05-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OomVcSiLfCw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so I've got a new tutorial
today and this is going to be about
making a sort of capture the flag system
so lot of games a lot of FPS games which
have this sort of game mode in maybe
like battlefield color due to whatever
you'll see a flag and then depending
what team you're on your lava spill to
capture this objective and obviously
change it to your team's color so I'm
going to base it on like a red and blue
sort of theme somewhat similar to Halo I
guess but this is just going to be a
really sort of simple where and giving
you the core ideas of how to create this
so all of god in my scene is I've made a
flagpole within unity all is unity so
I've created the pole I have got a
Collider which is just a box I'm gonna
remove the mesh renderer so the box is
there and I've got it as is trigger I
just named it capture Collider so this
is what we're going to be able to go
inside when you know whatever play
you're going to be if you're red are
blue then I've got three different flags
I've got one blue one red and one
neutral so the blue team the red team
and then when it's not captured by
either and I've got some particle
effects just to signify to make it easy
for everybody to see that when a
particular team has actually captured
the objective now what I've done for my
first-person controller I've created two
tags one called red team on one cob
loading so then depending on the tag
that your player has obviously you'll be
able to run the Roma capture down say
the blue team had it the red team could
run the capture down so realistically
all I've really got in my scene is I've
just got a blue a neutral and a red I've
spelt neutral wrong but that doesn't
matter for now and obviously I've made
that with the different actual flag
colors so all I've done it is literally
I've got 3 differents cubes underneath
each other inside each other just with
different colors so we're going to
switch those on and off depending on how
we capture and
similarly with the particle effect I've
got different colors depending on who's
captured it so initially what we're
going to do is we're going to write
something for the actual capture
Collider so we're going to detect when a
player of a particular tag walks into
the collider
so what we could do is going to start
off by creating a JavaScript file and
we'll call this flag capture then what
we'll do is open up in monodevelop or
once that done I'll zoom in and what
we'll do is I'll delete the two Stein
functions and I will right start by
writing private variable cap controller
as type capture controller and this is
going to reference our script that we're
going to create soon so we're going to
create a script called capture control
so we can control all the things that's
supposed to go on when were a specific
team member so what I've got is got
function start and then we'll add two
curly brackets below and say that cap
controller equals game object dot find
open brackets in quotes first-person
controller close these quartz up and
then say get component open brackets
capture controller just make sure that
I've kept the names correct and then
what we'll do below here we'll say that
function on trigger enter open brackets
call call on Collider close that up add
two curly brackets below there and we'll
say that if call dot tag I know that's
changed it to color but I'll change that
in a second is equal to the blue team
then we'll add two curly brackets below
and sick-out controller dot blue t is
equal to true
all I'll do is I'll change that to coal
so what we'll do before I get everybody
confused we're going to create another
JavaScript and we're going to call this
as I said before capture controller and
don't worry about any errors for now so
then we'll open up capture controller
and then what we'll do we'll delete
these two again and we'll start by
writing variable blue team as type
boolean equal to false then variable red
team as type boolean equal to false
sometimes it changes that and then we'll
save this then we'll go back into other
script so we can then what we're doing
is we're referencing the script over
here we're going to be changing the blue
team which is here to true and then
we're going to do some other things
there so what we're going to do here is
that we're going to copy that F
statement paste it below and then we'll
say if it equals red team
we'll have red team equal to true and
then what we'll do is we'll copy pretty
much this function again paste it in
below and instead of enter we're going
to say exit so obviously if either
player exits we're going to do Blue Team
and Red Team again and then we're going
to set these both to false and false so
that's pretty much it for the scripts
all it's doing is when we enter the
collider depending on what team were on
it's going to set some values to true or
false when we exit or enter and then
we're going to go on to creating our
actual controller to control everything
that's going to actually go on within
you know to make the flag change
essentially so what we're going to do is
we're going to write a private variable
and call this red capture percentage or
percent official and then have that flow
equal to Z
zero and then we'll have another
variable called blue capture percentage
a side flow equal to zero then I'm going
to add a little note here so because
we're gonna have a few variables we're
going to have this called flag objects
and I'm going to write variable flag
read as type game object
and then what I'm going to do is
actually copy this variable pissed in
twice change that to flag blue and
change this to flag neutral and then
below there we'll have this four
particles and obviously you can skip
this bit but it's pretty much going to
be exactly the same thing as before but
I'm just going to change this first word
to mist and it can we can you can have
some particles you don't have to have it
exactly like mine but we're just going
to do this to make it more obvious so
initially what we're going to start by
doing is making sure that everything is
actually turned off to start with
because we don't want to see certain
things when we actually start the game
or whatever you're doing
so we're initially going to say flag red
which is the game object up here don't
get component up and brackets mesh
renderer close that up dot enabled
equals false the mom to do is I'll copy
this line and I'm going to paste it in
twice then we're going to copy flag blue
to here I will make sure that flag blue
is equal to false and then we're going
to start off by flag neutral being equal
to true because nobody has the flag at
moment so we'll keep it as the neutral
color then what we're going to do is
I'll copy these three again if we use
a particle system obviously if you know
you don't have to use these what we can
do is then just copy mist red mist blue
and then mist neutral and have it
exactly the same so we're going to be
able to see the neutral okay
and so that's initially for what we're
going to have for the star so what we'll
do initially is we're going to start by
writing our update function so this is
going to make sure we up there a card
litter who's in the zone to capture the
flag so what we're going to do is write
function up down so initially what we're
going to do is we're going to said if
blue T is equal to true so if like and
the other script has changed blue team's
obviously the blue teams entered the
actual Collider itself we'll say the
blue capture percentage up here the
paste a plus plus equals time dot delta
time and for now I'll just put times 20
so it'll go really fast it'll capture
very quickly but you can obviously
change this to whatever you want your
card times by two or you can have it
just time dot Delta time sort of crown
up very slowly then we'll paste the same
thing in again but instead of blue this
time we'll put red and then we'll say
minus equals time not delta time times
20 so what this means is the what if the
blue teams inside the collider we're
going to make the percentage of the blue
team captured go up and then the red
team to go down so what we'll do is
we'll add two breaks a nail zoom out a
little bit so you can see a little bit
more over the code then we'll say pretty
much copy this same if statement
paste that in we'll just make sure we
put that break in
then what will said if red team is equal
to true or pretty much keep it as it was
but instead will change the blue team to
make my own this equals and the red team
to plus equals so really we're keeping
all the stuff pretty much the same but
we're just changing values depending on
which team member it's actually in the
color later itself so you're going to
say to me well what about when both
teams are in the Clyde obviously with
some games you'd actually won anything
tap and you don't want it to go up go
down but it's depending how you're going
to write your script for the get for
your I do if you choose to use this is
that what we're going to say is that if
red team equals true and and blue team
equals true we'll have two curly
brackets in here and then we'll say that
red capture percentage is equal to red
capture percentage with the semicolon
and then we'll also say we'll copy this
line pasted in below and say that blue
capture percentage is equal to blue
capture percentage so all this does is
it means that it'll just be equal to
itself you can set equal to whatever you
want tell it not to move so actually
what we're actually going to do now is
that once we've set that will say that
if red capture percentage is greater
than or equal to 100 then we'll add a
bracket and then two curly brackets
below and say that red capture
percentage is equal to 100 so we
obviously we could never go above that
and what we're going to do is like what
we did at the start we'll copy all these
lines at the start
and what we'll do is under here will
pierce the oldest in by what I like to
do is keep my card indented so I can see
where it's all going and so for this
time is if the red is equal to one
hundred what we're going to do is make
sure that red flag and particle effect
are equal to true so really all I'm
doing is change of the true and false
values depending on who's reached the
maximum to begin with so similarly like
we did exactly here we're going to copy
this if statement and then we're going
to put this if statement in below here
but instead we're going to say that if
blue capture percentage is greater than
or equal to 100 we'll say that blue
capture percentage is equal to 100 and
then what we'll do is make sure the blue
icon our flag is equal to true and
everything else is equal to false and
then what we'll do is we'll save this
and then we're going to do one more
instance here so if both teams are stood
in the capture point any one time and
they set it to a neutral values of fifty
each then what we're going to do is
actually set it back to neutral again so
what we'll do is we'll say that if blue
cap chip percentage is but this time
less than or equal to 50 and and red
capture percentage is less than or equal
to 51 then we'll say that neutral is
true again and blue is false
so you just make sure you copy and paste
all those correct statements in then to
make sure that we can never go below
zero so we don't obviously want to go
into negative values if one team takes
it far down because we need to make sure
that that doesn't happen the red capture
percentage is less than or equal to zero
then we need to make sure that red
capture percentage is set to zero and
obviously we'll do the same for blue and
we'll set blue capture percentage I'll
copy that I'll paste that in and I'll
save that so this is pretty much the
entirety of the script so I'll just
quickly run through we've had the other
script which triggers when we walk into
a Collider depending on the team we're
going to set some objects within the
scene we're making sure that we turn all
the non-essential objects off so we've
got the neutral to begin with we'll say
that if the blue team's inside the
collider will make the percentage for
the blue team increase but the red crew
team decreases vice-versa for the red
team so the blue team's percentage goes
down but the red team's goes up if the
both in at the same time the both set to
whatever their equal at that time if the
red capture percentage goes up to 100 or
set to 100 so it never goes higher and
we'll make sure that the red team then
enables their components obviously if
the blue team gets to 100 then the blue
team components are enabled if they both
get to the value of 50 so the both cap
down we're going to go back to a neutral
position and then if both either of them
ever get to zero we're going to make
sure that we can't go below zero and
essentially break the game so one last
thing that you might
to do just for debugging purposes so you
can actually see this going on you can
write function on GUI open up brackets
and then two curly brackets below and
say GUI dot box open brackets rect open
brackets again 10 comma 10 comma 300
comma 25 close the comma putting course
red cap and then in quotes then put add
a plus then add 2 quarts put a space
inside those two quotes and then say
plus red capture percentage dot 2 string
open brackets in quotes add a 0 close
that up add a plus and then add 2 quarts
but again add a 0 and a space in between
add a plus right blue cap then close
that quotation up add a plus quartz with
the space another plus blue capture
percentage dot 2 string open brackets in
quotes
0 close that up with a bracket and
another bracket so 2 brackets in a
semicolon so all this is doing is we're
actually showing some text red and blue
capture I'm actually going to show the
percentage going up as the time goes on
so what we'll do is go back into unity
and what I'll do is add to my capture
controller the flag capture and then
I'll add the capture controller itself
so you can see we can add all our values
here so what we'll do is we'll add flag
blue flag neutral flag red then we will
have missed Blue Mist red oops
I miss neutral
what makes you've got flag neutral back
there and what we'll do is on the FPS
controller make sure that you've got a
tag of so going to start off with the
blue team one thing I will care to
mention before I move on I forgot to
change the missed values obviously the
particle effect it's not got a mesh
renderer all it is is just a single
renderer so obviously for all the missed
values we just want to or all the
particle effect values we want to just
change that to renderer
so obviously the objects can stay the
same for the flags but the particle
effects need to be changed to trust
renderer so we'll save that back out and
one thing I will mention as well is that
on the 50 values when they're both equal
to less than or equal to 50 I need to
make sure that we don't actually set any
values there and one thing that you can
do is obviously I've added my both my
scripts to and my game object which is
the actual trigger so what we're going
to actually make sure that we do is that
in the flag capture we're going to
change this to whatever game objects
that we have the actual scripts on so
I've got mine on the capture Collider so
what I'll do is I'll copy that and then
I will sit will say you know obviously
were going to find it on that game
object not the first-person control and
then what we're going to do is we're
going to play the game and then if you
see the first-person controller is
tagged as the Red Team everything set to
zero we walk inside this the red team is
going to increase to a certain amount
and obviously if we get to 100 it's
going to change everything obviously if
I step out of this Collider now and then
I change myself to the blue team what
we're going to do is we're going to
notice that it counts down goes to
neutral
and then goes to blue so pretty much
that's the entirety of just making a
simple fairly simple sort of
capture-the-flag system within unity
using tags and using a simple bit of
counting up and down depending on who's
inside the collider so as ever
thanks very much for watching and don't
forget to Like comment and subscribe
Cheers</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>