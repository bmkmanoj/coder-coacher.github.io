<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>3. Survival Game Tutorial in Unity 5 - Stamina System | Coder Coacher - Coaching Coders</title><meta content="3. Survival Game Tutorial in Unity 5 - Stamina System - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/SpeedTutor/">SpeedTutor</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>3. Survival Game Tutorial in Unity 5 - Stamina System</b></h2><h5 class="post__date">2016-11-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/C3x2PYlUu28" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to part 3 of the unity
5 Survival Series now this is going to
be looking into adding a stamina bar or
a stamina bit to track you know what you
might lose through your game so in the
last episode that we look to adding
health first and hunger now we're going
to look into add another bar which will
be stamina
we first need to do is look in the side
our panel and our panel is what we held
all our sort of UI elements into and you
need to make sure that it's in a 2d view
and you're in your scene view and then
you can see all nicely what I'll do is I
will duplicate the hunger UI and then
what I'll do is I will get the mood note
tool and just slide this across like so
and why I could potentially do is grab
the panel use the scale tool in the top
right and I could just scale the whole
thing out like so then what I could
potentially do is just grab all our UI
elements grab the normal move tool and
just pull it all inside here like so
in the hunger UI that I just duplicated
we can call this stamina UI and if I
open this out you can see that will be
called hunger slider and hunger text
what we can do is I will copy stamina
from here and just paste it in and call
this stamina slider and stamina text
what we can do is click on the text and
just rename the text to stamina on that
side what we can do is we can go on to
the slider go on to the fill area open
out the fill area go to the fill and we
can possibly just change the color to
maybe a yellow so we can tell that it's
stamina and I think that will probably
do then we can close everything up and
that will be all fine and ready to roll
one thing that we will need to check is
if we click on the game view we want to
check that it all works and if we press
play
you want to make sure that it all fits
nicely in the bottom corner you could
potentially maximise on play just to
test it again just to see if it all sits
in the bottom corner and that sits
nicely now what we can do is we can go
back into the scene view and we can
start doing something with our stamina
bar in particular so what I can do is
I'm going to open up player vitals and
this is what we started doing to control
the thirst hunger and the health and
what we're going to do from here is
we're going to add the few bits that
we're going to worry about the movement
so you want to have a first-person
controller if you didn't already but I'm
sure you already do if you're following
along with this series now what we're
going to need to do with the FPS
controller because it already does stuff
with it some controller and it's actual
FPS controller as well so what I want to
do is add the first open up the
first-person control and you can see it
will be any standard assets pack what
you could essentially do is make a
duplicate of this script because when we
edit it some things you might need to
change and you might want to go back to
the original thing so if you need to you
can make a duplicate of this script and
just you know star it away if you need
to but we're going to do is I'm going to
open map as well and then we're going to
get that all in here with all the script
that runs with that controller so what
I'll do is I'll close everything up and
everything's open now I'm ready to run
so what we really need to do is start by
adding the new element to the and
variables that we're going to lock out
so at the very top of our of our and
script when we're going to use somewhere
some references that we need to to
reference or controllers and systems
which is in your sort of more modern
versions of unity 5 we want to be using
unity standard assets dot characters dot
first-person with a semicolon because
we're going to access the first-person
sort of components within unity 5 when
we need
it's line at the top to be able to do a
shorthand for accessing it so just like
we did here with the sliders and the
elements that we wanted to create what I
want to do is add some for stamina so
I'm going to do is I'm going to have a
public slider and have this cold stamina
slider with a semicolon and then we're
going to have public integer Max stamina
with the semicolon then I'm going to
have a private integer which is stamina
fall rate with a semicolon then I'm
going to have a public variable called
stamina fall molt for the stamina for
multiplayer but that one needs to be an
integer as well you could make these a
float if you want to be more accurate
but I'll go through it as we move on I
want another private integer called
stamina regain write with a semicolon
and then a public integer stamina regain
molt for multiplayer because we're going
to just times these values by whatever
we solve feel that we need then within
our start function we'll want to sort of
set some variables for some of the
values that we've already written
because we're just going to cut looking
at the stamina slider we're going to set
max stamina we're going to set the fall
rate the the multiplier which how fast
it falls the rate at which it falls but
then we give it a multiplayer so we can
you know can make it faster or slower
depending so what we want to be able to
do is under here we just want to say
that stamina slider just like we did
above dot max value equals max stamina
with a semicolon and stamina slide dot
value is equal to max stamina with a
semicolon
and that's all that and they'll set the
actual slider itself which is on the
other component to just the maximum that
amount that we're going to set within
the script so what we do see is that I
made these two here and private because
I made Mac I made fold rate in the
previous ones public so we could edit
them in the script but I don't think we
need that as much for this because
stamina Falls much more quickly so we
can do in the start function is we can
say that stamina fall red can be just
equal to one and stamina and regain rate
can be equal to one with a semicolon so
we're just setting it to 1 and then the
multipliers are the things that we're
going to be able to solve access so now
what we've got that basic stuff done we
need to be able to access the things
inside this script and be able to access
the actual character controller so we
can tell them whether we're actually
moving on so what we want to be able to
do is add two new variables two new
private variables and they're going to
be called one's going to be colored
character control and it's going to be
as a name car controller with a
lowercase C and another private variable
called first-person controller and have
that as player control semicolon and
what this is allows us to do when we've
written the sort of declaration at the
top it allows access this first-person
controller really easily because you can
see when I hover over it it's using
class unity standard assets characters
first person and first versa controller
and this lets us reference and be able
to use that script because it's slightly
different in unity 5 so what we can do
here is we can actually find the
components that we need so we need to
say that character or car controller is
equal to get component angled brackets 2
brackets in a semicolon then in the
amber or bracket
we're going to say we're looking for the
character controller and we only we're
only using a getcomponent because this
script actually lives on the actual
first person controller which already
has these components on which makes it
easier for us now I also want player
control have that equal to get component
2 angle brackets and two brackets in a
semicolon then within the brackets we'll
have first person control just like we'd
referenced at the top here so all we're
doing is instantly finding those as soon
as we start so we don't have to do any
solve we can just call these variables
in our script so we don't need to write
it out every single time and now we're
going to run down to a new section that
we're going to create and in underneath
this last else if statement just here
we're going to have a new section
looking call for stamina control section
just for the ease of this then what
we're going to do is we want to tell
whether we're actually moving or whether
we're sprinting and things like that so
what we're going to start off by doing
we're going to say that if car and
controller so if the character
controller dot velocity dot magnitude is
greater than zero and and input dot get
key open brackets key code dot left
shift and then close up those two
brackets and add two curly brackets
underneath I'll explain this so what
we're saying if the character controller
so we're going to unity and we look at
the first person troll you can see the
character controllers there this
controls sort of like the physics that
behaved on my character controller we
want to say that if the velocity are the
motor and the magnitude so if we're
actually moving so if were moving and
were pressing left shift and get key
just means it's whether you're pressing
it or holding it down it doesn't matter
so we usually hold it down
to sprint so if we're holding that key
down and we're moving we're probably
going to be sprinting so we want to do
something there so then we're going to
say that stamina slider don't value -
equals time Delta time divided by the
stamina fall ret timed by the stamina
fall multiplayer with a semicolon and we
can save that out so that's all we're
saying so for moving and we're holding
shift of sprinting so we're going to
want to lose stamina so we're just going
to say some the slider and will decrease
it by the values that we've set then
what I can do under here is I can say
else and have two curly brackets below
there and it just means that if we're
not doing this we're going to be doing
this other thing so for not sprinting
we'll be just be walking we want to say
that stamina slider dot value + equals
time dot Delta time + / stamina regain
ret times by the stamina regain
multiplayer and that just means will
then gain stamina and then what we can
do under here is we can start a new if
statement so we're going to need to
check something new if we're not enough
sprinting and stuff we're going to set
if the stamina slider value is ever
greater than or equal to v-max stamina
followed two curly brackets below will
say that stamina slider value is
actually equal to mic stamina because we
never want to go above that point now
here we want to do an additional check
so we'll use else--if instead of having
to write
and if statement because we're going to
want to do something similar but I'm not
quite the same we're going to set
else--if stamina slider dot value is
less than or equal to zero then if
that's the case if it's less than or
equal to zero we don't actually be able
to want to do anything we want to be
able to just kneel walk because we can't
sprint any marks we've run out of
stamina essentially we're going to say
that stamina slider dot value is equal
to zero and we actually want to be able
to do things with this other script like
we were mentioning so I'll write this
out as we'd want to do it but it'll have
some errors because it won't like it we
won't be able to access things on the
other side I'm going to say that player
controller because that's how we
referenced this script FPS controller
and this was our shorthand and we're
going to use dot and then we're going to
access things from the other script but
we can yet because it doesn't know what
to do because everything's hidden
everything's private then what we can do
is we can add a make this an M walk
speed to instead of having a public
private make it public have the run
speed M on discovering speed have that
set to public so we can access that from
another script and also I'm going to
make a copy of run speed and just paste
it in under here just like so I'm we're
going to have a public and then we're
going to have a new one called run speed
non that we're adding to our FPS
controller now in here soon as then the
now public will say play controller dot
M under Scott now we get access to those
particular variables that we need to
access so we're going to said that if
we've run out of stamina what we really
want to do with one end M on the score
so I'll start this game so then it
brings up the autocomplete so I want a
run speed then equal to player
controller dot M under Scott walk speed
saw what we're saying is that if the
stamina is a
equal to zero we want the run speed to
actually equal the walk speeds which
means that we'll just instantly go to
the walking speed so there's no sort of
confusion here we're just setting the
run value to what our walking value
which makes it easier to comprehend and
understanding and edit and it's a nice
little workaround because the FPS
controller script can get a little bit
sort of confusing now we also need to be
able to know that now we've set that
we've made it equal to the walk speed if
we then gain stamina again we'll always
be walking we need to be able to start
running again so then what we'll do is
we'll set else--if stamina slider value
is ever greater than or equal to zero so
if it's ever above zero this time
because we might have gained stamina by
just standing still or walking for a
little bit we want to do a pretty much a
similar thing also play controller dot M
underscore run speed equals player
controller dot M underscore run speed
norm with a SEMICON and what that dis
allows us to do is if the salmon is ever
above zero we just want the run speed to
be equal to our now our normal run speed
which we're going to set in a moment so
really all I've added to this script is
some variables to control the max
stamina have them to change some values
to change the fall great and the regain
right and made some references so we can
talk to and look for values in the
character controller and the first
person controller script of here in the
start function we've just got those
references we've set the fold rates to
one so we'd have to worry those in the
script I've just set the maximum values
of the actual sliders themselves so they
match this script in the stamina section
we've made sure that we're looking to
see if we're if we're moving and with
sprinting we're going to lose stamina
and if we're not doing that we're going
to beginning stamina
then if the slider is ever greater
the max stamina is always going to be
equal to the max stamina so we can go
above it and the stamina if it ever
equals zero we'll make sure that we
can't run anymore because we'll set it
to the walking speed and the slider will
never be able to go below zero because
we don't need to go into minus figures
and then if the stamina bar is ever
greater than zero so we've gained some
stamina back we'll be able to run again
so what I could do is I'll go back into
unity here I'll go on to my first
personal controller here and you can see
on this side I've got everything set up
ready to go so I need to add my open the
canvas stamina UI I want to add my
stamina slider here I want to say that
the max stamina is going to be something
like I don't know 25 the stamina for
multiplayer can be 5 the stamina
regained multiplayer can be 5 and we're
pretty much almost ready to go we'll go
back on the first bus controller and
you'll see that walk speed is 5 run
speed is 10 and normal speed or run
speed normal can also be equal to 10 so
we'll test this out so now I'll press
play and you can see in the bottom
corner that I've got my stamina and the
other bars will start moving down as
needed I can start sprinting you can see
that the bar goes down and when it does
you see I've gone back to walking speed
now if I let go and I go back to walking
I will be walking stamina again I can
sprint again and once I get there it
will slow down because I can and I'm
hold still holding shift now if I'm not
I let go I can sprint again because
we've got a little bit stumble or go
down account sprint until I've actually
got stamina available if I go out of
play mode and just go to the game tab on
tick maximizing playing if you watch on
this side you will see that run speed
will change so I'll start running around
run speed is normally at 10 and you'll
see that when it hits you can see that
runs B then hit to 5 but because we've
got a normal amount it instantly goes
back to 10 when we gain a little bit of
stamina and you could change that to say
that you have to have a
amount of stamina before you can start
sprinting again but really it's
depending on how're you want to be able
to do it you can decrease values
increase value so I could have I stamina
for multiplayer I could have that as 10
when I play it again I'll run out of
stamina much faster than I can regain or
you could then you know potentially
later in the series we do a level up so
you can increase the maximum values of
all your stats so as you level up you
know you can increase a certain stat
point and you can add those to max
values so it's really open to a lot of
different interpretation to what you
want to do so all we've done here is
literally added it to and made it
control the slider and some simple
values within the first-person control
that comes it with you and c5 and all
we've done is added a new stamina bar
and away you go
so thanks very much for watching don't
forget to Like comment and subscribe
Cheers</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>