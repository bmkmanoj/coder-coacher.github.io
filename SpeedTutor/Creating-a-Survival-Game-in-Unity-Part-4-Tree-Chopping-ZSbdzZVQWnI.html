<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating a Survival Game in Unity: Part 4 - Tree Chopping | Coder Coacher - Coaching Coders</title><meta content="Creating a Survival Game in Unity: Part 4 - Tree Chopping - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/SpeedTutor/">SpeedTutor</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating a Survival Game in Unity: Part 4 - Tree Chopping</b></h2><h5 class="post__date">2014-07-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZSbdzZVQWnI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys before I start the new tutorial
I'd just like to say thanks very much
for helping me get to six thousand
subscribers overall and couldn't have
got there without everybody so thanks
very much for the support and I hope
everybody continues to follow everything
that I do one thing that I'd like
everybody to do is if you'd be able to
give my Facebook page a like that would
be really good and help me you know get
the videos out to more people so if you
could just like the page I'll put the
link in the description thanks very much
and this is one thing for anybody who's
interested in art or Honda or digital
art I've got a very good friend whose
youtube channel is learning as I Drive
you search that I'll put a link in the
description and it does a lot of digital
art can show you how to you know do
digital pin and give you some tips it's
done a lot of good tutorials and I think
you'll really enjoy some stuff so if
you've got time give him a subscribe
thanks very much so straight onto the
tutorial today and sorry about the delay
but we'll finally do what everybody's
been nagging me about is tree chopping
so I hope this helps people do what they
want to do so first of all what I've got
in my scene is I've made a series of
prefabs that I'm going to use salma
tutorials so I've got one called a chop
on the tree and obviously all you do to
create a prefab is you can right click
create prefab down add a blunt err empty
prefab then what you could do is if you
drag a tree mesh any sort of mesh and
tea scene you can you know just drag
that on to the pre-made prefab slot so
you can drag that prefab in as many
times as you want and that's what we're
going to be able to use to cut down our
trees so initially what I've done is
I've brought in a tree mesh and then I'm
going to use to show the actual tree
cone so first of all I got on my tree
mesh is that you want to make sure that
it's got a rigidbody on it so you want
to go component physics and then
rigidbody when it's got a rigidbody
that'll mean it can fall over and
obviously because we want it to fall
over when we cut it down so you want to
make sure that use gravitating is
kinematic is ticked
we want to tick is kinematic because if
we apply this treat
slope if we're done it'll just fall over
straightaway because it's got a box
Collider on so that's my next step make
sure they add a box Collider that sort
of encapsulates the hull of the trunk so
it can stand up and when it falls over
you know a London won't fall through the
terrain and then one behavior is ears
just where we're going to add the script
because I've just deleted it so I can
show it in this tutorial you can keep
everything the same you don't really
have to change the mass I think I just
changed hid when I was testing but
that's all you need to make sure you've
got the Box Collider your rigidbody now
what I'm going to do is that I'll add
this log sort of object that I made and
make sure that that's in the pack when I
upload to the website and also I've got
a coconut they're not really they're
only basic shapes with a quick texture
on it so all these to have is the both
have box colliders on and rigid bodies
so they will when we cut the tree you'll
spawn them and they'll fall down to the
ground so then we can pick them up so
all you need to do is obviously have
prefab these up so you've got the
rigidbody and just keep is gravity on
these and then make sure that the
colliders all the way around the object
so when it hits the floor it can sit on
the terrain okay so that's pretty much
it for the actual objects that we're
going to use seen in one tree and then
your logs and your coconut whereas you
can just use blank objects for this to
test out really you don't have to have
trees or logs or coconuts so first of
all what can do is we're going to create
the tree controllers of the script
that's going to control how much health
tree has and such and such in the stands
here and the objects when we need to so
what we could do is create a new java
script and call this tree controller and
i'm going to open up in monodevelop and
actually as this happens in mum develop
now what we can do in our old in the
script that we made last time the player
control script you want to make sure
that we change can swing to a variable
rather than private variable so just
delete the private and that'll be all
good to go because we're going to
reference it in another script that
we're going to create so now what we're
going to do is in the tree controller
script all do is delete it
and functions and then we're going to
have a variable called tree health as
type integer equal to five and obviously
this is how many times are going to hit
the tree to cause damage to it till it
falls over obviously you could change
this within the inspector when you want
we're going to have variable logs as
type transform variable coconut is also
a type transform and then variable tree
let's type game object and then variable
speed as type integer equal to eight and
speed is going to be the thing that
causes the actual force for the tree to
fall over so obviously you can change
this depending on what you want it to do
then we're going to write function start
with two brackets than two curly
brackets below and say that tree is
equal to this dot game object so that
what this means is will auto fill in
instead of having to drag each tree to
the inspector we're going to just make
sure that whatever this script is on
it'll add the itself to that slot so we
don't have to do anything and then what
we're going to do is make sure that
rigid body dot is kinematic is equal to
true that's just in case you've got to
set it to true then what we're going to
do is in the update function I'm going
to save function update to brackets two
curly brackets below I'm going to say if
tree health is less than or equal to
zero
add the bracket at two curly brackets
below there and we'll say a rigid body
dot is kinematic equals false so we make
sure that we'll be able to use gravity
and fall over when the health is zero
want to make sure that we say rigidbody
dot add force so we're going to actually
be able to push it over then we're going
to say transform dot
forward dot I mean forward times by the
speed that we initially set and
obviously make sure that this transform
is a lowercase T because we refer into
knocking it over rather than changing
its actual coordinates and we're going
to actually put a line break in and then
call another function called destroy
tree two brackets and SMM semicolon then
what we'll do is we'll write another
function here which we just created
and we call it call tree I mean destroy
tree and then we'll add two curly
brackets below and then we'll write
yield wait for seconds of them brackets
maybe put in something like seven and
this is going to how long it takes for
the tree before it falls over before we
write our next line which is destroy
tree so obviously you could change that
seven seconds to ten seconds depending
on long it takes your tree to fall over
because I tried to find I tried to think
of a way but when it falls down if it
collides with the terrain then destroy
it but it already touches the terrain to
begin with it's a bit buggy and
obviously destroy trees just the tree
that we set for this game object now
we're going to actually instantiate the
objects that we're going to create once
it's destroyed
so also variable position as type vector
three equals vector three open brackets
random dot range open brackets minus 1.0
comma one point zero closet up comma put
zero add another comma say random range
again open brackets minus 1.0 comma one
point are two brackets and a semicolon
so what that's going to mean is we're
going to spawn the objects in a render
between between a random range between
positive one
and the negative one in both instances
so it's going to just spread them out a
little bit like I did for the
environment tool item drop mail the
tutorial then we're going to write
instantiate open brackets I'm going to
write logs comma 3 dot transform dot
position plus vector 3 op brackets 0
comma 0 comma 0 close that up plus
position comma quaternion dot identity
and then add a bracket and a semicolon
so what this means is we're going to
stand share logs of the trees position
so where the tree was and then we're
going to add a vector3 so not for each
for this one we're not going to change
it position but vector3 means that we'll
change it in a particular XY or z axis
and then we're going to say plus the
positioners itself and quaternion the
identity is just to translate the
position for it when we instantiate
objects and then what we're going to
actually do is i will copy this line
i'll paste it in again two times and
then what we going to do is change this
to 2 into 2 and that to 5 and 5 and that
just means that those are x y&amp;amp;z so we're
going to move that to along the X two
along the Y and then that 5 across the X
5 across the Y so they're all spawn
slightly different to each other
obviously you can change any of those
and then what we want to do is what we
can do is copy those three pests and
again and we'll just change that object
to coconut because we're going to
instantiate the coconut this time and
obviously paste that in you can then
change the positions if you want them to
change
but for this I'm just going to keep it
exactly the same for the sake of this
tutorial one thing that I did is
accidentally added an extra hour to
quaternion so you need to make sure this
just not got an hour in after the air
and before the tea so I'll quickly go
through this script so we'll reference
it the logs the coconut on the tree
we're talking about the speed that which
we're going to push it we set the tree
object to the game object the way we set
the script we'll make sure that is
kinematic is true so we don't happen to
make the tree fall over if the tree is
health ever equals zero so every time
we're going to hit it in a minute we'll
make sure that the kinematic is false so
we'll be able to knock it over well add
a force to that tree and then once we've
added the force we'll call a function
called destroy tree we'll wait seven
seconds before we actually destroy the
tree object itself and then what we'll
do is we'll spawn
logs and coconuts at the trees position
random range between positive and
negative one and in a random sort of
variant so we'll test that out once
we've done the next script so what you
can do is if on your prefab and on your
tropical tree or whatever you've set it
so if you add tree controller there
you'll notice that when I've added it it
remembers my settings before so we had
the speed to wait when you are
JavaScript for the first time it'll have
it in it's kept the tree it's added the
tree name and what you can do to the
logs in the coconut is you can add your
prefabs just in there to those two
things and obviously you can change your
tree health when you want so what we can
do now is we're going to make the rare
cast so we can detect when the actual
tree can be chopped so what we could do
is going to add another JavaScript
and call this rare caste chop and then
we'll open this up in monodevelop and
what we'll do is we'll start by writing
variable rare length as type integer
equal to 10 then we'll say private
variable tree script as type tree
control then we'll write a private
variable player annum as type player
control then we'll say function up there
open brackets and then add two curly
brackets below and then we'll say
variable hit call on rare cast hit
obviously before I start writing all
this if you know to write read cast off
for male the tutorials you can sort of
skip on this bit because I'm just going
to basically do a rare cast but then the
main bit is when we actually hit the
Collider that we want then we want
variable for word is equal to transform
dot transform Direction open brackets
vector three dot forward close that up
add a semicolon then under that will set
if physics dot rare cast open brackets
transform dot position obviously make
sure that that transform is lowercase
comma forward comma hit comma rare
length close two brackets add two curly
brackets below that then we'll set if
hit dot collider.com object dot tag is
equal to three then we'll add two curly
brackets below them and then we'll say
tree script is equal to game object
dot find open brackets hit dot collider
dot damn object dot name close that up
get component open brackets tree
controller so I like explain what I'm
doing so far so obviously we're just
doing a simple forward ray cast and then
if we've hit the collider which is going
to be our tree so in unity make sure
that your tree has it as a tag of tree
so you prefab kind of that tag doesn't
matter how many trees you have and then
we're going to do is we're referencing
the tree script so it's the tree
controller that we just created to add
to all our trees we're saying that we're
finding the game object that is the one
that we're looking at at any one time so
if we've got multiple trees we obviously
don't want to be a hitting one and they
knocks them all down we want to be only
looking at the one so it's looking at
the collider that we're hitting and the
game object name of that so and then
we're going to find the component of
tree controller so obviously I will show
you how to do multiple trees then we're
going to say player Anam is equal to
game object dot find open brackets and
then my name of the game object which
the player control script is on is FPS
arms under Skaar axe at idle obviously
you can change that something more
simple and then you say don't get
component open brackets player control
closet up add a semicolon then under
there what we can do is we can say if
input dot get button-down open brackets
in quartz fire one which is left click
close that up then we'll set and and
player annum dot can swing is equal to
true remember when I said earlier in the
tutorial that we wanted to set can swing
to a public variable so we could see it
in this script and then what we could do
is add two curly brackets below there
and say that Shri Script dark tree
health - equals one so this means that
we can't take the damage away from the
tree unless we can swing from the other
script so we can't just even though
we're not playing the animation hit a
million times were set in it so we can
only do it as the animation call sound
so we'll go back into unity so now my
prefab has my tree control and
everything on and then my tree in the
scene has it on as well because if you
change the prefab and the prefab object
will change in your scene as well so
what we can do add to the band camera
rear cast chop and then you can see that
the rail length is set to 10 now if we
go up to this tree what we can do is if
you watch on this side you will see the
health
you'll notice that I'll play my game
I'll walk up to my tree you'll notice
that hit it once hits it twice three
times four times my last time you'll
notice that the tree will fall and
obviously we wait an amount of time
seven seconds and it will spawn the
items that were actually looking for so
obviously you want to be able to make
sure that you can make as many trees as
you want so obviously maybe people can
find a better way of spawning your trees
but it's I can't really get make it to
work where you paint trees on the
terrain so you can make it quicker the
only way I can think of doing it is if
you have this tree and you take this
treat new duplicate it so you could you
get it and put it back here I'll make
sure it's a bit close to the ground and
then I change its name to tree chopper
ball one
so obviously you could hide this all in
an empty game object to stop the clutter
in every scene but as long as you name
it - one two three four five six seven
eight nine however many trees you want
to be able to be tropical the script
will always work so if I show you now
this tree even though it's all floating
a little bit if we hit it once twice
three times four times five times
may have just missed it that time but
that one falls over and our other one
doesn't
so we'll obviously spawn our objects
obviously we can move over to this tree
and do exactly the same thing but
there's different things every time you
want fast so it doesn't always follow up
100% now soon as they've got rigid
bodies in they roll away so you
obviously need to just change them and
mix it up
but obviously you can make it work with
however many trees that you actually
want to have in your sense you know 100
but as long as they named we slightly
different names it will always find them
really easy and as I always say it's not
100% bug free it's something to you know
get everybody with the basic idea you
can expand on it and change and saw all
these issues out that there might be
with it so as ever thanks very much for
watching and I hope this really helped
everybody out make the scripts that they
always wanted to make and hopefully this
helps you make one step towards um
survival game so thanks very much for
watching and don't forget to Like and
subscribe and if you've got that extra
bit of time don't forget to like my
Facebook page thanks very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>