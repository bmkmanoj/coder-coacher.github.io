<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>FPS Interaction &amp; Raycasts in Unity | Coder Coacher - Coaching Coders</title><meta content="FPS Interaction &amp; Raycasts in Unity - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/SpeedTutor/">SpeedTutor</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>FPS Interaction &amp; Raycasts in Unity</b></h2><h5 class="post__date">2018-01-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WEFb84TQ-lc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so today we're gonna look into
creasing a simple ray cast or something
well Charles to do sort of interaction
with specifically a soft first person
camera now a lot of first-person games
when you interact with something and you
want to soft pick it up and look
directly at it
it'll be often using a rare cast or it
sends out a ray in front of the camera
and it allows you to do interaction with
things because it will fire that ray if
it hits a collision then we'll be able
to just take that collision and go yeah
we can do something with that object now
so that's what we're gonna try and do so
this could be a continuation of my
c-sharp series but it's something that
is really beneficial to know and really
quite easy to get your head around
I want you've got that it can help you
leap some boundaries doing all the
interaction you quiet especially in a
first-person game so what we need to
begin with is we need a first-person
controller you can import that from the
standard assets and you can either get
that from the assets store if you don't
already have it or right-click in the
project and click import package and
characters and once you there you can
drag the prefab into the scene I've just
got an object over here which I'm gonna
use from it will create a script and
then we'll have a little UI which
changes color and be able to let us do
something in the sort of future so what
I'm going to quickly do is I'm gonna go
to game object I'm gonna go you I and
what I'm going to do is add an image it
will create I will come with as far as
and we'll get an image I'm gonna quickly
shoot to the 2d view and just press F to
focus in on the actual new image that's
just created from here what I'm going to
do is set its position to 0 and 0 so
it's gonna act as our crosshair so it's
directly in the center from here what we
can do is we could scale the width and
height down to say 5 and 5 so it's
really really small you can see that's
now that's now a cube in the middle
which is really tiny we can go to the
source image slot and just press and
find a new sort of element that we want
and we'll just use the knob element and
that'll just be a small circle in the
middle of the screen now we can rename
that
a to crosshair and that's all it is for
now and if we go back say to the game
view you can see it just there very much
in the center and that axis our
crosshair because it's 100% centralized
then it's perfectly to say where the
array would actually come from from the
camera now if we go back into our scene
view and go back to 3d we can select on
our FPS controller and focus back in on
it and start by writing the actual
raycast script that we're going to be
able to do so we'll right click in the
project panel create an will choose a
sheet c-sharp script and then we'll just
call this array cast and now what we can
do is when we've opened up in Visual
Studio or you can just get rid of the
two starting methods that which we don't
really need to use for now and we want
to start off by writing some of the
variables that we require so when we get
a right cast and we sort of trying to
look for an object that we might want to
interact with we're going to need to
maybe find the object and use that later
on require a sort of length or which we
want to send the rare cast out and also
maybe do a layer mask so then we can
only specifically find objects that we
want to interact with rather than
interacting with walls and things also
have colliders on it'll just get
confusing otherwise so what you can do
is write private and you we can have set
this as a game object with two upper
cases and then we're gonna have class
this as ray casted object with a
semicolon so this is gonna be the object
that we'll find and then we can
potentially do something with when you
decide to do some functionality within
your game so then below here what we're
gonna do is we'll write two square
brackets right serialized field and
we'll have private integer and then
we'll have this as rail length and maybe
set it equal to ten at this very moment
and I have it as a private just because
we don't need to access it anywhere else
other than this script for now so I can
leave this serialize field so I can view
in inspector if we need to change in the
future and then what we can do is we're
gonna have another square bracket sailor
ice field below and have private layer
mask as have this as layer mask interact
with a semicolon
and what this allows us to do is create
a layer mask specifically for the layer
that will space
if I saw we'll make a layer called
interact and then we'll specify that on
the objects that we want to use which
will allow us just to do the rare cast
on specific objects like I was
mentioning before so now we want to
access the sort of UI components so we
want to go to the top underneath the
using a unity engine and say using unity
engine dot u I add a semicolon there and
then below this to sterilize fields what
we'll do is we'll have another square
brackets sterilize field and have a
private image and image is part of the
UI system as you can see from the little
pop-up the displays and we need to have
this reference to the top to be able to
access it and then we'll just have this
as UI crosshair and we can save that out
for now so now we're gonna when we
choose to change the crosshair we're
gonna actually change the sort of its
colour on the image value so we'll do
that a little bit later on below these
variables that we've just created we'll
want to do this in the update method
because we want to check at any point
when we've interact if we're going to
interact with something we need to be
checking all the time to see if
something in front of us is the item
that we require so in the update in the
two curly brackets which so we can write
read cast hit with two capitals and then
have this as hit and this is just going
to be a sort of local reference to solve
the rare case that we're gonna have and
the green squiggle just means that we've
declared it but we haven't used it yet
so we'll come on to that very shortly
and then what we're gonna do is write
vector three forward and this is another
local reference and then we'll set
equals transform with a lowercase dot
transform direction which is two upper
cases then in brackets we'll say vector
three and dot forward and then at the
end of there we'll add a semicolon sort
we're specifying use we're saying that
vector three fold and our local variable
is called FWD equals Z transform
direction and it's going to be directly
forward from the camera that well the
origin point that we specified then
underneath here will say that if physics
and this is going to be a capital dontre
cast with a capital open brackets
transform with a lowercase dot position
comma
FWD for the forward direction that we
wanted and then have a comma out hit
with a comma of Ray length common layer
mask interact dot value and what we need
to do is we need to close that up with a
second bracket and then what we'll do is
we'll add two curly brackets below there
just to go sort of encapsulating so what
this is saying is that we can do a
physics or air caster from our current
position where we are we're gonna go
forward in vector three forward we're
gonna look for this see if there's a ray
cast hit with a length of ten and then
we're also gonna look for the actual a
layer that we're going to specify and
now we need to say that so as we're
sending the rain out we want to say that
if we hit a specific tag we want to then
try and do something so then what we can
say is that if and then in brackets
we'll say the hit dot collider.com per
tag in brackets in quotes and then we
can say something like object as just an
example of what we could have as a tag
and then we'll have we'll have two curly
brackets underneath there and said that
ray casted object equals hit dot
Collider dot game object with a
semicolon
so what again what we're saying is that
we'll send the brown we'll look for for
look for the tag of object if we've hit
an object with tag we're just gonna fill
this private variable which is gonna be
looking for a game object that might
live in the world and we're just gonna
fill that automatically and what this
allows us to do is if we fill this
automatically with what we've found is
it'll allow us to do interaction on many
different objects if they've got the
same tag whereas if we had coded in each
tag is going to be a different object
you might have a thousand lines doing
something which you could do in just
this one so we could have everything's
got object on have a script which we
access and then it could do something
different inside that script so it
allows us to be very flexible in what we
do then what we want to do is we're
gonna then want to potentially here is
change the crosshair we'll do that in a
moment and I'll just put the comment
there so we can see and then let's say
for instance we can in here we can say
that if input dot get key down in
brackets then we could save II in quotes
then we can say in this in these quotes
here we can say debug log I have
interacted with an object just so that
you can see this working now you I said
that we wanted to change the crosser now
what we could also do here is for
instance if we wanted to sort of pick
things up or do an interaction like that
we could then say that rare casted
object dot set active is false
after we've pressed the e button so we
could collect an object and then
instantly make it disappear because
because we've automatically filled the
variable up here with the object that we
found with the rare cast we don't need
to specify what object is it'll do it
automatically for us and we can just say
because you've already found now when we
press E we can just get rid of it
because we've technically picked it up
now what you can do here is then they're
almost the very end underneath the last
brace we've got going down here you can
see that this curly bracket here
corresponds to this curly bracket in the
if stem which is the actual break us
that we create we want to actually have
a line break here right else and then we
can add two curly brackets below that
and we can say that we might want to set
the crosshair to normal here because if
we're not looking at anything we can
just set the crosshair back to you know
not been interactable because we want to
interact with stuff and make the
crosshair change if we found something
then if not we don't need to be able to
do anything with across that we just
want to set it back to its normal value
just before the very end of this script
what we can do is we can write just
between the two final curly brackets
where we can write void crosshair active
with two brackets then two curly
brackets below and what I'll do is I
will copy these two and just paste in
again and have this as crosshair normal
just as two different examples and then
we can have we can Pierce crosshair
active up into the change crosshair slot
and reference this function by just
writing the crosshair active two
brackets and a semicolon and then we
also want to within the l
statement we want to say that we want to
set it back to normal so we can just
write crosshair normal to brackets in a
semicolon which allows us to call the
script and all we're going to do from
here is literally change the UI
crosshairs color so what we can do is we
can say URI crosshair dark color equals
and then we can say specify a solid
color like red so we can say that when
it's active it's gonna be red and then
we can also say cross UI crosshair dot
color equals color dot white with a
semicolon which then will allow it to be
set white again now because there's an
update function it's done all of the
time if it's not looking at an object it
will be always trying to set the color
to white all of the time maybe you know
third times every second if you've got
30 FPS so it'll be beneficial to just
write a little boolean statement in so
once it's done it once it doesn't have
to do it again but I'll leave that to
you if you choose to do that now what we
can do is we can save this out and go
back into unity so on your FPS
controller you want to go to your first
person character or you can main camera
that you've got and you want to earn
rare Casta to their no from here what
you can choose to do is you can look at
your layer mask and interact and you'll
say you'll get a list of your layers
that you've got currently available you
can see that you've got a UI crosshair
slot so what we can do is we can add our
crosshair UI to that slot that we can go
up to the top here and where it says
layer and we can add a new layer and
what we can do it within our layers is
we can find user layer 8 if we haven't
added in here already and we can just
type in interact so then we can go back
on to that camera and we can just choose
the layer that we're gonna look for is
interact so you can now say that the
rail length is 10 we've got interact and
we'll look we've already specified the
crosshair now if we go to an object that
we might want to interact with say like
this barrel I've got here you can see
that this barrel you're gonna need a
Collider on each of the objects that
you've got now this object has a mesh
Collider I don't really need to give it
a mesh Collider so what we can just do
is we can give it a box Collider for
instance and it'll do pretty much the
same job but be more optimized in a mesh
Collider now because we're there we've
got the
later which is required we want to be
able to give that tag that we were
specified to an object that was really
important so we can click on the + to
add a new tag and then what we can do is
we can just call this object and you
want to give that a bad name if you know
you choose to do it in a sort of
gameplay setting but now we can set our
tag to object and then we're going to
set this object's layer to interact and
do you want to change the children that
just means because this is a parent we
don't want to change the children so we
only want to affect and give the layer
of the tag to the object which has the
collider and we can say no this object
only and then I can press save and what
I can do is seen as though that the
raycast is on the camera it's going to
come directly from the middle of the
actual screen we'll press play and you
can see that you can see my white cursor
is just below where my yellow
interaction is and you can see that I
can look around and nothing's happening
when I go move towards my actual barrel
and I look at it you can see that it's
turned to red at this point and if I
press E you can see that that
disappeared just as we expected it to
and in the console you can see I have
interacted with an object and if I just
show you that again you can see that I
will look around do whatever I can look
at that object you can see that cursor
turned to red if I look away it goes
white again I come press E and I'm not
doing anything as soon as I look at this
object and it has to make sure it has a
Collider I press E and it's gone again
and you can see that we got that debug
line again so again just a quick glance
we have a private variable which has the
array casted object we do a length and
specify a variable four of them layer
that we're going to do we're gonna look
for the UI crosshair so in the update
function we're gonna just actually set a
couple of local variables just have that
rare cast hit and vector3 which is going
to be in a forward direction we're gonna
start by doing a rare cast from our
position forward with a particular
length and looking for the lair if we
hit a object-- with the tag of object
you can specify as you is required
you're going to then fill our rare
casted object with whatever we've found
so rare casted object will if
make that a serialized field you will
see the very casted object in the
inspector would fill with whatever the
name of our object is that there was
barrel not fall it would do that and
then we set the cross hat or crosshair
to active because we can see an object
in front of us then only when that's
happened can we then press E and we'll
debug a line well she'll say I've
interacted with an object and set the
object to false so it looks like it
disappears so you may have picked it up
you can do anything else in here that
you require you could say rare casted
objects and you could get a component on
that object like a script which exists
on it and do some functionality there
and then in our else statement if we're
not finding an object with a rare cast
if we haven't found something we're just
going to be a normal crosshair so we're
not going to be doing anything so then
we have the two methods which for active
and normal which in you from red to
white and like I said so it doesn't if
you put a debug line in say this one
here it would be running it all of the
time if you add a little boolean to
check whether you've already set it to
white and you not find anything then you
know you'd save yourself some sort of a
little bit of a based optimization there
but this is just a very simple way to
create yourself a basic rare cast and
help you just start interacting with
objects so I hope this helps you out and
give you an insight into doing the rare
cast so thanks very much for watching
don't forget to Like and subscribe
Cheers</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>