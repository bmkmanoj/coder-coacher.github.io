<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Insert message from comment system into database - PHP tutorial | Coder Coacher - Coaching Coders</title><meta content="Insert message from comment system into database - PHP tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/mmtuts/">mmtuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Insert message from comment system into database - PHP tutorial</b></h2><h5 class="post__date">2016-01-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1LmPeHX7RRo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today we're going to continue working on
the common sex in which we started
building in the previous episode and for
this episode specifically we're going to
work on the PHP code which will actually
insert whatever comment we write and
submit inside the form down here inside
our database so we're just going to go
ahead and insert stuff into database in
this episode and for the next episode we
will actually focus on getting the data
from the database or getting the actual
comments and showing them on the website
now before we start any kind of PHP code
I want to show you guys a couple of
changes I made to the HTML and CSS code
from the previous episode now I did
actually went ahead and switched up my
HTML 5 video for a iframe video which is
just simply linked to on my youtube
channel you guys can go into YouTube and
find any kind of YouTube video and to
simply create an iframe by embedding it
and I also went to my stylesheet and
gave my iframe a width as 853 pixels and
a height as 480 pixels which is a very
basic 480 pixel format now I also went
ahead and gave it a dark border so we
can actually see the video because my
videos on my channel tend to be pretty
white so now we can actually see it I
also went ahead and gave the text area a
new width so it have the same width as
my iframe and yes I know that it doesn't
have 853 pixels width but if I were to
say 853 it would actually be longer than
I frame so 850 would actually be just as
long so now that we have that cleared
out we can ask it started on the PHP
code so what we need to do first is we
need to create a new document and the
way I'm doing it here is that once we do
actually go inside our form and we need
to set a method and an action we're not
going to point to a document that's
going to run the PHP code and then
insert stuff to the database instead
we're going to learn how to create
functions and run functions instead of
entire documents when we do actually hit
any kind of submit button which is very
cool to learn so why not do it so inside
our form tag
I'm just really quickly going to set a
method and I'm going to set this one to
a
Methos you guys should already know the
difference between a post and a get
method by now but just to kind of
refresh it for you guys a post method we
can actually see the data inside the URL
because all this information we have
down here like the UID the date and the
message or writing they need to be
passed on to our function which is going
to insert it into the database and we're
going to use a post method to pass it on
to this function which means we can't
see the data inside the URL a get method
you can after we set the method I'm
going to set an action now action is not
going to be set to a document like I
said so we're just going to leave this
empty for now and go on to our empty
document we created a few seconds ago
I'm going to save this one enzyme a root
folder as comments dot Inc dot PHP and
inside of here we're going to have all
the functions that has something to do
with comments inside this website so I'm
going to open up on PHP tags I'm not
going to close to PHP tags because we're
just going to PHP code in here so
there's no reason to close the PHP tags
now I'm going to go and create a
function and I'm actually going to go
and give this function and name so we
can actually reference to it now the
name we're going to give this one is set
comment and this is not something we
have to call it I just like calling it
like this because usually when you want
to insert data into the database you
call it set if you want to get data from
the database you would call it get
comment instead it's actually going to
call it set comments with an S so now
that we have the function created we can
act go and copy the name with the
parentheses need to remember it and go
back to our front page and inside our
action we're going to go ahead and write
double quotes because we need to open up
for the PHP code again punctuation I'm
going to insert the function name that
we have from the function page now at
the moment our front page does not know
what comments that interfere
he is so we're this so we need to
actually link to it at the very top here
so I'm going to say include single
quotes comments dot Inc dot PHP
semicolon so now we can actually
reference to the function and it can
actually find it so if we do actually go
to our front page refresh you guys can
see we get no error messages now here's
one problem though at the moment if I
were to actually have stuff inside my
function in here let's say I have an
echo I'm just going to go echo hi there
like so and if I go and refresh my
website you guys can see we get hi there
which is because right now because we're
referencing to a function rather than an
entire document like we did in the
previous episodes it's always going to
just run the function even though we
didn't hit the submit button yet so we
need to actually tell it that unless we
hit the submit button it shouldn't run
this function okay so one little tip for
you guys right now we did actually give
it a name as submit I would actually go
ahead and call it comment submit with a
big s because right now it is going to
reference directly to a you know any
kind of button that has a name as
comment submit because if we did
actually have more than one form with
that where there was a button that was
called submit it would actually go ahead
and run the code if I were to hit any of
those buttons so if I have many
functions in here that runs when I hit
the button submit it's going to run all
the function so we need to make a very
specific name for this form that we have
inside the front page so if I save this
one just to kind of copy it go back to
my comments that Inc the PHP and as the
very first thing inside my function I'm
going to write if an if statement and
inside the parentheses I'm going to say
is set parenthesis so now that we have
this function called is set inside our
if statement we can now say that unless
we have a very specific variable that
exists somewhere it shouldn't run all
this code down here
so just to kind of give you guys an idea
let's go back to the front page and as
you guys can see right now we have a
forum here and we gave it a very unique
name inside the button so unless we hit
this button called common submits it
should not run the code and we do that
by going back inside our function and
inside the is set function we're going
to say variable on the scope post
because we did actually set a post
method brackets single quotes and now we
can actually go and tell it that we have
something called what was it called
comment submit so if this is not set
then don't even bother running the code
okay so now can actually go and delete
this echo and insert it in here instead
and now if i refresh the website you
guys will notice it disappears because
now we did not click the button if I
were to click the button we get hi there
so that's that's basically how this
works so what we can do now is we can
actually go ahead and write the code
which will actually insert the data from
the form into the database but before we
can do that we need to actually have a
connection to our database now the way
we're going to do that is we're actually
going to go ahead and open up a new
document and inside this document we're
going to create a connection so I'm
going to go ahead and say I'm going to
open up my PHP tags and the very first
thing in here is going to be a new
variable called con which is short for
connect let's just go ahead and save
this really quickly as db8 dot Inc dot
PHP inside the root folder of course now
after the variable called connects we're
going to say equal to sorry not
quotation marks we're going to write my
SQL i underscore connect parenthesis so
now we created a function called MySQL i
underscore connect which basically says
that we need to run a connection to some
kind of database and the parameters are
these the information on which database
we need to connect to is going to be
inside the parentheses
so inside here we need to set single
quotes and the first parameter is going
to be which server we want to connect to
now right now we do actually use a local
host server so we're just going to go
ahead and write localhost now the next
parameter in here is going to be the
username that we have for the database
in our case since we're using xampp is
going to be root for both Windows and
Mac users now the next one here is going
to be a bit different because depending
on your Mac or PC this might change now
I'm not entirely sure if it's because
map changes the password or if it's
because it's on a Mac but I don't think
that Mac users need to do this
differently I'm not entirely sure but if
this does not work and you can't get a
connection going you need to make sure
you're right root inside of this now in
our case because I do believe we're
using xampp we don't have to do this
comma space and now we need to tell it
what the name is of the database now we
did actually go ahead and call our so at
least in my case I called mine comments
section if I remember correctly and I'm
going to go and save this so now we do
actually have a database connection
going now we could also write an error
message and why not just do that really
quickly so we're gonna write an if
statement down here this basically says
ok if this up here does not run like if
this does not work by writing inside the
parentheses exclamation mark variable
come then do this down here so if we do
get an error message and this does not
work then go ahead and write an error
message and our error message could
actually be to create a die function
which tells it to kill the connection
and we're going to go ahead and write a
connection failed colon space and
afterwards we could actually let it tell
us what kind of error message were
getting by including a piece of PHP
function here so we can actually write
my sqli on the score connects underscore
error which is a function so now it's
basically going to tell us an error
message if we don't get a proper
connection going so if you guys get an
error message go ahead and write root in
here that was the basic idea
ahead with this password up here so now
that should be a connection so now we
just need to go ahead and go to our
front page or inside the header
depending on what you did and we're
going to go ahead and include it on top
of our include comments that link the
PHP function we're just going to go to
copy-paste this and we're going to set
the database connection up here now in
some cases you might want to have the
database connection as the very tough
thing when you do actually include
documents because some of these
documents might want to include the
database connection as well like they
might need to have a connection going so
we need to have the database connection
linked to first so now that we have this
we can actually go back to our comments
that link to PHP and create the
connection so the first thing we're
going to do inside our if statement here
is we're going to go and say variable on
the score post because we do actually
need to get all the different data that
we have from the form that we have
inside the front page and we need to
make sure we actually get it before we
can actually use it for something and
insert it into the database so we use
the post method and the first one we had
was called UID as a name the second one
we had was called date and the third one
was called message so these are the
three ones that we need to actually get
from the URL so in here we're going to
write a variable underscore post
brackets single quotes and the first one
was UID semicolon at the end and let's
just go ahead and give this one a name
so we can say variable UID is equal to
this
from the URL we're going to copy this
paste it underneath a treat two times
and we're going to change the names for
them so the second one is going to be
date as well as the name inside the post
method we're going to change the third
one to message again as well as our post
method and there we go now we have all
the data from the form actually inserted
inside the function so we can use
so now we have this let's actually go
and create our SQL sentence which is
going to insert this into the database
or at least tell the database what to do
with this data so I'm going to write a
we're going to go ahead and write
variable SQL equal to double quotes and
semicolon so now we just need to create
a very basic insert statement using SQL
so I'm going to say insert into and we
called it comments I do believe inside
the database let's actually go ahead and
double check
E yes it's called comments parentheses
values parenthesis so now the first one
is going to tell it okay what are the
column names that we want to insert this
into and the second parenthesis are
going to be the actual value we're going
to insert into those columns so inside
the first parenthesis we're going to go
ahead and write UID comma date comma
message so now we have all the three
different columns at least the names of
them now don't mind up mine actually
turned blue down here it's just because
data is also a function so it turns blue
just go ahead and ignore that it should
be seen as yellow inside the second
parenthesis we're going to start
inserting this data that we collected
from the form which we have up here and
the first one is going to be at least
inside the values is going to be single
quotes variable UID comma the second one
is going to be single quotes as well
variable date comma and again single
quotes variable message and there we
have it now just to make this look nice
you could always take the values move
down to the next line so we have some
kind of great overview over it you could
do that now for the next line we're
going to actually insert this data or
query it into the database now the way
we're going to do that is that we're
going to create a variable called
results because now we actually want to
result from this SQL string that we had
on top of here we're going to set it
equal to
to variable con which is the connection
we had inside the database file here so
now we're actually telling it ok create
a connection to the database and with
this connection I want you to query this
SQL string up here so we're going to
point to a method called query
parentheses semi-colon and inside the
parentheses we need to insert the name
or insert the value we want to actually
query to the database which is going to
be dollar sign SQL or the variable we
created it called SQL so that's
basically it now we have this we can
actually go ahead and try to run this so
I mags are going to go ahead and go into
my front page refresh and this actually
just go ahead and there we go oh we do
actually get an error message we did not
link something correctly we did not link
to the database correctly apparently on
line three so let's just go ahead and
double check what we did wrong here
deviate ah okay it's not DBA is tbh
which some of you guys might have caught
that error so now let's actually go
ahead and refresh again and there we
have it no error messages so now if I
were to actually write something down
here like hi there inflammation mark
this is a test message exclamation mark
if I write comments ah we get an
undefined variable ah of course
yeah so we don't actually have a
connection to the database which is
because right now we did actually set
the connection inside the function down
here so what we need to do is we do
actually need to go inside our comments
that Inc the PHP and this variable down
here called con which we do actually
have inside our connection here we need
to reference to it by inserting it
inside the parenthesis of our function
name so up here what we have set
comments parentheses we need to tell it
ok we're referencing to a variable from
outside this function so we need to
include the variable cont
inside the parenthesis here as well as
inside what we do actually use the
function inside our website which is
down here where we have the form
so I'm going to insert our variable con
in this in there as well and now that
we've done that let's actually go back
to our front page refresh right hi there
just hi there and as you guys can see
when I do actually hit comments we don't
get any kind of error messages so now
for where to go back to my database
refresh you guys can see that now we do
actually have a comment with the ideas
one name access to win for you guys with
a username as anonymous the date is set
to whatever data it is right now and the
message is hi there so now we did
actually insert something inside the
database which actually works now you
could as well include some kind of
message that you know inside the website
itself lets us know if we did actually
submitted correctly or if there was an
error message or something so we do
actually know that the comment was
actually posted for this episode this is
all I wanted to do so all that with
error handling and all that extra stuff
we're going to go and do that at the end
I've one of the later episodes so from
now this is all we need to do for this
episode so hope you guys enjoyed and
I'll see you guys next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>