<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Add login system to comment system in PHP - PHP tutorial | Coder Coacher - Coaching Coders</title><meta content="Add login system to comment system in PHP - PHP tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/mmtuts/">mmtuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Add login system to comment system in PHP - PHP tutorial</b></h2><h5 class="post__date">2016-06-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/a3Wxi-ZvUng" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today we're going to talk about how to
create a user based comment section
inside this website here which means
that you have to be logged in before you
can write a comment to the video it also
means that if you did actually create a
comment after you're logged in you
should only be able to edit or delete
the post that you actually wrote as that
user now in the future we'll actually
talk about how to reply to comments that
you didn't actually write yourself as
that user actually logged in us but
we're not going to do that in this
episode in this episode we're just going
to focus on actually creating the
locking system that we need before we
can actually start doing these more
complicated things inside our comments
section now I did actually create a
episode a while back showing in detail
how to create a login system and because
of that we're not going to go into too
many details when we create the login
system in this episode so if you at one
point think it's going too fast and
you're not learning how to create a
login system then I highly recommend you
guys go back and watch the previous
episode where I do it in more detail so
right now the first thing we're going to
do is that we're going to go ahead and
create the actual form at the very top
of the page here that allows for us to
actually type in our username and
password and then login so we're going
to open up our code and we're going to
go right underneath the body opening tag
right here and we're going to go ahead
and create a form now inside this form
we're going to include two inputs so I'm
just going to go and write the first one
here I'm going to set the type as text
which is going to be the user name by
the way
and the name we're going to set us UID
for user ID I'm going to go to and copy
this input like so paste it underneath
it and down here we're going to change
the text as type to password because
that allows for us to actually write
something inside this input without
actually being able to read what we're
writing the name we're going to change
to PWD which is short for password
below the second input we're going to go
and create a button and inside the
button tag we're going to go to set a
type we're just going to be equal to
submits and we're going to set a name as
let's set it to login submits with a big
s now one thing I want to point out is
that later in this episode we're
actually going to change this form into
a string within PHP code which means
that the double quotes are just used I'm
going to have to be changed to single
quotes instead so let's actually go and
do that straightaway just going to
highlight all of my double quotes like
so like so like so and I'm going to
change them to signal quotes like so now
inside the form tag at the very
beginning here we need to create a
method and an action just like we did
down here with the comment section so
I'm actually going to go ahead and just
copy what we have down here and paste it
in now the method is still going to be
set to post because it's secret what
we're typing in here we don't want
people to actually read this in the URL
so it has to be post and that gets now
as you guys can see we're actually
linking to a function inside our action
and because this is not PHP code yet
it's kind of it doesn't look like PHP
like it does down here with the colors
so let's actually go ahead and just open
up the PHP code and echo this so I'm
going to create my opening tags like so
and I'm going to create my closing tags
on the neath here inside the PHP tags
right before the actual form I'm going
to write echo double quote and then
after the form I'm going to write double
quote semicolon I'm just going to go and
move it out so it looks nicer and there
we have it now we do actually need to
change the comment or the function name
which right now is set to set comments
and we need to change it to something
that makes more sense when we're
creating a login system so I would
actually go ahead and write gets login
for example like so and we need to make
sure we keep the variable
inside the parentheses because we do
need to connect to the database now we
basically have our form and I would like
to create some distance between the
login form and the iframe we have down
here so I'm going to go ahead and
include some breaks afterwards just to
should be plenty now the thing about
creating a login system is that you need
to have something running which is
called a session a session is basically
a hidden space that you can't see in the
website where you can store variables
that has like different values and in
order to do that need to actually have a
session started inside our website or at
least inside this page here so at the
very top of our index file I'm going to
go ahead and go underneath my include
tags and I'm going to go ahead and write
session underscore start parenthesis and
semicolon which basically means that
starting from here and down we're going
to start a session now after we save it
we're going to go ahead and create one
more form because we also need a lockout
button so I'm just going to go and copy
my echo down here which has the form
inside of it and I'm going to go ahead
and change my my function name to let's
call it user lockout and we don't
actually need to have the variable come
inside the parenthesis because we're not
connecting to a database and we need to
log out which is simply destroying the
session that we have started inside this
page and resetting it so that's all we
need to do now we also don't need the
inputs but we do need the button now the
button we need to change the name off as
well so right now it shouldn't be called
login submit' we're going to go ahead
and call it
lock out submit there we go so now we
have our basic forms and if you go ahead
and refresh the website is probably
going to give us an error because we
didn't actually create the get login and
user logout functions so we're going to
go and do that right now inside my
comments that inked-up PHP file which
you created in the previous episodes
I'm going to go ahead and go down to the
very bottom actually now I'm going to go
ahead and copy my get comments function
first and paste it at the very bottom
now inside this function we need to
change the function name to get login
and we need to make sure we keep the
variable cotton inside the parentheses
otherwise we won't actually get the
variable con from our index page which
we have right here inside the actual
function we're going to go ahead and
create a couple lines above the SQL
command here and we're going to go ahead
and delete our content inside our wild
statements now we're going to also go
ahead and change the while to an if
statement because we don't actually need
that and from here on out we just need
to change the SQL string and insert the
actual post methods where we get the
information from the previous page which
was the index of PHP file so inside our
index index the PHP file we did actually
create a form we typed user name and
password and once we reference to this
function here we need to make sure we
actually you know grab those data so we
can actually use them inside our
function so the very first thing we're
going to do inside the function is we're
going to go ahead and write a variable
called UID I'm going to set it equal to
a post method by writing dollar sign
underscore post brackets semicolon and
inside the brackets we're going to write
single quotes and then the name of our
inputs which was UID I'm going to go and
copy this line paste it underneath it
and I'm going to change the names to PWD
both the variable name and the actual
post name so now that we have these we
can actually go ahead and start changing
our select statement down here because
we don't want to select from our typical
comments you want to select from a table
color users which we didn't actually
create yet we have to do that as well so
right now we're going to select all from
user where the you ID and the password
matches both of these data so we're
going to say UID which is going to be a
row or sorry not a robot a column inside
our user table and it has to be equal to
our dollar sign
UID variable up here now because both of
these has to be true
we're also going to go ahead and include
and after UID here and say PWD has to be
equal to the variable up here called PWD
so now this is basically all we need
inside the Select statement now we do
need to change these variables down here
as well or these data down here because
right now we do actually need to check
if we actually have a result from the
database before we start pulling out the
results so what we need to change here
is basically the first thing we need to
do after we have run our you know SQL
sentence inside the database via this
line of code here we need to go ahead
and ask if we do actually have a result
before we do this if statement so right
above our result code here we're going
to write another if statement and the
condition inside the if statement is
going to be a function called my SQL i
underscore num underscore rose
parentheses and basically what this does
is that it says okay whatever's inside
the parentheses we're going to count the
number of rows that you get as a result
so I'm going to go ahead and grab my
result variable put it inside the
parentheses and now to give me either a
0 or 1 because either my username
password was wrong and I'm going to get
a 0 or it's going to be true and I'm
going to get a 1 because we get one row
where both of these are true
so I'm going to go ahead and set this
one equal to 1 or we could actually go
ahead and say greater than 0 either way
works now after we have this when you
take the if statement we had before we
started making the new if statement copy
it delete it and move it inside this if
statement just created because now we
said okay if we do actually have a
result then we want to start taking out
data and putting it inside our variable
called row so now that we have this we
can actually go ahead and start creating
our session variable which we're going
to store inside our session that we
started inside our front page at the
very top here now the way we do that is
by saying dollar sign underscore session
brackets single quotes and then we need
to name this session variable now a good
rule of thumb at these for our database
table is that we're going to go ahead
and create a primary key which I'm going
to set us ID and then I'm going to go
ahead and give it the information that
we need to have on the user now in our
case we're just going to have to use ID
which is the username and the password
which means that I need to store some
kind of information inside the session
variable which is unique to that user
specifically now you might be thinking
well the username is going to be unique
you know only one person is going to be
able to have the username at least when
we set up the error handlers well true
but if something goes wrong with the
error handler and a user by mistake gets
the same username as another user then
you're going to have a problem so we
need to make sure to use something
that's very unique which in this case is
going to be the ID so I'm going to
choose the ID and if you don't know what
I mean by ID we're going to get to it
when we actually start creating our
table inside the actual database so if
you can't follow along right now just go
ahead and wait a few minutes to when we
get there now we're going to go ahead
and create this session variable and set
it equal to some kind of data which in
this case like I said we're going to
reference to the ID inside our database
that we haven't created yet which means
that we are going to call on dolls on
row that we created here and insert our
data into so I'm going to go and create
the brackets single quotes and I'm going
to reference to the call
inside the database called ID so now
this should be working basically but we
don't have any error handle this yet
which means that right now if I did
actually type the wrong user name and
password
nothing would actually happen so I'm
going to go ahead and create an else
statement after the first if statement
created down here which basically says
that we would like to go you know do
something if this goes wrong now let's
actually go back up to the success if
statement here and underneath it we're
going to go and create the header which
links us back to the front page after we
log in so we're going to write double
quotes location with a big L call one
index dot PHP now we're going to go
ahead and include some extra code after
the index dot PHP here which is going to
be question mark login success now what
this does is basically sending us back
to the front page and including just a
little bit more text behind our URL that
just tells us the status of what just
happened so if this actually succeeds
then we're going to have a login success
message inside our website URL so one
more thing we're going to include after
this header here is another piece of
code in PHP called exit and we didn't
actually talk about exit yet at least on
this build series here on how to create
our comment section but basically if I
were to go down in my I can actually
show you guys maybe we can't actually
show that and to actually need to create
a function called the name of our logout
function so let's just go ahead and make
a copy here go back to the front page go
down to our logout button down here our
logout form'
and create a function called user lock
out just so we have it so we can
actually see what's inside the website
delete the W or the dollar sign con and
go back to the website so now you guys
can see we do actually get the website
running here there's
errormsgs because we didn't actually you
know do the right thing yet but if I
were to go down to my comment section
just to demonstrate what I mean by the
exit functionality inside PHP if I were
to write a comment here click comments I
would actually have to comment down the
bottom here but if I go up to my to my
browser and refresh the website oh it
says confirm form resubmission oh if I
click continue then we suddenly have the
same comment again down at the bottom
here which is because we didn't actually
close the script inside our PHP code we
basically told it that okay you know
after we get to through all these
different statements and if you do
actually succeed till the end here then
don't close the script yet so what we're
going to do is we're going to write exit
parentheses semicolon so now it will
actually close the script which means
it's not going to allow for you to
resubmit the form if you refresh the
page okay that's quite a nice function
to have inside PHP now that we have this
let's actually go and copy the header
and the exit tag paste it inside our
else statement and change the question
mark login success to question mark lock
in failed and there we have it that's
only what we do actually need one more
thing because we're using functions like
this we need to have an if statement
that says ok if we did actually click
the button then you should run the code
and that's actually why we're getting
all these error messages at the top
because we didn't actually click the
button yet and they're still counting
all these things so we need to go ahead
and just take one of these functions we
already created copy the if statement
that checks if the button has been set
which is why we actually game out it
gave our button a name because we need
to do this then we need to do the code
so right after we open up the function
I'm going to paste in the if statement
and instead of taking for comment
submits I'm going to take for lock in
submit and then we need to make sure we
move everything else up just one more
and we close off our first if statements
if you just paste it in there we go go
back to the website refresh well would
you actually need to completely refresh
the site and as you guys can see we now
have dis going on now the button to
actually look like that I don't know why
it'll look like that something with the
styling let's actually go ahead and just
check it out no yeah
now the reason is actually giving us
black buttons is because we don't
actually have any text inside the
buttons so the first one which is the
lock in button we're just going to write
lock in in the lock out button
we're just going to write lock out there
we go go back to the website refresh and
as you guys can see we now have lock in
lock out so we didn't actually create
the lock out function yet let's actually
do that before we start creating the
database so what we're going to do now
is we're going to go inside our logout
function and we're going to go ahead and
start out by writing another if
statement because we do actually need to
check if it did actually click the
logout button so we're going to copy
this again open and closing brackets
curly brackets and inside here well we
do need to remember to change the name
as well forgot about that to lock out
submit now we go inside the if
statements and in here we need to first
of all start this session just in case
we need to so going to write session
start and then we started this session
it then allows for us to access the
session variables I think in this case
it wouldn't really matter if we had this
or not because we're using the functions
and the way we are so because we have
the session start up here in index page
and we have the function down in the
same page a thing would actually go in
and actually see this session start but
just to have it we're just going to make
sure we have it down here if we do have
one too many it's going to give us an
error message very likely so we're just
going to keep it here and see if it does
actually give us an error which I don't
think it's going to do after we have the
session start we need to actually
destroy the session because we need to
destroy all the session variables
which allows for us to actually lock out
as a user so we're going to say session
underscore destroy like so parentheses
and then we need to create another
header and an exit tag like so we need
to make sure we go back and we're just
going to go and delete our question mark
login failed text there we have it now
the last thing we need to do is
basically go into our database which we
have inside out our PHP myadmin and
create the table and insert two users
now we won't actually be creating a
signup form inside the website we're not
going to do that if you're interested in
learning how to do that then I have like
I said a tutorial a couple of lessons
back that show us how to create a fully
functional login system with a signup
form so what we're going to do now is
we're going to go into our the correct
database which is comments-section
go into the SQL tag up here in the top
I'm just consuming for you guys and then
we're going to go and create our user
table so I'm going to say create space
table and then we want to call it user
parentheses semicolon just go down a
couple lines inside the parentheses and
then the first row or the first column
we're going to create is the ID which is
the unique number we're actually putting
inside our system variable so I'm going
to say ID space int parenthesis we're
going to set the ins 11 characters space
and then we're going to go ahead and say
not null space or to underscore
increments let me just zoom in a bit
more for you guys there we go and then
we're going to set it as a primary key
comma next line we're going to create
the user name column so we're going to
write UID space watch our parentheses
128 characters just to make sure space
not null comma next line
we're just going to go to and copy this
line because the next one is going to be
basically the same except we're going to
remove the last comma remember not to
have a comma at the end of the last
sentence inside your table code so we're
going to change the name here from UID
to PWD whoops now that we have this
let's actually go and copy what we wrote
and insert it into our document that we
created in a couple lessons ago called
SQL SQL just so we have the Coache saved
somewhere in case something happens and
we need to re-enter this code it's nice
to just have it saved instead of having
to actually write the whole thing save
it and let's actually go back to the
database and run this code by clicking
go as you guys can see no errors now
like I said we're not going to actually
create a signup form which means that we
have to go back into the SQL code up
here and create an insert statement and
actually manually insert users inside
our user table so we're going to write
insert into user friend the C's values
parentheses semicolon inside the first
parenthesis we're going to go ahead and
write the name of the columns that we
need to insert the data into which in
this case we don't have to write ID
because it's Auto incremented it's going
to fill out itself so we're just going
to go and write UID comma space PWD then
we need to insert the values for the new
users were creating here so we're going
to go and set the first one too well
first of all we need single quotes then
we're going to call the first one admin
because why not comma single quotes
password is going to be one two three
now again we're not encrypting the
password or anything we're creating a
very basic login system just to show you
guys how to get this working with the
comments section so if you want to learn
decryption I also have an episode on
that you know encryption and decryption
so just bear with me in this episode
that we're just going to create a very
basic login system I'm going to copy
this and paste it underneath it because
if we have to test this I think it's a
good idea that we have two users if we
have to test the whole reply thing in
the future so I'm just going to go and
change the username for the
second user to Daniel because that's my
name and we're going to actually save
the code like so and click go no errors
if you go back into our user table
you'll see that we have two users we
have an ID as one and two and then it
filled out the users here now let's
actually go ahead and save the SQL code
in here like so and I think we shouldn't
have any errors now now I'm not 100%
sure because sometimes errors do happen
but if i refresh the website we get no
errors that's good so far
actually let's include one more thing
because we need to be able to see if
we're logged in or not if I go back to
the code go to the index page go
underneath our forms right before the
break inside the PHP code of course
we're going to go and write an if
statement that says if we are in fact
locked in right you are locked in if
you're not logged in then right you are
not locked in it's very simple to do we
can write if and the condition is going
to be an is set function that simply
checks if our session variable that has
the name ID exists so if it doesn't
exist it means that we didn't lock in
yet because we're creating the session
variable ID when we lock in here if
we're not locked in and we lock out
we're destroying it meaning that it
doesn't exist anymore so if it is not
set then we're locked out so I'm going
to write inside the parenthesis of the
is set function dollar sign underscore
session brackets single quotes ID inside
our if statement we're going to go ahead
and say an echo that says you are locked
in then we're gonna write in else
statements that has an echo so I'm just
going to copy paste and this will say
you are not locked in let's go back to
the website refresh and you'll see that
as you are not locked in I don't know if
you guys can tell but it's
right here now let's actually test it so
now this is Edmund I'm going to say 1 2
3 and it says you are locked in great
it's working if I log out it says you're
not locked in if I write something wrong
it gives me a path up in ul that says
lock in failed which means that it does
actually work which is great
there was no errors and that's basically
it so we just created a very basic login
system which we're going to use in the
future episodes so this episode did get
a bit long which is why we're just going
to do this in this episode but in the
next episodes we're going to talk about
how to actually check when we're locked
in in order to show the comment writing
form down here or not because we only
want it to be there if you're locked in
the same thing goes with delete and edit
buttons you should only see it if you
actually locked in so I hope you guys
enjoyed this episode I hope it wasn't
too long and I'll see you guys next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>