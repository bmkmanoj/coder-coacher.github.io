<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>53: Delete profile image using PHP - PHP tutorial | Coder Coacher - Coaching Coders</title><meta content="53: Delete profile image using PHP - PHP tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/mmtuts/">mmtuts</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>53: Delete profile image using PHP - PHP tutorial</b></h2><h5 class="post__date">2016-12-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6KFXlEiNg6M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today we're going to learn how to delete
files from our website and it's going to
be all types of files such as images or
text files you know any kind of file you
might have inside a root folder we're
going to learn how to delete these in
this episode now before we do that and
before we do any coding I want to
mention one thing now what I have in
front of me here is going to be based
off the previous two episodes we did on
how to upload files and how to upload
profile images now even though you guys
may not have followed the previous two
episodes this lesson will still teach
you how to delete files from a website
so if you have your own website in front
of you right now and you just want to
look for a quick way to delete files
we're going to do that in this episode
okay so don't need to have my specific
code in front of you now if you guys
want to have this code and you want to
follow this lesson I'm going to go to
leave a link in the description of this
video so you guys can download the files
and follow along on this lesson here so
now that we know this I'm going to go
ahead and show you guys what we created
in the previous episode just so we know
what exactly we want to do today so
inside this browser here I have a user
up in the top here with a user name and
a you know a name and a profile image
now right now I'm actually logged in as
to you so I can also log out if I want
to if I log in as this user here I'm
going to choose a file and upload a new
profile image let's say I want to be
this guy down here upload as you guys
can see it now changed the profile image
now what if I want to delete the profile
image and just have a default image up
here now as you guys can see I did
actually went ahead and create another
form down here that deletes the profile
image so if I click the delete button
here you guys can see now reverts back
to the default image we have when we do
not have a profile image and I did that
by changing the image and I went ahead
and delete the profile image that I
uploaded before you know the picture
with the guy in here because we don't
want to you know just change the profile
image back to the default one we want to
actually delete the file from a root
folder in order to actually change it so
just to show you guys if we go inside my
uploads folder where we have all the
profile images if I go ahead and you
know choose another image this guy for
example upload him if I go into my root
folder inside my uploads folder you guys
can see they have a profile image if I
go ahead and click delete
go back inside of it now I gasp can see
the profile image
is gone so we're going to learn how to
delete files from a root folder so what
we're going to do now is I'm going to go
ahead and go inside my index dot PHP
file and inside the index dot PHP file
I'm going to go down to where we have
our upload form because underneath the
upload form we're going to create a
delete form so I'm going to go ahead and
copy my echo down here that says you
know form Exynos to upload the PHP file
I'm going to go ahead and paste it right
underneath it now what we're going to do
here is I'm going to go ahead and delete
the input we have inside of it because
we don't need an input we just need to
you know just load a file in order to
delete this profile image so inside the
action here I'm going to change the name
to delete profile or something else I'm
going to go ahead and delete the ink
table as well because we don't need that
in here and I'm going to go ahead and
change the text inside my button down
here to delete profile image like so
inside the text editor we're going to go
ahead and create a new file and this
file is going to be the one that deletes
the profile image from our root folder
so if you guys want to learn how to
delete files this is where we're going
to do it so inside this file we're going
to go and save it as delete profile dot
PHP and inside this file the first thing
we're going to do is we're going to go
ahead and open up the PHP tags now
inside the PHP tags we're going to go
ahead and start a session because in my
example here we have a user who's logged
in in order to see the delete profile
image button we need to be locked in so
we need to have a session that actually
runs so we can see who is locked in at
the moment we're going to say session
start parenthesis underneath here we're
going to go ahead and include our
database file because as you guys may
know from the previous episode we
registers inside the database if the
user had a profile image uploaded or not
so we need to change this to false since
you want to delete the profile image so
we won't need to set the database as the
user has not a profile image uploaded so
we're going to say include on the school
once single quotes DBH
dot php' on the next line here we're
going to go ahead and get the session ID
from the user is currently locked in
which at the moment is the admin inside
my website so we're going to go ahead
and say dollar sign session ID is equal
to the current superglobal called
session that has a name as ID so right
now we have the session ID from the user
who is currently logged in so we know
which profile image you want to delete
now the next thing we need to do is you
want to delete the profile image or at
least the file that we want to delete
but before we can do that need to
pinpoint the right file so we can
actually select it and then delete it
now because we in the previous episode
now in this doesn't count for you guys
who did not follow the previous episodes
but if you did as you guys may remember
we did actually allow for more than one
type of file to get uploaded such as
JPEGs gape aegs p.m. d's and pdfs now
what that means is that when we want to
pinpoint the file we need to actually go
in select the file the extension here
which is right now JPEG could be PNG or
PDF it could be any kind of file so what
we need to do is we need to say we have
a file somewhere inside the uploads
folder that has this base name but we
don't know the extension yet so no to
find the file that we don't know the
extension of we're going to have to
write a bit of code and this is code
that is really useful even though we
might not have created a system we could
upload more than just a JPEG
you know like PNG s or something so we
need to do that first so what we're
going to do here is we're going to go
and create a variable called file name
I'm going to set it equal to the path
that we know the image is inside of so
right now if I go inside my root folder
you guys can see I have a folder called
uploads where I have the profile images
so we need to say ok we want to create a
path by writing a string which is inside
the uploads folder forward slash and
then we have a name called profile and
then as you guys can see if I go back
and set the root for all you guys can
see I have a 1 in front of this profile
image
and that's because the user here has an
ID as one inside the database so we need
to get the session ID of this user here
which we already created up here so just
copy it paste it right next to it on the
right side and then what we need to do
in order to actually get the extension
because right now if I were to go in and
find this specific file here it's going
to give me an error message because
right now it doesn't know you know what
is the file called profile one there's
no such thing in there because right now
it's called profile 1 dot jpg so what we
can do here is we can actually go ahead
and say well we do also have another
string and then inside the string we're
going to write star a multiplication
symbol which right now means that we
have something going on behind this
number here you know the session ID so
right now to the file we're looking for
is called profile 1 something which is
what the star does so now that we have
this we can actually go ahead and search
for the file so what I'm going to go and
do here is I'm going to go and create
another variable I'm going to call this
one file info set it equal to glop which
is a function we have inside PHP that
goes in and searches for a specific file
that has part of the name that we're
looking for so we have a file let's call
profile 1 something which we have up
here it's going to go ahead and list out
all the files that matches this search
up here which in our case because we
created in this certain way with the use
ID there's only going to be one file
that has this ok now of course right now
if I were to have 11 users inside my
database you would actually have a user
profile image in here that says profile
11 now if we search for profile 1 1 in
this case it's going to go ahead and
list out to users and the reason for
that is that profile 1 which we're
searching for up here it's going to be
inside both profile images names now we
will get around that I'm going to show
you guys in just a second how we're not
going to get an error message when we do
actually you know get the image using
glop so for now let's actually just go
and continue here I'm going to show you
guys what I
in a few seconds so inside the glob
function here we want to get the file
name because we're looking for the
specific file up here so file info right
now if I were to go down and print are
this one here parentheses file info go
inside my website refresh and then
delete my profile image you guys will
see we get an array right now the first
data inside our array is equal to this
path right here because it found the
file called profile 1 dot jpg which is
our profile image that we have so right
now we did actually get the extension
without having to type the dot jpg
inside the path now we get one problem
which is the one I mentioned before
let's say I have one use inside the
database which has a ID as 11 which I do
actually have in here I did axe create
one that has an ID as 11 and he also
uploaded a profile image now what is
going to look like if I go inside my
upload folder and just kind of copy the
image I have in here and change the name
to profile 11 which in this case is what
it would actually be like you know how
to upload a profile image as user 11 if
I go back inside my browser refresh the
website and go back again you guys can
see we get two results we get one piece
of data inside this array called this
file which is JPEG and then I get
another piece of data which is also a
search result that matches what I typed
in which is equal to uploads profile 11
because we just said we needed anything
behind the one so right now there's
something that matches this is one dot
JPEG now the thing I want to point out
here is even though we have two results
from the search the first one is always
going to be the one the de cáncer
searching for if I were to search for
uploads profile 11 we will only get one
result that would be this one over here
so this one would actually have the data
place a cero when this case we search
for profile 1 which means it's going to
get out both these results but the one
we're looking for is always going to be
the first one ok so it's really
important that you guys focus on that we
only need the first data result
so what we can do now is we can actually
go back
delete the print our function down here
because we don't actually need it and
we're going to go and create another
variable but we need to get the
extension of this file here so we're
going to save file ext is equal to
explode because now we need to actually
take this we have up here from the file
info parentheses semi-colon and then
what we need to do is we need to insert
two parameters we need to tell the where
we want to explode the string and we
need to tell a which string we want to
explode so right now we're going to
write double quotes punctuation because
you want to take it apart right before
we get the extension and then the second
parameter is going to be the file info
variable we have up here which in this
case is going to have all the search
results from this string up here so
what's really important to know here is
that based off what I told you guys a
few seconds ago
we might get more than one result when
we run this Galasso it's here so we need
to make sure we only get the first
result or writing brackets and then
inside the brackets we write 0 because
now we only get the first result from
our array that we get from the globe
search up here so after we do this let's
actually go ahead and print our what we
just did here so we say print underscore
our parentheses semi-colon and then
we're going to print our the file
extension variable we have up here just
to show guys what we're doing if i
refresh the website delete profile
limits you guys can see we get an array
you know based off the explode function
with it where we get two different
results we get the first data which is
equal to uploads profile 1 and we get
the second data right here which is
equal to jpg so now we just got the
extension from the file having the
extension now we can go ahead and go
down to the next line and say file
actual extension which is equal to the
file extension we have up here array
that has the data as the second data
which in this case would be one so right
now file actual extension is equal to
jpg ok so now we have the extension we
can actually go ahead and go in and
delete the file so
what we need to do now is we need to
write the full path to where we want to
delete the file and the file name they
want to delete because right now we just
figured out what the file extension is
so we can actually write the complete
file name of the file we want to delete
so down here we're going to say we have
a variable called file which is equal to
a path called uploads forward slash
profile and then we want to get the
session ID afterwards so it's actually
basically the same as what we have up
here we can actually just go ahead and
copy what we have up here because that
would be silly not to and instead of
saying we have something going on after
the session ID we can actually include
the extension we just got from up here
so we're going to say we have profile 1
dot the file actual extension so now
it's dot jpg so now we just got the
right file name or the right file
extension and now we wrote the entire
name of this file so now that we have
the entire file name we can actually go
ahead and start deleting the file so
we're going to write an if statement
because we want to have an error message
if we did actually manage not to delete
this certain file so we want to know if
we had some kind of errors so we're
going to say inside the if statement we
have a exclamation mark on linked
parentheses now the unlink function here
is going to be the one that goes in and
deletes the file so if it did not matter
to you know delete this specific file
here called dulles on file which we need
to insert inside the parentheses then it
needs to give us an error message but
else then it needs to delete the file
and maybe take us back to the front page
to something so what we need to do here
is we can actually go ahead and write
the error message we can say echo file
was not deleted or something then inside
the else statement we can go ahead and
make another echo if you wanted to we
can say file was deleted by the way
we're not going to see these messages
here because we're just going to get
taken directly back to the front page
but if you want to test this out and not
write a header function takes us back
it's going to say one of these two
things so we're just doing this because
we want to run this function up here
called unlink which is being run right
now even though it's inside an if
statement so now that we delete it to
file we can actually go ahead and go
down to the next line and what we need
to do now at least in our case based off
the previous two episodes is we need to
go inside the database and update our
image profile table or profile image
table which right now has a profile
image set to true because my user
uploaded profile image before that we
want to delete and because of that is
right now set to true so we need to
change it back to false because it just
deleted it so what we need to do here is
we need to write a dollar sign SQL which
is an SQL command you want to run inside
the database double quotes and then we
want to run an update profile image
which is the database table name set
status which is the column that is equal
to true or false in our case right now
is equal to true because it says we have
a profile image uploaded you want to
change that to false we're going to say
equal to one where user ID is equal to a
current session ID that we just have up
here so right now we're changing this at
the user that has a user ID as the
current session we logged in as
semicolon and then again semicolon now I
did actually get asked before about this
semicolon that I sometimes include and
sometimes leave out of my SQL string now
just to make it clear this right here is
correct and this right here is also
correct
now some databases prefer that it close
off your SQL string that we have inside
here with a semicolon so I recommended
you always do it okay so after we just
included the SQL string we wanted to run
inside the database we're going to go
ahead and actually run it so I'm going
to go ahead and write my SQL I
underscore query which means the we're
now querying this SQL string up here I'm
going to paste in dulles on SQL and
we're also going to include our database
connection which we include up here
sir inside this file in here we have a
variable called cuttin which is our
connection to the database like so so
now we just did is we updated our
database after we updated the database
we want to be taken back to the front
page so I'm going to write a header
function that says double quotes
location colon index dot PHP and then
after the PHP we're just going to go
ahead and include a just a small message
so it says delete complete or success
like so now we have this we just
successfully deleted our profile image
so what we can do now is we can actually
go and test this there's one more thing
we need to do at least if you created
the you know the profile image upload
system with me in the previous two
episodes there's one more thing we need
to do which is that we need to change
the extension that we actually show
inside the browser because right now I'm
actually showing a JPEG image but what
if we upload a PNG image when we upload
our profile limits you know we need to
change that but if you did not follow
the previous two episodes this is not
something you need to worry about so
let's actually go and test what we just
did if I go back inside my website and
refresh you guys can see once I click
the leap profile image we get the
default image because we change the you
know our user inside the profile image
table to false so right now we do not
have a profile image uploaded if I go
back inside my website choose a profile
image upload go back to the database you
guys consider the status right now of
the first row we have in here it's going
to change to 0 and again if I change it
again delete the profile image you guys
can see it says false so we just
successfully deleted a profile image and
we changed a database column now if you
guys followed the previous episode we
did and how to upload profile images
there's one more thing you need to
change in order to show these images
properly inside the browser and just one
more thing I want to point out I did
actually make a typo in the previous
episode regarding the double quotes and
single quotes down here we have the
empty random function so if you guys
didn't see that in the annotation
in the previous episode because it
disabled them I recommend you guys go
back enable annotations and check for
the you know the typo mate here or at
least check it right now because this
should be correct so what we need to do
here is as you guys can see we did
actually go in and say that the profile
image that we uploaded was a JPEG image
because we just used the JPEG as an
example in the previous episode but it
didn't occur to me that we might upload
a PNG image instead so right now if I go
inside the browser we have and I upload
a PNG image instead let's actually go
ahead and delete our profile image and
then upload a PNG image instead where it
could be this one here doesn't really
matter just any kind of PNG you guys can
see that we have no images displayed it
does actually give us an error message
because right now inside the front page
it says we need to display a JPEG image
so what we need to do here is we do
actually need to do kind of the same
thing as we did in our delete profile
image file here we went in and search
for that specific profile image and then
we need to see if the extension was JPEG
or PNG or PDF or whatever so we need to
copy all we have here in line six seven
eight and nine copy it go inside the
index page and right before we start
showing the image we need to insert
these lines of code so we do actually
get the proper extension then we just
simply copy it down here then we go
inside the string where says JPEG we
delete the JPEG right double quotes
twice because we also need the question
mark behind it to punctuation and then
we insert the file actual extension so
now we get the proper extension and once
we go back to the browser you guys can
see we now get the proper profile image
now of course we're also going to get a
session ID error message which is
because right now we do we do not have
the what do you call it the session ID
variable down here but as you guys can
see we do actually have the ID up here
from the previous code we did in the
previous episode so I can actually
replace it with this code down here so
do actually get the proper use ID save
it and now we should have no error
messages
so now we can also go ahead and delete
the PNG image if you want to because we
did actually create it correctly as you
guys can see vehicle inside my root
folder there's no PNG image as well so
now we can upload all kinds of files and
delete them again so this is how we can
delete stuff from our website and I hope
you guys found this useful and I'll see
you guys next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>