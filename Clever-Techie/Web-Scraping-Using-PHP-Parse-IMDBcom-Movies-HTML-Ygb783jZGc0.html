<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Web Scraping Using PHP - Parse IMDB.com Movies HTML | Coder Coacher - Coaching Coders</title><meta content="Web Scraping Using PHP - Parse IMDB.com Movies HTML - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Clever-Techie/">Clever Techie</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Web Scraping Using PHP - Parse IMDB.com Movies HTML</b></h2><h5 class="post__date">2017-02-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ygb783jZGc0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys what's going on in school every
ticket and in this video we're going to
be using regular expressions to parse
HTML now just a heads up this video is
going to be more advanced so I'm going
to be moving a lot faster than usual so
go ahead and review this regular
expressions cheat sheet or watch my
other video on regular expressions if
you're not very familiar with it before
watching this video okay let's go ahead
and get started so in this video we're
going to be parsing out IMDB website
which is an Internet Movie Database and
I'm going to be using a website called
reg reg X 101.com to test regular
expressions against the strings to make
sure we're matching them correctly and
I've also decided to have all the code
typed up before because otherwise it
would take many hours to show this video
so just to keep things short I'm just
going to be explaining what all this
code means okay so the first thing I
like to do when matching the content
from a website like this is to identify
the search string from which to to match
the content from so this URL here is
just showing a bunch of movies that were
released in the year 2000 and I'm
starting my search and page 1 okay so
you have all these elements like the
title the year in the description
director and stars and bows and drawers
and the image name so we're going to be
matching all this content now the
problem is here we're going to be using
a pragmatic ol function which means
we're going to be matching all the
elements at the same time now if I go to
the later page for example page 76 it's
going to be missing a lot of that
content so that makes it a little bit
more tricky because we can just match
all the elements individually we're
going to have to match a block of
elements for example here we're going to
have to match the movie runtime genre
and the imbd rating all at the same time
and then check if any of those elements
are empty and if they are which is going
to set the error value key to an empty
string
okay so let's look at the code now and
all this is going to make sense
hopefully so first thing I'm doing is
I'm loading up the page 76 of the search
results and I'm storing everything
inside the result variable I'm also
creating a new array called movies and
main T and I'm just making an empty
array okay so the first match is I
mentioned a movie title so this is the
regular expression here and I'm going to
go ahead and paste that regular
expression inside the Reg X 101 engine
and I'm going to search for this little
string here inside of the search results
of page source I'm going to go up a
source and I'm going to search for that
so since we're on the last page here
page 76 and we're matching this part of
the HTML it's showing 50 results which
means all the movies there's 50 total
movies that are showing up on the page
as you can see it's showing up 50
results and this result is being matched
50 times so that means it's a reliable
way to match the actual title so that's
why I'm using this string this regular
expression so if I paste the actual HTML
here you can see that it's in fact
capturing it as a group 1 which means
it's going to store it inside of our
array under key 1 and it's capturing the
actual movie title so you can see here
under a regular expression I have the
little text then instead of the TT and
this number I have a dot star question
mark which means it's just going to
capture anything so anything that's
there is going to capture it and this
number is going to change that's why I'm
using the regular expression in this way
then I have the regular little text and
then I was a new line break here because
there's a new line and then I'm
capturing everything that's between the
a tags inside the basically using the
same thing as a dot star and question
mark and capture it using the round
brackets and that creates the capture
of the movie title okay so now that we
have made sure that the regular
expression works let's actually go ahead
and print our movies name just to see
that it's in fact matching all the movie
titles and in fact it is there's 49 of
them since the arrow key starts with 0
so there's 50 total elements and it's
matching all the titles so now we're
ready to move on to the next one which
is the year and here's the regular
expression for the year I'm going to
copy that inside of the regex engine and
also I'm going to find this particular
HTML on this page I'm going to go to
search and at once again it's matching
50 elements which means it's a reliable
way to match the year name from the
source code and this is a really easy
one because this is the HTML it's always
going to be the same and the year is
inside of the round brackets inside of
the span tag so I'm going to go ahead
and copy this text and as you can see
it's matching the year name on the group
1 so here's what happens is basically
I'm using a /d curly brackets and 4
which is going to match any four-digit
number because the year is always going
to be a four-digit number and this is
just a different way of matching content
instead of using the usual dot star
question mark and the reason I put that
star question mark here is because there
might be some space in between here
sometimes for some reasons they put a
space there so this is going to take
care of that
okay so let's go back to the code and
let's print our the movies here this
time and see that it's matching all the
year names first so I'm going to delete
this
refresh the page and in fact it's
mentioned only your name since there's
49 elements which means there's 49 total
Araki's okay so it's mention all their
names okay next up is going to be in the
match image URL and this one is really
easy load late equals and then the image
name is between the double quotes okay
so I'm going to paste that here and
again it's mention is 50 times which
means it's a reliable way of finding
these elements and so this is the actual
string and inside the double quotes we
have the actual image URL so I'm going
to paste the code here and I'm going to
paste a regular expression as well and
the regular expression oh yeah ends with
a double quote don't forget that okay so
it's capturing the image URL on the
group one and this is super easy so
let's keep going here and okay so this
is where it gets a little bit tricky
instead of matching single elements
we're now going to have to match the
HTML block which is going to have
certificate runtime and genre now the
actual block is going to be found on
every page but any other elements inside
the block like this certificate runtime
on the genre can be empty and that's why
we're matching the whole block together
and now we're creating a loop here to
loop through that match to block as you
can see we're using match in the account
match one to look through it and then
we're using the same pragmatic
pragmatic all we just matching it once
and now we're searching for those
individual elements inside the block
which is certificate runtime and genre
and if any of them are empty so if this
if statement fails then we're just going
to create an empty string in place of
that element
so let's identify this HTML blocks first
let's let's search for it inside the
inside the actual page and as you can
see there is a space here and that's the
reason I put a space as a regular
expression here as well so make sure to
put that space here and as you can see
it's matching is 50 times which means
again it's a reliable way to search for
that string so I'm going to go ahead and
copy this block of text inside of the
test string and I'm also going to copy
the whole block regular expression
inside the regular expression engine and
also make sure to set the single line
parameter here because we're going to be
matching multiple lines on this regular
expression okay so it's match in the
runtime all the other elements like the
certificate and the genre are empty and
it's capturing the group one as as this
HTML so you can see the wrong time here
space class it goes the run time and
that's the next regular expression that
we're going to be using inside the loop
which is this I'm going to copy that
and it's matching number 75 from the
block inside of the loop so I'm using a
two digit number which is going to run
to or two comma three means two to three
digits number so the movie name movie'
runtime is going to be a two to three
digit number and it's matching that
number and splitting it in group 1 so
this is exactly exactly what happens
here run time and is matched and then
I'm putting inside the array of run time
so the same thing happens under all the
other elements and in fact if I go to if
I go back to page 1 source code and I
search for that text muted block
you'll see that all elements are going
to be there so now all the elements are
here and this is our blog so you can see
the certificate run time and genre if I
paste this code here and then use our
original regular expression to match the
block you can see that the block is
still being matched and now all the
elements are going to be there and as we
go through the loop is going to find all
those elements so again this is just to
account for the empty elements and when
they're empty it's just going to create
the empty string for those elements so
let's go ahead and test this out right
now to see what we have so far I'm just
going to print out the movies array so
I'm going to run the script and we'll
see what we have so okay so let's first
delete the year here it's not printing
let's refresh the page
okay so we're searching page 76 now and
there's going to be a lot of empty
elements so all the titles are found all
the years are found all the images are
found and then we have a certificate and
as you can see it's got all those empty
elements and it's only got a certificate
name for one of the movies saying for
the runtime it's got some of them others
are missing and others onra some of them
are missing and so I'm going to foul but
what what's really important here is we
still get 49 elements we still we have
49 elements we still get 49 elements
under all the key names which is really
important because that matches the
content up with the movies and all the
key values are going to be matching
because because empty content is going
to be empty for those movies that the
content is missing for so I hope this
makes sense and it's not too confusing
for you guys
we're just matching the block of content
and then we're going through individual
elements and matching them inside the
block okay let's keep going here now
we've managed all of that stuff okay so
next up is the IMDB rating and that one
can be also empty but this HTML is not
going to be empty which
a block that we're going to be matching
so we're going to we're going to search
for the block and as you can see it's
found 50 times so that's the block
that's going to be found and we're going
to be searching that block until the
span tag until the closing span tag
which is here I'm going to go ahead and
copy and paste that here and I'm going
to copy and paste the regular expression
so the right guys engine and as you can
see it's matching all the content inside
of it inside of our ratings bar span tag
or rather div and the span tag and the
actual value that we're looking for
which is the imbd rating and is inside
this data value and it's this number
here so this is exactly what we're doing
we're matching the whole block and then
you can see here data and value equals
whatever is inside the data values so if
I place their regular expressions here
you can see that this value is being
matched on going under Group one so
that's working and if it's not found
then it's just going to be empty so
again the same principle as here we're
matching the block first to account for
the empty values and then we're creating
an empty string if the element is not
found okay let's go ahead and keep
moving here and this time we're matching
meta description
I mean meta score and description
together so we're going to search for
this particular block here let's go
ahead and go to here okay so you can see
that this block is in fact found but if
I go to page 76 and search for that
particular block you can see that the
block is not found at all so if I copy
this whole regular expression inside the
engine and then I go to the page where
it's actually found so we can test it
out first so I'm going to go to page one
of the results and then view page source
search for the block and our regular
expression goes until until the closing
P tag so it's going to be until this P
tag so this is a Metascore and
description matched up together okay as
you can see it's matching the favorable
keyword which is what we want and I mean
it's matching this number here which is
the Metis meta score and it's also
matching this paragraph as well which is
the movie description now I've made this
tag optional using the round bracket and
question mark I made this whole HTML
which I'm highlighting right now in blue
all that thing is going to be optional
by enclosing it in the round brackets
and put in a question mark at the end
because like we've seen on page 76 this
block wasn't found at all so that's the
reason I'm doing that and the text that
will always be found is this p class
equals muted text muted so if I go to
page 76 from here that block is always
going to be there so if I search we
still get City result results and this
is the block here so even though that
block would always be found the meta
score block is not government it's not
always going to be found and that's the
reason we made it optional using the
round brackets and question mark okay so
that's how that works and then we're
looking through the whole thing matching
the meta score using its HTML and we're
also matching the description of this
video
using the p class tax equals muted and
whatever text is inside the t inside the
P paragraph so if I paste that here I'm
going to escape this as you can see it's
matching the movie description and put
it in Group one
so at this point let's go ahead and
print our the movies to see what we have
so far
and I'm just going to go to page one
just to see what kind of content we have
okay so it's so it's matching all the
movie descriptions 49 elements
imagine all the favorable stuff
Metascore now we're imagining imbd
writing as well okay so all that is
being matched correctly so now we're
ready to keep moving and actually if I
go to page 76 just to see why we have
those empty elements and block matching
you can see how a lot of these elements
are now empty but it's still going to
match up with a mood our movie names so
that our array keys are all mashed up
together and we're not mixing up all of
our contents so some of the elements are
going to be found others are going to be
empty as you can see there's only a few
descriptions here in this array but it's
all working great so we're ready to move
forward okay so next up we have
directors and stars and this is the same
exact principle we're matching up the
block which is P class equals empty
string and if I go to back to page 76
because that's the page where it's less
elements on it if I go to view source
and I search for that element as you can
see it's matched up 50 times again and
this is the element with empty content
inside of it so it's a reliable way
again
to match the stars and directors because
that's where stars and directors are
going to be found if I go back to page
one if I go back to page one and search
for the same string you can see that the
directors and stars in fact live inside
of this P tag so I'm going to go ahead
and paste it inside of the test string
and for the regular expressions I'm
going to
basis block here and as you can see it's
matching the directors and stars block
next we're looping through the block and
we're looking for the directors first so
let's see if that works
I'll have to skip all the text here okay
so you can see that the directors name
is found and it's matching the whole
thing and put it in a group one so the
director name is meshed correctly now
for the stars let's see if the stars
works stars match and it's matching the
stars content as well now it's matching
the stars content but it's matching all
the HTML with it and that's the reason
I'm using preg match all to match all
the stuff that's between these empty
HTML tags so if I place that here so now
what it's doing is matching individual
star names are from that content so
that's why I have another pragmatic all
here and now what I'm doing is I'm using
an employed function to get all elements
inside of the stars and put them as a
comma separated strings inside of our
Stars array in a similar way I'm
cleaning up the directors by replacing
all the HTML that was matched along with
the director names using a private
replace function and what I'm doing is
I'm replacing all this HTML along with a
closing a tag and that gives us clean
directors and I'm storing inside of our
array directors so now let's test out
and print our prints are just directors
and also print our movies stars just to
make sure we're getting everything right
view source and all the stars are
matched along with a comma separated
values and all the directors are also
managed with comma separated values as
well
and this is also accounting for all the
empty elements so some of them are empty
but we still have 49 elements inside the
array which means everything is working
great all right so that is for the
movies directors and stars and the last
one is going to be vote and draw so
these are the elements down here here
you can see votes
there's no grass which means it can be
empty if I go back to page one votes and
grass all these elements are found so
again in this last one it's actually the
trick is one of them all because either
votes can be empty growth can be empty
or both of them can be empty so this is
why I wrote this crazy-looking regular
expression here but it's actually really
easy to understand so let's go ahead and
break it down now okay so if I go ahead
and search for this pea classical sort
num both visible inside the HTML on the
page one you can see that the whole
thing is found right okay and it ends
with a class equals lister item mode
advanced so that's the end of the
regular expression string and that one
is a start so I'm going to paste the
whole thing here okay at this point you
can see that the block of both is found
and the block of grass is also found now
I am making both of them optional
because on later pages like on page 76
they're not going to be found so you can
see that I've enclosed the votes visible
in round brackets starting here and in
here and a put question mark at the end
I've also put a round bracket here and
ended the round bracket here enclosing
the grass and put in a question mark as
well making an optional then I have the
two div tags and I'm ending everything
with div class list or item mode
advanced because this is the only HTML
that's going to be found on the page
when it comes to matching
box now there's another dot star
question mark after the optional both
block because there can be some empty
space left over if the block is not
found
so I'm accounting for that using this so
if I deleted this part now you can see
that it's the other content is still
being matched because it's optional and
that's what what's our regular
expression is doing it's pretty smart it
knows that they both can be optional and
if I remove this part now it's still
matching the content but in this case
both of them are empty and so our area
key values are also going to be empty so
you can see how that's been done and I'm
just storing everything all the regular
expression inside the Reg X variable and
I'm just putting it here in the brag
match ball so it's just a different way
of using the Reg X if you have something
some complicated reg X like that so then
I'm matching it against the result and
I'm storing everything is match and then
I'm just using a loop just like we've
done in the previous examples matching
up the votes and matching up the grass
which are both inside of these spam tags
and that should be pretty
self-explanatory okay so at this point
we're ready to print out the whole
movies array let's go ahead and see what
happens and we're going to be using page
76 to view all the all the movies stuff
that we've just matched up and hopefully
this page is going to load up because
sometimes MBD legs a little bit so it
can take some time and I don't want to
make this video too long okay so now if
I go to fuse view source we got all the
movie names there's 49 elements we got
all the years also 49 elements image 49
certificate there's a lot of empty ones
it's in fact there is only a single
certificate that's found but we still
have 49 elements then we have the
runtime 49 genre 49 imbd rating 49
score it's all empty but we still have
49 elements which is perfect description
we'll only have a couple of descriptions
49 elements directors and stars and
votes and grass so we have 49 elements
which means all the regular expressions
are working and and that's how you
account for the empty elements by using
regular expressions by matching up the
blocks and then creating a loop to look
through the match and making sure that
all the empty elements get their own
values which are empty strings so you
don't mess up the content in that way
hopefully this video wasn't too
confusing if you guys won you can
download the source code in the
description of this video and play
around with this regular expression
stuff a little bit more and post any
questions you might have in the comments
I'll make sure to answer them promptly
and if you guys found this video useful
please go ahead and like share share and
subscribe and I'll see you next time
where we take you out oh I forgot to say
something please make sure to watch the
next video because we're going to be
saving all this content in a MySQL
database and it's going to be my first
- QL PHP tutorial where we're going to
be designing a MySQL database and make
sure making sure that we put all this
content in the database and then we'll
be able to display the whole thing and
on our web page so I'll see you guys
next time
clever techie out</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>