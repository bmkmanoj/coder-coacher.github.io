<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to use Apollo Codegen with React | Coder Coacher - Coaching Coders</title><meta content="How to use Apollo Codegen with React - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to use Apollo Codegen with React</b></h2><h5 class="post__date">2018-03-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jGY4bHRWO5I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys we're gonna take a look at
how you can use Apollo cogent the types
that they create and use it in a
reaction to add typescript types or flow
types now right here I have the types
that are outputted so in the last video
I was running the Apollo cogent code on
the server but in practice I find I more
run this on the front end in the same
location as my react application so here
is my reaction right here and you'll
notice I have a source and this is a
typescript react application and it is
using create react app and using the
typescript version now to generate those
types I added a line in my package a
song that I like to use called gin types
and what it does is it'll introspect the
server so this is the same thing that we
saw yesterday and then after that it
calls Apollo cogent now the only
difference is instead of using crack UL
files I am using dot TS files so I
actually wrote the graph QL queries
using typescript and then using gql I'll
show you guys that in a second
so here I'm searching source for all the
files that use basically all the queries
or mutations and then in my output
output a source out operation result
types so that's this thing over here but
running those back to back so now I can
just do MPM run gen types and what it'll
do is it'll generate a schema so this is
the same thing we saw yesterday
and then these operation result types so
now that I have both of these on the
front-end we can start doing some stuff
so let's take a look I have two folders
queries and mutations so I have a poly
boost downloaded and from that I have
gql and here are just the queries and if
you've used graph QL and react before
this looks normal and familiar right so
here I defined a query just called a
user query here's a delete mutation and
here
is a create user mutation now you notice
I have variables in here because I want
to be able to plug those in when I
actually call the query or the mutation
and an operation type you'll notice
there's variables right for each one so
let's take a look how you might use
these so first I want to show you
basically all the different ways to kind
of use this and to type it so the first
is just a basic query so here's me using
the user query right here so ignoring
the types at first you'll see I'm using
the graph QL higher-order component
right now and I have user and here I'm
passing in the options I'm specifying
the variable that's used for this query
so if we take a look at this query we
need an ID so I'm getting this ID from
the props passing it in and I'm
injecting this into the user component
and here I'm just rendering it
I'm console logging the props but you
can remove this important bit here is
you'll notice how I'm destructuring it
like this because data can actually be
null so we have to check this because
we're using typescript and it enforces
this then you'll notice I am
destructuring data and I need to make
sure that if it's imploding or if user
is undefined we're gonna return null
because we can get an undefined user
back from this now right here I'm just
renaming this to you that's because I
call it user up here so there's a naming
conflict and then here's me just
displaying it so here's how I had
actually added types for this so first
off I created an interface up here
called props these are the props that I
would expect someone to pass to my
component so if I were to come over here
to app tsx you'll notice I am calling
user one and I pass in color and ID so
in my props right here I have a color
and idea and number and then my react
component the first parameter - this is
going to be the props so the props I'm
gonna create is child props and this is
something that comes from react Apollo
and this helps you basically add the
types so you give it the props that you
expect and then you pass in
any kind of query or mutation so in this
case we're doing that query and then
also the variables for that query and
now you'll see why I like to name it
like this with just an uppercase user
and again I named all of these mutations
and this so my user over here I called
it capital user so now I'm doing the
user query right so now here I just say
user query user query variables it's
very easy for me to reference these but
I specify I'm here and I specify I'm
here now before I should go on I should
tell you guys I am using the latest
version of react Apollo let's look at my
package at JSON real quick so this might
change but I'm using RC 0.3 I believe
this is the latest version but take a
look if things seem a little bit
different they might change it but this
will give you a general idea of how it
works
so that's how you specify it and the
other thing to note is I'm not positive
this is the best way to do it but this
is the way I found that it works
typescript doesn't complain and I get
all the type information that I would
expect like take a look at user I can
now hover over this you and I see I
should expect an ID and a first name on
it so I'm getting the type information
which I want and I didn't create any of
these types right these were
auto-generated for me so that's really
nice so that's what Cochin offers so I'm
gonna show you a couple different ways
different queries you might do and how
to type it so here is the same thing but
using a function or just a function
right so here I specify the child props
right here and you'll notice pretty much
everything else is the same I copied the
same component but I turned it into a
non component in just a function so
instead of extending something we have
our function and we have our props here
and we say what is the type of these
props they are child props and we pass
in user query and this stuff down here
now for this you noticed
this that one actually load because I
didn't pass in options but you'll want
to do that as well okay so let's look at
make user this is how you would do a
mutation so here is the I'm using the
create user mutation so you'll notice
it's almost the exact same thing so here
are the props that I would expect here I
pass in child props and then I just pass
in a mutation and mutation variables
instead of queries so then at the bottom
here I do the same thing okay
so what's nice about that now is the
variables so here's me calling this
mutate function and again mutate can
actually be null so I have to check for
this so I'm just returning if it is no
but now because we have typescript in
with this and it's hooked in if I were
to say the first name was the letter v
or not I mean not the letter the number
five it's actually gonna catch it for us
because it knows it should not be a
number it should be a string so it knows
which variables to pass to the mutate
function now because we added these type
annotations okay so what if I wanted to
add a mutation and a query so let's take
a look at this so this is where things
can get a little complicated so I split
up into two things and this specifically
this one I'm not sure if this is the
correct way to do it but it seems to
work okay for me so starting at the
bottom so this is me composing both of
these together so here is my mutation
and here is my query so I have the
create user mutation and the user query
and I passed in the variable so here are
the types for the mutation here are the
types for the query so then the special
thing that I did you'll see the
interface for the props these are the
props that I would expect for my
component again but notice I did these a
little bit different now so first I
created type called query props which I
said child props and then I pass in the
query and the query variables and then
the props I would expect and then a
query props I pass in to another child
for the mutation so basically I take
what I did before and plugged it in as
the props to the mutation so now I have
type definitions for both the query for
this and the mutation on this component
so we can take a look at for example you
and see that it's undefined or the ID
first name and we can look at mutation
does it show what variables he up here
the variables that it's expecting you to
pass in okay the the one last thing I
wanted to show you guys was how to do
two mutations and we come down here so
for example here's how you would do two
mutations they would conflict with the
name mutate so you would name them make
user or remove user here's me just
naming two different ones and again so
the mutation the you know the type that
goes with each one you supply it so
here's the delete mutation so I'm giving
it the delete mutation and the delete
mutation variables that type and again I
always pass the crops that I would
expect to be passed to this mutation but
now I add two different things to the
props a make user and a remove user and
here I just pass in a mutation function
and this again is coming from react
Apollo and this will go ahead and add it
and we can see it Excel has the types
for this variable so it knows make user
expects these variables and remove user
expects these variables so it goes ahead
and types each one so these were just
some of the common things that came up
when I was using Apollo cogent and
trying to type my definitions I hope
this was helpful and you can kind of see
the different ways I'm gonna be putting
this code on github so you can kind of
use this as a reference whenever you're
coding and if you're using typescript
and you need to take a look at how to
get typescript to be happy with your
types also I'm sure the flow version is
very similar to this but you'd go along
the same lines right so you would go
ahead and create your type definition
and you would import them in so right
I'm getting all these type definitions
from operation result types that's this
thing that we auto-generated and then
you would use the flow types now anytime
that I want to update the types let's
say I update my schema or I update my
queries I just come over here and do npm
run jen types and it'll go ahead and run
this command and update both of these
for me automatically so that's how I've
been using Apollo cogent I hope that was
helpful for you guys that's it for this
video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>