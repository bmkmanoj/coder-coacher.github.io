<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Deploying Slack Clone to AWS - CURRENTLY LIVE | Coder Coacher - Coaching Coders</title><meta content="Deploying Slack Clone to AWS - CURRENTLY LIVE - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Deploying Slack Clone to AWS - CURRENTLY LIVE</b></h2><h5 class="post__date">2017-12-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qzTqv6uLYTE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys I'm gonna be deploying our
slack clone to ec2 instance on Amazon
Web Services and it's gonna look very
similar to what I did with voltage er so
feel free to skip this if you're not
interested and I'll just put in the link
below the permanent link to this so you
can come check it out if you'd like to
so yeah we're gonna have a public link
up and I'll just leave it up for pretty
much as long as I can
so yeah let's dig into this so first I
already set up my ec2 instance and here
is the URL for it
and this is the in production file for
our client so this is just me setting
the URL and again notice I didn't put
hup in front of that I just put the URL
to the ec2 instance so I'm just gonna
rebuild our clients so npm run build and
let that run the background so now that
i have the URL that's gonna be permanent
for our ec2 instance we also need to
update this message where we set the
server URL so for us we need to go into
docker compose and just set the server
URL and here we need to set HTTP in
front
oops if I go into message because we do
that for a little close to and we don't
need to rebuild our server because we
were just putting this environment
variable in docker compose so that's all
the code changes we need to make I
already have my ec2 instance set up so
I'm gonna do is SSH into it and then set
up docker and then move docker compose
over and configure everything so I'm
just going to do SSH and if you don't
know how to SSH and ec2 here's how you
have to download a key so you do - I and
then you point the where your key is so
here's where my key is located and then
I eat the default user is a bunt to
assume you create in a bunt - and
since which is what I did which you can
create if you're using the free tier
which is what I'm doing and then you
just put the IP address for your machine
and if you put the right conditions you
can get in okay so I'm gonna follow the
same instructions oh and actually I want
to do one thing before we install docker
actually so I wanted to talk about
saving the domain name with surge but
actually we'll hit this when we actually
deploy well let's see oops
is there front-end ready to deploy it is
so it's type surge and deploy it real
quick I'm gonna set the build oops
so I want to set the project path to I
think it's called build yep build and
okay over hearth surge copy that so this
is gonna be the URL that I want to save
so Eunice with surge it gives me a new
URL every single time I want to create a
permanent link so I'm just gonna add a
cname file and paste that in there and I
want the cname file to be in the build
because I believe that's what they're
gonna look for the cname so now it knows
this is URL so this will be the URL for
our website that will always go to okay
so now let's do docker and I figured it
tells us not to use this for production
but I figured let's try this convenient
script see how it works why not so I'm
gonna copy this curl to download it and
I don't know if it went it didn't even
see a loading bar alright looks like we
got it go ahead and run it we'll let
that do its thing and then when that's
done we'll just install docker compose
over here using the same method we used
last time
I'll change mod it and then I'm just
going to get minimize that docker
compose and this guy my site that
template we're gonna copy over here
alright let's copy this so we're gonna
set our user and our user is a bunt too
so now we can run commands at will and
ID copy this oh we're a have that
actually it's just one I'm gonna copy so
grab the script top you and I should run
docker hello world to make sure that's
working to run hello world
okay got permission denied
I did just change the user group here so
I should be able to run docker run hello
world without having to run looks like
we needed to use sudo run hello world so
this command just did not work and so
i'd user Ubuntu and I did not misspelled
it let's just try running again that's
odd not sure what I'm doing wrong maybe
cuz it doesn't like this user I'm not
gonna worry about it for now I'm just
gonna continue on not sure why it won't
let us add this user to the user group
for docker but we got docker compose
we're now just going to change mod it
and got the version good
so docker compose up for example good
can't find the config file so I'm just
gonna exit and we're going to SSH and
change that and we're gonna do - I still
and actually I guess we should do put
our thingy here I don't know where I
should put the flag we'll see so here
I'm gonna get compose whoops docker
compose I misspelled that don't carry
compose oh okay so this is just bouncing
to end my autocomplete is not working I
kept trying to autocomplete twice docker
compose and in my sites template so I'm
just s s you're just copying those over
to the home directory so now let's SH n
LS and we can remove get docker we don't
need that anymore and I'm just gonna run
docker compose up and that worked nicely
so now we should be able to go to this
website
and should just work so I mean we got
everything configured correctly and once
I do get this working I'm going to
cancel out docker compose and just have
it run in the background I'm actually
kind of curious maybe we'll do some
performance testing on this because I'm
curious how many users can use this site
at once and how much memory and stuff it
uses maybe some interesting things for
us to test out okay so it's like stuff
is starting up now we pull all our
images so let's switch over open up over
Earth oh you know what this is gonna
break every single time and that's
because we didn't rename index.html to
200 HP ml so what I'm gonna do is in my
package of JSON after I run build I
think it's semicolon for me I don't know
if it's semicolon or ampersand for this
I'm gonna run you know let's test it
real quick so I don't take this whole
time I'm gonna say echo hi and echo by
MPM run build
okay so semicolon works
so after this builds I'm just going to
move dot slash ooh I don't know what the
we'll see if dot slash works build slash
index.html I'm just gonna rename it to
build slash 200 dot build yeah 200 HTML
that way I don't have to do this every
single time I don't know if that's gonna
work
next time we'll run it we'll see right
now I'm just gonna do that and say Serge
and this should grab build awesome at
remember the domain and actually we need
to register Bob Bob at Bob calm Bob and
let's actually just use the same and
submit looks like it might have broke
okay so we did get a network timeout
failed to fetch let's check over here
okay so we didn't get a connection I'm
guessing it's because I don't have my
ec2 instance setup that's open to the
world the way I can confirm whether that
is correct is I'm just gonna try going
to it and see and I think it is not open
to the world cuz it's still spinning it
connect right away if it was open to the
world
yeah it's not okay so I think I just
have to go set a change ec2 instance
setting so I'm going to pause it real
quick and login and change them okay the
problem was with me not allowing anyone
to access HTTP and my security group so
here's the security group that I have on
my AWS instance or an ec2 instance and
if I just come to inbound I can edit and
I added these two right here
all I have to do is add new rule
HUP and then anywhere and then it'll add
those two for you automatically and now
when I come over here I can access /
graphic UL we hit nginx and we hit our
Express server so now I'm gonna try to
real aughh in and suite we're able to
register Bob calm paced that guy in
create a team not now team 1 submit
hello so cool I can see my message on
make sure I can drag images and doesn't
look like images did anything I'm gonna
try just clicking the button tad so team
Oh
okay so this is an interesting air /
graphic UL bad gateway failed to load
origin is not allowed therefore it
cannot allow it
ah that makes sense so I'm guessing it's
because of our chorus settings which is
gonna be in our index of the server now
we are allowing everyone but we can make
another one here I guess we can say if
processed I am dot I guess when do
production and development so node and
is equal to production then we only want
to allow this surge or L so let's copy
you
paste that in and then we're gonna say
else and then for development will just
say core is everyone now I don't know
whether I'm supposed to put HTTP in
front of this or if it's just the domain
I'm thinking it's just the domain so I'm
gonna try this and see and we can tap
you over to and there you now I'm just
going to build this Andrey push it and
see if it works okay so I just tried to
get cores working for a good half an
hour and I just could not get it to work
and the reason why is because we're not
having a course problem if I had only
read the log I would have told me there
was a permission denied but for whatever
reason the error message there told me
it was cores sleeping cores like this is
just fine what the problem ended up
being was files permissions was not
opened up enough so it couldn't access
it so I just did sudo change mod 777 on
files and files is if you remember
that's just where we're holding uploads
so we weren't able to basically write to
that folder so after doing that I can
docker compose up and I'm just gonna go
ahead and run in background cuz I know
it's gonna work now I was even see I
already uploaded it somebody refresh him
and let's try uploading timo nice so now
we see both teemo's so we are officially
working now and we are live come give
this a try come on over to avert health
create a team register an account and
start chatting so we're alive running
docker ec2 off of ec2 we're using graph
QL and we got this running surge next
thing I want to do is to fold things I
want to first since this is live now
there's a few queries that are quite
unoptimized
think I'm gonna make another data loader
video just so we don't use a ton of
database resources and just CPU
resources on our ec2 instance since it
is live now and the next I want to you
try to get set up HTTP and see how easy
that is to get set up but is it for this
video guys
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>