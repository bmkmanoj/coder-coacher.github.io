<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Fullstack Feathersjs and React Web App - part 10 | Coder Coacher - Coaching Coders</title><meta content="Fullstack Feathersjs and React Web App - part 10 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Fullstack Feathersjs and React Web App - part 10</b></h2><h5 class="post__date">2016-12-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2VctGMLXD8w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">guys welcome back so in this video I
want to show you two different things
the first is how to add recipes and make
sure we're getting good stuff saved in
our server and and our database so right
now we're able to put anything like we
can do an empty submit an empty form we
can also pass and through postman
garbage JSON data and it'll our server
will accept it and it will kind of mess
up our application so if we go to
postman real quick we can see that if I
post just this crappy old Bob object
which is definitely not a recipe we just
post it to our server we send it a look
it takes it and creates a JSON object
out of it and saves it in the database
but we don't that at all that because
that's not a recipe if we go back you
notice now we have this blank card
because Bob is saved in the database so
we want to throw an error and our
back-end when someone tries to give us
bad JSON data the second thing we're
gonna do is we're gonna keep track of in
our back-end when a user submits a
recipe and save the their ID is in one
of the fields of the recipe that way
this allows us later to search for a
recipe that a user has made so let's go
ahead and go to the backend so I have
the backend folder up and this is I'm
just gonna be installing a JV which is
what we're gonna be using to validate
our JSON that's coming in we want to
look a specific way to match your recipe
and a JV will verify that for us so I
reinstalled this so I'm good I'm not
gonna run it but make sure to run this
before doing this and then I'm just
going to open up the services recipe and
then hooks and then process and then I'm
just going to do Const HIV acquire HIV
and then I'm going to create an eight
the object and now here comes our schema
I'm just gonna paste it in here now how
I got this schema is I just took what I
wanted the JSON to look like and I
pasted this into an online editor if you
just Google JSON schema converter it was
able to take the JSON I had and make
this little schema for me and this will
verify our JSON so the JSON does not fit
this schema it will throw an error when
we try to validator so let's make sure
it's proper so we're gonna do that down
here in our hook function but first
before we hook we want to make sure to
compile this so it runs fast
Holaday is equal to a to be compile we
don't want to run this every time we
don't want to compile the schema every
time someone posts JSON because we
already know what the schema is we can
just do it once and inside this function
here we can check if what they passed is
valid JSON so validate passing and hook
data and if it's not valid
we're gonna throw an error so throw new
error invalid JSON okay so now we're
awesome we can actually restart our
server so I'm gonna go back to this tab
that I have open for the server I'm
gonna restart it and now I'm gonna try
posting some JSON to it so crappy JSON
like Bob and cool we get invalid JSON
that's exactly what we want now if I go
back let's try to add a proper SP so
recipe 1 du Timo
we have ingredient one ingredient too
and I am a description
try submitting that and here's sure
enough it posted okay and database saves
it as exactly want that's awesome so now
we'll get to the second part which I
want to do is first and the backend
verify and authenticate users so when
they're creating a new recipe making
sure that the user is logged in for the
backend as well and also saving the
users so if we go back to our process
what we want to do is just save the user
and the object as well so the owner ID
which we'll get from one of the
parameters is user and we can save their
ID well this will allow us to do is we
now for every recipe that we create we
save the users ID into that recipe in
the database this will last a lookup in
our database all the recipes a specific
user has made which we'll use in the
next video
so get all that and go to source
services recipe hooks index and now
we're just going to you can see we have
our process hook that's happening when
we create this is happening when we post
a recipe but we'd like to also do is do
some authentication beforehand this is
why we make sure a user is logged in
before creating a recipe in the backend
and then also just make sure to populate
the hook with the user so we can get the
user ID that the process function right
here is going to use I'm gonna do off
dot verify token rust into auth populate
user and auth dot restrict to
authenticated a through strict to
authenticate very nice so now let's add
recipe or
ptoo and let's make sure up and let's
also save that restart your server now
we're gonna add this here and make sure
this submits okay and we're getting an
error let's see what our errors Athenee
manager was called did you receive any
components Oh looks like I didn't start
up this looks like we have an error in
our code real quick let's see though
we'll check that so I tried to start an
it broke
looks like restrict authenticated is not
function rest great
- authenticated there we go
now let's restart server ok that's
worked ok refresh over here now try
address p2 again Oh looks like component
will receive props did you mean
component will receive props up we just
looked the e and I so real quick hop
back over to the client and open up your
components and then off this should be
in e area this shouldn't affect anything
but let's make sure we have the right
function ok awesome
now let's go ahead and address p2 you
can close the console now
submit very nice so we submit the recipe
and it's there just make sure there's no
airs nice and if we look at a recipe
object now we can see we have a new
field the owner so we can use this if we
go back to react so this just copy that
you go back over to react and we'll look
up recipe and we look at our user we see
we have the same idea here I paste oops
let's paste it in here so notice this ID
matches ID here so what we can do is we
can get the ID from our user object that
we populate and then search all recipes
of that user to display what the user
recipes have added so that's what we'll
do in the next video we'll make a new
page where we can click on our user name
right here and then it'll show us all
the recipes that we have added alright
thanks for watching guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>