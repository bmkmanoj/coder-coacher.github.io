<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a Food Android App - part 4 | Coder Coacher - Coaching Coders</title><meta content="Building a Food Android App - part 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a Food Android App - part 4</b></h2><h5 class="post__date">2016-12-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ad-yb5AVU_M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">guys so in this video we're gonna be
setting up our we're gonna hook up our
parser with some HTML the first thing I
want to do is set up kind of a little
restaurant class which we can use to
store all our data so I'm just gonna
create a new Java class call it
restaurant
I understand give it a couple of members
so we're gonna give it a string for the
name of the restaurant it's gonna have a
main URL which is for the main business
page and it's also gonna have like a
picture URL and then also if we take a
look at our emulator real quick so we
have the name the image URL this is
we're gonna have a bunch of different
pictures for the restaurant because we
don't want to just show one one be able
to swipe upwards and show mini so we're
gonna actually gonna show a list of
strings which is gonna be pictures and
port that class and right here we're not
with string at the bottom private string
which is gonna be red rating and cap so
we'll call it red cap all right now
we're just gonna generate some getters
and setters generate kitchen setters for
all our classes nice now let's create a
constructor for a constructor we would
like to have a name and then the main
URL what we're gonna do is we're gonna
set main URL using main URL and whenever
main URL is set what we want to do so
that's this URL without the photos so
just the slash biz and what we want to
do is we also
want to set the picture URL so string so
pick your L you basically want to
manipulate it so first we wanna replace
biz with photos so this pic URL equal
the main URL dot replace and replacing
slash biz with slash is photos and then
this pic your L plus equal there's one
other thing and that I would like to add
so notice it give us a bunch of options
they have outside drink of different
types of pictures I just want to look at
pictures of food so you just add a tab
and that'll add that to them to the URL
and give us all these pictures okay
that's looking good so there's our
little restaurant I have to go back to
our main activity what we'd like to do
is this is not null e first this is
going to be get the list of businesses
it's a nice list which is a response
body businesses and then what we'd like
to do is create a list of restaurants
out of these businesses so we'll create
that up here
restaurants so restaurants is equal to a
new ArrayList and for each business and
business list we're just going to go
through and we'd like to first create a
restaurant object restaurant our R is
equal to a new restaurant passing in be
the name and be the main dot URL um next
thing we'd like to do is we'd like to if
we look at a restaurant like to set the
the rating and the categories so if we
look at bead categories will notice it's
a red list of categories if we look at
rating the rating is a double so we need
to first change we're going to do our
dot set big cat and what we're gonna do
is we're gonna do B rating plus B dot
categories is what we'd like to do put a
space in between them but beat our
categories is not a string it's a list
of categories so cat to strength this is
a function we can create to convert it
so let's create that real quick
and we wanted to return a drink
oops will return an empty string for now
we'll finish that off in a second
understand do business or restaurants
okay so we created this our object or
this restaurant we would then like to
get the pictures for this restaurant to
get the pictures for this restaurant
we have to go we're going to use ok 80
HTTP go to this page and get the HTML
and pass it to a restaurant parser so
private string actually it's gonna be
void send return anything and it's going
to be get pictures all right we should
call fetch pictures and we pass a
restaurant so worried about that in a
second let's go ahead and just fill in
how our codes gonna work so we're just
enough fetch pictures okay so basically
what's gonna happen is we're looping
through every business creating a
restaurant out of it and then we're
going to get the pictures for that
restaurant and then we'll forget all the
restaurants and all the pictures form
and then we'll be able to use that in
our app so let's implement these now
it's category to string so I'm gonna use
a string builder for this so it's a
little bit more efficient yeah we're
just gonna do a for loop for eyes equals
zero iyslah same categories size i plus
plus and we're doing the other dot
append and we append the category
I don't worries that get I you don't
want I do that and then we're just gonna
do get the name of that category now
we'd like to space it out with commas
but not the very last one so we're gonna
check if I
is not equal to categories dot size
minus one we can then do stringbuilder
dot append a comma because we know it's
not the last one and then we just
returned string or two string okay so
that should convert our categories to
string okay and next we're going to
fetch pictures and like I was saying
earlier we're gonna have to add new
library ok HTTP this guy is gonna help
us make our HTTP requests so just add
that to our Gradle file and then we'll
just come over here and I'll show you
how okay cheese chief works and I'll add
this link to this description below so
we're going to do this asynchronously so
as you can see that uses execute right
here which is basically the same code we
want to use so we can just copy this the
only thing you'll notice is we don't
need run get rid of that and you'll
notice this guy we don't need creating a
new client object every time so let's
put that in our on create so those
create client so ok HTTP client oops
capitalized okay okay so that's creating
our client in there and we can use it
below so we need to get the URL that
we're requesting which is going to be
restaurant get picture URL and we're use
their M client to create a new request
what's going on
request stop builder doesn't like think
gear that you're that you're at that
we're gonna do dot and Q you call back
and then I think what we just need to
hear new request I think there's two
type oops I think my IDE is just being
funky if I do request dot builder up you
can see there it's getting Picasso not
okay HTTP oops request dot builder what
we would like to get is the okay HTP
request stop builder so let's see if we
can find that request okay so we just
need to pin this with okay htv3 okay so
all that was happening there was the
request was get confused with the
picasso request so we just need a
changes so that his two libraries have
the same name so we just have to change
that right there and so it should be
working now okay so what's happening now
is we're going to be making a request we
make a request we then execute it we're
in queuing it so this is happening
asynchronously so we can run a bunch at
the same time and then in our on
response on failure we're ignoring that
if it we don't get any pictures that's
fine but what we're doing is we're going
to this page right here and when we get
to that page we what we would like to do
is we would like to get a list of
pictures slip to string pictures
which is equal to remember that
restaurant parts that we just made well
we can now use that restaurant parser
dot get pictures now we pass in the HTML
which is in a response object dot body
and string and this will create the
pictures the only other thing is we
don't know we need to see how we made a
restaurant object up here we just need
to tell it which object it should go
here so we're just you can create an
integer I which is equal to zero and
have eyes and our parameter to our veg
pictures so in position and then we just
need to increment I so that way down
here we're just gonna add we're gonna
get a restaurants object up there oops
dyke it I dot position dot set pictures
and we pass in pictures and we just need
to make this final up here so we can use
an inter object okay now that we have
fetched a new restaurant we'd like to
update the main thread so we just call
on progress update passing in our
restaurants that get position and then
we just need to change this from a
string parameter the restaurant
and everything should be working nicely
and then we should also just do a quick
error checking if pictures dot size is
greater than zero so if there's no
pictures we don't care to update the
restaurant and publish it so up here we
should have a list of restaurants to an
hour on create or above our on create so
restaurants and restaurants and
restaurants so you go to the new
ArrayList ArrayList rest press drop T
okay
and then down here and then on publish
we're going to say M restaurants dot add
values zero okay so what's happening now
is when I call my async task with this
execute here what is happening is it
goes in do in background it calls the
Yelp API when it calls the Yelp API gets
a list of businesses and when we get our
list of businesses we're looping through
each business creating a restaurant
object and then fetching the picture for
those restaurants so we come down to the
picture fetch we're keeping hold the
position so we know which restaurant to
update once we get the pictures we have
a restaurant right here we're making a
request to that restaurants picture URL
which takes us to this page right here
we then use our restaurant parser once
we get the request in this response
object right here this gives us the HTML
for this page we
then pass it to our restaurant parser
which gets the pictures passes it to our
I just soars in this picture's variable
I make sure that it's not zero and then
we update the restaurant that just we
got the pictures for we set it and then
we do an update we just updated because
we got these pictures for this
restaurant so we have a new restaurant
that we can show
so right here we add it to our M
restaurants which we have up here so now
what we do is we call this is it
populates this with restaurants
asynchronously so that is looking nice
in our next video we're gonna actually
show some stuff on the screen so this is
exciting so we can see not just this
ugly picture but some actual food</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>