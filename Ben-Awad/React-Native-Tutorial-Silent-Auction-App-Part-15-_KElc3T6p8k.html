<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React Native Tutorial - Silent Auction App Part 15 | Coder Coacher - Coaching Coders</title><meta content="React Native Tutorial - Silent Auction App Part 15 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React Native Tutorial - Silent Auction App Part 15</b></h2><h5 class="post__date">2017-04-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_KElc3T6p8k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys welcome back in this
video we're going to be continuing on
the app and we're going to start
changing how this time works right here
so we're going to show a human-readable
time and if it's expired then we'll say
like the auction is over and we'd also
like to see it like tick down in real
time so you can see how much time is
left and as it's getting down when you
can go ahead and you know it's an
auction still open and so in this video
I'm going to be coding in Visual Studio
code I'm trying it out I'm still using
them keybindings them is what I usually
use but I'm going to try us out let me
know if you guys like this better from a
viewers point of view might be slightly
easier to follow and then also between
videos I'll inted the project
this one is what it looks like if you'd
also like to lent to your project I have
this on github if you want just copy and
paste this and you can change it to the
way you like it
and then also here's some libraries
you're going to need to install if you
want to once your project the way I did
and I'll just put this in the
description below singing copy/paste it
alright let's go ahead and get started
so the first thing I you want to see is
an actual human readable string and to
do this what we're going to be using is
a moment
so moments is a library that makes
looking at time really nice and it
handles all that stuff where you don't
want to do so I was just playing around
with it and console to see what it look
like here's the moment code and
basically what we're going to do so
we're going to get basically this will
be like the expiration date this gets
the current time and then we'll just
take the difference in times and right
here your reformat and show it so if I
run this you can see at the bottom this
is what the string will be looking at
the our second there's our minutes in a
second okay so we're going to yarn add
moment we'll be using that library and
then I'm going to go into the modules
auctions reducers here and we're going
to do stuff here I'm you notice I have
some
Cheers this is from es limp and it just
doesn't like how I wasn't using those so
if you I'm not familiar with this syntax
which is doing is receive auctions of
string so it actually gets the value of
the string here at the property and then
this dude just wants me x4 default but
I'm going to be adding some more
action or reduces later so I'm gonna
keep that okay so what we're going to do
here is we're going to import moment
from moment and what we want to do is
when we receive the auctions we are
given a string with the time and so the
first time what we want to do is we want
to basically convert that into a moment
object because we don't want to keep
creating that every time we update the
time so we're going to do we're going to
return an array here we're going to
spread the payload and we're just going
to map add moment and so right here we
will create a method called add moment
basically it'll just take a object-- and
turn so we're going to keep all the
properties of the object and we're going
to create end time which will be a
moment object and this will be from the
expiration date so expiration date so we
create a moment object based off of the
expiration date here and if we go back
to my example reaction you need to pass
in the format that the string is in and
it's an iso 886 a 1 or whatever I mean
here we're just going create you can
just pass end time in and I also want to
while we're at it to do a
basically time left and then we'll calc
time left so we'll create another
function here called constant time left
calc time left and what we'll do is
it'll take a expiration date and it's
going to compare this to the current
time and tell you how much time is left
so for that we're basically going to
just copy a basis and we're going to
clean it up
so we get the current time for a moment
right here don't need this then we want
to get the time difference so expiration
date - current time this will give you a
time difference and then here we want to
make that Const make this conf and the
duration this object just we're just
basically wrapping time diff and a
duration object this just lets us get
get it in hours which we're going to
need to do so here we are basically a
friendly time string so I'll called
friendly time we do Const hours is equal
to data as hours okay so here we want to
do a check this would be creation we
want to say if hours is greater than 0
else complete so if it's if there's no
time left or equal to 0 we want to just
return that it's time left we want to
show a negative time that's in the past
we'll just say a doctrine is complete
other eyes or return we can actually
just compete that
and what this is doing is it's doing
getting the floor of ours because ours
is a decimal so we want to get the just
integer value and then we want to timed
if we're going to convert the time dip
into a moment object and then that way
we can format it and just one single all
right see what doesn't it like Anessa
Sarah after returned oh I could get just
once that chilling space not a lot all
right cool so now with this oops that
should be you now with this we have this
new basically property we're adding to
all the objects auction objects called
time left so now if I come over here
instead of expiration date what I really
want to see is time left then we'll come
back refresh now if we don't here's we
should see it in hours minutes seconds
look we don't see anything so let's come
back over here and see what we did wrong
and we just forgot the pass in M time so
we pass in our expiration date here
which we create turn into a moment
object and then we're good look fresh
and cool so this is way into the future
here some of these are complete double
checking this is working I'll post an
object here so I'll have something in
2016 and up and we actually haven't done
that yet so if i refresh we'll notice
how that is actually in the show it's
showing us
but this is wrong right because we
should this should be in the past this
should be complete but it's not complete
so looks like we got it backwards so
should be current time minus expiration
date let's see if that gives us right
complete complete complete now for
example if I'm go to 2017 and let's say
tomorrow which is May the first maybe
the first is complete
- let's see it let me put another time
here so we can know which one
all right this is complete - all right
so obviously I was something off with
our calculation I think this is right
expiration date this current time let's
go back to jsbin just play with this
loop a lot easier to work with here all
right so let's run this
so are we doing hours we are checking
hours which is duration as hours
returned complete time left this looks
good and for example if I choose 2018
this is 731 okay you know what I think
it's working now I think we're good so
doing expiration date disk current time
this is the right format right here okay
but notice how when I was adding new
times like if a new time pops up here so
if I do like 23 notice how it's blank at
first the reason for that is we did not
add basically we're adding this payload
but we're not doing add moment on it so
all we need to do is add moment that way
it gets that moment object in it so now
for example 12 comes in and we see it's
time and notice if we refresh 3241 12 to
12 just missing oh it's because we have
more than 10 okay so just look at this I
was just going to show you guys how the
time is ticking down so 26:35 26 and 19
so every time i refresh it calculates a
new time and it puts it in there but
what we'd like to do is just like set a
timer every second
be freshers so we don't have to do that
and so that's what we're going to do
next so this is looking pretty good here
so we're going to create an action for
our auctions and we're going to call it
update time and we'll create an action
here called update time and then in our
reducer update time is really easy
so all we do is we take the state and we
do state dot map and all we do is we do
calc time diff
they're basically updating time left
let's actually create a new function
called update time that should be a
comma Const update time this takes a
object call it X and what we're going to
do is we're just going to return from
the sky you know what we don't even need
to do it up here because I am just going
to do everything here okay
go here this map is blocking thank you
okay so we're going to map through that
we're going to go through each object
each object or each auction we're going
to keep all the properties of it and
then we just basically need to calculate
a new time left so time left is equal to
help time left and then pass in X dot m
time and notice how we don't have to
calculate a new end time because that is
the expiration date which does not
change at least unless they update the
object in the database okay so whenever
we call update time now it will now
trigger this and it will run now to get
this automated so now update time is
called just over and over we're going to
use this timer mixin this timer mixin is
nice because what it does is it stops
we're going to create a timer which is
going to run and it's going to call our
thing every second and a lot of apps as
it says right here crash because we
don't unknown that so this is a mix in
that basically that Facebook gave us
that makes it easy so
use that so copy that and come the
interview over here and notice how this
is using the create class what we want
to do is use es6 classes not like this
and they point us to this library over
here that allows us to add a mix in like
this so we're going to use this create
create not create react mixin library as
well so react mixin react to mix them
right yeah so now we just need to add
these to our project
yarn react X N and the other one was
called react timer mixin alright so
we'll do in slow the dependencies and
when those are good we'll come down here
and we'll do act mixin then we'll call
view at auction top prototype and then
we'll call our timer mixin now now that
we have that timer mix and what that
allows us to do is component tip amount
will do this copy this except we're not
doing set timeout only happens once what
we want to do is set interval so that
I'll keep happening and here we want to
call this stop prop the update time and
we just want to keep triggering that
action to happen
every second so now I just nad update
time to the props so if I go to the
index do update time here
all right pass them through the props
and then we call it here every second
all right let's see it go all right and
we have a problem let's make sure we did
everything correctly so we added it to
the props here that looks good we're
getting it from the auction's action
here here we're calling state dot map
we're going over calculating time left
based on X and time that looks good
listening so it's probably something
with our view here and yeah it looks
like I just misspelled interval awesome
and check out the times they're just
ticking down
and now what I want to show you guys too
is if I add one that's really close to
being done so it's April thirtieth we
can watch it as it takes down and
becomes complete so just how far away's
is 2017 this is 25 minutes away so if I
subtract 25 minutes
that'll be 22 and we're 21 like 30 I
think here we go
so three two one and it expires and goes
to complete all right so we have
auctions and the timers for those so we
can just watch as we scroll down we can
see all the timers being update so we
can watch our auctions and watch them
expire and watch them and check out when
they're going to be done so I hope you
guys liked the video that's it for
though if you have any problems setting
up the timer or with the moment please
leave a comment below and I'd be happy
to help and I'll see you guys the next
thing</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>