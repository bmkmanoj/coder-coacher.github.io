<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a GraphQL Server with Node.js | Coder Coacher - Coaching Coders</title><meta content="Build a GraphQL Server with Node.js - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a GraphQL Server with Node.js</b></h2><h5 class="post__date">2017-06-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hqk30IVeYak" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys in this video I'm going
to be doing some live coding I'm going
to show you how I set up my graph QL
server end node so the server I'm going
to start from scratch completely from
start and walk through the whole process
setting it up it's going to be connected
to a Postgres database to persist the
data and it's going to be using es6 so
it's nice index so first thing I wanna
get started to do this is use the Apollo
graph QL server this baby just sets up
your graph QL server and Express super
easy like the business the code you have
to do right here this is amazing there's
other ways to create graph QL server
this is my favorite by far so I'm going
to be using that for this so Leanne
still Express body parser and this guy
right here so let's install those so as
you can see I have terminal open and I'm
just in an empty folder right now do LS
there's actually nothing there so we're
going to start with NPM in it and we can
just keep the defaults and now and be in
install and you'll it lets yarn this
because yarn is just faster and it
Express and then Bobbie parser let those
install now for using Postgres I'm going
to be using sequel eyes here it's a warm
and node and it just lets us basically
do stuff up the database and they have a
nice example that works well with
Express that we're going to follow and
then to get our nice yes 6 features or I
guess this is es 7 as well as you every
in Babel so we're just going to follow
this and I'm going to put links to all
these guys in the description below if
you'd like to follow along also the code
is going to be going up on github if
you'd like to just download that you'll
have my starter kit forcing have a graph
GL server alright that's that installing
I'll also install this with babble so
anything else when you really need to
install nope looks like that's is your
only library
again I'm going to yarn this yarn
ad and dev okay so that's done we're
going to just create a index file so new
file index up jf and we're literally
just going to paste their example in I'm
going to spread this out a little bit I
don't know why they're using Const here
and then bar here that's weird to me I
don't need that you just put it here
3000 is fine graph QL I guess I can also
set up EF lunt
that sounds like a good idea so let's do
a splint I think it's a knit yeah so I
like to just use the Airbnb one because
it's really nice
oh shoot I'm not using react there's a
popular style yard
Airbnb know react do a Java Script out
that install okay so this is basically
setup our graph QL server and it's
pretty much set up like there's nothing
else you really need to do I mean we
need to make a schema and resolvers but
our server is up and let's connect this
baby with graph iql or graphical um
looks like it's just this and you can
get that from our guy right there
click Ruiz copy that and we just put an
I was i right
grass cool Express ship
what that save cool es lent to the es
lingo it did cool
looks like alternatively did es hunt you
need to reopen the workspace after
installing excellent so I'm just going
to close that column can you do code
that way my es Flint works good some
linting scoop this put this here for now
okay so we got es Lent working enables
resolve path well installed body parser
did I not yeah says right here so you
flinched being stupid get something
stupid up and we'd all have a schema set
up so we can actually create a schema if
there should be a way to create
executable schema they should have an
example here sending requests here we go
during a schema with graph QL tools so
let's also do yarn
add graph QL tools okay so we're going
to create an executable schema oops let
me copy that correctly and it's fine to
create schema here why we have there
okay
so type def and resolvers we need to
make so I'm going to create that here I
do type both import type death from
schema and import resolvers from solvers
so we need to create these two files now
for our
I thing to work so I'm just going to do
a little whole world example for now so
let's do schema ojf and to say Jas and
resolve yours touch it so now the schema
how they do it is they want you to make
it a string so that's what we'll do and
create query and we'll make I'll just do
a single query for now and we'll do
hello
and then our resolvers here oh I
accidentally put hello and the resolvers
that should be in the schema so paste
that and resolvers export default object
and their objects we have a query in our
query we have a hello which takes three
arguments the parent args and context
we're not going to use any of those
we're just going to return hi and enter
schema that's not how you do graph QL
that's right that's proper syntax now we
this looks good I could be wrong but
we'll get an error if it is wrong
contacts good here index these guys
should be working now if I reopen nice
alright
so now if I go to graphical our endpoint
I think we should be good to go I think
our server is all set up nicely we just
need to get Babel so we need creates is
dot babel RC file so we can actually run
our server babel RFC taste you're in and
now we need to go to our package JSON
and I'm going to create a
start and when we start we're going to
Babel node and we're going to do that on
the index
oops and I don't think I installed Babel
node so when you install that too
I think that's just babble we'll see if
have in rise I think it's and this will
be dev babble node TOI believes what's
called if not we look it up
consarn package babble CLI there's a
package we need to install to actually
be able to just do a babble node hope
just babble CLI alright so we added that
here to this and then when that's done
installing what we're going to do is
we're going to go ahead and run the
server so I believe a resolvers is
looking good yep your creators all the
maps with a query yeah looks like you
there's also four param your info but I
don't really use that too much I just
usually read three okay now I'm gonna do
NPM start and move okay I did install
graph key and add dev crack you all
now I will do MPM start okay looks like
you're doing something
oops something else wrong - oh we just
have a syntax here oh the whole thing is
supposed to be let's go to drink schema
looks like I'm just being I'm missing
something I forget if they wrap the
whole thing I except the whole thing and
curlies like that see if they have oh
you do type that's right I always forget
the graph QL syntax all right let's
rerun this and it's thinking a lot
longer this time so maybe it's working
let's take in a very long time when this
does start up we should be able to go to
localhost 3000 and then graph iql oh you
know what it probably so I was saying it
was thinking for a while we didn't do a
print statement to say it was up okay
now we can go to graph QL and I can say
hello BAM that was super fast we set up
a graphical server just like that now
the only thing we're missing is our
Postgres back and i promise you guys or
database we're going to use and set up
with this guy so that's all the code we
needed to set up this with the s6 and
get babel up and running and we got a
palo server let's do sequel eyes now so
we're going to be following this example
right here this is coming straight from
Seagal Isis just how they recommend
doing it because what we really would
like to do is in a resolvers be able to
access the database so instead of this
silly whole example if we did something
more complicated we'd be able to like
update the database create items and
stuff which we will be doing ok
so let's go to models we're going to
have to create eight bottles folder -
this is where you're going to put all
your database models the way they do it
is they set everything up in index and
then each one and all they have here
let's create this alright
oops models is a folder not a file
folder wait what oh now you delete you
delete new folder models okay you fold
it index like area and then we'll create
one model sure
okay user model using that GIS cases KN
and now we're going to fix this so it's
actually es6
get review get rid of you export default
and we're going to be a function here
and const easier that's fine user has a
user name that's fine associate has many
we don't need to worry about that
we're not going to create associations
this tutorial okay so we're creating a
single user just create a table in the
database called user and I'll have one
column called
user name so it's good alright go to our
models here go to her index and we'll
set this guy up so we're going to copy
this we're going to cut this down quite
a bit there's a lot of code here that is
unnecessary in my opinion
basically what they do is if you like to
follow this you can I don't like it too
much basically what they're doing is
they're actually reading all the files
and their models folder and
automatically adding them I like just
adding them myself so you can control it
so up and I'll make more sense when we
actually kill all this stuff you'll see
what I mean
so imports equalize from equalized um we
don't need and we don't need config no
yes okay
can't see equalize is equal to new
sequel eyes we'll have to create this I
don't think we need this we might
nope we don't need this this is for
importing little talking about they do
some fancy business um okay on TV you're
basically making a map of all our models
so I'm going to import the user model
from music that we just created and I'm
going to create a user field here and we
actually have to just import that and
import it actually I think we do it like
this yeah we let C equal eyes actually
import this now why is it not liking
this should be listed oh when you
install sequel eyes two things I'll do
I'll do this in a second I want to set
up a node demon on this we don't want
the key restarting the server and then
yarn does nope without that dependency
seek wise so we can just keep restarting
this every time you make a change but
we'll do that later we don't really need
that right now I don't want to stop
because we're kind of in the middle of
setting up the sequel I see garbage all
right so we got this stuff this right
here is for staying up associations we
don't have associations right now I'm
just going to comment it out because I
will want to use it once I use
associations basically what it does to
loops through all the models and
associates them that's it this is just
something that they give you and we're
just exporting DV export default the
database alright so this is pretty
straightforward we're creating a sequel
I'd object from our credentials now this
I'm going to actually fix anymore I'm
going to put on the information a second
but first I have to actually create a
database I have to create a user so this
guy can actually access stuff then we're
importing all our models here we only
have one model user model and then we're
just adding some things so it makes it
user easier
we need at a what is it called access to
sequel eyes object you know you don't
actually technically need these lines
this is just like a convenience thing
because we're going to be exporting and
using this object and our resolvers so
if you did need this you Adam here I'm
going to leave it for now because
sometimes I need it you know actually
comment it out for now until I need it
I'll uncommon if I need it because
sometimes need to access this equalized
object most times you don't usually just
do the models and you'll suit I mean the
net we actually use sequel eyes and our
resolvers okay so let's create these
things if we go here it actually has and
I think they have a getting started
though also we need to add that we're
using Postgres because you can also use
equalize with other things so we're
going to be using this PG and PG h door
this is for Postgres if you want to set
this up with my C core these you just
switch those out for the one you wanted
so it's very easy and you know what
actually new tab will not work yarn add
up those guys okay then we're going to
set up a connection here this last
parameter is dialect and our host is
localhost so I'm going to put post
localhost and then what's it called our
dialect is Postgres and then our
database name we'll call when you create
this I'll just do test graph QL DB
username or create this as um test SQL
admin I am a password
okay so we need to actually go I'm going
to go to command line right now and
create these guys so I have Postgres
already running in the background so
what I can do is I can just run the
create any command
I have Postgres installed and all that
stuff it's running so I have this
available T and then I can just say test
graph QL DB and I'll create that for me
and then I can add a user by going into
piece equal BC equal just lets you
basically do database stuff I can do
select statements and all that jazz and
I can create a user but I always forget
how to create users we're going to give
a little quick create user PC cool it's
something I think it's like you create
there's a database table
um yes what we want to do but I like
this this is exactly what we want so
we're creating easier than we're
granting privileges straightforward so
the user test graph QL admin password
being I enter password
I am a password so you're going to want
to set this let me make sure this is
right click okay lemon I am have sort of
cool and you're going to want to make
whatever you want for username password
and database name grant all privileges
for the test graph QL DB to test graph
q11 all right now he has all those
privileges a backslash Q gets you out of
the prompt that's important and now we
can you NPM to start and we should crash
oh and I should should have been in the
folder but it doesn't matter okay so I
just cancelled that now in our index
folder or file here what we want to do
is we and import models from models and
then we just want to pass
here to our graph QL actually here as
context and I forget which parameter it
is we have it here um
adding in graphical and point it might
be this one basically we want to pass in
as context and actually think no out
sockets I was not this not subscriptions
this one one of these should have
context here we go
graph QL option so ok schema context so
there's this thing called context we can
create which is an object and all the
things we pass here are passed to our
resolvers so I'm going to pass in models
oops our models lets us interact with
the database here and so in our
resolvers here knows how I put this
context variable right the context
variable there is this this object so
now we can do in a resolvers this will
be modeled and we can do so for models
so just as an example just the show
just working oh forgot to show you guys
one other very important thing we're do
two things before we continue with this
let me just undo off this page this page
is fine undo this okay so what i want to
do is i want to set up no demon and i
want to sync and actually create the
database so one thing we have to do with
express is every time and this exudes
this example shows it in their app
dodges j s we just need to run app tank
where are we they're not at model
stop think I don't see it maybe they
don't do it here I've got yes I thought
they did wouldn't be in views okay let's
go over here they'll show it here test
connection here we go
sink not here though I want to see a
sequel I think setting up connection
maybe Wow I thought this would work I
thought I had it here okay I'm just
going to go by memory could like think I
remember how it works if it just doesn't
work - fine - so before we do listen we
just have to do models and it might be C
equalize and that's why I need to see
clogs object I can't remember we're on
to sync and then we do dot then and then
we actually listen so what did I just do
here and we can actually do an
underscore because I'm not going to use
that okay so and actually we can just do
this because I'm not gonna use any
params so model stop sync actually
creates the database so here we set up
our model our database model here we
told them what tables we want we want to
use their table but we never told we
told it how to connect to the database
but we never told seek wise to create
the database and to basically create
tables we don't have and to do that we
just have to be models that sync and now
this might be not the correct syntax it
might be sequel eyes don't think I can't
quite remember
we ran out to run this I can't find the
doc so I'll just see if this works
take it we'll give up now sync is not a
function okay so then we do need this
that way we can do
sequel eyes sequel eyes don't think
now restart that now if this doesn't
work I will go ahead I was going to say
I was going to go ahead and look it up
but look so this is what it just ran on
the database so create the table users
so it looks like our DB is set up cool
did it create the database let's double
check so I am not sure if it created the
database so we're going to do is risk
connect to the database see if it exists
I named it test graph QL select all from
users looks like it did gets it up
correctly cool ok users like that cool
so ID adds these three fields that we
see our user name field there as well
all right so it's setup correctly
all right now let's set up a node demon
NPM oops the yarn add dev node demon if
you don't know what no demon does it
basically restarts the server every time
you make a change so you'll have to keep
coming over here in control seeing and I
need to look at these settings because
we don't want to just run node we going
to run Babel node when we do no demon so
we have to do a special command and that
would be this yeah good okay
so package.json where is it
scripts now we're going to say node
demon and we're just going to execute
Babel node now we can do NPM start and
now we have running Babel node on index
recreate stuff it doesn't exist it does
we have to worry about it okay this is
all setup good to go
we're actually done right now so we
created a table we have the sequel I set
up here got a graph QL server we can now
do graphical things and our resolvers
and actually do stuff with the database
now I'm not going to end it here if
you'd like to see base I'm just going to
make some crud operations on the users
so you can kind of see how you can use
sequel eyes um with graph QL and it
makes sense okay so let's come over here
we're going to create a type user but
the server is all set up to go if you
wanted to just run this this would work
fine and you could customize it the way
you want so I'm going to create a type
of user it's only going to have one
field I'm going to cook it like normally
you want to want to create a type just
for one field but it's a user and I
might want to add more things later so
we'll just do it like that alright so
I'm going to create another type called
mutation so we're going to create a user
we're going to take a user name which
will just take a string and will output
a user we're going to do update user
username string and when we update a
user we actually returned the number of
rows so it's going to be this you'll see
what I mean this this will make sense
when we actually update and we can also
delete user username
and it this tells you how many things
you deleted so NC equalize we need to
delete it returns because we're just
basically going to run this equalized
command for delete update great for
delete user returns how many rows were
affected for update user does the same
thing but wraps it in array not quite
sure how that works and then here return
the user and actually there's more
fields so we could actually just do this
and create that that's going to be an
int as well actually is this a string on
it let's do it a bit of a string it
would work either way I think update it
at and then here I'm going to say get
user able to username and we return user
okay so now we need creative resolvers
for this so a mutation so get user what
we're going to do here is going to do
the models or models dot find think it's
find one I'm actually kind of rusty on
my sequel eyes as well um and I should
be doing models that user so we want to
do stuff on the user table and let's
look this up so querying we just really
want to find a one where find find one
see do they have a search equalize find
one I think that exists
yup find one does exist and we do where
um also cool thing I like async/await
so we're going to be using async await
actually we'll save that for another
video I'm going to be eight doing async
we in our ability
because we actually don't need it here I
was going to say we can use it but we
don't even actually need it I don't want
to just add it just add it well I'll
show you guys that in the next video on
that is some pretty cool stuff too
I'm a big fan of async/await okay so
we're we're username it's equal to
username and we can actually expand out
the args here so if you're not too
familiar with how resolvers work the
arguments are passed in from right here
so we're going to give an argument
username string so we can actually grab
the end result right here grab the user
name that the user passes in and we're
going to search for the user which has
the username that was passed to see if
we can grab him
alright now for a mutation it's going to
look almost the exact same as this guy
so we're going to copy him let's uh get
user react create user and I think it's
just create we're going to have to go to
there's one thing here I think it's
reference I has all of them yes this is
what I want is it create I want it for
models where is models there you go this
will have all the things I want I think
if you create your create is what I want
so this creates a user and then you just
pass in whatever you want and I'm gonna
pass in arcs so you pass in what you'd
like to create the field to create it so
there's going to pass in args which
should be username that's all I need to
create a user when update user exact
same code actually intially easier it's
going to be the exact same code except
now we just change out the operation
then I'm going to add one more to I
think it's called remove remove
attribute sit delete I don't pick it
sweet go back up
destroys it destroys what it's called
destroy where username we can just pass
in the arts
oh we just have one too many because are
we really going to be an object that has
username in it you can just pass args
right in update I believe it's just
update so as you can see now you can
just go yep update values options and
let's see how I think you need a wear
update might not work out of the box as
you can see just use different colors
that you want and we're going to use
just find all all users models dot user
find all I'm going need this you don't
need that because I'm using the same
name yeah we'll just a parent and args
we're not going to use it though okay I
think these are all good I'm not sure
update user might be the only field that
is broken fine all users
and we return array of user all right
that shows you how to do the crud
operations let's validate this is all
working and yep looks good make sure it
restart over here it looks like we have
an error let's just see send tax create
user so we're schema has an air of some
sort we have a type here all users takes
no parameters out string use the other
case anything else
you start it is like fountain name
string expected oh should be : here I
just did this totally wrong okay
okay looks like it started perfect now I
can go to graph iql over here will
restart alright so we're going to get
all users and there's your to start
because we haven't created anything now
I'm going to do a mutation create either
use your name Bob create them Bob - Bob
3 all right now we can query them all
users get their usernames got all our
bulbs here now we can do some more
mutations on an update user username Bob
and this is really how I should have
created this so we're going to fix this
Bob 3 so I should pass in another one
when we're updating what we'd like the
new user name to be and then an hour
resolver here when we're updating we
really just need here is username is
going to be new username so username new
username are going to be the args passed
into our update user we're going to use
we're going to be using new username to
update the user and we just need to find
the user by its current username alright
so I'll be your update function right
there and now that guy should work and
we updated user and just do different
things so it's you you see 10
okay now if I do a query on all users
get their username we have two tens oh
because two people have the name Bob and
now I'll show you delete and let's
actually get a single user Bob to make
sure that's working ID username also
don't forget I can get created at and
update that as well nice and we could
get if you want that for all user so all
users get all that junk and now let's
show the lead mutation username let's
get rid of Tim I don't like Tim got rid
of two users that's why there's a two
there and now we can do find for all
users and you can see we just have one
and hit should be on your an intramural
Bob we have left okay Bob - all right
that is it for this video guys we set up
a whole server connected to the sequel
wise we got graph QL setup we did along
this small little video here I guess
this is about kind of long because I
wanted to do this little credit
operation users to show you sequel eyes
and how that connects if you liked this
video subscribe below I'm also going to
be doing some more videos with craft
skill if you liked it doing
authentication with this and if you'd
like to see more so piss equalize let me
know so thank you guys for watching and
I'll see you guys in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>