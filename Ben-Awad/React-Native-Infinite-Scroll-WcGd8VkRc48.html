<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React Native Infinite Scroll | Coder Coacher - Coaching Coders</title><meta content="React Native Infinite Scroll - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React Native Infinite Scroll</b></h2><h5 class="post__date">2017-07-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WcGd8VkRc48" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so today I'm going to be
showing you how to do an infinite list
or lazy loading that way when we get to
the end of the list like this what we
see is more items it never runs out so
Twitter Pinterest Facebook all those
companies do it they don't load all the
data at once as you're scrolling through
your feed they load more so we have
ourselves a flat list right here
but it's static now I'm going to show
you how you can go to the next thing so
the requirement for this is to have a
back-end that actually supports
pagination because that's what's working
at least in some shape or form now we're
using the random user API for this and
it does come with pagination so I can
say page 0 page 1 page 2 or whatever and
it gives exact random results so paging
is not useful so to make sure it's not
random we use seed if you're not
familiar seed basically shoes you pass
it a string and as long as you pass it a
string basically and it can be like
anything numbers where it's anything
just - it'll use that and basically
unrealised it anytime you use that seed
you get the same order back so that way
we can page through it so we're going to
use that I'm going to copy this URL here
and we are going to use that in our code
so I have the URL here we're going to
just replace we had before with this and
now we're gonna have to add some stuff
to our state right because we need to be
able to change the page here that's
different data as we're going down we're
going to change what page were on so
page you can dynamically change and the
second thing I'm going to show a loading
indicator so we're not just like you
know scrolling through I want to
actually like hey we're loading like
give user feedback so that's I'm not
going to loading a boolean to check for
that and then we're going to change our
fetch here instead of just rendering
page 0 we need to change this so it
grabs the state right so this dot state
dot page so every page stays on it we'll
go ahead
and loads out and also I'm going to set
the beeps fault 2:15 you'll notice that
the reason I'm just saying the default
size that way it actually goes past the
bottom of my screen so we can actually
start scrolling and we're not loading as
soon as you know we've already made a
call alright so now we are set up to
handle this and what we basically want
to do is call fetch data when we get to
the end of the list right we need to the
end we want to fetch more data how do we
know we're in at the digit list
well flat list actually tells us come on
right here I have the flat list
documentation up and they have this cool
function here and here well these are
function their props called on and
reached and on and reach threshold this
is gives you basically a function that
can be called whenever the end of the
list is reached and now this is
basically it you can say how close you
want to get before this is a game called
so you can put 0 and wait to the bottom
or as this is saying wait you could like
start loading while you're halfway
through the list you can change this to
you know however you want to do it so
I'm going to copy these props over and
add them to my flat list so I'm going to
set the threshold at 0 meaning we once
we get to the end of the list you will
call this function and I'm going to
create a function called handle and so
handle end here what I'm going to do is
twofold so create the function so we
want to fetch data right but we first
want to update page so what we're going
to do is call this set state and
normally you would just have state right
and say page is equal to this dot state
gauge plus 1 but this actually won't
work here and the reason for that is if
we're scrolling really fast handle end
will be called multiple times so if we
just normally call like such data right
at the end like this
well handle end is called twice at the
same time this is a
synchronous so it won't update this page
you get a race condition because this
thought state is not going to get
updated because they're both running in
parallel so the fix is what you can do
and this is safer code you can actually
pass this date in as a function year you
can pass a function that returns an
object the set state few people know
about this but it's very nice in this
case to avoid a scenario I was just
saying and what we really want to do is
we only want to call fetch data once the
page has been updated right so you can
actually give a second parameter to
handle int which is a function to call
after the state has been done or
finished updating so we're gonna call
this stuff fetch data all right and come
and just scoop this to another line here
and it doesn't want to do it because I
have an auto for matter which is fine
it's not that long but basically we're
doing here is we're updating the page
where you go to the next page and then
we're grabbing the data for that page
and there's one other thing we need to
do and that is with data here so the
same thing now I want to do dot this dot
state data could we're pending on to the
end so we need to append on to the list
and I'm going to go ahead and do state
like this for the same reasons we did it
before and oh I accidentally pushed caps
lock and just messed up everything okay
so how's that there and then have eight
here there we go
I'm also going to go ahead and put
loading to false here and set this dot
said state loading true we're not going
to do anything with loading at first but
we will add an indicator later first
let's see if that worked so I'm going to
scroll down and as I'm scrolling when I
get to the end we should call our
function works
not to come back and see and make sure
we did everything correctly
so this thought handle end I'm going to
go ahead and make this a lambda 2 so
this by handle and that could have been
it sometimes it doesn't like if you just
packed like that so handle in this is
going to shove to the state we're
incurring the page and then the pay
we're calling this sausage data such
data here we'll add the end of the data
by getting whatever results already in
the data and adding it to the end this
is a pending JSON results to the end of
data that we have they were saying state
yeah this looks all good want to refresh
and make sure and still nothing
so I'm guessing that the on end
threshold this thing is not getting
calls or whatever reason because this
don't handle okay whoops let's make sure
what I'm thinking the problem is
actually a problem so this looks good
this looks good I'm thinking that handle
end is never being called so to test
this assumption I'm going to say handle
and handle and not called or what's it
called
so now I'm going to come over here and
do react native log iOS this will give
me an log account of whatever i
comfortab logical show me this is how I
like to debug when there's problems like
this because we're reaching into the
list we should be calling it right but
we're not so we'll see
and sure enough it is not being called
right I search the word called and it's
not there so for whatever reason oh
that's why guys I have a typo here it
should not be on reach it should be on
reached all right so now I can get rid
of my console log because I'm confident
and now we're going to refresh and now
we're scrolling
and we shall have more stuff pop to the
bottom and also what I just realized
this coolest on lady Oh goose ten popped
up twice I thought was it duplicates
that I think that's just I think that's
their problems not our problem
see how cool is stand and then gula
stand is down here too I think that's a
different thing okay so we see fill up
and then we're scrolling and then we go
down more and we're you know as we're
scrolling it loads when we get to the
bottom now we can play with this
threshold a little bit maybe if I do
point five um it'll auto load as I'm
going down so maybe I never hit the
bottom like notice as I'm scrolling I
actually don't even get close to the
bottom I mean here rating the bottom but
it needs a jumps up you might be getting
end of our Jaime API calls we can make
but notice how we don't reach the end as
much as we're setting the threshold
higher okay so that is how you do
infinite loading I want to do one last
thing before in the video and that's how
to do a loading indicator because we
want to not just scroll to the bottom
and have it you know pop the next thing
I'd like to see it like a loading
indicator wall to do to you know kind of
how how Facebook or Twitter does it so
help us with that we're going to use the
activity indicator from react so what
this wheel will do is this this guy's
component we're gonna grab from react
and it just as it does it's just a
little loading center and then there's a
footer that we can actually do for our
list list footer component so I'm going
to copy this so this is the component
that is displayed at the bottom of our
list so it's about my list I want to
show an indicator only if we're loading
though right I don't want to show it all
the time so let's take this component
and for now I'm just going to say active
is ii-in decay or and then import this
from me
NATO's so activity indicator and then
come back down here and I want to say
animated I think that was the prop I
need animating I needed to the prop to
true and sighs the default small I think
that's fine we'll see we can always make
it large if we need to but we need to
make this animating okay now we're not
we're not showing it just unload a cam
prime variable activity indicator
activity indicator we're loading it here
Oh active
just misspelled it and we get stacktrace
what's going on there
something did it crash I don't know if
it crashed out no I think crash we're
fine
check it out guys at the bottom here we
now we see that little loading indicator
actually is super small I'm going to
make the size of it bigger so size large
all right now I'll come back over here
so now when we reach the bottom of the
list you can see it loads actually
that's pretty good right I don't even
need to add anything else I was going to
say only show that when it's loading
like you could do no right here I could
say this dot state dot loading if it is
we return null else we return this but I
think it looked they probably looked
fine as is right I think it's actually
probably a little snappier huh I mean it
looks pretty snappy right now that's
pretty good now let's see it without the
loading I'll see how snappy is yeah
actually this looks just as good I think
it looks like it's load
a little bit longer see how long it took
for that one to load look how long this
takes the load but if I but if I do this
this dot state loading and then null it
makes the appearance it loads faster
what couple of fast got loaded right
like that's really fast loading right
there so you might not need to do even
worry about loading in your state if you
don't want to but it made it look like
it loads a little bit faster so just the
way it renders so kind of interesting
but that is it for this video guys I
think I'm going to go ahead and keep
loading in here but yeah we have a list
now we're in it and we're infinitely
scrolling through I want to do a couple
more videos on this one I want to show
you guys how to actually implement your
own back-end to use pagination because
we're just using this API that has it
but I'm sure a lot of you guys have your
own servers you want to hook this up
with and so you're gonna have to create
the backend so I'll show you how you can
do pagination with sequel and then also
I want to show you how to do this with
graph QL 2 so a lot of cool interesting
video is going to be coming up with
infinite scrolling with that stuff
pagination loading stuff on the fly so
that's it for this video guys thanks for
watching and I'll see you guys in the
next one
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>