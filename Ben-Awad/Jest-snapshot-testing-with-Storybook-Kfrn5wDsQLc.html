<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Jest snapshot testing with Storybook | Coder Coacher - Coaching Coders</title><meta content="Jest snapshot testing with Storybook - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Jest snapshot testing with Storybook</b></h2><h5 class="post__date">2018-04-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Kfrn5wDsQLc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so I got a request to go over
how to set up story shots with
typescript and story book and I was able
to get it pretty much set up okay just
following this guide that they have on
story book but what I'm gonna do is show
you how it works and then how I have my
story book set up with typescript
because I've changed it up a little bit
and that what might be causing people
trouble when they try to get this to
work so first off if you don't know what
story shots is it's an integration with
Jeff snapshot testing that's what they
talk about here so you can go check that
out if you want to see what snapshot
testing is it's pretty nifty but it
basically gives you free testing for
that you don't have to add any other
code it'll automatically do it so it's
really fast integration so let's look at
how you do this so first I just
installed a library using this next I
had to add this story shots that test
that J's file and let's go see how I did
that so I wasn't exactly sure where to
put it but I have a folder called UI in
this little example that I have inside
of that one of my components is button
and basically UI has all of my stuff for
testing or not testing all my components
that I want to have stories for so I
just put it in there and the only other
difference is I changed it to dot TS
because it's a typescript file and the
reason is because my whole project is a
typescript so it's gonna be looking for
typescript tests okay it has a little
little ts1 thing in here but it runs
okay without it so I don't even worry
about touching this so the next thing I
do is I just do yarn tests and it'll
just go ahead and run and test it so the
first time we run this it will create
the snapshots so it's gonna create a
little folder here called underscore
underscore snapshots I'm going to see
that run and cool and now what I can do
is I can now change my button for
example I can make
pink and save that it's gonna read
around the tests it's gonna be like hey
you changed something and it'll tell us
what exactly change and what's the
difference
now unfortunately this only checks the
HTML so at least I guess the default I
don't know if there's a version that
also checks the CSS but with emotion all
it does is it changes the class name so
notice the only difference we see is the
class names are different and these two
when we change the color of pink but
you'll notice there's actually two
stories that were affected this one and
this one so if we come over here here
are the two stories and it makes sense
because we are rendering two buttons
we've changed the color so both of these
should be affected and they are so we
can see that right here now the other
thing is to get this to work I had to
originally I was using this syntax for
reactive motion and if you run that it
will see it's not gonna like it at all
and it's gonna be like please use the
babble plug-in so I wasn't sure how to
get the babble plug-in working at least
with my current setup so I just went
ahead and changed it over here and you
might not even be using error reactive
ocean so you might not even have to
worry about this at all it might just
work
out of the gate the other thing is let's
say you want to update your tests so
I've changed this to maybe blue and I
want blue to be the new normal so or
basically snapshot it with blue so it
I'm like alright that's fine that these
things are different if you at the
bottom it says push W for more and then
you run press Q to update it'll go ahead
and update and now blue is the new
normal okay so that is pretty much all
there is the story shots and that lets
go over what my current setup looks like
for a storybook with typescript because
I changed two things the first is I kind
of started using babel to basically
compile a typescript or transform it to
JavaScript so you'll notice I'm using
some different plugins here
and then also some different presets
particularly the weird one is this one
right there to convert it to typescript
I was basically just having trouble
converting it with the TS linter for
whatever reason getting that to work
with the emotion plug-in was difficult
because I run the emotion plug-in to run
and then compile it to typescript or I
mean the opposite
my typescript code converted to
JavaScript and then have Babel run on it
or something like that and it just
wasn't working too well so I just went
ahead and tried getting Babel to do the
whole thing and that seems to be working
better so you can actually add a special
dot Babel are see inside the storybook
directory so that's what I did and the
other thing is I changed the web pack
config and this is what it looks like
I'm just testing for typescript files
and it's pretty much pretty similar
another big one is I'm transpiling only
it's true
this means it's not gonna check for
types and yeah so I'm still using the
typescript loader I can't remember if
this is necessary or not I made some of
these changes a while ago but the code
does work
I remember twiddling with this for quite
a bit trying to get this typescript and
react motion and storybook all to play
together nicely it is not the easiest
thing but this does work I'm gonna go
ahead and push this code on github so
you could check it out and use it if you
want to get the same setup for your
project if you'd like to use these three
libraries so yep that's it for this
video guys
thanks for watching
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>