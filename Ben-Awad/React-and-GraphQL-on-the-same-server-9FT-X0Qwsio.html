<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React and GraphQL on the same server | Coder Coacher - Coaching Coders</title><meta content="React and GraphQL on the same server - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React and GraphQL on the same server</b></h2><h5 class="post__date">2017-07-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9FT-X0Qwsio" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so I want to show you how you
can bundle your react application with
an express server even if you're using
grass cue well it works just fine and
that we only have to be running one
server and now what I'm going to show
you with is with the this project and
with this server they're both on my
github if you'd like to cone them and
follow along and for those of these just
go to the last branch so for this one
I'll put a link in description below too
so these are the two branches I'm going
to go off of starting the video and
we're just going to be using Express
serve static file so let's get started
so first I have my react application up
here and we are using react Apollo in
this and react Apollo you specify where
your graph QL server is now that we're
going to be combining them into one will
be one graph QL server and we're going
to be sitting on top of it so we just do
slash graph QL so in the index folder
and that's it that's all I'm going to do
for our server or not our server for a
react application so I'm just going to
go ahead and close it and come back over
here to the command line because I have
this project open and I'm just going to
do NPM run build because this is a
create react application it will create
these static files that we need so then
what I can do this is my Express
application Express tells us that we can
just do this so AB dot Youth Express dot
static and then specify the folder so
it's important that you do this after
where your graph QL endpoint is and if
you have a graph graphical endpoint as
well here's mine make sure you do under
both of those so I'm going to do mine
right here on it's okay to do it before
your subscription server if you have one
so we're just going to be using this
this is whatever folder you want to call
it I'm gonna call mine public that's
fine
or we could call build because that's
what this thing is going to be called
when that gets out put whatever you want
to call your static files I'll call mine
public let's come to standard and we
actually need to do it again and just do
a star here and the reason for that is
this is going to be this is like a
catch-all right here so that way we can
handle everything in our client side
whereas here we want to load the files
it's important that this star is after
this one because here we're going to
load each route if the route doesn't
exist it's then going to be caught by
this star and that's when our index page
is going to be run and it can handle
everything so make sure you in this
order so everything works properly and
if we come over here cool our build
folder is done we clear this we can do
an LS we can notice we have a build
folder now if I do an LS on build I can
see I have some index about HTML and I
can just tree this file tree is also
something I think I got that off of NPM
just a little package that prints out
all the subdirectory so we can see all
the subdirectories here and you can see
static CSS JavaScript this is all what's
got so we need to grab this folder so
I'm going to hop on over here this is my
server folder to switch tab I'm going to
copy that build folder into this one so
it's up and then it's called build and
then I'm going to rename it public so
now to do LS I to the public just to
show you guys entry public it's the same
got the same files so now if I do NPM
start here we can see our application
boot up so cool no errors and if I come
over here I can go to localhost 3000
slash login and click something didn't
work unexpected token this this happened
to me before
it just happens to you it's because your
browser is cache
things and messing stuff up so you can
just copy this URL and open it up in an
incognito browser and you can paste it
in you can see it does work
the reason for this is I basically have
done a lot of react development on this
and this route it's just like caching
some data maybe if I went over here and
deleted some maybe it's a cookie maybe
it's cache storage something that's
getting cached and nesting it out if I
got rid of that maybe it would work but
it does work and go to this and it you
might not even get that error that I got
but if you do that's how you get you
just go to this and after a while that
will go away and you'll notice if I push
to log in it'll actually go to graph QL
and it'll say hey Melvin and Olive login
so it's actually connecting to graph QL
so end rot 3000 right that's what our
server is running at here and so you saw
me just do MTN start now we have graph
kyo and react serving from the same
server so it's pretty cool now I'm going
to put this code up on github and I'm
going to also good to note you see this
is we keep track of how many changes
then I need to make sure to update my
get ignore and do that over there but we
can now say build actually public
because public is getting created we
don't want all the build files to show
and github they're unnecessary but yeah
so all right why should i guess since
we're now and we're showing a static you
know I'll keep it I'm going to keep the
public folders the way you guys could
download this project and just use it
right away if you wanted to so it will
have the login stuff so cool
also good to note if you make changes in
your front-end you're gonna have to
rebuild the project if you wanted to see
it what how can I do it where I split up
into I have like the server and I run
that on one port and the client on
another port I like doing that until you
I would move it over when you go into
production if you wanted to combine them
because you don't even have to combine
them for production if you don't want to
that is it for this video guys thanks
for watching codes on github links is in
the description below and I'll see in
the next
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>