<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Handling Errors on Sign up Screen - Part 3 | Coder Coacher - Coaching Coders</title><meta content="Handling Errors on Sign up Screen - Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Handling Errors on Sign up Screen - Part 3</b></h2><h5 class="post__date">2018-02-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4Y9chGxAqmc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys we're gonna be finishing up our
signup page today to do that we need to
handle some errors store a JWT token
somewhere so when the user comes back to
our app we know who they are and then
also look into changing screens once the
user creates an account so first off how
do I know that we could get some errors
well if we look at our database model
over here in the user we have a unique
little attribute that we add on to email
so if someone signed up with email twice
we're gonna get an error right so if two
people sign up with the same email so
let's console.log what that error looks
like when we do this so here's what my
terminal looks like and there's also
something a little annoying that's
happening right now so when I type my
name out so Bob for example and just how
it auto capitalizes so we don't really
want to auto capitalize emails or names
we want to let them capitalize it how
they want to maybe name you can auto
capitalize but for this I'm just gonna
turn it off and turn off you just say
auto capitalized none and also for the
password we definitely don't I'm
thinking because we said secure text
entry that it was already not
capitalizing but now we should
definitely not be capitalizing anything
okay and then when this is done we're
going to just see if we can get air so
Bob Bob at Bob calm Bob all right so
let's create the account once and I
don't even see accounts the log here of
the response coming back okay we do so
we get undefined a unique constraint
would be violated on user detailed field
name is equal to email so here's our air
that we got I'm thinking we don't have
any other errors that we're going to get
so I think it's safe
say when we catch an error here we can
just say no that the email is what's the
problem otherwise we might need to parse
this error in some way right so like do
air dot includes and look for unique
constraint or something and then the
word email but I'm not gonna worry about
that I'm just gonna say I if we catch an
air we know this user is already taken
okay so what are we gonna do in that
case well we have this errors thing in
our state up there so I'm just gonna say
this dot set state and we're gonna
update this state with a new air and I
want to keep all the current areas well
actually no I don't I want to reset it
so air is inside here so what is the
field that the air is for it's for email
and all I'm gonna say already taken so
how do we display this and it just
doesn't like it because we're not
currently using airs so how do i display
this message so I'm just gonna have it a
text that pops up underneath email or
maybe on top of email and now I'm just
gonna say errors dot email
and now I want to conditionally render
this because they don't only want to
render it whenever there's an heir so at
the front here we're gonna say heirs
email and we're gonna do a ternary
operator if we have one we're gonna
render it otherwise we enter in their
null you could also do an and sign right
here which is what we're gonna do
so we're saying we want this and this
and we have some errors right now we
need to import text and D structure
heirs so let's get errors from there and
at the top
let's get text all right all right so
here we're gonna say Bob again and I
don't think there should be a problem
with the name field because that didn't
look like there's a unique constraint
all right so it says already taken now
it doesn't really look like an error
message so let's make this read as well
so color or say red so Bob Bob Bob calm
Bob already taken all right I'm just
gonna come over here and change this to
Bob to create a count and nice it went
through now we notice we're not cleaning
this form so let's do that and to clear
the form all I'm gonna do is I'm gonna
say Const default state and we just want
to go back to what the default state is
so now I'm gonna have this state be
equal to default state and then down
here when we're using this so we just
finished assuming we didn't get any
errors here so let's say is submitting
is false to and we're going to return so
if we get any error we're going to say
we're done submitting and here are the
errors and then we're going to return
out otherwise so if we make it down here
we know we didn't get any errors because
we would have returned so we're good so
here I just want to
we're console logging the response and
then I'm just gonna set the state to the
default state so now we should clear the
form whenever we finish with that next
thing we want to do is actually store
this token somewhere so we notice we
need to get the data and then sign up
and then token so response data dot sign
up token so this is the string with our
token in it and we want to store this
someplace where it persists so when we
close the app and come back it's still
there and the way you do that is with
something called a sink storage this is
how you do it in react native it's very
similar to how local storage works on
the web and all we're gonna do is set an
item and get items with it and notice
how they have a weight out front that is
because you need to await it because it
is an asynchronous function so this is
something that comes from react native
so async storage in here we're just
gonna say async storage set item so we
gotta give it a name
and they do a little decorator out in
front we can do the same e-commerce and
I'm gonna say token so this is us
setting the token that we got and then
clearing the state
so let's sign up with another user and
see whether this is cleared so I'm gonna
save Bob Bob at Bob calm Bob so we
should get our air good and now I'm
gonna say this is Bob 3 create account
and we're not actually console logging
this so we shouldn't see anything here
but it did indeed clear and the token
should be set so perfect that's what we
wanted to do and this is pretty much all
we want to do on the create account page
so the next thing is I want to just push
to the next screen so we have this token
already given to us so we don't really
need to login after this we just need to
go to basically a home page or like
products so I'm gonna create a route
called products and products dot J s is
what we should call it in here I'm just
going to import react from react and we
can actually just copy what our login
page has because we don't need to fill
it out right now
oops
and I wanted to just add this to our
route over here
so products and yeah let's add an S to
that because it's just gonna be a list
of you products create a new route for
it so I'd like to change this page
whenever I have accepted sign up so we
know if we make it here we had a good
sign up and by the way we should await
this so we wait for it to finish and
then we update and then right here I'm
just gonna say this stop crops the
history so history is coming from react
router they give you this object in your
props and the reason why we have that
enter props is because the sign up
component is a route right so then we
call the push function and you specify
what route you want to go to so for us
we want to go to slash products and I
need to make sure I lowercase to that
and I didn't sow products like that so
now we should go over there and we
should really say here whether you might
want to also go to the login page from
here so we should just have a little
something full text that says for
and you have at the bottom here login
and then our on press will be this dot
go to login page so go to login page and
we're gonna just gonna that's not how
you do that and we're just gonna call
the history function here and go to
slash login and whore is not centered
let's just text the line and I think
text-align:center okay so if we click
login will be taken to login page now
and we can refresh come back here and if
we click create account when we fill out
this information we should be taken back
to the products page but before we test
out and make sure create account works
I want to refactor text input because
right now we're creating a function on
every render notice how we have that
that and that
this little lambda guy where you see the
arrow you're creating a function so what
I want to do is move them into their own
class to avoid doing this so I'm just
gonna do it above here it might get mad
at me that I'm creating a class and two
classes inside of one but I'm just gonna
ignore it and extends react component so
what we're gonna do is move all of our
logic into the render function up here
this will also reduce some of the code
that were repeating
and then we're gonna have an on change
text function here as well all right so
this guy we're still gonna call and use
but we're gonna be doing it from that
other function so we're gonna copy him
and move him up here and now we're just
gonna call text fields down here and the
only thing I really need to give text
field is what is the name of this field
well the name is name and whether it has
a secure text entry and we're gonna just
set the default as false but I can copy
this paste it here paste it here twice
so we don't need him and we don't need
him so let's go got a save we're gonna
get a ton of read and that is because we
have multiple guys here so I'm just
gonna copy this and ignore the CS Lent
warning isn't disabled and we're just
going to do this for the whole file
okay so we're gonna come back down here
so we're gonna have name we're gonna
have email and we're gonna have password
and this guy is gonna be a secure text
entry and these guys also need on change
text which is gonna be this lot on
change text and we can copy this and use
them here and use them here all right so
now up here in this guy what we're going
to do is we know the name of the field
from our props and everything else stays
the same so we're gonna get secure text
entry also secure text entry is equal to
and we're gonna make sure this is a
boolean value so this stop props dot
secure text entry so the bank signing
double bang sign out front casts this to
a boolean and this should be props and
so when we pass it and as true this will
be true and then the value here we can
actually just pass in from our props as
well I think so this stock drops that
value and honestly I should be just
destructuring this because we have a
couple different things from our props
now so we're going to get the value
secure text entry and then our on change
text now it's just going to be this dot
on change text so now we're no longer
creating a new function which was the
goal of doing this so our placeholder is
gonna be whatever the name is so name so
let's grab the name from the props as
well make sure we do with comma and
we're getting this from this stop
promise so we don't need to do this dot
props me more there or here
and we don't want to capitalize any of
them so we're gonna keep that static the
style is gonna stay the same and cool so
that's good so down here let's pass in
the value as well oops so value is gonna
be name value is gonna be email and
value here is gonna be password makes
sense we're just plugging in from before
what we had and then what do we do in
this guy right here well we just called
just thought props dot on change text
and we pass it the two values it needs
well what are the two values and needs
well first the name which we get from
the props and again we might as well
deconstruct this because we were
grabbing multiple values we don't need
value or that but we need on change text
the name and then notice how we're gonna
get the text from this guy so text so
we're gonna call on change text past the
name past the new text so we're getting
the text from the same place text input
but now instead of creating new function
to pass in the name we get the name from
the props so let's make sure this still
works Bob Bob at Bob calm Bob should get
us an air perfect so now I'm going to be
Bob three
and I already made Bob three so good
thing we still saw that Bob four and it
takes us to hello to our products and it
looks like it created it so perfect so
we've refactored our text field now
which is gonna be better because it's
not going to rerender every time because
of that function call and this might be
a case where we make this into a pure
component to get even more render I
actually think we're going to turn this
let's turn this into react up here
component we can do a little test here
so also dot log rendering and then the
name so we can see when we're rendering
the text field
so here's email name email so when I
type name we are rendering all of them
so this is what we wanted to avoid
before so now if we turn this guy into a
pure function oops
you should avoid that so a pure
component now we're probably over
optimizing this because it doesn't
really matter there's only three fields
here but this gives you an idea nice
only the name field is now re-rendering
which is perfect exactly what we want it
this gives you an idea of a place we're
using a pure component and actually can
improve how many times we're rendering
something all right so that's all for
this video guys I think what we'll do
next is work on the login page and then
go from there that's it thanks for
watching
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>