<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to handle cookies in GraphQL | Coder Coacher - Coaching Coders</title><meta content="How to handle cookies in GraphQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to handle cookies in GraphQL</b></h2><h5 class="post__date">2018-04-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ay1kKni4Rkk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so in the last video I showed
you how to set cookies and now I want to
show you how to handle these cookies
that are now gonna be sent to your
server after the requests happen so to
do this I am using a library called
cookie parser and if we scroll down to
the bottom I'm using cookie parser where
I create my graph QL server so this is
Express middleware that will run on
every single request
so cookies will be automatically sent
with every graphic you'll request that
is sent to the server and so what's
gonna happen is if they're on the graph
QL endpoint its first gonna parse the
body of the request then it's gonna grab
the cookies and what that does is
actually puts it in the request object
called dot cookies and then we can
access any of them from there now you'll
notice right here I have just like a
little function this is basically my own
custom middleware and if you followed me
before seen any of my other dedication
videos this is how I like to do it or
I've done in the past where I will look
at the request and that's where we're
going to get the cookie from so thanks
to cookie parser we can say rec cookies
tidy and this will give us the value of
the cookie ID and that's gonna be a JWT
token so what I'm doing here is just
verifying that it is good checking the
secret and then I get that user ID that
I stored previously and now you'll
notice I put this in a try-catch just in
case we err out or whatever and then I'm
sitting on the request object a new
property called dot user ID and the
reason I do that is now in my context
down here I can use the request and add
the user ID that we passed in this
nowhere up here into my context so now
all of my graph fuel resolvers will have
this user ID that they get from the
cookie
in the JWT token which is really nice
and that's pretty much what you can use
for all authentication I can fetch the
user at this point I can check what
credentials they have all that stuff and
then the only other thing that's kind of
interesting here is you'll see I noticed
I'm using typescript so I put any for
these the reason for that is this
doesn't have a user ID object so this is
a express request object and it does not
have the property user ID so when I'm
setting it here tells me unknown type so
instead of just dealing with the types I
just do any and make it simple in these
cases pretty much from using typescript
whenever I have a case where it just is
kind of annoying to type I'll just put
any and not worry about it so that's why
I did there but let's take a look an
example of how you might use the cookie
or the user ID now that's passed into
the context so I added a new query up
here called hello or off hello and what
it does is it just looks at your the
third parameter so context it grabs the
user ID it checks whether it's no lor
not so if we get a good one I say hey we
got your cookie and then we send back
your ID otherwise we say hey sorry I
couldn't find your cookie so I made a
change to the react application I had
before so now I have this new page I can
go to and it just renders the response
of that query so we can see so for
example right now I don't have any token
or any cookie
so if I click to go to this page it says
could not find your cookie so I request
from the server doesn't find it and so
we just send that back and I'm just
gonna refresh and now if I type anything
over here I hit submit now creates a new
ID new user for me and now if I go to
that page it says hey we found a cookie
for you and your ID is 51 so that is how
cookies work and how you can use
with graft kilo and now notice with this
you can do pretty much extend this I
like to add some basically kind of like
some graph qo middleware to handle
authentication for me I'm gonna be I
changed up how I've done that a little
bit I used to do like a higher-order
permissions thing but I'm gonna be doing
some more videos about how I like to
handle middleware with these resolvers
and then also I currently do not set the
token or I don't really use JWT tokens
with cookies anymore I'm just using
sessions so tomorrow I'll be showing you
how to use the express session session
library which is currently what I'm
using this is it for this video guys
thanks for watching
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>