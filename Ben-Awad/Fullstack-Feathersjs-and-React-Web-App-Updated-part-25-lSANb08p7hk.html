<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Fullstack Feathersjs and React Web App Updated - part 25 | Coder Coacher - Coaching Coders</title><meta content="Fullstack Feathersjs and React Web App Updated - part 25 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Fullstack Feathersjs and React Web App Updated - part 25</b></h2><h5 class="post__date">2017-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lSANb08p7hk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys welcome back so I found
that our problem here that was not
laying us to fetch so if I like refresh
and I try to fetch for this URL we're
having a problem where we were not being
able to find anything and if I go over
to the code for that it'll be in single
recipe we were trying to a query like
this right and we were looking for the
ID so I was wondering why the heck this
wasn't working and so I was going into
the database and I realized take a look
at this the ID value is actually an
object it's called object ID it looks
like that I notice how name is just a
string but this is an object and so
that's why it wasn't working because we
can't compare against objects here and
I'm not actually sure how to like create
my object ID I was looking at the
feathers Mongo thing and they have this
thing called objectify ID if I go to it
right here it basically creates a new
object ID that's something they get from
Mongo DB and that's how they actually do
the query so unless we wanted to create
like our own little hook to do this for
us um looking in the find it never
actually does that for us
but notice how I get so I do a get
request it actually does objectify the
ID but it doesn't do that for fine so
find it's not working so like the way
I'm going to do it is in our hook what
we're going to do is we're actually just
going to make um owner ID a string so
basically instead of using the pre-made
hook we're gonna make our own hook and
make idea string or sorry not owner ID
well we'll get to that problem soon
actually of messing with the database so
to make this not an object the first
thing to fix the problem is we actually
don't even need to use a find here
because we're only looking for one
object what we can actually do is do a
get because get works instead of doing
this request recipe ID I'll just pass in
the ID stop drops match grams dot recipe
like that and now in our sagas we can
fix that and also I wanted to address
this is ADD recipe here we're doing
fetch recipe done we don't need that I
don't know why I was there so we can
just remove that this is good though
okay so fetch fetch recipe I believe it
was called fetch recent recipe what was
the function called request recipe so
look listening for request recipe Thank
You Rory now listening for it or what
was calling that so request recipe
request recipe was recess be fetch
requested recipe fetch requested which
then calls this which calls fine recipe
now instead what we want to do to call
get recipe so we're going to create a
new function called get recipe and now
we're just going to have a single recipe
so we can actually change our reducer
here and it's actually going to look
just like my recipe fetch done but I'm
just going to return the payload there
because it's no longer going to be an
array okay and then our API is very easy
to change
we copy find recipe because create
recipe is basically the same thing
create recipe sorry now create get
recipe and then you just do a get there
and now we're returning objects so we
student object like that so now if we
refresh
let's you happen so return undefined to
ignore so are we getting undefined from
this oh no because I we don't have to do
dot data anymore right yeah
fetch recent outfit recent recipes is
fine called fetch recipe recipe data now
just the recipe and they're real so the
recipe showed up there was there
supposed to be an image here I forget if
the image is supposed to show up let's
good react but probably is probably the
same problem I had before so single
recipe view and we just do or case lower
case now that refresh and there we go
so our recipe now renders here so what I
was talking about earlier though about
fixing this problem that's going to come
up when we actually for example login so
I log in and oh I guess we should
address this problem first when I login
notice how we're not like adding the
user here that's a very easy change if
we go to our user saga request ah we
just need to call request off request
off so after we log in try login login
succeeded then we're going to yield put
request off and request off what that
will do is that will just should the
real space between footnote that's
function what requests auth is going to
do there is it just going to then go and
get the token verify the token and get
user that we want so now if I log in now
we see po up there cool so now I click
on Bob I should see all my profile
recipes on which we don't so if I go
into my recipes that is how what we what
we would like to do is something like
this oops
so do a query so our syntax is right
here so this page we want to get all the
recipes that we made so the syntax is
right for this but because the owner ID
is an object we won't actually find any
so whenever you fresh the page here no
record found for ID object not not sure
what tech app in there start props I use
there underscore ID object request my
recipe console dot log this table props
that user but I was not expecting this
to happen so I'm not sure what just
occurred
let's console log the user the user ID
should just be a string which it is and
then it looks like it's going to recipes
and it's passing an object in so let's
let's see what requests my recipe is
doing because this looks correct so we
can close some of this stuff too so we
don't need home we don't need a recipe
so working with my recipes
to do with this saga here so fetch my
recipes so call my recipes right here
right here looks like it's just passing
and fine recipes here and that's just
calling API here
let's console
I'll log payload I guess so for some
reason the payload looks like it's an
object which it should be
haloed so this function should be called
on this page so I'm surprised that it's
not okay it's not being called
get recipe fine recipe saga so okay
fetch my recipe fetch requested so in
this thing we're calling the action
request my recipe and if I go to actions
here request request my recipe gets
recipe fetch requested so both of these
are going to the same action which is
wrong this one should be my recipe fetch
requested there we go so our action was
just going to the wrong place now still
gain air payload of undefined okay so
the action being passed in is undefined
so I assume IV saga my recipe fetch
requested call I'm assuming this is
undefined and that's what they're
talking about so I have no idea actually
what the heck is going on all this one
so we're calling we're calling this
function request my recipe which is an
action here request my recipe which
should trigger the my recipe fetch
requested my recipe fetcher requested
which is this guy which should then call
this and pass as a parameter but
obviously it's not so what we'll do is
here instead
oh haha weird the feathers app there and
the feathers app should not have been
there
okay so silly problems there all right
that looks good hope we even add
authorization query owner ID is equal to
the string okay so it's working as
expected now and we're just not getting
anything here my recipes that map is not
a function so the reducer for my recipes
should return this my recipe fetch done
is what we should call here my recipe
fetch done so my recipes I have no idea
what my recipes is equal to so let's
just go down the tree so this is going
to be profile authenticated connect so
we see the user here we should see my
recipes up my recipes data
there we are and are we printing it no
we're not
so let's console.log my recipes here so
we can see what's returned from our
query and what we should expect is an
empty array because like I was saying
earlier the object we're passing in a
string to check and the other thing is
an object so we see zero there cool
now that is working so what we're going
to do is we're going to do fixed stuff
on the database side so yeah here so
right now if I come into the database
and I look at the not the hooks but the
I think it was under services recipes
hooks this um associate current user
this is not dead load we want it to so
now what we're going to do is we can
actually get out of here do so we move
that hook instead we're going to add our
own hook so add our ID this will be a
before hook this will be for SP isn't
only when we create so now our Hulk here
add owner ID the first thing I'm going
to do is print out the object just so we
can see what it looks like so hook pram
params that user should print out the
user so I can start with the server now
and then I can come over here and I can
add a recipe and then we can see what's
getting printed okay
and looks like ID might be a string so
let's console.log just the ID and make
sure that it is a string and if it is we
can add it directly
so let's add another recipe and it looks
like a string to me so what I can do now
is I can say hook data dot owner ID is
equal to params params user dot
underscore ID and I'll just add it in so
now we can refresh so now when I add
this recipe should have a string for the
owner ID so you should see me in profile
page okay now if I come over here and we
do not see it so what I'll do is I'll
loops come over here to the database and
DB recipes dot find one and we need to
use upgraded menu monkey so we basically
just need to switch the database first
now I can do like for example find one
let's do find all I believe nope is it
just all now I forget what the commanded
here we go where you want to follow just
find oh wow this is a lot of junk so
this would be the last one that's added
I believe and looks like it's not a
string so what I'll do is we can just
force it into a string like this
it looked like a string when we
console.log fit so now when I add a
recipe definitely see me I definitely
spelled out wrong
okay submit and cool now we see it here
so notice how we just had to force like
making this into a string so now I can
remove that and now our server is good
it adds the ID just as a string so now
we can just let that run forever we
don't need this anymore so now we can do
what we were doing right here where we
were basically checking the user ID if
you're familiar with feathers and
MongoDB and you know how to do this the
correct way please let me know if you
know how to like make a query because
really what we'd like to do is something
like this new object ID and not keep it
as a string in the database but I'm not
sure how to do this pass that at in a
URL pass an object like that or
telephotos to do that so if you're if
you do know how to do that please let me
know in the comments below because I
would love to know but for now we'll do
it like this it works and it's a decent
approach okay so that's it for this
video we now can see our recipes and the
profile page these recipes we won't be
able to see the ones we made before but
all new recipes made from now on you
should be able to see in your profile
page and if we click on them we should
be able to see them here no matter what
because we use the gate command okay so
now we have all that and that's it for
this video and I'll see you guys in the
next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>