<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Feathersjs 1 to N Relationship with PostgreSQL | Coder Coacher - Coaching Coders</title><meta content="Feathersjs 1 to N Relationship with PostgreSQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Feathersjs 1 to N Relationship with PostgreSQL</b></h2><h5 class="post__date">2017-03-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yO__Aev3TeE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys in this tutorial I'm
gonna show you how to set up a 1 to n
relationship or also known as
one-to-many so the first thing I want to
show you is I have and this is going to
be in feathers gsi have feathers GIS
server setup and right now I'm just in
the index folder of the services folder
right here and as you can see I changed
a little bit here at the very bottom
what you want to do is you want to add
the first thing you want to do is when
you're wanting to set up a relationship
among different models that you have in
your for services like for example I
created two services to-do lists and
to-do item and what I'd like to do is
set up a relationship between the two of
them where a to-do list contains
multiple to-do items now right now it's
not going to be a mini to many
relationship we're assuming that a to-do
item can only related to one to-do list
and then the user service comes by
default so these are the two services I
created and what we're doing here is
we're just going through basically every
object model that we created and then
associating it if there is any
associations and so we just need to add
the associations to the to-do item
models ok so the first thing is going
into the user model and you need to just
get rid of the sync so there should be a
little function that's called between
these two where sequel I syncs should be
like user dot sync and we do not need
this because notice how we sync after
the associations are added it won't work
if you try adding the associate if you
sink before adding these associations so
make sure you do this and then sync so
let me go over to our to-do list
model you can see I remove the sync on
this as well I just have one attribute
for it called name and you'll notice
this is a difference under freeze table
names I create a new property called
class methods and then under here I have
a function called associate
and it passes in models these are all
the other models that you have so it
would pass into do item and user and
allows you to basically set up
relationships in here okay it's the
ratio when I set up is a 1 to M
relationship or 1 to M and then this is
a also known as a also known as
one-to-many and so what it does is you
first say you grab the to do list right
here that's what the the object model
and you're gonna say has many and then
you're gonna say what model you want
relate it to and so you do the models
variable and you view dot and then you
say which model and notice how I have
just add an S on the in there that's
important that you want a plural form of
your model and then lastly I set up I
named the foreign key so this all this
is doing here and this is an object I
pass in is it's gonna create an ID
attribute and the to-do item model and
it's going to be called to-do list ID
and it's basically going to be a foreign
key as the name implies to this model
right here okay so our to-do list small
set up and then I'll just show you my
to-do item model there's actually
nothing in here it just is empty and
you'll notice I remove the sink as well
and also notice I can do as many as I
want of these like I could relate this
to user if I wanted to
so users and I could do different one
and say like users ID and you want to
put basically all your associations in
here and then depending on which way
your association goes you would put the
association in that so for example if to
do items for some reason has many of
something you would then put that in the
to-do item model so depending on what
the relationship to the model is that's
how you know where to put this
association in okay so we basically soap
the association and now
are good to go but there's one extra
thing I like to add which is a hook for
my to-do list and the reason I asked
added the hook here is because I have
this association in the to-do list model
now if we go to this hook all it does is
this thing right here and it's setting a
parameter called sequel ice for the hook
and all it's doing is it's passing an
object and it's doing include all that's
kind of like boilerplate code the
important part is what's right here
services dot to-do items so what this is
saying is this is adding to-do items to
the model and/or to the create function
because this was a create let me show
you show you the hooks so whenever I
create a to-do list I basically call
this add relationship hook and what it
does is it sets it up and it basically
just tells to-do lists that to-do items
exists now this will all I'll show you
exactly what this is giving you in a
second it'll make more sense when we hop
over to postman okay so this is
basically the normal way that you could
create a list and a to-do list item and
this assumes so you can do this without
adding this hook so if this hook wasn't
here you'd be able to do this first step
so you'd be able to create a to-do list
so I created one it has an ID of six and
then we can then come over here to do
items I'm going to post it to do items
and let's say I want to add an item to
the to-do list six that we just created
I'm gonna pass the ID of the to let
someone add it in and we're gonna create
that item and I could create a couple if
I wanted to and you can see that IDs are
incrementing do laundry again you can as
many as you want
and that'll fill up your to-do list but
another way you can do it is what this
allows so to do this new method that I'm
about to show you you have to have this
create hook set up so when you go over
to to do this what you can do is instead
of just saying the name you can also
supply the to-do items and then just
pass in the text
that you want there the attributes that
you want now notice I'm not passing in
the to-do list ID for these to-do items
they automatically associate to this
grocery list for me but you to be able
to do this you have to add that the
create hook that I just showed you okay
so now when you run this what's gonna
happen is not only is it gonna create a
grocery list but it's also gonna create
these three to-do items and then
associate it to the grocery list so I'm
like when I go ahead and run this you'll
see I have a grocery list and I get to
do items and you can see right here the
items created and that are though those
are the ways that you can set up
one-to-many relationships and then
actually create them and now this is set
up in your database and you can query
these and do whatever you like with them
so I hope that helps you guys and note I
just did this for create what you can do
is you can actually add this hook to all
and what that I'll do for you is I'm
just gonna restart the server when you
do it and you add to all what allow you
to do is when I for example get
localhost to do with what looks like it
didn't turn on see what's probable oh no
did it's supposed to be 30 30 okay
notice how it grabs to do items here
because now when we do a get request
it'll get these to-do items for you you
can see this is where the the lists that
we made and we're getting all of them
but for example if I remove this I'd
only had this on create restart the
server then when I do this get requests
you won't see these to-do items you'll
only see the name of the lists
because that's like an extra fetch so it
doesn't do it by default and you'll see
it doesn't get the to do items so you
need to set up this relationship right
here if you want to basically see the
to-do items and the to-do lists together
but you can call them separately if you
want to okay guys that's it for
one-to-many relationships I hope that
helps if you have any questions please
leave a comment below and I'd be happy
to help you guys out and I'll see you in
the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>