<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Fullstack Feathersjs and React Web App - part 4 | Coder Coacher - Coaching Coders</title><meta content="Fullstack Feathersjs and React Web App - part 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Fullstack Feathersjs and React Web App - part 4</b></h2><h5 class="post__date">2016-11-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gFr7ynd2eTw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome back I'm gonna be
showing you how to programmatically
through the feathers API and client
application to create a recipe so we
would like to create a recipe form for
our client so we can address pieces of
server without using postman so for in
our client folder
we're gonna go to source we're not a new
component and recipe j/s so this is
going to be our form now in the form
we're just going to import our usual
stuff for react components
from react
and then we're gonna be using a button
form and a message from semantic UI and
we're also going to use browser history
actually no we're not we're gonna use
the browser history and saga instead so
close care class add recipe extends
component
and super props
this state so we basically want to
create a state that our form this is
kind of like a local state we could also
put this in redux but and create actions
but it's a lot more boilerplate and this
is only needed in this particular so
it's easier to just set up just a local
state for it to kind of keep the form so
we're gonna have the name of the recipe
we're gonna have ingredients dance which
we're gonna take in as a string and then
turn into an array and in the
description is also
and we also want an image but we're
gonna not we're not going to keep that
and the we're not gonna give it a
default value in the state oh you know
what I didn't make the constructor my
bad guys so constructor props and just
put that inside there
area
okay so this is our constructor
sure this is all lined up cool so we're
just setting a default state in there
and let's make sure this is lined up
good all right awesome so the next thing
you want to do is store under function
so like I said we're gonna be using a
form and then when we submit we'll
handle that so we'll create a handle
submit function and then we won't worry
about errors for now but there's a way
to in a form show red lines and stuff if
you get errors so create a label just be
name and then we'll all get an input
and the value is gonna be this dot state
dot name and then on change set the name
also to name it on change we're going to
just create a function one that
functions gonna do is every time on
change is called when someone inputs a
character into the input box so when
they do that we just want to update the
state so this dot set state and we just
want to add update name with whatever
they just typed in which is e target dot
value we can set up placeholder H just
say recipe name
then we can just close it off we also
need to wrap this in a form field
and then we're gonna do the same for
create an image
a description and ingredients so the
next one is going to be recipe image and
we're going to do a different type of
input we're not going to use value let
me just set the type equal to and upload
excuse me not an upload a file so that
way we get instead of a text box we get
a little thing where you can upload so
and then we're gonna call this
ingredients and then we we can't just
update the state like this we're gonna
create actually a function that will
handle that so the grade off will create
a function called handle image change in
a second and we gave her the placeholder
okay no ingredients
let me just say put one per line and who
can split per line to break it up into
an array then the value is now gonna be
ingredients we also want to take the
name two ingredients and instead of name
ingredients and placeholder angry yet
okay last field description
so change that to description
description description and also
description
okay now if we create some dummy classes
or functions I mean the first being
handle image change and handle submit I
think we can go look at our form and see
what it looks like but first we need to
actually put this on the page right now
we're actually not rendering it in the
react router
we're just meet the component so let's
actually put this on its own page so
let's create a not creating anything
let's actually go into source and when
create the index page I'm just going to
add a route right here so instead of an
index or out so I'm just gonna be
regular route with the path let's say
recipes add and then the component it
will use it's gonna be an add recipe
component which we just created and we
need to import that
so
recipe
now if we refresh that and go to the
page oops made a little bit mistake if
we go back to our components and then we
go to add recipe that needs to be a
colon
okay now that refresh is compile is okay
now if we go to recipes to add look
looks like we're having a problem let's
double check what our area is so we
cannot invalid prop components applied
to route so if let's go to their route
make sure we set that one up okay so
yeah the component add recipe oh we
didn't free forgot to export add recipe
that's what it was
so if you go back to our ad recipe we
can export default address P now for E
fresh the page nice we can see our form
it looks like I forgot a submit button
so let's add that in there right now
let's put that the very bottom create
button
type equals submit
so
nice sri fresh the page
and now
type in recipe name
you can go search for an image very cool
oh and you know what these should not be
input fields I want these to be text
areas so let's put text area and same
for this guy as well now let's refresh
awesome so now like this can be carrots
tomatoes and so on they can create a 1
per line and what we'll do is when we do
in our on submit' we will actually
handle this text and split it by the
newline so we had submit nothing will
happen
Oh it'll happen but it won't do anything
it'll just refresh the page so let's
actually do stuff in our handle image
change and I'll handle submit so let's
start with the image so for that we're
just going to first prevent the default
behavior because we really want to do
our own thing we're gonna create a
reader okay okay get the file so files 0
and we also need to pass in here get the
first one and then we're just going to
read the file
and create a function and we're just
gonna set the state whenever they upload
the file so we're gonna get a file as
you go to file and then the image
preview URL
you could read your dot result
and then let's go ahead and read it so
read as data URL okay
so what's gonna happen is whenever they
upload an image it's gonna go read the
image and save it to the state so then
we have a preview URL which we can then
add to which we can use to pass into our
database or call the API I believe this
will be a base64 encoding of it of the
image so we'll see this a little bit
later in action but basically all you
need to know about this function is its
putting the image inside the state
now let's handle when we're getting when
we're submitting so let's first do a
little bit of cleanup so let's get the
recipe name from the state
and let's trim it to get rid of the
right whitespace excess and then let's
also go ahead and add the recipe so
we're don't have this function right now
but we're gonna add it into our actions
so remember how we had a I'll show you
real quick we had a recent recipes well
we're also going to have a so go to your
actions folder and your action creators
and we're gonna add a new action so
we're gonna create this add recipe one
recipe and it's gonna take couple
parameters for the name of the recipe
the description the ingredients and the
image URL
and it's gonna return these six so type
and name and description and ingredients
and it's your
and now we'll pass them in here name get
the state of the image Oh before I do
that
fill in the type of course add recipe
requested and what will be next making a
saga to actually pass this to the API so
we'll pass in the name description
ingredients an image URL to the API and
make an API call to our server so the
name and now we want to get the the
description so a description and then
the ingredients which will be this state
ingredients and now this is a string but
we'd like to have it an array for each
ingredient so we're gonna split by the
newline and then we're going to get the
image preview so this state that image
preview okay awesome so what's gonna
happen is when they click on the submit
button it will call this function
passing in the parameters that they had
in the form and that form will dispatch
this action right here now let's
actually do something and add this to
the server
in the backend but before we do that
actually let's prevent default because
we don't want the page to refresh okay
so we're done with that so we have our
action being dispatched we now want to
go to our Saga and actually make an API
call so if we open up for saugus we're
going to create a new set of these guys
so I'm gonna copy those paste that and
now we're going to add a recipe this one
it will be add recipe saga and then
we're also gonna fork it address P saga
and now instead of looking for recent
recipes we're looking for address opee
requested and this is the same name we
used in our action so requested and
instead we're going to call that recipe
and now our ad recipe is just going to
catch the response from a call that
we're going to make we're gonna call
address beat well actually let's call it
recreate recipe passing the feathers app
then we're going to also pass in all the
parameters so we're gonna also need the
action so action dot name action
description action dot ingredients and
action dot image
you're all okay so it passes all this to
a function called create recipe which we
need to add to our API so let's put that
down here so let's add a new one crate
recipe we're gonna have to go into their
next ink add this to services API I'm a
create recipe one and so we're just
gonna call that function passing in the
name description' ingredients and then
we're gonna look for the response and
once we get a response we'll send a add
actually for this one we don't even need
to dispatch another Eric thing we're
pretty much just done we're just going
to go ahead and after they've
successfully we're assuming it's gonna
be successful we are doing no error
checking right now but we should and we
should be doing error checking but we'll
have that in later so right now we're
just going to after they're done
submitting the form take them to the
home page so if we use this browser
history and we can push on to which
location we want to go the home which is
just an empty string okay awesome
so what's gonna happen it's going to
call the API and then whenever it's done
being called we're gonna go to the login
page and this create recipe is going to
handle adding it to the back end to the
database to our feathers server so let's
go ahead and add make this create recipe
function so it's gonna be in our
services API so we said export function
a recipe never give app I and then we we
don't need just the app because remember
we also are passing other parameters the
name the description ingredients and the
image URL so we're just going to make a
post request to the recipes first we're
going to do the same thing we did above
create a service two recipes
and then we're just gonna create one
and we want to actually return that all
right you know what we don't even need
to return this function doesn't what
we're turning this spots why don't we
actually print that out too so if you go
back to you the saga real quick let's
also just log console dot log the
response so we know what's happening so
we'll go ahead and return once we create
so create pass in the name description'
ingredients image URL and dot then and
then data air we're just gonna print out
the data and that's it okay so once are
once we make that action call in our
form
it's gonna call our saga and then our
saga is going to call this function
right here and this function is gonna
post to the server and it's gonna add
this database and then we're gonna go
back to the home page and we're gonna
see your recipe added so hopefully we
didn't miss any steps and this works
smoothly let's give it a test
so we're just going to refresh the page
get rid of that junk in the URL okay it
looks like there's no problem so far and
let's actually keep inspect opens and
preserve the log that way we can see the
response that we get so this is gonna be
a test recipe just add an image that I
have this little Teemo this is say
carrots up looks like we're getting a
set stay is undefined it's double check
looks like we might have messed
something up there so let's go back to
our components and then our that's an
ADD recipe so we did this Oh something I
forgot to mention is we have to give
both these functions the ability to use
this right now this is undefined because
these this is only defined in a
constructor and render and so it's not
defined in either of these two so we
have to add them so we say this handle
image change is equal to this to handle
an exchange dot bind to this and that
adds it to it and we also need you have
four handles submit
so adding these two lines right here
allows these two functions to have this
so saving that we can refresh the page
and we can try this again and when we
refresh so it cleans the log too okay so
a test recipe
oops Tenace recipe
now we can add the Teemo so be carrots
tomato onion cook everything in one pot
okay let's submit this we submit it and
it looks like we are getting an internal
error when we post this to recipes so
our entity is too large so now what's
happening is are we're sending a really
big image over to the server because
when we upload this image right here
it's too big for the server to handle so
it doesn't like that so all we have to
do is we need to go to our back-end and
update the configuration file and just
tell it we need oh we we want to allow
bigger files so if we go back to our
back-end and you go to the source and
then your app you just come down here
and right where you see body parser dot
JSON you're just gonna say limit 50
megabytes that's it restart the server
and now if we submit this and we need to
refresh because I open let's see like
that okay
so test recipe now what should happen is
it should accept our post requests just
okay now because it's able to handle the
big image so onion carrots tomato
description is
everything in one pot okay so let's
submit that and take a look our test
recipe is here now this is the response
it gave us so it just tells us stuff and
if we go to our react dev tool we can go
to the recipe list and we can see our
first recipe has an ID created add
description image URL ingredients and a
name and actually has an image URL that
will actually work so we can do is we
can go back to our component our recipe
card and add in the description and
image and we should see it show up for
this test recipe so if we go back to
client and you open up components recipe
card
add back the image
image is equal to recipe image URL and
then down here our description is equal
to recipe dot description or because
some of these don't have descriptions no
description that way doesn't air out at
us and get mad so now that's awesome we
see our team L we see our description
and we upload all ourselves so now we
could go back we could upload another
one we get upload as many as we like
that's working all nicely the next thing
I wanted to set up in the next video is
being able to click on these cards and
just showing like an individual view for
each one and then after that getting
into some authentication a login and a
signup page so thank you guys for
watching I'll see you in the next week</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>