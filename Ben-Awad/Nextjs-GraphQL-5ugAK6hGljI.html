<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Nextjs GraphQL | Coder Coacher - Coaching Coders</title><meta content="Nextjs GraphQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Nextjs GraphQL</b></h2><h5 class="post__date">2017-06-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5ugAK6hGljI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys so I have the simplest
next radius application up right now and
I would like to add graph QL to it I
have a graphical server that like to
query and get the response and show it
on the screen here now if you don't know
what next GS is it is a or you don't
know how to install it I have a video
which I'll link in the description below
that'll help you get set up and so you
can get to this screen that looks like
this now the server I run this on is
something that I've made before and I
have the starter code in the description
below or you can set this up if you have
your own graph QL server or if you want
to use something else like graph cool
which I'll show in a second you can do
that too but here's the query that I'd
like to execute super simple so we get
all the users and I want to get the
username and there's only one user right
now Bob seven so I want to see Bob seven
pop-up here after during your query now
the library I'm going to use to actually
set graph kill on this is Apollo data or
react Apollo is the actual library name
and it's actually incredibly difficult
to set up with next AF there's this
whole github project example here that
shows you how to actually initialize it
and I thought rather than redoing it
because there's two files that are have
quite a bit inside of them here and here
just to set up this library and usually
this library is super easy to set up
because but because this is a server
rendered next yesses you have to do a
little bit more so I'm going to put this
link in the description below to this
library here this github link so you can
follow along with me because what we're
going to do is I'm just going to copy
and paste these two files this
initializes all the hard work for us so
we can actually get to doing the graph
QL and actually do the query and get
stuff set up okay without further ado
let's get started so the first is in the
Lib slash and MIT
we're actually just going to copy and
paste this so here's my project right
here it's got nothing going on with it
yet and I actually don't even have react
Apollo installed so let's install that
first so I have it open here the project
that is and I'm just going to be yard
but is you excuse me
yarn add and then react Apollo and I'll
go ahead and download the library that
we need okay so now in the outside
directory I'm going to create a new
folder called Apollo and I'm going to
create a tan it Apollo got Jas I'm just
going to paste this in here save it and
that's it I'm going to do the same thing
for this one this is the Lib with data
page and now this just sets it up this
is not executing any queries or anything
this just sets up our application so
that we can do queries
now this anit apollo file has the URL to
the database or knots database but our
graph QL server they have one a near
graph cool if you'd like to use this you
can I'm going to I want to use my own
server so I'm going to replace this line
is at localhost 3000 slash graph QL all
right and now to actually use this we so
that was just initializing things now I
would like to use it on my index page
how do I actually do that so let me show
you how to do now so we have to tell
graph QL what query we would like to run
so to do that we need two things
gql and graph QL and this is currently
active Paulo and we need to actually
create our query that we want to run and
to do that we're actually going to put
graph QL query here just a string and we
call the gql function on this string and
you can see it's funky like this
this is just the convention that how I
do it so I'm actually going to go to
graphical copy and paste the exact query
I want to get run perfect and now what I
can do is I can say Const we'll call it
crack QL index good lowercase is equal
to graph QL we pass in our query and we
call it on our function here and
actually it looks ok so let's call I'm
going to break this up a little bit so
our index here is going to be this and
we'll put it here ok so this is my
component index here and then we're
going to create a graph QL index so this
is a just a regular component right has
no graph QL so when we call this graph
jail function on it like so we're
injecting this query in there this is a
higher-order function so now this index
will actually get as parameters a data
parameter and this data parameter will
actually have what we need but I don't
want to pop it up here yet I want to
show you what it looks like in the prop
because it might be different for you if
you do a different query okay so we have
this graph will index component here now
that is what we want to use last thing
we need to do is do that with data thing
so import with data from Apollo slash
with data and this basically just tells
it what server configures it was server
rendering all that stuff and this is
actually what we'll export so export
default with data our graph QL index
that's it we'll come over here see if
you render is okay we forgot to do
uppercase G save
that and for whatever oh I was recording
in my M keybinding that's why I was not
saving refresh alright so you see no air
is perfect now if I go to my react to
dev tools I can actually click on this
real quick here and for our reason
wasn't working so we'll just come down
here alright so if I click on my index
component that's this guy right here
right we see it has a data prop and then
it has all these things and the thing we
care about is the all users query which
is an array and the first one is the
username table size exactly what we want
so we can actually grab this from our
props and since this is a pure function
here you get the props right here so I
can say data and then I can say all
users and all user is going to be an
array so what we could do is inside our
div here let's make this come down and
wrap everything this will fix the
formatting in a second and we'll say all
users dot map and I'm going to take a
user like the user we're not your this
is not a great way to do it you're not
so see users have a key but we'll use
the index with the key right now and
we'll create a list item where we get
the user's username and we'll use as a
key the index and I'll show you in a
second why you shouldn't be using this
and what a better way to do it so let's
just see if this renders and I think
we're good now Fred sees match of so
let's just wrap this in a unloader list
come back over here I use that username
we just need to wrap this in curly
braces
okay all right now we see Bob seven nice
so if we were to add more users we'd see
more users pop up now better convention
is not to use the index because this is
not unique to the user a better way to
do it is to actually use the ID so you
want to use the UID but we didn't
actually fetch the ID with our query so
let's do that as well so now this is a
much better mapping and that's usually
what you want to do on a map and we're
this broke it
now all users can't be property map
undefined
okay we refresh now it's working not
sure why we're getting that before and
all right we're good to go we mapped and
stood our query and showed it so that is
it for this guy's I'm going to put this
code up on github if you would like to
see it and I'll also put this pollo
example up on github - or not it's
already on github but I'll put the link
in description below so you can come use
this and use this example as well and so
any page you want to add so because we
used with data here I can do more graphs
ql things here but for example my hello
page i would have to do with data on
this component so something like this if
I wanted to do graph QL stuff on the
whole page so every page that you want
to do graph QL things on you need to do
this with data thing so yep that's it
for this video guys thanks for watching
let me know if you had any trouble
sitting up graph QL with next J s I'd be
happy to help because it's a little
weird there's a ton of this code behind
it so yeah thanks for watching guys and
I'll see in the next video
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>