<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Don't setState Like This in React | Coder Coacher - Coaching Coders</title><meta content="Don't setState Like This in React - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Don't setState Like This in React</b></h2><h5 class="post__date">2017-08-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Kz3j_Fz7X2w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys I want to go over a line of
code that I wrote in one of my videos
and that is line 46 here where I'm
setting the state and I'm setting the
stay with errors and I'm spreading open
the state as well now this is a line
that someone in the comments asked about
whether it was the correct way to do it
and I thought it'd be good in case
anyone else was writing their code like
this why this is not the most optimal I
usually don't write stuff like this but
in this moment for whatever reason I
wrote it like this now this code works
right here setting the state like this
works just fine it's just not the most
optimal optimal so I'm gonna show you
why this is not and how set state works
and why this how this could be improved
upon
so just for context this is a form
component here and the state just has a
first name last name username email and
password so five different fields
basically and for each one I have the
actual value and then the air for it
so last name last name error and then
the it's in this function called
validate which is run and basically all
it's doing is it creates this object
called errors and it looks through it
does a couple checks and if it you know
if we find any errors in it we'll go
ahead and set the errors here and then
what we'll do is we'll set the state
with the errors and that will go ahead
and update you know because we're taking
this object and it's going to come up
here and populate the errors that we
have and then that will reload the
component and the component will render
with the heirs so that's what's
happening here
now the way I'm doing it is I'm
basically creating a new object here so
that's why how you why you see this
right here and I'm spreading over this
dot state so I'm keeping all the values
that are currently there they might be
the default or maybe they change somehow
the user typed some stuff in whatever
I'm keeping the state the same and then
I'm opening the errors so any case where
we have an error here it's gonna
overwrite whatever the state is and
that's gonna be
updated now the reason why this is not
needed particularly line 40 Sullivan is
unnecessary we can comment this out and
the code will work the same because this
dot set state does what's called a
shallow merge and now how a shallow
merge works is if you look at your
object so let's say our state has just
the component a is equal to 1 if we do
this dot set state and we say B is equal
to 2 all its gonna do is it's gonna take
our object here and it's gonna add the
property B it's not gonna overwrite this
so what it'll turn into is a 1 B 2 so
that is what's called a shallow merge so
it's taking both objects this guy here
and the original state and what we want
to update the state with and kind of
just squishing the two objects together
now if this was a B here
all it would do is it would overwrite
the B and you would have a B is equal to
2 here after setting the state so there
is no need to do you know grab with the
original values of state R because it is
a shallow merge so you can get rid of
that line and then once you get rid of
that line you noticed I'm spreading over
the airs into a new object that's really
unnecessary because look at this we
already have the it in an object form
the names here line up with the names
here so we don't need to change anything
all we really need to do is come here
and we can say this thought sets state
to heirs and that's gonna be equivalent
and this is the most I would say the
most optimal way to update this state
here so that is how I would recommend
updating the state here don't do what I
was doing before like this so this state
and then dot dot errors
so these two are equivalent they'll have
update the state in the same way but
this is just a bad way to do it right
here and we'll just comment this out
because we don't to use it so that's it
for this video guys I just wanted to go
over real quick how sets state is
working because there's multiple ways to
update your state make sure you're
setting your state like this don't
spread open the state like that and only
you know know that it's a shallow merge
like this and use that to your advantage
for saving just computation time when
you're studying the state so thank you
guys for watching and I'll see you guys
in the next video
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>