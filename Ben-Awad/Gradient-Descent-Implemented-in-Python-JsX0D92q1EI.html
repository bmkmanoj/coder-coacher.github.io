<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Gradient Descent Implemented in Python | Coder Coacher - Coaching Coders</title><meta content="Gradient Descent Implemented in Python - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Gradient Descent Implemented in Python</b></h2><h5 class="post__date">2016-07-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JsX0D92q1EI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm going to be doing a video on
gradient descent for those you that
don't know what gradient descent is is a
machine learning algorithm that is used
to draw a fit a line to a set of points
and it's useful for linear regression
and basically you want to predict
further out in your data set so I'm
going to show you how to do that in
Python so first thing I do is just
import numpy and matplotlib
and then this is just a sample data set
let's take a look at what it looks like
we've just got some sample points and
what we want to do is draw a nice line y
equals MX plus B is what we want and we
have that right here and we're just
going to use lambda to represent formula
so now what we're going to be creating
is a line equation for a line to plot so
we can get a line that goes through
these points and here's a function right
here that right now I'm going to be
using to plot an equation for a line so
if we just take a look right now we have
M equals 0 B equals 0 so just a flat
line at 0 if you want to take a look at
the code that makes it basically what
I'm doing is I'm picking the min point
in the max point in the data set for the
x-axis that way it creates a line for
the whole bar and then
just for the y-values just plugging them
in the formula right here for the
equation line okay so now let's get into
the equation for gradient descent let's
zoom in a little bit so you can see this
better okay that's pretty big but that's
good okay so basically we're going to do
is we're just going to over and over
we're going to crease mnb to get closer
to a good fit line so let's zoom out so
what we want to do right now if we just
plot these guys together you'll notice
you'll notice that this is up and it's
right here this is a poor job predicting
that because you know it's not very
close to what we want to do is slowly
move it up and get it so it's right
there you know it predicts it better so
we're going to slowly increase em
instantly increase B and basically just
change them so that fits we get a nice
line that gets the data well and so
what's happening is if we let k equal to
the number of points we that we have and
then what we're going to do is were
first going to subtract points from em
and so what's going to happen is we're
going to do a for loop and we're just
going to keep subtracting away from em
until we get a nice line that we want it
will do the same for B and right here
this alpha is how fast you want to have
the this to happen
basically because what's going to happen
is the line is slowly going to come up
up up both of them and go here
what's examines is going to be negative
that's why it's minus sine they're going
to cancel it's going to add it's going
to get bigger bigger here
and basically what's going to happen is
you take the summation of the distance
between the line and the points and you
in this case we're going to be adding
them to M so it's going get bigger and
closer and closer and closer to it it
makes more sense once you see it happen
so let's take a look at that so
alpha it is learn and that's this right
here and you can make this point a one
point one one the faster you make it the
faster the algorithm terminates but if
you make it too big you can get weird
results which I'll show later so you
want to basically start small just build
up it so this is the summation here and
we're basically what we're doing is
we're following this exactly so let me
explain the X I and the y i notation if
we look at the data points up here X I
would be so x0 would be this y0 would be
this x1 would be this y0 would be this
and so we're just indexing the x and y
points that's the notation here so we're
getting the x value plugging into our y
equals MX plus b formula that we have
right now subtracting summing it
basically is kind of finding the mean
distance between these um and then we
find give that a total and then that's
this summation right here is this part
and then divide by 1 over k and then the
second one for the B term the only
difference is we multiply times X I X
point so that's right here
and then here is that the algorithm in
action so M and B are currently zero
still and we run this it's going to
increase it so let's run it once we're
doing it five times we're increasing it
and notice how M is now 0.98 or sorry
excuse me 0.1 9 and B has increased as
well and let's just see what the line
looks like okay so you notice they went
up a little bit now if we run it again M
increases B increases we get even closer
line if we run this a few more times
it's closer and if we ran this for the
say 50 times it would increase even more
and we finally get a nice line that goes
right through here so what would happen
is you just keep running it until it
gets to a place that you like we can
keep running this more and notice it and
it'll get a better fit but it's very
incremental changes you know around
again you just get smaller and smaller
changes and let's just show you guys
another way to visualize this is it
moving upwards if we just run this 50
times set this back to 0 so set M and B
back to 0 so we're resetting it and we
rerun this you can just watch notice how
the line starts it here and just slowly
increases upward till it gets here
and then if we scroll down that's that's
pretty much how the algorithm works now
I'm going to show you with another data
set there's a real data set how is this
work so let's go by zero and I'm just
going to use pandas library to read in
some data so the data I'm going to be
looking at is crickets and the mouth a
chirp and the temperature that it is so
this is like the data a couple points
here it's I so 20 trips in a minute and
it's eighty eight point six or five nine
degrees outside and this is Fahrenheit
so we're just going to grab this and put
into a list to get the X points and the
Y points X's chirps why is temperature
let's just show you what that looks like
here's our data set and then our learn
is going to be 0.001 still and then
we're just going to run this thousand
times M is four point eight plot that I
guess nice line through here and now
what this allows us to do is let's say
it's I count ten chirps in a minute
let's see what you know the degrees
outside its forty eight point four six
degrees outside is what it predicts
and now the one last thing I want to
show you guys is if we increase this
notice this took a thousand to get the
four point eight just see if we get two
and
you know running a thousand with that so
notice when we increased it to 0.01 we
get wonky results that's because we're
learning too quickly so we go back down
a little bit smaller and it's reset and
then zero Oh again let me run it
and we get four point seven eight six
right again
so you notice as you change tweak they
learn you get a little bit different
result here in here it's the speed at
which it gets there as well so we were
just say just look at like maybe ten and
if we go back up to this i/o reset it
to run that and again it's too fast we
can't do this much so bring it back down
right lesson one last time
and so you guys can play around with
this I'm going to post this notebook for
you guys to play around with and you can
you know try to fit a curve to the data
you want to so thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>