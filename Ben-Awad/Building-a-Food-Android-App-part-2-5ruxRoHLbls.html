<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a Food Android App - part 2 | Coder Coacher - Coaching Coders</title><meta content="Building a Food Android App - part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a Food Android App - part 2</b></h2><h5 class="post__date">2016-12-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5ruxRoHLbls" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys welcome back so today I
want to setup working with the Yelp API
yell BPI is how we're gonna get
restaurants that are local now to
actually fetch stuff from the elf API I
want to create a async task that I do
the SIP so let's create one right down
here something creates a class I'm gonna
call this fetch pictures and it's gonna
an extend async task now async task has
three things the first one I believe is
what you pass in to the on when you
initialize the async task so for us is
going to be a string and then the middle
is how we're gonna post updates which
doesn't really matter while she does for
now we'll leave it as string string so
for now we're gonna have string string
string for each parameter and I'll
explain what each one of these does
later this one will always ignore but
these two we will be using so okay go
ahead and implement the methods do a
background so now right here if you're
not familiar with what how async task
works is we can call this class create
something so I could be like new fetch
pictures and I can do call execute and
what will happen is it'll pass it'll go
right here as a parameter they'll call
this doing background and we can pass in
parameters here so for example I can put
a string like that and it'll pass in as
a parameter right here and that is if we
change this to like an integer then we
can pass an integer parameter and all
that sort of things so for now we're not
going to pass any parameters all we're
gonna do is execute our AC
tasks so that's gonna be call our doing
background and this is gonna happen
asynchronously so what that means is
other code can be run while this is
happening this is happening in like a
background thread behind the scenes so
this is a good way to download and make
an API call so to use the Yelp API I
need to make sure and go to the Yelp API
page and create a consumer key a secret
token all that stuff you're going to
need these to access it so make sure you
go and do that
and then once you have these we're just
gonna add these to our strings file
right here to use so we go into just an
Android value strings right here so I'm
just going to create five new strings so
the first one's gonna be consumer key
can super-secret you can assume urkki
consumer secret and I got token token
secret and then we're just gonna replace
that with our driver values
how's that
and your last one okay now we have our
keys go back here and to actually access
the Yelp API we're gonna use a Yelp
library that actually Yelp creates this
is really nice and handy so if all like
this and the description below the link
to this page and this has all the
information of how to use the Yelp API
which is what we want to do so we're
gonna be using first we have to include
the center project and we're using
Gradle so we can just copy this compile
line right here and add it as a
dependency so go to our app just add it
right underneath Picasso and then we
just need to rebuild cradle so now we
can use the Yelp API if we scroll down
it shows us how to use the Yelp API we
just need to make a hash map with some
parameters and then we can call the Yelp
API just like that if we scroll down a
little more we can see we can pass in
coordinates to it that's exactly what we
want to do
creating a basically the search radius
based on what we're gonna get the
location from their phone and then pass
in the coordinates and the parameters
and make a call that way so we're just
gonna copy this code for now we're just
gonna hard code in the coordinates like
that but in later videos we're gonna
actually get the latitude longitude
using the phone up and Yelp API is
something we need to create we shows us
right here and well since these you only
have to do once we'll create these at
the top up here just do it right below
our touch and let's create make these
global so
um and um and then we're gonna create
those up here so Yelp API Factory and
API factory and then Yelp API is gonna
meet em Yelp API then right over here
it's get string r dot string dot
consumer key and let's just space these
out okay and we're gonna do the same
thing four times now we're get consumer
secret now we'll get our token and now
we'll get our token the secret okay
sorry it's that and then we'll just
create our API case that initializes
things and then we can use it in our
async call down here
so in Yelp API and we also need to
create a map called params just copy
that
to create one up here same way call it m
params
so hashmap nope it's just map map string
string and perhaps and then the - it's
doesn't like I did map string string
your hash map oh I just need to import
the class okay now it's working nicely
there you're gonna pass it in params
here and then what parameters do we want
to pass so right now we don't care about
the limit or the language I think this
is the only one we care about is making
sure we're looking up food just paste
that in alright next we can do call that
executes and looks like we just need to
put this in a try-catch I'm just going
to check if it's null so set to null
response and we're check if it is null
no we can then proceed to get data okay
so what's happening here is we
initialize basically our API here we
have our parameters that were passing in
we're passing in food and then down here
we're actually making the call so we're
also building the location for now we
have it here but that's another thing
we're gonna move up here later
we're hard-coding the latitude and
longitude that we're gonna pass into
Yelp to get the location and then Yelp
we're gonna call Yelp so we're actually
gonna search it right here we're
creating the call and then we're
actually executing it and we're looking
for a response so this is if we just
look at the response objects real quick
it has a body and then that has
businesses businesses we get the first
one
and then you know from here you can
actually this is what we want we want to
show all these businesses in our app so
if this call works then we can just
continue building out our app using this
so let's make sure this is working so
I'm just going to log it businesses and
then I'm just going to get a response
stop body dot businesses so we're just
going to print the array let's do two
string and we're just going to run that
and see it in our Android monitor I have
my emulator up and we're gonna check
down here and our in Droid monitor
whether we're making the API call okay
so what that finish building up and it
looks like we have a little bit of a
problem so yes this is a problem I
actually ran into building this project
before it for some reason it doesn't
like this compiling of this library or
whatever it says duplicate files copied
in apk meta and license and I have no
idea what that was so I just went over
here to Google duplicate apk meta and I
just want to over Stack Overflow and
they had this nice little thing where
you exclude some packages so I'll link
this in the description as well you just
add this right above here I believe
above build types yep basically what's
happening I think is one of these
libraries has one of these files and
then another one also has one of these
files so for example you Picasso and
Yelp both have a license we'll go ahead
and sink this Picasso and yell both have
a license
and so when they it's compiling together
they're getting duplicate files or
something and so all this is doing is
excluding that and getting rid of that
build problem so now it should build
okay and then let us run our application
okay now let's run it and make sure it
builds okay and if it builds
successfully will see that our async
task is being run since we added this
right here in our main activity and our
on create we added it so when it's built
we're just gonna do this a sync task in
the background and hopefully call Yelp
and get some businesses so let's see if
we actually do and let's just check on
and are okay it looks like it's just
booting up still just give it a second
well that is doing that I can talk about
how ASIC tasks works a little bit more
so the two parameters you see here is
later on what we're gonna want to do and
you can see we got some build errors but
you can ignore those what I'm gonna do
later is in our async task if you tried
to update what's called the main thread
for example the UI which is like what
the app looks like let's let's say in
the async task that I wanted to change
this fixture you get an error because
you're in a different thread so what you
have to do is there's this function
called on progress update and what this
does is we can call a function and our
doing background that we'll call this
and this is run on the main thread which
allows us to touch to the UI so that
might make then they might make sense
but basically every time we want to
touch change this image or whatever I'm
going to do in our async task we have to
do it in on progress update um so you'll
see this later and this string right
here tells you the parameter here so
we're going to be editing that shortly
but it looks like our Android monitor
finished looks like it loaded up nice
and if we look at our log right here
check this out guys um we can see some
businesses awesome
so our Yelp call worked that's perfect
so in our next video I want to set up
you know adding this location getting
this from the user so we're not having
it hard-coded also I now have all these
businesses I want to get some pictures
showing up I want to show the businesses
pictures right here I want to show the
images so we'll be setting that in the
upcoming videos and make this look a lot
nicer and make this dynamic so that's
what we'll be doing in the next video
I'll see you guys then</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>