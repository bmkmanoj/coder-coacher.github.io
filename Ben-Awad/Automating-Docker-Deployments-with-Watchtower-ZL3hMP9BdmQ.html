<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Automating Docker Deployments with Watchtower | Coder Coacher - Coaching Coders</title><meta content="Automating Docker Deployments with Watchtower - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Automating Docker Deployments with Watchtower</b></h2><h5 class="post__date">2017-12-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZL3hMP9BdmQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys I want to share with you how i
aughtta mated deploying the project
there's two parts to this the first is
actually sending the built code up the
docker cloud and the other part is
having the actual ec2 instance grab the
code from docker cloud and restart the
containers so for the first part
normally how I would send the code up to
docker cloud as I come in here in the
project directory and first run NPM run
build which takes our source code and
runs babble on it to build it next I
create the docker image by running
docker build it take our code to build
into a docker image and next I just send
it up to the cloud running docker push
and I just push up that image now I saw
why why am i typing each command out
like that that's silly I'm a programmer
so we should put this into a shell
script so that's exactly what I did I
create a little shell script called
deploy SH and it just runs those three
commands now if you're not familiar
shell scripts all it does is it runs
these three commands for me so now over
here on the command line all I have to
type is dot slash deploy SH and it'll go
ahead and run that for me so I don't
have to run each command now make sure
you change mod and you make it
executable and the way you do that just
do change mod + X on the deploy script
so run that before you do dot slash
deploy ok so that automated that's the
simple part right that's how I sent up
the I now send up the code to the docker
cloud with just one command the next
part is actually having the images over
here so here's my abun - server on the
right normally when i push up code what
i would do is i run docker pull in Awadh
slash slack clone server and we've
grabbed the latest code it'll download
the code and then I come over here and
run docker compose up - then restart the
container
with the new code but that's kind of
annoying to SSH in here every time so I
wanted to have it as soon as I run dot
slash deploy does the whole process for
me so there's a nice little utility that
we can use to help us out and that's
called Watchtower and I went ahead and
ran this and super nice so all I have to
do is run this command right here so
copy that and I ran an honor server well
it's full screen for this so all I did
is run this command and I've already run
it and what it does is it looks at our
docker images and it listens for when
our docker images are updated and then
it'll go ahead and restart the server
automatically for you and if I just run
docker container LS oops
container Alice we can see I have
watched our running and I can grab the
container ID so watch tower itself just
runs as a docker container and this
docker container listens for the other
containers and when are they update it
will go ahead and pull the code down
from docker cloud and restart it so if I
run docker container logs I can see that
it stops a bun to web it's creating a
new a bun to web and ooh look it found a
new version and so it just endless
process where it's just listening for
when I update new code so it's super
nice so I literally just had to run this
one command right here and that's it I
didn't have to do anything else
so now all I do is over here I just type
dot slash deploy it runs the three
commands sends it up to docker cloud and
then high tower not high tower
watchtower well pull down that code I
just pushed and restart the container so
SuperDuper nice and there's another few
nice perks here at the very bottom of
the readme you can have it actually send
you an email so you would get notified
every time it updates stuff so I thought
this was really nice and yeah that's how
I oughta mated
deployments that's all for this video
guys thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>