<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building Login Screen - Part 4 | Coder Coacher - Coaching Coders</title><meta content="Building Login Screen - Part 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building Login Screen - Part 4</b></h2><h5 class="post__date">2018-02-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6mcwL_uHKCM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys we're gonna be working on the
login screen so to do this to help us
out we're gonna be changing our routes
around a little bit so by default we're
going to this signup page but be really
annoying to be you have to click login
I'd see what the login screen looks like
every time so I'm just gonna swap it and
make login the default route that way
it's fast for debugging we load the
login screen right away now our login
page is gonna look very similar to our
sign up one so we can copy and paste
this but before I do I wanted to mention
one thing
so in our submit function at the end
here right here we are clearing the
state and we don't really need to do
this so I'm gonna comment it out and the
reason we don't need to do this is
because we're switching to another
component right that's what the stop
props history pushes doing afterwards
which is gonna unmount the component and
clear it anyway now if we end up not
needing or needing to clear this later
we can always comment it out but no need
to rerender when we're just gonna change
screens anyway all right so let's copy
this and paste it into login and we're
just gonna change things that we need to
for this and really the first big change
is our text field component since we're
using this in both places it doesn't
make sense to copy it let's just go
ahead and be good developers and make a
components folder and inside of that we
are going to create a text field
and then we're gonna move our guy this
one and we're gonna move it over here to
text field and so he's gonna need the of
the default state but styles and then he
also needs some of this and we can't
forget react so now we're just putting
him in a separate function and we're
gonna import him to use him and I'm an
export he fall
export do you know all rights this
components good to go so now on our sign
up and login we need to import instead
of just having the class there so I can
delete that and I can delete that and
now we can get rid of this little
excellent warning or disabling the
warning and now I'm going to import text
field
and we can copy that because if we're
going to do that in our login page as
well
oops I copied the wrong thing and we
don't need this stuff anymore and is our
signup page good I need to change it I
don't see any red lines I think we're
good now okay so let's focus on login so
we don't need es Lent
we don't need name because the login we
just need email password should rename
this to login we're gonna have to still
change the text of things so that's fine
our submit function we're gonna come
back to a lot of this is gonna stay
similar though I guess instead of saying
response dot data dot signup we can say
login so I have response that data that
login token is gonna be the same because
we're we get the same response if we
look at our off payload or schema graph
QL we return the same thing from signup
as we do with login write this off
payload which has a token for us
alrighty so instead of go to login page
we're gonna say go to sign up because
maybe you got to the login page somehow
and you really just need to go for the
signup page instead so down here I'm
going to say go to sign up and really I
can replace these
now the title the buttons so now I want
to login or say create account
flip them this mutation should be a log
and mutation and so we're gonna have to
change the inside of that and our
component is called log in now so we
need to fill this we no longer need a
name field and also we're showing airs
for email we should do the same for
password because there's a chance that
they give us an invalid password on
login page alright so that looks good we
can get rid of the name here there might
be some other things we need to fix but
this looks pretty good I don't see too
much red here
I see our app is crashing but that is
because we have not filled out the login
mutation so I like to do the same thing
as I did for the signup is to type it
over here so mutation we're gonna have a
email or just a string and a password
and I'll login with our email and our
password variables and again we just
care about the token it's a little why
not let's make it pretty copy it move it
over here give that a save hopefully
we're done crashing and we are awesome
now we want to handle errors slightly
differently than how we're doing it here
because there's really two type of
errors we can get email is bad or
password is bad so instead of trying to
parse the error on the client-side I'm
gonna send to the client exactly what
the air is so it's very easy so I'm no
longer gonna have a try/catch here I can
totally delete that I'm expecting the
response to be good every time otherwise
we have a big problem either like our
servers down or something so now we need
to change response and I'll come on over
tier to our schema so now instead of
just returning off payload I want to
return any errors we might get so I want
to show you guys what's currently doing
so auth dot type scripts so go to source
resolvers mutation off that type script
you'll see the login so right now it's
throwing airs whatever there's a user or
invalid password or invalid user since
we know these errors ahead time are
going to happen I don't want to just
return the error that way we we don't
feel like parse the error messages out
on the client-side so to do this I'm
going to create a type called err
and it's gonna have a field which is
gonna be a screen and a message and how
this is we're gonna work is let's say I
wanted to display an error invalid
password
I set the field the password the message
to invalid password and then on my
client side I'm gonna parse this and
show that err
and so now I'm gonna create a login
response which is gonna return a payload
which is gonna hae an auth payload and
err and both of these are nullable
because sometimes there's a payload
sometimes there's an air and we're gonna
return this from the login so login
response so instead of just Pat
returning off payload now here I could
return more than one air but really
we're just gonna get one air at a time
so I'm just gonna return one like this
and then in our login we now oops not
this one are off logging over here we
need to actually return the correct
stuff so if we don't get an user now
we're gonna return an air and the field
is email and what do we want the message
to be I don't know me like no user found
and we can just delete that and we want
to do the same thing for our valid
passwords so now this is going to be
password and we can just say invalid
password
and now we can't just return the token
user we need to wrap this in a payload
there we go cool so now our server is
good we are now returning our airs
regularly and if we don't get any airs
we return the token so now in our login
over here in a response I want to say
Const we could either get a payload or
an air and this is coming from response
dot data dot login so if I'm just gonna
do a simple if statement if payload
right otherwise it's gonna be null so oh
so if we get a payload we want to do
this stuff right here we want to store
the token so that's gonna be payload
token and so also we need to change but
our mutation looks like down here but
we'll do that in a second payload token
otherwise we have an error right and
what we're gonna do to handle this
is we're gonna say this bus that's state
and we're gonna say airs and one of our
airs is field name is gonna be air dot
field and the value it's gonna be error
message and then we can also say is
submitting as false so now if we get an
error what are we doing we are grabbing
it all right so grabbing it from the
response and then I'm doing this thing
here so this is gonna get the value of
the air so if this field is called
password or email and we're saying the
message and that we're updating and
remember down here we're conditionally
checking whether we have an eat airs
that email or password and displaying it
if it exists all right
I'm not sure if I have an air or is this
styling looks like it's styling I think
this is good to go actually no it's not
I forgot we need to change this so
refresh over here and let's make sure we
have our new response so that our schema
we see a login response so now we can't
just grab a token right we had a payload
then get our token and then from here we
have to get our air and get the field
and the message so let's copy the inside
of that paste it all right so let's give
this a try now so we're not console
logging anything so let's console dot
log payload token and we should see
something if the air goes wrong so let's
see an error first so let's do a bad
email so no user found nice
so now Bob at Bob calm this user exists
let's do Bob too because I actually
remember the password for that login now
we're getting it invalid password now
let's actually type a good password I
think it's just Bob and nice we get the
token so we get the token we set it an
async storage over here and then we push
the products and this is really all we
have to do on our login page I think
we're good to go so that's it for this
video guys you saw how we can actually
send a mutation over and then grab the
response parse out any errors and
actually handle the errors on the server
side right with our auth so returning
errors like so in updating our schema
appropriately thanks for watching in the
next video what we'll do is I think
either create like an intermediary
screen to tell us whether we should go
to sign up our login or to go directly
at products but stay tuned we'll get
into that soon
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>