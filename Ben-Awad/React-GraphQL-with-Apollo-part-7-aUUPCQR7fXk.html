<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React GraphQL with Apollo part 7 | Coder Coacher - Coaching Coders</title><meta content="React GraphQL with Apollo part 7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React GraphQL with Apollo part 7</b></h2><h5 class="post__date">2017-02-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aUUPCQR7fXk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright what's up guys this video we're
going to be finishing up our application
and finishing up the craft ql react
front end for this so last thing we
wanted to do was actually just to get
that button working so this is going to
be working in the home component so we
have this this is going to actually work
it's going to actually create secret
burritos this hard thing are not the
hard thing but the more difficult thing
is to actually show the burritos right
underneath how we going to get that and
we're going to be doing this with a
query it's going to be kind of similar
to the get tacos create where we're
going to get secret burritos query and
it's going to run when the cover the
component is bloated but if you remember
how we did it here we didn't have like a
all secret brutes like there's only all
tacos there's not all secret burritos
because you want to get it for the user
and Jude actually use a viewer and the
viewer you can get the ID the email but
more importantly what we actually want
and we can actually just cut this out
because we're actually not interested in
it whatsoever so save on the data that
we're getting is to get the secret
breathe oil and again we don't actually
care about by D so we just grab the five
so we run that hotel for an
authenticated that's fine because we
only really want to do this we just
wanted to format it so now we can paste
that in there and that's how we're going
to be getting the secret burritos we're
going to get this viewer this is
basically authenticate make sure we're
in there we're logged in okay and then
we can get the burritos for that user so
then let's create the function for that
can just basically the same thing secret
burritos get
figure burritos grass ql get secret
videos query and then the props here we
have data and I'm just going to call it
secret burritos data and up here wrap
that extra options for such is equal to
true now what this does is if you
remember when I was talking about the
fetching up here well we're going to
want to fetch the same way drop spot
secret burritos dot research after we
created burrito we want to show it
refresh DUI and pull it down now
remember when I'm talking about the
tacos is we actually have it was getting
cash when we added the create taco it
actually knows about that we created a
taco and then you can just grab it from
cash when we create a seeker burrito our
local Apollo doesn't know who is logged
in it doesn't know which viewer added a
secret burrito so we actually have to
research from the server and re-do this
whole query because we need to get the
newer than the secret burritos so to
force it not to use cash we have to do
force fetch is equal to true and that
will work for us now we also just need
to add this now that we haven't you can
add it to our few we come back up here
you can say let secret burritos it's
equal to an empty array and we're going
to do the same exact thing and we also
need to get this from our prop so secret
secret brio's secret burritos so let me
call this secret burritos listen so
secret burritos dot you or
that exists then we're going to say
secret secret burritos lip is equal to
the viewer and then the actual burritos
themselves went down too far and then
we're going to do the same thing we did
here so right underneath this button
here for handle secret burrito we're
going to say secret breed a list and
then in our pre tag get the secret breed
a lift okay so we just added this guy
right here underneath so if we come back
over here let's see if we can see help
cannot read property of view or
undefined so secret diced bell rung
secret oh when you compose it gets
secret burritos good secret places so we
just need that so it actually runs and
here we go okay no record found for ID
interesting I've never seen this air
before so this looks like floats debug
this together so we're getting a problem
with an ID first I'm curious to know I'm
assuming that means create secret
burrito does not work so the first thing
I'm going to do is I'm going to comment
out this refresh rerun see if we get the
air we get it once okay so it's a
problem with the create secret burrito
or is it a problem with
um the query so I'm trying to figure out
if it's the query return you tation and
we kind of need this film just going to
the best way so we're getting a new air
okay so i think it's we weren't getting
it before i actually don't think so for
whatever reason it doesn't like our
query i believe so it's not liking this
possibly because we don't have an ID so
I'm going to try adding an ID here and
see if that does anything for it or
maybe it doesn't like I'm not passing
the ID of the burritos possibly because
it's only when I push the button when it
loads it's fine so maybe it's not it's
not this it could be in our main so I'm
going to pop back over to our main
that's where we created the mutation
here so it could be a problem with this
creates eager burrito sighs i D sighs
you know just a semicolon I should be I
should've added semicolon salty hmm so
to make sure i'm not actually creating
secret burritos every time i'm just
going to log in here with my bob and
make sure bob is doesn't have secret
burritos Bob password Bob
get their token we can also get data
secret burritos okay so the problem is
when we're creating the secret burritos
it could be because we logged in and
like there's an old token or something
so I'm going to re-login Baba create my
taco okay no records found for ID um the
other thing is I could have maybe messed
up my account so let's create a new user
will call this Tom Tom and does he get a
so it creates log them in but we still
get no record found with the ID let's
see so I'm not sure what the problem is
I'm going to continue debugging this and
if you're interested in knowing how I
debug this I'll keep recording and I'll
show you guys how I figure out this
problem because i think it's interesting
kind of see how you go about debugging
when you get a problem like this you
have no idea where it's coming from if
if you just want to know what the answer
is all create a video I'll add a video
at the end just showing you how i fix
this and you can just skip to the next
video if you want to see what the
problem was ok let's dig let's keep
digging into this oh I comments this it
out comment this out to this means the
button isn't doing anything that should
oh so it's literally just a research
then the research is causing the problem
so could be also the email yeah I'll
look that's the problem no record found
the viewer ID all tacos trying to think
what also caused this we're just
fetching it's funny because the first
fetch work but then the second one
doesn't so I'm curious click only when
we call research and weary fetch oh ok
so notice how i know we should get at
home never mind going to be home so
seeker burritos research I'm just want
to make sure ok great talkers to work
with this guy's broken I'm just going to
get rid of that option real quick just
to see if it gets through this out err
no record sound for ID ok but if we
don't research we don't get that problem
right no we still get a problem even
though we're not are you what if we do
nothing
okay that's fine create speaker burrito
so when i call up create secret burrito
okay I'm just going to comment allow the
coat out here took care of that get rid
of that and then get rid of this chunk
so that gets basically just killed the
query I am now only creating the braid
oh ok so its own work so this could be a
problem with the code over here then so
let's double check this so this is our
main JavaScript folder so i have a
mutation so this is actual mutation
that's being run mutation creates secret
video size huge green ID that wilco k
and then down here on prop mutate
console dot log we're longing the
results oh hi I want to see if it gets
to this point it doesn't so it doesn't
even mutate let's see if it gets this
point onslaught log before mutation
no record okay so the four mutation
works it's actually when we mutate and
it doesn't like it own props mutate
create secret brio creates your period
on here okay so i'm not saying anything
in particular so I'm just going to
restart mpm restart the server so this
is the server that we're talking to
going to restart that okay still same
problem let's create another user now
sign up bud bud no record found Friday
okay so I want to just go to my serve
real quick turn it off data users okay I
wonder if it this empty one is just
messing it up I don't think it is so
what is this ID it's no record found
tri-d 9063 so that's not the idea of
these guys so I got rid of the empty
email thing that we created I don't
think that was what was causing it yeah
still still problem some kind of error
when you taste
maybe try this maybe in the login page
I'm only getting the token here let's
try also know i'm going to say also try
it we could try getting some data like
there how many bridges they have I don't
think that would do anything I'm
thinking right now I'm thinking it could
maybe be like our store or maybe a
reducer so let's go go up to reducer and
X reducer just look over this code we're
connecting to the right place I'm
assuming the authorization isn't working
so we should be getting a token local
storage I start writing everything you
get item token so if we come over to
security now where is it
profile at application okay so have our
actual token here that's good um okay
look actually when does create seeker
burrito it shouldn't need to
authenticate that's correct huh so wreck
the options the headers authorization is
correct network interface okay I want to
let's just google this error then that
would be next thing so I can't see if
you're out my own graph ql there are no
records found for ID I let's see what
Google says a record for ID and just
like a quick scan through here I'm not
saying anyone with a similar area
queered okay possibly i'm going to try
restarting just this wait secret free oh
that's our other thing that's fine I
don't think I don't think refreshing
does anything still no records found
okay let's try this let's try this let's
make sure i'm just going to compare this
to login page when i compare this to the
interactive one because then the
interactive one if we can create
burritos we should be a little create
gritos anywhere theoretically because
this is the same thing as an interactive
query we're just doing in a different
way so here
and data secret gritos sighs okay then I
come in here and I log in with Bob
should see no burritos okay so let's
escape the burritos ok so now I'm try
creating a burrito which we can just
copy the mutation consultation over ok
so the only thing is our togas missing
so going to open up postman and we're
going to try posting to create a secret
burrito
close request body do JSON token will
grab the token here and then our query
which is right here we did a comma will
escape it genki editor okay now go what
is this Oh prompt in your posting to the
wrong thing okay so it actually created
it actually created the burrito that's
really weird so when we come going to go
back login we now see a burrito or Bob
and if I login
now see one burrito for Bob creative
Rios glare cool so okay so it's
something we're doing wrong in this
client create secretly there's something
wrong with this so before I even do that
part now that we know there are burritos
let's try this playing it so three fetch
this part this part we're going to try
query and see if you can show them
so one brio should pop up here if the
query worked interesting very
interesting did it run good free room so
let's see what happened here you can
just click on the seeker brios air and
we get the new record found for IT we're
still getting this weird error thing so
the fact that it's happening on both
these mutations leads to me to believe
that has something to do with our
authentication is not working it could
again be with what would anything be
wrong with our store meeting look
there's not really much going on here we
must say this is fine possibly meet our
index page or possibly I'm really
leaning towards it did something wrong
and reducer so I'm just going to go to
my github and then see what I put as the
code there and we can copy it over on
reducers
you
um you don't need this thing there okay
we still get the problem so it's not
something wrong with the index page
we're starting out the next page the
root index is it possibly this index
page so now i'm just going to compare
them side to side because i have this
working over here store client history
app home login page signup client
history guess all looks fine the only
other thing i can think of is maybe one
I messed up one of the component the
component would have messed up would
have been main I guess will click just
about the same code but copied over then
same problem okay so it's not this
component either it's possibly i'll
bigger than anything for app let's check
out app will bind connect main app we
don't need this part actions ok that was
fined maybe the login page i mess up
something possibly doesn't but then like
it looks so good secret burritos like we
can manually put it in like I did here
but this is something else Oh proc the
variables email password oh my gosh guys
I I see where I messed up it's right
here I forgot to actually put the token
in felt local storage doc token is equal
to data log in ok there we go I had some
old token in there something from
different project that that's what we
needed right there result is not the
kind you don't need you anymore
sure enough it works maybe no really
really really no login first I was going
to say I would be very surprised if this
does not work I really think I was at
Bob Bob yep all right ladies and
gentlemen it works and create sarika
burritos for our user try signing up
great brand new user tah-tah no secret
burritos we can create them alright
awesome I'm sorry guys that uh it we
found like I had just forgot to do this
little token thing and it messed things
up but that this is it the project is
over this is one way to implement graph
ql in the front end of your website
using react you know I I did very little
with redux and most of the time we're
just adding things to the props right
here and then accessing it that way and
as you can see it works out pretty well
if you remember that the token that is
and now everything is working smoothly
also this will see your redux add-on I
was talking about that we added to our
state this lets you just like look at
the actions that occur it's pretty cool
I recommend googling these if you don't
have them reactive tools that's what
i've been using this whole time we don't
need this anymore we don't need this
anymore i'm sure i think
them from firefox and other browsers as
well but this is a must for developing
with react to the same thing for redux
is very helpful but yeah we're done with
the project I hope you like to hope this
helps and it makes more sense how you
can actually implement a front-end now
how you can make mutations and queries
from react and then update your UI
accordingly by resetting and getting the
data I'm going to make one more video
after this for those people that skipped
and aren't listening to me right now
which is probably the majority and just
show you the end and wrap it up again so
you don't have to watch if you watched
you here thanks for watching guys and
I'll see you in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>