<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create React App Login Form | Coder Coacher - Coaching Coders</title><meta content="Create React App Login Form - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create React App Login Form</b></h2><h5 class="post__date">2017-07-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/M4kk3Ac0WSM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome guys so we created a register
page using create react app and a graph
QL server to actually you know persist
the user or save the user in a database
I'm using Postgres sequel for a database
and today what I'd like to do is create
a login page that way we can access
authenticated endpoints and persist the
user for a week so I'd like to do if
they log back in it should refresh their
token so what we're going to do is
create the slash login page for this if
you don't know what this project is and
you'd like to get the code I have so far
I'll have links in description below you
can grab that alright let's get started
so first I want to just name this button
we call it primary so I'm in source
routes and the register page for the
code and let's call it register just
going to rename that button and I'm
going to actually like copy all the code
and register and put it and login
because it's basically the same thing
it'll be a lot faster this way and I can
just go in and remove stuff so we don't
need checkbox because we don't have to
say whether we're an admin and on we're
going to need this to be login we're
going to have an email and password
state if change we don't need this check
because we know we're not going to have
an admin and on submit we're going to
call a mutation that's going to be a
different type of mutation a login
mutation and here we hear it of the
username and put in the admin input and
we just have a button and we'll call it
login and then here's our mutation and
now we just need to change our mutation
from a signup mutation to a login
mutation so here I'm in graphical and
this is where my servers set up on port
3000 slash graphical so I can just
you mutation and going to have a email
variable which is going to be a
mandatory string and a password variable
which is also mandatory string now login
grab that email should be an email a
password may be password here we can get
the token and the Refresh token now
after we actually get these values what
we'd like to do lets prettify you make
sure cool after we get these values we
actually want to store the token and the
Refresh token and local storage that way
it persists and what I mean by persist
is I mean they refresh the page they go
to another page they come back we still
know who they are
so this looks pretty good let's run this
and see if we get the tokens so I'm
going to open up console so you can see
the tokens printed back to us all right
Bob Bob calm and we're going to click
login and then we have data log and
refresh token token
so we can actually grab this so response
and we're going to get the token and the
Refresh token from response data top
login and then we're just going to say
local storage dot set item token token
and then refresh token refresh token now
to make sure this is work I want to come
over here to application and then it's
going to be stored okay so we have
nothing in local storage right here
right now as you guys can see it's
totally blank but if I log in here we
should hopefully see our token show
so if I go over here and type all that
Bob calm and Bob login BAM our token
show up and notice if I go to say the
register page tokens are still here if i
refresh tokens are still here so we're
basically going to use this to go to the
off page here and you know after the hit
either we have these tokens stored so
what we want to do is use Apollo we're
going to actually use some middleware so
they actually have a section on an
authentication here and we're going to
do a header and a header X token X
refresh token so we can just copy this
we're going to do something very similar
so if I go into my index where I'm
creating this here I can add middleware
to my network interface and what apply
middleware does every time I make a
graphical query or mutation it runs this
piece of code right here so this right
here is just creating a new header if we
don't have a header like this says we're
getting in the token from local storage
and putting in the header so we don't
need all this junk this is going to be
called X token for us we're a set local
storage socket item token and do the
same thing for X refresh token okay so
what's going to happen is when we make
any request we're going to grab the
token and refresh token which you solve
a stored in local storage we put it in
the header and then our server looks in
the header for the authentication tokens
and if it sees it where he knows we're
authenticated and the server also show
us authenticated routes so in our off
page here we are going to make just
display all users which is I believe an
authenticated route so let's change this
up here I'm just going to actually
delete this that way we can make this a
pure function because we don't need any
state for this so I'm going to say pure
off the sequel too and we're going to
get four now we're not going to have any
props but later we will and we're just
going to have a div whole for now and
we're going to import our graph QL
things from reactor Paulo and now we're
going to do same thing as we did before
export default graph QL and now I want
to pass graph QL I want to pass in a
query and a pass and this off component
and so we actually need to make a query
here so we're going to execute this
graph kale query and this auth component
loads and the query I would like to do
is all users and if you see we run this
we're not authenticated and let's just
get the username so now I'm going to
paste this guy here so this is going to
get run and if we're our non Sigma kid
we won't be able to see stuff but if we
are are syndicated you'll should see
things so mmm we should be authenticated
okay because we passed in our token from
the header over here it's now over here
over here we're passing in our token
which we have in local store so we
should be able to see this query right
so if I come for example and to react I
can actually look at the props of this
component here off and I should see in
the data all users and you can notice
how it actually ret we actually see
stuff so if I go to all users array $3
while you see you can see how we get
balled and stuff now if I come to this
page in an incognito browser still not
logged in
paste that in we should actually just
get an air in the console yeah we get it
air from graph QL not authenticated but
notice we're good over here right and
that's because of our tokens that we
have stored so we can actually display
the users if we care to so data and then
all users we could say you know let's
just grab the data you know or not data
all users and we'll say the default this
is just an empty array and then we'll
say Const user and the user will have a
user name and ID will display the user
by having an h1 for the username and
some might be null
that's expected and then we'll just have
any of those it will just show a bunch
of h1 and the key is going to be the ID
so here we're just going to map that
we're going to say all users dot map and
then we're just going to pass in our
user function here so now we should
display all our users here and I think
going out a couple Bob and Tim so there
we go and as we can see we can refresh
this we're not indicating anything so
that is how that's working and that is
it for this video guys so we set up this
author out we have to log in now to
access it and what I want to do in the
next video is actually show you how you
can redirect people if they're not
logged in for example I don't want them
to get to not authenticated error from
graph QL here and I can also know
they're not authenticated from the
client side so we don't even have to
make a graph QL request which will sir
which will save server performance we
can just check in local storage see if
there's a token if it's there redirect
also we can check to see if there token
is valid not valid that hasn't expired
so that's we're gonna do the next video
and just check so we actually save
request and we can redirect them to the
login page to actually log in otherwise
if they're already logged in we just
shown the content right because it works
but yeah that's it for this video guys
thanks for watching and I'll see you
guys in the next one
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>