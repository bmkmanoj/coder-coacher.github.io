<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React Client Side Authentication | Coder Coacher - Coaching Coders</title><meta content="React Client Side Authentication - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React Client Side Authentication</b></h2><h5 class="post__date">2017-07-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oRL-pttfNSc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys so I have a react
application that has an authenticated
route and what I like to do is redirect
users if it authenticated now that's a
patient check that we're going to do
today is going to be all client-side
using react router so we don't even make
a request to the server to check if
users also indicated now this is you
know now 100% for sure they could be
still not often because if they get past
this point which is okay you're just
kind of doing in this little check so we
like people who do not have we're doing
authentication through JSON web tokens
so this one who does not have a token or
the tope is expired we can just
immediately instead of going to the
server and then the server telling us
that we could actually check those
whether that's true here on the cert on
the client side and then just redirect
them to login so that's what we're going
to do so we should see less of these
graphic you'll not indicated errors so
to do this we're going to be using react
router and we're going to creating like
this little private route right here and
it's basically just going to check to
see whether they authenticated this can
be any kind of function and if they're
not authenticated we redirect them to
any page we want to in our case we
already checked on the login so I'm just
going to go to the index page here so
this is where all my routes are might
create a new component here called
private route and I'm actually going to
name this it's going to say it author
out so we're past the component and
Delta rest so here for the route route
we're using regular route here we're
saying check if they're up and kid if
they are render the component is not
redirecting somewhere so we're going to
do a different function than this so
we'll create new action called check
check off
and then we'll put that here
so checkoff will return whether or not
we're often kids and we don't worry
about passing this state here is four if
you want to redirect them after they
login but we're not going to worry about
that so let's clean this up slightly so
just recap we're checking off rendering
the component if not redirecting so
really room just need to put our
information here that we want to use to
check whether it authenticated or not
and once we do do that all we do is for
example this rat this author out on the
instead of using routes I'm going to use
author out instead of render I'm just
going to pass in the component the off
component because we're rendering it and
passing the props inside of here okay so
enter check off the first thing we want
to do is grab the token local from local
storage so local storage get I on token
and get the Refresh token as well
so then we're going to check if not
token or not refresh token we know that
something's wrong they should have both
these tokens if they logged in so we can
return false and at the end we return
true if all the conditions are met
all right the next thing what we're
going to do is check if we don't really
care as much about the token because as
long as the Refresh token is valid we
can get more tokens so we're going to
check if the Refresh token is valid now
the way we need to do that is actually
first decode the token and if it's
successfully decoded then we then check
if it's expired or not
so to decode this guy we're actually
going to use this library right here
called JWT decode so go ahead install
that some here in terminal new yarn add
to Z decode and once that's installed
what allow us to do is just run it on a
token and we'll return back just object
and then they'll throw an exception if
for example they didn't pass in a token
maybe they just and their token at that
right that's not a valid token that's or
an error so we'll do is we'll do try
catch catch err we all actually don't
even care so if there's an error you
return false right we don't need to put
there or anything but we do need to
import decode from j2z decode so here
I'm going to say Const and I guess what
we can actually do is do Const and say
payload is equal to decode of refresh
typing and now one of the properties of
payload now is going to be the
expiration date which is going to be a
number like this going something like
that right I want to check and see if
payload actually we can just grab the
expiration date cuz we don't care about
any other things and we can say if
expiration date is less than new date
dot get time so what what does this mean
let's think about it so if the
expiration date is less than new date
that means it's expired right because
this is going to tell you if it's
expired the bigger number means later in
time so in this case we would want to
return calls and that's it so this is
our check off function just to recap how
it works we first check whether we're
given tokens whether they're in local
storage not we return false
then we first try to decode token fit
can't decode we get an air will return
false then if it's a good token that we
got from the server we'll check if it's
expired if it's not expired we just keep
going and we return true so now we can
go over to that page and watch this and
action so I just want to make sure that
expired the less than new day yep bugs
good so react app so oh we need import
so we're using a new component called
redirect this is from react router dog
so just need to add that and okay so
it's ok so it just redirect this us to
this page right it shouldn't be so the
only thing I can think of is I have this
backwards so let's do consult log the
expiration date and the new date get
time so let's see what both of those
values are because we should that token
should it should not it should be good
because I just logged in so if we go to
auth prints out the two things okay so
some one of these things is in probably
milliseconds while the other one is
and not millisecond so expiration date
here is a lot smaller than this so what
is so let's Google real quick what do
see expiration date so let's see what
format that's and I think it's
milliseconds but I don't know for sure
should tell you what it should tell you
what it is the ID token refresh token
the toga oh here the different types we
don't care about the type is for 10
hours actually this number right here
so thanks fiery date for JSON web token
so what what time format is JSON web
token expired
sorry these are numeric dates JSON
numeric value representing the number of
seconds okay number in seconds so new
date get time JavaScript okay so this is
giving us milliseconds so we need to
convert milliseconds to seconds which I
believe is just 100 yeah so divided by
100 I know a thousand all right so one
millisecond equal that many times with a
thousand so here we divide u by a
thousand so now if we log it I'll see if
we get redirected still and we don't we
see it here and we can see all right
that looks better
all right so we just need to divide by a
thousand there and so notice we are
seeing it here but now if for example
I'm going to try to an incognito go to
off it notice how I immediately and
redirected to the login page so cool so
we are doing this all client-side we
didn't have to make a graph QL request
to our server to even access this stuff
so that's pretty neat right we're saving
performance we're saving time that our
server doesn't have to handle stuff
we're just checking on the client before
sending it so that is it for this video
guys I recommend just creating some
little checks with your routes right to
save some time so you can wrap now we
can create any type of route we want I
can create more of these and we could
say off to and maybe pass different
components so now you have a reusable
component and we just made that you
could basically prevent people from
going to a leftover log debt which is
pretty nice
alright so the zippers
you guys I will see you in the next one
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>