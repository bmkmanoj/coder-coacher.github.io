<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Logout users with React Apollo and GraphQL | Coder Coacher - Coaching Coders</title><meta content="How to Logout users with React Apollo and GraphQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Logout users with React Apollo and GraphQL</b></h2><h5 class="post__date">2018-03-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9gm3w-Oo_us" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys so I wanted to talk to you
about how I like to handle logging users
out and this is in the context of an
application that's using graph QL and
Apollo client on the front end now here
is one way to do it and this is with
using the new Apollo consumer component
now how I see this working is the user
will usually click on a button called
logout and so what that would do is it
would take you to a page it would link
you to a different page and this
component would be rendered and now what
this would do is it would use the Apollo
consumer component and this is coming
from react Apollo this is the one of the
new ones and inside of this it's giving
you this thing called client and this is
actually gives you direct access to the
Apollo client or the Apollo store where
all your data is stored now it's very
important because Apollo automatically
caches it to get rid of that data
whenever you're logging a user out so
that's why you'll see me doing right
here I'll be resetting the store so what
that's going to do is it's going to wipe
all of Apollo's cache and you're good to
go after that and so you won't have a
problem with basically having other
users cache data so that's a very
important thing to do the next thing if
you're using local stores to store a
token which I've done before you want to
just get rid of that so you can set the
item and whatever you call it so if we
for example token and then just set it
to an empty string and then you might
redirect them after this to a different
page like login or whatever you want to
do after you log them out so this is one
way to do logout that's very simple and
very easy with like ten lines of code
using the new Apollo component now this
is not the only way to do it sometimes
you can't just clear the token and
you're good so you might be using
cookies or you're storing something on
the server side so here's another way
that I also like to handle log outs
so there is this higher-order component
called with Apollo that does basically
the same thing as the Apollo consumer it
adds in your props a client and this is
has direct access to Apollo store again
so what I'll do is when this logout
component gets mounted I'll first grab
the client from the props and then I
might call a logout mutation and then
just await the response of this now a
cool thing about the Apollo client is
you can call query and mutations from it
so I don't have to actually wrap this
with a graph QL hire or component I can
just say client dot mutate and then I
pass in the mutation that I want to run
like this so I'm gonna have a mutation
that just calls logout and that baby
will clear the cookie for me or does
something on the server side that you
need to do I'm logging a user out and
then lastly again I will reset the store
on the client and then for the render
function of logout I'll either just say
hey you got logged out and then maybe
I'll have a link or maybe I'll be I'll
render them or switch the page once the
this has finished running and so yeah
this gives you kind of two views of how
you might do logout I kind of just coded
these in a separate little project so
this would work and really any project
and it doesn't matter what you're using
but either of these should work
depending on what they're using local
storage or you need to clear the cookies
using a mutation like this so I hope
that helps and let me know if you have
any other questions associated with
logging users out or how you'd handle
that that's it for this video guys
thanks for watching
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>