<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Redux Saga and React Router v4 | Coder Coacher - Coaching Coders</title><meta content="Redux Saga and React Router v4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Redux Saga and React Router v4</b></h2><h5 class="post__date">2017-08-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/EifOGwAW5ZM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys so I want to show you how
to use redux saga and react router
together and old big use case is on
login screen so you would type in for
example your username your password you
hit submit and then if you get the right
password and username it takes you to a
different page in your application so
what would happen is you enter whatever
credentials you have here using real
toggle you make an API request to Rio or
to your back-end and then if that's
correct we're going to use react router
and then go to a different page so let's
I'm going to show you how to do right
now so here is the code for what I have
up this is a simple react application
with a form component here all this code
is up on github if you want to check it
out but basic form component here and
then all it does is it calls on submit
tasking the username and password when
this component is filled out that's what
you saw and in our index we're just
rendering app and in our app we're
grabbing the store we have a Redux store
because we want to use Redux alga here's
our store here we're just initializing
our reducers and our sagas and we don't
have any sagas yet but we're going to be
adding one but we are going to run our
saga when we have it and then we apply a
little where to get that out then going
that's just initialization of Redux and
Ryoka saga and then here you can see in
our app what we're just doing a provider
so we can use Redux and then our route
we have two routes right now we have a
home and a login brown what I'd like to
do is after we login redirect to the
home page it's a weird correctly login
so as you can see I'm using the render
function on the log and component here
to pass prompts and this is on purpose
that way we can use the history the prop
that gets passed along it to change
pages now our login is very simple all
it is is has connected to the Rio
or nothing currently being passed the
props or functions or from the state and
our view is literally just rendering the
form right now in our reducers it's
empty
I would dummy reduce it right now I'm
not using it for anything and our sagas
are not being used this is user
requested this is just literally taken
for real Congress documentation right
here but we're going to change this how
we like it
so let's go ahead and dive into this
code so now I told you that this form
component has a onsubmit it's going to
call problems going to call passing in
the state so we can in our login say on
submit you know listen for stuff and so
one things we can listen for is so we
can get fields we can say console about
log fields so first thing we can do is
just make sure we're actually being the
data we expect to get from this so now
when I submit this I should see it go
into the console the band we see in the
console the next step now that we know
we're getting the data correctly is to
actually call an action and the action
will trigger Ryoka saga to submit this
so I'm gonna go ahead and I have an if
the actions a is file I'm going to go
ahead and export an action here now I'm
going to call my action request log in
it's going to take a payload and it's
going to return two things the payload
and then also the type of requests logon
now it's good to create a Const like
this for your action to create constant
strings that you can use and reuse in
your application so I'm going to go
ahead and do that so request login this
is action that we're going to call in
our function after we submit so going to
go ahead
and go to the connect function that
we're using here and I'm just going to
go ahead and import request login from
if we go up to directories freakin it
from actions I'm going to just pass this
with defying action creators so request
login and now and my login component I'm
going to be past that right could we
disconnected it I'm going to say request
login and then here instead of console
logging it what I'll do is I'll actually
just call request log in passing in
fields which is our payload alright so
this looks good so far
we're not doing prop validation I'm fine
alright so now we actually want to
listen for this action that we're
calling this request log in in our saga
Center saga right here we're actually
going to in this is why you want to go
ahead and use the for your types make
them constant so we can import them in
here so request log in we're going to
import from actions and now what we're
going to do is we're going to take the
latest of a request log in so here is my
saga this is what we're driving and
running in the store here you won't put
the action you would like to listen for
so take latest every time you get a new
action it will cancel the other action
if it's pending and run this one as
opposed to take a phrase you might see
instead so what this is doing is one or
it's asking what what when do I call
this function here you call it when this
action is dispatched and here you put in
the saga that you want to run this is
called such user right now let's rename
this is their name let's try login saga
so I'm going to rename this to login
side right here we're it's going to
automatically get the action passed in
with the payload so we can just pass
that payload directly in here
now here is the call function now the
call function is that where you actually
do the API call now for us we want to do
a post request to our packet so you can
use whatever you want to make a post
request I'm going to go ahead and use
fetch and do a post request or you could
use Axios or super-agent you can use
whatever you like here I'm going to go
ahead and make this in a separate file
so I'm going to call it API gif and I'm
going to export default a function that
takes a username actually won't even do
that we'll just a payload here as well
and so this is a function and inside our
function here what we'll do is we'll
actually fetch data and we're going to
make this an async function actually we
don't even need to necessarily we could
actually just return but in here we're
going to put our logic and actually does
not make this default cook you might
want to add more and later so I'm going
to create so this is we're going to
actually put a fetch function we'll do
that in a second we're going to export
console again payload so the payload
that's going it passed in is this right
here so we're just going to import log
in from our API just a file that we just
created and then we're going to call
login here now the usual thing of what
you can do is after you call log in and
for us we're going to say response here
is you can then call put and this will
dispatch an action to redux we don't
need this for now we'll just cause of
all blogger if there's an error also go
ahead and do that out there wait so the
only thing left to do now is to actually
do implement the fetch here and I know
it's fetch
then you put in your URL and I forget
how you actually do a post request I'm
gonna have to look that up real quick I
create the syntax of killing fetch you
wanna do a post request but I want to
show you before I do that is what I'm
using for my back end so for this this
is not a video about making a back end
in a registration system so I'm just
using a simple Python server I'll show
you guys the code right here hopefully
you guys have your own backends if not
you can do the same thing I'm doing this
is in flash just this is just for demo
purposes but it has one route called oh
it's running on port 30 30 and all it's
saying is if their username and password
is Bob it has success that's true if not
it is false so super basic server
running on for 30 30 so eyes on start up
that server running there
okay back to this fetch so javascript
fetch post request because I know we
need to pass a body in and stuff and
here we go and this is exactly what you
and I'm actually just going to return
this and then will automatically get the
response handled okay in our rehook saga
so posting here like I told you guys
mine is at localhost 3030 slash off you
want to point this to whether your back
tip is that you'd like to make the
request to and then the data here this
is just going to be payload and go ahead
and say this and we're going to read
lines all over this place that's because
we're only doing export defaults let's
copy this if you have if you're using
insulin you can say you cellent disabled
now you can put and we can do next slide
how you do it next line I think it's
like this
area and then you can put the rule you
want to disable because I want to add
more exports here eventually and we get
fetch fetches on the fine that's fine
well you know I'm Fred everywhere that's
how you disable one via slant rule if we
wanted to we could disable the whole
thing but we don't need to do that okay
so this looks good let's try it out
so we can close this request login
unexpected token so let's see what's
going on looks like I've been aired oh
this should be Const you save it I'll
just restart and all right so a B this
should give us a response at false
oh no access control allow origin as
this happens to you guys this might need
to get a cores
the reason is because cores I'm using a
flat server so I don't have course set
up easily you can also get a plug-in
which usually works we'll see if my
plugin works for me
a B internal air Oh looks like I mess up
my server a nun type object is not
subscript Abul well we'll see what's
going on of my Python server so get JSON
did not work so I'm just going to print
out request dot data I'm assuming what's
happening is the data I'm sending is not
in the format that my favor likes um and
that's just because I have a crappy
server I should have just made a good
sir I use Python 3 but I was like I'll
just set up a super basic one but let's
run this again and see what's going on
so we can go to the logs here
none time ok I printed out that thing oh
look it's empty the data's empty um one
thing you can check is so there could be
two problems here one either we're not
sending any data or to my servers not
handling data so I go to the network tab
here I can actually see the requests I'm
making and this isn't
and if I click on this I can see what
data I'm sending over the request
headers and I don't think I'm sending
any data actually you need to show
something here if I'm sending it so it
could be a problem here also I'll put a
link to description for this plug-in
that I'm using here to get this to work
alternatively you can set your cores on
your server alright so let's do a
console log looks like payloads not
getting passed in for some reason so
let's do console log action dot payload
and see what the value of that is I'm in
our API we're just passing payload and
that should be carried that should be
right
hey B not being sent should be there but
it's not only I turned off the server
where I'm going to connect to arm so my
servers down that's not good so I'll
show you guys what it what you can do
instead so we're getting a failure right
so we're going to this cache block I
don't know off the top of my head I
don't know how to fix my Python knife
block server so I'm not gonna worry
about fixing that but I'll show you guys
instead is the same thing of what you
can do here let's say instead of on you
know on submit so you know on success we
wanted to basically change so here I
wanted to go to home page but let's say
for whatever reason you would like to go
to the home page instead if there's an
error because we're doing an error so
let's show it changing the home page
when there's an error you do the same
thing if you wanted to do it here so
there's two ways you can do this
depending on how you want to do it
they're very similar so in our view we
actually have this history component or
this is not component of prop so one
thing we could do
is in our action here what we could do
we could do dot dot on our fields here
and we could also pass in history so
we're passing our fields and the history
object so now in our saga here in our
action we have a payload and our payload
is going to have a user name and kind of
a lot jazz so actually looks just so we
can D structure this easy what I'm gonna
say is fields I'm going to be structure
I'm not going to like spread it open the
fields on the set of fields and history
so now my saga here I can be structure I
can say payload and the payload I'm
going to have a field and history so now
I'm going to pass fields and like normal
to the call function and then here I can
say history dot push slash and the slash
here will take us to the home page now
if I wanted I could do that here right
and I could say if response dot data dot
success then we'll push to the home page
right of course this won't work because
we're getting failure but I'll show you
guys is working in action right we
passed the history in here we make the
call we're failing so we then push to
the home page so a B go ahead and submit
Oh what the heck we just get internal
server error and it doesn't even come
here console dot log catch I was
thinking it was going to the catch block
but I guess it's not even coming to the
catch block yeah look at that it's not
even going to the catch block all right
then and our API here I'm sinking it's
crashing here I don't know why it's not
catching a try-catch what we'll do is
we'll say async payload and we'll
you are try-catch in our api so try try
we're going to try fetching this this
will be conscious response actually now
we'll just return that actually costs
related over here and then we're going
to return response else if there's an
error we're going to return and what I
can do is I can say is err false and the
response and here we can say is there is
true and not return a response object so
try and this should be catch not a else
okay so we just reword this function now
what we're going to do in our login is
we're going to try to fetch if we're
able to fetch correctly in our response
will say there was non air we're trying
strong otherwise I begin air which I'm
thinking we're getting to this cache
block I'm going to consult log and make
sure caching and vlog in API we're going
to say his air so now in our saga
instead of using a catch since we know
we're not getting here so comment all
this stuff right is we're going to say
conscious response and we can get rid of
this we're going to say if response that
is air so actually we can D structure
this right we are expecting is air and
response so if is air then maybe you
want to push for some reason to that
page and we don't need to get the
response be structured since I'm not
using that right now
sorry I'll see if this guy works so a be
internal hair okay this just like
straight up
crashes and does not worry oh you know
I'm suing fetch 500 means it
successfully works what I think is
response is actually true I don't think
we're going to the cache block I guess
for fetch maybe if you're using a
different one it will work better for
you yeah look how we redirect to the
home page reason for that is there is
actually full so even though we're
getting a 500 in the console so we're
getting 500 console which made me think
that we're going to the cache block or
really just returning here so but if
this did work right so you'd still want
to check so if not is there I guess
since we're actually working I mean my
server is not working but you know it's
not getting an error then we push
alright so that is one way to do it I
want to show you a second way you can do
this and that's by like passing a
callback so here I can say callback and
then here I can do whatever I want
console dot log callback called and I
can do other things in here right and I
can also say history dot push back so
now I have a call back here we're
calling using our history prop here and
we're comfortable logging so you can do
all kinds of stuff here but then your
saga right instead of doing history
you got your call back and then all you
do is you call your call back here so if
there's on air you then call your call
back all right let's try long inning it
a B and call that cold and we then
redirect to the home page Sam all right
so that's it for this video guys that's
how I like to handle history changing
pages with redux saga and react router
sorry I can get the server to work but
that was not the main purpose of the
video anyway so it's okay I have a
stupid Python server version of you
the Python server I should just not
Express but you guys see how like look
how simple flak is I mean it's not
working so I shouldn't like show you
guys how simple it is and then gloat
about it like what got short that is to
get this set up
I guess flash or Express is super fast
super like fast to do this to like it's
super simple but yeah not a lot of code
to get this set up I mean it doesn't
work though but it's close to working I
think so yeah thanks for watching guys
all the cooking will be up on github if
you want to check it out and that's it
for this video
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>