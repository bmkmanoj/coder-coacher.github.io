<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GraphQL setup with Feathersjs | Coder Coacher - Coaching Coders</title><meta content="GraphQL setup with Feathersjs - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GraphQL setup with Feathersjs</b></h2><h5 class="post__date">2017-01-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6Jw629xrkF8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up guys in today's video I'm
going to show you how to connect graph
QL and feathers GS now before I go into
too much of how it's gonna work I want
to first just set up our project because
it's gonna take a second to generate so
the first thing is go to a command line
and create a folder I'm going to call
mine Taco Apollo just go inside of it
and then do feathers generate we set up
a new feathers j/s project when I keep
the default name description and do all
the defaults will do the any DB for now
that's easy to set up so what's going on
is if you haven't seen I'll just show
you real quick graph QL is a library
that Facebook came out with I believe
Facebook came out with if not it came in
they help with the open source project
it's a new query language it kind of
sits in between your server and making
API calls as a client you'll make an API
call and then the graph QL will then
make all the graphs the API calls on the
server for you as you can see this is
what the syntax looks like right here
and then gives you back JSON it's a new
way to parse stuff and it's pretty cool
to do and what you can actually do is
set up with feathers and it works quite
nicely and I really like using this for
projects so this is still downloading
we'll let it finish when it is finished
we're going to install two more actually
maybe three more libraries to finish
this off we're going to need to install
a palo server graph QL and graph QL
tools okay so we finished downloading
just exit and then right here before I
even actually install I'm just gonna
open up my package JSON I want to
configure two things the first is I want
to use some new features in this so I'm
going to add bable bable
so allow me to use the newer JavaScript
syntax presets and we'll do es2015 okay
and then here do babble node instead of
just note in these scripts um if you
don't have that just do MPM install
global babble node and babble if that
doesn't work for you when you do NPM
start later okay but the files we're
gonna need is NPN install save we're
going to need a hollow server we're also
going to need graph QL and graph QL
tools graph QL we're gonna have to
install a specific version which we're
about to see when we install a Palo
server
it's like version 7 or something and it
specifically looks for it this right
here so NPM install save graph QL at
zero point seven point zero so that's
why I'm installing it second cuz it was
specifically asking for something ok so
that's all set up the next thing we're
to do is we're in generate a service so
this is going to be the service that is
gonna act for our graph QL so I'm just
gonna call it graph QL it's a generic
one and does not need authentication so
just exit out of that and let's go right
into it go into source services and go
to graph QL and then index so if you
didn't follow let me just make sure you
follow the path we're in source services
and then graph QL go ahead and open up
index and you can actually get rid of
all this stuff we're gonna redo this
whole thing and set up basically the
graph QL server here you can keep the
require hoax that's fine
so we're gonna import Apollo Express and
graph IQ IQ L Express from Apollo server
and Kurt make executable schema and add
mock functions to schema from graph QL
tools and we're going to import
resolvers and this is something we're
gonna be creating solvers and then we're
also gonna need a schema for our graph
QL and we'll be making that as well
okay so modules got export and we're
gonna have a function and then here we
can do const app is equal to this and
then we're gonna do app use and we're
gonna make two routes versus graph QL
and this is where you can actually post
a graph QL and you can access it through
a client pullo Express Apollo Express
just do that so we're just creating this
route and then we're gonna call this
Express we're just setting up the server
for the graph QL server here and then
we're gonna get the we don't have to
worry about any kind of authentication
in this app for now we're just gonna
return schema is equal to execute a bull
schema okay
and then down here oh we actually need
to set up the excuse you know forgot
about that to do Kant's executable
schema is equal to make executable
schema and this is just taking will be
setting this up in a second here type
def schema and resolvers resolvers dot
call app okay so this is just telling a
graph QL what our scheme is gonna be in
what to do what functions to call all
right that's it up here actually or this
comm at the end here the second route we
want to do is to actually play around
with this you don't actually want this
in production but for testing it's good
it's the interactive a little shell or
not shell but we'll get they have that
graph QL gives you and this just allows
you to query the database and test out
all your different stuff okay and then
we just have to tell it where to
actually make the calls to graph QL and
that's our endpoint right here okay so
we just set up the index page the next
thing is we want to make these resolvers
that we are importing so resolvers and
this is in the same folder solver cas
and we're gonna be creating a function
export default function resolvers let
app equal this and now actually you know
what i think it'll be better if we make
the schema first so they'll make more
sense what our resolvers are going to be
so let's hop to schema real quick so
we're gonna create in the same folder
oops
schema yes and this we're actually just
gonna make our schema type def
we're gonna just make our schema as a
string so export default type
definitions and then inside here we'll
just make some type definitions that we
want to set up now for this example
we're going to be setting up a taco
service so we're gonna create a type
called taco it's gonna have an ID which
is a string and then it's gonna have
meat which is also a string cheese which
is also a string and then salsa which is
also a string and then we're gonna
create a type another type at the root
query and we'll have tacos and this you
can query based on the meat string and
we'll say this is required and it's
gonna return a list of tacos we can get
a specific taco by you passing in the ID
and I'll return just one taco and then
we can also create one more all tacos
oops
which will return again a list of tacos
so that's our one type that will be
querying from now we want to be able to
create tacos let me create a type called
create taco and the route mutation so
create taco passing in meat and that's
what we'll say that one's required but
we don't need to have cheese we'll say
leave that unrequired and salsa son
acquired
and this is going to return of course a
taco at the bottom here just set our
schema which is gonna have a query as
root query and then the
mutation root mutation okay so this is
our schema right here we have a one type
of taco we can create tacos and then we
can query different tacos using our root
query okay
so let's go into the resolvers and
actually make those functions that we
just did there okay so to handle this
we're gonna first create our tacos
service app dot service tacos and this
is a service that we're gonna be
creating and actually let's create that
service right now real quick so it's
very important when you're creating the
service to go back up to the root folder
so you'll notice I have the package shop
JSON and then new feathers generate
service because for some reason when you
do feathers during a service if you're
in a different folder it will generate
it there it's kind of local which is
kind of annoying so I'm gonna call this
taco it's gonna be use a database and
it's going to use the any DB and no
authentication okay exit out of that
okay so our service is set up now I'm
gonna go back into the source services
graph QL and now we're gonna finish up
our resolver okay so we do have our
service um we're going to just return
and inside this return statement we're
going to be creating some properties
that are going to be used by the root
query and then also the root root
mutation and just put a comma there
we'll start with the root query inside
here we gave two types of queries there
are actually three types of queries we
could do all tacos passing the root and
this took no parameters here so they're
just empty arguments
and then also the context and what we
want to return it's just
tacos doc find and then we want to find
basic all the tacos so we're not going
to pass any parameters defined and
that's it that implements fine all tacos
it's that easy now we're gonna do tacos
which what we're looking for is we're
gonna pass in a meat so we will grab me
from the past in this is a king of the
parameter from the context and we're
gonna return tacos which return tacos
find and this time we're gonna use the
query parameter meat and what this will
do is I'll go and find all tacos that
have the same meat all right and then
we'll create one last one called taco
root and we gave it an ID parameter and
this allows us to just go get the taco
with that ID and that's all our root
query it's all it's all done already
it's very easy to implement these and
feathers so the X we'll do create taco
for our route mutation pressing in route
and then the data to create it and then
context we don't have to break down this
data we could also do like meat cheese
salsa but we're gonna pass in a hold the
whole object back into the create
function so you can just say data and
then do return tacos create data and you
have to pass in the context here okay
now our resolvers done our schemas done
and the whole graph QL service is done
but there's a couple things we have to
make sure that are correct before we can
actually use the interactive prompt that
we made if we go over I'm just gonna
start the server so NPM
start I'm just going to make sure this
starts okay
we'll just leave that in the background
for now it could take a second but
what's important to do is to go into the
services folder and look for one called
index and you'll see all these things
configured now it's important you see
how graph QL is above taco
we need graph queue at the bottom
because if we we need to configure taco
first because we use this taco service
in our graph QL if we have graphic
you'll appear graphical doesn't know
about taco and cannot use taco and the
resolvers and so it causes an error so
make sure graph QL is on the bottom and
this index file second thing if you go
to the taco service so this is under
services taco and then index you'll see
it has a paginate right here remove that
that gives you problems when you're
trying to get all the tacos and it only
gives you a page of tacos and it doesn't
play nice with graph QL so just remove
that and doing those two things we
should be good let's see what this is
not liking we could've done a small it
looks like we did well err be sure you
notice it's pushed up there I'm just
gonna run babble myself okay move up one
more suit or more files so babble node
and call on the source and let's see
what the problem is
oh and it just looks like there's a
syntax error so if you open up graph QL
and then in index I just put a semicolon
here and it should not be there and so
if you guys didn't see that I did that
pretty quick and graph QL index down
here the endpoint URL should not be a
semicolon at the end I was incorrect
JSON second thing up it looks like I
have a something messed up in my schema
so let's go to this schema real quick
so that was in graph QL and the schema
up goes create taco create aa code needs
to be parentheses not what's it called
curly braces my fault
restart run the server again and it
looks like it started successfully
getting rid of those little airs so now
if you go to localhost 3030 slash graph
iql you should see the little things
that allow you to call graph QL things
if you've never used this before it's
pretty cool I'll show you some of the
things you can do with it so we can do
mutation and then we can create a taco
so to create a taco we're just going to
pass in the parameters meat so let's say
I want some chicken on my taco cheese
I would like cheddar and salsa
I would like spicy and if we run you'll
notice it will return back this object
and it'll create the taco for us now
notice this right here this tells you
what's gonna be returned back so for
example if I just wanna know the meat
still makes an object of taco with all
those properties but only returns back
to me that so we can create a couple
different ones since I've said or maybe
I want parmesan because I'm weird and
then maybe here I'll have some mild
salsa and here maybe I don't want
chicken I want to be its create another
one with tofu so we have a couple tacos
in our database we can now get rid of
this and we can start querying it so we
did all tacos and let's just BAM run
that and we get all the tacos in our
database right here so you can see I
made a bunch of tacos we
also queer you in different ways we
could do the tacos passing in the meat
let's see I'm feeling vegetarian today
just give me those tofu tacos BAM
just give me only a tacos that have tofu
as the meat I can do chicken here and it
would query the chickens and then let's
try our last one where we passing an ID
so let's copy the ID of one of them and
then we can do taco I see an ID and
that's a string so rap in quotes and
oops taco is not defined okay so this is
an error we just set found so okay
notice this is not a good return this is
a problem with their feathers code so
let's go and do our feathers code and
see what's wrong so Ted said tacos not
defined I think it's gonna be somewhere
in our resolvers so if I should go
graphic Yoel and then resolvers tacos
create it'll be okay here so I call it
taco it should be tacos so make sure you
change that go graph QL and then our
resolvers and then restart the server
and then I'm just going to restart the
page and then run it okay and we were
able to get the taco by just grabbing by
V ID so that is how you set up a graph
QL server with feathers J s it's not too
bad and it allows you to you know easily
combine a lot of services now I'm just
using one service and this just show you
and demonstrate how this is set up if
you would like to see a video with how
to set this up with multiple services in
querying from several different in a
more large scale application positive
possibly maybe you want to see some
authentication leave a comment below
and let me know if you want to see more
stuff using graph QL and feathers J s so
thank you so much for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>