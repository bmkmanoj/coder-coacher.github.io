<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Search and Sorting Products - Part 18 | Coder Coacher - Coaching Coders</title><meta content="Search and Sorting Products - Part 18 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Search and Sorting Products - Part 18</b></h2><h5 class="post__date">2018-02-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ja4aVMNN240" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys this is gonna be a pretty sweet
video cuz we're gonna be getting name
price sorting by those guys and also
this search bar as we type filtering
down what fields we see now you could do
this type of sorting so when I click
this button what I'd like to happen is
I'd sort by the price if I click it
again it sorts it the opposite way and
same for the name and one approach that
we could do for this is just do this
sorting client-side and what I mean by
that it's just sort the data that we get
from the server right here so we could
put it in our state and sort the state
but one thing I don't like about this is
we need to think ahead when we add
pagination so when we do that it's gonna
get everything from the server and you
might not have the whole list and if we
don't have the whole list we can't sort
on the client-side so we're gonna be
sorting by sending a graphic you'll
query saying how to sort our data and
way we can do this is just adding some
stuff to the query we already have we're
calling that products query right now to
get it and there's some fields we're not
utilizing and one of the fields is order
by and in here I can specify an optional
product order by input and this is where
I can put how I want it sorted so let's
go ahead and add this so right here I'm
going to say so this is our products
query I'm gonna say query and we're
gonna add a variable called order by and
I'm just gonna copy the key type that's
over here cuz this is the type that we
want to pass in and we're gonna pass
this to our products so order by
now by default we can save this and
nothing's gonna change over here because
we're just passing no right we're not
passing any variables in and that's fine
we don't want to order buy anything off
the bat so now what I want to do is when
I press this button for a price for
example I would like to get the data
sorted and the way you can do this with
graph QL or Apollo is there's a function
called refetch that they give you and
this comes from the data object and this
is coming thanks to graph QL and Apollo
we can just call refetch and how it
refresh works is you just pass in the
new parameters you want to change so for
us we did not have order by in the
original query so we'd like to add that
here so we're gonna say order by and now
we pass how we want to order when we
refresh the data so weary fetch the data
we want order by the price and we want
to say ascending for now so let's add
that give it a safe alright so 11 123
want this number and then 213 and all
right we see it does go ahead and
reorder it for us so nice so now the
next step is when I click on this I want
to get in reverse order so another thing
we can get from data is called variables
so we can see what variables we passed
into this query so I can say variables
and I can look for the border by and if
it's equal to price dot ascending then I
want to make it price descending
otherwise I want to keep it priced out
of Sydney so here we're just doing a
simple check seeing if we've already
fetched this before with the price equal
ascending if it is then we switch it to
descending otherwise we keep ascending
so let's see if this works and it looks
like it's working to me
so here the biggest numbers we can
scroll down smaller at the bottom and we
can flip this the other way so nice so
let's do the same thing for the name and
you guys are seeing how easy this was to
actually add thanks to Prisma right
because they had this order by and I'm
just gonna paste it in and we got too
much and it's gonna be the same logic
right the only thing I'm changing is
instead of the word name out their price
we're gonna be using name so I'm just
gonna copy and save that and let's
reformat this so it's easier to see
there we go
so same condition but now we're checking
it's the name so let's do the price
now I'm gonna refetch my name I can flip
the name now we're at W at the end so
cool I think that's working nicely so
now we have both our sorting functions
the name and price the next thing that I
want to do is search so if we come back
over here with our query how would we do
search well there's another one called
where that we can utilize and n where we
can actually pass and it contains so
name dot contains and that's how we're
going to do it we're just gonna pass a
string of what is contained in that so
for that we're gonna need a new variable
here so this is just going to be we call
it query for example which could be a
string
and and you know what I'm actually not
even gonna pass it and like that I'm
just gonna call out where and we can
just copy this exact thing and so it's
gonna be a product where input that way
we can pass an OL to it at the beginning
and it worked out well so here I'm just
gonna pass where it's equal to where and
now I'm just going to rerun this make
sure we didn't break it by adding that
cool and now in my state I'm just gonna
keep track of the query so at first it's
going to be an empty string and then in
my text field here I'm gonna say value
is equal to this top state dot query and
then we're gonna say on change text and
I think that's how I did it yep on
change text looks like actually okay
yeah we just get it from the props and I
think that you passed the name and the
text in for us that doesn't really
matter cuz we only have one text field
here so I'm going to say on change text
and we'll go ahead and handle it here so
name text and this is really the art
query so I'm gonna say this that's that
state query is equal to text so on
change text we call this dot on change
and so after we do this we also want to
so we're updating the state right we
also want to refresh so we're gonna say
this stop props stop query we're talking
about query data dot refetch so we're
calling it in the same way here we're
getting this from the props data refetch
passed in our variables and then here
our variable is gonna be where all right
and then what do we pass to where well
we want to do name underscore contains
name underscore contains and then this
has a string and the string is gonna be
the text so give that a save a nice so
now we're gonna refetch with this where
all right so let's give it a try I have
no idea if this will work it should
search every time we type a letter so P
not only the peas so P 3 another thing
to think about is how we want these two
to interact right so now we have name
and price here doesn't look like it
changes anything price okay so it goes
ahead and sorts it I was thinking what
it might do is just overwrite that we
ready fetch it with the P but looks like
it doesn't alright so that seems to work
nicely with integration they might why I
know it was a bit like that bad what
else can we search Sally alright so I
think our search is good now another way
you could do this instead of fetching
every time the user type something like
this we could just wait and then for
them to hit enter right so type a type
hit enter and then do the search but
typing like this every fetch is also
kind of cool to see the results just pop
up really fast so nice I'm pretty happy
with this let me know what you guys
think about this I think this is pretty
sweet and that's all I wanted to do with
sorting and filtering
we're now able to search and change by
name and price stuff I want to look at
next I mentioned was subscriptions and
pagination not sure what I'm gonna do
next
but one of those you'll be seeing
tomorrow that's it for this video guys
thanks for watching
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>