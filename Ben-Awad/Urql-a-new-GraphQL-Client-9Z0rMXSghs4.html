<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Urql - a new GraphQL Client | Coder Coacher - Coaching Coders</title><meta content="Urql - a new GraphQL Client - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Ben-Awad/">Ben Awad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Urql - a new GraphQL Client</b></h2><h5 class="post__date">2018-02-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9Z0rMXSghs4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys some interesting stuff has been
happening in the graph QL community so
recently a new library came out called
Oracle now what this is trying to do is
to be a client for graph QL similar to
how Apollo client works now if we
already have Apollo client why does this
even need to be a thing right well the
goal of this library is to be a lot
simpler than Apollo client if you've
used it before getting started is not
the easiest you have to install a couple
packages and they wanted this library to
be plug-and-play
so you just install one library and
you're good to go you don't have to
worry about all the different options
there's a lot of ways to configure and
do advanced things with the pollow
client and that's not always necessary
so that's the goal this library so we're
gonna look at this library and I'm gonna
kind of compare and contrast the things
I like about it compared to Apollo
client so to help me out with this I set
up a graph QL server there's this nice
project called Launchpad graph QL and it
allows you to just create a little graph
Gale schema and then it creates a
endpoint for you so here I have a really
basic API or a graph QL schema so here's
my database right here I have some
colors and here's the type of them I
have an ID in a name and then I have
some queries I have colors and colors -
these are the same queries and we'll
talk about that later
and then mutation I have one mutation
where I can delete a color and it just
removes the first one so now I set this
up here and here my resolvers for it you
can notice in miss Drake returning the
data slicing off the first one and I can
run the queries over here to test them
out so here is grabbing the colors get
an ID in the name it also has Apollo
tracing on it but that you don't worry
about that so now I can access this this
data or this graphical schema with this
endpoint here and you can as well
because this is open it open to anyone
to access I believe so I set up a code
sandbox with using Oracle to connect to
this and then run some queries so this
is how you set things up so you just
import stuff for an Urkel you need a
provider and client to
Justino to config it so here you create
a client and you just pass in the URL so
this is the URL that I have over there
to that graphical schema and then you
pass the client to the provider and now
anything inside of provider is allowed
to do graph QL queries and mutations so
let's look at colors and that's where
I'm doing a query so over here I am
importing Connect query and mutation so
if you use the paulo client before you
would use gql to pass in and to create a
query or mutation with this you just
pass in query and then there's another
parameter you can pass over here if
there's any variables you want to pass
in and you just pass in with an object
like that so here's my query here's my
mutation you'll notice I'm clearing
colors and colors too and here's the
mutation and then how do I actually
inject this into my code so with the
Paulo client usually what you have is
you have a higher-order component but
with this you have a rendered prop is
how it works so I have a connect
component and I say what query slash
mutation I want to run so I want to run
a query and a mutation now it doesn't
actually run the mutation until I call
it but it does go ahead and run the
query for us and you'll notice what I'm
doing here is I have a function that
takes some parameters and these
parameters are given to us by this
connect function or this connect come a
component so if they have loaded a data
and remove color so notice how I passed
it in here so this is the key and this
is the value right so the key we're
gonna have that same name here and so we
could name this whatever we want so this
is how you name mutations you pass in an
object with the name and then the actual
value and the actual value is the
mutation itself up here okay so now I
have this function that takes these
parameters and I just return back some
JSX whatever I want to render right so
here I had just had react fragment and
then I have two lists I'm just mapping
through the colors right and then I'm
returning a list item for each one with
the key being index which is actually
probably not the best but then we're
just doing displaying X dot name and
then when I click on the button I remove
a color so yeah so we just put this
inside to connect and that's how we make
it so let's take a look at what this
looks like and let's just refresh and we
have there we go
I thought for a second we had a little
crash but it looks fine okay so here's
the thing that I really like about
Burkle so how caching works so one
problem I actually had with Apollo
client is there's not a way easy way to
like invalidate things in the cache so
when I delete an item it's not easy to
remove it from the cache so this is more
of an advanced thing but I really like
utilizing the cache and Apollo where
after I make a query it doesn't keep
running a query if I run the same query
it doesn't hit the database or hit the
server it'll cache it for you which is
nice so when I delete an item I want to
update the cache and say the item is
gone right and this is something Oracle
already does for us so I'm gonna click
here and remove a color and you'll
notice after it makes that request comes
back red is gone on both of these lists
so that is super cool and notice I
didn't do anything right there's nothing
to tell it to invalidate the cache or
anything it's just a mutation and I
returned back this ID so hello Oracle
knows to remove that is because I have
an ID and the ID matches one of the IDs
and the colors and also the type name so
I'm returning a type so it's important
for with Oracle to return the color you
delete all right and the color needs to
match the type up here and that's how
our Cole knows to remove it which is
really sweet and it remove it off
multiple queries and that's why I did
two queries to show you guys that it
doesn't just do it for one so I have two
colors here so these are two queries all
it looks for is both of these queries
return an array of colors and they have
the type of the ID that just got deleted
so it'll go ahead and remove it for you
which is super nice and this is
something that's not easy to do an
Apollo at all so what I want to do is
show you like this exact same code with
Apollo
so here's first off how you can create
Apollo so at least this is how you would
do it a couple weeks ago so with Apollo
client they have this Apollo client
preset to make things simpler so this is
where you can get your client your HTTP
link your cache so notice already
there's some more stuff going on and
then we have our provider so you notice
this looks very similar except they call
it Apollo provider instead of a provider
but there's a few more things that goes
into the client right so with the client
you can choose the link that you use so
it might not be HTTP and that's one of
the things I don't think Kirk will has
subscriptions yet so that's a miss big
missing part out of it and then here you
can set aside the cache so you can
change up the cache but also you can
actually have custom caches in Oracle 2
but it basically has defaults for it so
now let's take a look at colors so exact
same code at least it does the same
thing except for it does not update the
cache and we'll look at that in a second
so here's what it looks like and let's
refresh and also this is pulling from
the same server so I think red will not
be there ok it is there cool I was
thinking since we removed red over here
that it would just be gone but it looks
like it's still there ok that's good so
here notice how I actually pass in
higher-order components over here this
is how you name a mutation so that's a
little bit different and then you get
the props in here like this
and I believe with Oracle they have a
higher-order component to you can use if
you'd rather use that instead of the
rendered prop ok but here basically the
same thing but what I wanted to show you
guys is when I remove a color nothing
changes here or not over here of course
but the red doesn't disappear right if
you use the Paul before you know how you
can you can change this right so you can
in here do update
query and then you can pass in you can
update the query after this mutation has
run right so I could come over here and
update the color query but here's the
thing you have to update each query
individually which is really no annoying
what I'd really like to do is I'd like
to remove the item in the cache and then
for it to automatically update all the
queries which is kind of how Oracle's
working so I would have to do update
query and read this query from the cache
and read this query from the cache and
remove the item from both which is
pretty annoying so this is something
that Oracle has a huge advantage on with
their caching being able to auto do it
like they do here and hopefully oh did
it I think it actually okay I think it
refreshed and now it has it I don't know
what's going on all of a sudden okay so
red and yellow so this thing I want to
just see which items we have in our
database okay so we have red and yellow
so now if I remove an item from here and
i refresh it should be gone okay good so
it is working correctly but notice we
have to refresh to get that change
because it does not auto update the
cache so Oracle is that you're able to
actually invalidate the cache if you
want to and you just have more control
right now so I'm really hoping Apollo
will catch up in that and so this is
kind of something interesting so Apollo
saw that Oracle came out right and they
had this rendered prop and this is like
all everyone's super excited about these
type of things these days they like it
over high order component a lot and they
saw that it had this and so Apollo
actually came out with their own version
of it and like their own version of
instead of having to install react
Apollo and all these different things
because also notice on the colors page I
have to install graph QL tag and I don't
know if I could hear the dependencies
right so I had to install Paulo client
preset graph QL and also react Apollo so
three different packages to get this
work
whereas a circle just one so Apollo
countered this and basically created
their own version of these things called
Apollo boost which I'll be looking at
tomorrow but I don't think I'm gonna be
switching over to Arkell quite yet
because there's definitely some missing
things it just came out it's really new
and I don't think it has version 1 out
yet so it's it's not for use in
production yet at least you probably
don't want to but I think it has a lot
of potential and I really hope Apollo
like learn some things from Oracle and
take some things and I'm hoping that
they'll be able to catch up with the
caching and being able to invalidate
things because it'd be really nice to do
those things but also Apollo just has a
lot more configuration Oracle's nice for
little tiny things but Apollo is really
great when you need to go you know
you're building something real there's a
lot of different options you need that
Apollo has now both of these are on code
sandbox so if you want to come check out
any of this code you can you can try
both of these examples and they should
work and then also if you come over here
to Apollo launch pad I'll put links to
all of these if you want to come over
here play around with it and see how the
code works and what's running so that's
it for this video guys like I said I'll
be checking out Apollo booth tomorrow
but yeah those were my thoughts on
Oracle
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>