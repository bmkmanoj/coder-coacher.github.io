<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Populating Dropdowns in PHP (1/2) | Coder Coacher - Coaching Coders</title><meta content="Populating Dropdowns in PHP (1/2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Populating Dropdowns in PHP (1/2)</b></h2><h5 class="post__date">2014-12-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/X5rfX9utf5M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright so in this video we're going to
look at creating a dynamic drop-down or
a select HTML element containing options
that come from a database so I'm
basically pulling what you can see here
from a database here so we have two
tables so we're going to be working with
MySQL SQL joins here and this users
table just contains a and ID which is an
auto increment and then a user name so
that looks like the following the ID is
obviously an integer it's unsigned its
primary key of this table and we have an
auto increment extra on it just so when
we create records this increments we've
obviously got a username which is a
varchar' of 20 so we've got them fields
there to play around with
I'm keeping the profile information
separate but I'm joyner I'm so joining
this fire a foreign key you don't need
to set it up this way we'll do all that
within the query but essentially here
we've got an ID which we can sort of
ignore this isn't really that important
but we've got a first name and a last
name and then we have a user ID that
this relates to so for example Alex
Malcolm is at user ID of 3 3 elevator
users ID of 3 we have this Alex M which
is that user so what happens when we
select a user and then hit fetch details
well what that's going to do is it's
going to put in all of them details at
the moment this is just print our ring
on an array you know you can do whatever
you want with this data when you have
finished this video it's entirely up to
you how you use the data it's it's going
to be completely different for most
people but this is basically what we're
going to achieve by the end of this
video so it's fairly straightforward to
set up it isn't really that complicated
let's take a look at the code alright so
I'm starting out with not much at all
the only thing that I have done is I've
created this start file inside of an app
directory and all this is doing is it's
instantiating new PDO object we're using
MySQL as our driver because I'm using
MySQL the host is localhost or 127.0.0.1
I'll do is require this in on any
for any pages or files that I want to
use this so let's require that in just
to start with because we know that we
are going to need a connection to a
database and just a warning this code is
going to be very verbose it's all going
to be on one page it's not going to be
the nicest structure but you can
refactor this into your own project to
make sure it said well-written and not
all lumps on one page of course if you
are doing very small application you
could get away with this so the first
thing that we want to do then is
construct a query or an SQL string if
you like to pull in all of the
information about the users and then we
want to join on that profiles table so
then in your drop-down you can even
display things like their first and last
name if you really wanted to so we're
going to have a variable here called
users query and this is just going to be
a string so I'm going to pull this down
onto multiple lines just so it's a
little bit easier to read and we're
going to select something from these
tables the first thing I want to do is
pull it users ID and then I want to pull
it users user name now we're explicitly
defying the table because we're going to
be working with joins so we want to
specify which table this data is coming
from we could of course say users star
with an asterisks to pull in all fields
but it's unlikely that you're going to
want to pull in all fields so the next
thing then is to pull in users profile
first-name so it's just this field from
this table and we're going to do a
similar thing for the second name or the
last name and do this now where do we
want to pull this from well initially we
only want to pull from the users table
but we then want to join on using a left
join we want to join on the users
profiles table the reason we the user
left join is because we know that the
user would always exist but the profile
may not exist it depends on how you set
things up so we need to choose the
fields to join on in this case it's
where the user ID equals the users
profiles dot ID or user ID rather so
this should be enough now to put in all
of the information we need so let's
create a user's variable and we'll use
our database to query that
so we'll say users query and from here
we should be able to loop through this
to actually display all of the users so
let's end the PHP tag just there so we
can write some markup down here just a
basic document we'll do it doesn't
really really matter that much I'll just
give this a title so inside of here then
let's just practice looping through the
results from our query so I'm going to
create and open some PHP tags or start
and close and we're going to use a for
each loop here you don't need to do it
like this but it just makes it a little
bit easier to inject markup if you do it
line by line so we're going to say users
I'm going to fetch all this is going to
give us all of the records it returns
all that query returns and it's going to
give that us back as an array so we can
use our square brackets to access each
field value so we'll end the for each
loop just there and inside of here let's
just test echoing out we should say as
user mr. outside we're going to echo out
user and then we'll access user name key
from that which should give us when we
refresh a list of the users names so we
know that we can get them now that's the
first step the next step is to actually
put these into a drop-down so to do this
I'll just start back up here and I'm
going to create a form with a post
action in fact let's change it to get
it's a little bit easier and the action
here I'm sorry the method is going to be
get the action is going to be listing
dot PHP because we're just submitting
back to this page and then inside of
here we want our drop-down so to do that
we have a select with a name of user so
we'll call this user
and then inside of here we're going to
have many options and the value is going
to be the users ID and the text within
the option element is going to be the
users name but let's just say choose a
user and leave the value empty for this
one just so here down here we can loop
through and at least initially we see
this rather than the first user for
example so what we can do then is we can
actually move this up to here and it's
just indent this and then in here we can
create our option so for each of the
users that have been returned via this
query we can now output an option and in
here we can replace making this dynamic
so we can echo out for example user user
name and for the value we can echo out
user ID where when you are working with
outputting directly from a database make
sure that you are escaping with HTML
special chars just make sure you're
being careful at what you're outputting
blindly from your database so now we
should have something a little bit
different we've got a drop down without
chooser user option and then we've got
the list of these names here now if we
inspect the page and look inside of our
developer tools let's inspect this
element you can see that we actually
have Alex Billy
Alex M and Jun and we've got one two
three and five which obviously relate to
the IDS in our database table so we're
now ready to submit this and because
we're using a method of get this is just
going to be passed directly from the URL
in the query string so we need the
submit button first of all so let's
create a submit button just here and
I'll just say show details can be
anything so what we can do now is with
the submit button in place we can click
on a user hit show details and that then
appends to the query string in the URL
and now we've got user equals one we can
do the same for like another user and
that will just change that value so now
what we want to do is actually fetch the
detail
about each of the user that users that
we're selecting so we up here are going
to do an if statement and this if is
going to check if that user key exists
in the get super global array and that
sounds a little bit more complicated
than it is but it's just checking if
that value exists in the get super
global which is basically what we see up
here and we can access that in PHP using
other underscore get so if that does
exist then what we can actually do is we
can expand on this query to actually go
ahead and only pull in this information
where the user ID is a specific user so
for example we would do something like
where ID equals one bill in the first
user so we can just append on to this
query in a more complex situation this
wouldn't be ideal to have to do this but
since we're just playing around we're
trying to be as efficient as possible
with this example so I'm going to create
a new variable called user query so not
users query but user query and again
this is going to be a string and all
we're going to do inside of here is
we're going to put in the users query
but on the next line we're going to say
where users died e equals and then we're
going to add a placeholder because what
we're doing here is we're taking a value
directly from the URL and placing it
into a query so we need to be careful
about SQL injection so I'm going to
create a variable called user and we're
going to prepare this statement or
prepare this query so I'm going to pass
in user query which is our string here
and then I'm going to execute it passing
in the replacement for this placeholder
so in this case it's just user execute
we don't need to assign it to anything
and inside of here is an array the first
key is just going to be the name of the
placeholder that we gave here so in this
case it's user underscore ID and we'll
assign that the value from our global
out
get superglobal array so let's get user
so now we are going to have a selected
user and that's just going to be user
fetch we're only pulling in one record
so we don't need to use fetch all and we
choose how we want to pull it in in this
case I want an associative array which
will basically mean that the keys or the
fields from each of these will be the
key of the array so we can just easily
access them so why don't we just do a
var dump on selected user here just so
you can see how that this works okay so
let's get rid of this in here and let's
choose a user so I'll choose the first
one in hit show details and as you'd
expect we now have all of the details
including first name and last name which
remember came from that other table and
they're all within one array we've got
four elements here we can always go back
and update the query if we want to pull
in more so I'm not going to write them
there cuz that's silly what we are going
to do is underneath the form we're going
to if this selected user is set we're
then going to just do a print R on it
and in this case what you could do is do
anything you want with these with this
array it's easy just to access the eight
array elements so if the selected user
is set here and we'll just end that if
just there inside of here why not let's
put this inside some pre tags which
basically preserve the formatting of
something like print R we don't need to
echo this so an echo or a print art and
selected user so now we get the
following so if you did want to go ahead
and access a user name first name or
last name all you need to do is do
something like echo selected user and
then the name of the field so in this
case we'll just say last name so in that
case it would pull in the last name we
choose someone else it pulls in their
name so that's pretty straightforward
but there's one thing we need to
do just to tidy this up a little bit we
know how to do this and we're done but
at the moment when we have a user
selected the drop-down doesn't know
where we're at there's no selected
attribute on any of these options to
tell us where this should be
automatically selected when we reload
the page or when we submit the form so
we're going to do a little bit of logic
inside of here so remember this is where
the value attribute starts and this is
where the value attribute ends to select
an option within a select element we
just say selected and that will
automatically select that element but
what we want to do here is open closed
and PHP tags and we want to only output
selected if the currently selected user
matches the user ID within this loop so
this is a bit of a long way to go around
it but if you structure application in
the right way this will make it a little
bit easier so what we want to do then is
we're going to use a ternary operator to
do this so we have a condition here then
we have the first result and then the
second result if there's basically an
if-else so if this condition is true
then we do hit this or output this so
what we want to do is echo this
condition now otherwise if that's not
true we just do an empty string in the
case of it being true once so selected
and this doesn't really make sense at
the moment because we don't have a
condition I've just written condition
but the condition here is going to be to
check if the user is if the selected
user set so we can do here say is set
selected user and the selected users ID
equals
the currently loot user so say for the
first record this will loop if the user
that has been selected if their ID
matches the one in this loop then we'll
just output selected so what we can do
here then is if we select say Alex and
hit show details we inspect this select
element you can see that the option of
value one because we're doing that check
with IDs without put selected here and
again if we do these for example if we
click on Billy
it just changes the selector to Billy so
this is a very basic example of how we
can do dynamic dropdowns pulling details
from our database and of course we've
also looked at basic SQL joins</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>