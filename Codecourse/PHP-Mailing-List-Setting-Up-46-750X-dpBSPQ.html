<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Mailing List: Setting Up (4/6) | Coder Coacher - Coaching Coders</title><meta content="PHP Mailing List: Setting Up (4/6) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Mailing List: Setting Up (4/6)</b></h2><h5 class="post__date">2014-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/750X-dpBSPQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we're now going to install male guns
official software development kit for
PHP and this basically acts as a really
easy way to add users to lists which we
just created a moment ago and do things
like send out email etc etc there's lots
we can do here so we're going to need to
install this with composer I mean we
don't have to but the best way probably
to do this is with composer so if you
head over to packages and have a search
for mailgun slash mailgun PHP or
probably just mailgun PHP now if you
don't have composer you're going to need
to head over to get composer to org and
install composer basically composer is
just a dependency manager for PHP and of
course if we're building an application
that sends email with mailgun then the
mailgun PHP sdk is a dependency so if we
basically head over to a terminal this
works on Windows as well and run
composer that just confirms that
composer is installed so as long as
you're within the mailing list directory
or wherever you're storing this we're
good to go
now inside of sublime you can see that
I've got a root directory here called
mailing list
I've got subdirectories like CSS and
these are the this is the mark-up for
the forms that we'll be looking at later
inside of the root directory though if
we create a new file we're going to save
this as composer JSON now what this does
is it allows us to specify all of the
dependencies that we will require for
our project now on under packages you
can see here that this is the dev master
basically instance of the mailgun SDK so
what we're going to do here is once
we've created this we can then run
composer install what they'll do is that
will install the dependency and any
dependencies that the mailgun sdk has as
well you can see that it has a couple
here and then that they're then
installed inside of this vendor folder
now inside of the vendor folder we also
have this auto load dot PHP file which
we can include to allow us to access the
functionality within this mail gun SDK
so what we're going to do is inside of
mailing list we're going to create a new
file and I'm going to call this init dot
PHP now inside of here we're going to
create everything that we may need
between confirmed PHP send dot PHP and
subscribe dot PHP so this just gives us
the ability to specify everything here
so you don't have to repeat ourselves
now this can be depending on your
application included anywhere there may
be different ways for you to do this but
let's basically create a new mailgun
instance a new mail gun public instance
and let's also create an opt-in handler
we'll look at our so what we do with
these later but the first thing we need
to do is actually allow us to take the
mail gun API and use it so we include
autoload PHP from the vendor folder
which was installed with composer now
I'm going to define here a couple of
constants and the first one is male gun
key now the male gun key is what you
have on your dashboard over here so we
can just copy and paste this value and
we can paste it into there and we want
to define the male gun public key as
well which we also have out on our
dashboard here so I can just copy that
and paste that into there so we've
defined them now there's a couple of
other things that we need to define as
well the first one is the domain that
we're working with and remember we're
working without test sandbox domain so
let's say mailgun domain and all we need
to do here is copy and paste this value
and base that in there now we will also
need to go ahead
define the list the way adding users to
remember we all already created this so
let's grab the domain for this will the
address for this rather so if we head
over to the mailing lists tab this is
the address for it here it's basically
whatever you called it at your sandbox
domain or your domain if you have one
added remember we can't use this sandbox
in production so we're also going to
define a secret phrase or passphrase if
you like that allows us to pass this in
when we're generating things like hashes
this just ensures that no one else knows
this value and they can't generate
hashes on your behalf and I'm just going
to write anything in here but you can
just write a load of rubbish in here it
really doesn't matter as long as it
stays secret so now what we want to do
once we now that we've defined all of
this information we're going to be using
this in all of these files so it's
useful to have constants like this we're
going to instantiate two mailgun
instances one providing in our public
key and one providing in our private key
so the first one we're just going to
call male gun so male gun is actually
named spaced under male gun so we need
to do this male gun / male gun and then
we provide in our male gun key it's as
easy as that and that gives us all of
the functionality we need to add users
send the email etc etc now I'm also
going to create a variable called male
gun validate and we use this later on to
validate email addresses and what this
does is when a user's subscribing to
your list it validates that this isn't
an email address that's been marked as a
spam email address or it doesn't exist
or you know if it's just not a valid
email address at all so it's not just
looking at the valid validity of the
actual string you're passing it looks at
the genuineness of the email as well so
this instead of passing in our private
key we just pass in our public key so in
this case it's just pub key that's it
so we also have an opt-in Handler that
we need to grab from our male gun
instance which is this here so let's
create a male gun opt-in variable and we
will call take this from male gun and
it's an opt-in handler method that we
need to call so this allows us to do
things like actually add users to lists
and stuff like that but we'll be looking
at that later so what we need to make
sure that we do is within each file
where we want to access all of this
functionality we want to include it so
I've already created all the mark-up for
our for the form you're likely going to
have your own mark up with your own
styles let's create a opening and ending
PHP tag here and let's require in
init.php and this just lets us check
that everything's working we want to do
that on the send file the SUBSCRIBE file
and the confirm file as well and we can
get rid of the ending tag on that file
so if we head over to here and I'd know
gone to subscribe dot PHP this is the
Styles I've created a style sheet in
here which contains all of these styles
but you're like I said likely going to
have your own so now that we've included
in it dot PHP on this page it looks like
we're not seeing any errors so I can
assume that we've successfully
instantiate it and done everything we
need to inside of init uh PHP so good to
know that was a little bit verbose and
it's a little bit messy because we're
just putting it all into one file but
now that's clear we can go on and
actually start to subscribe users to our
mailing lists</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>