<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 9): Total Users Widget | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 9): Total Users Widget - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 9): Total Users Widget</b></h2><h5 class="post__date">2012-05-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0EsefXifM0k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so in this part of the video we are
going to be looking at not specifically
widgets but we're going to be looking at
the logged in widget and also we're
going to be creating a widget that
allows us to tell anyone that's visiting
the site how many users are currently
registered on the website and this won't
include users that are inactive so any
users that have an inactive account will
not be included because we could have
you know several registrations that
don't that haven't been activated
therefore you know we don't to include
them in the check but we're going to
look at just building up some of the
links inside logged in dot PHP and this
will form the the overall navigation for
our user so any whether they want to go
whether it's to change settings like
their password logout anything like that
check private messages we'll go in here
so let's do that quickly now because
it's relatively straightforward it's
just what it's very straightforward
it's just a unordered list with some
list items within it so I'll go ahead
and just do we're only doing two for now
one of which we haven't created which
will be the change password page which
we'll do you know we'll get when we get
to it the first one is going to be to
log out now you'll remember we've
already actually created the log out and
lookout code or the log out file it
basically just consists of starting a
session destroying and then redirecting
back to the index page so let's go ahead
and do that now I'm going to go ahead
and create an anchor tag so essentially
a link and I'll just here say logout or
space will do and we're just linking to
logout dot PHP and that's it really when
I go ahead and refresh I'm not logged in
let me just log myself in there we go so
I've got this logout link I'm going to
click on it I am logged out relatively
straightforward I'll also go ahead and
just replicate what I've done here but
I'll add a link to change password dot
PHP
which we haven't created yet as I said
we'll get to but we'll just fill up the
navigation it will sort of give us a
to-do list so change password keep a
small P okay so let's go ahead and just
log in and make sure that's displaying
properly I can't see any reason why I
wouldn't brilliant okay so this will go
to change password which isn't found at
the moment and logout will lager solve
our account okay so I'm going to go
ahead and log out we're going to create
a new widget now and this is going to
show us like I said the style the
tutorial how many users are currently
registered this doesn't include users
that are logged in ah but you know we'll
get to that at some point later on so
let's go ahead and create a new file and
I'm going to call this user let's say
user count PHP so user underscore count
dot PHP and this is going to take the
same structure as this widget so
essentially I'm just going to copy this
and paste it in here so we've got the
class the outer class of widget the
header and the inner div and that's all
we need so we can remove everything in
here so this is the formation of our
widget our outer container our header
and then our inner class or in in a
container so let's just go ahead and
sort of create the skeleton of this
widget we'll go ahead and create what we
want to say but we'll omit the actual
value and so I'm just going to say let's
I don't know what to call it let's just
say users and I'll say we currently have
X registered users okay so X is going to
be replaced with a value we're
essentially going to obtain a value
which will be a return value from a
function so we'll be using a function to
return a specific value and we'll be
echoing out this here
remember user count is a widget included
as part of our aside so if I go over to
a side now you'll see we've got a side
if logged in equals true then display
our logged in widget otherwise display
login widget so we already know about
that however we're not including our
we're mouths so we need to go ahead and
include this file so obviously we
display this so let's go ahead and do
that just under here and let's go ahead
and include user count of PHP will
obviously need to go it needs to be
within the includes widget directory so
we've done that now let's go ahead and
refresh and oh okay so let's check what
might have gone wrong here so includes
that it's widgets that's fine refresh
okay so now we have this widget users
and we currently have X registered users
so what we need to do now is go ahead
and create the function that's going to
return the user count so let's go ahead
and do that now so we need to open up
our within our core directory within our
functions we need I've not be users this
could go in general but I think it's
probably better to better-suited to
users because it deals with data
directly relating to users so I'm going
to say function use that underscore
count or you could say something like
total users anything like that we're
obviously going to be returning a value
so we can do this all all on one line so
we can return a MySQL result within here
we obviously need to supply a query and
then the row that we want to retrieve
this count from so let's go ahead and
say MySQL query and the second argument
we'll just pass a zero so within here we
want to use the MySQL count function to
return count based on the user ID field
of all of the users now at the moment
there's only one which is me so it will
obviously return one but in a moment
we'll go ahead and we'll create another
account
we'll see that this will change to two
so I want to select we're using the
MySQL count function and we're counting
by user ID we could count by like the
star or something but it's probably
always good to either field and
obviously fetching this from the users
table and we need our condition in here
now because we want to say where the
active state is equal to one we don't
want any users with the active state
equal to zero to be counted within this
check so I'm going to say we're active
equals one okay so that's it
now we're returning this number so let's
go ahead and test this out so within my
user count PHP file I'm going to go
ahead and break into PHP where this X
currently was or currently I've just
replaced and I'm going to echo as a
result of the user count function so
remember we're returning a value from
this function we're not echoing out so
echo use account and let's go ahead and
refresh and you see we currently have
one registered users now we've got this
problem here where we've got users but
we can solve that in just a moment I
hadn't planned on doing so but we can go
ahead and do this okay so first of all
let's go ahead and create another
account and obviously see how this
changes when we go ahead and hit the
insert tab let's go ahead and create a
new user account I'm going to just
choose the name Billy we will apply the
md5 function to this password first name
we'll say Billy and then we'll say
Garrett email we'll just make up so
Billy out PHP academy' to org and active
I'm going to set to zero let's go ahead
and submit this when i refresh you see
we have one registered users that's
obviously you know what we the result we
were expecting because we've got the
active state for this user set to zero
so let's go ahead and edit that and
change that to one click go come back to
our site and refresh and you see this
changes to
you oversee the the suffix on the end of
this word the the users is you correct
in this case because it's more than one
so what we want to do is we want to
create a condition that you know allows
us to allows us to either insert as it s
or not so you know this isn't entirely
necessary it depends on how your wording
it but I'll go ahead and do this now so
I'm going to say suffix equals and then
in brackets here is going to be my
condition after this is going to be a
string otherwise another string so what
I'm going to do is I'm going to say up
here I'm going to create a variable
called user count and this is going to
be equal to the result of this function
and that means we can use this variable
in this condition to determine whether
to put an s on the end and then we can
just go ahead and echo out user count
here so I'm going to say if user
underscore count doesn't equal or we
could say doesn't equal 1 so if it
doesn't equal 1 we can add an S on the
end otherwise we just keep this as a
blank string so as far as that goes
that's not really done anything because
we're not actually doing anything with
this suffix we're not outputting
anything so I'm going to get rid of the
s and I'm going to break into PHP
remember with no space here because we
just want it to echo out I'm going to
echo suffix and it's as straightforward
as that when i refresh now you see that
we've still got the S on the end here
and that's obviously to be expected
however if I go ahead and I set this to
zero click go come back and refresh you
see that this has changed to 1 and the S
has disappeared so this is really neat
not trick but a really neat method of
detecting whether an S should be on the
end of a word okay so in this part the
tutorial we've dealt with the user count
and more importantly just added some
links into our logged in
include here so in the next part we're
going to be dealing with something
that's a lot more complex but if done in
the correct way is going to you know be
a lot easier to maintain and that is the
registration page and we're not going to
do this as in you know static fields
we're going to do this slightly more
interestingly so I'll I'll see you in
the next part</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>