<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Easy PHP Validation with Violin: Custom Rules (5/6) | Coder Coacher - Coaching Coders</title><meta content="Easy PHP Validation with Violin: Custom Rules (5/6) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Easy PHP Validation with Violin: Custom Rules (5/6)</b></h2><h5 class="post__date">2015-04-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/R9_SHj7tbcA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">if you want to add custom rules to
violin we've made this as easy as
possible for you to do so we're going to
look in this video at a very simple way
of adding a custom rule but we're going
to go on later to look at more advanced
usage of violin where we can hook up
violin to our database and any other
dependencies that we have within our
project so we can actually do things
like create rules to check that a
username exists in a database or an
email address isn't already being used
or something like that so the first
thing that we want to do is go ahead and
just validate we won't do anything
particularly interesting with in here
all I'm going to do is I'm going to say
use the name and I'm going to pass in
just a hard-coded username and I'm going
to say this is required down here i'm
going to do a VAR dump on v errors all
and at the moment we shouldn't see any
so we've got an empty array perfect so
now let's go on to add our custom role
let's just create a silly one first of
all just to demonstrate this and then
we'll look more advanced rules that we
can create using arguments and you could
also then create rules using previous
input and that's what the matches rule
uses to check things like password and
password confirmation so for to create
custom role we just use a draw it's as
simple as that we give it a rule name so
I'm going to say something like is Apple
so we're going to check this this rule
is basically going to check if whatever
we pass through matches the text Apple
obviously a silly example but it just
shows how we can use these so inside of
here we create a closure which is what's
going to be run when our rule is called
and what pastor this is three arguments
value input and the args so in this
example we're only going to be looking
at value but in a moment will occur args
which is probably the most used so
inside of this closure then
we can either return true or false so
returning true means that this rule has
passed and returning false mean that
this rule means that this rule has
failed obviously you wouldn't hard code
that ins you wouldn't say something like
return true or return false that would
be silly but you would do some kind of
check in here that results in either
true or false being returned so in this
case all we need to do is return value
being equal to Apple so all this will do
is it will check this value value being
this which is passed in to our by the
date method it will check if it's equal
to the to the text Apple if it is then
we return true if it's not we return
false and therefore that fails so let's
go ahead and add this in here and
there's one last thing that we need to
do before we run this and that's add a
custom error message because obviously
there's no default error message for is
Apple so all we need to do is say add
rule message we add it for is Apple and
then we can say something like that
value must be Apple we could do that in
double quotes so what we can do is we've
already seen placeholders being used we
could use placeholders in here if we
wanted so we could say instead of this
we could say the field field must be
Apple you gave input now input is
anything that the user has submitted
through and you've passed into the
validate method so let's take a look at
this and refresh in fact no this is
going to be value no input there we go
so the username field that's our first
place holder must be Apple you gave
Billy so let's go ahead and update this
validate method to include the username
as Apple and when we refresh we
obviously get no errors so that's how we
create a basic rule using value that we
get past in which is obviously the value
of what we provide our validate method
but now let's take a look at what we can
do without args so for example we could
say something like is in or you know
something like that what it whatever it
doesn't really matter too much let's get
rid of the contents of this and let's
get rid of our rule message as well and
we'll get rid of that for now too so is
in is basically going to check if the
value that we provide is within the
arguments that we give so it would look
like this when we use it is in and I
could say something like 1 2 &amp;amp; 3 these
are just comma separated values within
parentheses and these are then
translated and given to us within this
args method here so what I want to do is
a VAR dump on args and that will give us
them args out if we just refresh this so
you can see now that arcs has 1 2 &amp;amp; 3 so
we can use that as we want obviously
these errors that we have here basically
due to the fact that we have no custom
rule error message setup it is in so
let's finish off our rule first so what
we need to do is say return in array
value ox that's as simple as that so
because this is an array we can check if
the value that's provided here is within
the array that we get from this either
one two or three really really simple
and obviously if you only had one
argument being passed through you could
use the array accessor to access the
first key or however many keys you
wanted to access so let's just quickly
add a rule message for is in must be
either one two or three so let's go
ahead and refresh now must be in either
one two or three currently at the moment
what we can't do is output all arguments
what I could do here is r0 arg1 or arg3
and that would give us
up to 60 indexed like that so using the
Arg and then the nut the position of the
argument you want you can use that as a
placeholder as well but what you can't
currently do is output all arguments
that's something that needs to be added
to the code base which will probably be
done very shortly so for now let's just
go ahead and replace this is one two or
three so we've now looked at adding
custom rules within violin what we're
going to look at next is extending the
violin class so we can add our own
custom rules but we can also then inject
dependencies for our application so for
example database dependencies and then
we can go ahead and look up things in
the database within our rules you can
obviously do this within here but it's a
lot cleaner if you have a valid a method
validate class for example that just
extends violin you can keep everything
in there and it's nice and tidy so if
you need to do database validation to
for example look up whether a user name
already exists that will be in the next
video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>