<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The strlen function vs mb_strlen (and others) in PHP | Coder Coacher - Coaching Coders</title><meta content="The strlen function vs mb_strlen (and others) in PHP - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The strlen function vs mb_strlen (and others) in PHP</b></h2><h5 class="post__date">2014-03-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PIhRD-ONRiQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to look at the
problems that you might face with str
len in PHP and look at some alternatives
like MBS tln but first of all let's talk
about why there's a problem or potential
problem with str len now you've probably
used SQL em before or string length to
actually you know count the amount of
characters in a string so as the name
suggests you'd think that it count the
amount of characters in a string now
this is sort of correct however in
reality actually works can be different
to this so we'll be taking a look at
some examples and how this actually
works now actually counting amount of
bytes in a string so it's not anything
you know that's been hidden away from
you or it's nothing secretive it is
actually explained in the PHP manuals a
note but it's pretty hard to miss so if
you're wondering what we took them out
here let's take a look at an example
using a single character let's go ahead
and create a variable here called string
and we'll just go ahead and type a for
the thing so we're going to assign a or
a lowercase a character to this variable
so let's go ahead and echo out str len
of this string now you'd probably go
ahead and expect this to output 1 and
you'd be right so let's take a look in
the browser and this outputs 1 so you'd
expect this to happen and the same if i
was to type for example hello you'd
expect this to output 5 which it does so
what would now do is go ahead and look
at changing this slightly and change
this to a special character now
basically with UTF encoding a character
can be up to 4 bytes long now if this
str Len function counts bytes and not
actual characters then let's take a look
at how this sort of handles it this
actually returns to now you might be a
little bit shocked that that's returning
to you might feel a little bit cheated
and thinking wow I've been doing it
wrong all along but don't worry it's
probably not the end of the world it
just means that you may get slightly
inconsistent results when you're
outputting things obviously of course
unless your application relies heavily
on str len to perform correctly which is
probably doubtful but it's a good idea
to go ahead and revise any way you've
used this so obviously we know that this
is a problem however let's look at some
alternatives now we've got one
alternative called mb str len so it
works exactly well pretty much exactly
the same as str linen the fact that it
you know is counting characters let's
take a look at using on its own without
any options so it's still returning to
so you know you might be thinking well
what's the difference here the
difference is that we can actually
specifically define the character
encoding that we're using so in this
case i can go ahead and provide utf-8
here and this will go ahead and actually
take into account the fact that you know
we're not counting bytes anymore we
actually want to go ahead and count
actual characters so what this is going
to do is it's going to say well yeah
this is made up of two bites but in
reality this is actually a single
character so now when i go ahead and
refresh we get the expected result of
one so we're now looking at an accurate
way to count characters like this so if
i was to say just rather an example type
my name but with this accent character
we'll go ahead and we'll get the
expected results for and again if we
sort of double this up just for the sake
of it we go ahead and get five so we're
seeing the results that we would expect
here now you may be thinking well you
know do I really need to define all of
this every single time I want to count
characters well no you don't you can use
in MBS coln eyes own instead what you
can do is set the internal encoding of
your scripts so you can go ahead and say
mb internal encoding and what this will
let you do is do exactly what we've just
done here with a second argument but it
will let us go ahead and provide it just
once and then not have to bother again
so in this case this will automatically
tell us that the in mb internal encoding
is set to utf-8 and if you're not sure
for any reason at all you can go ahead
and you can check this by echoing out
the value of this function without any
arguments let's go ahead and get rid of
this for now and go ahead and check and
you can see that it says utf-8 so we
know that that's been set to utf-8 if we
go ahead and get rid of this line we get
the
fault so let's go ahead and just put
that back and go ahead and get rid of
this and just use the mb stl n function
on its own and there we go we get the
expected result again so we've done this
in a short sort of short away where we
don't have to keep defining this over
and over again now there is an
alternative so we can go ahead and
actually UTF decode strings before we
use str len if you know you absolutely
want to use left str len you can go
ahead and do this let's go ahead and get
this mb internal encoding and we'll go
ahead and continue to use this accent
two character we'll go ahead and we'll
use str len but what we'll do is we'll
go ahead and utf-8 decode this and then
go ahead and just provide the utf-8
encoded string within the STR Len
function again and you see we get one so
that's another option now there are
other ways to do this I think probably
the most efficient way however would be
to go ahead and create some kind of
rapper functionality in your current or
next application so for example you
could provide a function or method as
part of a class to just contain all of
this functionality so basically then you
don't have to keep using mb/s tln or
utf-8 decode or any other methods that
you can use that's available to go ahead
count characters properly so the wrapper
functionality is a good way to go but in
terms of just demonstrating this we've
seen how str Len is not reliable for
counting character length and you should
go ahead and use one of the alternatives
to be spoken about</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>