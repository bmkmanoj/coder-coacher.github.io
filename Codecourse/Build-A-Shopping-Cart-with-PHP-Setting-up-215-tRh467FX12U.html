<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Shopping Cart with PHP: Setting up (2/15) | Coder Coacher - Coaching Coders</title><meta content="Build A Shopping Cart with PHP: Setting up (2/15) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Shopping Cart with PHP: Setting up (2/15)</b></h2><h5 class="post__date">2016-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tRh467FX12U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so we're going to start out by
setting up our base framework so this is
going to take a little bit of work but
once we're done everything else will
just be pretty straightforward because
we'll have everything in place that we
need to get going so we're going to be
using the slim three frameworks the
first thing that we need to do is
install this now I currently have this
directory up in my browser and in my
text editor I just have an empty folder
so we are truly starting from scratch
here so over in github I'm just going to
pull up the slim three-page now we need
to install slim three and we can do this
using composer so if you don't really
have composer go ahead and download that
for your system so let's open up the
terminal then and let's go and paste
this in I'm currently within the cart
directory that I'm working in so we're
going to paste this in and wait for this
to download so now that's downloaded we
need to think about what we're going to
use to render views out so you may have
used or heard of twig this is basically
just a template engine for PHP and we're
going to install this package called
twig view which is part of the slim PHP
project this will allow us to render out
views very easily so again let's go down
here and just grab this composer command
and paste this in and wait for this one
to download - that will almost pretty
straightforward you can see it's pulling
down twig and it's also pulling down
this bridge between slim and twig and
this is super easy to use now what we're
also going to do is get a little bit
more advanced because that we have the
potential for this project to grow a
little bit larger and also we want to
keep things really nice and tidy we're
going to be using dependency injection
so if you've not worked with dependency
injection before it isn't too difficult
to grasp but what we're going to do is
make this really really easy using PHP
di and we're going to use the slim
bridge for this so all this will really
allow us to do is inject things we want
to use into controller methods we are
going to use in controllers within this
project so this just goes hand in hand
and just really tidied everything up and
just makes everything a lot nicer to
work with so of course we need to go and
pull this in as well
we want to go and we can just do this
click on the command line so we want to
do a composer require on PHP di slim -
bridge so we will run that wait for that
to download and there we go ok so the
last thing that we want to pull in is
our database support so we're going to
be setting up database support as part
of this part as well now we're going to
be using the illuminate database
component from laravel that might be
really strange if you've not worked with
that laravel before then this will be a
little bit new but really it's not too
difficult to get started with so we want
to pull this into our project and we're
going to do this again
with composer so let's go ahead and just
require illuminate database in now the
benefit of actually using this is that
what we'll get is a really nice way to
just work with our database we'll be
able to create models and we'll be able
to create relationships between things
and in our case we know that we have a
database structure here that has
relationships between each other so
these tables have relationships so this
will actually really help when it comes
down to working with your database if
you're a bit worried about moving away
from something like MySQL I or PDO don't
worry this will become very clear very
quickly it's not really difficult to use
a tool okay so for our base framework
then we have installed everything we
need to actually get going so what we
can do now is actually start to build up
the kind of structure of our framework
so to be able to do this over in
composer dot JSON what we want to do is
psr-4 autoload all of our files now all
this means is is we can autoload these
in using composer using the psr-4
standard and that just allows us to give
a namespace to each file and then load
things in appropriately so again we'll
come back to this in a bit when we start
to use it but just go ahead and add this
into your composer JSON file just for
now so we have an auto load property we
have inside of here a psr-4 property and
we have in here the vendor namespace so
it's up to you
whether you want to call this app or
cart or whatever it could be the name of
your project or your business but in our
case what we're doing is we are
namespacing this whole thing or all of
our files under this cart namespace and
we're pulling all of our files from the
app directory that we want to auto load
so now that we've done that we know that
we just need to create an app folder in
there so any files we create in there as
long as we namespace them under cart and
then something else we can just use them
then any other files really
straightforward but again if this is
confusing we'll see how it works later
so to have this take effect we just need
to go into our terminal and run composer
dump Auto load and we can pass in the
optimized flag so there we go that is
our psr-4 Auto loading setup what we now
need to do is just work from this public
directory outwards to get everything set
up so inside of here we're going to have
a public directory this is where your
users will land so if you're working
with either Apache or nginx you'll need
to set the root directory to this while
you're developing it doesn't matter you
can go straight from the public
directory it's fine but of course when
you put this into production you'll want
to make sure that that's the case so
inside of our public directory then we
want an htaccess file because we want
URL rewriting on so let's add a htaccess
file into here and I'm just going to
pull this over from my notes but of
course what you're going to want to do
is write all of this in there and save
that out and if you are using another
server like nginx then this is a
slightly different setup but you can
find out how to do this from the slim
documentation okay so within public then
we just need one file we just need an
index or PHP file
this is the father' user will land on it
will load in everything we need
including all of our routes and it will
boot up our application so inside of
here then we want to pull in a
particular file and that is a bootstrap
file so we can create that bootstrap
file within our app directory again so
we're just going to say boot strap or
rather within sorry
root directory just going to create
bootstrap in there and inside of here we
are going to create a file called app
PHP so this file then is just
responsible for booting everything up
and we can require this in from out
index dot PHP file and then run our app
so let's require this in first of all
because we're going to do a little bit
of testing along the way and in here we
just want to pull in going back a
directory in to boot strap and then app
PHP and that is it so we can leave that
as it is just for now so for our app dot
PHP far then what do we need to do in
here
well obviously the first thing we want
to do is put in our autoloader now this
is within the vendor file and this pulls
in all of our dependencies that we might
possibly need so this is the auto load
file just here so we can require this in
again that will just allow us to use
slim use all about other dependencies so
we can just pull this in like this so
it's vendor auto load dot PHP and while
we're here why don't we just start
sessions because we're going to need to
do them a bit later or use sessions at
least a bit later on ok so before we go
any further we need to talk about the
PHP di package we installed now in
usually when you pull up a slim
application you create a sim application
you do things like that's you know how
they specify on the documentation but in
our case what we actually want to do is
create inside of here an app PHP file
which will load everything in as per PHP
di so we're going to do this if you
don't understand it immediately don't
worry we're going to take a look at how
we actually set everything up properly
later in terms of dependency injection
when we start to add things and of
course this will slowly start to make
sense so inside of App the folder let's
just go and create a new file and this
is just going to be called app PHP so
this is our base app file so this has a
namespace for me then of cart and then
we have a class here called
app and this
dens the dependency injection package
bridge so again don't worry too much for
this doesn't make sense we're going to
go ahead and use di container builder
we'll see how that does in a minute and
we'll also go and use di Bridge slim app
and we're going to use that as di bridge
and that is just here so the reason that
we're pulling these in is because we
have a namespace here so inside of here
then we have a container that we can
configure this will allow us to use all
of Slim's functionality plus it will
also allow us to bind other things to
our container that we can use later on
so let's create a configure container
method and let's just change this and
into this we accept a container builder
and we'll just call this builder now all
we're going to do here is we're going to
turn ever handling on within slip
there's a good chance that while we're
developing this we're going to see an
error and we want to make sure that we
see a full stack trace of all of them
errors so we just say builder add
definition and then inside of here we
just say settings display error details
and we set this to true so before we do
anything else we need to do something
else down here in just a moment we're
going to go over to our app dot PHP file
remember this is where we bootstrap
everything up and here we're going to
say app equals new app so up here what
we want to do is use cout app that's the
father we've just been working on and
now technically what we have is a booted
up application ready to go in fact what
we do need to do is over in our index
file so just here we need to say app run
so that's all we're going to be doing
inside of index.php so we can close that
off for now so now that we've done this
let's just head over to our browser just
give that a refresh and we have a little
bit of an error so that's fine we can go
and just fix this up so let's go over to
our app dot PHP file
it looks like I've spelled this wrong so
let's say add definition and I don't
think I have always add definitions
rather than add definition because what
we're doing is we're passing in a right
here so at the moment we now get a 4 a 4
now don't worry about that if you are
following along that's absolutely fine
it's just because we don't have a root
set up to handle this or at least we
don't have a controller set up to handle
this now as part of this actual video
we're going to be creating a home
controller just so we can see that this
is working and of course what we do is
we'll also render a view so we know that
we have our view setup as well as
everything else so now what we need to
do is let's just close these off we need
to focus on our container file now our
container file within our app directory
will literally just be anywhere we want
to bind anything to the container so
let's just create this now so container
dot PHP and we will start to add things
into here that we're going to need now
this will eventually contain everything
like our basket our validation a product
order customer address anything that we
need to actually bind to our container
but for now this is pretty
straightforward all we want to do is
return an array and inside of here we
want to set Rooter and this is going to
be our slim Rooter to get slim Rooter
class that will just allow us to use our
route as we need so that's pretty
straightforward and I guess what we can
now do is just focus on our views so
we're using twig we're using that twig
package we pulled in now the reason that
we're doing this and adding them to the
container is so we can actually inject
it into our into our methods within our
controllers so let's do this and again
if it still doesn't make too much sense
we'll see how this works when we get
round to creating our home controller so
twig class all this will do is if up
here we say use slim views twig this
will basically just pull back the full
name space for this and then we want to
go and create a closure here now inside
of here we'll have
Tayna interface I will just call that C
so that's how current container and up
here we just need to pull this in so
what we do is we pull this inform
interrupt container and then container
interface so within here all we want to
do is just basically boot up twig so we
can start to render views so you might
have seen this if you've worked with
slim before we just say new twig so here
we say new twig and of course what that
is is this just here and into here we
pass where we want to load our views
from so we haven't created this
directory yet but what we can do is
define this out and then create the
directory so here we're going to say go
back a directory into a folder called
resources and then into a folder called
views and what we can actually do is for
development we can turn our cache off so
that's just an option that we can pass
through the next thing we want to do is
add our tweak extensions now twig
extensions are responsible for things
like within our views if we want to
create a link to a particular page we
can use our root Oh within there to
build up a path or we can use any of the
other helpers that are available so we
just say twig add extension and then in
here we say new twig extension and this
will need to be pulled in at the top so
we need to just do this so use slim
views twig extension so that's now in
there we can use that and into this will
require two arguments and this is our
current router and our and our current
URI so to do this we just use C this is
the current container just up here and
we just say get Rooter that's it and
then down here we want the current
request URI so we say C get request and
then we use the method called get URI so
that is it and then finally all we want
to do is return twig like that so now we
have twig attached to our container
similar to if you've worked with slim
three before you'll know that you can
just use a
get container and then grab that out but
here we're using dependency injection so
now I think as long as everything is
working we're at the point where we can
start to create our first route and
create our home controller so under app
I'm going to create a new file called
routes and this will just be responsible
for listing all of the routes of our
application there aren't too many so
inside of here then how do we start
working with controllers well what we
need to do is first of all in app just
create a directory that will store all
of our controllers and obviously to keep
things nice and simple we can go and
create a home controller in here so
let's do this now let's create a new
file and we will call this home
controller dot PHP so the goal here then
is to create a controller create an
index method and then render this when
we land on the home page
simple as that so the namespace for this
will be cart controllers because what
we've done if you're not sure about PSL
for autoloading we've created it inside
of app which is technically cart and
then controllers and then we have a
class here just called home controller
so now we can create a index method like
so and what we can also do is now say
well in fact let's just died here and
say index and let's hook this up to our
routes just to see if everything works
so here we just say app get forward
slash then we give the name of the
controller and we can do this within an
array so we can say cut controllers home
controller and then as the second part
of this array we can say index that's
the actual method and then we can set a
name on this so we can refer back to it
later if we wanted to redirect back to
the home page for example
so obviously the routes isn't going to
work because we're not including it
anywhere we're not actually requiring it
anywhere so we can do this within our
bootstrap file so let's go over to our
bootstrap app file and down here let's
require this in so we're going to say
require dir and then in here we'll get
obviously going to go back a directory
we're going to go into app and we're
going to include routes
PHP so that's pretty much here let's
just head over here and you can now see
sure enough we actually have our index
being or at least the text killing the
page there now that's not what we want
we actually want to be able to use twig
to render out a view so how do we do
this well I guess what we can actually
do is start by creating our resources
folder remember when we added this to
our container just over here we said
that our views are going to live in a
folder called resources and views so
outside of our app directory we're going
to create a resources folder and then
inside of here we're going to create not
a new file we're going to create a new
folder called views so I guess what we
can do is create a home view and this is
pretty straightforward we just create a
new file in here and we will call this
home and we're going to give this a twig
extension so let's just say this is the
home page this will actually eventually
be the product index page but now what
we can do is inside of our home
controller we can actually render this
out now how are we going to do this well
like I said earlier we already have
dependency injection setup so we just
inject something into our method and
then use it so let's just pull in slim
views twig and now we can inject this in
so here we're going to say twig view
what this will do is it will inject this
twig instance in that we bound to our
container so remember this just here it
will return twig and then we can go and
say return view render we can choose the
name of the file in actual first of all
what we need to do is pass our response
in so this is a little bit more
complicated but essentially what we're
doing here is we are pulling in request
and response but what we're doing is we
are type hinting it here as well and to
pull these in we're just using PS our
HTTP message response interface and
we'll just call that response and then
down here we're going to have the same
thing
but we're going to have server requests
interface and we're just going to call
this request
now all this means is that our response
and our request
now with requests we usually get things
that have maybe even posted through a
forum and response we used to respond to
a particular request these are just
basically contracts for them and that
this is how we can type in and then
essentially just inject them in so for
our render method then we want to pass
in our response then the name of the
view home twig so now that we've done
that we've injected everything in and we
are returning that render method or the
result of the render method you can see
we have a little error so we can just
check this out and it looks like we have
a problem with our container so let's
just see what's going on here so we have
twig class just here out of course so
what we haven't done is told
PHP di what we want to use as our
container so essentially all this means
is that it basically cannot find twig it
can't inject it in because it can't find
it in our container so over an app
remember when I said earlier that we
need to do something down here I should
have remembered we obviously need to
pull in all of them definitions from our
container so this is really
straightforward there's nothing really
to this it's just exactly what we've
already done so we just say builder add
definitions and then all we do is inter
here we pass in this container that
we've created so in here it's just
container dot PHP simple as that so now
we see another error where we can sort
it so in a minute but at least we fix
this up so we have called it undefined
function get the reason for this is that
over in our container here what we're
doing is we're using the get function
here but we haven't imported this from
the PHP di package so it's really really
straightforward all we do down here is
we say use function D I get and that is
it so now we can refresh and there we go
so beautiful it took a little bit of
work but we now have dependency
injection set up we have our container
created we have views being rendered out
and we're well on the
just cracking on and getting all this
done so we pretty much now have our
application structure set up I know it
was a little bit of work but now we're
in the position where we can actually
really start to be quite powerful with
the way we use slim and it also means
that into the future everything is a lot
easier so now that we've done this we're
going to look at our database setup
later but next we're going to go ahead
and take a look at setting up our
Braintree sandbox account just so we're
ready to accept payments let's go over
and check that out next so thanks so
much to Braintree payments for
supporting Co course mobile app
development can be complex but
integrating your payments no longer has
to be the Braintree your business can
accept in any type of payment on any
device
with one simple integration everything
from PayPal to Android pay or whatever
comes next
Braintree simple flexible SDKs make your
job and payments a lot easier learn more
at Braintree payments comm flash Co
course</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>