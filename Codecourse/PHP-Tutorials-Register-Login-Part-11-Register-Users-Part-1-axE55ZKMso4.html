<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 11): Register Users (Part 1) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 11): Register Users (Part 1) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 11): Register Users (Part 1)</b></h2><h5 class="post__date">2012-05-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/axE55ZKMso4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back in this part of the series
we are going to be actually registering
our user in this case we well previous
to this we have gone ahead and you know
validated our field check for required
fields checked a few specifics and now
we're at this stage now in the last part
I created this condition here just a
quick note to point out it's actually
wrong here we've got if the if the post
data is empty is empty and the errors
are empty then register the user this
here needs to be false that wasn't just
a mistake on my part so if the post data
is full if it has data and the air is
empty then we can go ahead and actually
register the user so what do we want to
do well we need to construct some kind
of model that we need to pass through to
a function and that function is going to
be within users dot PHP we're going to
create a function called register user I
will also need general dot PHP open
because we're going to be creating a
function in there the sanitizes data
within an array it all sounds very
complicated but as I shown as I walk you
through this it shouldn't actually be
that hard
so what do I mean by build up a model of
data well I'm going to create an array
and this is going to hold all of the
user data and which fields that this
needs to be placed into so I'm going to
create a variable called register data
I'm going to assign and arrayed this I'm
going to just pull this down a bit and
I'm going to create be creating an
associative array so the label will be
some text and the result will be that
sorry the value will be sorry not right
dollar underscore post it'll be some
value that we get from our post data so
for example the first one will be
username and we'll call this username so
here print our register data will give
us an idea of what our array here looks
like I'm going to need to go ahead and
just and just as a side note quick
you'll see here we've got some white
space if I go ahead and inspect that you
can see that we've got our output errors
function is outputting an unordered list
with nothing between this first Ally the
reason being is that we've got an if
statement saying if the post data
doesn't equal false I have some data
been posted and the errors are empty
then we can go ahead and register the
user otherwise output the errors now
what we actually need to do is we need
to say else if empty errors equals false
so the errors array is not empty okay
and what that's going to do is it's
going to first of all get rid of the
wine space and second rule is basically
just because we need that extra check in
there just to make sure that the the
errors array is empty anyway let's
continue so I've gone I'm going to print
our registered register data so let's go
ahead and just type in some registration
data I'm just making sure everything
matches up again it's you know boring
case of entering any kind data really
okay so when here you can see we've got
array user name equals Alex AAA which I
just typed into here so we've got this
array now that contains the field name
that we want to post to in the database
and the value that we want to post to
and we can match this up a bit later so
let's go ahead and get rid of that print
our okay so I'm going to go ahead and to
get comma in here and just replicate
this for all of the fields that I want
to actually insert now remember we don't
need to include password again in here
because we are not pasting the password
that the user repeated because it will
be the same as the first one so we want
username password first name last name
and email now the last name may not have
been submitted by the user that's fine
let's go ahead and just substitute these
so password
password first name first name and as I
said the last name even though it might
may be blank but that's fine so doesn't
matter if it's not required and then
lastly the email address so let's just
go ahead and tidy this up I just tab
these along a bit so it's a bit easier
on the eye so we have now all of these
these values in our array and we want to
go ahead and pass these to the register
user function which we haven't created
yet but we'll do in due course so we
want to pass this data to register data
sorry we want to pass this data to the
register user function and then after
here we want to redirect which we'll
deal with later and then exit just just
in case well there's no real reason it's
just in case that users browse of some
reason doesn't interpret redirect
properly ok we want to kill the script
okay so what do we want to do well we
need to go now and create the register
user function so over to users dot PHP
we create a function called register
underscore user and we know that this
takes one parameter and that's the the
register data now inside of here I'm
going to go ahead and print our register
data and I'm actually going to go ahead
and fill this form out properly now so
we can actually start to refresh and
deal with some real data you know
assuming a user would go ahead and enter
this correctly so user name is Billy
password is I'm just going to enter
password password again first name Billy
last name Garrett and email Billy app
PHP academy' to org so register there's
the data that's been returned from the
register user function now let's look at
this data what do we actually need to do
the first thing that we need to do is
protect against or start to protecting
SQL injection by sanitizing this now if
you remember inside of general dot PHP
we have a sanitize function
unfortunately we well we could use this
on our array but we'd have to look
through each element of the array and
apply this and then re put it back into
the array instead we can use something
called a ray walk and what this will do
is it will walk through essentially or
go through every element of the array
and apply something to it and return
that data if required so we're going to
be creating a new function here in just
a moment so it sounds confusing but it's
not at all ok so the second thing we
want to do is we want to encrypt this
password we're going to use the md5 hash
on it again not entirely secure but
we'll look at you know sorting that out
later on in another video and enforcing
more security on our site so let's go
ahead and first of all encrypt this
password with md5 so within our register
user function what do we want to do well
we essentially just want to reassign a
value to this to this element of the
array so we're going to say register
underscore data and we're going to
access password is equal to register
underscore data
password we want to wrap this the
reassignment very air value within md5
now what's going to happen is when we
refresh remember if you're following
along don't hit enter here just actually
refresh so you can put confirm your form
resubmission you see now that the
password has been converted to md5
perfect so we now have data as we'd want
to place it in ok now let's focus on
walking through this array and actually
sanitizing each element of the array
without having to loop through and do
anything too complicated so I'm going to
use array walk and I'm going to here
within to this I'm going to supply the
register data which is an array now
within single quote I want to specify
the function walks through this array
now we haven't created this yet so we're
gonna have to create another function
but essentially this function is just
going to take in a value do something to
it and return it back and place it
within the array so I'm going to call
this array sanitized so we're walking
through the array with arrays sanitized
let's create arrays sanitize quickly
it's relatively straightforward few
lines array sanitize now we're going to
take a parameter inhibit slightly
different because we want to return this
value we're going to use the + symbol
and then the variable name and in here
we're going to assign item which we've
passed in here to MySQL real escape
string and then obviously the item so
we're passing the item in we're
reassigning the vat the item and then we
are applying this to the values within
register data so every element in
register data now gets this MySQL real
escape string applied to it so let's go
ahead and check out the results so it
won't look much different at all but if
for example we were to i won't
demonstrate something how to fill the
form out again personally illegal
characters and they would be escaped
ready to be placed into a query so now
we actually need to construct our
registration query so I'm going to go
ahead and get the print are not gonna
need that anymore
I'm going to create two variables one is
going to be called fields and one is
going to be called data and we're going
to make use of the implode implode
function to essentially just group all
this together like we did here for the
fields that we placed within the users
table we're going to do exactly the same
thing so here I'm going to implode and
let me just get rid of that I'm going to
implode by something and I'm going to
what do I want to implode we'll register
data and I'm going to concatenate on
a back tick so I'm not a single
quotation mark a back tick and I'm going
to do that for either side and moving
here I've got a back tick comma and then
a back tick so the output we're going to
get from this now is I'll just uh say
echo fields it's a string fields will
now be a string and that will look much
like this we've got Billy in single
quotes I pass within single quotes oh
sorry
I've done it the completely wrong way
around this here will be data so echo
data because remember data when we're
inserting the query goes within back
ticked back tick so it feels now equals
nothing so this is our data so if the
user names Billy the password 75 first
name last name email blah blah blah now
we want to do the fields so let's get
rid of this echo here feels equals again
implode we want to implode by something
we want to implode registered data but
because we've passed through the
associative array the element names are
the field that we want to give so we
again need to place I'm going to play
single quotes which means after escape
that character replace a single quote
here escape that I'm going to place a
single right here with a comma and then
it's just one single quote so you'll see
how this looks on the output and these
dis escaping all make a lot more sense
but now if I was to go ahead and echo
fields in actual fact we're not echoing
the fields that we want to write to and
eventually our query is going to look
something like this so insert into users
and then in here will be the field names
the field names will look like user name
sorry
user name
password blah blah blah and then it we
values and then values will go like this
with single quotes Alex the md5 hash
okay so that's what it needs to look
like so here we don't need the that I've
done it the wrong way around again
okay so let's just change this around so
fields and data now remember our fields
are surrounded by back ticks data is
surrounded by single quotes so echoing
out the data here sorry the fields here
currently looks like this single quotes
what we want to do is instead of
outputting the data output the actual
field names so how do we go about this
well we use the array keys just around
this register data here and what that's
going to do is it's going to give us the
keys of the array that we passed through
and these relate to these here so that
was a bit of a very a faff we've got
fields that are surrounded by single
quote backticks
which are the field names and the data
which was surrounded by single quotes
which is the data we're actually
inserting so that's how we end up with
it and that's definitely correct so now
what we're going to do is actually going
to query the database and actually
create this user so I'm going to use the
MySQL query function and within here
it's going to go the query so we are
going to leave it there because we've
you know gone over a bit of time in the
next part we're gonna actually look at
inserting the data and actually
registering this user and then
essentially we're going to have a system
set up where we can register log in log
out another user can register someone
else can register somewhere else and
it's going to be working so in the next
part we will do that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>