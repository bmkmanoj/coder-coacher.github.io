<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Learn PHP: Basic CMS - Editing Pages (Part 7/8) | Coder Coacher - Coaching Coders</title><meta content="Learn PHP: Basic CMS - Editing Pages (Part 7/8) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Learn PHP: Basic CMS - Editing Pages (Part 7/8)</b></h2><h5 class="post__date">2015-07-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ao-fTUiM1U8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">to start off editing a page we need to
hook up this link so you can click it
and then go through to an edit page
passing in the page that we want to edit
grab that data and insert it into the
form ready to be modified so it sounds a
little bit more complicated than it
actually is
but let's start out with this link so
remember over on our list stop PHP page
we have this edit link just here we can
go ahead and insert a URL here to
redirect the user to that edit page so
what we want to do then is pretty much
exactly the same thing we did for the
slug where we generated the URL and we
passed in the slug here but we're gonna
be passing in the ID this time
so let's echo out the base URL as always
and let's go to admin edit dot PHP and
then what we want to do is we want to
specify an ID in the query string so
let's go and echo out page ID and again
we will escape that so now we can click
this we go through to edit PHP with an
ID of 3 for this record here for this
one ID of 1 for this one idea of 2 so
what we can now do then is create our
edit page so under admin we create a new
file we call this edit PHP and we do the
same as we've done before we require app
start PHP and we go ahead and we output
our view as well so while we're here
let's go ahead and create that view
that's edit dot PHP we're going to say
edit page so under edit we require in
our view root and then we say admin they
do dot PHP and then we see that view
brilliant so the next thing to do then
is to actually check if we have that ID
in the query string and go ahead and
pull that record from the database
passing in the ID so we only get that
one record so instead we're gonna take a
little bit of a different approach and
we're gonna check if the ID isn't there
so we're going to use is set and we're
gonna say if it's not set yet because
remember we're pulling it from the query
string and then ID so all that's saying
is if this ID doesn't exist in the query
string we want to go ahead and redirect
the user off somewhere so we're going to
redirect them to base URL and then we're
gonna append on admin this stop PHP and
then we're just gonna kill the page so
all we're doing here is if they land on
this page with no ID it just takes you
straight back to the list otherwise we
hang around on this page waiting for the
next thing so down here then we're going
to grab the page so it's the same as
before but we're going to prepare this
statement because we remember we're
passing in user data here that ID we're
going to select the ID title label body
and slug or you could just do select
star if you really wanted to from pages
where the ID equals ID so we have
another placeholder here we can go ahead
and execute that passing in ID and we
can pass in dollar underscore get ID in
there and then that will give us our
page so we just need to fetch it now so
we do exactly as we've done before PDO
fetch
associative array so if we do var dump
on page we should see now that
particular page so third page second
page and first page so let's go ahead
and edit the first page them so all we
want to do now then is we have this page
variable and this will automatically be
available in our edit view so we just
need to build up our form to save a
little bit of time we can copy and paste
the add form that we created because
what we need is the same form we just
need to output the existing values into
these inputs so I'm going to copy this
entire page here and I'm gonna put it
into edit I'm gonna change this to edit
page we're going to change the action on
the form to edit we don't want to submit
this back through to add and that is
pretty much it I suppose we can change
the submit button as well so now when we
edit a page we end up with this all we
need to do is fill in this data we need
to somehow specify which ID that we're
updating inside of the form so when we
post it back to edit we have that data
available we can update on a specific ID
but let's tackle the outputting of the
initial values first of all so all we're
going to do for this is create a value
attribute which will populate that text
input with whatever you enter in here
and what we will enter in here is the
post remember that we grabbed in this
query just here or the page rather I'm
gonna go ahead and output title and
we're going to remember as always to
escape that value so now we see this
this is the first page because we're
grabbing the first record pulling that
from the database and we can output it
in here so let's do the same thing
for label we can just change that to
label we'll do the same thing for slug
and our text area is slightly different
we don't have a value attribute here so
what we want to do is instead echo page
body you still want to escape this like
so and we end up with the following so
you've got all the information that we
need the last thing to do is create a
hidden input field down here and that
will allow us to output the ID when we
submit the form we'll have that
available in our post superglobal ready
to edit our page only where the ID
equals this ID so we have an input of
type hidden' so this isn't shown to the
user we can give this a name of ID so we
know how to pick that up in our post
superglobal and then we give this a
value and the value is basically just
the page ID and again we can escape that
it's not necessarily as much of a risk
but we'll escape it anyway so we don't
see that ID but if we view the page
source we can see ID 1 if this were to
change to 2 we see 2 and again if this
were to change to 3 we see 3 just there
ok so now that that's done when we hit
edit what happens well it doesn't really
do anything we're not going through and
checking if the form exists in fact what
is happening is it's taking us back
through and then reading redirecting us
back to list PHP so we need to handle
this over here and when you're going to
do that at the very top here so we want
to check in the same way that we check
when we were adding if the post
superglobal array is not empty now we
want to pull in the ID label title slug
and body that have been submitted again
so we say ID we assign post ID to that
we can duplicate this down and grab the
label you can grab the title we can grab
the slug here and last but not least the
body and I'm going to tidy this up just
by indenting it like so so now we need a
prepared statement again because
remember we're going to be passing this
information into a query so we're going
to prepare a statement and we're gonna
update the data this time so we're going
to update page so it's a prepared
statement again we'll pull this down so
it's a little bit more readable so we're
gonna update the table pages we're going
to set and I'm just going to tab in here
so it's a little bit more readable label
equal to a label placeholder we have a
comma here and again we can duplicate
this down we want to update title to
title we want to update slug to slug
body to a body placeholder and then
finally updated which is our column in
our database remember that signifies if
something has been updated or not - now
that's going to just update that date
for us of then we'll have that updated
date available and last but not least we
can't forget our where clause because we
did this query alone will update all
records we want to only do it where the
ID equals the ID that we specified which
remember is coming through from this
hidden input just down here so now that
we've done that we can execute our query
passing in all the data up here so let's
say update page execute and we pass in
this array again so the ID is the ID
that we get from up here and we have the
same deal as before where we just
list out everything we need so require a
label there we've got our title body and
also the slug as well doesn't matter
which order that you specify this in so
once that has been updated we're going
to redirect the user again back to this
PHP under our admin section so we're
going to use our base URL admin list PHP
so just to recap we have our former here
to edit which is going through to edit
our PHP we're outputting the initial
data that we get from this query here
what we then do is include the ID in the
form so we know which record to update
and when that form is submitted this is
now true because the post superglobal
won't be empty we grab our data we
create our prepared statement we execute
with the data that has come from our
form and we redirect the user and this
part updates the record so on this is
the first page or the first page we'll
go ahead and update this very slightly
so I add an exclamation mark we will
change the body this is the first page I
hope you like it and let's hit edit and
there we go we can already see that the
title has been updated with the
exclamation mark when we click through
we can see that we get the new body and
obviously the new title and you can see
that we get last updated and that last
updated date and you can obviously
refresh in your database client and you
can see that that information has indeed
been updated so that is how easy it is
to go ahead and edit our pages not very
complicated at all all that we have left
to do now is to go ahead and delete any
pages that we don't want in our CMS</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>