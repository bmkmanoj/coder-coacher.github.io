<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Bloopers: User Login Mess Up! | Coder Coacher - Coaching Coders</title><meta content="PHP Bloopers: User Login Mess Up! - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Bloopers: User Login Mess Up!</b></h2><h5 class="post__date">2012-06-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iwz6Ei8y2t4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so after all of the long processes that
we've gone through to do these things
we're going to focus now on a very small
task which is if a user's currently
logged in then we decide to disable
their account it will automatically lock
them our and this is quite a useful
feature that people don't often consider
if you were to banner users account for
example and they were still browsing a
site then they'd still have access
obviously they could just leave you know
their browser open for as long as
possible so we're going to sort of build
in a little statement inside of here
which is going to look like that and in
here we're going to log user out if a
particular condition is met so we're
going to go ahead we're going to create
a function that's going to check not if
he users account is exists because that
basis it on the username we are going to
check if the account status for a
particular user is active so let's go
ahead and do that inside of users dot
PHP let's go ahead and build this
function the function is going to be
called user active and it's going to
take funny enough a user ID okay so
we're going to go ahead here and we're
going to cast this to an integer simply
because we're going to be placing it
within a query so we don't want to we
don't to have any non integer data here
and we're going to return the result of
a MySQL result in fact no sorry no we're
not we're going to return and we're
going to use the tersha nary operator oh
sorry ternary operator we're going to
return true or false and this is based
on this condition here so if this
condition evaluates to true we are going
to return true otherwise false okay so
what is the condition well we're using
MySQL results to return a result if this
is equal to
zero then we return true sorry if this
is equal to one we return true otherwise
we return false and we we simply pass a
query with in here so query and we want
to access road 0 always in this case
okay so let me just quickly go over this
again just in case some you know some of
you can't grasp this which I could
understand anyway so we calling user
active and we're checking where the user
active is equal to true or false so we
pass in a user ID we sanitize this then
based on the result of this query here
IE is it equal to 1 we return true if
it's equal to 1 we turn false if it's
equal to anything else IE if it's equal
to 0 so in here we're going to select
count no serene we're not we're not at
all now we are going to select active
from users where user ID is equal to use
ID remember we don't need single quotes
here because we are using an integer
we're passing an integer through so as
it stands what will this function return
for me well it will return one because
my active status is set to 1 so we'll
select the active status from the users
table where I'm logged in so user ID
equal to 2 ID we're accessing row 0
which is the first row remember because
we only have one record for each unique
user if this that if this active here is
equal to 1 so we are actually instead
need to pass active through here
so the mysql query result functions
taking three parameters the first one is
the query the second one's the bio and
then the field we want to grab if this
field is equal to one we return true
otherwise we return false quite simple
so inside of in it we're going to say if
user active session user ID is equal to
false then local user out so we want to
say session destroy and then we could
redirect them back to the home page and
that's Heather location index dot PHP
will exit the script there as well so if
this function returns true we don't do
anything inside of this block if it
returns false we kill the session
redirect them and exit so at the moment
I can be happily browsing oops cannot
read their user active oh we've already
created the function have we of course
we did look at that oh that's by
username brilliant that's for our login
our login process isn't it okay so we
can use this yeah we can go our
bollocks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>