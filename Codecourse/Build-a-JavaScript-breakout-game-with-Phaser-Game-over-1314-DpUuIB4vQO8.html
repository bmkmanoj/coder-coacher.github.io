<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a JavaScript breakout game with Phaser: Game over (13/14) | Coder Coacher - Coaching Coders</title><meta content="Build a JavaScript breakout game with Phaser: Game over (13/14) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a JavaScript breakout game with Phaser: Game over (13/14)</b></h2><h5 class="post__date">2017-12-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DpUuIB4vQO8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">to make this a little bit easier to test
out before we go anywhere I'm gonna come
over to our Global's just here and I'm
gonna set lives to one just so we only
work with one life and we can go ahead
and check this immediately if lives is
at zero now when we go ahead and call
that method that we've just looked at in
the last part ball lost of course at
this point what we want to do is before
we go ahead and update the lives text
you could do it after this but there's
no need to update the text if the lives
that are at zero we can add a little
check in here and go ahead and return
down here if the lives are zero so if
this game global lives is zero we want
to end the game and we want to show that
end screen so I'm gonna call an end game
method like so just to keep things nice
and tidy down here let's go ahead and
create this end game method you might
want to do other things in there but
what we now need to do is start a new
state now by that I mean we already know
that we have a splash state which goes
ahead and shows our preloader this is
all code from the boilerplate that we
downloaded we have boot which happens
before that then we have game so you can
have a kind of pre game screen where a
user can click to start that'll be
pretty easy to add in if you want to go
ahead and do that yourself once you have
figured out what we're doing here so
what I'm gonna do is just copy splash it
doesn't really matter which of these
states that we take and I'm gonna create
a new state in here and of course I'm
gonna call this something like game over
J s now let's go ahead and get rid of
this and let's go ahead and get rid of
this as well because we don't to do
anything inside of here and let's go
ahead and register this we can also get
rid of the center game objects utility
that's included with this boilerplate so
what we want to do is come over to our
main J's file just here and this is
where our states are all registered and
we can switch between states as we need
so this can be as complicated or as easy
as you like but let's go ahead and say
game over I'm gonna call this game over
state and let's pull that state in from
that new father we've just created so
game over state from game over so we're
just calling it game over State so now
that we have our new
what we can do is over in our game when
the game ends we can say this games
state and we can start a new state and
we've called that game over so that's
pretty much as easy as it gets
let's just take a look at this and click
to release that ball and there we go so
we're now on the game over state but of
course we want to show that the game is
over we want to give some text in here
we already know how to build text so
have got doing that yourself if you want
to otherwise I'm gonna go ahead and show
you how to do this now now we don't need
to preload anything in here so we can go
ahead and just get rid of that and stick
out there and create is the point where
we want to add this text so we're going
to go ahead and create some text we're
just going to say this add text really
simple we want this to be in the center
of the screen so we can do that using
the methods that we saw before or we can
save this game with x not 0.5 and this
game height x not 0.5 and we can go
ahead and add in our object of our font
which is really simple we already know
how to do this so let's say 24 pixels
arial let's go ahead and fill this with
pure black let's go ahead and align this
centrally like so and then down here
what we can do is say text anchor set
not 0.5 and that's just gonna go ahead
and anchor that so we can position it
centrally what I would look at that in
just a second so let's go ahead and end
the game and there we go so who at the
moment we didn't supply the other
parameter in here that we require so
we're just seeing a object
representation but this is essentially
going to be this argument here it's
gonna be something like game over and
we're going to show some details so
again if I just go ahead and click there
we go so right in the center of the
screen we have game over now just to go
kind of give you an idea of what happens
if we don't set this anchor and go ahead
and click like so we see the following
so it's a little bit off-center so
that's why we set that anchor and then
we go ahead and set this based on half
of the width of the game of course you
could do divided by 2 if you wanted to
that's going to work in exactly the same
way let's just go ahead and check that
very quickly like so okay so the next
thing that we want to do then is the
text so let's go ahead and add some back
ticks here so we can insert some
variables we're gonna say game over
we're going to go down a couple of new
blinds and I'm gonna say you reached
level X with a score or with score X so
let's give that a refresh go ahead and
make sure we can in this game and there
we go so that's exactly what we want to
see now we know that because we set
these as Global's it's going to be as
easy as saying this game global level
and the same for score so this game
global score and now that should give us
the level and the score which of course
is pretty appalling okay so the only
issue with this now is we can't really
go anywhere so I can click here but
nothing is happening so what we want to
do is add a event handler here so when
on our input we see a down button
clicked we want to go ahead and add an
event handler and that is going to be
this restart game again just extracting
this out to another method passing the
current game instance in and down here
what we're gonna do is say restart game
like so and we're just gonna go and say
this game state start game so pretty
much just going back to the state that
we left so transferring over to this
state and then back to the game state so
if now I go ahead and lose the game
purposely we see the following when I
click with back to the game now there's
a couple of issues with this first of
all you have noticed that lives is zero
so let's just go and set our lives back
to three over in our default just here
and let's go ahead and lose this game a
few times you can see the scores at 10
20 and lives are now at zero so that
ended the game level one with a score of
30 when I click we still have the same
score we still have zero lives and if
the level had have incremented that's
going to also be the same value another
reason for this is because we're setting
these as Global's we're not resetting
them when we just switch a state so it's
important that what we do is
when we restart the game we reset them
global variables to what they were
before just to remind you of how this
worked if we just go over to our boot we
remember when we created our boot screen
we initialize the global variables by
cloning that default Global's really the
reason that we put these inside of their
own file is because we need to do pretty
much this same thing again over on our
game over screen when we restart so what
we want to do is go ahead and just do
exactly the same thing you can't put
this elsewhere but I prefer just to do
this just in case you were keeping track
of how many games had been played you
could switch these around you know it's
entirely up to you so this game global
army clone Global's so over in game over
let's go up an import clone from lodash
so we can go ahead and make use of
cloning that object down here and
restart game let's extract this out to a
new method actually so we're gonna say
reset global variables let's go ahead
and create this reset global variables
method and we just want to go ahead and
reset that to the clone version of
Global's and again we want to pull
Global's into here so let's go ahead and
import Global's
from and we go into Global's and index
okay so now what's going to happen is
that's going to clone that object the
default state of it remember that's why
we're cloning it because we're taking
the default score of zero default level
of one and default lives of three so if
I go ahead and lose a few times just by
incrementing my score on the way like so
when we lose and we click that's gonna
reset score reset our lives and also
reset our level as well</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>