<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 12): Protecting Pages | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 12): Protecting Pages - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 12): Protecting Pages</b></h2><h5 class="post__date">2012-05-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yn_PJhcoz5Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so in this part of the video we're
going to be creating some additional
pages and then we're going to be using
our or some logic to protect against
these you know people that haven't
logged in or registered and logged in
from accessing these pages and these
pages I've created just as an example
our downloads form and contact us now
they don't have anything in them at the
moment but because we have our
templating system we can just duplicate
over some code and it's relatively
straightforward to just create these new
pages so at the moment we've got
indexing we've got our register page and
also our login page which all have
templating systems if I just click on
that down here you see we are including
the header including the footer we
already know this so let's go ahead and
pick a slightly simpler page which is
index let's go ahead and just copy this
and we'll go ahead and we'll paste this
into a couple of other files and just go
ahead and save them out I just so we've
got some some content now so let's go
ahead and paste this into a new file and
I'm going to save this as downloads dot
PHP let me just bring up the menu within
our includes and then you can see so
we've got index which we've already
created we need to create downloads
forum and contact PHP now downloads and
form are going to be protected contact
is not going to be protected we're just
adding it as an example to say what
anyone can access this Contact Us page
but to access the downloads or the forum
you have to be logged in so downloads is
now done let's just go ahead and change
the header in here let's just leave it
like that and let's go ahead again and
create a new file here called forum dot
PHP and again I'll just change this
header perfect close these we don't
really need them and the last one is
contact and this doesn't need to be
protected so we can just say contact I'm
just going to say
contact details and I can go ahead and
save that and we don't actually need to
do anything with that but it's going to
be accessible regardless of the user
being logged in or not okay so now what
do we do well we've got all these files
let's just go ahead and visit them so we
got downloads form and contact us oh
just see how I save that I think I'm out
of contact up PHP oh that's odd
I've saved it inside of Khan I've saved
inside include so I'm going to cut that
and just paste it over here brilliant
okay so right so we've got up our three
pages now we need to protect downloads
and forum so how do we do this what we
need to do is we need to redirect the
user to a generic page to tell them they
need to log in to access this specific
area we want to repeat the same logic on
every page because it's going to mean
we're going to duplicate a lot of code
so it makes more sense to create a
generic page that allows us to just say
to the user sorry you know you need to
login to access that area and then you
know whatever you want to put on that so
we're going to go ahead and create that
that generic page just quickly and then
we're going to create a function that
will just be able to just be able to
call at the top of every page that we
want to protect and this function is
going to check if the users logged in
and then if they aren't it's just going
to redirect them to this generic page
that we're creating so again we go ahead
and we need to copy and paste we should
have done this in the last step just
copy and paste the generic template here
paste that in and I'm just going to say
here sorry you need to be logged in to
do that
please register or login okay that's
fair enough and I'm just going to call
this protected PHP okay call it whatever
you like protected dot PHP is probably
not the friendliest name if anyone was
seeing in the URL bar but there it is
that's essentially it so when I click on
downloads and I'm not logged in like I'm
not at the moment
I want to be forwarded to that protected
PHP page same with form and contact
we're not going to include this
functionality so let's go ahead and and
open up
core functions and general this is
essentially just going to just going to
create function here that's going to
allow us to you know redirect the user
and I'm going to call this function
protect page so the function protect
page and this is relative well this is
extremely straightforward all we're now
doing is we're calling the other we're
calling the logged in function which we
have inside of users dot PHP that's
going to find it we're calling this
function within this function so we're
going to say if logged in is equal to
false then we want to use the header
function and redirect the user to
protected PHP and then we want to exit
so by placing this at the top of any
page that we want to protect we are
going to be checking if the users logged
in if not we're going to be redirecting
them now as I've said the reason we've
put this in a function is because
otherwise we would have to duplicate
this logic that I've highlighted on
every page that we want to protect
against and obviously it's not good to
reuse code over and over again so we're
going to be using this protect page
function so let's go ahead and open up
the files that we want to protect that
is form and downloads okay so let's go
ahead and get rid of this and get rid of
this and get rid of
so at the top what we want to do well do
we want to load the header before we
before that we do this functionality so
do we want to put our check here or do
we want to put our check here well it
obviously makes sense to put it before
we load in the header file because we
actually you know we don't want to
display any data to the user or any
information or anything and he designed
to the user you know unless they logged
in we because we're doing a redirect to
it there's no need so logically we place
it here so all we're going to do is
we're going to call this function
protect page and that's it that's what
we need to do so we'll do the same for
downloads and that will just call well
that will just check the if statement so
the condition will be checked if the
user isn't logged in it will be
redirected so I'm back on home contact
us isn't protected when I click on
downloads you see that we you know we're
now redirected to protected PHP and the
same with form as well when I click on
that we're redirected to protected PHP
so these two pages are now protected now
on the opposite end of the scale let's
just go ahead and log in and check that
this works and so Alex and password
there we go
so now I can click on download some form
and I can view this content as I please
so I'm logged in and it's allowed but
what happens if I now go and I now try
and access register dot PHP well this
doesn't make sense because I can
register again and I'm already logged in
and it just looks a bit messy in you
know it doesn't it's not the sign of a
well-structured application so we are
going to protect against this register
page being accessed if the user is
already logged in so we're doing it you
know the opposite way round so let's go
ahead and open general dot PHP back up
again and this time we're going to
create a function similar to protect
page but it's going to be the opposite
way round so we'll be function and I'm
going to call this logged in redirect
I'm going to say if something and that
is if logged in is equal to true this
time not false so we want to check it if
the user is logged in now if they are
logged in what do we want to do with the
user well we aren't going to be too
friendly because we're going to assume
that they're trying to access a page
like register dot PHP and you know we
buy there by typing into the URL bar by
purposely trying to access it you might
want to include a generic friendly error
so it's sorry something went wrong or
something like that but for now I'm just
going to be lazy and I'm going to
redirect them back to index dot PHP and
then I'm going to exit underneath there
as well so now I can include this logged
in redirect function on any page that I
want to protect against so I can just go
put that in there and I've called that
function so now when I I'll just return
to the index page quickly now when I go
ahead and say well I'm logged in but I
want to go back to register dot PHP
nothing's happened because it was that
quick it just redirected us back to back
to the index index page say I'm on
contact dot PHP and I try and access
register takes a straight over to the
index so that's that's how we can do
that as well and the other one is login
dot PHP and it says we tried to login
but no data received remember we set
this error up earlier within our errors
array but we don't want to we don't want
to show this it's unnecessary to show
this so we'll go ahead and we'll open
our login dot PHP and we'll go ahead and
include this function here as well so
when we do try to access this it goes
back to the index page so what we've
done here is we've protected against
pages that users shouldn't be accessing
if they haven't registered and logged in
I'm also protecting against pages that
users shouldn't really be accessing if
they have already registered and logged
in so we've covered both bases and as I
said you can include more more much more
friendly error messages or error pages
or you could you know create functions
for different things and pass through
different errors and there's all sorts
of things you can do but I'm not going
to be touching on that
entirely up to you so that's the end of
this part of the tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>