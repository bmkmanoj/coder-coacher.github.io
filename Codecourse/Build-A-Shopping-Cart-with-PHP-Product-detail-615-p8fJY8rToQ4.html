<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Shopping Cart with PHP: Product detail (6/15) | Coder Coacher - Coaching Coders</title><meta content="Build A Shopping Cart with PHP: Product detail (6/15) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Shopping Cart with PHP: Product detail (6/15)</b></h2><h5 class="post__date">2016-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/p8fJY8rToQ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so we have our product index but
now obviously what we need to do is
click through onto the product detail
page so this isn't too much work we need
to create our controller and now route
we need to create a base template or at
least just a template for this and we'll
hook these up and then we'll just focus
on the structure of the product index or
the product detail page sorry so I guess
the first thing then let's just head
over and we will update or rather create
a new controller so let's create a
controller in here called product
controller and inside of here we'll
pretty much just have the same things
it's very straightforward we just have a
namespace to this which is cart
controllers and in here we have our
product controller and as part of this
we want a get method in here this will
take in a slug because remember what
we're doing is identifying each product
by a slug so let's just paste the slug
in here we'll look at how we do this
within the routes in just a moment and
what we also have is our request in our
response so we can pull these two over
from here and use them up here and of
course what we also want to do is use
our product model because we're going to
need that as well so inside of here then
we have our request which we can type
int we have our response which we can
also type int and then as part of this
we have our view so we need to put in
Twix here like so and we also have our
product in there as well so product now
we'll also need to pull in our route to
here in just a moment just in case the
product can't be found
so obviously wanting to check if this is
found first and then we can redirect the
user if it's not found so let's start
them by rendering out a view we need to
create this but we'll render this now
and then we'll go ahead and create that
in a moment so remember we just say view
render we pass in our response and we
pass in the name of the view so in this
case we're gonna be creating a product
product quick view okay so over in our
products file
then let's create a new file and we will
call this product WIC and we'll just
write product in here for now so now
what we can do is just hook this up to
our roots and we can see if this works
so let's head over to our roots file and
we'll just duplicate this one down to
save a bit of time but essentially what
we need to do here is say something like
products and then in here grab the slug
that's passed into the URI so this will
be product controller and remember now
the method is get and we need to give
this a name which is just product get
this means that we can link to it and we
don't have to refer to it by its URI
makes sense to do this just in case we
changed the URI so now we can
essentially just go over and test this
so we can say products and then we can
give a slug so in this case I have one
up here already and of course we have a
reflection exception here because ivory
now product controller we didn't pull in
Twix so we just say twig rather slim
twig view in fact now it's the other way
around isn't it slim used twig there we
go and just bump that up so now we see
the product page based on what's which
slug we basically have okay so I guess
what we can do now is just hook these up
in our item so remember over in products
partials we have this item just here we
have the ability to click on the
thumbnail or the title to get through to
this page so how do we do this how do we
be able to link up well this is a simple
as saying and we'll do this for the
image first of all we just say path for
we give the name of the path or at least
the name of the route so it's product
get and then in here we pass through the
item that we want to basically be put
into the URI so this happens to be
product slug so we can do the same thing
here for the title and that is pretty
much it
so now when we go over to our index
we'll see that when we click on this we
go through to the correct slug so we can
do it for another one say Blake espresso
and we go through here as well so pretty
straightforward but obvious
see now what we need to do is update our
product controller to actually grab the
product check if it isn't found and then
we want to redirect the user and then of
course what we can do is pass this
details through to the product view and
then just out pull the information we
need so let's create a product variable
just here and we're gonna say product
where so this is now eloquent if you've
not worked with eloquent before we're
just saying we're the slug equals the
slug that's passed in here from the URI
and then we're gonna grab the first
result now this here will be null if it
can't be found so what we can do down
here is say if no product then here what
we want to do is redirect so to do this
we need to pull in our router now I'm
putting a lot into here I'm going to
pull the Rooter into here in a minute
but what you can do if you want to cut
this down is create a constructor so you
would do something like this
so construct you would go and say let's
say we want to pull out view in here you
could do this that will inject that as
well and then you could say this view
equals view and then up here you can
just create that property there or
rather that would be called view and
then in here rather than doing view you
would say this view like so so it's
entirely up to you how you do this I'm
not going to do this just to keep this
simple but of course the more you inject
here the more messy things get so if you
do add to this go ahead and fix that up
so we want to put in our route to them
now our Rooter comes from slim Rooter
this is just basically what we use for
our routing so here we're gonna say
Rooter Rooter and that means that now
what we can do is if there's no product
we can return we use response for this
and we say with redirect this
essentially just redirect us to a
particular page now what we want to do
is redirect to home by its name so to do
this we save Reuter path for home now
again the reason we do this is if we do
change the path of this then
it will just all the UI at least it will
just automatically update we don't need
to come through and change all of the
URIs
so now let's just click on one of these
and let's just change this and there we
go we redirected back to the home page
simple as that now if that's not the
case we obviously get to the point where
we render this view and like we did with
the index where we passed in all the
products this time we're just passing a
single product in and that is product
like that
so now when we click on this we now have
this product available on this view
ready to start using so over in our
templates or rather in our products
template we want to update this page
here to actually output our product so
this is pretty straightforward all we
want to do is use our app base template
so we just say extends templates app
quick and then here we want to define
the content so we just say block content
and then down here we go and that block
so again we want a row in here so we can
use columns and we want a medium or on a
medium viewport we want four columns
here this will be the image and then
just underneath this we want eight
columns because that makes up a total of
twelve we want the details so that will
now look like this so we have the image
here and then we've got the details just
here so for the image then this is
pretty straightforward we just have an
image tag we know we have that product
variable so we can just say products dot
image for the alt we can say something
like product dot title and then outside
of this image and then what we want to
do is give this a class of thumbnail
image responsive the what that will do
is it will allow us to when we come down
here have this as a kind of responsive
image and it will fit to the container
it's in it won't look a little bit
strange if you don't apply this you will
end up with something like this
so looks a bit weird so we have our
image in there that's great now we need
to focus on the details so as part of
the details what we're also going to be
including is where
there's low stock or whether something
is out of stock so we're gonna go back
and update our product modeling just a
bit but let's first of all focus on
stuff like the header which is just
going to be the product title so we just
couldn't say product title here and
underneath it will be the product
description so here we just say product
description and I think that for now is
pretty much it so that's looking fine
and we can start to output our little
stuff up here if we have low or no stock
and we can test this out by adjusting
the details in the database and then
finally we will come down here and make
an Add to Cart button which we'll get to
a bit later when we actually start
adding things to our cart so to do this
then we're going to come over to models
and product I'm gonna start to create
some methods in here which will actually
allow us to check things so the first
method then is going to be has low stock
and this will just return true or false
so we're also going to have will just
outline these first out of stock and we
will also create a method here called in
stock we won't necessarily be using this
just now but we will be using this later
and we'll finally create a has stock
method and what we'll do is here pass in
a quantity so we'll fill these out we're
not going to use all of them now we're
going to use these two now but they'll
be there ready for us to use
so for hazlo stock then what we want to
do is first of all check if it is out of
stock and then return false so this just
makes it a little bit less complicated
and we can kind of utilize other methods
we have in here so I guess let's start
with out of stock so what we want to do
is say return this stock equals zero so
it's just comparing to see if that stock
is zero if that's the case we know that
it's out of stock for low stock the
first thing we want to do is check if it
is out of stock so we're gonna say this
out of stock and if it is out of stock
we want to
first now otherwise we want to check if
it's less than or equal to five now
obviously you can adjust this figure but
basically that will mean that if it's
five or less that's classed as low stock
so here we want to return this stock
less than or equal to five and what we
can do is just go ahead and wrap this in
brackets and then here we can cast this
to a boolean so that will give us all
the information we need so let's just
finally do in stock and all we want to
do here is return this stock greater
than or equal to one that means it's in
stock and has stock will basically take
a quantity and check if the quantity
given is greater than or equal to the
amount that we actually have stored in
the database so here it would just be
this stock greater than or equal to the
quantity that we give simple though like
I said we're not going to use these two
but we'll use these two just now so now
that we have these methods on our model
remember what we're passing through to
our view is a model remember when we did
our index we're passing through a
collection of models here we're passing
through a single model and if you want
to check that out you can just do a var
dump on this and you'll see what I mean
so because we have their methods now we
can update this to check so a couple of
if statements then the first one will be
if product has low stock and we don't
need the brackets here we can just leave
that as it is and then here we will just
end that if and in here then if we do
have low stock we can create a label and
this will be a span by the way and in
here we can say label warning and here
we just say low stock so if we duplicate
this down and we'll create one for out
of stock so we just say out of stock
that's the method and here it will be
danger for red and then here we will say
out of stock simple as that so now if we
just refresh on this one you can see
that we just see normal because
obviously for this one we do have stock
so let's pull open our database go over
to products
this one is this one here we have plenty
of stock we've got ten if we set this to
five you can see that we get low stock
if we set this to one we have low stock
if we set it to zero we are obviously
out of stock so that just updates their
accordingly so now that we've done them
- let's just finally implement our
button down here to Add to Cart which
obviously we're not going to be clicking
through 20 we're at the moment but what
we are doing is we are going to check if
the product is actually in stock and I
only show the bus and if it's in stock
it doesn't make sense to have a button
there if it's not in stock so here let's
just create well we'll create the button
first of all this is just a anchor with
a class of button button default and it
will be a small button and we'll say Add
to Cart so that looks like this and then
for the H ref we obviously don't need
anything so we can just put hash in here
and we can actually use one of the
methods that we implemented that I said
we weren't gonna be using and that is
product in stock and then down here we
just end that if statement so at the
moment we would expect that not to show
because we are commenting out of stock
but if we have one or more we have Add
to Cart and of course it shows that we
have low stock anyway so that is pretty
much it that is our product detail page
updating our product model and of course
creating our product controller to go
ahead and deal with all of this weather
products exists passing it through to
our view and pulling up and creating
this product detail page and of course
this will work for all of our products
as well
thanks so much to Braintree payments for
supporting Co course why make payment
integration more difficult than it needs
to be rain trees a full-stack payment
platform lets you accept nearly any type
of payment from any device with a simple
integration it's flexible and supports
most programming languages so for SDKs
for dotnet nodejs
HP Python Perl and Ruby you'll always
have a range of client and server-side
SDKs available for your integration
Braintree makes payments and your job a
lot easier and you can learn more at
Braintree payments comm slash code
course</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>