<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>MySQL: Joins | Coder Coacher - Coaching Coders</title><meta content="MySQL: Joins - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>MySQL: Joins</b></h2><h5 class="post__date">2014-08-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/wYXmbcKPgsQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to look at my
SQL joins and we are going to be taking
three tables in this case we're working
with a kind of forum like structure so
we've got users these could be users
that just register on your website or
forum or something topics which are just
forum topics so we've got a title here
these are associated with a user so
rather than having a user name this
gives a number which relates to the
users ID now this is an auto increment
field we'll be building these tables in
just a moment so don't worry if you are
unsure how to build these up now with
posts this is a little bit more
complicated because we've got a topic
here and a user Association as well now
what we're aiming for is we're aiming
for a list of topics now what I've done
here is I've just done a print R on the
objects returned my my sqli and we'll be
looking at this from scratch so if that
doesn't make sense to you'll see what
we're talking about in a moment but we
we've got a title here which is
obviously the title of a topic and this
is obviously a topic listing so this is
just listing through all the topics that
are in the database we've then got a
user name so without doing queries
within loops which is extremely bad
practice and slow and unmaintainable we
have the user name being pulled in with
this query and we've also here got the
count of the amount of posts associated
with that topic so this is really useful
because we're doing one query but we're
accessing data from all three tables in
our database so that's pretty much what
we're going to be doing and by the end
of this video you should have a very
good idea of how to join tables and do
things like count on tables so let's go
ahead and start to build out the
database tables and then we'll go ahead
and look at some code okay so we're
starting completely from scratch I've
got a database here called website and
I'm going to create these three tables
that we saw just a second ago so the
first one is going to be the users table
now don't worry which software you're
you
to actually create these tables it
really doesn't matter it's exactly the
same concept as long as you're using a
MySQL database so under users this ID
field has been automatically generated
for me but if not if you're not using
something like sequel Pro you'll want to
go ahead and add an ID field this will
need to be a primary key and it will
need to be auto increment all this means
is that this will increment every time
we create a record in the next field
that we're going to have is the user
name and this is going to be a varchar
and this is going to be say 20
characters long it really doesn't matter
cuz we're just playing around with some
data here so let's add a few test users
in here so I'll just add a few in here
there we go so we've got four users in
this so we've got plenty of days - here
- to test with let's now create our
topics table so this is going to have a
topic title and it's going to be
associated to a user so for example when
you're creating a new topic within your
website you would store this the user ID
along with this so the user might be
logged in you might be storing the ID in
a session or you might have that just
available you can then insert this along
with the record so the title here is
going to be a var charm also this 200
characters for example the user can
remain as an int it doesn't have to be
11 lengths but we'll leave that as it is
so let's create a few tests
topics and we'll associate them with
some of the users that we have within
our database at the moment so I'll say
test topic 1 and we'll associate that
with user 1 so test topic 2 will
associate say with user 2 and we'll have
again test topic 3 let's also say sit
associate that with user 1 and we'll
have test topic 4 let's associate that
with user 3 and then we'll say test
topic 5 and we'll associate that with
user 4 so we've included all of the
users that we have in
here at the moment just to test things
out and we've got five topics that we
can work with so now let's do the third
table which is the posts table so this
is going to be the content that user has
posted within a topic so as many users
it exists can post within a particular
topic so in posts we need to say well
we're going to have this associated to a
topic so this is again an integer this
will just basically be the the users ID
and the topic ID sorry and the user as
well so that's going to be oops the user
ID like so so they can both remain as
integers and the audio will literally
just be some text there the the user can
go and just type in so let's go ahead
and create some test test in here we're
going to say topic say one and we'll say
user one and in here let's just say
let's just say this is a test and we'll
copy this just so we can save a little
bit of time so we'll also then target
topic one as well and we'll say user two
posted this and again that will just be
this as a test and let's again fill out
topics a two and we'll say user three
and we will add this in here and we'll
say topic three will so use a one and
we'll say topic three again and use a
one so we're just sort of mixing this up
really obviously with a normal
application this would just be post by
users you wouldn't be inserting data
here and lastly we'll put pics a topic
five and we'll say user four like so and
that leaves us without a record with
topic 4 so that will have zero posts
within it so what we're actually doing
here is we're assuming that a topic
doesn't have to have any posts so we're
going to do a left join which we'll look
at in a moment and that means that topic
always exists but posts might not exist
so we're just assuming that a user can
post the topic with
an initial host and that may not be the
case in a real world scenario but in
this case to learn about joins we'll
just assume that's the case and also
just before we start a topic always must
have a user so we're going to be using
an inner join for this so these both
must match so a topic must have a user a
topic can't exist without user posting
it but a topic can exist without posts
being in it so that's really important
to remember when we look at this so now
that we've set up the database table
let's head over to our text editor and
actually start to write out the query
that's going to bring this in and we'll
start very slowly and then we'll start
to introduce the joins as things start
to get more complicated so let's create
a new mysqli instance just so we can
quickly connect to our database we're
connecting to localhost here and my
username is root and my password here is
root and remember the database name is
website so we're now connected up to our
database and we can issue a query so I'm
going to store a queries result inside
of this topics variable so the query I'm
going to split into multiple lines just
so we can read it a little bit better so
very basic query just to pull out the
topic title would look something like
this select either everything so that
would select the ID and the title and
the user so if we just head back to our
database that would select all three
fields so you could say select
everything from topics like that and
we're going to do just a little while
loop down here and for each of these
loops we are going to fetch an object
from this query or this result so here
what I'm going to do is I'm going to
echo out some pre tags and within this
and just concatenate in all this on I'm
going to do a print R on that row so all
this does is it just wraps these in pre
tags so we can maintain the formatting
and print R will give us a
representation of what's in this row
so now you'll see something like this so
we basically just have objects so we can
access the title the ID and the user so
for example I could do let's just
comment this out I could do something
like echo row title if you wanted to do
that but for now we're just concerned
about the data it comes out and how we
use it so we've got the ID which we
don't necessarily need we might use it
eventually we've got the title here and
we've got the user now the user at the
moment just is one two and that's
useless now in a typical example what
you might do is you might then do
another query in here to fetch the user
now that would be bad because what
you're doing is let's say you have a
hundred topics you're then doing another
hundred queries just to fetch the user
that's really bad practice because when
you loop within a query you're
generating so many queries you're
generating so many requests to your
MySQL server you're just slowing down
your application so what we want to do
is just keep things like this we're not
adding anything else within this while
loop at all we're doing everything
within the query and this query is only
going to be about six lines long so it's
not that much of a deal so instead of
selecting everything from topics let's
specifically define what we need now I
want to pull back the ID because I might
want to link off somewhere and I want
the title as well I also want the
username now this username doesn't exist
exist in our topics table exists in our
users table so somehow within our query
we have to say well this number here
matter is equivalent of this username
Alex so we need to join these records
somehow so instead of saying select ID
and select title I want to specifically
define where these come from because
otherwise what we do is if we have field
match the same this is going to cause a
little bit of confusion within this
query now ID is ambiguous it could
belong to topics it could belong to
posts it could belong to users so we're
literally going to define where we want
this to come from so we're going to say
topics to ID and topics title and that's
from topics table here and because this
query is pulling topics we're always
going to say from topics because that's
the table we want to pull from and then
we want to additionally pull from the
users and posts so let's look at getting
this username in here so we've got ID
and title we want instead to have a user
name in here so we can output that so
how do we do this well we again
specifically define where we want to
pull the username from exists in the
users table so we say users dot username
simple as that
and this isn't going to work at the
moment it just the query basically
errors so we get back this error message
here and the reason that happens is
because we're not pulling we're not
saying where we want this to be sort of
joined on so all we do is we do an inner
join now an inner join means that this
exists on both sides so if you think
about joining you have a left and a
right side inner join basically means
the topic always has to exist alongside
of a user in an example where for
example you have a user and maybe orders
maybe you have a website where a user
can take or place orders a user doesn't
necessarily always have orders so you
can have users exist without orders in
this case when a user posts a topic a
topic must have a user a user might not
have a topic so if you were listing
users you would do a different kind of
join so that's a brief sort of
explanation of the this inner join type
so we want to inner join users so this
is the name of the table we're doing an
inner join on users so we now need to
define how this relationship works we
need to know for example if we look at
this topics user matches topics user
sorry users dot ID so this needs to link
up with this so we need to sort of tell
that MySQL that this is the case so we
use the on key
and we say on topics dot user so that's
the field we've just seen equals user ID
so these are what join up this data
let's take a look at this now okay let's
check what's happened here at that uses
the ID so there we go we've now got five
topics which we expected and you can now
see that we've got the username here if
you needed to grab any other data from
the users table for example if you
wanted the users ID you could do that
like so but there's a little bit of a
problem here when we say users dot ID
this then changes the ID here that's not
great because we're sort of overwriting
this field so what we can do is we can
use that as keyword so I could say user
underscore ID for example and then that
would give me an extra field here with
that particular users ID so that's a
little bit a little bit better so that's
just a little added thing if you if you
do want to do that and just to make sure
you understand as it's just pulls that
in okay so now that we've done that we
want to fetch the count of posts within
this particular topic so we you know we
can do this again by looping within the
wild Oh querying within this more loop
but again that's bad practice so we need
to do a second join now just to clarify
remember a topic can exist in our case
without any posts at all you can have a
topic you can click through to it it
doesn't necessarily have to have any
posts probably in a real-world situation
you would do have posts you would have
at least one post but there now is we're
going to say that we can have zero posts
so this time we do a left join and the
reason we do a left join on posts is
because the topic is on the Left that
exists but on the right hand side of the
join which is the posts table here that
doesn't have to match up it doesn't have
to exist so again we're going to use the
on keyword now this time if we look
inside of topics we have a topic ID and
we have a post with
topic ID so within topics or when we
join posts the topic here must match
this topic ID here and we've done that
when we inserted the data so we know
that that they match up so here we're
going to say topics dot ID equals posts
topic so topics to ID equals posts topic
okay so that's how we join that now what
we're going to do is we're also going to
look a grouping because what what's
going to happen here is you'll now
notice that we get one two three four
five six seven results what is going on
here the reason this happens is because
we're not actually telling how to group
this by drooping what we actually do is
we say well I want to group it by a
specific table field so I'm going to say
topics to ID and what that will do is it
will say well the topics to ID are
unique so each of these are unique and
therefore now we have five records
because we know that one two three four
five are unique so that's how we do that
so we've now actually joined that table
but we're not actually pulling in any
data from this table so let's just pull
this down a little bit just so we can
come on to the second line and I'm going
to say I want to join oh sorry I want to
select the count of hosts to ID now
count will just count the amount of
records based on that join so here what
we're actually going to do is we're
going to say as hosts like so so this
will just be a post count you can call
it post count if you want whatever so
now what we get is we get a post count
so remember we had two posts on that
first topic so we can confirm that by
heading over to post so we've got a post
here to post on topic one so that's okay
we have got one post on topic two so we
can check that out as well so we've got
one post on topic two there which is
this post here and on topic three we've
got two pi
wrists which is right we've got two
posts there on topic four we've got the
zero we purposely didn't add that in and
we've got one post on topic five so that
looks like it's all worked so what we've
done here is within one query we've
learned inner joins with left joins
we've learned selecting from different
tables and collaborating all of this
data so we can output it in one while
loop and we've done this all with one
query so we are maximizing how efficient
we can be so that's how we do joins
within MySQL a very basic introduction
but this should give you the knowledge
you need to go forward and create more
complicated queries</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>