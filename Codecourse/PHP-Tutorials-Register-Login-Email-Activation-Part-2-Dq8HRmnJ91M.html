<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login: Email Activation (Part 2) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login: Email Activation (Part 2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login: Email Activation (Part 2)</b></h2><h5 class="post__date">2009-08-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Dq8HRmnJ91M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so this is the second part of the
email activation tutorial basically what
I'm gonna do is I'm not actually going
to be doing any programming at all I'm
not going to be coding this out I'm
basically going to run through the
process the reason being is it's a long
winded script you can see if I just
scroll all the way down and I think the
best thing to do would just be to roll
through this and explain each part of it
if you are typing this out if you are
typing this out from the tutorial that
might make it easier for you otherwise
just sit back relax and I'll explain
this and hopefully you'll learn a thing
I do okay so the first thing we're not
going to start at the top of the script
we're going to start at the bottom this
is the register form here we've got it
in HTML here obviously our action is
going to go straight back to our
register dot PHP we're currently in this
file and our method is going to be post
just for reasons being security firstly
and also that we might send long data
and the gate can't handle
we've just got choose username and we've
got an input text here and then we've
got choose password and then an input
text here with the type of password so
it's so starred out and then we've got
the email address so it's a pretty
standard form then we've got a button
here so that will submit this data back
into this back into this script so then
at the top of the script we can get the
form data here now we're using this if
statement here we're gonna say if
underscore post register now basically
what this does is if we come down it's
just this label here so it means if the
button has been clicked because we don't
need them this script here to run if the
button hasn't already been clicked so
we're taking our username password our
email address email being the most
important and we're adding slashes
stripping tags just for security reasons
add slash' stops things like SQL
injection obviously if you're using
single quote single inverted commas
quotation marks if you like but single
ones then this is going to add slashes
and stop SQL injection okay then we're
doing a basic bit of validation here
we're just saying if doesn't exist
username
doesn't exist password and doesn't exist
email address we're gonna say fill out
all fields so coming back down
we're encrypting our password because
when we register we want to put an md5
encrypted password in if you don't know
what that is give it a read up it's just
a form of encryption and then we're
checking if the username is already
taken so this check here is just going
to say MySQL query which is our function
select star from users where the
username equals the username variable
that the users provided and then if the
rows is bigger than or equal to one so
if a row is returned with the username
equaling the one that they've given then
we're gonna say username were only taken
so presumably this will never really if
our script does work properly this is
never really going to produce anything
bigger than one but I just use this for
just for nice validation and assurance
really that we're definitely not
registering the same user again okay so
now the most important part and this is
relative to this tutorial we've got a
code here we're generating a random code
now you can really create this any in
any way you like you can make it as
fancy as you like or as simple as you
like what I've basically done is use the
round function which picks a random
number between this number here and this
number here so it's likely we're gonna
have a different random number every
time now if we are having the same
random number we're gonna have problems
so what I recommend you do is make this
as unique as you possibly can okay so
now we're gonna send the activation
email so this is the email part of it if
you don't know how to send email in PHP
then this is obviously for you I've put
a two variable here which equals that
email now this is the email that's
already provided I've put this back into
another variable just to sort of keep
everything together and make it a bit
more simple so you can understand it so
this is the email address where sending
to so the email that up up here was
provided in the form let's go back down
again
okay now subject can just be any text
subject so I've put activate your
account like you saw in the thing here
if we go up activate your account that's
what was
that's what was displayed to the user in
the subject and we've got our headers
here now this is quite important a lot
of my others don't let you send the
email unless it's from something
obviously so you need to sort of abide
by this structure so we've got headers
obviously you can call this variable
anything you like
we've got from and then a colon a space
and then the email address that is from
so this can really be anything I've put
Alex at PHP academy' info because I'm
working from my server so PHP academy'
got info it makes a sensible choice and
then I've got my name at the start of
the app this can be anything which leads
to sort of the anonymous email issue but
I'm just gonna keep it simple keep it
relative to my website okay another body
which is again brings in a really
important part we're gonna say hello
username so we're addressing the user by
their username that they registered by
we're using a backslash n backslash n
which is a newline so we're going down a
paragraph so two new lines and I've put
just some fancy text like you've
registered need to activate your account
this matches obviously the one you saw
in the email earlier click the link
below or paste it into the URL bar of
your browser new line new line okay so
we've got the web address here now what
this is going to point to is our
activate PHP page so I've got PHP
academy' not info forward slash
tutorials forward / email activation
forward slash activate PHP so that's
basically within this directory here so
we've got all our files and then we've
got activate dot PHP okay and then we've
got code equals and then all you need to
do is put the code in there and that
you've randomly generated the one up
here so that puts the randomly generated
code in and that has here you can see
here so we've got a random code here and
then a couple of more lines and then
Thanks so just being polite now we want
to send the email but what we're doing
is we don't register the user if the
email function is going
fail so we don't have register them a
bit later on if this is going to fail so
I've put this function inside a bracket
inside an if statement sorry and I've
put an exclamation mark
so this basically means if this hasn't
sent now this mail function won't
execute
anyway even if it's inside an if
statement but we're saying if it hasn't
sent say we couldn't sign you up at this
time please try again later
so this will send regardless but at the
same time it will check it and basically
we've got our four parameters and here
we've got two which is our email address
subject which is our subject here
remember this does have to go in this
order then we've got body which is here
and we've got headers which is here so
we've got our four essential
we're not essential about our four
essential for this purpose parameters
inside our malfunction that code that's
that function alone there we'll send the
email to the email address you provided
so that's as long as that sent
we're going to come on to this code here
inside this block and we're gonna say
register into database so we've got a
register variable and we've got MySQL
query so you've probably seen this
before insert into users which is our
table name values the first here is ID
let's go back to structure okay so our
first one is ID let's just close this
off first one is ID so we don't need to
put anything in there but it'll
automatically increment we've got our
username which matches up here then
we've got password in email so we've got
password and email now this is the
really important crucial step putting
the code in here so the code variable
that you've put out in the email has to
match the code that's going into the
database next to their name so code
that's obviously a type of integer and
we've got active one here our active
column here which we're gonna
automatically set to nor because our the
email account isn't active and then
we're just gonna display our little
message you have been registered
successfully please check your email
their email in brackets so they know
which emails and
who just in case they forget and then to
activate your account so that's pretty
much that process done and yeah that's
that's going to send up the email that's
going to put the code into the database
and await their activation okay so the
next thing to look at is the activate
PHP script and I'm going to follow this
through in an email
that's so let's go back to my Inbox okay
so what I'm going to do is I'm going to
register another account I'm going to
choose the username Kyle I'm going to
choose the password one two three even
though I'll be md4 md5 encrypted and I'm
just gonna choose my email address again
I'm gonna click register okay you've
been registered successfully please
check your email
and then my email in brackets like you
just saw in the last script I went
through click on my email click on inbox
and I've got an email okay so hello Kyle
you registered and need to activate your
account blah blah blah there's the
there's the link there's the code what
I'm going to do before I click on it is
I'm going to go into the database click
browse I'm going to come down you can
see that the new records been inserted
we've got the password which is
encrypted we've got the email address
here and we've got this code most
importantly we've got active set to zero
so this code should match this code here
which it does so when we click on this
we're going to go through the activate
process it's going to go like I said in
the like it put before it goes into the
it goes into the email body and displays
to the user as a link and it is a get
variable inside our active PHP so if you
come back to here you can see activate
dot PHP and we've got a question mark
for our variables after this code equals
the code so presumably when you click
this it'll go to activate dot PHP and
this code variable will be sent as a get
variable to that page so if we open up
activate dot PHP
we can have a look inside okay so we've
got include global that's just standard
we need to include everything that I've
shown you and then we've got code equals
dollar sign underscore get code so this
is the code that we are taking into
account from the email here now I need
to sort of point out that if you do go
on activate dot PHP on its own it will
say no code supplied this is due to this
if statement here if no code then echo
no code supplied so that pretty much
avoids people just you know coming into
the script and it sort of tells them
that there's no no code supplied okay so
now we're going to check that if the
user has already activate their account
so we're using our MySQL query we're
selecting everything from users where
the code equals our specific code here
which has been supplied here because we
put this into a variable and active
equals one so if they're supplying a
code but their account is already
activated so if active equals one then
we're using this MySQL num rows equals
one check to say you've already
activates your account so if this row is
returned then MySQL num rows of this
this query here will return a one so
we're basically putting this check and
having this output if that's if that's
true so otherwise they haven't activated
their account so we need to activate
their account so we have this activate
link hit activate variable here and we
have a MySQL query and the query goes
like this update uses so updated
eighteen our user's table set active
equals one where code equals the code
supplied so the code that is supplied is
unique to the user so therefore as long
as the code supplied here is correct
active next to that next to their name
will be set to one so if we run this
query through sort of like dry running
the code here is set to this
Oh plead the wrong thing so if the code
here this is this is basically what it
look like if you ran it through on its
own as a standalone query we have update
users set active equals one where code
equals that so what the this query does
is say or the code equals this here
which is this user here Kyle so we're
going to set this active here to one so
it's setting active one unique to the
code that's supplied through the email
so it's pretty simple if you think about
it obviously this needs to be code
because we're using a variable that's
been supplied and then as soon as that's
completed we're saying active your
account has been activated
so that will basically update that and
that'll activate that and then let the
user login okay so what we're gonna do
now is I'm gonna come back to our login
page so that's index dot PHP and I'm
gonna try and log in as Kyle now
remember the active is set to zero at
the moment okay you haven't activated
your account please check your email and
again we're giving the email that was
used so why is this happening let's go
into our index dot PHP and this is
something to do the login process now
let me run through the login process
again we've got a form down here that's
just basically a username password and
then a submit button we're using a
method of post jumping all the way up to
the top as it's a self submitting form
and the first thing we're doing is
grabbing the session username which is
that which is what we're going to set if
the user is logged in then we're
checking for our post login which is
basically this label here which is
basically saying has this form been
submitted has this button being pressed
then we're gonna get the form data this
is the username the password again we're
using using add slashes and strip tags
for security purposes we're doing a
little bit of validation we're saying if
the username doesn't exist or the
password doesn't exist we're going to
say enter a username and password
and then if that's all successful we're
gonna log in so the start of the login
process is selecting everything from
users where username equals our username
supplied and then we're saying if this
row is returned to zero
we're just saying no such user because
if this fails we've selected the user
that basically doesn't exist
okay then otherwise we're starting a
while loop here and what we're doing is
we just you may have seen this from my
other tutorials or somewhere else
this basically allows you to loop
through the day space using the MySQL
fetch associative function and this puts
this variable as an associative array
and lets you take each specific column
from the database so what we're doing is
we're looping by the way just to let you
know this is a secure way of logging in
so this is the reason I'm using this and
not saying and password equals blah blah
blah because that's acceptable even
though we've done our extra strip
slashes we don't want any SQL injections
so it sort of delving deeper into the
database to grab these out okay so the
password database this is a new variable
I'm creating is login row notice this
from here and then we using square
brackets to signify this is an array and
that's password so this password label
here is essentially the same as this
password label here so we're grabbing
the password then we're encrypting the
form password so we can match it to the
encrypted password in the database so
it's saying password overwriting this
variable and encrypting that with md5
encryption and then we're checking the
password so it's saying if the password
doesn't equal the password in the
database then we're going to say
incorrect password I'm not going to let
them in otherwise we need to do the
active checks so this again relates to
the tutorial our active is log in row
active so this column here Oh
and then our email is just force of like
show with with telling the user what
their email address is just in case they
forget so we've got our active this is
either going to be 0 or 1 since we're
taking it from here so 0 or 1 and we're
saying if active equals equals 0
remember to use a double equals for
comparison operator and then we're gonna
say echo you haven't activated your
account please check your email and then
we give the user their email here so
basically we've basically in one line a
couple of lines we've checked if the
users account is active since we have
this either set to 0 or 1 so else
presuming this is one session user name
equals user name and then we're going to
refresh the page back to index dot PHP
so we've just simply checked if the
active is set to zero and you already
know how to use the link in the email so
this should be pretty clear but if this
is zero then they haven't clicked the
link on the email and then obviously
we're just logging them in otherwise so
we can run through this um I'm gonna say
Kyle one two three you haven't activate
your account let's go back let's open up
my email and I'm going to click that
your account has been activated and then
again obviously we refresh you've
already activated your account back here
Kyle
one two three login and you are logged
in because they're active here although
it's zero now I'm going to refresh the
page that's been changed to one so
through a simple PHP script and an
addition to our register we've enabled
the user to click using a unique code in
a get variable form match that to the
database and use a simple SQL query to
update this active to one providing this
exists in the database so it's it really
is simple you just need to incorporate
this into your login your register and
then obviously create your new activate
of PHP your activate your PHP file okay
so that's pretty much it for now that's
the basis of this I understand that I
didn't do any coding this is because
it's sort of an adapt and adaptation
from previous tutorials and just using
this email activation so as long as
you've created your login and register
script you should have a good idea about
how to use this and the because I
haven't coded anything I've put this
script inside the forum if you go to the
forum and go to the source code the
source code subsection then you will
find this source code in there readily
available to take away and use for
yourself and study ok so thanks for
watching the tutorial I hope this helped
and I'll see you guys soon thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>