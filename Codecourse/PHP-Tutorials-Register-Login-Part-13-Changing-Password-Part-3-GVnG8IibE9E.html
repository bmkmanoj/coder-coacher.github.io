<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 13): Changing Password (Part 3) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 13): Changing Password (Part 3) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 13): Changing Password (Part 3)</b></h2><h5 class="post__date">2012-05-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GVnG8IibE9E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">right so right at the stage where we
need to go ahead and actually change the
user's password now and redirect them so
what do we want to do well I'm going to
go ahead and call a function here that I
haven't actually created yet but you
know we'll go ahead and we'll pop over
to our users dot PHP functions file and
create this function in just a moment so
the function is going to be change
change underscore password and we need
to pass a variety of two parameters in
fact just to this this function that's
going to be the user ID so we can
identify which user that we want to
actually you we want to change password
and put the new password so that'll just
you know convert the password to a md5
hash and place it into the database so
let's go ahead and open up our init dot
PHP file we'll need that and we'll also
open up our users functions file I'll go
ahead and get rid of register now we
don't need that so inside of in it we
have this session user ID variable that
contains the user's ID so we can go
ahead and we can actually pass this to
the function so user session ID comma
and the next thing we need to pass is
the the password that the user wants to
change to so in that case it will be the
posted password that we you know gave
here so dollar underscore post password
now notice we're not encrypting it at
this point we'll leave our change
password function to do that so once
we've changed our password what do we
want to do we want to redirect the user
to a success page and we did this in the
registration page we basically redirect
them to the same page but we use a
success error
success success query on the end which
will allow us to output a success
message to the user
so this changed password function we
need to go ahead and create this so
let's go ahead and define this here so
change
underscore password
now remember this takes a user ID and
then it takes the password that we want
to change to so let's go ahead and
sanitize this data now password we're
going to convert to an md5 string
therefore anything that looks remotely
like an SQL injection we don't need to
actually sanitize it because we're
converting to an md5 which will just be
you know numbers and letters the user ID
we always want this to be an integer so
when I say user ID and I know this isn't
direct user input that it's it's good
practice to sanitize data as you're
passing it through and the password is
equal to a result of the md5 function of
that password so we re resetting the
value for that variable okay so now that
we've done that we need to perform a
query obviously this is going to be
relatively straightforward because it's
just going to be an update query so we
say MySQL query we're going to say
update and we need to choose a table to
update let's go over to our table here
tables called users so we want to update
users set password so this is the field
that we're setting equal to and then a
value and that value is the new password
so here what we're doing is we're
updating users we're setting the
password field equal to this new
password that we're passing through
obviously doing that will change all of
the users passwords because we're not
specifying where we want to change this
and we're going to do that by the user
ID so we're going to say here we're user
ID it's equal to and then pass in the
user ID notice I haven't put any single
quotes around this because it's a number
so it doesn't require single quotes and
that's it we've we've done that now
we've we've checked we're going to
essentially just change the user's
password using this so it's relatively
straightforward so let's go ahead and
check this out unfortunately we can't
really see the you know the plain text
version of the password once it's been
stored but you'll know that once I
changed my password this will change
you know different different string so
let's go ahead and change my password so
I'm on change password dot PHP my
current password is password my new
password is going to be password 1 and
password 1 very secure password so
clicking change password now you see
that we've been redirected to this
success query here which we'll deal with
later will output say you know your
password has been changed to the user
we'll do that in a moment but when I
return to my database and click browse
you'll see that my password is the same
sort of let's go ahead and check why
that might be so change password passing
through the user session ID the new
password
and let's just have a look here so we've
got user session ID being passed through
ah there we go
okay so I'm passing through I need to
pass through session underscore user ID
well done to those of you that spotted
that I'm sure there were lots of people
that did so session underscore user
underscore ID so let's do that again
very basic mistake let's go ahead and
change the password to say password
password 1 and password 1 again change
password done we've got the success
query on the end let's go over to our
database table browse that and you can
see that is now changed so now what do I
do well I can go ahead and log out and I
need to log in again so Alex password
which is my old password now does not
work Alex
password one login and it works ok
brilliant and then I can just go and
change my passwords as many times as I
like so now that we've done that we need
to deal with this success thing at the
end we did that in register dot PHP and
we did here was we said if what do we do
let's go ahead and just check this color
the reason I want to check this is
because it's really good to keep you
know consistency through here so yeah we
essentially said if this success
variable on the end of the URL has been
set and echo this out otherwise and we
go all the way down and we include the
form in this as well because once the
users been successfully registered
they've changed the password you know we
don't want to we don't want to show the
form again so if and here this will be
the block that we need to execute if the
success message has been passed through
all the success query has been passed
through Elsa music all the way down to
the end of our form there and that's it
so let's just pull that down a bit so
I'm going to just grab all of this there
indent perfect so if let's just go ahead
and copy this from here so if is set
success and that's empty this bit sort
of irrelevant but I just like to do it
just in case anyone you know tries to go
success equals and a load of rubbish we
just want success that's all we want
so as long as that exists there we want
to do something and that will be to say
echo your password has been changed
simple so let's go ahead and change the
password again so my current password is
now password one remember I'm going to
change this to password two and again
I'm going to change this to password
dope - so change password your password
has been changed perfect we've got the
success error message up here and again
that benefits not being able to press f5
to refresh this page and send the query
again so not you know allowing anyone to
do that okay so now let's see well we're
essentially done now but we want to just
clear this up and I wanted to go ahead
and change these types here to password
which is going to act in the same way it
just means that we're not going to store
any of this data in the browser by
default so you can see that when I was
choosing them before we had dropdowns
but now it's a you know start out there
okay so that's it we've given the user
the ability to change the password we've
created a simple form we have validated
this data which again is extremely
important and then we've call this
change password function in here to
allow the user to actually change the
password and we've redirected the user
onsuccess outputted errors on any errors
being found and then these password is
changed and that's that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>