<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Poll With PHP: Listing Polls (4/7) | Coder Coacher - Coaching Coders</title><meta content="Build A Poll With PHP: Listing Polls (4/7) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Poll With PHP: Listing Polls (4/7)</b></h2><h5 class="post__date">2014-09-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/b59GD-3BOXs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we'll get started with something
pretty easy and that's just listing out
the polls that are currently available
remember they have to be between the
start and the end date for these to be
able to be displayed so we'll include
that in the query so we first will need
a connection to our database so inside
of the main directory I'm going to
create a new folder and I'm going to
call this app and inside of this I'm
going to create a new file and this is
going to be called in its top PHP or
initialisation dot PHP and what this is
going to do is it's just a basic way
when you're playing around or creating a
very small application just store all of
the useful things that need to be reused
between different pages if you think
about it in index Paulo and vote dot PHP
we need a database connection so we're
going to store all of that here now we
also need to start sessions so we're
going to say session start and I'm gonna
set the session user ID key to one
remember earlier we basically explained
that was just the user that's currently
logged in so we now have a session with
user ID of one we'll ignore that for now
though because we're not dealing with
that in this part let's now create a
database connection so we're gonna be
using PDO so we're gonna create a new
helio instance here and we're gonna be
using the MySQL driver and we need to
define the host which is gonna be
localhost or 127.0.0.1 we also needed to
find the DB name and if we check how out
Segal Pro you can see that this is just
website so in here we'll just say
website now we need to provide our login
credentials in this case mine's just
root and root and that's it we're done
we now have a connection to our database
and we can use this DB variable in any
page that we include in it dot PHP so in
that case then let's go ahead and do
that up here so a Stein end a PHP tag
and we're gonna require one or you can
just do a require app forward slash in
its dot PHP so that's including app in
it and now down here we can make use of
that DB variable so we're gonna do that
now obviously we're going to query the
database and we want to select the ID of
the pole the question from that poles
table so I'm going to create a variable
called poles query I'm gonna use this as
we go along it's going to be something
query that's gonna equal we're gonna
assign the result from DB query so in
double quotes I'm gonna pull this down
and we're gonna select and we need to
choose now which fields we want the only
fields we want is ID and question and
that's from the poles table so we're
selecting the ID and the question from
this table and that's going to select
all records because we're not adding a
limit on it but what we want to do now
is we want to say where the current date
is between the start and end date so we
say where date now so we use the now
function between starts and ends
simple as that so we now should have our
two poles and we'll change the date over
just to make sure that's working but we
need to actually loop through and add
these objects into a and array so I'm
going to create an array called poles
and that's going to allow me to just
easily output that everything down here
so we do a little while loop here and
we're gonna say while we're gonna assign
something to a variable called row and
that's going to be Paul's query and
we're going to use the fetch objects
method so the fetch fetch objects method
will basically give us back an object
for each record in the database so what
we can actually do to just test this is
do a print R on row let's check this out
there we go
so we've got a std class object here as
well as here so these are two separate
objects I'll just highlight this one to
make it a little bit easier and you can
see there we've got the ID and we've got
the question so I'm gonna add these to
an array I'm gonna assign these within
this loop to an array called poles and
we do that using the break
notation here and we assign ro to it so
what we've now got is if we just do an
echo and we wrap this in pre tags and
this would just preserve the formatting
we can actually do a print R in between
this on poles and that's going to give
us out the following so that makes it a
little bit easier to see what you're
working with you know that you've got an
ID property and a question property so
we can loop through and output these so
get rid of that we don't need it but
down here we're gonna do our outputting
so obviously what we need to do is check
that there are poles actually available
so let's just get rid of this markup
because it's fairly easily rewritten I'm
gonna use very basic PHP templating here
to say if not empty and we're gonna
access that poles array down here we're
gonna say else and then down here we're
gonna end that if like so so if the
poles array isn't empty that means there
are poles available otherwise there are
no poles available so I'm gonna just
output a paragraph here and I'm gonna
say sorry no poles available right now
that's it here this will be there are
poles available so we crowd unordered
list and we need to loop through each of
these poles otherwise so we're gonna say
for each and here we'll say poles as
pole down here we'll end our for each
like so and in here you probably already
guessed we need to output a list item
for each one and in here we're gonna
have an anchor so we'll start with the
actual label of the anchor in this case
it's just echo and we're gonna act out
Paul and because each of these are an
object we use this and we say Paul name
or is it Paul question yet Paul question
like so so let's check this out let's go
refresh there we go so we basically go
out to polls now outputs the page let's
change the end date to maybe the eighth
month and this is obviously going to
mean that because we're now past this
it probably won't I know will show them
of course because we're on this day
that's just change that to I don't know
the 26th so let's say ended yesterday
there we go sorry no polls available now
so that's basically how that's going to
work let's again just change these back
to nine or 10 there we go so we've got
these two polls now we know that the
message will come up if there aren't any
polls but we now need to know where
we're going to link through to well we
know we're going through to poll dot
php' but we need some way to identify
which poll that we're looking at in this
case I'm going to say ID equals then I'm
gonna output the ID of the poll now just
be aware that if these polls are you
know you don't want people to access
them unless they have the link this
isn't a very good solution the reason
being is we're using incremental IDs
here so for example if there's a poll
with an ID of one someone's likely gonna
guess that it's an idea poll of an ID of
two three four five so if this isn't
what you want you might want to replace
this with some kind of hash you still
want an index there on the ID fit on the
ID column in your database but you might
just have some kind of hash that's maybe
an md5 generated hash or something but
for now we'll leave this as it as it is
so in here we're gonna open and close a
PHP tag and we're gonna echo you're
probably ready guest poll ID so that's
going to echo out the ID from that so
now when we click through you can see
that this goes through to poll dot PHP
with an ID of one and the second one
goes to poll dot PHP with an ID of two
excellent so we've now got a list of the
currently available polls between the
start date and the end date so just
making sure that they can be shown and
we've now output our listing so that's
it we've listed our polls and we can
click through and in the next part we'll
be creating the ability to answer the
poll</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>