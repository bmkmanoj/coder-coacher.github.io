<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Essentials: DateTime: Project: Human Difference Calculator (9/9) | Coder Coacher - Coaching Coders</title><meta content="PHP Essentials: DateTime: Project: Human Difference Calculator (9/9) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Essentials: DateTime: Project: Human Difference Calculator (9/9)</b></h2><h5 class="post__date">2016-09-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_VhyXeSHx3s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so to put most of what we've learned
into practice we're going to create
something you can go ahead and use in
your projects today so what we're going
to be building is a human difference
calculator what I mean by this is if you
post an article or a forum topic or
anything that has a date attached to it
most likely on a website you will see
something like two days ago two weeks
ago one year ago etc now on its own this
is really difficult to do but using date
time we can create a very simple
function that allows us to pass a day in
and then spit out this human readable
difference now the inspiration for this
came from the carbon library which is
actually an extension of date time this
extends the daytime class and just gives
you a little bit more flexibility and a
little bit more functionality we also
have a series on that so you can go
ahead and check that out after this if
you want to so to get started then we
are going to first of all see our time
zone just assume that our time zone is
the same but everyone so once again we
use date default timezone set let me go
ahead and pass the timezone identifier
in my case I'm going to go ahead and
choose Europe London like so so next
we're going to define a function we're
going to create a function for this but
of course if you have experience with
object-oriented programming you could
perhaps create some kind of wrapper for
this or of course if you want to go
ahead and use that carbon library so
this is going to be called diff for
humans now into this function we need to
accept a date time so perhaps somewhere
else in our application will have some
kind of date like so so new date time
and maybe we have something that was
posted maybe a couple of days ago now I
can manually define this out so I can
say 2016 is currently August and the
date is currently the 15th so I could
maybe set this to the 12th or what you
could do just to test this out is say
something like minus two days we've
already seen this working so then what
we want to do is pass in this date now
this could come from your database and
you could wrap this in a date time it
really doesn't matter where it come
from as long as it is a datetime
innocent such really important so to
accept this in what we can actually do
is type in this to make sure that we do
actually receive a date time instance
that's pretty important because
otherwise this won't work so now that we
have that passed in let's just test this
out by returning the date and then down
here we'll go ahead and echo diff for
humans and we will pass in that day in
fact we can't a quit at the moment so
let's do a VAR dump just to make sure
our function is working properly so over
to the browser and there we go we get
back that date so its 13th of August
2016 okay so let's start to fill out
this function what we want to do is grab
the current date because remember we're
looking at the difference between now
and the date time that we're passing in
so i'm going to create a variable called
current date and set that Thun you date
time that will give us the current date
remember and of course it will use the
Europe London time zone now we want to
grab the difference so to get this we
just say difference and this is the
current date that we've just created
diff to the date that we've passed in so
we just pass that in like that so if you
remember from earlier with this we
actually now get if we just have a look
a date interval class so from this we
can take each part of this difference
and check it and then go ahead and do a
little switch statement and go ahead and
return the right values so the first
thing we're going to start off with is a
unit and the count so I'll explain what
these on just a minute so the unit then
is going to be month day year our second
we're going to default to second and for
the count we're going to grab the
difference seconds which at the moment
is 0 this happens to just be two days
because we've said minus two days so we
can go ahead and switch this up in a
minute just to make it a little bit more
complicated but for now we just want to
grab the difference s the second
difference so let me just change this
over very very quickly so i'm going to
say 2016 august 13 and let's go ahead
and say two o'clock
so at the moment for me it is currently
436 so this should give us a good amount
of stuff to play with so again let's do
a VAR dump on difference and see the
difference that we get there and you can
see that this is slightly different
we've got two hours 37 minutes remember
I is minutes and three seconds okay so
now we want to check the year we want to
check the month the day the hour the
minute and then if they are greater than
zero we can set the unit to that
particular unit and then the count that
particular count so to do this just to
keep it nice and tidy and this is
happening in the carbon library as well
we can just say switch true that means
that each of these cases will be checked
now I can say well if the difference the
year so the year different is greater
than zero then I want to set the unit to
a year and I want to set the count to
that year so that year different so
different why now the reason that we're
doing it in this order is because if say
it was posted three years ago we don't
want to say well it's posted 2 hours ago
because it was posted two or three years
ago so we do this in the order of the
greatest amount going down so we do the
same thing for each of them so we can go
ahead and paste this down next we want
to check the month and then if the month
is greater than zero we want to set this
to the month and again change this over
like so and we can do the same again we
want to do the day change this over
today and the reason we're not saying
days or months is we'll deal with that
in just a moment and we'll change this
over to D so that looks good let's go
down and just keep doing this basically
so the next one is ours obviously so
here we'll say our and then here we will
say H go down again the last one we want
to do is the minutes because we have a
default of the seconds up here remember
so here we'll say minute and then here
will change this over to I so now that
we've done this we need to put a couple
of checks in here so we've done our
switch statement we want to check if the
count so if the account that we've
potentially set for each of these is
equal to zero if that's the case we're
going to set the count 21 like so and
then we need to think about hours
minutes days with the s in the plural so
for this what we do very simply is we
just say if the count doesn't equal 1
then we want to append an S on to the
unit so we just say dot equals to append
on s so that will give us if it's 2 so 4
minutes this won't be two minute it will
be two minutes now this is all well and
good but there's a couple of things that
we need to think about we need to also
think about the invert of this and
that's if it's in the future we want to
say from now not a go let's just fix
this up so we can actually return a
string value will test it out and then
we'll look at that invert so here we're
going to say count because this is going
to be say like two minutes ago so we can
take count then we go ahead and put the
unit in there and then we in here use
the inversion but for now we're just
going to take a guy just to test this so
now what we should see this was about
two days ago we should see if we go and
echo diff for humans and we go and pass
in that date head over to the browser we
see two days ago perfect so we can
switch this over to say the tooth or
2017 this gives 11 months ago we do this
we get one year ago if it's 2019 we get
two years ago the reason for that is
that this is slightly further on in the
year so if we were to do say the first
of January 2019 would expect to see two
years ago if we were to do say today's
date let's just change this over and set
this to 2020 we go back to that three
years ago so it's not obviously exactly
accurate in terms of saying where it's
three years eight months etc ago it just
gives a roughing it because it's not
really important when it's human
readable okay so the next thing is if
it's in the future so let's just get rid
of this and say plus two days
we see two days ago now that doesn't
make sense because this is now into the
future what we need to do is work out
whether this is inverted or not and to
do this we need to just do a VAR dump on
difference and we will see a very
important property just in here and you
can see here invert now invert is
currently set to zero let's just change
this over two minus two days and see
what happens you can see that that
changes to one so essentially what this
means is if it inverts is set to one
it's in the past if it's set to zero
then it's in the future so to fix this
then all we need to do is say inversion
check the invert property on there if
that's equal to zero and i'm doing a
ternary here so it's essentially an
inline if statement then i want to say
from now otherwise i want to say ago and
then it's as simple as going ahead and
replacing this just in there so now we
see two days from now because it's plus
two days into the future if it's minus
we see the following and again we can
test this out say 2017 0 8 15 and we get
11 months from now so that is pretty
much it this is a really basic clone of
what the carbon library that we looked
at earlier offers but it gives you a
good chance to just play around with
things like this and of course if you
need something very simple like this in
your projects to go ahead and output a
human readable difference you can go
ahead and use this today</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>