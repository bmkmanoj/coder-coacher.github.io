<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Twitter Bot: Sentiment Analysis (2/4) | Coder Coacher - Coaching Coders</title><meta content="Build a Twitter Bot: Sentiment Analysis (2/4) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a Twitter Bot: Sentiment Analysis (2/4)</b></h2><h5 class="post__date">2016-07-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gBJ3CSPJmCo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now that we have the 20 most recent
mentions we want to send these off to
monkey learn for sentiment analysis and
we're gonna head over to monkey learn
and just talk about what it is and what
it does so monkey learn will allow you
via their API to basically do text
classification and in our case we're
interested in sentiment analysis so once
you are signed up and signed in you'll
be able to head over to the Explorer
section now the way that this works is
you can create your own modules which
you can train up to perform analysis on
text but in our case we're going to be
using a pre-built one this is a very
social way to share different
classifiers and you can see here that
there are a variety of different
classifiers we've got here one for
retail so if we just come into this and
just take a look at what this looks like
you can see that this will give us a
good idea when we send some text over
what this actually relates to now in our
case it's a little bit more simple it's
still very complicated but we want an
English tweets sentiment analysis module
to be able to perform on a tweet and
analysis and see if we have a negative
neutral or positive tweet so this has
already been trained with data and in
our case we can just start using it and
we can start using it by its ID I'm
going to be doing this using the PHP
library so if we just head over to the
API section here and head over to PHP we
can see how we do this
very straightforward at using the monkey
learn client and essentially this will
just allow us to pass a list of text the
module ID and then we can go ahead and
classify this text list against this
module and then we'll get back a result
so we need to see what this looks like
with the tweets that we currently have
so if we start by just heading over to
the monkey learn github page and it's
the monkey learn PHP project that we
need to pull down so we'll just grab
this so let's install this using
composer
let's do
require on this we'll get it set up and
we all see the results so this is
finished and we can start to pull this
in now so just at the top then I am
going to create a new monkey Learn
instance so new monkey learn and into
this we need to pass our API key so you
can find your API key over on the monkey
learn site if you come over to your
account area just here come over to API
keys and we can just go ahead and copy
this and just paste it in to here and
we're done so we can now start to send
requests off to monkey there so using
that example that we just looked at with
this collection of tweets we can perform
analysis on this I'm just going to
create a variable here and I'm going to
say monkey learn classifiers and we're
going to plus if I using that one that
we just saw so if we just head over here
to the modules section and this one here
we can grab it either from here or over
in the API you'll find the example of it
just here so we can copy this paste it
into here we want to send off an array
of tweets which we already have it's
that tweets text that we did a map on
and that is pretty much it so if we just
do a var dump on analysis we come over
here give this a refresh of course after
we've imported monkey learns let's just
use this up here monkey learn client and
we'll call this monkey learn so it's a
bit easier to use we'll wait for this to
finish and there we go so that text that
we sent off we get back a probability
and we get back the label so in this
case we have neutral positives and
negatives
it's just scattered down here and that
is pretty much it
so we now know using this mapping which
of these tweets that we have back is
positive neutral or negative now one
important thing to bear in mind these
labels could potentially change
depending on the module that you're
actually using so in this case we know
that the
labels are negative neutral and positive
but if you do use another classifier
these may be different and we're gonna
be relying on the fact that these are
negative neutral and positive so just
bear that in mind but we'll come to that
later and we'll talk more about what
that involves so now that we've actually
got the results we need to start to
assign a positive neutral and negative
emoji to this so now all we need to do
is loop through each of the original
tweets so we're gonna say grab the index
that's really important that we have the
index so we can map it to the analysis
from monkey learn and we're going to
call that tweet and inside of here we
want to decide which emoji set we're
going to use now we don't have any emoji
sets at the moment what I'm gonna do is
just to save a little bit of time copy
these over so I'm just gonna place these
somewhere up here it really doesn't
matter obviously we're just messing
around on a single page but once you go
over to the laravel version of this it
will be a lot nicer now essentially all
these are just codes for emojis and I
took these from this resource just here
you can see that you've got a Unicode
just here and you can extract this part
of it and then go ahead and place it in
here like this so that's pretty much how
we're gonna be sending emojis off now
the reason that I have multiple emojis
is that we're going to be selecting
these at random so if for example the
tweet is positive we're going to send a
happy emoji and we're going to be
randomizing this just in case the same
user decides to mention the bot at any
time and that's because Twitter doesn't
allow you I think within a period of
time to reply with the same thing so it
won't actually send our tweet so we want
to have a good selection of them it's
also a little bit more fun the fact that
we have more to reply with so of course
I'm not going to make you type all of
these out you can grab these as a free
download from the course section over on
Coco's calm so now that we have our
emojis in there inside of here we need
to determine based on the analysis which
label each of these tweets is so we can
do this in any way but of course we can
use a switch here makes it a little bit
neater and we're going to from our
analysis so let's just say analysis
we're going to grab the result because
in here we can see that we have a result
key just here I'm going to grab that at
the index of each tweet so what we're
doing is we're looping through our
tweets we are grabbing the index which
maps to the analysis on monkey learn
we'll grab the first key in there so
let's say it's the first tweet that will
have an index of zero and of course on
monkey learn this will also have an
index of zero we map it to this we grab
this item here and we now have an array
so from this we can grab the label so
inside of here now we want to check if
it's positive neutral or negative and
then assign the right emoji set so the
first one will say positive and if that
is the case we want to set the emoji set
to the happy emojis and we can do the
same thing for neutral and negative as
well so let's just paste this down and
we have neutral and we have negative and
for the negative we're going to have sad
emojis and for the neutral we're going
to have neutral emojis and that is it so
now just to test this out we can do a
var dump on the emoji set and just see
what this gives us just to make sure
that we don't have any problems along
the way so you can see here now for the
first one this was neutral so we have a
neutral set and so on and so forth all
the way down so we now have for each
tweet a set of emojis that we can pick
out so now that we have this then the
first thing that we want to do is reply
we then want to insert this into the
tracking table that we saw in the last
part we'll talk about how are you going
to set this up in a minute and then
that's pretty much it so we need to
tackle the fact that when we actually do
go
through this we need to store these in
this tracking table so in the next part
we're going to talk about the tracking
table we're going to set this up to
track each of the ones that we've sent
so in this case we're going to tweet the
user just here and then we're going to
track and that means that we can then go
back and update the mentions calls to
our Twitter or to the Twitter API just
here so we're not always pulling back
the same mentions we need to keep track
of ones that we've already replied to so
let's go over and we'll look at tracking
in the next part</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>