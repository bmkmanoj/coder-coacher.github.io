<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Shopping Cart with PHP: Adding items (7/15) | Coder Coacher - Coaching Coders</title><meta content="Build A Shopping Cart with PHP: Adding items (7/15) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Shopping Cart with PHP: Adding items (7/15)</b></h2><h5 class="post__date">2016-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/sajS4So1cWU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we're now going to focus on probably the
hardest part of the series and that is
actually adding items to our car now the
reason this is going to be pretty
difficult is we need to set up our
session helper and we need to set up our
basket model as well release our basket
class which is going to handle adding
items checking things and all that kind
of good stuff but we're going to take
this nice and slowly we're going to set
up our cart page that we can dump out
all of the items that are added to our
car in the next part we'll actually be
looking at outputting these nicely
within a cart summary so let's start
just by I'm first of all going to update
this link here because I can't actually
click back to the product in next page
and we already know how to do this what
we can do is just come over to our
templates here over to the partials and
under navigation and here is the link we
need to update now we know we have our
path for helper so let's just add this
in here path four and that's just for
the home page so now when we click on
this we're back to our index nice so we
can actually navigate between them now
so let's start with our cart controller
and the view that we're going to have
for the actual cart index page so if we
just head over and create this
controller quickly I'm actually just
going to copy my home controller over
just to save a little bit of time so
let's create this here it's just cart
controller dot PHP and we will just
update this as we need so we have cut
controller let's just get rid of this
method here we're obviously going to
need our request in our response we will
probably need our products and of course
we need our views here as well so what
methods are we actually going to have on
our cart controller well we're going to
have an index this is going to actually
show the cart page so this will be a
list of all of the items that are
currently within our car and of course
the focus of this part is actually
adding items so we're going to have an
ADD method just here as well so for the
index then this is going to take in our
request in our response so we can
do anything with them so let's add these
in here and it will also take in our
view as well so let's just type in this
in here Twigg view great so why don't we
just render out the view here first of
all
we'll come back to this add method later
when we're actually clicking to add an
item so over in our views then we can
create a cut folder and inside of here
we will create an index file so index
dot twig and this will be our cart so
let's just render this out so let's
return view render passing in our
response and this will be cut index dot
twig and why don't we go over to our
routes and just update this as well so
for our routing we have get and we'll
just call this cut and obviously for our
controller we have cut controllers and
this is our cut controller and the
method we want is index like so and we
can set a name for this as well just in
case we need to refer to it which we
obviously will do because we're going to
be doing a lot of redirecting to this
car index when we add an item so the
user can see what's actually in that car
and for now that is pretty much it so if
we have set everything up correctly and
we head over to the cart page we now see
cart here great and what we're going to
be doing is while we're adding things
we're going to be using this to dump out
everything that's in our car just so it
makes a little bit more sense and while
we're at it we can actually link this up
to click through to that page as well
that would make a lot of sense so if we
just head over to our navigation again
down here remember we have our cart
where we're eventually going to display
how many items are in there we want to
update this as well so we have path for
cart dot index and there we go we can
click through to our cart index so just
so we can focus now I'm going to close
everything off and we're going to look
at our session support now what we're
going to be doing is storing anything
that's within the
users cart in a session now the
beautiful thing about this is we're
going to be creating an interface for
this so if you want to switch this out
for something else maybe into the
database or anywhere else you can very
easily do that so let's start with the
interface we'll define what kind of
methods we need and then we'll create
our concrete implementation for this so
under app we're going to create a new
folder called support this is just where
things are going to go like our session
helper and anything else we want to do
and in here we're going to say storage
so we have another folder called storage
and inside of here we want a contracts
folder for our session storage so let's
create that now so we can define out our
contract by just creating a new PHP
interface within here and this is going
to be called storage interface and I'll
speak a little bit about how if you want
to switch this over to the database or
anything else you can do so later so
let's give this a name space then
obviously so we can psr-4
auto load it and this is just cut
support storage and it's within the
contracts folder so the interface then
we just define out with the interface
keyword and we have storage interface so
this gives us a good opportunity to look
at what kind of methods we want and
essentially all this is is a helper to
put things into storage get things out
of storage delete things from storage or
whatever else you want to do so we'll
start by saying well we need to get an
item out of storage at some point and we
need to do that via particular index so
this might be the ID of the item that
we've added to the car and then
alongside this we'll have quantities and
stuff and of course if we get things we
need to be able to set things so we're
going to have an index here and we are
going to have a value now the other
thing we want to do is be able to pull
all items out of storage we also want to
be able to check if a particular item
exists in storage so by this we can pass
in an index just to check that exists
and then finally what we want is an
unset which will just basically get rid
of an item so that is pretty much all we
need we can create our concrete
implementation now and we do that just
within the storage directory we have our
contract so we can implement this
contract and we know that we have to
implement these six methods just here so
under storage then let's create a
concrete implementation and we'll
specifically call this session storage
dot php' now when you're done with this
session storage in fact when you're done
with the entire series if you then want
to switch this out for your database you
would create a database storage file and
if you were doing something else maybe
storing in cookies which I probably
would advise but either way you get the
picture so storing these items in
sessions is not a bad idea at all
there's no nothing really wrong with
this it just means that it will last for
the user session you could of course
take this data store it somewhere do
what you want with it so for the name
space let's say cart support storage and
then here we have our session storage
class and we know that this needs to
implement our storage interface and the
other reason we're doing this is that we
can add this to our container under
storage interface and it makes things a
lot easier so we also need to be able to
I've just realized count all of the
items in our basket as well so what
we're going to do is we're going to use
a PHP or a standard PHP interface Espio
interface called countable so let's just
use this up here and I guess what we
could do is we can also use a clear
method so let's just add this to here as
well this will get rid of everything
within our session storage so we'll
implement that just there as well so now
that we have this concrete
implementation we need to think about
how we're going to actually use this in
fact before that just one more thing
let's just pull in that conch
so it's support storage contracts and it
is storage interface great so under our
storage interface or under our session
storage we want to have some kind of
bucket to hold things and we want to be
able to give this a name if we want so
we'll start by creating a constructor
just here and into this we will be able
to define a bucket name now this can be
anything but by default we'll just call
it default you can call that whatever
you want by defaulting when we actually
create a new instance of this we can
define what we want so here we will
store the bucket name and in here we
will say this bucket and set that to the
bucket name now what's going to happen
is if the bucket doesn't exist in the
session when we first load the
application what we want to do is
actually create that so this is the
first kind of session dealing we're
going to have so we're going to check if
within our session we don't have the
bucket name so we provide this in like
so and then if that's the case we're
just going to say well session that
bucket name in this case it will be a
property called default within our
session we're going to set that to an
empty array so we will come back to this
later we'll understand how this kind of
works so how do we actually get our
session storage and get it working we
need to attach it to our container and
we do this by the interface so let's
grab the interface from just here and
it's come over to our container dot PHP
file and just paste this in here and now
what we want to do is we'll add this up
here like so and do what we normally do
when we're adding items to our container
and again in here we have our container
interface now what we want to do is
return a new instance of session storage
like so and then in here what we'll do
is we'll pass in cart that's what we
want the bucket name to be of course if
we use this session
storage class elsewhere then we'll give
another name to it so that's why we do
that now we also just need to come up
here and say use cart support session
all out the storage session storage just
so we have that in there so it's now on
our container and we can use this
however you want let's just fill out the
rest of these methods and when we come
to creating our basket class that will
be responsible for using our session
storage and we'll start to see
everything working when we start dumping
things so I guess we can start to
implement all of the methods that we
have to find just in here the first one
is going to be get from a particular
index and let's in at Rifai let's start
with set that makes a lot more sense so
when we're setting an item in storage
what we're obviously doing is we're
taking an index for that so we can refer
back to it later and we're taking a
value so here all we do is session we
say this bucket because we're storing it
under a particular bucket to keep it out
the way with anything else we are
placing that within the index that we
provide here and then we're setting the
value like that really straightforward
and the whole reason we're doing this is
just to keep it out the way of our
controllers if we were doing this all
within our controllers it's just going
to get so messy just means that we have
a nice class that has one responsibility
and that's just dealing with session
storage so for the get method then
you'll probably have guessed we just
pass in an index we know that and then
we just take the item out but to be able
to do this we also want to check whether
it actually exists first of all so I
guess what we can do is create down here
before we do that and exists method and
this will take in an index to check if
that actually exists so whether or not
exists we just do a return is set
session this bucket we're going to be
doing this a lot because everything is
underneath that and then we're going to
just going to say
index so if that actually does exist
then we can we'll get out true or false
basically so forgetting then the first
thing we want to do is save not this
exists passing in that index then we
want to return null so if it doesn't
exist we'll just return null value and
then whoever's using this will know that
there's nothing in there and then after
that we can assume it does exist sort of
say session this bucket and we want to
return that the index that's been
defined simple so the next thing we want
to do is grab all items so public
function all this will just return all
items within that bucket you probably
guessed it's really straightforward we
just say return session this bucket and
that will give us all items within that
simple so now we are going to get to
unset clear and count
so for unset again this is really easy
so let's create this method here we know
that we need to unset a particular index
and in this case we are just going to
check if it actually exists so we know
that we already have this method we just
say if this exists at that index then
only then we want to unset it so we just
use unset and we say session this bucket
index like so and that is pretty much it
for unsetting now we want to say clear
so clear will be responsible for getting
rid of everything within our bucket it's
a similar thing to all and get where get
is getting a specific index all is
getting all with unset it's on setting a
specific index and clear is getting rid
of everything so here we don't need to
check for anything exists we just want
to get rid of everything within that
bucket or in actual fact get rid of the
whole bucket itself so we just do it on
set like that
now finally we have implemented this
countable interface which means that we
have to define on this method now a
count or on this class account method
and all we're going to do here is return
count this all so we're using all which
we've already implemented just up here
and all this will do is just allow us to
count how many items are in the session
at the moment or at least it within that
bucket at the moment so this is our
session storage class done we've got out
that out of the way the bad news is that
our buckets class is going to be a
little bit more complicated which is
going to use this session storage class
so let's close this off we'll open it up
again if we have any more problems with
it but what we need to do now is under
app we're going to create a basket here
so we're going to have a basket class I
might have said bucket class earlier but
I meant basket class so inside of here
then we will create a basket class this
will be responsible faculty Adam adding
items to our baskets this is basket
specific but it will use our session
support so here we have basket PHP and
let's just set this up so the namespace
for this is cut basket and the class's
basket like so so for the basket then we
don't have any interface on this because
there's not really any need to have an
interface on this it's not really going
to change there's no other
implementation but what we are going to
do is inject into this our storage and
also our product model as well so what
we really need to do is take our basket
and add it to our container this means
that what we can do later you use this
anywhere within our application we can
inject it into controller methods and
all that good stuff so over on container
let's do this now so here we'll say use
cut basket basket and feel free to give
this class another name if you want to
if it makes sense for you and down here
we will actually create or add this at
least to our container so we say basket
class and in here again just as normal
we have our contain it interface that I
can't contain the state and to actually
do this we just returned a new basket
and inside of this we want to accept or
these pass in from our container our
session storage class and also our
product class like so so this means that
over in our bucket class we can accept
these as dependencies and we can use
them within this class so let's set up
our constructor now so construct and
inside of here we will accept session
interface and we're doing this by an
interface because we don't need to know
about the implementation of it we know
that we just have specific methods
that's why we use an interface and also
our product here as well so we can use
that so we need to do is up here just
pull this in so I guess we can grab this
over from support storage session
storage and copy this over here just to
save a little bit of time and we also
want to use cart models product so now
we can set these so we can just say this
storage storage like so and then here we
can say product product like so and then
set these as properties at the top so we
have our storage and we have our product
just here great so this is the kind of
basics of things set up we know that
we're passing these in and we can now
use these in our controller methods just
to kind of give you an idea of this if
we maybe go over to the home controller
and let's just pull in our basket here
just to see if this works you can do
this anywhere just to test it and down
here that say use cart basket basket and
if we refresh now we should see well we
don't we see a problem
so here argument one pass to the
constructor
the session interface so all this means
is that over on our basket we probably
gave this the ROM yet so we call it
session interface so it's going to be
storage interface and there we go so now
that that's been injected in what we can
do to test it is down here just kill the
page and we'll do a var dump on basket
like that and we should see our basket
with everything in it perfect so we know
that this is there now and we can use
this to add things and do whatever we
want so let's just get rid of this
because we don't need it in here at all
and let's get rid of this as well okay
so now what we want to do is implement
all of the methods on our basket so this
is the ability to add a product to the
basket up data product so change the
quantity remove a product clear the
basket altogether which is essentially
just clearing the storage that's
attached to this checking if a product
exists getting a product getting a list
of all products getting all of the item
count so any items in there we're just
going to count them and also things like
getting a subtotal now for the subtotal
and the Refresh method which we'll talk
about later we can leave them until
later on we don't really need to worry
about them until we get to our cart
summary but all the others are pretty
important and there's a lot to do here
once again once we have this set up the
rest of it will be pretty
straightforward so to start things out
then let's say add this is our add
method now into this we're going to take
a product so we're going to type int its
product to make sure that is what we're
passing in and we also want to pass in a
quantity as well now we need to kind of
hook this into other methods that we
have as well so what we can do is we can
create a has method because we're going
to need that within our add class and
the house method will just check if an
item exists so we pass in a product
this has method and all we do is we say
return this storage
exists and we pass in the product ID so
the product ID this will make sense a
little bit later when we finish this one
off so to add a product then what do we
need to do well we need to add it as a
quantity so we need to say if this has
enemy passed through the product then
here what we want to do is set the
quantity to the current quantity plus
the new quantity if that makes sense now
down here otherwise what we want to do
is update session with product so we've
kind of defined this out now what we can
do is create our update method this is
just going to be a general method that's
essentially going to either add or
update an item within the car I know
this is add but essentially update does
the same thing it just updates an index
and a value so to update a product we
say update product and we give a
quantity as well we can use this to
update the quantity also now in here
what we need to do is check if a product
has stock before we even do anything to
it before we even add it or update it so
we know that we have inside of here our
product model so we can use this to hit
the database and check if an item has
stock before we add it so let's just do
this now so we're going to say if not
this product we're going to find this
product by this ID so we're now hitting
the database and then we're going to say
has stock and we're going to pass in the
quantity so if that's the case we want
to throw an exception and we'll get back
to that at the end of this video now the
next thing we want to do is if the
quantity that's been passed in is zero
then what we want to do is remove it so
we're going to call this remove product
and then we're going to return so you
don't want to do anything else
so let's just quickly
create our remove method I know this
does get a little bit complicated but
essentially all these linked together
quite nicely just to literally do what
we want to do so for removing a item
then this is really straightforward we
take in the product that we want to
remove and in here we say this storage
unset and we pass through the product ID
so like this product ID so that's what's
going to happen if we don't have a
quantity if we the add or update you
know we're never going to add a quantity
of zero but if we update the quantity to
zero we just get rid of it so the last
thing we want to do within our update
method is this storage set so at this
point we are either adding or updating
an item so we set this under the key of
product ID you can refer back to your
session storage if you're not too sure
so here we set a product ID and then the
actual product details in this case it's
just an index and a value so we set the
product ID the details that we are
actually setting are an array this will
hold the product ID so here we're going
to say product ID and just to make sure
we're going to cast this to an integer
and here we're going to set the quantity
and again we're going to cast this to an
integer so the whole idea of this is
that when we add an item we basically
set a session with the ID as the key so
we can refer back to that later the
actual product ID and then the quantity
and that means that we can at any time
see the products we have in our cart and
the quantity but then what we can also
do is hit the database and give
ourselves a list of all the products
based on this Product ID so hopefully
that makes sense but going forward it
should make a little bit more sense as
well okay so now that we've done our
update method we can go back over here
and here we want to if the I if the
product already exists in our session or
at least in our basket we want
to update the quantity so we just want
to adjust the quantity here so we just
say this get product we grab the
quantity remember that when we set it we
say quantity here so when we get it we
have a quantity available and then we
just add on the quantity that we've
already passed through essentially just
incrementing so if we already have a
product in our basket and we have two as
the quantity and we want to add two we
end up with four simple as that and then
here we want to update the session with
the product so we just say this update
we pass in the product and we pass in
the quantity so I don't think we've
created the get method in here just yet
note we haven't so let's do this now so
public function get and all this will do
is taking a product to grab out and to
actually get something all we need to do
is return this storage get and grab that
by the product ID just simple as that so
so far we have adding a product we have
updating a product we have removing a
product checking a product actually
exists getting a product we need a way
to clear out cart and this is also very
straightforward so let's just create a
clear method here and we just say this
storage clear now obviously what we're
going to want to do is when we check out
we want to clear our cart so that's why
we have a clear method in there so now
we want to get all items now this is a
little bit trickier because what we need
to do is all of the items in our cart
currently have an ID a product ID we
want to hit the database and pull a list
of the products out this will grab us a
collection of models so that's really
important we need this to able to
display on our product index page or our
cart summary page so let's create our
all method just here and we're going to
start by setting an empty
list of ID's an empty list of items
we're going to need these in just a
moment so all we do is we say for each
this storage all that will give us a
list of all products currently in our
storage that have been added via the add
or update if we're updating the quantity
and for each of these products we want
to add to this list of ID's or this
array of ID's so we're going to say
product product ID we've seen this
product ID key before remember when we
are adding and now that we've done that
we can grab the products using eloquent
so we're going to say products equals
this product find IDs now this might
seem a little bit strange because now
what we're technically doing is passing
through an array of ID's this will only
take one query so that's really
important we're just in one query and
pulling however many items we have our
if we have 20 items within one query if
we have 50 items we're only doing one
query so that's really important and now
what we want to do is go through all of
them products that we have so for each
product as product we now want to
essentially set the quantity and we grab
this form the item in our storage so we
say product quantity and reattaching
this onto the models that when we output
it we actually have property on there
called quantity so we say this get
product and then here quantity like so
so now what we can do is attach this to
our items array so product and down here
return them items
so just to recap if this is a little bit
complicated we have an to empty arrays
just so we can hold things we're going
through each of the items now storage in
our session which means any item that's
been added we are then grabbing them
items or products from the database
we're going through them products
attaching the quantity based on what's
been stored in our session storage and
then we are just adding them to an items
array and returning so that's pretty
much it the last one I want to do is our
item count and then we need to do here
is return this count or return count
this storage and that's it so we'll
leave it at that for now we'll come out
to this if we've made any mistakes
there's quite a lot being done here but
obviously this only needs to be done
once and very rarely updated you'll
probably not need to update this at all
and this is pretty much it so the only
thing I want to do now is just add in an
exception if we have too many items if
we have quantity exceeded so over in
basket we can create a new folder called
exceptions and this will be thrown if
we're trying to add too many items to
our cart based on the quantity available
so we will call this quantity exceeded
exception we'll go ahead and give this
our name space so it's cart basket
exceptions and let's use exceptions
we'll need that I'm going to say class
quantity exceeded exception and this
extends our just and PHP based exception
and inside of here we will create a
message just in case we want to use the
get message method and we'll just say
you have added the maximum stock for
this item so we are obviously going to
be catching this exception from our
basket when we try and add too many
items but of course you can handle that
in whatever way you want so now back
over into our basket then we can throw a
new quantity exceeded exception here and
of course we need to pull this up here
so use basket or rather use cut baskets
exceptions quantity exceeded exception
so we're all set up to go we've got a
couple more things to add down here
later on we'll now move on to actually
adding an item so let's close all this
off forget about it for a moment and
come back through if we have any
problems what we want to do is we want
to click on an item we want to click Add
to car and we want to add this using the
methods that we've just built and then
on our cart page we can go and dump all
of the items in our basket just to see
that they're being added properly okay
so we need to obviously hook this up so
we already have our controller just over
here and we have this add method we
already have sorted our index method so
for our add method then we want to add a
product by a slug we want to also accept
the quantity for this we have our
standard request in here and we have our
standard response in here that we can
use and we also want to pull in our
route as well so we can redirect off if
there are any problems so up here we
will just say use slim Rooter we've
already seen this in action so to add an
item then what do we want to do well we
know that we have our basket within our
container so we can pull this in to our
controller so let's create our
constructor just here and up here we
will use cart basket basket we will
inject this into here and this is what I
was saying earlier if you want to do
this with stuff like your Rooter you can
do we're going to say this basket equals
basket and of course that should be like
that and we'll just correct this up as
well now here we're going to say
protected basket and we're done that
should be all we need for now so to add
an item then we've already done all of
the hard work we're going to grab that
product from the database because
remember to add a product we need to
send it through to our basket admin
as a product model so we're going to say
this product which we haven't set up so
we define just a moment as well so we're
slug is the slug that we pass into this
and we're going to grab the first record
you'll have noticed this from our
product detail page as well so if we
can't find that product by the slug
we're going to return a response with a
redirection and from our router we are
going to get the path for the home page
so let's just quickly put in our product
model in here because we do need this so
just say product and we'll make sure
this is pulled in yes it is and we will
add this just here as well so product
and up here we will duplicate this down
like so okay so now that we've done this
then let's just do a die here and say at
just so we know that we can get to this
point because what we need to do is
update our router so to add an item then
we need to adjust this so we're going to
say cart add slug and then we're going
to pass through a quantity like so and
this will be a get again and we're going
to have cart dot add like so and of
course this will use the add method on
the route on the cart controller so we
can update our product index page now
our product detail page sorry so let's
go over to our template so or I've used
product product and down here we can
update this to go through so we're going
to say path for product or rather cart
to add
and obviously into this we need to pass
the slug and the quantity so this is
just product slug and then the quantity
we're just going to assume for this is
one obviously you can update this to do
whatever you want but we're going to
pass to a quantity of one so now you can
see if you just look at the very bottom
and left of the video you can see that
we have add and then that's slug and
then the ID and then the quantity so if
I click Add to car it now says add
perfect now if the item doesn't exist we
can't add it to the car we're just
redirected back so that works fine so
now that we're at this point we need to
actually add the item so we're going to
keep this up and refresh it but you can
just imagine that we've clicked on the
link again and how do we add an item to
our cart well we know that what we can
do is use our basket we can use the if
we just head over here we can use the
add method on the basket to add this in
so we're going to create a try-catch on
here because remember we can catch if
the quantity has exceeded so we need to
actually pull this in so I'll go ahead
and pop it in here now quantity exceeded
exception and we'll call that e
for now we're not going to do anything
but here would be the great point to set
some kind of message in the session and
what we trying well we're just saying
this basket add product and the quantity
that's been passed in and then down here
what we want to do last is just redirect
the cart index so let's return response
with redirect and let's redirect pulling
this out of our router the path for cart
index that's the index page that we've
not done much with so now when I add one
of these
we're redirected over to cart so it
looks like everything worked but now
what we need to do is actually dump out
the contents of our cart so the step we
need to take before this is actually
passed through our basket
class through to every view so the
contents of this to every view now to do
this we need to update our container
file and inside of twig what we can do
here is actually share items with every
view that we render so to do this we
just say twig get environment I will
just spell that quickly then we say add
global we give this a key we're going to
say basket and then we're going to say C
which is our current container get
basket class so now any view that we
create so this one just here we'll have
our basket class available to actually
grab anything out of and this will be
really helpful because it means that we
can go and update our navigation so we
can update the amount of items in there
we'll do that in just a moment so the
first thing then is just to dump out our
basket contents here just so we can see
that it's working so if we head over to
cart index let's just do this now so
we're going to say basket raw let's just
see what we get and this is fine because
we're here currently trying to dump on
the actual basket class and it can't be
converted to a string so what we can do
is we can use any methods now on our
basket class so let's just remind
ourselves what they are well we have for
example all which is really interesting
because this now hits the database and
pulls all of the items out and should
give us a list of all our items so you
can say basket all let's check that out
and again we get an array - string
conversion that's fine so we can say
maybe if we were to do JSON encode that
might help us okay there we go so what
we now have is our item in our basket we
know we added this we have a quantity of
1 we know that so now what we can do is
start to test if this works so let's go
and add a blake espresso let's add this
in
we're redirected back to that page where
we're dumping everything and you can see
that that's been added in and the great
thing is because we're hitting our
database without that class we're
actually getting
everything out that we could possibly
need to display this to the user so the
price the stock the quantity but now
let's check if we add another Blake
espresso how is that going to work out
well let's add this to the cart you can
see here the quantity has been updated
perfect this is working brilliantly
so what we want to do lastly because
this has taken a long time and it will
be the longest part of the series I
promise we're going to update the
navigation just here to output the
number of items in our baskets this is
really straightforward we'll leave this
in here for now as well just so we can
refer back to it later and let's go and
head over to our let's see templates
navigation and we want to update this
number just here so if we say in here
remember now that we're passing basket
through to every one of our templates we
can just say basket or item count now if
we go over to our basket method here our
basket class sorry we know that we have
this item count which just does account
on our storage and if you're interested
in how count works on this class
remember when we set this up we
implemented countable which will
basically when we use the count method
here or the count function here it will
go ahead and call this straight away so
that's how that works so here we have
basket item count when we refresh we see
two so we now have two items in our
basket we know that obviously we have
more quantity of one item but
technically we have to set prices in our
basket so there we go that is adding
items to our car take a break and in the
next part we're going to look at the
cart summary so that is just listing out
all of the items in our basket as it
stands I want to give a huge shout out
to our friends at Braintree payments for
supporting code cause in the future
there could be a whole new way to pay
brain trees for slack payment platform
is easily adaptable to anything the
future holds so you can easily
- with one simple integration and
support for any device when that new
payment method comes out all you'll have
to do is update a few lines of code no
complicated recoding no late nights no
stress about staying ahead of the curve
Braintree payments is here to help you
can learn more at Braintree payments
comm / code course</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>