<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Generating PDF files with PHP: Generating the PDF (6/7) | Coder Coacher - Coaching Coders</title><meta content="Generating PDF files with PHP: Generating the PDF (6/7) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Generating PDF files with PHP: Generating the PDF (6/7)</b></h2><h5 class="post__date">2015-10-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AYSFyIuTLy4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so remember at the start I said that we
need the process component from Symphony
and also the HTTP foundation component
so what we're gonna do is we're gonna
install these now so they're ready to go
when we need them okay so what we need
to do then is head over at our terminal
and we're gonna require these in with
composer it's as simple as Symphony
process we'll wait for that one to
download okay so we can now require in
Symphony HTTP foundation and that's done
as well so we now have these available
the next thing within this capture image
method we actually want to go ahead and
run the Phantom process so all we're
going to do here is start to implement
this method and just while we're at it
I'm going to change these to protect it
we don't need them visible publicly and
we're now gonna implement that phantom
process method now this will take a path
that's the temporary files that we've
got here so I'm going to delete that
other one now so it's gonna take in a
path we're gonna create a process that's
gonna run phantom Jas we then need to
build a JavaScript file which is
actually going to make the rendering
happen this will give us our PDF file so
because we're using Symphony's process
component we need to go ahead and import
this so its Symphony component process
process and well write it we'll pull in
the HTTP foundation response class as
well that will be for actually
responding to the request and allowing
the user to download the file so now
what we need to do then is say this
phantom process we pass in the path we
set a timeout as well this is quite
important because if it does timeout we
won't get the result we won
and we're gonna see must run so this has
to run so the phantom process then is as
easy as returning a new process which is
Symphony's process component we pass in
the directory sits bin or binary phantom
Jas if you're using Windows it will be
exe or something like that and then
we're going to run capture J s which we
haven't built yet and then we're gonna
append on the path that we get through
so again let's just recap here we have
the file written and then we get the
path back from this method we then run
the fan that phantom process method
which is here and all this is doing is
it's returning a new process we're
hitting phantom Jas we're using capture
Jas and the argument that we're passing
through to capture Jas is the path of
the father we want to take a snapshot of
so now it's up to us to build the script
to use phantom Jas to actually take a
snapshot so in my root directory and
then create a new file and I'm gonna
call this capture Jas and this is now
JavaScript obviously so we have to
require in the file system here also
going to put in our arguments and we're
gonna require in web page two so all of
this is going to allow us to first of
all use filesystem it's going to allow
us to pull in the arguments that we have
passed through to this which is the path
of the thing that we want to take a
snapshot of and we also have the ability
to set up a page so change the viewport
size change the paper size of what we
want to render it out and then we can
obviously use this to render as well so
this is pretty straightforward the first
thing we want to do is actually read the
file we pass in so I'm going to say page
content so we're assigning that the
value FS dot read so we're reading from
the file system and we
use args that we pulled in up there to
get the first argument so all that's
done is it's put a sign to page the
content of that temporary far within
storage and then we just want to do a
few things like set the viewport size so
this is just an object we have a width
to this now I'm just choosing like
values I think look good in the end
result but obviously you can play around
with these so here we've got the width
and the height set to 102 for now we can
set the paper size of this and again
this is an object here and we're going
to set the format I'm gonna set that to
a two we're gonna set the orientation to
portrait of course you can do anything
here I'm also going to set the margin to
and I'm going to choose one centimeter
so now what we want to do is delay the
page so everything has time to render
and this is mainly for the assets that
we've included within our view so once
we have rendered this out replaced
everything we want to let bootstrap load
in we want to let this image load in
which is just the co course logo and
anything else to be included on the page
it's good idea though to keep these
pages really lightweight depending on
obviously what you're doing so now then
we're gonna say window set timeout I'm
gonna pass in one second so obviously
you can adjust this if things aren't
loading in in time but obviously is up
to you this will delay the execution of
your user downloading the PDF file cuz
obviously the Fantom process has to run
all the way through before the actual
PDF files download it so you can adjust
this but if you would set it to say five
seconds it will take five seconds before
your user actually receives the download
so be really careful with this so now
what we're going to do so page render
I'm gonna again pass in the path that we
pulled into the arguments here and then
we just say phantom dot exit so that is
it we can now kind of test this out so
he
here we are running this process so
let's give it a go if we head over to
our browser get rid of these now hit
enter and see what happened so over in
my text editor under storage you can now
see that instead of an HTML file this
file is in fact now a PDF file so we can
open this up in here so if we go back
over to storage and we click on this we
can now see if I just move this into
place we have a PDF file with replace me
replace me and all that stuff so we need
to kind of sort these out so let's
quickly fix up these replacements first
of all and then we can actually look at
responding to the user's request and
actually downloading that file so inside
of invoice we've got the number variable
here let's just take a look on index
what we're doing so we've got order here
so I'm just going to keep this as order
and adjust this accordingly so order so
we now have the amount Jew which we
passed in amount so we just update this
in here like so and then build - and
that's name of course you can customize
this however you want so let's check
this out again then let's hit enter and
let's go ahead and see this new file I
think it's that one there perfect so
I'll just pull this into view and you
can see now we've got that number we've
got that amount and then we've got the
name they're being replaced in so what
we've now successfully done is using
phantom j/s we've actually rendered a
PDF file but how do we respond to that
request and actually allow the user
download it so in the next video we're
gonna be doing that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>