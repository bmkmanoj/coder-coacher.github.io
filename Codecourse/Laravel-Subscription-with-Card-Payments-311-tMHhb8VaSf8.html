<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel Subscription with Card Payments (3/11) | Coder Coacher - Coaching Coders</title><meta content="Laravel Subscription with Card Payments (3/11) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel Subscription with Card Payments (3/11)</b></h2><h5 class="post__date">2014-07-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tMHhb8VaSf8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're now going to install our file
cashier so we're literally just going to
follow the instructions on the repo very
very straightforward the first thing you
need to do is pull this in with
composure so if we head over to our
project and under our composer file
under require let's just paste this into
a pulling in laravel cashier version 2
so over in our terminal let's run
composer update so that's downloaded
cashier you'll also notice that it's
pulled in these stripe PHP library as
well which is a dependency of caches so
now that we have cashier pulled down as
a dependency on our project we can start
to go ahead and register service
providers and use the trait within our
user model but obviously what we need to
do is we need to create a user actual
user table first with a migration so
we'll really quickly do that and then
we'll start to integrate stripe
integrator laravel cashier so let's just
continue follow the instructions on here
so the first thing we need to do is
register this laravel service this
cashier service provider so we do that
within our app PHP file so if we just
scroll down here literally just add it
to the end here like so and now what we
want to do is well we'll go ahead and
create the migrations so under our
command line let's say PHP arts and
migrate mate create users table you may
already have a users table in which case
you won't need to do this but we won't
be a minute so let's pull up that
migration that we just created and let's
create this users table so we need an
incrementing field here that's going to
be my D we'll create a string here for
the username
we'll create a string here for the email
address we'll create a string here for
the password as well and we'll add our
timestamps on so Underdown let's drop
this table in case we need to roll back
this and then we go so we've created our
migration let's run this now let's
change our details first so on the
config local you're going to want to
change your database settings remember
under our local version if you want to
go ahead and change this on the
production you change this one so the
database here is website the username
here is root password is root as well so
let's run this again and there we go
let's open up sequel Pro and refresh you
can see that we've got our migrations
table and now users table with this
structure cool so we can now insert a
user basically into here so let's do
this now for the username let's say Alex
for the email let's say Alex code course
comm and for the password we need a hash
so let's just quickly run over to our
routes file and let's do a return hash
make password and that will then give us
hash that we can use in there and there
we go
so we've got our data in here so we can
actually sign into this account if we
want to let's just go ahead and get rid
of this inside of our route now we're
going to force the user to log in as
well but before that let's head over to
our user model that's already generated
for us now we need to implement the tray
into here so let's go ahead and do this
over on laravel cashier you can see that
it gives us a model set of example so we
need to use these two first of all this
trait and this interface so let's just
paste these into here what we then need
to do is make sure that our user model
implements the billable interface so
let's just pop that in there
and we also then need to use the
billable trait so we just come and
separate that on to the traits that are
already used in here and what we also
need to do is we need to add these dates
in here to allow card then to be used
for the trial ends at and the
subscription ends up and this just means
that we use carbon to modify the dates
in any way we want really so we can just
guess copy this pop that there all right
we won't give it a description so here
we are and we've we've got our user
model we now need to sort of force the
user to login and this is just the last
part of this really everything else is
set up so we can do this so over in our
filters file I'm going to go ahead and
before I'm going to say auth attempt and
in here I'm going to pass in my email
and I'm going to pass in my password now
that's going to sign us in so when our
routes file we can do something like var
dump off check and that should give us
true so we now actually signed in so we
can access the users information we can
also use the functionality that's given
to us on the billable trait that we've
now used inside of our user model so we
can do things like subscribe a user to a
plan etc etc</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>