<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Authentication with Slim 3: Persisting old form data (13/29) | Coder Coacher - Coaching Coders</title><meta content="Authentication with Slim 3: Persisting old form data (13/29) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Authentication with Slim 3: Persisting old form data (13/29)</b></h2><h5 class="post__date">2016-04-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/49cuwfzgf-s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now setting up our old form data so the
data that we want to persist is actually
really straightforward we just need to
create one piece of middleware for this
add it to our application and we can
then just start to output on our form
all of the persistent data so to do this
of course we'll start by just creating
some new middleware so I'm going to
create a new file in here of course and
I'm gonna call this old input middleware
again choose a name that you think is
appropriate and I can pretty much copy
this middleware over because we don't
here have to keep writing out this
invoke method so let's paste this in and
let's just change the name so old input
middleware so let's get rid of this
because we don't need this but we
obviously do need to call our next
middleware and inside of here what do we
want to do well you may have worked out
that we want to set this as a global
within our template so we can access the
old data but where do we get this data
from well of course what's actually
happening is we have our request object
in here so we can take the parameters
that we've submitted from the form and
we can apply them to a global in side of
our templates so we do a similar thing
we say this container view get
environnement set global we're going to
set this as old so that we the key and
here we're going to set a session that
we haven't quite set yet and this is old
so now we're sharing this old data
without view but we're not actually
setting this old data we're going to do
this down here so let's do this now
like so and it's just fix up this
spelling mistake just there now you
might be wondering well why are we
setting it into the container before
actually is being set here well think
about the way this works because it's
old data let's say we hit our
application for the first time what we
don't want to do is set our request here
and then share it without view what we
want to do is for the last request this
will be set in our session and then for
the next request that old data will then
be set into here so for the first time
round this obviously won't have any data
in but the next time around or have old
data so it will be set here and then
anymore we'll just keep getting set over
and over again so hopefully that makes
sense but of course feel free to change
this around and see how things change
for you okay so now that we've got our
middleware set up we obviously need to
attach it let's do a similar thing that
we did here and we'll just say old input
middleware perfect so now we can start
to test this out we know that the key is
old and we know that this is going to be
an array remember get params returns us
an array of all of our requests data
anything we submitted in a form or in
the query string so now over in our view
we can let's say for the email set a
value on here we know that this will
give you a default value and of course
the method name here I just need to
correct this should be add global so
let's refresh and there we go so we know
that this value property within HTML
sets this in for us so all we need to do
then is say bold dot email simple as
that and now when we go ahead and say
enter an email address but we don't into
any other data we still see that email
address simple as that and when we go
ahead and sign up again it just retains
because we've got that data in there
being passed through into our request
and we can grab that and set it in the
session so now we can just do the same
for the name and we are pretty much done
so
go and just set a value on here of
course we want this to be old dot name
so let's just test this out it's enter a
name in here hit sign up and there we go
we don't want to persist the password
it's a bit odd we don't to keep it in
the form so we're just gonna leave it as
it is but we're now persisting this data
so it's much better experience for the
user</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>