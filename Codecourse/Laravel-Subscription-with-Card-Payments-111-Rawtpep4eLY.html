<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel Subscription with Card Payments (1/11) | Coder Coacher - Coaching Coders</title><meta content="Laravel Subscription with Card Payments (1/11) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel Subscription with Card Payments (1/11)</b></h2><h5 class="post__date">2014-07-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Rawtpep4eLY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay in this series we're going to be
creating a subscription service with
laravel and we're going to be using
laravel cashier to help us out with this
and this is a really simple way to
integrate stripe into your application
now stripe is a credit card processing
service and it's really good because the
API for it is fantastic the
documentation for it is fantastic and it
is secure and by secure I basically mean
that when your user comes to join your
website join your subscription you don't
have to provide or you don't have to
have any of the credit card details that
enter touch your server at all they're
immediately sent to stripe and to verify
you get a token so none of the card
details will touch your server so let's
take a look at how this works it says at
the moment it's looks like I'm not
subscribed inside of our database at the
moment I've basically just got a user
here with the username password and
email I'm forcing this specific user to
be logged in we're not going to look or
authentication in this series so once
we're logged in we see that we got get
this message we're going to click join
now and you can see here that we've got
a couple of options we've got a the
option to choose a plan and these are
set up within stripe so if I just head
over to my stripe dashboard and don't
worry we're going to be going over this
within this series we've got two plans
here that are set within stripe itself
so we've got small and big now we can
choose either one here so I'm just going
to choose I know the big one and inside
the card number I'm going to go ahead
and enter a test card number and a good
thing about stripe is it does provide
you with test cards you can see you've
got a variety of different cards here
except and the card numbers so if we
take a visa card for example and we
decide to pay with a Visa I'm going to
go and hit hit make payment now and
you're going to see we get an error at
the top of the page your cards
expiration years invalid so it does
actually validate this data as well and
we'll be looking at how we do this with
the stripe JavaScript library very very
straightforward so I'm going to type a
month in a year and a CVC and
make payment and give that just a moment
and there we go so we're now subscribed
as a user we have a message here to tell
us that we're subscribed and we've got a
couple of options here we'll look at
them in just a moment over in stripe
though you can see that on my dashboard
as well as a couple of other payments
that I've made this shows you all of the
payments that you've made you can hit
payments here and that gives you
information here as well as well as a
list of the customers that you currently
have so if we just refresh this you'll
see that the customer I've just used has
been registered and that's the same
email that I have in my database and it
gives us payments and things like that
so I'm now on a subscription service
this will charge my card that I've just
used every month with $10 see your users
will continue to be subscribed on your
website unless they cancel their
subscription and we have an option to do
that here so if I hit cancel
subscription that will go ahead and it
will cancel it for me and it will then
give me a date that my subscription will
end and this is within a month's time
because what we're not doing is we're
not canceling the users account
straightaway because they've already
paid for a month's worth of subscription
so it wouldn't be fair to cut them off
straightaway
this just means that they're still
subscribed but their subscription will
end on this date which is exactly a
month from now when I've just paid we
can also resume the subscription as well
so if we want to decide that we do want
to carry on being repeat billed we can
hit resume that's going to go ahead and
it's going to carry on the subscription
process now if the card for example that
the user is using does fail stripe has
web hooks through which allow us to
integrate into our application so what's
going to happen is over on stripe if
this users card fails to make a charge
perhaps they don't have any money on
their account what that's going to do is
it's going to send a web hook to our
website and we'll look at setting up the
web hook and the roots later and that's
then going to cancel the users
subscription for us so it handles
everything for us so that's the beauty
of using laravel cashier here now one
last thing we're going to look at is
actually updating our card if we decide
say we want to use different card let's
check out
this let's say I want to use an American
Express I can go ahead and I can just
paste that in there and I can choose an
expiry and then hit update card and
there we go my card has been updated now
the users details obviously their card
details aren't stored here if we just
hit refresh here you can see that we've
got a few bits of information within our
database table we don't need to set all
this up because laravel cashier does
come with migrations that allow us to do
this just basically with a hit of a
command but this does store certain
information so it stores the customers
ID a stripe customers ID
the subscription that user is currently
on well this is like an identifier for
their subscription their unique
subscription the plan as well it gives
us the last four digits which is really
useful you could technically output
these here just to tell the user which
card they're actually using just so they
don't forget and then they can go and
update their card if they want to use a
different one
so that's pretty much the system it is
very very basic to get set up we're not
going to be taking too long doing this
but there's an introduction of all of
the services that we're using we using
Lovera kasher and stripe and all of the
features within this application as well
and just lastly we do have the ability
to actually access areas for say if the
users on a big plan only they might have
access to different functionality than
the small plan and we also have the
ability to check that the user is
subscribed as well but if you do need to
add any additional functionality is
really simple to do so let's go ahead
and just start building this up</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>