<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create a URL Shortener API in PHP: Link Model (5/11) | Coder Coacher - Coaching Coders</title><meta content="Create a URL Shortener API in PHP: Link Model (5/11) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create a URL Shortener API in PHP: Link Model (5/11)</b></h2><h5 class="post__date">2015-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DiaS87U8ehI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">it's now time to create our first model
and the model that we're going to be
creating and the only model that we're
going to be creating is a link model
this is going to represent our links
table and that way that we that way what
we can do is add methods to this class
that we're going to be building if we
need to or just use it as a simple way
to pull in the data that we need so
let's create the model then we will look
at Pierce off for autoloading which I'll
explain and then we will look at an
example of pulling in this record here
using our new model so it's not as
difficult as it does sound it's inside
of app then we are going to first of all
namespace our application files and by
this i mean i'm going to create a
directory that represents either the
name of the site or my name just so we
can keep everything under one folder and
that will help with PSR for autoloading
as well so it's simple as creating a
directory inside of app and this should
be capitalized as well like this so
inside of this folder then I'm going to
create a models directory which are
going to store all of my models you can
structure this in a different way if
your application grows larger but for
now I'm just going to create a models
directory because we're only going to
have one file in here for now and that
far is linked PHP now notice i'm calling
it linked and not links as per our
database table name and that's just
convention so let's save this out so
inside of here what we want to do is
namespace this file and by name spacing
I mean grouping it under a specific name
and the name is going to replicate the
structure of this shorty directory down
all the way down to link and that means
that we can auto load in these files and
all that means is we don't have to keep
requiring in all of the new files we
create within this shorty directory
that's pretty much the reason that we're
doing this so let's namespace this under
shorty the capital S models and that's
all we need to do
so the class name is linked and that's
it so how is this going to work well
over on start PHP let's quickly create
an example root again so let's say app
get forward slash we'll have our call
back here and let's try and instantiate
link let's create a new instance of this
link model so to do that we need to use
shorty models link much like we've done
for our dependencies and then here we
can say link equals new link we can omit
the parentheses now this should work
because we have the file existing here
named spaced under shorty models here
we're importing shorty models and Link
this is the class name and then we're
creating a new instance of this class
but this isn't going to work if we
refresh and turn errors on so just
temporarily we'll just set display
errors two on and refresh it says here
fatal error class shorty models link not
found in the reason for this is we're
not actually including this file
anywhere but we don't want to do that
because that means for any other file
that we create we're going to have to
include this file so we're going to
utilize composer to autoload our files
for us and because remember we're
including this also load dot PHP file
here to put in our dependencies that
will also pull in all of the files
within our shorty namespace as well so
under composer that JSON just up here
we're going to create an auto load
property and let's pull this down and
inside of here we're going to choose to
PSR for auto load that's another object
there and in here we specify first of
all the top-level namespace which is
shorty and then we do two forward
slashes because we need one forward
slash there but it invalidates the JSON
otherwise so we need to and
then we're going to choose the location
of where this shorty directory or
namespace structure starts and that is
app forward slash 40 so it's app /or t
and all that's going to do is it's going
to load in any files that we create
under this shorty directory as long as
they follow the namespace and convention
so shorty is the outer directory models
is this directory and link here is this
class so we can't really just do this
and refresh it's not going to work we
need to dump out autoloader we only need
to do this once because then it will
know where to look for these files so
all we do is we say dump composer dump
also load and we pass the optimized
Flags that's a lowercase o and that has
generated generated optimized autoload
files and when we refresh we get no
error and that means that this link here
has been instantiated properly now
obviously not going to be doing this but
let's take an example I look at an
example of reading this record from our
database so our model here isn't quite
set up to use eloquent what we need to
do is extend eloquent so we can take all
of the functionality from it it will
connect us up with that table and we can
pull in records so all we need to do
here is extend eloquent but eloquent
cannot be found in here because it's not
named spaced under models so we need to
import this namespace and this is
illuminate database eloquent models and
we're going to call that eloquent so
we're calling this models class here
eloquent and we're just extending it
here so there's a couple of things we
want to define in here we want to define
the table that we're working with this
will automatically detect as long as you
have link it will look for a links with
an S on the end table but I'm going to
do this manually because sometimes when
you're using eloquent models your
database table name is going to be
different and we also know
I want to define the fields that we're
allowed to fill and this is to basically
control mass of Simon so we want URL and
code so they're the two fields here that
we want to feel if you add any other
more any other fields you may need to
add them in here depending on how you're
creating new records or updating them so
this is done what we can now do inside
of start is actually start to use
eloquent functionality so what we do
here then is we say link and we can now
start to build up a query with methods
to pull in this record and it's as easy
as this so we say link where and then
here what we can do is we can say we're
URL equals something so we can say we're
URL and then paste that in as a string
if we wanted to and we will eventually
be doing this you can do this as well
but if you're checking for equals you
can just do two comma separated values
and then we use first to pull back that
record so let's assign this to link and
then let's do a VAR dump on link and see
what we get back so when i refresh here
we have an error so let's just check
this out there we go to the model
there's not models so let's refresh and
there we go so we get this link object
back and it gives us all of this data in
just in here and this does look a little
bit confusing it looks like there's you
know a ton of data where's all this data
coming from because we are using models
it's pulling back all of the
functionality that we have on our model
as well so for example we could add a
method in here like public function yet
URL for example and that could return
this URL and all URL is is the field
name of the column name in your database
table so that's why we're getting all
that sort of it what looks like
gibberish back but if we use something
like
yet this is going to pull back the
following so it will pull back a
collection of items this now has link in
there and then we can iterate through
them if we wanted if we had multiple
records it may not make too much sense
at the moment but when it comes down to
it and when we're actually working with
this within link generation it will make
a lot more sense so before we go on to
the next part which are actually going
to be creating our roots let's get rid
of this example root let's pull out this
here because we don't need this
dependency in there and let's leave our
temporary php.ini display errors setting
on just so if we do get any more errors
we can see what's going on here so at
the current state we have no roots at
all but we do have our database
connection setup we've created our first
and only model which is link which is
going to assist us in creating links
pulling backlinks and doing things like
that and we can obviously access our
application and everything is looking
good but now we need to actually create
the roots so we can start to show the
default homepage which is just going to
be nothing actually read directly use a
to a link from a short link and then
eventually we're going to generate links
using the API that we're going to be
building essentially just a route that
we're going to be hitting via a rest
client so let's get on in the next part
with creating these roots then and then
we'll go on to the more fun stuff</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>