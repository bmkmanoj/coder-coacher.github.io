<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Social Network with PHP: Showing statuses on the timeline (26/37) | Coder Coacher - Coaching Coders</title><meta content="Social Network with PHP: Showing statuses on the timeline (26/37) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Social Network with PHP: Showing statuses on the timeline (26/37)</b></h2><h5 class="post__date">2015-08-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hqG-fCZ8PDM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now we want to show our own statuses on
our timeline as well as any of our
friends statuses as well this might seem
like quite a difficult thing to do but
it's actually very simple so what we're
going to do is we are going to update
our home controller and we're going to
pass through all of our statuses and our
friend statuses in the timeline
the reason this might seem difficult is
because we need them in chronological
order but somehow we need to kind of
merge the two together so we need to
merge all of our friends statuses and
our statuses and this can get really
really tricky but with a look when it's
pretty straightforward so the first
thing I'm gonna do is actually from
another user account let's just check
who I'm friends with here so yet so
Billy is friends with Alex so if we post
the status from Billy well we should see
it on on our timeline so what a nice day
and we'll just update the status from
Billy and we now have two statuses in
here so we should see over on my account
two States's appear here so let's do
this all in here and we'll just die dump
the results we can see what we get
through from the result of this and then
we'll implement the view later to
actually loop through and show all of
the States's so I'm going to have a
variable here called statuses and this
is going to be status so we're using the
status object here where and before we
do anything else I'm just going to go
ahead and use chatty models status so
status where and in here we're gonna
have a callback and we're gonna have our
query builder passed into this and from
that we can return more things so we're
gonna say return query where and this
basically it's going to return any
results where the user ID matches our
user ID or where the user ID of each
record is in our friends list so that
will pull back all of the relevant
records so we say where user ID equals
auth user ID
and then down here we say or we're in
because what we're doing is we're saying
we're in user ID and then we grab a list
of our friends so use a friend but we
need the users our friends IDs we need
each of our friends IDs so to do this we
use the lists method and we choose ID
simple as that
and then outside of this we can go ahead
and we can order this by whatever we
want so that will order all of them
records we're gonna order them by
created at I'm gonna order them
descending and then we can paginate them
as well so we're gonna be including some
pagination here so now that we've got
this done we can pass these through to
our timeline but I'm just going to die
dumped on these results in fact we'll
change this to get just for now and
let's say statuses let's refresh the
page here and there we go so we've got
two statuses as we would expect to two
status objects the first one being what
a nice day that's from Billy and the
second one is me and remember this
second one here is the last one because
it was posted first so the the the
latest one of it at the top so we've now
got all of these statuses let's return
this to paginate and we'll paginate by
10 you can obviously adjust this value
and we're gonna render this view with
statuses as statuses and now in our home
or timeline template we can list through
them so over on our index page here this
is where our statuses and replies are
going to be so the first thing we need
to do is check whether we actually have
any statuses so if not statuses count
else then we end that if there so if we
don't have any statuses in our timeline
we'll say there's nothing in your
timeline yet
otherwise we want to loop through our
statuses so for each statuses as status
we end the for each there so this will
be each of the statuses so when we
refresh now we should see status output
twice if we don't have any statuses in
our database so what I'm gonna do is
just change these to use your idea of
nine for a moment there's nothing in
your timeline yeah that was one and
three I believe let's just double-check
that yeah so now what these two status
objects which we can go ahead and output
you'll find the mark-up for this in the
course download so if you copy and paste
this over inside of this for each loop
there's a lot here but I'll go ahead and
explain exactly what we've got just make
sure that's nicely indented so what we
have here is another media object with a
an avatar for the user that has posted
this status we've got the media body
which contains the name of the user with
a links their profile the actual post
itself and then we've got an unordered
list which will basically contain when
this was posted a button to actually
like the status which we'll be including
later an account of how many times this
has been liked now for now we're
ignoring these because we're not
focusing on that yet next here we've got
a reply so this is going to be a for
each loop we're gonna be looping on this
so these are all of the replies to the
statuses so we don't really need this
just yet so what I'm gonna do is just
comment that out so you can go ahead and
comment now here we have the form to be
able to reply to a status so we'll keep
this in anyway so let's see what this is
done we're just refresh so this is
basically what it looks like guava scene
are outputting your user profile at the
moment but we can just tidy this up just
now so the first thing to do then is
this media object that is the user
social statuses user that is the profile
picture now remember over on our status
model we have a user relation so what we
can do is for any status we can grab the
user who owns that status so in here I'm
going to say status user get
avatar URL and in the alt we can just
out for their full name so status user
get name or user name and we should see
the following there we go so we've got
that profile there so the next thing
then is obviously the link to the users
profile so let's create a link here and
this is profile dot just remind
ourselves let's come over to the routes
here its profile index and remember here
we need to pass a username in so past
that use the name which is status user
username so for a user
remember this is Billy and this is Alex
although it doesn't show at the moment
that goes through or this will this will
go through to Alex and this will go
through to Billy so let's update the
link sort of copy and paste this for the
actual name of the user as well so we
can post that into there and then we can
obviously output the user's name here
too so this will be status user get name
or username and here will be the body so
we can replace that now we already know
that we have a status body and we can
output the time as well
so obviously created at an updated
updates in eloquent are Carbon objects
so we can use carbon and we can say
status created at diff for humans so
let's check this out and it now looks a
little bit better so we've got Billy
Garrett Alex Carrick and click on that I
can click on that and we have the body
and the time it was posted as well so we
now have a timeline with not only our
own statuses on but our friends statuses
as well and you can go ahead and play
around with this and create more user
accounts add them as friends post things
if we head over to Billy again and we
host something else obviously on Billy's
timeline as well now you can see that
it's reflected we'll just write
something in there and we head over to
here and we see that updated so it's all
being updated for us so now that we've
updated our timeline to show a list of
all of the statuses what happens if
there are more than the paginating
amount
remember we're paginating by ten here if
I do paginate by two obviously we're
only going to see the first two records
here we need some pagination at the
bottom so we can flick through this so
over on our index page at the bottom
here we are going to after this render
out the links so what we need to do is
we'll see a problem with this if we knew
statuses render you'll see that this
will just render a little mark up
because by default blade outputting will
escape everything so we just need two
exclamation marks like that when we go
ahead and refresh we then see our
pagination and we can paginate between
our results easy as that so we'll go and
change this back to ten because two is a
little bit too little and if we return
to our home page there we go so we've
got three results there with obviously
the ability to paginate if there are
more than ten</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>