<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Authentication with Slim 3: Updating the navigation bar (19/29) | Coder Coacher - Coaching Coders</title><meta content="Authentication with Slim 3: Updating the navigation bar (19/29) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Authentication with Slim 3: Updating the navigation bar (19/29)</b></h2><h5 class="post__date">2016-04-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7C2XpInoASg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so now we'll tackle the header and we
have a few other things to update as
well at the moment none of these links
really go anywhere so we can first of
all look at how we show sign up and sign
in if we're not signed in and then of
course we'll show the users name once
they are signed in so we can also go
back and update our earth method to
return the currently authenticated user
this makes it easy to do things like
this so let's head over to that partial
that we created earlier on in the series
so remember it's under resources
templates partials navigation so the
first thing that we're gonna do is just
look at the difference between these two
links and then this entire drop-down so
we know that if we are signed in we want
to show this drop down otherwise we want
to show these two but we have no way of
checking if the user is actually signed
in so over an hour or class we need some
kind of check method so let's just
create a method here called check and
here how do we know if your users
authenticated well for now we can return
is set dollar underscore session user so
if that's set we know that a user can't
set that themselves because sessions are
stored on our server so we know that
they must be signed in so what we can
also do while we're here is create a
method to grab the currently signed in
user now we know the users ID here so
all we need to do is return user find
dollar underscore session user that
would just grab that record return the
first or only record and we're done so
now that we've got this we can go ahead
and use this in here to basically check
if the user is signed in but what
happens when we try to use auth dot
check say well where's Earth coming from
we don't have it within our templates
and that's where we
to again make this a global variable so
what we're going to do is we're gonna
head over to our app and just for now I
guess you could change this later you
could set this into middleware if you
wanted to but we're gonna set this in
here so we're gonna add this as a global
so all we do is save you get environment
again add global and we're gonna add
earth to this and this is going to be
container off so what we need to do is
just pull out off just up here and we're
done so now we're gonna have this or
class available inside of our templates
now we'll come back and change this in
just a moment the reason being is that
if we were to in multiple places use
author user well that's going to do is
it's going to keep creating sq it is
going to keep performing SQL queries so
in actual fact what we can do here is we
can say something like we just get rid
of this we could say off check we can
paste this back in we can use the check
method there so this will be a true or
false value and what we can also do is
say user and then here we can pull the
user so what we are essentially doing
here is we are calling the database once
but we're storing that user inside of
our view variables that means we can use
them in our templates therefore we're
only doing it once so we're just saying
auth dot user that will just always be
that user so it's these kind of subtle
things where you might create it not
realize how many SQL queries you are
actually performing so it's really
important to kind of tie this up at the
start so let's just test this out then
so over in our navigation we know that
we want the drop-down to display only
when a user is signed in so we want an
if statement here if off check and then
here we can have an else
and then here we'll just end that if
statement so now we just indent this we
should see because we remember
authenticated earlier and of course Isis
about environment wrong again set
environ mint there we go so now that
we're signed in we can see this drop
down we can't see the sign in sign up
because it doesn't make sense so let's
just hope to resources over to cookies
we'll just get rid of the PHP session
and now we're back to the state where we
have sign up and sign in so let's just
tie up these links very very quickly and
then we'll be good to move on so for
sign up we know that this is path 4/4
sign up and we can copy this pop that in
there and it's all stop sign in we don't
have sign out we don't have changed
password at the moment but of course we
don't this to keep displaying my cat's
name so what we want to do is say auth
dot user which remember we are making a
request to we're storing that in our
global views or our global TWIC instance
and then we're gonna say dot name so
this is the user's name so this is the
property from the database this is the
user and of course this is the thing
that we've attached to our views so now
if I go and sign in just pull this down
we should see my name perfect so easy as
that so let's just tie up the couple of
other links that we have we've got the
home link here of course you can get rid
of or create other pages pretty
straightforward now and this is just
home and of course we want the same for
the logo here as well so now we can
click home to go back home and of course
wherever we want to go so there we go
we've tidied up our navigation bar so we
have that state set now whether we're
signed in or signed out</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>