<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel: Events &amp; Subscribers | Coder Coacher - Coaching Coders</title><meta content="Laravel: Events &amp; Subscribers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel: Events &amp; Subscribers</b></h2><h5 class="post__date">2014-07-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dTYSH0R7D1o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to be looking
at events and subscribers so I've got a
very basic login system here I click it
to log in and then I can log out again
there's no form or anything I'm just I'm
just calling off logging just to save
time and make just for time and
simplicity purposes so very quickly
let's look over code I have a root get
to the home page which just returns a
view we have a login root which just
caused this and we have a logout which
is just this very simple and we have our
view ok so what I want to do in this
tutorial is if we look in my database I
want to add another column here to say
last login date so I'm not going to fill
around with migrations right now at
instead I'm just going to create a very
quick column last login time and we'll
just call it last login and we'll set
that to date time now we could put it in
here we could get the user we could do
something like this you to find to user
last login and then we could set the
date and then we could do user save but
instead of doing that what I want to do
is I want to use a event so first what
we're going to do is we're going to fire
an event so I'm going to call this event
auth dot log in and I think that's
actually reserved so instead I'm going
to call that Earth get login so I'm also
going to store this inside a variable so
off login user and we're going to pass
that in as a argument so in a routes
file we're going to say event.listen
we're going to enter the the event name
so auth they'll get login
we're going to pass in a closure and
this is going to take any arguments that
we passed in this array here so in this
case it's just a user so now what we can
do is we could say user what did we call
this last login so user last login
equals new date time and then we can say
user save okay so let's look at this in
the browser we're going to hit login we
get logged in we get welcome bacteria we
get no errors or anything refresh in the
database and we get our timestamp
perfect now here we're storing this
inside the routes file which is fine for
small applications but what if what if
we have a lot of events well we'd want
to create a subscriber for that so
inside Acme I'm going to create a new
fault called subscriber this is going to
contain a file called Earth at
subscriber the PHP I'm going to create
the class name space is Acme subscriber
class auth subscriber and we could
probably just leave this as author since
we have subscriber in the name space so
class off we want one method for now and
that was get login so public function
get login and what I like to do is I
like to prefix this with on just so we
know for certain that this is an event
handler I like before this is going to
take one parameter so now what we can do
is back in our routes file we're just
going to steal this get rid of that
paste it in and there we go the final
thing we need to do is just register
these listeners so public functions
subscribe events and then we say events
listen auth get login and by the way we
can call this whatever we like it could
be something different to the event name
so just to demonstrate that I'm going to
get and then similarly to how we call a
method in a controller we're going to
provide the class name so Acme
subscriber earth then we add an @ symbol
and then the method name so on login
finally we need to register this
subscriber in our in our routes file and
again this would typically be done in a
provider but for now let's keep it in
the routes file event subscribe we
provide just the class name so that we
can copy this Acme subscriber off okay
and we also need to change the name of
this file to all so let's take a look
let's take a look at this log out and
let me just check the time on here okay
so 35 minutes log in and we get ok we
didn't provide a namespace for this so
new date time just to add that global
namespace again again and there we go
nowhere is a refresh and we get the new
timestamp perfect</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>