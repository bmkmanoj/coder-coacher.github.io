<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 14): Email Activation (Part 4) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 14): Email Activation (Part 4) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 14): Email Activation (Part 4)</b></h2><h5 class="post__date">2012-05-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rFkGIo3O0ng" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so we're back for the last part of
this email activation part so we're
going to go ahead and actually test what
we've done now we've created this
function to activate the user account
we're going to throw out some errors if
there's any problems within this
activate thing but essentially now this
will work okay so let's just go ahead
and modify this slightly so we can
output any errors if they're in if there
are any problems here and then we'll
just spend the last part of the video
tidying stuff up okay so in here what we
want to do is we want to do the same
thing as we've done for all of the other
sort of validation bits and that is
checking if this errors array is empty
so if it's if it's not empty we want to
go ahead and we want to output some data
so I'm going to escape PHP back into PHP
so I can enter some HTML code in here or
HTML tags if your local element sorry
and so I'm just going to say oops and
then in here we can say oh no we want to
go ahead and just output the errors so
we can use echo and we're back in PHP
now output there as errors now remember
we created this output errors function
in general dot PHP where is it they're
real so don't think that's something
built into PHP if you've been following
this all along you'll you will recognize
this out the errors function so if there
are errors we do that if there are no
errors we assume that the user has
activated their account properly based
on what's been returned from this
function here and we can go ahead and
redirect them to a success page so we
redirect them to location this page so
activate activate dot PHP and then we
add this success thing on the end we've
seen this before in the register parts
where I won't go over again so now what
we want to do is when the user
successfully activated we want to go
ahead
and check this so what I have done here
is I've said if something do something
else if is set this stuff let's go ahead
down here and we need to honor that's it
that's what we need to do so if is set
dollar underscore get success so we're
checking this little success thing on
the end now again we did we did this in
we did this in the register part and
empty the underscore get success is
equal to true so we're checking whether
we have this success thing in the URL
here and we're checking if it is empty
that's just the thing I like to do it
completely unnecessary or not completely
unnecessary but relatively unnecessary
so if it is then we we just want to
output something basically so I'm just
going to say an h2 here what can we say
thanks we've activated your account
and you're free to log in brilliant so
let's go ahead and test this out there
may be some problems along the way
there's first of all access activate dot
PHP without putting anything in we
return just straight to index dot PHP
that is this working here where we say
else if this isn't set basically that's
the else of that if okay so now what I'm
going to go ahead and do is I'm going to
paste this oops just clicked on that I'm
going to paste this in which we used
earlier which essentially if no we won't
start the process again I'm going to
copy this and I'm going to paste this
into let's go ahead and close that we
don't need that paste this into here so
what's going to happen we're going to
pass in Billy up here Academy to all
this email code in our code it's going
to come down this is going to return
false this here is going to return true
because we'll have set email and email
code it's going to just sanitize that
trim that stuff check if the email
address exists if it doesn't oops
something went wrong so let's just do
that first so I'm just going to type an
extra G on here oops something wrong and
we can find that email address so we
know that that works testing testing
testing
else if activate is equal to false we
had problems like activating your
account if it doesn't we don't add an
error here so that's fine
activate we'll pass in the email in the
email code which we've taken from the
URL bar and we are sanitizing this data
we are checking if the email and user
code or email and email code exists in
pair exists in one row and where the
active state is equal to zero so we're
making sure that the users not
activating the account if they've
already activated it if so we are
updating that to particular users record
and setting their active status to one
and then we're returning true otherwise
we're returning false so if for example
we provide the correct email address but
an incorrect code so I'm just going to
append a one on to the end of here it
says we have problems activating your
account because that function will have
attempt false now if I get rid of that
one we're now
providing the correct data I'm going to
hit enter brilliant so now what's
happened is this function here this
activate function will have returned
true or not return false rather and
inside of activate dot PHP errors would
have been empty so we redirect the user
to success exit which is just to stop
anything else executing and then we pick
up on the success here and we say thanks
we've activated your account now it's
the scary bit of checking the database
to see if this has been updated properly
if I click on users and I scroll along
active is now equal to one so we've now
well this is due to let's find it where
are we yet that's due to this query here
actually updating that value because we
found the correct email in the correct
code so that is essentially it we've now
activated our count let's just quickly
go over the process one last time I'm
going to go ahead and register an
account under my name actually a conks I
would want I want to use the same email
address for testing purposes let's go
ahead and delete this so let's go ahead
and type in Billy I'll go ahead and give
it a password first name last name email
address click on register and I'm
registered I'm going to attempt to login
didn't work you haven't acted it
activated your account so I'm going to
check my email and activate my account
properly click on my new email I've
received I'm going to go ahead and copy
and paste this into my url bar so this
is how our actual user would do it press
enter thanks we've activated your
account you're free to login brilliant
so I can go ahead and enter my username
my password click login and now I am
successfully logged in so that is how
you use very very basic techniques to go
ahead and
activate an account on this system</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>