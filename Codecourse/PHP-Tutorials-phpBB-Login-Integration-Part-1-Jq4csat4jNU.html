<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: phpBB Login Integration (Part 1) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: phpBB Login Integration (Part 1) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: phpBB Login Integration (Part 1)</b></h2><h5 class="post__date">2009-08-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Jq4csat4jNU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so in this tutorial we're going to
be creating a PHP login integration what
I mean by this is if we were to log in
here with some login credentials let me
just show you we can login that's logged
me in
now this user account is actually a user
account that's based on my PHP v4 and
this is my user here so what essentially
I have done is installed a forum then
created a login script externally that
allows me to log in with the same
username and password that I've
registered inside my PHP be database now
obviously this is just a database I've
set up for the purpose of this tutorial
a note that we have a database here
called pH BBB I've named it pH BBB and
inside we have all the relevant tables
associated with a PHP ve set PHP BB
setup and the one we're going to be
looking at the only one we're going to
be looking at for the purpose of this is
pH BBB underscore users now your your
tables may not be called PHP PHP BB
underscore that's just a prefix that I
have set I think it's the default prefix
but obviously whatever your table or
database and tables or database are
called you can just work with that and
change that for the purpose of this
tutorial so our code is inside here
we've got three main files we've got the
login page this is the entire login here
and we've got the form at the bottom
it's going to be a self self submitting
PHP script or form rather we've got our
main which shows if the user is logged
in this is a pretty simple bit of code
and then we've got just a logout page so
when it's a functioning as a as a login
would and but we're taking user names
and passwords from our PHP BB database
so I'm just going to pause the video
blankies and we're going to start coding
okay so I've blanked these files and if
we go into our page here we refresh you
can see we've got nothing so we're
basically starting from scratch now just
a bit of directory structure advice
inside the file inside the folder where
I have my three files you can see
opening context I've got the folder
called forum now obviously you can call
this anything you like but you need to
know the directory name and we click and
we've just got our files for our PHP BB
setup directly inside this folder so
just make a note when you're following
this tutorial keep track of your
directory structure because mine is
going to be different to yours most
likely
okay so let's jump straight back into
context now the first thing we're going
to do is obviously open our PHP tags we
are going to do a few setups now we're
going to be using the header function in
PHP so what we need to do is we need to
use our Ruby start command to let us use
this and if there are if there is output
before this command because you will
receive an error if you have HTML or
string output before this command we
also need to set up our sessions
obviously we're going to be using logins
you can use cookies you're welcome to
use cookies I'm going to be using
sessions for the purpose of this
tutorial and we need to connect to our
database so obviously this is quite
important and obviously this is what you
need to take into account when
connecting to your own database so we're
going to say MySQL connect
and we're using three parameters first
one is the host so the local host root
is my username I'm using and I don't
have a password for this as it's local
and then we're saying MySQL select
database so select DB and obviously
let's jump straight back into our my PHP
myadmin
we're going to come up and we're going
to see that the database is called PHP
BB that's I've named that and installed
it into that database so we can just
call this PHP BB and then I'm just going
to stop as usual I set up an error thing
so could not connect to the database and
we're going to use or and then the died
function after this with that error
inside it and so if we get any
connection problems down we're going to
kill the script because the script is
not going to run without connecting to
the database okay so the the way this
works is we need to open a file inside
our PHP BB setup so if we go open you
can see here I've got the forum folder
I'm going to click on that and in inside
includes we have a file called functions
PHP now functions PHP is obviously
everything you're going to all the
functions that are going to be sort of
included inside PHP B they're going to
use these functions so you know we need
to include this I mean I didn't just
know this off by heart you need to have
a little research through these files to
see how we're going to take the login
the login process into consideration
first of all I want to point out that
inside the database if we were to scroll
through remember we're inside the PHP B
PHP BB underscore users table and if I
was just scroll along you can see my
username and username clean here that's
my username username clean just a word
of warning is a lowercase version of the
username so if you were to create a
username with a cow
Talay here it will display be displayed
with a capital A here and using them
clean would be as small in my case it's
just Alex and all lowercase so this
doesn't matter but we're going to be
using this username clean that's really
really important that we do that if we
scroll along again we can see user
password now looking at this password it
doesn't seem like a method of encryption
it doesn't seem like a password hash
we've come across before in actual fact
this is a self hashed by PHP BB they
have their own encryption algorithm that
encrypts passwords and then has a method
to decrypt them as well so we're not
using md5 here if we were using md5 it
would be a whole lot easier but we're in
fact using a their own methods so we're
going to need to find a way to do this
and that's why I suggested we open the
PHP BB functions PHP inside the includes
folder so if we open this and have a
look I'm going to search for this is how
I initially found it I'm going to search
for hash I'm going to say from the top
I'm going to click find I press f3 to
find my way down and you can already
start to see we've got a function here
which is called PHP BB underscore hash
and then we're feeding this this is a
function we're feeding this the password
parameter so we're feeding in a password
and then this function inside is going
to hash the password so if we scroll
down a bit more just a word of warning
this hash is always going to be
different it hashes the password
differently each time so what's
happening here is we can't hash a
password that's provided and then
compare it to a password already in the
database that's not going to work so if
we come down we can see here that we've
got a function called PHP BB underscore
check underscore hash and we've got two
parameters here we've got password and
then a hash so presumably this function
is going to take a plaintext password
and it's going to take a password hash
and it's going to compare them so really
we've got an easy ride this function is
going to do everything we need already
we don't need to
sort of you know mess around with
anything else this is going to do it for
us so we've got a function that's pretty
easy to use already so what we need to
do is obviously include this functions
PHP inside our login dot PHP script so
I'm going to say include functions PHP
PHP BB o
functions PHP okay so we've included
that script or rather commented to
include it what I'm basically going to
do is set include forum includes
functions PHP and we can even say
require because it is required okay so
we've got this script in here and now
and we're going to test this just to see
if it's included so we're going to run
this page here let's just refresh right
okay so failed to open stream look here
maybe get rid of that leading starting
slash okay yeah so that was my fault
directory structure fault okay so we
have included that presumably it's been
included successfully but what I'm going
to show you now is I'm going to echo out
just output just a test now if I come
back to this page and refresh now surely
we're expecting to see this output here
and we don't have an error for this so
this has been included correctly so why
isn't this being output I mean we can
refresh all we like and this is a
problem I came across and it took me mmm
quite a while to figure out why and the
reason being is if we scroll up to the
top of this page we've got a function or
rather an if statement here with this
defined in PHP BB thing so if it's not
defined in PHP BB then we're exiting the
script so this is pretty
self-explanatory it's basically saying
if it hasn't been defined within PHP BB
itself
then terminate the script we're exiting
this page so what we need to do is we
need to use block commenting and if you
don't know how to block comment it's a
forward slash star and then a star and a
back slash a forward slash to end we've
commented this at all so now what we're
going to do is presumably this script
now that we've included says it can be
included anywhere it doesn't have to be
included in PHP BB and then we are going
to get this output so let's refresh and
we have our output so it's just things
like that you need to take into
consideration and have a look for if
you're debugging if you're having any
problems any errors you just need to
have a look for things like this because
they do crop up now and then and you can
spend hours trying to get your head
around it when it's actually a
relatively simple thing to fix ok so we
can continue from this our output is
working and obviously what we need to do
now is come down and create our form so
this is just going to be the form to
login and like I said we're going to say
the action is going to go to the same
page so it's a self self submitting
script and we're going to use posts
because we're submitting password and
username data ok so I'm just going to
set up a basic script nothing special
and obviously not taking the design into
consideration I'll leave that up to you
so we've got input type equals so the
type for this is going to be text and
the name for this is just going to be
username we can paragraph down
we've got password break down to a input
type and that's going to be called
password and obviously the type is going
to be password so we get the Stars and
let's start out another paragraph break
an input type submit button the name
we're going to call the login so we can
check it it's been pressed later and the
value of there I'm just going to say
login that's what's displayed to the
user ok so if we refresh our page we can
see that we've got our username and
password up here we can type whatever we
like into hit ok so now what we need to
do is we need to check inside our PHP
script if this has been
submitted if it has we're going to run
this block here inside curly brackets
and that's dollar underscore post login
remember you know how to use the post
variable and login is the name of the
button presuming that I has been pressed
this data will be forwarded back to this
page okay so what we need to do is now
get the form data so I'm going to say
username equals dollar underscore post
username and we have the password or
password and that's dollar underscore
post need to really slow down yeah I
don't need to slow down and that's
password now we're obviously going to
take a few security issues into
consideration here and we're going to
use the add slashes and the strip tags
and to what strip tags first so it's
strip underscore tags basically what
this does is it strips any HTML data
that could be of a threat to your script
to your database and it strips that
straight out of it so it's strip
underscore tags and then we're just in
closing this in rounded brackets I'm
also going to use the add slashes and
there's no underscore this time remember
to enclose that whole thing in brackets
so we basically have a function inside a
function and this what this does is it
adds slash it adds slashes where I
believe it's just inverted commas and so
apostrophes it adds a slash to them so
things like SQL injection are I'm not
sure if it's impossible but much harder
to execute SQL in injection now the
other thing we need to do is remember I
said earlier when we were looking inside
our database we have a username clean
row this is a lowercase version now
obviously if you have a lowercase
version inside the database and the best
thing to do is would be to come back to
here and say STR to lower to
create a lowercase version of the
submitted username so we can check it to
the lowercase version of the stored
username it just makes things a lot
better and we're going to be able to
match a username a lot more easily if
you've got it if you've got something
like this inside the database it really
really helps when you're using sort of
validation to check of the users first
of all in the database and then select
records via that via that user record ok
so that's pretty much done we've got a
security setup we've got our username
and password and posted we're going to
shove a bit of validation here I'm just
going to say if username doesn't exist
or password doesn't exist I'm just going
to echo out to the user and please enter
a username and password and I'm going to
put a paragraph break just for display
purpose and otherwise we're going to
start up a block with curly brackets and
the rest of the code is going to be in
here so first of all they have to have
entered a username and password now what
we're going to do is find the username
so we're going to check that the user
does exist first of all I'm going to set
up a variable called find and that's
going to be my SQL query so we're
setting up the query to search for this
username and I'm going to say select
star from PHP BB underscore users where
username clean not just user name equals
user name so if you didn't understand
before why we've used this STR to lower
this this posted could be in capitals
what the script is now done is converted
it to lowercase and then it's checking
the lowercase version inside the
database so nothing really can go wrong
here ok so now what we're doing
obviously to find the username and if
this has returned a result that means
the username has been found if it hasn't
returned the result and what we're going
to do is we're going to check for that
so we're going to say MySQL num rows so
if MySQL num rows will find equals 0
remember the double equals it's the
comparison operator then we're going to
say
user name not found and basically what
this does is if this like I said before
if this is returned a row then it's
going to be bigger than zero if it if it
doesn't return a row it's going to be
equal to zero so we're checking if no
rows are returned then presumably we
don't have a user in that database so
otherwise if the user does exist and
we're going to use a a while loop you
don't have to use a while loop you can
do it other ways but I'm going to be
using a while loop and we're going to be
using a while loop to basically check
the password hash inside the database
just to retrieve that data that's all we
need to do so I'm going to say well find
row equals mysql fetch associative array
I'm sure you've seen this before if not
you know have a look at my other
tutorials and we're using the find query
there and obviously we're going to open
up some curly brackets we don't actually
need to but I'm going to be using
comments inside here and we're going to
grab password hash for user and this is
going to I'm just basically going to
call it password hash and be careful
when you're naming these don't don't
just call it password because obviously
we've already got a password variable up
here password hash equals find row
vermin but we're using find row here the
same as this and that is let's look
inside the database use the underscore
password so we can come back here say
user underscore password so presumably
that what that has done now is then this
area is going to be for the rest of our
code presumably what this has done is
grabbed the part it uses password what
you can do is just along the way test
things so we're going to say echo
password hash and this is basically
going to give us a little idea of how
math script is running so far obviously
I haven't checked things along the way I
tend to do that nowadays right let's
refresh just to check we haven't got any
immediate errors no we haven't okay so
I'm going to type a completely you know
rubbish name into here nothing to do
with it and it's silly ah
leave the password out let's click login
please enter username password so we've
got that validation up and working now
what I'm going to do is I'm going to
type a username that doesn't exist and
the password and we have user name not
found let's just come in here and this
is being picky I'm just going to say
paragraph break on there just to even
out ok so now I'm going to type Alex and
I'm going to type a wrong password in
okay so my password hash has been echoed
we have no nothing to compare the
passwords at the moment so therefore
we're just definitely out a password
hash just to check that everything's
working ok so what we're going to do
next and if we go down we can get rid of
this echo password hash the next thing
we're going to do is we're going to
check the password hash using the
function inside function at PHP that we
included up here so if we go to
functions dot PHP I'm going to again
search for I know the name of the
function so I'm just going to search for
it's a PHP PB underscore check under
Scott hash and here it is we can
directly use this function now because
we've included it inside this login
script so what I'm going to do is I'm
going to create a new variable called
check and that is going to be my sorry
PHP BB underscore check underscore hash
and obviously now we've got our password
that's been submitted and we've got our
password hash remember I said inside
here we've got the password here which
is the plain text password and the hash
here which is obviously the password
hash so password comma password hash now
obviously this this is the password
that's been submitted if we see here
we've got password and then password
hash here is the password the hash that
we've just found from that row in the
database or that record in the database
so how are we going to check if this
part if this has returned saying that
the password is correct and the reason
being is big
this returns a true or false value so
it's very easy to check now we can check
it by just saying if check equals equals
true and what I'm going to do is say
equals equals false for now and because
I'm going to put the error before what
we're doing so if it does equal false
then we're going to say echo and
incorrect password' and then I'm going
to say else if check equals equals true
execute some code now the reason I've
used an else if and then done another
comparison here with a cup with an
equals comparison operator is because if
for some reason check does equal
anything else than false then we're
going to still let the user in we want
check to return as true now if this
returns an error for example if this
function returns an error we're still
going to be logging the user in so we
need to use else if check equals true so
we're basically doing another check
button but using an elf elf elf else as
well so presuming that they have logged
in and the check for the password is
true using this function here PHP BB
check hash then we're going to log them
in so you guys should know how to do
this and if you don't we need to set
session and I'm just going to set it as
user name and step that equal to
username so if Sal username remember up
here we've got our session start and our
session username equals user name so
we've set that session there and then
what we're going to do is we're going to
say header location and we're going to
locate to main dot PHP and underneath
we're just going to exit so this script
is completely done now the login dot PHP
script is done and the main file I'm
going to do in the next part of the
tutorial but for now what I'm just going
to do is write success in here obviously
anyone can access this main dot PHP at
the moment but we're just going to be
testing out this script and see if it
works now okay so what I'm going to do
is I'm going to just come straight back
to this or every for the post
data is gone I'm going to type my
username and I'm going to type a wrong
password so I've just scribbled a load
of rubbish in there and I'm going to
click login okay so we put in correct
password I know this is really silly I'm
just going to add a paragraph break
there okay so I've got an incorrect
password that's been submitted
now what if I correct do the correct
password my password is PHP academy' so
I've typed that in I'm going to click
login and we've been redirected now
presumably now that means that we have
successfully checked the username and
password via the registered users on our
PHP B forum so essentially what we've
done already is we've done exactly what
we wanted to do in the first place and
we have successfully checked a user
that's registered inside our forum and
we've used that externally so in the
next part of the tutorial I'm just going
to be going through and just touching
everything up and finishing it off it's
not necessary you do watch this if you
know where you're going from here then
feel free to carry on but if you want to
create the whole sort of little package
and then you know have have a look at
part 2 so I'll see you then bye bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>