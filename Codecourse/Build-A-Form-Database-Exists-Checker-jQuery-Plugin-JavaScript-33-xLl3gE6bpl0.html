<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Form Database 'Exists' Checker jQuery Plugin: JavaScript (3/3) | Coder Coacher - Coaching Coders</title><meta content="Build A Form Database 'Exists' Checker jQuery Plugin: JavaScript (3/3) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Form Database 'Exists' Checker jQuery Plugin: JavaScript (3/3)</b></h2><h5 class="post__date">2014-09-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xLl3gE6bpl0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so now it's time to build the plugin and
obviously our page markup so we can
actually test that this works so the
first thing that we're going to do is
just build the form out just so we have
the structure there that we need to test
this so I'm gonna create a form here
with a post method so we've got a action
which is where your form will be
submitted through to to sign the user
app or do whatever you're doing in this
form and we've got a method of post here
this here has got nothing to do with the
jQuery plugin this can be yet which it
wouldn't be if you were submitting a
signup but you get the picture this
doesn't really matter this has no sort
of relation to the actual checking of
fields for existence in the database so
inside of the form we're gonna create a
div called form field and this is purely
just to split up both the form field so
this doesn't sit in line you might be
using a front-end framework or something
to put together your forms whatever it
is I'm just using this to separate both
of these out so within here we're going
to contain the user name and the other
one we're going to contain the email so
what I'm going to do is create a label
here and this is going to be for user
name so we'll name our field with an ID
of user name and in here we'll just say
choose a user name so that looks like if
we just head over to our index page that
looks like that so after this we need
the actual input itself so we have an
input with a type of text the name is
going to be the name that submitted
through to signup dot PHP again this is
nothing to do now plug in the ID is
going to be user name essentially so
when we click on this label here this is
ready to input oh by the way I'm just
going to turn autocomplete off of here
just so we don't get suggestions pop-up
and more importantly on our input we
want to add a class and this is the
class that we're going to identify or
select and then apply our plugin to so
I'm going to call this check exists you
can call this anything you want it
doesn't matter what I'm then going to do
is use a data attribute to supply or
sort of specify the type of this field
remember that's the same as when we do
let me just duplicate this when we do
this so type equals user name we already
have this functionality so that is the
type that we're going to send through to
that file and what we then want is we
want a span element at the end of this
with a class of check exists feedback
now I'm gonna hard code this selector
into our jQuery plugin so you might want
to change this around and add this just
it's a little bit more flexible you'll
see what we mean later but either way
it's going to work for now it just might
not be entirely flexible and we're gonna
have the same data type a data attribute
on here so we can pinpoint this specific
span in order to enter some text so
essentially this will inject text into
here so only it will be something like
that is not available or whatever you
want to enter in there and that all
looks like that so we've got that now
for our username what I'm now going to
do is just duplicate this form field div
with everything contained inside of it
and I'm gonna say into your email and
then here we're gonna give this a name
of email email email so basically just
replacing everything so really then once
we finished our plug-in if you want to
create a new one you just have to
duplicate and it will just automatically
work that's our sort of goal here and
then I'm gonna have an input type of
submit with just signup this is you know
this is a useless button we're not gonna
be building this signup page so now
we're at the point where I can start
typing my user name in I can start
typing my email address in but now we
want the functionality to as this is
being tight we're gonna set interval to
hit with an ajax request
check PHP page sending this data and
then we'll report back to the user
whether this exists or not so the first
thing that we need to do is load in
jQuery so if you head over to Google
hosted libraries you can just quickly
grab a copy of this from served from
Google's content delivery network so I'm
going to load in version 2 here I'm
gonna copy this and I'm going to at the
bottom of my page just before my ending
body create a script element with a
source attribute and I'm gonna paste
that in now this means serve over HTTP
and HTTPS depending on which protocol is
used but I'm gonna change this to HTTP
it since I'm working locally but you
might want to keep it as just the double
forward slash now what we also want to
do is include JavaScript file of our own
so let's create another script element
with a source attribute and we need to
create this javascript file typically
these are found within a J's folder or
something like that so there's my Jas
folder within the directory I'm working
in and I'm gonna create a new file
within this and I'm gonna name that main
Jas you might want to call this as
something like exists check dot exists
chip dot J query J s in fact we could
probably do that if we wanted to to be
honest and this would be our sort of
plugin file that we load in and then
down here what we're going to do is
we're going to activate this plugin and
you'd want to do this in a separate file
as well your sort of main JavaScript
file so we've got our file specifically
dedicated to our plugin and then we've
got our scripts it on page here which
we're going to use to actually activate
this plug-in so let's just quickly load
this in so exists check jQuery j/s and
just to make sure this is loaded in if
you really want to check you just do a
console log of one and then refresh now
I'm going to be using the console very
very sort of closely in this video as
well as the network tab as well so we
can see how many requests are being made
to our check page as well as actually
checking what
been sent with them requests and you can
see in the console we're logging one so
we know that that file is loaded
improperly so the first thing to do then
is just start to build out the plug-in
and then we will use it on the elements
with a class of check exists and we'll
just take it from there so let's start
to build this plugin then now jQuery has
a function object which allows us to
create a new function if you like which
essentially would be a jQuery plug-in
because what happens is when we extend
sorry when we do a selector for exists
check exist yet check exists and when we
do not something this returns the jQuery
object which then in turn has access to
the function object so we use dollar two
which is basically just a shorthand for
jQuery object and then we say dot FN and
then we give out plug-in a name so I'm
going to call this exists checker and
this is going to equal a function like
this and then we just end that down
there
so there we go so this is now our
function if I was to do a console log of
one in there and I was to say check
exists so check exists here and check
exists here these are both classes on
both of them inputs dot exists checker
exists checker then that's then gonna
console log because we're making use of
of that plug-in however what we're not
doing is we're not applying this to both
of these elements so what we actually
need to do inside of our plug-in is we
need to return this dot each and then in
here we have a closure and then we do
all of the code in here that relates to
checking and that means that this
applies to both in fields so when i
refresh now you can see that this little
circle
a to in which means that this has been
console.log twice one for each of these
fields if for example we would have a
third field so if I would just paste
that down there that does it three times
but we're not going to do that we'll
just have to so now that this is being
run for each of them field we can start
to write out the code that we need now
we're going to be storing an interval
because what we're going to do is as a
user is typing we're going to start an
interval which is going to check every
two seconds for the data and it's going
to send a request every two seconds only
if that data has not changed so this
means that instead of making a request
to our back end every time user hits a
key we're just going to do it every two
seconds as long as the value doesn't
remain the same and this just means that
we send slightly less requests to our
server and therefore it's more likely to
be a little bit quicker so I'm going to
store the interval here and we'll look
at this more in a minute if that doesn't
make sense so we're gonna say this which
refers to the object that we're
currently selecting so this basically
this in here refers to ease in this case
it's this and this so we're gonna say
this dot on and we're gonna add an event
handler here so on key up we're gonna
run whatever's in this function so if I
just do a console log here and I just
say typed or I'll just say key up then
every time now I type something in here
you can see that that's being added to
that's console login key up so I can
keep typing can keep typing here and you
can see that for every time I type that
is running that function so obviously if
we would send an ajax request to the
server
every time we pressed a key you can
imagine now we would have sent 29
requests which is ridiculous
and this is a lot of a lot of these
tutorials that teach doing this actually
do take that approach which is quite bad
so what we're going to do now is we're
going to grab all the information
related to what we've type what the
users
pipe then we'll start to set the
interval but the first thing I'm gonna
do is I'm gonna store this as self I'm
going to store another variable and I'm
comma separating these here rather than
doing VARs on each line it's entirely up
to you which method you take I'm gonna
say it self type now how do we get which
type this is so for this one as the
jQuery plugin looks at this one we know
that the type is a username we've
defined that using a data attribute a
jQuery gives us a handy data method
which allows us to pull in this really
easily so I can just do self dot data
and then I can defer data sorry and I
can define that to data type it's a data
type so let me just do a console log on
self type and refresh there we go so
we're just outputting username when I do
it in here we're outfitting email so we
know that we for each of these have the
access to the type now we want the value
which is a little bit easier to
understand so we say self value but
we're not going to be storing that just
yet we'll store that within the interval
itself and that'll become clear why
we're doing that later on but we are
going to define the variable up here
because we define define all of our
variables whether or not they have a
value at the top of each function that's
just best practice so we now need to
define where this feedback is so the
feedback is that check exists feedback
class with a specific data type so in
here we're gonna do a selector we're
gonna say check it exists feedback and
in here we're gonna say data type equals
and then in here we're going to
concatenate on the data type oops so
these need to be single quotes like that
so in here we're gonna say self type so
now this feedback is a selector j.crew
selector for the feedback
L
so now what I can do to test this is say
feedback text 1 so that means that for
each item I type in you can see one just
appeared there and I can do the same
here one just appeared there so we know
that that works now and there are
probably much better ways to do this you
could even pass options through to your
plugin to define what the class name is
here because technically this is bad
practice we're hard cutting it in I'll
leave that up to you to go ahead and
change this maybe to make it a little
bit more flexible if you wanted to
change the class name within your markup
you would have to modify the plug-in and
I'll purposely leave that in for you to
go and refactor it still work still
works fine but you can go ahead and
change that so now what we want to do is
actually look at starting this interval
so we're going to create an if statement
here to check if the interval is
undefined because what we don't want to
do is keep creating an interval every
time a user keys up so we're gonna say
interval Tripoli cause for type of
comparison undefined so if the interval
is undefined we then want to set the
interval remember if it's not defined we
don't need to reset the interval because
it'll already be going and if you're not
too sure a JavaScript interval is just a
function that will run every amount of
milliseconds that you give it so for
example I could say well I want a
function to run 100 milliseconds which
is obviously a tenth of a second so
we're going to assign interval remember
we applied this up here so we're doing
this outside key up because we don't to
keep redefining this here so interval
equals set interval and set interval
we'll take your first of all a closure
which is just a function here and as its
second argument we'll take the amount of
time you want to or the interval
basically so I'm gonna say two thousand
minutes milliseconds milliseconds which
is two seconds so here what I'm going to
do is I'm going to console.log let's
console.log something out like self dot
value this is remember this self value
here which
store inside of here in a moment either
way just know that this gets the value
of what you've typed inside of one of
these boxes so in here we're gonna say
Alex and you'll see that interval is now
started and every two seconds it's
console logging that value so we're
going to use this if the value hasn't
changed to do an AJAX request to the
server and it's the same for this value
here as where if I was to type Alex at
code cost comm you can see that that's
now console logging that value out and
it's also doing that first one as well
it's simultaneously checking but at the
moment if we were to leave this as it is
and do an AJAX request would be just
constantly polling the server for this
value now why would we need to
constantly poll for the same value it's
pointless if alex has typed there and
they've not changed anything since the
last interval then we don't need to send
the request again because nothing's
changed so inside of here we want to say
let's just pull this down a little bit
if self value doesn't equal self dot Val
now that might seem a bit confusing at
the moment but inside of here what we're
then going to do is set self value to
self dot Val so what's gonna happen now
is down here we can do our Ajax request
so if I were to do a console log of self
value here let's now see the difference
between what we've just seen I'm gonna
type Alex in there you can see that's
gonna send a request or we're not
actually sending an ajax request but
that's console of Alex now what's
actually happening is in the background
we've still got the interval running
every two seconds it's only if I change
the value that it does another request
if I get rid of it it's now gonna do
another request but we are going to
prevent against that because we want our
username to be more than two characters
so three or more characters long so
we're now more efficiently sending a
request to the back end rather than
doing it every single time the user is
typing or putting a key down so let's
get rid of that console log hopefully
that makes sense now let's save a little
if statement here to check
length of the value so self value dot
length we need to make sure that's
greater than two so only if the value is
greater than two we're actually gonna
send an ajax request to the server
because i mean you can change this
around yourself but really depends on on
the requirements of your username so now
that we've done that we're actually
gonna do our Ajax request so we use
jquery's Ajax method and we pass an
object in here and this has all sorts of
things like callbacks properties that we
send along etc so the first property
that we're going to define is the URL
that we want to send the data to now we
know this is check PHP we know that we
need to send a type and we know that we
need to send a value in order to
determine whether that username exists
or not so let's type in here check PHP
so we now need to define what we don't
need to but we can define the type of
request in this case it's going to be a
get request remember we're picking
values up using the get superglobal and
we again don't need to because jQuery is
clever enough to do this but we can
define the datatype that we're expecting
back from the the request in this case
I'm going to define that it's JSON but
it should pick this up if you if you
don't supply these I always like to
supply these because it's easier for
other developers or yourself in the
future to see what kind of requests
you're sending and which kind of data
you're expecting back and now we want to
define actually the data that we're
sending along so I'm going to pull this
down a little bit and I'm going to send
along the type this here is what we're
expecting here so tight we know the type
we know that that's stored in self type
up here so we can just say self type and
then we come a separate and we say value
self value easy as that and that's again
it's here so as long as there was a
successful request to this a callback is
called and we run this function now if
the request failed for any reason we
have this error callback so
something went wrong and you can handle
that in your own way I won't I won't do
anything here and if it does fail it
will just silently fail and I don't
really see a problem with that because
at the end of the day the user will just
then submit the form and then get your
back-end validation working anyway so
success what we also additionally have
within this callback is an argument
called data or not called data but we're
going to call it data so let's do a
console log on data and this is re-entry
start to see our code working we've got
our success callback without data let's
check that we get that exists back from
the server like we've seen here so let
me choose a user now I'm gonna type in
Alex we know that that doesn't exist
we know sorry we know that does exist so
here you can see that we've logged an
object remember I said earlier that when
we pull this data in because it's a data
type of JSON jQuery will automatically
parse this for you traditionally we
would have to do json dot pars and then
pass in the data and maybe just reassign
that or something so he got the object
but jquery is automatically parsed this
and now you can see that we're getting
this object so what I can actually do is
I can then access this exists key here
or property so that's his exists true
what happens if I add more this it says
exists false so if we're getting this
feedback here which we can then use to
add a little message on the end they're
the same of the email as well if I just
start typing Alex at code course comm
you can see that that says exists true
so I could then go ahead and maybe
change that and then we get exists false
so we're doing our requests now for all
of that data we've only made one two
three four five requests to the server
which isn't bad at all and it appears
that everything's working so we've now
successfully tied up our back-end to our
front-end but we're not quite finished
there because we need to apply this
feedback text so in here we first want
to make sure that the exists property is
available so remember this here we need
to make sure that is available first of
all so we just do data the
exists a reason the dot notation to
access the exists property and we're
gonna say if that's not undefined simple
as that so does that does that exist
property exists and then if it does we
can just say if data dot exists equals
true so if that's true then that means
that the username or email or whatever
other field that you're using this for
is taken now we need to set this
feedback text here next to this we
already have a selector for this up here
remember so all we need to do is say
feedback dot text already taken simple
as that
otherwise we're going to assume that
it's available you might also want you
might want to do an if sorry an elf else
if here and say else if data exists
equals false but we can safely assume
that if it's not true then it is gonna
be false so I'm just gonna leave that as
an else so feedback dot text that is
available so we've already seen this
working so it's nothing new but now when
I type in Alex it says already taken I
can change that to dial that is
available you'll notice we've got a very
slight delay on this that's just because
we have that two-second delay depending
on how you're accessing your data and
your back-end maybe it's optimized with
some kind of indexed service you could
change this to maybe shorter
however you know net in your network tab
you can keep track of how many requests
are being sent by the way if I was to
type that and it says already taken
let's go over to xhr here and then our
filter you can do all if you want but
this just filters out our Ajax requests
then you can see that we're perhaps
making a few more requests than we
really need so if I was to start typing
here then in total for these two we've
made quite a few requests it really
depends as I said on on how this is
some houses set up and there probably
are better ways to detect whether the
users finished typing but really for a
very small project like this it's with
not very many users and by that I mean
thousands it's you know it's fine okay
so we have now actually finished
building this functionality and the best
thing about this is its flexible so I
can I can work with a username field I
can work with my email field as we've
seen here and then the user can hit sign
up and remember you've got your back-end
validation on there as well so that's
how we check if data exists using an
ajax request and we've built a reusable
jquery plugin</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>