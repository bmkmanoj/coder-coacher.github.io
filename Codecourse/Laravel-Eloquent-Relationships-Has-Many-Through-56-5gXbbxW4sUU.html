<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel Eloquent Relationships: Has Many Through (5/6) | Coder Coacher - Coaching Coders</title><meta content="Laravel Eloquent Relationships: Has Many Through (5/6) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel Eloquent Relationships: Has Many Through (5/6)</b></h2><h5 class="post__date">2014-08-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5gXbbxW4sUU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so so far we've only looked at the
basic relationships now we're going to
look at something a bit more advanced
it's called the has many three
relationship and we're going to get into
that a bit later but first what I'm
going to do is I'm going to refactor our
code a little bit so what I've done
instead of having an address table with
the country column have changed it to
countries and I've removed the user ID
column and instead what I'm doing is
referencing that country in our users
table through this column here so
hopefully that made sense now if we go
to our browser we're getting this error
here so we need to take care of that so
let's create our country model country
dot PHP class country extends eloquent
and in user we need to change this
address here to country and all we need
to do is change that class to country so
now we can do user country name hit
refresh oh whoops
we're using the wrong relationship so
here we're using has born we need to
change this to belongs to just like we
covered in the first video so hit
refresh and we're still not getting
anything
a referencing country named countries oh
okay so let's rename this to name okay
so hopefully there we go we get our
country let's try Alex yet everything is
working fine okay so what I want to do
is I want to be able to go to something
like country and then United Kingdom
this is the ID for the for the United
Kingdom country and I want to display
all posts made within that country but
that's going to be extremely difficult
because if you think about it if we go
to our articles table we don't have a
country ID field or anything like that
so how are we going to do this well
let's create a country ID field and
let's fill this in
so hello world was posted by Terry so
what country is seen he's in the country
with an idea of one so let's fill that
in and Alex was in the country with the
idea of two so we could do it this way
and that would make things much much
easier but that's gonna still going to
be extremely impractical because what if
we use a moves country then we'd have to
find all of his articles and change
every single record so you know what
scratch that let's get rid of it the
must be in the easier way to go about
doing this and look Lee there is so
there has many through relationship so
before we do this let's get our roots
and everything set up so root get and
I'm going to modify the URI a bit a
little bit I'm going to say root get
posts country ID country ID pass in our
closer there so first things first I'm
going to get the country using our
country model I'm going to say find a
fail country ID and then we're going to
return you make country with country
country and I'm going to make this a bit
more explicit country posts so country
paused stop play whp
what we're going to do is go to our
previous articles view and I'm going to
copy this and what I'm going to do all
the way up here is I'm going to say head
of one and I'm going to say country name
and let's get rid of this fun now
because otherwise we're going to get an
error so unexpected okay we forgot a
semicolon
so let's change this to posts country 1
and we're getting an error let's change
this here and there we go so let's just
quickly change this to posts made in the
and we'll get rid of that so post made
in the United compared Kingdom change
this to 2 and we get United States
perfect so that's all well and good but
how are we going to get our country's
articles much more simpler than you
would have thought so in our country
model I'm going to create a public
function public function articles and
I'm going to return this as money
through now the first thing that we want
to do is provide our article model
because that's what we're trying to
retrieve we're trying to get the
articles next thing we're going to pass
in or be our user table and that's
because I will use a table is the table
that contains the country ID so pass in
our user table and as our third argument
what we want to do is pass in the column
name of the country ID which in this
case is simply country ID and finally we
want to provide the the column in the
articles table a virus it articles which
references the user so it's user ID so
if we paste our markup back in and hit
refresh I getting an error we need to
change this to country articles we'll
get rid of this that was for something
else hit refresh and there we go
so because Terry is in the United
Kingdom we're getting all the posts made
by him and let's let's annoying me let's
change that to h3
all the posts made by Terry since he is
in the United Kingdom and if we go to
the United States we're getting all the
posts made by the users in the United
States which in this case
simply Alex</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>