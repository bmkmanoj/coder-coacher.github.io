<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Social Network with PHP: Accepting friend requests (22/37) | Coder Coacher - Coaching Coders</title><meta content="Social Network with PHP: Accepting friend requests (22/37) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Social Network with PHP: Accepting friend requests (22/37)</b></h2><h5 class="post__date">2015-08-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HqdfUbzZYEs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">of course now that we've added a friend
we need to be able to accept a friend
request and we have all the methods on
our user model already there to do that
and we've built these all out so we can
just use them within our friend
controller so we need to create a new
method inside of this controller to
accept a friend request we need to
create the route for this and then we
can link up our buttons on our profile
page so we have a get accept method here
and that's going to take in a user name
and before we do anything here let's
just die dump the user name again just
to make sure this is working then head
over to our routes
I'm going to copy this paste this in and
we're going to say friend
accept user name rather than friend add
user name so we're going to change the
name of this to friend accept and we can
hook this up on our profile page so here
is our accept friend requests button we
can just change this over to route
friend accept and we obviously need to
pass in that user name here and that's
user user name so let's check this out
we have our friend request sent and
we're waiting for dell to accept it over
on our other user we now click accept
friend requests and that's going to out
of course we didn't change over the
route method here so that we get accept
instead that's why it went through to
that so again we can come over here and
we can accept the friend request and we
see Alex so the whole process now if
we're over and friends we see our friend
requests we click on this review this
profile we click accept and then we
actually accept the friend request and
then we come become friends which we've
already seen in our list so to actually
accept a friend request like I said this
is pretty straightforward all we need to
do is the same here we grab the user so
we can actually copy and paste this line
down just to make our lives a little bit
easier and again we want to check if the
user can be found or not so we are
having a lid
duplication here but you can implement
you know protected or methods on this on
this controller to check this if you
want to now the next check is whether
we've actually received a friend request
from this user because we can't accept a
friend request from a user we haven't
received a request from that makes sense
so we're going to use the has friend
request received method that we added
here that will check our friend requests
for that particular user and then we'll
know whether they have sent us a request
or not otherwise we would be able to
accept friend requests from people who
haven't added us so we're gonna say if
not or user and then we use that has
friend request received method we pass
in that use that we've just pulled in we
just want to return and redirect back to
the home page we don't really want to
display a message we'll just kick the
user off somewhere cuz they're obviously
trying to do something dodgy at this
point now otherwise we're ready to
accept the firm request so we say Earth
users The Comedy authenticated user
accept friend requests passing in that
user remember we have our accept friend
request method just here and then after
we've done that we can return back to
the profile page and say you've accepted
their friend request so we can return
redirect and we'll do this on a new line
to a particular route which is profile
dot index passing in that users username
so we land on the right profile and
we're going to display a message so
we'll say friend request accept it and
there we go so we're done so let's check
this out then or obviously waiting on
this one and this has a friend request
we're going to click accept and ok so
we've got an error
just check this out line 69 out of
course missing her ending semicolon so
let's go back to here
go back again and we're gonna click
accept
and there we go friend request accepted
so we've now on Alex's profile and we
see Alex's friends over here we're on
Dale's profile and we see a list of
Dale's friends and we see you and Dale
Guerra a friend obviously and here you
see you and Alex Guerrero friends so we
have now successfully accepted a users
friend request we can test this with
other users as well so for example let's
just go over to my profile and I'm gonna
add Billy as a friend so I'm going to
search for Billy well obviously not
friends so I click add as friend I'm
waiting for that request let's just sign
out of Dale's account here and we'll
sign in as Billy and we go over to our
friends list here you can even show
something on the home page if you wanted
to and you see firm requests so I click
on that a view Alex's profile I accept
and there we go so now alex has two
friends Billy which is myself here in
this browser has one friend and we have
this problem here which is button
showing add as friend so we need to fix
this up now so what we're gonna do is
we're just going to modify our profile
here you see we've got this else
statement here what we're gonna do is
we're gonna change this into an else if
and we're gonna say if or user ID
doesn't equal the current user ID so we
don't add ourself then we won't see that
so we can refresh here like that so
let's check what's gonna happen if we
are add trying to add ourselves as a
friend so I'm currently signed in as
Billy I'm gonna try and add Billy and we
see waiting for Billy Garrett to accept
our friend request so this is a problem
let's go ahead and delete that record
here so that's three adding three so
it's adding yourself as a friend so we
need to kind of taking this into account
when we're actually adding a friend so
we can add another if statement just up
here and we can say if or user ID equals
user ID we just want to return and
redirect back to the home route we don't
want to do anything because of the users
again obviously trying to do something
dodgy so I'm signed in now on this
browser as Billy I'm gonna try and add
myself as a friend via the URL and that
doesn't work we're just redirected back
to the home page so we can't add ourself
as a friend now so that's it we've done
we've tested this out we've found a few
problems but you fix them up and we can
now add and accept friend requests</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>