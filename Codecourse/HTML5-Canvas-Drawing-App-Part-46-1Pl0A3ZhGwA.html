<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>HTML5 Canvas Drawing App (Part 4/6) | Coder Coacher - Coaching Coders</title><meta content="HTML5 Canvas Drawing App (Part 4/6) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>HTML5 Canvas Drawing App (Part 4/6)</b></h2><h5 class="post__date">2013-10-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1Pl0A3ZhGwA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome back to our
development of this html5 canvas drawing
application so last time we made this
radius control so it made it very easy
for the user to change the size of their
brush today we're going to add a color
palette so it can easily change the
color of the brush so I'm just going to
draw this beautiful woman here
wolf okay so let's have a look at this
so again the mark-up is going to be very
simple so last week I made this this div
tool this tool bar dip sorry
and within that we had a radius div
because that was our radius control I'm
going to do something very similar we're
going to have a color or colors div
within the toolbar and yes I am spelling
cars without the you just cause so this
is going to be our color palette and
within that we want to have multiple
swatches so we're going to have multiple
divs with the same class of swatch close
that I'm going to make about three of
these just to test our styling with and
then I'm going to give one an active
class so if you're not aware you can
give elements multiple classes all you
have to do is separate the classes with
a space and then you'll be able to
reference it by either one so we're
going to open up our CSS file now what
we want to do is so our color palette is
going to be on the right so we want to
say colors float:right and if we're
going to do that we're also going to
need to say radius float:left so right
the ID of RAD that's our radius control
area so we want that on the left this is
on the right our swatches sorry with the
class of swatch I'm going to style these
with a width of 30 pixels a height of 30
pixels I'm going to give them
border-radius or 15 pixels so making
them circles obviously this is all up to
you you can do whatever you want really
with them I'm going also going to a
little bit the 3d effect to it so I'm
going to add an inset box shadow with 0
X offset 1 pixel Y offset 0 blur and 1/2
opacity white so that's going to add
like a little shine to the top and in
fact I might even add a shadow to the
bottom so I'll do a 2 pixel Y 2 pixel
blur I'll make this one black as I say
this is just a soft taste thing so you
can do this however you like what else
we need to do yet we want to change this
to display:inline-block cause at the
moment there block elements which means
they'll have new lines before and after
them and we don't want that move them
all on the same line also going to add a
margin left I'm going to make that about
10 pixels so if we have a look at that
one
so now you can see we've got these three
circles there's no background color on
them at the moment so I'm just going to
the sake of testing going to add a
background color of cyan and then you
can see we have our three little
swatches I'm also going to style that
active one that we set so we have one
that's active and the rest are not it's
the way we select that is dot swatch dot
active now notice there's no space in
between swatch and or active if there
was this would be selecting elements
with the active class within an element
of the swatch class and what we want is
elements with the swatch class that also
have the active class so that's how we
notate that so if I say dots watch dot
active and I'm going to give that a
border just to show that it's selected
border of two pixels solid white and I'm
also going to add a box shadow on this
one core because I've got this border to
show that it's selected but if the
background color is white then we're not
going to see that so we're gonna have an
inset box shadow or I'll do it like this
so a 1 pixel Y offset 2 pixel blur and
I'm going to have it be off pasty black
let's look at that so they go so
obviously each of these is going to have
their own unique background color so we
can get rid of this in the CSS and do
this actually in line so because this is
the background color is going to be the
only thing that's going to be unique
about each swatch this is one of the few
cases where we can justify styling
things in line using this style
attribute so we're going to say style
equals open quotes background color I'm
going to give this one red and then give
these two green and blue so really
boring colors at the moment but you can
see that's working so now let's start
interacting with these in JavaScript so
we're going to add a new script tag
again I'm separating this all out
intercept profile so we've got main
radius JSON call this one colors J s you
could do this all in the same JavaScript
file if you want to keep everything
together I kind of prefer to work this
way but it's up to you of course so
going to create that file what's called
colors which is I think yeah so colors
dot J s the first thing I'm going to do
is add an event listener to each of the
swatches so we're going to say we're
going to set a variable called swatches
I'm going to set that to an array of the
swatch elements so do that by saying dot
get
elements by so a.classname swatch as i
say that's going to return an array of
all the elements in the document with
the class name swatch and now we're
going to iterate through that array by
saying VAR necessary for VAR i equals 0
and N equals swatches dot length I is
less than n I plus plus I'm going to
perform stuff in here you may have seen
this sort of thing written slightly
differently you may have seen it written
before like VAR I equals 0 is less than
swatches dot length i plus plus like
that the difference is that in this one
we're caching the value of swatches
length here we every time we iterate
over the for loop we'd have to evaluate
swatches length and that's a tiny bit
more computationally expensive than this
I mean it is a really minor difference
but it's something I consider to be good
practice so we're going to do it like
this and we want to say swatches I so
we're indexing into this array swatches
which is a of course the array of our
elements swatches I dot add event
listener I'm going to use the click
event and we're going to use a function
called set swatch so we're going to
create this function set swatch and
there's a few things we want this
function to do so first of all we want
to identify the swatch that's being
clicked then we want to set the color
and then we want to give the active
status or glossary so how do we identify
the swatch when we're giving all
swatches the same event listener well
remember that the event listener always
passes
the callback function the event object
as its first parameter so as always
we're going to name this event parameter
this event object that we're getting
passed as a first parameter we're going
to name that a as per usual and all my
objects have this property called target
and this returns the element on which
the event was fired so we can say we're
going to use this property I'm going to
say var swatch equals e dot target so
that's going to give us which swatch was
clicked to fire this function then to
set the color first of all we're going
to create a more general function to set
the color because I'm feeling really
creative we're going to call this set
color and this is going to take a
parameter called color and when we were
working with the color in the canvas
there are a few properties that we want
to think about well a couple there's two
so of course we're using to paint stuff
onto the canvas we're using both fill
and Stroke and the relevant properties
to color these are context dot fill
style and context dot Stroke start we're
going to set both of these to the color
that we get passed and then finally in
this set color function we want to
remove active status from the element
that is active if there is one active so
you say element nicer over active equals
document dot get elements by class name
active and again that's an array so I
want to index into that we just want to
take the first one because it should
just be an array of one element because
there should only be one active element
at a time so we're going to say active
equals document dot get element by class
name active index zero and then say if
of if active then active Jesus active
dot class name equals swatch so using
this class name property of the element
object which just lets us set obviously
the class name we're going to reset that
essentially to swatch so that's all set
color function done so now in set color
we can insert swatch so we can use this
function now you may be wondering what
values fill style and stroke style
except they accept any CSS color value
that means any hex value any named CSS
color any RGB value even an HSL value so
this makes it really easy for us because
we can say we can use the background
color of the swatch that was clicked so
we can say swatch dot style dot
background color background color so
elements this is an element object and
elements have a style property and that
style property is itself an object so we
and within that object there is a
background color property so we can we
can just set use our set color function
and set it to the background color of
the swatch now finally we want to give
the active class to this swatch so we
want to say swatch dot going to use the
class name property again and in fact
we're going append space active to this
so at the moment it's just got the class
swatch we're going to add active
remember the space because we're adding
multiple classes obviously we knew we
need that
space to separate the classes so let's
have a look at how this is running at
the moment so you can see this is
already working and in fact we can use
our set color function outside of the
swatches so if we if we go into our web
inspector into our console start typing
set color you'll you'll see that
function pops up and we can use any CSS
color value again so if I could say RGB
255 1 no 1 8 0 20 we want to put it in
quotes and we get sort of orange that
was just a random color I don't know why
I chose it but yeah just to prove to you
that this set color function is working
outside of the swatches context as well
okay so this is already working nicely
but at the moment it's very tedious if
we wanted to add a new swatch because we
have to add all of this div class equals
swatch style equals background color and
then add the color and the only thing
that's going to be different about them
is the color so what we're going to do
is have the JavaScript create our pallet
dynamically so we're going to create an
array called colors I'm going to set
this to a bunch of colors that we want
in our pallet so black gray white red
I'm just going to use CSS named colors
because it's so much easier but they are
pretty ugly colors so yeah you might
want to choose some nicer ones let's do
the entire rainbow blue indigo violet
okay so now we have that array we can
create a swatch for each of the elements
in that array so what we're going to do
is we're going to come in here and say
what we're doing say for we're going to
use this iterating over an array again
so far I equals zero N equals this time
it's colors dot length is less than n I
plus plus now for each of these you want
to create an element that is going to
have the class of swatch and then we're
going to add it into our palette so the
way we create an element in JavaScript
as we say document dot create element
and then give it the type of element
that we want so I'll swatches the divs
so we want a div in fact we want to name
that so we want to say far will use the
name swatch again just because it's easy
so now we have this element object
called swatch that we can work with and
we're going to say swatch dot color last
name equals swatch and that's going to
handle all of the styling for us apart
from the one thing which is the
background color so we want to say
swatch dot we're going to use that style
and background color properties again
now I'm going to set that equal to the
current index of colors so we're using
that the index of the colors that
represents how far through the for loop
we are at moment
so we're indexing into colors and
setting that color to the background
color of this swatch and while we're in
here we may as well add our event
listener this will remove the need for
our this entirely we don't actually need
that at all because we're going to do it
all within the da DM the for loop here
to fix a swatch to add event listener in
fact I should have copied that before I
got rid of it
click set swatch I'm going to now get
rid of that get out there okay and now
once we have our element we haven't put
it in yet so we want to say we're going
to use the function append child so
first of all we want to find the element
that we want to put the swatch into
which is our palate element which we
called colors I think we call it yep
colors so save colors and to that
element we want to append the child
swatch okay so that removed the need to
iterate over the BIR swatches array
again but that's only going to work if
you don't have any hard-coded swatches
so all my swatches are going to come
from this array if you want to have any
hard-coded for any reason I don't know
would but if you do then you're going to
have to leave that iteration in so we
can get rid of all the swatches from
that are hard-coded in div colors and
save that save this and have a look and
now you can see this is all working very
nicely
and uh swatches are being created
dynamically by JavaScript and it's all
very lovely the only thing left to do is
to as you see when we first load the
page there's no active swatch so we want
to on page load we want to set swatch to
the first swatch now how are we going to
do that well remember the set swatch
takes an event object and looks for a
target property within that this doesn't
necessarily have to be an event object
just as long as it has that target
property it's going to work so if we
create an object in here just another
anonymous object and then assign the
swatch the first swatch and we're going
to get that swatch by um if you remember
we used we use this here before to the
document dot get elements by class name
active zero so that gets the first
active swatch going copy that in but
just change this to swatch so that just
gets the first swatch passes it to set
swatch in a not in and anonymous object
with the property target now that's sort
of a dirty fix a dirty way around this
problem but it does the job so they have
a fully functioning color palette next
time we'll be looking at how to save
these images now they're all funky and
colorful or look at how to save them to
the server and how to allow the user to
download them as well so I hope to see
them</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>