<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Object Oriented Programming (OOP): Dependency Injection (6/13) | Coder Coacher - Coaching Coders</title><meta content="PHP Object Oriented Programming (OOP): Dependency Injection (6/13) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Object Oriented Programming (OOP): Dependency Injection (6/13)</b></h2><h5 class="post__date">2014-06-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pDxVRtPXpqY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so now we know what a classes and what
methods and properties are as well as
what inheritances we basically know our
p by now but we don't yet know how to
utilize it to its full potential
so in this lesson we're going to be
covering dependency injection and the
easiest way to explain this to you is by
demonstration so I'm going to create two
files chest and lock
I need two both going to be classes so
class chest and class lock now the loc
method will contain a protected property
of is locked as well as a method hot
lock and a getter for is locked at all
and all this is going to do is return
this is locked now inside he are all
going to do is we're going to say this
is locked equals true so we're locking
the lock next inside chest we're going
to have public function closed and this
will have a argument called lock so when
we when we set this to true it will
automatically lock the chest when we set
it the false it will close the chest but
leave the lock unlocked so here we can't
do anything just yet because we we can
access this property here so the first
thing that we have to do is fix that so
the first thing that we need to do let's
create a constructor and we're going to
inject a lock and we're going to set
that to this lock and we're going to
create that property up here protected
lock now what we can do is we can say
this lock lock but we only want to do
that if we specified if we tell this
function to lock the chest so if lock
equals true in fact that should be
identical instead of equals and that
should all work fine and what we could
do is we could also have protected is
lock is closed
sorry so it's closed and we could create
a a getter for that is closed returned
this is closed and up here all we do is
this is closed equals true then what we
could do is we could add another method
called open and we could say if this
lock is locked then we want to unlock it
so the first thing that we have to do is
create that method here so public
function unlock and all we're going to
do is set this is locked equals false so
now what we can do here is we can say
this lock unlock so we're just invoking
or calling that method and then all we
have to do is open the chest
so is closed equals false so now let's
test this out and our index file we're
going to include these two files so
chest and block then we're going to
instantiate chest chest a new chest
sorry and as our construct parameter
we're taking lock so we need to say new
lock now let's just make sure that we're
not going to get any errors which is all
fine we're not getting any any errors
here so what we can do now is we can say
chest lock and just to make sure that
this is working in fact that should be
close and just to make sure that this is
working we're just going to say here
echo closed and we'll do the same down
here we'll say echo opened
so now if we refresh we get missing out
okay we need to we need to specify what
we want to lock the chest so we'll just
say that you know we'll so we'll make
this optional so we'll set that to true
by defaults we don't have to pass it in
every time
there we go the chest is closed then we
can call chest open and the chest is
open now one issue that we have here is
we can instead of passing in an object
here what we can do is just pass in a
string and then we're going to get an
error because this lock method here
doesn't exist on a string obviously so
the way that we can fix that is by doing
something called typing a type hinting
all that does what all that means is
that we specify the class before the
argument so now if we if we do this
again and we hit refresh we're going to
get a catchable fatal error and
basically this ensures that anything we
pass into this constructor here at least
the first argument is going to be an
instance of LOC so if we just fix this
hit refresh we get the same result and
this is what we call dependency
injection now I'm just going to give you
a really quick example of a real-life
situation where this might be useful so
I'm going to delete these files close
them get rid of all of this I'm going to
create a new file and this is going to
be called a database stop HP and then
I'm going to create a new file called
user dot PHP and again these are going
to be classes so class user and class
database and our database is just going
to contain one method called query and
we'll probably pass in the SQL and all
we're going to do is we're going to say
something like this PDO that prepare SQL
execute and we're not going to be
testing this or anything like that this
is just an example okay so the next
thing that we need to do is add a method
to our user class
so for this example I'm going to say
public function create and this will
take an array of data so what we need to
do now is we want to create a user by
inserting them into the database but how
do we access this method here because we
want to create a query inside of this
class well again we use dependency
injection so we create a constructor we
type in this two database and we'll take
we'll call it DB facade and we'll assign
it to a property protected DB and now
all we have to do is say this DB query
is that what we call it yep and then we
can say insert into users blah blah blah
and that will all work fine all we have
to do is include these files database to
PHP user dot PHP and we'll say user
equals new user new database and just
for now we'll get rid of this and will
echo SQL and then we can say user create
Emma pass in an array username teri hit
refresh and we get this query and of
course if this was on a real site would
actually be executing this query and
saving the user into a database now
another reason I don't want to get into
this too much because the video will be
too long but another reason for the ban
a dependency injection is tight coupling
now something that you may have seen
before is public static function get
instance and let's just remove all this
dependency injection stuff and in here
would say something like would create a
properly protected static instance and
would say if not static instance and
don't worry if you don't understand what
this means we'll be covering static in a
nother in a in a future video so if not
static instance so if it's null or if
it's not
set then we're going to instantiate this
class and start in that variable so
static instance equals new self so all
this means is new database but it means
it's dynamic so if we change this to
something like add DB then we don't have
to bother changing this and then all we
do is return static instance now inside
a user class here what we'd say is we'd
say DB equals database get instance and
then we could say DB query like so and
we get the same result but the problem
with this is we tightly coupling user to
the database so let's say for example we
want to change a storage system let's
say we want to start our users in a file
instead well every time that we get the
the get the database instance we'd have
to go through this class and change it
to file you see so dependency injection
eliminates this all we'd have to change
is the constructor and you can even take
additional steps by using things like
the repository pattern which we may be
getting into later to easily change your
storage system</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>