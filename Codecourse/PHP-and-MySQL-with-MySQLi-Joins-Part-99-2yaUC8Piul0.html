<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP and MySQL with MySQLi: Joins (Part 9/9) | Coder Coacher - Coaching Coders</title><meta content="PHP and MySQL with MySQLi: Joins (Part 9/9) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP and MySQL with MySQLi: Joins (Part 9/9)</b></h2><h5 class="post__date">2014-01-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2yaUC8Piul0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we're now going to look at simple joins
within a database table or a couple of
database tables so what we'll be doing
first of all is going back to our
database creating a new table an
essentially linking data from one table
to another so we'll look at how we do
that within the database first that
should give you a good idea of how this
is going to work in terms of our code so
let's hop over to our database you can
see we've got our people table open
that's within our app database and what
we're going to do is we're going to go
ahead and we're going to create a new
table so we're going to call this
countries and we'll give this three
columns so the first is just going to be
ID which is going to uniquely identify
each country we're also going to have a
country code and then we're going to
have a country name so the country code
is going to be two characters long and
named I guess we'll just put some
varchar' 50 and the ID will be an auto
increment and primary key so let's go
ahead and save that so we've now got two
tables we've got people and countries
now within the table people we will have
the option to supply whether or not this
person belongs to a specific country and
that country will be created within the
countries table now let me show you what
we first of all could do and then I'll
tell you why it's a bad idea so inside
of the structure of people let's go
ahead and just add a new field after
here let's just give this a varchar' 54
now this is the wrong way to do it
absolutely wrong way to do it but let's
just say we want to choose a country for
Alex so I'm going to say Great Britain
so I hit go there and I want to choose a
country for Billy and I'm going to say
United States and that's it so now I've
got two people with different
information and they belong to different
countries that's absolutely fine now
let's say we introduce another person
into the database and let's just say
their country is Great Britain also
just choose now for that so we've now
got another person added to the database
who's also part of Great Britain that's
their country now what happens if we
need to go ahead and change Great
Britain let's say we accidentally spelt
it wrong and this person now needs to
have or everyone with Great Britain
needs to have their details change now
this is a bit of a problem because
what's going to happen now is it's going
to require an SQL statement or an SQL
query to go ahead and update all of the
users whose country is equal to this
string to another string and it also
means that we're Joop locating data when
there's absolutely no need to duplicate
this data whatsoever so what we're going
to do instead is instead of this being a
varchar 50 we're going to set this to an
integer now what that's going to mean is
that when we come to enter a country
this is going to be 1 2 3 4 5 6
instead of United Kingdom United States
India or whatever Germany whatever so
inside of our countries table we can go
ahead and create a list of countries I'm
not going to enter all of them I'm just
going to give them the the countries
that or apply the countries that we
require so for example Great Britain and
United States so the two-letter country
code in the name of the country so we
now have a separate countries table
which deals with the countries now the
other reason this is useful is let's say
another part of your application mate
needs to make use of a list of countries
you've already then got a table with a
list of countries in there you don't
need to extract them from the people
table which wouldn't make sense so now
I'm going to go ahead and I'm going to
set Alex to country 1 I'm going to go
ahead and set Billy to country too and
I'm going to set Dale to country 3 as
sorry not 3 1 so how would we know what
country to set a user to on the front
end of side things anyway well let's
just say you had a drop-down list and
you had a list of countries you would
know from your countries table that you
would have I
of one and two so you could set this
value based on that you can have this
within a drop-down list as part of a
form when a user registers or you enter
the users details or whatever so we now
know that we have a people's table with
a country filled with a number relating
to a country within the countries table
now let's go ahead into our code and
actually output this list of people so
let's go ahead and create an SQL
statement this can just be slit star
from people and we will create a results
array results variable sorry with DB
query SQL and then here we'll say if
results num rows while row equals
results
fetch object so we're basically getting
an object to data back we'll just echo
out I know
row first name and we'll just do that
for now and we'll say otherwise echo no
results okay so what was happening here
is we're selecting all data from the
people table executing the query if
there are rows we are then going ahead
and out putting them in lists so we've
now got Alex Billy and Dale as we'd
expect now what I'm going to do is in
brackets I'm going to enter their
country so I'm going to say row country
and this is obviously just going to
output one two or one which is useless
we don't want to do this now how would
we go about grabbing this country well
there's a really bad way to do this and
a good way to do this the bad way to do
this would be to create an additional
query in here to select the name of the
country from the database so let's go
ahead and look at how this might be
so in here we might say country equals
DB query select star from countries
where ID equals and then in here we can
go ahead and say row country and then we
could say something like country equals
country fetch and in here we could say
country name also fetch object we want
to do and that would bring back Great
Britain United States and Great Britain
so we've basically achieved what we want
to do by using two different tables
however the problem here is that we're
doing this within a while loop so what's
what's happening is we are looping here
three times because we have three
records now this isn't too bad now you
can't notice the speed difference but if
there were hundred even a thousand
records here what this means is that
we're then generating an extra thousand
queries in this case we're generating an
extra three queries so we're performing
one query here and then three queries
here that's four queries in total just
to get back three people's details so we
don't want to do this we never ever ever
want to do this within a while loop
instead what we want to do is include
everything in this first query which
means we only will then have one query
so we're back to now let's say row
country so back to this sort of square
one now where we've got one two and one
now how on earth can we do this all of
them within one query let's just bring
this down a little bit just so it's
easier to read and then what I'm going
to do is I'm going to rewrite this query
and we're going to use a join now
there's a few different types of joins
we've got an inner join which is the
same as just a join we've got a left
joining we've got a right join now we're
going to be using a left join and the
reason we're using a left join is that
if you think about the database table
let's just say people being on the left
and countries being on the right people
will always exist we want to output
these people always we don't care
whether they have a country or not we're
going to left join the countries table
because we want to output the people
regardless of whether they have a
country or not the country might be set
to zero in which case we still want to
output the person but they just don't
have a country if it's an inner join
it's going to require that there's a
relationship both ways so it will only
output what has a relationship both wait
so if a person doesn't have a country
that person won't be output so we'll be
focusing on left join now I won't
confuse you too much with the different
types of joins let's go ahead and take a
sort of different approach to selecting
this data instead of saying select star
which will just basically get all of the
fields from the people table I'm going
to say select people dot first name
comma countries dot name as country from
people this might confuse you if you're
not too used to this this kind of syntax
but what I'm saying is select the first
name field because this is the only one
that we're outputting from people we
could do people dot star but we'll just
leave it as people to our first name so
select the first name from the people
table select the name which is the name
of the country from the countries table
as country so we're calling this
something different
because we want to output it down here
if we were to not do this we would have
to do row name and that's just confusing
because orders name mean is it the
person's name so we're going to call
this country so we're saying as country
from people and we can even say from
people countries we don't need to do
that we'll do it anyway okay so let's
put this down on next line just so it
looks a bit more easier to read so now
what's going to happen here is when I go
ahead and refresh we get this out so
it's saying here
Alex Great Britain Alex United States
Billy Great Britain Billy United States
Dale Great Britain Dale you now say what
on earth is going on here what's
happened is is we've selected every
thing we've not defined any sort of
joins so regardless of whether this data
is there or not we're getting back
because there's an because there is two
countries in the countries table this
record is being output twice with both
it both potential instances if we were
to create another country within here we
would get three of these output what we
need to do is link these up some house
we actually returned only the amount of
records we need with the right with the
right country so we use left join for
this now this is slightly tricky but
it's easier than you sort of immediately
appears so we're going to left join
countries which is the reason we don't
necessarily need to save from people
countries we could get rid of that if
you want to do will you be in any way so
left join country so we're left joining
this countries table on and this means
on a particular condition so we're going
to say on where people dot country
equals countries dot I D so what does
this mean well it means that we're doing
this on let's just duplicate this so
here's the people's table here's the
country's table we're saying on country
dot oh sorry people dots country so
whether that be one or two equals
countries ID be that one or two all
we're really saying here is where this
matches this and then we know which
country that user then belongs to so
what's going to happen now is when we've
done this we're going to get countries
named as country but it's on this
particular condition and that will join
the data together so when we refresh now
we get no results brilliant so let's
have a look I might need to get rid of
this actually yes there we go sorry we
get rid of this because we're basically
left joint we're doing a left turn on
countries table so we don't need to say
from people countries so now what's
happened is is it's joined up them IDs
it's
stem IDs up so we have Alex Great
Britain Billy United States and Dale
Great Britain so now what happens is the
point of this is that if say for example
dial change to another country that
reflected and in the country's table if
Great Britain needed to be changed I
know with an exclamation mark on the end
that then will update this for all users
so again if we were to do it states with
an exclamation mark this will then
update it for both users there's a lot
more maintainable way of working with
data so that's basically how we join
very simply two tables together with the
data that we require in this case it's a
country we've only executed one query
and we've actually pulled data from two
tables and made a really reusable
solution from this</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>