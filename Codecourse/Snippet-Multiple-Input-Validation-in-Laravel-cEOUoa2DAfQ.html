<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Snippet: Multiple Input Validation in Laravel | Coder Coacher - Coaching Coders</title><meta content="Snippet: Multiple Input Validation in Laravel - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Snippet: Multiple Input Validation in Laravel</b></h2><h5 class="post__date">2017-03-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cEOUoa2DAfQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I get asked quite a lot about multiple
field entry and specifically in terms of
validation so I thought I'd share with
you a technique I've recently been using
but without using JavaScript whatsoever
sometimes you don't really want the
hassle of having to do this so what I'm
going to do is show you how to
potentially share something with
multiple emails so the way that this is
going to work is we're going to have
five inputs on this page we're going to
be able to only allow one of them to be
required so only one email address that
we enter has to be required all of them
have to be unique so we can't enter the
same email more than once and once we've
submitted this we can go through and
obviously send an email potentially
we're not going to be covering that but
you can go ahead and handle that
afterwards and this could really apply
to anything it's not the most elegant
way of outputting a list of inputs but
it does the job and depending on what
you're doing this could work for you so
what I've done is just very simply set
up a control here with an index which is
rendering this share view just here so
we don't have anything in here at the
moment and of course I have a store
method on this controller as well and I
just have two really simple routes set
up so everything's already set up ready
to go
but this is pretty straightforward okay
so over in our view let's start to look
at how we might output these fields now
there are ton of ways that you can do
this and let's just knock this out
really roughly and you can go ahead and
tidy up later on so we'll leave the
action for now in here we're working
with bootstrap so we would have some
kind of perform group for each of our
inputs we may even have a label in here
you don't have to but let's go ahead and
create a label anyway so we're going to
say for email and this is going to
inside of here just expand my email and
why don't we make this a bit unique so
when we do iterate through here and
output 5 let's say email 1 and we'll
replace this out in just a minute so in
turn here we'd have an input type of
text let's just give this a bootstrap
class so form control and we'll give
this name of email and this is going to
be an array so we could call this emails
we could call it email I think email is
a little bit better here so the point
here is that for however many of these
we generate we're going to have an array
with all of them email addresses in now
in terms of the actual ID we'd need to
make this unique as well of course and
in this case let's just really roughly
do this so I'm going to say free range 1
to 5 as X maybe and then down here let's
go ahead and end that for each now if
you had a predefined set of input so you
could technically just duplicate these
down however many times you want that's
absolutely fine you can use a for loop
really depends on what you want to do in
this case we're just going to make this
super wrap so in this case we'd have
email 1 and then for the ID this of
course would be email and then maybe we
could include a hyphen in here and then
output X because of course an ID per
page needs to be unique so let's also
update this of course for the label as
well so we can actually click through
properly and let's just give this a
little preview and see what we have so
there we go we have five potential field
that we can fill so let's create a very
quick submit button down here so it's
creating another form group create an
input type of submit or a button type of
submit that'd be better and we'll just
say send something like that we'll share
whatever you wanted to do and why don't
we give this a nice class as well of
button button default ok so the problem
that we have is this needs to be
required but these don't so we can fill
out email two to five if we one only the
first one is actually required so we
can't just send it through it just work
will not work if we don't have any
emails whatsoever and we want to handle
this nice and elegantly with laravel
validation now the other problem is that
all of these need to be unique and also
all of them need to be an email address
now if for example we don't fill out
email 2 to 5 an empty string is not an
email address so we need to handle this
in some way as well ok so now that we
have this rough set up you can of course
go ahead and play around with we're
going to go ahead and send this through
to this I'm just going to give this a
name very quickly and we're just going
to say share dot store and of course you
can name this however you want so over
in our index here let's go and just
output this so we'll generate a route
through to that and we should be able to
submit this of course not
getting to bring in our cross-site
request forgery field all right so now
that we can actually potentially submit
this let's go ahead and send it through
of course we see nothing so not doing
anything inside of that store method
let's go ahead and validate this we're
going to extract this out to a form
request in a moment just because it's a
little bit tidier particularly when
we're looking at custom validation rules
but we'll do it here just to make sure
it works and then if you want to you can
extract this out so we're going to go
ahead and validate passing through our
request object and inside of here how on
earth are we going to set these rules up
well to kind of work this out let's do a
died dump on request emails and actually
see what we get so let's output these
let's go back and resubmit this form
send this through you can see we just
get a null for 0 to 4 of course it's up
to 4 because we have a 0 indexed array
so if I do go ahead and submit something
so let's enter an email address in there
and it's also filled that's pretty
annoying let's get rid of each of them
send this through and of course we see
the following so what we need to do is
set up a rule to say something like
emails and what we can do is use an
asterisks here to say that each of these
has to satisfy these rules so for
example if we were to say required that
wouldn't quite work what we can do
though is say that each of these has to
be an email so let's get rid of our died
done let's go back and submit this
through of course we're redirected back
because all of these are required now in
order to really demonstrate this we kind
of need to set up our validation output
so what I'm going to do in here is just
very quickly do this and the way that we
do this basically using an array and
this kind of for each notation is we
just say errors has and then we would
say emails dot and then we would simply
append on what we're currently iterating
through like so and in this case because
we are working with an array this would
need to be 0 to 4 but you can kind of
figure out a better way to go ahead and
loop through these or of course just
manually create them okay so now that
we've done that just underneath our form
here let's go ahead and say if our
errors has email and then of course we
still need to use our dot notation to
append on that
go ahead and end the if there and then
in here we would have a span with a help
block class and then in here we would
just output the first error for that
particular key so errors first and then
inside of here
email dot and then of course as always
append on that X so now if we go ahead
and send this through so let's just fix
this up to say emails we've call the
emails make sure that's okay
and it's send this through and it's also
just make sure we're actually outputting
the has error class that we need
otherwise nothing and in terms of the
label we also need to give this a class
which is I believe control label or
label control we'll see in a minute send
this through and there we go so we get
an invalidation
error for each one now of course the
actual validation error itself is a
little bit odd at the moment so we'll go
ahead and fix that up when we like our
form request okay so really back to the
kind of point of this we can't really
say that each of the emails is required
we can say that each of the emails has
to be an email address that makes sense
but we still run into the problem where
an empty value or a null value must be a
valid email address which of course it
isn't so what we can actually do here is
say well I'm going to allow all of these
to be inaudible now it might not make
any sense but just bear with me so if we
go ahead and send this it works as
normal now what we want to do in terms
of allowing maybe the first email this
first email has to be filled we can very
simply down here say email zero and we
can almost overwrite these rules so in
this case we can say well the first
email is required like so so this kind
of makes sense and if we go ahead and
give this a send now you can see the
email zero fill is required if I fill
this in and this is really annoying
let's just get rid of all of these again
send this through and it works so we are
allowing for the first email address but
the others are nullable so if we go
ahead and fill this in again and for
example I do actually send a duplicate
email this is a problem we don't want to
iterate through that array of emails
that we get and of course send it to
multiple people we can do that filtering
at the controller level but on this
it's going to get a little bit messy and
it's a lot better to handle this of
course at the validation level so in
this case what we want to do is just say
distinct and what that will do is allow
us to have all of our emails distinct so
really really important so essentially
nullable is still applied to this one
but because this is required it's kind
of ignored nullable okay so let's go
ahead and just send this through again
so let's include a duplicate email
address so let's get rid of all of these
send this across and there we go so the
emails one field has a duplicate value
now of course you've noticed all of the
inputs have been cleared to get round
this you would obviously just say value
and then in here you could say old and
then emails and then of course a dot
notation appending on that key so let's
go ahead and send this through again why
don't we send them all through and there
we go so the emails one field has a
duplicate value and so on and so forth
so even if we were to make this
different but don't include a valid
email address we see must be a valid
email address now if we submit this with
a rubbish email address in the first one
if we send this through notice we don't
see that validation error so what we
would additionally have to do within our
validation is also say that this needs
to be an email a little bit odd but
that's just how it's going to work send
this through and we get that in there so
you can play around with this depending
what you're doing but that is pretty
much the validation as we need okay so
now that we have done this what about
customizing our messages of course at
the moment this does look a little bit
rubbish with the emails that one field
has a cheaptickets value you kind of
want to make this a little bit more
generic so the way that I would usually
do this and the way that you can do this
is just pass an additional array in here
and then define out things like email
and then whatever so emails dot required
and in this case you'd have to use your
asterisks for each one so you could say
in here email is required or make it a
little bit more friendly I guess we need
an email address that's not more
friendly but a little bit different so
in
case then if I were to submit this we
need an email address but doing this at
the controller level plus any logic down
here which would probably be through
mapping through your array that you get
and then going out and sending I don't
really like this so what I'm going to do
is go ahead and make a form request and
I'm going to extract my validation rule
out to a form request we can implement
all of our custom error messages and it
will be a little bit cleaner so in this
case I might say something like share
whatever request in this case I'm just
going to say share form request is
pretty generic with this example that's
going to go ahead and create my requests
folder create this in here we can go
ahead and pull this in and replace out
our normal request so in this case I'd
use app HTTP request and use that in
there and very simply replace that in
and we can start to move all of our
validation rules over so in this case
let's set all throws to true we don't
need to really handle this here we do
that it may be a middleware level or
whatever else paste our rules in here
and if we take a look at the base form
request what we can do is use the
messages method here which returns an
array which grabs all of our custom
validation messages so very simply over
on our share form request
we just need to implement this method
overwriting the default and we can start
to define all of our messages out in
here and what we can do at this point is
literally get rid of all of this and
we're done so just to kind of
demonstrate this let's do a died UMP on
request emails just to see that we get
them values through okay so now that
we've done this let's just go over let's
enter an email address in here let's get
rid of all of these I really should turn
also complete off in this case and send
this through so we get the email address
here we know that our validation is
working and we need to handle these at
some point as well and we'll do that in
just a moment okay so for the validation
messages then let's go ahead and
implement these so we make it nice and
friendly okay so for required in this
case we would say emails dot asterisk
and then we would say required and again
we just set this to something like we
need an email address
then for for example nullable we don't
really need to worry about this because
this is a more kind of poke away from
the scenes validation where we are
allowing it to be nullable but we do
really need to implement something like
distinct so we could say something like
duplicate email sound and then for our
email so you know stop
email validation role we could say that
is not a valid email address like so so
now you can kind of fit it around with
ease until you want but now we have a
much nicer way of doing things if we go
ahead and enter an email address here
and we see a duplicate duplicate email
found if of course is not a valid email
either here or in any of the other
fields we see that is not a valid email
address and that is pretty much it so
again you can play around with these and
pretty much do what you want all right
so once we do get past this point we've
covered validation how do we go ahead
and filter out the nulls what we don't
want to do is map through all of these
if they don't exist so in this case for
example entering the following we would
only expect to see two email addresses
or at least send two emails so in this
case if we just send this through we see
the two now in the controller you would
go ahead and map through these so the
best way I found to do this is to go
ahead and collect them up into a new
laravel collection so for example
request emails what we can then do is
either map through them or go each
through them and this is a little bit of
a better method so we could say each for
each of them we get an email I need to
go ahead and do something with it so why
don't we just far dump that email just
to see it's there and then just kill the
page down here if we're doing something
else so give that a refresh and we see
the following but we still have these
null values now you could do this with
the laravel collection but to be honest
it's a lot easier just to use a plain
vanilla PHP function like a ray filter
to filter them before they put in the
collection and then when you go ahead
and map through them you will end up
with just the emails that you want to
send to so that is pretty much it
cause you can customize this to do
pretty much whatever you want you could
probably tidy up the view a little bit
just here instead of mapping through
like this entirely up to you but
hopefully that was helpful I get asked
about this a lot and if you don't want
to use JavaScript then this is the next
best solution</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>