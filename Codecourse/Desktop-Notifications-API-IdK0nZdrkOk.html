<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Desktop Notifications API | Coder Coacher - Coaching Coders</title><meta content="Desktop Notifications API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Desktop Notifications API</b></h2><h5 class="post__date">2014-04-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IdK0nZdrkOk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to look at the
desktop notifications API and how to use
it so let's look at a demo of what we're
going to do here we've got two links
request permission and trigger now
request permission is going to
specifically ask whether we want to use
or allow desktop notifications so in
this case when I click it we see we get
this native browser message come up here
and it's saying do we want to allow
localhost which is the domain I'm
currently on to show desktop
notifications now if we don't answer
this and we click trigger this just
generates a little alert here that I've
created to say please allow
notifications before doing this so you
request permission we can either deny or
allow this let's go ahead and deny it
and see what happens we get a message
saying you have denied notifications
obviously in a production environment
you would choose a more suitable way of
telling a user something rather than
using alerts now I can use the learn
button here to go and enable use global
default
so let's request permission again and
this time allow it and you can see that
it says you have granted notifications
now that that's done when we hit trigger
you can see that this notification is
shown up here there are a couple of
elements to this we've got an image here
which is a custom image that I've
included we'll learn how to do that
we've got a title and a body and when I
click this we have a unique identifier
and what this is going to do is because
I've seen this under being a new message
when I click it it's going to apply this
query string to the current page that
we're on so this is useful for if you do
if you are monitoring users messages or
something like that and you want then
them give the ability to click it and go
through to a specific page so we're
going to learn how to do all of this in
just a moment so we're now ready to
start building the functionality - first
of all ask for permission and then
trigger a notification now this is all
in sort of testing so we you know we're
not really doing anything useful here
we're just learning about how the actual
functionality works so you can see that
I've got a basic document markup I'm
going to create two links as we saw in
the demo and the first one is going to
be to request permission and the second
is going to be to trigger this this will
trigger the notification for the href
we'll just set these two hashes because
we don't want them to actually do
anything but we'll give these IDs so we
can target them with the JavaScript so
I'm going to call this DN for desktop
notification permission and this one I'm
going to call DN trigger so down here
let's open up some script tags obviously
this would usually be in an external
file we'll just do it here for
simplicity let's target the two anchors
we've just created so we can add event
listeners to these when they're clicked
so I'm going to say DN is document dot
get element by ID and we choose the ID
that we get gave here which is obviously
DN /
let's do exactly the same thing for DN
or DM DN trigger and there we go so
let's focus on actually adding the event
listener to the permission so we can get
permissions from a user you're going to
have to get permission from a user you
can of course trigger this automatically
but it might be polite just to allow
your users to click a button rather than
having it shown to them as soon as they
land on your site so we add a event
listener to the DN perm link and we want
this to be on click so we run our
callback function also supply a in here
that's the event and we want to prevent
the default behavior here so now what we
want to do is check for notification
support now this is really important
because obviously this being not
supported in a lot of browsers you may
want to do something if your user
doesn't have this you know ability
you might even not want to not show the
link to request permission in the first
place so a simple if statement here with
saying just window dot notification not
exists if so let's alert sorry
notifications are not supported so
obviously you would do something else
other than alert of a now that I'll do
we now use this global notification
object to request permission so here we
have a callback and we have something in
here the argument here which will give
us a string whether the notification
permission has been denied or granted so
if we console.log this p we can practice
this as we go along
so in here let's refresh we've got the
two links as we've seen let's open our
con
just in case anything goes wrong we can
debug it I'm going to click request
permission and you can see now this is
brought up this dialog so we can click
deny or allow so remember with console
logging that P argument in the callback
and that's going to be either denied as
a string or granted as a string so let's
practice both if I deny it you can see
that we get denied console logged let's
go ahead and reset this back to use
global ask and request permission allow
it says granted so we know we can now
use these inside of an if statement in
here to determine whether the user has
granted or denied so if he is denied we
want to alert to the user obviously you
wouldn't actually want to do this but
for our testing purposes you have denied
notifications now otherwise we might
want to do a comparison for granted and
in this case we'll also alert just so we
can keep track of how we're doing to say
you have granted notifications so let's
just check that these work so we haven't
missed anything out your statement again
set this back to ask refresh hit request
allow we get the alert as we expect and
we'll go ahead and just refresh this or
it's back to default and will deny just
to make sure that works perfect
so we'll reset this once more again and
here we go
right so we can now get on with the rest
of our code so we want to simulate some
kind of event
now obviously you wouldn't ask for an S
notification to be enabled when a user
clicks trigger link as we've got on our
page here that's silly you'd want it to
happen maybe if your Ajax into a file to
check a user has new messages or
something like that with on page refresh
you're checking for new messages you
want to do that but for now let's just
simulate an event
and we want to simulate this by allowing
user to click on this trigger link just
here so we'll say DN trigger dot add
event listener as we did before and we
want to add an event listener for the
click event so now we have a function
obviously with the event here and we
want to do the same we wants to prevent
the default so I'm going to create a
variable here in fact I'm going to do
that before I prevent the default and
I'm going to call this notify and we'll
look at why I've done that in a moment
we're going to create a new notification
object and that's what will actually
trigger the notification to be shown so
we're going to check now if
notifications have been you know allowed
or denied if the notification permission
property is default the string default
that means that we haven't chosen so for
now actually rather than do this if
statement lets console.log again the
notification playable object the mission
sorry console.log so when we refresh and
hit trigger it says default and that's
because we've got this set to default we
haven't actually allowed or denied so
it's it's assuming that we've denied
them and it's correct and well we
haven't actually denied them but it'll
assume that we can't show them and that
means that if it's set to default we
won't be able to show notifications so
in this case we want to create an if
statement to say if notification dot
omission is default then we can't
actually show the notification so this
is the point that we're saying to thee
or writing in the code let's check if
it's been you know clicked deny or allow
if not we just you know we can't do
anything so in this case we'll alert
please allow notifications before doing
this and again you wouldn't do this in
your code just simply because you don't
want to tell the user every time a
notification might be available that
they don't have
to do this if they've clicked deny or
they've closed the dialog we just want
to ignore this all together so in this
case the best thing to do is just not do
anything now otherwise we have this
notify variable I've created the top of
this sir of this closure here so we'll
say notify is a new notification so this
is a little bit different than using the
global notification object in this case
what we're going to do is we're now
saying we want this to be a notification
so I'm going to write new message from
Alex and by doing this we're just
actually automatically activating this
new notification let's check this works
I'll make sure that my notifications
start to be asked so when we click on
trigger it says please allow
notifications before doing this we've
spoken about that in depth
request permission I'll allow this it
tells me I've allowed it
when I click trigger now we see new
message from Alex now we don't see the
image or the body we saw at the start of
the video we'll go ahead and add them in
a minute we pass another object through
to this new notification like so and
that contains properties now there are
lots of properties that we can use but
we're going to focus on body tag and
icon so the body as you probably guessed
is just going to be what's displayed
under the title so I'm going to say how
are you today it really is a lovely day
so the second I'm going to choose icon
and then we'll discuss tag in a minute
and how that works and we'll also be
looking at adding a event handle to this
notify as well so the icon is just a
location to an icon file or not
necessarily an icon file afar that you
want to be the icon in this case inside
of the image directory in this directory
I'm working in I have message dot PNG so
I can just go ahead and include this and
that will just display so it's image /
message dot PNG let's preview this to
make sure that this is worked when I
click trigger now you see that we've got
you message from Alex the body and the
image we've got a transparent background
here as well so that's looking really
really nice when I click on it it goes
and nothing happens presumably you want
to attach some kind of event handler to
this to do something when a user clicks
it it's intuitive that if a new message
is received you click on it and you
would open that new message so down here
we want to say notify dot and then we
want to apply an event handler to this
notification object we've created
remember that this notification object
is unique you can create these
notification objects over and over and
over again that will generate new
notifications so we're going to say
unclick and that's going to run a
function let's console.log this because
this now refers to this actual
notification we can access these
properties in here so when we refresh
and hit trigger and I click here we have
this notification object we've got the
icon which is the full URL to this
message dot PNG we've got tag body the
language the direction which is auto at
the moment but that can be left to right
right to left you know these are all
available on the w3c or whatever but
what we want to focus on here is this
tag we want this tag to be the unique
identifier for this notification so in
this case I could say that the tag is 1
2 3 4 so what's going to happen now is
when I console.log this dot tag that
will actually console.log for me the tag
by applied so this could be the ID of
the message in your database or
something like that however this ties
into your application so because we have
access to all of these we can say window
location is message equals the S dot tag
now a little thing here if I run this
again with the same tag you'll notice
that this won't actually do anything is
not activating this mess
and that's because the message with the
same tag has already been opened and I
think this is probably done on purpose
haven't specifically looked into it but
it does make sense you wouldn't want the
same thing coming up and up and up again
you know if you had the same tag here so
I'll change this to one two three four
five six and now we should see when I
hit trigger this appear when I click it
that goes through to message one two
three four five six and obviously you
can do anything you want with this
functionality but this is obviously just
an example so we've looked at the
notifications API and how to check for
permission or ask for permission trigger
an event we've also looked at some of
the properties that we can use inside
the notification object we've also then
looked at clicking this to go through to
somewhere just to sort of tie in the
usual functionality of these</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>