<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Multiple File AJAX Upload: JavaScript (Part 8/10) | Coder Coacher - Coaching Coders</title><meta content="Multiple File AJAX Upload: JavaScript (Part 8/10) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Multiple File AJAX Upload: JavaScript (Part 8/10)</b></h2><h5 class="post__date">2014-04-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BoU0JZNQNnA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we'll now create the JavaScript
functionality to allow us to Ajax to
this file to actually submit data to an
upload but remember we have this array
here or this JSON encoded array here
which needs to go inside of here if we
submit via an ajax request and we look
at how this works later when we build
the javascript so let's take a look at
the javascript file we don't have this
included on our page here so we need to
go ahead and do this now so we choose
the source and in this case the source
is j/s forward slash upload that j/s and
we're also going to go ahead and create
a script area down here which will allow
us to call the functionality inside of
upload a yes so let's get rid of upload
dot PHP for now we don't need this and
let's start to build out this
application so I'm gonna create a
variable called app and that's going to
either be equal to app it's already been
defined or an empty object and what we
can then go ahead and do is pass it into
a function and this allow us to keep all
of our variables and methods all within
one namespace let's go ahead and create
this function then so what we're gonna
do is we're going to pass app into here
and that's going to be represented by o
which means object inside of our this
function that we've just created so if I
was to go ahead and output this you'd
see a object basically so I can do a
console log here on Oh for example and
when i refresh we see this object but we
don't want to do that we only want to
allow something to be called from this
part down here let's go ahead and use
strict this is validated so we use the
use strict statement at the top of this
and let's go ahead and say private
methods and declare the private methods
that we're going to use in here that's
going to be Ajax which will actually be
Ajax in two
the file that upload dot PHP file to
send the data we also gonna have get
form data and set progress you can
probably guess what these are going to
do get form data is going to get to the
files that have been chosen within this
form Ajax is obviously gonna get Langer
and send them set progress is gonna
return us the progress of the upload
let's go ahead and define these methods
here them so Ajax is going to just be a
function here also gonna have get form
theta which is obviously going to be a
function again and eight
Ajax can set progress another one there
so let's fill in what arguments these
take Ajax is going to take a set of data
which is going to allow us to send that
data along with the request we're gonna
have yet form data that's going to be a
sort of that's gonna have a source which
is going to allow to be passed into it
in this case it's gonna be the form that
we have and then we're gonna have set
progress and that's just going to be
value all set progress is going to do is
upload the progress bar and the progress
text so we'll look at that later
so with the Ajax method this is probably
the most important in terms of you know
what it does because without it we
wouldn't be able to send an HTTP request
to upload dot PHP so let's get started
on this and start to monitor along the
way so I'm gonna create a variable
called XML HTTP and this is going to be
a new XML HTTP request this won't work
on older browsers but you can easily use
fallbacks to go ahead and support this
and what also gonna store a variable
called upload this is just gonna store
which files have been uploaded so now we
need to go ahead and actually open a
request so I'm gonna say XML HTTP open
and that's gonna open a request it's
also going to be post and it's going to
go to a specific file now what we need
to do now is start to look back at how
we're going to call this uploader
because we need to provide options
so let's go ahead and just comment this
out for now and down here I'm going to
say Oh uploader
is a function which takes options and
I'm gonna say ODOT options equals
options that's just going to allow that
to be public and that's it we'll take a
look at just console logging out options
so let's just return to index dot PHP
and see how we would call this so inside
of our empty script tags that we open
here we want to just call app dot up
loader so let's refresh here you can see
this is undefined at the moment because
we've not actually passed any options in
so by passing an object in that's passed
that to here and then we set Oh up here
the options to this here so that means
that then we have an access to options
that we can use within our code so let's
define some of the options that we might
want to see here so inside of index dot
PHP we go ahead and we need to provide a
few options now files is going to be the
actual element where the files come from
so we need to somehow select this
element to be able to pass it to here so
how do we do that well let's create a
variable here called
F which will represent the files we're
gonna say document dot get element by ID
and that's going to be file remember
file here by ID so we can pass F into
the actual files this is going to be the
files that we want to upload we also
want to define the progress bar so this
is the actual element the progress bar
exists I'm gonna nickname this PB and
I'm gonna go ahead and do exactly the
same as I've done here and say document
dot get element by ID
and up here we've called now we haven't
actually given this a ID yet so I'm
gonna call this P B and I'm also going
to call the text PT so we say ID its PT
what this allow me to do is then also
define the progress text PT so we can
target the progress bar to update the
width of this based on the actual
percentage and we can update the
progress text as well so I'm also going
to define a processor processor and
that's going to be uploaded up PHP
that's just defining which file we want
to Ajax to to actually upload the files
that's the same as what we've been
choosing here so we're using this far
both for the Ajax and the non Ajax
solution what I'm also going to do is
have a callback function we're just
going to contain data for now we'll just
go ahead and console.log that data so we
are also going to provide the ability
for an error to be passed and we're just
going to go ahead and console.log not
working so we've not built any of this
functionality yet bear in mind these are
just options contained within our way
we'll be filling these in in upload KS
so we've got the processor here so we
already know that we can start to Ajax
to that so we access options by o dot
options dot processor so this will now
perform an AJAX request to the processor
that we've defined in this case I want
to go ahead and also say XML HTTP does
send that will just send the request and
we want to provide the data that we send
along with that request as well in this
case it's the data that's passed into
the Ajax function but where does this
data come from well we're not doing
anything we're not actually calling this
method at all yet so if I were to
refresh here nothing's actually
happening or you can see is this being
out here
which had happened to be the options so
we'll go ahead and get rid of that we'll
create a quick if statement here to
actually check if the files have been
provided so I'm gonna say options dot or
I could even say adoptions dot files if
that's not undefined we can Ajax we call
the Ajax method that we created up here
and we're gonna call get form data but
for now what I'm gonna do is I'm
actually just gonna provide in an empty
object so let's refresh and I'm gonna go
ahead and hit upload or choose a file
and hit upload so nothing's happening at
the moment so we need some kind of event
handler to only run this when we hit
submit so let's go ahead and do that
here and just test how that works so
document dot get element by ID remember
we created an ID for the submit button
earlier so idea of submit so you can say
submit there and we want to use the add
event listener and we want to do that on
click we have a call back here that's
run so we can just test this out by
console logging clicked now what's gonna
happen though is we're not going to
really see this console log or you know
if we quick will see when I hit upload
you can see it but then it goes because
we're being passed through to upload dot
PHP here so what we need to do is we
need to provide in here E and what we
can then do is prevent the default
behavior so now what will happen is we
won't see this go through to upload dot
PHP in its natural behavior so if I
choose a fine hit upload it just has
clicked so now we're starting to see
that we can now start to process all of
the files in here which remember we've
grabbed using this in actual fact I
forgot
to fill out the PT and I also forgot to
do PB in there and PT in there so just
to recall we're pricing the progress bar
element and the process progress text
element through to our app so instead of
console click that's not very useful we
want to take all of the functionality
we've already built and we want to paste
this inside of here and we'll indent
this like that so now what that's going
to do is it's going to get the submit
element it's going to add the event
listener the click event listener
prevent the default behavior grab the
files that we've chosen via the multiple
file uploader element get the progress
bar get the progress text it's going to
pass the fast through the progress bar
through and the progress text through
and it's going to choose the protesser
as upload dot PHP so once we've done
finish we'll want to call finish we're
gonna have console but a lot of data we
not include that functionality at all
yeah what we are doing though is we're
calling the Ajax method once we call the
uploader method here which is this so we
know we've called that we know that
we've got the option stored and we know
that files isn't undefined because we've
defined this here so now all we're doing
is we're Ajax in we're sending the data
here as an empty object just to test
things out we're creating a new HTTP
request we're opening this as a post
we're opening this at the processor so
what we should now see is in our browser
when we hit upload is we should see a
network request to upload dot PHP let's
test this out so I'm going to choose the
part 1 of this video hit upload we now
see we've got a file request to upload
dot PHP and that's gone ahead and sent
an empty object so the response here or
the preview is actually nothing because
we're not doing anything we're not
uploading any files yet we've only
passed through an empty object here now
instead of this being an empty object
what we what do we need this to actually
be well it needs to be form data that's
been gathered from
files so instead of accessing old
options dot files we need to access
files dot files because there's an array
within this so let's call an object
within this rather so let's go ahead and
do a console log on in fact we'll keep
passing an empty thing here o options
dot files so we'll see what this looks
like well when i refresh choose a couple
more files and hit upload this is
basically the element that we selected
remember we have files as part of the
options which is this which is the
element we upload we selected well what
happens if I do dot files now this is a
bit confusing just because of how I've
named this but files will actually now
represent the files that have actually
been chosen via this element so when I
hit open and hit upload we now see this
is a file list we've got two elements if
we look inside of here we've got a file
here with all of the information that
we'd expect the type the size the name
and the same with the second file as
well if we just open that - so there we
go there's all that information so with
that we can pass that through so if we
just get rid of the console.log we can
pass these files through to the get form
data method within our application and
pass through the files now get form data
takes source so remember these are the
files that we're playing with and in
here we can console.log the source so we
should now see the same you know output
that we would normally see in the
console Faiz these three files hit open
and hit upload we now see a far list of
three different files now what's left to
do is actually loop through these and
send these as an AJAX request to the
father expect them to see there's still
a little bit more we need to do but you
know there's not too much else to do
apart and send the age rationale press
and listen to the stuff and then go
ahead and and output it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>