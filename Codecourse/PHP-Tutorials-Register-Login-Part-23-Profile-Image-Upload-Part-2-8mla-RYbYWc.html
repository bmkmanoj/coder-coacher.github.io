<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 23): Profile Image Upload (Part 2) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 23): Profile Image Upload (Part 2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 23): Profile Image Upload (Part 2)</b></h2><h5 class="post__date">2012-07-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8mla-RYbYWc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so we've already went over the
basics of how this is going to work so
let's dive straight in and actually
start to do this so we've already looked
at choosing a file and submitting a file
we know that we've got our image ready
to go let's go ahead and process it so
I'm going to go ahead and get rid of
this I'm going to go ahead and get rid
of in it dot PHP we don't need that
anymore and here is where we're going to
do the processing so within here let's
go ahead and check whether the forms
been submitted and this file or this
profile that's good
here this profile field is set so if is
set equal to true what is set well it
will be dollar underscore files and in
here it will be the file name profile if
it is set I'm just going to echo okay
and we'll go ahead and take a look at
this
so we refresh we click Submit okay we've
not going to file but it's still set so
we need to do some further validation to
make sure that the file has actually
been chosen regardless of whether we
choose a file we get this okay message
come up which is absolutely fine so here
we can just quickly validate this so
we're going to say if in fact let's do
this a slightly different way let's go
ahead and no we need to do that
so if dollar underscore files profile
and here we can choose the name so the
name of the file and what we can do is
say empty is equal to true if it's equal
to true we'll go ahead and just echo out
these choose a file
otherwise we want to continue and we
want to validate the extension things
like that so let's just go ahead and
check this out we'll just say okay I'm
going to go ahead and click Submit
please choose a file so I choose a file
click Submit and it's okay so we've
validated that part and now we need to
validate the file extension to make sure
the users uploading a file that we allow
so I'm going to create a very very
Brookwood allowed and this is going to
be an array of extensions that we're
going to allow so this is going to be
JPEG jpg gif and PNG so we know that
we've got this a loud array but how are
we going to compare this with the users
choice
well since the file is not up the file
chosen it's not empty ie the user has
picked a file we can now start to create
variables of the properties of this file
so for example file name name let's just
pull this down slightly so file name is
equal to well we've already established
that this gets the file name so we can
just go ahead and copy that down there
we've also got file temp I'll just call
it temp now what this basically is is
it's where the file is temporarily
stored so in this case it's TMP name as
the as the array value if you like now
we do have a file size as well that's
just like size in there I'm not going to
be doing this but you can go ahead and
try yourself
add a comparison in there of the file
size if you want a specific file size or
if you want this limited I'm going to
assume here unlimited so these will can
pick you know whatever file size they
want but it's advisable to go ahead and
limit the file size but I'm going to
leave that out here so we've got the
file name the file temporary location
what we can now do is extract the file
extension from the file name so just
underneath file name I'm going to say
file ext n
now this is going to be equal to
something well filename contains the
extension at the end so if we upload the
file that I was looking at earlier
beginner PNG this would be beginner dot
PNG now if I exploded this by a full
stop it would give me two it would give
me two elements beginner and P&amp;amp;G now
this might be hard to understand so I'll
go ahead and do this like this I'll
explode by a full stop and I want to
explode farm name now was this done well
let's go ahead and print this out print
are in fact this will just show us the
contents of the array that's been
generated by the explode function so I'm
going to print out file X T n so let's
go ahead and pick a valid file a
beginner dot PNG submit now we've got an
array here the first element the zeroth
element is beginner the first element is
PNG or the second element whichever way
you look at it so now we know that this
is a PNG file and a work the same for
JPEGs anything like that so we can
access this element the only problem
here is we never know that this well we
can assume that it's a something dot
something file but for example if I was
to change this to beginner dot image
like that I was to upload that we've now
what three elements the array and the
last ones PNG so we never know what
element this is so basically we're we're
trying to extract the extension that's
the idea of this here so what can we do
to this well we can use a function
called end what this will do is it will
take the last element of the array we
already know the first element of an
array as it's zero but the last elements
you know always going to be the unknown
it could be anything because an array
you know it's like a stack it'll add on
to it so we've got end here so now what
we can do is just echo file extn oops
and this will give us the file extension
so choose file choose this regardless of
how many
Sinnott and we've got P&amp;amp;G here now we've
got another problem and that other
problem is let me just go ahead and open
up this image or not open it up but
rename it on actual facts I don't think
I can do this just because of the way
that my operating system set up
anyway I'll explain some files have a
capitalized file extension which is very
annoying because when we're comparing it
against these options here you know we
could be comparing something with
capitals so I'm going to say STR to
lower and since end has generated a
string we're just basically converting a
string to lowercase so even though file
extension could be uh placated always
end up as lowercase and therefore it
will always match something in here
always be able to be compared properly
anyway let's move on so I'm going to
create an if statement here now we're
checking if this file extension is
allowed and we're going to use the in
array function if this is equal to true
that means we are doing something right
so it is in the array so I'm going to
check file extn and I want to check the
second parameter if that is in aloud if
it is we can go ahead and upload file
otherwise we want to I'm just going to
output a small error message so echo
incorrect file type and then we could
say we could either loop through this
array and output the ones that are
allowed so we could do this aloud and
then we could say for each allowed as
ext echo ext
in fact that's the best way to do this
we could echo implode and we want to
implode by a comet and space and we are
choosing allowed there we go
so what this will do is if we were to
choose a file like activate PHP
incorrect file type allowed : JPEG comma
jpg comma G F comma PNG comma and it's
just popper space in there
so basically imposed on the opposite of
explode and it's just sort of joined the
elements of the array with a comma and
then a space afterwards so it now looks
like that okay perfect so if we choose a
correct file it does nothing at the
moment because at the moment we've just
got a comment here but this is going to
actually upload the file okay so what we
need to do now is we need to create a
function that's going to handle this and
it's just going to be called something
like change or upload User Profile or
something like that I'm just going to
call it user profile image and this is
going to change it in fact they say
change profile image and we need to work
out what what parameters we need to pass
through to this the first one is going
to be the user ID we'll modify this this
these variables just a moment we'll just
map this out here for a second so we've
got user ID we also need to pass the
files temporary location and that's it
and then we can just store this new file
so I'm going to say file temp so we've
already got a temporary location for the
file and this is being passed through to
this change profile image the user ID we
know comes from session user ID less I'm
not sure if we created a variable for
this it's going to call an init and yes
we've got session user ID so let's go
ahead and copy that and we'll just paste
that into there so we are passing the
user's ID which is helpful because we
need to update this for a unique user
we're passing the temporary
location of the file through we can go
ahead and upload this file and then we
can upload or sorry insert or update
this users row in the table and then
point that to that file location so
relatively straightforward in users dot
PHP in the next part of the tutorial we
are going to be creating this function
and that's it just uploading the profile
picture the user has a profile picture</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>