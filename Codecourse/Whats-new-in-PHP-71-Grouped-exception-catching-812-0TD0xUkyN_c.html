<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What's new in PHP 7.1: Grouped exception catching (8/12) | Coder Coacher - Coaching Coders</title><meta content="What's new in PHP 7.1: Grouped exception catching (8/12) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What's new in PHP 7.1: Grouped exception catching (8/12)</b></h2><h5 class="post__date">2016-11-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0TD0xUkyN_c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">if I mean completely honest this is one
of my absolute favorite changes that I'm
gonna be using all the time now I've
really struggled in the past with
catching multiple exceptions and
essentially just causing a complete and
utter mess wherever I'm doing so now the
change to PHP 7.1 means that we can
catch multiple exceptions but within the
same catch block so what we're going to
do is take a look at this particular
example here which involves say maybe a
Braintree which is just a payment
provider or a payment gateway and having
some kind of charge method that could
potentially throw all of these
exceptions so just to kind of set this
up and test this out what we're going to
do is inside of here just create an if
statement to manually throw an exception
so in here I'm gonna throw a new
insufficient funds exception and then
otherwise I'm gonna throw a new payment
method not supported exception now the
whole idea of this is that these three
exception types here maybe I want to
just say to the user sorry something
went wrong so if they have insufficient
funds it's a hard decline or we have a
security violation we just want to show
a general error message now for this
exception I may want to change the
message that I send to the user and say
sorry we don't accept that particular
payment method
please use another card or something
like that so these three I want to show
one message and this I want to show
another so let's take a look at how we
would traditionally do this and then
we'll take a look at the improvements
and how this really cleans things up and
I think you'll like this so we're gonna
go ahead and create a new Braintree
instance and of course to use this we
would do something like Gateway charge
and then maybe we'd pass some kind of
token in to go ahead and charge the user
now in this case what we can do is
obviously wrap this in a try and then we
can catch any exceptions that we need to
in here so what we would do is we would
catch each of these exceptions in turn
like so so we would go ahead and just
basically chain these on so we would
catch every single one here which
already kind of rings alarm bells and
the fact that you are doing this again
and again and
really is just completely and utterly
messy so let's go ahead and implement
the final one and then we'll take a look
at how we may get around this in the
traditional sense and then go ahead and
look at how this might be better so why
would tend to do is up here somewhere go
ahead and create a message maybe it's
null this might be error could be
anything could be called whatever you
want and in here what I would say well
if there are insufficient funds I want
to just give a general message so sorry
declined and I would do the same for a
hard decline and I would do the same for
a security violation now it's important
to note that this would only be the case
if these don't extend a common exception
so say these all extended a very common
exception that was just basically a
declined exception then this wouldn't be
a problem because you could literally
just pass through the exception this
extent in this case though I'm just
assuming that each of these are their
own exception and then for payment
method not supported I want to output a
completely different exception so for
example the error here might be
something like sorry we do not accept
that card or whatever you were to say so
now what you would do down here is you
would redirect so I would redirect with
error and then I would go ahead and send
that error through maybe in a session
like a flash message or something like
so now obviously this is a complete mess
it really just fills up your controller
or wherever you're calling this with
unnecessary code it looks messy you
potentially got code repetition here as
well now the change that's been made is
very very nice what we can actually do
is instead of doing all of these we can
separate the exceptions that we want to
catch inside one catch block so I'll get
rid of this one I'll do the same for
this one as well so let's go ahead and
pop that just in there and I'm gonna get
rid of this one so what's happening here
then is we're saying well catch any of
these call it E and then do something
with that so in this case I want to
catch this one separately and I want to
catch these three separately and just
take one action if
any of these were thrown so let's just
go ahead and change that to dye we're
not working within Merivale we see sorry
declined if I just switch this over to
false we will throw a payment method not
supported so we get a different error so
that has just really cleaned up how this
looks and if you did have a lot of
exceptions here that you were manually
catching why I would probably tend to do
is format them a little bit like this so
rather than have a huge long line I
would do something similar to that now
my text editor doesn't know what to do
because obviously it's not been updated
to work with this kind of syntax but you
can see that this just generally looks a
lot cleaner we can see that we're
catching these three types doing
something with that and then finally
catching this so really this just adds a
whole layer of flexibility on to how we
catch exceptions if you wanted to catch
multiple exceptions and I really will be
using this genuinely I think it's a
really nice addition so there we go we
can catch now multiple exceptions in one
catch block</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>