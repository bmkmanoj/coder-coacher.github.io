<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Prevent Comment Spam with Akismet | Coder Coacher - Coaching Coders</title><meta content="Prevent Comment Spam with Akismet - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Prevent Comment Spam with Akismet</b></h2><h5 class="post__date">2014-07-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qmPO0E-bDMY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to look at a
service called akismet which allows you
to filter out spam by checking certain
element of something that's been
submitted and checking that against this
service which will then return whether
something is spam or whether something
isn't spam so this is typically used
with WordPress considering it's built by
the same company that built WordPress
but we're going to look at a PHP
implementation now there are a ton of
different implementations for this we're
going to be working with a small PHP
library that isn't listed here some of
the ones listed here are either not
maintained or than not great there is a
lower avail one which is pretty good so
that's worth checking out but obviously
there are you know solutions here for
lots of different services so we're
going to install a library as very small
library that allows us to do this with
just very very basic code and then you
can go off and use this however you need
to you might have a comment system a
forum contact form anything so let's go
ahead and install this library and let's
get started so the first thing that you
want to do is go ahead and sign up for
an a kiss Matt account this is really
important because you're going to need
an API key to be able to connect and use
their service now i'm currently under a
test account and this is a personal free
account but you can change the plan if
you need to upgrade to something a
little bit more now we are on our
account area here and you can see that
we've got an API key you can hit reveal
and that will give you your API key so
you're going to want to go and copy that
and make sure that you have that ready
to use when we install our PHP
dependency so let's quickly install our
PHP dependency and then we can start
writing some code to see how we can
actually use this so over in my text
editor at the moment I have absolutely
nothing here well the only thing I've
got is an index file with an opening PHP
tag now if you haven't got composer
installed you're going to need to go
ahead and
composer just however to get composer
org and download that is to a PHP
dependency manager you can obviously
manually take this from the github page
if you wanted to but it's a lot easier
to use composer to manage your
dependencies if you want to do this
manually you can just hit download zip
just here so let's create our composers
or JSON file inside of our main
directory here and we want to require
this in as part of this project now it's
rib code and then its service hyphen a
kiss me and then we installing this from
dev master and this is this repository
just here so let's go ahead and do a
composer install with in that directory
and wait for that to install okay great
that's done now it does suggest we
install EXT curl I'm not going to do
this for now I'm just going to go ahead
and give us some basic examples here so
the first thing that we need to do is
instantiate this and then go ahead and
inject in this connector which is
basically a curl wrapper so we're going
to go ahead and just copy this I'm going
to be a little bit lazy and just paste
this in now we're ready to now start to
use this a keysmith here you can see
it's namespace quite heavily if you
don't understand this it's basically
just namespacing these classes under
this which is pretty sensible in this
case so that's what this is if you if
you're not sure now the next thing that
we need to do is this is slightly
misleading we have this check key method
here it asks for an API key and a blog
URL which is again a little bit
misleading it doesn't necessarily have
to be used for a blog it can just be
used for what any content really now the
blog URL I'm simply just going to type
the address of the website that I'm
going to use this on it doesn't have to
really be you know exact and under my
account area like i said earlier make
sure that you've got your API key handy
if you've signed up for an access my
account and we're just going to paste
this in here now this will actually
return a true or false value depending
on whether this was successfully checked
or not
and whether it was validated or not so
you can imagine that if we run this now
with a rapt invite via dumped out of
course we didn't include our autoloader
so if you're unfamiliar with composure
it comes with an auto load file which
will also load all your dependencies in
so we need to do is say vendor auto load
up the HP and require that in so here we
get if we just wait for a moment a
boolean of true now if I was to change
this maybe add an X on the end just to
test things out we should get a false
value back so as long as your API key is
validated you should be good to go and
actually start using a kiss me okay so
the next thing that we want to do then
is actually look at sending some data to
a kiss met to be to be evaluated or or
to be checked so think of it this way
you have some content that you want to
submit say you allow users to sign up
for your website they can then post a
comment in a forum or post a comment on
an article or something like that now
they're going to have a username
presumably or just a name they may have
a URL their website you lover to have
the body of the comment etc etc and we
passed all this information through to a
kiss me based on their checks they will
give you back true or false and say this
is spam or this isn't spam so the first
thing i want to do really is construct
an array which will contain all the
information i want to send off to a kiss
me and this array is going to represent
first of all the data that the user
sends initially it's also going to
represent the data that you might be
storing in your database and therefore
something that later you could say to a
kiss me hold on a moment this isn't spam
so let's create this array now I'm just
going to call this data just for
simplicity and we're going to introduce
a few keys here now at the moment there
is a bug in the I think there's a bug in
the this wrapper that i'm using all this
library that i'm using and it doesn't
pick up on
obviously we're not we don't have a
refer if we just saw refreshing the page
so I'm going to go ahead and just
manually add in an empty referrer now
there are a variety of things that you
can pass through to a kiss me amongst
which are the permalink the comment type
then the more important things and the
things that I that probably distinguish
spam and ham are things like the comment
author so this might be something like
Alex Garrett for example and we're going
to change this in a moment just so we
tell that we sort of say to a kiss me I
want you to deal with this as a spam
comment we can test in that way now
obviously the email address tends to be
quite important when you're sending
things along so if the users registered
with a new email address you could send
an email address along with this as well
we also have as I mentioned very briefly
earlier a comment author URL so i could
just enter say my website URL that's
been put into my profile or whatever and
last but definitely definitely not least
is the comment content so this is the
content of the users post so I'm just
going to say hello there this is a host
so that's all really all the data that
you need to send but we're not actually
sending this yet we need to utilize the
academic instance that we instantiate at
a moment ago so i'm going to say equis
met and i'm going to use the check
method and we'll look at a couple of
other methods in just a moment and i'm
also going to store this in a variable
so i can actually do a VAR dump on that
and check whether the return value is
true or false so inside of check we add
our data of course you could directly
put this array into here but in my case
i'm just putting up here for readability
and down here i'm going to do a VAR dump
on the result now ordinarily you might
do an if statement here so you might say
if result or if not result that was spam
otherwise
that was not spam and we'll talk a
little bit about the processes that you
might want to go through if things are
marked as spam I've already mentioned
but we'll look at the send ham method on
this library as well so at the moment
I'm going to devour dump on the results
so we should get a false value here
unless something's gone horribly wrong
so it looks like something has gone
horribly wrong so I'm just going to say
hello there see if that changes anything
maybe get rid of my url I think I might
have accidentally submitted a something
with this these details before with the
viagra test user name which we'll talk
about in a moment does sound a little
bit strange let's just check if that
changes anything and yeah there we go we
get a false value back so there might be
something there that when it wrong but
in the majority of cases you won't have
things submitted that are genuine it
I've just been because of that comment
so now that we have a result that is not
spam so in this case what we might want
to sorry in this case what we might want
to do is store the users comment and
just go ahead and just do things as we
would normally do now if something is
spam and how do we test bar that example
I just did there that return true how
can we test if something is returning
true now there's a username that you can
use or an author that you can use that
will always regardless of all of the
other data that you send through to a
kiss men will always give you a true as
in this is spam and that is viagra
hyphen test hyphen 123 no spaces so that
will always like I said despite any
other data give you a true value back
like that so you can use that to test
whether this works so for example you
can even sign up on your own website
with a user called viagra test 123 post
a comment that comment because of their
username should always be sent
as spam now if that was spam what do we
want to do well we want to store the
users comment anyway because this could
be an innocent user that's come along
perhaps has written something that a
kismat has mistakenly identified as spam
you don't want to delete that comment
because then you know the users work is
lost so what you want to do is store the
users comment you want to have a process
where you manually check spam marked
comments so you know you could send an
admin an email you could have a little a
dashboard that you know gives you things
like that now once you have checked a
comment let's say for example this
comment here was entirely genuine or for
example the one before this was entirely
genuine what you then want to do is once
you have manually checked and submitted
the process would be like this and let
me just get rid of this so you've stored
something anyway but you've hidden it so
other users on your web site can't see
it what you would then do is you would
go ahead and you would use the send ham
method so you would do something like
let's just get rid of this result here
this is if the comment was not spam you
would do something like the following
you would say a kiss met send ham data
and that will send this data to a kiss
me and say this is not spam this was
mistakenly identified as spam and then a
kiss met can improve their services by
changing you know whatever algorithm
they used to detect this now in this
case this doesn't matter because i'm
using the viagra test user and that
means that you know a kiss me i'm not
going to say Oh a Holden minute this
user name is genuine because this is
just their version this is just their
way of testing or allowing you to test
this service as in returning true for
spam so if for example you have stored a
comment which has gone through as not
being spam then what do you do you need
the opposite pros
to be able to say to a kiss met hold on
a minute this comment slipped through so
for example if it's a forum users might
be able to mark it as spam that might
then go to you and you might then be
able to review them comments that marked
as spam and then send them to a kiss me
as spam so it can equally have the
opportunity to train itself up to deal
with comments a lot better so instead of
these so if the this would be if the
comment went through but was spam you
would then send spam with this data so
now when I send this this is going to
take all of the information that I have
provided in here and it will analyze
that and say well you know someone
through our API has told us that this is
spam so that is a very basic
introduction in fact it's a thorough
introduction because this service is so
easy to use especially with rappers like
this this can be used like I said with a
lot of different languages a lot of
different services there are plugins
things for larva packages for laravel so
it's really easy to integrate into your
project and as you can see it's
extremely easy to use the only hard part
about how you're going to store things
for review but obviously that's entirely
up to the flow of your application so
that's an introduction to a kiss met and
how you can help prevent spam on your
website</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>