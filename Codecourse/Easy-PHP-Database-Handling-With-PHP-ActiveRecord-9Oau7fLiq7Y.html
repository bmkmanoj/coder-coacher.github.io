<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Easy PHP Database Handling With PHP ActiveRecord | Coder Coacher - Coaching Coders</title><meta content="Easy PHP Database Handling With PHP ActiveRecord - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Easy PHP Database Handling With PHP ActiveRecord</b></h2><h5 class="post__date">2014-09-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9Oau7fLiq7Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to be using an
open-source ORM library to access our
database and we're going to be
implementing this into an example
application this makes it really easy to
access your database whether you're
creating records updating records
deleting records or creating relations
between different models so let's jump
in with an example of how this might
work at the moment on the index page of
this project I've got absolutely nothing
and we're going to be using this index
file here it's just a test ground to do
things however when it comes to it you
might be using active record
functionality within controllers perhaps
or other classes so inside my database
then I've got a table called users here
I've got three columns here one is ID
which is just an auto incrementing ID as
you'd expect a username and an email now
how am I going to access these records
with PHP active record well in this case
I've set this up so my user model
relates to my user database table and
this happens automatically I'm using PSR
for Auto loading which we'll also be
discussing a little bit later when we
build this application up from scratch
it won't take too long but it is a much
better way to structure how you work
with your application anyway say I
wanted to access a user with an ID of
one I'm going to create a variable here
and I'm going to use the user model
which I've imported just up here and I'm
going to use the find method here this
is a static method so I'm going to find
the user with an ID of one like so and
down here I can then do echo user and
then perhaps I want to grab the user
name from this so as you'd expect at
user with an ID of one we have a user
name of Alex so you can see here we now
get Alex out and of course you can do
the same with email like so and that
will give the email address out so what
about creating records well we can use
the user model like so and we can use
the create method passing in an array of
the data that we want to insert
so as you'd expect we do username here
we choose a username and we duplicate
that down and then maybe fill in an
email address here and do the same for
that so pretty straightforward stuff
this makes it really easy to do things
like this there we go when we go back to
our database we refresh and that records
been created so you might have seen
things like this with laravel gsella Qin
if you work with laravel if not don't
worry this is an alternative solution
that you can implement into any project
pretty much and this makes it really
easy to do so we're going to be using
PHP active record like I said as an open
source RM library an object relational
mapper library and that's based on the
active record pattern which is why it's
called PHP active record and if you're
not sure the active record pattern is go
ahead and look it up and it'll explain
that pretty straightforward so we're
going to be putting this in from
packages so you will need composer
installed if you don't have composer
head over to get composer org and
install that so you can use it on your
command line that works for pretty much
all operating systems so let's get going
look at how we can install active record
and we'll add it to our project to see
how we can use it as we've just seen so
as I mentioned we are going to be doing
this completely from scratch and it will
take a little bit longer than you might
like to set up your application but the
benefit will pay off later down the line
when you go to expand your application
in the future so I have a terminal open
here and as long as I have composer
installed what we're going to do is
we're going to pull in PHP active record
as a dependency and we do this from
packages which works directly with
composer so basically what we want to do
is we want to pull in a version of this
into our project as a dependency if you
work with composer before this will be
completely straightforward to you
otherwise just following the steps and
I'll try my best to explain as we go
along so the first thing that we want to
do is if we run the composer command we
can go ahead and search for packages we
know that this exists at PHP - active
record and then slash and the same thing
so what we can do is we can show in for
Meishan about this package so we can say
composure show PHP - active record / PHP
active record and that's going to search
my composers JSON file which I doesn't
exist at the moment and then it's going
to look under packages and there we go
so we've got the information about this
we know that we want to pull in version
1.1 and we'll pull it in 1.1 got star so
all we do is composer require and then
PHP - active record slash PHP - active
record like so and then it asks us to
obviously provide a version requirement
in this case 1.1 go star so that's
created a composer JSON file if I open
up my text editor here and expand this
you can see that not only has my
composer that JSON file being updated
with the required property it's also
downloaded this dependency as well so we
now are able to include this within our
project which is really cool so we're
going to set up a basic structure to our
application and we're going to be using
PSR for autoloading
just so we can namespace our classes and
make it a lot easier to pull in
everything that we need
it just takes out the hassle of having
to go ahead and manually require each
class in its inside of my active record
directory I'm going to create a new
folder called app now inside of this I'm
going to create a new file and I'm going
to save this out as start dot PHP this
is where we're going to start up
everything in our application that we
need in this case we need to require in
the dependencies that our application
requires and we can do this easily by
requiring in the autoload file within
the vendor folder so if i just open the
vendor folder here we've got auto load
dot PHP so i'm going to require in then
I'm going to hit dir concatenate this
onto going back a directory interventive
dot PHP that's essentially a way of
saying go back a directory include
vendor
autologous recurrently within the app
directory here so now that we've got
that let's just create a index file
inside of our main directory just
something we can test on here and we
obviously now need to pull in our start
file so that's an app start PHP so we
then start you can start obsessions and
do whatever you want so inside of here
we're going to be testing now what we
need to do is go ahead and connect with
active record at the moment if I open my
browser you can just see we get an empty
page no errors which is a good sign so
we need to use active record to
initialize a connection somewhere so
let's go ahead and do that now
it's namespaced under active record and
what we're after is this config and we
use this initialize method and then in
here we pass in a closure we have a
config argument here and then we're
going to go ahead and use this to set
our connections let's just bring this
down a little bit so set underscore
connections is a method that we use to
basically set the connections that we
want to see and we can do this under
different environments for now I'm just
going to demonstrate it under
development but you can choose this
depending on your different environments
here so we need to define which driver
that we want to use so in this case it's
MySQL and then what we want to do is
provide the username and the password
in my case it's root and root then we
need to connect to the host in my cases
1.7.1 and then we do a forward slash and
choose the database name in my cases
website as we saw up here if you don't
have a password don't worry just get rid
of that it might look a little bit
strange having the colon and the @
symbol but that's just how you would
structure it so let's go ahead and
refresh now and see if we haven't done
anything wrong ok we have looks like
I've spell initialized wrong like so and
there we go so what we now want to do is
look at PSR for auto lo
because what we can actually do within
this config is define which folder that
our models are kept in that's a little
bit tricky because we might just not
have one folder inside of our app
directory that holds all of our models
you might do in which case you could
have a models folder like so and you
could say something like config set
model directory and then in here you
would define that it's in app models
like so or just models in this case
because we're already within the app
directory and from there what it would
do is it would pick up all of the models
inside of your models directory and
allow you to extend active record but in
our case we want to structure this a
little bit differently with psr-4
autoloading
and active record will support that so
let's delete that models directory and
we're going to head over to compose JSON
to also load everything in so in this
case we say also load and normally we
would provide maybe something like a
class map you might have seen but in our
case we are using PSR for Auto loading
if you're unsure that is we do have a
lesson on on this so you can go ahead
and check that out
otherwise you can head over to the PHP
fig website to read up more on yourself
or autoloading so in this case we need
to provide a namespace this is the
namespace that our our root namespace in
this case it's going to be code course
and then we provide a double backslash
and now what we want to do is provide
for the value of this where this is
stored in this case it's going to be an
app code course now we haven't created
this yet so let's go ahead and do that
now create a new folder in here and
we'll call that code course now this is
where the hits are for so loading comes
in we can have whatever directory
structure we won as long as we namespace
this in the same manner the classes will
be automatically loaded in using
composer but in this case what we won't
need to do is we need to refer to
composer and you dump autoload passing
in the optimized flag
now what that will do is it will dump
all of the classes that you have inside
of your directory structure according to
your name spacing and allow you to use
it pulling in Auto load it might seem a
bit confusing but once we start to
create some classes it should make sense
so inside of here we might have a new
folder called users and then inside of
our users folder we might just have some
generic class that allows us to access
the users database table in this case
the class is just going to be called
user not users so we save that as user
dot PHP and we need to need to namespace
this according to psr-4 specification in
this case we use the namespace key word
we say code course slash users like so
because it's code course users and then
our resulting class is user so whenever
we want to use user we'll have to refer
to this but we can just import them at
the top of files and we'll be looking at
how we do that in the index file in a
moment so now that we've got our class
user how do we actually go about tying
this to our database table users
it works on plurals so in this case our
database table is going to be called
users and this will automatically pick
that up because we've called the class
user you can modify this so go ahead and
check out the PHP active record
documentation and that will show you how
you can define specifically which
database table that you want to use now
we need to extend active record here ah
we can't just do this because what's
going to happen here is it's not going
to find this class if we go ahead and
dump our autoload again and we go ahead
and refresh and try and use this user
class so inside of index so we could do
something like use code course users
user we could say something like user
equals new user now when we refresh it
says class code course users active
record not found
that's simply because inside of here
it's assuming that this is namespaced
under this but what we need to do is use
active records model and we'll just call
that active record just so it makes
things a little bit more readable so we
say use active record model as active
record you can call this anything you
want or you can omit this all together
and then you can just refer to model
here but I like to call this active
record so now that we're using that we
should no longer get this error because
that class has been found because we've
provided the correct name space and
we've imported that up here now we don't
need to write any code inside of this
class which is brilliant because what we
can now do is use all of the
functionality within active record this
model class here because we've extended
the user class so now what we can do is
go back to index and we can start to
play around with this user model that
we've imported up here so we can go
ahead and try that out now
okay so inside of sequel Pro I've got a
couple of records I'm just going to
delete let's say we'll delete everything
here just so we can start afresh
so we'll delete all of these rows so
let's head over to here I'm going to say
user create much like we saw at the
start of the video and I'm going to
provide a user name here and call that
say Alex and then we'll provide in the
email as well and we'll say Alex echo
course comm so now when we go ahead and
refresh here because we've extended
active record we now have access to this
create method and as you'd expect that
record has been created inside of our
database table and likewise we could say
something like user equals maybe user
find and let's say we had some kind of
session stored somewhere in our
application for example in start of PHP
let's say you had session started up
here and you assign something to a key
in the session superglobal array
so for example user ID let's say that
was one you would then go ahead and
reference that inside of here
there's obviously better ways to do this
but you would say session user ID and
then what you could do is you could say
something like echo user user name and
that would then pick up that record with
an ID of one of course at the moment we
don't have a rep ID of one we have an
idea 15 so I'm going to need to change
this inside of my start our PHP far to
15 and then go ahead and there it is so
there's much more you can do with active
record this has just been a little
taster about how you might set it up
within your application but we can do
things like relationships between models
you can update delete create as we've
seen there's a lot more that you can do
here so go ahead and check out the PHP
active record documentation and see how
you can integrate and use this within
your next project</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>