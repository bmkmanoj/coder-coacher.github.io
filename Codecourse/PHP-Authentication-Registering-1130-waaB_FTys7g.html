<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Authentication: Registering (11/30) | Coder Coacher - Coaching Coders</title><meta content="PHP Authentication: Registering (11/30) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Authentication: Registering (11/30)</b></h2><h5 class="post__date">2015-05-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/waaB_FTys7g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're finding Leon - the ability to
register a user and this kind of comes
in three parts so in this part we're
going to look at actually creating the
route building up the form and actually
storing the user record in the database
along with the hashed password that we
created in the last part the ability to
create hashed passwords and then in the
next part we're going to look at
validating the form how we use the
validator to validate and then we're
going to add the unique user email and
username checking so let's get started
then with adding a link in our
navigation and creating our route so the
first thing I want to do then is under
my routes folder here I'm going to
create a new folder and this folder is
going to be called off so it's going to
be anything to do with user
authentication so for example this could
be changing a password activating an
account registering logging in and
logging out so we'll create a new file
in here and I'm going to call this
register dot PHP and let's create create
our route so app yet register and in
here we need to render out our register
view let's also give this a name we'll
call this register so the view then we
need to create we're going to follow the
same directory structure as the routes
so under here we're going to create a
new folder called auth and in here we're
gonna create a new file and call this
register PHP and this is just going to
be the registration form so we've got
our route set up and we've got our view
set up let's go over to our base routes
file and hook this in so this is under
earth and it's called register so now we
will be able to visit register in our
browser and we have our route so we
could I guess just render this view out
quickly so app render
both register dot PHP and remember we
need to use app so it's in this scope
and then we have our register page let's
add this to the navigation so under
templates and navigation we want to add
this here so register we will need to
eventually protect this link because
when a user is already signed in we
don't give the option to register so
we'll be doing that in just a moment but
register there so URL for register
because we have a named register root
and then in our navigation just here we
have register so we can click through to
our register page perfect so let's focus
on our view now so we'll build up our
form and be able to submit this through
and then we'll have another route which
will pick up the posted variables that
we send through so inside of here we
need to do the same as home dot PHP by
extending the default template I'm going
to just copy and paste this just to save
time I'm going to paste that into there
and for the title we can change this to
register and the home will replace with
register so under register now we have
register up here and we have this within
our main template so let's build the
form then so inside of our content we
want to create a form the action is just
going to be URL for register dot post
now this is the post route that we're
going to be creating to be able to post
what this user sends through and this
doesn't exist at the moment so let's
just quickly define this out now just so
we have it there so post register and
again we use a pin here and in here
let's just echo out form post it like
that so when we submit this form through
we'll just get that form posted text
output so the method here is post and
I'm going to turn autocomplete off just
so we don't get suggestions when we're
typing in emails and user names so we
obviously don't have any
here so I'm just gonna wrap each field
in a div of course you can go ahead and
use maybe a front-end framework for a
grid system or whatever you're using to
star this out nicely but we're gonna
have a label first of all for the email
so this is going to be where the users
gonna enter the email address and we
have an input type of text so an input
type of text we give this a name this is
the name will pick up within PHP and the
ID is so this label recognizes this
input okay so now that we've got that in
there let's do the next one
and again I'm just going to copy and
paste these down so the next one is for
the username so we type in the username
here and we'll change the name here to
use the name and the ID to use name as
well you can also use a type of email if
you want front-end validation here but
we'll just leave that as it is because
we're gonna be doing the validation on
the backend so next is the password this
does require a type of password so we
can sort of blank out the password as
the user is typing and let's change this
to password and we'll say password and
the name and the ID as well and we're
gonna have a repeat password so the user
is going to have to confirm their
password so we're gonna call this
password underscore confirm and here
we'll say confirm password and again
we'll say name as a password underscore
confirm and ID password confirm and last
but not least we want our submit button
so we're gonna have an input type of
submit like so and in here we'll just
say register so we now have the
following of course we haven't named our
register dot post root here so let's
just do that now that's why we saw that
error so register dot post and we can
refresh and see our form and we can hit
register and we see form posted so as
easy as that nice and broken up into two
routes we've got our view here
completely separate from our logic
that's going to happen in here and we
are all ready to go so now what we're
going to do is build out the actual
registration for
Oshin ality to put the record into the
users table so we can actually register
the user like I said before we're not
going to be dealing with validation at
this point we're going to do that next
and we're not going to be dealing with
activating the user's account we'll do
that in a separate part as well so how
do we get the posted data well normally
we would do something like post username
or post email but Slim has helped us to
let us do this and this all comes from
the request so what I'm going to do is
I'm going to create a variable called
request and say app request that's going
to store everything that's been sent
through to this route now and various
other things so what we can do is we can
say the email is request post so that's
the method email and the user name is
going to be the user names these just
the names that we gave in the form and
we also have the password here and we
have the password confirm password
underscore confirm so we have our posted
data now and all we need to do is put
this into a record but obviously what we
need to do is we need to hash the
password at the same time now cast your
mind back to when we created our user
model we can use our user model to
create a record and we also remember
attach this to Slim's container so it
was called user so what we can do now is
let's just close these off we can say
app user and then we can use eloquent
spunk Chenal 'ti from this model to
create a new record so all we do is we
so create we pass an array in with the
properties of the column name that we
want to fill so we want to fill the
email address in as the email that we've
given up here we want to fill in the
username with the username that we gave
we want to fill in the password like
that and that's it for now we're not
adding activation or anything like that
this password is now going to be stored
as plain text
we need to hash this password so
remember we have app hash which is our
class that we created which we attached
a slims container and we have our
password method which lets us hash that
password so now what we can do is flash
a message which we've already seen how
to do so going to flash global and we're
going to say you have been registered
and then we're going to redirect the
user to the home page so we're going to
say app response redirect and then we'll
grab the URL for the home page and that
will redirect us so let's give this a go
and see what we get when we submit this
form so I'm going to type in my email
address or an email address so I'm gonna
say tabby at Koko's comm or give a
username we'll type in a password which
will be validating later to see if these
check etcetera and we'll hit register
okay so we have a query exception
unknown column email let's just have a
look here okay so we haven't stored the
email in this table so let's do that now
so far 255 should have really noticed
that but we have the email now stored so
that wouldn't have created a record so
if we just refresh here we have no
records let's try it again and let's
also make sure that you now use a model
we have email as fillable yes we do so
let's again register an account so hit
register and there we go so we get you
have been registered we refresh that
goes and we now have a record inserted
into our table so we've got the username
here an ID of one because it's the first
record that we've created we've got our
password which is hashed here active is
set to zero so we'll have to add in an
email activation and everything else is
null and we also have a Creator that day
and we also have an update to that date
as well in here I'm guessing what it's
doing is just adding that in any way but
that is pretty much it to register but
of course what we need to do is at the
point of when a user does register
we need to validate so what we're gonna
be doing in the next part is setting up
our validation class which is going to
extend violin which is that package we
pulled in in the first part of this
series and then we're going to actually
validate this data and if it fails we're
gonna take the user back to that form
and we're going to show them any errors
that happened along the way</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>