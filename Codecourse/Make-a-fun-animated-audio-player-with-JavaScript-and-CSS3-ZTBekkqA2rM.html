<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make a fun animated audio player with JavaScript and CSS3 | Coder Coacher - Coaching Coders</title><meta content="Make a fun animated audio player with JavaScript and CSS3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make a fun animated audio player with JavaScript and CSS3</b></h2><h5 class="post__date">2014-11-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZTBekkqA2rM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi my name is Travis usually you can
find me making a mess over on the dev
tips YouTube channel but today alex has
invited me to talk to you guys about
some of the cool things I've been doing
lately you know you can make a really
fun music player that animates and moves
with the beat of the song here's a
preview of what we're going to be
building today you can see that the
player is pumping along to the beat of
the song adding interest and Dynamis
into the experience but most of all it's
just really fun so what we're going to
cover today is the JavaScript required
to play the song and then how to use
that to animate the player but first we
actually have to make the song alright
now let's get to work okay I'm not going
to start from scratch I have a little
thing designed already and let me show
you what that looks like here is the
markup it's all inside of an article
called player and I have you know a
headline and then here is where the the
animated kind of magic is going to
happen we have a spinner wrap an inner
and outer spinner and then the play
button which I'm calling a place bright
because it's going to turn into both the
play button and the stop button once
it's playing me show you what that looks
like in the rendered markup so here's
that spinner wrap the outer spinner the
inner spinner which is the smaller
circle here and then the place bright so
right now it doesn't work it's it's just
like this kind of static HTML right now
and with a headline above it pretty
simple let me show you also the sass
that's involved it's just exactly what
you'd expect to have the background
color and you know the headlines here
just they're just styled text the
article is just positioned and sized
with the spinners having different sizes
and
backgrounds applied to the different
inner and outer spinners and yeah it's
pretty simple to play sprite you notice
that place bright here is this let me
show you the images actually so this
will be the the place bright it's a both
a plate and a pond stop button and then
here is the center spinner and there's
the outer spinner you can see that
they're applied on to a dark background
to get to get this look here both kind
of layered over each other now we're
coming to play in a little bit when I
start animating these in a circular
fashion but right now we want to focus
on the first step the first step is
getting this player to play music when
we've clicked the button now also I want
to show you that I've taken the mp3 from
that song that I made in front of you
guys and I've also converted into an OGG
an OGG so it can play in Firefox browser
but the mp3 and the are going to be
stored inside of this audio tag right
here it's an HTML audio tag and it's set
to loop and the only custom data type I
have right here is that I'm just
capturing the the beats per minute and
it's 86 beats per minute I know that
because I programmed it but if you're
not if you didn't make your own song you
want to like put like a popular song you
can easily do a search on the internet
for any popular song beats per minute
and you'll find that out pretty easily
so I'm going to put the beats per minute
here in a in a data attribute and that's
kind of all I need so it's an audio
html5 audio tag and I have two sources
listed and they are the sources of the
jam sauce mp3 in the gem sauce so Gigi
and that is all we have for the markup
okay like I said the first thing we need
to do is get the music to play when I
click this button that's the most
important thing because what is a music
player that does not play music so I'm
going to run over to my JavaScript file
and and I'm going to make those controls
look like this you use jQuery to select
the player acts
let's have it select the JIT not the
whole player but just the spinner wrap
right so spin a wrap and when you click
it will have a function callback alright
this was what will happen when we click
the spinner the first thing I want to do
is just capture what we've just clicked
and I kind of do this a lot I'm going to
save our this and what I'm this is
called caching a variable this okay so
instead of dipping into the Dom every
time and discovering what this is I'm
just going to cash it in a variable
right there so it's a little bit more
efficient code and next I'm going to
identify the audio tag so say audio
actually not really necessarily the
audio tag but the the source the song
within the tag and this is how we'll do
that we'll say this and now because the
audio tag is actually a sibling of what
we just clicked we have to identify it
as a sibling so we'll use jQuery to say
siblings that have the tag of audio get
that and then look at the index of zero
for the actual audio okay now we want to
do is now that we've captured where the
audio tag is we got the song we want to
say call that variable audio play and
use a function to play it
alright let's save it and see how far
we've gotten right now I'm just going to
click this issue should should work it
anywhere in the spinner rap when I click
it ok we can hear the music but I
noticed that I cannot turn it off right
this is because I've not written any
controls here to turn off
so I just have to refresh the browser to
turn it off and that's no good so the
second thing we want to do actually
before we move on I just want to write a
quick statement that will say when we're
playing the audio let's add a class to
the spinner rap because we're adding it
to this and we'll and we'll put a class
of plank okay that's good alright so
what we want to do actually let's see if
that class the class should show up here
it here on the spinner rap there you go
playing cool so what we want to do is
now enable the user to turn off the
audio if they click it again I'll have
to set up an if-then statement and that
will look something like this if the
audio is paused so if the audio is still
playing then take that audio and pause
it and then we'll say and else and we'll
just tuck this stuff into that else
statement right here okay so what we
saying is when you click on this button
check if the audio is paused if it's not
paused then pause it if it is paused
then play it so when we first arrive
it's paused so let's click in and a
place now we click it again it should
pause and there we go it's cool so you
see how it is real it early pausing it I
want to reset that to where it goes to
the beginning every time then we'll do
that by saying like when you pause it
set it
to the current time is equal to zero and
now when we play it pause it and play it
I'll start from the beginning of the
track now that's going to be kind of
important because we're animating it to
the beat we need to know really where
the beat is and also now that I know
that I've turned the audio off I can
take this right here this class of
playing and I can remove it so I'll say
remove a class of playing so when when
the music starts this spinner wrap right
here should have playing a class on it
and then when I stop the music it should
be removed there we go perfect now we'll
take advantage of that by moving over to
our CSS finding that place right here
will say when there's a class of playing
that's a parent of the play sprite will
take the background position and we'll
move it to zero pixels and now because
the image itself of the play sprite is
140 we're going to divide it by or 1/2
and turn that into a negative so that's
negative 70 so 0 negative 70 pixels all
right let's see we got so what should
happen here when I click it it should
the plate the play class will start on
the spin wrap and this button should
turn into a stop button a stop icon it's
wonderful that visual feedback is really
really important to the user to help
them understand what's going on all
right let's go back to our JavaScript
and the next thing we want to do is
expand this variable and discover a few
more things about the
audio that we have the first thing I
want to know is when I look at this
audio tag I want to get this number here
this beats per minute that's going to be
really important to make the animation
move along with the music so I'm going
to say I'm going to make a variable
called BPM equals this which is the the
thing we clicked siblings actually it's
this right here audio and then from that
audio I want to find the data attribute
of BPM let's do a console log and get
that BPM to make sure we've captured it
correctly from that audio tag so if I'm
going to go to my console here hmm when
I click this play button I should get
the number right here the bpm
it's 86 right did it correctly cool
fantastic so now I know the beats per
minute all right now the second thing we
want to do is take the BPM and transfer
it into milliseconds and this will be
the rhythm with which the music player
will actually pulse so I'll call this
pulse equals the BPM and we'll multiply
it by a thousand and then we actually
have to before we multiply it by a
thousand we will divide it by a sixty
loops by 16 and we should have let me
check the pulse right here all right so
let's check that pulse and this is going
to be the number in milliseconds that
that are that our player is going to
animate like we saw in the preview all
right now before we start pulsing things
and getting to the exciting bit I want
to show you how to move these circles
concentric Li in in different ways and
it adds a lot of a lot of interests on
the hop over to the CSS we're going to
find that outer spinner here and we're
going to say when there is a class of
playing similar to what we did with the
play button playing wrapped around their
you wrapped around our outer spinner we
want to set an animation to happen right
now let's define that animation down
here in keyframes and the first
animation is going to be just to you
know spin it spin it clockwise so let's
just call it that we'll call it keyframe
spin CW for clockwise okay and how
that's going to work is I'm going to
start it from inside there from I'm
going to rotate it and I'll do it with
the transform
start at zero degrees and go to 360
degrees and then we can go back up to
our playing and this is where we will
put the animation so animation spin CW
and I want that to last about five
seconds and linear will be my timing a
fun time 'uncle time function something
like that and I want it to go infinitely
so right infinite cool so hopefully if
we did this right when we click play the
music will play and this outer ring will
it will spin clockwise or refresh oh
that didn't work because I wrote the
selector wrong playing play link try
again Oh
get another misspelling linear okay
thought I was going crazy there okay so
now the spinner is going to clockwise we
want to do the same thing with this
inner spider here so let's make another
keyframe function very similar we'll
call it a spin clock counterclockwise so
CCW and we'll make it go from 360 to
zero the exact opposite and we'll take
this same thing and we'll move it down
to the spinner center and put CCW on the
spinner Center let's play it check it
work all right
it feels great already huh really fun to
see
all right now this is where it gets
really fun we have this in our
JavaScript we know how fast the music is
so what we can do is every time that
there's a beat we can make something
exciting happen and what I want to show
you is I want to make another keyframe
and I'm going to call this one I call it
pulse and we'll say from I want to take
the thing and transform it but this time
I'm going to scale it up to 1.3 and then
to copy/paste and we're going to scale
it up to actually going to just bring it
back down to 1 so what's happening here
is gonna it's going to make it big and
bring it down to 1 over the course of
this of this keyframe so let me show you
what that can be like and I call this
pulse right so let me show that can be
like on the spinner wrap okay
spinner wrap I'll say and playing
remember the spinner wrap here in our
JavaScript that's the one that gets the
class of playing so we want to say when
the spinner wrap has a class of playing
not when it's wrapped by a class of
playing we want to say animation a pulse
will make it go oh point five seconds so
half a second linear and just make it
happen once not infinitely actually
let's just go infinite happen an
infinite amount of times so let's check
it
alright that looks really really cool
and really fun for the problems we
listen to the beat you see what I'm
saying it's just not working it's not on
beat so what we want to do is use our
JavaScript script to control this I'll
say it just bounce it just once alright
just happen just one clap first one okay
and I'll go into my JavaScript your
scrip your scripts and make a function
called pulsing alright now this function
finds this and adds a class called
pulse and then we will let's see when
the audio plays we will start the
function called pulsing right so I want
to make the animation that we saw here
dependent not on a class of playing and
but on a class of pulse and it should
have happened just once but what this
gives us even though it doesn't look any
different than what we had a second ago
what this gives us is that we can
control it with the JavaScript now and
the JavaScript remember knows how fast
our pulse is so we'll take this pulsing
and we'll set a timeout function
we'll say we want this we want this set
timeout to happen every every beat so we
use the pulse time here right and in
that set timeout function we'll be
removing this class of pulse and I want
to actually - a little bit take a little
bit off that pulse so that it so that it
can read it can remove the class of
pulse fast enough so where it won't be
confused when it adds it at the same
time you know because if the ad is going
to be happening at the same time as
pulse the removed needs to happen a
little quicker than pulse so what am I
talking about what I'm saying adding it
by the same time impulse I'm doing this
add the class every pulse amount of time
and I'll do that by using a function
called set interval and in my set
interval I will write a function that is
calling the function of pulsing and
it'll do that in at an interval of pulse
does that make sense I really hope that
makes sense
okay let's see what we got it works
see now that pulse class is being added
and removed on every beat this is
because it's being well because right
over here we've timed the info
whoa some craziness going on there
now what's happening there is we're not
clearing the interval so I need to use
the clear interval when the when the
audio needs to be paused right so clear
interval I can get the interval ID well
I haven't set that yet but I'll just
I'll just call it intervals right so
what I need to do is wrap this or just
place this set interval inside of the
variable called intervals
and then when I clear the interval
little know what I'm talking about right
does that make sense I hope it makes
sense javascript is kind of one of those
that are kind of like windy roads right
so anyway let's try it try this again
play the song it's rocking out to the
beat stop the song and the clear
interval function right here has stopped
the pulse from Earth has stopped the
pulsing function from happening on every
pulse which is defined by our beats per
minute right so let's just look at our
handiwork that is something beautiful I
really like it okay be sure to check out
the dev tips github repo to get all the
code here and the animated music player
repo where everything is is ready for
you to go I even have a working demo
here and on github github pages you can
test it out and play with it right now
and that link will be in the description
now we are done and you have the coolest
music player on the internet for more of
my face telling you Cody type things
check out Deb tips channel last week we
did a video called the top five hacks in
bootstrap 3 it's really good you can
find a link to that in the description
below and also check out my vine account
called just the tips where I focus on
quick actionable tips for maintaining a
healthy and productive creative
lifestyle
I dropped knowledge like this to be an
effective creator
choose one thing to do today and ignore
everything and everyone else until it's
done and this when doing creative work
going to hyper-focus mode by listening
to one song on repeat for hours it's
awesome links to that is also in the
description below that's it for me now
thank you for watching and everyone keep
on hacking</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>