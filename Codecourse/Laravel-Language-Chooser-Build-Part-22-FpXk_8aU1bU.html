<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel Language Chooser: Build (Part 2/2) | Coder Coacher - Coaching Coders</title><meta content="Laravel Language Chooser: Build (Part 2/2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel Language Chooser: Build (Part 2/2)</b></h2><h5 class="post__date">2014-04-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FpXk_8aU1bU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I've opened this language choose a
directory in my text editor so now we
can go ahead and start to create the
views that will contain the form and the
translation so let's go over to app and
let's go over to views and will delete
this test view that we can see in our
browser here that will just get rid of
that so now this should error perfect
I'm just going to go over to app config
and app and I'm going to go ahead and
turn debug on just so we get the actual
stacktrace errors like this so now let's
go ahead and create a new view so under
views let's go ahead and create a new
file and we're going to save this as
home blade PHP and hit save and we'll
just go ahead and type hello in here for
now so under root let's go ahead and we
will change this to make the view home
rather than actually making the view
hello and now when we refresh we see
that we've got this view rendered here
let's now go ahead and look at creating
some translations so we can actually
output hello as a translation here
rather than actually outputting just
this hard-coded hello
so under language and then under en
we're going to go ahead and create a new
file and we're going to call this
greetings
eh P and we'll also go ahead and create
a new folder inside of land call it de
for German and within this we'll go
ahead and create a new file and also
call this greetings so within here we
want to go ahead and knock the open PHP
tags we're going to return an array this
is just how we create localized text
basically in laravel and I'm going to
say hello here so in German this is
going to be hello rather than hello and
in English this is going to be if we
just go ahead and copy and paste this
hello so we've now got the translation
files set up so inside of home deployed
PHP we can go ahead and create our curly
braces because we're using the blade
templating engine and we can go and use
the use the trans helper function to
translate this
so we're going to say greetings dot
hello so depending on which locale is
set this should output the specific one
we choose in this case we've got en set
to default so if we look under config
and app you can see that if we scroll
down we've got the locales default set
to en we've also got the full back
locale set to e/m which is really
important because later on in the
application when we go ahead and choose
a language if we choose the wrong one
this is going to go ahead and fall back
to en if it can't be found so if your
user tries to fiddle our form to provide
a locale that hasn't been set we can go
ahead and just fall back to en so now
we've done this let's go ahead and just
define the rest of our page so we'll go
ahead and create doctype HTML tags the
head body will change the ch-- are set
to utf-8 we'll go ahead and stick a
title in here okay so inside of the body
now we want to obviously contain this
text let's do that within a paragraph
tag just so it stays out the way of the
form we're going to go ahead and create
in a minute and let's now create our
form so the form is obviously just going
to be a form element I'm not using the
lair avails helper now to allow to sort
of build this form up
I'm just hard coding it in it's just
just purely preference you can go ahead
and obviously use the helper
functionality if you want so I'm going
to choose the method as post and within
here let's go ahead and create this
select element and within this let's
give a couple of options and we'll
obviously make this a bit more dynamic
later on when we get to choose the
locale that we want sorry option option
so the first one is going to be English
that's going to be a value of en and the
display value is going to be English
we'll go ahead and duplicate this down
and this time we'll choose German and
we'll add the locale here so we need to
give this a name obviously because it
has to have an
aim for it to be able to hit to be able
to be picked up and we also want to go
ahead and include a submit button here
we'll give this value of choose let's go
ahead and preview this and then we'll go
ahead and fill in what everything else
that we need to do so we've got the drop
down here with the English and German at
the moment this does nothing it submits
through to the same page that we're on
but because there's no post root setup
then this isn't going to work let's go
over to our routes far now and define a
new route what this route is going to do
is it's going to allow us to post some
data to the /language page let's go
ahead and just define that now then so
we're going to say route post and we
want this to go to /the language as I
just said will then pass an array in
here and give this some different
properties so what we need to do is be
really careful that we don't allow
cross-site request forgery to take place
here because if it does it could
potentially mean that someone can change
someone else's language so we want to
provide cross-site request forgery
protection on this form so before this
request is submitted we want to go ahead
and check the cross-site request forgery
token that requires we update this a
little bit so let's go down here and use
the form helper to generate a token but
what that's going to have done is if we
just inspect this that will add a token
just here when we click Choose that will
go through and the token will be checked
so now that we've done this let's go
ahead and define what else we're going
to choose a alias for this route in this
case I'm going to call it language -
chooser and we also want to define which
controller this uses we're going to set
up a controller here so we're going to
say this uses the language controller
which we haven't set up yet we'll go
ahead and set that up in a moment and
the method in here is going to be
chooser
so under controllers we want to create a
new file so we want this to be a class
of language controller we want that take
then the bass controller let's go ahead
and save this as language controller dot
PHP and it's going to find this method
so public function chooser remember we
called this method here so we're passing
this data through to this controller now
here we're going to set the locale based
on the locale that's been passed through
from the form but we're not actually
passing anything through to this page
yet because we've not defined the action
for our form let's just echo out input
get locale so now we can go ahead and
update the action here so I'm going to
say this is a URL to the route remember
we gave an alias to our route which was
language - chooser so we say language
chooser and remember we're sending this
with a method of post that's why we
chose the route as a post route here now
what's going to happen then is when we
submit this that will go through to here
let's just go and check the whole plate
at pH B okay so that needs to be locale
rather than language so now when we hit
choose you can see that we get en and
then for German we get de so what we can
do now is actually set the session based
on this so we'll go ahead and leave this
in here and we'll just put that down a
couple of lines and we'll say session
set locale and will now choose this
input so now what we can do is we can
return redirect back and that'll just
ensure that we're redirected back to
whatever the page the user came from
when they submitted this form so let's
go ahead and do this now I'm going to go
ahead and hit German and click Choose so
nothing's actually happened because what
we're not doing is somewhere in our
application we need to go ahead and use
the set locale method on the lang model
so we do that under filters and before
so before any requests to our
application we want to say lang
set locale session get remember we've
already set to the session of locale
based on that option and that we'll go
ahead and set the locale now if this
line runs but a locale hasn't been set
in a session that doesn't matter because
we have a fallback locale which is en
now on a refresh you notice that that's
changed to hello rather than hello
because we've chosen the de locale if I
choose English again you see that
changes back to hello so what we need to
do now is change this form so that
whichever locale we're on it sticks to
it
we know that English is the defaults we
don't need to include anything here in
home late PHP let's create a conditional
statement here so we're going to say if
Lang locale is de we go ahead and set
this to selected otherwise we set this
to nothing and we've added a space here
so the space comes after this when i
refresh this is set to English when I
hit German and choose you can see that
stays on German if we inspect this you
can see that that says selected the last
thing we want to quickly do is check
that our cross-site request forgery
protection works let's go ahead and
refresh the page
change this token when we hit choose
this shouldn't match and we should
generate a token mismatch exception
which we have and that's it
we built a language chooser with laravel</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>