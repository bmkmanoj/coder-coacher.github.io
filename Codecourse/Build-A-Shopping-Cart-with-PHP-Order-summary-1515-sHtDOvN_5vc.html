<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Shopping Cart with PHP: Order summary (15/15) | Coder Coacher - Coaching Coders</title><meta content="Build A Shopping Cart with PHP: Order summary (15/15) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Shopping Cart with PHP: Order summary (15/15)</b></h2><h5 class="post__date">2016-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/sHtDOvN_5vc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so the only thing left to do then is
create the order summary page which will
redirect the customer over to once they
have made a payment install their
details and we'll just present them with
their order summary so to get started
then we are going to update our order
controller I'm gonna create a new method
in here so we already have our index and
now create but now we want a method to
actually show an order
so let's very quickly create this so
we're gonna say show and how are we
gonna show an order what we're gonna do
that via a hash in the URI and then we
have our request in here we have our
response we also have our view in here
as well and we also want to inject order
in so we can grab that order so in here
then let's just return a view we haven't
created this yet obviously but we will
do that in just a moment so we're gonna
render out passing in response and
that's order show dot twig so let's
create this just over here now so we can
get rid of all this and over in
resources an order let's create a new
view called show dot twig so in here
then we just want to extend our base
template so it's templates our twig and
then obviously here we have our content
we'll just end our block so this will be
the order so let's update our routes
then just to show an order by a hash so
would you take this one down we'll add
in a hash there really straightforward
we'll change over the method and we'll
change this to order our show so now if
we just choose an order from the
database so let's just choose with any
one for now and we'll clear this up in
just a moment we can go over to order
paste in that hash and of course we have
this order error because we don't yeah
we haven't pulled this into our
controller but we can do that very
quickly
just pull this in now and just bump that
up and there we go so we now have our
order page and we can pass in an order
like that now what I'm actually going to
do is get rid of all of the orders in
the database and anything else here so
we can literally just truncate all of
this except products just so we can
start fresh and we're gonna go and
create an order now so I'm just gonna
add a couple of items in what you want
to do is while you're testing this add a
few items and then also have different
quantities as well because we're going
to test showing them on that page let's
add six of these okay so let's check out
very quickly and I'll just fill this out
and we'll get going with this
and let's go and into car details by the
way the reason that these were read is
this is really cool if we try and submit
this form without these we actually get
validation automatically on here on the
front end so it's really nice we can't
go anywhere unless we've entered valid
details here so let's submit this order
through and there we go so we'll go back
again obviously we don't have any items
our can't now but we now have an address
we have a customer we have one order we
have then products associated with there
and we have a payment so let's go back
over to our order controller and let's
start to look at this just here so
obviously we need to check if an order
actually exists first of all we need to
check if it doesn't exist we want to
redirect so let's pull in this order and
what we're gonna do is we're going to
say order with so we're going to load in
the address attached to that order and
we're going to load in the products
attached to that order and then we're
gonna say where the hash in the database
equals the hash we pass in and then
we're gonna grab the first record like
that and then of course we can check if
that order doesn't exist and if it
doesn't we can just return with a
redirect so we just say with redirect
and let's redirect through to the home
page of course you can show an error
here if you want whatever you want to do
however you want this to flow through
and then finally inside of here this
means that this order does exist so we
can just go and pass this through to our
view so now if we just take this order
ID and we go over to orders and we just
paste this in here we now see our order
page obviously if it's wrong we don't we
redirect it so this is our order now now
we can work on actually showing all of
the order details with all the
relationships we have so we can output a
list of the products which is really
cool output the address and any other
information
you eventually want to get round to so
let's start by creating our row and
we're just gonna have a twelve column
layout here and at the top we're going
to create two nh3 and we're gonna say
order and then we're going to give the
order number so we can just put a hash
here and say order to ID this is the
actual ID from the database so you can
change this to up at the hash you can
even generate a shorter hash if you want
to that's absolutely fine
let's create an HR here and we will get
on with the rest of the content so in
here we're gonna have a two column
layout so we're gonna have a six on one
side and a six on the other side so
let's say call MD six here duplicate
this down and this one here will be the
shipping address so let's put an H four
in here with the shipping two and down
here we'll add the address in just a
moment on this side we will have the
items that the user has ordered so we're
gonna say items and then we'll do that
down here so we now have the following
so shipping two and then the items that
have been ordered so for shipping to
them this is pretty straightforward
because remember over on our order model
we have an address attached to this
order we already know that so in here we
just say order dot address address one
and you'll see that that gives us the
address and then we can just put a break
on here and we can do the same for
address two we can do the same for the
city and the postal code as well and if
you obviously output anything else here
you can go and output that so that's the
address I entered during that checkout
and that's it that's done so for the
items this isn't even very tricky
because again we have our relationship
set up all we need to do is loop through
and output these so we just say for
product in order dot products again if
you need to refresh your memory over in
the order model we have products
attached to this so let's end this four
and inside of here let's start to output
these women do these as anchors because
we're going to link through to the
product as well but for now let's just
output the product title
so this is just product title like so
and obviously here we're gonna want
something to break or something like
that you can obviously format it how you
like so these were the three items that
I ordered and then what we're also gonna
do is after this do the quantity so
we're just going to say X and then in
here we're going to say product but now
we don't have product dot quantity in
here we have it on the pivot table so to
access this we say dot pivot and then we
say quantity like so and that will give
us if we go back to our browser the
quantity of each one that I ordered
great so now we can hook this up to the
actual product page you don't need to do
this but it's quite nice
so path for product get and of course to
grab a product we need to pass in the
slug let's just fix this up here as well
so we've passed the slug in which is
obviously just the product slug and now
when we click through we can actually go
through to each of them products so
finally and again you can do pretty much
whatever you want here we're going to
output the order total including the
shipping which we obviously we have
hard-coded at the moment so let's just
create a paragraph here we're gonna say
shipping I'm gonna hard code this in and
then after this we're gonna break down
and we'll create an order total at least
output the order total and again this is
easy we already have the order passed
into here we just say order dot total
and if we just go and pop a pound sign
on there we want to add five on because
we know that we're hard coding this and
then here we just want to say number
format with two decimal places and there
we go so we have the full price of our
order and of course we can check this in
the database just to make sure that
that's correct so we have order total
here of ninety eight plus five in actual
fact this now counts the shipping so we
can actually get rid of the shipping
like that we don't really need that in
there anymore and of course we can
double check this over on the Braintree
guide
we've had quite a few sales today and if
we just go down and do a search in our
transactions we can see that we get that
98-pound payment just in there so it
looks like everything is matching up
nicely and with that that is our order
summary page done course feel free to
change it around now the last thing we
want to do is redirect directly to this
page after the user has checked out
that's the last thing that we need to do
so over in the order controller then
once we have created an order at the
very bottom we want to redirect so to do
this then we just want to return
response with redirect and then from our
router want to grab the path for ordered
show and it's gone pass through our hash
in here as well so that's just the hash
that we generated earlier and now we can
go and test this out so if I just add
one item to my cart and check-out I'll
go ahead and enter my details here
and we will go ahead and check out let's
do this with PayPal now so let's receive
this and when we place our order now we
are redirected over to our order summary
page with the total obviously all of our
items and that is it so through the
whole checkout flow we go ahead and add
items we enter our details we make a
payment with Braintree and then we're
redirected to our order page where we
can see everything we've ordered and the
order totals I want to give a huge shout
out to our friends at Braintree for
supporting Co course in the future that
could be a whole new way to pay brain
trees full spec payment platform is
easily adaptable to whatever the future
holds so you can easily adapt to with
one simple integration and support for
any device when that new payment method
comes out all you have to do is update a
few lines of code no complicated
recoding no late nights and no stress
about staying ahead of the curve
Braintree payments is here to help you
can learn more and repayment comm stat
code course</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>