<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 19): Forgotten Password (Part 1) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 19): Forgotten Password (Part 1) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 19): Forgotten Password (Part 1)</b></h2><h5 class="post__date">2012-05-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ypDWGvtxlIc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're now going to move on to the
password recovery process for a user
that's forgotten that password
now obviously this doesn't work in the
same way as the username and it can't do
and the reason for that is that we're
actually hashing or encrypting the
user's password so if we go over to our
database table you can see that the
password is an md5 hash of a plaintext
string that the user enters as their
password now the problem here is if we
were to go and say say to a user in the
same method that we used for the here we
grab these our data if we for example
said password this would just deliver an
md5 hash to them and we can't obviously
decrypt it it's one-way algorithm unless
we brute-force it but that would be
silly you know we need some other way to
do this and the way to you know recover
a password is to first of all give the
user a new password so reset their
password now what I'm going to do is I'm
going to go down the easy route just for
the purpose of this tutorial and I'm
going to generate a password myself
assign it to that user encrypt that
password and then force them to change
their password the next time they log in
so we need to do a few things here but
it's not actually that difficult is just
you know we're just being clever about
things so the first thing to do is
actually in terms of this here well we
don't really need to do anything because
we've got if mode equals password
recover password and in fact the first
thing I'm going to do is generate a new
password for the user now I'm not really
going to be creative here I'm basically
just going to use a not clever trick but
just a couple of things just to generate
a password so what I'm going to do is I
am going to say
generated underscore password is equal
to I'm going to use the rand function
and this generates a random number
between a specific set of numbers so I'm
going to say between nine nine nine and
nine nine nine nine nine nine and then
I'm gonna hash this that's nothing to do
with hashing their password for them to
use but now what I'm going to do is I'm
going to say substring starting from end
the point zero so the first character
and I'm going to chop off the first 14
so what we're left with here is a number
between nine nine nine and nine and nine
nine oh nine hashed and then the first
14 characters of that hash in fact now
let's let's not be silly let's make it
an eight characters so a user can
actually doesn't have to type in 14
characters and this this is you know not
strong but it's relatively strong
because it's random it's a completely
random value and we're not completely
random but you know I mean so I'm going
to just go ahead and die and pass
through the generated password just so
we can see how this looks so let's go
over and click on password I'm going to
go ahead and enter my email address and
click recover and there we go that's
what it looks like so let's go ahead and
just refresh again and refresh again and
you see that this is a new password
generated for a user perfect okay so now
that we've got this randomly generated
password we need to give assign this to
the user now we already have the update
user function here and we can actually
take advantage of this so what I'm going
to do is I'm going to else sorry now I'm
not going to use the update user
function I'm going to use the change
password function that we created for
actually allowing the user to change
their password but this time we're going
to set it to something that we want it
to be set to and that's what we've
generated
so using the change password function
and we just go ahead and copy this and
scroll up I'm going to change a user's
password now what's the user ID we need
to grab the user ID so in here I'm going
to go ahead I'm going to say user ID and
here I'm going to say user data user ID
okay and what I'm going to change this
to when I'm going to change this to
generated password so just to clarify
we're grabbing the user ID anyway if the
mode password which is in this case
we're generating a password then we're
changing the password the users ID that
we've taken from here based on their
email address and then we're changing
their password to a generated password
okay done done and dusted so now what we
want to do is actually email them and
say hey this is your new password log in
with this new password and then after
that we'll force them to change it so
let's go ahead and just copy what we've
done here with this email just to save a
bit of time why not and paste that in
there so I'm going to say your password
recovery so I'm going to say hello Alex
or hello first name your new password is
something couple of lines down I'm going
to say please log in to change this
actually no let's just leave that about
so obviously we're not passing through
the username this time we're passing
through the generated password so let's
go and give this a whirl we're changing
the password emailing me the password
email me the new password and then when
I log in nothing's going to happen but
I'll sort them in a moment so I am going
to see my foot on the username or the
password for video PHP academy' let's
just pretend I'm Billy so I'm going to
click on recover
and there we go thanks we've emailed you
so assuming that I've written everything
correctly let's go over to our email and
we should have an email your password
recovery click on this so your new
password is this let's go over to the
database and just remember both these
passwords of the equal are the hashed
version of the plaintext password
actually the string password so they
both start with v f4 Bravo blonde and
then with CF w 9 so if I click browse
you now see that the password here has
changed and this is the hashed version
of the password that I generated for
this user so now this is the new
password so we go through the same
process of entering this this is
technically the plaintext password when
I paste it into here when I login so
Billy paste this is then encrypted to
md5 an md5 hash compared to this if it's
if it's equal then we lock ourselves in
and then we go we're done we're logged
in we've recovered our password and now
we have this password now the problem
here is we actually are just allowing
the user to have this generated password
and most people would much prefer to
force a user to actually change their
password once this generated passwords
been sent to them so in the next part of
the video we are going to be actually
forcing this user to change their
password one when they login for the
first time and and it forces them off to
the change password page</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>