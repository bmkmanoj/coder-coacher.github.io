<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Authentication: Validation (12/30) | Coder Coacher - Coaching Coders</title><meta content="PHP Authentication: Validation (12/30) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Authentication: Validation (12/30)</b></h2><h5 class="post__date">2015-05-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0mjDJTfGbL8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so now it's time to validate the
registration form because at the moment
we're not validating anything we're not
validating whether an email already
exists we're not validating a username
we're not vet checking that the two
passwords match in the next part of this
series we're going to be actually doing
the unique email and username validation
but for now we're just going to be
inputting some very basic validation and
then sending the user back to the view
here with any error messages displayed
here and this is extremely easy to do
but what we do need to do is under our
code course directory create a
validation class which we basically can
use to extend violins functionality if
you want to go over to the github page
for violin and just read about how all
of this works that would be a really
good thing to do but we have this
extending violin section so we can
extend the violin class to add custom
rules messages and field messages and
this allows us to just keep everything
in one place so we can add as much
custom functionality as we need so head
over there and read that if you want to
but otherwise we're going to be dealing
with this just here so the first step to
validating is I'm going to create a new
folder called validation under code
course and I'm gonna create a new file
called validator dot PHP so let me just
pull that down and we're gonna save this
out so this file then is going to be our
own custom class but it's going to
extend violin which will give us all of
the functionality we need to be able to
validate so let's name space this first
of all so remember the out of folders
code course it will be different for you
and it's under validation and the class
is called validator so before we do
anything here let's add this to our slim
container so here we're gonna say app
container singleton validation
let me have out closer there we're going
to use app so we can use that in here
and here we're gonna return a new
validator and of course this class
doesn't exist at the moment where it
exists but it's not gonna do anything
but we also have a namespace remember
for this validates its code course
validation validator that's the name of
the class so up here let's use code
course validation validator so what we
can now do is actually use that
validation object on within our
container to start to validate under
here but inside a validator we need to
actually extend violin so we have all
the validation functionality so let's
extend violin and up here let's use
violin violin and we can now start to
validate we're not gonna be adding
anything into this just yet that'll be
in the next part when we add custom
validation rules to check if a user if
an email or a username has already been
taken in the database so we can close
this off for now so inside of our
register root then we're now ready to go
and actually validate so what point do
we need to validate here well we don't
we want to validate before we create a
user account so let's start the
validation up here when we have our data
we can pass our data into the validator
and then if it passes we can create a
user account otherwise we will show the
errors on the form so what I'm going to
do here then is create a variable called
V and that's going to be app validation
and here what I can do is I can say V
validate we have an array here with the
key names so this will be things like
email everything like that each of these
are an array the first parameter is the
actual item you're validating so we're
validating the email and the second is a
string of rules so in this case we're
gonna have we want it to be required and
we want it to be an email so these
are separated by a pipe you can read all
about the different validation rules in
the violin documentation on github so
the next thing we want to validate is
the username so let's just switch this
out for username let's pass in the
username and for the username we want
this to be required we want it to be an
alpha numeric and allow dashes so this
will just mean that it can contain
characters numbers and dashes and
underscores so hyphens and underscores
we want it to be a maximum of 20 so
remember in our database we had the
username of a length of 20 and we well
that's pretty much it will eventually be
validating whether it's a unique
username so the next one then is the
password
so we want to given the password that
the user submitted we obviously want the
password to be required and for now
let's just say this is a minimum of 6
characters so the password confirm is
the password confirm there and this is
required and we don't have to include
them in 6 because this is min 6 and
these two need to match so we can just
say that we want this to match password
all this rule does is it will check that
this value matches the password here
that we pass in so otherwise it will
give us an error ok so now that we've
got that let's just create a quick if
statement and to check if this is passed
we just say if V part is if it passes
let's died and say passed and otherwise
let's say die failed just so we can test
this out so when I register now we get
failed because obviously all of these a
blank are empty if I fill these in like
rubbish it's still gonna fail because we
know that we have errors here so how do
we actually get the errors out of our
validator well can use the errors method
so we just say far dump the errors and
that will give us a list of the errors
so let's hit register
Wow so okay what we need to do is just
kill the page there that didn't actually
we'll just remove that record from our
database let's remove both of them
actually okay
so if this doesn't pass we're gonna
output the errors so let's do this again
and there we go so we've got a violent
support message bag all the message bag
is is just a way to pull out all of the
errors and you can roughly see here
email is required username is required
password is required password confirm is
required and then for example if we were
to type in a rubbish email we see email
must be a valid email address so we're
getting the errors back but we need to
actually do something useful with them
and that thing is to output them to the
page so the user can see so if the
validation does pass we want to take all
of this code here and it goes in here so
if the validation passes we register the
user we flash a message to say that the
users been registered and then we
redirect home otherwise down here we
want to to render the register view
passing the errors into that view and
also passing the request object into
that view so we can output the previous
stuff they've typed so they don't lose
any of their form so we'll we do down
here is say app render or register dot
PHP and to pass variables to a tweak
view within slim we just have this array
at the end here as the second argument
so we want to pass the errors into that
view and we also want to past passed the
request object so request and remember
that's here so let's see what happens
when we hit register we just see the
same form that's because we've in past
throughs that view with the errors which
will output in just a moment and if we
enter everything correctly let's say
tabi app code course calm
everything here is correct we hit
register and we see a registered account
in here so let's look at now how we
output these errors that we're passing
through to our view here so the first
step here then is just to check if an
error exists for a particular field and
to do this we say if errors so errors is
that variable we passed through we don't
mark them with a dollar sign because
Twigg allows us to bypass that we're
gonna say if errors first email all that
does is get the first error from that
message bag so if that if it does have
an error and we'll just end the if there
and in here we want to output the error
so we're gonna say errors dot first
email so let's check out and see what
that's done let's register and hit
register there we go we get email is
required perfect so easy validation so
simple to do so what we can do now is
copy this and paste it for the username
and just change user name here and
username there and we can do the same
for the password
so password password and we'll do the
same for the password confirmation as
well that's password confirm password
confirm there we go ok so now when I hit
register we see all of the errors there
if I type in a rubbish email and I type
in the past two passwords that maybe
don't match you can see we got email
must be a valid email address password
must be a minimum of 6 password confirm
must match password so our validation is
now complete we're validating if your
user passes the validation we create a
record in the database table if we don't
we send back to the old form and we're
given out our errors but what happens if
I end to say a valid email and then I
forget to fill out the rest of the
fields and hit register
well the email goes even though it was
valid and that's a shame because it's
going to take
you'll use us a long time to output that
information so we can update this view
to check if we have a posted email and
if we do we can output this within the
within the input so to do this we have
an if statement nested within here and
we're going to check if requests
remember requests is the variable we
sent through to the view post email and
we'll just end if there so if that's the
case remember we're within the input
element so all we need to do is an
output value and then in here we can say
request dot post email so let's check
this out I'm going to enter a valid
email forget to fill out the rest hit
register and that stays there perfect so
we can do this for the rest of the
fields let's just copy this if statement
here and let's paste it into the end of
just in here and we'll change this to
username and we'll change this to
username we'll do the same Oh actually
no we'll leave the password out because
it's best practice not to output a
password if it if it's failed for any
reason so let's enter a username or an
email sorry and a username hit register
so password is required we can type them
in and we just allow the user to not
have to fill these out again so our
validation is complete but what we can
do is we can register a user twice with
the same email and same username which
is obviously a problem when they go to
login it's just going to be well muddled
up because we don't have users to
duplicate user names and duplicate
emails and we don't want that so in the
next part what we're going to be doing
is focusing on checking the unique email
and username within our validator that
we've already created so our validation
class just here we'll add our own custom
rules in here which will allow us to
connect to our database and check this
and integrate that as part of the
process we did when we validated just
here so it's just as easy as validating
like that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>