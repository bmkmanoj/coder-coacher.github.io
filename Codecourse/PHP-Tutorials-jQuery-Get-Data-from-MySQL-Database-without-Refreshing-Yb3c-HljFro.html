<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: jQuery: Get Data from MySQL Database without Refreshing | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: jQuery: Get Data from MySQL Database without Refreshing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: jQuery: Get Data from MySQL Database without Refreshing</b></h2><h5 class="post__date">2012-08-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Yb3c-HljFro" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi this is Alex from PHP academy' and in
this video we are going to be retrieving
data from a MySQL database using the
JavaScript library jQuery so what we're
going to be doing is we're going to be
building up this form that you can see
here I've already got a MySQL database
set up I've just called it ajax DB it's
got a table in it with nate called names
and we have some data here so we've got
a name ID just for indexing we've got a
name field here a location and what
we're going to be doing is we're going
to be allowing the user to type in a
name here and that's going to retrieve
the location and then place that on the
page with no refresh so let's go ahead
and take a look at how this works now
first of all it's important to note that
when we click grab without typing a name
nothing happens also if we enter a load
of spaces and click grab nothing happens
as well and this is important because we
don't want to Ajax to a PHP file if we
have no content because it's a waste of
resource so if I go ahead and enter the
name Alex despite the fact that we have
an uppercase a here it's still going to
match when I go ahead and click grab it
brings back London and obviously the
page didn't refresh that's just returned
the location associated with this name
and then for example if we type in Julie
and click grab we get the location back
so this is just a basic example of what
we can do but obviously this can get
more advanced you could pull back
multiple bits of data you can pull back
tables as you follow along the tutorial
you'll see that whatever you output in
PHP will actually be placed here so
let's go ahead and start to write this
from scratch so over to our code editor
and all that we've got here to start
with is a basic document outline we're
going to be writing everything within
the body or it could be including jQuery
in here and our own javascript file
which is going to handle the clicks so
the first thing we want to look at is
our directory structure so we're
currently editing indexed PHP and I've
created three folders now Jas is going
to contain a file which is called global
KS and this is just going to be our
JavaScript file that handles the click
on the button we've got DB which I've
created a file connect dot PHP that's
just going to connect to our database
and Ajax we
a file called name dot php' and this is
a file that's going to return the data
so as long as you've got these three
folders and these files we're ready to
go and actually build this in a
relatively short amount of time so the
first thing is we are going to build the
form itself so we'll go ahead and create
a text here I'm not really following
things I labels or anything like that
but we're just going to create a really
really quick example so we're going to
create an input type of text and we're
going to head going to go ahead and give
this an ID that's going to be named now
on the next line I'm going to create
another input and this time this is
going to be submit and I'm going to give
this an ID of name - submit now the
reason I'm doing this is just so we can
target these elements within jQuery so
we know that we can say when this ID is
clicked so this button here is clicked
then retrieve the value with the ideas
name and then output to the div below so
I'm going to give a div with an ID of
name data so we've got name submit
that's clicked it retrieves this value
and it outputs between here so as long
as we've got the market mark up we can
target this so what we need to do now is
we need to load in jQuery so I'm going
to create an empty script tag and the
source here is going to be the jQuery
library so I'm just going to pull this
from jQuery con it's probably better to
use something like Google CDN or a local
version I'm going to be pulling it just
from here for the sake of the tutorial
so over to here and we're just going to
paste that within the source attribute
of our script tag so now I'm going to
create another script element and here
is going to be jeaious
/local je s let me just bring this down
a bit I'll go ahead and open je s it's
global - je s from the J's folder and
this is where like I said we're going to
write our own JavaScript okay so let's
go ahead and first of all connect to our
database because we're using a MySQL
database we need to connect to it so in
within the PHP file that we use as long
as we've sent the data through to this
file then
we'll include our connect script so I
placed this in a separate file as we've
already seen
we've got connect dot PHP let's go ahead
and do that now and test the connection
just to make sure we'll set up and ready
to go so I'm just using the MySQL
function set obviously you might be
using something different I recommended
to you something different but again for
the sake of the tutorial this is just a
quick and easy example so I'm connecting
to the server localhost my username is
root and I don't have a password and I
am selecting a database now the database
name here is Ajax DB I've just called it
Ajax DB so Ajax DB ok so let's go over
to our browser and access this file so
it's in DB /q
here and error reporting is on for me so
I can assume that we this file will
successfully connect to our database and
oh there we go we've got our preview of
our form as well and so let's just go
ahead and give this an label or a value
rather of grab ok so when i refresh
that's changed to grab okay so we're all
set up on that end let's go ahead and
just open our Ajax folder and open name
dot PHP this is where we're going to
read in the data that we sin from our
JavaScript file and then output that's
then going to be sent back to our or
retrieved with our post method within
jQuery and then we can insert the
contents into here ok so inside of
global dot J s what do we need to do
well we need to target this name submit
ID and we need to say that when that's
clicked we can then start acting so we
create a selector and the selector is
going to target then input with the type
of name kind of remember I call it name
submit so let's go ahead sorry I'm in
completely wrong file global dot J s we
need so I'm going to say dot on I'm
using the on method and I'm going to say
on click I want to run
this anonymous function now what this is
going to do is it's going to run
everything inside of here when we click
on that button so for example I'm just
going to go ahead and alert one for now
we'll just know if this is working now
so when I click grab we get an alert of
one so we know that that event handler
is working so we've attached the click
event handler to this button so the next
thing we're going to do is actually
retrieve the name that's been typed
within the forum so I'm going to say var
name is equal to and in here we need
another selector so this is going to be
input with the type of the idea of name
and then we're going to use val to
retrieve the value from this so again
for testing purposes let's go ahead and
alert our name and refresh when I type
in Alex for example and click grab it
returns my name so now that we've got
that the next thing to do is to send
this name to our file basically post
this data to our PHP file but I don't
want to post it if this name is empty
because that's a waste of resource we
don't Ajax to the file unless the name
is okay so I'm going to create a an if
statement and the condition is going to
be if name is not equal to nothing now
we've got a problem here let's go ahead
and alert one now if I was to go ahead
and click grab that's fine we're not
getting that alert however it helps to
type a few spaces and click grab we
alert one so we want to accommodate for
the fact that users could be typing
spaces and then submitting this so we're
going to use the jQuery trim method
around name so what's going to happen
now is that data will be trimmed before
it within that condition
so if I click Grubb now type of you
spaces and click grab nothing happens so
as long as characters are typed in there
then we can actually perform our post
method so we're going to create or use
the post method to send this data the
first parameter is the father we want to
send this to and the file we want to
send this to is Ajax /name PHP which is
this far here got Ajax name dot PHP
the second parameter is a JSON string of
the values the name the key values so
name is the name of the variable that
we're sending through to the PHP file
and the data we're sending is named so
I've called them the same thing so it
looks a bit complicated but we've got
name is the name that we're passing
through to this file and this is the
value so essentially this would be named
Alex if that was the case and I typed in
Alex
the third is another anonymous function
this time what we're doing is we are
grabbing this data that's returned and
we are doing something with it so for
example we could alert data so what
we're going to do is inside of name dot
PHP we're just going to output something
and what this will do is it will place
that into this data variable here and
then it will alert that data so if I go
ahead and echo PHP tags first and echo
hello what's going to happen is when we
click on the event handler we're going
to take the name as long as it's not
empty we're going to Ajax it to the file
and then we're going to return what
Evers returned from this file here which
will be hello so let's go ahead and try
this out I click grab nothing's
happening I need to type a name click
grab and then hello is output so this
has been passed through from the PHP
file so we're already making a really
good progress here but obviously we
don't want to echo hello from the name
dot PHP file what we want to do is we
want to place what's returned within
this div element here so it's it's name
data so what we do is we go ahead and we
use another selector and we say div hash
name data obviously we don't need to
include these here but it's ER just so
you can see what's going on so name data
texts are using the dot text method and
what we placing inside data so this will
just place plain text within the element
that we specify so now when we echo
content for example and I go ahead and
type a name and click grab we allow
content so that's going into that
element if we inspect it we can see that
we've got the div here and then the
contents been placed within so all this
left to do now is actually process this
with PHP so there are a series of checks
that we need to do before we actually
start querying the database because
again we need this data to be available
we can't enter it in the form but it can
easily be modified to look like we've
sent data so what we need to do is
create a condition in PHP and we need to
check if this dollar underscore post
name is set so if that's equal to true
then we can proceed so this has been
passed through as post data if for
example you'd used get then this here
would be get but post is generally fast
and we're not using the Ajax method
because this is such a simple example
okay we also want to check whether it's
not true so we're going to say and empty
dollar underscore post name is equal to
false so we want the data to be set and
we don't want it to be empty so what do
we do then well then we can go ahead and
require in our database connection file
so remember oops here we connected to
our database that's in DB forward slash
and the file is connect so we need to
traverse back a directory because
remember with within the Ajax directory
now so we need to go back and
directories and into DB and then require
in connect dot PHP so now once we've
connected to our database we can query
the database and then output the value
as long as the rows return don't equal
zero ie something's been returned
otherwise we're going to return a
message saying name not found so the
query we just bring this down a bit is
equal to a MySQL query and this is a
string and let's go down a couple of
lines and we're going to say select and
we're selecting a particular field from
the names table which will be location
so let me just run over this in PHP
myadmin we're selecting name
dot location from names so we can go
ahead and add that in from names and we
have aware clause as well and the where
clause is going to be where names dot
name is equal to something
now this something we need to go ahead
and inject into the string and this is
going to be dollar underscore post name
now we need to take necessary precaution
so the first thing we're going to do is
trim this again now we've already
trimmed it within JavaScript but the
only problem is if data has been sent
directly to this file we also want to
trim this we also want to take
precautions for SQL injection so we're
going to say MySQL real escape string
and what that will do is that will just
escape any characters that might form an
SQL injection in our database so now
that we've done that that's all we need
to do so now well that's all you need to
do for the query what we now need to do
is check if the rows don't equal 0 so
something's been returned
if the rows don't equal 0 we can return
the result the location field otherwise
we want to return name not found so we
want to echo and we're going to use a
ternary operator and I'll just write the
syntax out and then explain so this is
the condition here if the condition is
met this will be returned which is just
an empty string at the moment otherwise
this will be returned so the condition
is and I'm using the MySQL num rows
which isn't ideal but again for the
purpose of this tutorial is quick we
don't want that to equal 0 and the query
that we're using is here so we're
passing through the query this will
return the number of rows so more or
less always be 1 really in this case we
may have multiple names which I haven't
accommodated for again because this is
an example but you know there we go ok
so if the number of rows returned
doesn't equal 0 we want to return my SQL
result passing through the query the row
number which will be 0 because well
we're assuming we only get ever going to
have
one name returned and then we need to
specify the field again which is
location otherwise we want to return
name not found
so just to recap we're checking the data
is available and not empty if so we're
requiring in the connect we're querying
the database and then we're returning
the result of the location based on the
fact that the row count doesn't equal
zero if the row count does equal zero we
return this name not found string okay
so let's go ahead and test this out
hopefully nothing's gone wrong click
grab nothing's happened in fact I'm
going to bring up the network tab in
chrome web tools and when I click grab
you'll see that nothing happens we don't
have any we don't have any ajax ajax
files here when i go ahead and type in
Alex and click grab we return London and
you can see that we've hit named PHP in
the Ajax folder the methods post which
we knew the status is okay is told told
us the time etc but the point is here
that we have an ajax this far and less
data has been available oh and obviously
London has been returned as the location
if we go ahead and type in Julie and
click grab Shirley and Steven click grab
and Canada so that was a tutorial on how
to retrieve database values using the
JavaScript library jQuery</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>