<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create a PHP Like Button | Coder Coacher - Coaching Coders</title><meta content="Create a PHP Like Button - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create a PHP Like Button</b></h2><h5 class="post__date">2014-08-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PQMtLDxOQRk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to be building
a like button with PHP so you can see
here that I've got a few test articles
now these can be absolutely anything
they could be people there could be
statuses they could be articles so I
have a like button here and I also have
a little piece of text that just gives
me a count of how many people have liked
this now I've tried to make this as easy
as possible to integrate into a current
project if you need to do this let's
take a quick look at the database just
before we click like on this so I've got
two users now I'm faking a user sign in
just by starting PHP sessions and then
adding a ID so one or two two a session
key but we'll look at that in just a
moment I then got my list of articles
which as I said can be absolutely
anything and I've got a table which
specifically relates to a user liking
articles the reason is throwing these
separately is because then you can maybe
store a data and time along with it
you can keep track of the actual users
who have liked something otherwise if we
just had a say like column in here like
so you wouldn't really be able to keep
track of each record so that's how it's
going to work I'm currently faking being
signed in issues of one you can see I'm
just starting sessions here and I'm
assuming I'm a signed in user and I'm at
the user ID key if you don't know what
this means don't worry we'll be covering
this so over here then I'm logged in as
user Alex so when I hit like you can see
it's not as one people like this I know
the grammar is a little off but you can
go ahead and correct it yourself and
then it gives me a list of the people
that have liked this so what we can in
fact do is go ahead and change this to a
user - which is Billy and we can go back
and we can like this as well and we can
keep clicking like if we really want but
we can't like it more than once
obviously that that sort of goes without
saying and we can like these other items
as well now we do have a little bit more
protection in here so if we just copy
this link address and paste it in you
can see this is how we actually like
things we have a like PHP and we can say
type of article this makes it really
easy for you to integrate into other
things you might have say articles and
statuses you might want both
to be liked and this ID is the ID of the
actual item so this is article one
article to article three I'm going to
enter article 999 because obviously some
idiots might try and do this that will
actually not work so there's protection
against that as well if we just refresh
in the article likes table over on
content you can see that that hasn't
been inserted but we've got the actual
records been inserted here so it's
fairly straightforward to build let's go
ahead and get started okay so we're
going to start completely from scratch
so at the moment you can see we're
looking at my database graphical user
interface I'm just going to create the
tables that we've already just seen a
moment ago so I'm going to create a
user's table and let's go ahead and give
the user a username and let's add this
as a varchar' if you are following along
with this tutorial from scratch you can
go ahead and add these fields to this
users table and we'll leave it at that
because all we really need at the moment
to identify a user is a username so
let's create the articles table and if
course if you have something else you
want to store you can change this and
let's give this a title and again this
will be a varchar' and that will be to
hundreds a can can be different so now
we need the actual table for the likes
to happen or to be stored so I'm going
to call this articles likes now inside
of here we're going to be storing the
user and the article so a user can like
an article and these are still is
integers because these are basically
nearly stored say say if we just enter I
don't know Alex in here and we enter
billion here and for the articles let's
add test article one and let's add test
article two and just do one more so test
article three so back to the users are
the articles like stable the user then
say user 1 which is Alex liked article
one which is test goes to one that's how
it would be stored and the reason we do
this is so we don't have to duplicate
data the relationship between these
tables is as follows
when a user likes an article we store
user in there so a user can like many
articles an article can be liked many
times and this article likes table
handles that it's fairly straightforward
there's nothing too difficult about this
it just means that you've got more
flexibility in the system so now let's
take a look at actually building the
ability to output these articles which
is fairly simple and then we'll go on to
actually being able to like them so in
my browser and certainly within my text
edit there is no code at all here but
I've created a basic structure within
this app folder within the root
directory I'm working I've got an
initialization file and this is really
just a test file you probably wouldn't
want to structure application like this
but this is just to connect to the
database log the user in essentially and
we're doing fake user logins so let's
start to quickly build up this page
we're going to start sessions so we can
make use of the session superglobal and
let's store this in a user ID key and
I'm just going to set this to one a
really important thing at this point is
I'm casting this to an integer which is
unnecessary because it's a hard-coded
value but we're going to be using this
value inside of a query and I'm not
going to be using prepared statements
because it's a little bit too advanced
for this tutorial if you know prepared
statements dust fibers not everyone will
do so instead of messing around with
prepared statements we're just going to
be putting this into a query but make
sure you're sanitizing the data before
this goes into a query really really
important we'll be doing so with the
article ID as well so the reason I'm
casting listed to an integer is if you
are storing this value make sure it is
or use prepared statements if you know
so the next thing really to do is create
a database variable and create a new
MySQL I instance and this will basically
allow us to connect to localhost which
is my MySQL server address and use my
username my password and there we go my
database name so this database name you
can see up here website I've just called
it so this is now available to us
whenever we include it in either file
let's get started on the index now so
I'm going to require this in
so app in it dot PHP so now we have
access to the the database variable so
I'm going to create a variable here
called articles query and this is going
to be DB and the query method and in
here I'm going to create a query this is
eventually going to get a pretty long
about ten ten lines or so so initially
we want to make this pretty simple we
want to say select articles dot ID and
articles title now the reason I'm using
the table name is because later we're
going to be doing joined so we need to
specifically define which table this is
coming from you might be used to seeing
article ID sorry select ID title like so
this just means which table it's coming
from
so from articles we know that the tables
go to articles and we are going to I
think that's it really for now that
should be it so I'm going to create a
quick while loop down here and for each
loop of this we're going to fetch the
object from this result set so for each
articles query and then we're going to
use the fetch underscore object method
we are then going to assign or not
assign or add this row to this articles
variable here champ declared up here but
it doesn't matter too much so now if we
just do an echo we're going to do an
echo and we're going to wrap print our
in pre tags and this will basically just
let us see what's inside of this
articles array so doing this then let's
take a look there we go so we've now got
an array with objects because we did a
fetch object and we've got test Oscar
one two and three so that's the first
step we're outputting the actual
articles themselves let's just comment
this out well we'll use it for later
it's really really useful to have this
sort of one hand so down here then let's
create an html5 type you don't or a
document you don't really have to do
this
really it's entirely up to you I'm just
going to say articles and now in the
body we want to output these so we're
going to assume that this articles
variable exists you might
want to do a couple of checks so we're
going to say for each articles as
article I'm going to come down here I'm
going to end this for each and PHP
templating is very messy but it's a
little bit cleaner than outputting PHP
within sorry HTML within PHP so I'm just
going to create a div element here with
the class of article and I have no
styling whatsoever this is just
literally to mark it up how you might
mark it up you probably all got markup
ready so here we'll open and close a PHP
tag and will echo the article title so
let's just quickly preview this there we
go let's quickly view the source and you
can see here we borrowed document layout
and we've got a div the class of article
the header 3 in there now what we want
is underneath this we want a link so an
anchor and within this line anchor we
want to say like so the href is
obviously the link that this goes
through too so we're going to say like
PHP we're going to say type equals and
we can hard code this to article and
then in the query string we're going to
add the ID so when we go through to like
PHP this is essentially going to say is
this what type is this it's a it's an
article we'll put a switch in there to
check and the ID is the actual idea of
the record so in this case this is
dynamic so we can echo out article ID so
let's just quickly preview that there we
go so when I click like that goes
through - like PHP type article an ID of
1 and then for our article 2 and
subsequently be the IDs will change so
now that that's done what we can
actually do is down here we can output
how many people have liked this so we
can do this really but it's a little bit
difficult because we haven't actually
created the like functionality so let's
just mark this up just so we know what
we're doing and then later on we'll
we'll come in and fill the gaps so we'll
create a paragraph element here and
we'll say X people like this so not very
useful at the moment and in here let's
create an unordered list
and we will create a list item and in
here just Alex but in reality this will
then be a list of the people that have
liked them or this article you don't
have to have this in a list you might
not even want to use this you might want
to have it so when some someone clicks
on X people or three people have many
years then it pops up with these you
know it's entirely up to you but at
least you know how to do it so you can
change it if you need to okay so that's
all we're really going to do on this
page for now we want to focus on the
actual like functionality first so this
is going to be a pure PHP page we're not
going to have any markup in here we
obviously need to access our database
because we're going to need to store
some records so app in it dot PHP let's
include that in and it's your quick tech
check to see if we have inside of the
get super label the type first of all
and second of all oops the ID so this
will be the type can be article blog
post whatever you whatever you're
storing and if you just have one type
then you can omit this all together to
be honest so the type here is going to
be get type and down here we're going to
have ID like so so it's just there we go
so remember as I said with the session
or the user ID we want to store these i
sorry put these into a query so I'm
going to I'm going to cast this to an
integer we always know that an ID is
going to be a number it's going to be a
whole number so we can just cast it to
an int if you're inserting string data
here use prepared statements go and look
it up use prepared statements you might
wanna use PDO that it's a little bit
easier but in here in this case we're
just inserting an ID or two IDs the
session and the article ID or whatever
so that's really important so we're
going to do a switch quickly it's
entirely up to you if you use a switch
or not it just seems more appropriate
for this oops and we're going to switch
on the type so in case this is an
article which you know
it is we're going to do something in
here and we'll break so here we'll just
say echo out okay just so we know that
this works so hit like okay hit like
okay obviously if one of these didn't
missing you wouldn't get that so or if
article was on my blog then it wouldn't
come up so we haven't got a case for it
but now we are in the position where we
can actually insert this data now we
need to think how this needs to work
we're only going to do one query and
this is going to be quite long query and
the reason I'm doing one query is we'll
cut down on the number of queries that
we make to the database we could for
example let's just bring up sequel Pro
we could do a query to say does this
article exist because we need to know
that the article exists before we add it
into here as a record we also need to
know if the user has previously liked
this article or not so that's really
important we could do another query for
that and then finally we could do a
third query to say insert this like
however that means three requests to
your server already sort of you know
it's going to have an impact on
performance now this query probably
could be better optimized I've just
created it in terms of you know how easy
is sort of to look at but there probably
are better ways to write this query but
at least it's all in one query we know
that so let's just do a query and again
this is going to be quite long so let's
pull it down so we can do multiple lines
and I'll try my best to explain how this
all works
so obviously going to insert into the
articles likes table that's obvious and
the fields that we want to insert are
user and article
so that's user and article here now this
is a little bit tricky what we're doing
now is with selecting data now I'm
indented it because it's not necessarily
related to insert into it's obvious but
it just helps a readability now I'm
going to select two pieces of data from
the articles table that might seem a
little bit confusing and there probably
is a better way to do this but I'm going
to select session user ID
and I'm going to select the ID here so
this and this so I'm saying I want to
insert this into here and listen to here
pretty much but because we're doing a
select from articles that means that we
can then say do a couple of sub queries
that will then check where if certain
things exist so here I'm going to say
where exists and then I'm going to do my
brackets and just pull that down and in
here it's our sub query so now we can do
an entirely different query and what
what exists does or not exists which
we'll be doing in a moment it will
basically check if any results are
returned from this sub query so in this
case we're going to select ID and by the
way this is the check to see if the
article actually exists first of all so
we're going to select ID from articles
where ID equals the idea of the article
that we've submitted through into this
page so let's pull this bracket up there
so what this will do is it will insert
using this data but only where this
actual article that's been submitted
exists and when not exists now this is
the part where we're focusing on whether
or not there has been a record for the
user say it's user one we'll just insert
it for an example
so it's user one and article 2 if user
one and the article two is being
submitted for a second time it does
exist in this table so we don't want to
allow it to be inserted again because
then a user can like more than one thing
more than once so we do another sub
query we say select ID and we say from
articles likes which is the table we're
inserting into where user equals dollar
underscore session use ID and article
equals ID and let's just bring this up
it's important we do a limit as well
just in case more than one record is
returned so here let's do a limit of one
okay so let's just run
through this just in case this is a
little bit confusing we're inserting the
user an article we know that we're
inserting it with this data the user ID
that you used is logged in and the ID
that we've submitted through when the
user has clicked like now what we're
also checking is if the article on
another table so we doing a sub query to
handle that exists and when not exists
so this query should return zero rows
which it should if if the user hasn't
already liked it so we're selecting the
ID from art and this really doesn't
matter which field you select as long as
you select one field you can even just
select star but probably a little bit
performance heavy so from articles likes
where the user is the current user
logged in and the article is the use is
the article being liked so this then
prevents articles that don't exist being
added and users that are already like
the same article so then after we've all
done that let's just do a header down
here you probably have a better way of
handling this within your application
but we're going to locate two index dot
PHP which is basically our list of
articles so at the moment remember X we
haven't done anything with and this
doesn't do anything so when we hit like
that's what he directed us back it was
very quick we are going to check out
sequel pro we're going to give that a
refresh and there we go
user one has liked the article one I
know that I'm logged in as user one here
and I know that I just like to ask a
once it seems to be okay so now let's
try and like this again click and hit X
equal poem refresh and you can see that
it's still there there's no no records
being inserted let's now copy this link
address paste this in and do something
that article 99999 or whatever and let's
head over to sequel pro refresh and
there we go so we've handled that we can
insert twice and we can insert where an
article does not exist cool so now what
we want to do is focus on the index file
and we want to make this query a little
bit better to handle the list of users
who have liked something and the count
of users who have liked something so we
do I'm just going to pull this down a
little bit because it's going to make it
very much easier to read
so we want to say articles ID we want to
select articles title now we want to use
the count function within MySQL to count
the amount of likes so its articles
likes dot and will count on ID I'm going
to call that likes let's just capitalize
that so this is now the field name that
will be returned now at the moment let's
just do a print R and kill the rest of
the page there you'll see that we get an
error and the reason that we get an
error is because we're not joining we
don't the query doesn't know where this
is sort of coming from really so we're
selecting from articles but what we now
want to do is do a left join and we do a
left join because articles will always
exist but likes might not exist so we
want to pull all the articles we want to
pull all articles regardless of whether
they have been liked so if it was the
opposite way around we do right join or
if it was both ways of doing inner join
but we're not gonna be focusing on them
so we're going to left join on the ask
was like stable and we need to choose
the fields that these relate to now so
on an article you have an ID on an
article like you have an article here
which relates to that ID so we say on
articles to ID where that matches
articles likes died the article sorry
or it could be article to ID you can
name either way depends on how you set
your database up okay so let's take a
look at this now the query should no
longer fail and you can see that on
article one we've got one likes but you
may have just noticed that we've only
got one record coming through here
that's really annoying and we need to
group by a certain field to remedy this
and the way this works is at the moment
we only have one result on the other
table so it's just saying or just you
know pull back one result so what we
want to do is we want to say well hold
on no we want to group by the ID
remember this is a unique field on our
articles table and articles is the thing
we want to list so we want to group
either and then oops let's just have a
look here Oh articles to ID and that
will give us three records
and you can see we've got one like on
our first article and 0 and 0 on our
second and third let's give one of the
others a quick like just so we can test
this out so I'm going to like the second
one and there we go we get a count of
one on that second one as well okay so
this is all well and good let's quickly
head over to init dot PHP change my user
ID to two which is the illy record in my
database just here and let's try and
like that as well so let's like maybe
article 3 and article 2 so now we've got
two likes on the second article and one
like on the third article cool so now
we're going to pull through the actual
users as you will keep that where it is
but we'll kill the page there so we want
to pull through the actual users that
have liked this now there are tons of
ways to do this one of the ways would be
to query in a loop which wouldn't be bad
which wouldn't be good practice or it
would be bad practice so what we want to
do is firstly we need to actually pull
in the users so we're going to do a left
join again the articles exist doesn't
necessarily have to be associated with
the user so we're going to left join the
users table and we're going to join on
the fact that the articles likes the ID
user equals the users dot ID field so
remember we have user one is Alex - it's
Billy cool so that's not really made a
difference to our query because we're
not altering how we select things now
what I could do is I could say well I
want to select users dot username but
let's take a look at how this is going
to how this is going to turn out you can
see here we've got Alex Alex and Billy
but this isn't very useful because
really it's just giving us probably the
I think it's tough you'll be giving us
the first user that liked it is probably
ordering out by ID I think by default so
we need a list here rather than rather
than a single single record or a single
string so we use a group the group
at function in cat stands for
concatenate and group is grouping
something so we want to group users
username that's what we're interested in
and we want to define what separator we
want to use in fact this should probably
be capitals so the separator I'm going
to use is a bar because I think that's
probably the least likely to get in the
way of a user or user name and I'm going
to name this liked eye now let's take a
look at the result and see what we get
oops see if we mess something up ah
there we go
misspelled separator brilliant ok so
hello into the browser ok cool so now we
see I've only liked the first article
but now we can see that we've got two
records here with the bar separating
perfect so this is obviously not very
scalable in terms of if you had millions
of users and say you know thousand liked
it you would get a very very long string
back here and this is really only for
you know it can had probably handle
quite a few but you know we're not I'm
not sort of thinking in terms of it
being scalable up to a large amount
that's probably a better way to
structure this query in terms of in
terms of scalability senior moment to go
ahead and look up and see how you can
improve this query so now that we've got
that how do we actually get you know we
don't output to the user Billy or Alex
because that just looks silly we want to
output it within our unordered list so
let's go ahead and start to modify what
we need to do I'll leave this printed
down here just so we can see what we're
doing we already know that we have a
count so I'm going to just quickly go in
and echo out article liked I think we
called it liked or no likes likes so now
we have an actual countdown here one
people like there's two people like this
you can fix the gram out orally said and
now we want to actually do an undo this
unordered list so we need a quick if
statement because we obviously need to
check whether there actually are any
records in here in fact let's get rid of
that for now
actually let's do what we need to do up
here so printing out the articles let's
make a modification to this articles
array and I'm going to say row liked by
which is here this row liked by I want
to replace this with something so I'm
just going to assign something else to
it so I'm going to say if there are
records in here because this query will
return sorry this will return here this
will return null if there are no users
that have liked anything so if there
have been some users like something we
want to explode I'm just going to say
otherwise empty array now inside the
explode we need to pass two parameters
one what we want to explode by which is
obviously a bar this basically takes a
string by the way and split it up into
an array and because we have no spaces
in here that's really important that you
don't add a space here or here we are
just basically going to get a list of
the user names so we're going to pass in
row liked by so now let's take a look at
what we get there we go so we've got
like my which is now an array because
we've replaced it with in that while
loop and we've got 0 and we've got one
here in the same here so however many
have liked it let's just remove actually
let's just remove this record for for 3
just so we can see how that looks so for
article I think it's here for article 3
let's just get rid of that record and
let's see how this looks there we go so
we've got an empty array basically which
is what we what we wanted and that was
placed in there remember ok so now we
can do the if statement down here to
actually output so let's do a PHP and we
need to check if this light by array is
empty or not so oops will say if not
empty article
liked by then we can just end that if
just down there to end if cool so here
we're going to output names we'll just
say that for now so down here then it
says output names output names but here
it doesn't because no people have liked
it no one's liked it so here we need to
do an unordered list this can be
absolutely anything you want
obviously in my case it's just going to
be an unordered list just because it's
easier to visualize and in here we need
a for each loop because we're looping
over the array of users so we're going
to say for each article liked by as user
and then down here we'll end that for
each loop and in here we'll create a
list item so the list item is just
basically going to echo out user because
for each one of these is just the user
name as we saw here okay so let's give
this a refresh and there we go we've got
iliyan Alex like this Alex like this and
no one has liked that so let's get rid
of this because we don't need it and
there is the final result we have the
ability to like something only once
remember and only if that particular
item exists it could be an article or
something else and we get to see how
many people have liked something and
then we get to see a list of who has
liked something and for each one we're
trying to be as efficient as I can
possibly write queries by selecting
everything we need within one query and
then when we insert we're doing that all
within one query so that's how we create
a basic like button with PHP</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>