<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Generating PDF files with PHP: Writing temporary files (5/7) | Coder Coacher - Coaching Coders</title><meta content="Generating PDF files with PHP: Writing temporary files (5/7) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Generating PDF files with PHP: Writing temporary files (5/7)</b></h2><h5 class="post__date">2015-10-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/MiQpoCnSKyc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're ready to build our capture
clasp out and actually render a view and
then respond allow the user to download
the PDF let's first of all have a look
at how we may want to use this so I
would like to say capture load and then
I would like to pass in a view so
invoices up here is P for example and
then into this I'd like to be able to
pass the data I want to see in that PDF
so for example order 1 2 3 4 5 6 and I
might have a name in here
so Dale Garrett and then I might have an
amount in here as well so all of this
data is going to be passed to our view
then so let's focus on this load method
first of all so under capture let's go
ahead and build this method so remember
in to this we pass in the view and then
the data so we're gonna say file name
and then data that's going to be default
to an empty array and now we need to use
that view class that we built earlier so
what I'm going to do is when this class
is instantiated I'm gonna say this view
equals new view we need to import this
so use code course views view and up
here we can just have a protected view
now you wouldn't ordinarily do this if
you're working within a framework this
would be within some kind of container
or we might you might already have some
kind of method of rending views this
isn't strictly great but like I said you
can swap it out for any other rendering
method you want this is just so we can
really get this going so within this
load method then what we want to do is
we want to store this view so we want to
say this view then we have that load
method remember on our view class just
here in fact I think we might change
this to render so if you go ahead and
change this to render
and we go over to here use render
instead we pass in that far name and
that data and now we have our view that
we can do something on now what we want
to do now is capture the image so I'm
going to up here say protected PDF so we
have another property just up here I'm
going to say this PDF equals this I'm
gonna implement a capture image method
and that's going to pass in that view so
just to recap what we're doing is we're
loading in this view we already saw an
example of this in the last video and
then we are actually capturing an image
of that view and what we going to do is
we're actually going to store that image
and then what we have then is a
reference to that under this PDF so
let's implement this capture image
method and into this we pass a view this
is just gonna be HTML CSS whatever else
at this point and now we want to write
this content to a file so we can then
pick it up with phantom JFS so we're
gonna say path equals this right file we
pass in our view and all right file is
going to do so we can implement this now
is taking that view and we're going to
write using file put contents so all
that's going to do then is place within
storage a file with all of our data in
that's essentially what we're doing at
the moment so the path then is going to
be storage slash and then what we're
going to do is generate
a unique value here and all I'm doing is
I'm md5 hashing a unique ID but of
course you can choose any other method
because we're immediately deleting this
file after we've done with it
it doesn't really matter too much but
again choose whatever you want to do and
then we're gonna add a PDF extension and
the data that we want to write to this
file is the view we pass in like that
now we need to return the path of this
father has been generated so to do this
really easily we can just say path
equals there that we'll write that
content to afar and then we'll end up
with this path variable so let's just
kill the page here an output path and
just see where we're at at the moment so
remember we pass in the file name of the
view and any data we render that using
twig then we capture our image and by
capturing the image all we're doing is
writing this to a file and writing it to
a file involves just file put contents
and popping that in a file so when we
run this now we should see it temporary
far within the storage folder so I'm
gonna hit enter we can see that it's
been output now so we've got 22 at the
start
54 at the end you can see in here within
our storage directory we have this file
in here now it's got a PDF extension and
it's just HTML at the moment we're gonna
let phantom actually render an image of
this so let's delete this for now we
don't really need that hanging around in
there and of course what we're gonna do
is in capture get rid of die path but we
are going to return path so path equals
this right file we now have the path
within this capture image method so what
we're now ready to do is actually
capture this image using phantom j/s and
then go ahead and serve it to the user
so let's jump onto the next video we're
going to be installing any other
dependencies that we need we have
phantom Jas so we can actually try and
wrap this up</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>