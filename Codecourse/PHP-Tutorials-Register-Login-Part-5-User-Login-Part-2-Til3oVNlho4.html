<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Tutorials: Register &amp; Login (Part 5): User Login (Part 2) | Coder Coacher - Coaching Coders</title><meta content="PHP Tutorials: Register &amp; Login (Part 5): User Login (Part 2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Tutorials: Register &amp; Login (Part 5): User Login (Part 2)</b></h2><h5 class="post__date">2012-05-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Til3oVNlho4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so we're back and we are ready to
sanitize this data that we haven't done
so yet so I'm going to need to open up
my general function file within or
creates our it a general functions file
within here so I'm just going to create
a new in fact no I'm not I'm going to
create a new file within my text editor
and i'm going to save this in here and
i'm just going to call it general dot
PHP so this is going to house any
general functions so we need to create a
function to sanitize so i'm going to
call this sun its eyes and I'm going to
pass in data so we're passing in data
and we're returning it sanitized now the
reason I've created a function for this
is because we might want to add
additional ways of sanitizing data later
on if we use you know all the methods of
sanitization within one page we might
have to duplicate them to another so
what I'm going to do is return MySQL
real escape string data and it's as
simple as that
so if I pass through any data here I'm
using the MySQL real escape string to
sanitize it and then return that data
back so if I close that what I can now
do is within here within users dot PHP I
can go ahead and I can say user name in
fact I don't need to do that I can do it
in line if I want out do dummy
so username is equal to son it ties user
name now that's all all well and good
but we haven't actually included this
general functions file so I'm going to
go ahead and I'm going to open in it dot
PHP and I'm going to copy this and I'm
going to paste this just here nervously
changed demo so now we have access to
the son size function within our login
script we are checking if the user
exists that's calling this function here
passing in the username sanitizing it by
calling the sanitize function in the
general dot PHP file and then we're
running our query but obviously that's
not it we need to return true or false
to see
if this value here is either equal to 0
or 1 now if this is equal to 0 it means
that the user doesn't exist and
therefore there's no point even trying
to check their password against their
user name if the user does exist however
we can continuum would return true from
this so I'm going to say return now this
is slightly trickier because I'm doing
an in line in if statement or a ternary
operator so anything within this these
two brackets will be the if statement
anything after the question mark will be
returned if this is true and anything
after the colon will be returned if this
is false I've got a semicolon on the end
of the line so in here if I said 1 is
equal to 1 so return if 1 is equal to 1
return true otherwise return false so in
this case it would return true so in
here what we actually want is we're
checking the result of this query
against 1 or 0 or just 1 for example so
I'm going to say my SQL result and in
here I'm going to pass through the query
the row and that's it and then I say is
this equal to 1 so is the result of this
query I the count where the username is
equal to username equal to 1 then return
true otherwise return false and that's
it we could combine this we could place
this query here in - oops into here the
reason I didn't do that at first is
because it makes it look very very
complicated we could do that I think
that that makes sense but keep it the
other way around if you struggle to read
this all in one line we could also use
sanitize within here as well anyway this
user exists' function we need to check
now that this actually works so let's go
ahead and just use this on let's do it
just up here I'm just going to say user
exists and in here I'm going to pass
through Alex we know this user does
exist and what I'm going to say if
user exists' Alex echo exists and
remember if this is equal to true and
this isn't part of our login code I'm
just doing this up here to demonstrate
but let's go ahead and refresh or rather
we'll just click here we get this result
back exists on the login dot PHP page so
if user exists Alex equals true this
function has obviously returned let's go
back here as obviously return true
because the query found a user with
username Alex now for type for example
Billy and I go ahead and refresh we
don't see oops we don't see anything
because the user doesn't exist so we
know that the function works now I just
used up here's of a testing space so we
now know that this will return the error
we can't find that username if the
username doesn't exist okay so what do
we want to do next well we want to go on
and start to you know check some other
things as well one of these is whether
the user is active so if the user does
exist we're going to say else if user
active oops active user name is equal to
false so if the user is not active
we again append another element onto
this array so we're going to say well I
don't know what we could say you haven't
activated your account
remember to skip that character to vated
your account okay so you could then go
on and maybe give instructions of how to
how to activate the account something
brief okay so else we're going to do
some stuff here okay basically what
we're going to be doing in there is
we're going to be testing the the login
process so we're going to be logging
passing the username and password and
checking if the password matches etc but
for now I'm just going to in fact let's
do nothing
and then at least we know that we don't
have any errors now down here I'm going
to use print R and I'm going to print R
errors and what print r does is it gives
us a visual representation of this array
and because we're adding these elements
on to this array then we'll be able to
see them essentially if we do come
across in the errors so let's go ahead
and create this user active function so
I'm just gonna essentially go ahead and
just copy this function here because
we're more or less returning the same
data or checking for the same data so
I'm just going to change this to user
active again we're sanitizing the data
which is important but this time what
we're doing is we are selecting well
we're selecting the same thing with
selecting the count from users where
username equals username but we're also
checking whether the active state is
equal to one so and active equals one
and we don't need single quotes around
this because it's an integer so we've
used more or less the same functionality
as user exists but we're saying return
the count of any of all the rows where
the username is equal username which
will only be one if that's equal to
username and activity equal to one so if
if the username Alex exists that's good
but if the active State you can see
quazy row this will return false
otherwise it will return true
so when again let's go let's go ahead
and and test that in fact we can test it
now because we've we've printed all the
errors let's go ahead and go back to the
index I'm going to click login and you
can see that we've now got this visual
representation of the array in the first
key so the key 0 is you need to enter a
username and password because we haven't
entered the username password so I'm
going to enter Alex but not a password
and we get the same error and again I'm
going to enter a password but the no
username when we get the same so Alex
and password
and we should get nothing now oh you
haven't activated your account of course
if I enter a username that doesn't exist
with any gobbledygook password we
couldn't find that username have you
registered so we're seeing all the
errors that we would expect to see and
if I again chose Alex you haven't
activated your account so I can go ahead
and now change this I'm going to go
click Edit I'm going to choose one and
I'm going to come back and another type
password login and nothing's happened
there's no element in this array ie
there's no errors that have occurred you
know within these checks so here what
we're going to do well we need to
actually lock the user in we need to
pass a username and a password to a
specific function that's going to return
true or false depending on whether the
login was a success and then obviously
we're going to deal without putting any
errors if if they do occur so we'll do
that in the next part of the video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>