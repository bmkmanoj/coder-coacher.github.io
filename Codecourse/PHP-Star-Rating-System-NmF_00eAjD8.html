<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Star Rating System | Coder Coacher - Coaching Coders</title><meta content="PHP Star Rating System - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Star Rating System</b></h2><h5 class="post__date">2014-08-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NmF_00eAjD8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay in this video we are going to be
building a star rating system with PHP
now we're not actually going to be using
stars we're going to be using numbers
one to five but it's essentially the
same thing you can represent these with
images and you can do pretty much what
you want with them now we are storing
articles in a database here as an
example this can be anything though it
really doesn't matter what data you are
storing you can see here we've got an ID
and a title within here notice we don't
actually have a rating stored along with
this article you'll notice we've got the
racing here though that's because we're
actually storing the rating inside of
another table this articles ratings
table and this gives us the opportunity
to store additional data along with each
rating that's given and what we're doing
here this three out of five you can see
for article one is actually an average
of all the ratings that have been stored
here and you can see that just a
glancing at these that is pretty much
three so let's take a look at how this
it actually works I've created a very
basic system that won't take a minute
for us to do that basically links
through to each of the articles given an
ID so I'm inside of article dot PHP here
whereas previously I was on the index
page so if I wanted to write article two
and give that a 5 you can see the rating
automatically changes to a 5 and if we
take a look inside of the article
ratings table you can see that we've got
an article of two and we've given this a
rating of 5 now if we do another one
let's just say one that then brings the
average in obviously at 3 we are
rounding these values because we're
using well it will be getting back a
float here so you can see here we've got
a article 2 and a rating of 1 there
which brings it to the average of 3 so
that's basically what we're going to be
doing as I said this can work with any
content so let's go ahead and start
building this so we're starting this
pretty much from scratch the only thing
I have here is a basic document markup
don't really have to even include this
if you don't want to but I'm just
including it anyway now inside of our
database we're going to need to add two
tables under the database name website
so when we connect using MySQL I we will
need to provide the fact that we're
connecting to this website take database
so let's create our first table this is
going to be articles and you can use
anything to create these tables you can
use the command line PHP myadmin but in
this case I'm using sequel Pro so under
the structure we want to add the ability
for storage of a title and let's just
add a varchar here and we'll give this a
length of 200 you can like I said be
applying this to pretty much anything
the concept works exactly the same as
long as you're outputting content it'll
work the same so let's create a new
table and this is going to be the
ratings for these articles so this is
going to be called articles underscore
ratings so inside of here we want to be
able to provide the article as we saw a
moment ago and then the rating now both
of these are going to be integers
because so we can just keep them the
same you can adjust the links if you
want but I'm going to leave this out for
now so now that we've created our
database tables that's all we need to do
but I'm going to add a couple of test
articles just in here so we'll say test
article 1 and here also test article 2
and in here we'll say test article 3
perfect so starting off from our blank
index file let's actually create a new
folder within the directory that we're
working in I'm going to call this app
and inside of here I'm going to create a
new PHP file and I'm going to call this
in it PHP this will just be my
initialization file that allows me to
connect my database so let's create the
database connection first just so we can
use this on every single page so we're
going to create a new MySQL I instance
and we're going to connect to localhost
we're going to connect to root or using
the username root
using the username password and the
fourth argument is the database in this
case - website
okay so let's grab all articles just so
we can output these again we don't
really need to do this here in fact we
could probably do this on the index page
that might make a little bit more sense
so inside of index let's open and close
some PHP tags up here and let's require
in that initialization file so now
anywhere down here we can actually use
that DB instance that we created in this
file so what we need to do in here is we
need to fetch all articles so I'll just
comment this all articles so we're going
to say query and this is going to be DB
we're going to be using the query method
here and just for now we are going to
change this later we're going to select
let's select everything from the
Articles table just so we can output
these below we're not pulling in the
rating yet from that other table but
we're going to wait till we insert
ratings before we come back and fix this
up so we can basically just come back
and fix this up later so here what we're
going to do is a quick while loop and
basically what this is just going to do
is it's going to add all of these
articles to an array you can actually
use the fetch old method and that will
bring you all results back by default
you'll have to loop through this and
either output within this while loop
which I wouldn't recommend or store them
into a variable that then you can pass
to what is effectively your view so in
here let's access that query that we
have up here and we're going to fetch
these as an object just to keep things
nice and clean and consistent and in
here I'm going to append to an articles
array and what we can actually do is if
we want we can just say articles and
assign this an empty array if you're
using an older version of PHP you might
need to use the array keyword so now
that we have that lets do a quick print
our on articles and see what we have
so a quick refresh and there we go so
we've now got an array inside of this
we've got an object so we can access the
ID the title of the article is perfect
so what we want to do now is just loop
through these just so we can actually
output these so down here we need to
create a for each loop so this is the
shorthand syntax just probably better
for doing within a view and we're going
to say for each articles as article now
let's quickly end this for each loop so
and for each and inside of here let's
just create some markup you don't need
to do this and this isn't styled I'm not
putting in a stylesheet but I'm just
going to call this article inside of
here I'm going to have an h3 and
basically this is just going to contain
the article title so let's just output
this
so that's echo article title let's
preview this let's just take a look here
okay there we are let's just fix the out
articles as article and there we go so
we've got our three articles there and
down here let's create a div element
just with a article rating and also
rating X out of five we'll fill this in
later now what we also want is this
title to link through to a page so let's
wrap this in an anchor and for the href
let's say article dot PHP and we'll say
ID equals and then we want the ID to go
here so we open and close our PHP tag
and we echo out article ID so now what
we actually have is if I just view the
page source you can see that we've got
ID of one ID of two and ID of three
that's then gonna link through to
article PHP ID of one we don't have this
page
available yet but what we want for this
page is just to say here's the article
let's fetch that specific article and
then give the user the ability to click
one two three four or five and then go
through to the rate PHP page which will
be creating as well so let's create this
article dot PHP page so we can take the
next step so we create article dot PHP
inside of our main directory and I am
basically just going to take what we
have from here
just because I want to copy the markup
I'm going to get rid of all of this
because we don't need it and I'm going
to get rid of all of this as well and
I'll just change that to singular so
inside of this file what we need to do
is we need to take the ID from the get
super global and then we need to put
this into a query and pull back all of
the information for a specific article
so the first thing I want to do is just
say article equals null and I'm going to
do a quick check to say is this key of
ID available like it might get super
global and if it is I'm going to store
it inside of a variable here variable
here and like that now what I'm going to
do is that this is really really
important for security I'm going to cast
this to an integer what we do is we cast
it to be an integer so when we put it
into the query we're never going to have
things like single quotes that might
cause an SQL injection attack so let's
just do a quick test to echo this out
just so you understand where this is
coming from so when I click test article
one we get the result of what's passed
through to here for two we get the same
in three you get the idea so what we can
actually do now is pick up the article
and then display it below along with the
ability to write that article so let's
say article and again we'll do a query
so we use the query method and in here
let's say select let's do this in double
quotes actually because we're going to
be putting a variable into this and what
will actually do is we'll do the same
for the
index pages work just to keep things
consistent ok so inside of article dot
php' back to this let's select will
select everything from this so select
everything from articles where ID equals
and then we just give the ID in square
brackets like this we don't need to do
that but I'm just using this syntax so
now that we have this article we
obviously just want to fetch it straight
away we don't need to loop here because
we've only got one record so I'm going
to fetch this as an object so I can go
ahead and I can return this like so and
this will now give me all of the
properties of that article so let's take
a look at outputting this down here I'm
going to start off with an if statement
I'm just going to say if article
remember we set article to null up here
so if this is not set we won't see
anything in the body you can you know
chop and change this to putting in your
requirements I'm going to end that if
statement there and inside of here I'm
going to create a div with a class of
article again none of this is styled
we're just containing it just in case we
might want to style it so I'm going to
say this is article and then in double
quotes here I'm going to give the name
of the article so we already have that
up at the top so I'm going to say
article title and then down here I'm
going to say exactly the same as I did
with the articles on the home page I'm
going to say article writing and then
the so rating is X out 5 and then now we
are going to give the links that allow
the user to vote so I'm going to encase
this in another div and this time I'm
going to give it a class of article rate
just to assumes that the users then
going to write so I'm going to say rate
this article now I could generate lots
of anchors here and you know say you had
a 10-point rating system which you can
absolutely do with this
you would have to write a lot of markup
so what I'm actually going to do here is
I'm going to use a for each loop and I'm
going to end this for each down here now
inside of the for each loop I want to
generate an array with numbers 1 2 5 you
could use a for loop for this but in
this case it's a little quicker not in
terms of the actual speed of it but it's
quicker to write and it's also probably
quicker to understand at a first glance
so here we're saying for each range 1 to
5 so basically for one to five as rating
rating now equals 1 2 3 4 and 5 for each
iteration of the loop so in here we're
going to create an anchor so here we can
just output rating like so let's just
take a quick look at what this looks
like you can see here we've got the
article title which we expected rating X
equal x over 5 which we know it's just
test and we've got these 5 here now so
we know that this works now let's create
the anchor for actually rating so it's
rate PHP will create this in a moment
I'm going to say article equals and then
I'm going to open and I'm going to say
rating like so so now what's actually
happened is if we take a look at the
page source you've got article 1 2 3 4 5
so we can go through to this write PHP
page and we can say article equals what
oh sorry this needs to be rating equals
the rating and in here we're going to
say article equals x and then and
because we're sending multiple values
along with this query string and in here
we're going to echo out article ID so I
confuse myself there so this is how it
should look
we've got article 1 article 1 article 1
article 1 article 1 and rating 1 2 3 4 5
we'll be checking that we are within the
bounds of how many how much score we can
give this in a moment when we
create rate PHP so let's now move on to
creating rates PHP basically what this
is going to do is it's going to take the
article ID and it's going to take the
rating and then it's going to just put
that into that articles ratings table so
this is rate dot PHP it's just open this
we need to require in app in it dot PHP
file basically because this contains our
database functionality so this is really
important the first thing we want to
check here is if the article exists in
the in the query string or the key R it
exists in the get super global and we
can come and separate these so basically
checking if article and rating are set
here now you might want to check if they
are actually if they actually exist so
for example if they're not empty but in
our case what we're actually going to be
doing in this file is we're going to be
checking if that rating is within one
and five and what are going to be
checking if that actual article exists
so if it's not provided it won't be
inserted anyway so you don't really need
to worry about that empty check so the
article now let's store that in a
variable here and that's just article
again what we're going to be doing is
we're going to be casting these two
integers and that's really important
again because we are inserting here
we're placing these variables into a
query which is then likely to result in
an SQL injection attack so we've got our
article and our ratings stored let's now
check if the rating is within one and
five so we could do complex if statement
here but we're just going to use the in
array function to our advantage we're
going to pass in what we're checking for
and then using the shorthand syntax
again if you're using an old version of
PHP you may need to use array we're
going to check one two three four and
five so that checks if the rating is one
two three four or five basically now we
want to check if the article that's
provided actually
exists so I'm going to create a variable
called exists and I'm going to query the
database and in here I'm going to say
select ID I'm just selecting my D for
the sake of it you don't need to select
ID it can be any field from articles
where ID equals article and then from
this we're going to bring the num rows
you could do something like num rows
true else false like this this is just a
short-handled ternary if statement and
alterna operator so we're basically
saying exists equals if this is a
positive number then this is true
otherwise this is false but you can just
use the number that's returned here so
now what we can do is we can say if
exists and in here we can do our query
to insert that so here we're going to
say insert into articles ratings that's
the table name remember here we're going
to choose the fear the columns that we
want to insert into so article and
rating and then we're going to choose
the values so in this case x and y we
can just replace these remember we are
inserting the article and then the
rating so here we'll say article and in
here we'll say rating like that and
that's it and the last thing we want to
do is just down the bottom I'm going to
relocate the user to the article that
they came from so I suppose we could do
that within here then we have access to
the article obviously if the user
doesn't provide these you'll just
they'll just land on a blank page but
it's certain tightly up to you how you
structure this to work with your
application so we are going to redirect
the user to article dot PHP with an ID
of and then we'll just concatenate on
the article like so cool so let's take a
look if this actually work so what we're
going to do is we're going to hit let's
test all of these we know that if one
works the other is likely to work we'll
test each one though and inside inside
of our database we should see articles
added a record sorry added to the
so let's hit one okay so that's brought
us straight back that looks like it
worked it redirected us straight back it
was so quick that we didn't see it let's
give this a refresh and there we go so
we've got article one with a rating of
one let's do two three four and five
they should now appear in the database
as well cool that looks like it worked
let's go back and let's choose a second
article and we'll do one two three four
and five again and let's again check
that that was stored and you can see
that its article two and the rating has
been stored there so now what we need to
do this is the more complicated bit we
need to basically join this table to
this table taking into account the ID
here matching the ID here so this at
first might seem a little bit bit more
complicated than it actually is so let's
focus first on the index page so we've
already got some article ratings in
there let's just give maybe the first
article a couple more ratings so we'll
give it a couple of fours a couple of
fives or one and maybe a three so we've
got a nice variety of ratings in there
so on the home page now we want to turn
this X into the actual rating out of
five so let's do this now so inside of
index we need to modify this query here
so let's just get rid of this and start
again so what we need to do is we need
to take into account the fact that we're
working from two tables so instead what
we're going to do is this time we're
going to select the specific fields what
we need rather than the rather than
everything because you could be storing
the body against these articles as well
which you wouldn't want to pull in so
we're going to select articles dot ID
which is the same as saying select the
ID column from the articles table we
also want articles dot title as well
that's all we need
but now what we want to do is select the
rating so how we going to pull this in
well I'm going to comma separate this
I'm going to use the average function in
MySQL
I'm going to choose the table name much
like we've done with this here and I'm
going to say dot writing so what this is
now doing is it's pulling in the rating
here the average rating from this table
so we can call this something so I'm
going to call this rating just so we
don't have to muck around when we pull
this in with PHP we can just use the
rating property that will be available
so I'm going to set this from articles
we also then need to join this because
otherwise it's not gonna know what to do
we're going to do a left join because
the article always exists but the rating
might not exist so you can obviously
always have an article but you might not
necessarily have a rating so we're going
to left join and then choose the table
that we want to join on which is article
articles ratings and then we want to say
which fields that we want to join on so
in this case we're matching up the
articles ID field so that's this field
here we want to match that with the
articles ratings the article field so
we're going to say on articles to ID
equals articles ratings dot article this
could be called article ID for
simplicity it's entirely up to you and
then what we're going to be doing is
grouping this by the articles ID so now
this is going to look a little bit
different let's just check that the
query works first of all okay it doesn't
seem to work so let's check it out okay
so it looks like we missed off an S on
this one so that should work perfect so
if now we now should have the average
rating based on that join so down here
instead of X we can replace that we're
already looping through these results
remember we can replace that with
article rating now remember we chose the
average as rating meaning we can just
use the rating property let's check this
out cool so it looks a little bit
strange because obviously we're pulling
in ratings here we need to round
this will also solve the problem of this
being completely blank and this will
round this to a zero by default so we've
got this actual rating here let's just
click a couple more times on five just
to bump that rating up a little bit you
can see now that it's gone up to four
point one let's do a round on this so we
just use the round function in PHP and
we round that off
so that'll round down to four perfect
and that round down to three this has
been effectively rounded to zero so now
that we have that we can basically
duplicate what we've done here and we
can put that on our article page so we
are going to get rid of this we'll pull
this down a little bit here and we're
going to do pretty much the same thing
with a slight adjustment obviously
because we are selecting a specific
article so we don't need to group we're
just going to say we're articles dot by
D equals and then we're going to pass in
that ID that we got from up here so
we're doing the same thing here let's
just check that this works cool it looks
like everything's fine now what we're
going to do though is we're going to
replace that X again with the rating so
we're going to echo out article rating
and we should see that like that and
we'll go ahead and just round that off
like so and there we go
so let's check this article out and you
can see obviously we have a rating of
zero
let's hit five you know that that's
going to go to five we hit rot one we
know that that's going to go to three
and we can hit two and four and maybe a
load of five that just brings that up so
what we're not doing in this tutorial is
we're not checking the amount of times a
user has actually pressed a rating now
you can integrate this in your
completely your own way within your
application because you're storing
article ratings separately this makes it
really easy to store the users ID along
with the rating and then you could
create a similar query to check how many
times a user has
created a specific article so what you
could do is you could say well has that
user rated article one and if if so then
you can disallow the rating you could
also maybe show who's rated this
specific article and you can also do a
count to show how many times that
specific article has been rated so for
example you could have rating three out
of five based on five ratings or based
on ten ratings so there's a lot that you
can do in terms of expanding this the
code we've written is a little bit
verbose and it's not entirely perfect
but this gives you a really good idea of
the general concept behind implementing
a rating system on your website</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>