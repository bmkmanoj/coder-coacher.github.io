<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Basic PHP &amp; MySQL Searching | Coder Coacher - Coaching Coders</title><meta content="Basic PHP &amp; MySQL Searching - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Basic PHP &amp; MySQL Searching</b></h2><h5 class="post__date">2014-07-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gf32KXTP0C4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to be doing
some basic searching with PHP and we're
going to be searching in a MySQL
database so effectively what we're
building here is a mini search engine
for your website and this isn't going to
handle a lot of Records I've got about
500 test examples in here you can see
that we have a database here called
website and it just one table called
articles we've got a title and the body
here you can see there's quite a bit of
content in the body obviously there's
likely to be more here and this could be
any data at all don't worry if you're
not searching for articles this could be
products it could be users it could be
absolutely anything so let's go ahead
and take a look at how this works I'm
going to type in Laura min here just to
see what we get and I'm going to hit
search and you can see that in almost
all of them records that has been found
now we're only showing the titles here
and I've just created them as example
links they don't really go to anywhere
here but at the moment we're searching
the title and the body as well and you
can switch this up depending on which
fields in your database you do need to
search so we're going to be creating
this from scratch you can also see it's
telling me how many records are being
returned which is really good and
they're all listed out here ready for
the user to go ahead and look and click
on so let's build this up from scratch
and see what we can do okay so you can
see that we've got a basic document just
laid out here nothing complicated at all
and we're going to be writing the code
for the form inside of the body here so
in our browser at the moment we've
effectively got nothing there's nothing
to submit through to now the other file
that I have which is important is the
search dot PHP file this is the file
that we're going to be submitting the
keywords through to to perform a search
and bear in mind that this searching is
going to be very basic it's only going
to be based on whether a specific
keyword that's typed in is contained
within the title or body it's not clever
at all there are other solutions for
this so for example we could use a
full-text search but this has been
proven to be slightly unreliable and to
be honest in my opinion if you're going
to go with the full-text search option
we're not going to be covering that in
this video
you
as well use a search engine engine
indexer like leucine Sphinx or something
like elasticsearch we'll go ahead anyway
and we'll build this form out and we'll
submit this through and we'll look at
the basic searching functionality that
we can perform here so the action for
this form is going to be search PHP
that's where this form is going to be
submitted through to and the method here
is going to be get it can of course be
post posted this just basically means
how the data is sent along with the HTTP
request it can either be sent along with
the HTTP request in the content of it or
if you use get that will be sent along
in the URL and then we can pick it up
from the URL either one is it's fine to
be honest but yet just provides you with
that flexibility where you have that
search term in the URL so what we're now
going to do is I'm going to create a
label here and in here I'm just well we
don't really need to create a label but
it'd be nice to say something like
search and then have our input type in
here where our input element so this is
going to be a type of text you can of
course use a type of search if you want
but I'm going to just use text for now
just for styling purposes and we need to
give this a name now this is important
because this is how we actually pick up
the keywords when we post them through
to search PHP I'm also going to put
autocomplete to off just so we don't get
suggestions pop-up and annoy us so down
here just before the form closes let's
create a input type of submit and let's
give this a value in this case it will
be search so when we refresh we've now
got a search keyword there we which we
can click on we've got a search box and
we've got a search an input submit which
we can click that goes through two
search PHP you can see here that we've
got the keywords in the query string but
we've got no data if I were to type in
something in there and hit search you
can see that then to pass through so on
this page now what our job is to do is
pick this up and then go ahead and look
inside of our database for
any of these said the title body that
match this so let's do this now inside
search let's open some PHP tags now I
already have a folder inside of this
directory called DB and I have a file
called connect so I'm using MySQL I to
connect I'm connecting it to localhost
which is my local server root root for
the password and the database name is
website and I'm storing this inside of a
variable called database or DB you might
already be connecting to a database so
in this case you can ignore this and
just use how if you're working at the
moment but this is just a little example
if you're not already set up so what
we're now going to do is we're going to
well the first thing we want to do is
actually require this in so let's do a
require so DB connect dot PHP so this is
going to allow us to actually query the
first thing that I want to do is
actually check if that keywords is set
now this here is called a get super
global and that contains everything
that's within the query string so in
this case we can just use the keywords
key to access that and then what I want
to do is I'm going to store that in a
local variable just here like so so now
if we stick an echo on the front of this
and we go ahead and refresh you can see
that that's just echoing out what we
have so we now have that value storing
keywords ready to put into our query and
actually pull data back the only problem
is that at the moment we're not
sanitizing this before or escaping this
rather before we inject it into our
query so let's do that now before we get
before we forget because that's really
really important so I'm going to use the
DB that we have inside about connect to
actually use the escape string method
and I'm going to enclose that like so so
now what we can do is actually perform
the query so let's create a new variable
to store this so we can iterate through
the results later so we're going to say
DB query and then here will be the SQL
string so let's just create some double
quotes and pull this down just so we can
do this line by line
tends to look just look a little bit
more readable so let's say select and we
want to choose which fields we want to
select so if you haven't already set up
your database table go ahead and set
this up let's take a look at the
structure actually just before we go any
further and we've got an ID here which
isn't necessarily that important but it
does serve as a as a primary key on this
and it also serves as an index here as
well you can see we've got the column
known as ID so that will speed things up
a little bit so we've got a title which
is a text type a body which is a text
type and a publish which is a date/time
publishers optional if you're just
following along this video from scratch
don't worry about publish you don't
really need to populate this so we've
got title body we've got loads of
content field in here oh and by the way
this was actually generated by a library
of PHP called library called faker so if
you do want to generate some dummy data
go ahead and download faker and put this
in a loop and query that within a loop
just you know it's bad practice but it
will just get the data in there for you
and there's plenty of information on
here anyway - how to install it and use
it so we want to select title and the
body sorry the title and publish we're
not going to use publish but this is
just an example to show you that you can
select it we want to choose where we
want to select this from in this case
it's articles and we're going to say
we're body like and then we're going to
choose what we want the part of the body
to be like now in this case for example
if I wanted to hard-code this in I'm
going to do two percentage signs
anything inside of this now will be
matched with anything being on the left
and anything being on the right so if I
was to type a I could probably assume
almost every one of these records here
has an A in you can see there's one
there so this means that search for an A
where anything is on this side of it and
anything is on this side of it so if we
wanted to change that to say well we
want an A to be at the end all we have
to do is do this or if we just want to
match a on its own we could do that we
wouldn't Orden
really do that because we could say
we're body equals a like allows us to
provide these wildcards so let's put
them wildcards in there and now let's
actually inject the key words in there
we are now we're also going to say or
title like and then we're going to give
the same thing so we can take this key
words like so so that's how query
complete what we're going to do now is
we are going to output the results and
then we're going to check if there are
many results and well we're going to
check if there are any results and then
loop through the records so I'm going to
do this within this PHP file probably
not a great idea to just stick this in
the middle of this file it's a little
bit messy but we can do this anyway so
I'm going to create a div and this isn't
styled but it's just giving you an
example of where you might put things so
result count so in here we can say found
X results so in here now I'm going to
replace this X with an opening closing
PHP tag and I'm going to echo out query
and then we can access the num rows
property that stores how many rows have
been returned by this query so before we
go any further let's take a look at this
and there we go so we get far found four
nine eight results let's just test this
out by taking perhaps just this text
here and doing a search for this so we
can go back to our search page
there we go found one result right we've
got one results but with a little bit of
trickery you can change this plural so
we now know that that works and we could
do the same of the body but we very much
know it's searching the body so now what
we want to do is create an if statement
down here to actually check the results
again so we you know this isn't really
harming because we've already have this
property available to us so we're going
to say query num rows so this basically
means if there are results let's create
a while loop and the reason we do this
is because we need to iterate through
the fetch object method on the query
that we've just performed and that will
then give us access to the
results so what we can say we can say
while our is query fetch object and you
can use fetch rose which will return the
results as an array but I'm just working
with an object because I'm already
working with MySQL I in an
object-oriented fashion so we're now
looping through we can escape and reopen
our PHP tags there and then let's say
div class and maybe we'll say result
here again this isn't styled it's just
as an example and let's create an anchor
here just to simulate a link and inside
of here will be the title so let's open
and close a PHP tag and let's echo out
our title and of course because we
selectively published you could also
select the publish date if you wanted to
and you could format that however you
wanted so now what's going to happen is
when we search for something we now get
all of the results listed out for us
perfect so that's pretty much everything
done it's a very very basic way of
searching but I just want to warn you
that this will get very very slow if you
do have lots of records or records with
a lot of data in so you shouldn't rely
on this as a full-scale search solution
for a website particularly if you can
have a lot of content if you don't have
a lot of content so 500,000 records it
shouldn't be too bad but it just depends
so you need to make sure you monitor how
well this is performing there are other
solutions like I've said like Sphinx
leucine elasticsearch and these will
handle searching much better though
initial results from your database and
then they have an API which you can use
to actually search against but if it's a
very very basic search solution this
will do the trick</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>