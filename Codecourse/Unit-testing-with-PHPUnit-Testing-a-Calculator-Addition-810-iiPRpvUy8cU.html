<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Unit testing with PHPUnit: Testing a Calculator: Addition (8/10) | Coder Coacher - Coaching Coders</title><meta content="Unit testing with PHPUnit: Testing a Calculator: Addition (8/10) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Codecourse/">Codecourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Unit testing with PHPUnit: Testing a Calculator: Addition (8/10)</b></h2><h5 class="post__date">2017-01-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iiPRpvUy8cU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so testing and building a calculator
sounds like it's pretty boring maybe
pretty pointless but actually the kind
of idea we're trying to drive here is
that we're gonna have multiple classes
that all interact with each other to be
able to build this up so what we're
gonna do is take a look at how we may
want to use this then we'll go ahead and
write our tests for each of these units
that will come together and then we will
as always along the way build this out
so the idea here then is if you think
about our calculator now normally you
would have say a calculator class so for
example let's just go ahead and write
this out we'd have a new calculator and
then we may say something a calculator
add and then go ahead and give a number
now we don't want to do that instead
what we want to do is create separate
classes for each operation so for
example addition would be a new addition
class and then to this we would add in
our operands so if it's a sum I might
set operands and then we would go ahead
and pass in an array of what we wanted
to add up now apart from this we would
have again something like division and
in actual fact the two that we're going
to look at are addition and division
addition is pretty simple and division
is a little bit more complicated because
we have to deal with things like
division by zero so we're gonna be
testing that this is all handled for us
so again this is a very simple example
in terms of a calculator but it will
give us a good idea into some of the
other assertions that we can use as well
so again we would say set operands and
maybe we would want to divide a hundred
by two so we would obviously get 50 here
and here we would get 15 so the point of
the calculator then would we be to say
something like calculator and we could
say set operations and then we could go
and pass in both division and addition
so we could say division or addition
rather and division now this would give
us the result like the following so it
would give us 15 and then 50 in an array
what we could then do is if we wants to
add both of these together we could just
simply use addition on its own to go
ahead and pass these in
as we've done here as an array so we're
going to be testing addition division
and the actual calculator completely
separately and we're going to look at
lots of different assertions as well so
we're going to look at throwing
exceptions and all that kind of stuff so
now that we know kind of how we want
this to work let's start by writing our
tests as usual now I already have the
tests from the whole of the course but
what I'm going to do is I'm going to
create a separate fold in here so let's
create a calculator folder and I like
doing this just to separate all of our
tests out just because we're writing
tests and they don't need to be as
pretty as we want them to be
we still categorize these just to make
things a little bit easier to find so
let's start with our addition test
because this is the most simple
operation so let's go ahead and create
our addition test PHP file and again
let's just pull over our sample test
just so we don't have to keep writing
all of this boilerplate code so we have
our addition test now let's go ahead and
change this over and of course we'll get
rid of this test assertion as well okay
so the first thing that we want to check
is that when we give two operands they
are added up is as simple as that so
let's go and create our doc block here
for our test and let's start to define
our test out so it adds up given
operands so we'll start by again
creating a class we know it doesn't
exist yet and I'm gonna place this
inside of app and calculator and we're
just gonna call this class addition like
so so now we can go ahead and set our
operands so addition set operands and we
know that in to this we're gonna pass an
array of an unlimited around numbers it
doesn't really matter but that's the
kind of gist of things so now we want to
assert that the result of this operation
is 15 so we're gonna say assert equals
we know that it's going to equal 15 but
how do we call this well we could maybe
have a calculate method like that so
this is a simple test to see that
creating an addition class with two
operands or more
adds up to 15 so let's go and run our
tests as normal and we obviously know
this is going to fail we don't have our
addition class so inside of app let's go
and create our calculator folder and
into this we will create our addition
class so let's create this in here
addition dot PHP and let's start to
define this out and make it pass first
of all so app calculator and we have a
class of addition and let's just refer
back to our tests we know that we have a
set operand method so let's define this
out set operands like this and this
takes in an array of operand so let's go
and say operands and we will set this
operands to your friends we've passed in
and of course create up here our
operands property okay so let's run our
tests once more and of course now we see
that we don't have a calculate method so
we go ahead and implement this and
really interestingly what we're going to
be doing in a moment is completely
refactoring this to extend an abstract
operator class so we'll completely
refactor this well not completely but do
lots of refactoring and we'll see our
tests should pass so again let's say
calculate now how do we go ahead and add
up items within an array well we could
do this multiple way so let's just do
this in a rough way first of all and
we'll quickly go back and refactor it so
to add something up we could say
something like result equals zero we
could do a for each loop over our
operands so we know we're adding up so
we could say each operands as operand
result could then be the result of plus
equals on that operand and then we could
go ahead and return the result so let's
go ahead and run our tests and undefined
variable operands that's absolutely fine
so that should be this operands and
there we go so we get green now so we
know that this is adding up properly but
I'm not really happy with this so
instead what we can do is something
along the lines of
returning array some this operands like
so we've run the tests again and we get
green so successfully refactored now
just quickly before we do any more
testing on this I kind of want all of my
operations to extend a common interface
because I know that I want the same
method on every single operation so what
I'm gonna do is inside of the calculator
folder just here I'm gonna go ahead and
create an interface for all of my
operations so let's create this now so
it's out of the way and done with we can
run our tests again if we want just to
make sure we didn't break anything but
I'm gonna call this operation interface
like so and we'll go ahead and just
define this out and we'll implement it
on addition we'll also implement this on
the division as well so let's go ahead
and say app calculator and this is now
an interface and it's our operation
interface and this just uses one method
which is calculate so public function
calculate and we're done
so let's go and implement this on here
and we now know that this implements an
interface
it requires the calculate method which
we can then implement on any other
operations that we create let's run our
test again and we know that this passes
so the next thing I want to do is test
that if we don't have any operands set
on this we want to throw an exception so
we're going to check with a test that
this throws an exception if we don't
pass any operands in so let's go and
create a new test just within here and
we're gonna say no operands given throws
exception when calculating so very long
but quite descriptive so into here let's
put our dock blocks and let's think
about how we want to do this now when
we're testing for exceptions that are
thrown we need to do this first of all
so I would say something like this
expect it
exception and I'd past the name of the
exception in here so in this case the
exception would be app calculator
maybe that's within an exceptions folder
and then we may be throwing a no
operands exception and we'll grab the
full class name so that's the exception
that I'm expecting to see when I don't
give any operands so very simply then we
want to new up an addition class and we
want to go ahead and try and calculate
so we're gonna say addition calculate
like so so there's no necessarily
assertions here but we are expecting
that an exception is thrown so let's go
and run our test we know that this is
going to fail so we can see here Noah
Prime's exception does not exist that's
the first kind of problem we need to
deal with so let's go over to calculator
create a new exceptions folder and we'll
go ahead and create this no operand
exception so no operands exception and
we'll go ahead and create this out so
name space is now app calculator and
exceptions and we'll go ahead and create
this now so no operands exception we
know that this needs to extend PHP is
base exception class so just pretty
straightforward exception handling and
that is pretty much it let's go ahead
and run our tests again and we see here
array sum expects parameter 1 to be
array not given so this is the error
that we're seeing it's not throwing this
exception so what we want to do is
update our class here to throw an
exception if there are no operands so to
do this we're just going to put a little
check in here we can refactor this later
if we want to we know that we have a
test for it
we're gonna say this or parents grabbing
the count of them if they equal 0 we
want to throw a new no operands
exception and we need to just pull this
in at the top so let's go ahead and use
app calculator and no operands exception
let's go ahead and run our tests again
and we get green so we know that that
has successfully thrown an exception now
if we were to test this out and get rid
of this and we go ahead and run our test
again you
see that we get the exception throat so
it's no good just doing this we need to
actually say to this that we're
expecting an exception now if for
example I was to change this over to
just throw a standard PHP exception like
that then when we run our tests again we
get a failure
so failed except failed asserting that
the exception type exception matches no
operands exception so not only are we
expecting an exception we're expecting
this specific one so now we are on green
with our addition class created what
we're gonna do is move over to the next
part and create our division class which
is going to involve quite a bit of
refactoring of this because we want to
move this set operands method and this
property to a common abstract operation
class that means that because we've
already got our tests in place when we
do do this we should still get green so
let's hop over to our division then
we'll finish up with our final
calculator which is a little bit more
complicated</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>