<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Emulating switch/case Statements in Python with Dictionaries | Coder Coacher - Coaching Coders</title><meta content="Emulating switch/case Statements in Python with Dictionaries - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Python-Training-by-Dan-Bader/">Python Training by Dan Bader</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Emulating switch/case Statements in Python with Dictionaries</b></h2><h5 class="post__date">2017-01-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gllUwQnYVww" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey folks how's it going so this is a
new video in the Python tricks series
Python tricks is a new book that I'm
working on it's like a buffet of awesome
features in Python that show you you
know the whole book is organized the way
where there's small chapters that each
show you a really cool feature in Python
like a really practical feature you can
apply in your own day-to-day work and
I'm doing this video series to kind of
go with the book and of course also to
promote the book so if you're interested
in these videos and interested in
improving your Python then be sure to
check out the book it's available for
early access right now so you can get in
get in now and then get all of the
future chapters as they come out all
right shameless plug aside today I want
to talk about a really cool Python trick
and that is a way to emulate switch case
statements in Python so what I
frequently see in Python code is that
people end up with these relatively long
if statements this these kind of chained
if statements to decide on what what
action to take based on a condition in
their code so to give you an example
let's say we had you know this if
statement where we had a condition and
we wanted to compare it to a certain
value and then okay if we get a we want
to call handle a and if we get condition
B then we're going to call handle B and
if we get none of these then we're gonna
call handle default right and you can
imagine that this would go on for much
longer and this would get kind of
cumbersome right and it's it's a lot of
typing and the reason for that is like
Python doesn't really have switch case
statement with which we could use to
kind of condense this a bit and make it
more terse and just easier to read
so there is actually a way to emulate
that switch case behavior in Python and
I want to show you how to do that and
the way to do that is by leveraging the
fact that Python
as first-class functions so functions in
Python they're just like any other
object you can pass them as arguments to
other functions and you can return them
from functions as values and you can
store them in variables and store them
and data structures so this is actually
a really flexible feature in Python to
give you an example we can define a
simple function here that takes two
arguments and just returns the sum of
both and actually I could actually go
ahead and say hey I'm going to store
this function in a list that I'm going
to call my funks and then I could just
refer whoops I could just refer to that
function and call it right so if I did
that I would actually get a result dad
is five because it's at it's adding
together two and three right I would
just well with the with the index here
just grab the first function in there
which is my func which we defined up
there and then I can just call it with
the the braces syntax so this is
extremely this is extremely flexible and
this is a really cool feature it's going
to allow us to emulate how a switch case
statement would work all right so let's
come back to our original plan here
which was emulating a switch case
statement so now that we know we know
about these first-class functions what
we can do here is actually create a
function dictionary that maps from the
condition name or from the actual
condition to the handler function right
so something like this where we're just
mapping from the condition to the
handler function and then I could look
up that that handler function just by
passing the dictionary condition as a
key into that dictionary right and then
I could just call the resulting function
and this would actually be sort of a
switch case statement right
and we could shorten that further I mean
you know we don't have to give a name to
this like we could just do this and this
would already be kind of terse or you
know there's not a lot of overhead to
this but it has a big downside and that
is we're going to get a key error if the
condition isn't found so there's no
default at the moment
right like previously with the if
statement we had NL's all the way at the
bottom and that would allow us to to
have a default branch that we can take
and a default handler that we would call
and we can't really do that right now
so actually one way around that is and
let me undo some of that so actually one
one way around that would be to use the
get function on the dictionary so we
could just call get and then that would
either return the value for that key if
it's found or it would return a default
in this case we're just you know pass in
the handle default function that we'd
have to define and then call that so
this would this would actually solve the
problem with the key error and we'd be
able to have a default and have kind of
this dispatch based on this function
dictionary here which is already kind of
neat and you can imagine like this
becomes really useful if you have many
many many functions that you want to map
to or many conditions that you want to
map to functions because then it
actually becomes a lot more efficient
then an if-else statement because an
if-else it needs to try all these
conditions in in sequence but with a
dictionary it can actually take a
shortcut and do a lookup based on the
hash of that condition that can be a lot
faster if you're dealing with many of
these mappings I mean if you're only
dealing you know with tens or
potentially even hundreds of them it
won't matter so it would be a premature
optimization but for you know a really
large number of functions and conditions
this could be extremely helpful so this
could be a really nice trick for you to
actually speed up your Python code to
optimize
so now this might look kind of kind of
weird syntactically and there's actually
one step we can go beyond this to clean
this up and I want to show you how to do
that now all right so let's take a look
at a little bit more realistic example a
little bit more complex example so I've
got some code here that is an if
statement
that that would do the dispatch for us
so the idea for this would be you know
maybe we have we're implementing some
kind of virtual machine and want to be
able to pass it an operator and two
operands and then it would look up the
operator and then carry out some
operation based on that right like would
either like at the two numbers or
subtract them or multiply them or divide
them so you know it's just a little toy
toy example here okay so just to show
you how you would use this function so
we're going to call the function and we
would pass the instruction of the
operator to it so in this case we want
multiplication and then we would pass
two values to it and the result of that
we would expect the result of that to be
16 right 2 times 8 and this would just
kind of go through that if and say ok
well we're looking for the operator is
mall so I'm just going to return x times
y and this is how this would work now if
we wanted to implement the same function
using this this dictionaries as a switch
case emulation of sorts then it would
look a little bit different and I'm
introducing another Python feature here
into the mix so so let's just walk
through that right so this this would
actually be a little bit shorter and so
what this function would do it would
create a dictionary and then it would
define these handler functions with a
bunch of lambdas here so this is a way
for us to not having to define these
handle add and handle sup and all these
helper functions separately but we can
kind of keep that
that actual behavior in line here and
then we're using all we're creating this
dictionary and then we're using the get
method on a dictionary with the operator
and our default is just returning none
so you know you might have you might
have seen here this if if we fall
through all of the cases and none of the
match the Python doesn't implicit return
none here at the end or we you know we
could also explicitly add that and would
probably be better for real-world code
like doing something like this or just
doing something like this where you know
there's just no way we can fall through
I mean in this case it would both be
equivalent so you know I wanted to
remove that too to kind of show how
tourists this could also be but really
here you can see that this is equivalent
to this code up here and it looks kind
of nice I mean it's not like exactly a
switch case statement and there's
actually one big downside to this that I
want to mention as well but it works
kind of nicely and it can be a good way
to do like to work in these dispatch
situations where you want to map you
know some condition to some kind of
behavior it can be really helpful way to
structure your code now one downside to
doing it like this is that you're
constructing a dictionary object and a
bunch of lambda or a bunch of functions
every time this dispatch Dyck function
is called which which is not great right
for memory reasons and for performance
reasons reasons it's it's not a good
decision I mean it won't matter if
you're not calling this a lot it
honestly won't matter and I would go
with whatever is cleaner but one way to
get around this would be to take this
value and or this dictionary and
actually store it in some variable in
some other place and then you can refer
to it right like if you have this
massive dispatch table mapping from
condition to handler I would just cache
that somewhere keep it in a variable and
then in your actual dispatch code you
would just take that dictionary
and look up the function and then call
the function and that way you don't have
to recreate this dictionary every single
time the function at the dispatch
function is called but you know like I
said if you're doing this with just a
couple of cases and it's not in like a
tight loop like a hotspot in your
program you probably won't matter and it
would be premature optimization I would
go with whatever looks better to you I
mean another downside here is that this
is pretty advanced Python so if you're
doing this you know depending on the
skill levels in your team or the people
you're working with you might have a
heart people might have a hard time like
dealing with this right because it can
be so foreign like you need to
understand first-class function all of
these advanced level features whereas a
nice and clean if statement it gets a
job done it might actually be the better
choice in a lot of situations so you
know just want to make sure you are
aware of that but it definitely has its
place and it definitely has its
applications and again I think it's a
really cool feature that teaches you
about some of the you know cool
lesser-known aspects of Python and well
if you enjoyed this example then I think
you'll really enjoy my new book called
Python tricks you can get in for an
early access with this book right now so
I'm kind of writing this book as we go
along and if you get it now you can get
it for a much cheaper price and then
you'll get updates for free as they come
out and yeah so you know feel free to
take a look at that obviously don't have
so you can just keep watching the videos
but I would really appreciate it cool
well thanks so much I hope this helped
you out and best of luck in your Python
journey I'll talk to you soon</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>