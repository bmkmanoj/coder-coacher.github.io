<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Server-Side Render Vue Apps with Nuxt.js (Server-side Rendering with JavaScript Frameworks) | Coder Coacher - Coaching Coders</title><meta content="Server-Side Render Vue Apps with Nuxt.js (Server-side Rendering with JavaScript Frameworks) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Firebase/">Firebase</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Server-Side Render Vue Apps with Nuxt.js (Server-side Rendering with JavaScript Frameworks)</b></h2><h5 class="post__date">2018-01-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZYUWsjUxxUQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I always have to be very careful in the
beginning because that's when they take
all the bloopers now I look at the
camera I'm like what are you gonna do to
me today editing through everyone
welcome to the view jeaious episode in
the server side rendering with
JavaScript framework series so every
news view JSP 4 it's a really cool
framework with a really cool logo and
one of the reasons why I really like it
is because it comes with a server-side
rendering library called next and with
next you kind of just like set up some
configuration and then you have a
server-side render it out and it's
really really easy to do so today we're
going to set up knucks - not only
server-side render our assets but to
split up our static assets from our
server assets so let's dive down into
the laptop and get started so I'm here
in the command line and I'm going to
create a new project so m'kay dear I'm
gonna call it next SSR and then I'm
gonna CD into it so now I'm gonna use
the view CLI which you can NPM I - G
view CLI but since I have it already
installed I'm gonna use it to bootstrap
up my app so we use the view CLI but I'm
going to actually use a starter template
which is knucks - community / starter
template and this SRC is actually what
I'm going to call the folder inside of
my project cuz it's my source so project
names call it source and I'm really just
going to go through and use all the
defaults so now that I have that done
I'm going to make a public folder and
I'm also going to make a functions
folder which will contain our static
assets and our server dynamic assets
respectively so now I'm gonna CD into
the source folder and I'm going to npm
install or if you want to use yarn which
i'm gonna do i'm going to install
everything and now i could open a code
editor here but instead I'm gonna CD out
and open up my editor so you can see
right here we have this source folder
and source has all these files and we
actually really don't need all these
files this is what the template gives us
we do want to look at is this pages
folder so instead of pages we have this
index dot view file and you can see we
have this template we have this script
section in the Style section and all
this together is known as a single file
component so you've ever been scrolling
through your social media feeds and
you're wondering why everyone's talking
about SFC s well SFC is a single file
component so what we're gonna do here is
I'm just going to delete all of the
defaults contents and the default
templates and we're gonna start from
scratch so I'm gonna see the edge of the
source folder and i'm gonna add
isomorphic fetch and isomorphic fetch
we'll make it so we can do HDV across on
the client and the server and with that
installed I can now go into my component
and I can import fetch from isomorphic
fetch and then inside of this export
default I'm gonna create a method called
async data a sync data isn't just a
method I made up it's a method that view
and next provides for you and what you
do is you can resolve any asynchronous
data into your component and in our case
we're going to be retrieving a list of
facts from the server so this is exactly
where we want to do our network requests
and if you're wondering with the async
keyword it means it means that we're
returning a promise from this method and
so this is all brand-new snazzy fancy
async/await es 2017 code so inside here
I'm going to get the response back by
fetching from this URL and since it's
asynchronous I can await it and I can
pretend that I don't have to use the
callback and then now I can get the
response back as JSON which also is
asynchronous so I will await on that and
with my fax I'll just return it as ad
structured object so with our async data
out of the way we can actually go and
make our template so I'm going to create
an unordered list and then an Li I'm
going to use the v4 directive to say
let's render the fact MD FACS and this
is going to give us an error because it
wants us to use a key directive
and I don't really have an ID or
anything at the moment so I'm gonna do
something cheap to get rid of this error
I'm gonna say faq.txt but don't do this
at home
so now inside here I'm going to render
out the fax text and then just paste in
some really bad styles I made myself so
now with this done let's go into the
source folder and I'm gonna write yarn
dev but for NPM users would be NPM Run
dev and this will spin up a nice little
nook server for us so it's building and
we have six problems and if you look at
what the problems are it's actually all
stylistic so this default template uses
a standard style guide which doesn't
want semicolons but I quite like my
semicolons so what I'm going to do is
I'm going to go into the es lint and
just get rid of this extends standard
section so it's not gonna complain to me
about how I'm writing my code anymore
but if you like the standard you know
style guide go forth and do that
yourself
all right so now that that's done I'm
going to run the dev server again and
it's now on localhost 3000 and you can
see outside of this padding issue that
our site is up and running and if we go
and actually and view the page source we
can see that there is HTML this was a
server-side rendered app and we can even
see our window data located in the
script
so we have a server-side rendered app
working locally but all the code that
we're using works in a modern browser
but it's not gonna work in older
browsers we're using Const and
async/await and D structured objects and
all that fancy new stuff so we're going
to need to be able to compile that code
down so it works in older browsers and
fortunately we can do that with babel
and even better next has an integration
with viable with just a few lines of
configuration we can get our code
working with older browsers so let's get
that going
so before we can get Babel running we're
going to actually need to go into our
package.json and what I'm gonna do right
here is is I'm just gonna add a few
dependencies so down here our dev
dependencies I'm going to add these four
I'm gonna add module resolver transform
runtime preset es2015 in preset zero and
all of these things are gonna be needed
to make sure our code works in the older
browsers so I'm gonna open up my command
line and I'm going to yarn so it just
goes through and installs everything or
you could just use NPM I and now that
that's setup I'm gonna go into this file
called next config jeaious so next
config js' is this big configuration
file that you can do lots of different
things with we have this section up here
for heads which is the head tag for your
app and down here we have this section
called build and this is where we're
actually going to be able to configure
how our application gets build where it
gets build to all that great stuff so
I'm going to specify a public path and
I'm going to say that it is in our
public folder and this will be our
static assets are then I'm gonna use
this vendor array and this is our
vendored libraries so in this case
isomorphic fetch I'm going to use
extract CSS and then now I get to
finally use my babel setup so inside
this babel object is where i can
actually set how I want my code compiled
down so the first thing I'm going to do
is I'm going to set my presets so I'm
going to use the es2015 and the preset
zero and the stage zero now I'm going to
specify a plugin so for this plug-in I'm
going to use the transform runtime
plugin which is what's going to help me
convert my async/await code down to just
you know regular es5 code so now that I
have my plugin specified I'm going to do
a yarn build to build out my knucks tab
so open up the command line say yarn
builds and you can see it builds without
a problem so wow it builds it doesn't
build to the right place
wanted to build out to my functions
folder because that's where my server
apps going to be so above build I'm
going to set a build directory and
that's going to be dot dot slash
functions slash next because that's go
up one directory and store it inside the
functions folder so I'm gonna open up
the command line again and I'm going to
run yarn build and you can see that when
I do that we get an error and it says
that it can't find the transform runtime
plugin and that's because now that we're
going to the functions folder it's going
to look for dependencies in that folder
and we don't have anything there so what
we're going to need to do is set up a
package.json and install everything into
that folder so I'm gonna open up the
functions folder and I'm going to create
a new file called package.json and I'm
gonna paste in this package that JSON
and all the needed dependencies and if
you check the link in the description
I'll have a little gist where you can
just go and copy and paste this too but
what we're doing here is is that we're
including dependencies for babel we're
doing some other peer dependencies for
view j us and next and also doing
firebase MN and firebase functions so
now I'm going to CD out of my source CD
into functions and then do a yarn or an
NPM I to install it and with that being
done I'm going to go back into source
and run yarn build again and as you can
see we don't have any errors and we have
our knucks folder so we have our server
dependencies set up in our functions
folder but it's also going to contain
all of our static assets and we don't
want to deliver static assets from our
function server we want to deliver that
from a firebase hosting CDN because
these static assets are like our images
our CSS our client-side JavaScript those
don't need to be generated by a server
we only need to generate our server-side
rendered HTML so what we need to do is
we need to take these static assets and
we need to put them in our public folder
so they're served from firebase hosting
CDN and separately from our server
rendered assets so let's dive down and
get start on that so in the terminal for
the source folder and I'm going to CD
out and now I'm going to do the CP to
copy assets from functions next slash
dist so dist will contain a lot of our
static assets and I want to copy them
using - our since it's recursive and
copy it out to public slash assets and
now if we go into the public folder we
can see we have all of our assets just
copied over so now that we have the
static assets copied over we can
actually go and set up our server code
so inside of functions I'm going to
create an index dot GS and I'm going to
require from firebase functions and also
next Express and then create an express
app to get my server started so the
first thing I need to do for my knucks
server is set up a configuration so I'm
gonna paste in this configuration right
here
it basically says we're not in dev mode
our build dear is a knucks folder but
you can see right there and our public
path is the public folder and so using
this configuration I'll create a new
knucks server by passing in the config
so now I'm going to handle request
through this handle request method which
will take in a request and return a
response I'm going to use next dot
render route I'm going to say go to the
root route since we only have one page
in our app and this returns a promise of
a results and the result has a HTML so I
can say res dot send result that HTML
but we also could have errors so I'm
going to use a catch block and if
there's any errors I'm going to send the
error message so now that we have this
handle request I can say app dot get all
routes handle this requests and now all
I have to do is export the function I'll
call it SS our app functions dot HTTP
dot on request past
the app so this right here is really
awesome because it's just a few lines of
code and we are server-side rendering
this HTML but what we aren't doing is we
aren't setting up the CDN caching for
our dynamic server-side rendering
response so what we can do is we can go
up to handle requests and we can set the
cache control header so if cache control
will say this is a public cashable asset
it has a max age of 600 seconds and an s
max age of 1200 seconds max age says
this will be cached in the users local
browser cache for 600 seconds and s max
age says that this will be cached on the
CDN level for 1200 seconds so now the
way our server code set up I'm gonna go
and run this locally and you do that I'm
gonna need the firebase CLI so you can
install the firebase CLI with NPM I - G
firebase - tools but since I have it
installed I'm going to save firebase in
it hosting so I'm not going to choose a
default project but you can choose
whatever default projects you want I'm
gonna say my public directory is the
public directory and I'm not going to
configure any single page app routes and
then inside of public I'm gonna delete
the index dot HTML and the 404 because I
don't need them and then I'm gonna go
and open up firebase JSON so in firebase
hosting I'm going to set up a rewrite
for my server-side rendered app and this
rewrite will be able to tell cloud
functions in firebase hosting how to
communicate with each other so I'm gonna
say for all routes call this function
call it SS our app and SS our app is
what we named our clan functions so
it'll know how to talk to each other so
now I'm gonna serve this locally with
firebase serve only functions hosting
and I'm going to set a port of 5004 so
it looks like our app is working but if
we open up the console we can see we
have these errors of this unexpected
token and if we go into the network
panel and we click on one of the assets
you can see that it is looking for this
asset in a public folder and what is
happening here is is this is not being
recognized as a static asset so it's
going to our server
and it's trying to generate an HTML
response which is why we have an
unexpected token so what we need to do
is we need to fix how we're setting up
our static assets so if you ever see
this method it's because you're
generating HTML rather than serving your
static asset so to fix this I'm gonna go
open up the next config j/s and I'm
gonna change the public path to just be
slash the root of my directory and then
I'm gonna go into the index J s and then
also change that to slash and if you're
wondering yes you could just require
this config file and use it right here
but just to make things explicit for
this tutorial I'm using two separate
versions now that I've changed the
config I'm going to open up the terminal
and CD into the source folder and build
the application again and now that it's
built successfully I'm going to CD outs
and I'm gonna make sure to copy the
assets again go to functions next dist
and this time I'm just going to copy
them flat into public so an open up
public you can see over this nice flat
structure and now we are ready to deploy
so I'm just going to say firebase deploy
and I can now go visit this URL and in
the browser we have our nice server-side
rendered application and if I
right-click and view source you can see
it's a nice server-side rendering
application so that's all there is to
setting up next on firebase hosting if
you like this video make sure to check
out the next one we're gonna go profile
it using the chrome dev tools and
webpagetest so that's all for today make
sure to LIKE and subscribe if you
haven't already and I will see you in
the next video oh hi there</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>