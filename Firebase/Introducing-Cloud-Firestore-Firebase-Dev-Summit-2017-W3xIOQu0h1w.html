<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Introducing Cloud Firestore (Firebase Dev Summit 2017) | Coder Coacher - Coaching Coders</title><meta content="Introducing Cloud Firestore (Firebase Dev Summit 2017) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Firebase/">Firebase</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Introducing Cloud Firestore (Firebase Dev Summit 2017)</b></h2><h5 class="post__date">2017-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/W3xIOQu0h1w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Alex do fatale and I'm the
product lead for firebase back-end
services today we want to talk to you
about building planetary scale apps
using firebase specifically we want to
talk to you about caught fire store the
new database we launched earlier this
month but before I get started let's do
it like a quick survey how many people
here have used a real-time database I'm
gonna get closer so I can see Wow okay
quite a few people how many people here
have used functions alright almost as
much and has anyone here already played
with cloud firestore wow wow that's
probably more than I expected that's
great so first we're going to talk about
how cloud firestore addresses some of
the toughest problems of building mobile
and web apps will then get hands-on with
a demo so we can see the database in
action and after that we'll have two
teams who have been building with cloud
firestore come on stage and share their
experience building with the product
cloud fire store was inspired in many
ways by our experience building the real
time database and by the feedback that
we had on the real time database over
the years so bear with me as I step back
and talk a little bit about the journey
that led us to building this product
when firebase launched in 2012 it
introduced a fundamentally new way to
build apps the real time database solved
many of the hard problems of dealing
with app data specifically it does three
things very well that make it and/or
make our lives much easier as developers
one it allows us to access our data
directly from clients
- it allows us to access that data in
real time and three it makes it very
easy to build offline experiences code
firestore does these three things as
well and we'll dive in why we think
these things are so fundamental in a
minute
at its heart the real-time database is
designed to do one thing incredibly well
sync app state in real time at low
latency but over the years as adoption
of the database grew usage patterns
shifted the real-time database is being
increasingly used across app data as an
all-purpose persistence layer and is
also being used by larger and larger
apps and when we stretch the real time
database outside of its core purpose you
enter you face two types of issues the
first is around data modelling and
querying the real time database can't
query over multiple properties and so
you can go around that but that involves
convoluted data structures usually
duplicating data and/or client-side
filtering all of which are kind of messy
the other problem is that the real time
database doesn't scale automatically
beyond a hundred thousand users which
usually accounts to tens of millions of
daily active users you have to create
additional shards now granted this is a
pretty high limit but wouldn't it be
amazing if you could build an app and
grow it to planetary scale without
having to change a single line of code
and this is why we built called fire
store caught fire store is a no sequel
document based database that we built
specifically for mobile and web app
development it builds on what we love
most about the real time database and it
combines it with Google's powerful cloud
infrastructure it's flexible to build
all
of apps and scalable to grow with you to
any size and this is something that I'm
personally very excited about because
before joining Google I actually spent
five years building and growing a
company that was powered by firebase
services the real-time database
including the real-time database we
built a real-time collaboration app and
we started using the real-time database
because we needed a tool to power our
collaborative whiteboarding and a few
weeks in trying like playing around with
with firebase we incited this instead
decided to build our entire app using a
real-time database and with hindsight it
was one of the best engineering and
business decision that we made as a
company it allowed us to focus on
building features that really matter to
our users instead of infrastructure that
wasn't core to our business but and and
that is really I think a testament to
what fire raised is really about but we
also hit some of the limitation talk to
my talked about earlier
so cloud fire store was really the
database that we dreamed of having when
we were building our company so I
couldn't be more excited to see it in
beta today and I can't wait to see what
all of you will build with it next and
with that I'll turn it over to Sarah
Allen to tell you more about what makes
cloud fire store so special
so cloud firestore it's fully supported
by all of the firebase SDKs which is the
most of you know means that it works on
web iOS and Android and these SDKs let
your native mobile app your web mobile
app talk directly to the server and you
don't have to write a middle tier and
that handles the data validation access
control all that stuff automatically for
you so you can focus on building your
business value rather than writing this
boilerplate code so all this works
seamlessly because the firebase
authentication and security rules so you
have some declarative rules that let you
say what data you want to be accessible
from your client app and what can be
readable and what can be writable the
other thing that's really new here is
that you can extend it on the server
side with cloud functions so as many as
you as many of you know server-side code
can be really helpful it's code that's
run in a trusted environment so you can
make fare decisions for your on behalf
of your users you also sometimes have
some secret sauce algorithms that you
want to have only and it run in a
trusted environment of course we can
also coordinate multiple communication
which is what real-time is normally
famous for including things that run
when when people aren't always there
that make your app feel more alive like
multi-party like autonomous agents and
BOTS so when we talk about serverless we
don't mean there's no servers of course
we're leveraging the server to do all
sorts of things that it means that you
don't have to manage the servers so you
can focus on building your app the
capacity planning upgrades maintenance
all of that is taken care of by the
system without any scheduled downtime
also it's replicated in different
regions so that
if is we hope not but if there were to
be a natural disaster in one region your
data has been replicated and it would
just be there for you this globally
distributed database scales
automatically with usage so we're
building different type of apps today
for a long time it's become completely
expected that every app we build works
on mobile and desktop web of course so
the people who use those apps are
starting to expect that they can have
multiple devices and it'll all just work
and sometimes it does but you all know
that sometimes it doesn't actually so
we've built that stuff into the
firestore sdk to make it so that you can
just build your app normally and then
these experiences can transition
seamlessly between people with multiple
devices and then of course that extends
to multi-party communication as well
so this same thinking which the SDKs
really make easy for you by doing data
binding between client and server
changes those that same paradigm really
allows for a completely different
purpose which is getting stuff on the
screen faster so when you use data
binding you can make it so that the UI
elements on your client app are attached
to the parts of you know the server
stuff that they're supposed to show and
then you just show your screen as soon
as the minimum amount of data is there
and then as the data arrives on the
client it just pops in and this can make
your app feel dramatically faster and
that model of programming is just
becoming more popular in general and
leveraging the SDKs it means that that
that pattern can serve you in these
different environments so offline you
wouldn't believe how normal it has
become for people to look at their apps
when there is absolutely no chance of
connectivity and so that many of you
have probably built these types of apps
where you cache stuff locally and then
you
to sync up when you're back online and
it can get a little tricky so we've
taken that common problem and put it
into the firestore SDKs so that they
sync up with a service that you can your
app can run offline and then when you
connect it syncs back up again and we'll
show you that later it's off it's
available on all the platforms including
web so this is really made possible by a
new data model in firestore so you
structure your data with documents and
collections we based this model based on
what we've been watching for years in
terms of real time database developers
and how they wanted to model their app
and what they were doing naturally that
we wanted to enable as their apps are
growing and having more and more
customers so we've taken some common
patterns and we've built that into the
data model and what we've seen so far is
that new developers who are coming new
to firestore are finding it more
intuitive to just get started and it's
accelerating the learning curve which is
great but the really exciting thing is
that this data model actually is what
allows this scalability so the key thing
is that your client-side query
performance is based on the size of the
results set not the overall size of the
data that you're querying over so you
build some app and it's just you and
your buddies other engineers in the
office and you're testing it out and it
works really fast and what normally
happens is then you get you know
millions of records and it starts to
slow down because you have to optimize
all your stuff
well we developed patterns that means
that what works with a small data set
will work for the large data set and
it's all about how much data you need to
pull down for the client and we'll dive
into that next so this is the new fire
store UI which is kind of a data console
in the backend of your app the first
column shows the collections so in this
case we have a single collection called
items
in the second column you can see all our
documents this each document has a
unique ID and this particular app has
millions of documents and you can scroll
through them and it keeps through you
know auto scrolling the way you'd expect
and our app could grow to have tens of
millions or billions of documents and
the client side queries would say
they'll have the same performance
characteristics in the third column you
can see one of our documents the
documents are structured data kind of
think of them like JSON so this is a
specific app that we worked on for this
conference and I'd like to invite Johnny
diamond out here with me to tell you
more about this app thanks Sarah hi I'm
Johnny and I'm an engineer on cloud
firestore today Sarah and I will show
you firestone action we'll be showing
some of the core functionality and
features that make fire so special for
this we built an offline capable
progressive web app the app allows users
to submit stories and the community to
vote on the best stories and comment on
them similar to hacking news the app is
built using HTML and CSS and vanilla
JavaScript all of the static content is
hosted on firebase hosting however the
data is backed by Firestone and when you
load up the web app it will use the
firestore SDK to load the data directly
from fire store without any any
additional backends we store all the
submitted news stories in a single
collection called items every story is
its own document in fire store and has a
unique ID attached and we save a bunch
of metadata about each story for example
who submitted the story when was it
submitted and what's its call
when we built the web app we spent a
bunch of time dealing with CSS and
making sure the app looks great
however the integration with firestore
was easy it was so easy that we could
fit the code the POW is the front page
onto a single slide I'll walk you
through the code line by line the first
thing we want to do is get an instance
to fire store we do this by calling fire
based on fire store this is a pattern
you might be familiar with from using
other fire based products on the web and
the file store instance will be
configured with your default app
configuration next we have to tell fire
store which collection we want to query
in this case we're creating the
collection of items for the front page
we don't want to display any kind of new
story we want to display the top news
story so we have a special property in
the documents that tells us the order of
the new stories on the front page so we
order by these by this property and next
we don't want to display all new stories
we want to limit it to the top 30 so we
add a limit now we've formulated the
query the next thing we want to do is
actually run the query for this we call
on snapshot what happens next is the
firestore sdk we'll go ahead and
establish a connection to the back end
if it hasn't yet it will then issue the
career to the back end the back end will
go ahead fetch the results and send the
back to the client we then will get a
call back with the data and we can use
that to render the page one of the core
features of fire store is real-time as
the data changes you want to update UI
with these changes and there's no
additional code we need for that as
things change the back end will make
sure to notify the clients and the sdk
will call on snapshot again so let's
switch to the demo and see this in real
life here we have a browser that has the
app loaded up and it's showing the top
voted stories over the last couple of
days
let's assume that someone submits a
story and it rises to the top really
really quickly
really really quickly so Wow
what are the odds that this story shows
up just in this instance what the SDK
does for us is it notifies us and we can
just rerender the UI very easily there's
no additional code required at the core
firestore are scalable queries so let's
go ahead and click on the submitter of
the top story this now shows a different
page it shows a page of all the stories
submitted by Sara
however it's backed by the same data
it's using the same collection it's just
using a different Korean filtering out
all documents or all new stories that
were submitted by Sara so let's go back
to the slides and look at the code for
that what we can do is we can add
filters to our collection in this
instance we're filtering by who
submitted the story but more we can
start chaining filters for example we
can say we wanted to look at documents
that were submitted by Sara Allen but we
want to limit it to documents that have
been submitted in the last year as Sarah
mentioned earlier firestore are built
around fire so is built around scalable
trees this means the performance is
based on the size of your result set not
the size of the collection and this is
done by you making heavy use of indexes
by default firestore has a bunch of
built-in indexes that make the most
common kind of trees that you issue just
work out of the box there's no extra
configuration required as your app adds
more advanced queries and more complex
queries it might require an index but we
make that really easy too let's zoom you
let's assume you develop
the app and you issue a query that
requires a different kind of index that
prairie will fail
however the SDK will notify you about
this and will give you a link if you
follow that link it will bring you to
the firebase console and it will show
you a pop up dialog to create that index
on the fly with a single click one thing
to note is as you use scalable queries
you might have to put some thought
upfront on how to structure your data we
have great documentation online on how
to structure your data and what kind of
queries are supported by firestore first
also comes with offline support for
Android and web Android and iOS but we
also added support for offline on the
web so let's switch to the demo we can
click on the comments link for the top
story and this page loaded just fine and
I hope you're not surprised because
we're still online so let's change that
and disable the Wi-Fi on the computer
let's go ahead and refresh the page and
again the page loaded just fine we use
service workers for the static content
for example the HTML and CSS however the
data is backed by firestorm and file so
make sure that even if your device is
offline the data still provide in your
career results but it gets better let's
try and add a comment while we're
offline
so we added the comment and it shows up
immediately and even if we refresh the
page the comment is still there if I
still make sure that any changes you
make while you're offline are persisted
and show up in the results when you run
the query offline that is useful but it
would be even better if the query or if
the changes are synced back to the
backend and to other clients so let's
open up the page in a different browser
so this is simulating a different client
on a different device and not surprising
the comment doesn't show up we're still
offline we didn't have a chance to
actually sync back the data so let's
change that Sarah why don't you
re-enable the Wi-Fi so we'll re-enable
the Wi-Fi and a couple of things happen
now one the computer has to reestablish
the connection to the files to sdk will
detect that the client is back online
and re-established the connection and
once it does that we'll check for any
changes that may have happened
while the device was offline when it
does that it sends the changes to
back-end and it will simply synced out
to all other devices
Sara why don't you post the same comment
into slack let's go here and I've got a
team slack Wow is that the same comment
you just posted right now it is let's
try that again
alright I'll post another comment
so the column was posted and it showed
up in slack so Sarah why don't you
explain how you use cloud functions to
build this all right so this is one of
my it's hard to even pick favorite
firebase features so let's go back to
the slides and I'll show you how this is
done with just a little bit of code we
push it up to the server side and we can
not only add functionality to our app
but you these days are the are at our
people are using lots of different apps
and so this allows us to integrate with
other apps so this is all the code for
the cloud function that triggers that is
triggered when firestore writes so I'll
just walk it through with you so the
first line is just like Johnny showed
you before he was showing you the
client-side SDK code this is the admin
SDK which looks very similar so you get
an instance of firestore you specify the
path that you want to that you care
about and whenever a document is written
in that path in this case when it's
created we're registering for an event
that will trigger this function on the
server side I'm getting the data out of
the event and then in this case our team
is saying oh we want to know about all
stories all comments that mentioned
firebase and so in that case I'll call
us a regular JavaScript function to post
a slack or otherwise ignore it so and
then just for completion this is the
JavaScript function that posts the slack
slack has a web integration we can just
specify a web hook so that web hook
actually is a simple URL that I'm making
a post to which has my credentials in it
and I don't want to put that in my code
so I can put that in my inner functions
config so that's like an environment
variable that stores that information so
you can use cloud function triggers to
connect to all sorts of different
server-side api's across firebase and
class
and so this means you can start to
develop your app and you can do the
complete experience using client-side
only code and then add in different
functionality even after your apps
already distributed on the Play Store or
the iOS store so I'm really excited to
see this is just a little peek into what
you can do with cloud functions and
today as Alec mentioned we have a couple
of partners who have been out in the
wild building stuff with our products
and so I want to invite Clark from
whipper and his team out to tell you
about what they've built with cloud fire
store and cloud functions Thank You
Sarah really really happy to be here
today I want to start off by talking
about our vision for why we actually
created whipper and the underpinnings
for firebase so we are at a place right
now where whipper is my lifelong passion
for content and my work life experiences
have been in technology feature-film
comic book publishing and global video
games including publishers and
developers such as NCsoft
pandemic Bioware and Riot Games all
roads lead here - whipper whippers
co-founders advisors and investors hail
from a wide range of name-brand global
companies such as viber Rakuten Riot
$0.10 Netflix and Expedia we are really
at a place right now where the content
that we're developing is pretty exciting
this is something that's where we are is
I'm gonna I'm gonna hand over in terms
of content right now because we're
running short on time
Dave's gonna introduce both the demo and
where we are today thanks Clark hi folks
we're gonna cut to a quick demo of our
product and then I'll talk about how we
got there
in terms of firebase and firestore so we
can cut to the demo now guys
hey Clark will I see you down at the pub
ah hey Clark
we like seeing you down at the pub of
course I wouldn't miss it tell Roman
he's losing at Bar trivia tonight
so that's whipper so I'm Dave and I'm
Wilbur's chief product officer I'm here
to talk about our execution strategy and
how we found firebase and then cloud
firestore I'm building a tech company
from the ground up is always a daunting
task you need a vision a team and the
right tools
Clark provided the vision we started the
team together and now we found the right
tools which is a cloud fire store from
firebase how we got there was when
Romans our CTO arrived at whipper he
immediately started talking to me about
firebase he had worked with firebase at
a previous company and had had a
fantastic experience with it so to that
end he started evangelizing and because
I've been in tech for a while we talked
it over we talked plusses and minuses
and I jumped right in so we went with
firebase and and here's the thing
we loved firebase at that point we
totally loved firebase but the big
challenge that we had were there are a
couple of features that we wanted a
request in terms of enhancements so we
went back and forth and we put together
our hands meant requests and then we
were ready to send them over and just
see if our friends at Google could help
us out with these at all and then lo and
behold here comes cloud fire store we
were invited to the Alpha of cloud fire
store and it solved all of our problems
and we were totally thrilled about that
so to tell you a little bit more about
the implementation
Romans we'll go through that for us and
I'll introduce Romans Berman's our chief
technology officer exam hi guys so
stories I'm one of you
quicken running out of time though when
I first came to whipper they've just
stayed out for me to challenge and asked
me to kind of help him solve it and I
just was at the gig were four engineers
we moved the platform written in Java
what actually was a pretty massive
prescription management platform written
in Java and my sequel we using spring
and hibernate
we just went to firebase and it was an
amazing journey at that time cloud
functions didn't exist so we needed a
bit of node.js and GCP to make a few
things happen but then when firestore
was released and that's was this time
when I was at whipper straightaway it
solved all our problems that we had with
the real-time database basically around
mostly around data structuring and
querying and with additional cloud
functions we could totally go server
less and they told you and it was
amazing so thanks firebase Thanks thanks
for all the great tools thank you guys
so much for sharing that story with us
it's so inspiring after working so long
on a product to see to hear stories from
the field and next for a very different
type of app I want to invite Emily on
the stage from home away to talk about
how they increased user engagement with
with this new technology
all right hi everyone my name is Emery
Cox and I'm an Android lead at homeboy
an expedia brand company and today I
want to talk about local an experiment
we built using cloud firestorm and
firebase homeboy is a vacation rental
marketplace and as you might imagine
some of the challenges we face are
unique to the travel industry but we
also face the same problem as businesses
everywhere how do we increase user
engagement thankfully on this point our
users were kind enough to give us some
direction travelers want local know-how
wherever they go one thing I love about
the vacation rental industry is the
community it's a really warm group of
people and they happen to have exactly
what our travelers want local expertise
so we set out to create an experience
bringing travelers in the community
together to share local insights from
the outset we face the same problems
plaguing any new product how does it
work how do we build it what tools will
we use in fact for this project a
primary challenge was simply resourcing
with effectively one person working on
the project at any given point in time
fortunately for us even at a big company
sometimes the most important thing is
just getting a small team together and
letting them run so with limited
resources we face the technology choice
do we use the standard HomeAway tooling
or do we try something different with
the standard tooling we'd probably end
up with an architecture that looks
something like a client app serving to
user experiences with one server one
database and a handful of integrations
this architecture is manageable in
theory for a team of one but we wondered
if there might be an accelerator we
could leverage enter cloud fire storm
cloud fire store bills itself as a
real-time database for mobile
development we didn't have first-hand
experience with serverless architectures
at the time but we are enticed to test
it out based on the promises the prod
deferred immediately firestore replaced
our traditional server database
architecture with an SDK allowing us to
focus singularly on the client as a no
sequel database it offered a flexible
solution for the data requirements of
our app and was optimized for our
preferred access patterns for writing
real-time and offline behaviors for free
well this advice for our crud operations
like many apps we also needed some
asynchronous behaviors here again
firestar offers a solution
out-of-the-box
rounding out the missing pieces of our
behavior with first-class eventing
support in app and simple integration
with cloud functions for ad-hoc service
actions we then used the remaining
firebase tools to flesh out the backbone
of our application allowing us to
isolate local from the larger HomeAway
platform while at the same time enabling
key integrations for an on platform
experience so putting it all together we
ended up with an Android application
where if my demo runs oops
alright putting it all together we ended
up with an Android application where
travelers asked for recommendations
travelers Explorer and locals locals
will recommend alright everyone so
summing it all up for Homewood Cloud
firestore and firebase really proved an
accelerator for our experimental mobile
development driving local from idea to
reality and empowering our small team
success thanks for the time
Thank You Emery sorry about the glitch
for the demo a big thank you to the
whipper and HomeAway teams for coming
here today and sharing their experience
that was it was really great thank you
all for coming I hope you enjoyed this
talk and I hope we got you as excited
about cloud firestore as we are thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>