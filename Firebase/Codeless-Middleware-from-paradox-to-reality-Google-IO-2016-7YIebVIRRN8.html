<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Codeless Middleware: from paradox to reality - Google I/O 2016 | Coder Coacher - Coaching Coders</title><meta content="Codeless Middleware: from paradox to reality - Google I/O 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Firebase/">Firebase</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Codeless Middleware: from paradox to reality - Google I/O 2016</b></h2><h5 class="post__date">2016-05-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7YIebVIRRN8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey good morning everybody and thanks
for joining us this morning on this
lovely day everybody having a good I oh
good so I'm Laurence Moroney I'm a
developer advocate at Google and i'm
joined by Ankur Kotwal who's also a DA
you know we work in just promoting all
of our API is promoting all of our
technologies and helping Google to
understand what you guys need to do and
helping us to understand you know hold
sorry helping you to understand that our
own technologies today we want to talk
about cole dless middleware and in the
context of building a full real app we
didn't want to just think in terms of
demo where we wanted to think of what if
we were building a full real app but we
wanted the server-side code and this apt
to be optional if we wanted to move away
from thinking about building server-side
code toward codeless middleware and we
wanted to make this a little bit more
complex we're saying instead of just a
simple crud type thing we're going to
integrate some third-party data and
logic into this just to make it feel
like a little bit more realistic a
scenario so we'll start with the first
part of this and it's building a full
relapse Oh Ankara and I got together and
we were thinking about the type of app
that would like to build and we're both
really really passionate about the Geo
api's we're passionate about maps we're
passionate about places and when we
started thinking about places we were
like you know in the world there are
some very historic places there are very
exciting places there are really really
famous places and there's there's a tree
anchor you don't know this tree I don't
know this tree is industry nobody knows
is tree Lawrence this tree is really
special to me because on December 35th
31st 2005 i SAT under this tree and I
watched the Sydney New Year's Eve
fireworks you can see the Sydney Tower
there and the Sydney Harbour Bridge and
the reason that it was that particular
New Year's Eve is special to me is
because I was surrounded by my family
and friends my loved ones so it has a
near and dear place in my heart and so
it's a perfect target for building an
app we're building the type of app that
we're going to build so we've creatively
called it place notes and the idea is
that we're going to be able to store
notes of places that we visit we could
even place notes about places are boom
boom I told you they would not laugh
so we can store notes at different
places and these could be about places
that are well-known like the ones Lauryn
shirt or ones that are really personal
to us and so then when we thought about
well how do we build this type of app we
put together an architecture diagram and
you can see that the phones on the left
hand side we said well we definitely
want to support Android and iOS that's
where all that users are going to be
we're going to be talking to an API
endpoint that we build that API endpoint
will work with our services and we're
going to store some data in a database
and of course because we're going to be
dealing with some of these more popular
places we want to use the Google Maps
places API to do it but as we started to
build this out we just SAT there and
going this is really complicated there's
a lot of work here right building an API
endpoint of service of database you have
to choose one infrastructure you're on
you have to then build it out you have
to integrate it you have to maintain its
and then yeah you want to make sure the
latest security patches on there and of
course we're expecting to this app to go
like super violent viral wouldn't you
use it yeah yeah see told me that we
want it to be scalable and again it just
felt like we were putting pieces of a
puzzle together so that's when we
thought about using firebase now
firebase is a set of tools that we
announced yesterday that help you
develop your app ehrin grow an audience
and earn some money as well and firebase
actually encompasses a number of
products but today we're only going to
focus on one of them and that's the real
time data base because the real-time
database with firebase allows us to
store in sync our data and so the way it
would work is that on our phones we
would take a note that note would get
sent off to the server synchronized
automatically the servo would then
replicate that piece of data to all the
other devices that need it and this is
all happening for you automatically and
it uses this really interesting event
driven programming model to be able to
synchronize these things so you can work
asynchronously and of course this thing
helps us address
those things that we said were hard the
maintenance the management the
scalability and so when we look at our
infrastructure diagram now you might
think okay so we're going to substitute
the database with firebase but actually
we're able to get rid of three
components and replace all three of
those with firebase firebase is going to
do that much for us and what we're going
to change with the places API is that
will consume those api's client side so
we're literally moving to making our
server side code optional and for our
use case we're actually getting rid of
server-side code altogether we're going
to write only android and iOS code
lawrence places API capi one of my
favorite API is that there isn't and one
thing that I do have to point out when I
was writing the code for this when I was
writing it for a database it wouldn't
actually compile because the compiler
didn't recognize data so I wrote it for
a database instead so anyway I'm they
didn't laugh about that so and so on to
the places API so if you're not familiar
with the places API I got great news for
you because this thing is just awesome
the idea is that Google have data about
all many different places in the world
over 100 million different places and
tons and tons and tons of metadata
associated with these places so for
example restaurants there might be links
to the menus there might be photographs
there might be my other favorite
technology street view inside views of
these things and these are also
categorized for you in a wide range of
categories so you know you have
everything from A to Z from accountants
to zoos actually stored in there so when
we come to thinking about place notes
and you know us wanting to place notes
in locations you know this turned out to
be a wonderful thing but not only that
it's when you come to determining the
place that you're in it's more than just
the latitude or longitude there's lots
of other signals that can determine a
place that you're in like so for example
I really really like coffee and you may
have seen my coffee with a Googler show
on YouTube and I'm a big coffee fan I
drink way too much of it but if I'm like
in a particular location and it's three
o'clock in the morning most coffee shops
are going to be closed so if I'm
actually saying hey what are the places
around me in at this location it's going
to be a low likelihood coming back that
I'm in a coffee shop right now so as I
scan for low
patient's using the places API it
determines a probability of the
locations that I'm in and returns that
probability to me but that probability
can be dynamic based on so many
different contexts so it's a really
really useful API to help you understand
your place in this world there's another
session it was this morning but it'll be
on YouTube called understand your place
in this world the thoroughly recommends
go take a look at it it's great coverage
of the places API so we said okay how is
the places API going to work in code so
this is some Android code that i'm going
to show now just to show how simple it
is so the first line of code here is i'm
using a Google API client we've ever
done any development for Google Play
services this guy will be familiar to
you right away if not don't worry about
a he's your friend he helps you
interface between your application and a
variety of different Google services and
in this case I'm going to use the place
detection API call a method on that
called get current place pass the Google
API client to it and then I'm going to
get a call back and in the callback I
get a non results which contains a place
likelihood buffer which is a list of the
places that I might be in right now
based on the likelihood of those places
so like I said if I'm at three o'clock
in the morning standing outside a coffee
shop it's going to give me less likely
than I'm actually inside that coffee
shop but if i'm there at nine o'clock in
the morning during the coffee rush it's
going to be more likely that i'm inside
that coffee shop so the idea is it's
going to return this list to us of
places around us ordered in likelihood
based on all of this intelligence and
then you know once i have that list of
likely places i can say hey i could draw
my UI and in my UI and can start listing
ok these are the kind of places where
the app thinks you're at right now do
you want to make a note about one of
these and this is just going to be a
simple loop right I'm going to go
through my likely places I'm going to
create a place likelihood object out of
that and then I could start calling
methods on that but the two ones the two
properties that i want to show here are
the name and the ID because if you
remember we want to store notes ourself
using our application into our firebase
so this isn't stuff that's available in
the places API so I'm going to get the
place ID out of the places API I'm going
to get the friendly name of that place
so instead of a long string just
describing the idea
going to get a friendly name like
shoreline amphitheater out of that and
then this place type object that you see
in the second last line of code that's
just a plain old java object that i made
myself that's going to define a place
it'll have an ID associated with the
place it'll have the name of the place
and will have whatever note that the
user has created in v1 of the
application we just did a straight text
no but that could easily be expanded for
pictures or for other things now places
actually we're only using the ID and the
name here but it's really important to
know that the places API is returning a
ton of data about us any given place you
can get things not like Lawrence
mentioned opening hours but you can get
ratings you can get photos you can get
addresses and so there is a really rich
database but to simplify our example
today we're only using the name and the
place ID and the important thing about
that place ID is that it's unique and
it's stable so all all you have to do is
when you fetch a place you only need to
locally cash the ID so next time you
want to get that place back you can just
get it from that ID and you know it will
be there and so that's why we designed
this entity to keep it as simple as
possible that we're storing in firebase
we're just going to store the place ID
and a note as simple as that the
simplest possible entity we could have
so a so for example shoreline
amphitheater where we're at now if we
were to create a note for that you know
all we be storing is the ID for
shoreline amphitheater and then whatever
note the user had actually typed in very
very simple entity but let's see what
that looks like in firebase so here is
what it like this is on the firebase
console where I've stored this note and
you can see when I was preparing for
this last week I was near to different
restaurants and so you can see there's
two columns in this database or let's
talk about this in database terms
there's two rows in this database you
know the first row is for the first
restaurant the second row is for the
second restaurant and then also if we
think about it in columns this first
column the one on the left is the ID
that came out of the places ID the
column on the right is just a simple
note that I'd made associated with that
restaurant and I tried asking for a
discount they wouldn't give it to me so
I'm not putting them
here the ID here is also in database
terms also our primary key correct you
can look it up by that ID that first
field so now when it comes to storing
that simple entity for a well-known
place that came out of the places API in
the database you can see how simple the
code is for that this is it now think
about if you were building middleware if
you were building crud you'd have to be
building a sequel query you'd have to be
you know sanitizing the parameters on
that sequel query you'd have to be
pushing it have to be checking for
results all of these kind of things but
in firebase it's as simple as you know
we do a firebase database don't get
instance to get a reference to our
firebase database and then on that I'm
placing a child that first parameter
there the place ID is that long string
with the place ID from the places API
and then I'm setting a value on that to
be the note so for our simple entity
like that this is how easy it is for me
to actually store data in the database
who thinks that's pretty cool I want to
emphasize this a bit more that
infrastructure diagram we talked about
those there's three boxes we have two
lines of code that that give you the
right operation that's it and does you
know replaces those three boxes so those
those challenges that we talked about
about like building these components out
and integrating them we have two lines
of Java code that replaces and today
we're sharing Java code so we're
building an Android app but on iOS is
quite equivalent as well yeah when you
work with the API yeah it's it's pretty
straightforward as well so now we say
okay so those are places that come out
of like the places API well known places
like the pyramids or the Las Vegas Strip
or the Statue of Liberty but what about
anchors tree okay I'm Chris tree isn't
in the places API at least not yet and
so we say well what if somebody has a
very personal location like that like
anchors tree that they want to be able
to store in a database like this one so
we need a slightly more advanced entity
for that will have a place ID it's not
going to be the same as the ID coming
from the places API because this entity
doesn't exist there will have a note and
then we'll say okay well just put a
latitude and longitude on that so that
you know we can store it but then we
have a problem when it comes to
retrieving it when it comes to we say ok
when we're running our application when
the person opens it
they want to see a list of places near
them and that would also include maybe
you know Ankara made his note like on
New Year's Eve and then he sounds like
we're taking off and maybe we are maybe
he would go back a year later or
something like that and he wants to be
able to retrieve that know which means
somehow the app is going to have to
query all these notes in firebase for a
latitude and longitude and say within a
mile or 1.6 kilometers am i right that's
correct getting better with my metric
and so if we say within a mile of 1.6
kilometers of your current location and
get the notes for that and like render
the the the ids are the names of those
places so how would we do that and this
is part of the other magic of firebase
and firebase as you know was a product
before you know the new stuff that we
came out with yesterday and one of the
things before I do that no spoilers I'll
say this is what the entity will look
like so here it's a case of when I was
testing this last week I was testing it
in my home office and here i put like i
called my home office i gave it the ID
custom kool on my office i put a note on
that that says this is where I work and
then there's like if you can see right
at the bottom of the slide there's two
numbers like zero prefix than one prefix
can anybody guess what those numbers are
lats and Long's I kind of spoiled it in
the previous slide didn't they but never
mind so you know those are latitudes and
longitudes so now if you can imagine a
database like this with thousands of
entries and you know some of those
latitudes and longitudes are within a
mile or 1.6 kilometers or whatever
distance I want from where I am now how
am I going to query that efficiently to
be able to find the ones that are within
that range from me and part of the magic
of firebase is its extensibility and
there's a tool of libraries called geo
fire has anybody heard of geo fire are
used it okay you most of you are in for
a treat if you ever want to build any
geo based applications using geo fire if
this makes it amazingly easy for you all
you got to do is give it a lot of tube
the longitude and it will match any
records in the database that have been
stored with geo fire and give them back
to you it's as simple as that and here's
the code for it so if you remember the
single line of code that we had earlier
on where we're saying you know for a
well-known place not one of our custom
places we set the place
we added note to that and we're done so
now if it's geo fire for one of our
custom places all we have to do is on
geo fire itself called a set location
method we passed that a place ID and
then we passed that a geolocation object
that we've initialized with our latitude
and longitude that's going to give us an
override that's going to give us a nun
complete call back and if we override
that then all we have to do and that is
do pretty much the same code you know
there's going to be a place ID on that
it already had children you remember
with the zero and one for latitude and
longitude so that's where the code is
slightly different here I'd create a
child called note and set a value on
that and this is my entire code for
storing data in a database for my
application both custom put custom
locations that I've created and stuff
that came out of the places API it's
pretty cool right I'm worried it's going
to put me out of a job so putting this
all together then and putting our
application together and anchor can you
explain how the whole thing works and
how about swim lanes and all that work
let's take a look at a broader look on
at all of this so is our app again when
we want to what we're going to do is
actually show two activities to the user
the first activity is going to be a list
of places around them as well as any
custom notice that they've written on
their current location and those custom
nodes will use a 1.6 kilometer radius or
one mile as they say here and the way
we're going to get those first set of
lists of the places around us is using
the places API so what we're going to do
from our app is say to the places API
get current place we saw that code
earlier it's going to give us a list of
that that place likelihood buffer of all
the likely places but we also want to
get that second batch of notes notes
that the user may have already created
those custom loads so we're going to
just query the firebase database
directly using geo fire we're going to
say give me notes around my current
position and it's going to return any
custom places so with that then what
we'll do
is when the user selects a note from
that list for that index we're going to
go to the details view so we'll look up
that ID into the real-time database
fetch it back and we have our note it's
really really simple right just a list
view to start with without index and
then a details view and these are the
flows that's how simple it is so
Lawrence why don't we look through a
demo sure let's see I believe it's this
one listen okay perfect everybody see it
so this is real code on a real demo on
the Wi-Fi for the conference so forgive
me if things fail but I'll do my best so
I sat in this room just before the
session began and I ran the application
and it gave me this list of places so
the top one two three four five six
seven of them down to Virgo stage
actually came out of the places API I'm
really surprised that Virgo stage was
added to the places API so that's pretty
cool somebody must have added it last
night so those now I've made that call
to the places API it's taken a look at
the location of my phone it's using
things like it's as well as my latitude
and longitude it's using beacons ah
that's where I got vertigo stage right
because we've got a beacon in here and
it's using beacons it's using anything
that's around me to determine my actual
location and it gave me this list and
then at the bottom of the list there's a
custom tag so if I touch that one now it
just throws up a dialog saying do you
want to name this place so I'm going to
touch that I'm going to say what's this
place called I'll say it's the lectern
that I'm at this is the part with the
devil but my typing's terrible sorry
left turn ok so now I'm creating a note
for where I'm at at the lectern ok and
I'll say these red I don't know if you
guys can see the red dots but those red
dots all over my hands and it makes it
look like a sniper's aiming at me are
scary they didn't laugh or that one
either anchor though I think we could
have the jerks Lawrence yeah so now like
I go and I refresh it and we should see
and we see the lectern has been added
there so now I've actually created a
note for the lectern I've saved it it's
been saved in firebase and I'm good to
go really easy right so let me go back
and save that and now for
to say earlier on when I was sitting in
the room right outside there's that code
the road bus so I created an entity
called geo bus and I go in to see it go
visit the Geo bus it's awesome you know
and I strongly recommend that you guys
do that so those are for custom ones but
what if I wanted to do it for you know
shoreline amphitheater ok so now that's
the first entity that I was talking
about all that I have to do is get a
place ID from the places API so you see
the long string there beginning with ch
and that's the entity game back from the
places API I type in hello room or I
type in something else and I save it and
I now have that note in firebase for
this for this location for shoreline
amphitheater so say we come back here
next year for google i/o I'll be able to
run the app and start seeing the notes
that i made this year and all kinds of
good stuff like that all kinds of fun
stuff like that so that's a quick look
at the app and I just wanted to show you
guys that it's a real thing thank you so
today we've covered how you can take
what could be a complex piece of
infrastructure for building a mobile app
to something that's actually quite
trivial something that we wrote entirely
in client code and we've showed how the
real the firebase real-time database has
substituted so many of those components
you know so you can learn more about
firebase at five google com and there
are many many more products in firebase
I highly recommend you check out the
rest of the message and I think the more
products and firebase is an important
part because once you've started like
you've linked in the firebase libraries
to build this kind of thing now look at
all the extra goodies that you'll be
able to do as well so far base off for
example will allow you to provide sign
in to this application so if you wanted
to sign in and provide a customized
sign-in experience which i haven't done
here or app indexing has anybody heard
of app indexing so app indexing is
really really cool technology where by
your app can be put into the Google
index so if people are searching for
content that's available in your app
they can be led to install your app and
use your app so there's a whole ton of
extra technologies up forgot analytics
all right you know everybody you know I
love analytics and analytics or a great
great way for you to determine who's you
what's working what's not working and
then the other one that I used primarily
when I was building this one
unfortunately was a crash reporting
because I had a lot of crashes as I was
building it and the built-in crash
reporting in firebase really helped me
to analyze that and find that so you
know firebase goes just beyond the
storage of the data as we've done here
but if you do this codeless middleware
if you make the data storage and data
retrieval as easily as it's been done in
here then all those extra goodies are
available to you we also use the places
API today and the reason that that's
important is because people don't think
of their location by the latitude and
longitude we also don't think of most
locations by a dress like we may have
typed in the address at some point to
get to IO today the shoreline
amphitheater but when you're thinking
about where you're at you're an IO or
you're at Shoreline Amphitheatre you're
not thinking of it by address and places
API helps us to identify place locations
by their place names so I have a
question for you Lawrence Oh what are
you doing for New Year's Eve this year
maybe I'll be sitting under a tree and
so yeah would you like to come check out
my tree yeah I think so yeah okay go
that was my question to you I like to
turn it up now for any questions that
you may have please just queue up behind
the microphone and we'd be happy to
answer them</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>