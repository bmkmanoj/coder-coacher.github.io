<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build Better Games with Firebase (Firebase Dev Summit 2017) | Coder Coacher - Coaching Coders</title><meta content="Build Better Games with Firebase (Firebase Dev Summit 2017) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Firebase/">Firebase</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build Better Games with Firebase (Firebase Dev Summit 2017)</b></h2><h5 class="post__date">2017-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BS2yy1KnzcI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you are in a maze of twisty little
passages all different you are on the
edge of panic that ogre standing over
you is your unforgiving boss how can you
possibly implement all those game
features you promised him launch is in
three weeks a truly horrible death seems
imminent captain fire base and is more
capable long-suffering sidekick coding
Doug
to the rescue alright hello everyone I'm
sorry that was Justin Charlie too silly
and well oh yeah me da Amsterdam Oh
welcome good afternoon Amsterdam I'm
actually Justin the Angele for the
firebase test lab team and I'm Doug
Stephenson developer advocate with the
firebase team and thousands of
developers have found the firebase
platform helpful to build their apps so
far at the time the firebase platform
was launched in 2016
focus was only on iOS Android and web
apps with Critch client libraries made
available for all three platforms to
make use of firebase cloud services
however for developers building mobile
games the native SDKs haven't been very
helpful because games are commonly
written or built with unity or C++ unity
provides a whole different IDE and
runtime for developing cross-platform
games developers who are using are
probably coding in C sharp which does
not really enjoy native support on iOS
and Android
so the firebase team believes that
firebase should be helpful for game
developers so they built additional SDKs
for unity and also for C++ so this means
game developers can now build out their
games using some of the best parts of
firebase so if you're a game developer I
imagine you probably want to spend your
time building worlds creating snazzy
special effects perfecting smooth
animations and generally making your
game
to play I'm also gonna guess that you
probably don't want to spend your time
being bogged down building back-end
infrastructure to support your game and
that's where firebase can be helpful and
to illustrate this we'll consult our
friend meed hamster welcome hammy
well hammy is a space traveling hamster
encased in a metal ball a space to shape
shaped spaceship rolling around mazes in
outer space which is exactly what you'd
expect from a futuristic hamster hammy
is the star of mecha hamster an
open-source game built by the firebase
team to demonstrate how to add features
using firebase to a Unity game so let's
take a look at some of those features
now Doug I found that during game
development one of the biggest pains
that you have is having to rebuild and
retest and redeploy your game every time
you want to make some minor tweak to
some small game setting how can fly base
help with this
well firebase can help with this and you
can solve this problem pretty easily
with firebase remote config remote
config is a cloud service that lets you
change the behavior and appearance of
your app without requiring players to
download your game and install updates
instead you code your app to use remote
config parameters instead of hard-coding
constants then you can make a live
values or life changes to those values
in the firebase console after your game
is published so in your game you'll use
a dictionary to define default values
for all the named parameters that you
might want to change then you pass that
dictionary of defaults off to the remote
config API to check for updates to these
parameters that may have changed in the
console you kick off a fetch which
completes asynchronously so you can see
it returns a task that task represents
the eventual completion of the fetch
then when that task completes you can
activate the fetch values with another
remote config method or choose another
time to make them available now to get a
hold of values in remote config simply
ask for them by name so what we're gonna
do is take a look at this jump tile
velocity parameter in action so here in
mecha
we see a level that some users are
complaining is too difficult or
impossible to complete the junk tile
velocity parameter is set to five right
now so we probably want to bump that up
to make it a bit easier so what I can do
is go to the remote config console
change the parameter to eight and then
publish the new value then when I
realize the game it'll fetch and apply
the new value so here's what it looks
like now and hami is able to clear the
barriers more easily so the game now
appears to be pretty well calibrated at
this point for the jump tile but it's
important to note if you're gonna be
making changes like this you should use
a project that's used solely for
development because if you're
experimenting on your actual players in
production and you publish a value like
twenty here it could be very distracting
and disconcerting for your users
poor hammy yes sorry for that horrible
hamster impersonation I found Doug you
know that getting my players logged into
my game identified in my game it's just
a royal pain authentication is really
hard just hard to get right how does
firebase help well firebase provides
firebase authentication which provides
back-end services to let you
authenticate the players in your game
and this is important because your
players might be using multiple devices
so you want to be able to do things like
save game state or achievements between
them so your players can switch devices
easily without losing any of their
progress so mecha hamster makes use of
both anonymous and password based login
as you can see here but firebase
authentication also supports phone
number at that occasion Google Facebook
Twitter github and your own
authentication system if you choose to
integrate it now for games I think
anonymous login is really important
because it reduces the friction of
getting players into your game and start
saving their progress so they don't get
held up on things like a login screen or
being forced to reveal their identity
before they trust you you can always
upgrade an anonymous account to a fully
identified account whenever they're
ready so once I've got my players logged
into my game now I want to store all the
user content all that custom content for
them how do I do
with that you can use real-time database
so real-time database is a no sequel
datastore whose defining characteristic
is its ability to notify clients of
updates to data in the database that
changed in real-time the way that
clients interact with the database is
through listeners so if you're
interested in data in a particular
location in the database you add a
listener there then that listener will
be called with the initial value of the
contents of that location followed by
any updates then you remove the listener
when you're done with the Unity SDK you
just create a firebase app object use
that to get a hold of a firebase
database object from there you can
generate database reference objects and
these are like pointers to the pass of
the data that you're interested in so
once you have a reference you can attach
listeners to it in to be more specific
in the case of the Unity SDK it's using
a c-sharp event handler which has
special syntax for adding and removing
handlers that plus equals operator right
there is adding adding a handler to the
list of handlers managed by the database
reference so this is not what the
equivalent Android or iOS code looks
like at all
the team decided it's very important to
make c-sharp programmers feel like
they're at home by taking advantage of
its best language features so you'll see
this sort of thing throughout the
firebase api's on c-sharp
now here the c-sharp event handler is
just a method that takes an argument
that describes the data that's being
changed we can reach into that get a
data snapshot object and query it for
typed data or the raw JSON for you to
parse for yourself
so if you're looking through the source
code here this is what to look for
so that takes care of storing my data
but I'm creating new content all the
time and I want my players to learn
about that content as soon as is
impossible how do I let them know even
if they don't even have the game open
this is a job for firebase Cloud
messaging
so with FCM you can notify players when
new content is available in your game
now there's two ways to send a message
with FCM first from a back-end that you
control so you can write code to send
messages or you can use a convenient UI
in the firebase console
mekka hamster is coded to accept
messages composed at the console so it
also has two different kinds of messages
that you can send identified by custom
attributes on the message now
show you what that looks like all
notifications sent from the console will
appear on the device just like any other
device notification the text here in the
message textbox describes what that
looks like
MECs a hamster defines a special kind of
message that when you click on it will
show more detail in the game when the
player clicks the notification so for
this it accepts a custom data with the
name of the parameter is type in the
text net and text underscore message as
the value then for the text of the
message in the game you can do some
longer freeform text that you choose so
when this message is sent it'll look
something like this and this is what it
would look like on Android so we can see
the notification there then when the
notification is clicked it'll launch the
game and send the player directly to the
screen in the game that shows the extra
information so here we just have a
promotion for a daily challenge so the
second type of message recognized by
mecha hamster is a notification about a
new bonus level so if I'm the mecha
hamster developer and I want to author a
new level to publish immediately without
requiring an app update I can just build
it save it as a bonus map then send a
notification to my players that sends
them directly to that level in the game
so the custom message here is bonus
underscore map and it takes a map ID
that the ID that you created in the game
and some sort of descriptive text for
that map so firebase Cloud messaging
messaging is great
for helping me stay in touch with my
players but I want to give my players a
more social experience one in which they
can exchange messages or exchange
content yes so you can do that with
firebase invites so with firebase
invites it makes it really easy for you
to share your game and its content sorry
allow your users to share the game and
its content with each other that goes
over email or SMS so invitations are
highly customizable and in this bit of
code what it's doing exactly that so
setting text to be used at various
places during the invites we have title
text message text call-to-action and so
on you'll notice it's also using remote
config to grab the values of those
strings for insertions so you can
customize you can change your invitation
text simply by doing a room sorry remote
config update
you can also attach some data to the
invitation when you configure it so when
mecha hamster shares a map attaches the
unique ID of the map to the to the level
and so when the invitation is received
by the other player when they click on
it it will show that custom level right
away and it's worth noting that
firebases invites is built on top of
firebase dynamic links which is a more
generalized tool for sending players
directly to content within your game in
Mecca hamster when a player builds a
custom level they'll do it like this and
then they can share it with others in
their address book so there's a share
function and what what happens here is
firebase invites provides the UI to make
this happen so you don't have to build
any of this this is provided for you all
you have to do is invoke the invites API
with the unique ID of the thing you want
to share and then the player can choose
the recipients then the other player
receive the invitation via a dynamic
link and you'll have to write a little
code to handle that link as well so I
have one more question well this is
great for adding new features to my game
but I want to understand how my players
are playing my game so which parts of my
game are they having trouble with and
conversely which ones are they really
engaging with now these things would be
pretty important to know if your game
developer and with Google Analytics for
firebase you can definitely track what
your users are doing and populate a
dashboard in the firebase console that
gives you insights into the demographics
of your players and also their
engagement with your game so firebase
will track a bunch of events in your
game without having to write a single
line of code just put it in there and it
starts collecting data immediately but
you can get deeper insights by defining
custom events when they occur so in this
example you'll see that in Mecca hamster
there's a bunch of events so when a map
is started when a map is created when a
map is shared and so forth but with
these we can see a lot more about how
players are actually engaging with the
game this is especially useful if your
game has some sort of in-app purchase
because now you can track and figure out
which players in your game are the big
spenders and the ones that play your
game the most those are the ones you
really want to find out about and
there's a lot to see in the analytics
dashboard I don't really have time to go
over that right now but you can get
read-only access to a demo project
called flood it and that's available for
Android and iOS so you can actually
download and play that game you can get
to the
demo project by going to consult on
firebase Google comm and clicking on the
explore a demo project that's below the
add project button that will send you
directly into what the console looks
like if you were the you know flooded
developer so inside you'll see much of
the analytics being captured by the game
and summarized in the console so again
you don't write any code you don't do
any configuration this just starts
appearing for your app when you publish
it if you're in the analytics and when
you go to the demo project be sure to
try out stream view which gives you an a
real-time anonymized look at the players
in the events they generate in the game
so this would actually be animated a
little bit so you'd see spots of people
playing and then if you click down here
at a user snapshot you'll get a random
users stream of events you can see in
real time how players are actually
playing your game went too far but none
of these features matter so all of these
firebase products are great but none of
it matters if my game crashes all the
time so Justin I need to know how can I
discover these issues in my game well
Doug that would involve some actual
testing so for a high quality game you
must do extensive testing on a wide
variety of different devices more about
the latter part later but testing games
is hard with regular applications you
can write instrumentation tests or you
can use our Robo crawler but games don't
generally lend themselves to being
tested automatically at least not yet up
until now most game testing was manual
but earlier on this year we announced at
i/o support in firebase test lab for
game loops so what is a game loop well
at its simplest a game loop is a part of
your game that simulates a user
interacting with your game you can see
an example of a game loop for mecha
hamster up there on the right with game
loops you can automatically test for
crashes or performance issues before
they reach your players so this sounds
pretty useful for testing my game
but I need to know how do i code up one
of these game tests alright so now we're
gonna switch to Luke and it was gonna
trip over that one ok so I'm back here
alright so it's actually pretty easy to
add a game loop to a game all you really
need to do at least one way you can do
this is to record all the user events
for all the game objects and write it to
a file and then replay that file that is
exactly what we do for make a hamster so
if we look at the code for mega hamster
here we can see and it might be a little
hard to see but we can see here that we
have a flag record gameplay that if that
flag is set to true we use a class
called game play recorder to write or
basically tee the events the user events
out into a file here is the class that
does exactly that and then we can grab
that file and here add it as an asset of
the game here it's stored under assets
hamster of course resources replays now
make a hamster this is why actually what
the file looks like here it's basically
a JSON file with a list of events now
make a hamster has a list of levels and
then for simplicity each level here the
spot of the resources for the game each
level has one and only one game loop and
then when Android starts up our game
it will pass what is known as an intent
to the game we can use that intent to
trigger a game loop or to register the
fact that we want to trigger a game loop
and that's exactly what we do here so
here we are testing the intent to see if
it has a scenario number if it does we
store it in this variable scenario
number and then later on we can test for
whether or not we have a scenario number
whether or not we want to run a game
loop which is
exactly what we do here and then we load
that resource file and interpret the
events in that file and run the game
loop so if I have one of these game
loops coded up how do I actually run
them well me Wisla actually running a
game loop is pretty easy you can trigger
test loops locally by simply using a an
application called the game loop manager
now the game loop manager is an
application that runs on the device and
it looks through the device for all the
applications that have game loops
associated with them this one has just
Mecca hamster so I'm going to actually
run the game loop in number four here
and what its gonna do is it's going to
load the game and it's going to trigger
this and then of course you guys can't
see that but we actually have a crash on
the way fires the crash on that device
alright so what we'd like to do is we'd
like to fix that crash the trouble is
with test loop manager we don't have any
detailed information about that so what
we're gonna do here is we're gonna run
that same test inside a firebase test
lab so to save time I ran this test
earlier for the same apk and here is the
crash we can see that if we open up this
crash in firebase test lab and as we can
see we have an exception and in fact if
we go look in the logs here and I'm just
going to quickly go search through the
logs for a string that I know about what
we see here is that we seem to have a
problem in player control a fixed update
so let's go look at the code so over
here back in the code here here's player
controller
here's fixed update and yes there is the
rather contrived exception in fact there
are actually two exceptions here there's
a fatal exception and
non-fatal exception we'll talk more
about that a little bit later so now
what I'm gonna do is I'm going to fix
this
fixing meaning just comment out the
exceptions and then I'm gonna save this
and I'm gonna go back to my unity SDK
and I'm just gonna build it my webs are
always this easy to fix
yeah so that I build this and of course
that's gonna take a little while so we
go back and this is the apk that I built
without those two lines in it earlier
and as we can see no longer did it crash
okay and that one worked all right but
you don't only find crashes when you run
game loops you can also find performance
issues so let's quickly look at the
performance tab here and what we see
here are a bunch of different
performance metrics CPU frames per
second memory and network tied
synchronized with the video so that you
can get some level of context about what
is happening in your game as the CPU
Mayor memory and network progress just
isn't a quick example here let's pick
this spike network spike and take a look
at what's happening in the video there
at that point
well it's loading and sort of what you'd
expect in terms of a large network spike
so now I'm going to test my game across
a wide variety of different devices and
I can do this that with firebase with
firebase test lab for Android so all I
need to do here is to go to the test lab
tab here within five ace and then run a
test I choose to run a game loop here
and then I can load my latest apk for
mega hamster and then I get to choose
what scenarios to run here so I'm gonna
choose the same scenario scenario number
four here and then I'm going to click
continue and here are all the devices
that I can pick from
I have many devices here many different
API levels I can just granda me click
here I even have a note 2 somewhere here
we have special fire protection and our
data centers and I have physical devices
and I have virtual devices you'll see
also that we have API level 26 on
virtual devices here in general we have
the latest API levels especially on
virtual devices so will will soon have
API level 27 which is om r1 as soon as
it becomes available
so then having picked all of these
different devices I click continue and
then I can release my game into the
world whoa whoa whoa whoa before you
release well at least before I release
the game I always fear that I've made
mistakes that somehow slip through the
cracks like no matter how much I've
tested my game it seems like there's
always some sort of bug that crashes on
my players in production and I need to
find a way what those are so I can fix
them quickly because if I don't they'll
just uninstall and then hate my game
well Francis mentioned this morning in
the keynote fabric became part of Google
earlier on this year and fabric makes
crashlytics and crashlytics has support
for unity games so all we need to do is
to add support for crashlytics to our
game we do this by downloading the
crashlytics sdk for unity and we do that
by going to the link that's shown at the
end we then follow the instructions that
involve importing the crashlytics sdk as
a custom package and then dragging the
crashlytics game object into our game
and Doug it's really that simple yes we
did rehearse this at
so what we've seen today so far is that
firebase provides rich client SDKs and
back-end services to help build out your
game the back-end services will scale up
to meet the demand of your game in scale
back down to zero if necessary and we've
also seen that adding game loops to your
game can really help in terms of caching
issues before they get into your players
hands
in addition adding support for
crashlytics to your game will help you
find those crashes that have somehow
slipped through and if we advance the
slide yeah we right so we have a bunch
of resources for you to get started
learning how to use firebase for games
we have blogs and videos we have
documentation for the game loops we have
a link to crash flicks for unity and
there's a firebase slack which is a
community full of people who love
firebase so please take a moment take a
picture of this if you want and we will
be in the ask firebase lounge
immediately after this if you have any
questions all right thank you everybody
we'll see you in the lounge and at the
office apology
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>