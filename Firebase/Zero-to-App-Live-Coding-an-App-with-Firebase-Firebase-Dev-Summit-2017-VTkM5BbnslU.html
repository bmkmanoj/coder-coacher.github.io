<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Zero to App: Live Coding an App with Firebase (Firebase Dev Summit 2017) | Coder Coacher - Coaching Coders</title><meta content="Zero to App: Live Coding an App with Firebase (Firebase Dev Summit 2017) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Firebase/">Firebase</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Zero to App: Live Coding an App with Firebase (Firebase Dev Summit 2017)</b></h2><h5 class="post__date">2017-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VTkM5BbnslU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Mike McDonald I'm a product
manager on firebase and I'm here with
Jen and Abe and we're gonna build a
really really exciting application so
I'm gonna start off with the premise of
this application and that is language is
hard so how many people actually
everyone put your hand up we're gonna
start with this how many people and keep
your hand up if you speak one language
excellent everyone speaks one language
keep your hands up if you speak two
languages so my hand immediately goes
down okay three languages
okay spoken languages so if you speak in
JavaScript we can we can talk about that
later for languages is that okay
and five languages there will be one
winner
okay your you are remember her what's
your name
pavía you will be our contestant on The
Price is Right when we do this okay
moving on language though that's
something that I really struggle with
right so I travel a lot for work I've
been to nine countries and as I said I
speak English that's really really
difficult to get around right I am
constantly pointing at things on menus
or using Google Translate I would love
it if I spoke five languages or more
like you so technology and actually
science fiction has kind of dreamed of
this for years so how many people have
read Hitchhiker's Guide to the galaxy a
couple of people so there's the idea
there of a thing called a Babel Fish and
it's a device or a an animal I guess
that you can put in your ear and no
matter what language someone is speaking
you can automatically understand
whatever they're saying I would love it
if that technology exists and I've seen
a couple a couple samples of that right
so I watched a demo a couple years back
of a voice of voice translation software
where there was a bunch of kids in a
classroom in the United States speaking
to a bunch of kids somewhere in South
America and the kids in the US were
speaking English and literally just
seconds later the kids in South America
we're hearing Spanish and vice versa
that's awesome but that probably took
years and years to develop and I would
love it if you know maybe it was just a
device that I could you know put in my
ear or something which is great right
because like a week ago Google is like
hey that's a great problem I wish we
could solve that and if you guys have
seen the pixel buds one of the big
features of that their headphones you
put them in and you say hey I want to
learn Japanese and someone will speak in
Japanese and it'll automatically
translate it also awesome but we do not
have 30 minutes to build hardware
onstage we need to do something using a
piece of technology that everyone has
with them right now right let's build an
app because everyone loves apps its 2017
apps are a new hotness just like the
Babel Fish our app is going to let us
select the language that we want to hear
and everything at that point on will
happen in your selected language so
someone else you know maybe a
or one of our friends in the audience
will speak something and all of the
language will come in in that chosen
language so how do we build that right
if you hadn't come to this talk you
would go home and start immediately
spinning up servers right your mobile
application would make restful calls to
some you know application server it
could be a rails app or a django app or
an Express app and that's handling all
of the interesting things in your
application right that is doing your
authentication that is sending things
out to a database or retrieving things
from storage or even doing your machine
learning but that's really difficult
right we have 20 25 30 minutes to build
this application and if we wanted to do
this
who's gonna spin up our servers who is
gonna provision them and manage them and
secure them how are we oughta cating
people do we have the appropriate
performance that we need so that when we
all walk out of here and everyone loves
this application and you share it with
all your friends and we have a hundred
million monthly active users is that one
server gonna handle it right or are we
just gonna be paying an obscene amount
of money luckily you all came here and
you all hopefully at this point know a
little bit more about firebase so you'll
learn the secrets of how to use firebase
to solve those problems very quickly
firebase applications unlike the
traditional applications on the previous
slide eliminate that application server
and let your devices talk directly to
our powerful managed infrastructure
right we handle really difficult
problems like client-side authentication
so if you've ever written o off code I'm
assuming a few of you have written OAuth
code it's terrible you don't want to do
it with firebase you don't have to we've
kind of taken it up abstracted it and
given you a really clean interface to
just do the thing that your user cares
about and lastly firebase scales
automatically so when you walk out and
you all have my application you can all
share it with your friends and we go
from 0 to n overnight firebase and smart
clients handle all of those really
difficult pieces so you can focus on
building an app that your users love
okay so in case you weren't paying
attention during the keynote or somehow
stumbled into this conference and have
no idea what firebase is the brief slide
firebase again is Google Google's mobile
platform it helps you develop your apps
on top of Google cloud platform engage
with your user base and really
understand what they're doing it's a
one-stop shop
for mobile application development but
there are a lot of products on this
slide and we have very short time I'm
going to invite a Bop here to talk about
a few of these products and how they
help make our app more successful thanks
Mike I'll be honest that's a lot of
orange circles that's probably too many
for us to explain right now and probably
too many for you to dive in and really
understand in depth and that's okay
because you don't need to from the
beginning a core tenet of firebase was
that you would not have to use every
part of it
today if we're building an app that
needs some specific functionality we can
pick and choose out of the Sorella
features you don't have to pull in the
whole sdk you don't have to use every
feature and if you have some other
solution for part of this that you like
that you want to keep using you can do
that and use firebase for the rest of
your application today we're only going
to be using three features cloud storage
firebase authentication and cloud first
or cloud storage is important because
we're gonna be dealing with files we're
gonna be uploading audio from devices to
translate authentication is important
because we're gonna be doing that
securely we can't have people just
throwing files at our server and
willy-nilly writing over other people's
data and lastly cloud firestore is
important because we need real-time
synchronization as soon as our
translations are done we need everyone
to hear them as quickly as possible so
we'll hand that off the cloud firestore
let's dive in a little more detail
though cloud storage for firebase is an
amazing way to upload files it is
honestly amazing if you've ever dealt
with files as a concept if you're saying
I want a profile like picture for my
user and I want to upload that that
seems simple it seems trivial it's
trivial to describe but to implement
there are a million concerns what if
they don't upload a JPEG what if they
upload an mp3 how do I handle that how
do I know what they're uploading what if
they upload an 800 megabyte ISO instead
of an image can I stop that what if I
run out of storage space on my hard
drive what is my what is my persistent
story all of these things are concerns
and that's not even to mention things
like Network flakiness Network latency
and the scalability once you get the
file to your server this is literally an
issue that you could spend weeks messing
with but with firebase we make it simple
cloud storage lets you take a device
talk directly to our scalable
infrastructure and upload files securely
quickly and in a way that is extra
resilient you're not just making an HTTP
request and throwing a file out it will
do recovery and we'll make sure that the
file gets up there accurately in a safe
quick way once it's up there though the
second half of the story is of course
serving that file in cloud storage it'll
be sent down to as many devices as you
want if that's for devices that's great
if it's for thousand that's great too
you can just get a URL and you know
normal download URL you can embed it in
a page you can get a stream of bytes any
way you want to consume that file out of
cloud storage you'll be able to do and
of course if you want to restrict access
and say oh only this person can upload
documents to their own folder and only
them can read it that's all right
because we have firebase authentication
securing this whole thing for based
authentication is like Mike said a
wrapper around traditional a lot
acknowledges along with some extra
firebase magic so auth is a huge pain
and one of the reasons it's a huge pain
is because it's different every time it
might be a standard but there is nothing
standard about it every implementation
is just a little different so if you
wanted to live in a world where you had
Google for login
and you had Twitter login and github and
email password you would spend weeks
going through and figuring out how to
deal with the handshakes and the extra
efforts required to implement each of
these providers but in firebase not only
do we make it easy to set this up but in
your code regardless of how someone
authenticated that user looks the same
to you
you get back a firebase user object has
the same fields has the same data and
works with your security rules and other
services in the exact same way we'll see
this later on we're going to build an
app that has multiple sign-in options on
multiple native platforms and they're
going to sign in and access the same
resources without any extra effort from
us because once they're signed in it's
always that's
unique ID it's always secured to that
specific user and you just don't have to
worry about it the last part once we've
uploaded that file securely once we've
dealt with it somehow translated it
maybe using some sort of magic we need
to sync that back down now you might
have heard today for the first time
about cloud firestore are brand new no
sequel database and the truth is it
wasn't announced today it came out about
a month ago and we've had ApS for a long
time and we really really think this is
an amazing way to deal with extremely
scalable applications that require a ton
of querying but still want speed and all
the other coolness that you expect from
a firebase product in this case cloud
Forrester is a little different than
what you might have seen in the past we
use a document and collection model if
you're not familiar with those no sequel
jargon then you can go ahead and think
of collections as lists and documents as
just you know objects of data in this
case we're going to have three top-level
collections
that's uploads when we upload a file
will write to the uploads collection to
actually kick off the process to
translate it will have transcriptions
which is the transcribed version in
other words if I say hello we will have
a string hello in there and then we will
have translations and that is what will
actually get passed back to our
application so we'll take the
transcription we run it through some
magic and get back a whole bunch of
different languages so hopefully
everyone in the world can communicate
and do so peacefully and of course this
is all done in real time connecting
those different collections
synchronizing it back down to the client
is all done with the real-time aspects
of cloud firestore your we're not
polling we're not waiting for something
to happen we don't have to do an
exponential back-off in case it took too
long
anything silly like that we just know
the clients and who want that
translation are gonna get it as soon as
it's available so we don't have to worry
but of course this is all abstract we're
talking about products and I'm telling
you random things that we can do but
that's not very interesting we're mostly
all engineers so let's write some darn
code and of course because we are not
all Android engineers and we are not all
iOS engineers it's not fun to do one or
the other so we're gonna do both at the
exact same time
which is extremely difficult so we will
see how it goes the very first thing you
need to do once you've set up your
firebase project imported the SDK and
initialized firebase in your app is just
access the services you want to use and
that's kit in this case that's those
three services we talked about cloud
storage cloud fire restore and
authentication once we've done that we
can just jump straight to it let's
upload a file to do that we need to get
a storage reference that points to a
specific location in cloud fire store
think of it as a folder it functionally
is and then we can go and actually
upload to that location well tack on
some metadata you know what is the file
type but that's that's all extra and
optional we're doing it here because we
get different types of audio from
different devices once we get to
actually uploading the file there's one
method put file and that's the really
magical part about this when you put
that file a million things happen a
million things in a million languages in
a million places but all you care about
is does it get uploaded and can I access
it and to know that it's all uploaded
and I'll complete we get back a
completion listener we can tack on this
completion listener will just tell us
hey was there some issued you know have
I been without internet for a long time
I couldn't upload it or did it go
completely because I successfully and
get uploaded to cloud storage when it is
uploaded successfully we're gonna go I'm
gonna write in cloud firestore - that
uploads collection that collection is
what will trigger off our processing and
allow us to actually translate our
message so if we ran this right now
would it work now it wouldn't work and
there's one big reason and that's what
I've been talking about this whole time
which is that right now we're not
authenticated we're not any user in our
application
we're just some person who happened to
connect you'll happen to have the right
API key and pointed it out of firebase
service we're not securing this at all
and that's extremely dangerous so by
default firebase locks this down and we
say you have to be all thank you
authenticated somehow you have to have
firebase authentication setup so we're
going to go ahead and set up fire
you I forbid you I is a brand not
brand-new it's quite old but an amazing
open-source library that is a headful
version of firebase authentication
firebase authentication gives you all
the methods you need to do all the
authentication but it doesn't actually
show anything on-screen it's up to you
to wire it up so firebase authentication
gives your firebase UI gives you that
really pretty screen once this I'll pick
your provider what do you want to login
with choose whatever you want and that's
all we need to do to actually do
authentication cloud storage and cloud 5
store on our where of that
authentication state and we can start
accessing these resources and of course
you can go and you can set up whatever
security rules you want you can
configure it different people can write
to different locations in this case
we're just checking that you're
authenticated before letting you upload
now that we've done that the last thing
we really need to do is listen to that
transcriptions clever translations
collection that collection is where our
final translations are going to come out
of so we're gonna do we're gonna create
a reference to that collection just like
we did before but this time we're gonna
do something different we're gonna use
an on snapshot listener and this
listener is our way of saying give me
real-time updates it's a little
different than if you've ever used you
know real-time databases like you know
firebase real-time database or any of
the other ones but the general idea is
the same well order by a timestamp so we
always get the most recent translation
and we'll check make sure the document
exists when it comes in look at what the
event is but then most importantly we'll
call out to a native API using the
language you selected in the UI and
we'll say hey speak this out so if you
write to that collection if any
translations come in both of our apps
will speak it out and that's basically
it we've written all the client-side
code in order to make a translation app
right now for two different platforms
and that's absolutely crazy so let's
give this a shot we're actually going to
try it using one of the greatest machine
learning API is known to man mr. Mike
McDonald he is going to go into our
firebase console and give this a shot
so hell's hmm yeah once he logs in
because of course it's secure serious to
actually type it so password and
everything like that and you'll notice
that the really cool thing about this is
that we had it like two lines of code
but he's getting a full native Google
login experience all the things about
saving your password and all the
niceties you expect with Google
authentication in general aren't brought
in with firebase UI so here we can see
this is a simple object it has a unique
ID then a languages object and that just
has a translation in this case we're
only translating to English and Spanish
because those are the only languages the
three speakers know but with any luck
if you select English on your app and
you send this in this will speak out to
us so let's give this a shot we'll write
this to the database and we'll see if it
makes it down to the application there
you go that was very fast so that might
have been very very fast and of course
you might be thinking well you know on
stage we faked that that's actually how
fast it was that was fired or real-time
syncing back in the US to here extremely
extremely quickly so that works but Mike
McDonald although he's a great
translator from English to English
he doesn't scale to other languages and
if you tell him to translate more than
five things he gets grumpy
so we're gonna come up with a better way
to translate things I'm gonna pass it
over to Jen to talk about what we can do
to really make this into a great
translation app Jen
thanks Abe all right can we go back to
the slides yeah okay
so as I've said we're not quite done
here because as great as Mike is at
translating that really doesn't scale
very far past just the three of us so
we're gonna write some software to fill
in that gap using the trendiest way
possible by adding some machine learning
but designing and training our own
modules from scratch takes a lot of time
and that's not what this talk is about
we just built an app really fast and we
wanted to get it working fast so luckily
there are some pre trained machine
learning api's and we can pick from a
big menu of api's that are part of the
Google cloud platform they solve a lot
of common problems that developers have
and in this case the two that we're
going to be using are for transcribing
we use the cloud speech API and for
translation we use the cloud translation
API so there you go problem solved right
well almost
how are we going to wire these really
cool api's up to our server let's app
traditionally with firebase apps would
bake everything into the client and
that's really great because it's server
lists and as you saw we covered a lot of
ground in a short period of time but
we've run into a few challenges with
this model and these are challenges
faced by a lot of apps as they start to
grow and get more complex
for instance secrets so users can learn
a lot from the files that make up your
app so pretty much anything you put in
there the users may be able to find it
such as pre-release game code or API
keys such as the ones we would be using
for our cool api's that I mentioned also
we have to worry about resources phones
get faster all the time but the battery
only has enough oomph to crunch so many
numbers or in this case so many phrases
finally there's just the idea that it's
a real pain to have to write the same
functionality over in all versions of
your app for each platform it would be
much more convenient if you could have
that all
one place now our app is pretty simple
but it still has all three of these
challenges and they can be mitigated by
moving our secrets and resource
intensive code into the cloud and since
it's in the cloud we'll only have to
write one version of it thus solving our
third problem and if we dip into our old
bag of tricks we might solve it this way
we might spin up some servers on the
compute engine create api's back by
Django or nodejs but we know there's
more complexity than meets the eye in
this little cute compute icon if we do
it like this we'll still have to worry
about caches micro-services and load
balancers and if you're very familiar
with firebase you probably know where
I'm going with this before we know it
we're back here lots of complexity which
we're trying to get this going really
quickly so that Mike can go travel
around the world speaking other
languages so of course we'll use cloud
functions that gives us the minimal glue
that we need to run our serverless app
and solve these challenges and of course
cloud functions works across many
different firebase features but in this
case we're going to be focusing on using
it for cloud firestorm but why show you
some more silly diagrams when we could
show you some really cool live coding so
Abe is going to show us what it's like
to build these cloud functions that
we're going to use in our app so we'll
start by attaching two functions to
cloud fire store one is going to listen
to the any documents added to the
uploads collection and the other is
going to listen for documents added to
the transcript transcripts collection
so first we'll import the cloud and
firebase api's and initialize the admin
SDK to use then when this initial
function is triggered when we upload the
metadata it's going to be extracted
using the language and coding and sample
rate to use the transcription so here
you'll see we'll run speech recognizer
to get the transcription then we'll
write that transcription
into fire store to a new document in the
transcripts collection this document of
course will trigger our next function to
run and again what we're going to do is
take that transcription and translate
across all these various different
languages once they have all been
translated we write that result back to
fire store and this is the part that our
app is listening to so once it sees that
something else is written to that area
in fire store it's going to read out
that new latest translation for us all
right looks great Thanks
we go back to the slides thank you so
there's still one more step with these
cloud functions we need to deploy and
we're very brave to do some live coding
and play it for you but a live deploy
can take quite some time and again we
want to get this app going quickly so
through the use of video magic we're
going to deploy our app and I'm going to
hand it back to Mike to show you how
this works so if you're paying really
careful attention to this slide you'll
notice that in addition to the functions
we also deployed something else so for
the grand unveiling if everyone would
like to go to Babel fire dot cloud on
their mobile devices bring that up and
select your favorite language give
people a minute we should start hearing
some words in other languages very soon
like we could have had a QR code
I think I heard someone yeah people have
it up Jen do you wanna say something
into your app and see if you can get al
they're working in English and Spanish
the languages we put in yeah
let's add another one real data them
okay let's see okay remember mine like
6th grade Spanish here donde esta la
biblioteca hopefully this is only four
but I'm not also output cuz if it's
using this for we're getting that phrase
a lot of food it's very delicious it's
very delicious
Oh oh I just heard I just heard
bibliothèque out somewhere okay there
you go um can we get our member of the
audience who speaks multiple languages
to come up and try this in a language
well we did Spanish do you speak one of
the languages on this list do you mind
coming up and and everyone welcome her
to the stage
you mind standing over with Jen and
utilizing that app so everyone select
the language that you want to hear we
promise it'll work this time okay
wait in anticipation we forgot to say it
had to be worker program was it set to
English well it's gonna be English on my
it's gonna show up lots of English on my
screen but it still translates it in all
this I think I said I set it to Hindi
yeah
there you go
a crowd of trends but the crowd of
translation wavers awesome thank you
very much so there we go between the
three of us in how long is that just
under half an hour four and a half
minutes just just under half an hour we
built two entire applications complete
with a back-end that did translation
from any of about eight or ten languages
before today you may have gone home and
spun up a server and written your own
machine learning algorithms and you
would be taking a lot of time you know
people like us might beat you to market
you'd be paying a lot of money to
maintain those servers and you spending
a whole lot more time dealing with
server issues rather than building
features Abe came onto the stage and
showed us a really cool way of getting
rid of all of that replacing it with
firebase and doing exactly what your end
users care about right uploading those
audio files synchronizing data in real
time securing all that information and
then Jen came and showed us how to
leverage cloud functions to glue all of
those pieces together right
she took cloud functions and a connected
cloud fire store to the speech and
translate api's and just as easy as it
was to wire up those two there are a ton
of other services within Google cloud
platform that you can take firebase and
cloud functions and stitch together
right
more pre-trained ml services just
general other there's a jobs API if you
ever want to like look for a job you can
do that on cloud platform as well and
it's just as easy to trigger those
events and chain functions together as
it was in this talk it turns really
complex processes into step-by-step
workflows that scale as you need them so
thank you all very much for coming
hopefully you've learned a lot from this
talk feel free to reach out to us on
Twitter or we will all be in the ask
firebase lounge right after this thank
you all very much and enjoy the rest of
the conference</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>