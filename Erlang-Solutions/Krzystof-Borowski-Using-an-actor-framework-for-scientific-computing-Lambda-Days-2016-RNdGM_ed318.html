<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Krzystof Borowski - Using an actor framework for scientific computing (Lambda Days 2016) | Coder Coacher - Coaching Coders</title><meta content="Krzystof Borowski - Using an actor framework for scientific computing (Lambda Days 2016) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Krzystof Borowski - Using an actor framework for scientific computing (Lambda Days 2016)</b></h2><h5 class="post__date">2016-03-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RNdGM_ed318" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone can you hear me
today I would like to present some
result from my last research about using
an actor framework for scientific on
computing I would like to show you some
opportunities connected to this topic
and also some of the changes but first I
would like to introduce the term
workflow the workflow is a directed
graph and we haz can have many inputs
and also many outputs on inputs we have
a sequence of data on output we also can
have sequence of day of data nodes
represent the activities and edges a
dependencies between these activities
it's null activity we can represent also
as a function and why Wartrol why I'm
talking about workload because a
workflow is a base tool for scientific
computing computing we have a such thing
like a scientific workflow it's a
workflow but very specific one the data
elements in this world are sometimes
really huge from megabytes or even
gigabytes activities can be longer
running and really resource intensive
also an often workflows live up with
legacy code for example written in 4chan
or NC or using extensively external
resources mmm we've written down some
crucial requirements for scientific
workflows and they are as follow
polarization and distribution of
computations persistence and recover
because there are competitions are real
around long-running and we sometimes
want to run for example the part of this
graph with different arguments or we
want to restore the state of the
workflow of the to the point before the
failure and also we want
to have a full control over the errors
of the fault tolerance and actor model
actor model is a concurrency model when
the main many unions are the actors
actors have a state isolation can
communicate with each other with
messages with a zinc messaging and they
can change their behavior in time and
they can create new actors of the basic
sedan main features of this actor model
I am talking about actor model here here
we see the simple workflow and in the
middle now we see the simplification of
the actor concurrency model we can see
that if we will represent if odd if of
this note as actors and if each of these
edges like and messages going between
this disallows these actors so with this
this model actor model can really fit in
here so we can spot some similar
similarities so why not give it a shot
yeah but we have a problem because actor
concurrency model is really a simple
simple one so the inputs for example in
loads in notes we have can have many
inputs in actor we have only one input
mailbox also the similar situation is
with outputs in output within notes we
have different channels and in actor
model where we have a problem because we
have only the simple messaging feature
also flow patterns in scientific world
pros can be really demanding and really
complicated so we must build some
abstraction above it those two
implement these patterns and yes so the
question is why not use the actor
streams it's exactly what we needs there
we have Anaka streams is a library
developed by typesafe around the aqha
framework is higher abstraction build
upon the actor model and its support
complicated flows through the beautiful
a graph RP and also its support
concurrent data processing so we can
feel that we must we can use it for also
the scientific computing computing but
the accounts trees were designed to to
handle very different target because I
costumes are for unbounded data stream
and when in scientific workers we rather
have bounded input data set also occur
streams operate on small elements rather
than on a huge was a accessories are
focused on back pressure so to know to
not overpower the actors when the
scientific workers are focused on
scaling and important thing in our
customs is the high message for output
and Rick and in scientific workflows we
have rather insist on recovery mechanism
because it is more important than actual
message for output because the
computation are here the main the main
thing and yeah we want some be able to
recover this computation the longer and
longer a single computations also we
have current World Cup engines like
Kepler tavern now again because and they
are but they are focused on graphical
interface for non-programmers
sometimes has complicated have a
complicated happy they are really
complex and yeah at the end you always
must write and actual code so why not to
yours for example the mother language
like as color to read this to write this
program and here we are the scuffle oh
it's a simple vocal engine engine for
scientific computations is built from
scratch it's designed for programmers
for now it may be kind of having the
future some UI is built with modern
technologies in the less than 1500 lines
of code is built with language is color
and the toolkits akka and Cassandra a
database so we implemented to
implemented some components to be able
to prepare actual flow like a source
component well is it is an input to our
flow and data processing component
component when extra computations are
happening data filtering component data
grouping we can broadcast data to other
branches we can merge after that this
data we can synchronize this data so we
take one message from the China I and
one method from the channel B and we are
composing together to chat to the taboo
and the data sync so the sink is output
from our workflow scuffle up you was the
idea was to design it is the way that it
would be similar to a scalar collections
library and so we can with we see this
we see here a very simple workflow which
takes the as an input that data number
sequence square square this numbers and
grab them grab them by three and sell
this group of free so you can see this
is the list of data sequence and we have
math operation we have globe operation
some and we are printing in on the
console and we are running to throw a
concurrent competitions in actor model
and we have a two main patterns here as
actor cannot process the data
concurrently so the actor must respond
workers to and send them the actual job
first model is to push the data so the
master is pushing the data to the
workers as soon as he gets the new late
a new job to do and the workers are
doing the job for him the problem is
here that the messages are stored in
worker mailbox and this Mabel when the
actor a crushed for example there is a
problem which message to for example we
resent to this world care there we must
resend all the day older messages they
are that are stored in this mailbox so
the other approach is to pull model when
the work hair is actually asking the
master for the job will not only notify
the workers that the new job is a
variable so when they are not eating not
busy they can they can send the message
that they want some to some data to
process and this is you're here to
maintain which worker is doing which job
exactly at the moment because the worker
is doing exactly one job at the time and
scalability in accra there's this
concept that the actor location is
transparent and so we can deploy these
actors to another
host to another remote machines and to
treat them as it will as well deploy it
locally yeah that's all and we have this
courage of for free a vote for
persistent state and we extensively hear
the event sourcing idea and even
sourcing actually implemented in as for
the concept of persistent actors and
each each comment that a mutate state of
the actor produce the event and this
event is saved to the external database
after that we can restore all the state
from from the database reading reading
the data and applying these changes to
the state of the worker of the actor
exactly the worker and for example here
we have a new event new message which
come to the to the actor and we are
persisting it as in ecology and we can
then reply the events when the actor is
restarting okay and photo us so we want
to also provide some strategies to be
able to handle some errors and we used
for this standard strategies from the
aqua framework but we've changed
slightly the behavior of the strategy
and for example the rest art methods in
the rest'll directive here if cody is
causing the cause that the message for
which the error was was right if
recomputed once more and the stop and
means that and we want to drop this
message because for example
it is a corrupted input and we don't
want to process it and hear this this is
the RP we can put it as an argument to
the map operation this strategy and
simply we're going to do the job and
bring out what example and this workflow
this won't download some biological
pathways related to the particular gene
identifiers and so so on the input we
are we have this gene identifiers we are
downloading the all paths biological
pathways identifiers connected to this
gene then we split this leads to the
separate messages we are broadcasting
this messaging to the two separate as
branches of this flow and we are
downloading the graphical representation
of the of the biological pathway and
concurrently we are downloading their of
textual representation of this of this
pathway and here is a coat I only skip
the actual called that downloading this
data as it is not interesting here so we
have this strategy for HTTP rest
communication when the time out
exceptional ocular we want to retry and
try to reconnect to this external
database and click database and here we
have this separate branches one is to
download the graphical representation
and the second one a second is to
download a textual representation of
this pathway and here we are composing
hold pro and
we can spread here this this is a source
this is a map operation that downloaded
the pathways identifiers here we split
this list and then we are broadcasting
these messages to this two flows and we
are running the flow scanning we can add
this feature very easy and we are
assuming here that on the remote
machines we have the up and running
after system on this address is cured
the local host it could be something
else and on the sport and we can also
add this information about waiting
actors system on the remote machine here
to this old map operation and simply
this where this map operation will spawn
this world curse on this remote machines
and everything else seems to be
untouched by these changes so it's
really to add this value and you may
wonder what what is the overhead on
persisting this data to the external
databases because we are we persist each
even that mutated the state of the actor
so I did a small research use small
bench bench mark here I built a very
simple flow and put different amounts of
data through the flow and I measured the
time of the how long the flow was
running and with different configuration
here we we see the performance of the
flow without persisting feature here is
a Kafka but it's Cassandra back end
and here is a Kafka vacant and here's
default implementation of purse this
event sourcing idea in apke and we can
see that yeah we can spot some job of
performance but it was for 450 thousand
messages it was like in three two or
three second overhand so for scientific
computation when we have this long
lasting computations is we can say
really laughing and it's not a problem
here at all yes and future development
of the scofflaw now I would like to add
some graph API i would like to beat this
graph api may be similar to the ACTA
streams as they are really clever also I
would like to use extensively occur
clusters idea and a cluster charging we
would like to also influenced some work
from monitoring to have the insight to
this workflow in real time and say yeah
and maybe a few others idea the codes
available on github and to sum up I hope
I've shown you in this presentation that
the idea of actor model concurrency
really fit into the scientific
computation scientific work flow we have
thanks to akka we can implement a few
crucial features in just a few lines of
code and I think it's worth to
investigate this topic and to gain from
this from this actor model what what we
can because sometimes we need a right
tool for the right job for the job and I
think maybe it can be
like a dope and spark when the spark
coming everyone was well now IM live in
paradise or it's really changing the
think so maybe this approach to the
scientific computation will be like that
and yeah that's all i would like to
thank you butterfly from agh university
for the idea and the supervision and all
the advices are doing the research and
whole capital development thank you i
want to ask about persistence do you
guarantee anything I mean if not goes
down if electricity goes down would you
be able to recover everything do you
have test monkey coasters for example no
it's another a proof of concept but the
rehab so the question was if the
persistence and is reliable here so for
the person we are sending basically it
to the other system like Cassandra
Cassandra can scale on different nodes
and is we can say that the cassandra is
reliable so we are not managing here and
any move we don't have here problems
with reliability as as the Cassandra can
handle this if Cassandra cannot handle
this our sample goes along with
Cassandra database yeah we also have a
problem I mean for example if you have
everything on the same node and
persistent mean that power can go down
or or not just so the power is down some
week we can it's hard to say you know
when things crashes is really hard to
say what's what's going on but but the
idea is is that yes we can
it will be persisted to the Cassandra
and after the power will be up we will
be able to restore this state but we are
not able to run run this workflow if we
have some node failure when when the
note which contain master worker or my
master will fail so yeah it's crush of
the workflow and that's all we can
restart it okay but help you try to do
that because you compare different
things like leveldb and cassandra and
without trying to restore is like
nothing yeah i was doing another another
research here for example i was i was
talking all the workflow and restore and
starting it once again and it works I
was assimilating some failure like for
example the availability the external
service is not available available so
the failure finally a pure and the whole
workflow crushes and also i was able to
restore the state but I was not
simulating the completely shutting down
of the Martians like pressing the button
of why I was killing it by in it yeah
this one super Christian artist or the
production ready I know if I baking a
precision butter underlying a custom a
customs they are now in the main acha
module and I think yesterday was the
release and the official release of the
ipad dreams the next version of it and
yeah costumes are production ready</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>