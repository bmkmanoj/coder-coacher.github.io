<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Michael Schaefermeyer - 'Individualised Content at Web-scale' ElixirConf EU 2015 | Coder Coacher - Coaching Coders</title><meta content="Michael Schaefermeyer - 'Individualised Content at Web-scale' ElixirConf EU 2015 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Michael Schaefermeyer - 'Individualised Content at Web-scale' ElixirConf EU 2015</b></h2><h5 class="post__date">2015-05-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xT8vDHIvurs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I am going to talk to you about
individualized content at work scale
which is another long and very much
interesting solving title and I hope
that the thoughts actually more
interesting than the title is so few
words about me my name is Miss Betsy
from Maya my appendix RMS eh8 me which
is very very close about materiality so
I might look into another programming
language many years ago round I have a
Ruby back problems recently found on
Felixia
and to the last month I was a senior
software engineer
each report which reported to be second
largest support website in the US and
this talks a lot what we did there and I
hope that I can convey some of the
things and what some of the problems
that we had there to you guys last month
I started my own company with couple of
friends and due to the experiences that
I made the meet report with leaves year
all of our back-end services were rough
and are running near exhibit Phoenix
so that's the first testament to how
much we were blown wait wait I have the
disclaimers of a front I have a ruby
background I saw that love you guys do
to have the same thing so this talk
might contain contain traces to Ruby I
would have a compare a little bit my
experiences super very experiences that
I have and we were raised not everything
we survived yet now we have a couple of
things that are yet to be released but
most of the code that I wrote that this
presentation is about is actually
introduction and lastly this talks not
full-stack what that means for this talk
is full-stack it's not very detailed on
the code level it's not very technical
what I want to do is I want to tell you
guys what experiences in girls observe
other what experiences we made with
ellipse and Phoenix and what problems
retarted
and how we address them and how we solve
them it is time to more towards people
who haven't as much experience with it
although I hope that some of the things
that we learned the way that we solved
it will actually be very loose to do
more experienced engineers as well first
let's talk about the problem domain
let's talk about the product so at each
report we have this which is team
streams team streams are a list of
content items to a sports team so for
example you can see San Francisco 49ers
which is a football team the football
and play with your hands for some reason
police feature recording Francie did
enough for that it contains a list of
tweets and offers the applicants are to
reach report content or content from
other websites are on web and then we
have treats and instagrams in there that
are being automatically in life fat into
that tweet and it's registry so you have
my experience all the different things
that you have in the internet that's a
protein but in the mobile apps in the
iPhone app that you're seeing on the
right-hand side of that screen the
starts start page is actually a merged
list of 40 different teams that you're
following and some other content as well
and that's where it's getting
interesting
I'm going to come back to that a minute
just keep that in mind so the start page
with the mobile apps actually contain
merged business teams so this is again
it's 3/8 as you can see if you get it
pretty low we actually don't delete
stuffs if you keep scrolling down
he keeps loading more stuff and it's why
the sets of our streams tweets and
instagrams
we've got burst desktop the native apps
we also have screams who leads to
business teams and stuff like that
master the same we just cover that
yeah and mobile apps and awesome desktop
you can subscribe to different teams and
we have an individualized experience if
you have noticed I bet those apps oops
that was one too many status quo so how
did we use to do things that each report
our first the losses both prints as lots
of requests
we are dealing with a five-digit I
wasn't able to show numbers but we're
dealing with five digits lots of
requests percent so there's no traffic
hitting our servers and the way that we
traditionally solve that problem was
with too many of the gaps we had one
monolith and I've started API project
became another one of the celebs great
and obviously is not introducing what
must be services to I expect that
architecture we're breaking more and
more out into micro services absolutely
I'm gonna end up with Microsoft's
architecture and the product that I'm
going to show you today is actually one
of those services we did everything on
Google rates like me
Ruby background rhythmic roads and Ruben
racism is very very well we have some
notes yes but you can see it's a very
fine print because we don't really use
it all that much for a variety of
reasons that are not going to go into
the room to not get too much JavaScript
a dummy persistence is that we store
everything in relational database that's
my secret little phosphorus sequel and
if you did that escape you know that we
have to have caches on top of capital
caches on top of caches if you are
handling that many requests and no
matter how good and faster databases are
that relational they won't be able to
keep up with that so we catch everything
now keep in mind those dreams I'm going
to go back to that in a minute
I've only been questioning him up I was
in Berlin for the victory talk to the
Martins and one of the Martins asked me
why don't you do like why do I go away
from that it works really well there's
actually a couple of good reasons
caching especially if you use CDN and
you bring the content closer to rather
user lives if you're an Australian that
you know want to do all the network on
trip to Virginia where our server lives
so caching it's good thing right when I
go over there and while is it well the
most honest answer their questions I saw
an exit likely to want to use it I the
app that I'm talking about doesn't have
a persistent connection it's not a chat
it's not a game and all of these things
that you heard about today are very
particular examples of how and when to
use elixir well I was on a blog because
my head is not like that it's a very
standard web map requests come in I do
something and I'm a spot
so way why won't you think it's it for
it and why don't I keep the caching
strategy that has been serving us really
really well well to push for the copy
there's two hard things in computer
science and that no one has ever heard
that one
attention validation and making things
and customization is the course of this
problem the grocery benefits of the
dictionary the one that is not website
that Joey likes to talk about but
actually makes a lot of make a lot of
sentences it's it's scalable it's for
tolerance it's a functional programming
language and it supports meta
programming that was news to everyone
here right turns out when you wanted to
use a new language and you have a big
product team and people who are charging
you that doesn't go too well like yeah
all of these things are great for
tolerance now that sounds interesting
but are apps that are actually pretty
fun stable so why do we need to change
anything well for the problem that I
just showed you those
this is highly individualized context we
can't actually catch that thing is
there's a couple of big teams and a lot
of people subscribe to like Miami Heat
for example or on the Lakers or best
football team on this planet and talk
about extra 4:20 Abruzzo don't the thing
is that no two users of our apps
subscribe to the same team that's a
little bit of life might actually find
to you but it's very highly dispersed so
especially if you guys you have your
college teams and there you have
different places where you live and
these combination of teams that users
subscribe to my heart become of the same
now that pretty much prohibits caching
because caching on the workers in
remembering a response to one of the
requests and then replaying that
response you can't do that with
individualized content obviously there's
like some caching you can do in between
and might be a good idea to do it but if
you are compiling these lists that have
to be very fresh and have to be in
utilizing a per user basis to over 80
million users then you can't go out and
just preempt all the different list
combinations that that might be in a
catchment what possibly can but it
wouldn't recommend trying that there's
another couple of reasons to use a
language like Lisa for what we've needed
for what we've been doing one of the
most turns of a functional programming
language is like linked lists it's a
very good data structure
functional programming language and
those lists you've seen are linked lists
so the data structure pretty much
encourages you to use the functional
programming language if you look at that
start page again I can keep that in mind
there's most of the lists and multiple
teams that you merge we have users
without to 50 60 different teams to
subscribe to so what you have to do is
to go the Apollo is different these
different lists and then be merging
turns out that a distributive language
like Linux near let's see you that
parallel and I'm going to keep hammering
that pointed out so just on the next few
slides all of that like I said we will
have extremely high dispersion you know
two users have the same stream every
stream looks individualized per user and
we have like a requirement to in the
future enrich those fiends to so for
example if you click one P more than the
other teams we might want to promote
that team content on the start page so
we actually gonna go ahead and do
visualize
even your own this every time you visit
and incorporate your users behavior so I
hope that I made a good point at least
somewhat with convinced of superiors I
had a teacher report to use one thing
that allows us to do it in real time
rock back cashed not even for real-time
I could have used a kind of other
languages like go and I looked at it but
everything I saw about Phoenix and Dixon
made me use that product in that snake
and I'm going to tell you very very
specifically whether that's so much a
white thing is the right decision and
why I decided to have a talk on this so
first of all if you do something in Ruby
there is some way to maybe do a little
bit of
see every now and then but it doesn't
really work and I think that's not
something that I've proved to you so it
has a sequential approach to the lists
that we are building equipment to go to
one database put a list go to the next
build list go to the eggs
builder there's none yet merge all of
these lists so basically even if you
make everything really fast the fastest
response you can give to users like a
combination of all of these visit builds
right well this is gonna know where all
the earlier continue that parallel we
can read from different database slaves
at the same time that all of these lists
in the same time I don't care how many
teams you subscribe to if it's a hundred
and describe the land route list at the
same time it's just going to feed all
that to the merger have the merge stream
and then another thing comes to play and
it was I think more of a coincidence but
it works really really well with this
use case actually the way that echo
handler is talking to a database is
brilliant little because and again this
is where ruby comes to play if you guys
have ever seen active record what you do
is you say user give me all your
entities so you probably city the
database call on the user there's no
data the database is completely
abstracted away from you it's within the
model that you were performing on actor
does a different way at the beginning of
beginning if I kind of weird to me that
I have to like do something on the
repository on that to the database with
like the queries but if you look here it
actually works really really really
nicely if you have
nation bases and muscles it's nice
actually different databases that you
read it rightfully so what made you go
out history you have to write to the
master muscles the only one that allows
you to change stuff so master before you
duel insert and then put it whatever one
of your boots you have but if you want
to credit me for something if you just
want to read data you can create a query
like that all you can read that and then
you execute that query on a people that
you specifically call can say it's a
free for all and you can see that it's
super straight for it at this point to
not just go snake fruit savory for bunch
of like an email round which we're going
to have in a few months except or you do
it yourself so it can actually have a
pool of different snakes databases and
execute that query on you can even go as
far as to use pool or something like
that - like maintain little slaves
now don't confuse that with a pool that
a database connection has anyway so even
if you just have to one database you
have a clue to little connections but
with this and this is where the vectors
designed that has Reaper living next to
aquarium if these two they're separate
things you can actually go ahead and
like be very specific of where you
understand that program that worked out
perfectly for what we're trying to do
because it's allows us to scale linearly
if I haven't go into a bottleneck we're
reading from database is where my my lab
go slow I just had a couple of more
slaves I'd look to that pool I can scale
up as much as I want and that's really
really helpful if you're trying to do
something like that
real time on West skip so upper to this
point I hope I must've made it a little
bit why I was using that snag and like I
said I'm not gonna lie to you I really
wanted to use it it's in that's like one
of the big reasons that I came up with
all these excuses use it but it turned
out that was actually very good a good
idea worked out perfectly for us and if
there's one thing that I want to want
you to take away from this talk then all
the conference stuff that you can do
with Phoenix and with Aliza and Phoenix
for me is a big part of this reason
thank you very much Chris for writing
here and although the current stuff is
really amazing but even for like
traditional web applications where Rubio
brands will do not need the Unicode
respect if you were like me it makes a
lot of sense and there's a lot of things
in the networks that are going to talk
about later on as well that makes it
really really good fit for it now in all
fairness it wasn't all peaches and cream
like every time you try something new
there were others that we had to
overcome and what I want to do now is I
want to talk to you about those hurdles
about the problems that we encountered
and how we solve them and the reason I
want to do that is maybe you're thinking
about writing a project in Phoenix and
elixir and maybe you are afraid that
there might be things coming up and
there will and maybe I can take away
some of those fears but just showing you
yeah we had that and there was a really
straightforward way to solve it so the
first big hurdle and the title of those
lights is always just like the poem that
we have to overcome its immaturity of it
it's there and there's a little bit
unfair I'm going to talk about that a
minute but
every keep in mind that Beach reports
big corporation a language that has been
stable for that one six months is not
necessarily something that makes
everybody feel super comfortable
actually when I started that project
appendix it was like point eight and
they were like that's very young to put
a lot of our money in trust me a problem
that results from that is there's few
suppressive service integration points
that we heard about that already over
the last couple of hours days our
tracking and another big topic that I've
talked about a minute but just like
software service was Ruby you get all of
these suppressor service tools that you
can plug into the app that you're
writing and it's all just and you just
pay a bunch of money to a bunch of
people are not works
ideally with did exceed the the of the
offering of the chakras of service
ecosystems obviously not quite there yet
it's not quote important like Ruby and
note that's the maturity that we're
talking about there's things like no
fish no docker images and we're using
buffer to deploy there's tons of images
out there I ended up writing my own
image took me know about 20 minutes
because it's really straightforward and
look what other people have done but
it's just like small pain points that we
encounter when we did it
now I'm gonna keep saying and I'm gonna
come back to this so just bear with me
comedy small your system
I might have matches whatever would be
background this is a chart that shows
like all the different github repos and
how active they are you can see that
Ruby is up there travel scripts are very
top there's a lot of repositories a lot
of things going on and obviously
for language that is less young it
exists not Atlas yet anyway
I do think that that's one change
eventually but when you start doing
something you have to look at the status
quo at the current situation what we
don't want to do is we don't want to
replicate existing functionality I don't
want to have to ride like another user
education see I especially don't want to
ride hard things like encryption that's
something I really don't want to have to
deal with especially not if I'm trying
to get a product out that it's time
critical so there was this fear of like
I have to do all these things myself and
this fear is like they're really big
problems that I have to solve it
databases somewhere they're talking to
them getting data and Oliver that those
are complex things and we were afraid
that it looks it wasn't there to solve
these things for us training developers
some big topic for us we operated San
Francisco San Francisco is extremely
competitive from the developers and
there's a good chance this is one way to
seeing of Silicon Valley to get noticed
unlikely violating copyrights here
there's no chance that you won't just be
able to hire what's tangent yes I can't
do it all so you will have to train them
that's easy
if they come from the movie back on the
near Ruby shop and there's lots of Ruby
material out there like I said
Francisco's what health market and I'm
already hearing recruiters would be like
hey you guys need a mixer develop okay
let's find some six years of development
experience good luck man maybe Josie
that will be the excessiveness
I think and this is probably the biggest
problem you've encountered I was really
happy to hear a couple of other talks
over the last two days imagining the
same problems for me that was probably
the biggest pain point like all of these
other things are not ideal and I'm going
to talk about in a minute how we address
them monitor it was like the thing I've
had me worried most because in Ruby land
I'm used to having foods like neurotic
and snide of it and you add one Jeffrey
gem said give it an API key and you get
this which is like a broth and inside
and how much time is spent in database
and monitoring is extremely important if
you're running a web application
whenever we have a doubt time monitoring
is the first and a check to go to our
dashboards and I see do we have space
spike in database response times that
would mean that the database is
Department of the load do we did we ship
code in the Ruby execution time went
through the roof that means that we did
something stupid Ruby and that's
probably fix whenever we encounter
problems and you will even in a foreign
language you need to have instance to
quickly narrow the field of things that
you have to look at to find and fix the
problem so you don't have you flying
blind
and it's super octave up things so how
everybody feel really good on feelings
application
these replications now the reason I
showed you all of those problems is
because I hunted them and if you start
predicting that you might encounter them
as well but we also find solutions for
or found out that the fears that we had
were actually unfounded I'm going to
talk about each slide that we looked at
and tell you what solutions we have to
that okay so the immaturity of Felixia
well yeah the language of some ESEs is a
six month over six years six month old
buttoned the 2-liter omelet is amazing
that you have a better package manager'
and dependency management then Ruby I'm
sorry but I'm going to say that midst
enhance solve the problem better the but
laughter did you have a testing
framework that works really well with
xunit and it comes built into the
language there's an amazing testing
frameworks all that ready then you can
also use make sugar and other tools that
not mentioning right now the end of the
hex package manager which is it was
there like one month or two months of
didn't experiment 1.0 like you already
have website to post all of these
dependencies and to deal with it you
have current documentation tools with X
bar there's just so many things in such
a mature tooling that's also good
already built into the language that a
lot of the very mature languages didn't
have for a long time still don't have so
even though it is a young language it is
not fair to call it immature it is has
to approve me nobody has written the
gaps in it that's not true by the way I
heard the bottle of Production apps but
it's not as proven as Ruby but
everybody's been using well but Erlang
cats like the whole thing is built on
early and
as been around as long as I have so
that's saying something
it's been proven in telephone systems
and his improvement things that are way
more complex than what I wanted to do
with it and that basically the
credibility that Ehrlich has and I don't
think that you never have to argue about
that basically let's Felix here because
you don't have a new foundation that
everything runs on you just have an
awesome new interface that uses is
really proven technology they are
production projects and actually the the
Martines
that have been using the exhibit really
reassuring for me because they had
systems of them were running and
production that were growing very very
smoothly so there is examples of
successful deployments to the web it's
not all just hypothetical there's
actually software that runs and it's
fine you can all breathe easy even if
there's something missing the
architecture the whole thing was written
s that's Felix - that's Phoenix that's
actual everything has been written in a
way that it's super easy to just extend
it to your needs even if there's
something that doesn't quite work where
yet I'm trying to give you things not
that a minute of that it's super easy to
come off that and fix it that's but at
least there's extremely smart people in
the community I'm going to talk about
that a minute but if you go through a
ruby challenge looking for help and
let's just say that the quality of
Alice's is very mixed the help that I
got with my Phoenix problems word like
smart right away it's just the the
extend of help and people working with
it makes it a lot easier for
problems if you have them small
ecosystem
I talked about mitosis right well you
have the Carnegie ecosystem at your
disposal
there's some other things that I didn't
find as illicit languages yet but you
can interface with Erlang there's a lot
of stuff out there for learning already
one of the things that I can think of
off the top of my head were stay home
off and to education librarian and I
think I just saw a package on the
hexagon for that too but at the time I
needed it it wasn't there but it was
there for hurling so I could just use
that there's a rich ecosystem of content
packages that you can use in your
Andalusia applications Phoenix is an
incredibly world is that web framework
and solves like the biggest pain point
that I would have lightning myself like
it has browsers and models and views and
a really sophisticated routing system
I'm not even using Phoenix chatter - its
intense not Chalcis generous and it's
it's mean there's great packages for
like your standard use cases already
HTT poisoning just poison xvc our just
like a fairly specific problem like you
have to do API requests in their tests
and wanna record and replay the answer
to those attacks like that's very
specific but we still have a package
there already it works and I'm
mentioning I'm not mentioning a lot of
other great packages so yes the
ecosystem and small but there's still a
lot of packages are
that Burling or already very happy to
see to Sparkle
there's us many people working on it and
but I'm gonna drive that home for a
point home I have that on the previous
slide as well people that do work on it
are pretty good so what you might find
more gems they might not be all that
good the elixir packages I haven't seen
about one that I've worked with yet and
lastly we have an extremely helpful
community
I don't problem with life as data that
you sent to the server was an adjacent
type but it wasn't decoded as Jason
because it didn't say applications left
Jason as the data types for something
else and it took Josie two minutes to
fix that push it to the master branch of
Phoenix so I can use it and that's
amazing
and then that's what I teased before
there was a problem that wasn't solved
already for me but due to the
architecture was really easy for me to
solve it myself and that's training
follows rates the way that you
negotiated your content type used to be
host / resource content for example in
dot JSON so the DA Jasmine tells us that
I have expected JSON response while you
do act on XML about HTML Phoenix didn't
understand that and didn't wanna
understand it because it's actually not
a very good way to negotiate what
content you want to have but I still
needed to maintain a comfortability of
those ap honest that did it that way so
all I had to do is write this little
plug and because he is 18 months of code
hadn't written a clock before and it was
really really straightforward to just
split the last part of that string and
use that as the former that just put it
into the parents of the connection
because in Phoenix you can't give it a
format power with first objects manager
now and then just continue that call
chain of the plugs and another amazing
thing for me as a Ruby developers I find
you submitted whereas which is kind of a
similar concept but every little rather
to introduce so it on your app because
you come on the deck traits and you have
to go through all the different middle
grass plus will be compiling other than
what this code that's running and super
straightforward you don't really
introduce all that much overhead so the
point I'm making here is there were
things that were missing but due to the
architecture of everything that was out
there
it was super straightforward for me to
just attach these names my hat and I
have them at my exposure and I also have
to show a code because this is an
engineer conference after all training
you developers well we found out a
couple of things first and this is
different from Ruby and all of you
probably know that and Dave Thomas made
a great pedigree to talk about like how
you shouldn't just do it the same way
that Ruby does it but the fact that the
syntax is so very similar to what you
already have and as you know is like the
perceived entrance variance for
engineers and I think for new languages
that might be the biggest problem
engineer's being like others is all new
to me and this
doesn't look the way that I'm used to
code look in line at especially with
Yoon Engineers it like RI a lot and just
the fact that the syntax and there's
obviously other reasons to have a very
but this fact that the syntax that's
very Ruby like people were like I
understand what's going on there I know
that it does that's a function
definition like I've seen all of that
and that really helped us train and
engineers it meant one way of training
that was just giving them a ticket and
even figure it out obviously want to
have a small team in the discussion with
you brought but just the fact that the
language of it's very similar made it
easier for people to get it this
excellent learning experience out there
and I think that's a very very important
point because you can teach people they
have to learn and read up themselves and
it makes it like that or it has a
fantastic warfarin tutorial of how the
different datatypes work differently
existence which is amazing to just like
you could fresh likes to see somebody
else doing it and then replicating that
and then obviously dictum of this book
it was there one of the links it was
release it's an incredibly good book
about the language that's a very very
rich resource to have if you're training
engineers we found out that the fact
that we're using a new language and a
new ecosystems actually really
to hire engineers because at the end of
the day you want to offer them something
you want to be like yeah it would help
just another ruby shop you're going to
do the same thing that we've been doing
a lot for years over and over again you
actually have something really this sets
us apart and we have another people
coming to us is looking for a job
because every rep that you guys are
doing clicks in a super interesting and
we kind of like one of the garnet and
that was the reason we got to talk to
them and like I said in San Francisco
when engineers coming to use big deal
measures what did we do to train them
like say we stopped with these
certificates and gave them to people and
we like figure it out and they did good
job Eddie
but we also had my supporting sentence
and it worked really well I just said
the room and started like doing stuff me
talking out loud well why I was doing
what I was doing and had to benefits
people who like understood like concepts
like pattern matching way easier but was
she watching me apply them and I started
thinking about my code which was a good
thing for the code so explaining
yourself while you're programming is
good for yourself
actually it'll also work really nicely
in tracking your engineers that's comes
the biggest problem lack of my brain
that was a big thing that I was afraid
of the moment so there is a Google a
manager that like lets you kind of
record some requests in your attic it
doesn't really work all that great and I
didn't want to base all my touring our
lifeline on something that was
officially supported and that was
actually condemned biking running like
there's a fourth bullet born every
summer where they say you ever got
support that would have encouraged
people to use it so that wasn't really
reassuring for the whole life I've gotta
have a letter charming and scarred I
know like a snow this great app doesn't
work so you have to build it yourself
and that is surprisingly straightforward
and actually for me the turning point
was the same are they factory that
talked about Berlin where I saw a talk
by Brian trotline
from Admiral who's like I let me talk
about how we monitor our raps we use XM
e time and he had like an amazing
walkthrough I was like well the cool
kids are using it so I want to use it
myself and I integrate X amita in our
app and it's there's so many things that
work really really well so for example
if you collect a couple of thousands
calls every second you don't want to
push those statistics to a danger
collection end part right way because
you're introducing a lot of network
traffic traffic just to push long
messages and stat messages so I haven't
steered away from using strange steps T
and pushing every event in a nice nasty
stuff what extra meter lets you do is
like collect all these entries in memory
in the Erlang p.m. and then aggregate
them before you send them out there it
has a very few this very slim chance I
ever need metrics that are more granular
than down to the second but collecting
10,000 calls and putting them together
to one data point vastly reduces the
load of your application you don't want
monitoring to bring down your main
product that's not what is there for and
by sending all these stats every time a
call has been made we it didn't work out
well for us
we do use stats deed to that send the
step and the statistics from XO meter to
our back ends and that's actually again
it was suggested my brother and I run
with it and it's a great idea because
there's so many great tools out there
already that Nietzsche breakfast that's
D if you want to have a quick
time-to-market you use a software
service like data development brought to
them there's a couple of other out that
I'm not mentioning I'm not getting paid
but information known density allows you
to just have a very like open step
collecting and monitoring whatever and
then you can host yourself to so execute
an income for that combination was
density is actually really good way to
measure your app and I ended up liking
it more than everything that is a
subversive service limited for us
because you can do more the early p.m.
it's amazing about sharing information
on itself it tells you how lucky how
much memory it has allocated for atoms
and binaries and processes and that's
impossible vast amount of data of your
running in the tells you how it's doing
right now that actually lets you
anticipate failures if you're seeing
that one of the memory allocation graphs
go up you have a problem you can
actually intervene before your app goes
down and on top of them it can also take
a statistics like CPU load memory they
give the disk space all of those
measures that tell you how well your
servers doing and you can have all of
these statistics all that data in like
the same data pipeline and you can
display it side by side and I'm
is a very very good overview of like all
healthier habits
so to recap here's what I'm interested
in to see if my app will live longer
than 4 X 5 minutes TB queries per minute
and I stopped upon the database of the
Lord to be traced where they're coming
from and how fast are getting
replacement web requests per minute if
my hat goes down I saw a search in web
traffic that may not stated all that
well and how fast am i responding to
those web requests and then at the end
health we react just like general
feel-good measures to see how we're
doing and that's how I ended up looking
like on a dashboard for one of our maps
and this is by far all the data that I
have at my disposal this is just a quick
glance overview of hard living right now
and you can see you top left you know
average response time it's a nice flat
drop we're happy on behalf of trooper
Jun and you can see that it's actually
kind of high it's a hundred milliseconds
for Phoenix have that's ridiculously so
awesome
you can see that the reason is that the
average every execution time of the
right hand side is pretty much the exact
same numbers so we ended up adding one
millisecond compare call to the prayer
execution time what this is my
development laptop and I was bombing it
was requests normally this is an old
FASTA the end that I was measuring here
and production has never written
response time of 15 milliseconds and
we're loading live data requests per
minute again like if that's searching
searching then you know for those people
accessing our side right now
it's just nice to have all the things
imagine side by side so you can
if something goes wrong what goes wrong
and where but they have memories that
shear this is also why you want to see
nice fat grass there's nothing spicy so
I'm not allocating memory and leaking in
this is the I think they have run queue
so how many messages are not currently
waiting to be processed this is also its
limit despite him of this because it was
my laptop you can actually see it never
went over eight things that want to run
so this is all you see we're very happy
and then you see system note on the side
so there's all this data that I can
collect and that I can put in context
with what I'm doing right now at mine at
in my application and it's all bad I
suppose and I'm going to say that again
I was super afraid of the lack of
monitoring I used a talk that was 25
minutes burden and integrated XO meter
and now I have something that I actually
like better than a lot of the suppressor
service tools I had at my disposal
before and I do an attempt to write a
couple of Jason's name not post about
how to integrate those statistics I will
have to just trust me at this one where
I'm saying it was really not that hard
it was very straightforward actually
meter is a little bit complex to
understand the beginning but once you
get like the concept it's super
straightforward to integrate now there's
a couple of like ongoing challenges that
I'm still looking at I'm working with
actor and Phoenix now not 1.0 yet so
there are sometimes changes that make me
have to change my code which I ain't him
now seriously there was there was a
couple of things that were Brett
breaking changes where I had to change
it but that's expected with some
preach 1.0 but it was none of that bad
like it was amazing called stable the
team kept Phoenix a nectar and how
they've changed actually required to go
up to next versions of it
I wanna spread the word I want to have
more people understand how amazing this
is and how well it works and like I said
I hope I was able to prove to you that
it even works well for just like
standard web applications I'm not using
WebSockets here like this is not a very
religious specific applications is very
standard and it still helped me a lot to
use this here language of these new
tools and would be awesome who solve the
sub graphs all the things that we did
where as software as a service and just
bad for people who want to teach we want
to get started with it and there's a
couple of challenges and I have them on
my gutters slide we went with the
standard nginx configuration of Amazon
and it crashed because the problem is
the earliest is stable I was able to
open up connections and connections and
connections and the other was just like
that's all you got
well then today's run out of file
descriptors we never have a problem Ruby
like who people regard to engine
accident anyways there is no worker
Olivette no file which limits the number
of five scriptures of nginx opening up
and then there's a worker processes that
nginx huh has that you can't have it so
you might want to look at those
configuration we'll have you smell just
go with the standard
what fire service that's what happened
it's I think it's a fair assignment or a
leg problem like you can do so many
things
you're harassing hunt like there's a
fixed number of open ports that you can
have about the work cos it's not a
student says that's done the funny thing
is if you have exhausted all of your
fine descriptors to conversation do it
anymore
that's probably what unifies turns out
Amazon is capturing the suspended in
from docker and writing into a non
rotated block fire to his only five
hours to expose all the distress as we
have with that one month why we went on
this is this was mentioned early on it's
super stupid but I didn't I converted
you said pretending yes thank you I need
that actually monitoring that we just
saw one of the statistics that I collect
it's how much memory do our allocate
vadimus I don't want to have that a
flatline if you don't do it there's a
good chance you're doing the same
mistake that I did this is a dumb for
everybody who has like that in early
background called moment and wonderfully
experienced but I found out that using
OTP even within a web server is a really
good idea there's a lot of things that
help you if you use FTP my example was
I'm talking to Reverend Q and I started
doing that out of every request that
came in well find his purpose
I was opening up with lots of work but
next to remedy cute rabbit she was fine
with it
the Marion was fine with it the US
didn't like it so I created an OTP app
that happens it's the communication with
revenue cube and then I communicate
through that our TGIF and kind of throws
the amount of Corbin keeps a consistent
amount of connection service to refer to
rather prevalent here so use OTP
remember is are they a binary data
collection I'm not going to go to that
too much but you are probably producing
JSON responses those are the blocks of
binary data if you send them around
between processes just be aware that
Ireland has a particular way of
collecting that memory bag and it
sometimes doesn't work as well so I know
this is a very unsatisfactory
explanation of what's going on but just
had that in the back of your mind when
you sending binary you to atrocities we
are almost appear to results what did I
get well I'm going to go ahead and say I
wouldn't have been able to build this in
Ruby the concurrency that's going on the
real-time scalability we have a lot of
experience skating Ruby but it almost
always entails having some kind of
caching in the treatment like I hope
you're honest like I hope I was able to
convey earlier did work for us
it worked extremely well Athenians
minutes there we have a very complex
merge lists we send them back in less
than 50 milliseconds and it actually
turns out that it's simplest is 30
milliseconds so you can see that like
the difference between a simple response
and a complex response is not even
double in size so you know I'm doing
like five times as many things like the
simplest has to be billed for the
complexes as well right so it's a part
of that and I'm building a 1 to 5 and
I'm doing that all at the same time it
turns out the response times I've nearly
the same and the look at that time spent
waiting for pause-press to semi data we
have kind of penguin
that's just the way it's gonna meet we
have a very high test coverage in
banking very maintainable code that's
not because I did it it's because I had
a two side that allow me to do it like
all of those extra upgrades and Phoenix
upgrades were very straightforward
because I just changed it waited to all
my tests were green again this is
standard for somebody who comes on a
ruby land it should be but there's a lot
of other languages out there that don't
have that kind of ecosystem that doesn't
allow you to write all these tests in
such a straightforward way and that's a
really big deal if you're working with a
lot of people at big web project so very
high test coverage very maintainable to
offer code we don't have run timers
anymore because the compiler catches one
that's amazing if you come from
scripting language and it's extremely
stable we weren't able to set so many
requesters that it would go no
everything else would like the entire
thing would fall apart but the Phoenix M
itself was just cruising along being
okay that's all you got and then again
if you scale up the database by
slavery's you can make that actually
perform as well I gotta make the point
that a functional programming language
like Linux is perfect for standard web
applications like I just explained one
and the reason that I'm saying that is
functional programming language is
normally work in a way but you put data
into in one end and do bunch of
processing you spit data out of the
other net-like that's if I understand
correctly functional
not for you turns out the web
application is just that you put in a
request on the one hand and you return a
response at the other on the other hand
and I want to have for the same request
the same response every time and that's
very testable so for me as a ruby
developer the thing that probably I
enjoyed most with the testability of the
code that I wrote because functional
programming languages are extremely easy
to test because there's no side effects
for the function and therefore it's
perfect for web applications because you
always have this request response cycle
and I'm not saying that it's not perfect
for all the other things that you're
seeing it obviously was with you for
that as well but it's also suited for
good I'll just reach the request
response cycle of applications so using
Phoenix using an excel using ecto using
that incredibly persistent rounded and
non-us build that time and it was but it
fast it's secure it's reliable and I am
very convinced that even though I had to
learn to program an elixir and figure
out the problem saw that you just
thought I wouldn't have been able to do
it at the same time to me that's a sign
first point most important I'm not very
smart if I can do it anyone else can
this I guarantee you that so what did I
do to get it done I use the elixir name
channel I use the Google Groups the
documentation of the resource is wrong
that are amazing and all of these things
you have to have
have at your disposal and if there's one
thing that I want to like give Reyes a
message it's like don't hesitate to ask
questions I ask the stupidest questions
and everybody was always super nice
responded and it's also a promise for me
so using Phoenix using an exam as I was
deck but others to build this product it
worked really well and this entire talk
was pretty much as a sales pitch we'll
go ahead and use it at your hiding
tonight thank you for attention
any questions just love them as well
for exceptional monetary there's two
things one we don't have many exceptions
it turns out that having a simple
language produces way those exceptions
because code is very more predictable we
right now have a not file atomizer that
just looks for her and sends us to them
because there's about one a day or so
that works fine
I did see other there's a clock that
catches hours and then uses I think
bucks a night for error connection so
there's a box neck plug that you can
just put into your list of plugs that
way to let the stars for you and central
device back we'll probably do that at
some point what I just didn't eat at
this price and that's again not because
I wrote decode that because the other
because sister just makes it really easy
to write code that doesn't crash you
shouldn't make it as well it's not the
operating process on either side they
should probably do that to see your
attention
when a great in you a great indication
the first thing I do this device to my
file I we don't have a health education
or that kind of bothered care but I saw
that there's a plugin for Phoenix that
gives you this pretty much device like
authentication with all the rods and all
the controllers and all the views so
there is like a device clone and I'm
probably doing it adjusted by qualified
you device for Phoenix all there already
but yeah jota's probably wants you to
Jocelyn right now all the cool things
that we heard well-liked xrm the clock
radio reloading all that we don't really
have to do that because we can just we
have a note by the Sun we can just swap
out what's going on the backend or a
persistent connections I'm not saying
that's not a good idea to maybe do it
another regardless but right now we'll
just have docker images that we spin out
and then we reconfigure the load button
so to pick up those new chopper
instances
I need you so as soon as I find some
free time but just like the univer fine
I also don't on writing one so right and
I guess and I think I saw something
already there's just lots of your
Phoenix it gives you like every
community college education and it's
super straightforward to right above
education cannot to like we have our
custom way of authenticating so it's
going to talk to every rocketship
requests you know what I'm saying
I just I just wrote a clock for it and
it's like I said this architecture that
everything's been good on just allows
you to do these things really really
straightforward with very little time
anyone else
you mentioned pulled walking and
coverage like there is think their
secret controls play plugin if I'm not
mistaken there is definitely a code
coverage metric measurement package I
have forgot what it's named like yes
okay I'm gonna I'm gonna repeat that
because I'm not sure that everybody
understood it so the thing that I
thought was a Hank Paxton hex package
was actually builded to language so mix
comes with the task I mixed top test - -
coverage is that right yeah these tests
- test coverage will give you a code
coverage report if it's not nice enough
for users conference integration or
something like that actually the way
with documentation German development
that it's kind of possible with elixir I
ended up like writing the tests and the
documentation for write growth functions
so but so I never really have to like go
back and write tests for missing piece
of the code because I always tested them
first in the world like all those
questions do you want to write a review
on the next application and an
experience that of rails and does you
know it is because of
I raise a lot of questions we have all
those library stuff through so listen
sir
then would you actually switch to the
next repentance in every case so I I was
about to repeat that question which is
stupid because he had microphone the
answer is I just was not accompanied
with a couple of friends and I kinda
want that company to be successful and I
put all of our banking services in
Phoenix and Onyxia so that pretty much
positive very positive question the
reason is that the lack of packages was
never a problem
it is also to have as many languages as
Ruby does and I'm looking forward to
having more Phoenix packages in sorry
there's more different packages but it
was never big enough of a hurdle to make
me want to go back and I still love Ruby
and rails I think it's great software
that can do great things with it parts
of our new system isn't Reyes we have
the use authentication service and
andreas because we have service or heard
or if in architecture we get to pick and
choose every piece of and language for
every piece of the architecture and it
was just at the time more straight
floors use greatest for youth of
education but it's like 2% of the entire
stack that we have everything else is he
takes one last question and a note on
the library I think
grateful for non-human libraries because
it's a signal they don't need to write
as much code
he has revisited the language that
provides everything and you have me if I
could you don't have a brightness in
this man in the world that's very true
and that's a good closing argument most
of the things that I would be as
packages in Ruby are already part of the
language in elixir and the packages that
are out there I just so good that we
don't need more many of them you just
include ones and we have those already
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>