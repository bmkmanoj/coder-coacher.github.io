<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>18 Months of Elixir in Production at Bleacher Report | Coder Coacher - Coaching Coders</title><meta content="18 Months of Elixir in Production at Bleacher Report - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>18 Months of Elixir in Production at Bleacher Report</b></h2><h5 class="post__date">2016-07-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AdY5AfXs7aw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to the online
solutions monthly webinar my name is
Martin will exceed chairing the VP for
the NIR region here at erlang solutions
today's webinar represents a
continuation of a series of webinars we
have been running across topics of
interest in the world of elixir and
Erlang and dealing with solutions based
on the elixir and Erlang programming
languages today we will be hearing about
Bleacher Report's a division of Turner
Sports and the second largest sport
website in the world at peak bleacher
report deliver over 1.5 billion page
used per month and serve over 200,000
concurrent requests to their mobile apps
alone now region report have been using
elixir where the language makes sense
and two significant outcomes details of
some of which will be discussed today we
will be running this webinar live so
there are any technical issues then
please bear with us as we'll try and
rectify them promptly to start by
telling you a bit about erlang solutions
we are a products and services
orientated company completely devoted to
the elixir and airline programming
languages and technologies based on
elixir and Erlang we specialized in the
entire elixir ecosystem we also provide
elixir and helix training courses so if
you are keen to learn then please do get
in touch we will be present at the
elixir conference in Orlando this
September so if you happen to be there
then do come and say hello just to
mention that early bird tickets are now
available for this event so if you wish
to use this opportunity to attend at a
lower cost then you're welcome to do
that we are headquartered in London we
have offices in Stockholm Krakow
Budapest San Francisco and Buenos Aires
and there's just over 130 people at
airline solutions at the moment I'm very
pleased to say that our speakers today
are Dave marks the senior director of
engineering and Ben marks the lead
engineer at Bleacher Report's who have
been running elixir in production for
the last 18 months
we are truly and deeply privileged to
have Dave and Ben speaking at this
webinar and I must say this is a very
visibly illustrated by the audience
numbers present here in their hundreds
today now I'll finish by saying you are
most welcome to post questions
throughout the duration of the webinar
by using the chat facility on the
webinars interface our speakers Dave and
then we'll answer as many questions as
time allows at the end of the webinar if
any questions do go unanswered you are
most welcome to raise them by email
using the following address webinar at
Erlang
- solutions comm now if you're
interested in learning a bit more about
elixir or wish to establish whether it
could be a solution for some of the
challenges your own business may be
facing and by all means feel free to
contact me directly my email address
will be displayed in one of the final
slides of today's presentation I would
now like to hand over to Dave and then
who will be glad to start us off I am
Laden thank you very much both Ben and I
are very excited about the opportunity
to be here and share our experiences
adopting a lick sir over the last year
and a half year please report and we
thank all of you that are joining us
today to hear some about that so this
slide here is Emma Laden said they've
marked senior director of engineering
here bleach report I'm joined by Ben
marks our lead engineer and here's a
little bit of information about the both
of us
I've been with Lee's report for roughly
two years now and been joined a little
more than a year ago to help us
specifically with our initiative around
elixir so just to provide you a little
history of bleach report for anybody
that's not familiar bleacher report was
originally founded back in 2007 by four
high school friends that wanted to
create a platform that would really be
the voice of the sports fan and what we
mean by that is a place where fans could
not only consume but create content
around their favorite teams and not
necessarily just the major teams that
oftentimes traditional sports
let's would focus around over the the
lifespan of bleacher report things have
evolved and right now Bleacher is
somebody that's providing an
industry-leading fan experience one that
really allows fans to consume the best
news and content available for their
teams along the way to wear bleacher
report is today there was a lot of rapid
growth that was experienced and a lot of
that can be attributed to bleacher
leadership recognizing and capitalizing
on market opportunities when I look at
historical bleacher report traffic
there's some some interesting inflection
points that can be attributed to those
opportunities the first one was Google
search really being one of the first
sports sites to focus on SEO and
recognize the importance and develop a
strategy around that from there they
rolled out their newsletters a few years
after that and again drives a lot of
traffic back to the site something that
the site certainly had to react to to
handle team stream which I'm going to
talk about in a minute
which is our mobile app the release of
that again saw exponential growth in
bleacher poor traffic and in recent
years a lot of it has been driven by
certainly are a lot of social traffic
driving us traffic and then our adoption
of social platforms as a distribution
channel so you know I would say when I
first got here bleacher report and I saw
what was going on there very much still
developing within there there monolith
or the the original rails platform that
was developed going back eight years ago
and this is nothing new for anybody
that's that's gone into startups that
have experienced this type of growth
it's commonplace to have a monolith
right where you kind of bei borrow and
steal to support the growth of the
company but along with that you incur a
lot of technical debt there's a lot of
to dues things we'll go back and we'll
fix that later
there are knowledge gaps
they're only one developer has
institutional knowledge around a piece
of functionality at best and then
certainly as Bleacher Report's focus
became more on mobile where the majority
of our traffic is change has had to be
made to the platform to support that so
again nothing new but when when Ben and
I were getting involved it was around
the time that we're really looking to
break down monolith and think about the
next-gen architecture of bleacher report
so to talk about team stream no doubt
this is our most strategic asset the
majority of our traffic does come
through team stream which is a native
app available on both iOS and Android
it has a live stream of content based on
the teams that you're interested in so
when you first download team stream you
would go on select in this case I'm
interested in the Patriots the Warriors
and the Yankees and then the information
that you see when you log into the app
is catered around those teams in your
interests as well as you know certainly
just general breaking news in the sports
arena the streams that you see when you
actually dig into these teams are unique
lists that feature a variety of articles
and media produced by both VR and also
spanning the web and social platform so
you can think of it as one-stop shopping
for the teams that you're interested in
you no longer have to go to the local
newspaper and follow these twitter
accounts you can come to team stream and
see the best of what's available out
there it also delivers news alerts
around both breaking news and just
points of interest for those teams that
you follow and then certainly scores
scores and stats team stream itself
presents some interesting technical
challenges when at scale on that stream
of content that you see when you first
launch the app is both real-time and
personalized for the teams that you're
following which means heavy merging and
sorting on demand this doesn't lend
itself to an aggressive caching strategy
so it certainly tests any technical
implementation that you have especially
a time
times of high traffic and that can be
frequent right we are within the sports
news cycle and you never know when
something is going to happen that's
going to see a significant increase in
our traffic going back I think back to
just July 4th two weeks ago when some
news broke around Kevin Durant coming
here to the Golden State Warriors our
traffic literally doubled in probably
five to ten minutes that was news that
broke it about 8:00 a.m. local time here
in San Francisco and again you have to
have a platform that can support that
sort of burst of traffic so on top of
all this our content is time-sensitive
we have to enable our content
programmers to alert our users and then
display that breaking news around their
favorite teams and what's going on and
above all else we just need to be fast
so taking a look here at some of the
numbers of where we are today
for starters team stream has 15 million
app downloads we do roughly
one-and-a-half billion page views for a
month about 16 billion global page views
over the last 12 months 250,000
concurrent users at peak that particular
number was actually goes back to the
LeBron decision of a few years ago if
anyone remembers that and then we send
over 3 billion push notifications a
month to our users I guess I'm going to
talk about why elixir was chosen and a
brief history of how Worcester Kings of
leisure Report um as as David mentioned
we've in a rail shop since the founding
of the country and we're having to deal
with all these different strategies and
increasingly more complex caching
strategies to try to get the rails apps
to do we need than to and with we kept
throwing one more money at it and it
just it wasn't a long-term feasible
strategy so there are some other
languages that were looked into go was
looked into knows looked into and then
one of our engineers at the time was a
guy named Michael chef Meyer and he
stumbled upon elixir
and elixir for those who don't know was
was created by Joseph Allen who was a
rails core team member and as such
elixir is the combination of the Erlang
medium along with though with Ruby
syntax so it makes barrier to entry a
lot lower and and because Josie building
is such a respected member of the
community and and the rails community at
the time Michael started developing a
prototype and all of these listed it
would soon became towards an ideal ideal
solution for us in terms of concurrency
which is what we need when we're dealing
with all of the with the traffic
especially with the fluctuations of
traffic we need to handle on we need to
be able to handle on peripheral traffic
spikes we by allowing us to get rid of
these complex caching strategy and mego
code much simpler and there's built on
top of the of Erlang and darling BM and
well elixirs a new language that the
game has been around since 1992 it's
been used all over the world and it has
a lot of interesting tooling the that
elixir gets for free like the observer
and we started using this one eighteen
months ago so elixir was a very new
thing and there was a chance that elixir
might not take off but the the concepts
that early had been them they're like DM
itself it'll still be around and we
worst comes to worst we can switch to an
early I'm shocked because we would have
understood the Erlang being I can use
elixir but given the the recent success
of elixir and over the past few years at
the elixir come then the numbers had
almost doubled from about 150 to over
300 last year and I from what I hear the
elixir pump in the US this year will be
even more than that so it seems like a
luxurious doing for a while will be here
to stay
and then so my background I don't remote
computer science degree but I studied at
a little bit philosophy and economics
and part of then a little purple SP is
what logic and meta logic and these kind
of things and so I was actually
introduced to functional programming
concepts and in philosophy courses so
when I first start
with with elixir I was or function part
of my general I remember my days of the
college and gone found this functional
programmer approach to be much simpler
than object-oriented it allowed us to
approach problems from a new direction
and in the sense that you only have to
worry about transforming data through
functions you don't have to worry about
inherent and these kind of things it
makes it a lot easier to reason about
these kind of things and then as I
alluded to earlier
josÃ©e Valene being a core member of
rails brought a lot of the Ruby syntax
into elixir along with f-sharp pipe so
it made it made the transition much less
scary I think had Michael trying to
bring Erlang into bleacher report it
would have been a much more difficult
sell because the syntax
well the concepts are the same the
syntax is very difficult is very
different and can be difficult for
developers to take that on and and you
know developers are like everyone else
in the sense that we like to do things
in a way that we're used to doing it and
bringing in a new language with the
strange or different syntax wouldn't it
would have made it much harder to adopt
so we were able to sort of slide Ruby in
our slide elixir into interglacial
report because of the similar syntax of
Ruby and this also sort of carried up a
kind of odd in the sense that we were
writing Ruby ish code in elixir and
that's just something that we were able
to work with over time um let's see
so we inducted it very early as I said
and in fact the first version of the
Phoenix framework that we used which is
the web framework it was 0.5 - dev and
it was at such an early stage that there
are no guidelines for the development
and do what it feels natural which is
quite a quite it's not exactly a
confidence firing mantra for a
production framework and at this point
it was variable choice we've done it at
a very early stage and ecto which is the
sort of the ORM of the phoenix and the
elixir world at that point and say at at
that point
it was changing so often that when you
went to the Phoenix starts it's had to
go to github to look at the echo dots
because it was so unstable and so many
changes were occurring and then this
will give you an idea of what was going
on in Kings at that time this was our
first met for our first app and elixir
in X was a nearly two years ago as I
mentioned in the excursions 0.5 - dev
and f2 0.2 point 5 this was before you
can change that's where around in the
model data relationships weren't very
well defined which led to some sort of
suboptimal patterns and at least if
literature had reached 1.0 um so that
this was where we started with that and
as with with things pretty 1.0 there are
some advantages and disadvantages um the
biggest avenge was that we were able to
grow with the framework and that we had
to we had to follow along because it in
those early stages new new releases
happened almost weekly and we were at
one point we been behind the two
versions and it took a lot of time and
effort to get that up to date with that
so this encouraged us to constantly
refactor and to grow with the framework
which helped us to improve both our
understanding of things and elixir as
well as to write better elixir code and
this also sort of ingrained in us the
the idea that you have to in order to
adopt new language you have to to
constantly factor and and because of the
massive amounts of technical debt that
we've accrued over the last eight years
this is helped us to set a president the
precedent that says we will do our best
to minimize tech debt and and as you
might imagine there are a number of
disadvantages to adopting anything
pretty 1.0 which is the unpredictable
release schedule which means that it's
harder to plan sprints when you don't
know how often things want to be
released the magnitude of changes in
releases can vary and with three one
I know especially with ecto we had to do
some so optimal design patterns in order
to get things that way that we wanted to
do and they worked but they didn't work
amazingly well and that led us to later
have to refactor and revisit these
decisions and and the nice thing about
all this was it it sits on top of the
beam which takes quite a lot of which
takes care of a lot of these things for
you so even if you're writing so optimal
code it still performs very very well
and then phoenix 1.0 was released about
a little under a year ago I believe on
this meant that da guy wasn't going to
make these batch breaking changes that
we've seen over the past year before and
the relief schedule is much more
predictable there's a you have release
candidates and all these things so it's
not it's not the same surprise that one
day you come in there being diverting a
Phoenix or actor or whatnot the mature
lot more mature libraries both on the
Luxor and Ireland and since selector is
system Tolliver user Erlang libraries
with elixir and one of the one of the
more difficult things about dealing with
elixir and Erlang libraries over the
past two years has been that the
dependency resolution was quite
difficult because one library would use
one version another library another
version and they would speak to a lot of
dependency resolution management but
that's that's become much easier
especially when there are elixir sort of
wrappers for Erlang libraries that take
care of the dependencies for you al
examiner being one of them and then with
Phoenix
they have exciting new features such as
phoenix channels and phoenix presents
and then ecto 2.0 is it was just
released and it's a very exciting
release in the sense that it's moving
away from the MVC pattern that that was
sort of adapted from from rails and
other frameworks and is starting to talk
about more functional
concepts in terms of terms of data
structures as opposed to models and
these kind of things so that's been been
very good and very nice to grow along
with that
so this is the app lifecycle of our
first app in Phoenix and it looks good
and as most absolute life cycles where
this is pretty common
you have the exploratory of days and in
this case the exploratory phase was we
had this problem the problem was is
there this emerging apps work fast
enough so let's try elixir um this it's
I mentioned before the active had no
change that so we were doing very
interesting things in in order to
manipulate the data which weren't the
best ways to do that um began because of
that because Actos data relationship
model and data relationships were
incomplete
we had to this was just a result of that
and we will revert a lot of Ruby ish
code in elixir and in terms of adding
these inter actors which are sort of
rails and Ruby concept and that don't
really belong in elixir or Phoenix and
but it worked
it gave us the confidence that we needed
to move forward so there's a sort of a
dry spell the definition phase where no
code was really added or deleted and
that was the time when we said hey but
we had this we had this concept it seems
to work well and then we turned to
product and said how are we going to
start breaking apart this this
monolithic app and one of the features
that you need to let us pull this out
and to give us the Minimum Viable
Product that we need to put in a
production and the drive to 1.0 actually
had a lot of interesting times in it not
only was it our this was our first
release into production this was also
Phoenix's release of 1.0 Aptos release
of 1.0 elixirs 1.1 release which meant
that you can see over the over the
course there are more additions and
infraction that we're adding the
features that product wanted and we're
also there are a lot of there's a lot of
churn because of the changes to ecto and
feening
um but at that point it was released it
performed very very well we were we were
very surprised very surprised though we
were we were pleasantly surprised that
everything went as well as it did
because this was our first foray into
functional program is the first foray
into elixir in Phoenix and it was doing
things that we were not we had not
expected to do I mean a Riverland we
first started with a monitoring library
called X ammeter to monitor our data
with stat Steve I was sure that we were
doing something wrong because the CPU
use the memory use were so low and they
never buried even when more traffic was
hitting this the servers but that's just
one of the many benefits of the of the
beam and as Dave alluded to earlier we
have these different content types
we have articles than we used internal
and external articles and various other
other media types and at that point we
had about seven content types and it was
it wasn't easy to to add a new content
type because of the limitations that act
that we had carried over from ecto so in
at that point we are very happy with the
way that the app was performing but it
was still we are still learning and it
was difficult to to see how to add new
content types and product requirements
are pretty frequently adding new content
types in new ways to interact users and
so on so this was one of the drivers in
the reflector it refactoring stage was
how do we make this more extensible how
we make this the foundation for going
forward um and part of that was that we
stopped writing Rubeus code and elixir
and started writing functional code and
elixir you can see these two massive
spikes on both the addition and deletion
and fortunately the deletion spikes are
bigger which means that we were doing
more things with writing less code and
we stopped thinking in terms of content
types being backed by models and started
thinking content types is just data that
flows through pipeline and the way that
we were able to do that very simply is
to use
use the echo-chamber sets and to
validate based on the content type in
these kind of things which made it
incredibly easy to add new content types
and we have about 15 types now and we
added so many so quickly that the people
who program the content are still
learning how to use them because it now
they have an abundance of choice a
luxury of choice another they're not
exactly sure how to use them the most
effective if again but but this is a
good challenge for them to have and and
it also makes it incredibly easy to add
and modify these types because we made
may you design them in such a way that
it takes about 20 minutes to add a new
content type as before we take a
developer maybe a day or two and you had
to do all of this battle modeling and so
on but now we've using changed edits
it's been incredibly easy and it's also
this is when new developers are we have
we have mainly Ruby developers and we
hire Ruby developers and transition them
to mature developers and this is a way
for us to show them this is how we
develop app set at which report this how
we do adopt new language new framework
iterative iterative development is very
important if we tried to write perfect
elixir code we still wouldn't have it's
in production our lecture produce is
very good I think and but it wasn't very
good at the beginning and we just have
we've had the luxury of being able to
devote to to iterate over this many
times and and now we're very pleased
with with this and our developers are
also pretty happy with developing fixer
yeah five you said one thing on that I
think a lot of credit to our our
business and product partners here at
bleach report who understood that we
were embracing a young language and you
know we've really made it part of our
culture within engineering to go back on
a regular basis and address that tech
debt that you naturally accrue anytime
you're developing something so anytime
we have a major release on one of
our elixir apps a sprint that follows or
that will soon follow will be dedicated
to identifying and remedying that that
technical that which ensures again not
only are we the best position
you know engineering wise you know for
the future but everyone can feel good
that what we've put out there is it is
the best it can be and I should talk
about some development highlights with
Rick with regard to elixir at bleacher
report um
the app then I showed the app lifecycle
graph that I showed before was
essentially our content list management
and merging app as it's we've been able
to go from is this going to hold up in
production to not even having to worry
about it and it's quite amazing how
elixir in Phoenix have made our lives so
much easier
and we don't have to worry about them as
much anymore of course we always want to
be prepared to make sure that for major
events like the NFL Draft and da finals
these kind of things that that we have
proper you know safeguards in place but
generally we don't have to worry about
it even on those nights functional
programming concepts in terms of data
transformation I've made have made both
creating new change sets and validating
those those change that's incredibly
easy with a with very few lines of code
and it's this content stream app has
given us a great foundation to build for
other apps and a model to to develop new
apps and push notifications was the
second sort of the most important app
that we moved from rails and known to
Phoenix and elixir we our older system
was pretty fast but this push
notification system is incredibly fast
and we have content programmers who
program the streams that we supply as
well as synaptic modification and right
after we released this they couldn't
believe it we literally give select
messages that say it I can't believe how
fast this works because whenever they
press the click the button to send a
notification it would almost immediately
appear on their phone and this was a
remarkable remarkable achievement for
our second foray into electron beam
accept and it was something that was
very tangible and real way to show the
business team and as well as our other
internal programmers that this is
working really well um one of the one of
the things that were able to do to make
this offensive was before we had to use
Ruby and we had to use Redis and then we
had used external third-party workers to
help us send out these massive amounts
of notifications that they've showed the
numbers for the beginning of the
presentation and now we were able to get
rid of Redis and as well as the
third-party workers so now we have just
an elixir app that uses a gender
it's very simple very easy to reason
about and one of the fun things that we
that people like to do is especially the
business side they'll have editors apps
some sport alert will go out and gamble
and something will happen and our app
will consistently be the fastest and you
know and not just a few seconds but
sometimes minutes or even tens of
minutes depending on on the time of day
and so on so it's it's a very rewarding
way for us to see that our listener in
Phoenix are arguing what we need them to
do and finally removing external
dependencies have been great um none of
us here are right as texworks but we
know enough word is to sort of do what
we knew what we needed to do but by
getting rid of Redis that means that we
can focus more it looks elixir and
teenage so we don't have to be read as
experts and ruby experts and whatever
other integration experts we can only
just focus on elixir elixir is the self
contained ecosystem the dirt everything
we needed to do and by focusing all of
our energy on that we become of our
naughty Lister's at a much greater depth
than we could be if we had to spread
them across all these other external
dependencies and services these kind of
things and also we save a lot of money
by not paying third-party third-party
integrations or third-party clients we
don't have to we can save money on the
kind of thing which is which is great
and another very tangible way to say
we're saving money this is just gamble
has been good with elixir as some NFL
Draft is consistently probably are one
of our biggest nights of the year um
everything has to go right for number of
reasons this is how this is sort of how
we gauge the progress over the year
before this is how we present to the
business team and the part team that
we're doing things the right way
um and the draft 2016 was our first
major test of our new open straps we
have a few more looks wrapped in
production but the main apps are the
list merging app and the push
notifications up
the previous year push notifications
there were some issues with sending up a
number the volume you need to send out
and we we were also a bit concerned
about always scaling enough do we have
enough elixir or if you have enough
instances of Villa trapped in production
for the content murderer as well as for
the push notifications and we we
probably over provisioned and because
the traffic look the exact same from the
monitoring tools that it did in any
other night of the year which is really
incredible when you consider that we
probably had almost about 200,000 of our
users that night and to not see any real
significant jump in CPU usage or memory
usage or RDS usage is really amazing and
it shows not only that elixir is doing
what we needed to do but that our our
knowledge of litter has improved over
the past year the push notifications are
incredibly important on the graph night
people sports fans are very particular
so essentially the push notifications on
draft night are especially important
because sports fans won't immediately
get the information and the year before
we had had some issues with ensuring
that we were delivering all these
notifications but this year everything
went through without any issues and we
sent about 200 million push
notifications just in the first drive at
night which is about five hours and
there's 10 times of performance from
last year and on the server side it was
from the monitoring side of things it
was completely indistinguishable from
another day and then for the app for all
of our likes wraps we didn't need to
dial of scale would you need to have any
kind of provisions in case something
went wrong it was just just another day
and who it really validated and
justified all the work that we put into
a bookstore in Phoenix over the past
year and a half just to talk about some
of the some of the business highlights
of elixir been touched on this but first
off just on the AWS savings site so
Bleacher is 100
host it on Amazon and certainly the
monolith again which this wouldn't be
uncommon can be a resource hog at times
and from the beginning there was always
this promise of efficiency and cost
savings that was going to come along
with with a lick sir and it's one of
those things that until you really get
into the production environment you
don't know how it's going to materialize
or what you're actually going to devise
and I'm the first to admit you know as
we have grown functionality out of our
monolith and stood up new services you
know sometimes it gets a little muddy
when you're trying to attribute
individual function individual pieces of
functionality to new services or at
least try and quantify the amount of
resources that they consume but I'm
confident in saying that some of the
functions that were the most resource
intensive on the monolith where I would
estimate we require you know upwards of
you know a hundred servers in order to
enable now run within elixir services on
five servers with has been mentioned CPU
utilization rarely going above five or
ten percent so we actually believe that
we are provisioned but again still being
rather rather young adopters of elixir
you know world caving over provision at
five servers versus a hundred were we're
just fine with that the other thing I
would say kind of in that same vein is
the liquor has proven so efficient that
it's really challenged the way that we
think about our scaling metrics one of
the things that we try and do is
understand certainly within a micro
services architecture how scaling one
service is going to impact another
service and you cannot scale elixir
based on the traffic throughput or
looking at again CPU utilization or
memory utilization because it's just not
going to waver as been said with those
traffic spikes so it's
thing that we're very actively you know
working out I would put in the bucket of
good problems to have but certainly a
challenge on the tangible saving side as
well and then did touch on this you know
as we've been able to sunset old
functionality like our old notification
system along with that we've been able
to eliminate a lot of internal
dependencies whether it was external
worker processes or Redis instances
databases whatever it is we've really
seen some significant savings there and
I think alast is just overall developer
happiness I think Ben's probably the can
elaborate on this one but you know Ben
came in and immediately adopted elixir
day one that he would he and some of the
other members of our engineering team
that had very strong bill's backgrounds
you know didn't dive in right away and I
would say the majority of our team now
has had exposure to elixir and not many
folks want to go back they really have
enjoyed I'll let you elaborate on that I
mean what days to do and people don't
like to change but you found that people
do like to change the litter in the
sense that there's the initial
contractor to overcome in terms of
thinking in terms of functions and as
opposed to objects these kind of things
but the familiar Ruby syntax helps helps
that and then having already created a
number of apps in elixir helps to give
people a foundation on which to build on
so typically for already developer who's
interested elixir we will just start
giving them small sort of features or
cleanup for these kind of things on
another app and most are amazed at how
easy it is to get up to speed probably
you know we we have the programming
textbook like Krishna cord and Josie
Lilly member state and then the
programming books or book by Dave Thomas
and that's really all they need to get
started of course we try to have more
intense code reviews more
thorough code reviews with new other
crew developers and even developers who
at first were pretty resistant to elixir
and say now you know I ruby developer
rails is fine we're still doing rails
and so on even even they find that after
the initial hub they quite like it and
and don't really want to go back to it
which is sort of an interesting problem
to have that we have all this Ruby
developers and outlets or developers and
still have legacy Ruby apps to maintain
and when we have even the smallest issue
with an app the first refrain is well
let's write it in elixir and yeah okay
we you know we get that but we need to
evaluate that on a on a more realistic
basis but it again you know elixir is
just brought us good problems as opposed
to bad ones yeah so that that raises an
interesting question which is how do we
really make the decision as we're
breaking down this monolith and standing
up these new services around whether to
use rails or Phoenix you know first and
foremost it it's a case-by-case
evaluation I would say we think long and
hard about exactly what reporting what
are the expectations as far as traffic
and scale looking ahead for the next
five years for the most part if it's
going to be a component that we expect
to see significant traffic again
something that's going to require high
concurrency then we're going to lean
towards developing it in a lick sir that
being said we certainly don't force
anybody to build things and elixir most
of our most of our back-end development
over the last 12 months has been an
elixir but it's an ongoing conversation
you know and also I mean if you be sort
of the consequence of refusing to
develop an elixir opinion ruby developer
means that you're just the project's
you're going to be working on a much
smaller and more internal apps like
admin type stuff perhaps these kind of
things so you know if you want to work
on bigger projects then elixirs is
really the way to go for us and yet we
obviously have the lead
in a book certain Phoenix and continue
to be to be more so invested in that one
of the when we train new illiterate
developers or Rudy developers going to
elixir one of the things that has helped
us do that so well is by establishing
paternity nice guidelines we have we use
credo which is if you know about it is
it's a it's not just a winter but it's
also a teacher in the sense that it will
evaluate your code but it will also give
you reasons why it raises errors or why
it raises warning to these kind of
things and it helps us to have the
consistent style across all of our apps
somehow with developing elixir I don't
know if it's just a new language or if
it's just people feel more productive in
it that the developers seem to be more
engaged and wanting and seem to to
progress that much quicker rate it's
also led to some sort of experimental
endeavors that they talked about in this
is more of just you know what if we did
this over to that we had a bleacher
report pop-up store in New York last
year there's a project called nerves or
and it's a very exciting project that
uses the competitors run devices so and
they can all do these kind of things so
that they're all these different tie
ends that you could do with physical but
the visible store and with these devices
so there's a there's a whole new world
of possibilities that have opened up
with elixir and meanings yeah and since
I imagine that most of you are either
considering elixir or at least
interested in elixir um this is how we
these are sort of though the guidelines
as to how we've been able to adopt
elixir um first is you have to ensure
that the team fit is good because if
there's one imagine if one person one to
develop an elixir and the rest of the
team was resistant it would never go
over because even if you realize all
these product productivity gains
performance gains and so on if the team
doesn't want to do it it's not going to
work out make sure that you start with
simple projects we found that
converting Ruby or other projects to
sir is a much easier way to go and
starting from scratch um of course that
mean that when you have already existing
code you tend to rewrite that code
elixir in Ruby but that's okay because
one of our other important matters is
iterative development and understanding
that new literature developers or even
experience which developers I'm going to
write the best code the first time so
just keep iterating over and over and
eventually it gets better and as I
mention before
Kratos been very good for us to teach
new developers as well as to establish a
consistent elixir style across all of
our apps um and one of the nice things
about cryto is that it it is opinionated
but it allows you to change some of
those opinions so we have our own
profile that takes most of the defaults
but changes them changes the few of them
to the way that we like them and finally
although we've been saying nothing but
good things about a bookstore in Phoenix
for the last our temper expectations
if you're a small strap you might not
see the massive performance gains that
we've seen and as well as understanding
that some developers might not like it
or that your experience might be a
little bit different but don't expect
you know don't drink the kool-aid as the
expression goes understand that there
will there will be hiccups and there
will be problems and you know we've had
it even one of the constant refrains for
new developers is well I know how to do
this in rails like attitude somewhere
else and it's like well you have to you
know there's a learning there's a
learning curve and you just have to
stick with it and eventually those you
know those are ideas and rails become oh
now I know added with this Oh picture I
don't want to go back so if you are
going to take the plunge some
recommendations we have here around
adopting a list Lichter first and
foremost leveraging the great
documentation that's available on both
the phoenix an elixir websites in
addition to the books that been
mentioned these are incredible resource
there's a very active slack and IRC
channels available for support just
about any time hopping
on there again one of the advantages of
the small community is it was really a
culture of support and certainly should
feel free to dive in their meetups are
something that we embrace here at
Bleacher we've been involved in the
elixir SF meetup for for a while now
there are also some great Erlang
meetings with certainly plenty of
overlap there I think at this point
there are elixir meetup just about every
major city so there's likely one
anywhere anywhere you are Exorcism dot
IO this is a great site not only for
just a lick Sur but also for any
languages that you work with if you're
unfamiliar with it it provides practice
problems for over 30 languages and
they're really kind of practical
practical problems so not so much you
know hello world type challenges
actually how do I really implement
something or solve a problem that I
would see out the wild so to speak and
then don't they also get a feedback from
community members as well so it's not
just right or wrong and they again they
also encourage an iterative approach to
problem solving which i think is very
good and then certainly last but not
least is erlang solutions are our hosts
today and they have been a tremendous
resource to us here at bleacher report
we engaged with Erlang solution shortly
after that first production release and
asked them to come and really spend some
time on site with us here in San
Francisco reviewing our systems really
embedding with our engineering team and
educating them on the best practices
again to ensure that we're getting off
on the on the right foot it's proven to
be incredibly valuable and it gave us
further confidence in the work that that
we had done and the direction that we
were headed and to that and we continue
to engage with Erlang solutions on a
regular basis we look forward to having
their consultants come on-site with us
review the work that we've done since we
last saw them and certainly again ensure
that we are hearing to the best
practices
and building things the best way that we
possibly can and I think that you know
today our credit this is something that
can be intimidating to to internal
engineers when you have you know
consultant come in and I would say that
you know the folks that we work with
have meshed very well with our team and
this is something that has really been
embraced by the entire engineering team
here and they look forward to the time
we have people on site to work with them
yeah those are nice just to having
worked with them in the past is to when
they evaluate your code to not to say
that it's good code to say that you've
been proved or these kind of things so
it it's nice to have that external
validation especially since I guess
traditionally our link solutions has
been you know all Erlang they've been
especially helpful when dealing with
lower-level issues with talking about
the beam and understanding the internal
processes and something you know as an
elixir developer you don't necessarily
need to know but it's been really
helpful to get a much deeper
understanding of how the VM works and
it's been really great to have that
external validation so that's about it
for us up at the top here there's an
email address that you can send any
questions that we aren't able to get to
over the last 10 minutes contact
information form laden Ben and myself
and certainly feel free to reach out any
questions that that you might have about
anything go ahead Dave and then thank
you so much and I'm sure everyone else
will join me in thanking you for a most
inspiring talk on your use of elixir and
your achievements with Alexi to hear
about use of an emerging nascent
language at the second biggest sport web
site in the world and with elixir
supporting mission-critical use cases is
trolling cycle and I think will motivate
much further use of elixir but just to
briefly reflect on the final slide if
you are interested in learning the leaks
here and picking up elixir as a skill
then we have some resources online for
you you can obviously attend our events
our boot camps both an elixir in Phoenix
and finally if you're interested in
triangle ixr out yourselves and if you
need a bit of help in terms of
consulting and development then you're
welcome to drop myself personally an
email or use this email address write to
us let us know how we can help but more
importantly I'd like to open up the
question and answer session and before I
do that I'd like to thank everyone for
an absolute avalanche of questions that
I can tell you now that there is no way
we can answer all of them in the time
given so it will be as efficient as we
can and try and honor as many of our
members hold the audience as we possibly
can but I can also tell you that all the
unanswered questions we will answer in
writing after the webinar so again to
try and answer as many as we possibly
can I'll start with the first question
for Dave and Ben so Fernando one of the
one of our audience members is asking
why did you use elixir instead of
playing Erlang and if you had time to
learn one beam language would you go for
licks here or Erlang and why and we
decided to use elixir because we're Ruby
developers and when you look at it I've
always had this sort of an interest in
functional programming and I played with
Scala closure Haskell in the past and I
never bored with Java so with closure
you had to learn the closure syntax the
functional programming concepts as well
as the sort of peculiarities of the JVM
and with elixir since we already knew
Ruby we only had to learn functional
programming concepts so it was I think
the barrier to entry was a lot lower
Erlang syntax is quite different and can
be very intimidating and especially even
and even though the doctor the other
line documentation is very good and very
thorough but it can be quite
overwhelming for someone and the elixir
documentation is also much as a much
lower barrier to entry and with regard
to the beam for most illiterate Avella
pers you don't really need to know that
much about it if you don't if you don't
care to because it handles things so
well and
I think that is people become more
experienced elixir developers of course
are going to want to learn more Erlang
so I'm spending the spare time that I
have to learn more our length but for
developers who just have a cursory
interest in using elixir I don't know
how you need to get into thank you for
that Ben now again I must find our
audience we're being absolutely buried
with questions what we can promise is to
answer all of them if not now then
answer the webinar and right now we will
answer all the questions in the order in
which they've received so straight on to
the next question for you they can then
Amanda one of our audience members is
asking what is your database setup which
accompanies your elixir setup so
traditionally going back to the monolith
bleach report utilized my sequel running
on RDS again within the within the
Amazon world these days all of our new
development will relied on Postgres on
the back end which we believe is it is
more performance just to kind of thrown
that out there we can talk about that
for an hour bill and also used ETS
tables a bit which are the Erlang term
storage you can come as part of our
length and we've where traditionally we
use Redis in the past we've used guest
tables and it's you know like a lot
easier and there also we because things
are running so smoothly we wanted to use
ETS other places but we don't really see
the need for extra caching so it is so
post rest and ETS are sort of abused now
yeah and one other thing I'll add there
that I think is is interesting we've
adopted as a best practice putting a
fastly CDN endpoint or service on top of
all services that we put out there even
if that means having a TTL of zero which
we would have to have for example for
our for our content stream right given
the dynamic nature of the content that's
being served but having that CDN in
front of it provides us not only
shielding if for some reason we would
have an issue that caused the service to
stop performing maybe based on an
external dependencies or also
just requests collapsing itself has been
a huge benefit so that alone has
eliminated a lot of need for for
external cashing even in cases where
perhaps we could we could benefit from
it really moving that to the CDN layer
thank you Dave and Thank You Ven
I can tell you we're receiving about
five questions in the time it takes us
to answer one so clearly we will have to
answer some of them in writing but
thanks to everyone in the audience for
asking them moving right on to the next
question and here's a really interesting
interesting one from Phil Phil is asking
one of the main gaps I've seen where the
licks here is a de facto monitoring and
metrics solution now you mentioned an
elixir meter plus stats be set up but
how do you handle alerting and the more
nuanced things the tools such as New
Relic providing the rails world if you
like I can repeat that but effectively
kill is asking how do you handle
alerting and the more nuanced things the
tools like New Relic providing real as
well we've used accelerate has been a
really good solution to press we also
use bug snag to give us served our
reporting and we've been working with
Erlang solutions actually to use wombat
which is there sort of all-in-one
monitoring tool and it's when we first
started with them I don't know there
wasn't a complete elixir in Phoenix
support but now there is and that's been
really great to us because you can also
see that you can see all of the all of
the networks of the beam so you can
basically get everything in there
without New Relic of these kind of
things and we use data dog as well so
all of our metrics are type two data
done and once the integration with the
wombat we'll be able to fight those
accessing data as well so while we don't
have all of these sort of niceties of
New Relic we have been able to cobble
them together in a very effective way
thank you for that then and I would
recommend if you're interested in
monitoring on an elixir or an airline
system then by all means check out our
webpages look at one that IO am
and see if it fits your particular needs
just moving on straight to the next
question for Dave and Ben so we have
Stefan asking could you discuss in a bit
more detail how you went from data
modeling your data types to taking 20
minutes to deploy the data types sure um
so we originally thought a content types
as model as TV backed models and so that
mean you had a table for a post put
podcast or external article of these
kind of things
and that meant that every time that we
had to do a new content type we had to
think about the model relationship we
had to do migration we had to come up
with all these functions or in the
regular role all these methods to
support and validate this data and then
I didn't really touch on this too much
but in the refactoring stage with all of
with those two graphs of additions and
deletions that was when we tried these
different ways to model data and we
found that if we look at content types
as sharing similar attributes in terms
of you know there's a generic part of
the content that all content temps have
there's parts that are metadata parts
and they're spots that the programmers
edit if we think of it in that terms we
can make them much more generic and then
you can use the change that's to
validate those so we're able to order
this above a number of database tables
and a number of models or modules in the
elixir world and by using change sets
you just pass it through and you write
functions based on those change that's
and that makes it much simpler to do
without any database migrations at any
other additional for the fake code thank
you for that now we formally breached
our webinar time but because we received
so many questions we simply have to
honor a few a few more of them if that's
okay with Dave and Ben so we'll just
joined one thank you we'll move straight
on to the next one we have an audience
member asking
would you comment in a bit more detail
as to how your hosting is set up on AWS
is it one server running everything is
it a lot of services and how do you do
security between servers we're talking
about multiple services yes so a good
question
we are indeed running multiple multiple
servers for the database layer as I
mentioned we're running RDS as far as
the deployment of our liquor apps were
leveraging docker with elastic Beanstalk
on AWS which has proven to be successful
for us both in terms of again the
ability to scale as well as some of the
other niceties that it has as far as
security between servers again this is
something that we could dive a little
bit deeper on but we've gone with a Jets
model that we believe is it's the best
approach for us thank you for that day
now here's one that's very familiar to
people in the world of Erlanger and
quite a hot topic an excuse excused upon
Marian is asking do you use hot code
loading in production and if so can you
share in what context you might be using
it oh okay this is something that we're
working towards right now we as a
mission we used offer an elastic
beanstalk and it's not a hot code
reloading but just like with the
development side of things the outside
of things is a we're trying iterative
development or iterative ops deployment
I guess the way things are working
pretty well now but we realized that
there we're not taking an advantage of
of the number of things that airline
Novak's or offer um one of the things
that we want to move too quickly is xrm
which is Felix release manager so it
basically takes your application and
turns it into a small binary and which
would be speed of deployment times and
these kind of things so yeah this is
something that we haven't taken
advantage of
it's on the radar and it's just actually
because of because things are working so
well with the way that we have them now
we have other things that are that we
prior repaired it prioritized and but
you know this is something that we
definitely want to look into thank you
for that now we really have very little
time left so we'll limit this to three
more questions and I'll try to ask you
pragmatic ones that can help some of the
elixir sort of newbies in the audience
now just to ask a question coming from
Pedro to begin with how did you decide
on the number of machines for the elixir
app was it a good guess or was there a
type of methodology that you applied to
get to that number
yeah that's a great question I mean I
think it was more art than science and
it continues to be the approach that we
take you know gets very complicated
within an AWS world where you have so
many different instance types that you
can select from and again when you have
a it when you're understanding of both
elixir I'm thinking back to a year ago
when your understanding of both elixir
and the service that you're developing
are limited at the time you kind of have
to punt on that for a little bit so I
don't recall exactly what instance type
probably we were using initially in
staging but generally speaking the
approach that we take when determining
instance sizes is to first get our
services up and running in a staging
environment where we can blitz traffic
and look for potential bottlenecks
so once we've optimized let's call it a
single unit of a service from there we
will increase the traffic load
oftentimes ghosting traffic from
production to that service within the
staging environment to look at again how
does it react how does it scale and from
there and working with our DevOps team
we make a an educated decision around
the ideal instance type and again where
we want to go ahead and set that
threshold when when we initially hit
production for some of the other apps
it's a it
a little bit easier again on the rail
side because you know when you get
pounded by traffic we can go into a new
relic and see that you know this
particular controller is the bottleneck
or this call-out to Redis is the
bottleneck and scale up accordingly with
the lick sir again it's been a little
more challenging so we put it at a level
where we feel comfortable that should
something happen it can react but kind
of going back totally in the
presentation we still feel like we're a
little over provisioned compared to
where we could be we also used the
observer there are langham server which
helps us identify bottlenecks as well as
on your traffic which has been really
really helpful so that's been good for
us as well thank you for that we have
time for no more than two questions so
go straight ahead with the first one and
this is obviously practical for from a
perspective of learning Alixe here in
regards to the order of books that you
should read to master Alex here would
you have a recommendation that you could
extend to our audience yeah first is the
programming elixir book by Dave Thomas
who's also a pickaxe Ruby book he's
moved to elixir as well um it's very
good and I would recommend reading the
first couple of the B there are four
main sections the first is basic elixir
syntax and used them and then the next
chunk is more about OTP which is very
important especially understanding how
Phoenix is structured and what once
you've done that then I would recommend
the programming Phoenix book by there's
no corn the creator of Phoenix Joe's a
bulimic grater of elixir and restage who
is working on both it goes into very
good detail about how Phoenix is
structuring and about how how it gives
you a real life example of building an
app using channels and just crud app
type stuff and then um I think those are
probably those should be enough to get
to get anyone off the ground
thank you for that now Michael is asking
the really interesting question and I
think we can finish with that it's
basically saying can you give us any
examples on how to benchmark elixir apps
so there's a few lexer benchmarking
libraries one is venture love and Alex
ometer which is a wrapper for examiner
we use that to benchmark controller
actions and these mappings and you just
serve in that pipeline you put a X X
ammeter plug and it tells you we use
that to monitor the controller actions
as well as the database time times also
you can because it's in Erlang library
you can measure the atoms and these kind
of things as well
and what else we use those have been I
guess those are the will of the most
benefits of things and again we also use
the observer to do more real-time
benchmarking and then exporting that
data to data dog or SATs T's how we
monitor them over time thank you for
that Dave and then we significantly
breach the time we've had but it was
absolutely worth it now I'd just like to
thank you once again for a fantastic
speech on the use of elixir ability to
report most inspiring and I would also
like to thank all of our members of the
audience who joined us for the webinar
today please join us again for our next
monthly webinar now following today we
will send you a short survey to make
sure we capture your feedback of today's
webinar please also note that the
recording of the webinar in the
presentation that was shared with you
today will become available for you to
collect on the erlang solutions its
corporate website at www.att.com/biz</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>