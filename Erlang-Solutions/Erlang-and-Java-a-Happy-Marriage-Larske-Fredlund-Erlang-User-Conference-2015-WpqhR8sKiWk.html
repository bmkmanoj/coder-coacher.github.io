<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Erlang and Java - a Happy Marriage - Lars-Åke Fredlund - Erlang User Conference 2015 | Coder Coacher - Coaching Coders</title><meta content="Erlang and Java - a Happy Marriage - Lars-Åke Fredlund - Erlang User Conference 2015 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Erlang and Java - a Happy Marriage - Lars-Åke Fredlund - Erlang User Conference 2015</b></h2><h5 class="post__date">2015-07-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WpqhR8sKiWk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is really is about is that we have
done a library Javert lang which is open
source available on the tub that tries
to make it a little bit easier to
combine your Java code and your online
code so if you will a marriage between
Java and airline code and it should be
happy marriage so what goes into a happy
marriage well there has to be a dominant
partner somebody has to be the boss
somebody has to tell the other party
what to do right or maybe no but anyway
let's pretend it's like that so here
being an online conference of course I
Lang is a dominant part are Lang is
going to tell Java what to do which
methods to kohls which obvious great and
so there's quite a lot of support for
that in the library whereas there is not
so much support to do things from the
Java side and perhaps this is one of the
limitations to the libraries so if you
have any ideas of about how to do that
after hearing this talk please please
approach me because it would be nice to
add a little bit more facilities for for
cooling gel airline code from Java but
so but nowadays so far this is all about
calling java from our lang okay so
please also feel free to interrupt me
whatever you want if you have some
doubts or something like that okay so
listening to some toxic yesterday it
becomes clear to me that it's a good
idea to present what are the goals but
what do you really want to do well maybe
we don't have so much goals here but we
have them or maybe the goal is that we
have some problems and we want to solve
those problems okay so it's a problem
solving task this one so what is the
problem we are solving well where I am
part of our group of teachers that teach
at university of madrid and one of the
courses we teach one is for instance a
course on algorithms and data structures
and people use java all the time
students use java just to do that and so
for instance this year I think we have
around 10 around 10 obligatory exercises
and we have around 125 solutions that
are going to be handed in for each of
these exercises around the house and
maybe exercises to correct in Java
that gets boring pretty quickly okay so
that's a problem we won't don't want to
do this boring stuff we also do other
things so we're involved in research
projects that try to apply testing to a
lot of code and sometimes maybe the Java
code is made the code that we test is
not java itself but actually java has
some pretty good libraries for for doing
part of the testing so for instance we
are working with testing web services
and we are doing that by specifying the
behavior web services using a language
called JSON schemas there is actually
pretty good support from from some
libraries Java libraries to do that so
we would like to be able to call those
to Java libraries another thing that is
useful GUI testing with you dealt a
little bit that as well and you have
selenium written in Java maybe there are
other AP is nowadays but one possibility
is called selenium directly from Java so
actually Java has some good stuff we
want to use it but we really don't want
to write Java code we like I like much
better okay so this is our problem we
have to call java but we don't want to
do that okay so thinking about them you
can get an idea what our libraries about
what are the strengths and what are the
weaknesses and clearly one of the
strengths is going to be that it's going
to be pretty easy to write to call java
from our line we don't want to have a
lot of hassle doing that so we want to
streamline that process but on the hand
we are doing testing so maybe we're not
as much concerned with having really
really the best java the best
performance of doing calls from a link
to java so maybe this is not going to be
the library that you want to use if
you're really really concerned about
performance about having a call from our
line to java in a very short amount of
time and there are a lot of applications
that need this and so far I think this
library is probably not there yet okay
so there is already stuff in Ireland for
talking to Java perhaps the most or
certainly the most well-known libraries
they interface which is basically what
it does basically it provides a set node
concept they are like node concept it
exports this to the Java world
so you can create you can program a Java
node and that you have a node can talk
to the Erlang nodes so distribution
between our lang and Java and this
basically enables message passing so
from the alongside things are pretty
easy so an hour long process can sound
normal messages doesn't have to care at
all about that is really talking to Java
to the Java side so normal message
passion from a line whether but on the
Java side you have to work a little bit
more because what you get are incoming
messages but these are not the incoming
message that would you expect to have
normal Java types like integers lungs
strings and things like that but know
what you get in are objects that
represent the an encoding of the airline
values so you have two unmarked those
those values when you start working with
them on Java and there is no further
complication you really so on the Java
side you don't really have processes and
things like that you have to decide what
you have to write a protocol for
everything you do you have to write the
protocols you have to decide what is the
vocabulary how do the online world speak
what messages does the Java side except
from the alongside and things like that
so a little bit work but anyway this
works people have used it to great
effect and it's stable think we probably
want to use it but there are other
options as well sorry uh okay strange we
probably lost the slide no okay that's
design so there are some problems as
well here okay so one that was
addressing was that on the Java side for
every program you want to jump a program
that you want to talk to from from
malang whatever you want to do the new
task you have to write quite a lot of
Java code so this is a typical skeleton
here you can see that well there is
something called receives you get in the
message and then you start taking this
message apart you see oh maybe the
alongside wanted to call a method call
em and maybe we have a this this
information is represented in a string
well then eventually
scholl the method I am with the
parameter I here so for everything you
need to do you have to write this kind
of amount of Java code and this is
something we really don't want to do
right another thing sad thing in my
opinion perhaps is that well if java is
about anything is about objects it's
about object references but this library
doesn't have any way of communicating a
Java object reference to our line so you
can communicate types like integers
Long's but not really develop a
references and you want to do that of
course especially for testing and the
third drawback is performance but we are
not probably going to be able to address
that much here ok so there are other
options so one option is our young which
is really if that's how you pronounce it
I don't know which is really an
interesting system where a person has
gone out and built a long virtual
machine if you wait on top of the Java
Virtual Machine so there is really a
tight integration of the languages and
this is something to me it might have
been pretty interesting and according to
the web page so this is quote from the
web page it does work I have never tried
it but maybe it's not completely ready
for primetime yet seems to be the
conclusion so if you have other input on
that tell me and I will be curious
anyway we started this work before our
yang was developed but that's certainly
an option ok so having looked at that
what what do we want to do well our
design goals is we want to build this
library java.lang on top of a interface
because it has some good features but we
want to streamline the process of
calling java code from a line right for
instance we don't another thing we don't
want to do somehow sometimes when you
see this libraries you see there is a
lot of work on pre compilation of Java
interfaces needed and all this thing we
don't like to do that so we want
everything to be ready from the box in
some sense and a way to do that a
technical comment is to use java
reflection which actually works pretty
well so there is a mechanism java
language
that sort of you can use for getting a
lot of information from from Java
classes and things like that
programmatically so Jabra reflection is
really nice we use it a lot so another
design goal we want to be able to
communicate java reference to from our
line without any problems of course and
as a fifth goal which is perhaps a
little bit more unexpected because we're
doing testing but it's it's somehow
natural in the sense of the languages we
are working with because both Java and I
Erlang are of course garbage collected
languages automatic garbage collection
so in some sense it's sad if we start
passing object references from Java
Twila it is sad if we cannot any longer
garbage collector so we want to be able
to enable safe and automatic garbage
collection of Java objects whose
references have been central on and
there are two issues here one issue is
that well it could be suppose we send an
object reference from Java to learn well
maybe Java forgets about this object
reference and it starts garbage
collecting the underlying object that
wouldn't be good so we don't want Java
to garbage collector early but it could
also be that because of the fact that we
have communicated this object reference
to our along it's the underlying object
is never going to be garbage collected
so we have to have our line talk to the
Java side and say oh now actually it's
safe to garbage collect this object and
to do that automatically without any
programming okay so that's the task so
let me because this is a conference
about programming and things like that
so let me illustrate a little bit of bit
by by actually using it here okay
instead of doing just a boring slide
presentation so we will run the code now
so this will run our line we have the
starter no because the r-line side is
going to be a note that's going to talk
to another Java note okay so give it a
name let's say you see for instance and
it starts we're using an old version of
our line apologies for that it works on
17 as well but never mind okay so the
first thing we want to do you want to
create the Java Runtime to talk to the
long run time so how do you do that well
our library has a number of modules
the primary module is java and that has
a method here which is called start node
for creating a java node it doesn't take
any parameters but it what it does it's
on the same machine is going to start a
java runtime okay and it will return
okay a node if it is successful I was
okay we now Java has started running on
this machine everything is fine what can
we do well what is the first thing you
do in Java probably you create an object
right okay let's get an object so we
have a method or a function in Java
called new which as a first parameter
accepts the node identifier because this
is about notes so the same a line note
can actually talk to several Java notes
we're not limited to talking just
one-to-one communication here okay and
the second parameter is the clasp of
which we want to create an instance so
let's for instance create an integer so
we give the whole path this is perhaps a
little bit ugly but right it's not big
deal okay and we want to send along a
parameters to this this operation so
we're going to call the constructor for
the integers in Java and there is one
for instance that accepts an integer I
mean as a parameter so we can create an
object integer object we have a storing
the value too okay we did it fine okay
come back pretty quickly and we can
store it in a variable we can create
another object and store it in a
variable so I does I to it's actually
another object of course we create a new
object we had to but the first one is no
longer accessible okay so it could
possibly be garbage collected later on
oh so we can do more things we can call
out the Constructors we can for instance
there is a string constructor we can
pass along a strain here and create an
interior story number 30 okay we can
make our sister
well of course we can try to call this
new but adding giving a float instead
these crashes on the Java side well it
doesn't really crash this presentation
with Java site crashes in the other long
side but the the the consequences is the
same so we get back an exception so if
this crash have been on our Java side we
would have gone back gotten back in Java
exception but anyway they are these are
catchable errors that one can handle ok
so we can create objects what the hell's
do you want to do you want to create if
you want to call method so these objects
so we can do call and we give an object
reference or the representation a line
of that object reference so we can for
instance fri to we can for instance call
the method in value this is a standard
java method in the integer class of
course what is it return let me think
get it up perhaps a little bit 90 as
well never mind so what is it do it
returns the int for the object for the
integer stored inside there ok so it
doesn't take any parameters it returns
to ok cool what else do you want to do
in Java you want to access the
attributes so for instance where the
inter the class there is an attribute
max value I think which is the maximum
integer positive integer I can store in
an integer object ok so we have an
operation gap but this attribute is not
an attribute of the of any object so
it's an attribute of the class so it's a
static attribute if you will so there
are there are methods there are
functions for calling accessing object
attributes but here we are calling a
static one so we call a different
function get static it needs to note
because there is no object it needs the
class name yeah I will I will get it up
a little bit yeah sorry it's not sure
how to do that so and we have as a
parameter the value ok so
oh we got an attribute a class attribute
we accessed it it return the value from
the integer class and the attribute name
was max value so you can see a lot of
things here represented as our long
atoms for instance class names method
names attribute names those are a lying
atoms and you can one can discuss
whether this is a good choice or not but
it's the thing that is implemented right
now okay and this was the value returned
ok so a quick demo let's continue but I
should say that this was in no way
prepared we didn't have to compile those
things the example anyway with you we
just started a java runtime and they
started talking to each other and easy
ok compared to j interface things are
very easy actually so this is another
example you can take a look on later ok
so the API for the Java module which is
the the primary model module is the
following more or less you have already
seen it so I'm not going to talk much
about it her to make a couple of
comments we try to make the job easier
for instance we try to do things like
after boxing so converting into two
integers or things like that we try to
make sure that the values that you can
send along to method calls too
constructors and things like that so Val
here this could either be the
representation of an all-in are lying
I'm an object reference in Java or it
can be a basic outline value that can
bring be interpreted in some meaningful
way as a Java value so for instance the
integers the boolean's the atom now
those are things that you can send along
as parameters okay so implementations
gets how do we do it because this could
be a little bit interesting for other
people that want to do the same thing
later on in other languages or for far
along as well so how do we implement the
new function that creates a new object
instance give it a node given a class
name anathem and giving us a list of
arguments okay so let's do it step by
step so the first thing we do on the
airline's side on the other line note
because that's the caller always along
is the Kohler and Java is the recipient
okay so the first thing one does is to
look at the class and there is a table
on the alongside that stores all the
classes so there is some information
that there that we need so if the class
is not previously known we have to do
some stuff otherwise we can continue a
bit later on but let's assume that the
class is not previously known then we
have the airline sides sends a request
to the driver side saying please give me
the class information for that class and
the Java side are using reflection the
exact information about that class and
what does it get back well it gets back
essentially the names of all methods
there types and things like that the
subclasses the attributes for that class
the public members of that class if you
will and what it gets back is not just
text strings or something like that but
it's actually objects object references
that represent ways to to call these
methods and constructors and what you
will okay and so that's an
infrastructure that we send along to to
our line then the next step so we
basically just do some mapping of
yeah with references to analog
representation and a little bit more
stuff and we send it along to john the
alongside so okay so now we have the
class in for that we need okay so we can
now the alongside can hopefully take a
decision by itself it can look at the
the class infrastructure it can look at
the arguments and can see ok which
constructor do you have to call so and
it will find a concrete constructor
hopefully otherwise there is an hour an
exception so it will find a concrete
constructor see here and this is the
representation another line of a real
Java object reference okay so what do we
do we just send a request to the Java
side saying basically although basically
call this constructor with the set of
arguments okay and java gets these
requests it has the map from the online
it has to translate a line object
resistor java object references so the
constructor here digging that out the
real object here the real object
references and the same for the
arguments okay and then it can just
invoke the constructor on the objects
using java reflection okay fine and
later on it sounds along to our along
the return value of that of that call
okay again taking care to mapping from
Java to our line okay so things have a
fairly straight for we'll use reflection
a lot we use mapping or object
references okay so Joe the object
reference is how do we translate how do
we represent the Java object references
in our line okay so this is really a
topple on the alongside so we have with
four components when it sends from a job
at least so there are four components
there is an I a unique integer that
identifies the identity of object and
that's unique at least on the node that
they object where the object resides
because every object or insights on its
own note its own java runtime okay and
the same we have a class ID so this is
some kind of the fire that identifies
in a efficient manner which class the
object belongs to okay remedial class
and there is also for garbage collection
purposes there is an object reference
counter which counts essentially the
number of times we have passed the same
object reference to two alongside and we
need that to do garbage collection okay
so on the driver's side essentially we
have a big table so that every Java
object reference that gets answer Allen
gets noted in this table and a mapping
between the object reference and a tuple
like this okay and we do that for two
purposes one purpose is to be able to
consistently transport a translate of
course object references to and from our
line representation but also for garbage
collection we need to keep this object
reference in the table until alongside
says oh I'm done with you okay so this
is to protect that Java doesn't
premature garbage collect object
references okay so Oh garbage collection
so how is that done and this is the one
of the interesting things that it has
become possible to do this lately in our
lying i think five years ago i think it
wasn't really possible to do something
like that and it's the introduction of
the Erlang foreign function interface
the the nibs that has made it possible
okay so when an object the
representation in a lying on a metal
object reference comes into the unknown
from Java to the alongside well it comes
in like an object like that we saw a
tuple with four components four elements
well it gets translated immediately by
dialing layer into something slightly
different the object reference counter
is replaced by what we can call what is
called in standard terminology and nice
so this is spelling our initial object
and this is basically just a blob of
something that we're not going to
inspect ever but this blob has the nice
characteristics that when this blob is
no longer
is no longer possible to reference this
blog from any part of the online runtime
system well then there is an Associated
delete constructor in the NIF library
that's going to get cold saying oh
nobody refers to this blob anymore this
research object so this function can
then say oh actually I have a table here
mapping this blob to to a object
reference counter an object ID so it's
probably a good idea for me at this
point in time to inform Java that this
object reference count this object
reference is no longer used we have 11
the instance of using that is no longer
valid so you can decrease your reference
counter that's in Java and the Java
sites receives this message is and if
the count goes to zero it can sort just
remove the entry from the table the big
table that exists on the Java side okay
so this is using nips to a nice in a
nice way and I really like that there
exists but one of the drawbacks perhaps
is that if you're working on an online
platform that does not support nifs well
you don't get garbage collection things
will work still but you will never be
able to garbage collect things down to
our line okay so a couple of other
points about the library so both our
language Java has threads or a line has
processes Java has threads so one needs
to actually to take some stand how how
if a process makes a request once a call
a Java object or something like that how
is that represented on the Java side and
the decision we have taken is by default
at least every hour long process talks
to its own javathread and this seems to
be pretty natural we are sort of
liberated from things like well if we
call a java method takes a long time
from one process this is not going to
block the whole library forever because
of that so we can make lots of
simultaneous calls ideally the there is
no ratio as well so some Java libraries
for instance the swing GUI library
actually requires you as a caller to
always call its methods from the same
thread javathread so this gives a nice
way if we want to use the swing GUI
library from our like then we have a
way of doing that as well in a
controlled manner so we can let one
process always be responsible for
calling the swing GUI methods and that
that sort of this pretty okay so we have
done a lot of stuff but is there
anything missing do you miss anything
from this functionality what are we
missing we can create objects we can
create we can call the methods of the
objects we can call attributes do we
need anything more from Java to do
anything more with Java starting friends
we can do that with this slide more or
less what what else do we need what else
do you need it do you do in when you
program in Java you create classes right
we need to create closes so this there
has been nothing about creating classes
so far and we don't want to write Java
code so we don't want to create classes
into either but there are actually
libraries which require you create my
new classes so let's look at an example
so here for instance if we want to use
this swing GUI library for instance we
can easily do that here this is code for
creating a button in swing so we say
Java cooling colon ooh this is the
button class jbutton and we can give it
a label so the label on the button will
be hello initially okay fine we can we
can add it to the we can add it to do
some window etc and things like that
okay pretty straightforward but suppose
when a user presses the button suppose
that we want to change the label from
hello to world so this is some action
they'll standard way I'm doing that in
the GUI library the swing library is we
have to provide something called an
action and listening listener object so
we have to call a method of the button
which is called set action which accepts
as a parameter the object that is going
to listen to events that happen to that
button okay so we want to have an action
listener object that looks and see if it
the thing that labeled my the bottom was
hello we change we want to change the
world and
but we really don't have any java class
that does this of course no and well
what what is available well there is for
instance in practice what people do they
look at the abstract action class java
class which is an abstract class it
cannot really be instantiated and they
from that class they usually derive a
new class which does what exactly what
you're supposed to do changing a load
the world okay so what we have gone out
and done in her in this library is to
implement a facility for defining
classes in our line pure our line no
java classes and it's almost doable
there is in java reflection in standard
java there is something called proxy
classes and they're almost usable for
this purpose except there is a problem
with the abstract classes one can it
really create a new class that in her
from from an abstract action okay so we
were forced to use one of these bad code
manipulation packages and concretely
this by the system assist bytecode
manipulation package so that's
integrated inside the java.lang library
so let's look at how does it look like
in practice our task okay so we have a
new module Java proxy for creating these
classes the new classes proxy classes it
has a function class which acceptances
first parameter the node that we want
where we want to create a new class then
we have the name of the class we're
going to call it act listen in this case
our class then great and the immediate
super class is going to be the abstract
action the abstract class so from that
class we are going to inherit some
methods for instance to string for
converting a Java object to a string
representation so those kind of things
we get from abstract action okay and
here is where we define the the new
functionality if we will so we are going
to define a new function actionperformed
with the following Java type so it has
to be except an action event and here is
the Erlang implementation by a function
called action performed with three
parameters so this is the implementation
so this is the recipe for for creating a
class we also have to provide a
definition of this this function of
course on the next slide okay so this is
how you do it it gets three parameters
the first one is some kind of context
which which proxy object was was cold
and things like that we don't care about
it here the second one is a state
parameters so because Java stateful
probably our job online classes that
represent java classes are going to have
to be stateful as well so we have a
state here that can be changed by the
functions a little bit like a dancer or
something like that and the third
parameter is the the one that we
specified here as the really the type of
the function or the method so it's an
action event here okay so that's the
event so let's call the functionality
down the first thing we do we look at
the source where for that event there is
a method called get source for finding
where where did the event originated so
hopefully this is the button otherwise
we in bad trouble we can take out the
text that was printed on the bottom
string to list your call button get text
etc and we can analyze that text say if
the text was hello we change the world
and vice versa and finally we call set
text again on the button with a new
string the new value and then so there
are two things we can do at the final we
have to return a value so the method has
to return something in this case we
don't really want to return anything so
we specify the void value which is
basically saying it's not going to
return anything we could also specify a
updated state but we don't care about
that for in this function either so we
just forget that parameter ok but so ok
we have created a java class in the
library and that's pretty nice there are
a couple of limitations there's one
limitation right now we are dealing with
a situation where actually this member
funk
should probably not call other proxy
objects in a recursive manner so we are
one wants to avoid recursion at least
with the current implementation of
things maybe that will change later but
it's not really clear what the semantics
of such a person is either okay so
performance so one of the drawbacks of
using J interface is about lack of
performance that people have been
pointing out so at least we want to take
a look at that here and see what kind of
performance you can expect to get out of
the library so probably the most
important parameter is how long does
it's if you make a call to a method how
long does it take to get a reply so for
a simple method that doesn't do so much
okay so here is some statistics for the
for calling the int value method have an
integer that you saw before so it for an
integer it just returns the int that is
somehow associated with this integer
okay so just making this call and noting
the reply how long does it take well
it's a little bit interesting actually
because one could think that this it
should be sort of very perhaps the the
minimum time should be pretty static but
it turns out that if you sort of embed
lots of these calls next to each other
then you will get drastically better
performance so here's an experiment
where suppose you call it only once or
one time while it will take around eight
hundred microseconds almost a
millisecond but if you do a lot of them
consecutively you will be down around
under 200 microseconds so this is a
little bit surprising to me I'm not
completely sure how to interpret whether
this is due to artifacts on the java
runtime system could be or whether it's
due to artifacts on identifying side but
it's at least a little bit curious one
can see that well it's not a great
performing library it's not totally
horrible either and if you have ideas on
how to optimize the interface please
approach me as well I'm I'm really
curious okay so some ray let's summarize
because we want to have coffee soon
so darling provides her in my opinion
are really easy to use a really nice
interface for calling java code from
allah you don't have to write any java
code basically at all ok it has almost
all java there are a couple of exception
one exception is for doing if you want
to write code in in our lung that
synchronizes on monitors and things like
that well this is a little bit difficult
tricky to do because the API for doing
those kind of synchronizations are not
in the new Java API itself but they are
done on the Java Virtual Machine layer
so what could support is in the library
as well but this would mean having to
probably talk to the java native
interface which is a foreign function
interface for java ok what could do that
but we haven't been interested enough to
do it yet there's little maintenance
required I mean you can get new Java
versions you can get new hour-long
version but typically everything works
out to the books so and this is good
because we don't really have time to fix
so many bugs so we can typically we can
just keep on working using this library
ok another interesting point in my
opinion when the most interesting one is
that we have accomplished automatic
cross-language garbage collection which
is something you don't see in many
libraries many foreign function
libraries there are some concerns as
well we still have speed concerns this
is not the library to use if you want to
have really high performance calling
from from airline to Java we can
probably implement improve the
implementation of Java classes in our
line a little bit and as you can see I'm
really bad at syntax so one could
probably embed this in a nice macro ish
style to make sure that you have a
language course the Java looks really
nice you don't have to send along this
list the parameters and things like that
but so far I really don't care because
it things are ok enough in my opinion ok
so but the future finally about the
future what what do we want to do in the
future well one of the things that
embarrass me a little bit when giving
talks like this because people are
concerned about database interface is
what
lots of transactions per second that's
not wondering maybe this is too slow to
be useful so one of the things that we
could do for instance is try to use the
Java native interface to sort of throw
away Jenny interface okay we don't care
about the interface let's implement the
J interface port ourselves and let's do
it on the on SSE library few well so we
can use the Java native interface that's
a see interface to Java and we can
couple that with the Erlang nice for a
function interface and we keep probably
replicate to a big big extent what j
interface does we can probably that way
get a lot of battery performance out and
this is something that maybe maybe we
could do we would still be a little bit
slower than the doing native callings of
Java for a couple of reasons one thing
is that we're using Java reflection a
lot and that has a performance penalty
so use Java reflection that's going to
be slower than then writing your Java
program and compiling it okay so there
is a cost and the cost is we're doing
table lookups to translate a Java object
references to their representation along
and that has a cost as well maybe I like
Nick's will have a cost as well so we
are not going to be as quick as writing
your programs in Java directly but we
could be substantially better I think so
thank you
we have five difficult questions all
right Thank You Lars I just wanted to
ask you because I kind of missed the
first couple of minutes what actually
triggered you to take on this endeavor
to produce the Erlang java library so we
have to do a lot of some teaching it's
in Madrid and we have got a lot of
student exercises in Java we have to
test them and these are maybe this very
so we can have maybe for a course we
could have ten different job on
assignments so we want to develop we
want to test this we'd use quick check
for testing usually so we want to
develop quick check models for that and
we don't I really don't like Java as a
language i want to write the testing
code test models in our line and I want
to have a really convenient way of
calling java so it sure has to be
convenience i don't want to write this j
interface boilerplate code for
everything i want to test I 00 in some
sense boilerplate code is the idea here
okay so testing which where I don't need
the kind of brutish performance that you
need for some other toast so that's my
goal in some sense to do testing well
allowance also want to call a Java
libraries that's good for selenium
whatever things like that JSON
validation and things like that where
you have good libraries in Java but you
don't have the same quality libraries in
Allah and I want to be able to use them
okay is it ready for production that's
always a question I use it a lot for
testing but there are a couple of things
that would worry me a little bit for
production so um the best thing is just
to try there there is some stupidity in
how we look up the correct constructor
the correct method for applying so we
look at both the arguments and we do
some digging there we
this is this is maybe not buggy but
maybe it's not flexible enough so we
should look out a bit but but try it out
we use it we have used it for testing
now for three years or something like
that so it works for us but we fix the
bugs as well so I don't know try it out
are you
do you support subtyping and over
loading bays and subtypes and those
ticket things I mean they are supported
they are supported because they are
supported in Java side so I mean if you
if you sort of create an object if you
have a if you define your own if you
define your own strings but have you
have a string class and create a string
your string and you get an in your
string reference on the alongside you
can of course pass this to a method that
would accept normal strings in Java
because eventually Java ensure state
type safety on this kind of thing so it
ensures through reflection ensures that
your arguments are actually valid okay
so did the eventual check that
everything is fine happens on the Java
side so it can happen when you try to
apply something you get back an
exception on the downside but you can
expect you can expect those two
exceptions as well so things are in
spectacle so yeah they are supported
maybe not directly and I like but they
are supported because Java supports them
one quick question yeah is anyone
interesting in the project how can i
participate it's a github send take a
look at the source code make
contributions make comments try it out
so we have got a couple of contributions
one nice one we got a couple of weeks
ago was june or shin i think is called
that wanted to rebar if I the thing
because we hadn't make file system
before and well let's maybe it's a good
idea to try rebar so now it's builds
using rebar so that was an example some
contribution of God we also gotten
contribution before from loud Vlad who
is doing the aisle ID and things like
that so there are couple of contribution
specially on the Java side because i
have to say i'm at lousy lousy java
program i'm not a good i along
programmer but I my worst Java
programmer so we needs lots of help
there do you think this project at some
point would bring more Java people to L
on community no because I think it's not
no I mean no cuz I think
there are different worlds right
different concerns so no probably not in
our perfect marriage yeah okay okay
thank you very much please give up for
LA Schalke</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>