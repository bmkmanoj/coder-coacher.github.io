<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Automated testing with Erlang (&quot;these go to eleven&quot;) | Coder Coacher - Coaching Coders</title><meta content="Automated testing with Erlang (&quot;these go to eleven&quot;) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Automated testing with Erlang (&quot;these go to eleven&quot;)</b></h2><h5 class="post__date">2012-11-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SjCZRH8ywF0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">right okay thank you and we'd meet up
there's some Dutch here and now also
watching the live video stream my name
is Kurt Becker I'm why Amsterdam so I'm
going to talk about I've made testing
earlier when I started out early I also
just dr. death curling is not only great
for building highly concurrent highly
available systems but it's also great in
testing there are some great testing
libraries available
so today I would like to talk about
those and using my own examples so the
agenda for my talk let me quickly
introduce tty this company I work for
after that we quickly dive into a unit
we're gonna be smarter when we get to
the quick check part we do so here but
heavy lifting with contest and hopefully
we get quickly up and running with
continuous integration so and that's
about it service you might have known
might have heard of that's called Travis
great how to make testing an airline and
airline itself is complex and quite the
first so I might hope simplify some
stuff here today just to get to make
more understandable or people that are
not are not familiar with testing in era
okay managers were thicker than in the
last five years I increasingly needed
high visibility and confusion see my
projects as my company we use a lot of
scripting languages we use Perl Ruby PHP
the fam stuff and it's not easy to get
it right there well some might said that
you can say is it possible to get right
so I search for language that could do
it right and make or at least made it's
been much easier and I found spare Lang
I was peeking and became a big fan of it
so talented why yes ttyl
we built high-traffic sites and mobile
applications we also have a lot of
experience in the search and meshing
solutions like solar bussiness means
we're basing up stem and that's of
course a very dull place to work their
goals canals and everything not drives
me nuts
we also also the owner of salesman VA is
the number one classified site in
Belgium with over 650 thousand unique
visitors a day so that's quite a lot of
traffic we also have a few startups we
participate in it's doing we do mobile
payment solution internet broadcasting
platform and music service and even
mobile audience targeting system so
quite a lot quite busy and that's it -
why we like airline Allah will love her
life we're currently using it for a
research and development project
regarding search so we're building
basically distributed search engine in
era
we also currently using it for a lot of
API backends and we're also using it for
a logging analysts platform for trails
with a hey and what are high-traffic
sites so we have also some Ruby
developers and they also love airline we
also participate in quite a lot in the
air among community in the Netherlands
the Dutch are on user group you have
semi regular meetups and a lot of great
Dutch companies that use around
participate in that community so if
you're nearby please come to meet up
with strength also together with our
solutions and maximum story interactive
we have organized the airlines
paranoia factory light Amsterdam in 2011
so and with at least t2 i also created
together with four team of Travis is a
continue to race service more about that
later created the first extra language
on Travis because before they tell me
support Ruby and at the sermon so we're
quite proud of it okay
enough about my company let's talk about
simple testing with a unit well you're
probably familiar with unit testing
already in other languages you might ask
well test is quite simple what you do is
you check the expected result with the
actual results based on an input you
array 3 defines so for example the
simple addition method list then the
addition exists in Maryland this way one
plus one should be two and one and two
should always hard when you're on the
stage and presented alright great so
this is a very basic unit test you
probably get the point
it's well to why let's go to a real
example right well we're at Google
compass so when you talk about the
search engine what's what's important
well Google gets rights and that's it
should be very very fast and very very
relevant so to get the relevant results
most services systems use a process
that's called stemming stemming is
same words to its base former roots form
so for example these are examples
fishing Fisher fishes fish and euro
reduced to the fish base form so when
you search that you also get the
documents with other without a fish's
result is that actually the result
becomes more relevant so that's right
there's an algorithm that does that
there's this very famous is he's created
by Martin Porter in 1980 and it's the
world algorithm named after itself the
other makes quite complex but to chest
heart implementation mr. mcian provided
the dictionary of vocabulary with thirty
thousand worst tests so we're the
English words bliss systems form so if
all those words mesh our other and
should be correct this is the point
that's the idea so and looping over all
those words were stemming the words and
checking if they're equal well it took
some time to get these to work and
fixing a lot of bugs but something else
was was also very interesting unit
testing in airline it comes with
coverage report well a coverage course
this is an example progress report shows
you how much times in a particular line
your code is executed during the test so
for example the line above is one
hundred to five five one three hundred
sixty and seventy four and that's very
interesting to see because besides
knowing what lines are actually of well
the most important thing is that you see
which lines chip parents tested
and those are marks red and that's
interesting because I just said okay we
had a vocabulary by the man himself
so without stem equivalents so you would
expect that those who told all rules
match so this is about Barnardo's well
turns out the vocabulary used was not
complete so we found actually I'm back
there and that's significant because if
we test our codes
hope is certain we are testing the right
thing well you can say that in other
words who is testing the tester let me
make this problem with more more clear
with another example so again I gave
myself permission to reinvent the wheel
that's what programs like to do so you
need me to so in this case two plus two
is four and 1.1 plus 1 is not equal to
three great ok let's mess up the
implementation a bit because your codes
consciously constantly changing so in a
test shoot to catch them right well well
they still pops with the definition is
definitely incorrect so the quality of
this test is not very high let's see and
there's another but not a problem as
well integers in airline are both
numbers are actually infinite
yeah well links about in the memory of
your computer but there is no maximum
size so if you want to test that issue
function we actually need to test the
addition function for all inputs and
adds both integers so that's actually
quite a lot of tests ok
that's of course we're not lazy
programmers so let's
a lot of cats this guy's Stewart yeah
well you know what you might think
artists will never ever never have any
practice but actually I see similar
tests view tests in real world goes
because okay this feels okay let's just
another test and to know it does for
this test case which it's good but it
still doesn't give a guarantee if about
the quality of the test of the
invitation that's be worse so create a
bit silly example again that it's shown
that is a pretty few job your job to
improve your test by adding more cases
manually so when we hit the mail 1
million it actually feels again damn it
ok so again in this case is testing the
tester whew make sure that I as a
developer and maybe you guys know but
developers are see quite that testing
their own codes for fixed writes inputs
so how do you know for certain your
picture everything so that's a good
question
well lucky using pathway check you can
be smart and easy at the same time so
that's our prepare egos in their input
check for what you don't do is specified
input so what we see in previous
examples that when we specify the inputs
we probably made them wrong choice
lovely quick check generates as for us
the only thing which we needed to do is
specify the properties of the code so
you saw my addition example let's go
further it could go over it one more
time and see what properties we can
refine for that particular method
for example a plus B should be equal to
B plus a here we see a quick check
method so what we're testing here is for
all a B that are integers the addition
should be a comma B should be set equal
to an addition v comma head okay well
there are actually some other properties
you can define from this you might seek
it before
for example a plus 0 should always be a
well some float right okay so when
running we check what it will do it will
generate lots of lots of lots of
integers and for all those integers your
property needs to be correct if it isn't
it feels so this is actually a very good
way to stay lazy and be smart system
well but my presentation by line is this
thing's comes to eleven so you can let
pre-check go to eleven by turning some
knobs my default number of test cases so
the number of integers in this example
it generates it's like hundred random
integers you can decrease it but it will
also take a little bit more time doing
tests so for development this is great
later on we see we will see that people
if use for example continuous
integration system it would be wise to
increase this to say if that's how to
22,000 depending on how forum you want
to be you can also change the size where
the site does is changes the maximum
size of the integers that are generated
in the case of integers
great okay let's look at another example
for a quick check using a project of my
own when you're creating a search engine
you tend to have millions of documents
you tend to wonder why the love of big
lists with integers so that will take
quite a lot of memory and lookie there
is a solution for it in the schools yes
come I ain't going anywhere some coding
first up we have a list one two three
the 16-bit integer representation of
this is and you see all those zeros so
what the image dummy coding basically
does is remove those zeros so let's
remove the zeros well they're fun
problem if you remove all zeros we don't
know when what the delimiters are
between the numbers so what we do is
based on the number of elements minus
one we add that amount of zeros in front
so so we know how much this particular
integer will say oh how many days that
we need to get to constructed integer
again right the nice thing is that if
you're creating a compress decompress
algorithm the property is actually quite
simple this is of course not the only
property you can write but this is very
one of the most important properties so
when I am hold a list of positive
integers integers it should be the same
the when I think of it should be the
same as the booze breath what we saw
first is that one of the perks we found
is that positive integer integers are
required because this encoder doesn't
support negative integers so that's
that's one thing we found out
of course the base mistakes empty lists
and we had a lot of my own errors
so from this is not completely accurate
that is just my experience with with the
unit a quick check is a unit it's like
you saw is just an assertion is quite
ladies it's quite simple but you don't
find a lot of bars I found if we checked
to be a lot harder because you really
have some reason about you you have to
create a mental model of your girls and
that's quite hard if you didn't do that
a lot of times before that so the good
thing is that you need to create a
mental model of your culture your
reasoning about your code becomes a lot
big better with this complex but you've
also found a lot of more bugs so that's
great and well shipping quality code is
our goal
next up contest so let's do some heavy
lifting I want to be for example that is
coverage curves and it has also has a
complex codes of test suite for example
on sit on commodity machines runs over
six hours and I don't think it's because
they use a lot of sleep goals so it's
actually quite happy and they also use
competence and the reason for that that
is take so much time is that this really
heavy-duty CSM testing let me show you
using an example from our project the
search engine project that talks about
before so we created some test system
test our search engine is distributed so
it works on multiple maps so we
specified some tests and deleting a
document adding deleting and index
make sure that queries are running and
test some redundant see would have a
significant kill analysis they're still
you know
and of course Hana the replication so
what would we use contest for is that
Tommy test can actually shuffle those
cases and repeat those cases well so
what we said is okay shuffle it and
never read it
let's see if this dies well turns out it
dies of course because state left by the
index so you couldn't call those
multiple times after each other
so in this is a very good example of the
use of contest contest is very complex
allows for grouping complex expression
with other types of systems it's really
I think we don't need that right now in
our projects but it's yeah it's really
really cool to work with okay next up so
we so we could simply test with the
units
okay that's partly with common with
check and now we can do heavy lifting
with common test well when you know
that's what that we all just trade it
test Suites and it takes quite a lot of
time let's say 50 minutes well you don't
want to wait every time your code
changes or you make a book face or
whatever so that there's continuous
integration it's very valuable probably
also suitors for this one that's a very
good excuse let's let's pretend that and
every change you need to wait for 15
minutes so you have a lot of time to
play
how do you pull that mine or sword
fighting okay well this is fun as well
but some of the work gets done then so
protesting it will be the same so using
continuous appraiser server that runs
your tests when you're just developing
increases the trial and error cycle as
my balloons
bolus so that's very important
and it's also extra disability sorry for
this screws alarms will go off -
somebody broke their bills and if you
make this very visible the person tends
to be Waring clients worth is a little
bit of help to fix the bills and that's
a good thing because that improves your
quality and doesn't keep you don't want
works lying around you who you are great
though okay
and there are a number of continuous and
creative services available one of the
most popular one is Jenkins is another
source project I believe it's what's
called Hudson before a lot of big hair
on projects use death they're probably
also a lot of other ones that I didn't
include this grant is mature its
complete very flexible and you also have
traps CI which is a hosted the
contingent basis service industry focus
or projects and like I said in the
introduction and we created the together
with the core team I helped create the
air long continuous integration for that
so this Travis can help you catch it
quickly upper running so let's look what
we need to do for that
okay first some numbers JCI has
currently is running over ten thousand
bills lady for 20,000 active open source
project so that's quite good and
currently I believe 371 air project so
that's also quite a lot of ones that
some of the produce you might never know
Russia react mushy web web machine
CouchDB elixir from associate for me
they're all a presence on travel so
that's great to get you quickly up
running with trap this is actually quite
simple
you need to have your repository as what
we can foster you on get out you have to
add this file to your repository here
you can specify the build matrix and
that's actually quite cool because you
can test directly on four different or
five different versions or param OTP so
that's that's really cool and of course
you can notified if something fails or
succeeds well if it's you see if you go
to travesty idle Park it will look like
this for example this is the this
morning that Yahoo we have a was ring so
great guys very good work you get you
can get also notifications by using
email
IRC brawl hip chats and even campfire so
that's great the built environments
currently and and this is also why you
once might want to use Jenkins this Jen
case you can just use on every system
supported by GBM however and and Travis
only supports in this case 32-bit Ubuntu
Linux so if you need to test other
distributions as well Travis CI is not
for you and you need systems like
Jenkins
the air on OSP version 14 b2 and so the
carbon 14 is 15 is supported service
grant his assumes your project is
reaping - reap are if it hasn't you can
specify your own bills c'mon sir that's
great and batteries are included so we
act memcache Cassandra couchdb are all
present so if your project depends on it
it's already there and you can use it so
that's great so well we are already at
the end of my presentation so when I
showed you this with new units is very
easy to test but you really have to make
sure that you're testing the right thing
but mostly when it says I see isn't it
doesn't yeah it helps but it doesn't
have that much value for me personally
using quick check and it's way way way
more value and I was much more
comfortable with positive my codes using
quick check the happy anything with
common test if you project depends on
distribute its disappearance has some
external dependencies using system
testing is really a sweet spot for
contest and trial prep CI if you want to
get your test Suites quickly over
running and the APIs and with all Frank
the test libraries you can use really
really mindful for the value you think
your tests will provide because a lot of
people are very I can might say
religious about testing that test-driven
development lifetime stuff and that's
great the school if that works for you
please do but make sure that you don't
just writing codes and like the example
when I saw just writing down all cases
all test case really be mindful that let
every like ass okay
thank you questions yeah well that's the
last challenge and but what you see is
that you actually get up you have to
reason about your codes and that's a
bonus it's hard
it isn't easy but it's a good thing and
because I need to reason about my codes
my cup gets better because what you see
is because you reflect on your cows
you might even change your code based on
the test so that's this that's really
how you find that you regretful
illogical with his go sorry if you
reflect well I don't know now I always
found properties that that were actually
giving me values events yes so that
might change ok another question ok
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>