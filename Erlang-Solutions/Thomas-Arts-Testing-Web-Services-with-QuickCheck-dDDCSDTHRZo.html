<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Thomas Arts | Testing Web Services with QuickCheck | Coder Coacher - Coaching Coders</title><meta content="Thomas Arts | Testing Web Services with QuickCheck - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Thomas Arts | Testing Web Services with QuickCheck</b></h2><h5 class="post__date">2017-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dDDCSDTHRZo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my background is Ellen and I am my
background is from the computer science
lab which was a kind of a research unit
inside Ericsson many years ago where
people actually got the freedom to to do
crazy stuff right and one of my
colleagues Joe there's the second
picture there that was kind of doing
this airline stuff and most people there
then gathered around this is airline
language and we did things like that so
I'm the third person there it's a few
years ago
but it's still fun to look like so we
had really good fun my TAS there was to
look at the future of quality assurance
for complex software so Ericsson was
very aware that the software would get
more and more complex that's right
kind of push for things like airline was
there because Ellen would be a means to
write your software in a much easier way
and therefore you could handle more
complex software easier but if you can
write your software you still want to
get guarantee the quality the quality of
disorder all right and I think that even
in research and the school kind of did
software Quality Assurance has been a
little lag behind the actual development
tools so you have lots of tools and cool
languages to develop your software but
then when it comes to testing it's much
less evolved there are actually people
answered we still do this that write a
test case and then execute that are you
you do that okay so that's old-fashioned
right you should not do that
testing is very hard we all know that
and that's why your to put people like
me to actually explore this project and
this problem we looked at formal methods
theory improvement model checking all
those kind of advanced things to make
sure the software works if the software
in a telecom switch does not work it's
very expensive you have to fire someone
to us bake is done to climb up the
ladder in the mountains and fix the
software that's not really nice right so
you really have to make things sure
things work but then you can ask
yourself the question why is testing
hard do it any one of you experience
testing as being hard
okay luckily because if you would sell
when I was testing is no problem
then your software would be not so good
I can tell you just the companies I made
that sale we have no testing program we
don't need the tests they kind of have
not the kind of quality software that we
are looking for so why is testing hard
well let's look at it explain it in a
number of features that you have your
software normally has a few features
right say we have n features if you want
to test and do a reasonable job then you
would want three or four test cases for
it to feature you add a pub sub
subscription you can output security
with your web server you write for your
port tests just to make sure that this
actually works and then this means that
you have a linear amount of test cases
or an test case that you have to write
that will work fine but now you you do
not have only one feature like you have
two features at least so the other
feature could be something else like
what code swapping or whatsoever so you
really want to test that this whole code
swapping feature together with this book
sub feature also work together so that's
a pair of features that you want to test
so you have to write a test for a pair
of features as well so you write for
your forecast for the feature itself and
then one to test for the pair of
features meaning that you get a square a
number of features of test cases in your
application which is if you have a lot
of test features like your software
hundred features you have to write
10,000 test cases probably or even more
also depending on the concept that's
quite a few but then you only test a
pair of features so when does it really
break when you look at the triple of
features if three things interact with
each other without you knowing that they
are interacting and then boom you crash
all right and that's not very nice so
you want to test for the triple of
features as well
ah but now it gets cubic and you get
really really unhappy because if you
still have one with features or probably
under than one now because you've got
the new one then you get in order of a
million test case two right move this
part a million test cases last week
and the only one but now it's not it's
not a good idea to write such so many
test cases like you don't want to do
this testing is very really hard for
this and the only real solution to this
problem is don't buy tests that's that's
really the only solution if you come you
can't write a million tests so you
should do it
but you should instead if you generator
you should generate test cases from from
thing which is linear so you get an
exponential amount of test case or a
cubic or but I think whatsoever of
something which is linear to write
that's the whole solution for how to do
the testing so how do we do this well
luckily Jose keynote first day already
explained the key ideas of our invention
property based testing so how does that
work you specify a property of your
software instead of one test case you
say something general about your
software and then click check the tool
behind property based testing is then
automatically generating random tests
for you a difficult thing of course is
to come up with the property that says
our brought back bread and butter you
could say our kind of business idea is
to help people terminal properties and
writing them but that's that's the kind
of difficult part if you do that you
have a linear thing this is just a
little bit of code which can generate a
million different test cases for you in
seconds all right so that's the nice
thing about it depending on how many
course you have what a seconds are not
that so what does this property say do I
have a pointer here probably not but I
will walk forward them so the property
here says okay this is one word it's
just like a normal test module which you
have to put this this great check
singing in front of it as well then you
can write this status test your own
property you give the name like in a
test and you say for all strings s1 and
s2 and the strings are utf-8 strings for
all those strings if I start with s lon
and then I offend s2 and I ask myself
the question does this string start with
s1 then I should get a yes back right
this should be true
is the property of the simple function
starts with and you can then run quick
check and you will see lots of tests
appearing I got a question can you
download that so I will download that so
here we are I have my property here
that's readable from the back I shall
make up a larger figure okay better okay
so then I have to make this one big as
well so hopefully it works go bit like
this so this is the property I want to
test what do I have to do here to make
that work well I have to start mix test
and since it has lots of test cases here
I just want to do it like this right I
give the test file so that this is just
mix as it is you take the best fall and
you test it oh what's this the wrong one
yes the room fall absolutely wrong for
so and that that was clumsy
so I want to test the spring thing so
now I got a hundred dots each dots
represent the test case of a random or
actually two random strings which I
append to each other and then check
whether the first thing is still the
last thing and at first does everything
passed and you get this this Colorado
this is the the happy case so that's
quick check in a nutshell you write some
specification of the software you run it
and you look at the result and it can be
done for any function so that's why it's
another property string reverse there's
another function there that reverses the
strings and I've shown this before so
some people already know what's
happening but assume I want the string I
take an arbitrary string which is utf-8
yeah and what I'm going to do now is I'm
going to test the reverse function so I
want to try something like string
reverse and then s1 this is
because one could be called s actually
because it's only one string anyway so I
want to test the reverse function but if
I randomly generate a string what should
have reverse B well the recursive course
but I have no clue so how can I then
make that can work all right and then
you could implement your own reverse
function reverses that your own reverse
function saying they are the same good
but then you do the work twice that's
not a good idea
you shouldn't do that so what you should
do this set think about what is it kind
of a property of the reverse function
well if is something that I want to
reverse like this and I reverse it back
it should be the same again
right so if we reverse flyes it should
be the same that's the whole idea
so okay so if I reverse it twice
whispers are two right I reverse the
string that I reversed then it should be
the same string again right that's what
I really want to see and I won't like
assertions I want to show the output
when this happens so this is what I want
to write as a property for the string
reverse function okay so what is going
to happen now
well I run the test again I went both
because have two properties but that's
fine Oh failure so the first one passed
the second one actually failed why well
because if you look at the example the
first one it says not insured and then
some kind of strange character and if
you can see it from the back I'm not
sure there's a little bit of a term
style character the right-hand corner
there which is on the other one over at
left hand corner so in somehow it
doesn't really work now you get the
shrinking and shrinking it's
automatically built in so if you have a
test case which you generate can be
large test case you want to kind of get
the minimum test get coverage sinks
filled because that makes your analysis
much much easier so this is what is done
automatically for you the whole analysis
and you get back if you have a very
strange character there in a space and
you reverse that irreversible you get a
very strange character before the quote
and then a big space and that's it
so this is
strength let's run a few more tests
after all random testing can learn you
something oh here we get another strange
character and if you reverse it it
strange - well first of all it comes is
not the same the reverse and it's things
to notice strange accent and it turns
out that the unicode accents are kind of
special and the spring reverse function
doesn't take those special accents into
account so you can't just reverse a
unicode string and reverse it back and
get the original that's not possible
with this reverse spreadsheet you should
know much more about unicode if you want
to do that okay so fine we know that
that's not them at it this is how it
works and see also the speed is quite ok
you this was reasonably thought that's
what we call a quick check so I showed
this one and then we'll just pass so if
you want to play with this you're at
home mix you can see well you have to
add the dependency XCX to your project
mix equal see install minus ones meaning
we have two quick checks one is the mini
version that's free and then we have the
version we work with and they have to
pay for and then mix Equus II and then
just the test or mix test and then the
default that you want to test that's
that's how it works so that was fine
this was the very first function and
here I had a much nicer example actually
after running a few times where the
string was bigger in the beginning and
you see this very strange clearly thing
kind of a piercing in the W that the
piercing has kind of moved up to the
first character if you reverse it twice
so that that's kind of strange happening
so this is what happens if you get a
mistake so the whole idea is use
specifications or properties and
generate test cases from those
specifications now then you often get
okay fine
I can probably see how to do the list
reverse reverse
that's simple but how does this work for
real software and it doesn't equally
less equally easy scale for real
software part you have to really do
something so I gave it talk two years
ago at the airline user Ellen a
conference
a conference in Krakow where I showed
how you do this for stateful systems
because all your systems are stateful
right you have a web server and the web
server compilation of State and then you
want to check that the things you do are
actually respecting that state so you
can do that you can do it for real
systems in fact that's what what cuing
does we rewrite click check
specifications for companies that have
software which has stateful one of the
biggest examples we did was for focal
cars so forth right has a Volvo car
nowadays that's about 80 to a hundred
computers inside so I could madness
right like lots of the floats small
computers but nevertheless all those
things they just talk to each other over
a number of network versus and one of
the nightmares that fall for that was
when they buried all those computers and
put it together and very very often it
didn't work because the protocol stacks
are not compatible so I keep putting
Fedora Linux and Ubuntu Linux and and
that had Linux and everything together
and then all different tcp/ip stacks and
they you try to communicate a name for
the Windows machine in it and though
breaks right so that's the kind of
things that Saul was really really
worried about this so they said can you
for that part of the networking software
all the protocol stacks can you actually
test this with quick check because we we
have no clue how we will do enough test
cases for this automotive software is
extremely configurable and extremely
current rich of features so they would
not be able to test all that so we got
three thousand pages of PDF
specification could you do this I was a
year weekend no clue how but we promised
that and we in the end wrote twenty
thousand lines of quick check code to
test one million lines of code that the
different vendors gave us and we found a
few problems there which was not really
expected to be that much sure you must
imagine that the software we got was the
software that actually should go into
the car all right
at that moment we got it and then what's
kind of okay here's the software we
tested with all in-house yes what kind
of
big names we tested all the stuff it
works really past all of this and then
you still find this number of kind of
issues that's not nice
but it was very good for vocal because
when they finally got the first car out
it actually could drive which is not
always the case if you produce a car
normally if you produce it the first
batch of twenty cars comes out of the
production line and is pushed to the
parking lot because you can't start it
and then three months long they are
trying to fiddle around with the
software to make it start and then they
can start making the next batch which
hopefully starts there are no to fullfil
cars on the planet with the same
software in it all right
so it's kind of a tricky thing to do
because everything is configured kind of
for a specific car very exciting problem
ok so that's the kind of things we do as
well that software is written in C so we
do that C code as well it's not just
Ella but we write the mobiles in airline
we work for radio base stations we test
it out for GM 5g base stations with
quick jack but we also did some other
things like Kobashi oh I don't know if
you've heard about Barcia but they have
this react database with no SQL database
and that's a completely different kind
of ballgame that's a distributed system
what are the properties of those they
didn't have 3,000 pages of stress sketch
I can tell you they had something in
their mind how it should work
so then we tried to get that into a
quick shake model and test against it
and guess what it didn't really work the
way they have solved it but then they
could actually fix it so that works
according to what they were thinking it
should do so ebonized drop box has no
specification if you I guess you have
seen draw box so you put a fall
somewhere and then you can do it on
different devices you put false in and
in the drop box and then when you open
it you could look and you could share
that with all the people and they could
look at the files that's fantastic and
it takes a bit the synchronization time
but then you will see that that's for
coconut so we have airline gammas
distributed rule number of virtual
machines start writing false just see
what happens right what's the property
of this thing well the property was you
do not lose data what else could we say
I mean you write something it may have a
conflict fine
so if you write a two at the same time
you get a conflict you notice that
complex you should be able to say oh
that's fine but if you lose data then
that's something which you probably
don't really like like if you write a
file or machine you create a directory
on the other machine where's the same
name don't do that at all right okay so
after world the directory is gone you
file a storm as well so that's house so
this is the kind of things you could you
could test we worked on some other
fields like caught got the testing that
they don't bump into each other in the
air and things like that but that's all
fine so we went to we get this gun
presentations and people picked this up
at conferences and we are approached by
big companies that all we have this kind
of quality demand on our software it's
kind of lives are on stake here right if
you don't test better normally so that's
kind of fall for Ericsson this is really
when they need good software but also
some companies popped up like oh we have
this web server here can you test that
as well with this discount technology
I'm sure it up yes we can do that
because a web server to me is slightly
simpler than probably base station or
vocal cords that's probably not true but
that's my impression of or what web
service on so this is yeah we can do
that so I went to them and show them a
demo and
how we will do this on a little web
server that that they had and this is
always in an airline code and they said
earlier interesting and then we were not
very enthusiastic and the reason why
they were not very enthusiastic was it
was Ellen code and people in that
community they they were really like
airline code you know which for me it
could be natural code but they they had
other airline code so it showed that a
few stakeholders and their days they
didn't really Burfoot
and then I went home and thought about
it and voted in a lick sir and played a
little bit around that I like Alex a lot
so this is cool this looks much nicer
somehow because it's not Ellen Erin
wasn't much be nice all right so I went
back after a year because they still had
the problem it hadn't made a decision
and there are clearly showed again I
showed it again but now in elixir and
people said oh wow I didn't remember to
us that easy it's just like Ruby yeah
they are right so then it's okay give me
your specifications and what it what
things I need to make the model so we
can we can start doing this and then
they were like our specifications you
know yeah oh yeah we have one and then
they gave you an A for which going to
drawing or not this is I was
justification actually something better
right but it didn't really so we had to
specify all that and it again rather
kind of labor-intensive with what they
did have was Jason schemas any one of
you using again schemas okay that's good
quite a few so Jason schema is basically
a typed language for Jason okay
like people types on it so this is a
JSON schema that I show you here for a
currency type and the currency type has
to string a string and a number the
string is actually the code that
currency has and then there's an amount
and that's a number which is minimal
zero because you cannot have a purse
full of negative currencies at least you
didn't used to have but now with
negative interest we probably assume
there that we have negative currencies
as well and then you say something looks
like this is required that that is
a language for doing that gossip so they
had these kind of things and a lot
probably can use that stuff so I wrote a
little machinery that given a JSON file
generates elixir what else source code
that has a generator in that source code
forth exactly that's Jason forward so
given the JSON schema you get you jason
generator for free so that's nice so
then I can start watching properties
like this currency is always positive
you take your general oh this is
probably a bit it is how you use mixed
tests in a more advanced mode you do a
set up and in the set up I compute my my
module and then I assign a key generator
to the value which is the function
generate in that module which have just
generated and the modules in memory
compiles and things like that so that's
nice so then they can pass that on in
the context of the property or the test
case if you like and say this is my
actual function and then the currency is
used there to generate the amount tuple
so it's now an it was adjacent thing
it's adjacent schema but is now all maps
of course so I have a map amount v1 and
then make sure that v1 is larger than
zero and indeed if I run another test
cases that's that's completely correct
and if I look at the test cases that
they generated they typically look like
this right
these are let's come a some objects that
you have been generating if I print them
with poison and code and I show them as
strings this is how it looks like so you
see that the number generator has a
reasonable spread of different kind of
things you can do you can have many
dishes behind the doctor you can have
lot smaller numbers which are integers
or slightly larger so there's a lot of
kind of distribution tuning there but
this is what you get as kind of decades
nice now we have a currency let's test
the web service
I must admit so I wanted to do this on a
web service written in poison or written
in Phoenix I thought I will make that
Phoenix is so simple I can make a web
service that does this know now the
purpose of the test is to follow this
schema minimum zero if they had written
any then I would have negatives but if
the schema sets minimum zero I will only
generate positive things I'm testing
that the generator right thing just for
the moment the motors not testing more
than a followed this schema in my
generator all right so this is the
schema and what I did here was just
saying if I generate something with that
schema the thing I get has to write
positive amount that's the only thing I
test there's nothing not the web server
at all we are not in that stage yet this
is just showing you how you transform
that so I wanted to write this in
Phoenix but I didn't have time to
actually do that my attempt of doing
that would just failed and said let's
look at the reel web service then that
does something like that so this is
something you can go and browse and you
find XC currency converter formula that
comes up if you touch currency in Google
so I said let's test that one and that's
it JSON API cost you $700 a month with
that now I don't do that so they also
have a web page it is actually creating
the web page and testing that way
so that's what I did anyone interested
in this subscription that was less than
800 dollars and come to me
this year is an API let's make a mistake
you opu sent guarantee your query for
currency for the exchange and then you
get something back what you get back is
specified like this okay you get a phone
turns you back and a to currency back
and then an amount what the exchange
rate is and then you get a time lag and
this is how it is you can specify that
in in JSON schema and I made a mistake
you can never get back sweetie you
cannot never convert to Swedish colors
you can convert euros you and US dollars
but never two Swedish dollars of course
this is not a complete list because it
wouldn't fit on the slide I just took
away the Swedish roller thing there we
have to be able to find this that the
webserver
this is this supported but we don't
expect it to support that okay this is
then what you write the first line
you've already seen that is basically
that you take your falooda jason schema
and you generate the generator from it
by module you can also give it the one
I've just shown the currency API if you
give it that JSON schema it will
generate a generator for it but that's
what we're not interested in that we're
interested in the valid data and also
immediately generate a validator and
that's again the lik source code does it
generate which has a validator built
into it so that elixir source code then
you can use to call the function
validate in it with a certain amount and
that's what we go into you so what we do
is we generate the currency with
currency one and an amount v1 a second
currency where we want to convert to and
then we have an webserver call convert
which converts currency want to currency
to and this is the amount we want to go
to exchange okay very simple we got to
return back the return is an API call
just adjacent that we get back we parse
the JSON we get a map back and then the
Indian map we we just call the function
validate on that map and validate then
should say whether or not it is
respecting this JSON schema interface if
not we want to see an error and of
course since we did make an error we
will see that popping up so this is very
query developed surface currency
converter to convert with the following
things one you withdraw what we want to
compare two euros different works fine
and you see a little actually launched
going fine and then you see a failed
test case here the second one if I want
to exchange Horford through this corner
to another Swedish Krona then I get our
error the value Swedish Krona is not
allowed in the enum and that's an error
that I get from my validator so
basically this says something is wrong I
cannot handle Swedish columns coming
back to me and you can see that it then
starts shrinking and since the Euro of
the left most currency that I put in it
will swing to euros to Swedish kronor
and amount the minimum want the zero so
I will three to zero euros to Swedish
kronor and we'll say roll all right so
now it can be bugged at and I can say
that okay I made a mistake let's put in
the right currency there together that's
how that works
so you have a generator and a validator
for free if you get me a JSON schema
after fixing this I run 100 tests and
now I'm really testing the web server
with what am i testing well I test that
the web server when you give it a type
gives me something back of a type which
are specified but I could if I could ask
for conversion of euros into the ends
and it would say to me oh here you have
six euros US dollars to so many three
destroyers and I wouldn't notice because
it's all within the time specification
right so it's super super lousy testing
yeah this is the first thing you have to
do and it doesn't test anything and you
are amazed how many errors you find with
this but that's another thing but it's
not good testing you want to test
slightly more you want to get into
something more advanced so why not doing
this first you convert something and
then you convert it back and it should
be
say that's the basic idea that's not
completely true but it's basically so
you get your currency and your second
currency and the first thing you do is
you convert the currency one into
currency two and you get your fee to
value back this one that's what you get
back then you use that fee to in the
second attempt to to exchange and you
get security to it because you want to
get the feedback and then those those
those two should be equal now you could
also at the same time but this the slide
gets rather cool if you do that which
you can check that the from and the tool
that you get back from this where
actually the currency wanna go see - and
that here the firmament - are actually
the right currencies that you get back
also you can test much much more with
only those two lines of code and you do
this for any currency and there's
actually a unit test that you do it for
for many many different currencies at
the same time okay let's do that and not
completely surprising this will fail but
it was a surprise to me why is the
reason why it failed so if you say
here's zero US dollars how many years do
I get from you then says all 0.91 euros
oh I want to do business you know and
then it tries to reverse that and then
it says okay if you if I give you zero
point nine one eight six five euros how
many dollars do I get it says only you
get one dollar so I have two zero dollar
into one dollar don't tell okay so find
some shrinking and then you get the
minimum if you have zero euros and you
go to them say how many how many you do
a guess from you if I give you see
reviewers you get one year oh okay and
then you say if I give you one euro how
many get it back one of those okay so
this is this is also thinking so I went
to the website and check this and I
thought one there and indeed it makes
immediately it makes this into one so if
you top zero here it will immediately
make it into one
ah okay some of us completely stupid it
was just they don't expect zero and it's
actually quite clever because then they
would have somehow to divide by zero
somewhere and that is kind of asking for
problems okay but then the specification
is wrong right so they they specified it
in this way where you have the minimum
is 0 but the minimum is not zero cannot
be zero so you should then use the JSON
schema for to say something more
sensible and you say for example it's an
exclusive minimum so the minimum itself
can never be used but anything else is
okay and then you get closer to the
truth right so that's the kind of things
that helps you a lot when you start
doing this it's a technique you get
better specifications by the way no one
in his right mind is going to enumerate
this stuff because it takes too much
time so what people normally will do is
say the currency is a string and by the
way you when you get back is also string
and you know nothing
all right so for testing that's not very
useful to you this forces you to make
better Jason schemas which are more
meaningful for for everyone so that's
that's a good thing
okay so if I run click check with this
little kind of modification that you
have an exclusive minimum then it sells
for 1 to the power one 10 to the minus 9
that's too little that's already almost
zero so they don't accept that so I get
up minimum one so you at least give it
one and then be happy that works much
better apart from the fact that now I
still I still get strange numbers back
but this is what I expect because what
what I really expect to get back now is
an error because if you ask a real-time
server
what's the currency at this moment and
they say ok let's touch what's your turn
see if you if I return it back then
there is a change has happened because
this is real time the currencies changed
all the time so let's also exchange rate
change over time so what happens here is
that time is an issue and you can do you
can see that once if you ask
this is check tanking to the test suite
and say I really want to check this a
few more times and you run mix you can
see only checked and will only run the
property for this checking here and it
says one time it says okay fast that
means it was the same and then next time
it will say oh not insured and then you
get a number which is not not one so of
course it's real time and only at the
same time this is actually happening so
we can make that more visible by looking
at the time that you put back from the
server remember there was a time stamp
if you go back so I use this time stamps
and say whenever this is not equal I
want to write on the screen that's at
time T one and at time T 2 I did this
exchange okay then now you can run that
and you say oh it failed at time 8 5 3
and the other one was at eight five four
that's a minute later no wonder I got
something wrong there right so that's
that's what you can do this is actually
the real time that they go back I don't
get seconds back I guess I have to pay
in over 800 euros for that but you only
get the minutes back and probably you
only get the exchange for it once every
minute that is my assumption okay so now
we want to only test this when the
exchange the time stamp actually is
equal so I can do that by enriching my
property my spec gets better and better
and better so I get a specification
saying only when t1 is equal to t2 then
check this and then I can run a lot of
tests and I hope that an owl is okay
because you say they are exchanged at
the same time the exchange rate should
be the same well not sometimes I get
close to one as a different sometimes
further away from it it simply doesn't
work so I thought okay so much for this
service that so this is a bit a little
bit how you can transform JSON objects
into into generators which we then can
use for testing pure the system and we
use we generate arbitrary data
and we use a lecture and click check to
actually execute the test case and to
shrink it but there is a problem our
arbitrary days that can be too arbitrary
yeah so if you start using JSON schemas
then there is a lot that you can not
express in the last five minutes I will
dig into specifically that for what is
it that you cannot express and in quick
check you can see quickly as a
domain-specific language for expressing
these kind of things so you can you can
actually do something more so what would
you say the currency could be so if you
want to say this is a get advanced and
back sorry I want to give it time so I
want to say at the time so-and-so give
me the currency then I could good back
in history and also I'm absolutely sure
that I asked for the same timestamp then
you could specify that as something like
a string like this with a regular
expression and it will then spit out a
certain time for you so if you use this
regular expression this is the kind of
strange that you could generate
automatically so my my transfer
transformation takes regular expressions
as well and makes generator for regular
expression so I can just spit out all
these kind of dates and that's nice but
no one in his right mind is
understanding what this regular
expression is doing odd at least I'm not
the regular expression expert although I
wrote this one I would not really say oh
yeah this is between 1900 and this is
hard to see so to say so this is not the
right way to specify these kind of
things moreover I get very strange days
as you can see here and if this kind of
takes like the 30 seconds of July and
that's not normally a date which is
accepted so it's like yeah you make too
much rubbish let's do better and then
the other thing is that why did wait a
minute this is only the timestamp now
all of the links the timestamp to the
actual currency because changing Swedish
corners to u.s. dollars and then a key
makes perfect sense
in 1980 the US was already there
and Sweden have the same currency as
today changing Swedish currency to Euro
that didn't work because in 1980 there
was no Euro but that only made sense of
the 1999 so you cannot just generate
random data and hope for the best
you have to spear that more more
carefully and this kind of dependencies
are very very hard to encode injection
engage the schema so we have to do a
little bit of quick check juggling so
what you want to do is you want to give
in a currency and a timestamp to ask for
the new currency at that time and the
way you would like to do that is to
write a little bit more quickly so for
the basic data types in elixir I have
generators and for example you can have
them some color options to the
generators for example for the euro you
could say euro you generate by having a
date between 1991 and 2017 somewhere
near and for the same for the other
currencies it's going from 1980 because
the surface I was testing didn't accept
any date before 1980 so that's fine and
then you could do something like this
you want to get the currency and then
you want to take the currency field out
of that currency that you generated the
station you compute the date connected
to that and you take any arbitrary time
with the time generator which is just
the built in something then you have to
only take the hours in a minute from the
time well this is a late line of elixir
that does that you split it at the
second semicolon I think or no at the
fifth position and then you take only
the hmm minutes there and then you put
everything together and now you have
here your actual timestamp and that's it
now you can test it so now you can check
for given this currency at that time
what was the exchange rate making
testing simpler so to conclude education
schema that's very powerful for at least
having some kind of specification and
then I have to fool people in to use
that make it more on one more
better and better fitting my purpose for
testing and then as you'd say to them
throw away your jet and just use the
lake sir because that's much nicer and
that's that's kind of my path of
evolution here that I want to to proceed
progress with elixir is very good for
testing web services because people
really like it when they see this kind
of example some ll say oh this is almost
Ruby I can use this that's what
question Oh so should leave them that's
a question okay so what's the question
here and there but who has the mic
I will speak up speak up no there's no
reason you can go in ten thousand or
whatever yeah yeah that's just the
notion thank you any more questions okay
the question is is the what's the
difference between the mini version and
the commercial version the mini version
has all the data type stuff but it
doesn't have the libraries for the
stateful testing and has no component
framework and no connection to C and all
the kind of useful things we use for in
industry but all the data and all the
things I showed well will not generate a
generator but you can use all the kind
of primitive data types that I showed
you
yes
yep
right so this is also good so this is a
good question and it links a little bit
to what you saw this morning this
picture you remember of the heart which
was too detailed and the heart which was
too abstracted something in the middle
so if you write the reverse function as
the identity function then you are a
malicious programmer you know how we are
going to test this and you try to shoot
the system most of you are not like that
so you write something which is
reasonably okay and therefore this will
work for finding errors but if you know
how things are tested you could always
find something that actually is some
function that will break this property
it's just one property you could of
course add more properties you could say
well the length of the list should be
the same but the identity would still do
that you would could think of something
more you could you are like the unit
that's whatsoever it's finding the right
level of abstraction to make you find
books with not put too much effort in
doing so and that's the balance here how
often do educators happen
okay so in my experience if you have
Roger yes I think the question is how
often does it happen that you specified
something wrongly to details or to less
detail switch that when you change your
implementation it fails you have to
change the property so my experience is
that depending on where you start if you
start with the property that you have to
change it often because then you're in
the experimentation phase of what what
you want to do if you start inviting
codes and then you write a property then
you'll know what the property should be
for the code and they changed less often
and if they if you have to change them
more than once basically there's
something wrong in your design somewhere
else you you don't really understand the
problem domain or you have
misinterpreted
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>