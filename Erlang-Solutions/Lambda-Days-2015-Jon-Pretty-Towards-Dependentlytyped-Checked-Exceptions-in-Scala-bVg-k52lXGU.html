<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lambda Days 2015 -  Jon Pretty - Towards Dependently-typed Checked Exceptions in Scala | Coder Coacher - Coaching Coders</title><meta content="Lambda Days 2015 -  Jon Pretty - Towards Dependently-typed Checked Exceptions in Scala - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lambda Days 2015 -  Jon Pretty - Towards Dependently-typed Checked Exceptions in Scala</b></h2><h5 class="post__date">2015-04-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/bVg-k52lXGU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is this will be a bit different
from from that one yeah the Patrick
crazy album was was something I did
because I didn't understand it and I
hope that I would I would understand if
I'd in by the end of preparing the
presentation I never really did but so
yeah maybe it's worth watching anyway
today I'm actually going to give a
slightly different talk from the 1i I
plan to give a couple of months ago when
i submitted the corporate papers but i
will do I will do the original plan talk
just in the first 15 minutes so you'll
meet it'll be brief for the night I
wanted to speed but the reason the
reason is like I discovered through
through through visiting the any scholar
conference in in Boston oh what's turn
out to be really great idea that gives
us I believe dependence might protect
exceptions in in in Scala so the first
the first 15 20 minutes or so i'll be
i'll be talking about how we can do
better diagnostics and an exception
handling in my my my rat to live reasons
you can jason and xml libraries which
does actually segue quite nicely into
the it's the last part which will be on
on these leave these new fangled
dependent i checked exceptions which I
think are potentially very excited for
Scarlett so that's that's a rough
schedule it's indeed the schedule of my
slide so it's unconstrained buyers so
who here has one who's is a scholar user
everyone accepts everything what are you
used
okay who who uses Jason or well who's
Jason so maybe right oh it seemed that
mostly before you're more reluctant to
put your hands up who uses xml it's
probably all of you you don't want to
put a hand up at all okay so we we have
we have Jason we live in a world where
it exists it's a dynamically typed
structural good muscle of the language
but a way of web defining data and one
thing you can do in rapture actually
who's use rapture JC du Midi with some
tumbleweeds rolling across the room so
yeah I've been to a bit to crack off I
think four or five times know is I think
it's my fourth or fifth time and I
always talk about rat to Jason and you
always give me a really good response
yet none of you are using it so what
about what am i doing wrong tell me
afterwards but in rap sheet right
literals in Jason so you can write
something like this so you say oh cuz
new value J which subtype Jason and then
you literally put the JSON inside the
string prefix it with the letters J no
it not sir that's a string context and
scholar that's that's a feature of
scholar now you can also the same with
XML so there's a raptorex and our
library if you if you really have to use
XML and we can do the same thing now
what that used to do is it would
compile this may be fine and then at
runtime it would pass it and what what's
the problem here anyone tell me yeah
folks all right well there's no quotes
around food so in JavaScript you're
allowed to type this but this is
actually valid JT doesn't doesn't meet
the specification so this would be a an
error now previously I said that'll be a
runtime error which we don't really like
because we'd rather know before the
copious into production that it's a
problem now a new feature either to the
rapture Jason recently was compile time
checking of these literals so this is
full now if you write code like this it
will say fail to pass with Jason after
all and it'll tell you exactly what
problem is so it expects you to either
quick actually it is pointing the wrong
place the default that's being used is
it's meant to be a mono smokes pot in
this actually proportionally spaced this
happened between me switching from
Firefox to crow so Crohn's using a
different font for some reason and this
is actually meant to point to that
affair which exactly where the error is
occurring so you'll have to trust me on
that but it found that when it expected
one of those two things so we now get
these nice compile errors so this is an
improvement over the previous situation
if we have a substitution we've such as
a value into the JC we also get an error
if example back that substituted value
appears in the wrong place so that that
is better than it was before and this
works right smelled I'm not gonna show
you an example because we see enough XML
already
so here's an example of some sun shades
this is representing a football match
does anyone know the outcome of this
match sorry oh come on 22 nil to photo
right yeah yeah okay so Jeremy play
Poland and generally had a run of
30-something wins and then poem
destroyed them at home I was actually in
water at the time which is the only
reason I know about it I don't follow
football but I maliciously this an
example of Awesome Jason never go to
work with now you see we've got some
players now I've actually I haven't
written them all down but there's a
litter sequence or list of players there
and there's the German German players
and this is this is consistent for every
single player we get a name and number
and another position likewise patine
here is roughly the same structure
exactly the same structure as the team
here and the whole thing we might
consider is a is it's a football match
so what we can do in rat rejection is
this the beach that's been there a long
time we can we can describe a piece
class for player so it has a mange the
string and a number an integer we can
describe the team as being last names
are the Germany or Poland in this case
and a set of players so this is a
sequence and this is Earth this is the
player we've defined here likewise we
can describe the whole map like this and
one really nice thing you can do is you
just say J that's the Jason from the
previous slide don't as this means
extract from this dynamically typed
Jason a statically typed match ok so
we're moving from the dynamic world of
Jason to the static world of scholar and
after that we can we can relax abit was
when there's no risk of
anything going wrong due to a typo so if
this discourse exceeds we're happy well
do we have a time for addressing itself
I mean I would like to treat drink under
some key yes that is another day some
parking structure uh yes talk to me
office without that'sthat's yeah I could
go into another depth about different
features of rapture Jason this one I'm
just aiming to talk about that than the
new features which relate to compile
time checking and exception but the
answer I think is yes but yet talk to me
afterwards so we can do this and it very
nicely generates an extractor for a
match and the reason it does that is
that what it knows it can extract string
strings are easy to extract from Jason
that's not a string now team well
there's a team to find here so it knows
you can in fact that if it can get the
this parameter here and this parameter
now set of players well I can be both
players here you can expect a string you
can extract mint therefore the set of
players can be extracted and therefore
the whole thing is extractable and it's
completely happy to generate on fly an
extractor for a match and that's what we
get we get this if you can call to
string on that match we successfully get
this I'll i put the dots and again to to
avoid it fitting a whole page so that's
all all quite nice and it makes it very
trivial to if you've got a case of glass
structure that matches your your Jason
it's quite easy to to get that out now
what if we are you notice that I had a
position on the unnatural JC where I
have both goalkeepers and I've typed
this in something called position so the
questions can be extract a player well
if we can expect a play if all of
parameters are themselves extractable
from Jason now position well this
happens to be a trait we've ever
you'll have several different case
classes or case objects in there but
I've got to find anywhere how to extract
them it doesn't know how to extract
things that the alarm case classes or
primitives or some kind of collection so
this this isn't currently extractable we
can find a way later on but right now
it's not so if we call Jaya Jaya as
match this will fail and this is the
area used used to get contract type
match from this adjacent side now that's
not very useful we happen to know the
position is the problem but this isn't
very useful in directing us to position
as the cause of our extraction problem
because this will be trying to get a
match but it could be any of the
parameters of match that fails if we
assume it's team it could be any of the
parameters of team that fails and if
it's the players I mean as soon as the
players it could be any of those
branches which good felt we're a luxury
position of knowing in this example a
little bit of this position but in
general it could be a massively do tree
of more page glasses but that's cause it
to fail a compile-time to extract and we
get no information it's a basic
education at and we now get this is
rather long explanation as to why it is
failed but this is the original error we
have and then it says cunt generally
freedom backwards contributor Jason
extractor from for match because the
parameters team one team two of type
team copies out again then teen points
to team can be extracted because players
players and then we get to the root of
the problem which is the position can't
be found so can't find an extractor for
position so we can fix that and
work so that that is an improvement over
ho / the current situation now when when
you're working with with jacent assuming
we've we've compiled everything
successfully there's a there's a there's
a risk it's just a slight risk the data
we're parsing and trying to try to
extract data from or values from might
not be correct it might have missing
values it might have things that are in
the wrong place typed incorrectly
because it's jason and the format itself
although the protocol doesn't have a
schema which enforces or typically
doesn't escape which enforces that so we
can encounter errors so value i'm
missing or if its present it might be an
int when you're expressing a string or
or or even an array when you expect in
objects these are all useful
possibilities that happen to anyone here
yeah nothing so a simple simple solution
to this which which wasn't true couple
months ago is that it get very clear
exception it tells you exactly word from
this so if we try and try and call as
match on that maybe well well goodness
this was a different example but if you
have an object with key food which has
not really key bar that is not present
so that is present is the wrong type we
get a full explanation as to
as to why us why that's fails likewise
if if the value there is just not
present it tells us it's a missing value
so that that should point you directly
at the at the problem so I'm going to
talk a little bit about modes who has
heard of modes so you've heard about
them from me presumably so motor I'm
very excited by most i've been i've been
talking about them for a year or so now
and modes are a way of deciding how you
handle errors or how you home how you
represent things that might fail so a
quick poll who's is scarlett or try okay
to use either but yes either something
why do you use either rather than try
though I'll come to that later because
my favorite perception but it does
sodium sets up except so that there's
there are reasons to use either over try
so I'm gonna use option to represent
failure hoxton none summon them yeah so
these are all possibilities and there
are different different reasons for
using one or the other and actually who
uses trying caption just throws
exceptions yes I mean it did there are
uses for it and a great benefit of
throwing exceptions is if you're working
the referal you don't want to have to
get at Ryback and have to unpackage that
try before you can use it you sponsor
what a quickie deal with the problem and
the reckless particular annoying because
you're not going to reuse that codes
it's right write once run ones
so this is the cool i made before
exactly the same jada as match and by
default in rapture if you don't specify
otherwise it will vary exception that's
the default now what you can do is you
can port something if you import modes
return option from the rapture core
project Raptor chorus at the baseline
project with a few useful utilities I
using all of the rapture modules if you
import return option I mean call this
exact same method this is by it provides
identical it will now return something
different will return at some of the of
the usual return type or if she fails it
will turn up the exception will be
discarded but we'll get a man back so
we've configured how our methods will
will work basically with a lit with an
import and you can scope those imports
you would as you would with any other
important places so that's some I mean
that the existing a bit weird is yep
yeah it's yeah this is a couple ways to
think about it 11 is that is it's using
a type class with a high kind a Titan
and constructing an implicit depend meth
dependent method typed return value the
other way is that it's magic and it's
it's reasonable just receive its magic
most of time I I haven't found any any
obvious leaks in the in the abstraction
so what I do most times I i I'm porter
mode and I just use it and it's as if
that method was written as it could
always return an option we could also do
return try and exactly the same code
except this time we get a success or a
failure and failure would contain the
exception that stopped it completing
is a his quad core one we can port a
future most of its own future and as
long as we've got a NEX acute in context
in scope as well this will return a
future of the match so with just one
well 22 imports in this particular case
we can now deploy our methods on to a on
24 joint ball and there'll be executed
synchronously yes question I'd like to
ask one of the benefits of important
implicit execution mode as opposed to
let's say synth xjs option of match so I
urge a leadoff options all right so you
can actually write option to match if
you want to and it will do basically the
same thing so one of the benefits of
this solution because you you are
getting option match anyways so yes
forward yeah so we took the given in the
case of gene the add method the type you
provide here does you can include be
that the modal type if you like there as
well some methods like pars you expect
that to return adjacent jason top ours
will return a string normally you don't
you don't have an opportunity to specify
the restaurant type so in those
particular cases it will it will return
them the mobile version of Jason so the
biggest benefit seems to be that you
don't have to ride option of thousands
of times for example um I think it means
you can hear possibly yeah you can you
can change this and put things into a
full comprehension and then as long as
the for the mode type you use is
muriatic you just change the important
it changes the whole thing very very
safe so some people were using either we
think we can do that as well we'll get
either a bite match or a left of the
exception type and as we discuss it does
actually encapsulate
the actual exception type now this is
pretty useful if for example we want to
subsequently match all that now the
reason is that well it is successful we
get we get this right version and we can
say a matched great if we get a failure
we can put one possible to lack of data
get exception which is a tiger / and
it's got single two parameters and we
can reach deal with that somehow i'm
just going to print out bad type here or
it might be missing budget is missing
missy Bradley there is no I'm not
missing baby but you can you can even
write both both both or have many
branches that are now data get exception
happens to be a sealed trait which means
that if we were to forget one of these
said you've got missing value we would
get a warning to say that you haven't
handled missing value the Scala compiler
will axles tivity will check for
exclusivity the seven places you provide
and if you forget one it will tell you
so that's that's pretty useful okay so
I'm probably about halfway through every
time so I'm about halfway through so I
think we've got time for a commercial
break so i am going to vary flea promote
my my conference which is scarlet world
and is happening in September in in
north of England in other if you can see
the images changing the background it's
one of the most beautiful places in
UK in the Lake District and everyone
who's at the back there will be will be
speaking it's a scholar conference and
we needed them we needed a wild card and
we've also got I don't if you know these
guys agen d bill and George just just
been cut off there they're all speaking
and I'm gonna be announcing more
speakers over the over the next six or
six or eight weeks so the website is
scarlet doc world it's a great domain
name and if you if you just type in your
email address there I'll let you know
when registration opens and hope you can
all come so that's that's that's the end
of my my brief commercial oh this
question especially is a previous life
sorry a slider system not for their
roots ah the left data type sorry don't
know the one when you mark on the right
sorry the other other pics i took this
on yet yeah if i did the import computer
option so this whole match will find in
the compile this won't felt a part time
because the these types here are not
either riders or you busy yeah so
results of Stan Hixon camera so I all of
these all these failure types i've shown
you so far have some deficiency there's
a few things that I'm not happy about
two in particular we get we get
different kinds of exception some of
them we kind of expect to have at least
they're there they're sort of likely
enough for that particular method call
that we should expect apple to handle
afterwards others like out of memory
error it could happen at any time and we
don't have probably a standard way of
recovering from things like that so we
might want to distinguish between
between the expected exceptions and the
and the unexpected and also there might
be if for example we're extracting data
from from Jason there might be more than
one failure in the process of going
through that extraction so if for
example we were extracting those both of
those those players from taking it might
be the three out of the out of the 11
players actually has a has a problem now
normally you can exception thrown at the
very first one now that exception sort
of breaks from the normal normal flow of
program and you've got no way of getting
back and then trying the rest it's given
up and that's the end of this we've lost
we've lost the sack so we might want to
actually collect all of the exceptions
that happen or all of the failures
probably some calm exceptions because
they're necessarily something else if if
they don't if they don't break break out
the stack but collect all of a famous
and the the example of showing up until
now don't really do that so I've
introduced the results type which like
I'm gonna spit like I but in that has a
successor site and it has a failure they
decide so I'll go talk through this but
this is this is the this is what's going
to allow me to do dependably tight
checked exceptions in Scala so it's got
three possible states there's an answer
that's the success
case so we try something we get a result
back the result is an answer which
contains that successful faggot so in
the ad match example that would be a
match we have an errata type which is a
collection of all the all the failures
that have happened when when when when
doing that method call and we have an
unexpected type which is which will
contain a single exception and that will
be the exceptions we didn't anticipate
the out of memory errors the stack
overflow errors we probably don't want
to catch these or at least we don't want
to we don't want to be forced to catch
them having to catch or process or
handle every other memory errors and
stack em players everywhere is going to
be very very tedious so I me also don't
want the program to continue after one
of these happens so we will collect and
most one of those in the unexpected side
so these are three possibilities okay so
it's a mode we have a mode just like
just like the others and we can report
it so what we do we can try and get a
string from that original Jason here so
team one main as string now think that
was Poland so that's successful great we
get answer moment now let's try and get
the 20 / 20 first player from from that
so that's see what's going to happen
here any guesses right there are two
yeah of
missing missing veyron drawing 20
players so we get in the router and it
printed nicely like this so it gets
listing value and there's the message
problem from missing value and it tells
us as I've said before exactly where
that problem is that's good what about
this t1 name as string any guesses any
other guesses unexpected we didn't
expect that did we it's not so proving
the point these could happen any time
and we don't want to we don't want to
put it into an errata we want to stop
immediately and get her alone try and
try and find a way out of this this this
hell of an outofmemory error so who uses
scala said to use validations so
validation is quite nice and you can
collect up a number of different
failures in a single result but it does
i think require you to write your code
in a particular style I don't use
scholar said so I don't really know you
do have to change your style little bit
that's not the case with we've been
using the result mode so if we were to
do this as I said there might be a few
areas with with getting players from the
team so we get a list of these they're
all missing value exceptions and they
are listed one by one and basically that
the number is it is missing there the
mange missing on these two so there are
there are obviously issues with this
this jason but rather than just getting
the first one we now have all of them
is that okay I have one question yet
like on the last slide you if the costs
are some other patients who have on the
music value or are so if the is the
constructor of the team well the case
class yeah then that would be an
unexpected exceptional yeah so you might
decide that you think there's some
likelihood that your your constructor
with it a man like let's say man version
be between 0 and early right and it's
8000 hang on until the end and i will
show you an example so yeah we've gone
missing value here and this is what we
want i hope so run myself where where we
are so normally be the ass method
returns this is kind of related to to
what you were asking it returns a string
a day to get exception remember missing
value is a is a subtype of data yet and
it kind of having that return type
instructors that that's what we need to
handle we need to handle data getting so
what one thing we can do is anyone use
recover on Scarlett ill try so it's a
way of getting out of the era case and
back to a successful try so we can
recover a specific type in data get
exception and all of the data gates
exceptions that happen to to be
contained that errata we can handle them
how we like but the return type has to
be the same as the successful time so we
just can be lazy for now and say if we
had any of those then it fails now
what's the return type of of this is
that doesn't even the question that'll
be a question on a couple of slides the
color slide Stein
so here here are here are two other
things you can do with with rapture you
can slurp you can select characters from
a file or could go wrong well you might
get a read exception you might be some
reason why that file can't be read so if
you're in if you're in the result return
results mode then the return type would
be a result of a strange the successful
case or a reading exception likewise if
you pass some Jason sauce then ideally
would like to Jason but we might get a
part of section so we can put these into
a full comprehension the first one we're
going to take this uri with this
decision to the URL and slurp it so we
expect string those we can expect source
to be a string here and then assuming
that works we can pass it and assuming
that worked we can extract the first
player as a string if they're probably
seven name in there yes we players more
domains or as spring but we expect to
get a string from that now why does this
work in a for comprehension they won't
tell me they'll all say melodic I think
someone did so the the result type is if
it behaves is technically not Aman out
but it behaves a bit like I'm on adding
that you can you can flat map over it
which means that as long as all of the
right-hand sides here are armed on us we
can we put them into this for
comprehension and we can get a a result
at the end so what what's this results
not going to be
given that we have real exceptions
possibly being thrown past exceptions
here and then there's the potato get
exception what what are we going to
return here so good that's a good guess
it's not knows not so good it's well
your your clothes for the cocoa right
yeah I mean it's a try no I have the
answer is it's not there it's not there
next slide here we are it's a result of
a green exception with a poz exception
with a day to get exception these are
all possible things that could go wrong
when we call that method the co prod was
a really good guess actually but i'm
actually using an intersection type so
this this probably looks very strange
because do we ever get something which
is a real second and is a part exception
and it's a day to get exception well it
doesn't the Brandon instances among
thing so why is this top well we don't
actually have actually ever have
instances of this this is this is kind
of cheating in skul this is using a
intersection type when we want a union
type but scholar doesn't doesn't do
union types I think dotty Wilden Union
types with scala at the moment doesn't
so we have to improvise and we do that
with a within section so what I want you
to do is read with as if it's all so we
get a read section or a parsec system or
a date exception
this is now selling this all things we
need to handle in that result I should
credit Christopher Fox who described to
me a face the idea of using the
intersection type representing Union at
any scholar at Boston a couple of weeks
ago and this kind of form the whole idea
so I owe to him to coming up with the
initial idea so the errata type you've
only seen examples of her after at the
moment with a single single kind of
exception so as a missing value
exceptional it can hold multiple copies
net index by type so it's like a map was
it in fact a multi map index by type and
that that is what Chris's team apps so
given given this player named this this
is this is the value from the previous
for comprehension what we can do is we
can recover just the reader exceptions
so if there's a reading section one of
these X's we're gonna replace that with
the screen so we're giving up make it
into the successful tightly the answer
and they get replaced so great we've
replaced all all the ribs read
exceptions with strings so we get this
return type this recover method now
returns this without the without the
reading section as part of this
intersection so we can carry on we can
we can recover really ception then parse
exceptions then day skate exceptions and
those are all the possible exceptions
that can happen unless it's something
unexpected and unexpected exceptions
it's it's tough you've got
you've got handling somehow now what
this particular version does it converts
all them into successful cases now this
could be a bit inconvenient we don't
always have a successful case so what we
might want to do is to transform those
areas into something else so we can use
the map exceptions method so each read
exception we're going to transform that
into something I've just invented called
access except it's some exception
representing a failure in this in this
particular it's tiny little application
I've written so we've read exceptions to
access exceptions we're going to convert
piles exceptions to access exceptions
and we're going to convert data guess
exceptions to access exceptions now it
might give an access exception provides
a very nice general way of presenting an
error to the user so we've unified them
and I created them and we now have a
result of predation is successful
actually no movie Spring was no sorry
I've had a successful string or an
access exception so we've nicely dealt
with all these exceptions does that seem
cool exciting but only just sigh ah yeah
whoopee there's one issue with matching
winglets unless these three exception
types happen to be sealed the pop-apart
have a common seal super trait we we
don't know for certain that they've all
been handed so yes you could get all the
exceptions and password children just by
doing it as instance of check or colon
the exception type but the compiler
wouldn't help you in guaranteeing that
they've all been handled in this
particular example we're tracking with
every single
every single call to malloc exceptions
here what exceptions are remaining in
that typed map yeah I'm sorry you are
not mark inception but through cover and
there are no exception set yes it's a
nothing I was the type here yeah yeah
it's so special three hours or so what I
I have matching bunch of this part of
this viscous this returns well if it
turns a result of string comma nothing
but you can you can still a call don't
recover nothing from that and then what
happens there so what I think I want to
do is return a new type here which will
be a lot like try so if you think of try
is being a two by state exception holder
it's neither successful or it's an
unexpected failure which means you will
be able to call the cover here it's just
not not hardly a guide so this this
whatever you deal with the final recover
i am using macro states make this work
the the scalar type system isn't
expressive enough to allow me to
subtract types so i have to use a macro
to to look at the types remove them from
the intersection return something but
because it's a white box mac pro i can
return anything I like so I could just
invent a new type or insert another type
in my my result hierarchy that
represents the result recovering or
mapping a mapping away from the file I
to which be recover
in the final microsecond sorry Sagan for
something off the mark or the name of
the macro oh well known it recover
because of the recover method is
infamous with a macro and it looks at
the type and returns always returns a
result but it will modify the type to be
exactly what we want so this is I think
this is quite cool as anyone doesn't
know cuz he can just sell it and type
and type in this because telling takes
it high right time and eat eggs from the
argument you pass the select that I you
expect and personal does it does it does
it does it track we well yeah yeah yes
okay you see next thing yeah I'm good
friends with miles but I took uses
software this isn't being video oh hi
miles yes so so I'm sure shapeless could
do something similar I don't identity
protection I don't I don't believe shake
sorry crazy yeah crazy bachelor signals
yeah I'm not I don't think shakers has
any specific error handling
functionality which is kinda what i'm
showing here uh has anyone noticed the
the elephant in the room so this is this
is something java can do already this is
this is basically the same as declaring
the methodist throws so
it seems I mean when I got this working
I was really pleased it may made sky
well I can make scar a whole lot safer
because it forces you to to handle
checked exceptions and it's really
clever because it can track track where
those exceptions are truck track calls
to any method that might be an exception
and will activate all possible exception
types but that is just what Java does
with with checked exceptions so in the
scala context it's spectacular java
content isn't mad as we saw this so
where am i going to go from here i'm
going to interaction to interrupt the
various libraries I've got there it's
already working with the CSP library
which pretty pretty small library but it
seemed a good place to attempt this
first and that appears to work
sufficiently well for me to be confident
to give this talk it's always
embarrassing if you give a talk and then
did discover later on but what you
described is actually impossible but I'm
confident this does work I've seen it in
the limited context one thing we could
do you notice the arouser type just
returns a list of all the all exceptions
under each particular paleo type what it
could do is it could it could take over
the what what what the what I showed you
earlier on with the the failures from
Jason where it records the path into the
Jason whether the problem occurs at the
moment I've got two more time I Jason
library or as my Jason language does all
the hard work with tracking where that's
that exception where the fade it happens
so it's the food of Bardock as element
six that's the Jason I were just doing
the work that could actually be done by
the by the result mode
so I'd like to explore that I think
that's that might be quite easy to do
and you could you could also have it
have it give you a nice most path into
into any kind of structure you like for
for any kind of exception type so
there's possibilities there now this
this is this is one step further I can
take it now you saw the extraction
happening before where I extracted a
match based on the parameters those
those that the distraction is provided
through extractor type classes so it
resolves extract type class every
particular type that's used in in each
of those cases now those extractors are
typed only on the thing they're
extracting so that's constructive the
sprits abstract of things but we could
make the exception that that extractor
may throw part of the extractor so we
can add a type to it you can change the
type from extractor of disagree spring
in even list of string we can change
that to extract or a string of spring or
int with some type in here some
exceptions like so this could be i'm
going to divide by default it would be a
day to get exception there's always the
possibility that the value isn't there
or it's the wrong type but it could be a
validation failure could we could
successfully expect a string but it
might be the wrong format so this is
kind of the question you asked earlier
or the extractor could be doing
something clever like reading from a
file now if the extractors reading from
file there's a definite possibility that
might fail with something other than a
day to get accepted it might be a really
exceptional or or anything so the
extractors naturally all to encapsulate
in some way the exceptions they
they make throat so what happens i
mention this briefly before when when
we're getting but when they're trying to
extract case class we have a macro which
generates the extractor on the fly well
a compile-time on demand and it composes
a set of extractors one for each
parameter in the case class into a
single extraction now what we could do
is we could look at the the x types in
all those extractors this is the new
newly added exception type and we can
find the intersection of all of them and
we could make the new exception type so
that's the new extractor type that we're
generating be the intersection of all of
these all of the possible exceptions
that all the extractors for all of the
parameters might throw that make sense
so if any of them if any one of those
throws a really exceptional and past
exceptional some other random exception
that with that we're tracking through
this type here then there's definite
possibility that could be throwing when
extracting the whole the whole thing the
whole case of us so we would define our
extractor as typed on this is this new
intersection and one thing we need to do
is normalize so if we have exception one
we accept from one with exception to
well these two at the same type so we
will norm i sat in macro to just a
single key one and that means that
whenever that type gets printed to the
screen we get a reasonable result
so that that means if we had a mind my
running out of time my overtime draw I'm
overtime okay yeah oh I love this if
this is my it's my last five yeah so
what we can do is we can add an ox
little market rate to a string here now
this this this means does the string
validate as a name now let's make
something I'd let's say it just got a
calculator the beginning in the rest is
low case then that's about it made and
we can define an extractor yeah I have
actually show you the implementation but
I'm going to say this extractor could
fail with the validation type of a bad
validation exception so when we call
Jason as match the results like we get
has that validation exception even
though that validation exception is deep
inside player which is referenced by
team which is referenced by match it
still gets traced through all the way to
the result type here and we are forced
to handle it which is exactly what job
at us once all the time you don't do I
guess so so thank you this this is this
is the key difference in with these
rapture exceptions you can use a mode
sir monologue in Java you can't you
can't say I stable yeah so you can
switch for different modes when you
don't care about these exceptions or
when you can
to deal with in some other way so that's
that's the nice that's what makes it
better than Java so that's that's all I
got from these slides here but I'm good
time for them thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>