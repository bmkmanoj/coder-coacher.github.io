<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Chicago Boss: A Web Framework Built for Comfort (and Speed) - Evan Miller | Coder Coacher - Coaching Coders</title><meta content="Chicago Boss: A Web Framework Built for Comfort (and Speed) - Evan Miller - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Chicago Boss: A Web Framework Built for Comfort (and Speed) - Evan Miller</b></h2><h5 class="post__date">2013-04-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LGGo6bIuj8w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Oh wonderful okay yeah find a seat
everybody
be talking about the web framework I've
been working on with growing and active
community for the last few years it's
called Chicago bus I'll tell you in this
talk I'm going to talk a lot of sort of
philosophy and engineering philosophy
that went behind it because if I just
talk homey
my jacket here I just you know showed
you the API it looks kind of similar to
other web framework API so it really
comes down to a question of why Erlang
is so well-suited for web development
and there are very specific engineering
reasons for that but before I get into
them let's talk to you about me or at
least my history and software I worked
for a 9.com down in Palo Alto I don't
know if anybody was been by there but if
you're gonna Caltrain and you go through
Palo Alto you'll see the big a9 sign
still there and I actually I was fresh
out of college and I tried to get a job
as a software engineer cuz I knew
somebody there but I didn't actually
know anything about computers or
software so they they said well you like
to wear a pager for us and instead and
tell us when our systems break so go
okay that sounds fine and when I moved
out and my first week on call I got
paged 110 times so there 168 hours in a
week and the crashes of C++ programs are
kind of like a Poisson process so they
you can imagine there's that's kind of
spread out evenly and I did not get a
whole lot of sleep so that kind of
introduced me to the dark underbelly of
network operations and website
operations but of course it was a lot of
fun because like I was on a team with
six other people and we got to drink a
lot and try to drown our sorrows but I I
left there to take a job across the
street at a company called IMVU
was starting to be a little bit famous
as the first Lean Startup there's a
really good book by Eric Ries about Lean
Startup practices and continuously
deploying new code and that's something
I really liked that they did they would
constantly push new features out because
they were they had fairly good test
coverage but it's something I'll talk
about today is that the formula didn't
quite work because the tests were really
slow and if you're trying to constantly
deploy something and your test takes
several hours well you know people are
human they're gonna say well I'm sure I
didn't break these tests I'll just push
anyway and pain and suffering ensued so
I got to know all about pain and
suffering of Silicon Valley on the
operational side and the development
side and that kind of informed or made
me want to search for something better a
better platform since then us to decide
something that sounded like a lot better
than having a job was not having a job
and I went to grad school it's starting
in 2008 and that's where I've been since
I've been a Morgan I PhD in economics at
the University of Chicago so this is
just a hobby project some people thought
like oh there's no company name on
Chicago bus is this some secret ops like
no it's just it's been a hobby so I
thought I'd just answer that question
and by the way and the rest of the talk
if if you ever feel like interrupting me
or asking a question please do that
because I really just want to make sure
I'm talking about things that people
find interesting
so why Chicago bought well first of all
I want to talk to you about that a
little bit about the name
this was inspired by a database I was a
little unfair way today that the time
but one of the early no sequel databases
Tokyo tyrant which was just put out by
some guy living in Japan and I had
gotten pretty frustrated with doing
schema migrations when I was working at
at IMVU and so no sequel seemed like a
nice painless solution to the problem of
taking down a service in production and
moving all the data over and cetera so
sort of where the name came from an
homage to Tokyo tyrant since then we
supported a lot more databases
but another thing that I liked about the
name is that it's it's it's kind of
political this is this is a picture of
Edward G Robinson anybody know the movie
Key Largo 1948 with Humphrey Bogart he
plays a Chicago gangster I just liked
this picture a lot so I thought I'd put
it up there but I think it's important
to keep in mind that technology and
information and power are very
intimately related in our society and
you know technology is it gives us
control over nature
it lets us communicate it lets us
collaborate and sometimes it gives us
power you know over other people and I
think it's it's important to realize
that role that technology has
information technology in particular
there's a really good book OUP's called
the control revolution by James Ben
occurs from the nineteen eighty-three
and he talks about control in a very
technical sense of control theory sort
of comes from operations research which
basically says that in order to control
something you need good information
channels in place and particularly you
need a channel for issuing commands and
you need a channel for getting
information back so you can see what
you're controlling so for example a
thermostat will have both a mechanism
for increasing a decrease in the
temperature and then a sensor to see
what the temperature actually is it's
sort of in our society as we got better
information technology structures in
place through the 20th century it enable
us to have much larger organizations and
organizations that could coordinate
action over larger and larger spheres of
influence so I just say all this because
I think information and and control and
power are very very well tied together
and I think I think our line is actually
gonna play an interesting place in the
development technology one thing in
particular I think is kind of scary is
that we have just a few organizations
that are emerging that are controlling
the information infrastructure and a lot
of that has to do with economies of
scale that
get out of controlling those and if you
step back and think about it you've just
got a few organizations that you know
control our most people's rate you know
representation of knowledge emails
newspapers magazines these are all
getting digitized and they're all you
know being controlled by a sort of a
frightening Lee small number of entities
and I think I think it's kind of scary
actually so what can we do well back in
the 80s there was a guy named Marty make
Armstrong who decided to go to the
future and get a programming language
and bring it back and that of course is
Erlang and I think it's it's it's yeah
even though it's 25 years old I think
it's still 15 years ahead of everything
else and I think that's that's why we're
all here and I think it's it's something
that's going to help us build the next
generation of information technologies
so what did Chicago boss have to do with
this it's a goal the project to reduce a
typical web sites operational cost by
90% that's that's a goal and it might be
even be conservative based on the
numbers I was hearing from Alex at his
presentation yesterday very conservative
and what is that you know reducing costs
you could have sounds good to everybody
but I think we can actually enable sort
of qualitatively new class of
applications and new class of websites
so right now to run a popular well
traffic website you need a large
organization even if it's nonprofit you
need a huge bureaucracy you need a huge
Operations team if you're Wikipedia if
you still have hundreds of servers to
manage dozens of ops people etc so I'd
really want to be able to leverage
Erlang to make websites that more
marginal groups can use or that you know
maybe just you can build a website and
have hundreds of thousands of people use
it and not need to build out a big
infrastructure or formal legal entity to
support it and as I say here hosting
your own stuff represent
power and independence and I think
that's really important so finally I'd
like to enable sort of a new generation
of applications that you can deploy and
that someone can write an open source
web application and have it just not
need any care and feeding
after you set it up and get going that's
what we're hoping to do with the Chicago
boss framework so what is it here's the
analogy I like sort of is to Ruby on
Rails with engine access to Apache which
means it basically it's designed to do
the same thing but it's different in two
very specific ways that I'm going to
talk about first is non-blocking Network
IO
and I'll get into the exact engineering
benefits of what that means or the
second that people don't talk about in
web development nearly enough is no copy
memory our architecture and I'll explain
why for the sorts of applications we
have early I actually will do a minimum
number of copies which gives you much
much better performance than you'd have
otherwise so you know if you look at
information or talks about something
like nodejs they'll keep emphasizing the
first one but it's the second one that
will give you a lot of wins as well so
in short we just want to be faster
better and cheaper the project started
with this project called early DTL which
is an implementation of the Django
template language I was started by
Roberto Sakon in 2007 and I kind of
discovered it about a month after his
first commit where it looked like he had
done the first 90% of the work in
implementing the Django template
language and so it was left to me to do
the other 90%
yes there's only 90% left so I want to
talk a little bit about why I'm not
going to talk about the syntax of Django
you can go to a Django conference if you
want that but I do want to talk about
the memory architecture and implementing
a template language in Erlang and sort
of my punching bag will be a ruby string
versus an Erlang I olace but this this
is really a stand-in for any other type
of string structure and PHP or Java or C
sharp or anything else anything that's
not an i/o list these the things that
I'm going to say will apply so the first
is if you want to do a concatenation or
if you want to do an append so you're
building a template you got the header
now you want to add you know a heading
or you want to add some other variable
well what do you do well in Ruby you do
a concatenate you know string dot concat
and if you look at it it's just a mem
copy it'll say string to copy into
string 1 whereas with Erlang when you're
building an i/o list you actually just
do a cons operation on the list which is
in order 1 operation so you've got two
pieces of memory say oh well I'll build
a list and the first element of the list
will be this and the second will be that
rather than getting this and copying
into all the way over into here and that
will give us a number of benefits so the
if you come from the sea world the way
that I like to think about it is that a
ruby string is just a pointer and in
Erlang you've got a pointer to pointers
and that implementation goes all the way
down to the network level so the the
underlying right function in your
operating system and if you open up Ruby
it'll just say write this pointer to the
socket in Erlang with IO lists you'll
find a lot of right D's on UNIX which
says I've got all these pointers just
take all the data from all these
pointers and send them over the socket
so you don't need to copy them into one
large piece of memory before you send it
which is a really great implementation
detail that works really well for for
templates and a lot of this benefit that
we'll see comes from data mutability and
something that Erlang can do because the
data is immutable is have a much lower
memory footprint so when you in the I
think was starting with our thirteen or
fourteen when you when you compile a
module and you have a binary literal
which is will be something like a
template header that will just occupy a
constant or a static piece of memory in
the binary heap which means that the
shared template snippets will actually
occupy the same hunk of memory across
multiple requests and this is a huge win
from the perspective of your memory
footprint so if you have a hundred
concurrent requests and something like a
Ruby or PHP it'll be constantly creating
new rendered templates and have a
separate chunk of memory for each one
whereas in Erlang with these i/o lists
for all the stuff that's shared it's
just a pointer to the shared part which
gives you a better cache head ratio on
that and that sort of thing so the
practical benefits here are really
important tests run quickly on rendered
early DTL templates they're really fast
and that means you can you can just work
much faster and be a lot more productive
so it sort of solved the problem that I
personally experienced that in view
which is that slow tests were just not
being run and you had people this kind
of doing fake test-driven development on
account of the development speed the
other big benefit of courses just has to
do with using fewer servers to
accomplish what you want and finally
your application logics is a lot simpler
so if if any of you are Ruby on Rails
developers using the latest version and
keeping up with the 37signals blog they
advocate using all kinds of complex view
cache hierarchies and you've got to be
really vigilant about cache expiration
and keeping the cache and sync with the
database and that sort of thing
if you can just eliminate the cash
because your views fast enough then you
that just eliminates all kinds of
application logic and all kinds of
problems so it's a really big win in
terms of server-side templating so next
I want to talk a little bit about the
Erlang VM and sort of the other reason
with other engineering reason that
Earling is really great for website
development and that of course is
non-blocking i/o so if if you already
know everything there is to know about
blocking a non-blocking i/o you can
check your email for the next couple
minutes but I just want to make sure
that everybody sort of appreciates how
much this helps so if you've got a
blocking server it will basically
anytime you go to the database or do any
kind of network operation you're gonna
need a separate process to sit there and
wait for a result and in most languages
and applications that'll be an actual
operating system process erling of
course has these green threads of these
Erlang processes which means there's
just one operating system process or
typically one per core that you're
running on and as a result the the
memory footprint is much lower for
handling a lot of concurrent requests so
usually you'll measure it in the
megabytes for something like Ruby that
has to spawn a separate interpreter and
it'll it'll just be a much much lower
when it's just a little data structure
and you don't to worry about the stack
or any of that as I get in argues with
people or I haven't actually ivan
actually kept up with ruby in a number
of years so they've I'm told they've
improved things a little bit with fibers
or fit rules or something but I haven't
looked back so the other big benefit
that you get with Erlang is you don't
need nested yeah you don't need all this
nested callback junk that people are
doing with the nodejs is the the hot
non-blocking i/o server but you quickly
find that you've just you got your scope
level increase
seeing every time you do a network
request which just gives you terrible
code and this is just doing to network
network requests and a node which could
also be and you know an engine X or
another non-blocking server you get this
junk in Erlang it compiles essentially
do the same thing which is going back to
your you know your select or your e poll
or whatever but the code is nice and
clean and sequential so it's kind of non
blocking under the hood which i think is
pure genius when I when I discovered
this I was just I was blown away and
they don't advertise it you know you
know I actually I had to grep the source
code to figure out that this was the kit
you know this is how it actually worked
and yeah I cannot like say enough about
this design decision which yeah they
think they think is not news but anybody
coming from any other framework this is
this is really a really important yeah
you've seen something about publicity
earlier yeah so yeah you get all kinds
of engineering benefits and then your
codes not a mess so practically what
does this mean in terms of a web server
where you can put your email away it's
hard not to write a high-performance
server in Erlang you automatically get
all these benefited crash your your
operating system with lots of operating
processes and threads in a way that can
easily happen if you have a high traffic
server and anything else the second
thing is that we get these WebSockets
for free which are real-time
notification so we can keep sockets open
and keep connections open and let our
application just pretend like it's this
blocking long-running thing when really
it's it's imposing very low marginal
cost for keeping that connect
alive so we can do all kinds of neat
real-time things in our web browser so
the other cool thing which Joe alluded
to in his presentation this morning so
you can build a lot of services into one
server and everything will just continue
to work fine which is really neat if you
want to build a comprehensive web
framework so what does Chicago boss do
why are you why are you go all here it's
a high performance web server it
implements Django templates for about
99% thereof we've got just a few small
and compatibilities because the the
Django template language is actually
like a functional language it's so it's
very easy to implement because it's
these nice for loops with well-defined
scope no data mutating it's it's a
really nice little template language I
don't think they even realized it was
functional when they wrote it cuz I
emailed him about so I wanted them to
like close some tag which was not closed
because it was creating this mutable
state they had no idea what I was
talking about a second big feature is
well sort of rails like API from your
controller and model and as I alluded to
we've got a support for WebSockets and
long polling for getting kind of New Age
web features a couple other things that
we have in there is built an email
server using Jenn SMTP it just really
makes your operations a lot easier
because you don't have to get postfix
installed and you know you don't need
all this extra junk on account of having
slow servers out there in the world you
can just build it right into the end
Erlang and things will will work more or
less out of the box we also have a
message queue which kind of enables chat
services for these WebSocket services
across a whole cluster of Erlang nodes
which is neat so just a few other
features give you a high-level overview
we do we do it really horrible things
with the
the compiler chain in Erlang in order to
get the features that we wanted so for
example we've been supporting utf-8
source code for a long time and I think
in or now internationalization is really
important and website development it's
it's often overlooked but we've got some
facilities for editing your Poe files
that are called and doing the
translations and the the template tags
got a built-in admin interface called CB
admin to let you kind of edit the
database and look into it and just see
what's going on without writing a single
line of code yourself so we'll kind of
introspect the models and build you a
nice HTML interface to get going and
I'll talk a little more about the data
modeling in a minute and of course it we
tried to do everything in a very ODP
compliant fashion to get all the
benefits of TPP
code reloading and so on so one thing I
want to talk about or one aspect of boss
is boss DB this is our model or database
layer it's actually been split off into
a separate project so if you want to use
the Chicago boss model and database
layer you can it's pretty easy to get
integrated into other projects so I
think it's the only database abstraction
layer that that there is Lea at least it
was when I started writing it I couldn't
find anything else out there
now we support seven databases we
actually that concur ik's
contributed the dynamodb one recently so
that's B be great more people will try
it out and make sure get graduated from
experimental status but the sequel
database drivers are really well tested
and it's it's really nice just to be
able to kind of build your application
and then decide later what database you
actually want to work with or make sense
for your application so the most
controversial axe aspect of boss DB is
our wholehearted embrace of parameterize
modules
which everyone else in the Earling or at
least on Earling questions seems to hate
but it's it's really nice to have
something that looks like
object-oriented programming when it
comes to modeling database tables it's
just nice to say author : first name and
get their first name back it's
especially nice because it can integrate
with the templates so you can say
something like message dot author dot
first name and it'll do what you expect
so like object oriented programming is
actually a convenient mental model for
accessing sort of structured data or
acts
yeah just accessing fields without
having to say use the record syntax and
say well you know this author
it's an author let me see the first name
field or having to use a prop list or
dictionary or anything like that you can
just say author : first name and be done
it's also nice because you can just put
related functionality in the module that
defines that sort of has the fields and
you kind of have access to those fields
which is especially nice when you're
doing something like validating data or
applying business logic so the boss DB
will support validations which is it's
it's good so what actually won't save if
you know your custom tests failed so we
use we try to use rails conventions
wherever possible to get people to throw
my plan is to you know find the one
thing that's really slow and a rails app
and then have the person rewrite it with
Chicago boss and point it to the same
database and have them live side by side
until boss eventually takes over so for
example the table names are all just
plural now you know plural English nouns
and ID field is just call ID and foreign
IDs are called you know object
underscore ID and uh that's that's one
part of the rails API I really liked
it's it's opinionated but it's very
dick table so when you get into querying
you can say something like boss DB find
say the object type and then we actually
this looks a lot like qlc and a parse
transform but it's it's much worse than
a parse transform we actually we have a
number of operators for querying
including set operators and match
operators and here I have an equal sign
but we have a number of actually utf-8
characters that you can embed in your
source code so like a set should have
put this on the slide but you can have
like a a is a you know element of
operator the little EE thing I can kind
of do it make a shadow here but you'll
embed that you can bed that directly
into the source code which makes for a
nice clean looking source code and we I
had to do all sorts of terrible things
to the scanner and parser to make that
actually work with stocker Lang but it's
it's pretty cool it's so it's very
similar to a link or Lin Q or however
you pronounce it in the Microsoft
technology world so another benefit of
vos DB is we've got a built-in caching
layer and connection pooling layer using
pool boys so it's really easy to write
an adapter for another database and take
advantage of the the caching and pooling
mechanism so I'm trying to get people to
write as many adapters as possible
because I think it's it's a really neat
system so there's another part of the
boss DB API is an event system called
boss News and what it lets you do is
create what's called a watch you say
it's it's just like an observer but you
can give it a string and it'll parse
that string and interpret that so if I
say watch message 42 . contents that
will invoke the callback whenever the
contents field of the message with ID 42
changes and I can replace any of this
with asterisks so I can put an asterisk
here and then it will
nope the callback when whenever any
message has its content changed or I can
put a star here and then it will invoke
the callback whenever any field of
message 42 changes and what's what's
really neat about it it's it's actually
tied into the cash system so whenever
you whenever a query is cashed it will
create a watch based on the contents of
that query and then give it a callback
and so once that the contents change the
callback will be invoked and the cash
entry will be expired which is great
because it means you don't have to you
never have to worry about cash and
validation logic so it's it's a really
nice nice wind of having an event system
built into your your model layer so you
should use it all right finally I'm
gonna give you some example code since
since we've got some time the hello
world application and you don't wanna
you or you can sort of get started
without building a template or if you
don't know anything about Django
templates that's okay all you need to
know is some Erlang to get going
so you just declare the module here's
another place where we use parameterize
modules which i think is is a really
good place to use it which is passing in
this is actually a simple bridge request
object and will give you access do you
want the request method or you want any
HTTP headers if you want query
parameters you can get all those through
rec in this case and you're gonna need
it for all of your defined actions so I
think a mod is is really good here and
then you define that what's called an
action and this would be the name of it
this is the HTTP method and then a list
of tokens that appear in the URL and
I'll sort of show you how a URL is
parsed in a minute here and then to
return something to the browser you just
say output and then some data and once
someone hits that URL it'll output hello
world it's very simple I'll show you in
just a second
so yeah so each URL will map to in
action and then so it'll choose what
function to invoke based on the URL and
I'll show you how that's broken down to
get a little more complicated you can
make a template so this is a django
template with variable interpolation so
you say message for you open braces
message and braces and then instead of
saying output like we did before we
return okay which is sort of the
standard situation that you want to
populate the template with some
variables and you can pass it a prop
list you can pass the dictionary and
there are a few other thinking and even
pass it like a GB tree if that's how you
roll and it'll populate the template
accordingly and so you know final a more
complicated example is using a model so
here's what the boss DB models will look
like also parameterised modules you just
say what the model name is and then you
have a parameter for each field in your
model and so it always starts with ID
because everything needs an ID and then
you can have content so you can have the
dates you can have numbers whatever else
you want and then in your code you can
create the parameterised module using
new and then since BOTS DB will create
these access or functions for you you
can say message colon contents and it
will retrieve the the contents of this
contents variable here so you'll notice
I didn't define a Content function up in
the model that's that's all taken care
of for you with with Baz TB and that
will have the same I have the same
effect and give you the previous
template that we saw with the custom
message so talk a little bit about the
how the URLs are parsed since we got a
couple minutes here and that's that
falls under routing so when you request
a URL like this
by default it says breaks it up breaks
up all the tokens says the first token
is the controller name
the second token is the action name and
then everything else will just pass to
the action as a list of tokens for it to
do whatever it feels like with so that's
that's kind of the default behavior
makes it really easy to so you can say
slash message slash edit and it will
invoke the edit function of your
controller and and so on you can
customize this behavior if you want you
can use regular expressions so if you
want to sort of take out the controller
name you can say okay anything that says
let's show slash I have a sort of a
capturing match here
you can use to to route to an action
that you want and something that's
pretty neat that we added recently is
having named capture groups so if you
have a really complex URL scheme you can
use a regex to capture sub parts of it
and kind of stick them where you're
where you want so you can you can have
the controller name in there you can
have the action name or you can have any
other parameters now one little detail
I've left out here is how it knows what
to do with this ID key value pair
because I haven't said anything about ID
anywhere in this application but this is
a valid routing rule in Chicago boss so
what how do you know how does it know
what to do with ID you know we got
dollar one I can see that for the regex
I got a dollar message ID but what
where's that coming from
this is this is a neat little feature
the parameter names are actually
inferred from the parse tree of your
controller so if you have a route like
this that goes to message ID it will go
through the source code say okay we've
got this action names show we have this
control of a message how do we match
message ID it'll actually look at the
variable names and transform this Erling
variable type or a format this is a
camel case message ID and say oh well
that's actually the same as this
underscored version up here that's a
match let's take the contents of
one and pass it as the only token in
this action so it's it's really nice for
creating nice clean looking routes that
map very cleanly to your to your
controller logic and that's just using
more horrible tricks with the Erlang
parser and friends yeah so that's that's
your overview of the framework thanks
for listening one last thing before I
take questions sure our boss is built
with the following libraries and you'll
see a few of these I started were
actually originally developed for
Chicago boss we've kind of broken out
from the project a little message queue
the template system and other things
yeah so that's set here yep so recently
we added some code so that you can write
your controllers and elixir if you so
desire and every rest the API is exactly
the same so you can take advantage of
all our plumbing or session handling
excuse me email server and so on and
just write your code an elixir yeah yes
and Duncan's been the adding support for
Lisp labor
Erlang controllers as well yes so yeah
yeah so what you can do actually in your
controller is so he was s he's asking
about authentication so in your
controller I'll go back to hello world
you can create a separate function
called before that takes the action name
as an argument and it's invoked before
anything else is invoked it'll say
before index do something and that can
either return to redirect or return some
data and it says oh so that's where you
put in your open on ID authentication
information
okay so no there's there's no nothing
right right
so there's yeah there's nothing built-in
for doing that I'm not sure if they're
open ID libraries out there but it's
really easy to integrate because
whatever you return say the user
information will be passed as a third
argument into the action here so in that
way you can kind of say just by
declaring action with three arguments
you're effectively saying this person
needs to be authenticated in order to
access this which means that has to go
through this this before filter
it's called yes oh sure
well part of it is let's see the library
list here okay so uh Aleppo is actually
okay the sorry the question was what
kind of nasty parsing tricks do we have
to do to get all the features that we
wanted one is so implementing your own
sort of compiler or doing compiler hacks
and Erlang it's a little tricky there
are nice libraries for this scanner and
a parser and Erlang so you can scanner
link tokens and what we'll actually do
since we support these utf-8 operators
is intercept scanner errors it'll come
back scanner will say illegal character
at column whatever and then I'll look at
that I'll say okay well what was that
illegal character it'll go down a table
and if it's one of these operators that
we support I'll replace it with an atom
that effectively does the same thing or
actually it replaces it with a comma and
then an atom and then another comma so
that you've got left hand side operator
right hand side that's actually replaced
with left hand side comma operator name
comma right hand side which is a valid
Erlang construction that was no the
first step and then to really make that
work you got to pass in the scanner
tokens to the parser
the problem with that is that the
preprocessor EPP doesn't like scanner
tokens you can only pass it at least the
API with the API you can only pass it a
file that it will pre process but I had
some scanner tokens so we actually have
aleppo was a little project I started to
reimplementation
which is a much more sane API in my
opinion and it's it works but with a few
little quirks that I can tell you about
afterwards but those are story and that
then afterwards it also does all kinds
of cogeneration to add functions so for
example with the routing I was telling
you about inferring figuring out that
this is message ID it will actually the
compiler will scan all these forms for
the function names and then pull out
these token lists with the variable
names create a new function called
underscore routes that exports all of
function names with the the variable
names themselves which are eliminated or
you know that the compiled beam doesn't
know anything about so that's I think
those are sort of the big hacks that we
did but Earl syntax is a great library
for doing a code generation if you want
to go down that dark route any other
questions yes
yeah so the question was how do you
handle Ajax calls and you can do it like
you do anything else so instead of I I
guess I should say instead of returning
okay which will give you a template you
can return JSON and then some data and
then that data will be sort of munched
and sent through mochi webs JSON
generator I think that's how it works
but yeah you just return JSON and it's a
nice Ajax endpoint yeah yeah so yeah you
can have a custom route and then it'll
take care of the content type and that
sort of thing for you yes right after
PhD right Yeah right my own typesetting
system first just making fun of Joe for
writing his own typesetting system in
the middle of his PhD any any other
questions example projects there's a
high chance in here it's been working on
one or at least he's been you've been
telling me about a sort of a forum and
knowledge-based system that's being
developed with Chicago bus which
hopefully will be open source before too
long
mostly it seems to be pretty popular for
sort of internet quick sites that you
can you know you want to set up an
internal tool but you don't want to
babysit it and manage it for the rest of
its life people like Chicago boss for
that because it's it's very low
maintenance
I sorry what do you exactly right yes oh
yes oh wait yeah web web applications
yeah scale out very easily like that
yeah it's very uses the same that's the
strategy most web servers will use for
first having sort of share nothing at
the the front-end level that yeah I'm
happy to reuse for boss yes
yeah that's that's that's the power
Erlang absolutely wouldn't question in
the back there's we support sort of
three types of comment so there is the
native WebSocket support through cowboy
now it's this sort of works out of the
box there's like a little broadcast
function that thinks so I think it's
been integrated to check but we have a
number of people using WebSockets and
all that I don't use it myself so I
don't really understand how it works but
they seem happy with it
one more question yeah yeah so good
great question the question was if you
have a lot of front-end nodes
how does the event system for the the DB
layer work and for that you actually you
define a master node that handles all
the notifications so in this case I
think those are routed through the the
message queue that'll just be sitting on
one of the nodes so it's eventually we'd
like to go to sort of a master list you
know replicated architecture but now you
got to say here's the master node I hope
it doesn't go down and it'll be in
charge of all the sort of shared
services like that okay well I think
we're just out of time thank you very
much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>