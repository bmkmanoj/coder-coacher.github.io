<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Edwin Brady - Idris: Programming with Dependent Types | Coder Coacher - Coaching Coders</title><meta content="Edwin Brady - Idris: Programming with Dependent Types - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Edwin Brady - Idris: Programming with Dependent Types</b></h2><h5 class="post__date">2014-01-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/O1t4xJzrOng" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">right so peg for that I thank you for
finding it to be the conference table
they tell you about my favorite toy
language it's it really it's really
about for me in Tibet annoyances that
come up when you're using a computer
like you know this sort of thing you let
me come see this very clearly but this
is if you know programmed it down on
Windows machine this will be familiar to
you this is a this is a series of null
pointer exceptions the unfortunate thing
about mrs. green is that it's the trade
information displayed through railway
station and I was trained I should take
and this didn't tell me so this was a
bit more complicated if if your machine
is a spaceship this this is master
climate orbiter this is this is my
favorite ever type error doesn't have a
my also have a favorite type error this
is most climate orbiter
what it was supposed to do was go to
Mars and relay information from another
bottom surface back to earth well it
actually it was crashing to Mars as soon
as it got there because someone in the
ground wave software someone had written
code that was expecting imperial units
and it was taking metric units which
well I guess if you're a programmer
these two things are the same type
they're just and it's kind of
embarrassing an expensive site there so
that's you know just think about what we
can do to make this other thing not so
rigorous it's a programming language
that I've been developing for us it's
it's
I actually mean by that a bit later on
but just to say ma'am cheering
completeness is overrated
C++ templates are here in complete the
game of life is turing-complete Tom
Waits game of life
seven configuration files theoretical
please but if you can't write pack that
into the fury common language I'm not
interested Idris is not necessarily
accurate properly language it has a
termination and yes you can still do
interesting graphical um one thing I
would like to probably refer to do if
you if you don't do anything else you
can start playing I'm gonna do a lot of
this by demo as well so if you haven't
had a laptop available then you can just
sing along all the video all the code is
available my kids understand mercy you
can try afterwards so a little bit so
I'm going to say a little bit about why
time through thought my senator
Whitehouse reformed we use platform
well conventionally we use type systems
for checking that the program does the
right thing we also use type systems for
guiding a program if you go to correct
program so we have the type we're aiming
for we think about type systems is that
my parents and teachers before I even
went to school recognized the importance
of type systems and they told me type
theory
all that food and not food yes this is
mr. theorem prover so so in the top here
I have I hope my theorems these are on
my types in here I have some candidate
values let's say I'm trying to prove
this theorem stuff that's the type of
tight so I'll talk through that theorem
and well I'll look through my candidate
values and this one works here so I
prove a theorem great Oh what I like
what I might do is so I guess I can
coerce it so if you're if you're if
you're a Java programmer that's the sort
of thing you do something else you might
find children do this when they get
these is they've got this theorem but
they've got this value try to prove this
human there's no it's brilliant
now the frustration of trying to find
something through the right holders
that's my program isn't it that's
exactly the same things programming I've
got a thing I'm trying to do it it's
just not working so if you're a thief
right the rest of the top I'm going to
be working with one of these it's just
going to be a little bit we're asked
that question again humor type series
before we went to school yeah good so
here are so what type systems before so
typically we think of them as checking a
program has the intended properties that
we've that we've specified guiding a
program towards a correct program
because well we've got a thing that
we're trying to do we've got some values
that might give a little more time and
later on we'll see a little bit of how
we can also use them to make fairly
generic libraries that expressive likely
to give us my facility recipe now
dependent types
so here's no cross this concept before I
explain a little bit about what's going
on actually who knows doughnut Haskell
to beat it so even if you don't know how
to read it I hope hopefully we'll
hopefully you'll be able to see at least
all the programs that I write so I'm
going to talk about dependent type
systems so dependent types the
characteristic thing is really that they
allowed types to be predicated on values
so whereas previously money you might
say my type is list well I could say I
have a list of five things and things so
because we can predicate types of values
we can be more precise about what kind
of behavior program I'm going to
illustrate this idea with several
hundred examples so this list of
demonstrations I don't think we won't
necessarily get through all of these
because I'm going to do it on the
keyboard it means you can find it
directly to where you want me to go so
so I've talked for about four hours on
this
try that basically because you know
there's very successful to just let me
know please ask questions as we go along
so I'm going to show you a few of the
basic ideas just some fundamental
programs that you will have written
before and just just recognize them in
this new setting and I'm going to show
Society law you say the examples just
before we start before I get into the
life hacking just to get you a little
bit familiar with the meditation I'll
show you to the basic data types basic
data declaration so the first one you
know my favorite type theory my baby's
first my theory example is natural
numbers the international numbers so
this is a 0 or a successor of another
natural number so we're basically
counting 0 1 2 3 and I know that
underneath computers typically have
integer arithmetic these days it's still
very useful
still very useful to have because they
bring a nice structure they have
structure that's the same in a sense as
a lot of the other data structures that
we work with so this for example have
the structure that and this is either
empty or it's we've got an element and
we've got another list so I'm writing
this down in a style where I give this
type constructor I give all the ways of
constructing that time there's data
close crutches and you can you can read
these things to the right of the colon
as types so this is in some sense a
function that takes a type and gives us
another type so it takes a nil-nil
that's that's a list of some things it
don't know anything in it and then calm
now we have dependent types so we can
predicate types of values so factors
these are the lists with length so as
well as constructive says okay I have a
number I have a type that's the number
of things in the list the time that's
the only type and that will give us a
new time so nil here that's a vector
with zero things in it so this zero
corresponds to the zero constructor here
that is just an ordinary an ordinary
part - such as ordinary daddies so I can
have ordinary values in Tights as long
as I say as I say that and then comms
was just the same except that we say
littlenecks is explicitly so we've got a
thing we've got the better of K things
so using natural numbers just has this
nice natural structure that corresponds
to their right so rather than show you
the examples in the slides I guess I'll
just do this by a lot of people when you
when you see independently typed
language like say a global clock you
don't tend to dive straight into the
vector example and forget to tell they
don't think that run programs is
important because why don't you run the
program when you already know it works
I'm just going to do this dish I'm just
going to do this to show that you can
compile and run program so we have a
really valid GI star
so we've got something that isn't
amazing
let's do something slightly more
ambitious so here I'm going to I'm going
to write a couple of a couple of
functions over vectors and if you look
carefully at the types here these these
these types tell us exactly what that
program is supposed to do so I've got a
function append which takes a vector of
length N and a vector of length n and
that gives us back to that replace F so
clearly it's gonna be two vectors start
together and there's only really if you
think about that for a minute there's
only really one way you can write that
program we're gonna struggle to write
this program if it's not the append
function over these two vectors I guess
we could reorder this reorder the
elements about that we think about
giving types you might think well I'd
rather write the program and then have a
machine tell me well type my program is
like Rama half full type inference
surely
I'll say like the payoff is if you have
types if those types are detailing
precise and they tell you what the
program supposed to do
you don't actually have to write the
program you just ask the machine so I'm
going to do comment on itself so these
are vim commands this corresponding
commands remax that work just as nicely
so backslash D that will give it a type
will create a template definition so X
is wise is
so some clues already it's not a nice
classify the way we have we got a class
or so this plus is actually overloaded
so how we gonna do this well what we
could do is look at X's X's is either
going to be nil or cons cons form and
then we'll see what happens so how do I
do that well I disaster machine again I
say well connect speed so now we're
doing the pens empty list and Y so again
we can look at the time for depend RHS
and it says well you've got why is that
a better of M things and I'll try to get
a vector of n things so I'll use the
backslash oakum and then it says well
obviously that one is young
so same here
I've got vector N Things a vector of N
Things and I'm trying to get a vector of
successor of n plus M things
brilliant there's only one thing it
could be naturally so why should I have
to write that down machine will do it
for me so a bit more complicated is
simply so zipler is what that does it
takes a function and applies that
function to two corresponding vectors
that anything's that's not the same
thing
TenPoint definition so this heuristics
for choosing names here you can actually
you can give hints so I say okay
you can overload these with your own
looking to find your own data types so
so how are you derive this
what's that press mumbling it's surely
surely he's not asking a question that
easy
we've never get X's into the two
possible cases so what we need next well
wise is only gonna work
so we've case splits up answers and
that's giving us an empty vector and
it's notice that wise also has to be an
empty vessel because otherwise one time
check so now try K splitting on lies I
only get watch the other one one time so
why should I write the program I've told
the Machine what we're gonna do it's the
traditional style of programming it's
like you've you go to your share you'd
like your teacher gives you a teacher
and you get a grade from the teacher
rather than that I didn't say that
rather than man it's much better if you
do if you can't read the compiler is
just persistent says okay what are we
going to do now what's the what's the
next step
can you do it for me what's the answer
will this work then you say well there's
two ways to find out so let's do
something a little bit more so this is
just adding two lists together that's a
pretty much a problem that we solved in
40 designs we know how to add on this so
because we can write down the size types
we can start expressing proofs of things
so why not here is proof that something
is an element of some particular list so
these are to be done this with length
these little ordinary lists and so this
this place I here said well whenever we
see X's coming up so to say that to
express in a datatype at compile time of
check-in at compile time that agent of
this agents on this page well either
it's the first thing it's here so X is
clearly announces because if I know that
X is in the list X's then I also hope
that it's in the table of a list that
something stuck on the front so it's
also as an example of how that might
work so secondly this is proof that tube
is the second thing
all things create a definition and ask
the machine and it says yes it's it's
the second thing you go there and so if
I try something like okay this is the
kind of error message you might get I
can't unify LM 3 3 4 5 with 2 3 4 5
because you said you've given us proof
for the third thing and we've actually
proved the second thing and two is not
three now this is a compile-time proof
unfortunately users are securely
cooperative in that they attempt to give
things to your program that's what they
do so if you want to have if you want to
work with this kind of proof you're
gonna have to you're gonna have to check
the data is valid at some point once
you've got that proof you can then use
it just happily all over the place but
sometimes you might need to do some
dynamic checking so really really what
we've got here I suppose is statically
checking that you've done the necessary
dynamic checks and once you've done the
necessary dynamic text your power proof
that you've done it so you know means do
it again and that's this function that
checks whether X is in the list and if
it is so this function if I know how to
be side knowing how to decide to be
quality of two things
an exit type T and I have an X to type T
then I will this beta type is either on
proof that they're equal or a proof that
they're not equal so I won't go through
the details of how that works but I'll
show you how to use it so what we'll do
again create the template definition
well what we going to do well in a check
to check whether X is in X's we're going
to have to check what form of that to
this so we'll expect X's and is X in the
empty list
well Department is X in Y axis well that
depends on two theatres however it's
going to be Y or it's going to be later
in the list and so the natural thing to
do here would be to say okay if x equals
y then here great
unfortunately that's not quite good
enough because billions because boolean
say if I say to you yes we got a more
question you put your question on x-ray
it's the same that boolean if you see
something it says true or false you
don't actually know what questions be an
accent so the idea of this this deck eke
function is it a keep track of the
question that's been asked in the form
of proof that says so there's a special
form of pattern matching to do the idea
is once you look at one thing which has
some proof
that might tell you something about the
other data you have and we have to do
that basically by adding an extra and
that's you thinking construct called
with so what we're going to do is is
decide whether X is equal to Y and this
with pass is now we can now pattern
match this this thing is pattern
matching on the result of deputies like
so it's going to give us either approves
the x and y are equal or quizzes they're
not so case analysis on it it says okay
yes or no in the case of yes this
argument here
this argument here
zette isn't proof that there is only one
proof that x equals one and that is
wrestle of X so what I'll do is I'll
pack natural matte so case with on the
edge and two things firstly we see yes
this X well now we can just use the help
okay okay so I'm going to check
just deserve one of the things that I
really find annoying about programming
Haskell is when we do this melodic style
you've got a pneumatic thing all you
really want to do is pass it on to the
next function why do I have to go to the
trouble of binding everything myself
isn't this bang-bang notation just means
yes I know this is something in the
Monad you figure out how to find it
and then just do the ordinary
left-to-right semantics there is
actually an argument we have enough
typed information but I shouldn't even
need that back the machine should know
that and a few times I've been on the
point of doing that but but my users are
terrifying anyway so that's so that's
your basic programming you basically see
you're improving so we've got these
these are the these on fundamental this
is the mechanics is having on actual
programs
so I guess write something a little bit
more can I ask a silly question
what's wrong the encoder which is
actually our silly person who thought
the extensible investing because you
know back in back in the 1980s and 1990s
when when graphics were at most 16
character there 60 colors you have the
same
just saying we have a number of copies
of character or bitch
and then we just say number of copies
and apparently it's still used in fax
machines how do people see these
fantasies so what we're going to do here
is is is do run length encoding of a
list of characters and we're going to
use the type system firstly to make sure
that what we've actually done is invalid
compression of the original data but
also to write half the program for us
well so what's going on here well
firstly a little convenience function
this probably should be remind me but
this is just doing end copies of the
character so practice a natural number
and then some a I didn't actually need
to give this a name I used this before
and then here I have a run length
encoding view so it's a way of looking
at data it's so it gives us some other
patterns with which we can describe
later
so our end that's just the run length
encoding of the empty list we've got to
the end and then well if I have if I
have an N in the C so if I have a number
of copies in the character and I have
someone they think oh give answers that
will give me a wrong they think Oh being
off and floppy to see processes so if
you believe that this data type really
does describe run length encoding for
data this is crucial
you have to believe the data types
because if you don't believe the data
types tell you the form so if you
believe that hopefully you also believe
that should I successfully write this
function are
that goes from a list of characters exit
the list of characters to I relieve X's
but I really do have a value of X's yes
we believe that so so just naturally how
would you answer Oh Graham I guess you
did the natural way to do this just look
at the list and then look at the copies
of the look at the element of the list
and see if they're the same if they're
the same so we don't have to do that we
know roughly what the plan is going to
be it's kind of boring if you know what
the plan is going to be for writing a
function to actually have to do the job
it's I don't have to do this why can't
we Sheen dutifully so what's the role
making an empty list what about an
ex-con taxes so I've got character and
I've got some more stuff so a good place
to start would be to find out what what
happens when I press the other stuff
because because I relief has has this
prior to X's when I do pattern matching
on ah relief so we saw this with
decidable equality when you do pattern
matching on something that tells you
about before with other things so if I
can matching on that is going to tell me
about before was the singing
so what happens I get these two patents
so because I've written down this data
type I'm allowed to pattern match are
things that are more complicated than
just the ordinary days I'm going to
pattern match on the form of things so
either I have X followed by the empty
the empty list in which case coffee of X
or I have X followed by M popular seed
followed by the rest and the rest is
represented by this so I have been
properties of C and I have an X so the
question is do I want to add is X the
same see if X is the same as C but I
want one more copy of it so it's gonna
be the same as before basically no music
quality just use disciple Authority the
runtime behavior is exactly the same
because the proofs getting ready for
runtime so I like it when I have to let
me make mistakes because then it shows
that depend on that so now now we have
that we've got an X followed by n copies
of X followed by wise
so so in poppy there so Tesla made
copies of that plus the rest of the oh
yeah yeah absolutely yeah so the
question was if you just have more
coffee you repeatedly had one coffee
okay well yes it would be okay
it's just so it's kind of so this is
this is a function which takes some list
of characters and then gives us an
intermedia structure that says what the
structure of the encoding
we've got got lists will Pat match on
the coded version of that list I've got
an top you'd have seen then I've got the
rest so however you want to render those
empathy to see okay so that's using the
type system to guide us to a sound
version of some compression algorithm so
our only okay but you can imagine doing
this sort of thing
realistic so also I showed you I showed
you the Mars climate orbiter you're
thinking this is all very well but none
of these programs are gonna get us to
Mars yet and real-world programs have
side effects anyway you know we've got
stage we've got interaction we've got
things going wrong we have to deal with
with not only in that user input but in
bad effects from outside subsystems not
working based around a library of side
effects reasonably sized program has
probably started using transformers
so over there I put the unsatisfied
again I thought well can we do better do
we have an express we got type system
that I can somehow write a program that
says what effects
my real program is a 90 so this is using
that library so it's that P effects flag
is just a safe use the use the effects
program because I'm a programming
language scholarship what I do with my
programming line abuse is like using to
write smaller programming languages
I'm limitation of spacing so this is the
little programming language that just
has variables
it's got values so this is a simple
language to evaluate this language so
it's got variables which means I'm gonna
have to have some way of locking up the
value of those variables and when I
looked up the variable it might not
either so I'd have to have an
environment that map's the it's just a
list of strange imaginings so I don't
have time synonyms because types are
first class and we can generate time
just by writing functions so this is
just a function that calculates a time
so the way this happened the way this
works is if you think this aspiration
type this F data type just gives you a
list of all the things that you're
allowed to do you can call some programs
that use a subset of those effects
basically all the stuff I've just shown
you the best have built have to build
theorems that prove that things are in
this there's a long really important for
getting this thing to work
you don't need to know them so this
program says well and then here so any
faithful program I have to I have to
invoke it somehow so this run function
just invokes that program and for every
fact I have so it's just like you're
wrong state so if we compile the wrong
so the reason the effect system is is is
useful or interesting to me anyway is
that if I decide I want to have more
numbers so you might think when we do
case splitting or something that's all
very well but what happens if we can
just find out which places on this thing
we don't have the random number of that
available so random numbers are
inherently special you've got a people a
seat how do I make it available well I
just have to the resource so the same
thing so 5800 plus around the number is
132 can you argue that pen you I guess
when you have when you invoke the
program you do have to initialize the
resources application now this thing I
started experimenting with using this to
structure large programs it's like if
you're programming in Haskell you have
to
and you have to think about how to deal
with all the kinds of impurities
determine reality so typically you would
have some on a transformer sack that
says personally what I do is I get bored
to see this there's more than two
monitors and the snacks I've just I just
kind of all into long giant what I think
is better what I do is say like for my
program I'm going to define the list of
results that I have effects that I have
they're available to me in this program
my whole program runs on dry oh it's
it's got the SDL effect this I parameter
to the SPL effects is it says whether
it's initialized also but keeping track
I think you were tracking the station
the time if I forget to initialize the
SPL effect but I don't make a window
then it's not gonna come apart it
doesn't make sense to draw things so
this is just a parameter that says yes
running program is a program that
actually has an SPL surface available
and then I have a few a few bits of
global state so these these are all just
effects like we saw before I have some
global stage which I've labeled with
frames I'm keeping track of what's
actually going on star fields so when I
run the other bits when I run soft
components of the program
I don't read one of these all of these
bits of states are only relevant to
certain business program so if I look in
the star field
is machine but there's at least my mind
my attempt to prove that you can do more
structured larger applications so just
to summarize why are think dependent
types are important and times give you
lots of things so they give you safety
because you can check your program again
specification
you can know because entire text is
going to work the precise if you want it
to be so I really think Kobe example we
know that it's fake we know that it's
sound
we've got more expressive ax T so we can
write I think better more to go through
the api's so that fact language was an
example of more expressive APR one thing
I didn't show you is you can one thing
we've done with that is is have in the
results in the state the forms that you
have feels that you have a web form so
when you have a form you know which
forms with which field you know what
field you back to before and you know
what types are expecting so when you get
to the submit button you can work out
from what you've added what the type of
the handle Stockton has to be so if you
had a handler for your web form that
accepts the wrong data so you have you
have a type safe web applications just
by using this framework directive should
stop being surprised when my programs
well as well as like you get time
directive development so we've seen a
lot oh no I basically didn't write
programs the machine did I sort of said
well one of the options available to you
tell me what I should do then I'll tell
you the bits that you can't figure out
then you tell me the bits that are
obvious if you write down time typing
easier and these are thick your system
is supposed to help you types are
supposed to help you missus there's this
idea that the type checker is is some
stern teacher
you know that's not much attack it
should be an assistant the right program
not something that tells you when you've
got the wrong program also we have we
seen so much of this but types giving
generosity so you good types give you a
recipe that you can write program the
calculator type and then the dynamic
typing found often seem to wheel this
without by say oh you can't do JSON data
in a statically typed language because
you don't know it for well I say you
can't write a program if you don't go
before as a pacer
so have you write the program's going to
form well we know form we calculate the
time for app runtime and still have time
correctness just because you know
basically you're checking in advance
that all the possible things that can
happen and then eventually they finally
you know efficiency hopefully one day we
know more about what a program supposed
to do that should have to compile so
these zip will need the append function
I'll show you radical stuff we know that
there can't be any runtime errors we
know that because we know number time
what the length of the list has to be we
don't even need to bother checking
whether it's oh no it's not we should
get some we should really get some
mileage out of that we should be able to
use the fact that we've already
statically prove that but I know it's
happened really interesting to go
further and see if we can exploit this
finally just finish a few possible
applications
independent I'm really an active
research topic minutes getting a bit
more trendy finally we're getting some
languages that you can actually buy
programming and we're having lots of fun
with all these and join us it's fun
just kidding you have dependent eyes
doesn't mean you have to use them I
think this is something that people get
worried about when they when they see
dependently type programs they say well
I don't understand this to my sister I
don't want to have to prove my program
does the right thing just a program bill
you wanted to and if you ever need that
extra activity then yes you can but if
you don't I can't really say it is
challenging to think of things that that
you might want to prove because there's
got to be a properties does actually
that is actually an important point for
another reason which is that one thing I
like to do is hide all the time magic
behind some attractions so building
verified domain-specific languages for
whatever thing so that your domain
experts can use those fractions to know
that because you've done the proofs
what's behind it that works but not
understanding yourself so that's really
what
can you do constraints on well but the
thing about floating point numbers is
they're not really numbers now there are
some people at a time and that they're
interested in to reason about economic
models and they do do reasoning about
floating point numbers in the types and
they do this by adding a few postulates
so they're a little bit careful about
whether what they say is true and they
said they can certainly say things like
a number is within a certain range you
really do have to assert
I always find this reassuring if your
system gives you long point-three for
that either you're cheating
right yeah yeah I don't think about some
probabilistic rules</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>