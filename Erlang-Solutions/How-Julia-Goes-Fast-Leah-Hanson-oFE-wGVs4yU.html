<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How Julia Goes Fast - Leah Hanson | Coder Coacher - Coaching Coders</title><meta content="How Julia Goes Fast - Leah Hanson - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>How Julia Goes Fast - Leah Hanson</b></h2><h5 class="post__date">2015-11-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oFE-wGVs4yU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi so if you're here you probably
already know that Julie is a programming
language to sort of put some numbers
behind goes fast it's usually between so
optimized really comes between s fastest
c2 like two times slower than C so
that's pretty fast and the point of the
stuff is basically like this is the
point you take away is that Julia is
designed to make going fast easy and
there's two sizes is making it easy to
write test code and making them cry very
easy to influence and so the third
outline of the top is we're talk about
what problems are Julia solve what
design choices does that lead to and
then what sort of implementation
decisions can make within those design
choices and so first what problem are
you solving and as a due to a
performative languages about the problem
is like a user so in this case the
problems that a scientist has also the
supplies the engineers mathematicians
finance people so julia is not really
designed for programmers I'm a
programmer mad at me of the like target
audience but I'd still like to live but
science is very non professional
programmers who use programming as a
tool that means that they don't really
want to become professional programmer
they would have gone to school for that
if that's what they wanted so that your
chemistry professor cares about
chemistry and lightning some math he
doesn't care about programming except
that he needs it in order to do this
work so we want to be easy to use
because they don't want to spend then we
can at least this time programming for
maximum benefit as possible so in a
language they want something that's easy
as early as possible should be easy to
use you don't want to have any headaches
from purchase from programming you want
to use those to think about your
research if you go to writing scripts
because you want to do some data
processing very easily if you'd be right
for party libraries because especially
when you're like a professor you're
doing research you and have like your
tiny specialty and they'll be here by
the library for you unless it gets you
or your grad students so you have to be
able to use your libraries are also
right libraries it should be okies they
call existing libraries in other
languages especially close to make you
probably previously broke your
specialized library than language that
was not delayed since Julian's it exists
and then you want to use that code built
up over the decades and you also want
you also to use all the existing
language around our libraries Julius me
fast enough for medium to large data
sets the episode and this is for a
single computer so Florida State's that
you're gonna pass on a single computer
is whatever fits in ran so you need it
that control to not copy your data
because if you have a giant array of
numbers and even only fit them once and
ran or going to be really sad if you
accidentally make a copy your math
should be fast and extensible especially
for mathematicians that like defining
you numeric types and lots of other
people who like to do a lot of linear
algebra especially nice fast linear
algebra so if you're all sort of needs
to be easy to use and it needs to run
fast and so of course once you if you
could actually do both of these things
you would still encountered a question
like how is your way better than
whatever you already use as those who
cannot elaborate umpire are and I'm
going to focus
hi fancy sample just a pickle so if
you're using a pie or my Python I
remember the paper face to use your
linear algebra and as you're using a
researcher yours or if you're going to
like these and you're going research on
the same stuff that the pie is
implementing you might buy a function
that you need to like it's like a
different one ladies compared to the one
that is a sin m pi erode better version
so you need to like benchmark the two of
them against each other to see how much
better your results are or you
implemented in Python it's too slow and
as because the fortunate numpy is
written in C it just has a Python
wrapper around it so some guy is really
like SC library with a Python interface
and that means if you want to add to it
you're going to have to learn C and
connect see a Python and that's not
really what we don't want to research
you doing that if C is language
professional programmers and is battling
mature scientists not that they can't
use seema that is not really a good use
of their time so instead of how this is
like this is a problem of having c and
python and eating to learn both is
called the two language problem this is
really common in like most languages
that are intended to be easy to use is
that they have sort of a system language
buddy you that like does all the fast
stuff underneath this is neither feels
like a higher barrier avenge if you want
actually who met the fess up so it's
really a better they could've written in
July so you only have one language to
learn and this leads to order this
interesting difference of Lakeside High
King County Kevin like your fingers
number important commuters to side by
the inductive oce and Python and all of
this complicated math stuff in order to
contribute and that means that
scientists that use the library but
can't really contribute because they
don't know all this other the insides of
scifi whereas julia is proud of having
so dragged by committed to like negative
account make one program us to fix it up
in the base library like math stuff they
care about and then they leave and like
that's because it's really easy to come
in and make one change because always
living the same language that you want
in order to use it in order to achieve
this really has to be both of those
languages last I have like the strengths
of sea and the strengths of Python which
is obviously give it a challenge and in
order to meet that challenge you are
going to make something through so
upfront design decisions to make as
possible as we're really trying to
combine the strengths of a strategy by a
fast language and then ending contribute
easy language into one language that
sort of made adjusted in between on the
imitation side while getting both of the
benefits as we're about the compiler
security side of insanity versus dynamic
and so when you're using simpler
language you can sort of those always
like kind of language in the sundaes and
chocolate languages and compiled
languages get done compile time where
these much thinking as they want and
then they get to make right fine
literally fast native code usually
between whole program come then whole
program Pilar so that means you give
your the whole program to the Pilar at
once and that usually means you don't
have a rebel because it's you know to
make this whole excuse matter the
fermentation effort to implement a rebel
because it has make you want expression
at a time which is not how your Pilar
works on animated interpreted language
doesn't Ethan piles time so it runs for
exist which so much more thinking at
runtime and all of its work at runtime
but it usually has a full wrap one which
is really helpful for trying things out
this because if you're reading your file
along expression at a time you don't
have to change that much to make a rebel
where you also read your info funny
expression at a time so if you're pretty
language is almost always have Merkel's
julieta remembering our pokémon minute
is G compiled just-in-time compiler
which is sort of an in-between choice
that's always working on time but still
does compiling it had asked ever
because that's part of our convenience
features markzware design decisions are
based on competing to be easy to use the
other half is sort of static versus
dynamic so compiled languages basically
always have static typing a static
dispatch and because that it means
different at compile time if you don't
know your types you don't number you
don't know what your data sets are you
don't know like what your dispatching
too late which importation of a function
you're going to call you can't do with
many optimization it's like your
compiler just I'm super confused I can't
optimize anything for you if I don't
understand so compiled languages usually
static then employ image never made that
run time so this is if you're willing is
usually do this because they don't have
been much benefit from static typing
resetting the dispatch because they
don't have a pal time whereas dynamic
typing in dispatch tells you have a lot
more flexibility when you're using the
language and this is sort of why that
I'm going through like Python Ruby
injunctions are considered easier to use
is partially because you can just sort
of do a more flexibility so it really is
really dynamic because easier to use but
we have to put limits on it so that we
don't need like the JavaScript v8 engine
team in order to commence a fast
compiler for other feature that sort of
important design decision is using
multiple dispatch I'm going to talk
about this a little bit later but I went
to go to the front as like so as we were
using dynamic multiple dispatch and it
was regarded as like so there is
convenient to extend for that so this
next section of you talk about three
pieces of background information we're
going to be before we go into the
implementation details and so this is
going to be more about that compilation
with a system
mosel this match and j compilation is
very talked about at five i hope i buy
this visit the spread imagine these
parts are there group are brighter
rather than they are I a so we have the
pride language on top these repeated
language in the middle and then this is
the J competition pilot language so it's
doing everything at one time but its
operating between compiling a piece of
code and then running it and hopefully
you've run your code a lot more than you
compile it so that you actually hit the
savings of using the compiler and what
this means is that every Tyler needs to
be fast in like you it sort of makes
when ahead of time Tyler's are fast but
it's not super important it's not that
doesn't count to presenting your
benchmarks whereas for a jit compiler
every time you run the code if you're
sort of also benchmarking the compiler
because it's part of your runtime and
it's me because this one is it like what
optimizations we're going to do our
garage needs to be easier than pilar an
understanding i can't think very hard is
they're trying to think as fast as they
can to like get your code compiles you
can actually run it and this limits your
optimization options because
optimizations that take a long time to
power your figure out your videos and
ahead of time compiler and still get a
savings at runtime but you can't do that
in a jit compiler because it would take
you too long to takes you to want to
make the optimization you won't have the
savings when you between you and pull
you add the compilation time to a long
time but we use your dick compiler
because as X as X have access to
internal information if you're going to
do a headache language
you want to get fast J compilation is
the obvious choice that's our v8 pi PI
for Python luigia those are all like
these sort of fast version of boobs
languages with fast implementation all
of them are agent compilers the
advantage of julia has over those things
is that Julia's designs Fugit compile is
like the nicest engine up front where is
like Python and ducks are definitely not
designed with your compilation in mind
and so one of the things which really is
design speech at compile is the tech
system so very systemic so values have
types variables are commonly said to
have types which is way to evolve of
psionic languages so it says well
execute 15 min x equals with equal the
hello world so I would say X isn't it 64
and then Exodus string so exchanges type
overly it's only the values that had
types to be in length and so this is
what the definition gradually takes
looks like even sort of think of it as a
see struct and we'll talk about it in
all more detail in a minute so there's
two kinds of types of Caesarea there's
abstract and concrete certified little
deputies you go two major types so
hungry types are what you have shown
instances on so all all types of you
have a all values and country types
abstract types can't be an engine that's
why they're abstract so concrete types
can be initiated they determine our way
out of memory so these are the part that
looks like see trucks so like we know
that case and as n64 688 64 bits and
isn't it 64 that's fine 64-bit engineers
over long mira costa's are understands
also new 64-bit so the whole modded is
128 bits and we know that k is going to
start at 0 and n is gonna start 64-bit
pin and the compiler can beat that
understanding into the compiled assembly
because takes
can't be modified after creation and we
can't have any subtypes for concrete
text and that means the provider can
trust that information is like once you
tell it what the table it's like you
can't change it so we can compile all
the sort offsets into our code if you
change them we would have to do a
dynamic look up anytime we tried to look
at any field at the type because you
might have changed what was in the tape
and where it was kept it's also have all
types have one to protect we sort of
connection to the paper which basically
looks like a tree except at the very top
and so which I've got monument I 128
bits can't change it there's nothing you
can use this type after you created the
other night effects are abstract tapes
you can't instantiate the producer name
and they're sort of more modifiable than
concrete X in the sense that like
interesting part answer texts there are
some types and you can add more subtypes
at any time and this is partly because
if you don't care quite as much about
abstract text when you're doing
optimizations because they're not you
don't have any actual value so they're
just sort of changing how your
dispatching stuff so abstracts take
animal add a subhead cat as a subtype
helps cats house cat will never have any
subtypes but we can add more sometimes
ndvi point symmetry or caps or more
animals or whatever this is just the
subtank operator so this is the last
name before we get it to implementation
details so a multiple dispatch it's a
convenience feature to if make
extensible mac easy i started hungover
more about that in it but first time i
have about single dispatch which is what
I've been trying to Glenda's you so this
should be familiar it even if the term
business so this is what normal alike
algebraic of X tattoo of why we're going
to look at whatever class X has for our
method called su and call and the air
cleaner why and when you
and you use our self comma Y so the
first argument is when we care about X
is one of the arguments even though
Italy started the owner of the method
zune and so single dispatch because we
only care about a single argument the
first one multiple dispatcher care about
multiple arguments all of them so we
care about exercise X at X my equally
when we're doing multiple dispatch and
this means that nobody is there like an
owner so instead the function is a
generic functions or like the function
owns its methods so we will say that
there's the function foo this is one
call to food here is the method
signatures guru so these are methods of
the function foo and they have very
signatures so like the first one takes
two in 64 and this one takes three
numbers and we can have signatures that
have hungry types like in 64 also
abstract types that number and so all
main functions and Julie are generic
each function has one or more methods
and each method has a specific signature
a number the number of arguments of the
types and as a specific implementation I
so we're going to find a method so in
order we're gonna try to make this code
work so x equals mod it's of 3 comma 5
solo button and represents like 3 mod 5
in this case and then we want make x + 5
+ 5 + X work and so the first line
already works is the default constructor
that comes with defining attack and so
we just need to get it to and so that
means we need to add an ethical ended so
plus 1 the handle of audience and in 64
and either the handle and hit 64 and I'm
on it so here's the first one where my
name is in 64 orig Adam
we're going to turn an n64 12 audience
and assume that we have two buttons then
we just switch the arguments around to
do the other are working and you can sit
this code anywhere you want there's
those actually defined in the same file
as the types and so this is lately
really just watching them be ordering
the blue is need 64 and green is the
bonnet and so this was pretty easy six
lines of code and now we can add buttons
and n64 in any order so if you were
doing it in a single dispatch version
the first half is easy you know take
basically the same three lines but
inside inside the body its class but
then we're going to do the other half
it's a lot harder like we don't really
have a quick access to the 64 class so
the best thing we can do is probably
just a monkey patching you method the
plus if we can do multiple methods that
we can get this badge inside the class
otherwise it's gonna be even Messier is
only trying to adjust the post method
the handle of audience so this is why
you not play it doesn't work you're able
to identify yourself with Madeline
you're trying to extend the math
operators and so now their tentacles
with the treasure talk about the type
system we talked to mention compilations
now we have enough background that we
talk about the details of how things go
fast so first we're going to talk about
dispatch and captions make this fat
track faster so this match happens a lot
it happens like basically every time you
call function so this is really
important that's right and so this is
the code example I'm going to use so we
are coming through different from all
three vehicles I should change the names
and so we're going to call to a five and
info of six and then full of seven and
these are all integer literals so we
know that all of them are in 64 is so
we're calling this the signature three
times in a row so the first time we're
going to dispatch the valid method and
we're going to compile it and then we're
going to run that code the next time we
just need to dispatch defines that
method again
run the code burning pile because we're
going to take the same so we got paper
method being pilot you save the compiled
code with that bad thing from that file
code ha and what we could committed we
have to go through the whole list of
however many methods there are at the
best in these are our two possibilities
because they have the right number of
arguments one and this one tastes at 64
which is an exact match and this takes a
number of did one of the abstract types
that are super type of and 64 so we pick
this one and so we should eat a dispatch
again because we're we're going to pick
it full of n64 so we don't we can adjust
that step to be faster rather than going
through a whole list of aput be over a
thousand functions did you figure
because it was in exactly so I just
invented this function i made of these
signatures the best matches video is
because its exact this one because of
several steps up like integer and number
it's like further off as a loser
attached so we want to avoid that
dispatch you may not want to go through
the whole list like plus literally has
like hundreds or over a thousand
function methods that you can look
through so you want to not look through
all of them if you don't have to and so
what we're going to say that they put
the same input so full with it 64 always
idiot the same results given these
method options and so this is a good
place to add a cash because you get the
set of same result for the same input
and that's like what a cash is good so
we're going to add oh it's called the
method cash here so this one's going to
get a cash
so it has to be the whole thing well
then after that we can just go after a
time using function to and giving it one
in 64 just give me the code you already
have pilots and so we can just this is
like calling into a hashmap instead of
how they can go through a list jessica
teens and so next part is junior
conscience so Sharon functions vario
says that multiple dispatch means that
all of our function if your generic in
the sense that they can handle multiple
different argument six and so here is an
example of a single method that's
already generic because it handles to
handle student versus is multiplying two
numbers number in abstracts hey this is
grayed out because you don't even see it
other than these two so this is because
this assumes that the two number of
tapes whatever it ever had to pick will
implement plus and minus in order to
make multiply work as we this example
we're making the silly assumption that
no other implementations have multiplied
exists so that mind will always get
dispatched you this is a good news room
there's no friction it's a pretty silly
assumption but also gonna make the more
reasonable assumption that posted minus
implemented on numeric types which is
more comment so you can call this origin
by multiplying 4 times 5 to 8 20 and
also for time so I can see it funny and
notice that in 64 result the next in 64
and put 64 you go on the float 64 and
sometimes we're depending on those other
generic functions plus and minus which
you know if you if you add in subtract
two 2164 you'll get another float64 back
and so this is like you know pretty
straightforward we talked about
semantics of the language but we
actually want to compile it we have two
options I most languages or hide this
from you
really see what they're choosing between
not c++ w if you get to choose between
templates and dynamic dispatch which are
basically the two options for compiling
generic functions if you do generic
dispatchers equals lots of facing the
same is well the way most languages do
generic functions and that's you write
one function and your code and that is
compiled to one binary blob that handles
anything that that function allows it to
get passed to it so we handle to number
is in the function and one my hair while
if they know all subtypes of number
anything you pass into it should get
handled somehow the other happen is
templates which basically do aggressive
specialization let me write if your
template a function in C++ or if you
move right any motion in Julia this is
what Julia does you get so you hack
right nearby our function with your
numbers when we hold up in 64 is we get
a specialized version it only handles to
it 64 is what we call with Duke low 64
to be another specialized function that
separately generated that only handles
float64 s and this is a trade-off like
since there's different options and
signals all cells you choose from year
one that's a sign that there's some kind
of three off this case of dre often
between concise and scheme so if you are
difficult size if you have like a
generic vlog this is a general sketch of
that and that's too specialized blogs so
the generic lab has like this do stuff
with one and this happens no matter what
the pipes are and in case of skin like a
couple situations you can be in and at
this level but appears months over here
but placed over here is it happens and
stuff that sort of happens for all the
different types and it hasn't happened
in each of the specialized walls so they
are that much if that's like a big chunk
of code but this is like much bigger
than just how to do it months over here
on the other hand we have more branches
making the generic blobs slower because
as we figure out
situation it's even in before can do
anything on the other hand you also have
the general also has to do dynamic
dispatches on plus and minus because
where do we allow you to add more
methods and more types at any time so as
you add more more subtypes of number we
have to handle more things that we were
not prepared for a compile-time which
means we're definitely gonna be doing
some dynamic walk-ups to decide what
plus and minus to use on the other hand
our n64 go out knows that it's
definitely going to call plus a night it
was just in 64 s do this next note
consider that's what it's getting cold
plate and i'ma say we'll wait a bit we
haven't talked about anything where you
could like do special dispatches if you
know the tapes of your calling a
destination where you talk about visions
opportunities to avoid dispatching
because we don't like doing slow things
like David family book looks like this
better so we have two new example cohere
a function a.m. and it calls be event so
it's doing the same argument there and I
where two methods of the event one that
eats anything about the taste 64 okay so
what we're going to try it is like some
ways to avoid this dispatch here we what
we want to make this go away so that
we're not doing a dispatch one option is
in lining this is basically like copy
pasting some code so we have this call
to a which is hitting it in 64 and we're
coffee with that n 64 so you can copy
paste the body I love that method right
in there so n times do obviously the
comparative continues after that is
asked nick name spacing still work
because you can't be able to tell that
it in mind anything so it semantically
your coat stays the same but basically
it's just pasting it in there and then
it can do then you have the identity
more organizations because the compiler
can look at books at one function once
what is optimizing so if it's in line
stuff it might be able to do more
optimizations that they would be able to
do otherwise the disadvantage is cooler
like he is small in this case like n
times 2 we don't really care about
whether we're compiling that basis with
its tone so tiny but if we had like 200
line function and we pasted it every
into it every time it was cold that can
generate a lot of extra code and a lot
of extra work for the Pilar so instead
we might try to keep it relation which
is another this is the name that sequel
plus users for it isn't much Julia Julia
media calls it but it's basically the
same thing so if you're going to deeper
chua lies you would wear the same
situation as if now be is bigger so we
don't want it in line so instead we're
going to basically put an address in
there or in a pile that method be you
are in a state in the method cash or
take it out of enough cash to move
already there and we're going to say
what we're going to go right over there
where we put it we're not going to put
up anywhere just like going to go
straight there and this avoids the
dispatch while silhouetting has reuse
the work because it's going to meant to
catch everybody else is going to use the
same kapatic version for that signature
as nao if i put in all the sort to be
able to like not dispatch why don't your
mommy this fact obviously there's a
reason and that's because usually we
don't always know the text right like if
you haven't taken unstable country if
you're not going to be able to do this
because you offer what your types are
and there's other cases where you're
calling the function without knowing
what the tank absolutely is going to be
there's also some of a problem so this
isn't a similar code example any calls
be this is me at the ripe old defining
so eight holes be and we have be that
just as n plus M ah and so I'm going to
call a 25 and an error because I didn't
I know if you remember this is what i
type in for me and is not defined
anywhere I've never ignition you very
will need that so that's a problem and
so I can go back and fix it though so
remember me to find me I'm going to make
it return n + 3 + 3 is definitely
defined and so now I'm going to get do a
f5 and I'm going to expect it to return
10 because i have 5 plus 3 and i'm going
to add to an a but i just want to
actually get as long as I'm still the
same rebel sorry that the red is so hard
to see but so this is giving me a
defined areas exactly the area out of
but before and it's because I have
inline code so this is because we got in
line into a and so this is issue queue
65 which is a relatively early issue
member this is code from this is output
from this morning so it's not like it's
fixed part of the reason is it only
shows up when you're like interactively
debugging something because once you
like actually run your code is just in
the files it's just going to be 0 you'd
finally or functions then you start
writing them you don't normally like
start redesigning things so I'm you can
fix this at the rebel you can if you
define a again with exactly the same
definition it'll pick up it'll clear up
a method posh you pick up B and then you
get done so now I'm going into there is
like 2 4 sections myself before the
conclusion and these two sections are
both more about like writing in touch
really good okay this one is like
reveals and things about huh girly is
implemented so Texas ability is helpful
for writing private class code where you
talked about how it could save you with
dispatch when the compiler really
understands your code enough to know
what the types it's calling but what
types of the our concern so here are two
functions a
me so this 17 equals 0 0 isn't it 64
little and then foureyes 100 wriggle and
I Jovian street in 64 here some of us
equals pi divided by 2 so it's 64
divided by n 64 the magnetic was afloat
64 because scientists know that pi
divided by two is 2.5 it's not too and
so that someone's going to be 0.5 so
it's your maple at 64 and so some just
change type this is important in 64 64
and then the rest of the community I
float64 return is quote 64 on the other
side V is like character for character
the same except for it starts at 10.0
this means that B is a stable because
some is afoot 64 all the way through the
function whereas a is unstable because
some changes head ok so I said this is
important for performance so I can fetch
article mentions you have time this is a
very interesting midterm because i only
did 100 so it's all over like e to the
native six seconds so it's you know not
very much indifference however
interesting thing here if they were
already see a different indifference in
memory allocation so al cared about
three kilobytes whereas veo reallocated
64 best that's a big difference
considering they're not doing very much
work they're doing the same work so why
would this happen so one fact that you
should know is that non-compete types
have to be boxed so now the concrete is
like abstract types or others has types
that change so like because some days
will 64 n64 switching this is another
country type anymore it it changes over
time and so what is boxed me as the
enemy
yeah so values you need to be stored
boxster and loves this is a pretty
common like concept in programming
language implementation so boxes unbox
values are just that it's so 64-bit it
takes up 64 bits and then probably is
worth in that way when it understands
that going to knows what this is what
type this value is and in put them
anywhere at once because it is what it's
doing so on the sack on the heap and
register you really love when your
additions happening in registers the
other option is box so this is what the
Pilar is a little bit confused it's like
I don't really remember what this is
value as a weird time I'm going to put a
tape type on it end of this so your
values about one byte longer on the
front so the product can check the tag
find out what types its hole putting in
there I just one of the priority needs
to tag to remember what the type is
because the thing is changing and is
always stored energy other pair commuted
over there mutable types can't appear to
change this all this is like not
surprising it's I said immutable but
Julia also has immutable text the other
kind of type it in tell you about so
it's a kind of concrete tank so it
follows all the rules and concrete types
but in addition values of the fields
can't be chained in fabrication by
default texture removal and you can
change in June week when we have 35 hot
3mon 5 when you change like a three to
two or four or whatever but if it's
immutable that we can't do that we have
to create any one and all the built-in
ameritech charlie that's in 64 point 64
bigots whatever they're all beautiful
enemy one is that they can't appear if
you change their probably whatever at
once under the hood as long as it
definitely doesn't let us like as long
as our answer is is if the hedge were
immutable and so especially when they're
in a register even though will you know
nobody else I know what I'm definitely
the only looking at this value i can
change in place and time otherwise our
be pretty terrible for our performance
if we have the copy things but it was on
the heat if the time then we can't
change it because it's like somebody
else we have a pointer to this value
wanna he who knows what who else is
looking at it I can't change it cuz it's
supposed to be immutable so maybe a new
one and so box give you values are
pretty bad for performance because we go
ok so we've all tips can't cure exchange
and so both the built in the Americans
removable so it's pretty bad when we
have box immutable values because we
have to copy them every time we want to
change home and make another value on
the heat that's where all our locations
are coming from we're making a new
smaller location every time you go
through that deep this is just see this
is the assembly code for a is it showing
you that not really is that allocate
more memory it's also more complicated
than B these are formatted the same way
and he is much smaller if you could read
that you can also see that there's some
like it sort of the assembly operations
here sort of what you would expect if
you were implementing this in SF like Oh
think it's at operations on floating
point numbers and so if this is the last
section before including so macros for
speed so you might think I'm going on
another tangent I gave you all that
background information and now i'm doing
back ribs which probably have nothing to
do with my performance so it really it
has a list of style macros listen tile
backer with meaning that they take the
metro takes another valuate expression
like a piece of AST and then it doesn't
operation on it and gives you a new
piece of AI stephen replace that one
with so macro bizarre supposed to see
style macros which you're just doing
replacements so macros are evaluated in
final time they're basically the first
step of compiling something because
until you run the macro expanded the
macros which is like what you do when
you like place the macro quality of
whatever return you only know we're
compiling these macros can do basically
anything name and that goes are pretty
magical so you should really use them
sparingly anything's harder to debug
they had this level of complexity where
you read the code and then you have to
like karaoke the macro which is usually
harder than reading normal code and in
general I couldn't use them unless you
have to use a macro
nothing else will work and so let's get
back to that performance thing so i'm
going to give you an example of macros
affecting performance so this is the
another example because really as good
at that and so a quarter tool so the
situation is we have ax squared plus BX
plus C what we want to do is evaluate
that expression to a gun and good press
we have a and B and C as actual values
and they also the value of x so we have
all of the variables we have just an
actual value so we're actually to do is
we're just gonna put into a calculator
arena like plug in those multiplies
dad's over there and if they can be a
calculator like pushing the buttons
takes most of the time but but I
computer like the is it pink much faster
than this the effect of the multiplies
are slower than the ads matters q you
care about the speed of your arithmetic
so you want to avoid multiplies and so
you're excited if I quarter school with
less you wish what you relight me right
this is that by moving the x over and
then we'll have two multiplies instead
of three and I appreciated your polygon
excited about losing one multiplied but
if we increase the power so we know we
have a cubic function and we go from six
multiplies 23 multiplies and I was like
half as many and only gets better as the
whole is like the power of X get higher
and I feel that this is exciting if you
care about the speed of your like editor
physic and like how fast you can like
solve that for inertial w so they say
make sure you as an implementation of
the macro and sort of in like
preparation for that are like you know
that this bottom row it's in reverse
order so we have D over here plus X
times c plus etc so the t is first as a
is lost I'm telling you this because
when we this is a BGC database including
the comments so the way there is
representing the coefficients d is P sub
1 the first element of the array and we
go all the way down to the last one is
new PA if we're evaluating a pilot
valuable a meal using heart of the
printers rule and so we're gonna make
we're making the macro it's called
corner it's going to take X switches are
at the value for x expression that
evaluates to it and then we're going to
take all the coefficients from DJ and so
I'm going to jump out the bottom of the
macro because this isn't people to look
at what we're returning in this case
we're going T equals X so X can be any
expression it could be like la HTTP call
for all we know so we gotta we want to
only run that once and save the valley
with t and then DX is this expression
with the link up so whatever the block
return rate is at t equals x and never
going to whatever DX evaluates to is
going to be basically result of this
whole block of code so what is he is so
yet starts out being a so these events
lasting in the early that's a and then
we go through a for loop we're going
backwards through the array so b c d and
then inside this word editing es so each
time we add more to it so if this in the
first time through the loop is going to
be so a piece of is V B plus T times a
and we go through the hoop again it's
gonna be c plus ki times B plus D times
a so we're going to keep expanding the
macro until we get the last one where we
have at thee to the front and then we're
reaching the whole thing and so that's
just a few lines of macro it's a little
bit more complicated because you have to
understand with all this escaping and
hygienic stuff is but under how this is
like a patient for implementation of
what we're going to did by hand and so
when we call macro we use an at sign so
let you know that you're calling a macro
which is like it could do anything it's
magical and it can't like redefined
variable to knows what's going on in
there but so we would call corner we're
not doing at expression here we just
have the value
elikem areas at that value above please
have a variable for X and then we have
seven coefficients and these are just
floating point numbers the interest or
you just part of the way you can write
floating point numbers and solo is this
fast so i'm holding all of this code and
like that example we're calling it from
this pull request that you can look at
on gether but if you want and let's go
on to add in the a corner macro and one
club and so we actually benchmark is
considered performance you don't care
how fast the macro goes well we care
about is how fast the function state use
it though in figure we're going to care
about the earth in the function which is
the thing for finding the inverse of the
error function for real numbers and
currently like all of the they are going
languages that have this thing like that
wage was that like a way of trying to be
obtuse so but when they bench like this
this function was four times faster than
from that one particular one and three
times faster than si Hayakawa i like you
to be like you julia is faster than
Python so what we already knew that but
it's not like swype i implemented this
function in Python it has been cold some
sea or for china implementation and so
this is pretty suspicious like i
recently it was like advice pastor of c
or light few times slower this is not as
fast as II this is faster so it's going
on and so they didn't make a mistake it
is actually faster so the thing is we
saw that a crow and by that back row the
actual compiled code that gets passed
into llvm has much of constants in it
it's just like full coverage of
arithmetic with like actual inline
constant it and llvm which is what
to produce assembly code love those
constants that's like easiest thing for
a little optimizer to optimize and so it
was like a cactus it's gonna be super
fast and so I said that she doesn't have
macros that has seen a cruise which
you're not going to let you do this so
she doesn't have the option of my
pudding I guess if you're going to write
this in any reasonable way and see it
basically going to be an array of
coefficients like just an actual normal
array and in an actual normal form and
it isn't it the theme of stuff we did in
the macro but at runtime and claim which
also using lb on this going to be like
well you know array for loop and there's
not that much that elevate was going to
do for it like it'll make it fast just
like any other Iranian for loop and I
see it perfectly fast at that but lady
doesn't is not the same as having actual
constants that's what makes this like
then this is like one of the times this
kind of cool that like it's like
abstraction that's like powerful or
whatever actually lets you go faster
which is pretty unusual usually it's for
extractions make things slower so it's
kind of exciting to have at least one
example of macaroni contains faster as i
get to the conclusion so we said that
scientists like things that are easy to
write and pastor I'm ah we chose dynamic
so that became easy and have a rebel but
we make implemented on it so that it
doesn't take like hundreds of nine years
of efforts you a person years of effort
to write the cloud we've made an entire
because that's a given class that's like
what you do human go fast LOL so take
multiple dispatch and macros to make
like fast code concise and like all
those add up to julia's designed to be
fast easy both for users and through
people writing in the private and i may
be your baby out of ten more questions
probably time for questions
hi you mentioned sci-fi and how does
trulia compared to our regarding
performance piece of you so our if you
two are only go fast if you write your
code in a very specific with vectorized
functions and so if you want idiots on
things like Monte Carlo simulations you
really need a for loop so r is extremely
slow at stuff like that it's hard to
compare vectorization because really
it's very fast to be writing a c-like
style with four loops so if you write
the same operation in their own styles
i'm not sure where the comparison is but
if you're right anything reform that
julia is much much faster let's see so
you said i don't know i don't know any
people who like writing our code
although nobody people really like
writing Julia code and Julia cookies
much more natural to me like it's the
same as writing like the easiest icon I
think I've had it will get easier though
they convenient types and you can
actually talk about types and julia
despite it being Diana which is what I
things I think
for opening few positions Claude so the
question is does Julia support for an
MPD paralyzation I think so is do you
mean calling OpenMP or writing code in
the open what basically I need the
support photo because the open so you
can do you think you can call leverage
that use OpenMP there's actually
experimental support for OpenMP style
Freddie I'm going to talk about that
tomorrow so he's one of the co-creators
of Julia so if he knows more about some
random library support than I do it's
also really weird to go to Julia talk
with him in the audience you have one
more question
okay it looks like we're all other
questions thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>