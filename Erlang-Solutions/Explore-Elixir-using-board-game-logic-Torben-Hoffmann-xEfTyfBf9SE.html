<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Explore Elixir using board game logic - Torben Hoffmann | Coder Coacher - Coaching Coders</title><meta content="Explore Elixir using board game logic - Torben Hoffmann - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Explore Elixir using board game logic - Torben Hoffmann</b></h2><h5 class="post__date">2015-09-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xEfTyfBf9SE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
hello and welcome to the Alliance
solutions monthly webinar my name is
Martin military time the VP for amia
region here at her lying solutions
today's webinar represents a
continuation of a series of webinars we
have been organizing across topics of
interest in the world of our line and
dealing with solutions based on the
airline programming language today we
will try and tell you a bit a bit about
the emerging paradigm of alexia and how
we can explore elixir using board game
logic as many will know elixir is a
functional programming language
orientated towards concurrency and
today's webinar will aim at translating
some of these concepts and lessons of
board games into how you could solve
real world problems by using elixir as
with any live events please do excuse
any technical issues that we may face
today but to start by telling you a bit
about Erlang solutions we are a products
in services orientated company
completely devoted to the ER line
programming language and increasingly
working with and providing expertise
around elixir since our founding in 1998
we have worked with organisations and
individuals using our life helping
evolve the language and supporting
people and businesses using it today we
are just over 100 people across our
offices in London Stockholm Krakow
Budapest Seattle Buenos Aires and
working on projects across the globe we
develop Erlang based products and some
of those include our Mongoose IM
messaging platform the react distributed
data store and one bath or am are
monitoring and management technology for
Erlang systems as well as other
solutions applicable across sectors and
problem areas where our line of course
makes sense I'm very pleased to say that
our speaker today is Tobin hoffman who
is an architect at bayshore technologies
Tobin has spent a number of years now as
a self-confessed Erlang priest I've
creating the use of our line across
industries and helping companies and
individuals benefit from Erlang and her
line based technologies please allow me
to finish by saying you are most welcome
to post questions throughout the
duration of the webinar by using the
chat facility on the webinars interface
our speaker turban will answer as many
questions as time allows at the end of
the webinar if any questions do raw
unanswered you're welcome to raise them
by email using the following the dress
webinar at airline hyphen solutions com
I would now like to hand over to Tobin
who will be glad to start us off Thank
You button ok so today I'm going to talk
about how to use he licks here to
implement the logic for parking and that
might seem to be something that's not
very useful in the end except for good
fun but actually taking something that
has a very strict definition and then
trying to implement it in a programming
language using the paradigms of that
programming language will teach you
something about how that language is
supposed to be used and then it actually
turns into something using real life and
of course even more so if you're
implementing board games in computer
languages for a living so in order to
become a bean store and the beams this
is anybody working with languages on the
Erlang virtual machine the beam you need
to be ready for it and I hope that that
people with an epileptic attacks would
look away but the rest of you take a
deep breath and then be ready to feel
the love of the beam just be ready and
then soak it in just soak it in you are
now about to be ready to be say I love
being I love be you'll be then a few
seconds and hopefully the rest of the
slides will help you transfers into
becoming a real beam stuff good
everything on the beam revolves around
the golden Trinity of airline so that's
the notion of share nothing fail fast
and failure handling so you have
processes that do not
anything they sent messages to one
another you have failed fast if you
don't know what to do you kill yourself
or you kill others and if you run into
something with a things failing you have
failure handling on top of it but today
I will focus on the share nothing part
because that's the first scary part
about getting onto the beam
understanding how you make this
processes with message parching work for
you and actually design systems and then
it comes down to concurrency and this is
a thing bolted stock is set at the
keynote at the earning user conference
in 2015 no Diaz has an interesting
approach to concurrency it's by having
none and that means that in movie terms
we're back to highlander and this is
also how you have to think about
cooperative multitasking as they have it
in languages like no tears there can be
only one so if there's one guy wanting
to do something one process it'll make
everybody else starve until that process
has done its work so that's not running
very nice but then it comes to the
Beanstalk on currency that means you
need to have a ton of lightweight
processes and the equivalent movie wise
here where you just need to find let's
have a lot of good things happening
spontaneously and every just work things
just works out I haven't found a movie
for that if you find a movie for that
that just has this good things happening
all over the place please send me a link
him and I'll see it but in terms of
having things that just multiplying
especially after midnight we actually
have little remnants here so this is
your think of your processes they just
multiply all over the place some of them
are not as pretty as the others I'll
give you that then eventually you'll end
up having so many that you need a
manager and there this is how a manager
process should look like in your mind
and then you have other processes that
are trying to work together to achieve
something and then at all times where
this is going on somebody very sinister
will be running around trying to kill
these processes so these all things we
need to take into
account when we design things lots of
processes something somebody has to
manage all of that and then killing will
happen processes will dies and we need
to deal with all these things and that
leads us into a methodology and
technology so how do we do this how do
we approach this one thing here is that
uml is not the answer there and if you
want to read a little bit about that and
then i'll suggest you to turn to michael
jackson there it's not the same it's not
the guy doing whiskey books it's the guy
with the doing software and this book
has a section on brilliance you should
go read that one it applies to a lot of
us in our daily lives there and as also
there's a lot of good tools in that book
to be read so I recommend that one over
there what do you need instead of these
big tank tools like uml you need two
things this was enough to take me and my
team through creating a mission-critical
gateway at motorola interaction diagrams
showing the processes and what kind of
messages they were sent into one another
and then message sequence charts that
describe the flow for messages and how
the different entities communicated this
is enough to do a mission-critical
gateway this is enough documentation
remember that you don't need anything
else when the QA guys camel comes along
and say you need to buy 400 pages a word
document to do something cut them off
this is all you need so a protocol is
actually just how we solve a problem
together and then the together part here
is the key here because you can solve
problems in a number of ways and in
different paradigms but with protocols
it's how different entities solve a
problem together and i'll show you how
this works here for for this board game
and with protocols if you want to dive
deeper into this you can go and get the
horse book on communicating sequential
processes it's free freely available
online as a PDF or you can also go in
and get book called principles of
protocol design the book that i bought
once when I was
it is get expensive there but a lot of
people saw the book after having had
that course I never sold mine because
it's actually a really really good book
there so if if you want to really read
about how you actually design protocols
and how all this works and how we do it
with an underpinning of a CSP because
that's a notation using that book I can
wholeheartedly recommend or robin spoke
there good then you might be at this
point going what's going on what is what
is going on in this guy's head and then
a lot of people actually ask me these
things that what's what's in in your
head what's in your brain talking and
and you really really you don't want to
know because it's hits a lot of messy
things but when you took talk about
what's actually going on in your brain
on the physical level you're actually
having a number of neurons firing off to
one another through the synapses and
that's actually something where you can
see oh the neurons here is sending
messages to one another this sounds like
what o.o line ah the beam and this is
actually a topic of a whole book on how
you can actually use this methodology or
processes and mrs. passing to actually
generate things that emulates the brain
and you use for artificial intelligence
also a quite good book to go through so
word of warning here and for those of
you who haven't met me in person perfect
I am not perfect so I will now show you
my approach to design in the sport game
in elixir and there'll probably be some
of you that can find ways to improve
what I've done please go ahead there i'm
going to show you the the four process i
went through and also the arrows i made
as i was trying to deal with the problem
and i think that's actually something we
should all do sometimes instead of just
telling everybody about the rosy picture
at the end of the road we need to tell
them how we fell off the road every now
and then and how we got back on track
they're so that's what I'm trying to do
here so I'm going to talk about this
board game called a choir it's
actually an ancient ancient came almost
there not as old as monopoly but it's up
there so it's about growing and merging
corporations you have to buy stock in
these cooperation and of course in a
game that has that sort of feel it's
about getting the most money at the end
that's all it's a very capitalist game
and there and the board looks like this
at least in the addition I have here
where you can see this very funny way of
numbering aboard so you can see the the
row of the column with one instead of
saying one two three four it says 1a 1b
1c it's a very odd numbering luckily the
tiles are exactly the same so they match
the board and that's what you put on the
board to do things and then you have
here you can see these nice building
hotel towers there along with some cards
on the board and the cards they're there
they are actually the stocks you can
have in the different companies and of
course you want as many stocks as
possible there to become the richest
person in looking and yeah and here you
can see that there are these different
corporations and what the buying and
selling price for incorporation is
depending on what type of cooperation it
is a low tier metreon height here and
then how many stocks are number of tiles
there are in the corporation on the
board so you can see as a corporation
grows with number of tiles the price
goes up and then it grows into a
interval thing there and then after 41
that nothing happens but we will get
into that later so move outcomes so
there if you place a tile it can result
in a number of different things so if
you put it on an empty type a space with
nothing around it nothing happens that's
just placing a tile on the board there
of course you can go on google the
rules get the PDF for it because then
you can see everything but so I'll just
try to make it short here then you have
another fun here is you're placing
something next to another tile there
that has not been incorporated and that
means you're incorporating so that means
if you're placing a child so that it
forms a continuous segment of spaces
next one another with tiles on then you
incorporate you create a company so you
become the founder of the company we all
want to found a company right then you
have this other thing where you're
placing something next to an existing
cooperation and in this case nothing
happens empty spaces and all other sites
so you're just expanding the cooperation
making it bigger and then we come down
to the thing that really makes the game
funny this is where you merge the two
cooperation so if you place a tile that
glues together to corporations then
you'll end up with a merger and as as in
real life it's always the big company
eating up and now each purpose is a very
bad word to say that is collaborating
with the smaller company and integrating
it to become a happy marriage or two
companies that's how we should figure of
course yeah so that's what can happen in
the game and then the beams to design
for this and excuse me for not saying
elixir sign or long design but if this
is just beams the design so if you're on
the run on vm the beam this applies to
any language you would use this would
work with most of the languages there
without a quirk they're so in this case
I've chosen alexia you could chew you
could do this in your long as well not
much of a difference there just keep
that in mind beam star is on the beam
then the basic beams to idea the first
one you need to get into your head and
just instantly think of every time you
think of a something with the beam is
that tada one process / space so each
space in the board should be one process
that will come on whatever happens to
that space another thing
did you do you should have one closest /
cooperation so when you created a
cooperation in the ball in the game a
process should be created to deal with
whatever happens to that cooperation and
then of course one process /
microservice so so this is you can now
be totally postcard compliant by being
on the beam you just have every time you
have a process and especially if you use
this approach of thinking about
protocols means action here each
protocol turns into a micro services and
then we are as happy as we can be when
you play bingo and other things
now the design process that I recommend
following at least the one I'm following
there you can see how that you draw up a
message sequence chart for the Golden
Path a Golden Path in this case is where
nothing goes wrong does the ECP see no
error conditions no nothing we'll deal
with that later because the important
part is that you get that structure in
place and then you build upon that when
you start to need to fix arrows in the
code but get the codon path down first
notation i'm going to use here is like
this so here at the top you have two
processes a and B and here you have an
asynchronous reprise so that's where I'm
just sending a message with a fat line
between the two processes and if I want
to do a synchronous reply I'll send off
a message and there'll be a dotted line
Tippett going back to the other process
with the return for that message one
going and you can draw all these mses
with a plant UML there told you uml is
not the answer but plant UML has a
sequence diagram thing there that is
absolutely lovely to work with its or
text based and then you can forget about
the seven or eight other types of
diagrams you need to do uml this is the
notation you need to do work with yeah
so placing a tile you'll have a number
of processes you have a player he'll
send a move tile to the term process the
turn process will take care of
everything related to a player's turn
the first
being a plan is to do is to to place a
tile then the term will ask the space
what will be the outcome of placing a
tile here in this case we're taking the
easiest case first no neighbors to the
tiles that's the first one I showed you
before it'll set reply back nothing
happens here and then the turn tells the
player okay nothing happened and you
allowed to buy stocks that's how you end
up return in your game you allow to buy
stocks in the existing corporations
those that have been incorporated and
that's the end of your turn so this was
the golden golden path the very easy way
of placing a tile then we go on to the
slightly more yeah well the thing here
is you want to make sure that you don't
put too much logic into each process and
that means that deal with your own stuff
whatever that is and leave complicated
coordinating coordination to others and
this is where you need to iterate on it
because you will not know the limits or
the borders to draw between what it goes
into one process and what goes into
others as a coordination thing until you
work the bit with the design I'm sorry I
cannot give you a full rule on that
upfront you need to work with this but
let's have a look at how that would work
so here you have the board and any as I
told you there would be a process for
each of these and then I told you
something about that we needed to know
the neighbors of of a space on the board
and that's to figure out if you're
gluing something together so you need to
be able to talk to your neighbors so if
we sit through the inside the box
thinking here then you'd write up a
function like this that returns the
neighbors for given space on the board
so here you have that you have the
corner one the one a it has two
neighbors 1b and 2b and then one I
that's indeed other end of at the bottom
and of the first column that has two
neighbors 21 h and 2i and so on and you
can see that there's a lot of different
things here that you write down and this
was my initial version until I started
looking at
at this and said I don't like this this
is too complicated so uh and the inside
box the thing is actually also you can
see the code for it here this is not
nice functional code and that's again
there's no metric fraud you just look at
it and it doesn't feel nice because here
you're taking the neighboring status and
making sure that it has enough of a
length there to do the thing and then
you're saying if the neighbors there is
nothing the bomb and if it's not all of
this very complicated to figure out
there and you can go in this code will
actually calculate the right thing for
move but it's not easy to read so now
you need to think outside of the box
yeah and yeah I guess you all know this
exercise that you need to connect all
nine dots with four straight line
segments and you're not allowed to lift
the pimp why do you do it and if you try
and do all these things that will not
come to nothing until you realize you
need to do something like this down
there and then you draw outside the box
you go down again and there's four line
segments connecting all nine dots that's
the same kind of thinking we need to
apply to the representation of our board
a obviously require so here outside the
box you just add extra spaces around the
board you're just extending the board of
course don't do that physically because
then it just starts looking ugly but in
our representation of it we add extra
spaces around the board and that means
the thinking outside the box code
actually turns into this so this massive
thing I showed you before here these
neighbors of a square actually turns
into and we'll get past this one on 26
lines of code very easy to read so
that's one common case here where you
take any space on the board and then you
just get the neighbors back and some of
the things here will be things that are
outside the physical board but they'll
still be processes and they will just be
empty all along
and that will make the code a lot easier
to deal with then the pattern matching
here it comes into full place here
you're asking you have a function here
that returns the neighbor status for for
a coordinate excuse me one second if its
native status returns it's the last of
the neighbors is full that means you can
incorporate it and if you have one or
more of your neighbors that are
incorporated you take them all all of
the names out and say now we need to do
a merger between those corporations and
in all other cases the outcome of this
move is nothing so that's a lot easier
to deal with because you can actually
look at the board go get placing tiles
and see okay this is how this neighbor
status would work out and this is also
how we as humans we think of this we
instantly think of a pattern to look for
when dealing with the rules of the board
game in this case we have code that very
closely mimics those patterns that we
see on the board and that's actually
cool that we can get pattern matching to
match patterns in the physical world
again coat that's closer to what we
actually think is easier to understand
and maintain then we need to buy some
stocks and when you're the she saw
earlier the turn will will ask a player
now it's your time to to buy stocks and
in this case the player chooses a number
up to three stocks is the play allowed
to buy and then the turn pro so we'll
have to iterate over this and this this
is my first design here it'll reserve a
stock in the bank and get the price back
from the bank then it will debit the
players account to see if he can pay for
it it will work out in some cases
otherwise will be an error turn then you
go back to the bank and say now I want
to buy the stock that I was reserved
before because now I know that I have
the money for it get ok back and then at
the very end you will add that stock to
the players portfolio which is a
collection of all the stocks he owns in
the game and then you repeat them for
that for all the corporation's the
player wanted
by in and then you sent the pie result
back to the player and this is
complicated its way to complicate it you
do not want to do it like this and this
is something you realize when you're
sitting there and you're writing this
our pinnacle this is are not nice
because you start thinking about the
coat and everything so I sat down and I
fought a little bit about it and then I
came up with this and I'm pretty sure
they got me the next thing I'm pretty
sure if you think more about it you can
probably come up with something that's
even better than what I so this case you
still have the turn asking the player
buy some stocks and then you get the by
choices back and then in this case we
turn some of the nochi into something
that the pink should manage so here you
have the turn asking to buy a specific
cooperation for that player and the bank
goes off if you can dip it the the
players account ie there's enough money
in his account to pay for it that's
that's in the ok coming back the bank
will just add that cooperation to the
player portfolio there there and then at
the end the bank will send back to the
turn it went ok here's the price and
then you repeat for the corporation
again and you can send the bar by result
back there and you can see here there
are fewer messages going around to this
this one that's not a measure in itself
but it's very logical when you explain
to people how this would work and it's
when you it feels more logical and
explaining it's probably a better design
and I'm very open to discussing with the
people how we can make this even better
but this is this is the best I could
come up with at the time when I looked
at this so good think about if it gets a
little bit too nasty try and find some
other ways and again do it here i'm
shifting some of the responsibility from
the turn to the bank this is where you
don't know why the border is between
processes in terms of who does what and
you need to iterate to find where the
border is good and then when you
incorporate things that's remember
that's where you
plays a child space on a child next to a
number of spaces with tiles on already
and then you see has one field neighbor
no corporations so you get the
incorporate mesas back from the space to
the turn and then you ask the
cooperation process is this in corporal
and then the corporation will say this
this amount of companies not
incorporated yet these are the your
options to choose from the turn then
asks the player choose which cooperation
you want to found and then at that point
you know that this move is going to go
ahead then you remove the tile from the
tiles ahold by the player so the player
has a process that keeps track of which
tile he has on his hand you had I think
we have six at all times there and then
the turn changes state and say now I'm
awaiting awaiting the incorporation
choice from the player and this is
actually also what happens when you're
playing in real life you agree that okay
this will turn into a incorporation of a
nuclear cooperation here and then you
need to look at the player that plays
the tile and you asking what cooperation
would you choose and this is the
incorporation choice here and then you
say send the in corporate message to the
space you ask the bank if there should
be a founder stock for this cooperation
that some quirky cases where you don't
get it there the bank will then add that
stock the founders stock to the players
portfolio and tell him that he's founder
of the company and then they'll be
returned to the players and then we
would turn to them we go to the last
past of a plain stone that's buying
stocks the things we saw earlier I
haven't iterated over this and because I
found that this design actually I was ok
with that I didn't feel that it was
awkward to describe or anything but
again if you come up with other ideas of
how to place responsibility and
everything I'm more than happy to have
that discussion but that would probably
a discussion we should take off line and
not into heavy details at this meeting
we'll find out we'll find out there and
then there's the merger that's where you
place a tile and you end up gluing
cooperations on the board here together
there and that means that the space will
look at its neighborhoods knows it has
more than one cooperation as enable it
will tell the turn that a merger will
happen the term will ask cooperation are
these corporations miracle and the
corroboration we will answer back again
remember this is golden case yes it's
myrrh table and this is going to be the
surviving corporation that's the SC and
the rest will be merged into the big
corporation and then you need to loop
over all the corporations that are going
to be merged into the new big
corporation I either the small ones will
be sucked in and then you need to ask
for each player how many stocks does
that play I have in his portfolio
because that determines who gets the big
bonus the guy that has the most stock in
a given a company gets the big bonus and
then there's a second bonus and then
nothing there so that's how you get more
money you have small corporations where
I have a lot of stock in that they get
merged with others and then you get a
payout there so that's like being bought
up by Facebook for 19 billion dollars
something like that so you calculate
your bonus and you go home happy there
and then once you've calculated the
bones for each of the player then you
created the account with that particular
bonus amount and then you need to to
loop again because the stocks you used
to hold in the now defunct company you
need to decide what you want to do with
them and then you can either hold on out
onto them hoping that the cooperation
will be created again this is what it's
a game thing and not real life there and
then you can trade them and trade them
in to get their stocks in the new
surviving corporation or you can sell
them at the price of what
given by the size of the cooperation at
this point there this I must warn you
it's not been implemented yet so if you
go to the github repository for this
thing it's not there and I think I'm not
sure that I'm i placed everything
correctly at this point so I need to
revisit the design iterative at some
point when I start implementing this and
I think that's also the lesson here you
try something out if it feels ok you
should start putting some code together
and the code will tell you very fast if
this is a very bad idea you you will
feel pain when you're coding and when
you're coding with the on the beam when
you're being a beams the coding should
not feel painful we're not practicing
paint driven design as they do when they
the code in Java we it's love we're
doing love when we're coding so please
if it feels painful you're not doing it
right that's my recommendation anyway so
now to the implementation of this so you
always get this thing off a list when
I've talked to people what should I
choose because there's a number of
standard behaviors in elixir and also in
Erlang but an elixir these are the ones
you have a gin server you have a task
and agent and you have a generous of
that again if it's a it's a finite state
machine board for directly for Merlin so
how do you choose which one to use for a
given thing because if you choose the
wrong one your code will become painful
and you don't want that it should be
lovely and nice to write your code so
design choices so you have this spectrum
between pure computation and pure state
and honest under pure computation you
can do a task all the tasks does in
alexia is to compute something you ask
it to do which is nice on the other end
of the spectrum you have an agent that's
all about state the only thing it does
is to keep state doesn't do anything
else anything then in the middle of all
of this you have a gin server there so
you have three choices
on this axis there and then of course
sometimes the gen server is just not
enough to do things and that's where you
have the generation that is for the
hairy stuff we're transitioning between
states and keeping track of which then
that will take you from one state to the
next one becomes important so then
that's where you have the generation and
now I'll try to walk you through the
different things we have and see how
that works out so but before that I
forgot about that one yeah the NFS I'm
warning it comes directly from your like
there's no alexia wrapper around it here
and you need to put a call on in front
of the the module name because it's an
atom there and it comes directly and
there are no default implementations
that means that all the functions have
stated here you need to implement them
there and then you need to add two
functions a state name to an estate and
three for each state you implement that
is just a number of boilerplate code
which if you used to doing a lot of
elixir you will see that as nearly no
boilerplate especially in energy and
server you only need to implement the
things you need but here we have to do
everything otherwise things will it
explode on you and I'm actually been
thinking about creating a better
implementation but the time is not
enough I need 48 hours in a day to be
able to but I have some ideas brewing so
we can ping pong on that one then
hopefully you could implement something
that's a bit better but anyway so the
player account remember that's when I
talked about keeping track of his cash
there you can debit and credit the
account and you can show the balance and
before I'll show you what the right
choice is you should think about it for
a few seconds what would you choose
which of the things I've shown you would
be the one to use here and in this case
it's an agent because this is all about
state there's no other things going on
sunday teen will fit just fine there so
then the account you all start with
6,000 arbitrary money units I can't
really remember it says dollars in the
game of this week is 6,000 there and
then here you can see I'm using Jeep
rock so I have freeform names when I
name my processes there and that's why I
use the function you called via name and
then the course and use all these deep
rock things but that allows me to have
very clear names for the for the
processes with a nice hierarchy to it so
when you look at this process it will
have the name Claire a tuba player that
account and then the name of the player
and that's actually pretty nice when
you're trying to debug things that you
can have nice names on the processes
there and then you here you can see the
function the balance is just getting the
balance out and remember the only thing
you keep in the state is the balance
there so that's just returning the state
there and if you want to dip it here you
through the agent get an update there
there you get the name of the the pit of
the process fooled the via name and then
you do a handle debit function with the
state and the amount that you want to
dip it and you can see the handle dep it
at the end so if you have more in the
account than they want to debit it's an
ok you can debit that in other cases if
you're trying to debit more than that's
in the account it's an error that's very
nice code you separate out the two cases
here and it's easy to figure out and
then if you want to credit something to
a player account you just make sure that
it's an integer and that the amount is
greater than 0 and if that's the case
then you just add the amount to the
state and that you can do that through
the agent cost function so that's a poor
ties and easy to tune to implement yeah
and the question is can you smell it can
you smell what it is just try taking a
deep breath through your nose can you
smell it it's a micro service yeah
 pink was not complete but it's
a micro service and the it's just a
beautiful little thing there so
then we go on to the space on the board
there and you need to keep track of the
status of the space it can either be
empty full incorporated of a certain
corporation you need to be able to show
the status and need to determine the
outcome of a move depending on what it
is you do then you can think about it
for a few seconds what would be a good
behavior to use for this this case again
it's the agent you don't need anything
hairier than that then I'll show you how
that works because then when you fill it
out you do the same trick as we did
before we do a handle fill function i
use the trick or not the trick or d but
the convention that i do a handle
underscore something to deal with
something that's in my api there and
then you can see here that Phil will
only happen if the move outcome was
nothing you can go back to the rules and
look at that there and then you look
around and see if there are any
neighbors around and that can only be
one here because otherwise it would be a
merger if there's a neighbor around
there then you join that cooperation
there and you tell all your neighbors
because you could be having spaces with
tiles on them that are not bad part of
the cooperation you tell them all to
join this cooperation as well and then
you change your state to incorporate it
with the name of that corporation there
and in other cases and if there's no
incorporated around you you just change
stages to go be a full space on the
board and that's it so that's a very
nice and easy there there and then I can
just tell you the smell of microservices
in the morning it smells like victory
yeah so the player actually consists of
a number of micro services so that means
he should be a supervisor so the player
here well you have the player that
supervisor then you have the player
object and then you have a sora asset
object
it's okay it's the same thing as a
process when we were talking beep stuff
yeah sorry if somebody got really sick
now I really do apologize it process the
player process here and then you have
processes at the bottom the player count
the tiles and the portfolio holding all
his stock and there so that's how you
structure this there and these things
being microservices it's okay the
process is they're cheap the ER long
runtime the beam is made to make things
cheap so just have as many processes as
it makes it a sense to have their it's
not going to hurt you it's just going to
make you to sound very good there and
then the player and here there's a
startling here and there you can see
that in the init function I'm creating a
number of workers the account the
portfolio and the tiles there and then
they start supervising these children
and then we're happy that they all
started that's nice there and then I've
done the pad pad thing in like github
repo I have accessed the children's
modules through that children's bottle
instead of having the full API for what
you can do with the player in the API
module and you should really really do
that because you need to hide the
subprocesses because suppose one day you
figure out that my decision my initial
decision to separate things into these
process it doesn't make sense anymore
and then if you've tied everything down
to these different modules and they're
those processes you have to change a lot
of code so it's better to have the full
api api in the top-level process and the
network of defining that and then have
whatever underneath it it gives you more
freedom later on and again i apologize
upfront I'm not perfect I should have
taken this pill before I did it but yeah
there you go so then
the term it controls the execution of a
turn in the board game and it interacts
with the players regarding choices of
what to do and then you might think to
yourself what behavior should I choose
here and you can almost see it from the
different the things I've said in the
dms es showing the interaction here
there are some state to it that means
that it's this is time to bring out the
big Swiss Army knife of behaviors that
Jen fsm because it will encapsulate this
and do it in a nice way so let's have it
away so here you see here's the idle
function that actually defines the idle
state so the turn always returns to the
idle state waiting for players to to put
in a move and a player will put in a
move giving who saying who he is he or
she is and then the tile and then the
term and say is this the player that's
supposed to to play right now so you
have a current order of who's who's next
to play there then you also do a check
that is this tile actually one of the
tiles that that player has in his hand
they are hidden from the other players
where there if so then you can handle
the move if that tire was an increment
you tell the players incorrect I'll and
in the first case if somebody tried to
play out of turn and trust me this will
happen you'll always have somebody that
has fought out the most brilliant move
and they'll just put the thing on the
board there and then in real life you
you do various things to these people in
here we'll just send a message back and
say it's it's not your turn there and
then return to the outer state in this
case so the interesting part is how do
we handle the move and then we go back
to the new outcomes just to repeat it
here you play something with no
neighbors around it nothing happens play
something the next to something that has
something on it you incorporate it there
then you play something to an existing
cooperation that means nothing again
you're just extending the cooperation
and then you're merging to cooperation
so these are the things we need to deal
with in the turn so let's see here we've
in the handle move a function we just
ask this babe space what's the move
outcome if I place a tile on you if it's
nothing you'll just fill the tile you
remove the tile from the the player and
you buy go on to buying stocks for that
player so this resembles one hundred
percent the MSC I showed you earlier
there if the space says it's a move the
move out cop is incorporate you'll ask
the cooperation process is this in
corporal and there's some rules for that
there and then you'll fill the space you
remove the tile and then buy stocks
there if it's if it's empty on it in
case it is possible to incorporate you
get a list of cooperation you can choose
from and then you send the choose
operation back a message back to the
player remove the two tiles on the
player and then you go to the next state
in the state machine of the turn and
that's ever wait in cooperation choice
and you know which player has to do the
choice and what tylee placed and and
what cooperation he has he can choose
from and the very last thing is the
merger thing and that has a big to do
and it also has a big to do the g-tube
repo because I didn't get her on to that
one but that's how it pans out here and
then wrapping it up is that some sort of
Rises microservices focus on the
protocols whenever people start talking
about micro service and everything you
have to think about protocols it's all
about entities trying to collaborate
something its protocols solving a
problem together forget all the buzz
words people that only I'll solve this
with micro services the first thing is
when asking what are the protocols
you're going to put between the
different microservices a butler and if
they go like this you know you've you
found a bozo and if people start talking
about oh I'm using this protocol and
using these tricks here i'm doing a a
window buffer and blah blah blah then
you know you're talking to somebody
that's worth his or her salt otherwise
it's about
they're so just keep that in mind and
then if you want to do get the code it's
unfun get up there it's incomplete has
box and I accept PRS if you start
working with it of course and I also
engage in discussions there about
different things aspects of it well of
course and then you should be polyglot
you should know a lot of languages here
and this is is one of the common ones
you will find them on the net showing
how different languages in influence one
another and one thing you will notice
here and is that there are a lot of
languages on it and you should stay
curious stay with just one language is
bad even if that language is on the beam
just doing that language is bad for you
you should stay curious I'm sorry but
that's just the way it is the more of
different things you know the better
yeah yes I sound like an old professor
sorry there but you actually have one
thing here erlang Alixe here not being
on that map is the number one reason to
learn them because you learn something
you don't get from other languages in
paradigms so you should use this even if
this is not going to be your data or
your manager is going to approve using
it learn it because you think
differently and some of the things you
can actually go apply it to other
systems all the stuff I've said about
mses and everything and thinking about
protocols it applies to a lot of things
it's just easier to express and where
long and alexia but a good design never
heard it hurt anybody yet to see the
person that got hurt by good design
there and then this is release the beans
done inside yourself release the love of
the beam and have fun with programming
programming should be fun remember that
and then thinking how do you think about
this processes mrs. passing and the
modeling is mostly straight forward when
you approach is like like this of course
as I've shown you you don't get it right
first time but as long as you move in
within the confinement of a methodology
and in a way of expression your things
the problems will will come screaming to
your face and you can get around them
and some of them relatively easy this
way and actually it was great fun
writing the things I did wife require so
yeah that's what to do and then the
modeling is actually okay so yeah and
then remember the golden trinity of
airline share nothing have mrs. Barton
feeding the process fail fast I haven't
you don't do that today and also the
failure handle not shown as well you can
go on google some of the other toxic
donna talked about the fail fast the
failure handling in other talks yes we
can go have a look at that there any
questions other now through the chat or
then send them off to latin and you'll
probably send them off to me and then
I've try to prepare a reply to them so
thank you Torgon thank you for a very
inspiring talk on a mixer and on
erlanger times I'm sure that everyone
who's participated from the perspective
of the audience will join me in thanking
you as it typically goes we have a very
limited time left to get on to some
questions so I'll just get on to them
straight away I'd like to say that we've
had over 500 people registered for this
webinar so as you can imagine we've had
a flurry of questions and real answer
them on a first-come first-served basis
so to start with the first one this
question comes from pure Trendkill tree
has froggy duration of the webinar
actually said that he thought the
question was answered but I thought for
the benefit of others it should be asked
so the question is as far as pure
understands each process should be
responsible for holding a state what
kind of state does turn holes Oh shastra
yeah that's a very very good question I
didn't address that as well
I should have given the other things i
said this state that the turn holds
depend on the state in the state machine
it's in yeah this is getting very meter
but it's a finite state machine go
through a number of different states I
showed you idle and await incorporation
choice that's the first thing that the
turn is responsible for but then in this
case it also keeps track of when is it
when has has asked a player to choose
which cooperation to incorporate it
holds state there in terms of I've asked
the player these are the cooperation he
can choose from and that's the state it
holds there but that's a very temporary
thing it only holds it in the awaiting
corporation choice state there so I
suggest is if you go and look at the
code you will see this and then you can
power means ask me an email about this
to elaborate on it but that that's the
kind of state that the ten homes thank
you for that old and now I do have to
say I feel obliged to say that many of
our audience you know without knowing
that you know what what what people are
suggesting have actually suggested
minions as a movie example that you who
are asked for so that's something you
can consider and that was a thank you
thank you it'sit's that's of course the
correct one yes its minions you gotta
love that thank you guys that's awesome
so so there was a suggestion on that
front as well but just moving on to the
next question and you know kill you
still pose questions we've got a flurry
of them but like I said we launched
fitment and all the other questions will
be answered by email so the next
question question comes from Dennis so
dennis is asking if two corporations are
of the same size then the player needs
to make a choice for which one gets
merged and also players should be
listening for stock choice on a merger
on the basis of the number of shares
descending so let me just let me just
repeat that the first part of the
question if two corporations are the
same size then the player needs to make
a choice
for which one gets much maybe you can
comment on this column yes I think then
it then it is absolutely right there it
might be that I have skated over this
when I implemented this but this of
course means in the case of the two
corporations being equal they replied
that needs to go back to the player is
he should choose between which
cooperation survives at which one get
merged into the other one so that that's
the first half and then the second half
Laden yes so the second half is going to
comment then is basically saying you
know players list for stock choice on a
larger it ordered by number yes
descending I'm not okay there might be
conflicting rules then because i'm
pretty sure that my rule book says that
you need to take the player that has
either the the the guy that did the
merger the word they had the most and
then it goes clockwise after that but in
that in either case in either case you'd
end up having you have a sort of the
list of the people to ask then you ask
the first player get it sorted with him
and then you can take the next player
it's a matter of how you create the
sorted list of players and then start
asking them there but it could be that
i've read the rules incorrectly and also
there are different versions of the game
out there might be subtle differences in
it there it's not like when you get a
german or game there's only one correct
interpretation of a German porking there
so ok but good yeah thank you for
that old and just to try and sort of
honor as many questions as we can we
have Brian asking what is the benefit of
using agent rather than just storing in
the process dictionary that if you store
in the process dictionary it's it's an
you're basically hiding it in the code
there and if you fail
it gets messy because when you're
failing it the standard OTP traces will
not show the state you're holding it not
show what's in the process dictionary
when a pro Cee'd fails but if you use
one of the behaviors and you fall over
the error message will show the state
you're holding so that's another huge
benefit hope that it's enough of an
answer I think that's fantastic thank
you talking and just moving on straight
to the to the next question we have
Simon asking something really
interesting so he's saying from the
presentation I gather that the whole
board is contained in one process I
imagine they're keeping every tile on
the board of the board in its own
process might be a good learning process
would this also be viable for real-world
count yes I actually think that because
in the normal approach to these designs
would be that you put everything into
one object 44 game state and then you do
something in this case I'm forcing
myself to go all in on the process
methodology and saying each entity that
has a little bit of meaning to it should
have its own process and often when I
approach also real life scenarios it's
actually a good starting point because
you get a clear separation of what needs
to happen and sometimes sometimes you
end up saying that process is not
necessary I'll gobble that into a small
state in another process but that's
something that comes after iterating I
and I think it's a good starting point
just throw some more processes at the
problem and see how it paints out there
so I can have recommend that thank you
for that oven I'll just take a second
and apologize we are having a flurry of
questions coming in and I can assure you
all the questions will be answered on
this webinar or after that in written
form so please keep asking them but to
try again and answer as many as we can
we'll move on to the next one yep yeni
is asking how do you enforce contracts
be
three microservices I think he may have
meant contacts no I think he meant a
contract sorry yeah I think he doesn't
mean that yeah that is slightly tricky
and but I think for me these things come
down and again I come from a telecom
background there for me it's in the
protocol because when you define a
protocol and you've been slightly or at
least somewhat rigorous about it the
interaction and how you progress and how
you move the state of ever parties
involved in the protocol and an exchange
of messages that is the contract there
so it all comes down for me to the
property to the protocol and defining
these things there and if you have
invariants on these different things it
needs to be expressed in terms of
message passing and saying if I go from
this to this I need to set this message
and then you have it air typically in
that case you haven't have state
machines running through a number of
state and coming to the end of something
which is the conclusion of a contract
thanks to open and what we have time for
no more than two three questions so to
try and ask as many as we can here's an
interesting one that sort of goes into a
practical demonstration of I guess
advanced line rick is asking could you
give us an example of an OTP task of an
OT key task yeah so I'm assuming the
Rick wants to hear about a real world
task here so so in this case it could be
that you have a computation say you want
to calculate a chick zone of some sort
on some data while you're doing some
other things there then you'd have a
task go off and do that and then when
you feel like this is the only thing I'm
waiting for you will ask a task if it's
done that's the kind of thing you put on
the side again comes
to being pure computation something I
want this computer and when it's done
then I'll deal with it they're there and
this is the task is a nice way of
actually creating this do something
without blocking everything thank you
for that now just to sort of try and put
this in a bit of a perspective and you
know put a frame around the talk and we
can probably finish with this and maybe
another question could you give us your
view on how you would sort of briefly
and quickly compare and capture the
essence of differences between our Lang
and elixir and yeah Alexia has a huge
focus on on convenience for the
programmer and by being a separate
language and not having to have backward
compatibility with a lot of different
things because that is a huge thing with
the airline and the OTP library you get
to innovate more and I think if you look
at the fact that you have task denser
ever an agent as free things to use from
shows that innovation is happening
because you don't have the legacy to
carry around you can innovate more
freely on using an experiment with
things some things and some of the
experiences they've been done in the
elixir world they will turn out to be a
very bad thing just as evolution might
turn out that they're having a big brain
is we have is a very bad thing we are
still in the early ages both as humans
and also when it comes to a lixia so i
think it's it's that freedom to do more
things they are the focus on on making
easier for the programmer this is where
it makes your shines there and as I've
said numerous times maybe not today but
you have to think like a beamster if you
are on the beam and that means any leaks
you need to apply the same sort of
design the methodology and thinking as
you do if you're coding or lack there so
it's not that much of a difference but
that's something on the tooling and the
East for the developer Thank You Tobin
we're already passed on schedule time
for the webinar so we'll finish with the
following question we've had a lot of
queer
in along the lines of you know I'm not
doing Lexi now very keen to sort of look
at both aligned and licks here how do I
start you know what's the best way to
start you know how long will I need to
sort of become productive from a very
different background in something like
Alexei wrote a line 00 the time there
and if you dedicate yourself to it and i
would say that one to two months you'd
be at your own old productivity and from
then on you will just become more and
more productive as you learn more and
more about how to utilize the beam
correctly where I actually did
measurements of this this was for her
line when I work for motorola solutions
and and our measurements showed that we
were we were back on track with our
performance in terms of creating
functionality in a month and then after
two years of doing this we were
producing four times as much
functionality not lines of code but
actually function points which is a more
neutral measurement of productivity and
I think it's the same thing one to two
months to get back to to know your
previous productivity and then you will
improve after that until say thank you
to oven once again a big apology to all
the people asking questions and you know
for which we simply did not have time
but I'm sure everyone will join me in
thanking talking for a very inspiring
talk</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>