<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lightning Talks - Martin Schürrer (ElixirConfEU 2016) | Coder Coacher - Coaching Coders</title><meta content="Lightning Talks - Martin Schürrer (ElixirConfEU 2016) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Lightning Talks - Martin Schürrer (ElixirConfEU 2016)</b></h2><h5 class="post__date">2016-05-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Kh6m4EQBb0k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everyone i'm martin from p SPF kit
and chances are that on every single
phone in this room that at least one app
that's using a framework to view and
edit PDF files and today i want to show
a fan Alexei library that we open
sourced last year for testing HTTP API s
so let's write a twitter client i start
out creating a new project I depend on
it should be poison and poison for the
HTTP client and the chasing encoding
decoding and then i create my simple
module I add the module attribute with
the endpoint for the twitter api and
it's like a really weird api a trust
created to chase an object by base64
encode the password put in the username
and the message and post it I want to
handle the case that everything is fine
hit wonder okay Adam and because Twitter
is often overloaded I need to deal with
being rate limited so I want to return
our wait a minute there now how do i
test that what do i do if you come from
the hooby world you would probably just
mock the hdb poison module replace it
with something and basically decide what
to return but Alexia runs tests
concurrently this will not end well if
I'm replacing modules while other tests
depend on them so maybe we can do
something else and Alexia is also really
good at internet services maybe we could
just start another HTTP server that we
actually mock the whole intro and
request response thing and the motel I
would do that it's really small it's
chose evil I'm approved so let's
integrate that I added to my
dependencies only in the test
environment and because I've on a switch
out by my client is connecting to I add
the default endpoint to the default
environment of my application that I'm
gonna ship and then I'm changing this
module instead of hard-coding the URL
I'm making it a function that fetches it
from the application configuration and
everything else stays the same and
here's the test code that i'm going to
write
the setup block I used by plastered open
which make a which makes 5 has assign
itself random open port and listen on it
then I configure my Twitter client to
connect to that in the test i use bypass
expect to set to use a function which
will be called then something connects
to this HTTP server then I trust call my
Twitter client which will now connect to
a bypass which we call this function
which in this example is really simple
it just is like yep 200 okay and in the
example further down it's just like HTTP
429 rate limited can't do that really
simple and you can do more advanced
things like I actually want to check
that the password is base 64 encoded
because it's very important so I trust
Vita body Dakota Jason and assert this I
can use like a sort and assert received
in all this in there and it's on github
check it out I hope it's useful thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>