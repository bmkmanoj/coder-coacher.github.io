<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AdTech by AOL debugs a production issue with Erlang | Coder Coacher - Coaching Coders</title><meta content="AdTech by AOL debugs a production issue with Erlang - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AdTech by AOL debugs a production issue with Erlang</b></h2><h5 class="post__date">2015-10-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8j5dtcsCtGc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in production we have a lot of timers
which we monitor just recently we notice
a spike appearing in one of these timers
you can see from this graph the spike
appeared approximately every 20 to 30
minutes and the magnitude of the spike
was about 5 times the normal timer value
we were really unsure of what could
cause the spike was not obvious to us
looking at the code and it didn't really
seem to have any relationship to high
load on the system either but if you
consider if this was not an erlang
system why would you find out what
caused this delay for one auction in
about 1 million auctions we probably
have to rewrite the code so at every
event will get time-stamped and store
that in an in-memory database and then
have some kind of alerting system which
can alert us when the timer threshold
was exceeded but we using the airline
clear system we didn't have to deploy
anything new to production we just
traced every new process spawn this flow
diagram shows all the steps that we took
there for every new process spawned in
the system we check to see what we call
a particular function unaffected we
recognize that that was going to be an
auction process when the auction process
was identified we activated tracing with
timestamps we recorded when the messages
were received by the process at what
times the process got scheduled in a
locked by the airline scheduler recorded
the linked processes at the function
which was logging the timer value when
the timer value was seem to be over a
certain threshold we dumped all this
information into a file after a couple
of hours we had all the information
logged in the file and we're able to
find the root cause of the issue and fix
it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>