<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Erlang/OTP at EE: journey and lessons learned - Chandru Mullaparthi | Coder Coacher - Coaching Coders</title><meta content="Erlang/OTP at EE: journey and lessons learned - Chandru Mullaparthi - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Erlang/OTP at EE: journey and lessons learned - Chandru Mullaparthi</b></h2><h5 class="post__date">2013-07-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2qIj5wSeSuk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">there's five collectible yes yeah cuz of
windows-based me to version of Nauticus
right and okay so hello everyone and
thanks for coming tomorrow I shall go I
work free that is formally in 2010 as a
50-50 joint venture the name what was
nineteen wild and orange two separate
companies so it all also operates the EE
t-mobile and orange brown so it's it's
one network which is operated by Ed and
his three brands riding over it and they
are still here the first and still only
Fuji operate in the country so eat your
hot water coming out to pick out the
first but my teams are over 90 10 people
including me too but one guy who's a
device hacker four of them were really
tell from the experts who look better
than one for joining the day no trail I
got program has a number for full time I
like the girls and that is basically a
map of our network I came out names out
because of a security fill me so long
the green dots are basically a line
notes he has generated the spigot is in
graft place but it and the blue ones are
core network systems so if you see here
the entire the handset as the internet
as it pictures it too big you can't see
it clearly but as you can see we were a
few number of system builder OBS so on
so just 2 i'm going to talk about a few
of the systems we have what we've done
so far the few lessons learned a long
way building some high volume systems I
guess the interesting thing will be
asked me questions probably not
tell you what we've been through so do
you an example working on the Triple A
for mobile data it's a system to make
every time you turn on data on the
handset or your smartphone if you've got
as soon as it turns on it attaches to
the network and get it has to get ideas
first thing I'm so this system hands all
of that the protocol used is radius
between the back gateway and it proxies
these messages to a bunch of downstream
systems so the mole identity of
subscribers it's been little about 20
other angles or working together looks
roughly like that so we've got so the
deviation is really back giving the man
network so you got this sorry this
asthma you know the radius modes which
could actually handle anything I suggest
they look up subscribe related issues
and also it's in an ally using amnesia
the session it is is maintained I get
this pool so as a bunch of fools and
then they pass it on to proxy nodes
which which act as a packet amplifier so
then you got about 6,000 packets per
second coming in and outgoings about
twenty twenty four five dozen back to
second what's the surface subscribe
detected by sending as I'd at last have
about 80 million records in it actually
yep ready we've done it for that 200
million so be quite hopeful will become
and so that that's that's the real time
subscription database as talking about
which raised in Indonesia and use of a
later learn modes not a lot and then
it's handles roughly about 6,000 becomes
a second I think CPUs mumble boxes by
five six percent at peak enough that
that's the architecture you've got four
nodes fully replicated i'm yuneisia so
this will split across two sides each so
pair of known stores the end our
subscriber database and we just use
standard fragmented databases so if the
replication is using all native RPC
replication but for all queries will be
there with our own RPC mechanism because
native our pcs too heavy weight and not
very reliable heavy load so and then
there's a set of interfaces we call it
to which all the clients talk this way
it gives a lot of flexibility in taking
notes down for maintenance if we have to
and these broken and and then these
basically have the ingredients 2 so 4
moles of connections will fail overs and
all that with an appliance noticing
anything very wrong and back twice in
that sense or other requests
system yes yep so yeah the old armor
green dogs i showed you want but not
it's it's lotion yeah um really the
biggest of the most complicated system
we have written using Everlong is what
we go the PDF the policy decision
function as you can imagine we've got
prints a million subscribers and we'll
all of them are well the phones are very
busy data users if you like so you know
violence in your pocket your phone's
busy transmitting or receiving data it's
ringing a lot of stuff and and our radio
interface is a finite amount of the
resource we have to sort of share it
among all the users equitably obviously
the boeing pay the better service you
get so really what this PDF is doing is
controlling your new your experience
while you're while you attach the
network so its handling all the
signaling from the core network bad when
you're trying to do their time
monitoring how much you using if you've
got a fair use policy on your contract
before this is that so that when you hit
it you don't get that high speed did any
more uses for lamp so browsing and email
and you don't get any of the fast
stringing of video we reduce redirect
events relate but faster its mph i would
also and again you know like i said in
20 20 20 10 will be merged or indian
t-mobile so since then big lie I come
from next t-mobile side slowly the stuff
they put in has been spreading across
the to the origin subscriber places
where
virus slowly but surely taking your
stuff so so there's a lot of disparity
we have a handle in terms of rich
subscribers we are selling and what use
experiencing any it's currently matter
of 16 airlines but this is changing
constantly so I Highland me with that
spring water days so it's again DJ's
saloon like I said it's the packet
gateway with a bunch of notes
terminating diameter which is again a
protocol rhythm telecoms with you guys
are fan here too long he'll know that
meter but otherwise it's basically a
binary protocol fairies very simple
ready to understand and 0 to be has got
a built-in stack for that and those
talks what we so they do the vertical
decoding talk to internal code modes
which do all the heavy lifting of the
business logic fading out what's
happening based again a PDF database
which is again a major but it is
suffering from that we come to that
later GX g x 6 lloyd ng1 and so GX and
gy are two different 3gpp 03 TPP is the
body which time is turquoise protocols
DX and dy a different protocol GX is
what we call the control plane so it
tells g just more Felicity of y gy is
the charging interface so the charging
your folks come out here and GX light is
specially at elaboration of GX
and you've also got a bunch of mediators
online charging resin using hairline the
most they act motion here the protocol
converter they take one bird golden so
we gonna because our IT systems are
traditionally big slow people they're
all little Java or C++ or something like
that so they typically their release
cycles are 26 months ducati and if you
can put in a request to being in the air
hopefully by the movie here it being
everything so so what we tend to do is
to put a layer of our loans between our
core network systems alrighty systems
and we can change at will and a lot of
networks to move ahead as it may be we
want without affecting and so usually
when we first did this it isn't 2008
there was no diamond to stifle OTP so we
bought one from a guy called Thomas
Magnum some of you may know him from
this interaction the mailing list but we
are slowly marketing to the already be
done in giraffe because it's it's
actually lower the one in order to be is
much much nicer it and it works very
well I'm another system called a
third-party advantage it handles all the
bulk SMS traffic from the bodies so
almost family didn't hear homes those
two are like if that makes me think that
and it handles of upwards of 100 million
messages a month but again that's that's
not a huge figure really an income by
the billions of SMS which go to a bird
again very small games of giving they
pushing it hard enough
this is an interesting one roaming for
control so basically every time any of
our subscribers goes wrong and they try
to make voice call there's an alert
system making decisions about do i
connect the call do I other them to some
announcement or do i drop them and we
have pretty much one of them if not only
one one of the very few networks in the
world which has this capability thanks
to our life because most others roaming
fraud is a big thing in the big loss for
mobile operators and not many of us have
anything to deal with this problem we
can do this purely because gives us the
capabilities to so what we do is every
time a call is being initiated we think
we begin a trigger from a network
telling us who's calling who and in
which country they are using those three
we can make additional so if you're in
Pakistan and trying to call the premium
great number in Nigeria we reckon that's
probably a phone call and not legitimate
100 top it so so yeah I mean in our view
Allah is pretty awesome why because it
really lets us to wrap the development
and go to market really quicker and peep
people can make a business case for it
or you know produce the correct it's
actually faster sometimes then if they
ask us for cells and say okay what sort
of reply message we want to send the
customer in certain cases by the time it
goes to ground and legal it takes two
weeks and we've got service ready
deployed safe okay many wanna go give us
messages it's easier than our language
is to get things right now it's not easy
and i thought i should probably qualify
that because well the simple things are
really quick right if you're ready
looking at something high-volume ready
mission critical
takes a bit of time and effort you can
there is no real shortcut board I think
generally in my experience you can do
the same job much faster and outline
obviously you can do pretty much
anything in any language and the likes
of actually Google now probably
testimony to that for that for the same
amount of input you can get your out
faster of same quality and it's free is
great it's the unlock moment you're a
bit then we paying for it and it's it's
brilliant for implementing verticals I
mean we can turn around support for new
protocols in days literally there is a
binary singh tax on you know support for
I mean recently experienced support for
sctp or TCP which is which is awesome
it's a yes it's a gift and it comes to
the built-in database which for most
medium wage applications having this
manager is pretty good you really you
know you start going over a heavyweight
their debate stuff amisha is not really
suitable for it and and the PDF for
instance i talked about be looking to
move away from amnesia because it they
starting to suffer from its limitations
and again there is a large pool of
actively on the bus spi mailing list you
can it again it's it's not as easy to
find out along the paralysis in other
language but still a link and it's not
that bad you can't wait it's no hostile
here you here is much better than that
yet so just illustrates how quickly we
can do stuff without learning so you've
yourself home from this fraud God's
inbox god I basically what that is is
because international calling no mames
is pretty expensive oh oh say
international calling is expensive so so
what people you still get these devices
called sim box like so if somebody wants
to
from India to the UK for instance now
that's quite expensive if you live the
water fully over the proper gsm network
Vincent what did it is the Sun routing
calls voice over IP to the device look
at it in the UK and that would break out
through the sim box so to us it would
look like a local call a mobile calling
a local local number and people are
especially amusing price plans where it
was being sold with bundles saying 500
minutes for a tenner a month now so that
was being abused the lord so so we had a
problem and ready within about two weeks
we have a fully working solution which
what what that was basically doing was
every five minutes taking a CD our feet
are creating systems and looking for
calling patterns now if your typical
mobile user you probably won't call more
than 10 different alright said 50
different numbers in a month whereas
these sim box there because they put
call up the call of to come which have
no relation to each other you can
literally by analyzing about an hour's
worth of CDR data tell whether this is
actual mobile user or is it someone
trying to do this fraud so within within
an hour of these devices being putting
us in box we used to get enough data to
say okay you're a fraudulent user and
immediately we didn't actually
disconnect the device we because that
would be acting contrary to the legal
stuff in the contract what we did was we
remove the data model on that account
saying well you exceeded your values so
you can't have it anymore I mean
literally around within two weeks after
that fraud or missing muhlenberg
literally just went down to home 0 and
then moved on without three networks
success yes in this okay double whammy
we save money I come with this movement
so a bit of our lessons that I did they
aren't any great inside the sub some of
these is what we learned the hard way by
actually having out it isn't a network
in this is a fine one proclip spawn you
guys probably know this spawn near
process it can be quite harmful if
you're operating on the lower because if
you have a bar the manifest under under
load what road trips for NASA's and a
process crashes they produce a nice for
my clever report in your saucer looks
now you have x 5000 of these a second
crashing out and all of it quickly goes
into bills of a huge mess with you
handle em unknown is pretty useless
after that yeah like sadly we found in
the hard way but there was an artist by
the name of the hell is happening and
you look at the process mystic and raise
that all the with about three million
messages its cue so we quickly had fixed
under the Soviets post fairly simple
just user once phone at least your
processor and can crash the close the
bar but they won't affect everything
else and this again we are the nephew
guys saw the news we hadn't we had a
couple of hours love control our 4G
network on monday during busy period
which is a bit of a bummer but it's
still the first of the marketing and it
still works yeah that's how I justify
her job to the books in here and so but
at high volumes for what we observe
those we were able to receive data and
socket but actually gently p.m. CC peace
and was blocking now again there were
thousands of processes being spawned
every second of my expectation is that
they lose something and will die after a
few minutes at
or maybe a second and I live a lot
because Jen didn't send was blocking for
some reason it couldn't send it out and
pretty quickly we had by 200,000 cross
in the north and counting and slowly
grinding go home and when that happened
at me here try mmm nature decided it
wasn't gonna play ball as well and so by
the time yeah it took us a couple of
hours to isolate the traffic away from
the system and record it yeah so re you
gotta be careful really that if you
didn't gently CP send and you're
expecting that to finish quickly and you
better be careful there hi belief system
give you the cool breeze avoid we know
we had networking issues so this was
between two shared Indonesia databases
and it was on that link we had some you
know we had it was actually a fire break
somebody's Langton back it up is
everything but again our network stunned
into signaling that is built to cope
with that source of traffic at sri rupa
and stop bragging they came back and
said it too or 39 seconds for it to fail
over tomorrow route yeah yeah but that
was enough time to screw the system
operating i could just imagine
it's you yes i mean i aven't go to the
bottom of why this was locking but i
knew for a fact that this was what was
causing the problem process to lord I
because it was pretty much stuck at yeah
I'm not all over ideas the response and
stuck there that was nuts literally the
last statement in the the worker
functional design but some response i
wasn't dying and that wasn't happening
that caused the process there's that fun
there was another reason ratings we
found we were using there was a library
i wrote which is yeah it's a bit
embarrassing but full of myself of
posterity and so I'm nature has this
little fragment well you know fragmented
tables a fragmented tables doesn't have
ordered sets analytics but we really
needed ordered set semantics on large
tables so I said I know both are great
and Emma Jax would he call back which
every time somebody does an index read
first illus goats can all the tables
figure out which one is actually because
each fragment we made it up so that it
was an oven set so I said all I need to
do is compare across all 60 now I'll
pick the first one and out of that now
this is a high volume 8 just blow up in
I should've seen that because when
you're doing in extra dollar table it
takes a whole table look and that means
and and if and because we had this 39
seconds of our kids between
we have products and supplying up and
didn't recover up to that and he bases
passing out thing is dangerous it's it's
actually very powerful atom to do when
you're first building I manifest and
gaara migrating message possible really
what made me fall in love with it
because it it's just a very intuitive
way of writing gold you want one entity
cocktail olives and a message hey yeah
how much more yeah what more can you ask
for but it's very very easy to all over
the system as well it's incredibly easy
and if you're not careful and you
haven't thought through how all the
messages are going to flow through the
system and exhibit more importantly you
can kill urself very quickly this way
needs a lot of load testing to find the
flash points you need overload control
and I suppose we need some solid in da
I'll ask there's a couple of times in
the mailing list and most of them
various modes I came back I got
backwards polish you decide you're
probably right have you have very good
terms for see message rates are no
really no sir that's I think that's a
lot of it that the tooling room support
for their blind system i think is
actually go stand somewhere existed in
others yeah yeah i mean there are some
like this I suppose on github and even
gone in forever nothing is really stood
out to us as something which would
really work and an important thing for
such schools in regulation work on the
load when your system is going wrong
that's when you want it one and I think
if it works in a voice system is it's
not really useful and no I haven't and
that I think it's a good opportunity for
cell phone someone who wants to write
something and sell it all right
this very simple basic but hey you know
something is I personally would be
interesting our stuff like barn with
message tears it would be nice to be
able to say it's this process message
krx in two thousand messages killer son
is it that if you use no regulation when
we must right here sister yeah yeah
that's true and so that's the bigger dad
needs careful design within this yeah
you should do that again let's again
this is an issue we showed up before you
go back to the old days yeah this was a
very yeah it with multi-core alert stuff
happening all at the same time it's true
conquering 60 or I mean just what I was
writing lease like if I thought hey why
not have my city is over there as a net
stable I mean I has an option in the
spawner process stay actually know what
I want the message queue business
processes next table that back and if
it's building that I can actually go and
do queries on it to see what kind of
messes are building up any inspected
properly I in the worst its case to it
select delete and just wipe the blood
again open saying and you know quick way
to record without bringing the whole
system down but I don't know as was its
lot of like a lollipop it on the mailing
list and seasonal bites and amnesia a
limitation everything ambitious great i
mean obviously is CR so travel databases
in amnesia you know we pushed it to
about 80 million records i'm sure it
will take more you know just add more
fragments it will work but again our
subscriber database is a you know this
half million rights owner today but it's
probably half billion reason it so it's
perfect for that
I'll keep using it for subscribers but
to something like that vamsi engine
there's a lots of Rights going on
they're all the reads and writes are
actually very evenly matched and amnesia
is really not business for that it yeah
eat you I each biggest weakness is if
you put it in a scene in the Lord and
just throw stuff at me little work
you've distributed and throw stuff at it
a lot of rights especially it can break
pretty quickly and it's hard to recover
punishing networks are paying to begin
with because you mean restart I haven't
tried a big as net split stuff but I'm
not sure how my little work in a heavy
load situation so in one of the things
we considering is moving to react to
something like that I am but again you
know small team so current challenges we
face book BB you know i'll be over this
big black comprehensive or to make a
desk coverage a lot of it we've being
pretty opportunistic about it say oh
this is a new problem the business has
let's quickly sold some of it we have a
test plan which is which gives us an
advantage so we have that one tree say
actually can you text it for added it
works for all the positive cases and
maybe a few negative ones if someone is
to do that till now but it's reaching a
point where they are not able to move
forward that i'm actually building is up
so actually we've got like some loaf and
couple of these guys in south africa
buildings up for us at the moment just
pretty good i think in a few months time
will be
better situation with respect to our and
it slows down are there with no cycles
as well as especially if it's a complex
system some of the more the simpler ones
you do it 12 25 you know and nobody
touches it for years that's fine but a
system which is undergoing heavy change
constantly this is the portal back
scalable database organized it's
probably react we haven't tried it yet
by obviously keeping an eye on what's
happening within the industry in the
community so we think reacts probably
the way to go they migrating all our
code ways to get from subway that's
trying of its own challenges leave some
we like most things like subversion
except the merge support yeah all the
lack of it but moving to get to the
actually thrown a different kind of
problem in that with subversion we get
nice we can invade the subversion
revision number and subversion we were
linked to the morning when it's checked
in so when you compile it and load it in
a live system all you have to do is
modeling for you know exactly where that
files come from which part of the so
screen which branch number but with get
all you get is a comments hashing side
and you have no idea where the thing is
come from only you can find out using
the come attached but that's nearly
known as intuitive as having sufficient
ribbing number which we can quickly
science um tags right how is that good
suits me okay right yeah yeah it sounds
like a good idea and documentation I'm
just going to know about it I mean there
isn't any documentation
that works to a certain extent and
beyond a certain point especially when
we're trying to bring our contractors
when business new work and quickly want
them or to get them for active it's a
hassle because they keep asking all
these questions then you can tell them
rtfm else you spend time with them so
it's a bit of a problem everyone knows
it isn't empty looking comments yeah you
read the cover to see we breathe out
it's good yeah exactly i mean and what
I'm trying to do you're right ready I I
don't think I'll still put coming to my
gourd really i think a lot of the
mailing lists ain't coming to a waste of
space but it has a really great so far
but we'll see neither this complaint is
i reject their covenant community action
okay well as long as they're meaningful
demands and not we have some hannity
cast handles in the cast messages where
i was very good sir I know me go for the
ABC game projects the syntax is only had
a two lines description yeah um if I'm
doing heard of you I will accept
anything that has the description in the
gig man in place of a difficult in the
code yeah because in practice you watch
your speaker get poetry with the cut yes
yeah like that yeah I'm going to
ready you ready Johnson yeah me the
reason so my memory using about this way
since abortion then the problem with
putting tomlinson accord is their own or
they go after eight and I come across it
I have to lodge to fix it the owners own
you know but the problem you fix it and
you committed the virtual number changes
now if if some rays will the texture or
someone in operations is all that
particular model is you know then it
seems to be out of sync with more today
you should be and we give them this
updated wanna go that's what is in test
you know the test virtual number is
different because you change the comment
in the code and then it comes down to
this argument that I'm trying to explain
when look come come look at our diffs if
you want Ramirez look up James sister
but it won't accept it said we have the
points and yeah okay no unless it's
really useful comments from both putting
it in the code because it just causes
more hassle knowledge and so that's
really um any how do you have field any
questions you have but that so we've
grown from what was one full-time guy
doing online in twenty two thousand to
about 10 people doing a full time
including orbit on vectors we have a big
meeting if you don't have like a twin
still seem to school thing
this yes it is yeah yeah ladies I think
you're so successful with the other
sorry still watching movies job under
the next time don't do I'm java really
they just do the other telephones guys
there go and do I am so the bear I said
I in experts these guys are developing
services on ice the game okay I made a
big mess with you Archie organization
why don't ya got a big apps which are
doing to high school and I think I can't
change because no no no but if it comes
out of political battle ready and how
much you willing to fight it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>