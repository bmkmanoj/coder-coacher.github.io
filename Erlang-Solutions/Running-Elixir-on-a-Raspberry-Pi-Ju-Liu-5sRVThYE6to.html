<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Running Elixir on a Raspberry Pi - Ju Liu | Coder Coacher - Coaching Coders</title><meta content="Running Elixir on a Raspberry Pi - Ju Liu - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Running Elixir on a Raspberry Pi - Ju Liu</b></h2><h5 class="post__date">2016-10-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5sRVThYE6to" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is gieux you can find me online
as our camp with a four I'm Italian
is that so I don't think you believe it
it's oh it's okay I've been living here
in London for the past three years in my
free time I love to climb I think you
don't believe any of that so as a proof
there's a picture of me climbing of
course you can tell it's me because
there's a label so I'm here today for
two reasons
and the first reason is that I don't
really know Alex here nor erlang very
well and the second reason is that I
didn't know embedded systems at all and
I'm sure at this point the organizers
are starting to regret the decision of
accepting this talk but I'm on the stage
already so what are you gonna do and I'm
just a web developer I was born a ruby
developer and it's sort of like when
you're in the Marines you're like Semper
Fi like you're always a ruby developer
lately I've been doing a lot of
JavaScript so front and MVC and this
sort of things so I know now you're
asking like oh why is this dude like
here on a stage and the reason is that I
mostly enjoy programming and by
programming I mean a sort of physical
and mental activity
and after all these years working as a
developer as a web developer I felt the
need to do something in the real world
so I felt like I don't know if this
belief I got to disbelief after all
these years working in JavaScript but I
felt that as engineers we like to get
lost into a lot of layers of abstraction
and I thought it was just me at some
point and then I figure out like some
tweets on the internet and there was
like this dude who can't really like use
grunt and I think it's famous in some
sort of way anyway there's this writer
which I really liked which is jorge luis
borges and he wrote this quote about a
labyrinth of librarians and celebrities
which they can encompass the past in the
future in some way even the stars and
really reminded me of the npm
architecture I'm not kidding like only
recent versions of NPM made sure that if
you had the same version of a dependency
they would not get like install like in
multiple copies even I mean yeah that's
really mind-boggling but anyway I wanted
to do something simple something as
simple as switching on a light bulb
and by the way how many engineers do you
think it takes to change light bulb so I
have three for you today
the first one is inter impossible
because they're all trying to design the
perfect light bulb the second one is one
precisely the only one who bothered to
read the light bulbs fine manual and
three I'll drink a little bit you can
read
okay so why elixir and well I'm an
elixir conference I don't think I need
to explain all of you I like I think
elixir is awesome so I just want and the
second question would be why Raspberry
Pi as we've seen we can use so many
different devices nowadays and they're
all like quite cheap and the reason why
I use the Raspberry Pi is because I want
to like something to play with and I
felt like I could just like get the most
value for my money so I just compare the
different options out there and I pull
out the specs for an hour you know zero
and in respect I three and I think like
the difference is pretty massive so on
one hand side we have something which is
like brother like single purpose and the
other hand side we have a real computer
and it's real it's not a joke okay and
the Raspberry Pi
it's here have you run in and
unfortunately I couldn't figure out a
way of like streaming something like
using my phone as a camera or something
like that
apparently the technology isn't there
yet so you just have to trust me that
it's working it's connected I'll show
you something afterwards also something
which will find really interesting
afterwards is that the Raspberry Pi has
these 40 pins and these four pins can
like give her work and connect to ground
can be used to either as outputs or
inputs so that you can program your
Raspberry so what next I bought myself a
board and then I did the thing that most
reasonable people in the audience would
do so I just like starting and going on
Amazon that coat UK and started buying
all the sensors I could find anyway so
if you see I'm not like in any way
affiliated with some founder but I
really think their package is awesome
because the thing on the bottom when you
open it up you have these sort of things
no-one's talking this amazing so yeah
this like pretty some cool really really
cool sensors right so I thought are you
still busy reading
okay I put I put up the slides
afterwards and you can read like all
these things so what could I build and I
think I have a reputation for building
always like the silliest things a couple
of years ago I was playing with Sonic PI
which is a ruby program which you can
use to write music and I used it to
build nokia ringtone converter and
player and some sort of stuff
so I thought well like what was what is
the silliest thing I could ever build
using this all these sensors and I
remember there was a movie from 1996
with Tom Cruise in it yes yes Mission
Possible also wait for a punchline if
you haven't seen the movie
it's about Tom Cruise trying to break in
into the CIA and there's this
high-security vault and they have lasers
they have temperature sensors they have
vibration sensors they have noise
sensors so whenever the room is locked
he had to go like to overcome all these
obstacles and you can't really see it in
this picture but on the top right
there's actually the name of the
security system so I use some CSI magic
there and is actually called intrusion
countermeasures which I thought was a
bit weird as a choice especially given
that this display should is only useful
when the room is locked and supposedly
there's no one in the room when the room
is locked but anyway I mean designers
right
so I could rename this talk to building
mission impossible intrusion
countermeasures in elixir and a
Raspberry Pi but it didn't think this
was like exciting enough or was sort of
like giving away like all the punchline
so it just like called it like running
elixir in a Raspberry Pi and we have
these features right and I don't think
there's anything in this list which
isn't awesome
and there's like laser beams noise
detection vibration awareness a
temperature sensor so let's do it okay
I'm just gonna open my terminal here
there's something which I have here
connected this is called USB TTL cable
it's one hand is yes B and exposes the
raspberry as serial interface so when I
connect it to my computer I'll be able
to do something like screen use see you
USB serial one one five two hundred and
I'm logged into the raspberry now and
it's up i've only did maybe I can show
you I took a picture so that you guys
could understand a little bit better
so here the Raspberry Pi here's like the
pins you can see here there's just like
one of this old cable he is to connect
hard hard drives and it Just's a way to
easily be able to tell which is the pin
I'm connecting to so they don't make a
mistake on stage and a fry-up the board
what you see here is a small analog to
digital converter so Tatiana was talking
before that like most sensors are analog
so since I want to use this information
as like a programming device I just have
this little chip which does the
conversion between analog and digital
and also it connects like to the P I
using this to this special bus which is
called I to see bus and actually I
shouldn't have put like these two
sensors like down there because they're
not here in the world right now I just
ran a small Hardware check before the
talk so cool let's try to login
Wow let's unexpect it let's try again
mmm I probably have to reset my terminal
no let's try again reset oh no I think I
did something wrong maybe or maybe now
let me try doing this
Oh No it's back P I I was about to kill
it to be honest that's how much patience
I have with these things so here
basically which you can i've been sold
an elixir so I can just like one IEX
it's actually running on the device
which i think is quite impressive but
makes sense considering what they showed
about like the capabilities of it it's
like a real computer is not a toy right
and if I get out of this like I have
like real like like this is rusty I'm
running on an SD card and it's like it
has even like a graphical interface
which I'm not using right now but you
could so basically what you would do now
is just like to run like mix new you and
your project and everything would work
I'm just like brown like test test so
you'll work and basically you go inside
of it and what you would do is to change
the mix file and you add this library
which is called elixir ale which is just
an elixir wrapper around an earl and
library which is called Erlang ale and
you just do something like this and then
you do run like mixtape scat since I
couldn't really connect it to the
internet I had to use a backup which I
luckily made which is called back and
inside this there's just like the same
thing I've showed you before so there's
like elixir ale and actually if I show
you
there's like a little bit of ivko design
countermeasures and there's a deaf
modules countermeasures so now I'll just
open it up countermeasures I'll say use
the occasion deaf start you can ignore
this do and maybe can I ask if someone
in the audience wants to assist me in
this no yes
someone teeth yes basically basically
just prove that I'm not like hoax
that the actual ate stuff is happening
here I just want you as a human mirror
basically so I have here have a laser
emitter on the back of the laser
emitters there's some blue tack I use
this just like to connect like to make
sure that the laser doesn't move on the
board back cool and now there's like two
cables here one is a tension so I can
just connect it to the tension and one
is the signal so I'll connect it to a
certain pin which is GPIO 17 pin okay
and here I've used this GPIO which is
part of the elixir al library and you
can just like start a link to a certain
pin number 17 tell it the mode you want
the pin to connect to which is output
and in this way you'll be able to do
stuff like this so right laser
zero then maybe we can sleep for 500
milliseconds and we can turn it off so
now if I run IX - mix you'll be able to
see that like the laser turns on now
it's currently defined
model control measures no what does this
mean it's gonna help let's let's
crowdsource this oh no ok I have to
remove flip back up because yeah exactly
cool no it's works I hope yes it's
pressed again oh no cool it said cannot
start application countermeasures return
the bad value ok this is because if we
want to use application we have to
return a certain value from the start
function and this value is usually
something like this so now if I run this
again the process won't crash any more
will seal on off again so um I thought
it was pretty cool and the first time
you do this you feel like dr.
Frankenstein you're like yes it's life
and I thought that was pretty cool but
what if I had a photo resistor which
could like measure the amount of light
which shines like through this little
surface and there's also some blue tack
on the back of this so if I carefully
align the beans thank you ok and then I
need to connect this to the digital to
the digital to to the analog to digital
converter ok cool so I just killed the
app now the countermeasures so here I'll
just like keep the thing on so I don't
really need to turn it off now and right
what I'll do now is do something really
similar but since the sensors are not
using the GPIO pins I want to use GPIO I
use I to see which is this but I was
talking
out and just need to do something I to
see - one and then you need to pass in
address here which I know is 48 but I'm
not a magician
there's a simple like tool which is
called I see detect so if you just do
something like this I will show you okay
there is something connected on the pin
48 and now what I have the sensors maybe
I'll do something right I'll spawn a
function and inside this function I'll
pass this little object which will have
sensors and sensors and cool and now I
have to define the look sensors sensors
state do and okay so now basically in
this loop I first of all I want to make
this wait for a little bit like before
doing anything so I just add a quick
slip and then I'll loop again on the
state so that we always know that the
app is doing this as I said I don't
really know anything about the leak sir
nor erlang so this might be all wrong
but it turns out like turns on the LED
so I'm happy and and also I've cheated a
little bit because this this chip is a
little bit weird so I had to get some of
these like basically the hardware
specification of this and I want to
paste them you're amazing thank you and
there's this little function illogical
ring sensor you just need to pin like
past the pin with sensor and then you
can do sensors and then I know this is
on the first channel because it says a
yen zero right and now I can say this is
a value and what we can do now is just
to print this value right so and now we
run this again are the beans wines
so it says 212 117 212 160 it works okay
cool so let's try to make this like more
human-friendly right and here when we
know that the value is less than 180 do
okay
are you put has laser triggered and then
we say something like the value just for
fun and after that we can just like and
right and we don't need to do this
anymore
cool
actually I need to do something else so
because like now like the the app boots
but we don't really know this sorry I
didn't tell anything to the user but now
if I put my finger in it these are
triggered these are triggered and so on
so the other change you want to do is
just you know source code after will
spawn this I just print out intrusion
countermeasures on this will be more
important later but anyway okay so I
guess like like I'm sure like how this
works so now I'll just add two more
sensors and one is a temperature sensor
and this is a noise sensor so I'm just
gonna happily like do my own like cable
plug in for a second so you kiss
anything to say
he's great don't ever try to get into
his house okay okay
actually when I started doing this
little project my desk just you know I
said Franklin's time because it's just
like basically little pieces of like
hardware lying around and all sort of
things so this is a temperature sensor
let's use the noise sensor also just
like in the unfortunate event that
ëifí the board I have a spare board so
should be good
cool so did I connect the right ones
brain brain okay cool so let me just go
back to the code and I'll do something
that we like a lot well just like copy
paste so here I just like is at loop
state so that we shortcut the event and
here I'll do something like this and
here 1 0 I read from the first value I
know that this is something like 110 I
think and here is something like this
and you won't be laser any more this
will be the temperature sensor
temperature and laser and this will be
noise triggered okay oh thank you I need
to change this tattoo right yeah cool
it's much easier to program this way
sorry temperature triggered oh no
there's something wrong okay I just need
to invert that so if it's slower than
that dragon so I thought I don't know
let me try it like all this to be like
this okay
so now I shouldn't complain anymore
should say countermeasures intrusion
countermeasures on and we have the
temperature sensor here if I start
holding the sensor well very good come
on
well the noise works at least that's
good I think the temperature maybe the
thresholds a little bit too high so
maybe we can just do temperature maybe
130 if this doesn't work I'll just like
try one more time oh now it's too low
temperature sensors oh yeah I do the
opposite
okay thanks I knew there was like an
opposite somewhere so what do you think
I should do I'll do it like a greater
than hundred twenty yeah okay 130 so if
this doesn't work it's all you offer
okay let's try again
no temperatures always up no I mean the
VIN I could do that I could try to do
that so let me just I you're protesting
this value at all times so at least like
we have a consistent feedback of what's
going on I thought I got it but
apparently don't 127 when I don't touch
it it gets lower when I touch it and
also the noise triggers because I'm
speaking which is good and the sensor
works so if this is lower than yeah if
this is lower than 120 temperature
it's just the values yeah thanks
okay so one more time I once picked this
I thought I do it is like I know you're
like oh this like when I was preparing
the talk but friendly wasn't like sorry
enough okay let's wait for the intrusion
country mr. song cool laser temperature
and whoa and the temperature is what yes
the noisiest working cool
but I mean I know you guys are really
excited but what sort of what sort of a
large system doesn't have a beeper
come on right so I have a beeper here
and it it's like really similar to the
other sensors so it has a ground and VCC
cable so I'm just going to connect this
to anywhere I want and there is another
pin which is being driven by the GPIO
pin so I just pin it to the 18 okay cool
gotcha so now basically I just want to
do the very same thing I used to do it
before so here when I'm hooking up this
laser I also want to hook up a buzzer
and will be on the pin 18 it will be
still an output I will turn off by
default because that's how alarm works
and here's a buzzer and now I need to
include this thing to the loop right so
just do buzzer buzzer and here I'll just
do the same thing and basically every
time I want to do like there's an alarm
I just want to do this GPIO right
buzzer zero no zero yes that's correct
I'm just going to quickly copy paste it
everywhere and here
in the case that like no sensor so no
alarm triggered we want to do this under
one okay so if I try this out
nutrition control measures on and I
don't know if you're hearing this let me
try this maybe it's not the right
frequency but it is working well if
you're like really conscious about
security properly you can hear it but if
you're not programmed on anyway so now
we have a buzzer like it does like all
the right things I also have a vibration
sensor but I don't know how much time I
have left so yeah okay I just did the
vibration sensor once more and this
vibration sensor is actually just a
mercury switch so it's just like a
little piece of glass with like some a
ball of mercury in it so and when as
soon as you like move it a little bit
it'll just like make contact and we'll
say okay someone touched this thing and
and on the country of all the other
things this is a digital sensor because
it just says on/off so it doesn't really
need to have an analog output so I just
like simply connect this to the board 20
and just connect no sorry the alarm is
just like catch me all the time so
connect it to 23 and I have there and if
I go back into the countermeasures so
here we do we want to do something
really similar as like this and here
we'll do vibration and we'll start a
link on the pin number 23 when in this
case will be an input and I want set
like write anything to it and here I'll
do vibration vibration and here all do
the same thing cool so I'll just do
something I'll put this sense of read
before the nice because otherwise if
someone by braids will trigger in the
noise the noise will trigger as well
you're just like have this sort of like
dependence
your alarm systems yes so basically just
do GPIO read vibration
maybe now instead of guessing and just
like print out the value and run it and
you should see it should see like one
and as soon as I vibrate a little bit
you'll see zero well and other noise
triggers but now I know that the value
is zero so as soon as value equals
equals zero do and I have to copy paste
all this thing don't worry about that
like in the version I pushed on github
is as being properly refactor to a
helper function it is just for
educational purposes because I know it
would earn me as well so so the
temperature is called vibration we don't
really need the value but I'll write it
anyway and oh yeah thank you
let me try to okay so right buzzer
vibrate no this is good I think
where it should be good okay cool so try
again mix
now if I check this look vibration
trigger yeah kind of for its it's okay
okay cool so now I'm just gonna well bye
is it working I know I just like this
connector they have like five more
minutes still that's fine because my
plan was to show you that like this is
actually running like everything you've
seen up to this point has been running
on Ruskin so Debian basically but I have
to working like nerves thing it just
like takes one minute if everything goes
well
can I go yeah cool so if I go to desktop
countermeasures
I have everything prepared here so I
just opened the countermeasures axe and
can you please remind me what the values
were I've turned off the system but
hopefully we can just like copy them
from somewhere so I think this was like
120 this was the same thing and I think
this was like higher for some reason it
was 116 okay let me just try so now like
basically I've just like when you if you
just go to the nerve project you can
just follow the tutorial you can install
nerves you can create a new project
which uses nerves and as soon as you do
that you'll be able to do something like
this which is a compiling a firmware for
a specific target which in my case is a
Raspberry Pi 2 and then you have another
SD card which I'll just like pop in
I'll just disconnect this other SD card
and now if you just do mix firmware burn
will like flash this app sometimes it
doesn't work don't worry about that I
think I got it oh no okay
awesome so now it flashed this app to
the SD card and what's amazing about the
nervous project is they actually
replaced the whole system D in Linux so
as soon as the kernel finishes to boot
you are straight into your Erlang gap
elixir app so if I go back here you see
like now it's booting and we'll you'll
see that something cancer measures on
well the laser now triggers and
something but the rest works</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>