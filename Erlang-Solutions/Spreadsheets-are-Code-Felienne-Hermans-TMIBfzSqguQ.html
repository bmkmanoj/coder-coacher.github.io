<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Spreadsheets are Code - Felienne Hermans | Coder Coacher - Coaching Coders</title><meta content="Spreadsheets are Code - Felienne Hermans - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Spreadsheets are Code - Felienne Hermans</b></h2><h5 class="post__date">2015-11-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TMIBfzSqguQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Flynn Airman's I'm assistant
professor at Delft University of
Technology if you're on Twitter and if
you're tweeting this this is my handles
just my first name so you can tweet
about it and mentor me so I can read
what you like and it not like after the
talk so my talk is about spreadsheets
and many people developers think why on
the Developers Conference
are we talking about spreadsheets
spreadsheets are often mislabeled people
think of spreadsheets as being data
where spreadsheets are actually
programming spreadsheets are code this
is the gospel of my life I go everywhere
all conferences that want to have me and
I tell people spreadsheets are code now
you don't have to believe me
immediately I have three reasons for you
why you should start believing me why
spreadsheets are actually code first of
all spreadsheets are used for very
similar programming domains problem
domains here you see an investment
calculator you put in some properties
and you get an answer and this is
something you could have built in Java
and objective-c in Haskell it doesn't
really matter a domain is finance it's
very suited for programming in any
language and of course you can one there
why would you do this in a spreadsheet
and I have asked people this during my
PhD project I worked at an investment
bank for two years where our research
spreadsheets so it's a people why did
you build that why didn't you buy
software or hire someone to build it for
you so it turns out as developers we're
really bad at making software often
these users they have tried this they've
gone to their favorite IT supplier you
know within their company or winner
outside of it and they say hey can you
build me this investment calculator and
then the software company says sure no
problem
that'll just be three million and six
months and then if it were true it
wasn't even that bad but often then of
course it is three years and twenty
million and it has half the features
they want so from the perspective of a
smart end-user
doing it yourself in a spreadsheet
actually makes a lot of sense it seems
very cheap so why in a spreadsheet
because it isn't that easy to make so
far so I go to great lengths to make my
points
to such great lengths in fact that I've
implemented a Turing machine using
spreadsheet formulas only to show people
that spreadsheet formulas are actually
true and complete so they're proven as
powerful as any other programming
language out there so would you see here
every row is one iteration of the tape
because using formulas only you cannot
update itself and the head is visualized
with conditional formatting actually I
think in addition to being proved that
spreadsheets are too incomplete I also
think it's a pretty nice visualization
of a Turing machine because you see the
movement and it's on my website you can
download it and if you do you can put in
different state machines and they map to
a visualization of how the head moves so
you sometimes oome down and just looked
at the pictures it's pretty cool and it
went somewhat viral on the internet so
if you google Excel Turing machine
you'll find lots of people who wrote
about it it actually brought my blog
down for half a day because it wasn't
hacking news and reddit people thought
it was fun at least which tarnishing I
don't remember just like the basic one I
think oh yes okay that is of course true
so the third reason that spreadsheets
are actually should consider them source
code is they suffer from typical source
code problems for instance we found that
only one entry spreadsheets have a
manual spreadsheets are are used by 12
different people during their lifespan
that average 5 years so these problems
they sound a lot like the problems that
we had in software in the 70s and 80s
when people started realizing that the
little scripts they build within their
company the little COBOL programs or
Fortran programs we're still there 10 20
years later and were undocumented and
maybe people have lost the compiler so
really similar problem space also so
these are three reasons that
spreadsheets are actually programming
they are used for similar problem
domains they're just as powerful and the
problems
that occur with our usage arted saying
so spreadsheets art gold I hope you are
convinced me but I'm going to go a bit
further than that they're not just a pro
game programming language they are the
next programming language that you
should learn resistance is futile why
again I have a few reasons for you
spreadsheets or live programming who
knows who made this visual from what
talk it is yes Victor from inventing on
principle so he presents this idea of
live programming where on the one hand
side you have the code and on the other
side in the same view you have an
instantiation of that code and changing
something to the code it me is
immediately reflected in the running
environment the compilation is needed so
this is wonderful bread Victor but we
had that stuff since visicalc I mean the
spreadsheet is life programming you
update the formula and immediately got
the results no compilation is needed
there secondly I know how functional
programming is suddenly back in fashion
everyone likes functional programming
well if you like functional programming
you've come to the right talk because
spreadsheets are purely functional a
spreadsheet formula it cannot have side
effects the only thing a formula can do
is its reference other cells and based
on their values in those cells it
calculates the result if you only look
at formulas it is impossible to create
side effects you can only manipulate
your own little cell if you're a
scratchy Foreman so they're purely
functional and the third reason that you
should actually learn about spreadsheets
is everyone knows this stuff but us
everyone knows how to work with it with
a spreadsheet like your next-door
neighbor is managing its fantasy
football team in a stretchy your
accountant is doing your finance
probably in a spreadsheet everyone knows
this there are lots of statistics for
instance in the netherlands all
inhabitants are surveyed for their
computer skills and over 50% of people
knows how to manipulate formulas in the
spreadsheet so you could say that this
is enabling everyone to program it's the
most popular programming language ever
except amongst programmers so I'm going
to fix that here today in this room I
will teach you a little something about
how to do some amazing algorithmics
in a spreadsheet so what we're going to
do is we're going to implement selection
sort it's a pretty simple sorting
algorithm that works as follows you pick
a value the first one and then you look
at where is the minimum in in the rest
of the values you select the minimum and
you select the first value and you swap
that and then you continue to the second
value you again search for the minimum
you swap them and this is how you sort
the entire row so what I've added here
is just the index so it's just from 1 to
13 just every this is the first one
second one for convenience we will meet
that later so the first thing we need
for our selection sort algorithm is the
minimum and luckily Excel has a building
function for that we just take the
minimum of this row that is very easy
but we're going to do it slightly
differently and at the end of the talk
you'll understand why I use this so
instead of going from e3 to q3 I can
also use this syntax 3 : 3 and that
means the minimum of the entire row this
is something that not everyone knows
remember this because you'll need it
later so what we now want to do is okay
we know the minimum but at what position
is the minimum located there is a
matched function in excel for this so we
say we're going to search for this value
in this row and this means we want to
have an exact value in all an
approximation so that is correct
it tells us that the minimum is at
position 1 so let's build our algorithm
step by step what we're going to do
initially in this line is not
immediately sorting first we'll just
mark the spots with an X where we're
going to swap and for the rest of the
values we've put an underscore just so
we can build the formula step by step so
this is a position if e 2 is
to d4 so ever at the position of the
index of the minimum then we would like
across there so this is a formula if
this is equal to the minimum mark it
with an X hmm
we would have expected across there but
it's not there
it's all see what I forgot here some
dollar signs very good sir what happens
if we select this cell you can see it if
you take a formula and drag it all
references are immediately updated so
this formula now not refers to this
minimum but to devalue right before it
and we can fix that with a dollar sign
if we put a dollar sign in front of
reference and then dragon it is not
updated so now we get a nice little
cross there and let me
I'm not going to trick you again with
the dollar so I will do another dollar
here because later we're going to drag
all the fault formulas down I want to be
fixed on the index row okay so we know
where the minimum is on the other side
where we want to start at the beginning
first index and then move up we have the
opposite situation we know where we are
but we don't know what value we have so
we we know we're at the first spot but
we need to get the 13 there's an index
function for that in Excel so we can say
give me the value on this position so
now we have 13 now what we like to do is
also add a cross in this first cell
because we want to swap either if we're
at the position of the minimum or if
we're at the position where we're
supposed to swap so what we do here if
if eetu is equal to the four then we're
also going to swap so we're either
swapping if we're at the index of the
minimum or if we annex a minimum or if
we're at the index where we are supposed
to swap so this is the easiest part this
is the thing we can you can come up with
what's supposed to go here what do we do
if we're not swapping what should go at
the spots of the owner score
so this is the situation as it is now if
we've done one step of the algorithm
what's in the spots of the underscore
yes very good the same value we can just
copy the value from upstairs from one
row up so we're getting close if we're
not swapping we just take the value up
and what I've done here is I've added
conditional formatting like with the
Turing machine to show you what values
aren't swapping just for convenience so
you see what the algorithm is doing so
what do we get here
if e 2 is equal to B 4 so if we're at
the position of the swap value what goes
there yes the other value the minimum so
if we're at the position of the swap we
take the minimum and in a similar
fashion if we're at the position of the
minimum we take the swap value so this
is almost our selection sort we can take
that and drag it down unfortunately
again I've made a little mistake because
this doesn't look very sorted so what is
the mistake here
very good I am increasing the position
where to swap however look this minimum
stays the same because my initial choice
was the minimum of the entire row so I
need to change something about that what
I'm going to do here and Excel has a
wonderful function for that called
offsets it takes a range and moves that
range over the spreadsheet so I can take
this range and every time I increase my
index I move this range one so initially
I move it zero so that's this one minus
one and then in the next step I move it
one and then the next step I move it to
so the range I'm taking the minimum over
goes like that and if we fix that ball
selection sword oh wait we're not done
yet this is a really nice we want to go
a little bit deeper in all the scary
things that Excel has to offer for us so
bear with me I'm going to make it nicer
but also somewhat darker pop quiz anyone
has an idea what this syntax mean so
there's a formula a 5 :
q 5 then there's a space C 1 : c 15 what
does this mean
no well they're two Rangers so I'm
selecting it let me select it and then
you get some further visualization
yes intersection so for some reasons
above me instead of just having a
function called intersect and then two
ranges Microsoft decided it would be
very nice to give the space some meaning
only in this specific situations because
there are there are many situations
where somewhere spaces can be ignored
but not here because now it has meaning
how do you know such things have you
have you implemented the entire grammar
of spreadsheet formulas fellini yes I
have
we actually have of course it is
implemented because it's inside of Excel
and it's also inside of OpenOffice that
have a similar syntax but it's not
separately available for researchers to
build all sorts of add-in so we fixed
that by really seeing a grammar and
parser it's actually on my github that
parses we test-drove it on about a
million formulas and we have 99.9%
completion so this is how I know about
this funky syntax because we in we
analyzed lots of formulas and we
actually saw that people use this and it
gets even a bit worse than that we can
use this particular syntax because what
we can do now is name this range we give
it the name index we select these cells
and say we now want to give them a name
what I can do now is the formula that I
had if this e nine sorry this e 2 I can
replace it with index and what I get now
is the intersection of index and knee
column so this is two minutes ago I
refer to it gets a bit more strange this
is it because now this e here is
optional I can remove it so what this
means
I see the gentleman looking very
confused so what this means is the
intersection of this index range and the
cell that I'm currently in yeah that's
what that's what it means
so I this cell is evil
so if I refer to index from here it
means the intersection of this cell and
I say the column of this cell and this
range we can repeat this trick if we
give all these columns so we call this
swap and index and minun index men we
can turn this into this isn't that nice
now it looks a bit more like programming
right we can read this it's
self-documenting if index is equal to
the index of the minimum swap if index
is equal to so index swap minimum
there's just one thing here that is
annoying this is of course that III I
cannot use my trick on that because it's
an intersection of something else it's
the cell above so I cannot refer to a
fixed row of course this has to go this
has to go because I want to have
something nice without any cell
references I know if I'm trying to give
you some programming and Excel and it
still has a 3 in it you'll say no that's
not real programming so we have to fix
this but we have to go a lot more deeper
into this special special hell that is
named ranges of Excel or are having or
opportunity however you may call it so I
showed you already how you can give a
range of cells a name I selected a few
cells and I named that index but what
you can also do is name a constant so I
can say the name all you need and
instead of referring it to a certain
cell I can also just put something else
there like a string constants so now
I've defined all you need is love and
now I can call that reference look all
you need is love love is all you need
isn't that nice it's a pity that the
Beatles never got to see this well at
least maybe still two of them there are
other songs also that we can turn into
magic excel poetry forensic service is
wonderful song by Paolo Nutini it's cool
it has a line in it however much I love
you you will always love me more well
let's bring that to a spreadsheet we
define a constant like we just did
instead of a string constant we now
define an integer my love that's safe my
love is 15 so what I can do now is I can
find your love which is always more than
my love so I can say my your love is 1.3
times my love so I have a formula inside
a named range I have to find something
like a function you could say it's a
function so I can say ok your love is 15
my love is 19.5 and whatever you put in
here there always be more or asleep
because it's defined as a multiple of
that another song that we can put in
Excel by famous Dutch DJ I mean from
Buena called every day I love you more
so this is like loving to the next level
because first it just was ok you lost I
love you more but now it's every day I
love you more this is an unending
never-ending process
so let's map that in a spreadsheet again
let's start at 15 and day 1 what we can
do now is use a formula to point to the
cell above and you can use the row
function maybe you've seen this if you
use the row function without arguments
you get the row of the cell that you're
going from we can use that so we can
create a cell reference to the cell
above us using we make a cell address
out of our row minus 1 and our column so
if you put that in now here we just have
the string value of the cell above the
location of the cell above and Excel
automatically puts in the dollar signs
here so we're close but we're not there
because
we don't want the location of the cell
we want the value of the cell and what
Excel has is an indirect function that
you can feed a string and it will
evaluate that string it's very much like
the eval function in JavaScript you put
the string in and you get whatever it's
represented by that string so if you
take the interact of the string be three
is equal to what is n be three it's the
same thing so intuitively you just drop
off the quote but what it means is give
me whatever is on this string we can use
that so we can say we don't want to have
the location we want to have whatever in
there so now we have a formula that
refers to the cell above it the only
thing we now still need to do is put in
the vendor in factor however much it is
that I love you more every day we just
add that so we say today's love is
yesterday's low of times a certain
factor we can drag this formula down so
all these cells this is like if you will
trick your co-workers with a crazy
spreadsheet all these cells refer to the
same names range but they all have a
different value because they're secretly
referring to the cell above weight some
sort of formula mumbo-jumbo so this is
of course what we all need to attack
this III I'm not here to talk about love
songs I'm here to talk about selection
sorts so we can use this crazy magic to
get rid of that ugly nesting I bleeding
III it needs to go so what we can do is
we can define in a similar way that we
were just defining yesterday's law we
can define a function a name change I'm
sorry
call previous row with a very similar
formula it is referring to whatever is
above us the row above us and here when
I told you in the beginning you need to
pay attention to that syntax of row
colon row that is what I use here so
here I don't need to have the column
values I can just say the row minus one
and the row minus one so I create the
string of the cells above me and refer
to it look at that now it's like real
no one ever anymore can say that this is
not real program if the index is in next
minute you got swap if the index is in
swap you get the minimum and otherwise
you get the previous row isn't that nice
it's yours for comparison I've also
implemented selections for annum by
phone it's not that concise it's lots of
letters actually I don't know what
version I would like better well I know
what version I like better but if you
wouldn't be as biased as me I know no if
I thought it seems pretty nice too
so the idea now here and that's actually
what my research is about my research is
not about doing crazy Excel stuff the
idea of my research is if spreadsheets
are code could we apply methods from
software engineering to spreadsheet to
help people build better spreadsheets
like I said in beginning the problems
that we recognize in the spreadsheet
domain a lack of documentation a long
lifespan artifacts being transferred
from one person to the other without
really deep knowledge these are the type
of problems that we I wouldn't say we've
solved them in software engineering but
at least these are the type of problems
that we worked on for the last decades
to get people to build better short code
and initially when I started my PhD
project I wasn't hired to work on
spreadsheets at all the assignment of my
PhD project was to build a
domain-specific language at DSL for
Finance so I started doing a small case
study and an investment and an insurance
company me being computer scientist I
was surprised everyone in that insurance
company was building spreadsheets they
were all programming but not in a proper
way so I went back to the University and
I said to my supervisor look they don't
need a DSL in finance they have a DSL in
finance
it's called spreadsheets and it's not
very good so let's
let's try with all our knowledge - from
summer engineering oh man let's make it
better what those guys need is an IDE
that's what they need they can just
build software like we build software
like I work basic when I was ten just
like writing and trying but what I need
is support professional support like
professional programmers have and that's
actually resulted in my PhD dissertation
called analyzing and visualizing
spreadsheet and you don't have to read
the whole thing because the conclusion
is yes we can we can very easily
transform methods from software
engineering to spreadsheets with very
little effort it's very easy to talk
about the same concepts in spreadsheets
so one of the examples that we did is we
build a refactoring tool for spreadsheet
so initially we started with a smell
detection tool that could tell you this
formula is very long or these things
seem very connected and people like that
and they wanted to improve upon their
spreadsheets so we build a refactoring
tool and it can detect formulas like
this one you see here it's not very
elegant it's the sum of something
divided by the count of something you
could also use an average there and it
could be due to the fact that this
person didn't know about the average
function note so maybe not so probable
for an average but in other scenarios
sometimes people use very complicated
sums because they don't know about the
sum if for example this is a refactoring
we support two so you can ask our tools
give me applicable rewrites give me
things I can do with my fur line and it
says yes we found something for you the
sum and count to average refactoring and
we even give them a preview like many
ideas also have this is how your formula
will look like and this is a slightly
older version in a newer version we also
check if given the values that are
currently in your spreadsheet the
refactoring won't change anything
because there are sometimes subtle
differences even between the plus and
the sum in Excel it's not always this
it's not always the same so at least we
check if the change doesn't mess up your
spreadsheet
currently is and you can apply then this
transformation within a cell but you can
also apply it within a range and these
transformations are entirely
programmable so we didn't make what we
did make a number of default
refactorings but if you don't like them
or if you want to have others you can
define your own transformation in the
language that's very much like
spreadsheet formulas and we imagine that
power users that can you use very
complicated formulas or write VBA could
also write these transformations and
then apply them on their spreadsheet and
then it gets a bit broader than just
refactoring then you could also do
transformation of business rules so
suppose you're changing how you evaluate
mortgages you could write the
transformation rule for your formulas
and then apply it throughout an entire
spreadsheet it's sort of a powerful
finding replace and then of course you
should know this one I'm okay if you
didn't know all the spreadsheet answers
but someone should get this right if you
say refactoring you say that's very good
of course we cannot give those poor
spreadsheet people if a powerful
refactoring tool if they don't have
tests how will they know if everything
is ok of course we can Jack against the
current values but you want to have
something more safe and initially this
was some sort of ivory tower thinking we
were like how are we going to get
spreadsheet users to test it's already
so hard to get normal developers to test
how are you going to convince
spreadsheet people to add tests this
will never work and then we actually
looked at some spreadsheets and we
looked at what people did and it turns
out spreadsheet users are pretty good
testers we found lots of formulas like
this test formulas you could say so
something like if the some of these guys
is not a hundred I'm just going to
output the string error and otherwise
I'm outputting the string 100% these
type of formulas are common we found
them in about them ten percent of
formulas have this form they look at a
certain value and if it's not whatever
they expect the output is certain string
so we saw many cool different versions
we even saw things like well ok and good
and bad but also smiley faces and sati
faces as outcomes of these tests so
people apparently do use this but
because just there is no and unit or J
unit for excel what they do what they
use is what they know formulas so we
thought why why not exploit this why not
use this observation that people already
do it and use that to generate the first
version of a test suite so we've built
another plugin called X Factor and what
I can do is it can find these existing
tests in your spreadsheet so for this
you get a pop-up and we say hey we found
this cell in b10 it appears to express
that this sum should be a hundred
percent and we have a list of heuristic
words so we know that error is okay and
okay is okay and sadi face is probably
failing so we can guess whatever it is
you're doing and if you're if you like
it you just take the marks and you can
save the tests now they're saved in a
hidden worksheet that we call a test
suite they just think they're so magic
that knows what is happening in my
spreadsheet and you can run all tests so
you can click this button you get a
pop-up and it says yeah all your tests
passed this is a test this sum should be
a hundred percent and you see that we
have slightly transformed this
you know formula into something a little
bit more readable in behind the curtain
what you can then of course also do if
you have a test suite is visualized test
coverage so users can click show me what
is tested we don't use coverage and then
it says hey these cells are tested so we
color all the test cells and to make it
a bit easier we have a very simple
definition of course of coverage we just
say ok this cell is tested and it uses
all those cells so less considered and
tested to everything that leads to this
cell is tested because at least if
something goes wrong it will all trickle
down together in this cell or we're not
talking statement coverage and branch
coverage here if this is a very complex
conditional we're not at all looking at
our order all the different branches of
the conditional covers we just say ok
this area of the spreadsheet seems to be
fine what we then do once we've got
people hooked to the idea of testing is
give them a little bit more in very
small doses so not make them responsible
for testing everything we will give you
a few suggestions so you can pick I want
to test the complex formula I want to
test the formula with a big value or I
want to test the formula with many
precedents so formula that has lots of
cells that it depends on so if you click
it we select a very complex formula and
this is again where we use our smell
detection algorithm to determine how
complex the formula is because we know a
little bit about it and then we say ok
this looks sort of complicated if if C 4
is yes well I don't even know what it
says it looks complicated if you say yes
make tests we give you a few options so
you can do a few building tests like it
should be a number this is a trash hold
upper bound the lower bound and in a
slightly new version we also have an
option here to define your own format
because this turned out to be a little
bit too simple so now we also have
formulas you can just express whatever
you want there it should be all it
should be even it should always start
with an A whatever you want so you save
that and you get wonderful you've
increased your coverage
6% to 8% so we try to make it a little
bit fun and then these these thresholds
are added to your to your test suite so
if you run tests now their attitude so
the idea here is really and actually
this is the idea of my entire research
is look at what people are doing and
make something useful for whatever
they're doing small increases of course
you could say and I always get this
question so I can just answer it right
now people say why are you fixing this
obviously broken system why aren't you
working on something better than
spreadsheets something to replace
spreadsheet a4 DL or a 50 L this is not
working I think it's very interesting to
observe the success of spreadsheets and
make it a little bit better make it a
little bit safer because for reasons
that are not perfectly clear to me
somehow spreadsheets hits the sweet spot
between being expressive enough to run
entire banks and you know the things
I've seen with spreadsheets and higher
risk management dashboards managing an
entire department its expressive enough
to do that but it's simple enough to
make everyone feel like they can do
something you just put the data in the
spreadsheet you play with it and then
suddenly you have a dashboard it's very
low threshold apparently it's very
inviting environment so why not keep
that power and make it slightly better
instead of trying all the power out of
the window and building something
entirely different
so both these tools are available
available from my websites Felina tooth
comb slice bumblebee and flea nettle
comes expect or actually we're running a
user test would expect right now so if
you have people that you know that like
spreadsheets or maybe tomorrow at your
job or the day after tomorrow you decide
to stop Haskell and you're going to
billow your enterprise systems and
fractions then please join this study
the unlock the tool and we monitor on in
the back we monitor what I perform
allows you test and how frequently you
use it because we really want to
and how it works in in a real context so
just I will before we go to questions I
think we have some time I will summarize
my entire talk in 30 seconds so if you
miss anything you're sleeping or doing
your email or you came in late that is
fine this is your second chance and for
those who are here from the start this
is of course absolute preparation for
question asking spreadsheets because
this is the most important thing tell
all your friends if you're on Twitter
you know the rest is not that important
just spreadsheets are cut why our
spreadsheets code firstly they're used
for a very similar problem domain
secondly they're turing-complete sorted
just as powerful and thirdly they suffer
from typical software engineering
problems they are even cooler in just a
programming language they have all the
health characteristics that are in
fashion there are live programming
they're purely functional yes contrary
to maybe Haskell everyone can use them
very easily so I demonstrated how
powerful and fun spreadsheets can be by
implementing selections for it in a
spreadsheet and this is the entire idea
for my research
spreadsheets are code so we can make
them better with tools from software
engineering we build a refactoring tool
and it says tool to make spreadsheet
users as professional as real developers
so if you want to know more this is my
professional website my personal website
and this the spreadsheet lab is the
website of my research group where I
force a few grad students to also enjoy
this if you want to connect well I'm
here today I will be at the drinks I'm
here tomorrow as well but you can also
send me a tweet or send me an email if
you if you're more if you don't want to
hang out with me in person or you could
ask a question now
so the question is how do you define a
complex formula we have well read my
dissertation it has we have a number of
metrics for that so a few things we take
into account is the number of different
functions so if it's just one sum it's
easier than some and it flows and it
divide we also look at the number of
ranges the cell refers to if it's just
one or two it's easier than if you get
cells from everywhere we also look at
the locations of the cells because it's
a lot harder to refer to as cell from a
different worksheet you have to go there
and go back so a number of metrics yeah
so the question is why would people add
test formulas yeah why do you add test
formulas to normal code
yeah this is very true so the very
financial spreadsheets we'll look at for
instance my income and outgoing money is
it is it equal to each other and also
the example that I showed is also a
common example where it's really about
inputs so you give this form to someone
and he has to make sure that the
percentage is match and I guess by
experience people send a spreadsheet to
someone they have to fill it out it
comes back and then they see oh you wait
it doesn't add up so I think they want
to move that process closer to whoever's
entering data and but this is
speculation I guess it also has to do
with people's experiences or
spreadsheets having errors they know
that they're coming a mistake in either
the data or in calculations so checking
it for yourself just makes it easier
that's also of course a big difference
between spreadsheets and normal
programming is spreadsheet is one
package with data and formulas whereas a
program is independent of whatever data
you run through it so some of the tests
are also very much aimed at checking
that the quality of the data do I have
enough aren't there any values below
zero or something like that yeah
yeah so how did I got all the
spreadsheets there the this test we did
that on a very small data set that other
researchers gathered that sorry
the we you said a small set that
researchers gathered just by googling
but the very big that we have this is
another talk it's also on YouTube where
spreadsheets are typically attachments
to email and there was this wonderful
company that made my research a lot
easier called Enron they went bankrupt
and as part of the investigation their
email servers were made public so we
crawled all those emails and now we have
invisible so we also open source that
corpus of spreadsheets so we have all
these spreadsheets this is a very nice
research paper if you want to read it
where we looked at the spreadsheet and
we also crawled the emails so we did
some text analysis and we saw very
interesting emails people like hey Harry
I checked your spreadsheet there seems
to be an error in it somewhere so you
also see that the culture about you know
people talk about updates of spreadsheet
can't you can give me that new version
so thank you and wrong for going
bankrupt and being investigated because
now we have this wonderful data set and
one of the things we're also analyzing
though we probably cannot really publish
about it all the week Sony file
lots of spreadsheets there that we well
we have have them maybe I shouldn't say
that we could potentially if we would
have them analyze them and not publish
about it because we don't really have
them
I swear anything else yes sure
yeah yeah this is very true that that's
that lightness - those are tears that
breath Victor presents Arnold actually
here's their way over there I think from
papers in the 70s and 80s that design
they described as a design feature for
you eyes you should have this likeness
it's a lot easier if you can directly
look at your values and I hope that due
to Brad's popularity somehow this
likeness will go into normal mainstream
programming language because obviously
it's very very powerful to have your
data right there and to be able to
manipulate it and get direct feedback
yeah the question if we only analyze
name related errors we also do similar
things so we have specifically specific
smells for example for the vlookup look
at my blog we have a whole paper about
very detailed intricacies and how if you
look up it works and we warn people if
they use it the wrong way if you use it
over a non certain range it won't work
in certain situations so we have that
type of it's more static error checking
than smell detection but we have that
tune I will yeah</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>