<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lambda Days 2018 - Maximilian Algehed - QuickSpec: A Lightweight Theory Exploration Tool (...) | Coder Coacher - Coaching Coders</title><meta content="Lambda Days 2018 - Maximilian Algehed - QuickSpec: A Lightweight Theory Exploration Tool (...) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Lambda Days 2018 - Maximilian Algehed - QuickSpec: A Lightweight Theory Exploration Tool (...)</b></h2><h5 class="post__date">2018-03-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/922GilQEvXo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm going to talk about quick snack I
should start with this so quick speck is
joint work by a lot of great people at
Chalmers and me Nick mower John Coon and
me if you want to follow along this is
going to be a long demo we're just going
to play with a thing for voice 5 minutes
there are two ways of following along
one is installing quicks back yourself
really easy to do caballo update
kabbalah install quick spec or if you
just want to follow along by shouting at
me telling me what to do that's how I
you know that's how I prefer to interact
with you guys so please the files I'll
be using at this time URL get the paper
paper is great yeah
so let's get started so this is quick
spec we have some functions we have plus
takes an int + int gives back an int we
have x we have 0 and we have 1 okay what
do we know about these things
well I don't know anything about these
things because I didn't go to school I
went scope kidding but let's ask quick
spec quick spec knows all these things
about these functions how does it do
that well what does it know first of all
it knows that multiplication is
commutative in this applicator or
blasters commute to save units of plus
and times some laws about associativity
of operators and so on and so forth and
this is what quick spec does as I said
or as was said in the introduction this
is really the opposite of what quick
check does right quick check you come up
with something like this you think very
hard do you say hmm this thing ought to
be associative and then you write the
property and it's associative quick spec
on the other hand will do all that for
you well not coming up with the function
but coming up with hmm this looks like
it's associative I'm gonna try and see
if it's associative how does it work
testing okay quick spike knows nothing
about the definition of these functions
it only has access to the function as a
value right okay
so here's how you use quick spec you say
I want the signature of the things I
care about so for instance plus you say
plus is a constant give it a name and
then give it a type signature all right
because quick spot uses testing and
randomness I'm running with a fixed seed
here and that's because I don't want to
get caught out by randomness and a lot
of demo hasn't happened yet will happen
one day in the future I'm sure all right
let's look at some more functions and
let's sort of explore how we might use
quicks back and remember if at any point
you want me to put another function in
just tell me and I will do that because
that's fun okay so I can the reason it
didn't do that here is because quicks
back normally just I can show you I
don't want to explain things I want to
play with the thing with Mac's term
slice if we go up to slightly larger
times let's go up to 8 we should be able
to find it it has to think it a bit
longer
we've got larger term sites but
eventually we find it at 11 here and
that's how quickly we find it right x
times y plus said x times y plus x times
that
exactly we instantiate every variable
with random values and we find
equivalences between towns that's right
it does grow exponentially and as all
these things are you know you might
imagine that there are some limitations
I'm going to show you that the
limitations really are not as severe as
you'd think right I'm gonna try to I'll
show you a really big example in a while
but maybe we'll build up to that X plus
y plus Z is okay well I should explain
this
I should explain this quick spec will
find things which which which are true
and with associativity here it it's this
is this associativity follows from this
and commutativity which we have up up
here somewhere I've hurt my shoulder I
shouldn't be doing that but but yes it
follows from from the other thing right
and there's a caveat
listen taking the reasons why the
associativity is tricky oh look you know
I can point I can point like this all
right this is okay if anyone gets a
laser in the eye during this
presentation it's that guy's fault all
right
yeah so we found associativity but we
found it in a slightly odd form right I
don't have to do with the order in which
quick spacing some new times to test
I won't go into the details aren't the
details of precisely why this particular
thing with us or simply happens are in
the paper five minutes
yeah it's an interesting yeah this is
one of the well improve service activity
just found it in a slightly strange form
but it didn't it would normally expect
to find it perhaps associate elements
from the VA and commutativity hang the
law it printed it's not make more sense
right so first they doesn't find doesn't
consider equations think they considers
things long-term at the time I think
this is a term or dream culture I think
this has to do with the it side of the
ordering of the terms for this course um
I have a great answer at the moment but
let's look at another one zero dabs and
just look look what quick spec comes up
with
so what quick specs found here is a load
of things about abs of values which you
probably some idea about abs of abscess
abs and then it finds this ABS of X plus
amps of X is AB sub X plus X and that
makes it to X and it's bigger that just
makes it more negative if if X is
negative then say X is minus 5 it's
minus 5 plus -5 I'm just going to do
this for now no I'm not gonna do this
this is never going to work
all right this is it good excellent
great but yeah so access the same time
as X so if it goes up it goes up abs
does nothing if it's negative it goes
Darren whatever now I when I first saw
this I wasn't
happy because there is a more general
form of this equation which clicks like
hasn't found and that's but it's not
only under a certain provision and
because ABS X plus ABS Y should be equal
to AB so X plus y if and only if x and y
have the same sign right everyone fun
with this well let's see if it is this
quick spec doesn't just know about
equations with terms in them it also
notes about equations with with these
conditionals so these provisions and we
might have to do this with max term size
8 say oh so what I've done here is I've
said add equal sign as a predicate that
is a function which eventually returns a
boolean and what is equal sign doing
it's just comparing the sign of the two
values right so let's look at ABS plus 2
there we go okay what does quick spec
find it finds the load of things it
finds a lot of the same laws we will
renew about abs it's finding that equal
sign is an equivalence relation and
hopefully at one point to another it
found the law I'm interested in here we
go here oh no that's not the one I'm
interested in all right 14 thank you
here we go if x and y have the same sign
then ab sex plus abs why is ABS x plus y
so quick spec notes by equations over
Haskell functions they knows about these
conditional equations that have some
provision what else does it know about
well nothing so all we can do at this
point is just keep giving it more
Haskell functions and play around and
see what happens
so let's do that let's play with lists
for a while for just a little bit and
again if you have a function from the
standard library or something that you'd
like me to show you just tell me and we
can add it right so here we're looking
at three list functions append zip and
reverse note the funny type signatures
plus plus has type list of big a - list
of big a - list of big a and that's our
way of telling quicks back
this function is polymorphic so you can
use it polymorphically it's okay to use
it polymorphically even though area is
big a and Big B are concrete types right
so let's see all we get with lists a lot
of functions about zipping or equations
about zip and reverse and append
reversing some something twice it's the
same as doing nothing append this
associative lots of things about zip and
append for instance this law right here
telling us that if we zip X's with X's
and then some stuff that's the same as
just zipping XS with itself does anyone
know why that is cuts it off exactly
right and we get similar laws in the
other argument we get similar things for
Reverse right
reverse of zip of exes with reverse exes
is zip of reverse exes with XS ok so
what's going on here is that we can sort
of shuffle the reverses around now
notice that all of these equations to do
with reverse and zip and append all the
interesting ones with zip I should say
all feature access in two places now
let's think how can we generalize that a
little bit what's the property of having
access in multiple places that gives us
these interesting laws any ideas
length and what about length they should
be equal that's right so let's try that
again same kind of signature
maybe I should increase the term size
max term size seven and here i units
there are more and more Feist some of
the functions and that's mostly actually
to get slightly fewer outputs so force
the functions to be a little bit more
specific and focus on the problem at
hand we get just more stuff or all of
them with any we get slightly less more
stuff we can do that but it will make it
more difficult to see that's it right
this with conditionals okay we get some
stuff about what it means to be of equal
length lots of stuff about what it means
to be a people length and then here 14
or 15 if X's and sides have the same
length then X is plus wise and then
that's a zip axis and that's all right
so we're learning something about our
intuitions they seem to be correct we
can play around with this quick speck
goes on keeps printing stuff everyone's
happy
a thousand I think I think that and you
can change that you can change so if you
have a tricky problem where you think
that you get a lot of false equations
because remember quick spec has this
nice property for a tool to do with
formal stuff it's both unsound and
incomplete so yeah you can increase the
number of tests to it till you get
sufficiently large number we can check
let's go back here maybe as we get
slightly less stuff head quick spec
knows about bottoms quick specs should
know about bottoms old quick spec knew
about points okay quick spec doesn't
know about bottoms alright now we can
sort of go on like this and we can look
more at lists and we can play with lists
and and we can't play with with non
total functions in the motional quick
spec that I did this last time we did
one but let's look at some of Mary's
function from those functions from this
morning Ken quick spec really figure out
stuff about higher-order functions well
quick check notes about higher-order
functions so quick specs should know
about higher-order functions let's try
it and yeah so you see yeah it's the
standard stuff about higher-order
functions there's nothing funny going on
we point quick spike at it and after a
little while we find the difference some
of the definitions of fold and map some
things about function composition and
then eventually we find mat fusion
that's what rule number five right now
he talked about this this morning find
the definition of fold and then we find
fold map fusion so I don't know about
you guys but I think this is cool I like
finding things like this I especially
like doing it without having to think
which are the fold fold fusion or the oh
right right right right right right
right yeah so you're given that yeah
yeah so this is a sorry yeah
so that would that would require having
to come up with a name for a function
that has some other property right and
quicks like only finds equations now so
if I what I could do is add that as a
predicate H is a function which can be
pushed through G like this and I would
have to sort of somehow decide find you
know find a decision procedure that will
give me that but otherwise quick-strike
will not synthesize these kind of side
conditions like that so it's actually
when I first looked at at grants paper
and I thought okay well I better get
these things in the quick spec demo and
then I realized this exact limitation
that no I can't make it just invent
things about an auxilary function I was
very sad and then I found that it can at
least come up with this formulation of
the tuition law all right
right yeah so that gives me an
opportunity to talk a little bit about
how the more clever things in quick spec
work so what-what quick spec does it
basically is that we come up with terms
so a left-hand science of equations if
you will we come up with a term and we
see Oh can I prove that this term is
equal to some time I've seen before
given what I've already discovered right
so if I find associativity if I find the
term say we can write it down if
composed with G composed with K composed
with H if quick spec sees this time it
will say ah I know things already about
function composition because I found the
associativity of function composition
let's see if I can rewrite this term to
some other time I already know about or
if I can prove that this time is already
equal to something else and in that case
it will prove that this term is equal to
another term it's already seen which
would be F composed with G composed with
well G K H I just say oh and also I
should actually clarify that what it
does is when it finds the term if first
tried to test it against or first try to
prove it see if it's equal to something
else then if it's not equal to anything
else it tests it against all the other
terms that it already has if it's then
still not equal to anything it just puts
it in a pile of things which are not
equal to anything so what would happen
here is that we'd find the first one
we'd try to prove this equal to
something it wouldn't be we test it it's
still not equal to anything
we'll put it aside and then when we come
across this time
we would say ah I can prove that that's
equal to the term about that make sense
I'm not sure if I should take silence as
a yes or no but I'll take it as a yes
the details are all in the paper they're
always all in the paper all right we had
a question earlier about very very big
signatures or lots and lots of functions
I can actually show you one of those
signatures huge lists huge lists okay is
that I think it was you who are strike
that's what you count that that's a lot
of functions right this 33 of them 32 32
lists functions well not all this
function some of them are like this for
instance 0 and stuff like that but a lot
of lists functions let's see what quick
so I can do it just happily sort of goes
on printing things finding equivalences
and so so what we have here is that yes
it's happy to find things under hers on
the other hand it's finding a lot of
things and that may or may not be what
you want right so you had a more
aggressive way of tuning the number of
things that you that you consider if you
if you are even better at figuring out
before you consider something that ah it
must be equal to this thing I've already
seen that might find some things which
you know there might sorry the other way
around
that might be too aggressive and might
hide things that you don't want that you
want to see whereas if it's if it's not
very good it won't come up with too many
things so it's a fine balance to strike
there from a usability point of view
it depends entirely on the problem
you're attacking yes yeah right
so if quick spike when it's doing is
testing finds a false positive because
testing is is unsound it will then
consider this a true fact and we will
say yeah definitely that that's an
equivalence and the funny thing when you
do that is that you get some amazing
output hey Rick slick starts coming up
with things which has make no sense
and this is a problem actually
especially if you want to do one of the
applications we have four quick spec
which is using it in a theorem prover so
where we have Isabel which is an
interactive theorem prover the use of
writes is that his or her definitions in
Isabel Isabel then takes these
definitions and gives them to quicks
back quick speck finds a load of
equations that it thinks are true and
then it tells Isabel hey can you try to
prove that any of these are true and
then if you get unsound things there
which is about people right a lot of
strange programs and sometimes you know
they're not the easiest to test then
yeah sometimes you will get very strange
results in the theorem prover up there
but most of the time most of the time
quickly is great for working with the
theorem prover and we can automate all
sorts of stuff including stuff about
infinite structures right so learn who's
sitting right here
did her MVC thesis on this so take a
limit we can go on and week I can let
this go for four months probably
yes you might want to tune the order in
which you consider different terms in
order to get more interesting terms
before the ones that you've already got
them quick smack by default will just
print everything it comes up with will
happily just print along and say well
this is I know this and I know this and
hey here's this and sometimes that will
even be too good it will come up with a
load of things which are not very
interesting and then it won't find the
interesting thing and you sit there
scratching your head scratching your
head and then you're up but it can prove
this interesting thing which I wanted it
to come up with from these four or five
other things that came up with before
right
right so if you want to generate a list
of property sweet rights so that you
would have to do yourself you'd have to
go through have a look try to figure out
what is what is sort of the fewest
properties I need here and actually a
PhD student in York called well he's not
a piece he's a he's a PhD now from York
did wrote wrote the Haskell tool which
would do exactly this it will take a big
signature of properties and will try to
figure out what is the minimal set of
properties and that's called John okay I
have no idea what it's called he's
called Rudy anyway and he's going to be
very crossed with me for not remembering
the name of this tool all right now
right now we have a few different things
that we could attack how much time have
I got ages
it's a shame I can't lock the door I
mean how many people are at Phil's
keynote as Phil what's up Phil skin
right that's good Phil raised his hand
Phil talked about categories and one
example of a category kind of if you
squint is Haskell functions and so why
don't we we try to find some of Phil's
laws using house or using quick spank so
the first thing I'm going to define is
Phil's angle bracket operator you
remember this for product F G like this
for for taking a thing and going from a
C to a times B well here's the secret of
what's going on in that function it
takes C and it applies F to see it
applies G to C that's how you should
think about it well that's how I should
think about how I think about it and
everyone should think like I think is
then the world would be a great place
right so so one of the the other things
that we took that Phil talked about is
the identity function right we know
about that goes from a to a it was
composition written backwards here so B
to C A to B A to C so well I'll let
quick-quick spec show you the definition
curry which takes a function from a pair
to a c2 to a function from A to B see
first second and then this funny
composition operator funny pairing thing
all right
everyone okay with with these things
they're roughly what phil was talking
about on yesterday
great you will look absolutely
bewildered some of you look cooler than
other people look like they're bored so
so please if you are bewildered tell me
all right well wrong clicks back and
quicks that comes up with a load of
stuff holy cannoli
as let say I didn't know half of this
stuff okay well that's enough quite
enough right so idea of axis is X
obviously and then here we're finding
fill floss about composition F composed
with ID on the right is F F composed
with ID on the left also F function
composition so f f composed with G is f
of G of X F of us G of X right anyway
and then F composed with first on X is
step four first of quicks back you know
that that's a bug I should show you that
the the difficult incomprehensible once
it's ending you won't be able to spot
the bugs so what's this oh yeah
seventeen is a fun one this one had me
somewhat bewildered curry first of X can
post with where F on the right hand side
is equal to curry first of X and then G
what
okay let's see does anyone know just off
the top of their head why this is number
seven oh crap oh no it's at the top
curry first of X of Y is X curry first
of X is Const what but yeah curry first
of X is Const and that makes sense right
curry should take the two things in the
pair and then with the a and the B and
we throw away the be in the para so we
should throw away the be in the type
here of curry eight yeah 11 right first
of was it this one fair enough say that
again
all right is equal to H two
possibilities one is its finding it
second is one two three four five six
seven it might not actually have been
done looking for terms so we can run it
again and see if quicks like fine sir
right
how can you find equations between
functions sorry say that again that's
right that's yes and no quicks but can
discover equations between functions too
right so and that's just testing the
functions for extensional equivalent so
it's just if we apply this function to
stuff do they always return the same
thing if applied to the same stuff
let's see has it found it
or is there a reason why we're not going
to find it yeah that's that's entirely
possible that it follows from from
something we already know I mean it is
finding things which look them like it
let's see maybe that seems completely
pointless to me no you not that I that's
not an option we have in quick spec we
could have it I guess there might be a
point to doing it yes you're absolutely
right
right yeah I mean that could be a fun
tool right there just a tool which
rewrites my stuff too pointless stuff
why doesn't 17 follow from seven that's
a good question actually I'm not sure
hmm
yeah that's that's what we call a bug so
it might actually be that that 17 follow
it not following from Phi this is or
from seven it's also a bug actually I am
gonna have so much fun debugging this
that that has to do with how we
instantiate polymorphic types or every
bug you find in quick spec has to do
with how we instantiate polymorphic
types and that's all I'm going to say
sorry right this is exactly the problem
so quick spec should have already
figured out when he sees that you should
figure out yeah okay that's an instance
of the one above but what were what was
quick swag is doing I think it's finding
it at one polymorphic type and then
improperly instantiated if ER entrada
morphic type for the for the one after
and not realizing that they unify in one
way or another yeah we can do that come
which is some curry dollar right and
that would be a to be come a to be
parrot Risty tells me that yeah it's the
only yeah yes parrot wrist he talks
about know why isn't it doing that
it might actually be that there are no
interesting laws for apply of the right
within this size bank yeah time says in
a yeah right times us in times 2 times
is in pairing operation the this times
the F wait F G a B F of a gob and this
has type A to B to C to D to a comma B
to C comma D right no doesn't that's a
complete lie yes obviously
oh this is a B that's a B all right
finding all sorts of things we might
have to keep running this for a while
is this a lawyer you wanted Phil we're
not quite yeah
no because the application that we're
doing directly is of this type right
whereas the apply function had this A to
B a B type should we should really have
that yes let's see if we can find out
there's this just not quite it oh well
yeah so what you're seeing is the
problem we're seeing is that eventually
quick specs sort of as terms get bigger
and bigger the number of terms that has
to consider before it actually finds
anything interesting also gets bigger
and bigger 31f composé yeah
that's a yeah that's funny oh well yeah
it might be that the sizes are very big
and that it has to go up to size 10
terms before it starts finding things
like that but I didn't think so yeah you
can find a quick speck on github and
then you can fork it and stare at the
code come up with something and then
change the code send it back to us and
then we'll be very very happy and if I
see you I will buy you there which may
or may not be what you want depending on
how much you like me but yeah
so the the primary one released they're
improving because this helps speed up
inductive their approvers buy a lot
right in the examples where it works and
then it doesn't in their compass where
it doesn't work
another replication is just you find a
library you don't quite know what it
does so you sit down and play with
quicks back you sort of you have an idea
of what should hold just as if you have
a library you don't know what it works
and you sit there under play with quick
check you have an idea of whom this
should hold with quick spec it's more of
a more of exploratory processes hmm this
should really work this thing might be
equal to that thing let's see what if I
put them both together okay no they're
not quite equal but this other thing
holds instead with quick check if you
wanted to do that you have to sort of be
right from the onset from the beginning
and if you're not right from the
beginning you'll get a counter example
which you can then use to get slightly
more right as a bar nothing about Korean
apply oh this there I have lots of hours
to spend trying to debug this so yeah oh
you know if it's about it might also be
that there are no interesting laws
we could we can't now but we should be
able to in effect that is what the what
it does when it's in Isabel right so
when it's a Miss value you just press a
big button and it's about girls often
does everything in the background so yes
if you're an Isabel programmer know if
you're a school programmer which is you
know but there's nothing fundamental
stopping us other than time constraints
right
I think I'm low on time now have a
suggestion because I mean difficult
position because my duty as a track
horse is to watch the clock and on the
other hand I see you some of you guys
are obviously having fun with it and
would like to proceed
so let's officially close the talk
finish it and then whoever wants to stay
the room is not needed anymore there are
no any more talks so we you can you can
stay here for another two hours if you
like so so let's give a Maximilian a big
round of applause
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>