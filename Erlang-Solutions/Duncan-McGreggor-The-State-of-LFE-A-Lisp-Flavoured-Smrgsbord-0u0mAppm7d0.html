<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Duncan McGreggor - The State of LFE: A Lisp Flavoured Smörgåsbord | Coder Coacher - Coaching Coders</title><meta content="Duncan McGreggor - The State of LFE: A Lisp Flavoured Smörgåsbord - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Duncan McGreggor - The State of LFE: A Lisp Flavoured Smörgåsbord</b></h2><h5 class="post__date">2014-07-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0u0mAppm7d0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I was actually going to show you the
startup of this but I don't want to
waste time this is actually a Yas
application using s expressions for
generating HTML but the proportions are
off sorry about this it's a widescreen
format just there we go okay speaker
notes alright so as stated my name is
Duncan MacGregor by a day I am an
engineering manager at Admiral by night
of an l fe hacker and community
contributor this talk was originally
going to be about a sorry you rerun of
the talk given in San Francisco and then
sort of touching on some of the
deployments that you can do with LFA
some folks were actually using elephant
production however at the airline
conference in San Francisco Robert and I
had a fantastic fireside chat and he was
really excited about the things we could
be doing in LFE and we just hatched out
a massive list of things we wanted to
tackle you know optimism was everything
we didn't really think we'd actually be
able to get to each of these and we in
fact did so so much has happened in LFE
that that we figured hey let's change
this presentation and and do a a state
of LFE it'll is flavored so if I get
this right motor Gus boat close okay I
apologize here's we're going to cover
you give you a brief introduction the
latest developments in LFE proper a
quick language tour for those unfamiliar
with LFE i'm going to highlight some of
the more recent projects that have been
done in the community and i'll share
with you evidence that LFE is not in
fact an island and then we'll wrap up
the session as you can see this isn't
just a status report on LFE or the code
base rather i'm sharing glimpses of the
many things
happening inside the air lang micro
community that is LFE it's a community
that supports airline beam languages
directly through its own work and
indirectly by encouraging the
exploration of other languages and
features in our ecosystem okay oops I
think I skipped a section here there we
go why Lisp in this section of the talk
i'm going to talk about some of the
basic reef basics a refresher for those
familiar with lisps or a gentle crash
course for those who have not
encountered them before one of the first
questions that's asked of lisps by
people coming from either see style
programming or Python some programming
that sort of things why why a lisp this
is often what you see is the classic
example to avert any possible panic from
this I'll talk about in a second but
this is actually an excerpt from the
Lisp 1.5 manual 1962 was when it was
published and as you can probably
discern the code here is defining set
operations where your sets are defined
with lists and to set aside those fears
here is what this looks like now this is
a preview of the typical list code you
will find in this presentation and if we
wanted to provide set sets that were
implemented with lists as opposed to the
sets that are available in the airline
standard library this is what the code
would look like we've got cons Ain
pattern matching in the function heads
the airline lifts modules being used
lowercase letters hate syntax
highlighting this is not the list with a
1.5 manual it's a new world born three
years after the death of any arc Lisp
has been with us from pretty much the
dawn of computing due to the hardships
of the AR winter Lisp is whether some of
the greatest social difficulties a
language could withstand part of this
reputation is due to this the the
consider kickback that it received due
to its dead simple syntax small number
of core forms home iconicity and macro
system one can accomplish that speech
feet as writing a compiler in the
morning or a DSL in the afternoon
but the real reason you'd want to choose
a lisp is it as the language of the
universe and what we just ignore the
last section of that I chopped it off
familiar with the comic okay you may say
you've talked me into playing with Lisp
but why Lisbon airline you now have easy
access to all the power that the springs
combined the cotp but it's more than
just that it's about what you can do
with these two together referencing the
great work of Garrett here lisps home
iconicity and macro system coupled with
Airlines fault tolerant and distributed
system capabilities it is the perfect
language lab for the multi core core
world turns out that we weren't the only
ones doing it during the same time
period we had stuff from Haskell to the
JVM and of course LFE everybody was
implementing their own Lisp on on their
various language platforms list scale is
the one yeah and Haskell this was the
beginning of sort of a renaissance for
Lisp you find that pretty much every
project now language has an S expression
variant that they've they've got pushed
out it's it's just a simple thing to do
people were just loving it while it's an
air laying there are several reasons for
this diversity brings new ways of
thinking and new discoveries increased
options for the airline vm bring more
programmers to the community you can
witness all the things having with
elixir jock so air log laurel concurrent
schemer i'm not sure how much progress
they're making though living by these
principles ensures the wider success of
the airline vm more people benefit from
the excellence does airline alright so
latest developments we've got lots of
stuff you to share i'll try and get it
in this is what's been happening LFE we
now have maps this just recently landed
roberts working on some of the fine
tunings on this the the syntax we might
be looking at some of the function
definitions for this might sneak in some
common less
forms it's now possible to define
functions and macros in the repple this
is huge so one of the things we've had a
couple of closures come closure
developers come to us and say hey the
thing that really sucks about air long
is you can't actually you know define
functions and macros in the in the
repple it's not really a rebel and we've
got an answer for this in LFA now you
can you can do this you can do full
development almost full development my
development life cycle and the rep one
just we've got plans for Roberts got
some really great ideas about spitting
code out and generated modules from
anything done within the repple which
would be a super super cool feature
strings are no longer need to be quoted
that's the single quote that precedes
the actual double quoting we've got a
new syntax that's more familiar for most
folks how many from airline with a mod
colon funk prog one Prague to from
common lisp we got a new fields name
macro that makes it much easier to
interoperate with manisha and define
your various fields we've got the common
lister style multi-line comments I just
started using that and we've got
improved handling of hurl files this
allows us to do stuff with E and it down
that we couldn't do before a bunch of
new example codes that we've got in the
example directory joe armstrong's
favorite programs in there now which is
a delight to write in LFE got a bunch of
new sites new subdomains starting to
organize things better so that's not so
confusing for newcomers ported the
programming rules and conventions from
erilon to LFA that was a trip also the
common list style God that ITA
originally worked on and that when they
were acquired by google google now
maintains that document so we've got a
an l fe version of that lots of new
documentation in progress line of lisp
somebody's actually working on land of
bliss Piniella fee which would be a
treat and there's some nice java interop
stuff we're working on the current work
that hasn't landed yet there's some
really cool stuff that Roberts doing
with scripting we're looking at eating
go legs launched here um this will
actually make it much easier to use the
systems programming language
um got standard new stuff for a
potential standard library we're
thinking that probably is going to land
in some form or another will actually
start maintaining some library files for
LFA and some really exciting stuff for
more poking around with air Jang where
we might be going and we'll see I really
am quite curious to see what we can what
advances we can make with supporting
types in LFA and if we can't get the
stuff we would like to see in the in the
beam files Roberts got some pretty nifty
hacks planned and i might be pushing for
those so we can get us sooner than later
um against air library we need to start
getting more stuff landed for that
improvements in LFA internals Roberts
but Roberts been looking at reader
macros maybe anything else there yes at
one point oh it's where its eminent any
day now we're not really way to any one
thing it's pretty much when Robert wakes
up one morning flips the coin in its
heads the docs roadmap the things I like
to point out here actually is the
cookbook and I might actually combine
the airline idioms and cookbook into one
so the cookbook would show you what it
looks like back and forth and I might
reach out to the elixir folks and see
about doing a three away on this in this
particular thing i would like to
complete the java interrupt
documentation because this could be very
compelling for bringing new folks on
board and of course finished in the user
guide there are several projects that's
that i'd like to highlight here i'm
going to go over some of them in detail
later in the talk but but and some of
them parenthetically that i've noted
here but before we get into that i'd
like to give you a quick review of LFE
itself and here's we're going to cover
in the review of LFE and a very gentle
crash course
that wasn't planned LF ease origins are
humble but in the best sense of the word
i was born on Roberts laptop 2007 and it
was a writ initially released released
in 2008 and by the way in 2007 that was
actually when lascala was released to so
the timing on this wasn't you know
Robert wasn't saying hey closures doing
this and let skills Haskell's doing this
it was just the alignment of the stars
everybody was doing it the intent was to
modify the particular Lisp that he felt
like creating to suit the airline vm and
not vice versa not just throw a lisp on
top of the airline vm he wanted air lang
with the lisp syntax and you may wonder
what caused robert to do such a thing i
did and so i asked him and here's what
he shared he was curious to see how a
list would run and integrate with
airline he wanted to explore generating
correr length this is a fairly new thing
at the time plugging it into the back
end of the airline compiler he likes
implementing languages I thought it
would be fun to fun problem to solve as
a solution would be comprised of many
different parts of the problem space and
it was quite open ended and i kind want
to highlight that i'll come back to a
little bit later but the fact that this
was born of of fun and experimentation
is key no mutable data the standard
stuff i actually took these guys from
some of Roberts early slides on LFE same
types as airline modules and functions
like everything you're used to data
types here's we look like four numbers
and I'm if you can see that very well
but there you can see how some of the
bases are defined atoms and strings
atoms are sick or preceded by a single
quote and if you have spaces inside of
them you can just wrap them in pipes
there's some example of the lists and
various operations on them we have car
and cutter we also have to deter and all
like although the combinations that are
you can find in the list Piper spec
Common Lisp
respek tupple usage pretty standard here
and you can see we're accessing the
Erlang elements to get the pieces of it
records is how you define a record and
you can see with a set forward and the
make person is an actual macro that is
present anytime you define a record in
whatever context you're doing that you
then have access to a whole series of
macros that the provide access to the
various operations you want to do on
them and so making a person and then
getting that person's name setting the
person's age and all the operations you
can do on this as defined by the the
fields that are in this particular
record the record name oops sorry about
that ok maps again just landed here is
the new map syntax um pretty
straightforward it's probably good I
think this is the right order yeah we're
going to keep it with a map map first
and then I'm sorry keys first and then
map and then here is this is one's going
to change probably use the same ordering
but maybe offer some aliases this from
the common lisp okay here's a neat
little part that is fairly new and like
I mentioned before something I'd like to
integrate into a cookbook and this is a
comparison between the airline idioms
and the LFE basic pattern matching no
big surprises here list comprehensions
this one's a little awkward in LFE i
tend not to use it i tend to use the
more functional approach with a map but
but yet so it's available for you should
you choose to do it and then sometimes
it'll be easier to translate guards
again similar thing very straightforward
the or else there can be used to do the
series of checks like Don what else we
got here con zing and function heads I
overlooked this initially as clearly
stated in the documentation that Robert
has provided but you see past my head
there there's the the cons in and the
function
um and I've begun using this great deal
this one was tricky I've had to do a lot
of conversions from from various airline
projects to LFE and getting the the map
map map oh sorry record matching the
function head has been and fairly anti
intuitive because it doesn't look like
airline at all I have to use the macros
but once you do it's it's quite easy and
there you can see sorry the using the
literals robber and I've talked about
whether we say we use literals or tell
people to use the constructor forms and
we're both experimenting with what it
looks like in the documentation if we
use literals receiving messages this was
one of the things that actually
initially really won me over to tell if
he was how clean it was to to write the
message passing bits and some sample
code now that the idioms are done dot
product very elegant implementation tail
recursive factorial sorry sorry I'll
back up here can you see over my head
there oh yeah and partial function
application and the repple
and it's the first part of the ring
benchmark module this is the one that
was taken from the the one that hosts
hosted on debian org and there's the
second part of it pretty standard and it
performs almost identically to the the
airline one a purely one so at the risk
of leaving dear mr. Baggins with
questions unanswered and with our rule
rule Wintour of LFE behind us we can now
highlight some of the interesting work
currently going on in the LFE community
and that is of course the ring benchmark
behind okay these are some of the
projects I'd like to cover quickly
there's more but we didn't have enough
time and I barely gonna have enough time
for these the magic word this was taken
from a presentation that's I'm not the
originator of this I did laughs and I
saw it though I'm going to say it again
mo dad so the first project Calrissian
it's brand new it's inspired by the amp
ere laying I'm sorry the Orlando project
only supports one monad so far and I
haven't actually given to it I've just
run the example there's a couple that
I'd like to add to it it's a project I'd
actually wanted to create myself and
somebody went ahead and did it at in the
community which was fantastic they beat
me to it here's some example usage of it
um I don't know enough about monads even
really talk about it
here's another example another community
sample that was recently given to us was
someone that did an Eli integration with
LFE and apparently I haven't tried Eli
at all but it allows you to run a web
server and service inside you're inside
your project itself very cool stuff I've
done a lot of work with Yas love yas
grand dad that's still cranking out the
hits and there's a bunch of projects
that actually LFE tool generates a bunch
of Yas projects and here's an example of
a bootstrap Yas project skeleton just a
single command and bam you've got your
bootstrap project using s expressions
like this in your HTML this is actually
from this presentation this is the index
generator for this presentation lots of
links I've got references in the back of
the slides which i'll be publishing and
say all the stuff you have access to it
from there LFE tool t-shirt this has
just been fantastic for generating a
very similar to elixirs mix generating
projects installing stuff one one-stop
shopping I'm going to skip over the lot
of details here we don't have enough
time oh that's we a the Copic coloring
for the run test runner and cleaning
that up to make it actually readable was
was a big thing that was inspired by a
ruby project they did something very
similar to that it's pretty nasty
hacking of terminal colors but it's
worth it this is my new favorite pet
project jl fe that's fully experimental
we'll be diving into it shortly it's a
lot of fun to work on I've done a little
bit of work with closure and so this is
a dear to my heart and there's a quick
sample usage but again i'll be going
over this in a few minutes alright so
this is the next section for the
smorgasbord and it's the various ways in
which you can interoperate
with with other parts of the the beam
and outside the beam communities airline
vm we're seeing a renaissance and
there's a lot of languages that are
working with errol nvm really good stuff
going on here gay interface that's
actually it was a lot easier to work
with than i thought it would be so
there's there's really really great
stuff we can do so with airline itself
it's a no brainer this is it really you
this is the original sin tax was the
colon mod funk we've now got the mod
colon funk that's all you need that's it
that's integration with with airline
itself Ella fina licks here almost as
simple all you had to do is add it to
your depths in your rebar config file
and then do your your make get depth so
this is assuming you've created a
project with LFE tool make get depths
they compile and just run it with
pointed to the right to e bin directory
when you do that you get dumped into the
the ripple
and and this is as easy as it can be you
in the elixir you don't have to actually
reference elixir dot it does that for
you implicitly obviously you have to do
that in LFE there's a little bit extra
typing but but you can use elixir code
seamlessly and one of the nice modules
there the streaming stream module I was
a good example for that um I haven't
worked with any of the built-ins that
elixir provides I don't know what that
would be like in LFE I haven't played
with the protocols at all but these are
both things I want to work with them and
check out their unicode support this one
was fantastic ok so the jLF e is totally
experimental it's a wrapper around
around air Jang and when I saw Kristen's
presentation at the Ealing factory in
San Francisco a few months back I said
hey I'm super-excited about this I'm
going to dive in and try some stuff out
and so I did and made a lot more
progress than I thought I would I
thought is going to much much trickier
just a few as a single maybe guest two
patches 22 LFE one to make up the fact
that some weird string parsing problems
between LFE and air Jang and the other
just basically to get a elephant to
support syntax that can check for a Java
form so I'll show you some examples of
that there's still some outstanding
issues constructors can be tricky when
you pass parameters yeah ctrl-d when you
quit out it gives a very crazy trace
back but here here's some of the the
example code on the top part is just LFE
and air jang directly and you can see
the calls you have to make fairly
awkward and so the macro changed
actually I guess this macro parsing
changes made an l fe allow you to
shorten that very similar to similarly
to what you would do with closure you
don't have to do the full full path for
java dot lang calls
again calling cause how you access
constants basically just it's you're
still doing a call-in LFE even though
it's not what you would do in Java but
you just override the behavior and do a
couple of checks and if it doesn't end
up being a call that you can actually do
a static check and then get it in our
case constructors with the with the new
syntax constructors are dead simple
again use your skipping all the crazy
stuff from from air Jang I can't use of
the dot form it's an illegal character
in common lisp and their foreign LFE as
well so we're trying to figure out how
we can actually do instance members will
see some experimentation to come but you
can make this call right now and an LFA
if you want to get it types can be a
little bit tricky when you get the types
back from air jang it's actually a
representation of a java objects to
proxy and so you don't actually see a
value so there's a utility function here
to actually get values for you and you
can actually program like you would an
airline areas to explore some law all
kinds of stuff to do i'm not gonna go
over this in detail LFE enclosure so i
got that far as I hey what about
actually closure itself and J interface
of course with the right answer and so I
created a small projects and I take it
back i ported a project from from
someone else that was an airline closure
project it didn't work so I had to get
it working first then i ported the
airline parts to LFE and documented that
and what this project does is it creates
two nodes a one enclosure one using j
interface and you send messages back and
forth very simple but based on that you
can do a whole whole series of new
things anything you would DJ interface
but it's nice to have some function
actually functioning code up and running
that you can try this with get clone it
get compile make repple dump you right
in there and then you can start the
application just like you boobs any
usual OTP app
it's actually making a system call to
start up java in the shell and so it's a
little bit awkward there I don't know
what other options might exist for that
but then you can send your messages to
the process you just started and and
then when you flush the shell you can
you can get the responses back and it's
basically here's the notes on bed said
earlier message sent back and forth
between the nodes and then you get that
response back to the LFE repple I would
love to do some experiments with number
crunching maybe some machine learning
see what that would look like it'd be
good practical application for this
especially if you've got a diverse
environment at Admiral we've got Java
and an airline both being used
extensively and they're very often
conflicts in the planning sessions and
this might be able to eliminate some of
those okay so here's what we covered and
before I do the full wrap up I'd like to
tell you more highlight more about what
what else he really does give you and
why you might want to use it with just
these you have all sorts of power at
your fingertips but it goes beyond that
we have access to all the works in the
beam community and we can fairly easily
translate decade's worth of Lisp code
that is available and I have done this
with several projects other word any
universities for hierarchical task
networks machine learning type things
artificial intelligence and we have so
many different ways of interoperating
with with you know other parts of the
programming language world including JVM
and all of this with the best actor
model in the markets and the power is
mind-blowing to think about it but with
great power you have great
responsibility
computing had its beginnings in the
darkness of war any act was built
specifically for calculating artillery
triet trajectories Johnny von Neumann
got involved and it was used almost
primarily and mostly on the manhattan
project itself and there were various
idealistic reasons for that but it's a
fairly terrifying thing to think this is
where we we have our origins and here's
the later spider-man quote in contrast
that heaviness though this was created
to explore intelligence error Lange was
created as a in a playful manner to
explore reliable systems LFE was created
in the same playful spirit that was
upheld at ericsson CSL so this is a very
wonderful contrast to where we started
with with programming in general i found
out that actually full tear this is a
misquote he didn't actually say this i
searched through the documents online
and could not find evidence despite
everybody saying he did as socially
responsible hackers we need to remember
the power of our tools it's easy to
forget and it's in the excitement of the
moment it's also easy to forget when
we're frustrated at a job this is
actually very similar quote this might
be the original source most most worthy
of power is the one that knows the
responsibility it's the translation
we've got OTP and Lisp macros we don't
need to worry about what's going on with
governments and what they're going to do
with stuff we can make mind-blowing
software that actually helps people can
rewrite our own history and i would like
to quote katie hear from our talk the
other day in the spirit of using our
powers of mind for good this view
perfect is perfectly stated it's a
wonder wonderful example of the high
standard to which we need to hold
ourselves I'm just going to read it out
loud I think we should care because we
write programs for the whole population
and we should have a fair representation
of that pop
in creating these programs the
technology we produce shapes our world
in our future and we want it to be
shaped in a way that reflects the
interest of all not just an empowered
for you and that's that's it perfectly
and that's again why I emphasized how
LFE was created it was with that spirit
of fun and play of exploration and
that's what drew me to LFA and that's
why that's why I'm here so that being
said thank you very much here's some
contact info and I can take questions
we've actually got Lautrec right
I wouldn't know about that stuff I
haven't actually played with the elixir
protocols we don't have an
implementation of protocols like like
closures but I'm fairly curious about
that have a friend who just they just
got their first round of funding in the
startup and it's a closure startup and
they have had huge success with using
protocols to ship features in record
time and so i'm i'm curious now that
i've got a real real nice case case
study to base that on anything else
exactly yeah absolutely no changes no no
monkeying around yeah robert
specifically did not want to do anything
crazy with that yeah which I actually
was fairly dismayed at originally
because I've become a pretty big fan of
ASDF and all the package management and
Common Lisp and I got over it anything
else alright thanks again folks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>