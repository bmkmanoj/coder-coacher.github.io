<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Konrad Szydlo - Creating reactive components using ClojureScript React wrappers (Lambda Days 2016) | Coder Coacher - Coaching Coders</title><meta content="Konrad Szydlo - Creating reactive components using ClojureScript React wrappers (Lambda Days 2016) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Konrad Szydlo - Creating reactive components using ClojureScript React wrappers (Lambda Days 2016)</b></h2><h5 class="post__date">2016-04-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4lfJ0FVa6Zg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">can you hear me this
minus and it will be evident soon if not
I'll just yet I spell it out for you
just a show of hands who uses react Jas
closure script okay who's seen a no but
talked just before okay I guess it ty
it's quite nicely with what he was
saying in some thoughts or for those of
you who haven't seen at the talk I'll
explain things father so hopefully it
will so solidify what he said and I will
expand in few bits and sharable
practical of results so as i mentioned i
work for with Alec it's a company that
helps retail to draw business
conclusions from custom behavior and
develop software what it means that on
top of building web applications and
apps we also do some data analysis
previously I worked for scar UK it's a
multimedia company in the UK it's a big
company although I worked in two
different environments both of them they
are similar in a way that it's really
important to choose your tools wisely
just the impact not only your customers
but also you as a developer or projects
that you work on and I believe that
react and closure script and the
technologies that we use enclosure
script with react are really good and
would help you in a lot of cases to
build pre performant websites because
nowadays most of the applications are
fairly large partly comes from the fact
that we have to solve more and more
elaborate problems there's lots of
browsers and devices ranging from wide
swing desktops food tablets to different
mobile phones and whenever we develop we
have to create applications website that
our performance and combined
of resources in 90s late 90s we could
use just JavaScript to create dynamic
content on our websites but as our
application started growing large we
started having problems so Jaguar was
invented they help unfortunately wasn't
discovered so it gives you a hint it
showed us ask from some browser quirks
and in consensus this is so good start
building large applications but it led
us to what was called jQuery soup so we
move to MVC different frameworks like
backbone or knockout they give you nice
features but there are trade-offs and
they come with their own set of problems
in 2013 Facebook released its own
library called react Jas and really
quick it gained momentum and attention
ed developers community but what does it
mean to be reactive it is a nice stock
but Eric Myers what does it mean to be
reactive and if you watch the talk you'd
see that there's a lot of definitions
and people have got hard time just to
agree and by the way all the resources
that mention that at the end of at the
end of slides and the slides will be
available until on the internet so i can
easily check things out so for our
purposes we can say that components
reacting to events and changing and our
changing states or Vittra definition of
reactive programming in this context so
let's have a look at an example where
we've got a list it's fairly standard in
web applications or websites if I want
to add a new item the question is how
can I do this so the solution number one
would be to insert a new item and this
is a follow-up question work and I do
this how can I find the right place to
insert
this new item sometimes the order
doesn't matter sometimes sometimes it
does I or the solution number two would
be to throw out the entire list and
rebuild it but Randy when rendering
large-scale amounts of Dom is really
problematic most JavaScript frameworks
would help us to mitigate problem number
one are they by making them easier to
navigate or by tying elements to
controller that keeps keeps it up to
date we are Jess on the other hand
solves problem number two we act
provides the virtual Dom two versions
and whenever you make a change to your
component it will compare a previous
version with a new one and only make the
smallest amount of work to satisfy the
changes and update Dom because returning
to we render all page of a component is
much cheaper than doing whole swapping
and we rendering but for us programmers
it's easier to reason about is change
reacties often described as vigne in the
MVC model and because it provides an
interface to changing data and you can
use it with different frameworks like
angular and a lot of people have done so
successfully react uses flux
architecture where we've got one
direction of data flow an action would
cause dispatcher to react and update to
store and manipulate installed cause
view to be rendered and further
interactions reviewed Gaussian is
partial to kick in and we will see this
pattern really clearly enclosure script
and its approach to using react but so
what's the problem with reactable most
of them you you have to use JavaScript
and
there's a really hilarious but
disturbing spring cast by the destroyer
of all software about JavaScript and all
its quirks it's really it's really funny
or not funny so to mention a few things
with JavaScript it this what does it
mean when its syntax it's Weaver both
confusing inconsistent operated
convention global variables and so on
and so forth so what's the so we know
the javascript sucks but we have to use
it it's almost everywhere and its
runtime is improving a lot of
interesting technologies are coming out
data associated with JavaScript so it'd
be unwise to just let it all go so
what's the solution this solution will
be to build a better language on top of
JavaScript and a lot of people have done
so and one of such languages closure
unfortunately closures really difficult
as you can see one is too simple but
closure it slips and you know definitely
definitely too difficult for programmers
at least for a bridge both people
interested in functional programming or
more curious and that's what it takes it
takes a lot of curiosity to learn
closure square because it's just
different unless you are coming from
this if you are coming from all over all
other functional programming languages
if parenthesis might scare you but once
you start writing code and saying you
see how simple it is because closure
script it's a modern list it gives us
immutable data structures a clear
separation between between state and
identity identity it allows us to do
rebel driven development closure has got
a lot of interesting
ideas like transducers and also
libraries like co dot async so it's like
using a going go lankan closure just
live with it in mimics a language quite
mind logging say and a lot of more
things closure squid provides a
JavaScript Interop so you could use
react just from your closure code but
why would use tab and just do that
because react GS or javascript is not
idiomatic enclosure script and we
wouldn't be able to leverage he mobile
data structures the one rapper has got a
page were they compare performance of
view of we r GS and their wrappers and
because you can use imitable data
structures the code is more performant
faster but different wrappers enclosures
could not only give you give you more
idiomatic way too bright we actually
Scott but also they provide lots of
interesting tools that are not about
either not available in Rio GS or more
difficult to achieve and one of the
wrappers that I'd like to talk about is
RAM it's not a framework in a sense that
it forces you to build applications in
certain style and whenever you want to
do something that the office didn't
think about you a battling the framework
rom on the other hand is more like a
library where you pick different things
that you want different components you
can mix the match all depending on your
needs and other brothers that are
available in a closure script like on
reagent or quiescent they've got
built-in component behavior model
but run provides a two level API on the
lower level you define your component
and you render it so it's starting this
no havior a simple definition of a good
component requires a name you can add
some document strength description
parameters and obviously you'll run your
body so if I want to define h1 component
generic one that takes a text that's all
what it is and if I want to display it
on a page I'll just mount it and pass
some text to my component it's a simple
component it's not reactive it doesn't
care how you store your data and how you
interact with your component so it's
kind of boring so how can we make it
more dynamic and do interesting things
we would result you the second level
higher level of rums API where you can
where we can use mixings to control
behavior and the a few pre-build mix-ins
in RAM and they mimic the behavior of
other rappers that are available
enclosure script like on reagent we are
cool so if you want to create a
component you just extend our definition
to include optional make sense and T you
can add more than one mixing to your
component or depending on your needs so
one of the first mixing I like to talk
about is a static mixing it checks if
arguments that you pass to your
component have changed so we could avoid
rendering if arguments are the same so
going back to our h1 component
particular it is a static s component
using static mixing
and if I mount it first time and when I
pass some important text to the body it
gets mounted to dom displayed if i want
to pass it again with the same text we
rendering won't be triggered and if i
pass different text it will kick in the
rear ending so as we can see just by
using this static mixing we can avoid
rear ndering components where we don't
have to another mixing it's a local
mixing it provides per component local
state so let's say that we run a company
IT company and we've got a website on
our website there's a section where
customers can click and they can select
different services that they'll like us
to do like web development testing
integration and whenever they click on
the component it gets highlighted so
they've got visual cue what's going on
and plus the total amount gets updated
so if i wanted to create such a
component of defining this local mixing
and in this case i'll be storing a CSS
class and i'll provide on click behavior
it would just call a function toggle
clasp service in in this case and this
class would take a current or old value
and a service and i will be comparing
the class so if it was a active class i
just get rid of a class CSS class if it
wasn't i add active class so that's why
i can create interactive list another
mixing that run provides for us is a
reactive mixing it creates truly
reactive components the track references
to data
and this mixing would auto update
whenever T value stored changes and this
mixing works like reagent wrapper so
going back to our service example
whenever customer clicks and to the
service the total amount gets updated
and enclosure you can use closures it's
a pragmatic language so it's immutable
by default but if you need mutability UK
you've got some concurrency primitives
and one of them it's an atom and it's
often used to store data so in this case
I've got order form total waste or a
total I fold the order and i'll define
here i can define my total some
component and will display the total and
I'm Markus using react Rams react
function that I want to keep keep
looking at this value so whenever it
changes my component would update and
how do I make a change I make a change
again enough in my total plus I function
depending whether I'm the component
should be ready it should be active or
not I'll just increase or decrease price
from the total order and another mixing
that run provides is a cursor to mixing
it's similar to the approach taken by
own wrapper and it provides an interface
to sub trees inside an atom so let's say
that I want to store whole my whole
application state in a single in single
atom so in this case I'm throwing the
colorful header in my settings
and I've got a label component with the
take some color and text and if I want
to use this component outpost some text
and i'll pass the cursor to a certain
place in my global atoms so in this case
it's app settings headers and color so
whenever there's a change to this
particle place in my atom the component
will get updated there are certain
benefits of using this approach like
your normal where you've got one global
state we provide so Tomic swabs and your
applications always inconsistent state
going from one state to another fool
transitions regulations it's easy to
implement undo it's just the matter of
going to prove estate and you can
serialize your app so imagine that your
customer reports about audit application
crushed if you go to work to serialize
application stage and and your customer
can send it to you in your local machine
you can debug it and see what exactly
happened that caused a crushed your
customer but Rome is more flexible on
top of mixing said it provides you can
create your own mixing and it's just the
matter of using a reactor by lifecycle
methods like will mount should update so
on and so forth so if I wanted to create
a let's say scrolling mixing that would
scroll to certain page my page I'll just
use react lifecycle methods and in this
case i'm using dead mount method first I
check whether scroll before or not if I
didn't I call scroll function that takes
some bargain
and just say that I've scrolled you can
create other makes sense for example if
you use a google analytics and quite
often you have to provide different
arguments you can create a mixing that
takes those arguments you can plug it to
your component and you've got free or at
least CLS pain we're creating a
components with google analytics so it's
quite easy to build a new mix ins and
you can mix them and match in your
application so you can have a top-level
reactive component a few local ones
static ones may be a curse at one all
depending on your needs they are
decoupled as well probably the most
known um rapper closest reacts yes
rapper enclosure script is um it comes
from the fact that if it was created by
David Nolan and he's one of the main
developers behind closure script sort of
people that come to closure script and
want to use different Roberson on they
will in-close shipped out to use Alma I
mentioned some of your benefits of using
one global state but else sometimes it's
not the most optimal solution so I'll
explore examples were this model breaks
and I'll show you what we can do to
improve this model so in all the routier
is given a root cursor and it passes a
sub trees of cursors to each sub
components so if I've got a list I can
just say displayed and on the left hand
side yes on the left hand side you can
see my data structure and how it maps to
what I want to display so it's fairly
simple and easy what one relation but
what if you've got you I with some
cross-cutting concerns let's say that
you want to create a dashboard and knee
and you want to shrink or expand certain
parts in your dashboard plus you want to
save the presentation options in your
general settings with cursors girls will
point to certain certain place in your a
tub and you can save formation about a
certain item from a list in the certain
place in your autumn but if you want to
save it in general settings then you
start battling um and this principle of
using cursors because the curse oriented
architecture requires you to structure
your up that much as a tree edge
actually it's a UI 3 but quite often
your data are not a tree changing say
that changing a text items is quite easy
but what about deleting an item should
it be easy well it virtually depends
what you think that the delete option
should eat belong to an item or should
belong to a list if you think that it
should belong to an item you've got a
problem because deleting an item
requires list manipulation and your list
item is a child of the lists so it you'd
have to create two-way data binding
between your child component and your
parent so what are the solutions or
outsider to use run because it's more
flexible but if you read like Rome and
you want to use it one solution would be
to use up next which is a new version of
but actually it's a reboot it was
inspired by Facebook's will a netflix
Falkor cognate x diatomic and also the
experience of last few years so if you
want to display a date of purge
purchases for some item you would
instruct your data in this way where
you've got some information about
purchase and then you've got previous
purchases and you can see what is that
the strategy would be quite nice if you
want to display it on a page so if you
want to save your data you would use a
structure more similar to this way where
you've got recent purchases and you just
saw ID or your recent purchase and then
you've got another data structure with
information with actual information
about purchases that you did in our book
next component sleek define a quality
data that they need so those who we have
seen no words talk to this part way i'll
be talking about ideas that he talked so
pearl hopefully it will start ringing a
bell curse has helped to navigate a tree
why Corey can navigate a graph and your
data so I could if I wanted to find date
of previous purchases for some of my
boots and purchases I could quite easily
define such a query and it's not
difficult to understand just by looking
what what I want to get and possibly i
can get data structure like like this
that we really see to just display in my
UI so how will go how do we go from that
stretcher like this that i want to
in my data store to something like this
that I want to display in my UI with a
bit of help from you or the next can
normalize the data from the one that you
stole into the one that you use and how
does how does it do nomas ation let's
have a look at another example we've got
two lists and we can see there's a bit
of duplication between both lists so
let's normalize this and how can we
normalize it or if we help um and we say
that we want to normalize using a
product name we just define identity and
on dot next would scan our list infer
that it's the same name so it needs to
be the same item plus when you define on
the next component you can define query
as well so here I want to get a name
price and discount and just while using
a bit of code I can get such lists were
normalized lists were in my list one
into slag got the same items that I had
originally but it's this time just with
names and then at the end I've got
information about products for
normalized without duplication so in on
load next you can store the data the way
you want and you can convert it to the
way that makes more sense to your UI and
whenever your UI changes you just change
the function that converts so you don't
have to change it you don't have to
change the data that you store on door
next it's currently in the alpha stage
so it's a bit fluctuating but it should
be production ready in a couple of
months but if you don't want to wait
another solution you could you
use data script and rum because good
things come in purse and both of them
the way they were created by Nikita
broke up of data script is an immutable
in-memory database it uses data look at
a query engine data log is a logical
language some it's a bit similar to
sequel but also differs because it's a
logical language you can you can infer
different things it provides central
uniform approach to managing all state
and data script sits somewhere in
between relational schema and schemers
databases so it's not as rigid as
relational schema but also more
structured than a schema latitude have
in let's say I'm going to be CEO you are
normalizing the data that you store and
so if you want to define product name
you could give it certain attributes so
you could say that what its identity or
you could specify what's the value type
you could also say what's the
cardinalities either one many you can
create references between a different
attributes we can also add some optional
description as well so a simple example
of data log query what I want to find
name price and a discount would be like
this so all right econo he can see a
cursor so I want to find some product p
with certain attribute in this guy's
name with with a name because i'm using
? it works as a wild card so it would
much
any any name and I want to for that same
product and to find the price and also
discount and data log it's a logical
language so it will just yet scanner
data and figure out what's d what are
the entities that that it needs to
return and it's really similar to what
we did in on the text where we wanted to
find a lame price and a discount but
what if you want to find a specific item
not all the items that would match a
curry so here you'd pass name and in
this case name would be really would be
specific name that you want data log to
find and return information about this
product by name so how can you use it
with rubb like you know next to you
touch your query to your component so
when I define my product item it will
take a database and some name I embed
query that I want to use for finding
finding product and if I've got a
product I can render it with certain
details so you can write a components
that depend on the return values of your
voice so the nice property of rum and
data is Curtis said whenever your data
changes your components would would
update
and you can treat a database as a value
so in summary we r KS is really
interesting so if you haven't used it to
give it a go closure script is also
interesting and I encourage you to use
all try closures closure script and
using a reactor s enclosure script it's
really nice and you can create
components and websites fairly quick
this there are few rappers and it you
can use enclosure script to use react
you can explore you can explore them
they've got different properties are
different trade-offs okay are there any
questions any questions okay then Thank
You Conrad</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>