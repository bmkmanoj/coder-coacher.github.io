<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Erlang Scales - Do You?: Erik Stenman | Coder Coacher - Coaching Coders</title><meta content="Erlang Scales - Do You?: Erik Stenman - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Erlang Scales - Do You?: Erik Stenman</b></h2><h5 class="post__date">2012-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/40LGHTXEbsM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay imagine that you're in a company
where you actually have a business model
that works and you have technology that
works so you're growing your company's
expanding and expanding exponentially so
what are the problems that you're facing
them and what can you do about them I'm
hope I can give a sort of personal story
on what kind of problems you can hit
when you go from a small start-up to a
big start up because that's what we've
done at corner so in order to scale I
think there's four things that you need
to have you need to have the right
business model I'm going to tell you
about our business model but I don't
think that's going to help you that much
so we'll just go briefly or with that
you need to have the right technology
and since we're at an a-line conference
we will not talk about that almost at
all and you need to have the right
people so I will talk a bit more about
that and the right amount of process so
I joined a small start-up in 2005 I was
the eighth person joining the company or
the seventh person joining the company
and now I work at a company with 700
people and it's the same company it was
called Khadijah when I joined so this
these were the people working at
creditor in 2005 and see me there and
the founders and these were the people
working at
lorem which is the same company in 2010
so we have in the reception area we have
these pictures of all the employees from
each year I haven't updated my photo but
there's a 2011 now so so how did we get
there so the basic thing that made it
possible was of course a business model
so this is the secret business model
that was the start of the company so you
might not be able to see these secret
notes but the real secret is taking the
shopping experience and separating from
the paying experience so for shopping
you want it to be simple and fun and for
paying you want it to be safe so the
three words that we use that clone all
the time is simpler safer and more fun
and we use them as that simpler safer
and more fun not simple safe and fun
because we can always get better so we
always try to be even more simpler have
more fun and be safer so when you shop
all you need to know when you use karna
it's your name your birth date and where
you live most people notice at the top
of their head when you shop with a
credit card you need all sort of thing
you need a credit card oh no it's in my
jacket downstairs you're sitting at the
computer and you're going to shop and
then haha oh I what a hassle i won't go
downstairs and i'll buy it in the store
tomorrow instead so even such a simple
little problem with trying to get rid of
because you don't need your credit card
number you don't need a little box where
you type in lots of numbers and secret
codes
some things you only need to know your
name where you live and when you're born
and then you can shop so shop simple and
fun then when you pay that's a different
thing so paying and shopping is not the
same thing paying you want to do it safe
you want to go to your bank and use all
the security you can because you don't
want to give you away your money to
anyone out there you want to know that
you give them to the right person and
that the money reaches the person and no
one else is going to use your credential
and and pay so paying should be safe so
this is the thing that made clone a
success we separate shopping very easy
you come to the site and this is what
all the shopping sites want just
everyone coming to the site should
finish their purchase and do the
shopping without having to worry about
the safety of pay and fortunately this
has been a successful business model so
of course you can try to copy it but
we're a bit ahead now so the green bar
down here that's the number of
transactions in the system from februari
2005 and then there's a Christmas p care
this was huge Christmas shopping in 2005
and then I was Christmas shopping 2006
it was used huge and in two thousand
eight and nine and 10 and 11 so you
cannot really see that that there was
these big Christmas shopping bumps here
because the scale just goes up because
it's an exponential drought so you need
a holo greatness scale to see that
khurana was found in 2005 by three guys
and in april two thousand five the first
invoice went through the system in 2007
we passed million purchases and in 2008
during christmas we had more than
200,000 purchases during one month for
the first time so this was huge for us
in 2008 but then in 2009 we had eight
hundred and thirty seven thousand 375
purchases during the one month and then
investor got interested in us and
sequoia capital invested in clora in
2010 and at the end of 2010 we had more
than 300 employees and now we have over
600 close to 700 employees in the
company yeah so that's a little bit
about the success we had and also just
pass through the technology slide we
implemented it in airline so this is the
first file created actually already in
December when they started thinking
about this by someone at tail f no less
tail F was just starting up and was
hired to do some of the coding in the
beginning of the company so this is a
line right let's forget about technology
now so you have the right business model
and the right technology now you need to
find the right people and I'm not going
to tell you much about how to find the
right people partly because I don't know
and things i dunno i don't want to tell
you because we're competing about the
same people so but
I'm going to tell you a little bit about
what I think the right people are as you
can see here we also been awarded the
best work place in great place to work
in Sweden for 2012 and that's one secret
of getting the right people to having a
great workplace so here we have the
right people one of them is in the room
and other one left bright passionate and
get things done so this is what we're
looking for yeah so bright and getting
things done is what Jose bowls keys
writing his blog about the right people
and I bought into that wholeheartedly
but I also believe that you should have
passionate people so passion is one of
the most important things when you hire
people so if you're just writing yet
things done it's good but if you're
passionate then this will mean a whole
other level and actually are lying is a
secret weapon here because there's a
nice paradox with a lying that there's a
lack of airline programmers so it's
really easy to find great programmers
I'm sure there are many good C
programmers and Java programmers and
sometimes we have to find some Java
programmers to do some our front-end
stuff that we have at the merchant sites
let me put out an ad and we get 200
applicants and we have to find someone
that's good among those 200 applicants
and it's really really hard most of them
don't even know what a program is but
they still apply for a java programming
position very strange if you
put out an ad for an a-line programmer
three people show up two of them are
good and one is great so it's truly easy
to to hire the right one and and a
reason for that is if you're so
interested in computers and programming
and distributed system and whatnot so
that you have found airline and really
learned a line then you're passionate
about programming and that will make you
a great programmer so for us the lack of
airline programmers has made it possible
to to find the right people and there
are a number of great people to have in
the team so in our in the beginning of
our team we have the the prototyper the
robusta fire the fixer the cleaner and
optimizer so the prototype or you can
just build anything over a weekend maybe
as a day an invoicing system how r can
be will do that or a weekend it's really
passionate creative impatient and
curious and here we have a very young
young top Torian turnquist who you can
read what is done on his red-hot airline
blog for example and he's really really
good at just getting a vague district
description of what needs to be done and
then he'll sit down and hack and hack
and hack and then come out from his
office a few days later and and have a
fully working prototype which is a
prototype unfortunately but usually ship
it so that's how we can be quickly out
on the market so when we
in 2006 needed to take the next step we
were thinking about what we needed to do
and we decided we need to do installment
plans so that's previously we only had
invoices so you you went to the shop and
then you could buy stuff and we sent an
invoice and you pay the full amount
within 14 days or 30 days but we had
stores that wanted to sell TVs and
refrigerators and they wanted to be able
to provide installment plans where you
pay a fixed amount each month for 12
months or something like that so we're
thinking should we really do this this
this will change a lot of things we will
take on the credit risk for a much
longer time than we're doing now so it
was a bit risky so it wasn't until
summer in 2006 we decided yeah we should
do this and then everyone was on
vacation and we realized that if we're
going to introduce it now we need to do
it before the Christmas shopping start
and that starts in November so everyone
was getting back from vacation end of
August and then we had September and
october to build a completely new
service to have it up by beginning of
november so what we did was that we
built the ability to receive
transactions for installment plans and
launched in november we couldn't send
out an invoice to any customers at that
point because we knew that we had one
more month because you would pay at the
end of each month so we launched and
people could start using the service and
then we built the service for sending
out in voice at the end of the month and
release that and we couldn't receive any
payments for this at that point because
we knew there was another month before
they would start paying
so we released that and then we built
the service for actually receiving
payments and this way we could release
in time for Christmas shopping and in
February 2007 we had taken ninety
percent of the Swedish market for
installments pan on the net so the the
previous competitor there was basically
only one that really provided this this
was one of this old Swedish banks and
they had a much worse business model for
this than we had so the Swedish law
required you to sign a paper saying that
I'm going to take this loan for this TV
for 12 months or something like that so
what they did was you went to the site
and you say i want to buy a TV and i
want to pay it in 12 months time and
then decide ok we'll send you this PDF
you can print it and sign it and send it
back to us and then we'll send you an
e-mail say we got it and then you can
buy the TV so this meant that the Easter
had to reserve that TV if and when the
customer would send in this paper and
actually be able to buy it and they
would never know whether it could buy it
or not and it was a hassle for the
customer and everything was really
problematic but what we did was we said
you want to buy this TV fine you can pay
it in 12 month time you only need to
sign this paper and send it to us if you
don't we just send you an invoice for
the full amount and you get a TV now so
they could just drop by the TV directly
and then send in the papers and if they
didn't we send them an invoice
so we follow the law but we did in a
much better way than the competitors
before so quick release and a great
business model and we could just take
the market in Sweden for this very very
quickly they are still trying I think
this was in 2007 but I think they're
getting some time I think we got our
last customer two years ago so but over
the last big one so the build the
prototypes and we actually shipped them
because they are actually working not
everything is working but most parts are
working and then we have to put our
robusta fire on the task so evil fix all
these necessary stuff like startup and
shutdown and error handling and logging
and all the boring but necessary stuff
that that you need is also passionate
and very careful very patient and he
knows what he's doing there is a young
Magnus there from his time at the
computer science lab so he's one of the
guys who wrote the debugger and part of
gin server and well parts of most things
in OTP so was Toby also and then he just
make the this system up work up and
running for most of the time but every
now and then the system will still break
down there's a very dark picture of mats
here then the fixer comes in so he knows
how to debug things and he knows the
runtime system he's passionate also very
patient and thorough
but it's also curious you want to really
find out what's going wrong here
actually we have several people that
does this Magnus is also a great fixer
and I have humbly tried many times to be
a great fixer also but then when it's
actually working the code then the
cleaner comes in so now we need to be
able to maintain this code for many many
years and then we cannot have
unfortunately the prototype vers code
it's a very quickly done it's working
but it's not pretty I'm afraid so he's
also passionate and but it's also
aesthetic and patient and very
knowledgeable and his sitting right
there wicked Coulson is our main cleaner
every now and then there's a shake in
that touches every file in the whole
repository and he gonna go out oh there
was a name here that was ugly and it was
everywhere so I just changed that
everyone goes well hey it works great
and then we have the optimizer so when
we have working beautiful code then it's
time to start to optimize the code and
then we have someone who knows math and
algorithms and it's passionate and
experimental and analytical so to be us
so Rick card here was from the hype team
and two BS is also from the hype team
from the University and he is working
with our harder algorithms like you know
I said in the beginning that when you
shop with us you only need to know your
name and your birthday and where you
live and I said everyone knows this well
everyone think they knows this but
they don't so they type in anything and
then somehow we have to find out whether
they type in correctly or incorrectly
and if they're trying to cheat us or if
they just made an honest mistake and
should we trust this person or not
because we're actually lending him money
yes from this information so we have
some pretty heavy algorithms to find
these things out so we don't have that
many transactions going through our
system but each transaction has to go
very quickly and it has to do a lot a
lot of work you might need to go to
several external sources to find
information about the person shopping
and we have to do some advanced pattern
recognition to to recognize what this
guy is trying to to write in these three
fields so that's where the optimizer
comes in and that's sort of the last
step so we have a number of people that
has taken these different positions but
for us it has been a very successful mix
Bullough team to be able to very very
quickly produce code that's working then
make it better and then fix it and clean
it and optimize it yes
at the prototyper so the proto soon as a
prototype is working you can actually
show the whole flow that you want to
implement that prototype becomes a
product and goes into production so you
just they just know when to pick it up
so with the right passionate bright
people that get things done they know
when their turn comes so for a small
start-up that's all you need that with a
small team so this this becomes a
problem when you grow so now we're not
like five developers but closer to a
hundred developers or something like
that and this doesn't really work
anymore these people don't work with
these things anymore it can be a day or
it can be three years so some things we
haven't optimized at all yet we haven't
had any need for it some things as soon
as traffic hits we realize that this
doesn't cut it and you have to go to the
optimizing step but so that worries
so with the right business model the
right technology and the right people
now you need to have the right amount of
process so we've been using scrum that
was sort of this picture or skirmish
things on and off very much but when
you're a small start-up you don't really
need any process or project management
and so on so there's just one or a few
guys and they know what they're doing so
they just do it you don't have to tell
them what to do and this is of course
the the biggest problem when you grow
when to introduce what so we we started
with very very loose project management
only sort of trying to prioritize what
is the next project that we're going to
do and not really caring Amida sided on
a project the people in the project just
did what they felt like to get it up and
running doing some prioritizing self and
what a thing should be released but now
as we grow we needed a bit more process
so we start to a bit scrum and scrum you
have these two weeks or whatever you
want one week or four weeks prints and
we tried be two weeks prints and you a
lot of time in planning and then you
work for two weeks and then you're
supposed to leave something and we came
to this from having had no process at
Oliver really released three or four
times a day and management suddenly got
a bit scare or they suddenly had to wait
two weeks for for a release and during
that time they
they changed their minds on what I
wanted like 10 times so priorities
changed and it was very hard to get
these cycles working so we went with
Kanban where you just have a flow of
requests in and then you can just work
on a limited amount of requests and then
you push them out and this was working
quite well but starting to get many many
teams and many many requests and it's
starting to become sort of meat packing
factory so you just pull your the next
thing in a priority queue from our
ticket system did that task and then
send it off to testing and tip for
taking life and then you put pulled the
next one and so on so yeah it was
becoming less interesting for the
developers they were sort of feeling
that they had no control over what was
happening and starting to lose passion
so now we we have a number of teams and
each team owns one subsystem and they
meet with management between once a week
and that's upper management sea level
management once a week or at least once
a month and get priorities and ID's for
what we're going to do and then they
themselves decide on when and how to
implement this and this
seems to be working rather well right
now but we have a little problem that I
will come to in a while that makes it
hard still so another problem we quickly
run into was the build versus by
question so we generate all our invoices
ourselves PDFs we used al guten to to
generate pdfs and this is very efficient
and we can produce loads of them in
really really short time and send them
to print or send them to the customers
directly when they shop by email or
regular mail but it's really really
problematic to change the layout because
the layout is written in a line so the
business I doesn't really like that they
don't really read along that well so one
thing that we was the first things that
we try to really buy was a system for
creating PDF so that you would think be
an easy problem so we just decided on a
system and started integrating that and
after year we realized that no this is
not working and had to throw it away and
throw away a lot of money and now three
years later we still haven't we we're
now we now have a new system that is
integrated for one of the countries that
were in in testing right now but it took
us a long time so buying without doing
proper research and proper testing
that's a bad idea even if it seems like
it will be a simple system to just plug
into your system
on the other hand we have a problem with
the not invented here syndrome so now
everyone just thinks that well we can
especially the prototyper I can do that
day over the weekend we don't need to
buy a system for millions of dollars we
can just write something ourselves this
weekend and then we have something that
works and yeah most of the time that
works to build a neutral system but then
there's another thing that we need to
maintain so that's one of the reasons
that we have drawn from seven
programmers to 100 programmers because
airline doesn't have much libraries and
we wanted to do everything ourselves so
suddenly we have libraries and systems
and subsystems and everything that we
all written ourself and for every system
we write then we need to get two people
to maintain it afterwards so it's an
easy way out to bill it yourself in a
line it usually goes pretty quickly and
get you more or less exactly what you
want but then you have to maintain it
yourself and that's that's not good
yeah so another important thing to to
have a process for his testing and and
you have to have everything automated
and we had that and I was the first
thing i did when i joined chlorin i
joined corner on the first version were
implemented already but they didn't have
a test system so setting up a test
system was one of the first things i
pushed for and that we built but then
Clara grew and I became CTO and I was
just sitting in meetings all day then
suddenly one day I needed to code
something and I was coding and then I
was checking things in and then I looked
and it was like 250 broken test cases
and there should be none and then I
discovered that well the whole test
framework had just fallen apart because
no no one had really taken care of it
and giving it the loving if needed so it
was really really bad so we had to spend
a lot of effort and we're still spending
a lot of effort into getting this back
in place and now it's really really
important with hundred developers to
have a test system networks
the most important things for us since
we're putting prototypes basically live
is that we monitor everything so we have
a lot of logging and the logging and
measurements or old draft and put on
this base everywhere so that we can see
directly when things are going wrong and
can fix them so i just want to show you
this graph that shows you the number of
transactions per day for some different
or per hour for some different
transactions and at this time whenever
it was sometimes in 2011 still during
night there was no shopping so what you
can see in the dark color is this week
and then you can see in lighter color
previous week so we can compare trends
so you see that they are basically going
exactly the same every week and the
interesting thing is that this is
Saturday and Sunday so people don't shop
much on saturday and sunday then it come
to work and monday and they start
shopping and then they go for lunch and
don't shop so there is a little lunch
every day and then they come back to
work and do some more shopping and then
they go home and sleep so we can see the
shopping patterns of all the sweets very
well here people shop at work still not
enough internet connection apparently in
Sweden just eighty percent of the people
have internet at home so
so back to the problem that we have now
with all the teams that are responsible
for their part of the system is that we
don't have parts of the system we have
one big monolithic system Alan have has
modules and we break things up into
modules but it's really really easy to
export too much from a module and then
to use that export everywhere else and
to have from one application every
export from every module in that
application is visible to every other
application and some developer things oh
I need this function and actually it's
already in there so I'll just call that
because you're not allowed to copy of
course so you just call directly into
this application to some low-level
function and then we get this huge
spaghetti thing so we only have one node
really running it's of course
distributed but it's the same know that
is running everywhere and it can do
everything and it was very easy as a
start-up to build this and very quickly
get something working but now with 11
teams that should be one responsible for
this part and one responsible for this
part it makes it very hard because it's
very tightly connected so we have
written a lot of tools to find out where
the boundaries are and when we break
them and we have a monitor in the coffee
room it says these are them how many
calls that break these boundaries
between applications and we have to fix
them and bring that number down
so now we have it all the right business
model dry technology right people and
right amount of process so don't let
testing slip don't buy without enough
research do not fall for the not
invented here syndrome don't leave
without interfaces so make sure you have
nice interfaces for your application do
scale your process make sure you have
proper testing and have process for
upgrade monitoring and escalation in
pace and most importantly don't lose
your passion that's all any questions
yes
sale so when we started in Germany we
immediately started with Salesforce of
70 people so I don't know how many they
are now but just sales in Germany was 70
people and then there's customer care so
when you get an invoice that you don't
understand or you don't know whether you
paid or not you can call us and ask
what's happening with your payments so
there's a huge customer care part that
we're handling our also and then there's
risk management and finance and now
there's layers and layers of managers
also so yes
so
yeah so the the goal is that they should
own their system and they own the
interface to through their subsystem and
they should only need to communicate
when you change the interface but we
have a technical board but board was too
boring so it's not called that i'm not
sure what it's called but where some
people from each team meet once a week
and discuss things that need to be done
that are more general but technical and
regarding process each team chooses
their process themselves kanban or scrum
or whatever yes well that used to be the
chief architect but he got a little bit
too much to do so he sort of retired to
becoming a developer instead so I'm not
really sure but yeah I hope someone does
right now
yeah so the this technical board and
then members of that is supposed to work
with this we also have one guy that is
sort of taking over the chief architect
role and he's right now mainly concerned
with getting all these interfaces in
place and and so on so no
so our chief architect hehe up until a
year ago he read every second in the
system and he did most of the final
merging and and taking life and he still
brought most of the code in the system
but it became a bit too much so we were
looking for a new solution there but
it's a challenge now yes
you
you
well so it's a good thing with with a
line that we don't have the DLL hell but
the reason we don't have the DLL hell is
because there are no libraries I think
this is a big problem for for a lying
it's it's a blessing in to some extent
but it's a big problem there's a lot of
things missing library wife so I hope
there will be more open source efforts
to to get great libraries and in some
way that actually works and someone
takes care of like perhaps OTP to bring
all these together into some nice
packaging the problem now is that you
you have to go out and get tub or
something in and find an XML parser and
there's five of them and you have to
choose the right one and it turns out
that that one is not maintained anymore
and so on so that nuts that's a big
problem with Alan but yeah on the other
hand you can usually write that library
yourself over the weekend if you're but
then you have to maintain it also
questions
do a consulting project I realized that
there aren't a lot of used to bail for
outreach
obviously yeah we're working on that a
lot so we're we're working on unrest ap
is for all our services but we're going
to start using them internally but the
plan is to have a nice rest api is
publicly available for almost everything
that you can do with a system but that's
sometime in the future but i think the
the api is armed or less done now for
for internal use and hopefully we'll be
able to release them and start working
more with developers but right now
there's not that much you can do with
the system as a developer from the
outside but it will be better in the
future yes
yes but it eludes me right now the car
do you remember
probably something like that
yes I'm not a hundred programmers there
are some people in the IT department
butters managers and testers and all
sort of people so around 70 developers
perhaps pure developers airline
developers
that
yes
I think so i think we were a lot faster
so we we did have a lot of competition
there was one company that was basically
well ahead of us when we started and and
we have like three or four companies
that basically provide the same services
us but we have been able to be a lot
quicker in development than them and
introduce new things lot quicker than
them and we have had a system that which
is very robust so it's basically never
been down so usually when we upgrade our
servers they haven't been down a single
time since since we started using them
so the last server i took down had 600
days uptime and the airline node has
basically been running all the time on
on that one also so that's one advantage
and the ability to to do the hot
upgrades has been really really great
and the ability to get the great
passionate programmers so i think the
the people working at at our competitor
they were writing PHP and the c++ code
and they were not very passionate and
that company went bankrupt in two
thousand eight or something like that
but so i think that was our line that
did a lot of that but the most important
thing for us is the business model which
has been really great
ok
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>