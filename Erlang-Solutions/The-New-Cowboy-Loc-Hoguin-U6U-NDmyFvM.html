<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The New Cowboy - Loïc Hoguin | Coder Coacher - Coaching Coders</title><meta content="The New Cowboy - Loïc Hoguin - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Erlang-Solutions/">Erlang Solutions</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>The New Cowboy - Loïc Hoguin</b></h2><h5 class="post__date">2013-05-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/U6U-NDmyFvM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">second one is that I don't drink alcohol
so you can't offer me a beer I'm sorry
you'll have to settle with a coke and
last one is that I always forget my
heart except today I finally found it it
was in my home actually I thought I lost
it but yeah I have it so I'll try next
time to bring it with me because it's
really the one thing the people ask the
most and I i'm really not lying so so
far i started coboy about two years ago
why mainly because i liked many of the
existing solutions i liked web machine a
lot but then you can't do web sockets
with web machine easily at least I liked
mistltein because it's very easy to use
I liked also some things inside mochi
web inside yours so I couldn't choose
and since I couldn't choose i just
bought one that bought everything that i
liked inside a single project and of
course i wanted to use also binaries
burn Ariza really the domain try girl
that made me start covering so we
started yeah two years and one or two
weeks ago and initially we wanted
binaries we wanted dynamic listeners I
saw this in a web machine I think you
can create as many listeners as you want
dynamically so for example your
application could create a listener for
specific administration interface only
when you need it and the icing does
vertical also we of course optimized for
low latency but along with too much does
all the work here and memory but banner
is pretty much do all the work here too
we have one process per connection
mainly because it says in memory and the
code base should be small and record
clean so no parameterize modules which
are going off so that's good and
initially the community work was pretty
encouraging we had some Oscar alc guys
who jumped directly on the bandwagon and
then it just started growing I'm very
thankful to the very initial group of
users because they helped make coboy
what it is now and then I talked for the
first time at the UC two years ago
mistltein was also a big help not
because of the project bigger but
because Roberto decided to stop
mistltein in favor of Cobra we disc we
discussed a few times before then about
both projects how they have used that
pretty much much and how it's a waste to
have two secret projects for everything
so it is I dead and I'm very a bus
thankful and a bit sorry that Cobra
should prevail so if you go to rackspace
tonight I think he will be there so you
can go talk to him and some came for
that because that was very generous of
him so then more recently I wanted to
start working on more stable version so
i had to condense all the changes i
wanted for the first first table version
in a very short time span so that's why
you have you had to do all these changes
to upgrade second but first I actually
didn't do much at all because I had to
really think about this because once
it's stable you generally don't want to
modify it the code has to be the code
has to be a future-proof so I've done
all this but few very small things
remain we will see them afterward so
what's new Cabaye as a mascot which is
not a cowboy but a call girl the reason
is that I like girls not boys so yeah
sorry about that we have new girls now
cowboy was really trying to have a very
small code base it's not that small
anymore but the the code base is still
the same it doesn't grow we just have a
big module for passing HTTP headers and
and everything associated with HTTP and
this is mostly it we want to be able to
avoid too we want people to avoid to
pass themselves d HTTP headers so we
will have to cover will include passing
for every single HTTP header available
and we of kooks won't support for what i
call the modern web so that's speedy
WebSockets long bullying and so on the
new goal is to have a good documentation
so that's new we didn't have any
documentation before our people
complained about it almost on a daily
basis and not we do and it's actually
pretty cool I think here so this is just
the introduction and we have on the
right many many different chapters
and of course we want the code to be
stable to be future proof and last girl
which I haven't really started to work
on yet is to target non a long
developers so for example I want to PHP
developers to be able to use cowboy to
serve their applications Oh Ruby
developers or Python developers I want
to expand the number of users that can
use Cabaye and perhaps this would allow
many people to try along because if they
can simply add a hunger waiting in a
wrong on top of the application that
would be a lot simpler solution than
anything that exists now so we have new
conventions in cover in Cabo everything
is a binary know we used to have items
as for certain other names and for some
methods this is mostly because coba used
to have to use the air long decode
packet function which does kind of a
mismatch it has a few defined header
names which are eight times and the
other ones are binaries so it's not very
good we want something clear so it's
sort no binary and it's also everything
is lower case if its case and sensitive
so I got a few complaints about this
some people think they that you really
want to have the camel case for the
other names that's not well this turned
out doesn't say that and maha well as we
will see speedy actually asked to have
lower case Adele names so we are
compatible with speedy already on this
on this point and then i renamed a few
modules simply because it's annoying to
tip kobo HTTP something
we improved HTTP itself we have better
support for HTTP 1 dot 1 and 1 dot 0 I'm
not interested much in one dot 0 because
it's going to disappear eventually
especially with budino coming but yeah
we do improve as much as we can mainly
on existing implementation khob I know
has built in response compression so if
you just set an option compressed to
through cover will compress everything
you son to the browser we have built in
passing of HTTP headers as i said the
request body streaming code is very fast
now it used to just read whatever is on
the circuit every time you asked to
sleep for a swim string chunk now it
tries to read as much as possible before
giving you the data so it will have a
much better speed there and we also
improved long polling we detect when it
closes I have changed a lot of things
this is the biggest part of the changes
I think we have four types of functions
in coverage we have functions that
access direct to extract value these
return the first one value rack so we'll
return the rack simply because often we
have something that will be cached and
you should really use this work you
should not assume that nothing happened
even if you know the record it might
change in the future for actions we
generally do something like sand or
reply so we have a result okay on that
okay modification
we simply write on the right so for
example you set a response body and
questions for example has body will
return a boolean we improved WebSocket
the WebSocket now is completely
compatible with the standard which we
handle everything we use the D autoban
test which which is a huge test which
used to test both servers and clients
and we pass all the tests there's a few
shadowy areas in the stand out that we
may or may not handled properly but
everything that is clearly defined is
clear is properly hundred and the code
is also much faster now also thanks to
the autobahn t street because they have
some tests for performance and this test
will take a lot of time if you don't
optimize and we went from about 100
seconds 27 seconds on some of the tests
so this is a pretty good improvement we
also i did not mention indeed much
remitted in the slides but we also fail
much earlier if there is some data that
is incorrect and finally the text frames
which are by destined out the required
to be utf-8 i'll now properly checked so
checking this makes actually chuckled a
bit slower but we can't really be fully
compatible if we don't do it so if you
need speed you should use binary binary
forms instead
so rest rest which actually comes almost
entirely from a web machine we use the
web machine diagram and we implemented
it and many users went to Cabo after
that simply because they want to use of
course rest and web socket at the same
time and we have a pretty similar
implementation but we are in the process
of changing a few things in the in the
diagram itself so it was quite
compatible before it will be less and
less until we are sure that the FBI is
what we want one thing we added is the
patch method support so when machine
does purse tampered we are dead patch
which is pretty much the same thing as
per to accept the data use and is just a
fragment of the whole widows and it's
still it's still experimental so like I
said we still have a few changes to make
here you can use it but it's at your own
risk and of course people do use it many
many people use West we have more
powerful routine so before we had list
of segments and that was a bit annoying
too bright so I went with a nice and tax
we I don't have examples here sorry the
sin tax allows you to simplify to swing
with the kind of you are you warm you
want the bindings you want you can have
optional segments and you can also apply
constraints concerns for example would
allow you to take a boring value and
make sure it's an integer so this allows
you to differentiate between these two
API 52 an API blue
can be routed to two different angles
and you can also write your own
constraints you can apply anything on it
if you want we have middle whales so
this was a feature that was requested a
long time ago I wasn't sure exactly
whether I wanted it or not until
recently when I talked with Garrett late
last year middlewares are simply
pluggable a pluggable process kind of
saying you plug a module in the middle
of the Kaaba execution and that's about
it by default the middle whales enabled
are the routing that we saw just before
and the handling of the request
themselves you can add anything you can
replace them if you don't like this
footing you can just discard it one
comment is that this isn't wsgi this is
completely different they they actually
just pass the request toward the middle
west and then there's a response that it
is generated that is pass it back to all
the middle west and this takes just a
lot of time to to send the response to
the board to the browser and I don't
want that i want to be able to send your
response directly so instead i have a
list of middleware and we just good one
way we don't do the way back we just
passed the request until we have no
response until it stops or until until
death of course there's something wrong
happening so it's a bit different I
think it can fit a lot of uses and if
you really need to
do something on the response you have
worked for this and yeah we do have
documentation now so it's not perfect
I'm not very very good at writing I'm
trying my best but I can do only so much
at a time before I get first started so
please send feedback please and patches
if you have anything to say about it it
would be much appreciated so Kobe has
always focused on performance and this
has had great results recently and I
actually am not sure how to benchmark
Kobe properly this is a problem of salt
for a very long time and I still don't
have a solution because there's two
things to consider first cover generally
can handle more requests then you have
that you can generate on classical and
benchmark Lions like a bee or CH and the
other things thing is that most of the
things you want to most of the values
you want to X trait from benchmark
actually come from systems and download
systems that do many other things than
just reply something and that's very
difficult to to do when you don't have
the actual system in place so instead I
ask people to give me results so these
are from Fred from there Edgar
application and what we can see here is
there are six servers four of them ran
the cowboy 03 version
and two of them rent the cabayos yeah
it's 0 7 0 0 8 but really risen Quebec
and these are the 03 here here here and
here and do does especially the bond one
a cobra 07 so the bond one is very much
bigger than everything else it can under
maybe two times more requests than
everything else and that's very
interesting because that means that we
managed to find a way to improve cowboy
that actually come beef can be detected
in any kind of benchmark so I will
explain why this happens and yeah these
two are the same kind of servers they
are big servers and this for a smaller
server so that's why you don't see such
a big increase here this one just takes
everything so yeah I'm forced to test in
production in users system I really wish
there was a way to do otherwise so if
you have any performance needs any graph
please send them to me I really can use
them I'm also hoping from that the
progress with post project will going
results because they are of course
focused on building testing tools to
measure of the correctness of the
project but they are they are also
interested in benchmarking so perhaps
something will come out of it and that's
pretty much the reason why Kaveri the
new kobe is able to handle many many
more requests nice while Cabaye never
used if we did
at some point for perhaps two or three
months but beef of the same as me if
they can also have the scalability of
your system and it can be surprising
because you they are actually they are
conceived to be able to give back
control to the scheduler but they are
not they are not necessarily tested for
your own kind of application they are
they are doing their best but sometimes
this isn't enough so for some operations
like the ones we have in a web server if
we remove the beef we actually get much
more performance at was it out of it so
these are the kinds of beef that can be
helpful especially it's the first one so
when we actually stopped using the code
packet because we wanted consistency we
ended up having a lot more performance
in our project so this was a happy side
effect but I'm glad this happened and
binary much is much smaller scale but it
also has some effect least lands I'm
sure you know that if you do list is
huge it will take a lot of time to
calculate the runs so there's no real
formula to this you have to measure your
system perhaps the changes I've made in
kibriya works for you I'm not sure what
you want but on the real head out where
at least we have a pretty good
improvement and never assume something
is faster doctors Neef because it's
liquid because secret is fast it doesn't
it does work if you have one tread but
it doesn't work if you have many many
processes and of course up team
is the critical code base the the part
of your project that as everything going
through so as you can see Kaaba is
actively developed a motion this because
I occasionally have some questions about
the status of Cabo Cabo is our main
project it's really what we focus on and
we do have other projects so on but it's
cowboy that is the most important and we
we are planning to use it in a future s
in a few toss a solution I can't say
more about this Kaaba is popular so this
is github most along most wretched and
most along projects so I looked
there from time to time and this is
always what I see well not exactly all
the time I'm sure hi hi xes this month
will win by far the most out but this is
very very encouraging this give me a lot
of confidence in what I'm doing and you
might wonder why coboy become became so
popular I do myself and I think it's
mostly the community for example if you
go on Twitter and you see oh no like the
New York away okay retweet and that
helps a lot because people don't know
about the project and they know it's
still working and it's still being
improved so please continue supporting
the project we have many contributors I
want to sign them some of them are in
the room we have had more than 50 its
enormous I'm so happy about it you have
almost 500 tickets so that means we had
a lot of bugs of course but they are
getting fixed and that's what matters
and we have many many companies using
coboy to make things and I really liked
hearing where cover issues I don't
really care if you use it to pull some
kind of API or some subsurface us I want
to know does it help save the world and
in some case I'm sure it does so please
tell me if it if it does so this guys
use it you have hello qu the Holy along
team is here you have winner Linder lab
which is the guys behind the Second Life
there are you there are they are using
it for game you have bloomed it was the
previous company for fred was in UF
kazoo the talk was just before and it's
also using financial in mobile
applications real-time web and so on and
so on we also have actually we have a
few sports related users icon talk about
them because i didn't get explicit
permission but we have many things going
on and most of the time they are
projects that need real time so they use
a longer loop of course they need some
kind of HTTP access so they use Cabaye
and there they also use web socket they
are these are the three key points of
why people are using cover and if you
are using it for some game project game
related project then you have and high
five and you are using it and that's
great and also many open source open
source projects are using it you can use
caballo is nitrogen chicago bus axiom
actually even Miller told me he want to
switch to cover by default so that's
very very nice easy in the room no okay
we have many open-source users habit mq
use it it's a plug-in but that's simple
aliof s i'll talk about it a little more
projects fifa which is some kind of no I
already don't understand I'm sorry you
have a an area search at five planes is
a cool application where you can share
files using web sockets without throwing
the file on any server and you have big
wig which is an old one and I hope
someone will one day take it and make it
better because it could be very cool to
have a kind of web Buzzard Observer
application and I added recently a
section in the cowboy guide for people
to list the projects that use caballo
that compliment coboy so please send the
pull request add your project it will
help people find examples of find tools
to use with cowboy so cowboy was
initially doing what ranch is doing
which is accepting connections it was
benefit a separate project it was always
meant to be a separate project and wasp
enough because many people wanted to use
it and they don't want to use the kokoda
street d HTTP code specifically Bushell
for many reasons runs listens accept
connections supervise the processes it
does everything for you it's a real
pleasure to two years and you can of
course embed it if you need to bullet
is actually getting quite popular it's
pretty much web circuit for our borders
event the ones that don't support it and
it's also permanent connections it will
reconnect if something disconnected it
for waste so I've been here last year to
talk about far west and it was just an
idea at the time and since then it has
been used actually by a group of people
while building a game database project
so these guys have absolutely no
programming programming background and
they are still using it with very few
anteversion for me to build this kind of
project so i'll do a short demo
afterwards for wes is mostly about
giving this kind of users complete
autonomy to do what they need to do it's
not so much forever long people it does
it will provide libs for example for
authentication session so but it's not
the K point of powers so i actually just
released version version 202 here you
can find it on my github and this is
yeah this is the Farwest you I so of
course you need an UI because these
people don't know common line or
anything and dear I so far gives you
access to the roots you can change them
dynamically you can edit templates we
have they actually made quite complex
the templates you can so it looks a bit
like a wiki because these templates will
have will be versioned
but these templates do not contain any
data they are just the template itself
and then you have the user data which is
also versioned and yeah I probably have
one that was yeah more data and these
are just JSON and people actually do
understand how to edit a JSON how to
make some JSON so it's okay for now at
least perhaps we will have a better
interface later and we can of course
upload files so far west there's a lot
of you you I work to be done so I'm
hoping to get into a stew TT sauce guys
went to me and asked if I wanted to do
some kind of Kickstarter and I said yes
sure let's try whisper West because I
really don't know how to make you eyes I
really need to pay someone to do it so
if far west becomes successful one day
it will be because someone will have
done the way I work so if you are if you
are interested just look give what you
want and I'll be some food and last is
Leo FS which had talked yesterday it's a
pretty much just amazon s3 open source
on your cell walls it uses cover in the
Gateway part of the application so
kawaii must receive a lot of data and
that's why i asked them to be able to to
work on the project to be able to
optimize cowboy for these kind of
situations Cabaye wise you was optimized
for latency we need to optimize it for
throughput also so this is what I'm
doing mostly at the moment in the future
we still have a few things to break
so we will improve rest we need to fix
the post hunting in web machine if you
have a post request and the the resource
must not be created it goes to the
process first function and this function
simply don't care about the content type
of your data and that's quite bad
everything else cares about it and then
you have this function that is odd so we
want to fix this and make it like
everything else we I will had these are
actually not working anything but I will
have more options to whip to rid the
request body we need to be able to
decide the size of the chunks at the
time outs and so on and i will probably
remove coverage period which is mostly
used if you have a poxy somewhere and
you want to find the real EP IP address
except the headers used by the proxies
differ depending on which poxy you use
so this function is on perfect I'm not
sure I can do a perfect function so I'm
just removing it and I write a lot i
will add support for passing these
headers instead we have a lot of work to
be done in ranch actually but it's
mostly for Cabo use we have this setting
called max connections it allows you to
have a maximum number of computer and
connections mostly to avoid overall
overloading disappear so to do this
today we have a gentle well that
monitors all these connections and
maintains this country this isn't very
good because it duplicates the work of
the supervisor which already knows when
processes stop so I want to make a
custom supervisor to do bus supervising
max connections rumbling at this in the
same place and doing this will also
allow me to optimize a few other things
I'll be able to simply have the protocol
options and transport options directly
inside the supervisor so I don't have to
copy it two times to create a new
connection process speedy speedy is very
interesting speedy is this new HTTP
saying that uses binary that is mean to
have one single connection for all the
requests the buzzer is going to make
it's a synchronous it compresses
everything so it's soon's perfect and
it's actually quite good supposingly
it's it it has the head of our lower
case like I said earlier and that's very
very smart and in Cabo we will be able
to have speedy connections walk directly
on the same code as HTTP request so we
are going to do this by having one
process for the connection and then we
spin whispering many different process
for each request and they will be of
course thanks to a long executed as I
honestly so something's in speedy we
won't be able to do speedy has this
priority number for request that
determines which requests should be on
lead first but along doesn't about this
we of course want to support HTTP fully
we want to support everything that is
standard standardized around HTTP except
perhaps things like web dev which would
be better in a separate project but we
want to be able to enable people to
build anything they want on top of koba
koba HTTP
and of course we do continue as soon as
implementations arise to add the new
standards so the first version is going
to be everything I've been talking about
here please of course the stable API
with really want this actually Joe came
to me a few few days ago two weeks ago
perhaps and said you have to stop
breaking the code and there's a big
reason for this but i'll talk about it
afterwards so i'm going to make the best
for taken to stop breaking your code I
don't promise anything but I will try
and of course we also want cowboy to be
fully documented so it will probably
actually take a lot of time between the
last few important change in cowboy and
the version 10 release because I want to
spend time to document everything make
sure people understand and then be able
to want this version is will it start
working on the next thing so how can you
get help you have the IRC channel on
freenode and 99 you can also ask on how
long but I think with the amount of
people who are asking about questions on
along or the along mailing list I think
we are annoying a few people in the
community we don't care about this so
it's probably better to focus your
questions in 99 channel or the mailing
list on the that you can find on our
website you can ask me for consulting I
actually did some earlier this week I
can come where you are look at your
application until you what's wrong how
to improve it
and so on so I'm mostly interested in
consulting and things that will allow me
to improve co by Indian like
optimizations and I can also do some
specific developments if you need but I
prefer if they are open source later so
you can if you need something you can
talk to me anytime you can help risk oh
boy yeah give me feedback give me
feedback give me feedback that's it you
can also of course and patches you have
a get a guide for this in the repository
if you are a company you can ask me for
sponsoring I of course will consider it
and then you can help with the future
cowboy boot so I want to talk with a few
people I see two about the cowboy boot
because I want something that is huge I
want this kind of book not because I
like writing I really don't but because
we need a book that is good bus for
beginners and for people who are going
to build two more rows biggest web
applications we I want something that
can be read by people who don't use
along that we don't know how long yet
this is important I think because cowboy
and mostly songs to a lone cowboy change
the rules of the game we have many
processes we have many connections and
it's simply not the same as developing a
rise up so I want to be able to one lie
10 people about this I want as many
people to know they can also do it this
way so we will have of course a few
introductory chapters about our long aha
just one how long is very simple it's a
very small language and then we move on
explaining kawaii and then we move on
explaining how to build real world
applications and I want to go protocol I
want to go as far as distributed along
applications that use copper II for four
servings solving the application itself
so if you want to help after the talk
come to me I'm sure you can we will
probably publish it online like Fred did
with a long new summer long I think it's
a it worked very very well for him so we
want to do the same and I also already
have some interest to publish it on
health copy and one more thing cowboy
will have some part of the programming a
long second edition Joe like mobile so
you should like it too but it doesn't
look it doesn't like reading the source
code so we always bugs me about the lack
of documentation he hasn't recently so
that means I'm doing a pretty good job
there and yeah so we will add something
there i'm reviewing reviewing it so it
won't be something too crazy i hope and
that's it so you can find me on IRC
twitter and so on and so on do you have
any question yeah
yeah I do want to yeah yeah I will i do
want to enable many other years of
probably including fcgi like you mention
so I would be very interested if people
want who want to try walking on cowboy
but not directly because it it's perhaps
a bit scary to walk on satellite
projects like a CGI right for Ruby or I
don't know so that can be a good thing
the main the main appeal i see is simply
the feedback feedback is the most
important whether it's Berg's or simply
saying it works it works and it does it
this world but if you want to write code
you can do fcgi if you want yeah i'm
very interested because that's the next
step 1 Cobra 1 dot 0 is released I'm
pretty much done with the along side of
things so I want to expand them so if
you want to start watching at cgi please
do so stop now and it should be ready it
should be ready before 10 yeah any other
question yep
you mean time yeah night so the question
is when will I what's my target for
releasing one dot oh and I don't have
any I'm very very bad with with with
time I i generally say I'm going to do
this next and then I go do something
else so I can't say anything I'm sorry
but it should be already pretty stable
you can start using it if you don't
already it won't judge much much on the
edge of the rest part which is still
undocumented so that's a big stopgap if
you if you don't really want to look at
google any other question thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>