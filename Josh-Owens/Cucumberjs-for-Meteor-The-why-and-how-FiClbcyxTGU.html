<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cucumber.js for Meteor - The why and how | Coder Coacher - Coaching Coders</title><meta content="Cucumber.js for Meteor - The why and how - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Josh-Owens/">Josh Owens</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cucumber.js for Meteor - The why and how</b></h2><h5 class="post__date">2015-02-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FiClbcyxTGU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">those I have standard josh owens
complimentary package here he's awesome
and let's let's give a little round
let's thank you for let's hear it for
Josh for Josh's in Cincinnati he does a
ton of meteor stuff meteor podcast check
email over to Josh alright so i'm josh
owens if anyone's tuning and we're
broadcasting this live on the internet
too so it's gotta got to be careful for
the all the kids watching um so uh yeah
I am actually it's funny you mentioned
letterpress that's actually what i'm
going to cover as well Sam and I we did
a testing class and we covered
letterpress that was kind of what we use
since it was in the book we thought it
was a natural extension to kind of keep
working on that and letterpress is so he
built the meteor testing com site as a
way to write the book so he writes it
and mark down and it parses his markdown
files and then like spits those out as
chapters and once you pay you could
access to those premium chapters and so
the idea is that you know he wanted to
put out an open-source version I'm like
hmm you know I'd be interested in
helping with that because I could see
uses for that for some of the videos
that I create as well so that was kind
of the the impetus for choosing that I
guess and that's what we'll cover but
real quick I've got some slides about
like why test and that kind of stuff so
let me share my screen and we'll walk
through those and then I'll do a little
live demo of getting like writing a
cucumber test as well me I won't say
this we had a question Josh about
trustable in the windows version of
meteors meteor windows meteor is being
heavily worked on right now by the
meteor development group I don't know
Josh may know more on that but but I
know it's being heavily worked on it
commits a commitment if there's a branch
out there that you can go try I don't
know if it's worth trying yet but it may
be worth it to help if you want to help
with the project but what do you Josh do
you know anything about the windows
version other than that this yeah I
believe it's working
it's a little slow I've had people email
me and say like hey you know I've
totally got it working now but you know
it's just a speed issue at this point I
think they're working on but I will say
this like it is known to not work with
velocity and testing so I think if you
try to do windows with velocity right
now you're you're gonna have a bad time
fair enough thanks yeah okay so this
this is the the cucumber j/s a meteor
the why and how of testing here so why
test apps I think for me the reason that
you test apps there's kind of two main
reasons that you'd want to test your
apps one is to kind of improve your code
design or to prevent regressions and
those are two kind of important reasons
why so if you think about it like when
you sit down and you write out a test
ahead of time you're actually forcing
yourself to think about your code and
how your codes going to be written sort
of so you're not really thinking about
the entire code that you're going to
write but you are kind of thinking about
what you need to call and what it's
going to give you back and that kind of
thing and so I think that helps with the
code design and then the other thing is
you never know when you write a test and
you write some code and you put it out
there I think you know you want to make
sure that that code works the way that
you wanted to and you want to make sure
that someone doesn't come along and
break it later and so that kind of leads
to like things like confidence in
refactoring a code documentation and
helping scale at your development team
like all that stuff is kind of a side
benefit of you writing tests to prevent
regression so those are those are the
main reasons why you'd want to get
started and I think you know looking
back at my career over the last 10 or 11
years the one piece of
information I would go back and give
myself as like tests aren't stupid there
in a waste of time you should do them
because I think they're there comes a
time in every applications life when you
go from being able to click test it to
like you just can't click test all the
pieces anymore and you know what I was
working at differential I think that
that timeline you know that that started
happening somewhere around six weeks
between six and eight weeks and at that
point you know you start deploying bugs
or breaking other things because no
one's looking at that part of the app
when you put a new feature out or
something like maybe you broke a
pre-existing feature or something like
that and so those tests are important to
make sure not only that everything's
working the way you want but to you know
make sure that that the new features are
also going to work the way you want so
kind of a kind of a why test there so
why cucumber so cucumber is in English
based
test framework and so it starts with
gherkin and you're right I should put a
slide in here with an example what it
looks like um Oh me give a huge font
bump here can you guys see that okay a
little bigger maybe a little bigger
about that yeah I think okay all right
so the idea is that you know you're
going to write a feature and then you're
gonna have these scenarios and so
gherkin is like I said it's based on
english language so you can say like the
feature is I want to have an author abou
landing page so I want a page that I can
control the content on and you follow
this as a i want to so that and that's
kind of how you outline your feature and
the idea is that you're driving out the
business value so as an author I want to
curate a landing page so that i can then
tice people to purchase my book and so
the the so that part should really drive
ultimately down to a business value and
I think on the cucumber page yes
actually lists out like the five core
business values that you might be
interested in actually let's let's go
look cucumber
if they list them out yeah they don't
have to find it later but they were
really there's there's a good script to
where they they walk through like asked
popping the why stack is what they call
it and you basically just you keep
asking why you're writing that feature
until you get to a core business value
so I guess that I mean that sort of
explains cucumber and you'll get to see
it in action and understand kind of how
it gets hooked up but I think the great
thing is that with cucumber it's
something that you can have a client
right or you can have a business owner
right or some other kind of stakeholder
that's not a developer like they can get
involved and write that stuff and hand
it over to you and you know it's also
nice because once your tests are all
green you can hand them back a little
spit out that shows them you know hey
here's your code it ran it past and so
you know it kind of gets everyone
involved in the process so um and the
right thing given the wrong one here we
go uh so this is a little
tongue-in-cheek but generally with I
think when you're when you're going to
start writing a unit test or when you're
going to start writing an MVP you don't
want to necessarily start with unit
tests because those are actually going
to be some of the hardest things to get
functional in my opinion because you
really want to like mock and stub out
parts of dependencies and so I think
like when someone's getting started with
testing or they're getting started with
building an app like mocking and
stubbing is is probably the last thing
you want to do so that's why I generally
like to recommend people at least start
with cucumber like just dip your toe in
it and get started and an understanding
and the other thing is like it's
cucumber is what people can see right
like it it forces your user or it forces
you to think about what your user is
going to see but there's also this
theory of outside in testing and so you
start with the writing your cucumber
test wait for it to fail come back to
writing more tests and then you're going
to write like the integration level test
and then you'll write the unit test kind
of as your as you're starting to get the
code together and make it all work like
you're testing each piece of it down
down the stack so again like if I were
just getting started on an application
or just get us starting with tests I
wouldn't necessarily start with unit
testing you know in terms of how hard
things are I think and then testing is
probably the easiest to get started with
but it's also the slowest and then you
have integration testing it's a little
harder than end-to-end it's a little
faster than end to end and then you know
you get down to the units there super
fast but you gotta like stub all the
pieces out and that can be a little
harder for people to understand so
that's what I think cucumbers a great
place to start hey Josh I have a
question about uh what you talk about
their just I don't know if now's a good
time yeah go ahead so so one one thing
that we were talked about recently I
mark our as we were actually I think you
just made a great point in plays right
into this but we actually talked about
because we get writing unit tests we
write a test first and then we were
doing summer stuff to what we haven't
written much of yet at all is
integration a thing we're not there yet
but um I can see right I can't like I
can fathom being more of a back-end
developer writing unit tests like
planning the functions i want to write
and writing some unit tests first but
i'm curious are you are you are you a I
mean ideally i guess it's there but are
you at a point where it's like hey it
you should get to where you write the
goal is to write your cucumber tests
first just like you do other TDD stuff
yeah yeah absolutely I think I you know
honestly the goal should always be an
outside in a pro
in my opinion like if you're comfortable
with that testing strategy than that I
think that that that would be an
admirable goal because again it forces
you to kind of come down the stack and
think about like what you want to start
with what what the end user is going to
see and how they're going to interact
with it to some degree but then you need
to get down in there and you know you
started to see it so the code all right
here with cucumber is just making sure
that you know we get we get chapter
previews onto the page but then there's
other code involved and getting the
chapter previews on the page like we're
creating a chapters collection and we're
making some fine calls in the iron
router so I mean these are things that
even though your end end test covers it
it may not be testing it quite the way
you want so I think integration and unit
s allow you to really get in there and
say like is it sorted the right way and
you know is it you know we making the
right fine calls and that kind of stuff
okay yep thank you so much yeah sure so
the other thing I kind of alluded to in
the last slide was an end-to-end test
you know is is something that emulates
exactly what the user sees and the
reason I think this is so important and
why why it really like forces you to
think about how you're writing your
application if you think about it you
know your user can't just go peek in the
database and make sure that things were
inserted I mean I have an example of
this right now if you get a meteor jazz
club and you you sign up on that that
little mailing list widget on the front
page and you hit the button it doesn't
really do anything so it ships it off to
MailChimp the way it should but I didn't
I didn't think about the fact that i
should give feedback to the user and say
hey we saved your your information and
you'll start getting email soon and
that's kind of important because i think
if you're not thinking about these
things then you're probably not doing a
good job with with writing your app
so to me I think cucumber helps keep you
honest if you're writing you know an
assertion saying you know this this data
should be in the database and you're in
cucumber you're doing it wrong so just
something to think about and another
reason why you know cucumber is an
important part of the stack so getting
started with cucumber this project
already has the cucumber stuff installed
but it's pretty easy you know you can
just say media ads all V 0 colon
cucumber and it should bring everything
that it needs for you and it will get
all the the files and folders properly
set up 42 I think when you when you tell
it to put the examples there everything
will get dropped in for you and will
kind of walk through some of those files
real quick when we get to the live demo
portion so the other thing to think
about is you know it velocity and
cucumber Jess they're a little bit
different for me than necessarily rails
and cucumber was in rails land you know
we didn't necessarily like we would we
were just able to insert data from a
step automatically but that doesn't work
right now with cucumber jsu have to use
fixtures and they're just files there
that run in the mirror environment and
so she kind of wish i had a diagram for
this now but i'll i'll try to explain
the mirrors in just a second but the
important part is to know that you know
your code your your app starts up and
runs and then the meter is like a
version that's forked off and you have a
second running version your application
and your tests are run against that
mirror and so when we're using cucumber
we're running against that mirror and so
when we're in cucumber land if you do
like a database insert their it actually
inserts into the development database
rather than into the mirror and so the
way to get data like automatically into
that mirrors
use a fixture and so we'll take a look
at what that looks like as well i'll get
to live demo alright so let's do some
code and so I've got a slightly
different version than what you saw mark
running I've worked it off and started
an early version and we just we have
that we have this given when then set up
here with the scenario and it just says
like given the settings with public
booked a title and a value of
letterpress buys lvo has been set and
I'm a new visitor when I navigate to the
landing page I should see then I should
then I see the heading letterpress buys
lvo and so we're just he's just pulling
settings out making sure that they're
getting put onto the page and so that's
all passing so what we want to do now is
if we look at the meteor testing oops
calm
i log out you guys can see there's like
a fundamentals of testing like these are
all chapters and these are little
paragraph snippets of what the chapter
is about and this is actually all pulled
from the database so we kind of want to
get that functioning at this point and
so
let's see yes
yeah so we'll write a new scenario here
and this is just something that's
slightly different like it's still
related to this feature but we're
testing a different part of the feature
so we want to say visitors and see
chapter descriptions oops descriptions
and so then we just start with like
given I have entered chapter preview
descriptions and I navigate the landing
page you'll notice that's the same as
line 10 above so we can reuse this code
here then I see the chapters
descriptions in the preview section and
the chapters are in order so if I save
that and we come over here you can see
we get some pending yellow steps here
and there actually you'll see the use up
here this means that there undefined and
you can see it's actually spit out some
JavaScript code that we can take and use
unfortunately these log prepending is on
here which is kind of annoying what we
can do with that is a in your test
folder you know we have tests cucumber
is where we keep everything related to
the cucumber framework we've got a
features folder and that's where this
file on the left lives it's the landing
page feature but then we also have step
definitions and we have a landing page
Jas and this kind of correlates with the
steps on the left and so you there's no
like you don't have to have them named
the same but I think it's a good
organizational practice to kind of keep
them the same and so what we'll do
just come down here oops see these guys
in with me and little copy-paste get rid
all this move this back over and so what
we're looking at here are the steps and
the steps are wiring up a little bit of
code behind the scenes to run the test
the way you want and so you can see like
up here given the setting with key blah
blah blah it's actually going in and and
setting some meteor settings right here
or like given I'm a new visitor it just
has a call back so it's not actually
doing anything or like when I navigate
it to the landing page we're calling
helper doubt world up browser which is
controlling our phantom j/s instance
we're handing it I URL and then we run
this callback so call call back just
tells it that hey we're done with this
step you can move on to the next one and
so on line 11 we say then in the heading
I should see letterpress and so we're
telling the browser hey grab the text
from the h1 element and make sure that
you know it matches the string that we
passed in right here this is just regex
that's what this expected head heading
is right here and we're just saying
compare the expected heading to the one
that we actually got from the h1 tag and
so if this assertion fails it'll never
call line 42 it'll actually just fail
and Bo blow up the chain and we'll see a
test failure and so now it's
a good time to take a look at some of
the other stuff in the cucumber
directory we've gotta support directory
as well and it's got a hooks in a world
gasps and so the world is this is where
everything gets set up so this is the
helper that we reference over in the
right here like online 39 and then we
set up the world and then we just set
like we set the mirror URL here and then
we get the ghost driver which is just
phantom Jas and that's what world out
browser is and so once all this is set
up then we kick off the the the very
first call back and then and then we're
able to run all this stuff does that
make sense to everyone does anyone have
any questions kind of about how that
phantom jazz stuff works I think we're
good so far okay awesome all right um
yeah let's close this guy I guess we can
look at the hooks to test cucumber sure
and so these hooks if you
familiar with kind of like how you test
things generally what you want to do is
you want to get set up for your test
execute your test then verify the
execution results and then tear down
anything that you need to tear down and
so these hooks are a kind of how that
happens so you have a before hook in an
after hook and you can you can add your
own hooks as well but this is just code
that's going to get run every time like
before and after so I actually haven't
looked in here before so it looks like
we're setting up world to be helper
doubt world that's interesting so wonder
if these can just be world up browser
and then he's setting up call back to do
something too I don't even know what
this is necessary anymore um anyway
don't to get sidetracked so we've got
these steps here that we want to get
working and so let's let's wire up some
given when then stuff and then we can
actually write some code as well so I'm
just going to leave the given step to be
call backed up pending because we're
actually going to write that fixture
that I mentioned before and then our
then step be something like a helper dot
world up browser do get text grab the P
tag and then it we just run a call back
here so air and actual descriptions what
we want all right so right in here we
can say something like assert equal
actual descriptions 0 so since we have
more than one pretty tag we're going to
end up with an array for actual
description so we just want the first
element and we'll just say this chapter
will cover item one oops yes it wants me
to put us and Michael in there all right
and then in our then step we've got a
second then step so whenever you see
this and it's just a continuation of the
keyword above so this this could read
then the chapters are in order as well
we say something like helper doubt world
up browser do a get text again this time
we'll grab the h2 tags so the chapter
titles will put in h2s and this is
easier to do because you know we're able
to look at Sam's working version on
meteor testing calm and just kind of see
what that markup should look like so
maybe that makes it a little easier
actual headings
so we say get text again and then we can
do a cert deep equal and we're doing a
deep equal because we want to actually
check in Iraq and so we're going to
check for each heading so we'll check
for item1 item2 oops you just have my
colon on that and so we're using
webdriver and this is where you can find
a lot of this stuff they've got great
API documents just at webdriver I oh oh
goodness sorry for dead saying its
emergency I talk to him so what we can
do Rui at
certain stuff come from this must
actually come from cucumber is somewhere
in here you can look up your assertion
stuff I don't have the link to
documentation right now sorry about that
so again we do the deep equal just
because its array and we want to make
sure we're doing the right thing here
the other thing you have to do when
you're done is make sure you do that
call back right
if we save these we should start getting
failures here and I think this guy's
still pending just say that to be a call
back instead there we go we get an error
I don't maybe this isn't the best of
errors but it says cannot read property
zero of undefined so that is just a
fancy way of saying actual descriptions
coming back is null and I can't read
that or undefined and it can't read that
so another thing you can do if you want
to be a little nicer to people seeing
the error messages we can just check for
an air right here we can do call back
fail and then air has a message property
on it so we can use that now we should
get a little better failure message
there we go no such element problem an
element could not be located on the page
using the given search parameters so it
couldn't find any P tags on the page
and so now we can go write some code
real quick let's see do we have a
collection
now don't look like we have a collection
yet hmm so I always put these in a
collection folder so we'll make a
captors Jas here make a quick Mongo
collection for chapters to be saved off
and now what we need to do now that
we've got that is go look at our fixture
we want to make sure we insert some data
so we go into test cucumber should just
be we can put it right in the the root
of the test cucumber folder if we want
we'll just make it called letterpress
stash fixtures Jess and again this is
just a meteor code in the interest of
time I'm going to copy this code in and
so what we're doing here is we're just
saying actually I don't even like that
guy guy uh we're saying if you're the
client or you're not a mirror then we
want to return out of this block of code
so essentially if we are a mirror we and
on the server we should get all the way
down to here and then we're just going
to run chapters dot remove and then
we'll run chapters insert twice I'm
purposely making sure that you know the
order of insertion is out of order
because we are checking the order of
items I you know I don't know this is
maybe it's weird to rely on data
insertion to kind of make sure your
tests are right that's up to you if you
don't like that this is where you
move lower in the stack to kind of test
the ordering so you maybe take out the
the chapters are in order and put that
into an integration test or a unit test
or something but this is talk on
cucumber so we'll do it in cucumber all
right so we should still getting our
test failure I'll bring up robo manga
real quick so you guys can kind of see
what the data structure looks like so if
i connect to local host 3001 you can see
we've got the standard meteor database
here but we also have cucumber Jasmine
client Jasmine server integration so if
i go into cucumber we can pull up
collections and we can look at chapters
right here and you can see that those
chapters were inserted as part of the
fixture so what happens is when when a
meter get started that fixture file gets
copied over and run in the meter
environment and then it's doing the
insertion into the meter database any
questions about fixtures before I move
on Oh Josh yeah if that check for his
iron ore is we're returning what I
exactly d return there and end okay so
this may be this is unfamiliar to some
people but basically we've wrapped
everything up in a function here and we
call the function to run so this is just
all anonymous code and so when we if
will be hit line 5 it's going to stop
running everything inside this function
so we'll never get to line 8 does that
make sense yeah okay just a fancy way to
break out hey Josh had a question to the
way the weight is did the fixture
inserts um does litter press I can't
remember his letterpress already have
some of those fixtures as examples like
that in there it does but Sam raft
up and cleaned it up a little bit so if
you go look follow Bo letterpress yeah
so the star
I was like this clear state and in the
testing class we did we created a fake
inbox so we could check mail going in
and out of the system and then there's
this clear state like unsub the mailbox
if we need to and then down here is the
chapter insertion stuff okay cool all
right so did the fixtures so now we can
write some actual code here look at our
router here with me here Sam rates as
routers different than other people
oh this was before we put
ok
so right here we can just insert a
chapters template and since we don't
have iron-router I'm just going to put
my template right in here chapter news
it in here we'll just make a simple
structure so if we'll call chapters and
then we'll loop over each chapter's
close the loop i will do h2 with a class
of chapter dash title because we like
vem title in there close the h2o key tag
what chapter description the description
in there who's the P tag and that should
be it for our template and then we just
need to write a helper to make it work
so go look at the yes here template job
chapters that helpers of a script object
in the air chapters function
return chapters will chapters dot find
and you always want to write like the
minimal amount of code you can to get
like a step passing well it's a lot of
failures you can already start get a
clean cucumber run here this should
still fail for us there we go so the
first test were Jasmine by the way and
then the the second test here the
cucumber's steps so this chapter will
cover item 2 equals equals this chapter
will cover item 1 these aren't equal and
we're getting a failure here because
we're purposely like testing for sorting
and ordering right so we're moving
further down that stack we've moved from
hey you don't have AP tags on the page
too hey you're not quite asserting the
right data at the moment so if we throw
a sort in here and we sort by chapter
number ascending just a fully pass asmin
sing hmm our cucumber didn't rerun oh I
think we're running on an older version
of cucumber here I'll just restart so
038 has fixed quite a few bugs one of
them was like when the client refreshed
and changed code it didn't rerun
cucumber so that's the bug we just saw
there that's been fixed alright cannot
read property value of no none no should
be passing um eine is that so we called
somewhere I'll Lenny pay
r7 visitors can see a book heading yeah
that should pass there we go and now
we're all passing so I've been showing
you you know the console output but the
other thing you get mark showed you guys
earlier in the meetup that we didn't
record but you get the you know the this
nice velocity guy over here the HTML
reporter and so you can see these are
the steps I wrote and so if we comment
this out we don't return anything four
chapters we reload just really upgrade
this app you run to get the red X so you
can kind of see like it's running tests
things are checking off we get down to
cucumber we got the failure and we get a
big red X so that's what was going on
behind the scenes I was just for me I
like to stay in the console so I tend to
watch you know right right here in the
console oh right two minutes to spare
any questions general questions specific
questions
yes i can now a question for Josh anyone
bueller bueller statement s complexity
so Josh Nia back to my question is about
figuring out the best way to see test
driven development major development but
I intest priority Oh Cody like how do
you honey mentally approach like let's
say you're doing cucumber and how do you
mentally approach like I'm gonna write a
test for this story um if you maybe
don't know all the pieces yet on the
minister maybe don't know all the
mark-up teaches it kind of takes tabs
that what you think it's an h1 or ruby
in paragraph and just start there or oh
my would be to say that I'm going to
mute you for a second while I talk I
would start with either one you're going
to have a designer involved in the
project or like a stakeholders going to
be involved and they're going to help
you write some of the cucumber stuff but
then what you don't want to do is just
think about like if you don't have HTML
being handed to you because you're
writing it and I would say yeah I would
absolutely just kind of think through
like semantically I mean we knew we had
a chapter description in a chapter title
kind of ahead of time but I mean if you
just kind of like mock out the page like
you can even do I don't know if you've
seen like 37signals drawing types I do
like these drawling mock-ups or they
don't you know they don't really put
words on the page but they you know just
kind of draw it out and I think like you
know as you start to think in this way
your Ilah is like hey what are the key
elements on the page and you know what
are these like this this box here maybe
indicate some kind of header and these
are checkboxes and I guess this red ones
like a call to action or a button of
some kind and this over here is like a
grid or a table
some sort so you know like there's gotta
be something that triggers this this
thinking for you you know that makes
sense oh I muted you hold on well and I
can unmute you I have to unmute yourself
sorry okay yeah that helps um I helps a
lot Josh in so it sounds like even if
yours you're saying even if your markup
you can offer our dreams and just say
hey this would work we have as soon as a
head here this is a button this is what
every but I've been also high because
it's somebody that sort of thing needed
thinking about him working with a
designer East actually make one with his
arm but it probably pig that you so
happens we yeah I would definitely come
in have an advocate for design first
development is low works yeah in that
case tennis okay then yeah I'm just sing
cups of time so say you already
mentioned I'm gonna keep asking
questions and Hoggett studio sessions
but oh so you already mentioned that
there is a couple pieces like the
fixtures thing that isn't the same as in
the beauty cover as you can my creepy
land but are there other things that
aren't there yet and cucumber are meteor
that ever made you come in or they just
aren't there of all come later yeah Oh
me again because I get a bad echo but um
yeah there's definitely some pieces that
aren't there yet so with meteor and
cucumber KS we're relying on the the
ghost driver which is a wrapped up
version of webdriver and phantom Jas and
the problem there is and this was this
even got us starting the class like we
didn't we didn't realize this was a
problem but they have what they call a
cookie jar and it's shared and it's just
like I mean it works just like Safari so
when you're
browser tab one and you open up browser
tab 2 and let's say you're on Twitter
and browser tab one you know you go to
like twitter com / drop in browser tab
to it browser tab to knows that I'm
logged in well that that's great when
you're in this browser environment but
when you're in phantom jsu really want
that to be like not shared and you want
those cookies to be gone on each test
run and that's just not the case like
there's no way to get at those cookies
and like get them out of there so I
spent some time trying to get
chromedriver to work I didn't have a lot
of luck with it in my one hour stabbed
but I know when phantom 2 comes out and
you know the the ghost driver gets
upgraded that should fix this problem
but the problem is like this problem has
been fixed for like a year in phantom
jas but phantom 2 has never been
released and therefore like it's not
making its way into all the other spots
that it needs to to get into cucumber
j/s here so that that's probably a big
one and what ends up happening is like
in test one if you do like a sign in and
then a test to you expect to be signed
out like that's just not the case like
that states being saved so the way I've
gotten around it right now is I just got
like a global before hook that calls the
sign out route and make sure that you're
signed out so then we're starting the
test in a in a clean state and the other
thing that is maybe a little bit
different you have to make sure that
you're waiting on the things to show up
on the page so I wrote some tests for a
client and in particular like the sign
out stuff it would fire and run the call
back but it wasn't actually signed out
all the way and so like the next you
know that global before would finish and
run the next step before it was actually
fully logged out and therefore like the
test was failing and I was left
scratching my head like you know why
isn't why isn't that working and so the
way that you do that
I go back here B and features studies
the museum just a hair on that yeah
awesome thanks perfect all here
pretty sure it was in here yeah so you
can do a wait for exists and a wait for
visible when you're in cucumber and
basically it'll tell it to wait and i
think the default timeouts like 500
milliseconds sort of weight 500
milliseconds for that button to show up
and wait for exist just means it's in
the HTML wait for visible means hey you
can actually see it on the page it's not
like you know hidden or anything like
that and the other thing that is it's
just nice for debugging is you can say
save screenshot and then just give it
you know the current working directory
plus a screenshot name it'll actually
take a snapshot with phantom jas of the
code running and I may have I think I've
got a saved saved one in here somewhere
yeah like auth one so I can just say
open and like this you can see like it
was logging in and the page was loading
when it took the snapshot so you're kind
of able to debug and see actually what
the browser seen tickets please tickets
please so those are those are probably
the two big gotchas right now just
paying attention to the like
cookie-based up like session based off
like log in on log out and then making
sure you wait properly before you move
on and your call back if you're if
you're going to search something or wait
on some element or something that is
that's definitely a good tip for sure
what what other questions do we have
I'd push grunts creature can you show it
screenshot following in yeah okay so
that process and the PWD do you go what
exactly is that s the current directory
yeah that's a no thing oh okay so you
just saying throw in the car directory
okay save it to the current directory
you know is it possible to throw it in
safe / or just that is dude I don't
exactly i'm wondering me it what
directory remain in your eng test when
you call PWD it's gonna do what I just
did amazon solace yeah yes so I don't
know I don't know if a little works or
not but ok now that make sense what does
that say when it to the root of your
meteor app then or yeah yeah okay I mean
you could add a path and and put it in
the Testament says yeah yeah that's
super handy to have screenshots
especially things fail you see what's on
screaming yes the other thing is go to
the dot media folder into the build go
into local this isn't documented very
well but if you're going to build uh no
not build me to your local log then you
can see we're actually spitting out a
bunch of log files here and so you can
just cat cucumber doubt log and you can
see like this is where a lot of that
output goes so need to consult out log
it ends up right here that's an awesome
tip right there yeah that's not
documented at all Lana you got Jasmine
webdriver logs which stuff hmm yeah this
was a I got this one from yonas sanjo as
most people know he pointed this out to
me yeah you can see like clearly these
streamers are coming from
something in on his end not something on
cucumbers end but yeah you can actually
see like these males are being sent and
that's getting spit out here it's kind
of funny so is that is is that something
that's in letterpress now is actually
testing male yeah yeah I can show you
that real quick would be awesome so the
way that that works is in the fixture he
calls in it fake inbox and he's got this
underscore fake inbox collection that's
being created uh somewhere yeah up here
on line 10 so he's just he's making his
own Mongo collection right in your
application and then he basically stubs
out emailed out send and replaces it
with a you know fake inbox collection
insert so he's just literally taking the
email that's being passed to email not
send and shoving it into the database
and then he calls create JSON server out
and tells it to answer at fake / inbox
like all this should be wrapped up in a
package totally worth it and then the
gold yeah and then here he just um he
creates a router route that you give him
and just sets the content header to bj's
on and then string of fires you know
everything and makes it work on the
server and so that way in the we can go
find a test I think he's using like
which one this is laney pages should be
the one
yeah so right here he he says then I
receive a confirmation email from you
know blah blah blah he pulls in the HTTP
package and then hits the fake inbox
route and grabs out you know the data
and grabs the first item in the array
and then he starts running asserts right
against that since we're just getting
json back like HTTP GET does the right
thing and that is really sweet um so
Sydney so this is issuing so since eat
since he since when you're stepping out
and like emailed us and you're basically
just Rida clearing something that's been
declared previously how are you guys
with velocity and these testing
frameworks making sure that the testing
pieces run later than everything else
these are some trick to that or is it
just um well part of that is the mirror
like the the mere starts up and then
like the velocity stuff doesn't really
like fully kick off until it says the
mirrors ready so that in kind of ensures
that all this this stuff is done and
then the fixture runs like before any of
the other test kit run so that kind of
ensures that your fake inbox is in place
ahead of time ok cool and then the the
other cool one here is
see if he's released it there's a fake
github I'm pretty sure he also had a
fake Twitter we couldn't get the github
to work doesn't look like he's done
twitter yet so that the oh yeah and here
it is this may not be released as a
package yet though that could be the
problem so it does so its handling neo
off and everything like simulating a
walk with Twitter yeah and so you can
just set up this data right here this
Twitter stop fake data user and anytime
that it's going to detect that you're
trying to make the OAuth calls it's
gonna like catch that and stub it out
and return this data instead and so the
the key point there is like these last
two things that I've shown you those are
test boundaries and I think when you're
writing tests you should think in the
mindset of like if my internet
connection is down I still want my tests
to pass and so that's why we do things
like stubbing out the email and stubbing
out the you know the OAuth stuff because
you want to make sure that you're
testing your stuff not necessarily
twitter stuff and probably the greatest
example of this was like I left Google
OAuth are not Google oh I left Google
Analytics in my test environment and you
know we were running automated tests and
we had just deployed like payment and
playing signup code on this app that we
wrote and you know we were using CI and
it was doing the automated deployment
and all that stuff and I go into Google
Analytics and it's like oh my gosh look
at all these like we're getting people
are signing up left and right like this
is this is dream come true for an app
builder this crazy and then lo and
behold like we start looking and all
these signups are coming from Germany
and we're like huh this is weird and it
turns out the CI server that we were
running with was in Germany and it was
issuing all the sign up calls in the
test mode and all our goal
lesion was actually happening just in
the you know in the in the test
environment so you must have had a lot
of david hasselhoff images on the app or
something yeah so questions Jeff you got
a question I've got one for Jeff I'll
ask on behalf of death and bio um so so
it looks like cucumber is it you know we
kind of mentioned kind of flip kind of
how I was thinking about stuff a little
bit but it makes sense so you're talking
my cucumber Josh writing those in tests
like kind of starting with those is a
good first step in a testing and um it
seems like that is absolutely maybe a an
awesome way to for designers and folks
again wobble testing um because it seems
real accessible yeah I would agree like
anyone that is um oh maybe I need to go
anyone that's like getting you know even
if they're not writing the the step
definitions like if they're if they're
writing the even the given when then
steps I think that's like helpful to
have someone other than the developer
right that like if you're the developer
writing that stuff then I don't know I
think there's a little bit lost their in
my opinion so they use the point easily
lose the point of like a process where
someone's defining what it should do
it's closer to the to the specs maybe
anything this how I shouldn't run and
then heading off to the developer than
to implement that makes sense yeah and
if you if you just want to go the other
route right like you don't have
stakeholders and like they're not going
to get involved and you don't want to
write like the gherkin steps and then
have it translated into step definitions
there are other options as well there's
like Night Watch selenium and there's
now someone's
a python framework called robot
framework and it's an end testing you
have to have Python installed but it'll
it'll get you all this stuff there as
well so that's awesome yeah well it
sounds like Josh you might need to take
off too and uh if if folks don't have
any more questions and sentences like we
don't have any more cards at this point
i would say this has been awesome Oh
unbelievable man I appreciate you doing
this tonight trim let's give Josh your
hand garlic and Josh you got to take off
will let you go but this has been
fantastic so we appreciate you doing
this well thanks for tuning in guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>