<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Serverless Event Driven Application Architectures - Crater Conf JS 2017 | Coder Coacher - Coaching Coders</title><meta content="Serverless Event Driven Application Architectures - Crater Conf JS 2017 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Josh-Owens/">Josh Owens</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Serverless Event Driven Application Architectures - Crater Conf JS 2017</b></h2><h5 class="post__date">2017-07-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2JJMH-nwCQI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to this crater cough 2017 video
a big thank you to all the speakers that
took time to give these talks hopefully
you enjoy this video series and also be
on the lookout you can go to credit on
Io to get all the latest JavaScript news
and you can also follow me on Twitter at
Josh Owens and we've got some other
exciting stuff coming up in 2017 Thanks
enjoy the video
we have David wells with us he's going
to talk about serverless you actually
work for service don't you did it I do
indeed but what I'm talking about today
is kind of the overall picture of what's
out there with surrealist not
necessarily like what our company does
yeah I actually saw I got to see two
demos I ran a confidence in North
Carolina please take off the coast there
anyway
one for him but like I saw two demos of
that that thing back-to-back and like it
just it amazed me how easy it was to
like deploy things and get everything
hooked up and everything was just like
working together and they were I think
they were using meteor a little bit as
well and doing like real-time updating
it was super slick so I just knew this
we we hadn't had someone talk about
service and you the guys yeah for sure
things away glad to be here all right
cool so let's talk about building
serverless applications with nodejs
and a little bit about myself I'm a
full-stack developer in San Francisco
working in a start-up called server
lists you can check us out at surrealist
comm but what I'm talking about today is
more about just the idea of what
cyrillus is and how developers can
leverage that to build and scale out
applications kind of in a way that that
we haven't been able to do before
without a lot of developer operations
and what have you so the quick agenda of
this
presentation we're going to jump into
what exactly serverless architectures
are it's kind of a confusing term to
some so I'll dispel all those things
we'll talk about some use cases and some
real-world examples and I'm going to
show a couple of demos and then we'll
jump in the Q&amp;amp;A again but cool so let's
get started so server what server less
what is this thing that you speak of
of course there's servers at the end of
the day but really what we're talking
about is how developers can use this new
technology without having to deal with a
lot of the previous things that you had
to do with maintaining and scaling your
own servers and so it really seems like
it's all the rage these days in terms of
the buzzword that you'll see all over
hacker news and Twitter and
what-have-you but let's dive into
exactly kind of what it means so to me
server list is really these things
services is basically a new approach in
building and scaling out your
applications like I mentioned so your
servers while you don't actually touch
them ever
they auto scale for you there's this
concept of everything's event-driven or
push based so instead of pulling for
data or having machines kind of sitting
there idly everything's event based so
if the new user signs up to your service
that triggers and events that then
triggers you know the welcome email for
example and we'll look into some use
cases that in the future here you also
never pay for idle machines so I can't
tell you how many side projects I've had
in the past where I was running on you
know digitalocean droplet or on Heroku
where you know it's really just me and
maybe my mom and some other users using
it but I'm paying monthly for that so it
started it basically add up the cost add
up when your machines are running and
really not being used and most
applications kind of fall into this
category and yeah so basically it's kind
of one of the paradigms of serverless
like when you're using AWS lambda or
we'll talk about some of the other
providers as well you only pay for what
you use by the millisecond usage which
is amazing and kind of was the light
bulb that got me kind of into this space
the other the other thing is like the
systems are implicitly fault tolerant so
if let's say that you launched your
application and you get on the front
page of hacker news you're on the front
page of Reddit your whatever reason in
New York Times picks you up and put you
on the front page you don't need to
worry about scaling out your servers you
don't need to worry about a basically
downtime with that huge rustle of
traffic the actual provider under the
hood
AWS Google or IBM or Microsoft there's a
ton of them out there they'll actually
scale out those servers for you so it's
kind of like auto scaling on steroids
where you really don't have to you know
scale up dinos or do anything yourself
it'll just do that out of the box for
you and the other kind of idea here is
that you want to break up your
application into smaller pieces it's
really taking a micro services approach
to how you build your application so
instead of building a really large
monolithic application with all the bits
and pieces in there or you have to
deploy it all at once it's really about
breaking out your application into
tinier pieces so you can deploy them
individually and they can scale
individually as well and then there's
also this notion of offloading things
that aren't your core business
competencies to third-party services and
that's for example like if you know
re-rolling like user off for every
application doesn't really make sense or
writing your own email sending server to
send transactional emails doesn't make
sense because there's these amazing
third-party services out there like nail
gun or auth0 that do all that for you
and do it extremely well so you can kind
of focus on your actual application
rather than you know building out those
that kind of glue glue where if you will
so and this is this is the one thing
that people get hung up on is like
there's no servers of course at the end
of the day there are servers the
difference however is that you no longer
have to maintain patch upgrade or scale
these yourself all that stuff is kind of
abstracted away from you and kind of the
whenever I get a tweet like this or
asset a conference you know there's
clearly servers yes I explain you know
why it's different and then I also throw
out you know yeah think about your
wireless router for your you know your
Wi-Fi is it truly Wireless like you may
it is to you it's the wires are
abstracted away from you but at the end
of the day there's a router in your
house somewhere that's connected to a
wire so it's kind of the quick tidbit I
like to give about that and so running
like service architectures like server
like our company server list we actually
all we have is a we have an open source
framework to let you deploy your
applications that's really it we're not
a hosting provider we really plug into
the main providers out there and these
are some of them so we have AWS lambda
this is Amazon Web Services answer for
their compute layer IBM open wisk Google
Cloud functions and Microsoft Azure
functions and really like the biggest
player out there right now is def by far
AWS lambda I'd say they've had like
around 80 percent market share some
and that but the other ones quickly are
building out their offerings and it is
yeah it's basically like the
competition's heating up and it's pretty
cool to see all of it like basically the
four biggest tech companies offering
these services seeing kind of the value
in this serverless event-driven paradigm
a question I get asked a lot is like how
are these different they're different
they have different ways that you write
your functions there's slight
differences between them another
difference is the runtimes that are
supported obviously this is a JavaScript
focus conference I believe yeah all of
them support nodejs but for example I
believe as your function supports PHP
and some other languages that AWS lambda
doesn't support right now a dev is
lambda does Python node.js and Java
another difference would be with IBM
open wisk it's completely open source so
you can actually see how it's
implemented and actually to pull that on
your own infrastructure so if you wanted
to run an on-premises version of a you
know compute layer like this functions
as a service layer you could do that and
another kind of honorable mention here
is web task io from auth0
so it's a kind of a bare-bones
function a tool but it's basically you
can run kind of functions on demand as
well the cool and as a side note we just
added support for IBM open whisk in the
service framework we've been primarily
simple supporting AWS because it's you
know the largest marketshare but we're
working on adding in all of these
providers to the framework
so how did we how do we get here how did
how did servers come about how to
dysfunctions as a service offerings from
all these different you know huge
Technic companies come to be it really
it goes back to the history of how we
built and deployed applications you know
way back in the day you would have to if
you're running an application at scale
you'd have to go you'd have to build a
data center and you know have a whole
team you know building the hardware
building and maintaining that data
center then we kind of evolved from that
into cloud computing kind of world where
we started with virtual machines so
instead of actually maintaining and
building around data centers you would
you know print space and run virtual
machines on their boxes that kind of
evolved into what we see with things
like Heroku and the platform of the
service movement where instead of you
know having to deal with that those
lower-level
pieces they kind of give you a platform
to just deploy your application to and
that then the inevitable conclusion is
the serverless space where it's really
just functions running on demand where
you're not paying for any of that idle
time yeah so it it's really interesting
to see how all these things kind of
evolved and how all of these different
levels of abstractions build upon each
other but yeah so what so like some of
it is like main principles of a service
architecture and this is taken from a
presentation from Sam cranberry and
Peter Sabarsky
of a cloud guru the game and check that
a cloud guru highly recommend it if
you're trying to learn any of the
providers like AWS or Google cloud etc
they have a ton of amazing training
videos that's actually as a site now
that's actually one of the hardest parts
of getting started with we service kind
of geek
system is learning AWS or learning
Google cloud functions etc so highly
recommend that and checking out this
presentation that they gave cool so
basically the principles we want we need
to use a functions as a service compute
on demand layer so our code we're
deploying it up as functions it's
running on demand when it's called by
our application everything is a single
purpose stateless function so again this
kind of micro services approach it is
everything's pushed based and
event-driven so based off events that
are happening in your system things are
happening and we'll see some examples of
that in a second here
and then it also has this notion of
creating thicker more powerful front
ends so the browser is getting more and
more advanced and I'm sure you know all
the JavaScript developers listening know
that with you know react and a bunch of
the other front-end frameworks it's
really a it's really getting cool what
you can do on the front end and I'm
going to show you an example of that as
well and then that notion that I
mentioned before embracing third-party
services so i'll floating those core
concerns that you're uploading the
concerns that aren't core to your
business or your core business
conferences the value that you're
delivering to your users like
authentication or sending text messages
or emails or you know you name it
there's probably a third party source
out there that you can leverage instead
of rolling your own
so let's jump into some use cases and
then we'll jump into some actual code
examples so the use case is a server
lists everything alright presentation
over just kidding there is an asterisk
there there are some limitations that
will jump into but let's look at some of
the examples of really what we can do
some of the use cases might spend a
little bit of time on this slide because
there's a lot to run through ok so first
things first
one of the biggest kind of use cases
that we see is using it for web and
mobile backends so if you are creating
Express applications in nodejs
you're familiar with like kind of the
requests response model really what you
can do and there's actually a project
out there Express slammed and I believe
it's called from AWS that you can you
can port over your existing Express
application chop it into functions and
deploy that to AWS lambda and then
you're only paying for the actual
invocations of those API endpoints and
you get that raw scale out of the box
and so so really and you can use the
entire power of the NPM ecosystem to you
know build whatever functions that you
want so exactly like you would be
building on an extra you know in Express
for example you could do that with a
function that you could pull that to
lambda yeah so another use case should
be for processing which is basically a
back-end API we use that on our site
showed a demo van in a little bit
we also another use case is image
processing so you can basically have a
API endpoint set up listening for image
uploads and once an image gets uploaded
and dropped into let's say an s3 bucket
SPG is
full storage service from AWS once a new
profile image gets uploaded by the user
let's say that they uploaded an image
that's way too large or would be a
performance burden if you know someone
saw it in the front end of the
application you could automatically kind
of listen to that when a new image is
added to a bucket then you can throw it
in through a lambda function to resize
it back to a you know suitable size for
the web or create a thumbnail of it and
then put it back into an s3 bucket and
that's again all kind of we've been
driven and we have a diagram of that in
an upcoming slide here another use case
would be web scraping or testing so one
of the things that you can do with
lambda is as well with node is run
binaries so you could basically run a
binary of phantom Jas and do web
scraping or run something like just
through using the request module request
HTML web pages use something like curio
to parse the HTML and then return a
response to you and by the way and this
is getting into some of the other use
cases here everything doesn't have to be
a request response with a lambda right
so if you wanted to for example mix and
match some of these use cases here you
can basically set up a cron job in AWS
lambda to say okay every day go and
scrape you know my favorite sports teams
website.com to see if there's any
updates if there are any updates use of
Twilio a sdk from NPM and you know send
me a text message of the updates yeah so
it's really you can kind of mix and
match skews together to do a lot of
interesting things another use case
would be serving HTML or dynamic
binaries and what I mean by that is like
so when someone hits your API gateway
point you don't have to just return JSON
for you know an API to consume you can
actually return HTML or image files any
any type of binary or SVG etc so a use
case of this would be if you're running
a marketing campaign and your your
traffic is going to end it's a dynamic
page and you like basically your
respective spiky spiky traffic you could
basically set that up behind an API
gateway endpoint and return the dynamic
HTML to the visitor and I would kind of
scale for you out of the box another use
case and this is another example that
I'll show you guys is web hook listeners
so there are so many amazing fast
products out there and tools like github
that expose web hooks so when something
happens in github they if you plug in a
web hook listener they will post an
event out and let you know about it
but before this kind of compute
on-demand service was available you
would have to set up your own server and
again pay hourly for that server so
doing a really quick simple applications
wasn't really didn't really make sense
from a cost perspective or a maintenance
perspective but now that's kind of gone
by the wayside because your code only
runs when like the web hook fires so
you're not paying hourly for usage and
you don't have to maintain the server or
worry about kind of security risks and
stuff around that
cool and I already mentioned cron job so
yeah basically using cron syntax you can
run lambda functions whenever you want
we have a buddy on our team here at
serverless
is using it to remind him of when San
Francisco Street cleaning is so like
every third every every second week
Thursday or something it will get a text
message to move this car which is
interesting another use case would be
DevOps or infrastructure automation so
you can listen to AWS infrastructure
event so if for example you have a team
member spending up a new server like a
new ec2 instance if they are still using
you know if you are still using servers
which there are some use cases for that
which we'll get into but basically you
could basically listen to that
infrastructure events and then run for
example a security audit to make sure
that all of the checks you know
everything is in place so there's no
security risks exposed by that machine
and if there are you can automatically
spin that down with a lambda function
which is kind of cool
so more infrastructure events like I
mentioned s3 so if the new file is
uploaded or a file is changed that will
fire events and lambdas can listen to
those and react to them like resizing
images or transcoding video files you
know etc and then also there's a huge
list of infrastructure events on the AWS
website if you google it but another
interesting one is is the dynamo DB so
if a new item is added to your database
basically a lambda function can listen
to that and then you can react to it so
like a really good use case something I
was not super trivial to do well it's
harder than needs
to be to do the old way would be if a
new user signs up to your service you
want to send an email usually you'd have
to like batch that or if you're using a
micro services approach you'd have a
separate service to do that but with a
dynamodb event you can just look in hey
there's a new user added to the users
database send them the welcome email
super straightforward and in my opinion
a little bit more logical to follow when
looking at architecture of what's doing
what when things are being triggered by
events and then of course you can set up
Alexa skills so you can say hey Alexa
when is my bus coming or whatever set up
your own custom to command to do
whatever you want
IOT events so if you're doing anything
in the IOT space you know raspberry pi
org we know or what have you there's a
you can basically plug in there and then
box as well box is another pretty big
use case that we see so if you want to
type in you know a specific command into
into slack and have a land of function
listen to that you know you could set up
a bot to do that and cue custom things
cool so what service what can't it do it
can't run the processes longer than five
minutes so if you're doing some like
intense processing or you know data
manipulation that takes longer than five
minutes Landa really isn't the answer
for that right now - limitation from AWS
I don't know if they're going to lift it
or not the interesting see but there are
some workarounds however to this you can
and this is you want to be extremely
careful when you're doing this but you
can run recursive lambda calls so you
can have a lambda function that calls
itself until it's done doing what it
needs to do with
data that's passing from one call to
another you want to be careful with that
because you can run into a you know
infinite loop and see a nice bill in AWS
lambda yeah and another kind of more
sane workaround would be if you have a
process running longer than five minutes
if it's triggered off by some sort of
event like a user clicked a button to
say like okay process my data or
whatever in the UI you could use it you
could listen with a lambda function so
the lambda function is listening here's
the users requesting this long-running
process that lambda function then can
spin up an ec2 instance or machine
learning instance or whatever you're
trying to do that's like a really long
running process do the job and then
return the data to the user so there are
some workarounds there but that is one
of the limitations
cool so let's look at some examples so
some examples of event-driven
application so this is a cool this is a
fun one that was sent to me by John
McKim over at a clock guru he writes a
lot of interesting posts on medium as
well I recommend checking out but this
is a serverless app that you know the
client uploads an image it gets put into
an s3 bucket the on created event fires
and there's a lambda function listening
that land of function then uses this is
another AWS service called recognition
for facial recognition the image gets
passed over there and then it will
excuse me overlay emojis on people's
cases this is a silly example but you
could extrapolate this to you know doing
things like you know making sure
pictures are safe for your website or
you know really yeah basically tagging
people in photos and social apps
fun one but I like showing this one
because it shows the event-driven kind
of nature of these applications so one
thing happens and then another thing
happens etc here's another example is a
surrealist screenshot service using
lambda and there's a blog post over on
our site if you want to check out
exactly how this is done the repos there
as well but basically this is using what
I mentioned before using a binary
phantom Jas which is a headless browser
be given tried Fanta that's super cool I
recommend checking it out but basically
you can take screenshots with it
and do a bunch of other stuff but this
service will listen to an incoming
request for the URL it will then spin
out the lambda function that then you
know starts up phantom phantom will go
take a screenshot and then store that
into a bucket and create a thumbnail so
there's actually a couple of different
functions here composed together so
there's a create function screenshot
then puts it into a bucket is to create
thumbnail so the screenshot might be too
big to actually display on the front end
of the site so it will create a
thumbnail put that back in the bucket
and there's also like a list screenshots
function that I guess returns to the
user but a pretty cool project and yeah
so another use case this is from our
server or sorry from our website so our
site is 100% serverless meaning I mean
it's still there still a server at the
other day there always is but it's
basically a static site built with Sonam
ik it served up from a CBN so like we
kind of get that raw scale out of the
box we don't need to worry about you
know spikes and traffic or anything as
you trying to react on the front ends
that's why Phenom accuses to do the site
build
and then some functions that were using
so we have lambda functions for
processing forms so someone fills out
our contact us form you know that I'll
go through lambda function and route to
the appropriate person we also have 404
tracking set up through a lambda
function so if you hit a 404 page it
will hit a lambda function store that
URL in a dynamodb table and let me know
that basically there's broken links on
the site that we need to fix and then we
also have some protected API calls
and I'll show you guys that an example
of that in the next slide and we also
we're working on doing some serving up
some dynamic routes serving HTML form
lambda functions it should be
interesting she asked so basically like
all this stuff will scale without like
lifting a finger it just will work and
the greatest part about it is you know
we only pay for when it's being run and
a side note on that which I haven't
mentioned is like AWS lambda and all the
other providers have a very pretty
generous free tier so I believe it's a
million invocations a month for free so
if we were getting you know more than a
million form requests then we would pay
money for that function which we don't
get right now maybe one day but you
could see how you know with that
generous free tier you could build out a
lot of standalone applications pretty
pretty easily and pretty cheaply if not
free with the free tier so that was also
kind of one of the selling points to me
I can basically set up all of these
different side projects and different
you know IOT apps that I want around the
house without really needing to pay
monthly for those boxes anymore cool and
this is a this is a example of a
protected API route basically the user
logs in via off 0 it goes in through API
gateway lambda gives you the ability to
set up a custom authorizer function so
like if the JSON web token actually
validates then they can access you know
the authenticated user endpoint if not
big it's not authorized response back
and it tells them to log in or to you
know upgrade their account or what have
you this is a live demo as well at this
URL if you want to check it out it's
pretty cool and really using this so
this is using all 0 for the
authentication and the JSON web token
stuff but really this is kind of what
you would need for a you know SAS
application front-end where you know you
have a home page maybe and then you have
a login screen and then you have your
actual application that you only want to
allow people that you know pay money to
use that demo kind of show you how that
works and some additional examples can
be found on the github comm slash
serverless
such examples yeah we have a ton of them
a ton of them and we just added some for
open Wisc as well so for your various
use cases out there you can actually see
the code and how to do this and then as
a quick aside finding other examples if
you go into github and search globally
for dot cyrillus and then search for
recently updated you can actually see
what people are doing what kind of
service applications people are building
I do this all the time it's it's super
interesting to see the kind of complex
applications people are piecing together
again taking that micro services
approach but yeah so highly recommend
checking that out as well
umm cool so those are those are some of
the use cases let me check the chat
okay we'll come back to that
alright so who actually uses this though
like if it just for you know your hobby
projects is it just for things that
don't really need scale etc answers now
some of like the largest fortune 500
companies are using lambda in production
today you know Nordstrom coca-cola VEVO
Autodesk I mean Amazon of course is
using it because everything that AWS
builds is for like to support amazon.com
Accenture I mean there's a ton a ton of
ton of very large companies that are
leveraging lambda at scale and again
yeah it's just they're seeing they're
seeing cost benefits from it and also
kind of the more agility from this
approach as well because if you don't
need to wait for DevOps to basically
provision a machine for you anymore
you know teams can move much faster and
be more agile and this is a shout out
this slide is from the serverless State
of the Union address from reinvents
happened a couple months ago highly
recommend checking out that video really
good it's Tim Wagner the guy in charge
of the lambda team over there they talk
about some interesting use cases and a
lot of the kind of auxilary services
that you can leverage with AWS lambda
cool and yeah these are some more
examples so sir vada serve Otto's an
interesting one their company here in
San Francisco they do survey survey for
ad effectiveness but they're basically
using lambda to process hundreds of
millions of events and actually drop
cookies on people's machines to make
sure that they're surveying Mary people
which is interesting and then another
cool one is Netflix Netflix is using it
for parallel processing for encoding
media files so one of the one of the
cool things that I haven't mentioned yet
is so I like the lambda functions when
they fire you can spin up multiple of
the same lambda function at the same
time which means that you have the
ability to do like parallel processing
like to infinity and I'm doing bunny
ears there because nothing can go to
infinity but I add a very very large
scale so what Netflix is doing is that
they are taking a video file and taking
the frames of that video file splitting
those frames up and then basically
indicating you know all these lambda
functions to shrink them down or what
have you all the same time and then
putting them back together at the end so
before you know that might have been a
really long running process on one
machine but yeah you can basically run
things in parallel and do things super
super quickly so you can think like kind
of batch processing on steroids cool
and then yeah definitely check out a
cloud guru their entire site as well is
serverless driven really cool what
they're doing they're actually
leveraging firebase as well so it's a
it's a you know video tutorial site when
a person I want to when a trainer
uploads a new video that gets stored
into firebase and if a user is logged in
on that on that training page
you know course they will like real-time
see that kind of new file show up which
is interesting cool alright so that's
enough of me chatting let's jump into
some demos so I can show you some real
applications bill with this so let me
pull this over here okay so this is the
serverless status board it's a project
we just released
it's called scope and basically what it
allows you to do is it's a completely
service application what it lets you do
is deploy a customizable view of your
project so this is actually what's
happening in the service framework right
now this is all event-driven
so
the issues coming in are maps to a
specific column which you can customize
and what-have-you
let's actually take a look at the
backend works
me
yeah okay
cool so it's basically like this is the
architecture so you have a github repo
some activity happens it triggers a
github webhook that goes through API
gateway to our post endpoint and then it
basically triggers our lambda that is
listing for the event and saves it into
DynamoDB so the code for that actually
looks like this so if we go into the web
hook listener you can see that you know
I'm using you know normal NPM modules
and the section the core one and it's
simply like a function with that accepts
an event context and callback it will
look at a simpler example of this but
this is basically verifying the github
webhook request to make sure that no one
else is hitting it but github once it
does that it processes the data and then
saves it into the database so pretty
simple code very similar that that you
would write as you know in a standalone
node app except you know this is running
only when a new event or new comments
our new pull request happens in our
github repository and then that gets
tossed back into the status board so we
can see yeah and we have the recently
completed section here as well and I
could sort this as well to see so we
needed this person like for the service
project because there's a lot of stuff
happening in it and we can kind of sort
and see like okay what are people really
you know interested in or what stuff do
we want to highlight for our community
to jump in and get involved with so
that's kind of one of the reasons we
built it and then I built it so everyone
can use it for any github project yeah
cool so that's
one piece of the backend so that's the
github webhook listener and then the
second piece is just an a a simple API
call to the dynamo DB table so we go
through API gateway it triggers the
lambda function that lambda function
goes and gets the items out of the
DynamoDB table and then we'll type that
back to the UI so really really simple
service application but again like we're
running for in under the free tier of
AWS so that is the one example and let's
actually look at a demo so here's this
is actually the this is the Dynamo table
so let's see it in action I'm going to
go close an issue on our let's close an
issue and then reopen it can probably
not closed yet
so here's an issue that I made
there's a vague error in our CLI and I
don't like the errors so I'm going to
actually close this
and if we come back into dynamo what
what's the ID the ID is three 3221
so that's not on the closed items right
now but if i refresh this there it is so
you can see that that lambda function
triggered and stored the item in the
dynamo DB table and then the reverse so
if I reopen the issue because it's not
closed we do need to fix that it'll
actually go ping the lambda function to
remove it and put it back on the open
item stable so that's a really simple a
useful kind of example of a service
driven application that like we don't
have to set up our own server to run
this stuff this thought that this will
just run forever it must github changes
there webhook syntax for us and we can
just embed it on our site and kind of be
off to the races so that is the first
demo that I wanted to show you guys when
we go back to my slides and yeah I
already talked about the API
so let's actually do another demo real
quick
let's do it will do a live deployment of
a service so hopefully this is big
enough zoom in ok so and again like you
don't need to use a service framework to
do this you can wire all this stuff up
yourself
it's rather painful to do so in the AWS
user interface so highly recommend NPM I
server lists - gee that'll install it
globally but once I have service
installed I can basically sort SLS
two different commands where I can
deploy roll back stuff and do a bunch of
crazy things but for this demo I wanted
to show you guys basically how to we're
going to create an infinitely scalable
API endpoint right now and deploy it to
the Internet
okay so serverless creates and I'm
giving it a template name so it's going
to be AWS and the runtime is going to be
node.js and then the path is just the
folder that it's going to create this
service force and so let's go ahead and
create that cool
so that folder is now created
so let's go in there and take a look at
the code
cool so here is our demo so as you can
see like the bare-bones handler function
that we're going to deploy super
straightforward I'm going to comment out
this but yeah every every function
handler has this event context callback
mechanism and then for a server list
service we have a server list dot llamo
file and what this the mo file does is
basically it lets us to find what
functions we're going to deploy and what
infrastructure requirements we need so
if I needed a if I needed a database
with this I could define that here and
it would actually create that for me
this is using cloud formation under the
hood but right now this would just
deploy a lambda function that's not
exposed to the internet so what we
actually want to do is expose an event
so I could do events and the event is
HTTP and I'm going to set the path so we
have a API endpoint path hello creator
and then I'm just going to set the
method as get so get post you know put
delete we're going to gonna do get cool
so again this is saying ok deploy the
AWS with the runtime of nodejs my
services name is crater demo and oops
hello
hell crater ok cool so that's all done
and now all we need to do is SLS SLS is
shorthand for serverless deploy so what
that's going to do is it's going to go
ahead and you know read through my
project see all the functions that I
have see what infrastructure
requirements I've specified in the
server list black camel and go ahead and
spin those up it does take a minute or
two and that's a limitation on AWS aside
creating the I am roles the permissions
to actually you know for us to run this
function via API gateway so it looks
like it's almost done
doing that I'm going to jump into the
docs real quick and show you guys so if
you go into the documentation and go
into AWS and look at the events there's
basically all the different events that
you can plug into right now so like I
mentioned s3 a cron job with the
scheduled events SMS you know setting up
your own custom Alexis scale etc see
still creating so yeah and all the
documentation as well as like the open
list stuff is here as well and we have
some examples the actual CLI reference
so what we just did is run the deploy
command and you can deploy into multiple
stages as well I'm just pulling this
into a dev stage right now but yeah so
almost done
you
so close I really wish and as I would do
something about this is painful this
only happens on the first deploy though
because it has to set up all the IM
roles once your IM roles are set up
deploying it is super quick and easy
hey what we're waiting um there was one
question here did I hear environment
variables in the code where do those get
set in the system well a very good
question okay so let me pop open scope
here so the environment variables are
set inside of the serverless tamil file
so
here basically yeah under the provider
or under the given function you can set
environment variables this looks a
little crazy because it's using our
variable syntax because I'm pulling
those from a JSON file but as a simpler
example we'll go here so if I want to
set environment variables I can just do
this
so environment and then I could set in
my tokens or what have you so XYZ yeah
so that's that's the environment
variable man still going I did this
right before the the presentation and it
went way fast oh there we go
all right the stack is finished great
the demo gods are with us today okay
cool so what we just did is we deployed
our service into just east one and it
gave me back a live in point so if I
actually open up my browser to that URL
you can see boom there is the returned
response so this like you could hammer
with you know a bajillion requests it'll
scale for us please don't do that
because that's not nice
but let me actually show you guys how
easy it is to change something as well
so if let's say I wanted to change
something I want to actually changes to
you like by creator so all I need to do
now is deploy my actual function so SLS
deploy function and then the function
name which is just hello
so that was way faster and then if i
refresh this page you can see hi crater
so there there's like our live API
endpoint for our back-end again you know
this is super simple code not using any
like third party API calls or anything
else or any Amazon infrastructure but
you can kind of get the idea of what you
could do with that or if I wanted to run
this on a cron job and send myself a
text message or whatever good yeah so
there's the two live demos I think I
just have a couple more slides so where
to get started where should you get
started learning this stuff so here are
some handy links that I recommend
checking out again our Doc's are
examples if you want to see like kind of
a full working project with a front end
and a back end
check out this serverless slash scope
project we actually just released that
yesterday that was fun times and then
yeah the serverless repo and if you want
to chat about this stuff as well we have
a really vibrant community there's like
a couple thousand people in our getter
channel so if you do have service
questions and/or you're stuck on
something or you're getting a syntax
error what have you you know toss a chat
into the architect annal or into our
forum and you know some will be back
with you shortly
that's what that's one of the good
things about our kind of community cool
and yeah check out the docs and all the
docs are editable as well if you see a
typo don't send me an email just go
ahead and edit it submit your first pull
request to the service project
who that what all right all questions
yeah
thank you David your nose that was
awesome uh yeah we have quite a few
questions here um I think early on maybe
people weren't understanding you were
mentioning a website for learning
frivolous I think maybe you just covered
it in one of those last ones though yeah
so that's a cloud guru a cloud dot
Google
that they put out all right
so Ryan who by the way has named Li la
echo there apparently we were you were
setting an off during your talk he said
don't say Alexa turn off the off the
flight
thanks mr. Nelson's like um yeah I just
gotten elected it's it's super
interesting yeah definitely uh so he
said you had mentioned that the website
the service website also is completely
serverless and it's secured with TLS how
does that work if you're just routing to
a function and who handles the TLS is
their traditional gateway server between
the client and lambda functions I think
this is more like you're serving it up
from s3 I believe you sign yeah so we're
we're using a net left eye as our CDN
it's actually so I just posted a link in
the chat there the site is totally open
source as well if you want to check it
out so yeah so we type that up through
net laughs I so I mean yeah it is going
through you know a DNS lookup and
baloise but yeah it's pretty interesting
and you'll notice that yeah a lot of
stuff is happening on the client side as
well so that's the beauty of what we're
using we're using on phenom ik IO so it
is basically it will do the the react
server-side rendering for you at Build
time and then that's what actually gets
typed up to the CDN and then
then the person actually gets into the
website the reactor router will pick up
and then you can just kind of jump
around so if you navigate around the
serverless website and you're wondering
like how is it so freakin crazy fast uh
that's the answer
nice yeah so Violeta asked can we use
survey lists for real-time apps and I'm
actually seeing it done I'm curious to
hear yeah so you can use serverless with
real-time applications there is an
offering from AWS for like socket
connections
I believe it's it's three at through
there I offer encountered scoffs on my
head
I haven't personally done in anything
real-time I actually thought that was
one of the limitations when I first
started working with service pas but
yeah some people are doing it or I have
seen people using firebase as well like
a cloud guru - you know pipe back data
so when a new thing gets added to let's
say like a DynamoDB table or to your
firebase it would type back through to
the front end but yeah
all right and we'll have another
question here what is your experience
with dynamodb how does it compare to
other notes equal do
um yeah so learning dynamo is a little
tricky it's at so I've used I've used
Mongo and I've used dynamo manga was
like much more straightforward like with
their API interacting with it
the Dynamo API is a little strange and
you really got to get used to it but
what I like about dynamo / Mongo is that
I mean it will just kind of scale for me
I don't need to you know yeah basically
do worry about any of that stuff any of
the sharding stuff if you're setting up
your table correctly and it's crazy
inexpensive
yeah and Ryan is saying all the things I
should be saying in the chest freakishly
scalable yes yeah yeah I've heard a lot
of people talk about the fact that like
the the free tears that they have for
dynamo and for you know lamda are they
actually give you quite a lot so it's
pretty pretty cheap almost free for a
lot of people runs though yeah for sure
yeah and if you check out the scope
project inside of the back end
I actually I wrote a dot I wrote a
DynamoDB II kind of client helper to
make it not as bad it's yeah me I'll
post a link in chat but a class oh I
learned a lot of dynamodb stuff from
actually a cloud guru as well like they
have a really good David if they have a
course it's like 25 hours long it's
crazy nice yeah um I guess I also had a
question like do you find it's almost
like since you're running functions and
they're like kind of run on the fly do
you find that there's a problem with
like response times being a little bit
slower or do they seem just kind line
with other than api's or what yeah so
there is I actually don't really notice
it anymore
but there used to be what are called
like cold start times because everything
is basically excuse me lamda is running
all through a container the container
has to spin up to like you know return
your funk run your function so there
were like this was a while ago that it
was pretty noticeable like when the
function was cold like it hadn't been
run in a certain period of time so the
machine wasn't waiting but I really
don't notice those anymore
I know Amazon's working like extremely
hard to basically eliminate those
completely but uh yeah
and for most things so it the response
time even with cold starts there's there
are some ways around that so like if
you're doing something in the UI you
know you can do an optimistic update or
set a loading state until something
returns
instead of you know just having the user
like click on a button and nothing
happened for you know and again the yeah
but yeah to answer your question
sometimes there are but I don't really
notice them anymore especially if you go
yeah if you go look at the scope like
roadmap like the the status board on our
site it's really just like it's pulling
in dynamo so if you see there's n
there's a loading state but yeah okay
that's interesting so this is this is
loading the data directly from dynamo
well see yeah so it's hitting a lambda
it's going through API gateway running a
lambda function and then that lambda
function talks to dynamo gets all the
items back and returns them to the UI I
see okay yeah and then you know another
thing that I've seen interesting too is
like it is like a graph QL someone's
already made like a graph to L for it to
serverless yeah yeah so we have a we
have a graph QL project so instead of
setting up multiple API endpoints you
can just set up one and it's a graph QL
and then you got to train the graph QL
to go and fetch the data from all the
different places but yeah that's totally
doable and one of the patterns that
we're seeing kind of merging yeah I
would think like this is this is a
perfect use case for that I don't think
yeah because then you never have to like
change the URLs in the front-end code
dragonoid you just kind of ask the data
you want and and your resolvers not have
to get it yeah can you talk maybe just a
little bit more about the authentication
stuff it's all zero kind of the
preferred way or there are other ways to
handle authentication I'm curious in
them myself
yeah sure so let's see so I like we just
use all zero because like it's super
super easy to integrate like I dropped
it in our site and like literally I
don't know pride took 20 minutes if you
click on join beta on our site you can
see it like kind of an action but
basically you can use Amazon has an
authentication provider called
kognito which you can plug into all the
different social applications as well
but really what you want to do for
authenticated routes is set up an
authorizer function let me actually send
you guys a link of exactly what that
looks like
let's see yeah here it is so it's
basically like if the JSON web token
sent in the header is incorrect it will
just throw back an error like hey you're
not authorized if it if they are
authorized
it'll keep passing it it'll pass it
through to do whatever lambda function
it was trying to do and and the
interesting thing about that is like the
authorizers like cache as well so it
doesn't have to like run every time it
like kind of caches in front of your
your API gateway layer
okay yeah yeah so really like at this
point you could do anything you wanted
you wouldn't have to rely on those you
know yeah yeah you wouldn't have to at
all yeah you could roll your own we just
use that because it's yeah it was just
super easy to integrate with I think
like once you start getting like a ton
of active monthly users all zero I think
starts becoming expensive so we might
actually change that at in one day but
yeah yeah yeah I said well I mean you
know you have options there as well with
passport obviously doing JWT and all
that kind of stuff
yeah yeah absolutely so you could use
passport in the land of function as well
if you wanted as your authorizer
yeah awesome
all right well I think I was all the
questions I had all the questions the
audience had I just want to say thank
you David this was pretty awesome and I
appreciate you coming and chatting with
us and showing us all this yeah thanks
for having me it's always fun to chat
about this stuff if you guys have any
other like questions about service stuff
feel free to tweet at me at David Wells
always happy to help this video has been
a space dojo production you can click to
learn more button to find out more about
us at bass dojo calm or in click the
subscribe button get notified about new
videos we've put out each week thanks
for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>