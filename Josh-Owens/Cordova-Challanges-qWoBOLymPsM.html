<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cordova Challanges | Coder Coacher - Coaching Coders</title><meta content="Cordova Challanges - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Josh-Owens/">Josh Owens</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cordova Challanges</b></h2><h5 class="post__date">2016-12-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qWoBOLymPsM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome crater fans this is a talk from
crater remote cough mobile edition this
talk focuses on building mobile apps
using javascript you can find out more
information about upcoming crater remote
coughs at conf crater i/o enjoy the talk
alright welcome back to the second
session of this Thursday edition of
Crater conf mobile and our next speaker
is going to talk about Cordova
challenges which is apropos because he
has an app called parlay he is the CTO I
think him and his sister are running
that application so without further ado
Lauren take it away Thank You Josh hi my
name is Lauren and this is day 2 creator
mobile cough and definite number two
Cordova challenges I have spent the past
couple of years working on a social
mobile app for making social wagers with
your friends and it is a meteor Cordova
and I've run into a number of different
challenges mainly in the lines of lines
of performance and I've overcome some of
them some of them some of them are still
working on so I'm here to tell you about
what what those are and why you might
want to choose doing a Cordova app or a
native app or react native that so the
environment you you are in in Cordoba is
you have a you have a small native app
shell that launched is a webview and
that and that webview takes up the
entire screen of the phone and your your
javascript is running in in the main
thread and that means like whatever you
do in javascript land it's it blocks the
user interface so like the screen pixels
cannot update while your javascript is
running unless you're doing something
like running JavaScript in a worker I
think I think the the mobile browsers
that are that are current support web
workers but maybe your your framework
doesn't support web workers for instance
in meteor land if using like reactor
blaze and mini Mongo that's all in the
main thread and it would be substantial
work to like try to take out mini Mongo
and put it in a worker or parts of blaze
and you could definitely do all the
plays because it needs to interact with
the Dom one cool thing is is angular
angular number two is a sort of built-in
in a modular way that allows for a large
book of the computation to be done in a
worker so that'll be exciting to see how
much performance benefit they get from
that and so you're you're in JavaScript
like rap and you get to access native
functionality through a regular
JavaScript functions and a quick example
of that is the geolocation plugin we're
in javascript in your browser and you
you create your functions and on success
callback and an on-air call back and you
call them navigator da geo-location die
get current position in javascript and
you get these callbacks in javascript
but the implementation of that function
does a does a bridge to to call native
code depending on whether you're on
Android or iOS it does whatever those
you know Swift objective c or java api
is and then gets the result back and
then passes it back over the bridge to
your javascript browser land and calls
your javascript on success on error so
that's that's how you get native
functionality in inside cordova another
other interesting thing is you can you
can update your app without going
through the app store similar to how you
can with react native because it's using
javascript and hapless said that you're
it's okay to update your app directly if
it's JavaScript which is which is a nice
exception and they're different ways
two to get to get a new set of files a
javascript files in HTML and CSS into
your crudo BAP the most straightforward
way would be to like rebuild the entire
app and then submit the app store and
have your users download it but the cool
cool thing is to do it directly sort of
inside of the live app and if you do
that in JavaScript which is if you're
familiar with meteor the way that the
Cordova pre 1.3 version of meteor worked
was in JavaScript land it would download
all the files and then replace them and
then refresh that was it wasn't a good
user user experience because as we were
talking about before anything that's
happening in Java doing a special thing
with her isn't the main thread so while
i was downloading those files were your
app was frozen you couldn't scroll you
couldn't interact click events wouldn't
happen because they were busy javascript
was busy downloading files and if you
had a huge bundle with lots of files
that could be could be frozen four
minutes so after 1.3 they only they a
there they only downloaded that the
change file is not the entire HTML CSS
stuff bumble bundle and be they do it in
in native code so it doesn't have to
block javascript in your browser so
those were some some great improvements
to the to the to the point where now I
now you don't notice that you the user
doesn't notice that the files are being
downloaded because it's done fully in
the background so another thing to think
about besides the environment you're
working in when you're when you're
looking at cordova is how am i going to
do the UI so if you're if you're coming
from a web background you might be using
bootstrap or something and the UI
elements are built for a website for
something that you're that you're
clicking that you're hovering that has a
big screen and you when you're doing a
mobile app you you probably want it to
look like other mobile apps and
specifically to look like the components
the default components that come with
with native apps so there are different
frameworks that help you with this
whether it's just in general mobile
friendly vs
mimicking precisely the native UI with
JavaScript and CSS and HTML and I wrote
a little part of the guide article on
few layers and one of the sections is
the mobile section and for Cordova you
can use any any any web front-end view
layer like react angular or blaze
because it's just a website but the for
a for a sort of component framework for
these things that are going to look nice
on mobile that the most advanced one is
is ionic too there are also some others
like onsen UI and for I need to fix this
formatting adder for ionic let me just
give you an example of what those
components look like so if you'll run
the the ionic version 2 which is based
on angular version 2 and it was an
action sheet for iOS and that that looks
exactly like a like a current iOS action
sheet and then for Android it looked the
material design ii and has a different
style for the action sheet it componets
for lots of different things buttons
lists let's look at inputs for like a
form I these are the normal looking
Android inputs and these are normal iOS
like inside of a list of inputs and you
could have floating labels which is it
was more of a more of an Android thing
but they also have an iOS version so
like this this takes javascript to to
CSS animations to to mimic what happens
in the native UI elements and as you can
see here and in this continues to be the
case on the phones is that is that it's
a pretty smooth transition there so you
can you can pretty well mimic what the
native UI elements look like and so your
user won't be look this kind of looks
like a website what is this I thought
this was a nap yeah and there's there's
another thing you can do in Cordova
which is there's a plug-in called ace
made by microsoft where
you can put native elements inside of
your app so that here's an example of
the HTML your your website only being
part of the app and the native like
maybe have a native header and a native
menu or something here you have like a
native button on top of a HTML page and
here you have a full screen maybe you're
like this is like a snapchat thing and
you you can swipe to this screen and
that one's native and the main screen is
native but if you swipe left you get
through an HTML screen and and you can
do free Android widgets iOS you know
houses so that's another cool thing and
and you get the sort of interactivity if
for widgets that are native and have
some some interaction animation design
that that happens smoothly like you
would if you're doing a normal native
app so that's a huge component component
libraries and let's think about
animations so I guess one of the one of
the big concerns people have when
thinking about Cordova versus native or
hybrid versus native is will it will it
interact nicely smoothly quickly when
you click a button will you get an
immediate immediate response from the
page both both of the button being
clicked and also the the display of
whatever happens next maybe it's another
page or something and there there are
are there are certain way that you need
to code your CSS and JavaScript
animations in order to make them smooth
in is particularly on mobile and one of
the fee the recommendations is to is to
use a trend trend to transform only CSS
properties that let me use the
compositor so there's those three three
general sections of what the browser
does 10 inch rendering cycle and the
cheapest to do
is composite so if you look at if you're
trying to swipe a menu open and you do
it by changing the left property on that
give then you're going to be doing this
is all three colors so this is laid out
painting a pause you can be doing all
those three and that takes a lot of
effort for the browser and desktop that
might be smooth but on phones with which
have a smaller or less capable
processors that might be jittery and
that goes the part of the part of the
native Native look and feel that you
want to get right is when you when you
drag things you don't want them to
scatter scatter you want them to flow
exactly along with your with your finger
at 60fps so we're looking for properties
to animate or to transition that only
use the the dark green so instead of
left you would use something like
translate transform translate so let's
look at like translate X so transform
you can see over here only uses the
green sorry transform only uses green in
in blink and let's also look at opacity
is also on the using green so those
those transitions are going to appear
smooth on a resource-constrained device
lik like your mobile phone let's let's
look at some well I guess let's talk
about data loading so in in native apps
you you often are storing some data on
the phone locally persistently so that
if you if you lose connection or you
like restart the app and start it again
you don't have an internet connection
the app can still display some data it
might won't be the most up-to-date data
but it will still be able to display the
page and that's something that this is a
just uniform across like mobile app
development frameworks and that's it
might not be part of your
your web framework that you're using
because it's not that common in in web
sites to store data in local storage or
index DB or web sequel and so for
instance with meteor there's there's a
there's a package called ground eb4 for
saving your data offline and you can you
can use that to to load the page with
that saved offline data lot while you're
offline but people have had had some
heads in trouble using it and and it's
not it wasn't wasn't a standard thing
that came came with the frame work with
the media platform and there there's
even if you did use it there's a problem
where the server sort of has the has the
the state of each client and when you
disconnect from the server even if you
even if you fill your mini Mongo client
collections on restart out with with the
things you saved in local storage or
index DB the server doesn't know that
and it's going to send you all of the
data that you that you subscribe to and
you can't like just not subscribe
because then you won't get updates so in
order to get updates you need to
subscribe and if you're going to
subscribe the server is going to send
you the data and that's that's
unnecessary load on the server and that
takes time on the client to receive so
if you if you do subscription on load
and you go around in the app for a while
after after a few seconds depending on
how big your subscription is the
subscription data is going to start
coming over the wire from the server and
while it's arriving even if the data
isn't different even if the UI is not
getting be rendered it's still receiving
the data in the JavaScript main thread
so you're going to your scrolling is
going to be jittery because the browser
is going to be busy
the websocket data and putting it in
mini mag release comparing it to what's
in mini Mongo and and that takes time
and that prevents the browser from
re-rendering while you're scrolling one
one thing that that will probably help
with this in the future is systems or
outside of meteor land systems where the
client knows what data it has and no
sort of the version numbers of that are
associated with whether that data has
has been updated or not so one of the
one of the but architecture designs for
how Apollo the graph qol client is going
to work is that the clients going to
have more information then then mini
Mongo does in the current live data
system and it's going to be able to say
hey server do you have any new versions
of these data or these version numbers
of the data and the server won't need to
be sending the entire data back to the
client so so that that's going to help
with with Dale loading and having that
be performing on the client and not not
freaking up to you I so I guess another
thing with data loading is when you're
thinking about having having an app that
doesn't have any delays with user
interaction one of those is commonly you
might be switching pages and you'll need
data that you didn't you know that you
didn't have from the previous page to
display the next page and typically what
you do is you'll subscribe to new data
as soon as as soon as that that route
change happens and you'll show a loading
indicator and then wavelet data to
arrive and then once it arrives then you
render the next screen but that takes
time where the users just looking at a
loading indicator and it'd be better if
you had all the data to begin with so as
soon as you change the route you you
already have the data you just start
rendering it and so there's the only
delay that they use
sees is not any network traffic round
trip to the server which would take a
substantial amount of time but yet the
only the only pause that happens is the
pause where the browser is using
javascript to render client-side
templates with the data that you already
have and that can be very short that can
be 10 milliseconds although sometimes if
it's like a it's a huge template it can
be on the order of seconds is there
something that you you have to tune in
your app depending on what what
rendering view layer you use and the
speed of that and then depending on how
complicated the templates are and the
helpers or functions that that are used
to that look at that look up the data in
mini manga or redox or whatever you're
using to get to get it written format it
correctly for display on the screen so
my app uses blaze and there are there
are certain parts of blaze that are
generally slower than say react or
angular 2 in how it determines what
updates do or and how it constructs the
dom together to put on the screen and
but but there are also some some things
some work that happens during rendering
that is going to happen regardless of
what view layer you use to do your
template rendering and so for instance
if you're doing react and meteor you're
still spending time doing mini mongo
collection finds and that takes some
time to so you're gonna have performance
problems or you're gonna you're gonna
have some distillate delays no matter
which front end you in front as you use
just depending on how how big your
templates are and how complicated the
functions that provide them data are so
let's look at par light and and and see
probably the name of the app see I'm
which things are which things are fast
which things are slow why the things are
faster fast why the things that's lowers
though
and we're going to look at a this is the
video from my my device and so I can't I
can't like click and interact here so
I'm should be tapping on my phone and
you can see what happens on the screen
there's a little bit of delay but I'll
tell you sometimes when I'm tapping and
we can see approximately how how big the
delays are so some things that are
really smooth are things where you don't
need to render anything new so I'm
tapping on the the my parlays sort of a
list filter header and as soon as you
whoops sorry about that let's see how
responsive this is okay so the the this
recording let me try restarting this
because it has a little bit of a lag and
let's take off well no I can't do that
because you didn't know what you in
quick time you can do a new movie
recording and if your phone is connected
via cable then you can see the screen
okay there we go that's i mean the the
video of it on the screen isn't as isn't
as fast as what we're doing but you can
still tell what's going on at least so
so when I tap the disk right here
there's there's there's a JavaScript
touch handler that starts a compositor
only like we're talking about that CSS
triggers calm compositor only animation
of that expanding wave and as soon as
the the so that happens in the touch
handler and that happens right away and
you can see it right away both that and
also here this is a rotation which is
which is a transform which is a
compositor only and then this expansion
of the menu or the filters is just a
scale so it's scaling from like zero to
like full 11 height that's also really
fast some things that take more time are
when you need to render new new things
so with them if I'm scrolling down these
are the list of my bets that I've done
in the past if I scroll down to the
loading bar I'm trying to scroll right
now it's not responding so these these
the loading spinner was going and I was
trying to scroll but it wasn't scrolling
because as soon as I soon as I saw the
loading spinner it started rendering the
next items so sometimes when you're when
you when you're doing an infinite
scrolling list and you see the spinner
at the bottom you might be doing a
native subscription like you can do a
custom custom in in meter pub/sub or
like relay does for you in facebook from
ful or sorry reacting Dracula
and in this case as soon as I loaded
during during the load of the app i'm
subtracting to all of the data so the
date is on the client so it's not
actually requesting from the server all
it's doing during that time is rendering
the d list items the like you won't buy
me a drink and it takes Nicole over six
seconds to notice it and that's a
somewhat substantial amount of time and
it is proportional to the complexity of
each of these thus items and how many
how many you're rendering at the time so
I rendered something like like six at a
time I actually do a test at that the
first load on a new device of how long
it tastes takes to render one of these
and if it takes a certain number of
milliseconds then I'll like only render
four at a time something like that and
on desktop instead of instead of having
like 600 i'll have like 20 rendered
because it's much faster so we'll see if
it lets it scroll down again and see how
long it takes for the next few to be
rendered 234 is like four seconds before
the data showed up and maybe three
seconds before scrolling started working
let's compare that to the desktop
browser version of the app where let's
scroll down on this page and i got here
at one two three well usually it's much
faster i think it might be that i'm
taxing my computer with all of these
screens and video going on let's try
reloading I think I loaded this a while
ago and I wonder if app is running
that's right I probably wait for that to
refresh let's look back at vm at the
phone screen so
because whenever you're scrolling down
the page is frozen first and round time
depending on how big the template
templates of the individual items are
you have to think about how much you're
going to put in each item and one
consideration is these are expandable so
if you tap on it expands and the the
response to a tap right now on at least
on iOS Android is often a little bit
slower because their processors just
aren't as good there's a great post
about this from Jeff Atwood on on his
one of his discourse forums and he talks
about how Android menu phone
manufacturers have just been adding more
cores instead of making the individual
course function better vs apple started
making their own processes which which
actually function significantly faster
and that's important for a single
quarter but you have to have a lot of
power because you can't use multiple
cores for a single JavaScript main
thread web browser runtime so often
often your your apps will be slower
Cordova apps will be slower on Android
especially if they're doing a lot of
client side rendering like you would in
angular or react any of these modern
single page app frameworks and
see so the the sort of the complexity of
displaying this is you might have let's
look at something with more stuff in it
the first one you have some emoji here
and you have comments listed out and you
have this this menu some all of these
all these things in the expanded list
item are actually rendered even in this
state so I'm not tapping and then like
changing a changing what hTML is is
rendered in the template on the page
this is our this all the others like the
comments down there and and the emoji
are already rendered they're just hidden
with CSS and I did that because
previously tapping was had some delay in
it you tap and then it would JavaScript
blaze template would be rendering and
then it would it would show you that
they expanded one versus just doing a
CSS change which is the current version
of the app happens happens immediately
and it's a trade-off because now because
it's more complicated when you scroll
down for the infinite scrolling that's
going to take longer versus if you had
on tap then rendered the comments etc it
would be cheaper to render the the non
expanded regular list items and it would
have been faster to do the infinite
scrolling let's see other things that
are quick are that the show more these
are these are pretty simple notification
rose so it doesn't take much to to
render those dismissing notifications is
is fast it's just taking some that
simple list off of the Dom let's go back
to the eye
talk we looked at data loading we looked
at looked at some smooth ones and not
smooth Lewis items when they got
expanded we're scrolling let's look at
the pages okay so when you do a page
transition you're often rendering a
whole lot of new stuff and one thing you
can do to to prevent all that rendering
of having is having the pages rendered
already so like when I do the page load
of this app I'm not only rendering this
this home screen but also the new page
which is even if you click the top right
Plus let's see if it reflects in the
movie sorry about the performance guys a
pretty pretty beefy macbook pro what I
haven't tried doing this many things
with it so that transition in the new
page is pretty fast because the new
pages already there it's just it's just
hidden behind the main page with CSS and
so when you do the route change all you
need to do is is hide the the the home
screen the CSS and show this with like a
past eight years in Yandex or something
like that or display none well not just
lean on because then it's actually well
anyway so another example of things that
are quick are this when you when you tap
somewhere on the friend it does a CSS
animation to go in and out so again it's
hard to see over here and that that oak
that overlay this choose an opponent
overlay is already rendered it's just
scaled to 0 and hidden and whenever
whenever you tap the plus it it unhide
zit and then scales it to one size and
it's sort of it's using a technique
called called flip bye bye Paul from
from google chrome team that that
dynamically from wherever you are on the
page it goes to a certain place
it's cool cool animation technique if
you're going from from arbitrary place
to arbitrary place on the screen that's
called flip FL IP so that's that's quick
let's let's see the other parts of this
page if I'm switching between types it's
also pretty smooth again the video
you're seeing over here might not be
smooth because it's it's not getting all
the frames from the phone on the phone
it's it smooth you can you can download
in the App Store it's on Android and iOS
and check this out those are also
similarly just compositor only in
transitions some some weird things that
you have to think about or consider when
you're making a hybrid app is sometimes
keyboards and inputs just don't work
right for instance right now the cursor
is below the writing gift input you can
see it you can see blinking over here
versus it should be up here because
that's what I that's what I just click
on so sort of something to do with the
the keyboard coming up and the page the
page getting strolled up so that this
keeps in view sort of messes up where
the thing is when I start typing it it's
in the correct place but there are some
bugs like that that I have no idea how
to fix and they're there at least used
to be you had to do some custom keyboard
handling I think it might might have
been fixed a AG in the fact that this is
running on on wk webview right now we're
like you had to change the size of the
page either the height of the page or
the scroll top in order to get the thing
you just clicked on to be shown so like
if if this keyboard is down if i tap
that if that had stayed in the same
place it would be under the keyboard
numa dosia at least at least outside of
WK of you you'd have to like change the
height of that main
page or change the scroll top manually I
might calculate how far do I have to
move this thing up this whole page up so
that this is above this line right here
so there's just there's certain some
keyboard handling things that you might
run into let's go okay so that that was
an example of a page that was already
rendered the new page let's nest outdoor
cam yeah i saw that let's see um going
going to the new page and back home
screen is fast let's go to a different
page like the friends page and well it
can see how long it takes for that to
render well that was instant because the
video didn't catch up let's go back to
the home screen and I'll tell you I
guess when it's happening the menu is
open I'm tapping friends right now
immediately the wall okay you didn't see
it anyway there's there's some time
where be the menu is closed but the the
new page is not finished rendering yet
because it might be I think it's a long
page yeah it's got all my friends listed
there and it takes a while to get the
mother so the page is sort of just dark
for a noticeable maybe like a hundred
milliseconds or something because the
whole page is not yet been rendered I'm
like a new page alright let's look at
something else something that's not
smooth a good example of that is so up
here there's there's three different
tabs this is this is your own your own
list of parlays or bets and here's your
friends feed and here is your public
feed and this is sort of a sort of a
hybrid between the iOS tab views in the
header and the Android swiping views
yeah so I think tabs I thinks with their
cult and so you should be able to swipe
between these or just have these
I'm going to start out by tapping that
the the friend one right here and the
the friend list is sort of translated
over to the right of the page and
similar to when you're scrolling down in
the infinite scroll it takes a little
bit for it to appear but now we can
swipe i'm slowly swiping and and on my
screen it's it's without jitter and
there's a little bit of delay when you
let go of the of the screen and it
finishes the the transitions to like
right here you can see on this screen it
waits for a little bit for like a for
less than a second over here before
going over and finishing the swipe to
the to the french feed and that's that's
something strange because the when
you're when you're swiping over it's
just changing a translate y or translate
X in the touch handler but as soon as
you let go all that happens is there's a
touch end handler that looks at the
current position and like your velocity
and your direction and then decides
whether to go to the next hour go good
or go back to the first and and once it
decides to go to the next then it it
just turns on the transform and it sets
of the translate so that should happen
pretty quickly let's let's look at what
actually happens so like when you have
some things that slow down like that
where you don't think you're doing any
new rendering because we've already gone
to the friends page once so that we know
that's all there just to translate it
over to the right of the screen so there
shouldn't be any new rendering happening
but it's still slow in those cases you
have to do some analysis some profiling
to see what's going on and we can do the
profiling in local development so it's
not minified uh yeah we're on localhost
and we're going to switch to the friends
feed let's do it once for us without
profiling it just to see just to get all
the stuff rendered on the page and
we're going to start rendering using the
timeline tab of chrome devtools and it
will show us sort of the insides of the
rendering of the blink render and run
engine I'm going to stop this recording
in the hopes that my computer will speed
up there we go and so now let's see my
my my swiping isn't working let me try
reloading well without the sorry if you
if you hit if you hit command R while
you're on the time my tab starts
recording I didn't want to record the
page load I just wanted to reload this
to try to get swiping working let's eat
can i swipe no
anyone in the comments know why I can't
swipe oh thank you for yeah someone in
the comments did the arrow twist flip
your animations link let's try changing
this I'm pretty sure like if you if you
are in mobile emulation mode you should
be able to have touch events and this
has worked for me in the past so I'm not
sure what's going on here what's so
touching is working fine and swiping ism
anyway what did that okay there at that
time it worked all right let's try
recording this it's not it's not exactly
happening the way I thought it would so
let's swipe over to left side and stop
the recording and then look at what
happened there's there's social there's
no delay there's no visual delay on the
computer but there's probably some
JavaScript happening and that javascript
is probably is what's getting magnified
on the slower device that's causing the
pause between when you let go during a
swipe and when it finishes the
transition alright so this is the whole
thing looks like our animation happened
over here and around to second mark at
some point is the here's the touch start
event and during during this event every
frame at least on mobile and when touch
is properly working let its its setting
the the translate y and then when you
get to the the touch end let's minimize
this a little bit so this is the touch n
event so your your finger just left the
screen and we're looking at what's
happening and we're trying to find the
part of our code that gets gets called
and is taking time to run so the total
time if we if we click on the top of the
phone chart is 26 milliseconds and 15
milliseconds for these two this is like
a set timeout
looks like blaze so we must have we must
have changed something that that blaze
reacted to and over here we did we did
this which would which does which I
recognized from my code but but doesn't
take very long let's let's actually try
the other way so clear this recording
and we're going to go and we're going to
start the recording and we're going to
swipe left to get to the friends feed
and stop and see whether it takes
weather does anything differently and
how much jess is gonna is being run okay
so this is this list this looks like
more j/s then going from the Friends to
the profile and here's the touch end and
this is that so the animation that is
talking about here is like a is a
transform animation versus this
animation which was every every frame
Inge is setting with there's there's no
transform on the on the on the div
there's just setting the translate y to
whatever the current the current some
position is so this is where the CSS
sort of animation starts and well I
guess it's not an animation property but
here's where the transition starts and
that's right after the touch end which
is good the touch n takes 160
milliseconds which is longer than it
took before so let's zoom in on that and
see there anything different is
happening here so here's the set tab
which which we saw last time here it's
calling something in friends dot coffee
yes I write in CoffeeScript I love it
and let's find the line number that it's
talking about for back in time line it
says line number 99 so that's down here
and it looks like if we're currently on
the this page that the friends page when
when I have a set tab which is what
happens when you let your finger off
it's calling method and that method call
whoops let's minimize this again so we
can see this is call this is a method
call it's doing it's doing something on
a collection local election update so
ideally you wouldn't be doing this at
the same time that you want the browser
to be animating the page so you might so
what I'm going to do to fix this is to
do this local collection update which is
taking 80 milliseconds so often when
you're when you're doing something with
mini Mongo it's going to take some time
hey I'm going to do this like on a set
time out like a hundred millisecond or
something or more depending on how long
this thing takes this thing takes 300
for your so would it make maybe a second
because it's this particular operation
this method that i was calling doesn't
need to happen right away so what else
is happening there's set immediate so
like something in blaze is triggering
based on changes I think it's related to
the method so the method made some made
some mini Mongo changes and then that
invalidates some helpers I think it's
involving the helpers of the whoops the
side menu that I can't swipe open right
now and what else is happening we have a
web socket on message so whenever you
send a method the server comes back with
a message that says oh this is succeeded
or no that didn't and if it in either
case you have to receive the message in
JavaScript and then this is this is a
handling it it's doing trekker recompute
so there were at some data that
triggered blaze doing some rear end
during so and that happens a good amount
that's a 400 plus plus that's like
almost a second right there so it makes
sense that that's going to take even
longer on mobile so we'll try to not do
this method call and then we won't get
this this
web stock message and then we won't
trigger all that and even even if when
we do this like if we if we took the
time out for a second and do it later on
we still don't want all this reactive re
computations to happen because I don't
think there's anything in the the UI
that actually needs to change based on
that particular method I got called on
mitesh end so that's an example of the
sort of profiling you need to do in
order to make sure your mobile app is as
performant UI is responsive and whenever
whenever you're looking at the times
here in JavaScript like 268 milliseconds
it's always going to be longer sometimes
twice or more the amount of time on your
front all right we talked about the
hiding risk rendering we talked about
the keyboard also when you're when
you're thinking about so I was saying
that I rendered both the slash new page
when you cook the plus in the top right
and also the main page at the same time
if you render too much in the Dom at
once uh it your memory your RAM on your
device goes up a lot so like if I had
when I if I render all the pages in the
app and and just hide all but one of
them so there's like I don't know 80 80
80 different routes or something with
different pages and if i render them all
at the same time then that's gonna be a
huge dog even though it's not much to
display the yeah even when your CSS
hiding most of it it's still all there
in the Dom and that takes a lot of ram
and if you do too much RAM on on a on a
computer on a website you're just going
to start swapping and it's going to
start slowing down but in on a mobile
device you just get killed so the the
operating system was like no you can't
use this much memory I need it for other
things and it quit force quits you the
app to the user appears to crash it does
crash and but it's like a purpose of
personal crash the iOS says no you can't
have that memory so
that's one it takes it takes a pretty
complicated either pretty pretty
complicated app or a really old phone
with a low amount of RAM to run into
this issue but I definitely have and
I've had to had to change how much I've
rendered at once do to it there's a when
you're inside Xcode doing a simulator or
a live device run of your of your app
and development eat there's there's a
there's a UI on like on the left side
that shows you how much member you using
how that's changing over time like a
running graph which which is useful we
tab swipe plugins okay so another thing
when you're doing Cordova or react
native is you have to think about what
plugins are available and what you might
have to write yourself in in in Java and
Swift and like how good the existing
plugins are and how like battle-tested
or debug they are so the the plugins
that I used with with parlay most of
them work great like geolocation works
pretty good the camera there was maybe a
small bug that I don't think I observe
any more but there were some that that
were a little bit buggy I remember
trying to I'd if there was social
sharing like when you do a share icon
and you do it to Facebook or Twitter the
facebook one had had an error in it and
then at least 44 it for meteor Oh off
packages the the native app switching
version of facebook login I've tried
maybe three different Cordova atmosphere
packages or I guess atmosphere wrappers
affordable packages that all have have
have had various bugs and it's the kind
of thing where like I'm not exactly sure
what's going on what you're doing Oh
auth app switching in native and I and I
I think one time I tried to delve into
it and look at the code and modify it
and rerun it but I was not successful
and fixing the bug out trying to fix so
so I guess I'm depending on what kind of
what kind of native functionality you
need your app to have you you might run
into these problems and i don't know i'm
not sure what the react native plug-in
ecosystem is like I think they might be
they might do some more plugins
themselves like in house and and those
might be those would probably have a
higher quality bar but there's
definitely a there's definitely a
smaller batch of or ecosystem of
community plugins just because it hasn't
been around this long but you can't do
similar things and and and in in the
extreme case you can always just make
your own and it's going to be similar in
both cases you're just going to have to
write some native code for both or any
and all the platforms that do that you
want to support so in summary there are
definitely some some things you have to
think about when you are trying to
replicate a native look and feel you you
can make animations performant even on
mobile with restricted resources the the
main thing I would say is that if you
are if you are getting into complex
templates client templates with with a
whole lot of content and functions that
are like the equivalent of blaze
templates or funk functions that are
that are preparing your your data for
display then you then you might have to
do some trade-offs and you might have
some pauses like you see in to my appt
with the infinite scroll and there's
there's there's room for there's room to
be proved in my app but don't a lot
already so you guess you have to think
about the trade-off of how complicated
your app is going to be and how much
time you want to spend doing performance
analysis with like a chrome devtools
timeline vs
how much time well guess in the past the
the alternative was right at twice and
in Swift and Java but now the
alternative is react native which is
which is fantastic to be able to write
once and run them both and and have a
native UI and for your JavaScript store
to be running in a separate thread this
is not blocking you I that's huge and so
for certainly if you do if you don't if
you're not familiar with either web dev
or react native and you're in your
extruding one to learn that I would
suggest react native and certainly if
you're if you're making a app that has
that has a complicated interactions or
interaction design and animations you're
going to want to do that in react native
but it's in particular if you already
have a website or you're more familiar
with web dev oh yeah if you if you have
it if you have a web app and you can you
can reuse some of those some of those
views in your or some of that even some
of the just the logic and not the view
layer in your Cordova and it's not like
a really complicated app then it might
be easier for you to just use Cordova
and make a website and put it inside of
a native shell and have that for both
platforms these are just some of the
some of the things to think about when
you're making a decision of of Cordova
versus react native and I think that's
everything I have for you I'm happy to
take questions about about the app or
about now Rick word from our sponsors
before you see the rest of the talk ray
gun spend more time building great
software and less time fighting it ray
gun helps keep a watchful eye on your
web and mobile applications and tells
you when problems arise you can learn
more at Reagan com
native script back by telerik by
progress is an open source framework for
building truly native mobile apps with
typescript and angular to use your web
skills to get native UI and performance
on iOS and Android enjoy the rest of the
talk awesome well thank you lauren that
was a informative talk I learned a lot
actually oh nice um yeah there were a
couple questions here one I asked is if
you're starting over with parlay today
would you something like react native or
native script instead of Cordova um not
native script I definitely go with react
native Native script is cool but just
like look at look at the number of stars
and in the community sites and and
Facebook's track record with just react
or with graph URL I definitely think
that that recognizes going to be the
winner here and yes I was doing partly
today I would definitely use react
native for something for a lot of a lot
of client apps I do freelancing for a
lot of them I would just do Cordova
because they're like if it's a crud app
if you're if it like a marketplace it's
like it admin UI it's just it's just
simple and faster to do it in web it
particularly if they also want a website
and you know it's an additive by the
base it's like whatever you can build
fastest i can definitely do that faster
yeah yeah I would agree with that like
there's there's some amount of business
value you have to think about in there
you know and like how are you gonna be
able to deliver that in the fastest way
possible but without creating I guess
too much technical debt I suppose yeah
yeah yeah the right answer and like I
don't I don't know if I would
necessarily discount native script I
would just say if angular is your jam
you should probably give the look if
react is your gym and you should
probably could react native I don't know
unless unless uh you can use Bonnie's
thing that was really cool from
yesterday her talk where she mentioned
that you can do angular
or two to react native sort of together
kind of curio I wonder I wonder what
that's like wonder if that's terrible or
good I don't know it seems like was
coming from the angular 2 people like
from from their team so my my suspicion
would be that would be a pretty pretty
good yeah all right uh next questions
kind of along the same lines I think you
hit up a little bit at the end of the
talk that it seems that and this is from
da vidis I probably butchered that I'm
sorry he says it seems Cordova
performance is a big issue how much
development time do you spend on
performance optimizations required to
have adequate performance um just I
don't know it certainly feels like a it
feels like a lot because I there's a
there's a it's a huge it's a huge app
I've been working on it for two years
mostly full time and in addition to that
it also has a lot of a lot of custom
animations and it's using blaze so like
if you're using react you would have you
would have definitely had fewer fewer
problems than I did if you weren't using
custom animations like I was you'd also
have have be spending like fewer time
like I wasn't using i was using
particular things in ionic but not the
ionic spam so like if you notice when i
was going to the the new page and back
you can't swipe back that something
comes it comes to fault with ionic but
not something that I've coated yet and
my thing isn't in like a ionic show and
he my drawers so like the menus on the
right and there's also one on the left
the menu and the right there's also a
drawer and also the the swiping between
the different feeds that was all custom
like a hammer to a s and n CSS and if I
were doing it again I would just use
ionic to with like a bottom tab bar and
yeah with no with no swiping if I was
doing swiping I would use you
um I onyx normal menu hang that would
have been been easier yeah all right
well thank you again Lauren for the talk
really appreciate it it's time for our
next talk so your work thank you and if
anyone's interested where can they find
part parla is at partly with me or just
search parlayed PA ra ngoai on either
App Store and then my site is Lorna
sorry if you have any few have any thing
you need to do and want to hire someone
for i'm available all saying thanks for
watching yeah thanks lon thanks for
watching this crater cough talk from the
mobile edition 2016 for more information
about upcoming conferences such as the
one in February 2017 go to comp cratered
io to learn more</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>