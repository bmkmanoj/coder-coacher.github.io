<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Refactoring - Design of Computer Programs | Coder Coacher - Coaching Coders</title><meta content="Refactoring - Design of Computer Programs - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Refactoring - Design of Computer Programs</b></h2><h5 class="post__date">2012-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oroZM95FA-s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now for the moment I want to get back to
this idea of moving along the elegance
direction without changing the other
dimensions and that's often called
refactoring that is we take a program
and we change it around some to not that
it does something different but that
it's clearer and easier to maintain now
here's a line from my hand rank program
that bothers me a little bit and what
bothers me here is I'm repeating myself
so I'm asking do the rent do we have
three of a kind in the ranks and do we
have two of a kind in the ranks okay if
we do that's a full house and then what
are we going to return six is the marker
for full house and then the three of the
kind and the two in the kind but I'm
repeating myself
and so that violates what's known as the
don't repeat yourself principle or
sometimes called
dry so I thought to myself is there a
different way to do this can i refactor
my routine so that I'm not repeating
myself so that I only have to say this
once and in doing that I came up with a
different representation for a hand for
the ranks of a hand so consider this
hand we have a seven a 10 7 a 9 and
another 7 now in the representation we
have so far and note I'm leaving out the
suits here they don't matter the
representation we have so far we would
sort these in order we'd have the ten
and nine and three 7s and then we go
through and we'd say it's a three of a
kind is there four of a kind is there
two of a kind and so on but I want to
come up now with a representation that
takes into account everything we need to
know about this hand and I can do that
using this function that I'll call group
so we group this hand and group is going
to return two values first it's going to
return the counts for each of the
different kinds of card ranks and so
here we have three sevens and one ten
and one nine and those counts are going
to be sorted biggest first and then the
second value that groups is going to
return is the card ranks for each of
these and so for the how many why do we
have three up we have three sevens and
what do we have ones of well tens and
nines and we're going to put those in
order of biggest first
so this representation of taking the
this hand and turning it into accounts
and a list of ranks is in some ways a
better representation of exactly how a
poker hand counts so here's a new hand
rank function using this new
representation for hands so we call it
in the same way we pass in a hand and
now we create the groups and pull out
the counts and the ranks and then we do
what we did before where we say we have
to deal with the ace high straight and
so change the ranks if we have to and
then similarly to before we check to see
if we have a straight or a flush and now
we can check for what the results are
and here we're returning a single number
0 from 0 through 9 and in every case we
return the ranks so note of what we're
doing here is we're actually changing
the signature of hand rank can rank this
version of Henn rank is going to return
different results in the previous
version of hand rank but that's ok
because it's still going to work in the
in conjunction with our evaluation in
that it's going to return the higher
value for the higher hand even though
it's returning slightly different values
why is it slightly different because
we're only returning a single number and
then we always return the set of ranks
and those ranks are there even when they
aren't needed so for example when we
have a straight we don't really need all
the cards in the ranks and in the
previous version of hand rank we only
return the high card here we're
returning all of them and what we do is
we go through and we say what are the
counts so if the counts are just five of
a kind
that's the highest otherwise we check
for straight and flushed like we did
before otherwise four of a kind and the
only way we can have four of a kind of
fits the counts are four and one
otherwise we check for a full house the
only way we can have a full house is if
the counts are three and two then we
look for flush and straight those are
next in order then we look for three of
a kind the only way to have three of a
kind is 3 1 1 2 pairs has to be 2 2 1 1
pair has to be 2 1 1 1 and then high
card would be 1 1 1 1 1 but we don't
have to explicitly check for that we
just have 0 as the final
so this is simpler we're not repeating
ourselves we have a nice representation
here also one thing that I really like
about this representation is it showed
me a new fact about poker hands that I
had never realized before and that if we
look at these values 5 4 1 3 2 3 1 1 2 2
1 2 1 1 1 and then here I haven't
written it but it would be 1 1 1 1 1
these are all the partitions of the
number 5 so in mathematics a partition
of an integer is the set of numbers that
add up to that integer and for the
number 5 that partitions into 7 possible
partitions 7 possible ways and it turns
out that poker recognizes all 7 those of
those as a different thing so poker has
a name for all the partitions and the
even more amazing thing is look there in
lexicographic order if we sort the seven
partitions they're in exactly the same
order as the poker hands five comes
first that's the high as 4:01 comes next
that's the next highest and so on I
never knew that before
about the mapping between poker hands
and partitions but this representation
of hand rank makes it clear</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>