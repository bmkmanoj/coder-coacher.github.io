<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How Many Stages - Georgia Tech - HPCA: Part 1 | Coder Coacher - Coaching Coders</title><meta content="How Many Stages - Georgia Tech - HPCA: Part 1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How Many Stages - Georgia Tech - HPCA: Part 1</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hk34qSnMcV4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now that we have seen how pipelines work
and how they are affected by hazards and
dependencies let's talk about how many
stages a pipeline should have in the
pipelines we have seen so far the ideal
CPI is one we were later in this course
see pipelines where the ideal CPI will
be larger than one because they try to
do more than one instruction per cycle
but regardless there is some ideal CPI
that the pipeline should be achieving
and it boils down to executing some
number of instructions every single
cycle now let's consider what happens
when we add more stages to the pipeline
we get more hazards this way we have
already seen that some of the
dependencies caused the number of stalls
or flush cycles that depend on how deep
the pipeline is for example if a branch
is resolved in the second or third stage
of the pipeline we only have to flush
one or two instructions that we have
incorrectly fetched if the pipeline
however resolves branches in something
like fifteenth cycle then we will flush
14 instructions when we have a branch
that we incorrectly resolved so we have
more hazards when we have more stages
and what that does is it adds more of
that CPI penalty so the CPI increases
because of that penalty that we have
when we have a hazard but with more
stages there is less work per stage
which means that our cycle time can be
decreased less work per stage means that
every cycle there is less work to do
which means we can do it in less time so
we can speed up our clock we already
know the iron law which says that the
execution time is equal to the number of
instructions times the CPI times the
cycle time if we have the same number of
instructions because we are just trying
to figure out for the same instruction
set whether we should have a processor
that has more or fewer stages if we
increase the number of stages our CPI
goes up which increases execution time
but the cycle time drops which decreases
execution time so the number of stages
needs to be chosen in a way that balance
is the CPI and the cycle time you don't
want to have too few stages because then
your cycle time will be too long
but you don't want to have too many
stages because then your CPI will be too
high we can plot the number of stages
here and how execution time depends on
it and this is what it looks like as you
increase the number of stages the
execution time drops because you still
don't have too many hazards but you are
improving the clock cycle time at some
point you get fewer benefits from
reducing the cycle time and the CPI
increase starts to hurt beyond some
point you are no longer shortening the
cycle time very much but you're
suffering a lot from hazards that are
now causing dependencies that cause many
many cycles of stores of flushes so the
bottom of this curve for modern
processors would be at something like 30
to 40 stages which would be a very very
deep pipeline so this is if you only
consider performance so for performance
we want a pipeline that is 30 to 40
stages deep but we need to consider
power if we add more stages we are
shortening the cycle time so we have
more cycles per second and in each of
those cycles we now have more pipeline
latches that spend energy latching
temporary results so power quickly
increases with the number of stages if
we plot power it does something like
this so because of performance and power
considerations we want to choose
something that is not in this
performance optimal point we want
something that is also power efficient
so we end up with 10 to 15 stages in
modern processors so again this is not
because performance is best when you
have this many stages it's because it's
the number of stages that balance is
pretty good performance with relatively
low power consumption or at least
manageable power consumption</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>