<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Directory Example - Georgia Tech - HPCA: Part 5 | Coder Coacher - Coaching Coders</title><meta content="Directory Example - Georgia Tech - HPCA: Part 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Directory Example - Georgia Tech - HPCA: Part 5</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lZZYILcQ68Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now we are going to do a slightly more
detailed director example to show how
the directory doesn't become a
bottleneck when a bus would here we have
four cores each with its own cache and
also next to each core is a slice of the
directory let's assume that each slice
just keeps track of one block so this is
the directory slice where we keep the
block X information and then next to
cache one there is directory Y Z and W
and now let's assume that the core 0
right X at about the same time where
core 1 is trying to read Y this is a
cache miss and we send the request to
the directory that is the home for X
which happens to be around nearby slice
of the directory when we read Y we go to
our own slice let's say that cache to
also reads y at about the same time so
what happens now is the write to X and
the read to Y here are probably going to
be processed at about the same time
completely independently by these
directories meanwhile the read Y is
traveling through the network to this
directory in each of these directories
we see that the block is not present in
any of the caches so we allow exclusive
access for the read and here of course
the block will be modified anyway so
here we will set the dirty bit and note
that block X is now in the cache 0 and
here we will set the dirty bit because
exclusive can become dirty easily and
set the presence bit for cache one now
the read y is traveling to this
directory let's say that cache 1 is
being accessed with a write to X and
it's a cache miss so it gets sent to
this directory so this will probably
arrive here first we will check the
presence vector in the dirtiness
information and see that cache 1 is the
one that has the data and that it might
be dirty there so we forward the request
to read to cache 1 cache 1 acknowledges
that request change
state two shared we get the response
that doesn't carry data so now we know
that the block was not dirty and we
change it to not dirty we then get the
data and forward it to cache - and now
we note also that cash - might have the
data and the cash - eventually we'll get
the data so it will eventually get the
shared state and the block why meanwhile
the right X is getting here and because
we need to write we're going to send an
invalidation and an external write
request to cache zero so here the cache
needs to response with the day time
because it's a write request it sets the
state to invalid and responds with the
data this is also a right so the block
will remain dirty but now the directory
knows that cache zero no longer has the
data and we send the data to cache one
so now the cache one will eventually get
the data in the modified state and as
you can see the write to X and the read
to Y are largely preceding independent
of each other except for maybe possible
connection in the network so if our
network is good and has many different
paths between these caches and
directories then really there was no
point with these requests competed with
each other for anything
this one was processed by this cache and
this directory this one was processed by
this cache in this directory and we
involved other caches if necessary but
in this case it was this cache so these
requests were still largely independent
now let's say we want to write to Y on
in this cache this will be sent to the
directory for Y so the message travels
over here the directory for Y now sees
that cache is one and two might have the
data and that none of them are dirty so
it just sends the invalidation request
to cache is one and two when they
receive this invalidate the block Y and
send back responses that indicate that
they have done so when the first
response arrives from let's say cache 1
the directory eliminates this bit when
the second response comes in the
directory lumen is this bit now that we
know there are no
more remaining sharers we can send the
data to the requesting writer and note
that it's going to have the block and
that the block will be dirty so now we
send the block over here and this block
becomes modified here and so on so again
this write only involve the caches and
the directory entry that actually needed
to be involved for this block this cache
and directory for example were
completely operating independently of
this and these two directories could
have done something else</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>