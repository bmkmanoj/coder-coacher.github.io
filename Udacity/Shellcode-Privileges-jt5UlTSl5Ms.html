<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Shellcode Privileges | Coder Coacher - Coaching Coders</title><meta content="Shellcode Privileges - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Shellcode Privileges</b></h2><h5 class="post__date">2016-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jt5UlTSl5Ms" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so let's ask ourselves this question
when control transfers to the shellcode
what privileges are going to be used
when this code is executed we know the
code is attacker code the attacker
actually created the code last in memory
transferred control of this program that
we were running before to the shellcode
and remember the program is running on
behalf of some user so it's a service it
may be running on behalf of root or
depending on what sort of privileges or
credentials we have some role or
whatever it is it could be a system
process for example so the program was
running with certain privileges this
program is now going and executing these
instructions that make up the shellcode
so whose privileges are we going to be
using when the shell code or the
instructions that make up the shellcode
get executed these privileges are going
to be the privileges that the host
program the program that gets exploited
was running with certain privileges this
attacker code now has the same
privileges that the host program or the
target program that could exploit it had
so if this happened to base system
service as it said is running with root
privileges essentially you have keys to
the kingdom you can access arbitral
resources so that hacker used a
vulnerable program use the buffer
overflow idea that we talked about
transferred control to its own code that
was the shellcode and the shellcode
let's it launched a command shell and
the command shall now can start whatever
program it wants to and that program
would run on behalf of the host programs
owner or group privileges whatever that
it had so the attacker has come in and
become you either the system or a
particular user was running this
vulnerable program so this is how the
attacker is able to execute arbitrary
code with legitimate users credentials
or privileges legitimate users
privileges are available to this
arbitrary code that is being executed on
behalf of that hacker that's the
best-case scenario from that hackers
point of view is the worst-case scenario
from our point of view
somebody is executing code we have no
knowledge off with our privileges and
they were able to get him to the system
because there was a vulnerability that
got successfully exploited and as a
result the attacker has ability to do
everything that he or she wants to do</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>