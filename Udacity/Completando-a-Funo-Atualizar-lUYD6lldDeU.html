<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Completando a Função Atualizar | Coder Coacher - Coaching Coders</title><meta content="Completando a Função Atualizar - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Completando a Função Atualizar</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lUYD6lldDeU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Now that I've shown you,
that we can easily remove an add circles, based on some selection.
Let's get to the last piece that our update function needs to perform.
As I mentioned previously in the lesson, we want to highlight which
countries participated in the given year of the World Cup, and hide every other.
To do this, rather than removing and adding paths of countries, I'll simply
change their fill and stroke, accordingly, depending on whether or not,
the country for the given year of World Cup, is present in our teams array.
Remember, in our nested object previously, we used a d3 set,
to create a list of the teams that played for a given year.
Since every path has previously been bound toward GeoJSON country data,
included in that data,
are properties such as the name of the country in addition to their coordinates.
We can simply selectively update a give path,
based on the accessor function we used.
In our animation, we'll be leveraging negative space to highlight which
countries played in each year.
In other words, if a country is not in a current year,
that we're updating, simply make it white.
And if it is, keep it the light blue we've made it.
Going through some of the code I just added.
First we want to get a list of the countries that participated in the given year
they were updating, which we can access through the filtered data.
Get the first and only element,
access the values property, that was created when you used the nested object.
And then select the teams array.
So in this case,
countries is an array of strings corresponding to the names of the countries.
And the code that I'm running here, while slightly complicated,
is easy to understand once you break it down.
Every JavaScript array, has this method index of defined on it, which,
if its argument is contained in the array, returns the index in which it is
present, and if it is not contained in the array, it simply returns negative 1.
Again, remember, every path has GeoJSON bound to it.
Every GeoJSON, in this case d, has properties defined on it.
And inside the properties object, it has a name.
So altogether,
this has the effect of going through every path with corresponds to a country.
For each of those, compares the name of that country,
to the teams in our countries array for a given year, and if it's present,
keep that country light blue.
If it's not present, turn it white, effectively hiding it.
And since we'll be doing the same thing with our stroke property,
we can abstract this function outside, of the style fill.
And as you can see here, now that I've created an update countries function,
I can simply pass that, to both the fill update and the stroke update.
Let's save this and inspect our complete update function,
in the web console, before we animate for all the years.
Again, let's start to update it this time.
For the most recent World Cup, the year 2014, when we ran update in the console,
again, right at the bottom of the plot points function.
We can see that many of the countries have been turned into white, but
many of the countries have remained blue.
Closing the bugger, we can see here that what's shown for a given year.
Are all of the countries, that participated in the given World Cup, which was
held in the home country indicated, with attendance indicated by the circle.
Now that our update function is complete, let's animate this so
it cycles through every year of the World Cup.</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>