<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lorenz Cipher Machine - Applied Cryptography | Coder Coacher - Coaching Coders</title><meta content="Lorenz Cipher Machine - Applied Cryptography - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lorenz Cipher Machine - Applied Cryptography</b></h2><h5 class="post__date">2012-06-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_yfl3KOVzDE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so this is the structure of the machine
so the message each letter would be
divided into five bits and those would
be X Ord with the value coming from the
corresponding K wheel and so these
wheels would rotate with each letter and
in each position they either had a 0 or
1 depending on one whether there was a
pin in that position or not and each
wheel had a different size the last one
had 23 the first one had 41 there were
different sized wheels and this would
also be XOR with the result from the s
wheels which works similarly they also
had positions that were either zeros or
ones around the wheels the difference
was that K wheels turned every character
the s wheels only turned conditionally
on the result of two other wheels which
were the M wheels the M one wheel would
turn every time the M two wheel would
rotate depending on the value of the M
one wheel and depending on the XOR of
those either all the s wheels would
rotate by one or none of them work and
then the result of all these XOR is the
ciphertext so this is similar to the
idea behind a one pad one time pad where
X oaring message with key but the keys
not a perfectly random sequence it's the
key generated by this machine so to
break the cipher once you knew the
structure of the machine that's not
enough you need to know the initial
configuration so here's the intercepted
message that was intercepted over the
radio and we can think of all the
characters in the message and the
important thing to remember about the
Lorenz cipher is that the message
encoding each character is encoded into
five bits using a little bit of code and
so the cipher text is in the same
sequences where each ciphertext bit
corresponds to one bit of that letter
the next one corresponds to the next bit
of that letter so we can think of the
ciphertext
being broken into channels corresponding
to each part of the letter so that means
each channel would be the sequences that
repeat every
so this would be part of the first
letter part of the first letter this
would be the second part of the first
letter this would be the second part of
the second letter and this would be the
third part of the first letter this
would be the third part of the third
letter and so on so we can think of each
of these as a separate Channel so what
we're going to do is use the new
notation we're going to subscript Z by
channel and the letter for that channel
so Z Z sub I is the isolator for channel
C so in terms of this mapping if we look
at channel 0 that's going to be Z 0 z 5
c10 so we can just break the cipher text
up into channels and the key reason for
doing this is because of this weakness
that was noticed in the cipher and the
key weakness is that all of these s
wheels move in turn so either when we
advance one position they're the same
for all the channels or they advance by
one for all the channels so the value of
each of these depends on the message it
also depends on the outputs of the K
wheels and it is also X or with outputs
of the s wheels and by separating it
into those three pieces we're going to
be able to take advantage of properties
that they have so the key insight is
that the s wheels don't always turn so
if you look at subsequent characters
there's a good chance that the s wheels
have not changed so we're going to
define Delta Z sub CI as the difference
between two subsequent characters in the
ciphertext for that channel so that's X
or with Z see of I plus one and now
because this is for that channel these
are five characters apart in the
intercepted cipher text but they're
adjacent for that channel so what
happens when we look at these values for
two different channels so we're going to
look at channel zero and we're going to
XOR with that with the Delta value for
channel 1 so plug in to the definitions
well that's just there
result of Z X whoring all of these
values but where this becomes valuable
is because we can break these down into
the three parts so let's break them down
into parts separating the M decay and
the s parts that combined into this
ciphertext and so what we get is these
three things so for the message bits we
have the X ORS of all the message bits
for the two channels the jason and the
key bits extraordinary f--k wiz here for
each of these combinations we'll call
them this is Delta M Delta K and Delta s
so supposing we could separate each of
those the question is which of these
inequalities are likely to be true and
so each one we're asking whether the
probability of that part being 0 is
greater than 1/2 if it was a uniform
distribution while the probability would
be equal to 1/2 if it's not uniformly
distributed then the probability could
be less than or greater than 1/2 and I'm
asking here are there any of these that
we can be confident or at least have a
good likelihood that the probability of
the Delta for that component is equal to
0 and let me remind you what the
components are the message is text in
the language and in this case it's in
language German these are the K wheels
each wheel rotates with every character
and they have pins around the wheels
deciding if it's a 0 or 1 and these are
the s wheels and the s wheels rotate
only when the output of the M wheels is
a 1 so sometimes they don't rotate at
all sometimes they all rotate at the
same time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>