<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Efficiency at Scale Refactor | Coder Coacher - Coaching Coders</title><meta content="Efficiency at Scale Refactor - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Efficiency at Scale Refactor</b></h2><h5 class="post__date">2016-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/sPDt5m61rSk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay since we changed the data model
around we're going to need to do some
refactoring let's see what classes we're
going to touch this is a pretty big
change in the way that we're thinking
about our data so I'm going to try to
divide up these changes in two steps the
first step is to delete old constants
I'm going to be here in the constants
class you're going to remove the whole
active list node and as such there's
some constants that you're going to no
longer need if you remove these
constants you can easily see the places
in your code that we're getting data for
the old active list location there's one
here which is just the word active lists
that was being appended to urls and then
down here in the URL constants we also
have a constant that we could remove
okay and now when you run your code
you're going to get a lot of errors for
the different places that we're using
these constants you can go through those
errors or if you're really squeamish
about breaking your app you can
right-click or use the keyboard shortcut
and use the find usages command okay
let's go into the next step the next
step is fixing up the read operations
and this should be fairly quick you
should think about the screens again and
which parts will need to read for the
new data location for example all of
this is list data it probably needs to
read for the new data location and this
list name over here also list data
probably needs to read from the Duelist
location updating writing will be a bit
more difficult remember whenever you
change some detail about the shopping
list other than the items it's going to
need to change in multiple places now
it'll need to change in the owner
shopping lists and in the shopping list
of all the users that the owner has
shared the list with so I have a couple
of thoughts of the best way to approach
this seem to remember discussion about
using update children not sure when we
had it but basically update children is
preferable to set value because it
allows you to update a bunch of
different places in your database all at
once and therefore you don't need to
worry about consistency issues now that
we've got a bunch of shopping list that
we want to keep in sig it'll be even
more important to use update children
this will keep you from getting it too
inconsistent half-baked state where some
users have updated lists and other stone
you might also remember that I talked
about making a helper method and this
method is specifically for keeping
copies of the same object synced &amp;amp; this
helper method would be specifically for
updating a property of a shopping list
in multiple places the method could take
information about the shopping list and
the property to update and then make
that update to the appropriate locations
throughout your app using key value
pairs in a hashmap when you're
generating this hash map for using
update children remember that every list
is going to have an owner and event
surely they'll all have a shared with
list we haven't implemented sharing yet
so right now just focus on the code to
update the owner of the list it seems a
little silly because you're using update
children to only update one property but
it'll make the switch to using shared
with a lot easier whenever and wherever
you change a property for a shopping
list you should be using this method
that you just made okay so here are all
the thoughts i have about the refactor
and i've also included the finalized
database schema the notes again why
don't you take a look at the spec and
then update the app thanks a bunch</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>