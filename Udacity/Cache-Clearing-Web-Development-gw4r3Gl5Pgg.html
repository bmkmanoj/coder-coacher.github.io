<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cache Clearing - Web Development | Coder Coacher - Coaching Coders</title><meta content="Cache Clearing - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cache Clearing - Web Development</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gw4r3Gl5Pgg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we've seen this picture a few times
let's talk about how our algorithm is
going to change so what we're going to
do is you know user mix that makes a
request we go the database we run the
query we get the results out store them
in the cache and then we return the HTML
to the user that's kind of our standard
use case and then any future requests
hit ASCII Chan bounce off the cash and
come back now we're going to improve the
situation a little bit so that when you
do a database right so we post a new
piece of art and we do our right to the
database at the same time we're going to
clear our cash so that after we redirect
the user to the front page and the user
fetches / again we're going to run our
query we're going to get our result
we're going to wreak ash the new version
which has you know multiple things in it
and then return correct HTML through our
user so let's go ahead and see how that
looks in the code okay now despite the
complexity of that picture this is
actually a fairly easy change a
rendering front page doesn't change at
all and our top arts function that that
runs the cash database query this also
doesn't change at all the only thing
that's going to change is that when we
submit new art which is in this function
here the post function you know after we
put this art in the database let's just
clear our cache which looks something
like this cash that clear clears a
function on Python dictionaries that
just basically empties the dictionary in
our case this will work just fine
because we're only storing one thing in
the cash so we it's fine to just delete
everything alternatively of course we
could have decided cash you know top
equals none something like that but
let's go with the simple solution for
now okay so let's see how this works so
here we are I'm going to reload our
front page of ASCII Chan we see our beer
is here now because I change the app so
our cash got cleared anyway if we go to
our terminal we see that our most recent
request did a database query and if i go
back to ASCII Chan reload the page again
and then go back to our terminal we can
see that on most recent request did not
make a DB query so that's pretty cool so
our caching is still working on the
front page now let's submit a new piece
of art to ASCII Chan and see if the site
still works I'm going to put a few blank
lines here so we can see where we
when we come back to this okay so here
we are in ASCII Chan let's go ahead and
submit a new piece of art in this case
it's going to be a cake now what should
happen is we're going to store this in
the database clear the cache reload the
page update the cache and have our new
piece of cake okay so I submitted and
now we see our cake is here let's go
ahead and look at our terminal to see
all these requests okay so we can see
our post here that was the submission
and then we responded with the 302 which
is the redirect and then we can see we
print out DB query and we see our front
page request and all as well now if i
were to reload our page again here we go
and go back to the terminal we'd see
that the follow-up request didn't hit
the database so now we've got this cool
system when we submit to the database we
clear the cache and then the next time
we hit the front page we rerun the query
and every page after that doesn't hit
the database anymore so now we're doing
only as many database queries is we
actually need and so every user to ask
each and won't have to hit the database
unless there's a new submission for them
this is going to cut down on our
database requests substantially you know
instead of doing one database read on
every page view we're only doing one
database read on every submission which
happens far less frequently ok so we
implemented our new algorithm and before
in the original agon we were doing 1 DV
read per page view this is really bad
you know this is doing a lot of
unnecessary database reads the name of
the game when you're scaling websites is
only do the minimum number of database
operations that you need to and in this
case one read per page view is the
opposite of that after our solution
we're only doing one DB read /
submission and since submissions are
rare you know most of our users you know
the vast majority of them aren't
submitting new content they're just
reading content we've cut down the
number of database operations we're
doing significantly so when you're
looking for speed and you're looking for
sufficiency and you're looking to not
spend all of your money paying for
database access this is a much better
approach than this one you know if we're
getting a thousand page views a day and
ten submissions a day we went from a
DB reads to 10 that's a big improvement
and those are actually approximately the
real numbers from ASCII Chan so you know
we just save Steve a bunch of coin here
so good job everybody</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>