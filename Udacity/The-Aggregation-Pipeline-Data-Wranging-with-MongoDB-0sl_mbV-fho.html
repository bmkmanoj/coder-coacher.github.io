<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The  Aggregation Pipeline - Data Wranging with MongoDB | Coder Coacher - Coaching Coders</title><meta content="The  Aggregation Pipeline - Data Wranging with MongoDB - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The  Aggregation Pipeline - Data Wranging with MongoDB</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0sl_mbV-fho" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">aggregation in MongoDB uses a pipeline
at the far left is your collection so
for example tweets the collection is fed
into the first stage and the first stage
processes the documents in some way and
passes the results on to the next stage
each stage does this type of work
processes the documents it receives as
input and produces output documents that
are passed to the next stage now an
example we looked at in the previous
lesson the stages included were a group
stage in a sort stage it's the group
stage that actually does the aggregation
let's take a look at a pipeline specific
to that example ok we'll zoom into this
but this is a representation of the
aggregation pipeline that we saw in our
previous example again that example
looks like this so here is our aggregate
query ok so here in this column we're
representing the collection being fed
into that first group stage and then
what the group stage then passes on to
the sort stage and then this is the
output of the group stage and then
finally the output of the sort stage
let's take a look at each of these in
just a little bit more detail okay so
here's our collection and you can see
that I've represented several documents
within the collection and in fact
multiple documents for some of the
twitter users ok this collection will be
fed into the group stage so what is
group do well group is going to find the
screen name field for the user sub
document in each one of our tweets and
it's going to aggregate together it's
going to accumulate all of those tweets
and then count them so here we can see
that for this twitter user we get a
count of 8 tweets because that's how
many were found in the entire collection
of tweets so the group stage produces
documents that look like this from
documents that have the shape of those
in the collection itself in the tweets
collection itself so the sort stage then
takes this type of document as input and
produces this as output remember sort is
sorting into reverse order so it's
producing documents that look exactly
the same as these simply sorted so that
the ones that have the highest count are
at the top so one thing that it's very
important to
in mind when you're thinking about the
aggregation framework in MongoDB is that
depending on which operator is used in a
given stage that stage may be reshaping
the data sometimes quite significantly
the collection of tweets contains dozens
of fields what we've done here what our
group stage does is it creates documents
that look very different from these in
order to do its job so the whole idea
with the aggregation pipeline is that
you use aggregation operators to
construct stages that will in a series
of steps process your data in such a way
that it produces the results you need
sometimes a single stage is enough other
times you need several stages and the
individual operators that are used in a
given stage are entirely dependent on
your application exactly what type of
processing you want to do you're not
wedded to using group in the first stage
or sort in the last stage</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>