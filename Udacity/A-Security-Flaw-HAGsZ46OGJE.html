<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>A Security Flaw | Coder Coacher - Coaching Coders</title><meta content="A Security Flaw - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>A Security Flaw</b></h2><h5 class="post__date">2016-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HAGsZ46OGJE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so the developer and I have written all
of these rules good job by the way and
the rules are in the app well that's a
load off my shoulders while I get packed
wait up you don't let me finish my
sentence all of your hull abou about
security now has me paranoid ah you're
welcome hmm ok ok I guess it is my fault
you're on the security kick what's the
problem here I'll walk you through it
our decision to use email as the key for
the user is causing a lot of issues this
boils down to the fact that the only
secure and verified method for knowing
who a person is if the security rules is
using the auto ID you don't
automatically have any sort of email
associated with the account and this is
of course why we made our mapping node
from you ID to email unfortunately this
connection here is a very hard thing to
secure let me walk you through an
example so we have our hacker here she
is no sort of special permissions to
access our firebase app but she is
JavaScript and firebase savvy so she
could execute some arbitrary JavaScript
code on our app and she could write
pretty much any JavaScript code that she
likes as long as our database rules
permit air to either do the read or the
right so let's take a look at the rules
that we have right now for the UID
mapping node our rules say that anyone
logged in can read a single you ID from
the UID mapping stone and if you are the
user who's associated with that node you
can write data to it as long as you are
adding data for the first time and we
further have a validate rule just to
make sure that the value is in the form
of a encoded email ok so the first thing
that our hacker could do is execute a
create account command the first issue
that I'm seeing here is that since she's
doing this outside of our Android app
she can basically bypass that whole nice
reset password login flow that we had so
there's nothing that's really forcing
her to prove that she actually owns the
email that she claims that she owns when
she calls this create user command and
this should work the firebase back-end
will return to her a UID so now she has
a UID that she has legitimate access to
so here's a sample of our uid mappings
table and the question is is there
anything to the rules that stops the
hacker from making an entry like this
basically an entry where she uses the
legitimate uid that she got for herself
and then associates it with
email such as my email no I guess not
after all the only rule is that they're
adding an entry associated with their
own user and that's a new entry so yes
that seems bad but what does it mean for
the app it means terrible terrible
things here let's take a look at the
database literally every rule trust that
the UID mapping tells you what email the
USA is associated with so if we can hack
that mapping it essentially gives our
hacker complete access to all of my
shopping lists and that's a pretty major
issue so again issue number one is that
there's not really a real way to enforce
our reset login flow if somebody is
executing code outside of the shopping
list plus plus android app and issue
number two is that with just a little
bit of JavaScript code a hacker could
easily impersonate another user and
that's because our uid mappings table is
currently insecure and it's actually
pretty tricky or potentially impossible
to secure in our security rules and
you're launching version 2.5 when in a
week sweet Nexus that's my ride to the
airport okay i'll tell you what i think
i can ask puff to chat with you he's
actually in the SF office today it might
be able to swing by your office well
that's actually incredibly convenient
and my crib match got rescheduled so
awesome well then all tell him to take
the company to person man experimental
flying electric vehicle excellent thanks
JP and safe travels</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>