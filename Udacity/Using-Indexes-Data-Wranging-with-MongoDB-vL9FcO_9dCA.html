<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using Indexes - Data Wranging with MongoDB | Coder Coacher - Coaching Coders</title><meta content="Using Indexes - Data Wranging with MongoDB - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using Indexes - Data Wranging with MongoDB</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vL9FcO_9dCA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so now we'd like to show you a
large collection and the effect that
indexing can have on performance now our
collection of tweets is relatively small
so instead we're going to revisit the
OpenStreetMap dataset which you should
remember from a previous lesson this
will also serve as a nice transition to
the next lesson which is a project using
the OpenStreetMap data so for this
example I'm going to work in the MongoDB
shell and the database in which this
data is stored is the OSM database so
I'll switch to using that and then let's
take a look at what documents look like
in this database and to do that we'll
just do a find everything ok so then if
we scroll up let me see what these
documents look like there's location
information latitude longitude so all
data in this collection is tied to a
specific location and something I'd like
to point out is that some of the
documents in this collection actually
have a TG field and this is shorthand
for tag so if you remember we looked
before at how specific locations will be
tagged from time to time within this
particular data set and the way these
tags work in this collection is there is
a tag field that is array valued and
each of the individual values in this
array are a sub document with a K and V
field much like we saw in the XML
version of this data set now the reason
why the data is represented this way is
because there could be multiple taggings
all with the same type or key so storing
them in an array this way gives us the
ability to do that without one tag
writing over another as we put them into
MongoDB one alternative would be to have
this be a field name out here and this
be the value for that field okay now
something I'd like to point out about
this dataset is that there are more than
seven million documents in this
particular collection now we've just
talked about indexing and how indexes
can improve performance so let's take a
look at a query and the amount of time
it takes for that query to come back
right now I don't have an index on this
tag field so let's do a query and see
what our performance looks like
now this particular collection that I've
loaded here is actually all of the
OpenStreetMap data from the city of
Chicago again and what i'm doing here is
querying for any nodes or any geographic
locations that have been tagged with the
name Giordano's
which is a famous Chicago pizza chain so
if we do this query you can see that it
takes a little while to come back let's
do the print version of this query okay
so a couple of seconds right for the
query to come back so if we're doing a
single query yeah not too big of a deal
the fact is in most applications were
doing many queries in some applications
hundreds or maybe even thousands or tens
of thousands of queries in a very short
period of time so waiting two seconds
for a query to come back giving the load
that places on the database server and
all those simultaneous queries going on
at the same time simply just doesn't
work for applications it's death to our
application as I mentioned previously so
if we build an index on this collection
then our performance improves
significantly because instead of having
to do with table scan as we saw before I
can simply go right to the place on disk
where these particular documents
matching my query are located now going
too far beyond where we're already at
with indexing is beyond the scope of
this class so I'm just going to
essentially get you started with indexes
here and encourage you to go look at the
MongoDB documentation or take a look at
the free online courses we offer on
University dot MongoDB com see the
instructor notes for a comprehensive
treatment of all of these topics that
we've been discussing with regard to
MongoDB including indexing okay so let's
build my index and the way I do this is
by specifying the field on which I would
like the index created and I do this
simply by saying make it the case that
there is an index on the field
tgd in the collection nodes okay now
again more than seven million documents
in this collection so this is going to
take a little while to come back it's
going to take a little while to build
the index had we created the index at
first then as we were loading data into
the collection it would have been
updated with each right to the database
but in this case we're building the
index after we've loaded all the data in
so that I could work through this
example so we'll just skip ahead in the
video to the point where the index is
actually created this is going to take a
couple of minutes okay so now with the
index created let's run that query again
and look at the performance difference
it was immediate really we got back our
documents right away
and so that illustrates the performance
differences in using an index versus not
using an index</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>