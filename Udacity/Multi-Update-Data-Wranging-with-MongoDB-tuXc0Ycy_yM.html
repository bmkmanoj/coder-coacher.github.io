<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Multi Update - Data Wranging with MongoDB | Coder Coacher - Coaching Coders</title><meta content="Multi Update - Data Wranging with MongoDB - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Multi Update - Data Wranging with MongoDB</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tuXc0Ycy_yM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay the last thing I want to talk about
with regard to update is how to update
multiple documents at once there are
many situations in which we want to do
some sort of global modification to all
documents matching a certain set of
criteria so here we selected a single
document and updated its country code to
deu and updated it so that it included
this country code but this is a country
code not a city code and we could go
into why we would want to do this this
is definitely a denormalization of this
data if you're familiar with that term
essentially where we're headed here with
this example is that the country code
will be replicated in every single
document that represents a city in
Germany in MongoDB we design our
document schemas so that they match the
access patterns so that ideally in order
to satisfy any one query you only have
to hit the database once
therefore the normalization makes sense
it's a way of getting really high
performance and being able to scale
really well your database okay pardon
the slight digression but I assume that
for at least a few of you the normalized
versus denormalized data question was
coming to mind okay back to the topic at
hand in this case what I'd like to do is
use update to query for documents whose
country is Germany and what I'd like to
do is set the ISO country code field for
all such documents to this value the way
we do that using update is by specifying
a third parameter multi equals true now
by default again update will modify just
the first document that it finds so in
order to get it to modify all documents
matching this query we need to specify
this parameter okay so let's run this
okay and then we can go back to the
Mongo shell and do a query now this time
I need to modify my query so that we're
looking for all cities with the country
field of Germany and because we want
them all I need to change this back to a
find instead of find one all right and
then I want to pretty print these and
here we go here is chemnitz hope I'm
pronouncing that properly and it has the
correct ISO code and here we have
another city with the correct country
code and so on as we move through this
data okay so that's multi update and of
course
we can use other operators besides just
set in this same way</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>