<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Geolocation - Web Development | Coder Coacher - Coaching Coders</title><meta content="Geolocation - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Geolocation - Web Development</b></h2><h5 class="post__date">2012-05-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JYRU6DG_Ico" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so let's start with the first piece
which is going to be implementing a
function that looks up the IP so let's
look at our code here's our code for
ASCII Chan it's not a lot of code 64
lines it looks like most of its
contained in this main page handler
remember the the get function just calls
render front which is this function all
around our front does is run a basic
query to get the 10 most recent pieces
of art this Google Google database
object here renders front dot HTML which
is my template that draws that whole
form and the 10 most recent arts posts
function here grabs the title and the
artwork from the request and if we have
both of them creates a new art object
and puts it in a database reloads the
page by doing a redirect otherwise it
throws an error so what we're gonna do
is we're gonna change our code like this
I'll just kind of put in comments what
we want to do so we want to look up the
user's coordinates from their IP if we
have coordinates add them to the art
that's gonna be our first face so let's
work on the first part of this look up
the user's coordinates from their IP so
we're gonna need a function we'll go
ahead and throw it at the top here we
call this get courts and this is the
first function we're going to be going
to be implementing so this is going to
take an IP and it's going to make a
request to host IP dot info and that
request is going to look something like
this here's our API documentation we're
just going to take this URL we're going
to paste it here and we don't want to
use their IP we want to use any IP
that's the URL will be requesting we are
going to be requesting this URL using a
URL up to so let's go ahead and import
that and we're going to be parsing the
response it's an XML if you recall will
verify that we're gonna be parsing this
XML using mini Dom so let's go ahead and
import that we know how to make a basic
URL request I'm going to show you a few
things we kind of do in the real world
to be a little less error-prone first
thing we want to do is we're going to
store the content of the URL in a
variable called content and then we're
going to load the URL so we're going to
use URL 2 and URL open like we've been
using this whole time and we're going to
call read on that response now if this
URL is invalid or that websites down
this is actually going to raise an
exception I happen to know what that
exception is so I will
ahead and if there's a URL error I found
this by trial and error when I was
working on this the first time we'll
just go ahead and return
there's no coordinates that's if somehow
this service is broken normally you know
we might log this you know if we were
making a bigger site I probably put some
logging in here so that finally
maintaining the site I can see
oh man the geocoding is broke for some
reason for our purposes right now we'll
just return none because we'll be
watching it then down here we can say if
content there's a chance that this read
that the page is broken in some other
way and we just get an empty response so
we want to make sure there actually is
content and then in here we're going to
parse the XML and find the coordinates
which you are the lucky person who's
going to write that code for me what I'd
like you to do is implement this get
chords function it's gonna take a blob
of XML here's an example chunk of XML
that comes from that website that should
work and what this function should do is
it should return the coordinates found
in this XML keep in mind the coordinates
here are longitude latitude and I'd like
you to return a tuple of latitude
longitude so you're going to have to
reverse them if there are no coordinates
in the XML say for example we get a
response that looks like this I change
the IP to zero zero zero zero and then
you can see the response here there are
no coordinates in here so this is a case
we're gonna have to handle because host
info is a free service and it only has
the locations for IPS that people have
entered you know it also be worth your
while to go ahead and go to that site
and enter your location if it doesn't
know it so I'd like you to implement
that function if it receives XML that
looks like this it returns the
coordinates in the proper order
latitude comma longitude and if it
doesn't find coordinates it just returns
none okay good luck</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>