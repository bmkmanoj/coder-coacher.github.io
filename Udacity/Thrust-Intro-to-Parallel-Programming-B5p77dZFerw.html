<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Thrust - Intro to Parallel Programming | Coder Coacher - Coaching Coders</title><meta content="Thrust - Intro to Parallel Programming - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Thrust - Intro to Parallel Programming</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/B5p77dZFerw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now some libraries are less about
solving a particular domain of problems
and more about enabling the programmers
to design their own solutions and I call
these programming power tools and the
first example I'm gonna highlight is
called thrust now C++ programmers well
know about the standard temper library
or STL STL provides a set of incredibly
useful abstractions about canoe that are
organized into containers and iterators
thrust provides a data parallel analog
to the STL for CUDA and also borrows
niceties from the popular boost library
thrust allows host code that runs on a
CPU to very easily create a manipulate
data on the GPU and the principal
container abstraction and thrust is
device vector okay and this is analogous
to the vector container and STL but as
the name implies it lives on the device
on the GPU like the STL vector container
thrust device vectors are generic
containers which means they're able to
hold any data type and they can be
resized dynamically so once your data is
in a device vector you could do a bunch
of things trivially you can do things
like sort the device vector or perform a
scan operation on it you can do a
reduction operation or a reduced by key
operation where you actually take a
vector and reduce it according to a key
that's in another vector so for example
if you have a device vector X in this
case it's got three elements and it's a
type float then I can do a reduction on
those three elements by just saying
thrust reduced pass in X dot begin and X
dot n to indicate that I'm going to
reduce over the entire range of the
vector and it will give me the result or
you can do a reduction of a different
sort so rather than simply doing a sum
reduce we can pass in an operator to use
or a func door in this case we'll do
thrust maximum so in this case this
reduction will give us the maximum
number in this vector you can also do
more general transformations you can
transform one or more input vectors into
an output vector for instance you could
do a vector addition operation taking
two vectors and adding them into a third
vector using the built in thrust plus
operator or you can apply a user-defined
transformation using a func door and
this is a chunk of code that you give
thrust and tell it run this on every
element or you know on the collection of
input and output elements that I'm
interested in and you can interoperate
with CUDA code so you can mixed up
thrust code which is running on the host
and doing things on the device but if
you didn't need to do something that's
not built into thrust or this difficult
to do with thrust and you've got some
raw CUDA kernels that you want to run
then you can simply get the pointer to a
device vector to the data and a device
vector or hand a pointer to thrust to
wrap up as a device vector in the end
using thrust is a good idea because it
helps you avoid writing a lot of
error-prone sort of cut and paste
boilerplate code and you can exploit
high-performance implementations of
these data parallel primitives like sort
and scan and reduce and reduce by key
these have all been implemented by CUDA
ninjas for you so that you can just
reuse that code so thrust can be very
handy we're going to give you thrust
code that sorts ten to the six floats
and we're gonna ask you to time it then
we're gonna ask you to also time sorting
ten to the fifth and ten to the seventh
floats and then enter here how long it
took to sort 10 to the fifth floats ten
to the six floats ten to the seventh
floats and ten to the fifth ten to the
sixth and 10 to the seventh bytes and
enter your answer in milliseconds and
we'll just checked within a significant
digit or so</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>