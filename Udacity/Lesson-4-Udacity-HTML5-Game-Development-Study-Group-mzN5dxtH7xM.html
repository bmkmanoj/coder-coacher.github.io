<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lesson 4 - Udacity HTML5 Game Development Study Group | Coder Coacher - Coaching Coders</title><meta content="Lesson 4 - Udacity HTML5 Game Development Study Group - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lesson 4 - Udacity HTML5 Game Development Study Group</b></h2><h5 class="post__date">2013-03-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mzN5dxtH7xM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">easy cause you're beautiful all right
welcome everybody thanks for coming out
for the fourth study group the Udacity
training group everyone on the live
stream welcome back thanks for coming
sorry for having to change the live
stream URL on you we made a last-minute
error and killed the old URL so I'm
sorry about that so we're about after
this session we're about halfway and a
lot of great feedback we've had we had
lots of great questions we've been
reeling and really enjoying it with me
I've colt Colt McAnlis hello from google
Sean Sean Bennett howdy dusty and I'm
Peter lover so today wanted to kick it
off with a little a couple of little
details about some of the code you items
you may need to be more aware of so
Colts going to talk a little bit about
some of those the fine details of input
and handling which which is very odd
right me talking a little bit just a
little bit yeah look we're going to try
and shut called out like 10 minutes
that's my good then we have questions
from you and then we have all the
questions on the on the moderator now a
couple of quick notes for the people
that here in San Francisco if you could
only do us one favor and take your
plates at the end and put it in the bus
station that would be very much
appreciated and other stations around
the corner that's right that's now no
longer in the room but around the corner
and the other thing just a quick round
of applause for Google for hosting this
event and the great food is variously
every week yeah yeah hi yeah chicken
Papa my live here right great so uh
let's let's get off cold you want to
talk a little in transfers yeah the
circuit so great does mine work kind of
can you guys hear me in the back okay
let me just take her us just in case
okay can you guys hear me in the back
now yes okay cool so I just wanted to
start off it sounds like a lot of you
are having issues with the input unit
code
I'm not sure why but some of you seem to
be getting cached versions of the code
from before it was released I have no
idea why that's happening I'm still
trying to work that out if you reset
your code then most of those issues
should be working I don't know why you
were getting cached versions of that but
we're going to try and sort that out so
sorry about that and I think Cole was
next my turn fantastic quick show of
hands in the room how many of you watch
the input unit so far the rest of you
are bad study group participants okay
sweet should we do can you guys hear me
if I talk like this in the back no okay
let me turn off this love give it off
yeah yeah so look this off justing okay
there we go so uh what we need is more
microphones apparently clearly that's
the thing so I want to give a little bit
of context so in the class there there's
a the one of the video units we actually
talked about the reason that you don't
want to actually handle the computation
from a from an input call back in the
input handler and there's little
description I talked about in there
about getting your frames out of sync
because javascript is actually an async
language right so your input handler
callback can occur sometime anytime you
really have no control or any idea when
it actually comes to you right so you
could be actually in the middle of
processing some frame and get a callback
and now all the data that you had
computed is different because your input
data is different so that was one of the
reasons I actually wanted to point out
something else which is actually more
along the lines of performance than it
is of a sort of causality or anything
like this so anyone in here interested
in writing fast web applications writing
performance performance matters perf
matters if any of you guys actually
follow me on Twitter we're actually
starting to use the perf matters hashtag
and so if you start seeing that come up
more and more and more we're really
focused on making sure people write
performant websites so I actually wanted
to show this diagram today because
there's another reason and probably a
little bit more important reason that
you should not handle the code
computation for an input call back
inside the handler basically what you
should be doing is just cashing those
results and then actually handing
handling it later inside of your request
animation frame so what I want to do is
really quick walk you through how chrome
works internally because I think it'll
actually help you understand why this is
such a bad thing so first off it's
important to know that the processing
thread for Chrome that handles
javascript is not like a while loop
that's just sitting there at the start
of your program right there's not
actually like a tight little loop so
things are executed in a very specific
order rather hopefully you can see a
little bit up in the top corner here we
get the right drawing primitive so
rather it's actually just a while loop
that's just going to sit there waiting
on an event loop popping messages off
this event loop and then responding to
them so basically this is event-driven
processing many subsystems are all
communicating with chrome they're
sending message packets back and forth
threads will pick these up process them
and then move on so this really means
that if a thread sends two commands to
the main thread that javascript is
processing on there they could come in
in different orders they could come in
at different times they could come in 16
milliseconds apart one of them can cause
a GC etc etc etc so you need to have
this mental model that it's not a while
loop that code is actually executed in a
linear fashion every frame like it does
do input the network then render input
network render it's not how it works so
hopefully you can see this a little bit
in the diagram so in the middle here we
have the event tube right so let's just
hypothetically say that's a good drawing
of an event queue I don't know the
proper UML schema DNA mobile jumbo that
goes with drawing this correctly but
anyhow so you can see the event queue
will actually get some commands back
from chrome chrome may say hey I need
you to go pull the camera or the audio
processing thread or something like that
and so those will actually kick out to
the chrome miss cattle it category we
could also be getting network processes
right actually doing TCP UDP WebSocket
requests HTTP requests rests any of that
stuff those things will all come back
and forth through the event queue as
well the interesting part that everyone
here should be focusing on is actually
the callbacks into v8 so this is where
that main thread is actually calling
code inside of JavaScript for those of
you who don't know v8 is actually the
code name of our internal JavaScript
virtual machine right so anytime I say
v8 that's the actual C++ code that runs
javascript and I've said this before too
too much the chagrin of many JavaScript
developers but you know a browser is not
a magical unicorn paradise it's actually
C++ code that's been highly
highly optimized to run all of your
magical unicorn JavaScript right and so
you need to keep this mental model in
mind is that it's not JavaScript all the
way down its JavaScript and then you've
got all of this c++ that's making it
fast so the callbacks from the main C++
into JavaScript so for example if you do
a post message right if you're actually
communicating between frames or elements
on a page input handling callback stuff
like that image on load as we've already
been loading images that's actually a
callback that'll come into a v8 center
set interval actually too so set
interval is an interesting process
because you actually say call this block
of code some milliseconds in the future
actually you're not guaranteed to get it
exactly back at the interval you set
right and the reason for that hopefully
we'll talk about it a bit so you also
see these two little notes here GC
target and restyle target and what you
should be aware of is that any time your
javascript is executing you can actually
fall into a garbage collection pass
there's there's really nothing you can
do about it right so javascript
javascript will decide hey we need to do
a garbage collection phase and it'll go
off and do it so pretty much any time
even when you're just handling your
input call back all of a sudden you may
lose you know hopefully only a half a
millisecond or something but
hypothetically you could lose 16
milliseconds to the garbage collector
running off and doing something the same
thing with restyle target anyone
familiar with reflows browser reflows ok
so I'll cover this really quick any time
you write a right of property to the Dom
so you're saying like this Dom element
position equals XY Z or something like
that you can't read from the Dom again
until every element in that page has
been recomputed every position of every
element has to be recomputed before you
can read it again so if you do a right
and then a read you're gonna have to
wait three milliseconds for all those
things to be recomputed then if you are
right and a read you just lost another
three milliseconds and then a right and
a read now you just lost nine
milliseconds because you're not properly
doing the order so when I say restyle
target what I'm actually meaning is that
your code and your execution can
actually cause these reflows to be
occurring at odd rates and you're going
to be actually losing processing time
because the doms being recalculated ok
so this has little unless to do with
JavaScript games that use canvas but
it's important to know
here's the reason why down here at the
bottom we've got this nice little block
so um anyone familiar with a V blank yes
I love rooms that don't know what be
blank is okay cool so does anyone know
what a monitor refresh rate is hopefully
everybody awesome okay well start the
basics so your monitor will actually
refresh it a specific hurts right well
what we call is a when the hardware
actually receives a call back alerting
you that the monitor is refreshing or
the video card is doing its thing we
call it a V blank now what happens is
chrome will actually receive a V blank
call back with some magical mumbo-jumbo
that I won't get in here when it does
that's when it actually kicks off a call
called requestanimationframe and you'll
actually get a call back in JavaScript
so you can actually respond to the fact
that V blank has occurred now this is a
little bit different than actually set
interval timer so set interval will say
hey call this again in 10 milliseconds
well what may be happening is that you
may have 15 or 30 milliseconds worth of
events in the queue before that set
interval event gets pushed into the
queue right so you can say hey call me
again in 10 milliseconds but then you've
got 30 milliseconds of work so you're
not actually going to get it for 30
milliseconds later so this can actually
be a problem the same thing actually
happens with a request animation frame
now here's why this matters so much as
soon as your request animation frame and
we'll talk about RAF a little bit more
in the physics unit right yeah so this
is this is a little bit of sort of
looking ahead once your request
animation frame finishes the immediate
next thing that occurs as soon as the
year the RAF callback is done is that
chrome will go into its layout paint and
composite mode so as soon as your code
is finished executing chrome says cool
you're done with your thing I'm going to
go do mine so if that raft callback is
longer than 16 milliseconds right or
even 13 12 milliseconds you're not going
to be hitting 60 frames a second because
your entire frame start of Wrath start a
frame to end a frame has to complete in
16 milliseconds otherwise you're going
to mix that next V blank from the GPU
process okay so here's another reason
then then you shouldn't be handling any
of your code for input in the input call
back because what you want to do is you
want to make sure that that event queue
is as
you're as possible so in that V blank
callback comes up from the GPU thread
you can respond to it immediately with
your wrath and actually allow this
entire composite down here to go paint
resize all these other things I see some
people are asleep already good that that
times awesome but if there's anyone that
wants talk about questions for this
let's go ahead and talk about those now
before we get into some of the stuff on
moderator I know this is a little deep
in the bowels but believe it or not the
understanding of chromes architecture at
this level is critical for high
performance games and web applications
and by the way see this entire diagram
here it runs about 34 x slower when you
put it on mobile right so even it's even
more important that you look at this
from a performance standpoint on mobile
because man if you're losing three
milliseconds in your input frame you
lose your v blank etc etc one other
interesting thing too so V blank will
hurt will trigger off at the refresh
rate so 60 Hertz right every sixteen
point six milliseconds now if you end up
in a situation that you miss your V
blank cycle you may actually miss two
frames as a result so let's say V blank
occurs but we actually don't respond to
the V blank until five milliseconds
after it right so now we're actually we
only have 11 milliseconds to process all
of our data so that we can hit the next
frame but you actually compute 15
milliseconds so now you miss that next V
blank you actually have to wait 16
milliseconds for the next V blank pulse
to come around so you've actually just
missed three frames because one of them
went long and you started Brian so this
is this is a very very important concept
that everyone in here should understand
is don't do things outside of RAF if you
can try to do as much processing inside
of that rap call back consider that your
update loop consider that the source of
all truth if you get any callbacks just
cash that data push it into a queue and
then inside of your RAF respond to it in
your own time this is this is super
critical for high performance that's my
rant a question here please use the
microphone if you don't mind it's just
right here sorry I kind of gotta do the
walk and talk thing
we thought about this we bring yet how
much is chrome specific or how much is
crossed up on out about the process
everything question it's a great
question so the question for the people
at home is that how much of the time is
actually chrome specific like so
basically if you have 16 milliseconds to
hit your frame how much is chrome taxing
you right the problem is that that
actually varies per frame sometimes you
may be getting different callbacks or
sink notifications as a general rule I
personally say that you get about 12
milliseconds soso justjust cut four
milliseconds off in terms of tax and
this changes by the way chrome rolls out
every six weeks right if we're lucky it
rolls out every six weeks and every six
weeks performance changes things changes
so definitely profile your code and make
your decisions there but I generally
expect we only get about 12 milliseconds
now this brings up a new interesting
question unfortunately that the browser
world will get many angry tweets for me
about what happens if you can't hit 16
milliseconds per frame rightly if your
overhead is just at 20 milliseconds well
in that case in that scenario you're
going to have to try to lock yourself
somehow it actually rendering it 30
milliseconds because that's the next
interval down that the human retina will
actually respond to proper animation
frames without jerking that any how long
thing down there we can there's a
separate tweet archive for that but
another question well actually this is a
little bit higher level okay I mean we
all love chrome obviously yes um I like
your style awesome shirt by the way
original original rosin box yeah for
those of you who are at home you can't
see this but the original chrome books
they shipped in a box that have this
little a hand drawing of a hamster
actually can you keep is there any way
come around yeah around without well
breaking everything
background let's see see I closed a big
hand for him big hand everybody free
hand for the top yeah yeah the original
chrome books because we were trying to
do something super cool we actually had
this hamster and then this diagram of
like a hamster wheel powered jet rocket
of death right there was a like torn
apart it was like thing a goes in slop
be in this little hamsters like got a
helmet on like oh yeah I'm going to the
moon man sorry anyways every story
episodes at home and web gear dude does
the same process apply to other unnamed
browser great question so so this what
you're seeing here is actually in most
WebKit implementations the question was
besides chrome and WebKit what other
browsers exhibit this again every
browser is going to have their own way
they handle composite reflow and repaint
operations I think it's a great question
anything in WebKit is going to follow
this similar pattern so I think one of
one of the big browsers actually just
announced that they were moving over to
WebKit so you can expect to see this
flow out pattern through their stuff as
well besides besides that I have no
ability to comment beyond the scope of
the the length of my hair one thing we
do have control over a JavaScript or at
least we thought we had full control or
was set interval we're gonna have a
calendar game it's going to have a
calendar in it so it would have a set
interval there somewhere so you implied
that if you have a very low interval
you're not guaranteed to get your
interval event at that location but if
you have grosser intervals than that
just chrome actually then give you say
you had a second interval well you
always pretty much be guaranteed to get
it on a second or does some extra
processing actually push everything off
yeah great question so the great the
question is about set interval if you
have a very coarse interval set are you
guaranteed to actually get your set
interval call back closer there and what
I'm going to say is that don't trust
anything with set interval because again
what happens is set interval is going to
have an event that gets pushed back into
this event queue and whenever that event
queue gets around to processing that
event that's when you get to get the
call back so you could have a 16
millisecond call back time on set
interval but let's just say that your
your wrath block down here
at about forty eight milliseconds total
each time and so you've just got a bunch
of these cataloging and so you may get
your callback and then have to wait 48
milliseconds until you actually get the
ability to process the set interval so
my suggestion to you would actually be
add a window performance now to the B
actually I'm sorry a raf actually gets a
call back yet right raf actually gets
the high performance oven timer call
back so you can actually so you that
yeah we're getting ahead of ourselves
here I apologizes for everyone in the
room so requestanimationframe as a
parameter will receive a timer value
timestamp which represents when it's
called to the Delta from the last frame
I'm not exactly sure but yeah well I
thought it was the Delta about it can be
wrong I might be the Delta so but
basically you can use that value and
query it against the last time you
receive that hashtag mark to figure out
what your Delta is so you can actually
find out if you ran in a second or a
second and 12 milliseconds and then
adjust all of your animation accordingly
in fact just as a quick side story this
is how modern web game or modern games
of all size RTS FPS is and everything
actually adjust their animation layer to
hide latency so effectively what they'll
do is they'll get packets back this
thing keeps cutting out I think it's my
personality basically they'll get
packets back from the networking layer
and the networking don't get packets
back from the networking layer and the
animation system will actually take into
it a variable value that represents how
long it's been since you've ran your
animation frame since last time yeah
that's dead so the value means
effectively they'll take this value and
then they'll they'll use it to actually
interpolate the animation of the
character so if you notice when you're
playing an RTS game sometimes the
character will like hop in position
because of low network latency this is
taking into account that animation value
and noting that the position that you're
going to can't be smoothly interpolated
to so as a result what they'll actually
do is just hop you to the next position
now good and awesome developers will
take this into account and actually try
to put some more client-side prediction
or linear smoothing in their code so
instead of actually like hopping you'll
just see the entire simulation slow
down and that'll hide the latency in a
different bandwidth I want to get to
your question but I want to give Tony is
time because he's been staying over
sorry yeah this is just a follow-up so
say I do have a gross interval like that
and somebody in the event system not
necessarily me okay does something that
pushes it off so I get mice one second
interval at one point two seconds say
will I get my next second interval at
2.2 or does chrome refresh that I think
that's a great question yeah so chrome
is going to in under the hood try to
match whatever the set interval you ask
for so if you've asked for ten
milliseconds and you had you didn't get
your last one until eight milliseconds
over the time in two milliseconds it'll
push and other events into the queue
right because it's going to try to give
you back as much as it can question sir
can you come up like sorry by the way we
put these chairs here because like six
people almost died last week so yeah
thank you for not moving shared you
mentioned via their processing the
fastest beep at the speed performance
where are the algorithm are there any
particular practice or libraries that we
could use as reference points for for
algorithms oh yeah that's a great
question so the question was about you
know we talked about client-side
prediction and we caught talk about
linear interpolation and things like I
was there any libraries unfortunately
not in JavaScript most of the time the
actual de facto that I point people to
is actually the steam source code so if
you actually go look at the half-life
two source engine and type into it
client-side prediction you'll actually
get an amazingly detailed right up where
they talk about modifying your update
and animation in position based upon
your network latency and what you're
getting because those guys are actually
using an authority of server so the
server will actually say where all the
units are in the world and actually pass
that data in a lazy manner down to the
clients and then clients do some
prediction and everyone syncs up and
we'll talk about this quite a bit in the
next grits course where we actually
talked about client server and how this
all works so in the grits code we
actually have an algorithm for this
predictive smoothing it's gnarly but if
you if you email me week I can show you
where it's at and take a look at it from
there
okay any other questions on this topic
it's a fun diagram I have a tattooed on
my body somewhere what winner gets a
t-shirt everyone gets a t-shirt yeah
they're out in the hallway all right so
let's take a look question alright so
the first question was about the
recording of unit 3 so we haven't been
very successful with our mobile studio
so last week's recording everything went
fine but it's still quote unquote
processing on youtube we actually have a
call in to get that fixed expect it to
be fixed either tomorrow or today after
if that is still not think we have a
complete copy and we'll post it the only
problem with that would be that it would
be a new URL so all of the links will be
broken so we're trying to get a fixed in
place stay tuned for that yeah the
YouTube team knows all about it so
that's right good okay um let's see i
can probably take this one i miss my
you're pretty good my mic is actually
working okay right okay good so this
question is Andy made liberal use the
instructor notes section during
Sebastian's and Peter's courses to
clarify correct the videos and quizzes
although we're working through these in
the forums it would be great to
acknowledge them the notes yes excellent
absolutely excellent I love this yeah I
would love to add in more of the stuff
in the instructor notes actually one of
my pipe dreams I guess that I've been
pushing for for a while is actually to
turn all of that basically all the
information about the course the
instructor notes the supplied code the
grading scripts all of that basically
into its own github repo so that then
people you know if they have useful
content to add could just issue a pull
request for example to the to the course
and then say hey you know I've added
this animation or I've added this you
know diagram for this topic I think it
would really help or you know hey
there's this problem with the great
instructor with the supplied code I push
the fix
this is something I've been pushing for
for a while I think it might actually be
happening now but it it's going to take
a little bit before that happens it's a
bit of a side note but yes absolutely we
should definitely do a better job if
anyone has specific specific diagram
specific notes that they would like to
attach to the quizzes or any specific
quiz please email them to me one of the
problems is that searching our forms if
you haven't noticed are somewhat
difficult to search through so searching
through the through them for some of
these gems is kind of difficult if you
have suggestions or anything that you
would like put it up in the instructor
notes please email them to me that's by
far the easiest way to get get ahold of
me hmm right thanks Sean okay so next
question maybe good one for colts what's
the best way in your opinion to give the
user the option to remap his naturals
fantastic so testing no good nut okay
take this this is the mics officially
dead so this is a great time because
anyone anytime there's a question it
says in your opinion I officially have
to say that my opinion is my own not
that of any representative bodies that
may be associated in any way shape or
form anything you do with the data I
provide is up on your own accord and we
cannot be held accountable in any way I
got that memorized a veteran of PR
training yeah so really you it's really
great so the the my high suggestion here
is that you actually create a UI mode
were so basic standard quake 1 style
stuff for quake 3 i think was probably
the earliest example of a really good
way to do this you know you provide a UI
to the user allow them to see the
actions that your game is performing
user selects an action either through
click or spacebar or hit the button that
it's currently bound to and then in your
UI you can actually put a new key
listener in that says hey let's figure
out what user what the user hits next so
the user clicks on fire and then he hits
the Q key now you actually go in and
that fire key to Q now there's one of
the important things about the grits
input system was it was built to focus
on this since day one so typically in an
input system you've got some if
statement buried deep in the bowels of
your code that says if the user hit the
letter Q right we actually think this is
the row this is the wrong way to do it
in game development early on if you
notice in our knit functions I think
it's in game engine and then clients
like no no input engine input engine
will actually say you know map the num
the key to q2 this action right move
forward or shoot or jump or something
like that and then later on in the code
we can actually just call a single
function this is now map a to shoot now
map J to shoot and then the rest of the
code actually doesn't have to be changed
because those all query off of whether
or not that action has a boolean state
on or off or has been executed so so
with the current grits set up it
actually Maps itself really well to
providing this sort of experience we
didn't do it because we're lazy i hope
everyone in here who's building a
product is less lazy than I am that's my
heart my heart gold griffiths thanks for
that opinion all right Sean I think this
one is for you and I was able to pass
test cases for quizzes on input handling
but is there something I or Shawn could
do to allow testing on the canvas how my
code handles input this is from I've
been forgetting to tell their carnac and
san diego hat is cool man what is an
interesting question the so hmm to test
it while you're moving around on the
canvas in the game world as what I'm
presuming he carnac's asking and my best
bet would actually be we would have to
put in some kind of logging framework
that they would have to call out to
during their event handlers or when this
input actually occurs in their code we
would have to take control the event
yeah we would have to take control of
the event handler they would implement a
function we call yeah that that's really
the best way I can think of to do that
which I don't think is really the right
way to go about it unless you guys have
other ideas but i don't think there's a
better way to do that it would be really
cool but I don't think if you if you
weren't in control of the code or
writing code and that would be a problem
yeah testing on the cam yeah hmm
something think about but that's that's
my best bedroom or the only other thing
I can think is chrome developer tools
and yeah ol developer tools have these
ways to pause on any sort of input like
you can say okay I want to stop on any
any time you hit the mouse click or the
mouse up or whatever then you can
immediately jump to the part of the code
where where that's happening in all of
this that wouldn't be grading though but
that's something he could do so the
first part that quite right I think that
that fits so could we put a canvas on
the quiz page there there's a canvas but
there's no way to grab grading input
from that direct so it since it's just
stay my friend yeah it's in my room yeah
I would say the developer tools are
really your best better there all right
so another question guys lots of
Awesomeness let down by a buggy test
lack of explanation of the concepts
comes back to
what you said about believe it teach a
man to fish and he'll never be hungry
right now it looks like we're wading
thru the grits code base I think I
stopped listening after you said
awesomeness well I mean if you have some
specific feedback I mean yeah we would
love to have loved to fix it we were
trying we're listing things to you know
improve and make better it's a matter of
getting to all of them but you've got to
give a specific feedback no Sean yep
email me give Sean a hard time um well
and just just to give you some credit i
mean it there's been like we had some
definite issue in the beginning but it
has gotten a lot better yeah but yeah if
you find any issues there are certainly
more out there let us know also if
there's questions from the audience here
just feel free to come up to the mic and
yeah come on oh yeah go for it we should
get a we should get a back of the room
mic yeah we should get act like sorry
yeah just related to the the test code I
is there somewhere where it's accessible
because I know one of the things I run
across is you know like for example
you're defining a variable that I
defined and I didn't know you'd already
divided in the test case okay so you
know how can we see those kind of things
i think that's that's the problem that's
probably what's right we got to hear
that's that's one thing that i would
like to put up on the instructor notes
so i will put that up either there on
the wiki i think would probably be the
what place to put it so excellent yep
yeah that's a great question because uh
basically the question was can we have
the grading code and the code it's
actually running available and there's
nothing really there that's causing us
to hang on to it way yeah no no and that
again i would like to bake all that
available and accessible and changeable
i would love to have all of that info on
github so that you guys could all access
it and see what we're doing and how
we're doing it and you know to just
better ways to do it if you guys have
ideas means i'm sure you do
a lot of static here yeah there's a lot
of static repre gonna come on last week
you said the genesis of this course was
really as vehicle to highlight html5 in
particular the canvas and so learned a
lot in the the Atlas section and the
mapping and then talked about user input
so this is just a question that says if
I have a game and I have all these
elements on the canvas the canvas is
really just a rasterized device how can
I hit test on that what I have to
literally backtrack through my drawing
of atlases and maps in order to hit test
it to have a game with a nature to be
able to control different objects on the
screen rather than just one element main
road blogspot.com there is an article
that talks about fast canvas hit
detection such a tool follow up if we
drew SVG on the canvas and I know with
3d you can those actually have automatic
hit testing things built into the
infrastructure that draws on the campus
is that am I correct in saying that I
don't know anything about SVG yeah would
you use I know three details okay so
that i think i think the api he's
referring to is the i think its
experimental or something more
effectively you define you define a
shape primitive so for those he on the
feed sorry they can't hear this he was
asking about whether or not the internal
SVG processing which already has its has
some hit detection in it I think how
that works is you actually define a
primitive and then through the SVG API
and then to find a point to that
primitive and then get a boolean result
I think this is a so I haven't done the
performance test but something in my
brain back here in the reptile area
tells me that it's a bad idea so I when
I said go visit my blog I got actually a
really wicked look from one of the
Udacity community managers over here
like what you're just gonna say that and
I'll explain it so I sir your first
question oh yeah
to acquire me so so basically to answer
your first question the the naive
approach is of course and you know end
of the end solution where you actually
test the point in 2d against all the 2d
rectangles of objects in space as a
number of objects increases this of
course times your performance to the
floor what my article actually talks
about is starting there and then making
it faster and there's a couple different
ways that I do it where the first one is
actually using spatial binning right so
effectively what I do is I tile up the
grid tile up the canvas into 64 x 64
buckets and then any tile that's
rendered into that bucket I effectively
make a reference mark to it so then when
the user clicks I only walk through the
list of other objects that are touching
that same square now this is fantastic
if you're doing a basic 2d rectangle
based collision but if you're actually
doing something isometric like a
farmville clone or something along those
regions this doesn't really work so you
actually need per pixel hit detection
now per pixel hit detection in
javascript is going to just kill your
performance right because effectively
what you have to do is you actually have
to call a you have to you have to
rasterize the glyph or the sprite into a
separate canvas and then call get user
data on that on that canvas which then
gives you a RGB a packed stream for it
and then you have to be effectively to
figure out what the translation point is
inside of this linear array and
determine whether or not it's it's
outfit there's a separate way to do it
is where you pre process all of your
sprites and actually dump those two
discs in a binary array and store that
separately so you don't have to use the
separate canvas in the separate call you
just have to walk through these binary
arrays which if you pack properly
hopefully you can use some bit shift
operators to improve the speed and
latency of that the methodology that I
actually go for because I think it's
probably a lot better a lot cleaner and
a lot safer is and you can find this on
my my article it actually links to my
github account where I actually have an
algorithm that will compute the concave
hull of any sprite so you can actually
pass in an alpha sprite and actually
print out a concave polygonal
representation of that sprite you can
then save just the edges of that
polygonum representation to disk as
integers there's gonna be a lot less
memory than either the two previous
operations and then the code to
determine whether or not a point is in
the polygon is a very simple algorithm
that you can actually find in
article code base as well so with this
so basically here's the thing the test
that I propose is actually like four
thousand objects on canvas and when you
click a couple things occur first off
you're only touching like the five or
six that actually occur in this bucket
in space and then after that you're only
actually touching the United touching
the pixels you're only touching the
concave volumes of the point against
that so the result is very very very
fast so for those of you looking to do
lots of point queries in fact it
actually might be too fast at this point
that's one of the things like I've over
optimized it like who's going to click
that many times to make sure that this
is performant in a way that matters but
but for anybody interested in that sort
of stuff main roach blogspot com leave
feedback no one visits my blog it really
makes me lonely that's all your opinion
yeah yeah my opinion is my
representation myself another than
anyone lawyers in FFM alright so if you
have any questions feel free to jump up
here to the mic we'll take another one
from the moderator how can we
accommodate odd keyboard layouts one
common layout this is er D across the
top which makes was it controls bad for
games needing two sets of keyboard
directions like grits can this be done
without making the user fix his controls
manually
is really not a JavaScript at least now
if you have access to the device drivers
then maybe maybe maybe maybe but
definitely not JavaScript sorry sorry
you need some key mapping and you need a
way for the user to actually be able to
interact with that and modify it it's so
you need a UI for it and everything not
only something people are playing around
with India input unit we see how to
control the mouse and the keyboard are
there good approaches and dogs for
controls or for controlling our game
using the Android device from Mary
Ellen's what's your opinion on this in
via Fred's sour who's a developer
advocate for Google App Engine not only
beside being a developer advocate he's
also a gentleman and a connoisseur who
worked us on who worked with us on the
original grits codebase he actually
wrote this code and it's actually part
of the grits codebase so if you go to
the code repo for grits you'll notice
that there's a folder called WASD this
is actually an android client that will
connect to the node.js back-end and
communicate with it and pass input data
from your Android device to the nodejs
instance and the nodejs instance will
take that as gospel for where your
player is moving so for those of you who
have actually been able to get into the
live instance when you join a game
you'll notice when you're configuring
your little robot you'll actually get a
QR code and so what happens is you
download this app from the Play Store
you scan the QR code and then you
actually just use your device as touch
input and it will actually move your
character around the world there's a
little bit more lag involved with it
because it's kind of doing this weird
round trip and plus like you have your
device so basically you hit you hit a
key on your Android it has to go up to
the server to then tell your client
where you're at so basically this
philosophy actually invalidates all the
client-side prediction code that we had
added and put in there to actually make
everything look smooth but the fact is
that that code is all in our code base
and you can check it out and if it's too
crazy or chaotic blame me and Fred sour
and sent us emails and whatever
there's also that uh super sports game
that was recently released for Crohn's
do that does super sugarsync super no
super sync sports different things they
do something fairly similar I think and
there's an API yes there's an API we're
actually going to release an article
about how it was built yeah so it's a
pretty fascinating vehicle code yeah
yeah cool all right so is it possible
that Alan's win the testing back end its
operation broken it would be nice to
know what our problem exists in our code
or your code from see ya in the bay go
for it ok so again some of you were
getting cached versions from before the
unit was released not sure why the other
thing is that the emailer that we were
using before we changed our site over in
late January didn't actually work with a
new site so we were working with kind of
a jury-rigged email / announcement
system which made it a little bit
difficult to get in touch with all of
you the good news is that we now have as
of i think thursday a brand-new emailer
system if you guys got the email for the
study group it looked quite a bit nicer
than last one that is part of this so we
should be able to contact you much more
easily about any problems from here on
out so yes we will definitely do that
thank you for asking that alright thanks
John yeah those emails look a lot nicer
thanks again that reminds me of
something just a quick in
and note here we're running a contest I
know all of you no doubt but for those
of you that are just joining the live
stream or are new to this session we're
running a contest the details are on the
Udacity wiki page it's running for about
a week or two after this 8 unit courses
over the study group and there's some
cool prizes so you can win a ticket to
google i/o you can win a cameo
appearance in one of the future Udacity
courses there's a bunch of Chromebooks
and Nexus 7's for all the different
categories of prizes so definitely check
that out that's probably the sense we're
about halfway in the course right now in
a study group it's not too late to start
I mean how many of you here are thinking
of submitting something right really
fantastic is a serious hey if any of you
have questions about what you're
building this is the time to ask by the
way yeah if you guys how to build it if
you have questions or problems in your
architecture yeah this little here yeah
I find those questions fascinates can i
use impact GS for that yes yeah right so
the question was if you can use other
libraries like impact jails and that's
perfectly fine yeah really anything that
compiles down to javascript is is good
right so yeah if you want to use dark
for instance or some other language that
miles down to and also mad props
shoutout to the guy who made bomber mine
don't know if you guys have seen this
was this SQL bomber mind said only it
seems like a massive multiplayer
Bomberman clone well he's actually one
of our students seriously yeah he
actually sent me an email so if you're
on the video feed mad props he's
actually one of our students are taking
our class and shipped Bomberman dot are
you all right massive multiplayer bomber
and cloned I played for about five
minutes and died like 800 times so I my
bomberman skills are not with you
I was five one of the thing about the
contest I'm pretty sure we announced
this last week but just in case we've
extended the deadline to april eight i
want to say so you have plenty of time
ya to take the entire study set up study
groups and admit after work yeah so
it'll be after the last unit is launched
and everything because that didn't make
a whole lot of sense yeah for those of
you on the live stream you didn't see it
how many hands spend up probably a good
20 thousand what do you 20,000 people i
think by like 20 guys everybody winning
other people in the room that are all
can we give a confirmed by the Udacity
community managers way about their one
there yeah we're getting the nod yeah
that wasn't a lie at all that's not to
park after all right so back to the
questions oh wait that anchor this one
so hi there thanks for the great course
it's possible to list of programs games
sites and recommended tools you
mentioned quickly in the video somewhere
in the wiki page or somewhere else so
it's hard to write it all down quickly
from the Canary Islands in Spain okay
yeah yeah so we can definitely do that
um we can we talk about that afterwards
and figure out what we need a list and
what's cool and what's not yeah the good
thing is we have a lot of our original
story boards that mention all these
things so would be pretty easy for us to
go through there and then also anyone
can can add to that right so yeah if
anyone has suggestions for cool tools to
use like impact j/s please add it to the
lucky you want to give a plug for it
overland i'll provide a tool okay there
are tools
alright so ritson is complex I feel it's
overwhelming by the time we have in CS
2255 to achieve everything you've done
frameworks create yes can make things
easier or not without prior html5 and
Jas experience will we be able to
deliver something like grits from
Portugal well so first of all we took
the client side part of grits and turned
it into this course and there's other
parts like the server side that we're
hoping part 2 will be so it's not
everything you're seeing in the actual
grits game mhm we specifically and we
mentioned this a couple times over the
last few study group tried not to go
immediately to all the different
third-party libraries just think to have
a little bit more of a sense of what's
really happening except for like the
physics parts where that would just
probably just add to the confusion so
thoughts about that I think in order to
really understand how to build a
performance gay more performant web app
period you kind of need to understand
what's going on at a fairly low level
low level in terms of JavaScript at
least um which yeah yeah tell them how
long it took to build with how many
people's yeah so we so the grits went
from concept to google i/o open source
in 120 days with six Googlers working in
our twenty percent time so we're
basically working in one day a week and
about the last month that actually
turned into me working five days a week
to put all right don't tell my manager
yeah it's you you generally need to
understand how some of these things work
yes it is confusing and that's what's so
awesome about it if you're an engineer
you should have a love of solving
problems and looking at things a
different way and finding and digging
and yearning to know how these blocks
work together programming is not easy
generating games is the worst of it
because it is not easy and you have to
have a designer and an artist and a
business manager
um I roll intentional you know love love
the fact that you're getting this low
level stuff I actually saw someone sent
out a tweet that they had a picture in a
book in a book there was a book was a
scan of a book I couldn't believe this
was in a book it says if you would like
to make this book more performance you
should use something more low level like
jQuery and by hiding it's about a son
one wrote that down and someone else
read it and said yeah yeah yeah that's a
good idea people agree with that
statement hahaha probably three
technical right here so yes sean is
right if you need to understand how to
make something perform it you got to go
down and you got to understand and you
don't use jQuery 3some one yeah okay so
we have another question from karthi
from chennai hello world the doing maze
game in 805 find a route to the
destination I'm stuck in the game
validation whether the user reached the
destination from the starting point to
help me have a check I use canvas to
draw the ground thanks Chuck by a star
oh yeah yeah hey star okay so what
you're actually looking for is a path
finding algorithm basically and the
go-to here is called a star you look it
up on Wikipedia or just google it there
are all sorts articles about it there's
code in just about every language you
can imagine it is the go-to path finding
algorithm that you're going to want to
use there are optimizations and
modifications of a star depending on
what you want to do exactly but for a
basic 2-d game especially you know a
maze game or something like that a star
was built for exactly that so use it
it's brilliant it's clever its simple
it's awesome and there is a JavaScript
there is a java library yeah yeah yeah
hey sergeant yeah hey Sarge is probably
I don't know it perfect all right thanks
Sean so have you thought about using
phonegap or some other tools to get
html5 games on wait oh yeah we oh oh
yeah oh yeah we've thought about that so
I guess one of the things we've
mentioned already is we're talking about
what's next right after this we're
thinking of doing the server side course
and we're actually already thinking
ahead after that 2-8 how to turn this on
to a great mobile game so you know
obviously phonegap is a pretty popular
approach to just take a game and
packages up for mobile but if you have
you actually experimented yeah like what
are we were well yeah okay so so um I
have an opinion for it's all the things
I said before yeah so uh grits we've
we've intentionally designed grits to
kind of not work in these sort of
package web view modes so so it would
work in phonegap you'd have to actually
call out so I think a different web
socket API or something along those
lines for those of you who don't know
how these rapper tools work effectively
they have some c++ or objective c or
some runtime that will load your
JavaScript and load your canvas data and
then operate on it as though it were a
browser right so again remember you know
browsers aren't magical unicorn utopia's
where you know ebay and all these
companies make millions of dollars from
just putting fonts on a screen pinterest
yay um yeah oh great great great joke
real quick just a segue is this is my
funniest joke about the web right okay
so a new bar opens in Silicon Valley 400
people walk into it no one but her for
four million people walk into it nobody
buys anything and then walks out and
it's declared a smashing success
only on the web and only in Silicon
Valley here four million so the point
being is that you know we basically
phonegap is trying to emulate the fact
that it's a browser right so it's
running C++ I know there are some other
versions of those wrapper tools that are
actually running v8 because v8 is open
source and then they're running skia
which is also open source so they're
basically run running the JavaScript
processor and the canvas rendering
processor from chrome in their package
they're running like kind of a different
version of Chrome so these things work
to lesser degree or more degree most of
the time that you're going to find the
problems are the AP is that it provides
to get native device access because you
really have to ask yourself a question
if you're writing something in
JavaScript and using canvas and it's not
performant or better yet let me let me
take a step back if you ready something
JavaScript and in canvas you're either
going to run into a web browser and one
of these things well it's not going to
be that performant on mobile because you
don't have the processing cycle that the
GPU hurts to actually make that matter
so then if you want something that's
more performant you probably need to
write it native anyway because otherwise
you're not going to get it and if you're
writing in a native you probably want
access to native api's like messages
notifications because these are what
actually make you money so then you have
to have this serious discussion with
yourself in a mirror about am I actually
going to write a web game that's html5
we're going to write a native
application and where's the line and
unfortunately I think this is one of the
the largest concepts and constraints and
and I hopefully hopefully this is the
the match that actually forces the web
to move in a different direction
personal opinion not of that of any my
employers anybody associated with me in
any way whatsoever are my wife I really
think the biggest problem right now is
the web is butting heads against mobile
and the fact is there was a time when
the web was the place you went for easy
access to applications and look how
amazing it was I just open a browser and
I get all this data and I get everything
and how easy and how simple it is and
how awesome it is and how responsive it
feels because the desktop browser or the
desktop applications felt slow and
sluggish and cumbersome and now we've
actually gone the other way right we've
gone completely 180 is that native
applications on your phone feel snappy
and responsive and awesome and the web
feels slow and sluggish and so we've
actually gone the other direction now is
that is that the web is actually the
slower version that people don't want to
make
anymore and so I think this is a very I
think this is important for the web to
kind of grow up and realize that they've
hit this problem and this kind of comes
back to my larger philosophy that I've
ranted about for a couple weeks now
about the web and the technology stack
involves asking serious questions about
whether or not JavaScript can get us
there whether or not our current
technology stack can get us to where we
need to be where the web can actually
start competing in this environment
again where it matters to users because
right now native is eating the lunch of
the web and I mean it's like give me
your fruit cup in the web is like okay
so but part of this is actually building
the kinds of web programs that you would
build on on mobile or native and saying
okay where does this fall short yeah
what do we need yeah yeah and that's and
that's again one of my one of my one of
my rants about the web is is even if you
write that and it falls short you have
you you don't have the much power to fix
it you got to wait for someone else to
fix it you gotta wait for the web
community to fix it for some of the spat
past w3 specifications you can get a
better primitives on the timer or
something those lines and I'm not saying
that this is this is doom and gloom
amazing things happen on the web every
day but if you want to actually compete
you gotta play the game period yep yeah
but there's hope so for a new hope oh
alright so we have a question from the
audience one thing the web it does have
going for it is exactly that you don't
need bone gap for it and you don't need
to hire jim teams to develop eventually
as you said there is hope and it will
get fixed now and there will be a way to
do performing things hopefully because
all the apps are building information
silos in the user because it's going to
implode on itself and that's a really
good point because you know the other
day my son he was an aspiring DJ put
some songs up on soundcloud actually has
a really nice web app what's the DJ name
yeah yeah well no no no you should you
should plug him yeah plugin it's
actually shot good shut up rocky lowers
yeah
go follow him on sat but so he posted it
then a few days later already had sort
of an alert that found this this music
right to add a and learn for the last
name set than fountain so had it been
sort of like put in some sort of App
Store but it would have never found it
right so to really there is a lot of
power and and a lot of these browsers
are not sitting still right there's no
yeah a lot of activity right now and
getting on par with oldest the device
access and all of those things are
moving you know faster than most people
think yeah it's doing that in a way that
also gives you that same openness that
is right really the web's hallmark yeah
yep so we've got our final question of
the week where the same hi dad what hey
buddy how you doing you get that thing i
sent you did dad said from las vegas
last week's of ritz game was working
fine today it wasn't does google need to
buy larger yesterday yes 16 million
people are playing grits right now
that's the problem you're having end of
discussion i filed some tickets and
stuff got fixed and then it got broken
my fault i will get on it as soon as i'm
done doing all the other things that you
asked me to do your other emails thanks
good all right and thanks for your
support all right so any other questions
here in the audience a not necessarily
related to this unit any other things
that are ya any other questions about
your products the games you're making
any tricky items the you'd like us to
rant about yeah i'll meet a rant them to
look sit there look pretty any opinion
so what we doin is cute come i sorry my
god you gotta come to the mic
okay I so much didn't get chance to go
to the Google dot that was here a week
or so ago the way Google dart about the
crows dart the diamond bar for breakfast
oh that was fantastic it was there
anything that could be used from that
event but not to to correlate with
gaming physics engines yes surety car
was there was an event rehabs here in
the San Francisco item 5 user group like
two weeks two weeks ago let's go
saturday morning dart for breakfast all
of the materials of that the code lab of
if you will is never available online
yeah dartlang.org has links to it can
you use it for this course actually one
of the students in this class was not
here today i think is using that sort of
knowledge to build the the game for the
contest and and what there's actually i
received like four different emails from
people as soon as dart for breakfast was
over saying hey do you mind if we part
port grits to dart and I'm like sure you
and the other 800 emails that I've
received since Google i/o last year more
power to everybody yeah so so people are
looking I don't know the the status of
the project I think Don own steam is
heading this one uppers I thought so SI
my god but yeah the darts awesome you
should definitely check out dark I'm a
big fan of dart I'm a big fan of more
structured one leg reduce static typing
yes tree shake yeah tree shaker well
it's like the Harlem shake for contacts
coming soon right yeah make sure you
point out the Udacity folks for yeah so
okay so with that I think we're gonna
wrap it up a couple of final
announcements so tune in next week for
another study group entity unit say
entity same time same place we will make
the livestream URLs and moderator URLs
available pretty soon there are a couple
of folks here from Udacity who would
like to ask you a couple of questions so
they're waving right now and tox it in
afterwards give him some feedback
um don't forget the contest there's
still time or about halfway right now so
there's a good four or five weeks left
who are entering and with that I think
any litter announcements I next unit
should be up when i get home to post it
right taking him home yeah thank you all
for your time this makes readers thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>