<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Master Secret - Applied Cryptography | Coder Coacher - Coaching Coders</title><meta content="Master Secret - Applied Cryptography - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Master Secret - Applied Cryptography</b></h2><h5 class="post__date">2012-06-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F3Zdz3npUvA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so these are two pretty fundamental
problems so that's not going to work so
we need to make some improvements here
so the way to solve this problem is to
include more randomness in the key here
so an attacker who can replace this
won't be able to trick the parties into
agreeing to a different key and then
they can verify that they've agreed on
the same key so what we're going to do
is add extra random nonces to these
steps so in addition to the messages
here the client will generate a random
value I'll call that RC that will be
added to this message the server will
generate a random value RS that will be
added to this message this value will
still be created this is what's called
the premaster secret what we're going to
send here is going to include a little
extra information it's still going to
include our - premaster secret we need
to share that with the server we're
going to pad this this will make search
attacks more difficult prevent some of
the weaknesses if this is a message
happens to be a small number so we're
going to use the pkcs protocol that we
talked about unit 4 to use RSA more
securely if this were some other cipher
we could use a different way of padding
it we're also going to add to our
something about the client version and
this will be useful for verifying that
the previous steps have not been
tampered with
so now instead of making the key just
our the key is going to combine all of
the randomness that we've used so far so
the way we'll compute the key which is
now called the master secret is by using
a pseudo-random function this is like a
hash function where what it takes as
inputs are the premaster secret
that's our and it also takes a label
which is just identifying this as the
master secret which gets combined with
the value of our see the clients around
us and the value of RS the server's
randomness and what H is is a way of
using a combination of hash functions
where it takes a key as well as the
value that you're hashing what it
produces is 384 bits which gets divided
into three 128-bit keys one of these
will be used as the key for symmetric
encryption and that's using an algorithm
like rc4 typically one of these will
become the IV and that's the
initialization vector that we need for
CBC cipher block chaining mode that will
use will talk about the protocol how it
uses that later and the other one would
be a key that's used for a keyed hash we
previously talked about hash functions
that didn't use a key the important
property the hash function is it gives
us a one-way mapping a keyed hash
function that mapping depends on the key
one way to think about that which is not
quite the way these work but it's really
concatenated that key with the value Roy
hashing it was a strong cryptographic
hash function that should be effectively
equivalent to a keyed hash function so
this change means if an active attacker
can interfere with this message they
still can't control what gets computed
here this depends on randomness used in
the previous two steps and what happens
before the channel is used for anything
secure is the client and the server need
to verify that they got the same key so
we add a step here to finish the
handshake and the way that step works is
we encrypt the finished message using
the key extracted from the master secret
that means if any of these values were
tampered with that key would be
different the handshake would never be
finished and there would never be any
secure communication sent using that key
because both parties verify the
handshake before continuing
so this fixes the first problem now
there's no way for the middle attacker
to hijack the session if they tamper
with this message it will be detected
when the final step when the handshake
finish is done using a key that depend
on all these values depending on the
random values here also prevents a
replay attacks since new random values
are used for each protocol execution
there's no way to replay it the key
depends on these values that were used
previously</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>