<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Auditing a Cross-Field Constrain - Data Wranging with MongoDB | Coder Coacher - Coaching Coders</title><meta content="Auditing a Cross-Field Constrain - Data Wranging with MongoDB - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Auditing a Cross-Field Constrain - Data Wranging with MongoDB</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Y7TNXALXut8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so let's take our conversation about the
validity of field values a little
further and look at auditing across
field constraint so remember this is a
constraint where we have multiple fields
per item that must be an agreement in
some way once again let's look at a
Wikipedia page for City in this case
Bern in the country of Switzerland so
here we have a nice example of a city
that has values for population area and
one for population density any time you
have a situation like this where you can
essentially check at least one field
against another you have a nice way of
validating field values throughout your
entire data set so the cross field
constraint here is that population
divided by area gives us the population
density and we'll employ this as one
check in auditing our data for the
city's collection so here I've written a
little program to do exactly that and it
does something like calculate the
population density based on the
individual values for population and
area and compare that to the population
density specified within the dataset
itself and we're just going to make sure
the difference isn't more than ten to
account for rounding errors in that sort
of thing now this is just a first pass
at this and just an example to show you
the type of thing we might do in
auditing across field constraint all
right let's run this we should only see
output here yep and we've got a number
of bad population densities or possibly
bad population densities so what I
usually do in situations like this is I
pick one and I basically just go look at
the data and see if I can figure out
what's going on okay this one stood out
to me so let's go take a look at that
now in the interest of time I've already
pulled this one up in our original
dataset and I've actually hidden some of
the fields here so it's easier to see
the values that we actually care about
in this case so here's the area field
population density and the population
total now what we want is for this value
divided by this value to be pretty close
to this value and if you look at this
you can see that there's no way that
could possibly happen given the size of
this okay
and as I look at the rest of these
values here I also see some values that
appear to me to be impossibly large as
the area of land for a given city
especially given that when I look at the
Wikipedia
and as I look at Wikipedia pages for
other cities I noticed that area is
actually measured in square kilometers
so there's no way I have this many
square kilometers however if I look at
Yoakum Texas I can see that its value
for area is 12 square kilometers my
guess is that this is a rounded value if
I go back and look at this data and if I
interpret this instead of kilometers as
not even meters but millimeters then
this makes sense now
from my perspective having a land area
specified in millimeters is a little
crazy but I can see reasons why the
dbpedia folks might have set things up
that way but if I think about shifting
the decimal point for this value
appropriately so that it describes
square kilometers instead of square
millimeters then I end up with a value
that's eleven point seven square
kilometers which is pretty close to this
value right here and these values were
collected some time ago so I'm willing
to bet that our problem here that we're
seeing in auditing this cross field
constraint is really one of having made
a faulty assumption about the land area
and that in fact is what the problem is
and now of course in order to verify
this we'd want to look through a number
of other fields here and actually maybe
do a bit of googling around to really be
sure that that is exactly what's going
on here and that it's just an issue of
units as opposed to an actual problem
with the cross field constraint that we
know has to exist between these three
fields and that's an example of auditing
a cross field constraint in our city's
dataset</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>