<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Reddit Architecture - Web Development | Coder Coacher - Coaching Coders</title><meta content="Reddit Architecture - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Reddit Architecture - Web Development</b></h2><h5 class="post__date">2012-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/I0AaeotjVGU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">the architecture originally looks
something like this we basically had one
machine that we were renting from this
company I'm not going to mention their
name they're so bad I try to only
mention companies I like but we were
renting one machine and this basically
ran list and this was Oliver edit we're
also running Postgres on this machine
and that was it we didn't have any fancy
caching I just use in-memory hash tables
the database had a fairly guessable
structure we had a table for links
weight a table for votes a table for
users it may have been it to begin with
there wasn't a whole lot to writer we
didn't have any comments for a long
while and the links in votes tables were
basically kind of as I represented them
in this lecture they said things like
score title URL foe basically had a link
ID a direction user had a name and a
password notice I didn't say password
hash
I actually stored the password and told
you that story of how I got in trouble
as a result of doing that we actually
did a lot of joints this last sort of
probably about first six months or so
after six months we hired a couple guys
well we kind of merged our company with
another company called infogami and that
brought us another engineer named aaron
swartz
and we hired Chris slow who is doing a
PhD at the time so the four of us me
Alexis Aaron and Chris worked on reddit
then and the first change that Aaron and
I made together was we rewrote read it
from Lisp to Python and then at about
the same time we pulled the database out
of that one machine and put it on a
second machine and so now we had two
machines with this hosting company our
app server and our DB the switch from
list of Python was kind of performance
agnostic Lisp is a faster language but
our rewrite of Python was better so the
code actually ran about the same speed
going from one machine the two machines
gave us something on the order of 4x
speed improvement remember how I talked
in the last lecture about separation of
services separating our app server from
our database gave us a tremendous speed
improvement because these two pieces of
software run totally different use
computers in a totally different way
that was the first architecture change
we made I think we upgraded this machine
once or twice to like a more beefy
machine at the time we were still
plagued by downtime where was our list
program or a Python program it would
occasionally just crash and we'd have to
get notified more often I'd just get
called I would like check the site or
somebody would call me the tell me the
site was down and I'd bring it back up
there's so many easy ways to avoid this
scenario it makes me cringe when I think
about how much time and stress I spent
on not knowing whether our website was
running the way we do it now is we use a
piece of software called supervised
which we integrated shortly thereafter
that basically what supervised died
that watches a program it runs a program
and if that program crashes it restarts
it and that's really nice setup to have
and we actually got to the point where
we'd run to Python programs on one
machine and then we had a little mini
load balancer kind of running on that
machine as well that would send traffic
to both of these pythons and if one of
them died supervisors would bring it
back up and so unless the whole machine
died
luckily never actually happened to us
I'm the website would stay running at
the time we still only had one Database
Machine we were very lucky we were very
lucky that neither of these machines
ever died because if we lost this
machine the website would have been down
until we could get a new one and our
hosting provider was very slow would
have been very difficult if we had lost
this one our Database Machine we would
have lost the data like forever we
weren't doing good backups back then it
was really fortunate that reddit turned
into a popular thing and it's really
cool that we still have those archived
and as a result of luck that we didn't
lose those because you will lose
machines machines die all the time it's
just kind of a fact of life I mean
you're running these machines around the
clock high load hard disk can fail
memory can fail there's lots of things
that can go wrong if you use a machine
constantly I look</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>