<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Countermeasures - Applied Cryptography | Coder Coacher - Coaching Coders</title><meta content="Countermeasures - Applied Cryptography - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Countermeasures - Applied Cryptography</b></h2><h5 class="post__date">2012-06-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gM20GMRZ8DQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">if we treat an encryption function as
the one in GSM as something that that
takes a message produces an encrypted
message and consumes key to perform that
there are different ways in which you
can make this resistant against hmmm be
trade-offs so three different
medications first you can make the
message unpredictable
sounds obvious why would you encrypt
something predictable but a lot of
systems do just encrypt a whole stream
of data some of which is encrypted
something is this was protecting and GSM
makes us to choose and all these attacks
you know some because of the GSM
protocol there's some messages that are
very easy I guess and you know it what
they are and can use those addresses had
to exchange a text message for instance
between the base station and your phone
somewhere between 20 and 40 messages I
exchanged only one of which has the
actual text message contents another one
may have some unpredictable setup
information all the rest is just
management information encrypted though
and that management information is
usually does it make sense as one
solution to not encrypt the management
information clearly yours now and
there's a standard extension in there's
a standard extension that suggests
exactly that but basically the whole
ecosystem would have to change to
accommodate for that so currently just
the encryption is switched on at some
point and everything they're after is
encrypted be predictable or not there
are measures door to make predictable
messages or randomized to create some
wiggle room for how you send a message
and that's currently being deployed not
in all networks though I've not seen one
of the two American networks you need to
tell me the base station is that
understanding only change the parabolic
at the the base station would have to
change to to go all the way of making
all messages unpredictable but even
changing the base station controllers
big bigger installations that control
dozens of base stations would do the job
and those are usually software updatable
because they have to accommodate for
usually faster connections all the time
now more secure connections i could do
too hasn't been seen too much yet we do
track that on GSM net org so the second
way of course of making
just a system unpro uncrackable is to
decrease the key size sufficiently so
that none of these trade-offs leads to
practical values anymore and that is
used for instance in 3g and 4g networks
most of the time and then a third way of
protecting against these types of
attacks that assume if you predict a
message you have a direct mapping
between message out and key is to
introduce an auxiliary input it's
usually called is a nonce for random
number or an initialization vector and
gsm in fact does have an initialization
vector so you would think that creating
that it breaks the correlation between
key and message is now you have to
compute your table separately for every
one thing they are this is sort of like
adding salt to passwords exactly does
the exact same system as adding salt so
this has been included in GSM however
the nonce is only effective if the if
the attacker has to go for the key to to
break the system there are different
encryption function that article was
trained memory trade-offs in different
ways particular for block ciphers this
this protection measure works out of the
box because the block cipher consumes
the key crunches it in complex ways and
outputs the message unlike so stream
ciphers
they take the key do one small
computation do the same computation
again do the same computation again in
the case of GSM 100 times and then
output the message so it becomes a
function that that that's consistent or
very many smaller functions and the
nonsense of course only input it at the
very beginning so to make this now
resistant against against a memory trade
of the intermediate States those results
of the first round second round and so
forth to the hundredths rounds have to
be a non attackable time memory
trade-off and that sometimes this is
achieved by a large internal state of
the function for instance the GPRS
functions or H function 2.5 g networks
they also consume a 64-bit key but they
have an internal state of at least
ninety six bits so that is a protection
because now the attacker has to go for
the key after all however if you use a
small internal state then the attacker
can go to attack that internal state and
GSM falls exactly in this category and
then countermeasure doesn't work in
teams and internal sales still 64 bits
exactly mining the key in the knots yeah
message in the key in the message out as
well as two internal said everything is
64 bits in GSM and of course adding an
internal state a larger internal state
doesn't come at a great cost it takes a
few more flip flops in a hardware
implementation or a slightly larger
words in the software implementation so
this didn't prevent it attack that you
described but they attack you showed us
what actually better than this that you
to do that and lookups would have taken
hours you were able to show it working
in a matter of seconds or minutes to
explain why gsm is more vulnerable we
have to go a little bit into this
Cashin we started earlier on 100 little
function instead of one big function
what makes this a stream cipher so this
stream cipher consumes in the beginning
both a key and div as we've seen but
then does computation 100 times to
produce an internal state that is then
mapped onto the output that then exhort
was there the message is basically the
output message interesting is this part
though because each of these links is
such a small computation that you can
easily reverse it it is nonlinear
meaning you cannot really reverse it
with a hundred percent certainty but
it's such a small computation that you
can just kind of brute force the input
space okay all right so little space is
small yeah just a few bits change in
each of these steps so you can just go
through all the possibilities of the
input space and see which one's map back
to to your output right now you may end
up with several so it's not always that
that only one of the inputs would have
produced that's exactly the nonlinear
property right however this may look as
a like a complication at first but does
in fact help the hacker because each of
these also generates a key for for some
some given IV that that you assume well
at least some some may may be dead ends
and but at least in a lot of cases you
can track one um one point that you
store on your table back to different
keys as it is a different starting key
IV pairs they did the same outlet
exactly and on average for each value
that you store in the table you have 13
arm keys that you find every time only
one of them will be the correct one
sometimes even all 13 are wrong
if you if you do find the key will just
be one of them however storing this
point in the table is equivalent to
storing 13 points in the sale for a
better phone is the equivalent of doing
13 attempts but the lookup actually is
the same effort but the storage is
decreased so this is basically an
inherent encryption function for rainbow
tables that this system comes with ok so
we had 13 times more efficient with this
encryption function there was a generic
64-bit encryption sponsoring area and so
13 times in such a trade-off was all the
different tweaks is the difference
between ours and seconds it's not a
linear just drinking this table by a
factor 10 which is making all the
hookups less expensive exactly basically
we're we're having 13 times more storage
and in the trade of storage is quadratic
so we're more efficient as an
approximation by the fact and that's the
difference between seconds and hours and
that's why SMS can be snooped in seconds</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>