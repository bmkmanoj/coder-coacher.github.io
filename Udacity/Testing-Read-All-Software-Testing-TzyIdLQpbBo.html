<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Testing Read All - Software Testing | Coder Coacher - Coaching Coders</title><meta content="Testing Read All - Software Testing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Testing Read All - Software Testing</b></h2><h5 class="post__date">2012-07-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TzyIdLQpbBo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so here's my read all function this is
code I just took a few minutes to write
and what you can see is that i've
included a couple of assertions the
first thing is I've asserted that the
file descriptor passed in is greater
than equal to 0 UNIX file descriptors
are integers usually small ones and they
have to be non-negative the second thing
we're going to assert is that buff that
is to say appointed to the block of
memory into which we're going to read
data can't be the null pointer and just
a sorting buff like this is implicitly a
test the pointer is not null and see and
the third thing we're going to assert is
that the number of bytes to read is also
non-negative so given that setup and
we're just doing a little sanity
checking here we can get to the main
logic so the first thing we're going to
do is initialize a left variable which
is going to be the number of bytes left
to read to initially be the total number
of bytes to read now we're going to
enter a while loop the while loop is
going to operate until either the read
system call returns something less than
1 that is to say it returns 0 indicating
an end-of-file condition or minus 1
indicating an error and if either of
those things happens we're just going to
return that value to our caller if Reed
worked that is to say it read some
positive number of bytes we're going to
increment the buffer pointer by that
number of bytes reduce the amount of
bites left by that number of bytes
assert the number of bytes left hasn't
gone negative due to some sort of a
logic error and now finally if there are
no bites left we're going to return the
number of bytes read which has to be
just the original number of bytes that
the user asked to read so this is pretty
simple code and I would expect or at
least I would hope to be able to get it
right but i know from vast prior
experience that i never get this stuff
right the first time so what i want to
do is be able to test it and so what
I've done is written a little test
harness and so what the test harness
does is opens of opens a program and so
here we're just using a splay tree from
python that happens to be in this
directory and allocating a buffer and we
don't need to worry about the details
here and then what we're going to do is
a hundred different times we're going to
issue the read all command to read the
contents of the file into the buffer and
then we're going to assert that the read
all always read the full number of bytes
we're trying to read and then we're also
going to assert using a memory
comparison function that the contents of
that file are the contents that we
expected this definitive variables
initialized in some code I didn't really
talk about to contain the data from the
file and so we're going to say is if we
do this 100 times then our new read all
call passes so let's look what happens</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>