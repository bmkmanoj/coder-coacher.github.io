<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Networking Security Intro - Georgia Tech - Software Defined Networking | Coder Coacher - Coaching Coders</title><meta content="Networking Security Intro - Georgia Tech - Software Defined Networking - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Networking Security Intro - Georgia Tech - Software Defined Networking</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/leTiP1s6RCk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">to see how a DNS cache poisoning attack
works consider a network where a stub
resolver issues a query to its recursive
resolver and the recursive resolver in
turn sends that a record query to the
start of authority for that domain now
in an ideal world the authoritative
nameserver for that domain
would reply with the correct IP address
if an attacker guesses that a recursive
resolver might eventually need to issue
a query for say google.com the attacker
can simply reply with multiple specially
crafted replies each with different IDs
although this query has some query ID
the attacker doesn't need to see that
query because the attacker can simply
flood the recursive resolver with a
bunch of bogus replies and one of them
in this case the response with ID 3 will
match as long as this bogus response
reaches the recursive resolver before
the legitimate response does the
recursive resolver will accept this
bogus message and worse it caches the
bogus message and DNS unfortunately has
no way to expunge a message once it has
been cached so now this recursive
resolver will continue to send bogus a
record responses for any query for this
particular domain name until that entry
expires from the cache now there's
several defenses against DNS cache
poisoning and we've already seen one
which is the query ID but of course the
query ID can be guessed the next defense
is to randomize the ID so rather than
having a resolver send queries where the
IDS increment in sequence the resolver
can pick a random ID
this makes the ID tougher to guess but
still the query ID is only 16 bits which
still makes it possible for an attacker
to flood the recursive resolver with
many possible responses and it's likely
that with relatively few responses one
of these bogus responses will
the ID for the real query due to the
birthday paradox the success probability
for achieving a collision between the
query ID of the query and of the
response actually only requires sending
hundreds of replies not a complete
32,000 due to the birthday paradox the
probability that such an attack will
succeed using only a few hundreds of
replies is relatively close to one the
attacker does not need to send replies
with all two to the 16th possible IDs
the success of a DNS cache poisoning
attack not only depends on the ability
to reply to a query with the correct
matching ID but it also depends on
winning this race that is the attacker
must reply to that query before the
legitimate authoritative name server
replies if the bad guy or the attacker
loses the race then the attacker has to
wait for that correct cached entry to
expire before trying again
however the attacker can generate his
own DNS query for example he could query
one google.com to google.com and so
forth each one of these bogus queries
will generate a new race and eventually
the attacker will win one of these races
for an a record query but who cares
nobody necessarily cares to own one
google.com or google.com the attacker
really wants to own the entire zone well
the trick here is that instead of just
simply responding with a records in the
bogus replies the attacker can also
respond with NS records for the entire
zone of google.com so by creating one of
these races using an a record query and
then responding not only with the a
record response but also with the
authoritative of the NS record for the
entire zone the attacker can in fact own
the entire zone this idea of generating
a stream of a record queries to generate
a bunch of races and then
stuffing the a record responses for each
of these with a bogus authoritative
NS record for the entire zone is what's
called the Kaminsky attack after Dan
Kaminsky who discovered the attack the
defenses of picking a query ID and
randomizing the ID help but remember the
randomization is only 16 bits so let's
think about other possible defenses</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>