<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Intro to XLRD - Data Wranging with MongoDB | Coder Coacher - Coaching Coders</title><meta content="Intro to XLRD - Data Wranging with MongoDB - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Intro to XLRD - Data Wranging with MongoDB</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TcWtpvLSoG0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay let's turn our attention now to
working with Excel documents what I'd
like to use is an example here is data
from The Electric Reliability Council of
Texas this is an organization that
manages the flow of electricity to
millions of Texas customers they also
provide a lot of publicly available
datasets on things like load or the
amount of electricity that's used by
their customers this is one such example
for the calendar year 2013 a lot of
organizations publish this type of data
and often they will publish it as Excel
documents what that means for us is that
we have to have a way of
programmatically working with Excel
because many times we'll want to process
dozens or perhaps hundreds of files all
of which have been published as Excel
what I'd like to introduce you to here
is a Python module called xlrd xlrd
allows us to work with excel files
whether it's the old XLS format or the
new xlsx format this module will allow
us to read in all of the data from an
Excel workbook and work with it in any
way that we need to in a Python program
there's also an excel WT module which
allows us to create Excel files if we
need to do that programmatically ok so
the first thing that I want to do before
we dive in and take a look at this
example code is actually go through and
run it ok what I've done with this
program is produced output that
illustrates a lot of the features that
you might want to work with when using
Excel Rd when processing Excel data so
one of the things I'd like to illustrate
here is how we can read our data from an
excel file entirely into a Python list
and work with it how we go about working
with rows and columns and individual
cells in an excel file using the excel
Rd module and then finally a little bit
of information about dates this is
primarily because of the way that dates
are represented in Excel that we need to
talk about this so let's go back and
look at this code here we're simply
specifying which file it is that we're
going to load in this case it's an XLS
file an old format Microsoft Excel file
ok and then the bulk of the work that
we're doing here is actually done in the
file function-- all right so this is the
command we use to open a workbook and
you note that we're using the same
variable name here okay and then we need
to specify which sheet we'd like to work
with so here we're selecting the sheet
zero and you'll find that xlrd is
entirely zero-based indexing so the very
first column is actually column zero the
very first row is actually row zero okay
here's an example of doing a list
comprehension and in this case what
we're doing is essentially looping
through all of the rows and columns and
reading all of that data into a Python
list what I'm doing here then is simply
printing out the value of Row 3 and
column 2 for this list that we've just
generated now if I scroll down a little
bit we can see that following the list
comprehension piece what we're doing
here is looping through the entire sheet
one row at a time and then moving across
the columns and the way I've set this up
is that once we get to Row 50 what we're
going to do is essentially print out all
of the values in that particular row one
column at a time now again this is a
piece of code that does nothing more
than simply illustrate the functions and
methods that you'll want to work with
when using xlrd
in the next piece of our example code
I'm illustrating how to work with rows
and columns in xlrd alright in this case
what we're going to do here is we're
going to simply grab the number of rows
for this particular sheet and then we'll
print that out alright this is an
illustration of how to check the data
type or the value type for a particular
cell using the cell type method for
sheet 4 objects of type sheet ok and
then cell value this actually gets the
value that's stored in that cell as the
appropriate Python value whether it's a
floating-point value or something else
and then finally this is actually a
pretty cool method here we can slice the
values out of a particular column what
that means is that we can say okay I
want 3 values from this particular
column and I want to start on Row 1 so
actually the second row down and I want
to go through rows 1 2 &amp;amp; 3
to Row 4 but not including real four and
I want to take those three values sliced
out of that particular column okay and
then here we are doing something very
similar to what we did here which is
actually checking the type of the value
in a given cell but in this case we have
a date in this cell okay so we're going
to pull out the cell value now it turns
out that in the old Excel format dates
were represented simply as
floating-point numbers so what we can do
is use the Excel Rd date as tuple method
to get us that time in a way that allows
us to work with it
as a date in Python okay let's go look
at that output one more time okay so
here's our list comprehension
we're simply printing out the value at
Row three column two from the list into
which we read all of the Excel data so
here we can see where I was looping
through the rows and columns and printed
out all of the values on row 50 okay and
then number of rows in the sheet happens
to be more than 7,200 all right now note
here that the type of data in cell two
is specified as two you can look up if
you want to in the xlrd documentation
exactly what all of these different type
of identifiers reference in this case
it's a floating-point number we can see
that the value that we've got there is
1036 and change okay and here's the
output from having taken a slice out of
column three okay so here's that piece
where we were working with dates now
xlrd does distinguish the fact that that
particular cell holds a date but here's
the time represented as a floating-point
number
okay what we can do is convert this to a
Python date/time tuple using that xlrd
method that I showed you and this gives
us a much better representation of the
data that we're interested in so in this
case what we've got is row 1 column 0 so
it's that very first cell at the top
okay this one here all right and note
that what we're pulling out there as the
value is in fact year 2013 January 1st 1
a.m.</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>