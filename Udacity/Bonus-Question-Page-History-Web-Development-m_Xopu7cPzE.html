<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Bonus Question Page History - Web Development | Coder Coacher - Coaching Coders</title><meta content="Bonus Question Page History - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Bonus Question Page History - Web Development</b></h2><h5 class="post__date">2012-06-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/m_Xopu7cPzE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">let's talk about the solution to the
bonus problem now which was add version
history so the way that worked through
members if I click history we can see
the previous versions of this page if I
were to make a new version of this page
I can click any of these edit links
click Save we can see we edited the page
and if I click on history again we can
see this new version version 3 you can
see the content of that page up here so
that was feature number one required for
the bonus which is view the history of
all these pages feature number two is
view any particular version of this so I
can't just go to slash new page I have
to also say what version it is so if I
were to go to this middle version here
I'm going to new page and then I edit a
get parameter for what version it is in
this case it's five and that's just the
database ID you know I think this one is
version 10 because I may have made other
objects so Google is just assigning the
ids and doesn't really matter now of
course i can edit any version of these
and they have their own special URL and
this is editing new page v4 which is
that first version and if i were to save
this it overwrites that the newest
version so if we look at history again
we can see it's plopped up on the top so
and if I want to restore the most recent
version i can just click Edit safe and
there's our page again and if we go to
history we can see all the history so
that's pretty cool let's talk about the
implementation ok so the first thing is
there's a number of ways you could have
you could have done this you could have
one page that has instead of content i
could have a list of contents there's a
way to store a list of things in data
store that's that's a fine way to do it
what I did is I basically said every
page has a name which is always going to
be pages and it has a parent called /
route plus the path and I originally did
I prepended / route in there because I
thought it was going to be more
complicated than it was but basically
remember entities in the data store can
have these ancestors this hierarchy of
objects now we'd spend a whole lot of
time talking about this and you know
it's not understanding that isn't
required for doing this homework because
there's many ways you could have done it
and this is how I chose to do it so
every URL has this
basically this common ancestor and so
when we look up in a page by path all
I'm really do is I'm saying get me all
of the pages that have this ancestor
basically give me all of the pages that
belong to this URL sort of by most
recent and then I always just use get to
get the most recent and if I want to get
an old version i say i use the get by ID
function which takes an ID and it also
takes it can take a parent key which
uses the same key as the main path query
and what this is saying it says okay get
me to get me the page this case class
refers to page because its class method
and we're in page get me the page by ID
this is the data so this is built in the
data store now with this ID and this
parent parent and this so we can go we
can go get older versions out of history
and then when we're rendering this stuff
you can see here on at a page you know I
can call by path and then call get to
get the first response out of the query
or I can do this other thing which is
look for the V parameter which is the
version if it's there and if it's a
digit if it's basically valid try to run
by ID on it and if that's not there that
page that version just doesn't exist not
found otherwise basically if there's no
vivre parameter just look up the normal
version and we have the same block of
code and then in the normal wiki page
for viewing any page on the wiki this
exact same block of code and of course
we'd want to clean this up and the code
that I'll give to you will probably have
this cleaned up in it so let's take a
look at some of these templates real
quick so we can see the last bit of how
old is this together i'm using template
inheritance again so my base template
basically has the title of the wiki
references my style sheet and it's got
the basic structure of my document which
is going to have you know a body tag and
then a couple of dips that have these
classes are just for styling you know
not required for completing this
homework just required to make your
homework look a little bit better you
know and I was you know I want my stuff
to look slightly good so you know I use
them this is the whole header area where
we draw those links so basically if
there is a user you know we print the
username and then we print the logout
link which is just a basic link to slash
log out if the user is not logged in we
draw two links 14 login 14 sign up and
those are also just basically
they both have the gray link style which
is how I make them gray and I make that
underline hover thing work and then I
have a div here that basically doesn't
have anything in it this is just a block
remember this is kind of a way of doing
this kind of template inherits tent
stuff so you'll have to write the same
HTML over and over and other templates
that inherit from base will fill in this
block and this is where we put in the
controls for editing a page or viewing a
page or viewing history of a page all
that stuff gets overwritten in the other
templates this clear Davis technique the
technique I used to float those links
over to the right is called float when
you float something it doesn't take up
any space and one of techniques to make
it take up space is use this clear div
I'm not going to attempt to explain that
here but it's basically a CSS trick for
floating something over to the edge of
screen and still having a vertical
height here we have the actual content
this is where either the Edit window is
going to go or the wiki content page and
again there's no content in here we just
define the block and the other templates
will overwrite it so let's look at the
template for page at HTML which is
basically draws the actual wiki content
page so it extends base HTML which
basically says use all that other stuff
and then we can just overwrite the two
blocks so on an edit page I mean sorry
on a viewing page a normal wiki page you
have two links 14 edit and 14 view in
the history but we only draw the Edit
link if the user is logged in so if the
users logged in draw the Edit link and
if the user regardless of other user the
users logged in draw the history link
and these two links are simple one is
underscore edit and the path remember
the path was passed in into my render
function and one is on the score history
to the path so both those linked just
these are just simple links that go to
the handle by the appropriate handler
and then in the actual content we render
the page content and I use that the
ginger safe notation is basically says
don't escape this which basically says
take the HTML that was typed in and
insert it directly on the page security
issues be damned since I entered all the
HTML I know it's ok now if you're going
to put this website online you want to
have probably some special escaping what
a lot of websites do is they only allow
some HTML or they have a special
language that turns into HTML or they
don't allow HTML at all but that
wouldn't allow links and then the wiki
wouldn't be very useful so you know
that's a design decision that's up to
you
edit HTML this is our template for the
edit page the controls are very similar
to the viewing page we have a link to
just called view which is links to the
page itself so that's basically kind of
like a cancel button and then we have a
link to the history of the page so you
can view the history of the page right
from the edit page and these are just
basic links and we only draw these links
if the page already exists if you're
creating a new page there's nothing to
view and there's no history so that's
what if page is done and remember when
we call this template we pass in whether
the page existed ok now here's my form
it's a method post' and has this class
is called main edit that's just for
styling purposes to make it render nice
and big it's basically a giant text area
whose name is content and who includes
basically page and page that content so
if the page exists render its content
otherwise render an empty string that's
what's going on there and then at the
bottom of the form we have this little
area called form footer which just has
the Save button and we'll go through all
that CSS so the edit page is actually
fairly simple as well the history page
this is for viewing the history of a
wiki page again we've got our controls
if the user exists draw the Edit link
just like the the main wiki view page
and regardless of whether users logged
in draw the view link to just view the
page instead of view in the history and
then our content here I'm drawing a
table now we didn't spend a whole lot of
time or any time at all on tables in
this class it was in some of the example
code I've given you but it does what you
would expect that draws a table so we
draw a table history table is what I
used to style it now i'll show you that
function again called gray style but
what this does is this basically for p
and posts return the p and basically
whether that rose even our odds so
that's how i do that that affects where
each rose is one is white and one is
great so i'll show you the effect first
here it is this is the history page you
can see the first road is white first
row is white second row gray white gray
white that's just kind of a nice effect
when you have a table so i just did a
simple version of that and the code to
generate which of these rows should be
gray looks something like this so here's
that gray style function will look at
this in the template again but basically
it takes a list and it enumerates over
the list this is a built in Python
function that basically say
earn the elements of the list in a
topple along with the index of that
element in the list so so 4x enlist
would return basically each page you
know page 1 page 2 page 34 n X and
enumerate list basically says index into
the list select 0 comma page 1 0 comma
page 2 as tuples so basically we say and
then if n is modulo 2 equals 0 basically
if it's even the row should be blank or
basically return X and blank and if it's
odd return X and grey now there's a lot
of stuff going on in this function it's
also using yield which is how you build
generators this this is this is complex
stuff not required for the homework at
all but this is this kind of how I
wanted to create that effect you could
also create a defect in the template
itself by having a variable that you
create and check to see whether to even
or odd this is kind of the more pythonic
way of doing it so back to the template
so I piro style so Rho Styles use are
going to be a blank string or the string
gray and then I use that in the class
name for each row so each row is either
going to have a class of nothing or of
the word gray and that's how on the CSS
I decide whether to make the real gray
or not and then so then i have three
columns that's what TD does first column
is the date and so i just print the last
modified time the second column is the
content and I print the first 100
characters of the content and then the
next column is a link to view that
version of the page which is just a
normal link it's got its got that gray
link style on it which you know makes it
look like my other links and in its href
points to the path and then I add a get
parameter V equals and then the ID of
that post and remember dot key ID is how
you get the idea of an element in google
data store or of an entity so the URL
will be the basically the path of the
page were on plus the ID stored in the V
parameter and we saw in the Edit and the
wiki handlers we look for that V
parameter to see if we can find a
specific item now going a little bit
further down if the user is logged in if
user we create the Edit link so this is
a link to edit and what's a link called
edit and it's a link to slash underscore
edit
and then basically the same link is up
here path V equals and then we conclude
the idea of the page now I should
probably clean this up I should probably
have a function may be on page that says
like edit URL history URL normal URL
version URL that sort of stuff would all
be really handy and I would have to keep
including that in the template and
that's probably one of the first changes
i'll make cuz this is kind of error
prone you know we've got all this code
that's the same these two lines are the
same basically you don't want to get
that situation because if I edit one
then I gotta remember that the other etc
then we just close out our statement our
for loop in our table and that's how we
do the history page so that's all the
templates I'll walk you through the CSS
real quick that I use the style things
and then we'll be done first I say HTML
remember outside the body element is the
HTML element I say height one hundred
percent and this is part of what allows
me to make that text area on the Edit
Page take off the whole page let's take
a look at that real quick if I click
Edit up here my technique for making
this text area fill the entire browser
is basically to make the HTML which
normally is just the size of the content
actually take up one hundred percent of
the space so that's what that hundred
percent does the body element also needs
to be a hundred percent for the same
reason position relative position
relative basically when use of it is to
adjust where things appear relative to
where they should appear or you need to
have position relative on a parent
element of an element that you can
position absolutely which is that's
basically what you do when you want
something to be positioned specifically
on the page and we'll come down to that
you know I choose my file my default
font size the width of the whole
document which is 800 pixels margin 0
auto basically says center that our
default color which is kind of this
great color for all the texts the header
area of the page it's 30 pixels tall the
line height is 30 which causes the text
actually Center vertically when we give
a 10 pixel margin to the content the
control elements floats to the right
control element those are the links for
editing viewing in history that appeared
over here on the browser and float right
basically says take that content and
float it to the right and it's gray font
size 13 controls following controls give
it a little space between them remember
we have concepted controls for logging
in and sign up and for doing the page
actions and they just put some space
between it straight that real quick
right here
is that 20 pixels between those two
things this is one control element and
this is another control element and
they're both floated to the right so
they kind of stack over there so that's
what those two things do a great link we
use this all over the place basically
make our links gray and don't underline
them and if they're visited instead of
joining them as purple draw time is gray
if the mouse is over them that's what
however does draw the underline so that
behavior looks something like this when
I put the mouse over the log out here
you can see the underline appears and
all of our links have that effect and
it's kind of an effect I like and you
can see we use the gray link over here
on all these styles as well so that the
other line appears on the mouse it goes
over it and you can do that all in CSS
okay errors should be red we use that
all time so main edit this is the class
that's on that main form in its position
absolute so that allows me to basically
force the positioning of this element
and so I say position at 45 pixels from
the top of the page 0 pixels from the
right 10 pixels from the bottom 0 pixels
from the left so that makes our form
grow up to fill the whole space and then
text area under main edit it's the same
thing except zero pixels on the top of
the form 30 pixels from the bottom of
the form that gives us room for the
button and then 0 pixels in the last 20
pixels on the right and so that makes
our text area take up nearly the entire
form in our forum footer is also
position absolute and that's at the
bottom 0 pixels in the bottom 0 pictures
from the left 0 pictures from the right
I didn't specify top which basically
means draw it normally and I say height
3 pixels so that draws a row along the
bottom for a save button on that is 30
pixels tall our button our submit button
is font size 18 pixels here's our table
border collapse collapse basically just
shrinks our table a little bit otherwise
tables have kind of this default spacing
between all of the cells so if the table
has a CSS attribute of grey which is how
we do alternating rows set the
background color to eee which is
basically light gray if it's a date cell
make the width 200 pixels if it's a
Content cell give some padding so let's
just kind of fattens up our table a
little bit and if it's a Lynx l have a
little so padding just giving it a
number basically says put padding on
top bottom left and right 10 pixels if
you do it like this the first number is
vertical padding which we say is zero
and this is horizontal padding five
pixels and this gives us this affect the
little five pixels between the view and
edit here if I got rid of that these
would actually there'd be no space
between these words because we're in a
table so that just adds that little
space so that's it I know that's a lot
we didn't cover CSS in this course but I
still like to kind of show you it in
case you have questions and because you
know i'll provide the CSS and you can
play around with it in your own projects
and that's it for the final if you
manage to figure all that out that's
really impressive I I know that the
final itself was challenging and the the
bonus question of doing the history
itself was also pretty tricky so if you
manage to get all this working that's a
very good job that's really cool and you
guys can you know that that's that's a
sign that you've I think learned a lot
in this class and for those of you who
didn't figure it out or didn't try
that's something to you know aspire to
down the road so that's it for the class
I want to thank you all for you know
hanging with me this far it's been a
really fun experience and I hope you
learned as much as I did you know over
the last few weeks it's been a lot of
fun so I'll see you around the internet
and good luck out there</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>