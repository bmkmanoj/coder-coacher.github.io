<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cookie Hashing - Web Development | Coder Coacher - Coaching Coders</title><meta content="Cookie Hashing - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cookie Hashing - Web Development</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IUTtcMMpo-c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what we're doing now is restoring where
we have a cookie that looks something
like this and on the server side when we
receive this cookie we make sure hashing
1 gives us this hash value and if it
doesn't we throw it away now does this
really solve our problem a little bit
but if you know if this if they know
we're using md5 which is you know pretty
easy to guess it's easy to forge a
cookie right you can just change the
cookie value to whatever you want
run md5 on it append that and now you
Forge the cookie so how do we solve this
problem let me show you what we need to
do is we need to add we need to have
some secret knowledge here so instead of
hashing you know the number 1 into our
hash what we want to do is we want to
hash a secret string plus the number 1
into a hash so as long as this secret
stay secret a would-be attacker even if
they know our algorithm won't be able to
forge a hash because remember one of the
properties of our hashing algorithms is
it's very difficult to find you know
find two inputs that equal the same hash
or to find a specific input for specific
hash and and vice versa
so you know they'll see in our cookie
you know they'll still see a cookie
you know the browser will still see a
cookie that looks like this but instead
of hashing this one we added an extra
little secret and as long as the
attacker doesn't know the secret they
won't be able to generate the same hash
so let's build this functionality and
bit by bit this one one last thing in
Python I want to introduce you to so
we've been using hash Lib to run basic
hashes there's a second library
specifically for doing a message
authentication called H Mac hash face
message authentication code this is
basically as a special algorithm it's
built in the Python for when you want to
combine a a key with your value to
create a hash there's a series of
different types of attacks where you you
know if you just put your key plus the
value you can find a collision by just
kind of extending your value and
similarly if you put your value and then
the key there's there's other attacks
you can do an H Mac is basically just an
algorithm that you know looks something
approximate like this hm at a secret a
key a hashing function returns a hash so
it'll it'll look just like using hash
Lib except it'll take an extra prime
for secret which will incorporate in a
secure manner you could just call you
know use our hash loop function with you
know secret plus value and that'd get
you pretty close and for our purposes it
actually probably worked this fine but H
Mac is is the proper thing to use here
again you can you can learn more about
HM AK you know on Wikipedia or something
there's a wealth of information on what
the algorithm actually is but it's
basically a special way of using a
particular hashing function with the
secret key I'll show you that real quick
and Python how we how we use it okay
let's review some of the things we've
talked about if we were to make a hash
the way we've been doing it you know
we'd use hash lip I could create an md5
of a string they call hex digest on it
and we get you know the hex output we
can use the H Mac library to accomplish
something similar similar but HMA takes
an extra parameter for a secret and
combines it securely you know we could
say hm a canoe and we give it a secret
and give it Udacity I say hex digest and
and we get a you know we get a similar
output except this is more secure of
course we could have done something like
this secret Plus Udacity and as long as
secret stays the same when we verify you
know our algorithm will still work but H
Mac is this basically a more secure way
of accomplishing secret Plus Udacity
let's use this new HM AK function and a
new secret key to improve our make
secure value function</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>