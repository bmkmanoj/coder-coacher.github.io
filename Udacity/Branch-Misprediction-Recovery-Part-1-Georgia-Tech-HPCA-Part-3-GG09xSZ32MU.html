<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Branch Misprediction Recovery Part 1 - Georgia Tech - HPCA: Part 3 | Coder Coacher - Coaching Coders</title><meta content="Branch Misprediction Recovery Part 1 - Georgia Tech - HPCA: Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Branch Misprediction Recovery Part 1 - Georgia Tech - HPCA: Part 3</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GG09xSZ32MU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we said we need Rob in order to have
precise exceptions and also to be able
to easily recover from branch
mispredictions so let's see how that
happens suppose we have a program that
reaches a branch and suppose that our
prediction was that the program will
continue here and fetch these three
instructions although in fact the
program branches so these three
instructions will be executed in a
branch misprediction let's say what
happens in this program in our Rob and
the registers first we will issue the
load here its output is the r1 so at the
beginning of all of this the Rob is
empty the issue in commit point are the
same and that let's say that there are
no instruction at the beginning of all
of this let's say that there are no
instructions so the rat is just pointing
to the registers and the issue in commit
point in the Rob are the same meaning
that the Rob is empty all of the entries
are free now let's see what happens when
we issue the load we move the issue
pointer here the load produces r1 and r1
here in the rat is made to point to the
Rob one entry when we issue the branch
it produces no output and thus we don't
need to rename anything and our issue
pointer moves here next what happens we
will issue instructions that shouldn't
have been issued but the processor
doesn't know that yet so it's just going
to do it anyway so decide here rights to
r2 and it gets the next Rob entry here
so the r2 entry is going to point to Rob
tree and then this multiply here is
going to write to r3 and thus r3 is
going to point to Rob for and then the
divide is going to again write to r2 and
that means that the entry for our two in
the rat will be changed from pointing to
the add to pointing to the divide which
is Rob five and of course after all of
this issuing is done a ratio pointer is
now here and we have five instructions
in our crop now suppose that this slow
takes a long time to produce a value for
example because it's a cache miss
this branch depends on the load so it
cannot complete until the load is done
and this add also depends on the load
and it cannot complete until the load is
done but this multiply here can begin
because our tree and r4 are not produced
by any of these instructions so this
multiply might produce a value for
example 15 and originally it would write
it to the registers and at that point
after the branch misprediction but this
multiply can compute its value because
r3 and r4 might be ready they're not
produce many of the previous
instructions so the value of 15 when the
multiply finishes would have been
written to the registers and then we
don't know how to undo the
multiplication once we discover that the
branch has been mispredicted in a row
based processor and the result of the
multiplication goes into it's Rob entry
and it's marked is done once this
multiply produces a value the divide can
begin and let's say that the divide is
producing a value of 2 and it might also
be done before the load returns
so now we have a situation where these
two instructions would have updated
registers and done permanent damage but
in a row based processor all they did is
update the Rob entries the registers are
still unmodified</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>