<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The client youll build_V3 | Coder Coacher - Coaching Coders</title><meta content="The client youll build_V3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The client youll build_V3</b></h2><h5 class="post__date">2016-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DEw_CZdzYZ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so let's look back at the tmdb
client ducks will fall there are two
common and methods in this fall called
tasks for get method and task for post
method the goals of these methods is to
take the duplicate code that exists for
the get request and the post requests
that we're making to the movie database
and moving them here now you could
create different methods for this goal
they don't have to be called tasks
forget method and task for post method
those were just some names that we chose
for this example now you could even
split these methods tasks forget method
and task for post method into smaller
methods each specialized for a different
part of making a network task so maybe
building the URL making the task and
then you could have something that
checks the errors and I'd highly
encourage that but for now we're just
going to work with these two methods so
I'm going to delete these real quick and
use them as a way of giving you an idea
of how this kind of process works how
this process of better architecting our
apps works because at the end of the day
what we're really trying to accomplish
here is better design of our code and if
you talk to 10 different developers you
might get 10 different ideas about what
better design is but that's kind of
another topic for now let's just focus
on what these methods take as parameters
and what they return so that we can work
on this specific example each method
takes a string parameter called method
the intent of this parameter is to
represent the API method that should be
used by the request so remember these
are things like this was it I'll think
often occation ballet with token or
slash account these were the methods
that we're talking about
then our second parameter for lack of a
better word is called parameters and
it's a variable parameter and it takes
any of the parameters that we want to
specify in the URL such as the API key
these are things that go in the query
portion of the URL
next for the task for post method we
have this extra parameter that's not
included in tasks forget called JSON
body and of course this parameter allows
us to pass in values into the HTTP body
of a post request and we'll look at it
more later now the last parameter is
where these two methods get really
interesting
both methods end with a closure
parameter called a completion handler
forget in this case and completion
handler for post in the test for post
method now remember a closure is just a
block of code if you need a refresher on
closures I recommend that you go back
and watch the Swift syntax section that
we have on closures now these closures
that we've called completion handlers
they're very similar to the completion
handlers that you've seen before when
we've used the nsurl sessions data tasks
for requests and we can look at an
example that over here remember those
completion handlers they had the data
response and air parameters and these
completion handlers aren't run until the
data task itself completes and then it
executes this block of code these things
are very similar here on the Left these
completion handler is very similar but
the signature is just a little bit
different these completion handlers take
result which could be any object and an
optional NS error and they return void
or nothing
we're going to use these completion
handlers to pass back the resulting data
from our network requests in the result
parameter or if an error happens for a
request then we'll pass back the air in
the air parameter if that was hard to
follow then let's pause and let's take a
look at the tasks for a get image method
it's already implemented and it has a
similar completion Handler it's called
completion handler for image and it's
going to look very much like what we'll
do for these two methods so let's take a
look at this one real quick so in this
method we start by building the URL and
the URLs so we can make a network
request for some image keep scrolling
there we go it makes the request and
then the completion handler for the
request it starts with our series of
guard statements to make sure that there
is no error and then assuming all these
guard statements pass then it calls the
completion handler for image and it
passes the resulting data the image data
and because there was no error it passes
nil for the air and then it calls the
resume method for the task to make sure
it runs and then we return the network
task now the network tasks being
returned here is just an implementation
detail don't worry about that for now
let's focus on this call to the
completion handler for image this line
of code it calls the closure that's
passed into task forget image it's
calling this closure
so let's see what this looks like if
we're to call task four get image that's
going to make this make a lot more sense
I think now back on our login view
controller let's pretend that I want to
call tasks forget image so to call this
I'm going to specify some phony size and
file path and then we'll get to the
completion handler for image closure
part now this is where we get a real
opportunity to see the power of closures
here where I'm calling tasks for get
image I want to specify what I want to
happen when this task completes that's
closure which we've specified as a
trailing closure it has access to the
image data and any air that may have
occurred and we can get rid of Floyd
here
if you think about it this is the exact
same behavior that we want with our
tasks for a get method and task for post
method inside of our viewcontroller so
this is our login view control remember
we want to be able to make our requests
using the client so the tmdb clients
being used and then when the requests
completes we can use the resulting data
or the air right in the view controller
and this helps reduce the complexity of
our view controllers because it puts all
the networking code into the client we
don't see any networking code here we
just see the tasks that we're wanting to
call and we see hey we're gonna get some
data back or some air back what do you
want to do with it so from the
perspective of the view controller we
don't really care how the networking
works we just want to know are the
results or was there an error and then
we can handle those cases appropriately
okay so that was a lot to take in so
let's just pause for a second if you
need to take a deep breath if you need
to go back and re-watch this video from
the beginning feel free when you're
ready to move forward we're gonna get
started with tasks for get method it's
gonna look a lot like this task for get
image in the sense that it's going to
allow our view controllers to just make
the call and then have our completion
handler our closure here specify what we
want to do with the results</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>