<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Producer Consumer Pattern | Coder Coacher - Coaching Coders</title><meta content="Producer Consumer Pattern - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Producer Consumer Pattern</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VXJSJ6c3ZIs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">one of the most common design patterns
for multi-threaded applications is the
producer-consumer model this can be
viewed as a special case of one of the
models discussed before if you like to
motivate a discussion we'll use a
tracking application here's our camera
maybe it's monitoring the number of
people on a subway platform to help wrap
trains or something like that we can
then break the computation down into two
pieces one is to get the picture from
the camera into the memory we'll call
this the producer task and the other
task is to analyze the picture to figure
out where all the people are and pass
this information on to the train planner
or whoever may need it we'll call this
the consumer task now for this scenario
suppose the images are available from
the camera every 33 milliseconds we want
to get all of them so we're going to
have a thread whose job is just to copy
the frame from the camera into computer
memory and let's say that the image
processing to find the people is
variable taking somewhere between 20 and
40 milliseconds but on average less than
33 if we're more than 33 we could put
more consumer threads here to do the
work because of the variability in the
time it takes to process the image we
need to place in which to store images
that our consumer thread is not ready to
handle and for this we'll use a ring
buffer each division here represents
memory for a frame from the camera the
ones that haven't been consumed yet I've
colored in red and we should imagine the
producer and consumer threads chasing
each other around this ring with the
producer one writing frames making them
red and the consumer one running behind
turning them back to white that is empty
or processed though of course the
consumer will never pass the producer</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>