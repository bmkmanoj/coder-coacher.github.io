<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Loop Unrolling - Georgia Tech - HPCA: Part 3 | Coder Coacher - Coaching Coders</title><meta content="Loop Unrolling - Georgia Tech - HPCA: Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Loop Unrolling - Georgia Tech - HPCA: Part 3</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hsQj7n-8Q3A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now we will see how loop unrolling works
suppose we have this loop in the C
language where I goes from 1000 down to
0 and in each iteration of the loop we
add something to the ice element of the
array a when we translate this into
instructions we get a loop like the one
we have already seen we load from the
array element so r1 is now the pointer
to the il iment of the array we load
that we add our 3 that would be our s to
that and then we store it back into the
a of I and then we move our pointer four
places down that's equivalent to
decrementing I and then we check whether
the pointer has reached the beginning of
the array which is equivalent to
checking whether I is 0 now let's apply
loop unrolling to this loop we will do
what we call unrolling once we unroll
the loop by making each iteration of the
new loop do more than one iteration of
the old loop so when we unroll once what
we want to do is now each iteration of
the new loop will be doing the work that
it should be doing plus the work of the
next iteration however if we just do it
this way then we are doing the same work
twice so instead what we will do is we
will adjust the index so that this is
doing the ithe element of the array and
then I would be decremented and the next
iteration would now do a of I minus one
however this loop still counts one at a
time so we do this we add as to the next
element in the next iteration of the
loop we would now add as again to the
same element we already processed here
so we also need to adjust the loop
counter update to update by two now and
now we have a new loop that has half as
many iterations each of which is doing
the work of the two original iterations
we could unroll the loop more than once
for example unrolling two times would
mean that this loop is doing now three
times the work of the original iteration
for
this one's Android loop the instructions
would look like this we would have the
actual work of the one iteration these
are the same instructions is here we now
want to do this work once more this
would be this however if we just copy
the instructions again we would be doing
the same work twice we would just add
our three again to our same element a of
I so instead we will adjust the offset
here so that we are accessing the
element right below the one that our one
is pointing to this would be the a of I
minus one and now we need our loop
counter update and the actual loop back
branch but those we cannot simply copy
just like here we had to update the
counter to count by two iterations in
this code we were decrementing our one
to move to the element below now we are
processing two elements at the time so
we need to move eight bytes at a time so
the approach to unrolling ones is take
the original work copy it wise adjust
the second copy so that it does the
second iterations worth of work and then
adjust the loop count so that it's
moving by two iterations not by one this
is what it means to unroll once so keep
in mind that when we are doing two
iterations at the time we have unrolled
the loop once because we have added one
iteration of the original loop in
addition to what the iteration normally
would be doing unrolling twice would
mean that we are doing three iterations
at a time unrolling three times means
that we are doing four times the work
and so on it is a very common mistake
that when you are asked to unroll the
loop twice unroll it this way
this is unrolling only once again
unrolling twice is not do two iterations
at a time it's do one plus two
iterations at a time because you always
have to do one iteration so this loop is
not unrolled once it is not unrolled at
all this is unrolled once</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>