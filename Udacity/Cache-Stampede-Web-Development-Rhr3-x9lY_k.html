<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cache Stampede - Web Development | Coder Coacher - Coaching Coders</title><meta content="Cache Stampede - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cache Stampede - Web Development</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Rhr3-x9lY_k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so I'd like to talk about this new
concept called a cash stampede so we've
got our use case now you know a user
makes a request and the request probably
bounces off our cash and returns now if
the user makes the post request that
edits the database we clear the cache
and on the next request from that user
we go back to the database and update
our cache and return to the user the
user submits we clear the cache and on a
following quest we do the whole chain
again now a problem happens when we have
many users say that one of these guys
posts to the database which writes to
the database which clears our cache and
then the rest of these guys you know
they're just browsing the site they all
come to the site at the same time so
we've got all these requests coming in
to ASCII Chan and our cache is empty
they're all coming at the same time we
just cleared the cache and what's going
to happen is they're all going to say ok
the cache is empty therefore we must all
read from the database at the same time
because they're all like ok cache is
empty we need to update the cache and
then bam bam bam and bam they all hit
the database running the exact same
query just so they can store it in the
cache this is called the cache stampede
and what happens is the database gets
beat up and you know that query that
only takes a few milliseconds before
because it's a small database actually
can take a lot of time or may never
return at all because all of the the
queries are blocking on each other this
was something we saw happen at Reddit we
kind of went through this this whole
process kind of learning as we go
cache stampedes are really painful but
the solution is is fairly simple so a
cache Stampede is when multiple cache
misses from so much traffic create too
much load on a database or not
necessarily database whatever slow
computation you've got going on that you
don't want to do very many of you know
that you constrained for resources to
compute let's have a quick quiz and see
if we can figure out the solution to
this problem ok how can we avoid a cache
stampede we replicate the database to
handle more reads only allow one web
request at a time only allow one
database request at a time or database
query at a time or don't clear the cache
but instead overwrite it with new data</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>