<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hotel Door Locks - Applied Cryptography | Coder Coacher - Coaching Coders</title><meta content="Hotel Door Locks - Applied Cryptography - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hotel Door Locks - Applied Cryptography</b></h2><h5 class="post__date">2012-06-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dP0w9Ejuj-I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">there's an interesting story about using
hash chains for hotel doors and I'm not
positive if this story is true but I've
heard it from fairly reputable sources
and it seems too good not to be true
so if you think about a hotel you've got
rooms let's say this is room 387 and
you've got a check-in desk that may not
be connected by any wire to the room
what you'd like to happen is when a new
visitor checks in let's say it's Alice
the desk if the check-in can give her a
new key and that key will allow her to
open the door there's no connection
between the check-in desk and the door
and we want to know that Alice will be
able to enter the room whoever stayed in
the room previously let's say that was
Bob shouldn't be able to enter the room
any more at the point after Alice checks
in and enters the room Bob should no
longer be able to enter it and we like
to have all this happen without needing
any coordination between the desk and
the door one way to do that would be to
use a hash chain what the door will do
is when it reads a card and I'll write
this in sort of Python ish code the door
will have some some stored value X what
the door will do is check if the value
of hashing that key is equal to X the
stored value if it is the door will
unlock and everything's good we open the
door with the correct key there's
another situation that we need to test
for and that's if the hash of the hash
of the key is equal to X if the hash of
the hash of the key if we're thinking
about a hash chain well that would be
the next key in the hash chain if that's
the case we also want to unlock the door
but we want to update the value that's
stored as X well update that value to be
the hash of the current King hash of K
so that's our read protocol what this
means is that well if Bob's using the
room first his key is key k1 and his key
will have the value some number of
hashes on some secret and the value of x
would be M plus one of those hashes and
Bob keeps opening the door going through
this path through the code there
wouldn't really be a Python interpreter
in the door this could be done by
something much simpler than having a
full Python interpreter then when it
comes time for Alice to open
well Alice's key would have the value
when fewer hash of s that means that the
value of the hash of the hash of Alice's
key is equal to this value hashing and
plus one times starting from s and that
means Alice would open the door it would
change the value of x so now it no
longer works for Bob but the next person
who enters it will work and then it will
stop working for Alice so what the
check-in desk needs to do it needs to
keep track of some secret and it needs
to keep track of the number of the
guests the initial value stored as X
needs to be set but once those are done
there's no coordination needed every
time a new guest arrives they'll be
given a key which is the result of
hashing and time starting from s and the
value of n would be decreased by one so
this is our design for allowing secured
doors with a sequence of users so to see
that you understand it and understand
hash chains well we have a quiz what
would cause problems with this design if
a criminal could extract the stored
value from the lock if a guest checks
into the hotel but never actually enters
the room or if a guest enters the room
many times</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>