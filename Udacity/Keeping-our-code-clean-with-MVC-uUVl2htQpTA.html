<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Keeping our code clean with MVC | Coder Coacher - Coaching Coders</title><meta content="Keeping our code clean with MVC - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Keeping our code clean with MVC</b></h2><h5 class="post__date">2016-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uUVl2htQpTA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this project is already split in some
virtual folders that will get us
thinking about the model view and
controller the app delegate and the gcd
black box have been placed outside of
these folders and we can ignore them for
now in the model folder we have this
clients folder and then under clients we
have tmdb for the movie database this
folder structure represents the idea
that we could have multiple clients or
managers that handle all the code
related to an API but since we're only
working with the movie database we just
have this single tmdb folder but you
could imagine others like one for Flickr
or Facebook or so forth now in the tmdb
folder we have Swift files that pertain
to the main model of our project the
tmdb movie as well as the api's config
constants and a tmdb client that will
handle all the communications with the
API itself we'll talk about this more
later
you'll also notice there's this one
controller like file called tmdb off
view controller we've designated this
file as part of the model instead of the
controller because it's used
specifically for the movie databases off
flow and nowhere else but that was just
our design decision it doesn't have to
be this way if we look inside the tmdb
client file we see that the client is
only partially implemented these two
methods here are still common today here
at the top we've moved the
authentication state into this class
instead of it being in the app delegate
like it was in my favorite movies and if
we scroll to the bottom we have some
helper methods and at the very bottom we
have a method that allows us to use this
client like a single dense so in a very
similar way as to how we use the app
delegate in my favorite movies now these
two empty methods at the top called
tasks forget method and tasks for post
method the purpose of these methods is
to reduce the common code in our request
and you've probably noticed that there's
a lot of common code between each
Network requests that we've been making
we also have this tmdb convenience ducks
will fall which will be adding code too
as well now let's look at the view it
contains a single file called bordered
button dot Swift now some of you may be
thinking what gives
 in this folder contain our
storyboards and media files since they
are what the user sees they are the view
well you could do it that way and it's
really up to you but we've decided to
keep our MVC folder split and
organization where we're just focusing
on the Swift Falls and not the other
associated media files our reasoning for
this is because most of the actual view
classes have already been built by Apple
and are packaged together inside of
uikit and in that way we've decided that
this view folder over here should only
contain custom code of ours that is
purely view related so in this case the
only custom UI code that we have is this
border button finally let's talk about
the controllers this folder contains
classes that touch a little bit of the
view and a little bit of our model I'll
start with the login view controller
this class is a prime candidate for why
our previous app my favorite movies was
so poorly designed in this controller we
have four methods for the four different
steps that are required for the movie
databases authorization flow and you'll
note that the login with token uses the
new step 2a which we're going to cover
more detail later but we have the get
request token and then login with token
which is step 2 get session ID and then
the user ID isn't really part of the
authorization flow but we get the user
ID ahead of time so that we can use it
in requests like adding and removing
movies from favorites now each of these
methods let me blow one of them out
right here each of these methods has a
lot of duplicate code and they make this
controller are really big in heavy class
I think let's see we're at 340 lines
right now so it's starting to get pretty
large but what's worse is that if we
want to add more complexity this
controller is just going to keep growing
and growing and become really hard to
deal with and when you have big files
like this and lots of duplicate code
then you know you have problems what we
should be thinking about is how can we
make our code Lite clean and reusable
not overly complex and hard to manage
for our apps a great way to fix this
problem is to always keep our view
controller small by migrating the logic
like this this networking code away into
the model so for this application we're
going to take the code that's in this
login view control
and move it into the model or into the
movie database client this tmdb client</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>