<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>自定义 ArrayAdapter | Coder Coacher - Coaching Coders</title><meta content="自定义 ArrayAdapter - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>自定义 ArrayAdapter</b></h2><h5 class="post__date">2016-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/C4zSpiZPyXU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so now you understand how a
sample app with the ListView and custom
array adapter work so that's a great
starting point for understanding how we
can make the corresponding changes in
our app now the Android flavor app had
two text views and one image view per
list item in the case of our Miwok app
we'll want to have two text views and
this is why we'll need to create a
custom array adapter because the default
one only works with a single textview so
let's start with step one of the quiz
first we asked you to create a list of
word objects and here's the code for the
ArrayList of word objects notice that
each word object created has an English
and Miwok translation pair so make sure
that order the inputs is English word
first and then Miwok word and remember
that's because that's how we set it up
in the word constructor here now back in
the numbers activity we asked you to
modify the way that the adapter was
created and set it on the ListView so we
provided some code for you that you
could add to the numbers activity to
make sure that the word adapter was
built correctly so we had to remove the
old array adapter code and then the
oncreate method would look like this so
here we're creating a new word adapter
object and storing it in a variable
called adapter we're calling it a
constructor and passing in a context so
that's what this refers to refers to the
numbers activity and then passing in the
ArrayList of word objects then we're
finding the ListView in the layout with
ID called lists and then setting the
adapter on it now for the third step we
asked you to create a new word adapter
class and we showed you the instructions
for how to do this in the earlier video
for the fourth step we modified the
class declaration so that the word
adapter extends or inherits from the
array adapter class so by specifying the
word class as a generic parameter here
we expect that the array adapters
datasource be the list of word objects
now in the fifth step we asked you to
override the getview method to provide
your own implementation of the method so
this code here was generated by Android
studio you could have either use the
keyboard shortcut ctrl o or gone up here
to code override method and selected
getview method so for step stick six we
asked you to complete this method with
your own implementation and pointed you
to the Android flavor app as an example
so let me open up the Android flavor app
here's the code for the Android flavor
adapter in the custom array adapter
example so down here is it's get view
method since this logic is very similar
to the get view method we need aremy
walk out let's just copy and paste this
section over into our code so I just
pasted that code into the word adapter
class first we're making sure that we
have a list item view even if it doesn't
have the right data so we could try to
use the recycled view that came as an
input parameter however it is possible
that it could be null meaning that
there's no view to reuse in this case we
would need to inflate one from that list
item layout from scratch we can use the
layout inflated from Android and called
inflate method passing in the layout
resource ID the parent view which is the
ListView and false here because we don't
want to attach the list item view to the
parent ListView just yet
but the next step is that we'll need to
find the word object at the requested
position so we can start to set the
appropriate data onto the views in that
layout so we'll call the get item method
which comes from the superclass array
adapter and it takes in as its input the
desired position now instead of
returning an Android flavor object we'd
like this get item to return a word
object and this is because our class
declaration says that we inherit from
array adapter where word is the return
type of the get item method let's take a
look at the documentation for the get
item method so here's the documentation
for the get item method from the array
doctor class so in this case we can
substitute the word datatype anywhere
that we see the generic parameter team
well let's head back to the codon now
for these next three sections we don't
have an image view in our layout just
yet so we can delete these lines of code
related to setting an image on the image
view let's navigate over to the list
item XML layout remember that we have
two text views within here one with the
view ID called Miwok textview and one
with the view ID called default textview
and no it might be slightly different in
your code if you chose to name them
differently this means that back in the
word adapter class the list item view
variable is currently referencing the
route linear layout for the list item
layout so if we call the fine view by ID
method on the list item view then we can
find the Miwok
whew and once we find that we can cast
the view to a text view because it is a
text view and then go ahead and store it
and a me walk text view variable after
that we can call the set text method on
the text view and then pass in the new
text that needs to be displayed so this
would be the Miwok translation string
from the current word object so reading
this line of code can be a little bit
complex but let's just start by reading
the expression within the parentheses
first so on the current word object we
call the method get me walk translation
so this returns a string that's a me
walk word and that becomes the input to
the set text method call on the me walk
text view object so now the me walk text
view should display the me walk word we
will repeat the same steps for the
default text view so the list item view
points to the linear layout in the list
item layout so we'll call find view by
ID to search all its children we find
the view with the ID default text view
and cast it to a textview and then we'll
store it in a variable called default
textview after that on the current Ward
object
we'll call the get default translation
method and this helps us get the English
translation string now this becomes the
input to the set text method call on the
default text view object so now the
default textview should display the
English word now with all that done we
just need to return the list item view
as a return value so the ListView will
take its return value and add it as a
child to itself whoo that was really
challenging but thanks for hanging in
there
so to recap in our getview method we
first get a list item view that we can
use so either by reusing one that was
given to us or inflating a new one
completely from scratch then we get the
word object at the given position and
after that we can start finding the
views in the list item layout and
setting data to them from the word
object and lastly we can return the
updated list item view so let's try to
run the code now hmm it looks like
there's an error in the numbers activity
it says that there's an error with
creating the word adapter ah so that's
because we forgot to create the
constructor in the word adapter remember
that takes two inputs the contacts and
list of words so let's go ahead and do
that
now let's take a look at the example in
the flavor adapter app we describe the
constructor earlier in the last video so
you can refer back to it if we needed so
here I am back again looking at the
example flavor app so we described the
constructor early in the last video so
you can refer back to that if needed now
we're gonna need something similar to
this for our word adapter so I'm gonna
copy and paste this constructor over and
then tweak it so at the top of the word
adapter class I'm gonna paste that
constructor we copied over now instead
of Android flavor adapter we need it to
be word adapter because remember the
constructor name needs to match the
class name also inside this list here
instead of a list of Android flavors we
want a list of words and lastly inside
this constructor we can call the
superclass Android adapters constructor
by passing in the context the layout
resource ID and then the list of objects
so we'll need to update this towards as
well remember that we can pass in 0 for
the layout resource ID here because
we're inflating the later ourselves in
the get view method
here's what the app looks like on our
device so navigating into the numbers
activity nice so the list is showing the
Miwok and English words so
congratulations
really great work</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>