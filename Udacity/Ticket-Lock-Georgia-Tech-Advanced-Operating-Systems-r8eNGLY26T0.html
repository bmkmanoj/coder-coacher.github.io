<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Ticket Lock - Georgia Tech - Advanced Operating Systems | Coder Coacher - Coaching Coders</title><meta content="Ticket Lock - Georgia Tech - Advanced Operating Systems - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Ticket Lock - Georgia Tech - Advanced Operating Systems</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/r8eNGLY26T0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">up to now what we've talked about is how
to reduce the latency for acquiring the
lock and the contention when the lock is
released so far we've not talked about
fairness what do we mean by fairness
well
if multiple people are waiting for the
lock should we not be giving the lock to
the guy that made the lock request or
tried to acquire the lock first
unfortunately in spin lock there's no
way to distinguish who came first
because as soon as the lock is released
they're gonna try and grab the lock and
it's entirely up for grabs as to who may
be the winner so next what we're going
to do is we're going to look at a way by
which we can we can ensure fairness in
the lock acquisition now daily shops and
the restaurants busy once that is often
use a ticketing system to ensure
fairness for those who are waiting to
get served so for instance in this
example here let's say I walk into a
deli shop and my ticket is 25 and I have
noticed that currently they are serving
16 so I know that I have to wait for a
little bit of time and you know once my
number comes up I can get served so this
is actually and if I know that there are
at least nine people ahead of me who
needs to be served before my turn comes
up and by similar argument if people
come after me I know that they're not
going to get served before me
that's the basic idea that we're going
to use in this ticket lock algorithm the
ticket lock algorithm is basically
implementing what I describe to you as
to what happens in a deli shop the log
data structure has two fields to it a
next ticket field and a now serving
field and the lock algorithm in order to
acquire a lock what I'm going to do is
I'm going to mark my position and the
way I do that is I'm gonna get a ticket
just like when I walk in a deli shop I
get a unique ticket I get a unique
ticket by doing a fection increment on
the next ticket field of the log data
structure and when I lose this fetching
I get a unique number and this number is
also advanced exactly like how it would
happen in a deli shop and once I have my
position marked as to when I can get my
lock
I can then wait by procrastination and
what i'm doing here is pausing to see if
I've won my lock by an amount that is
proportional to the difference between
my ticket value and who is being served
currently and after this amount of delay
I'm gonna go and check if the now
serving value equals my ticket value and
if it if it is then I'm done I can
return otherwise I go back to looping so
basically I'm looping waiting for
waiting for my number to be up so that I
can assume that I've got the lock and
how am I going to get get this
information that that my ticket is up
for serving that is going to be done by
the current holder of the lock he's
going to come and and release the lock
and when he releases the lock he's gonna
increment there's now serving value in
the lock data structure and that's all
eventually the now serving will advance
to be equal to my ticket and I'll get
the ticket and then I can I can return
from the acquire lock now this algorithm
is good that it preserves fairness but
you notice that every time the lock is
released there's now serving value that
is in my local cache is going to be
updated by the cache coherence mechanism
and that's going to cause contention on
the network so on the one hand fairness
is achieved but on the other hand we've
not really completely gotten rid of the
contention that can happen on a network
when the lock is released</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>