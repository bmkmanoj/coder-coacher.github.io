<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Heun 方法 | Coder Coacher - Coaching Coders</title><meta content="Heun 方法 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Heun 方法</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/s6gaDthJ5no" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">So now we want to actually look at the solver of order 2,
the method invented by Karl Heun, Heun's method.
It also goes under the name of improved Euler's method.
And it is also is one example for a simple Runge-Kutta method in case we haven't got that term.
I'll start with the forward Euler method.
The position for the first time step is the initial position plus time step times the initial velocity
and similarly for the velocity, the velocity is changed by time step times force divided by mass
Force divided by mass is acceleration.
I have explicitly indicated the dependence of the force on time and position.
And what we do now, we do not actually use these results for the next step,
we use them as stepping stones if you will.
Let's start this result as Xe for Euler and this result is Ve for Euler
and the trick now is to use these into immediate result
to get a better estimate for the next x and the next v.
So how can I improve the estimate for the next position based on Euler's result?
And the next position is the initial position plus time step
times the average of the initial velocity and the next velocity as predicted by Euler.
This takes care of the fact that the velocity is not going to stay constant
over the cause of the first time step.
Euler's method is based on the assumption that this velocity is almost constant.
How can I use this to improve Euler's result?
The bad thing about Euler's method is that the velocity actually is not constant.
It's not going to stay at the value it has at time equals zero.
A better estimate is use the initial velocity and the velocity predicted by Euler
and form the average of both.
This is what Heun's method does and similarly for the acceleration used to compute the next velocity,
I found the average of the initial acceleration F at times zero divided by m
and the force after the first time step at the position predicted by the Euler method.
For the velocities, I'm using a similar approach.
I formed the average of two forces and divided by m to get acceleration.
The first force is the initial force times zero, initial position.
The second force is the force that I get at the end of the first time step
using the position predicted by Euler's method.</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>