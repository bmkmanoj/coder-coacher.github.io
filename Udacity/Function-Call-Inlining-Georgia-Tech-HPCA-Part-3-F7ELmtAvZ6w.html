<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Function Call Inlining - Georgia Tech - HPCA: Part 3 | Coder Coacher - Coaching Coders</title><meta content="Function Call Inlining - Georgia Tech - HPCA: Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Function Call Inlining - Georgia Tech - HPCA: Part 3</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F7ELmtAvZ6w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">an optimization similar to inlining as
far as benefits are concerned is called
function called inlining and it takes
code that calls a function so we do some
work then we prepare the function
parameters for example put them in the
right registers according to the calling
convention then we call a function and
then we do more work after that and when
we call a function let's say that the
function itself was just adding the
first two parameters and putting that in
the return value and then returning so
this sends us back here and then we
continue with the more work so this is
what a normal function call looks like
so now we can try to avoid the overheads
of calling the function and returning
from it by doing our work then we don't
have to prepare the function parameters
anymore now what we do is we simply take
the work of the function and just plug
it in here so in this case we add up
adding the registers for example that
did contain the values that we
eventually ended up passing here so we
didn't need to copy these registers to
a0 and a1 and we put the result exactly
where we need it for example r7 instead
of having to maybe copy from our V to
our 7 and then we can continue with our
work so the first benefit of function
call inlining is that it eliminates the
calling in returning overheads which
include not only the function call
instruction and the return instructions
themselves but also the code that
prepares the function parameters
according to the calling convention and
the code that possibly in the function
itself needs to for example pop
parameters from the stack and so on and
then possibly also the work here after
we return to get the return value into
the register where we need it all of
that can be done by simply in lining the
function and then just using the
registers we want and just like loop
unrolling which helped scheduling do
better so does function call inlining
because really what we have is this is
where we can do scheduling and then we
need to call the function
so these instructions cannot be moving
around beyond this point we can do
scheduling here but again we cannot do
much of this work before the call
and then the function itself can be
scheduled but we have to do it within
this we have three separate pieces of
code each of which can be scheduled but
we cannot for example take something
from here and use it to fill an empty
slot here on the other hand after in
lining this is just code with no
function calls or anything so now all of
this work is scheduled able for example
the work from the function can easily be
moved around assuming that the
dependence is allowed so inlining also
lets us do better scheduling just like
loop unrolling did and for the same
reason now we have more work that we can
play with just like loop unrolling the
elimination of the overheads for calling
returning and so on will reduce the
number of instructions the better
scheduling will let us reduce the CPI
and that means that we can usually
improve the execution time by quite a
bit
the smaller the function the more
benefit from both of these because if
the function is very small the overheads
of calling and returning are high
relative to the work we are actually
doing and also if the function is small
scheduling with then the function is not
gonna do much but if we put it into the
existing code suddenly this instruction
here can probably be squeezed into an
existing cycle without really adding
another cycle and finally there is a
downside to inlining and it's very
similar to what we had for loop
unrolling</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>