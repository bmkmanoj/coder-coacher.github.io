<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Minimizer finds coefficients in python | Coder Coacher - Coaching Coders</title><meta content="Minimizer finds coefficients in python - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Minimizer finds coefficients in python</b></h2><h5 class="post__date">2016-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dCBX0nAvsJg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now we'll look at some example code that
can fit a line to data that's given
remember we're using a optimizer to do
this and first thing we have to do is
describe for the optimizer what is the
function it's trying to minimize so
we'll call this function error and it
takes two parameters line and data line
is just two coefficients C 0 and C 1 and
data is just a list of data of course
we've got some nice comments here that
explain it but really our error is
expressed simply in this single equation
we have the value of the actual data at
each point here minus the estimate that
the line we're currently looking at
would give at that same point so we use
the 0 coefficient and the 1 coefficient
times the x value of the data at that
point so we take those differences and
square it and that's our error function
and that's what we're trying to minimize
we've added some code now to illustrate
how to use the minimizer to find the
equation of the line we start with our
original line that the minimizer doesn't
know so it's our secret
but we're testing it to see if the
minimizer can discover the equation of
this line here's the equation for our
line it's just a two element array it'll
have a slope of 4 so coefficient 0 is 4
and a y-intercept of 2 so coefficient 1
of 2 here we generate X and y values
again keep in mind our minimizer doesn't
know these but we're just generating
them so we can look at them and we're
plotting it for looking at it later we
take that original line and we use from
numpy the random function to add some
noise to it so at each point
along the x-axis where we have data we
add some noise so now we've got our
original line plus some noise and we're
going to challenge our minimizer to find
the equation for that original line even
though there's noise we wrote a separate
function fit line that takes the data
and the error function we defined and
finds the equation for that line
here's fit line that does that for us
two parameters the data so remember this
is noisy data that is approximately a
line in other words we took our original
line and added noise to it and the error
function or the function we're trying to
minimize we have some nice comments here
that tell us what those are but now we
just follow the steps like we've talked
about before we start with an initial
guess here our initial guess is a slope
of 0 and a mean of the rest of the data
as our y-intercept it could be anything
really but that is a reasonable guess we
plot the initial guess so we have
something to look at and I'll show you
that later but here really is the meat
of the function you've seen it before so
we call our minimize function with the
error function in other words this is
the function we're trying to minimize
our initial guess and this is a
parameter you haven't seen before but
this is a way by which we can pass the
data to our error function this is the
method that we're going to use and
finally although it goes off the end
here we'll set display to true which
will mean we'll get to see any
information as it goes along so that's
it I mean really the key here for this
is this minimized call right here and
then it returns the result so let's run
it and see what we get there was some
additional code that I skipped over that
generated this plot you can look at that
on your own of
okay let's take a look our original line
is this blue line of course the
minimizer doesn't know anything about
that these green dots are our noisy data
where we just added noise values to the
blue line now we're asking our optimizer
okay find the equation of the line that
best fits this data and the metric
you're trying to minimize is error so we
passed it an initial guess here of this
purple line and this data so that's all
it knows right now is this initial guess
of a purple line and this data and then
it iterates and tries different slopes
and different y-intercepts until finally
it converges to this red line and that's
the solution and I think it looks pretty
decent
we can check it here so if you look in
the code you'll see that our real line
had a slope of 4 and a y-intercept of
0.5 so it got four point one seven and
point six four not exactly
but if you look at the data you can see
that it's pretty hard to know exactly
what the underlying line would look like
so I think our equation solver did a
pretty good job</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>