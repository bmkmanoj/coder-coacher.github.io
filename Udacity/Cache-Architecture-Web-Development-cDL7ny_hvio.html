<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cache Architecture - Web Development | Coder Coacher - Coaching Coders</title><meta content="Cache Architecture - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cache Architecture - Web Development</b></h2><h5 class="post__date">2012-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cDL7ny_hvio" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">the way we got around replication lag
was by having memcached I think at the
time did we run memcached on the app
service or did the rift separate
memcache boxes I don't know about back
then until very recently there was no
memcache on those servers okay there is
mechanism service now yes okay there's a
render cache on the server side oh okay
and now there's a stable cash okay so we
transitioned I think over time I think
when we started off memcache was on each
app server and then we started adding
more and more app servers and the
configuration got a little weird because
like we'd bring up a new app server and
t1 overcome a new memcache server also
and redistribute the Tees so I think
when I left we had a bunch of mem caches
that were a separate cluster and these
are the memcache is these memcache is
was used we use memcache net right for
everything it's like the Swiss Army
knife of systems I think we used it
forward definitely to avoid replication
lag
you know we'd write to the database and
memcache at the same time so that when
you do an immediate redirect to a
permanent page or something like that
the data is good to go if you're prone
if you read would have otherwise hit the
slate the other big system we had and I
think this is kind of the final big
system is we had what was called this um
the the pre compute system doing
real-time queries against the database
was too slow to generate our listing
pages so we had a whole separate
database cluster called the pre compute
cluster which if I recall was just
mirrored versions of all of these
machines and whenever you would submit a
link to Reddit or vote we would submit a
job to this queue the job would be
something like update the front page or
update this person's like page or you
know all these different things like a
vote affects a front page affects the
new page it affects your lights listing
all that sort of stuff we put this job
in a queue and then what the queue would
do is it would say recompute that
listings front page or recompute that
listings rising page or recompute that
users like page some of it can be done
in place without actually hitting the
database you know if you submit a link
we just put it at the top of your
submitted page you don't
fancy but it also affects the hotness
you know of that Lincoln etc and we had
a separate set of memcache --is that
were actually running a technology
called memcachedb and memcachedb is just
like memcache but instead of being
totally a memory it had a little disk
data store so it was like kind of fast
like memcache because it's mostly memory
but also would persist the data that got
precomputed would be put in memcache DB
as kind of this this middle layer cache
for so we can avoid running queries on
these databases that was basically the
state of the system when I left
lots of replicated databases this really
complicated pre compute cluster we had
this whole separate set of databases
that we could just run queries on as
hard as we could just one after another
these machines were really sad all the
time actually there's actually more
specifically they were literally on fire
all the time like these machines were
hot I think the high low because no no
no query that the user would see would
actually hit these machines so we could
just beat the hell out of them and you
know when the result is done it hit the
cement cache DB that's what we'd store
the data and the users would only hit
this so we would lose nodes here all the
time because we were abusing them we
could add more they could be slow it
didn't matter goes out of the actual
request loop and that took a lot of load
off the whole system</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>