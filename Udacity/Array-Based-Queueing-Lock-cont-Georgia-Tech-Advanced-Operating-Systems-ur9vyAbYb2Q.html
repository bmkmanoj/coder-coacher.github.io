<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Array Based Queueing Lock (cont) - Georgia Tech - Advanced Operating Systems | Coder Coacher - Coaching Coders</title><meta content="Array Based Queueing Lock (cont) - Georgia Tech - Advanced Operating Systems - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Array Based Queueing Lock (cont) - Georgia Tech - Advanced Operating Systems</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ur9vyAbYb2Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so let's see what happens when the
current lock holder comes around to
unlocking the lock what he's gonna do is
he's gonna execute the unlock algorithm
and the unlock algorithm the first thing
that it does is it sets this position
that the lock hold ahead from HL to MW
and the reason for that is is that this
is a circular Q and this is a circular
queue even though Q last is here future
requesters can can't come around and
then eventually as somebody may come
here and may want to occupy this
particular slot and they have to know
that they have to wait and that's the
reason the first thing that the current
lock holder does is to mark this spot
that he used to be at as HL the next
thing that the current lock holder is
going to do is signal the next guy in
the circular Q so the current lock
holder was here so his marketer's MW for
future requesters that may come and wait
on his part and the next request in the
circular Q is the guy next to him and
therefore what she is doing is he is
saying you know current plus 1 mod n is
going to be set to HL and so that guy
would have been waiting in this position
and so he'll get the signal and
therefore he'll be ready to go and he
can get into the critical section and do
whatever he wants to do with the data
structure that is protected by this
particular lock now this will go on and
eventually my predecessor will become
the current lock holder and when my
predecessor is done using the lock he'll
come around to do an unlock and when the
current lock holder who was my
predecessor does the unlock operation
that's going to be resulting in a signal
for me because basically he's going to
set the Flags array the next part in the
flags array as HL and that's the spot
I'm waiting on it's a good news for me
I've got my position marked as HL and
what that means is that now I've got the
lock and now I can go off into the
critical section do what I need to do in
order to do the code that is associated
with the critical section protected by
this particular lock L now that we
understand how the lock and the unlock
algorithm works with this array based
queuing
let's talk about some of the virtues of
this algorithm the first thing that you
notice is that there's exactly one
atomic operation that you have to carry
out a critical section so every time you
want acquire a lock you come in and do a
fetch and increment and that is all that
you do in order to get the lock and so
there's one atomic operation that you do
per critical section that's good news
and the other thing that you also notice
is that the processors are all sequenced
on other words in his fairness so
whoever comes first and gets into the
queue ahead of me and when I come in if
people are going to come after me
they're gonna get queued up after me so
that's good news also and the spin
variable because I marked my position in
this array my spin variable is distinct
from the spin variables of all the other
guys that may be waiting for the same
lock that's another good thing in other
words I'm completely unaffected but all
the signalling that would have happened
when the guys that are ahead of me we're
getting the lock and and signalling the
next guys and so on I'm completely
impervious to that because I'm spinning
on my own private variable waiting for
the lock and of course corollary to what
I just said is that whenever a lock is
released exactly one guy is signaled to
indicate that they've got the lock and
and that's another important virtue of
this particular algorithm so it is fair
and it is also not noisy so these are
two things that very good things about
this algorithm and this we saw were you
know the deficiency of the ticket log
algorithm was exactly that that it is
fair but it is noisy when the lock is
released so that problem has gotten away
with this queueing luck now you might be
wondering are there any downside to this
arabia's queuing lock sure there is the
first thing I'm sure that you've noticed
already is the size of the zero
structure is as big as a number of
processors in the multiprocessor so the
space complexity in for this algorithm
is order of n for every lock that you
have in the multi program so if you have
a large-scale multiprocessor with
thousands of processors that can start
eating into the memory space so that's
something that you have to watch out for
so the space can be a big overhead and
the reason why I'm emphasizing that is
because in any well-structured
multi-threaded program even though we
may have lots of threads executing in in
all the processors at any point of time
for a particular lock they may not be
contingent by all the processes only a
subset of them may be requesting the
lock but still this particular algorithm
has to worry about the worst case
contention for a lock and therefore it
creates a data structure that is as big
as a number of processors that you have
in the multiprocessor so that's the only
downside to this but all the other
things are good stuff about this
algorithm and of course the reason why
you have that the on side with D with
this particular Anderson skewing lock is
the fact that the queue is being
simulated by a static data structure an
array and since it is a static data
structure and you have to worry about
the worst case contention among
requesters for a lock we have to make
the static array as big as the number of
processors so that's really the the
catch in this particular algorithm next
we will look at another algorithm a lock
algorithm that's also based on queueing
but it doesn't have the space complexity
of Anderson's
queuing lock</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>