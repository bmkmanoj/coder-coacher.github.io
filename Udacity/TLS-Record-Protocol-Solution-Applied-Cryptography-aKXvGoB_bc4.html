<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>TLS Record Protocol Solution - Applied Cryptography | Coder Coacher - Coaching Coders</title><meta content="TLS Record Protocol Solution - Applied Cryptography - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>TLS Record Protocol Solution - Applied Cryptography</b></h2><h5 class="post__date">2012-06-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aKXvGoB_bc4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so the answer is 0 1 0 1 1 0 1 0 let me
explain why so remember that we're using
CBC mode encryption the value of
ciphertext block I is the result of
encrypting using the key the value of
ciphertext block i minus 1 X sword with
message block I for the first block of
the second message well that's going to
be c0 prime is the result of encrypting
the value of the previous block and this
was the initialisation vector for the
first block for this one it's the last
block in the previous message so that
was the block we called CN minus one and
that's X sword with message block zero
so here's the danger the adversary
actually knows this value so that means
the adversary can pick a message value
so the value of c0 prime reveals
something that means it has to be an
input to the encryption we're assuming
the adversary can't break the encryption
but it has to be an inputted encryption
that adversary already knows what's
expected result is so the adversary
knows the encryptions of all the blocks
for in the previous message and we know
from the way CBC worked if we want to
learn the value of M for well m4 was
encrypted in the original message using
the value here this was ciphertext 3 the
previous ciphertext block and that was
encrypted and it produces output
ciphertext block 4 so that means if we
can feed in to this result that means if
we can make the value of this equal to
the result of c3x sword with m4 well we
don't know em for but we can make it our
guest for m4 so we're going to explore
it with our guests for m star and for if
that's the input to the encryption
function well then we'll be able to look
at the output and see if it matches c4
so to make that the input well we have
this IV which is really the last block
in the previous message well we can just
explore that out so where we're going to
pass in is the guests XOR with a known
value of C 3 X sword with this value
with the values I've chosen well c 3 is
this mstars all 0 so we don't need to
worry about that in the next door
n minus C and minus 1 the last
ciphertext block is all the ones so
that's going to flip the first four bits
that's why we get this value and let's
see what happens when that value is used
for m0 what we're going to get for
ciphertext blocks 0 is the result of
encrypting the known value of ciphertext
block and minus 1 with this result which
is c3 well now this is X or so that same
values cancel out and so that means the
result is the result of encrypting c3x
or with M star well that's the same as
we were doing here right that's
encrypting m4x sword with c3 we know
what c3 is so we could construct this
message to pass in we don't know what m4
is but we know if this result is the
same well then this should be the same
as ciphertext block 4 and that would
give us the answer the question was m4
equal to M star and of course we can
generalize this if we can pick the value
of M 0 prime to be the XOR of the last
ciphertext block and the one before the
one we want to guess and our guests that
means what we learn if the ciphertext
block that results from the new message
is equal to ciphertext block I then we
know that block mi is equal to M star</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>