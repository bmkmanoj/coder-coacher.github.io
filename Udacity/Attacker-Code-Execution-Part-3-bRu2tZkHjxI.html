<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Attacker Code Execution Part 3 | Coder Coacher - Coaching Coders</title><meta content="Attacker Code Execution Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Attacker Code Execution Part 3</b></h2><h5 class="post__date">2016-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/bRu2tZkHjxI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">depending on what sort of input data we
provide when this string is red we know
that if we provide more than 12 bytes
we're going to overflow in this
direction into these variables as you're
talking about so what can you do if you
sort of are careful about it first thing
that we want to do is we want program
control to go someplace where our code
the attacker can actually craft some
code there are two things that hacker
has to do it has to have its code that
it wants to run and then it has to find
a way to get the program control
transfer to happen such that the program
goes and starts executing the code that
the attacker has crafted here we should
sort of look at this and say there is an
opportunity here for that hacker the
attacker has found a way to go up and
right into these locations we know that
it has done that because if it passes
more than 12 bytes these four bytes are
going to be overwritten that's allow log
in if it writes more than 16 bytes then
the return address is going to be
written so if you carefully sort of
overflow and you can find out the return
address where our code is and the
overflow actually ends up right thing
the address of that code into this
return address what would happen in that
case the function when it's done will
not return to where it came from
remember it had stored the address where
it needs to go back in return address
but by carefully sort of overflowing and
modifying this return address that all
return addresses history it's gone it's
going to actually return to the address
that we have inserted or we have put in
these four bytes the four bytes where we
have the new address that we have put
into this area of memory where we had
the return address before that's where
this program is going to return so this
is kind of an aha moment by providing
bad input the vulnerability is we're
going to know that we are not checking
input that's the vulnerability that is
what is getting exploited by that hacker
the attacker is providing a carefully
crafted input and when we take that
input an overflow occurs and the way the
whole flow reaches that
address area the part of memory whether
to turn a dress is stored we are
actually going to put a new return
address where code that we have created
by V I mean that hacker the program will
start executing that code so some code
that hacker wants executed if you know
where that code is and we know it's a
dress and this is what we overwrite
these four locations with the return
address by passing bad input exploiting
the vulnerability when the program
doesn't check its input by passing
carefully crafted input we are now able
to take the program from it it was to a
place where our instructions are located</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>