<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Memory Virtualization  Full | Coder Coacher - Coaching Coders</title><meta content="Memory Virtualization  Full - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Memory Virtualization  Full</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/UgVnzAGBeWI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so far we've focused on explaining the
basics of how to virtualized efficiently
the CPU but let's now look at the other
types of resources looking at memory
first we will explain how memory
virtualization can be achieved for the
two basic virtualization approaches
whether it's based on full
virtualization or requires guest
modification and we will talk about full
virtualization first for full
virtualization a key requirement is that
the guest operating system continues to
observe a contiguous linear physical
address space that starts from physical
address theorem this is what an
operating system would see if it
actually owned the physical memory and
ran natively on physical Hardware to
achieve this who distinguished among
three types of addresses virtual
addresses so these are the ones that are
used by the applications in the guest
the physical addresses these are the
ones that the guest thinks are the
addresses of the physical resource and
the Machine addresses these are the
actual machine addresses of the actual
physical addresses on the underlying
platform the similar distinction of
virtual versus physical versus machine
will also apply to the page numbers and
the page frame numbers so given this the
guest operating system can continue to
make mappings of virtual addresses to
the physical addresses that it thinks it
owns and then underneath that the
hypervisor will then pick these physical
addresses that the guest believes are
the real ones and map them to the real
machine addresses Sina says there are
two page tables one that's maintained by
the guest operating system and another
one that's maintained by the hypervisor
now remember that at the hardware level
we have a number of mechanism the memory
management unit a TLB mark a shank of
the address translations that these
mechanisms help with the address
translation process make it much more
efficient and don't require us in
software to repeatedly perform address
translations and validations now this
option that we discussed so far will
require that every single
access goes through two separate
translation the first one which will be
done in software and then the second one
potentially can take advantage of
hardware resources like TLB because the
hardware will understand only this page
table clearly this will be too expensive
since this will add overheads on every
single memory reference it will slow
down the ability to run at near native
hardware speeds the second option is for
the hypervisor to maintain a shadow page
table in which it actually looks at what
are the virtual addresses that the guest
has mapped to these physical addresses
and then in the shadow page table it
directly establishes a mapping between
the virtual addresses that are used by
the guest and the Machine addresses that
are used by the hypervisor by the
physical hardware
then if the hardware MMU uses this page
table the guest operating system is
allowed to execute natively using the
applications will use virtual addresses
and these will directly be translated to
the machine addresses that are used by
the physical Hardware the hypervisor
will clearly have to be responsible to
maintain consistent between these two
page tables and it will have to employ
mechanisms that for instance invalidate
what is the currently valid page table
shadow page table whenever there is a
context switch or to write protect the
guest page table in order to keep track
of new mappings that the guest operating
system installs and similar mechanisms
this write protection is necessary so
that whenever the guest OS tries to
install new virtual to physical address
mapping in the page tables that are used
by the guest
this will cause a trap to the hypervisor
and then the hypervisor will be able to
pick up that virtual address and then
associate the corresponding machine
address and insert this mapping into the
page table that is used by the hardware
MMU this can be done completely
transparently to the guest operating
system</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>