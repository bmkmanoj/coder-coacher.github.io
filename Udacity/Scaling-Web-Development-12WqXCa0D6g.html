<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scaling - Web Development | Coder Coacher - Coaching Coders</title><meta content="Scaling - Web Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scaling - Web Development</b></h2><h5 class="post__date">2012-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/12WqXCa0D6g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we had these app servers that we're
all running their own caches and then we
had a couple databases that were all
replicas of each other this point we
added a load balancer and this load
balancer probably actually ran it was
probably a program running on one of
these app machines and these guys are
still keeping their caches in sync using
interacting with the databases directly
and we had a limit to how many app
service we can had because we had this
complicated caching spread thing the
next thing we added was the memcache
layer and so instead of these app
servers containing their in-memory cache
they would communicate via memcache so
instead of having to keep their cache in
sync we just had one cache that was just
shared among all of our app servers I'm
sad it took us so long to figure this
out because we memcached existed when we
started reddit we should have been using
it from the beginning this is what
allowed us to get all of that state all
of that cash out of the apps in the
memcache and then allowed us to add apps
arbitrarily once we had that going that
allows us to scale our apps and they
stayed in sync and so we can add an app
lose an app we didn't have to worry
about it next thing we had to start
dealing with was the database load so
we're already replicating four kind of
durability and for performance reasons
so we can spread our reads across
multiple machines as we started
segmenting on type so we'd have a
database for just links then we could
separate comments out into its own
database and so these would still
replicate to each other but if you're
only submitting a link you only have to
touch this database and you're only like
reading a comment for example you only
have to touch this database this is
actually still basically the general set
up reddit has today in terms of how the
database is scaled and we never wrote
sharding in in the beginning and I
really regret that when I rewrote the
thing to be the second version of it I
had in the back of my head you know I
should add a charting because we're
going to need that someday and then I
just wanted to get the damn thing in
production so I stopped a big lesson
I've learned is when you're writing a
big system like that if you don't do the
hard parts upfront you may never get
another opportunity to do them because
now the database is so big that if we
wanted to bolt on charting that's a huge
project it's easier right now to just
add bigger machines and more caching
it's not going to work forever and
somebody's gonna have to bite the bullet
and do that and it would have been a lot
easier to do it at the time since all of
our queries we stopped using joins when
we switch the thing DB charting is
actually fairly straightforward if you
kind of do it right from the beginning
over the time some of the software needs
app service changed so we've always been
using Python I don't remember what app
server we used originally we switched
from whatever we used initially to web
PI which is a framework that we wrote at
reddit Aaron was basically the main
author of that and it's still out there
on the internet somewhere and this is
where the first time I recall seeing a
framework that had kind of the notion of
a handler class and then functions
forgetten post and I've become kind of
addicted to thinking of web applications
that way actually the Google App Engine
the web app
to framework inherited a lot of that
design from web that PI which is nice
nice for me Elise is that a sign
decision is kind of stuck around for a
little while so I think that means it
was a good one now
Python uses a web framework called
pylons but it uses a very old version of
pylons and basically when we switch the
pylons Erin had stopped maintaining web
that PI I didn't want to maintain it we
switch to something that was maintained
by somebody else and then we basically
shredded most of it and made it function
just like web PI hindsight we probably
should have just written our own because
that's effectively what we did but we
did it on top of pylons so if you want
to use the reddit version of pylons it's
open-source that's online but it doesn't
resemble anything like the actual pylons
web framework at this point and to my
knowledge that's still what they use
today is this hacked up version of
pylons</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>