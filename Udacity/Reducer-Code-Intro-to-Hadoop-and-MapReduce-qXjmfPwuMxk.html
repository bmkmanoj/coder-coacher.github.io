<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Reducer Code - Intro to Hadoop and MapReduce | Coder Coacher - Coaching Coders</title><meta content="Reducer Code - Intro to Hadoop and MapReduce - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udacity/">Udacity</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Reducer Code - Intro to Hadoop and MapReduce</b></h2><h5 class="post__date">2015-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qXjmfPwuMxk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so here's the reducer code let's step
through it we'll start by setting up a
couple of variables sales total which
will keep the running total is
initialized to zero because we haven't
read any keys yet old key starts at none
then we start reading from standard
input as with the mappers we receive a
line at a time
that's tab-delimited in this case we
expect a store name a tab and one of the
sales so we'll strip off the new line
separate the value in the key by tab
that should give us two items which will
store in an array called data if we
don't have two items something strange
has happened so we'll skip that line but
that should never be the case because we
know that mappers send us the data in
this format for the sake of clarity will
store the two items in the array in two
variables this key will get the store
name this sale the value so here's the
tricky part we want to know if the key
has changed since the last row we read
so we'll check if old key is even set
because if it's not and this is the
first line we're reading and if it is
we'll see if it's different to the key
we just read in if that's true then the
key has just changed in our example data
we had just switched from the Miami row
to the New York City row so now we need
to write out the result which will be
key which is the store name a tab and
the sales total for that store then we
reset sales total back to zero now for
every row that we process we'll set old
key to the key we're working on then add
the current sale to the running total
and then we'll loop back to the next row
eventually we'll run out of data which
will take us out of the loop do you
think we're done</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>