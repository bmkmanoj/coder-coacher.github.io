<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Working with Promises - PWA #11 | Coder Coacher - Coaching Coders</title><meta content="Working with Promises - PWA #11 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Developers-India/">Google Developers India</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Working with Promises - PWA #11</b></h2><h5 class="post__date">2017-04-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CqTGssuLftE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so JavaScript promises one last thing
today
now we're already into tomorrow's
material but I'm gonna do one short talk
and you one short lab and I think the
way people are looking your brains are
pretty full so one little thing we'll
get it done we'll be out of here for 15
or 4:30 come in tomorrow we'll start
like that we'll go through the full day
tomorrow is more is more time in the
labs less talk more practice that's very
deliberate when you build a class if you
ever teach people always if you're
teaching programmers always give people
more programming forth towards the end
of the class because your brain is fresh
to start you can deal with lectures
later on you don't really deal with
lectures you just want to write stuff so
increasing the number of labs late in
the class is actually a lot easier on
you just a little tip if you ever do
this job so jobs get promises most of
you have used them but I want to tell
you a couple of things you may or may
not know so you know what we're trying
to replace here is the mess of nested
callbacks or event handlers different
weights doing asynchronous code that are
kind of difficult because the problem of
the callback is what happens when I get
an exception in the middle of this it
could be really tough to work on also
look at this entire pyramid of nested
stuff think about how often you have to
repeat this it just becomes hard to
maintain
so instead promises you know do
something it returns a promise then pipe
that to the next step
fetch the flag image pipe that to the
process thing then append it makes for
very simple modular code now terms of
error handling you can put a catch
keyword in here to capture any errors
above so if get image name fails this
catch this fallback would get it
now what this catch can do is when it
returns a value it pipes into the next
thing so this might catch any errors
getting the name and put back a default
name
you can also not shown here you can say
get image name no actually I just think
I like this this is you know then you
can have two parameters you can have the
thing to do if it's good and the thing
to do if there's an error normally
people use catcher then they don't
normally use the two argument form of
then but they're actually equal now to
wrap a nice synchronous operation in a
promise you create a promise object it
takes a function with two parameters
which are themselves functions you do
some asynchronous thing and then maybe
you've got a callback or an event
handler and if you get a result you call
resolve with that result that passes it
to the pipe or you call reject with an
error it's actually a pretty simple
piece of code to write I once was
writing a demo last place I worked that
the initial cut at the demo was 10,000
lines of code all asynchronous callbacks
I turned it into promises it turned into
the 3,000 lines of code much more
maintainable these are really great for
wrapping async operations or existing
api's and then use the promise then and
catch like you've been doing so promised
at all I could provide an array of
promise an array of promises and these
will execute in parallel I will get back
an array of results but be aware they
are not always in the same order as the
original promises they're in the same
order as the results arrived so things
can be a little scrambled up in the
results what most people will do is when
they return a result from the promise
they'll take a serial number in and
return a serial number out as part of
the output result and then do a sort
based on those numbers but this is great
you know so think about in the browser
when it loads files it loads a bunch of
files in parallel well you could load a
bunch of data in parallel
now promise that all does fail it either
resolves if everything works or it fails
if anything fails it's just kind of a
shame sometimes you just want to skip
that result and keep going if you want
that you have to write some custom code
promise that race on the other hand
takes multiple promises runs them at the
same time and gives you back the first
value that resolves or it gives you back
the first error but it's kind of stupid
because what you really want is if
something errors you want the other ones
to keep going
instead with race if something ferries
out everything dies it's like yeah and
not great if you look at the offline
cookbook written by Jake Archibald he
gives a bunch of examples of doing
offline with serviceworker he has a ten
line replacement for a promise race that
actually does the right thing so there's
the problem prong spot race doesn't
really race if the error happens first
that's it you're over so the lab here
told you it wasn't going to be long is
just for practice built two promises
chain them together handle errors and
then use all in race</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>