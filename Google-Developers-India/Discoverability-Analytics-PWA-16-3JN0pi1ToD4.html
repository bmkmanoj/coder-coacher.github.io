<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Discoverability &amp; Analytics - PWA #16 | Coder Coacher - Coaching Coders</title><meta content="Discoverability &amp; Analytics - PWA #16 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Developers-India/">Google Developers India</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Discoverability &amp; Analytics - PWA #16</b></h2><h5 class="post__date">2017-04-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3JN0pi1ToD4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">discoverability and analytics people
have been asking about this how do i do
SEO how do I find out what my users are
doing because it's a web page you want
to be able to do these things so the
short short answer is you're using
progressive enhancement so you're still
building a site that everybody can see
and the PWA features are a layer on top
of that for capable browsers so all the
rules and SEO rules of building a good
site still apply now javaScript sites
you probably knew this already but our
crawler actually does index JavaScript
sites and execute sand watches things so
there is a new set of best practices
that you can get to in the slide deck or
from the textbook this was a post on
Google+ that's been put up and you can
read those and it got very specific
things that you need to be doing to make
sure that your psyche picks up in the
crawler but you can also go to the
Google Webmaster Tools and use the fetch
as Google tool which will pull your page
and show you what Google actually sees
that's important because you know how we
render things may be missing or
different you actually want a good look
of what we're doing so that's the first
rule you're still building a website it
still uses JavaScript you need to follow
the same rules as everyone else so that
you get into the database properly now
what's analytics kind of the obvious
thing here so as the user does things
that generates data that goes to the
analytics back end and then we generate
reports okay kind of obvious but need to
define our terms so when you built how
many people are using analytics already
see most of the room not quite everybody
so let me do a quick review for the
folks who don't what you do is you go
into google analytics create an account
which is free and each account has
multiple properties now I don't mean
JavaScript properties you have multiple
locations that it tracks so each
property is one location for each
property you'll get a piece of
JavaScript code called the tracking
snippet that
has an embedded property number in it
and then optionally you can do some
custom analytics beyond the default that
we give you so an example you might have
one account and if you had iOS Android
and web apps they would each have unique
property ideas but you attract them
under one account this is what the
snippet looks like there's a bunch of
uglify jas above this but at the bottom
that creates a function called GA google
analytics at the analytics function you
call create and give it your tracking
number so this will be some number that
you've been given that creates a
connection and then you start sending it
events so in this case you're going to
Senate page view events for each page
the user looks at but you don't have to
be limited to page view events so
typical example of the analytics
dashboard and we can infer from
subsequent page views how long somebody
spend on each page except the very last
page hard to infer that one so we also
have real-time analytics so we will
report to you the cycle time on this is
about once a minute will actually report
to you what events have been happening
live it's kind of fun to watch
especially on a roll out and it could be
good for some diagnostics so if you want
custom events easy you sent a new event
you set the hit type to event and then
these next three fields event category
action and label are completely up to
you these are the three axes on which
you can sort things in the report
alternatively you can call GA send an
event and just line those three fields
up and it'll work to this top versions a
little bit more readable okay pretty you
know pretty obvious pretty simple so
somebody was asking for example can i
crack add to homescreen so if I actually
have the user initiated add to
homescreen event and I write to the
manifest to kick it off with a system
then I could actually send at the same
time the fact that they did that add to
homescreen so
I can construct that particular event if
you send push notifications when the
client receives the push first when the
drop-down notify shows up you could
record that event when they react to it
you could record that so you can record
any user action they take and send it
off as an event so here's the example in
push push notifications we subscribe to
the push manager and then whenever we
get the subscription we go ahead and
send a note that says okay this user
registered for push messages now there's
a bit of a problem when you do this with
service workers the GA library requires
the use of window so instead you ditch
the library if you don't have window
what you don't have instead of a worker
and instead send the appropriate HTTP
formatted messages and that's documented
as the measurement protocol API there's
a dock page at Google but let me show
you some examples so I'm going to listen
for somebody gets a notification it
closes it and post a analytics event for
that so on clothes of course do the wait
until to keep things alive do a fetch on
the Google Analytics endpoint google
analytics com collect post version 1
message and leave us the ID alone set
your tracking ID to one of your ideas
define your event you know and add your
various values afterwards now what about
if you're offline the idea if you're
offline is basically to take those
events and instead of sending them to
the server because you can't build the
URLs and stored them in the database
then when you're back online read the
database playback all the URLs now you
could write this code but you don't have
to as usual we have an open source
library called offline google earth
called SW offline google analytics
service worker offline google analytics
that you
basically go get it from NPM it's on
github import the script initialize it
and use it to send your messages so just
pass the messages to it if it can reach
the server it will and if it can't it'll
store them in index DB you can see the
date of the store here I'll find Google
Analytics with a store of URLs they're
all stored up there when it goes back
online it'll read and play them back now
there are limits in Google Analytics to
how many URLs you can send in a batch
it's I remember correctly it's like the
last 256 events so this basically does a
the correct queuing for that what
happens if you run out of storage I
don't know what the error handling does
on this one you could look at the docks
and see what it says I suspect what will
happen is it'll just fail to store that
event so this will capture the event
offline remember this is so if the
service worker is tracking the page
views yes but this doesn't hook the
top-level handler so you'd have to pass
that data down what I would do at that
point is actually if I'm serving our
pages on the service worker I'm probably
sending a synthetic page view event of
my own inside the app normally inside of
an SP a you don't get the same kind of
page view of it but you can generate
your own synthetic one your own custom
one every time you render a new page and
that's what I would do so the lab at is
to set up an analytics and firebase
account add analytics create some custom
events so you can experiment with custom
page views try it with service workers
and push notification we get a little
sample for you using the measurement
protocol API if you all find analytics
so practicing all the things we talked
about
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>