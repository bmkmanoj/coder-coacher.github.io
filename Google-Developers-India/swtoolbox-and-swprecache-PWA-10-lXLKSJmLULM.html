<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>sw-toolbox and sw-precache - PWA #10 | Coder Coacher - Coaching Coders</title><meta content="sw-toolbox and sw-precache - PWA #10 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Developers-India/">Google Developers India</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>sw-toolbox and sw-precache - PWA #10</b></h2><h5 class="post__date">2017-04-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lXLKSJmLULM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I introduced precache and toolbox and
the architectures talk let's take a
little deeper look into them so some
service workers can be crazy crazy
complex the whole idea of the
serviceworker cache API is you write
your own caching caching logic but it
can be complicated so we wrote a bunch
of it for you so as I said precache
generates service worker code handles
versioning redirects all of that because
for example if you do a fetch and you
have like a 301 302 come back you have
to handle that our code actually handles
redirects and such for you knows what to
do and it's located under sw-precache
it's a gulp plug-in actually it has a
gulp plug-in and grunt plug-in and it
works in all of these sw-toolbox is a
bunch of tools for writing your service
worker and sw-precache depends on it so
let's look at an example for a pre cache
here's my gulp file
I need the path tool load 3 cache to
find some path so I want to basically
cache everything under app so my it's
saying my entire source is under the
application I create a task called
January desc w callback is called at the
end precache write any paths listed in
the source gap join them together this
is going to go into a file called swj
yes to build your serviceworker now
there's two entries here that will show
up in the next two screens the list of
static files to import and the list of
scripts to import strip prefix if you
remember in the previous page path start
sources app you actually want to strip
the app prefix once you're running
because that's where your application is
located that'll be the root of your
directory and then the callback signals
when this is done so static file
Global's one way to do it is say path
source and list of files this way but
you can also list wildcards this will
traverse down any number of directories
and this will grab all the
all the file formats so this can walk
the disk and do wild carding and grab
your files you need to enclose this
sw-toolbox script and any other scripts
that you need you can also add custom
scripts at this point so if you need
custom logic in your serviceworker you
write them in the other scripts and
they'll get imported and run and then
call generated SW for gulp now from the
command line you could do the same thing
except instead of writing a gulp file
you Radek json configuration file that
lists what you need and then just call
it from the command line with a pointer
to the config file easy toolbox gives
you different strategies so for app
indexing HTML I'm going to say I want
that done Network first that's why just
define this strategy so if I backup
precache this is for static resources
things that don't change strategies like
this or probably for more dynamic
resources so I get a set of five things
I can use network cache first
fastest is the race so race them and
whatever comes back first use caching
only or network only and you can add
your own strategies if you look at the
source code for these these are like 30
or 40 lines each it's really easy to
write a new one so for pattern matching
in the routes you can if you're used to
the Express API and node you can use
that particular syntax or if you're used
to regular expressions use that syntax
either one works so it either takes a
string for express or it takes a reg X
object denoted by the slashes for cache
management I said that sw-toolbox lets
you do cache management
so notice name for the cache max entries
max age seconds there's actually a big
list of options here take a look at the
documentation you can also go
so somebody was asking well can I build
caches for alternate origins I can't and
that's how I do it right there I say
okay this is a cross origin cache and my
service worker will actually watch for
those and cast that data to for things
like the Google API s-so toolbox is
really incredibly useful now in your
serviceworker remember to do this import
if you let precache write the
serviceworker for you this will be done
if you're writing it manually remember
to include that so the lab finally three
lectures one lap so installed toolbox
and precache there's my light setup gulp
go write a toolbox script to grab
specific requests so do some different
caching based on paths but customize it
and then use pre cached in the command
line</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>