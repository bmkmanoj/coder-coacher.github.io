<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building an Instant App with Anirudh Dewani (GDD India '17) | Coder Coacher - Coaching Coders</title><meta content="Building an Instant App with Anirudh Dewani (GDD India '17) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Developers-India/">Google Developers India</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building an Instant App with Anirudh Dewani (GDD India '17)</b></h2><h5 class="post__date">2018-01-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ftFWOdwnD9Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so let's get started the format
here is that I will present some slides
and I will talk about instant apps and
how to build an instant app and explain
the project that we're going to use in
the code labs and after that we'll start
coding so to begin first of all thank
you all of you who are here to learn
more about in synapse thank you for
attending GDD brief introduction my name
is Annie Rhoda Bonnie and I'm a
developer advocate in the partner
engineering or so what I do is I help
top partners build or integrate with our
technologies over the last 18 months
I've been helping developers build in
synapse the agenda today first of all
we're gonna discuss the technology what
are insane apps how do they work
after that we will look at the tools
that help developers build in synapse
finally we will look at the project
topeka which is a project we will use
for the code labs
all right so here's an example of
instant app running this is a recorded
video so you see here the user types of
query and you have results in the Google
Search app and as you click on a result
the app just launches this app is not
installed on the device it's run
instantly the Red Bull app here is not
installed as you can see it just runs
instantly provides you the same native
experience of watching video streaming
and all the functionalities that you
would expect in the app now what just
happened how did it work how did the
user get in the app without going to the
Play Store and without installing how
did we know which activity to launch
so in synapse our Android apps that run
natively so the key here to understand
is that these are native apps these run
on Android platform on top of android
framework have access to all the api's
and services and they run without prior
installation there are many surfaces
that can trigger instant apps some of
the surfaces are chrome when you search
for something in chrome and there are
links that appear red results you
click on a link and that can launch an
instant then google search up like that
video we saw before also links shared
through hangouts through emails anywhere
there's a URL and instant app can launch
finally we also integrated with the
launcher on on pixel as well as Play
Store so in place so now next to install
there is a button that says try now for
apps that have an instant version this
instantly launches an app so user can
experience your app without friction
without the friction of downloading it
and going through the install process
and then if they want to they can
proceed to install from within the app
so all this works like I said with a URL
so what what makes or how can we
associate a URL with an activity in the
app this is possible with app links so
app links are special deep links that
declare the relationship or that
associate your activities to URLs and
you verify your app links by uploading a
file to this location which is your
website comm slash well-known slash
assets links dot JSON this is where you
associate your web app the domain that
you own with your Android app so there
can only be one possible app that
handles all the links associated with
that domain now this is a requirement
for instant app but even if you're not
building a Nissen app you should go
ahead and claim your domain just upload
this file
that's what links to our JSON we'll see
the tools that help you build this file
the structure of this file and then you
upload that and your association is done
all your links belong to your app there
won't be any dissemination dialog that
says open with Chrome or open them with
this app right so go ahead and do this
anyway for your apps so now let's take a
deeper look at what happened so here the
user clicks on a link which was sent to
them on an app that's a travel
attractions app and the link is to a
specific attraction right it's a details
activity now how you organize your app
there's a list activity which shows
everything and you step into details so
this particular link points to a
specific attraction in this case the
fishermen
what happens then is we figured out that
this link is associated with an app
because of Apple Inc's and we also
figured out that the URL is represented
by the a particular activity in your
code now your code may have a lot of
activities it may be a very big apk we
know which activity represents the code
and then we pull down that specific
chunk of your app that contains the
activity and there it launches your
insta nap now you might say that
downloading my 20 MB app at my app is 20
megabytes or even more isn't a good idea
because it still adds friction it takes
time to download the networks are slow
it costs data so how is this how do we
make this possible so building an insane
app requires you to modularize your app
by features so you have a big app let's
take the example of a travel app you
have an app that has flights hotels
buses car rentals and then payments so
you look at our app as a set of features
right and then you carve out these
features into separate modules that's
what modernization is and then we only
download the activity or we only
download the feature module that has the
activity that the user is trying to
reach through that you are so the
reasons you should modernize your app
because in synapse are dynamically
composed at runtime
they need to be modernized so that the
download bundle is lean right you don't
want the experience of downloading the
experience should match the experience
of opening a web page right you should
not have an instant app take 20 30
seconds to download so they need to be
lean again they also need to be made
available on demand so when the user
clicks a particularly URL we load the
feature that represents that particular
URL and as user clicks a button so say
in that same example of a travel app I'm
done with my flight bookings now I wanna
book the hotel so I'm gonna click a
button that says add Hotel to my booking
at that point this is an intent right a
URL intent that tells the system that
hey we need to download the other module
the hotel's module for that feature so
your app is composed dynamically and
it's made available aren't on demand we
didn't download the other modules right
we only downloaded what was needed and
will download what will be needed based
on user action in the download and
module so for example when we download
the flight's module that module will be
cached in the system so it will be
available for faster loading second time
user tries to access the flight's module
now what are features let's look them at
details so these are discrete user
experiences right in the case of the
travel app it's a flights feature or
hotels feature and a payments feature
should the user try to convert they are
tied to one or more activities your
features should have at least one URL
addressable activity or else we cannot
download that feature but it can have
more activities so you can have a set of
URLs map to a single feature which can
have two or three activities that
support those set of URLs
it helps user accomplish a task again in
the case of the flights app the user is
able to find a flight using this feature
find a hotel and then finally another
task could be pay right so the user
finds a flight adds them to the cart
finds a hotel adds them to the cart and
finally the user wants to pay for this
so pay the payments could be a separate
module that's downloaded and applied
when the user actually tries to complete
the transaction the optimization here
comes from the fact that we only
download the feature that was required
to complete that user action so now
let's look at the tools that mean we we
released to help you build in synapse so
beginning Android studio 3.0 we added
support for instant apps so we have a
set of plugins some refactoring tools UI
Wizards and templates that help you will
then in cinah
in we added a new SDK the Android apps
the Android in synapse SDK which has
functionality or features that are
specific to in synapse we also enhanced
the app links assistant to four URL
handling so this helps you set up URLs
against your activities create bad asset
links got JSON file and then upload that
to the web server and then complete the
association between the URLs and the
activities also we had a support in the
emulator so your immunity can be used
for local development off in synapse
where it's another talk ad in synapse
tomorrow which I'll have a lot more
details we also added a new track in
Play Store it's called the dev track so
you guys know you must have used the
alpha-beta in production tracks right we
also had it at track or development
track for development and to do an
end-to-end test while developing what
you want is your app to be uploaded
right because it's instant should load
from the cloud dynamically so we are
there that development track which has
less which restrictions where you can
upload your app and share with QA for
testing or you know for your processes
in the company so now let's look at some
of the tools made available with Android
studio so we added in two new plugins
that help you represent feature modules
and in synapse so we already had a
plugin for library we had a plugin for
an app we added two more plugins to the
present future modules and to the
present and in celeb so the plugin for
feature to declare module as feature in
studio when you create a new module to
declare that module as a feature Mario
you add you apply calm android dot
feature to it just as you do for library
Condor Android library for feature
Mario's you apply this plug-in and when
you use the template or the new module
wizard you will see this icon here for
the feature modules so what's the
purpose of feature module when we
started developing the infant the
instant app tools we wanted you we
wanted to enable a thing
project structure Wien wanted to enable
a project structure that will allow you
to have a single codebase to build your
incent and install that right we don't
want you to write a completely different
version which will be your instant happy
want you to use the same code as you add
features for one those features should
be available for your instant and
install that instant apps are not trial
apps they are not demo versions they are
not lies versions they are your app
should represent the full functionality
of your app so to enable this we needed
a plugin that would compile into an apk
when applied to a build of an instant
app but would generate the artifact aar
when applied to an application type why
because instant app applauded artifact
it's basically a collection of modular
apks write small apks each one of them
is a feature apk so the flights that apk
hotels are IBK they're all constructed
separately so that and bundled together
so that they can be downloaded on the
map so what we wanted to do with inson
app is produce an apk but when compiling
your or building your application as
Commodore Android application a regular
installable application this feature
plugin generates a aar output so it's
dynamic in nature on which top-level
artifact it's applied through okay
this feature module convert Android our
feature should only contain code that's
specific to that particular feature
so the second plug-in we introduced was
calmed Android or instant app this
basically produces a build artifact that
represents your instant app essentially
this is a zip file and this is zip file
has a collection of split apks so in
terms of Gradle it basically has nothing
you don't do anything you just say this
is the output type include these feature
modules and it produces a zip file it
has no code no resources no manifest of
its own
and in the dependency section you
basically include the features that you
want to bundle in your insane app now
there may be cases I already said that
we want we look at instant apps as a
complete app not a trial or a demo
version but there may be some cases
where you have features that do not
apply to an instant app a good example
will be offline video right an app that
allows you to offline video content and
then watch it later that functionality
may only be available in your install
that but may not be available as part of
an insane app so it also allows you you
can selectively choose the features that
you want to bundle in your insane app
and then add other features other
features for your installable app this
is the app links assistant tool that
helps you create the association between
your two that helps you create URLs
assign them to activities and then
create the association between the web
app as well and the Android package so
you basically open this tool and then
you set up some URLs you select the
activity that maps to this URL in the
manifest it creates the necessary intent
filters and then on the right side you
see the process there you generate you
generate an asset links JSON file then
you upload that file and then we've at
that point we verify that the domain
belongs to you and these URLs belong to
you are associated with your package ID
finally as part of the insanity also
added the instant app we are also
reducing synapse SDK these has this SDK
has api's and features that are specific
to instant apps that's the dependency
you want to add in your Gradle to
include the features for in synapse the
API is for in snaps some of the API is
there are there's an install API so when
the user has your instant app running
and at some point there's a feature that
the user wants to use that's only
available in your installed app or the
user decides to install your app there's
an API that triggers the install of your
app then there are cookie and storage
API so when the user moves from an
instant state of your app to the
installed sale of the app we want to
make sure that the transition is
seamless so this API lets you backup and
transition
preferences and data over to the install
app so the user context is not lost
right
when the user installs the app we don't
want the user to start afresh right he
may have already gone through some setup
or profile within your insane app you
want to carry that forward and then
there's the in-app context API this is
basically one single method call that
says it's instant app is in synapse will
tell you whether your app is running
instantly or not so a good example of
usage of this API would be the first API
install API you only want to trigger the
installed API if you're running
instantly write cinder code you would
say if it's an app called eaten solid
ice okay so those are the new tools but
the tools required to build in synapse
now let's look at the code lab project
which is project Topeka so it's
basically a simple quiz app has some
categories and some quizzes that you can
take a couple of activities a very
simple app we're going to use this app
to builder to build our tea for our core
laps today so this app is monolithic
code one module the application module
that has everything in it so what we'll
try to do is first create a base module
so we'll create one base feature module
comm dot Android dot feature right apply
that plug-in to this module we'll put
all the code there right and then we'll
create and we'll create an instant app
module and then install that module
right so all the it's not very well
modularized just all the code lives in
one module and we create the to build
artifacts they are installed at and
instantly from it in the second step we
will create an additional module
additional feature module called to pick
a UI so what we'll do there is pull up
all the UI code into this module so all
the activities UI activities will move
into this topic a UI module and we'll
leave the common application and the
common application code and the
frameworks and the base libraries
libraries that would be used across
modules we leave all that in the base
module all right so this is what we're
going to do now I want to talk a bit
more
about the base module right the base
feature module the base meteor module is
a special module you can only have one
base module in your app and all other
feature modules should depend on this
base module so going back to our example
of flights and hotels
those are your feature modules right but
there will be a lot of code that's
common right you load some widgets you
note some views that are used in all
your activities you have some dependency
injection framework or some frameworks
that are using that apply to all the
modules so all that code what you want
to do is put that in your base feature
module all the feature modules depend on
that so they have that they have all
that functionality available to them
base model is also very important
because the Android package managers
system that it knows about your instant
app through your base module that's the
first module that's pulled up when a
user tries to access your Instagram
through a link that has a definition
that has a package ID so the base module
is special and they'll be in the Gradle
file for the base module you'll add some
special configurations you see that tag
that says base feature true this
basically tells a build system this is
our base module and there's a
configuration there called application
project so bitch here we basically
specify what are installed package name
is so that this copies over the package
ID and builds your insane app with the
same package ID and then the base needs
to be aware of all your features as well
right so you say feature to pick a UI in
the case of the flight's example here in
your base module you will say this
feature hotel feature project flights
feature project rentals so base module
is aware of everything this is all
needed because when you trigger a bill
what really happens is the manifest
merger kicks in picks up the manifest
from each of the future modules extract
the activities the intent filters and
then combines them in a big manifest and
that's how the base the system is aware
of all the components in your
application okay so now it's time to
start coding the core lab links is again
here now
two things you can do one go through the
code lab and try 240 Topeka or build a
instant Topeka app the other thing you
can do is if you work on Android
projects and you if you have an Android
app you can start building your app as
an instant app today
right we'll help you through that
process in the end you might have
something you can go back and demo to
your team's right so you can either
follow the code labs or if you're a
little more comfortable try with your
relapse
simple steps these are also in the code
labs in the core lab document convert
we'll begin by converting our
application module to a base feature
module so we move all the court there
then we create a new application module
which generates our install that and we
create an incident module which
generates our instant this is same as
the block diagram you saw earlier and
then we carve out a separate feature
which is UI and we pull up the UI
activities into that module
finally we deploy and test okay so the
feedback link is here if you are using
your app today we would love if you can
give us some information about your app
and drop some feedback we'd love to help
you after this code lab you know after
gdb will follow up with you so if you're
trying with your real app today fill
this form we would love to know about
your app the code lab link is right
there and all the instant app
documentation is available at G dot go
slash in synapse so I'll leave at this
slide and then let's start the collab
now all tears are here if you need help
raise your hand we'll come and answer
your questions and help you - yeah thank</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>