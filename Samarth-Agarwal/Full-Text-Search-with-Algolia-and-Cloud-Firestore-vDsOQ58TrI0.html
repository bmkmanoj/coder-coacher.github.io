<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Full Text Search with Algolia and Cloud Firestore | Coder Coacher - Coaching Coders</title><meta content="Full Text Search with Algolia and Cloud Firestore - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Samarth-Agarwal/">Samarth Agarwal</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Full Text Search with Algolia and Cloud Firestore</b></h2><h5 class="post__date">2018-04-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vDsOQ58TrI0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello I am some earth and I'm back with
another video on my youtube channel and
in this video we are going to learn
about implementing full text search in
cloud fire store so as of now what you
can do is make queries on your fire
store data based on the value of certain
fields but what it does is that it
matches the value of the field exactly
as it is so if you are looking for an
exact match it's going to work for you
but if you are looking for something
more like a search or more appropriately
I should put it if you are looking for
text based searches then it is not going
to work for you fire store does not
support that as of now but what fire
store does is that it recommends to use
something like elastic search or algo
Lea and in this video we are going to
learn how to use algo Lea with cloud
file store to implement full text
searches in your application just for
the sake of this video we'll be using an
ionic application to implement all that
search functionality but the concepts
are pretty much the same all you need to
do is just use the SDK is provided by
algo Lea and you are good to go so as
you can see that I have a collection
here and the name of the collection is
steam for some reason basically it just
contains some documents and each of
these documents contains four fields the
field names are titled user ID ID and
body two of these fields are numeric
while the remaining two are text or
strings as you can see that the title
here represents something that the user
will never be able to type exactly as we
have here in the cloud store data in
order to make the user be able to search
within these fields we need to implement
full-text search and we are going to use
algo Lea for that but to use algo Lea
all this data first needs to be provided
to algo Lea okay if you have the data in
your cloud file store you can easily
write a function to move all the data to
algo Lea and then algo Lea can do the
rest of the magic so first off in this
video we are going to write a function
that will move all our existing
documents from a collection to an index
in Algeria okay and then in the second
part of the video we are going to write
the code for our ionic application
implementing the search functionality so
you can just go ahead and sign up for a
free account with all gulia you can try
it out for 14 days for free so just go
ahead and sign up for an account and
once you have signed up just go to
indices and get rid of any indices if
you already have so I'll just go ahead
and delete this one indices are very
similar to what collections are in file
store so all the related data is stored
inside an ending okay so now that we
have deleted the index we are ready to
create a new one with the data from
cloud file store there is an API key
section as well which contains the
required credentials you'll need all
these keys when you will be connecting
to algo Lea using your firebase function
so I'll start by creating a new firebase
project so I'll just log in to firebase
first using the firebase CLI and once I
have logged in I'll just go ahead and
create a new firebase project with the
functions feature so all I want to use
in this project is firebase functions so
I will just log in and then I'll create
a new folder called firebase I'll go Lea
server and inside it I'll initialize a
new firebase project with just firebase
functions so I'll just go ahead and type
in firebase init functions now I'll have
to select a firebase project that I want
to use so I'll just go ahead and select
my first app which is the same project
that we just had a look in the console
and now it is just going to ask us a few
questions and in just a few moments the
firebase project is created let's open
it in Visual Studio code and have a look
at all the files and folder so we have a
folder called functions which contains
the code for our firebase functions in
the index dot JS file we'll be writing
all our code so you can see that we
already have an import for firebase
functions module so we'll add a few more
imports here
the second import that I am going to add
here is firebase admin okay and the next
one that I am going to add is Algol II a
search
okay so alveoli searches a module that
will be installing will install that in
just a few moments but before that we
will also initialize constants for our
Algol yeah ID alguna admin ID &amp;amp; algorri
index name okay so the name of the index
is going to be users you can use
whatever you want it is just like you
name a collection in file store so I'm
just going to call it users and for app
ID and admin key you can refer the API
key section in your Algol your dashboard
so just go ahead and copy those keys
from there and paste them right here
once you have done that you need to
initialize the firebase admin SDK next
we will just create a function this will
be an HTTP based function so it can be
triggered using a URL and the name of
the function is going to be add file
store data to L go Lea inside this
function the first thing we'll do is
retrieve all the data from my collection
steam and then insert that data in an
array that I'll send later to Al gulia
so I'll just retrieve all the data from
my team collection and in the promised I
will get all the documents from this
collection and then for each document
I'm just going to get the data from this
document and one more requirement that
I'll go Lea has is that every object
needs to have a key called object ID you
need to have the key exactly as I have
here so the O for object ID needs to be
lowercase while the alphabets I and D
need to be uppercase and generally when
you are using L go Lea with file stores
you might want to use the document ID as
the object ID for L go Lea
so I'll just insert the object ID key if
you do not insert the object ID key in
the user data algo Lea will create
random object IDs for you so it's better
that we use the file store document IDs
as object IDs for algo Lea once you have
the user object ready we'll push that in
an array and let's just define this
array as well so I'll just define it as
a blank around the top and once we have
all the objects inside this array I'll
just write the code to send this
data to alguna while initialize a client
object first using the Algol a search
module which takes the app ID and the
admin keys as parameters and then I'll
create a reference to my index so I'll
use client dot init index function and
it takes the name of the index as a
parameter in our case the name of the
index is users finally I'll just call
the save objects function on the index
object the save objects function takes
the array and saves that array inside
the AL Golia index inside the callback
you'll get all the contents saved as a
response
so I'll just return that response as the
response of the HTTP function as well
all we need to do now is install algo
Lea search module and we also need to
save that information to our package dot
JSON file so all I have to do is just
type in NPM install algo Lea Sauvage - -
save this will install the algo Lea
search module and we'll also save that
information to our package dot JSON file
once installed we are ready to deploy
this firebase function to firebase so
I'll just run the command firebase
deploy - - only functions this will
deploy the firebase functions only to
fire with one stern you will get a URL
that you can use to call this function
from your browser so I'll just copy this
URL from here base that in the browser
and you are good to go the function will
be executed and all the data from your
firebase cloud store will be saved to
your algo Lea index and if you are on
the spot plan on firebase then you might
not get anything in the browser and that
is because firebase does not allow
external API requests on the spot plan
so you might want to upgrade your plan
and once you have upgraded your plan you
need to execute this function once again
and you will see all the data from your
cloud fire store in your Al Gore index
so it might look something like this you
can see that I have all the data inside
my algo Lea index called users
so now that I have all my data on algo
Leah I can implement search
functionality is in an app so for now
I'm going to use an ionic app the name
of the application that I am going to
use is firebase algo Leah so I'll just
open the app in Visual Studio code real
quick
and I'll go to my page and I'll import
the alka research module to get rid of
this error I'll have to install the algo
Leo search module just as we did in the
firebase project I'll define a few
objects here the first one will be the
client and I'll also define algo Leah
app ID and algo Leah API key okay these
two keys will be required when you want
to connect to your alko Leah index from
your application then I'll initialize
the client using algo Leah search and
then pass in the app ID and the API key
the third parameter into this function
that I'll pass is a JSON object with the
key protocol and the value HTTP colon
this is required specifically for
applications running on localhost I'll
also define a new object called index
and this will hold the reference to our
index well just type in this dot index
is equals to this wrote client not in it
index and then pass in the name of the
index again the code so far is very
similar to what we have done in the
firebase function except except that the
API key we are going to pass in on the
client code is the search only key while
on the server code it was the admin key
now we need a variable that we want to
use to perform our searches so I'll just
go ahead and create a new string
variable called search query will later
bind it to an input field in a reg tml
page and now to perform the search all I
need to do is just use the search
function which takes a JSON object for
some configuration as a parameter so
I'll just go ahead and type in this dot
index dot search and the JSON object
which I have to pass in here contains a
property called query and this property
contains the value of the text that you
want to perform your searches based on
let's just go ahead and pass in this dot
search query here and in the promise you
will get some data you can log the data
to console but I know that the actual
of data is data dot hits so you can use
data dot hits and assign it to an array
in your code so I'll just create an
array called users and assign data dot
hits to this dot users I'll use the
users array to display data as an ion
list in my HTML page so I'll just go
ahead and create an analyst real quick
I'll also change the page title to
firebase al Golia and I'll also create a
search bar in my iron header so the
search bar will look something like this
I have assigned an NG model it is equal
to search query the debounce value of
750 means that when the user types in
the search function will automatically
be triggered after 750 milliseconds now
all we need to do is use the iron input
event and bind it to a function so that
our search is automatically initiated as
the user types so I'll just create a
function called search and I'll have to
create that function in my TS file as
well so I'll just create a function
right here and I'll move all that search
code from my constructor to this
function so that's it let's see how this
works in the browser so I'll just go
ahead and type in ionic serve and this
will launch the application in the
browser make sure that you have defined
your app ID and your API key before you
run the application so now you can see
that the search field is there and what
I can do is just go ahead and start
typing in the search field and the
results will show up on the page
so as you can see as I type the matching
results are displayed on the page in the
ion list so you can see that the search
is pretty fast it almost looks like that
we are searching in real time so go
ahead and try it out I hope that aljalja
can be an answer to a lot of questions
that firebase developers have in their
mind one more thing that I would like to
mention is that as your data updates on
cloud firestore you need to make sure
that the data is also updated on your
algorri index so that as new documents
are created or older documents are
updated or deleted the changes are
automatically reflected on gulia so you
need to write that code let me know if
you want to learn how to do that
maybe I'll create another video on that
topic but that's another story so for
now this was it I hope that you liked
this video let me know in the comments
if you liked this video and as always
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>