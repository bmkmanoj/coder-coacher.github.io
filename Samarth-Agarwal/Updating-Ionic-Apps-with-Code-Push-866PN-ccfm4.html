<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Updating Ionic Apps with Code Push | Coder Coacher - Coaching Coders</title><meta content="Updating Ionic Apps with Code Push - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Samarth-Agarwal/">Samarth Agarwal</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Updating Ionic Apps with Code Push</b></h2><h5 class="post__date">2017-05-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/866PN-ccfm4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome back to the ionic
school I have been away for quite a
while but now I am back with another
video so in this video we are going to
learn about another cool feature that we
can implement in our ionic and co2
applications and it's called code push
so we learn what code push is and we'll
also implement code push in an ionic
application so let's start by learning
what code pushes so code push is a cloud
service which is built by Microsoft
specifically for Cordova and react
native applications what code push does
is that it allows you to update your
applications on the go without having to
update your application on the
respective application store so let's
say that you have an Android application
that you have built with ionic and you
have made changes in the HTML and CSS
files and you want those changes to be
rolled out to all your users in that
case what normally you would do is that
you will build your application for
release and then submit an update to the
respective application store which is
Google Play Store in this case what you
can also do is use code push to update
your application and whenever you want
to release any minor update for your
application you can use code push to
release those updates and your
application will download those updates
from the code push servers this will
eliminate the need of submitting your
application to the respective
application store now one thing that I
would like to mention very clearly is
that only the changes that you make in
HTML CSS or JavaScript files are
propagated via code push if you have
made changes in any files other than
that then most probably code push is not
going to work for you ok so I have
created a new ionic application here
which is an ionic 3 application and what
I am going to do is integrate code push
in this application so I'll just change
the current directory to my project
directory the
location name is ionic school code push
okay so if you haven't already then the
first thing that you will need to do is
install the code push CLI all you have
to do is type in npm install - g code
push CLI execute this command once and
the code push CLI will be installed on
your machine then you will be able to
run code push commands in your terminal
or command prompt next thing you'll have
to do is type in code push space
register which will create a new code
push account for you I already have a
code push account so I do not need to do
these things again all I have to do is
register my app with code push
registering my app with code push will
give me access keys that I need to
configure in my application so let me
just start by typing in code push app
Add and then the name of the application
now this name that you type in right
here can be different in the name of
your actual application but for the sake
of simplicity what I am going to do is
keep these names same so I'm just going
to type in ionic school code push this
will add a new application to code push
in my account as you can see I have got
two keys the first one is the production
key and the second one is the staging
key make a copy of these keys because
you'll need these later for now what I
am going to do is just copy the staging
key from here okay and open my
application in Visual Studio code so
here is my application opened in Visual
Studio code since I have copied the
staging deployment key the first thing I
should do is go into conflict great exam
L file and here right inside the widget
XML tag I create a new example tag which
is called platform Android since we will
be building this application for Android
only inside this platform tags I will
create a preference element and this
will contain an attribute called name
the name will be code push deployment
key okay and another attribute will be
its value and the value will be the
staging key that I have copied so I'll
just paste that here okay and if you are
building your application for iOS as
well just copy this and paste it just
bill
it just change the name of the platform
to iOS save you're conflicted examine
and now you can close this file once
this is done you will have to install
the code poo-ish Cordova plugin and the
ionic native module for code push so
let's just do that I'll open a console
right here in my Visual Studio code and
I will start by installing the code push
Cordova plug-in so I'll just type in
ionic Cordova plug-in add since I am
using the latest ionic CLI which is
three point zero point zero I do not
need to provide the plug-in name just
yet I'll just hit enter and now it is
prompting me to enter the name of the
plug-in which is Cordova plug-in code
push make sure you enter the name
exactly like I have entered and then hit
enter this will install the Cordova
plug-in Cordova plug-in code push and
will also make the necessary changes to
your project now I'll have to install
the ionic native module for code push so
all I have to do is type in npm install
that's just save at ionic native slash
code push and hit enter this will
install the ionic native plugin for code
push now whenever you use ionic native
plugins you have to import that plug-in
in your advert module to TS file and
pass it in your providers array so let's
just do that real quick save that and
close the app dot module dot TS file
now what I do is go to my home page
which is home door TS and import code
push
since we are going to use this module in
our wonder TS we'll have to pass it in
our constructor
okay I'll also import the platform
module
okay since code push is a cordova plugin
it requires that your application is
fully initialized before the code push
code can run so we will use the
platform's ready function to make sure
that the code that we write for code
push is executed only when the
application is ready and fully
initialized
okay so we'll type all our code push
code right here and inside this promise
of the ready function we are going to
write the code that will check whether
the version of our application is the
latest version according to the code
push servers or not if the application
version is an older one then the code
will update the application and will
restart the application so I'm just
going to type in a small bit of code
here and I will call the sync method on
my code push the sync method basically
takes in two parameters the first one is
the sync options which we are going to
overlook for this video and the second
one is a callback function which is
executed when your application is
updating this is a function that will
also get a parameter and this parameter
contains some information about the size
of the application update and how much
of that update has been downloaded so
let's just call this parameter as
progress okay and for now let's just
leave this function blank and once the
sync has been completed we will
subscribe to this event okay we will
also get a status as a parameter in the
SUBSCRIBE function and here we will
check the status for certain conditions
so the status actually returns a number
and that number carries a very special
meaning in terms of code push so what we
will do is import another module called
sync status from the same ionic native
module okay and now we can use the sync
status module to perform checks and
display respective alerts to the user so
I'll just bring in some code here and I
will paste that code here inside my
subscriber third I will paste that and
inside this code you can see that I have
checked status with a number of
predefined variables inside the sync
status module and I have tested for
example for checking for update this is
a constant value defined inside the sync
status module
if the value of status equals sync
status dot checking for update then we
will just display an alert to the user
checking for update similarly I have
tested for other values as well like
downloading package in progress
installing update up-to-date update
installed and error and for all these
conditions I am displaying a similar
alert to the user okay so the first
thing I'll do now is add the android
platform to my application and run this
application on an emulator
the platform has now been added so I'll
just run this application in the
emulator so I'll just type in ionic
Cordova run Android so as you can see
that as soon as the application launches
I get an alert checking for update I'll
hit OK so nothing happened because we
have not actually released an update on
code push so let's just do that so we
will now release an update on the code
push servers before that let's just make
a small update to our application so
I'll just change this title to the ionic
school I'll save that and what I'll have
to do before pushing an update is that
run ionic serve okay what ionic serve
does is that it watches for file changes
in your application and builds your app
again as soon as it detects any changes
in the files so now that we have made a
change we need to run ionic serve or
ionic build to make sure that the www
folder in our application carries the
latest updates and when we push our
application to code push server's code
push pics all the files from the www
folder and sends the update to the code
push servers so make sure that the www
fault are always carries the latest
files for your project so ionic server
actually launched the application in the
browser I'll just close that and
minimize my browser and I'll keep the
server running I'll just open another
terminal and in this terminal I'll use
the code push command to release a code
push update so I'll just type in code
push release Cordova because we are
working on a Cordova application then
you'll have to type in the name of the
application which is ionic school code
push then you'll have to type in the
name of the platform which is Android in
our case and optionally you can provide
in a flag call - M which is specified
whether this update is must for every
user to download or not I am passing a -
AM flag which means that this is a
mandatory update I'll just go ahead and
hit enter ok so we have successfully
released an update on code push now
let's go back to our application in the
emulator close it and try running it
again so that it checks for updates
I will hit okay
and you can see that I get another alert
downloading package I'll hit okay and
now it is downloading application
updates in the background
once the updates have been downloaded it
will show me another alert telling me
that now it will install the application
updates so now it is going to install
the updates and the updates are now
installed I'll hit OK and the
application will restart and I should
see the updates so now the application
is up-to-date and you can see that the
title in the header bar changed to the
ioniq school we did not deploy the
changed application code again to our
emulator all we did was push an update
to the code push servers and the
application downloaded the updated code
from the code pushed servers let's try
one more time so I'll just remove all
this code from here and instead I'll
just create a button here I'll say that
and before pushing an update I'll check
if the ionic surf command has completed
the build or not and you can see that
the build has completed and now I'll
just push another update to the code
push servers
so the updates have been pushed again
let's come back to the emulator close
the application and run the application
again and application should again
download some updates and you can see
that the application now is downloading
the package a little k so now the
application is restarted it is again
checking for updates
the application is now up to date and we
can see our button right here we forgot
to add some text so we can add the text
on the button and then push an update
again and that will be reflected in the
app next time the app is updated let's
also use this download progress callback
to show some updates to the user so what
I will do for now is just create a
variable and I will call this variable
as progress status this will be of the
type string and I'll initialize its
default value to a blank string and what
I will do is just update this variable
with whatever data we are getting in
progress so just if stringify progress
using JSON dot stringify and then assign
it equal to our progress status variable
now this should work but I have tested
this and it doesn't work the updates are
not reflected in the progress status
variable so to fix that we will wrap
this inside an ng zone dot run function
so it will force update the changes in
the progress status variable
and I will wrap this line of code in my
ng zone dot run function so I'll just
type in this dot ng zone dot run this
takes in a function as a parameter and
it executes this function and makes sure
that the changes are reflected
immediately
and now I'll display the value of
progress status variable as the text of
my button okay I'll save that
and I'll run the app again
and the app will download the updates
and install them and restart and now for
all the next updates the application
will display the status of updation
right here as the text of the button so
let's just try another update in this
case I'll just change the title to the
ioniq school code bush and now I will
release another update
you
so the update now has been released
let's go back to our application and run
it again
and this time while downloading the
update it should show the progress as
the text of the button
and you can see that as
text of the button it displays the
amount of bytes that are downloaded and
the total number of bytes as well the
update has been downloaded and now it
will be installed
I'll hit okay update has been installed
and now when the application runs the
title in our header bar changes to the
latest one
so this is how code push works if you
face any problems or if you have any
confusions feel free to comment on this
video also let me know what kind of
videos do you want me to create and I'm
really looking forward to your feedback
thank you for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>