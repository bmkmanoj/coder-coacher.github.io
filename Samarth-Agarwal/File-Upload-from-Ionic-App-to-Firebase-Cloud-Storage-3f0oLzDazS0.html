<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>File Upload from Ionic App to Firebase Cloud Storage | Coder Coacher - Coaching Coders</title><meta content="File Upload from Ionic App to Firebase Cloud Storage - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Samarth-Agarwal/">Samarth Agarwal</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>File Upload from Ionic App to Firebase Cloud Storage</b></h2><h5 class="post__date">2017-12-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3f0oLzDazS0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome back to my youtube
channel I am some earth and I'm back
with another video on ionic in this fun
video we'll be building an ionic app
that will allow the user to choose a
file from their mobile phone and upload
that file to firebase cloud storage so
the user will have to browse the file on
their phone and once they select the
file the file will be uploaded to
firebase cloud storage in this video we
will be installing a few modules the
first module will be the file chooser
ionic native module along with the
Cordova plug-in which will help us to
build the functionality to allow the
user to choose a file next we will be
using the file module and the Cordova
plug-in called Cordova plugins files
which will allow us to read that
particular file so that we can upload it
to firebase cloud storage lastly we will
have to configure firebase in our
application and I have already done that
in a lot of videos before so I will be
doing that real quick and then we will
be building the rest of the
functionality in the video so as you can
see that I am creating a new ionic app
here the name of the ionic application
is ionic file upload it is a blank ionic
application that I have just created and
now I am going to open this project in
Visual Studio code so here I have the
project open inside Visual Studio code
first things first
I'll install the firebase module and
configure firebase in my ab dot module
or TS I'm not going to explain this
because I have already done that in a
lot of other videos that you can check
out on my channel
okay so this is the config that I have
got from the firebase console you can
get this from your firebase console and
yours will be different
it contains quite a few credentials that
you need to make everything work finally
you call the initialized app function
and pass in this conflict so that is it
that's all you need to do to configure
firebase we will not be installing any
third-party modules like angularfire -
or anything like that we'll be using
just the firebase node module and now we
can proceed with the installation of our
plugins so the first plug-in that we
need to install is file chooser so I
will install the Cordova plugin and the
node module
now we will move on to the file plugin
now that everything is installed I'll
have to import it in my abroad module to
TS file so right after my status bar
import I'll just paste in two more
imports the first import is the file
chooser from ionic native slash file
chooser
and the second one is filed from ionic
native slash file and I'll have to pass
both these providers into my providers
array right here at the bottom we are
done with our app dot module to a TS
file for this video so you can just go
ahead and close it and now we'll be
doing the rest of the world in our pages
so we already have a page created for us
it is the home page so I just opened my
home to HTML and I'll create a button to
upload the files okay so this is the
button and this button is a block button
and this button will call the function
choose whenever we'll tap or click on it
ok and this tooth function is the one
that will be creating next in our home
dot TS file so let's go to home the TS
and create this function right away okay
so the first thing that we need to do in
this function is use the file chooser
plug-in so I'll import that up top and
while we are at it
we'll also import the file plug-in will
also pass both these plugins to our
constructor to initialize them
now we have got the instance variables
file chooser and file with lowercase
alphabets that we can use inner tooth
function so the first thing we'll do is
use the file chooser plug-in using the
file chooser object and I'll just call
the open function and on this function
you can call the den function and the
den function takes in a callback which
will be executed if everything goes well
and if everything goes well you'll get a
URL of the file that the user selected
on their phone let's just call this URI
okay and we will alert this you arrived
for now okay just so we know that we are
doing everything right so if we run our
app right now our app will allow the
user to choose the file on their phone
and once the user chooses a file on
their phone we will get the URI to that
file on the phone and the URI will be
displayed to us in an alert now the next
step is that we want to read that file
either as a base64 string or an array
buffer now we can use the base64 string
method but for larger files like images
it is very inefficient and is very
processor intensive so I do not
recommend to use it if you are expecting
the user to choose larger files if the
file size is below one megabyte then I
suggest that you can go with the base64
string method otherwise you should use
the array buffer function and that is
what we are going to do so now we will
use the file plug-in to get a file
system URL for this URI and then we will
again use the file plug-in to read that
file from that URL as an array buffer
okay so let's let's go ahead and use the
file plug-in so I'll just type in this
word file not resolve local file system
URL and this function takes in the URI
that we have got from the filechooser
plugin and once you pass in this URI you
will get a new URL which is the result
file system URL that you can actually
use to read the file from the file
system
so let's call this new URL okay and it
says Gordon alert this new URL as well
basically this new URL is not just a
string
it is a JSON object and it contains some
properties and functions so let's just
go ahead and use JSON dot stringify on
this new URL and alert it to the user so
now we'll get to know everything which
is inside the new URL object since it
will be alerting to us now I know that
inside new URL there is a field called
native URL that we need and it contains
the complete URL to the file it also
contains a field called name which
contains the file name so the next thing
that we want to do is use the read as
array buffer function which takes in two
parameters as you can see that this
function takes in the path as the first
parameter and this is not the path to
the file this is the path to the
directory in which our file is so we do
not have that path as of now let's just
go ahead and call it directory path for
now or dir path and the second parameter
is the file name which we have inside
new URL dot name so now that we have
provided both these parameters the read
as a buffer function will work and will
provide us a file contents as array
buffer but we do not have dir path as a
variable as of now so we'll create that
so we'll extract the path up to the file
from new URL variable and it is inside
native URL but we need to remove the
file name from this path then only it
will become a valid directory path so
what we will do we will split it we will
remove the last part that we get after
splitting and then we'll join it again
that way we will have just the path to
the directory in which the file is so
what I'm doing here is that I have
created another variable called
directory path segments and I have split
directory path with a slash so the
string will be broken down in a lot of
pieces wherever it finds a slash it will
break the string and will store all the
same
as an array inside directory path
segments variable next I have used the
pop function to remove the last element
which will remove the file name and then
I'm joining it again using slash so
basically if your path looks something
like this
and if you remove the file name then
whatever you are left with is actually
the path to the directory and that is
what we are doing so now that we have
the path to the directory inside the
directory path variable we are passing
it inside a read as era buffer function
and we will run the promise on this
function we will get a string let's call
the parameter that we get inside the
promise as buffer we will pass it into
another function that will be
responsible for uploading this array
buffer which is the content of the file
to firebase so I'll just create another
function which will be called as upload
and inside this I'll pass in this buffer
and the file name so the file name is
inside new URL dot name so the last
thing that we need to do is create this
function upload so I'll just do that
real quick
this function takes in the buffer as a
parameter and the name okay so now all
we are left to do is use the firebase
functions to upload this buffer content
which is actually the content of a file
to firebase so the first thing we'll
need to do inside this function is
create a new blog from this buffer and
then we will upload that blob to
firebase blob is a special data
structure which is used to transfer
files from one place to another so let's
just create a variable called blog and
this will be of the type blob okay and
inside this constructor we can pass in
two objects the first object is going to
be the buffer itself but you cannot pass
in buffer like that if you do that you
will get an error the second parameter
is going to be the type so this is
specifies a file type that you are
expecting the user to browse so for now
let's just keep the file type to be
image / jpg so we are expecting a user
only to browse JPEG images now this will
give you an error if you try to use it
so instead of passing in buffer like
that you will have to pass it as an
array okay that's what the blob expects
so once you have got the blob we will
now initialize the storage module of
firebase and now we will use this a
storage object to upload the files so
I'll just type in storage door drift and
here I'll have to pass in the path where
I want to store the files so I want to
create a directory called images on
firebase cloud storage and at the end of
it I'll just concatenate the name of the
file dot put and inside here I'll just
pass in the block you will execute the
promise and here I'll just alert done to
the user and if something goes wrong we
will just alert the error to the user as
a string if I'd JSON object okay we are
getting this error because we have not
imported firebase up top so I'll just do
that real quick okay and the error goes
away another thing that we want to take
care of before we actually run it is
that this function right here is an
asynchronous function so what I want to
do is that I want my choose function to
wait for the upload function to complete
okay so I'll just type in a weight here
and to type in a weight here I need to
modify this function as an asynchronous
function and I'll have to make upload an
asynchronous function as well all the
errors go away now our choose function
will actually wait for the upload
function to return and once the file is
uploaded then you can actually display a
message here that file upload process
has completed since we are displaying an
alert right here we do not need to do
that let's try and run this on my device
so I'll just type in ionic Cordova run
Android this command will add the
Android platform first and we'll then
deploy the apps on my phone which is
connected to this computer right now why
are the USB cable so let's hit enter and
wait for this process to complete
so here is the application as it looks
like on my phone you can see that I have
the upload button and I'm going to tap
on it as I tap on the button I get a
list of all the apps that can help me
choose a file on my phone so I'll just
go ahead and select gallery and choose a
picture from my gallery and as soon as I
select a picture you can see that I get
an alert that displays me the URL to the
image this is the functionality that we
implemented via the filechooser plugin
now I'll tap on OK and we get another
alert and this is what we have inside
the new URL object this is what we get
when we use the file cloggin and this
contains a lot of information about the
file the two things that we actually
used in our code from this object is the
native URL and the name okay so I'll
just go ahead and tap on OK now
and you can see that I immediately get
an error and this is the error from
firebase so everything went well the
file was converted into era buffer and
in our application was trying to upload
the file to firebase just when it ran
into this error and what this error says
is that permission is denied our
application cannot upload because only
authenticated users are allowed to do
that so let's go back and remove this
restriction and see how our application
works without authentication so I'll
just tap on OK for now I'll come back to
my firebase console I'll select my
project on firebase console go to
storage select rules and in here you
have to remove this part right here
after the right statement comment this
out for now publish all these changes
and now I have modified the rules so
that any user without authentication can
write to my firebase storage so now
let's go back to our application and try
again so I'll just hit again on the
upload button select gallery select an
image ok ok and I think it is uploading
the file to firebase cloud storage right
now and it's done so we get an alert
that says done let's head back to
firebase and see if we have actually
uploaded our file or not go back to my
firebase console click on storage inside
the files tab I should get a folder
called images we have the folder here
and inside this folder I should have the
file that I selected in my gallery so
here we have the file let's see if the
file shows up so this is the image that
I actually uploaded it shows up just
perfect in the preview so this is how
you can use firebase cloud storage to
upload files in this video we uploaded
just an image but you can use pretty
much the same process for any file on
your phone so that was it for this video
I hope you enjoyed it let me know if you
face any problems in the comments and
also let me know of some topics that you
want
to make videos on thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>