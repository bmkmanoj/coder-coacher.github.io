<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>&quot;Security for Humans: Privacy and Coercion Resistant Design&quot; by Morgan Marquis-Boire | Coder Coacher - Coaching Coders</title><meta content="&quot;Security for Humans: Privacy and Coercion Resistant Design&quot; by Morgan Marquis-Boire - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Strange-Loop/">Strange Loop</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>&quot;Security for Humans: Privacy and Coercion Resistant Design&quot; by Morgan Marquis-Boire</b></h2><h5 class="post__date">2015-09-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/k4ypqzOShZs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this talk is security for humans because
I'm a security engineer I'm actually not
very good with humans so I think this is
what a human looks like but I'm not
really sure I'm I'm going to talk about
privacy and corrosion resistant design
I'm going to talk about a bunch of other
stuff as well when I actually say
privacy i'm actually going to be using
this an exceptionally generalized term
which which which largely relates to a
type of agreement that you have with
people and how you handle their data I
don't particularly want to get into the
weeds on that although i do like these
sorts of conversations and we'll be
happy to have it at the bar of the
doubletree later um so as you mentioned
my name is Morgan Marquis Bois I work
for a variety of organizations I split
my time these days largely between
security Human Rights research and
journalism my day job is being the
director of security at first look media
all talk a little bit about in a second
I used to be a penetration sister I had
maybe four or five years we had a lot of
fun breaking into power plants and water
sanitation facilities and banks and
airlines and that sort of thing I spent
six years at Google security being a
security engineer and I'm very enthused
about the fact that I was one of the
founders of the key week on conference
in New Zealand so you guys should all go
so first look media is a kind of an
interesting new media enterprise
endeavor I you probably haven't heard
that name but you've probably heard of
these two people one of them is Laura
Poitras who just won an Oscar for
citizen for and the other one is Glenn
Greenwald and these are two of the
journalists who together with Barton
Gellman were given documents by this man
it would snowden and yeah i think he's
pretty cool too uh-huh and yeah so that
they were given a trove of toxic
documents pertaining to the activities
of the GCHQ and the NSA so in my day job
I have to sort of look after a bunch of
unruly journalists and I'm going to talk
a little bit about what I've been doing
for the last 18 months but probably in
Vega is for reasons that you'll
understand
and I also do a bunch of research and
have done for years with the Citizen lab
at the University of Toronto and they
are very interested in the sort of
intersection of digital media global
security and human rights I also advise
Amnesty International and Human Rights
Watch and that type of things of the
sort of the potential human rights
impact of emerging technologies and
insecurity and so forth so what am I
talking about today well I really wanted
to talk about corrosion resistant design
because this particular crowd is
actually really good at systems thinking
resilience and big systems failure modes
and big systems and in fact the previous
talk was fantastic a great example of
that and it was also really funny so
enjoyed it a lot but i think this crowd
thinks about system failure and system
resilience in a very specific way and
I've been thinking about this problem
for a really long time in a slightly
different way also I have to start with
an admission so I was I was one of those
kids who who was really really into the
internet I thought I thought that the
internet would just save the world so I
mean because I actually got to see it
kind of happen right Sosa bear in mind
it like you know I'm an academic brat
and so you know my first experience of
the internet was when my parents got
email the universities and would use
these texts clients to be able to like
you know send emails sort of other
academics around the world and and you
know I I got remember getting it at home
and thinking that this this amazing
piece of technology would actually
enable you know untold an unprecedented
freedom of expression which would
naturally be sort of a liberation
technology and issue in this you know
global era of peace and goodwill towards
everybody which isn't entirely what
happened you know but it was a kind of a
90s dream you know and and it still
lives on in a little part of my heart I
mean I try to keep that fire alive
because of course what we got was a
little bit more like this which is sort
of unfortunate right and I think what
happened was that much like a lot of
Technology early on it sort of benefited
the early
dr. Wright this fast the nimble the
hobbyist I mean you're like oh my god
this is really cool we can do all these
things with it but you you know as you
guys will be aware technology is a power
amplifier and that means of course when
forces of institutional power you know
really got hold of the internet they
were like oh yeah we can do all sorts of
interesting things with this so I'm
going to talk about corrosion resistant
design and sort of designing for the
inevitability of what will happen to
sort of the success of your endeavor but
I did this thing earlier where yesterday
and today I've actually been talking to
attendees and I said you know what what
would you like me to talk about if I was
going to talk about anything you wanted
like assume just one time only I'm a
jukebox and I'll take requests and I had
people at say all sorts of things it's
like oh I mean I'd like you to talk
about you know the targeted activists I
love you talking with human rights work
I'd love you to talk about nature theme
hour and I'd love you talk about
surveillance or Snowden or all these
types of things and then I actually
realized that a lot of these what
questions I sort of had before and spoke
to like really human problems that
actually really frustrated me because
occasionally can be a really impatient
guy but so what I'm going to do actually
is talk a little bit about threat
modeling and sort of a taxonomy of
attackers and actors that kind of
inhabit my world that I've studied over
the last you know six to ten years or
something and a lot of these cases have
involved very real people I'm sort of
going to talk about this and then I
guess about how we can try to design
against these problems so this isn't my
usual crowd so I want to ask some
questions everybody here knows what you
know exploits are making a show of hands
this is good like if I talking about
memory corruption and heaps praise maybe
yeah okay this is great we're gonna get
on good um right so I went to Google for
six years and I was on the team at
Google who did
response forensics and now our analysis
when we were hacked by China and this
was sort of an interesting time this is
sort of back in late late 2009 early
2010 and and and what happened was that
this kind of led to a lot of a lot of
chest beating you know there's kind of
like Oh shame on you China how could you
hack google you know this is really bad
and then of course we discovered that
China head and just hack google trying
to had hacked lots of Silicon Valley and
all sorts of other things beside and
then as things progressed on we
discovered that it wasn't just China but
that actually that that all the nation
states were hacking pretty much
everything all the time in fact if you
had interesting data the question is in
if someone will come for it it's how
many people will come for it and it's
not actually all nation-states all
nation-states kind of wish they were
it's generally it's heavily weighted
towards people that have you know
universities with comp sci programs and
collapse program you know maths programs
and so forth as you might imagine so
this takes us back sort of six years and
and i was working doing incident
response and forensics and then you know
there was this kind of wave of
revolutionary activity across the Arab
world and we have been watching it on
the news like many people and I had
friends call freedom bothers now do good
as those sort of people and they ended
up messaging me and say hey Morgan you
know we think we're seeing malware
that's actually sort of targeting you
know activists Human Rights researchers
and sort of journalists in on Syria this
sounds like you're sort of thing and I
was like okay like could you have a look
at it for us and so I started analyzing
of the smaller as it came in and and
some of this was actually pretty grim
this guy's name is timer Kareem and he
was arrested by the the Syrian
authorities he was tortured he he says
he thought he would never see daylight
again but but the thing he said that
really stuck with me was my computer was
arrested
for I was and they had transcripts of
all his skype chats that enumerated all
the people that he was talking to on his
computer they've been logging his
keystrokes looking at his emails that
type of thing and and I spent years like
literally years tracking these sort of
operations in Syria and the guy's face
you see there his name is borough and
galleon for a head for a while he was
the head of a Syrian transnational
opposition he's also a lecturer at the
University of the Sorbonne in Paris I
mean there was things that they would do
like they they hacked his facebook page
and and by they you know there's a kind
of you know in my end of the woods
attribution is tricky and so I would
generally use the term pro Syrian
government actors perhaps you know sort
of a nation state sponsored hacking
attempts you know sort of his facebook
was compromised and and links to to
malware which was rid through his
facebook to sort of near various
interesting followers and associates of
his and I mean this is just an example
as I said this is the sort of campaign
continued for years and actually sort of
continues to the current day I published
a variety of maybe like 13 or 14 pieces
on this with the eff and with Citizen
lab and in late two thousand twelve i
was contacted by bahrain watch and this
is a group that monitors the sale of
arms internationally to bahrain it is
not very popular with the bahrain
government this woman's name is elijah
hobby she is one of the cofounders of
bahrain watch and she is what I now call
finfisher patient zero and I'm not sure
how much you guys actually know about
this scene but as the desire for
internet surveillance capability has
increased with the move of people
towards using the internet as sort of
like a default digital Commons for our
world there's been
a booming commercial market for
offensive software finfisher was one of
the first companies to come to light as
providing this stuff commercially that
they're a company based out of munich
and what happened was during the Arab
Spring the in Egypt the doors of the
state surveillance secret police were
were kicked down and ransacked and
people found all of these documents
regarding the sale of the software and
these were published and so so this kind
of gained notoriety but no one had
actually ever seen the software and you
know if you worked in the security seen
it was actually very interesting to me
because typically you know if you guys
remember back to 92 93 right when the
sort of the birth of the virus seen and
you've got John McAfee screaming that
the Michelangelo virus is going to
destroy the internet and into them
nothing happens and then you've got
someone else screaming that the Melissa
virus is going to destroy the internet
and annoying nothing happens and so I
was actually very very interested in
what commercial malware actually written
by you know that they have an office you
know where it is there's a large group
of people they have a group of employees
that they presumably pay reasonably I
was very interested in what this looked
like and she was actually the first
person that was ever found to be
targeted by it and so I helped you to
analyze it it was actually pretty
interesting I mean they they use this
sort of interesting polymorphic packer
with like you know seven or eight
different code templates to sort of
obfuscate and you know sort of frustrate
someone trying to do reverse engineering
of the code I mean that's all right it
costs like they it costs like three
hundred thousand euros so that's that's
how much it costs for the sort of thing
don't get any ideas I would be really
pissed if that was the takeaway of this
talk um you know I I mean after I did
that sort of you know and really
released a paper on that together with
sort of Bill Maher check who was a
member of Bahrain watch um other other
people started getting in contact with
me and I started following the scene
more closely in in Morocco citizen
journalist movement name ma'am inch
whose tagline was no concessions what
they did is they reported on what they
believed to be draconian activities of
the Moroccan government
they were targeted using another
commercial piece of malware they were
actually sent being a journalist site
someone actually went to their contact
us page sent them a small message which
said this is really sensitive material I
need to stay out of this but you know
you need to have a look at this and it
was called it was a link to a document
named scammed a lot dark which happened
to be a word document containing an
exploit which then installed this
commercial so they want software and
another guy tigard by the same stuff so
these are all cases that I actually
ended up working this man is named amid
man saw he's currently an advisor to
Human Rights Watch in the Middle East
he's also a member of a group named the
UAE 5 and he was thrown in jail for
signing a pro-democracy petition not a
popular political stance in Abu Dhabi
and he was also being he got released
from jail maybe I think he served two
years or something and he his his
political views didn't change but
unfortunately the political views of the
establishment Abu Dhabi didn't change
either so it meant as he as he continued
to give pro-democracy lectures he found
that he was being tracked physically and
assaulted and that you know he would go
to give these talks and then he would be
physically beaten and he had no idea how
this was actually happen alike how the
hell of finding him he ended up getting
in touch with me subsequent the the work
I've done for Bahrain watch and it
turned out that he actually also had a
commercial surveillance in plan
installed on his machine and they were
reading his emails and using it to track
his location now the last two cases the
software was written by this group
called hacking team which I mean really
if you're going to come up with a name
for your nation state like I I think
actually the name came first and the
product came second because normally you
do it the other way around like the
product is actually called remote
control system which is very boring and
bland right um so I mean if they'd sort
of applied that to naming the company it
might have worked out better for them
well get the hacking team a little bit
more later but essentially they're an
Italian company that sells
what's essentially software your
backdoors implants malware for lawful
interception I don't really like that
word because the word itself implies
that it's fine so it's got the word
lawful in it but I mean functionally you
know it's its governmental interception
right like breaking into people's
computers installing sir precious
software that hides in activities and
then you you know record what people are
doing through their webcams monitor
ambient sound around their computers you
know track their keystrokes read their
emails see who they're communicating
with in that type of thing and as part
of this work I did the first analysis
together with Bill Maher chikan Claudia
guarnieri of a suite of such implants
for for mobile phones because obviously
as as the world has gone mobile so does
the surveillance state and so there's a
paper i call the smartphone who loved me
it doesn't contain this cute picture of
the android getting wasted but but the
spyware provides all the stuff that you
imagine you might want for the purposes
of espionage surveillance or tracking
right and it intercepts calls tracks
people's GPS locations obviously allows
you to read people's messages you know
and so on and so forth the bit that
actually kind of freaked me out was the
invisible microphone facility I mean
it's actually called spy call when you
disassemble a code right it's actually
called this a function called spy call
and so what that does is it takes over
the hardware of the phone and
instantiates an outbound call to a
remote number and so someone just here's
all the ambient audio around your phone
and of course you know the phones still
dark and that type of thing if there's
an incoming call what it does is it you
know returns control of the hardware to
the phone processes you know lights go
on phone vibrates that sort of thing in
it and it places the outbound call on
call waiting and then of course you know
you you know when you finish your call
spy phone kicks in again and you know
and start listening to you and of course
you know I'm sitting there and I've got
a decompiler open
learn stuff and I'm looking at my phone
its kind of the sort of thing room like
and I start thinking about putting it in
the fridge right I'm like ah become one
of those people like damn it um yeah
which I think speaks a lot to the
relationship that we have with these
devices that we carry everywhere right
like there's this kind of you know it's
the first thing I look at in the morning
and the last thing I look at 4i got a
beard and you know half of americans
between the ages of 15 and 30 check
facebook on their iPhones the first
thing they do when they wake up in the
morning right and so you kind of have
this like odd trust relationship there's
something that you just carry around the
all the time um as discussed in the
previous talk i'm going to show none of
my working on this but i wrote a paper
for the university of toronto so you can
look it up and there's hashes and
domains and I peas and code snippets
what sort of things you can look at it
there but this this conferences much
like this one where you can go and
actually talk to these vendors this one
is commonly known as the wiretap as ball
and and you know there's there's this
one in DC you know they have it they
have it around the world you can you can
go along and surveillance vendors you
know show their wares this is not the
only brand of this conference there are
others where you can go to purchase your
surveillance software together with your
gold-plated Uzi you know or whatever
dictator finery that you know you you
desire around that time you know I
actually started tracking in addition to
the sort of bespoke targeted
surveillance I started tracking the
usage of software hardware and solutions
that provided I guess what you describe
is massive intercept mass surveillance
or also so math censorship capability so
one of these companies will call blue
coat they're out of Sunnyvale in
California and you know that they
provide software which can be used
rather benignly right like it's used to
prevent the viewing of pornography and
libraries say I talked to a blue coat
salesman actually at a conference once
and I was like wow how how big do these
scales scale and you know I was like you
us you must really had some bandwidth
things he's like oh no we can do entire
countries like whoa really my entire
country's you say that must be really
handy like oh yeah no I mean me and of
course there's this sort of issues with
that right and so you know a couple of
years ago myself and some other fellows
colon Anderson primarily did a bunch of
scanning of the whole internet looking
for these devices and we came up with a
kind of criteria I guess for deciding
whether or not we cared about it so for
instance if you found it on a private
network so it's the corporate network
right then it's like well these networks
belong to whoever this is a sign to so
technically I guess they can do whatever
they want with it and also people do
sign some sort of agreement whatever
draconian it is when they actually like
to use this network so fine and as those
are the those are the gray areas the
black is we didn't find it the blue area
is when we found them on like public
sort of isp provider and government
networks and so we did a bunch of this
and of course we found it in a couple of
areas that I just simply contraindicated
like Syria now that's actually just flat
up illegal for a US company to sell
stuff to Syria and blue coat was filing
2.8 million dollars this wasn't the
first work on sort of the skullduggery a
blue coat there was a group called tella
comics who had actually been really
pursuing the use of blue coat stuff in
Syria for quite some time about a year
later we followed it up and actually
found that not only in Syria but also in
Sudan and Iran was this gear being
solved I mean this is an American
company who sort of selling you know
filtering monitoring censorship and sort
of surveillance apparatus to customers
with human rights records that you might
think are not great I mean that sort of
part can get actually get contentious
right in that you know I sort of get
other people sort of respond to me like
well they you ues runs gulags Guantanamo
Bay that sort of thing and say well
that's true but these people aren't even
complying with the law
of the native land which is that you
don't actually sell to these countries
we sort of did another report and we're
still not entirely sure of what what's
going to happen to them on account of
their stuff being found in Iran and
Sudan I kind of continued to be
contacted by people who felt that they
may have been victims of sort of
state-sponsored aggression digitally
there's a woman in LA named doctor who
ran the largest political blog outside
of Vietnam and her WordPress got hacked
and like she got locked out of her blog
and my first thought was actually I was
like yeah I know if this really looks
state-sponsored I mean how pity can
estate be answer is very um because at
the time I couldn't really figure it out
um you know she'd actually done a lot of
restorative work had people help her
trying to get her blog back and stuff on
the trail was greasy and kind of cold
but you know I sort of did what I could
and I kept the data and then you know I
I ended up sort of talking to you know
more and more people about so the
Vietnamese government surveillance
practices and I encountered more and
more people who felt that didn't
victimized by this one let's actually
finally blew up when there's a guy named
Chris brummitt who is actually the
author of this article he is a
journalist who writes for Associated
Press who is stationed on the ground and
Hanoi and he received the document which
promised to be a breakdown of the human
rights practices of Vietnam ironically
like it just and this actually proved to
be sort of targeted malware designed a
compromise his system there was actually
of the same kind that was found on the
system of the woman who round the the
bissan blog out of LA this was the same
as malware that have been used to target
a Vietnamese constitutional law
professor into loose who wrote
extensively about proposed changes of
rule of law of Vietnam and there's sort
of other people around the world that
have been targeted by
exactly the same people and what we
ended up seeing was kind of a pattern of
basically every politically active
Vietnamese group that you can imagine
had actually been targeted by the same
people and I got very interested in
actually the targeting of what what I
mean even intelligence people might
describe a sort of non legitimate
targets right like non-combatants not
not not military or government
installations not large corporates but
actually individuals you know activists
journalists and that type of thing and
this was actually the last piece of work
that I did publicly before I left Google
which was a study which actually ended
up showing that I think 21 out of 25 of
the world's top news organizations had
been targeted by state-sponsored
attackers and I then moved to working
for first look media where I released
some work on the targeted malware used
by the five eyes or the UK Australia
Canada New Zealand in the US and they
had had used this to compromise the
European Parliament and if for those of
you with long memories they they hacked
telecommunications provider in Belgium
Belgium and so this was actually a
sample that was found on this host in
the belgic on network which is kind of
an implant that it had had been written
by the five eyes so by hacking belgic on
this allowed them access to the
communications of all sorts of
interesting targets upstream which sort
of also included European Parliament
after that I worked on baba was actually
amusingly what we ended up calling the
French government's targeted espionage
kit that this linked to a whole bunch of
other stuff which was found in Iran and
Syria recently at black hat together
with Mary and March hillock I released
something on uh I guess a sweet right
again I guess you know in this case it's
kind of almost like archaeology because
this goes back to 2002 and so I don't
know how many of you guys remember like
the new executive
format like 16 bit windows and stuff
this malware targeted those systems
right this is why i said it's sort of
you know it's kind of archaeology and
then this looks like it was israel most
recently I've been actually working on
the case of alberto nisman who some of
you might know because this was kind of
like a South American JFK sort of thing
he was a lawyer and he was just about to
indict the President of Argentina and
then he was found mysteriously dead in
his apartment three days before that
apparently of suicide although they were
no powder from suicide by gunshot to the
head no powder burns on his hands it
everything looks very suspicious and as
it turns out there was malware on his
phone so I ended up looking into this
and found that this actually tracked to
a whole campaign of spying in Latin
America including against other
high-profile you know investigative
journalists such as Jorge lanata and
allegedly alow is unable to prove this
ended up targeting the president's son
as well Maximo Krishna so I've had an
interesting time doing this type of work
over the last few years this guy is the
PR flack for hacking team who is one of
the companies i mentioned before that
writes sort of commercial commercial
tools for espionage he doesn't like me
very much one of the one of the things
he sort of said to a reporter was he was
kind of like hey you know one person's
activist is another person's terrorist
you know sort of basically a sort of
everyone's a legitimate target kind of
argument then they actually wrote and
they sent this to my bosses where they
said call me a tireless wolf crier on
the issue of privacy as I saw it and
then I think they argued that I was
helping pedophiles and criminals and
terrorists and that type of thing with
my work seemed a little bit harsh now
yet see that laugh is exactly what I did
when hacking team themselves was hacked
earlier this year and their email spool
got dumped and inside this emails ball
you know because in this kind of age of
self googling so I looked myself up and
I'm I'm sure it's not personal but I was
mean
117 times and the email archive my
twitter pseudonym which was Morgan
mayhem for a number of years was
mentioned 29 times and I'm at headhunter
on twitter which rich got 15 mentions
which clearly I'm not big enough on
Twitter but I mean what where things got
even weirder was that they actually took
photographs of me and recorded me so
this is this is me giving a talk
actually not dissimilar to this one in
fact it does use some of the same
material that that talk that I gave and
this is photos that they took of me this
was actually found in the home directory
of one of the hacking team guys and I
got this mail from someone who's like
hey have you looked for yourself in the
hacking team dump and I was like yeah
you know I found this stuff and they're
like did you see this stuff where they
surveilled you and I was like wait what
what you have to whom it came as a
little surprise to me but that is
actually not the weirdest thing that
came out of this work this is the
weirdest thing and that's why i said
before like none of you guys get any
weird ideas because we had a meeting
with eduardo this went very well and
they were impressed all right so they
use code names so meeting today with a
group from Phoebe so if we go mnemonic
Lee like if be I huh so who could Phoebe
be also in some ways they're OPSEC is
not great because you see here if bi
quietly form secretive need Surveillance
Unit and they've got the link in in
their email so it doesn't it doesn't
really matter that they're using this
code name but so Phoebe whoever that
might be you know they they met with and
it turns out that this meeting was
because of a piece that I wrote I wrote
a pit piece called police story about
hacking teams mobile implants and they
say if anything good came out of the
Citizen lab articles it's that it
brought them to contact us to see if it
was true it was more than they expected
Thank You citizen lab and I was kind of
like what like really am I just doing
free QA for these people right like you
know your reverse is software you look
at it and you're like oh you know there
are four station with its kind of cool
here and they use this kernel driver
here to like hide processes and it's
like really I am anyway so FBI look
certain is like huh
independently verify their promotional
materials that's cool oh I don't know um
so yeah anyway this stuff is kind of
grim so I like to just stick kittens
randomly in my slides but anyway i mean
the the thing is that that you know this
i mean in some ways there it's an
interesting crowd you have a lot of
rescaled software developers and there's
a lot of very skilled software
developers that are actually writing
this type of software and this market is
only increasing all right and and it's
we've seen kind of as a public awareness
of this has risen we've seen a
comparable bait of sort of basically
generally communication privacy tools
and I stuff like silent circle whisper
systems is actually really good if you
don't have signal installed on your
iphone or take secure on your Android
you should just install that what I'm
talking in space out for a second you
know most of you probably have heard of
tour which kind of provides an
anonymization overlay Network for your
traffic but this is actually very
confusing to generally the lay person or
even the not particularly security
interest a technical person because you
don't really know what you're trying to
protect yourself against or what type of
I mean it's not this you know what's a
methodical way of thinking about these
threats all that we know is that there's
powerful people that want to do bad
things and you know software developers
that are doing stuff that I might not do
and making a lot of money doing it so I
thought that what I do actually is I
kind of discuss sort of threat modeling
for these types of attackers so sort of
you know this is this is this is a very
scientific taxonomy a threat that I came
up with on a bar napkin one time and I
will now present it to you in slide 4 so
most of you guys are probably have heard
of Alice and Bob and Eve right you guys
hands everyone else but yeah great so
anyone who's like done five minutes of
reading about cryptography learns about
this right and and and this is
you know so Alice wants to have a
conversation with Bob sends an email to
via their happy mail account and then
you know they have even they might even
have a https log into this happy mail
service and then the email gets sent
clear text across the internet and Eve
is the malicious eavesdropper now for
the purposes of this argument let's
assume that the cost of Eva 0 now Eve
costs a lot of money to instantiate to
set up costs for Eve might be billions
of dollars right because Eva's fiber
taps and internet exchanges Eva's you
know rooms and AT&amp;amp;T Eva's alligator
clips on wires if you've seen the life
of others Eva's the you know state agent
listening to listening to and doggedly
transcribing phone calls but we assume
that Eve is omnipresent and the cost of
listening to you using Eve is very low
sometimes Eva's done its scale I I was
working at Google when this happened
this was the the the GCHQ was actually
harvesting Google's data and that while
it was kind of encrypted between
customer and google it wasn't encrypted
inside the data centers and so what
they're done is had started tapping
Google's leased lines and they had this
very hilarious slide but they had an SSL
added and removed here if you worked at
Google at the time like I did it kind of
felt a little bit like this I thought
they probably didn't really understand
the kind of hot or act by RPC very well
but you know they didn't really need to
so the cost of Eva 0 but Eve is actually
pretty I mean it's cheap for them he was
pretty easy to defeat if you're
installing signal on your phone or you
have then you're already defeating Eve
right you can kind of you can defeat Eve
through the use of basic encryption
software Eve has a pricier mena older
sister that we're going to call Mallory
now Mallory is your malicious active
attacker this diagram was drawn for me
by willow blue
and it actually documents a real-life
scenario for an active attackers so
hacking team actually created this
platform which they call the network
injector which is basically a mechanism
for performing man-in-the-middle attacks
at scale which you can do if you own the
wires and so what it is is it's a rack
that you slap into a data center it
plugs into radius server so you just
look up someone's name it tells you
their IP address state straightaway you
isolate their traffic stream look for
like an HTTP download of a binary or
something like that and then you just
change it and so you just sort of melt
that binary together with your implant
make sure it doesn't miss with the icon
and then you know when someone runs it
on download it'll you know stick the
implant into memory change the binary on
disk so it's simply the original and
then it'll run the original and you'll
get your install or whatever another way
that they were actually doing it because
I mean waiting for people to download
software might be a drag so they would
actually inject things into traffic
streams and one of the things that they
would do is they would inject stuff into
YouTube screens because while YouTube
the log in like the actual screen looked
like it was HTTPS the videos are still
played in clear text so what they would
do is you know this person watching
videos here is your bank of cats at the
other end and the malicious attacker
would wait for the clear too extreme and
then it would tell some of them they
needed to update their fat flash player
which like absolutely every suggestion
to update your flash player on the
Internet is malicious and so I mean
Google actually fixed this I mean it was
kind of one of those things it's sort of
like a generally known vulnerability in
the state of the internet right like
this is just sort of a problem with how
we decided to do transport in the
beginning but of course if you're
running a large service and you discover
that people are actively exploiting this
to attack your users you kind of have to
fix it and Google actually did now I
mean this is this is sort of you know
just an example of what a user gets
right you get the bogus flash player now
how much does this sort of reg cost well
that's did we get eight hundred and
seventy four thousand swiss francs
so let's call it around us 1 million
dollars and that's generally how I mean
obviously you need a piece of paper
which says which allows you to go to an
internet service provider and actually
install it so I mean if I bought this
million dollars then I'm not sure what I
would do with this rack you know I would
inject the hell out of people that use
my guest wireless it's like a butt so I
mean targeted teams are also i mean you
know there's been a lot of discussion on
chinese government hacking this is also
Mallory this is actually a slide in from
an NSA presentation which I thought this
was a little bit underhand that turned
out that the NSA was hoovering up
information on Microsoft crashes so this
is their joke right this actually looks
like a Microsoft crash error report but
I mean this was actually it this was the
this slide was made by the NSA
themselves and it says this information
may be intercepted by a foreign SIGINT
system to gather detailed information
and bitter exploit your machine now they
know that a sense of humor so Mallory
actually costs something right because
someone's got to write the exploit
someone's got to write the software and
it's frequently a team of people this
stuff is written over time if you're
doing this professionally you actually
care a lot about the stability of your
code right like implants generally hook
in a very low level in the operating
system you need to not be crashing and
blue screening stuff all the time right
like you know if people people start
getting you know core dumps and blue
screens and that sort of thing then this
isn't very good and in fact as I said
before if a target is interesting it's
likely to be targeted by more than one
people so maybe you want your back door
to be so stable that it has to operate
with the kernel code of the Russians at
the same time let's also been
maliciously inserted into running kernel
of this machine so this is actually a
really difficult problem when you think
about it so you have something you have
a team of exceptionally skilled low
level engineers and not i mean just cost
money right and you know in a lot of
places this also costs legal approvals
you know like I mean these lawyers who I
mean there's FISA courts you know well
that sort of thing like hey I want to
hack this person / company / thing like
alright let's have a look uh-huh yeah
why oh you know intelligence sounds
great free netflix no you know and so I
mean it cost some money now if some
reason Mallory doesn't work and Mallory
is actually pretty effective in this day
and age Mallory is cheaper than human
intelligence right and a lot more
deniable but then you actually meet this
and then not George Clooney or Brad Pitt
but basically what i mean is kind of
like an ops team right someone that's
going to gain physical access and steal
things it might look more like this and
but but I mean you know this is this is
very effective right if you want to get
intelligence right you know like people
cut through glass I'm actually not an
expert on the scene of things but but
it's it's sort of the human the physical
operation now this this costs money
because it's people to have people
highly trained enough to do this well
and reliably obviously cost a lot of
money to train them there's not
necessarily there a finite resource and
this takes this you know there's a
military chain of command or whatever
all right on these people expect to be
paid and they don't scale but basically
when people talk about raising the cost
of surveillance which comes up a lot in
like sort of modern narrative right what
you want to do is you want to turn even
to Mallory and turn Mallory into a
burglar now I didn't say this a
reasonably smart friend of mine did and
I ended up thinking I was like well sure
I mean the burglar is kind of expensive
all the special ops team and that type
of thing but there's actually someone
that comes after this and it's Jack
Bauer now i don't i'm not actually i've
never actually watched 24 but but Jack
Bauer seems like a really unpleasant guy
from what I can glean like as far as I
know he basically just torches people
for like five seasons like he just ties
people the chairs and just slaps them
repeatedly uh yes sir so Jack Bauer is
kind of my byline for a torture or
someone I mean I guess the the industry
term for this is is rubber hose
cryptography right you know you extract
Kim
materials or other sensitive information
from someone through use of rubber hose
and this is very expensive well I mean
it's good it's very expensive because
you're not really supposed to do it I
mean in order to do this institutionally
you need a black site maybe something in
Abu Ghraib perhaps also if you're found
out doing this it costs you political
cachet which is more than money because
it means that the president of a country
has to stand up on television and say
yeah we tortured some folks you know
we're really sorry and so on and so
forth and that's that's something that
politicians really don't like doing but
this is kind of a useful scale to think
about when we actually talked about in
terms of surveillance it's it's a kind
of and I mean if you want to talk about
a cost-benefit analysis right but these
are these are these are the sort of the
types of actives and now let's actually
talk about like the the players in the
real world that we get right and so this
is the GCHQ I chose to use this humorous
picture that banksy drew outside of a
phone booth and cheltenham this is the
the UK Secret Service everyone knows who
the National Security Agency is this is
the for the illustration the eff uses
the eagle with the holding the phone
lines of the world and its talons but
functionally these are the high end
attackers right so we've got us UK the
five eyes Israel China France and so
forth a friend of mine once described
you have this commonly near when we talk
about a PT which is advanced persistent
threat right the joke he made was was it
advanced Russia persistent China threat
Israel so I mean there's kind of a lot
of the discussion of this type of thing
and the security scene and this is you
know these people they you know they
make artisanal small-batch locally made
homegrown malware because you've got
you've got a lot of developers right i
mean you can you can have a team of 30
40 people writing this stuff over ten
years and then you can have a team of
100 operators and I mean like you know
this the there is a lot of resource
there's a lot of university
there's a lot of skill developers
there's a lot of money and then you've
sort of got this this is this next tier
of countries and what they do is they
buy stuff like hacking team software
like finfisher and they don't
necessarily have the dips to do the the
homegrown bespoke because again remember
you know what I talked about low-level
developers crashing code all that type
of thing like you actually do need
expertise for this and so there's a
commercial market and these vendors they
sell to law enforcement intelligence
agencies and they kind of probably
shouldn't but sometimes they sell for
third-party security companies and this
is the tier of actors that I'd sort of
describe is the pay for tools tier and
then you get this again down another
tier you kind of get cyber mercenaries
and so we actually have seen like a rise
of this type of thing over the last few
years like I'm not sure if you guys
remember a few years ago there was
actually someone online offering route
at MySQL calm for five thousand dollars
less just on some forum it was like wait
what but this companies are one of which
is known as appen they're out of India
Leo impact is another one and basically
these guys will do sort of bespoke jobs
for you and so they they sort of
position themselves as investigators in
the form of ethical hackers and so you
know like those they'll break into
opposing legal counsel during court
cases and steal their data and let you
know what they're doing and all the type
of thing and therefore countries that
really don't have this type of dedicated
program but you know it's worth paying
these people for one-off jobs and then
of course is cybercrime sometimes these
people are very good the definitely
institutional and organized there is
more money and add fraud than there is
in just about anything else in the world
right now and this is the kind of a guy
to get paid contingent right like so I
mean they're not really interested in
particular targets they're just
interested in overall the amount of
money that they make and so all of this
actually the equation for all of these
people is the same right which is the
attacker resources versus of cost versus
how much a target actually is worth to
you and then there's of course the one
type of attacker which I haven't
mentioned yet which is the
the black hat the hacktivists the
personally motivated and I don't it's
difficult playing these types of
attackers because it's not necessarily
sort of the the the logic doesn't really
exist there in the same way so with the
other ones if there's a like cost is too
high to require this target we're going
to ditch with this one never in to
underestimate someone who is cash poor
but time rich and when will they stop we
don't know this person might be pissed
river and but for all reasonable sort of
attackers know what I call methodical
professional or whatever there's a kind
of like you know this business stock
diagram that i have used here you know
efficiency quality cost it's the same
same type of thing you know when you're
making standard business decisions and
they probably have meetings that work in
exactly the same way you know there's a
project manager and it's like okay list
of targets this week percentage of
acquisition you know blah blah blah you
know and and yes spying now means that
you sit in an office with multicolored
bean bags and you have like iminium
things and you know smoothies and
massages and haircuts on site but yeah
so I mean there's this kind of blended
threat cat three categories this isn't
discreet as i see it for instance you
know there's you know i said human was
more expensive but i mean in some cases
you know what is this is this a
replenishing the minibar or is this an
evil made attack on your hotel room you
know yo yo we don't know that this was
actually my hotel room so I mean also
it's not a discrete category of enemies
right because in some cases for instance
say I'm protecting my journalists who
are writing a story about national
security if be I probably wouldn't like
them to know what I'm doing however
Charlie Hebdo style attacks where
terrorists just kill eight journalists
with machine guns in their offices if bi
all of a sudden very good friend so you
know as I said like this is this is
actually sort of a continuous scale but
the concerns are the same for both sides
right so C&amp;amp;E which is
yeah with the institutional actors call
hacking computer network exploitation
it's cheaper than inside a threat or
human intelligence and that type of
thing it's all about sort of leveraging
what you can control as I said you know
these sort of network injectors and
internet exchange and so forth and you
know for both attackers and defenders
you know like if you're if you're
running a company and you have customer
data or you know anything like that like
what's the most cost-effective way to
compromising either compromising that
data or protecting that data you know
just like we talked about before or I
didn't talk about but in the earlier
talk right like you know complexity and
cost isn't always negative if it's
protecting data but then of course you
probably want to balance this with what
you get out of it so give this one size
does not fit all problem and this means
that I've spent a lot of time dealing
with people that are asking me questions
about this type of thing so that's what
kind of the end of the tech tech
taxonomy thing and this is the kind of a
human problem here um seeing people like
well what can I do to protect myself
it's like well against what and what are
you trying to protect this is so like
how can I tell if I'm compromised and
like well yeah again by whom and what do
you think is compromised and then I just
sort of get this like hey I'd really
like you to look at my random device
because I'm a kind of politically
interested person I think that I'm
really important and probably a target
of nation state surveillance and you
know I got after spinning a while sort
of trying to answer these questions
really earnestly and i discovered that
what a lot of people actually really
wanted to hear was there's this app
called Morgan's total security that
works for your iphone you just install
it and everything is sweet because what
they don't I mean they don't want to
hear is like like hmm how do you really
protect yourself it's like well you
should probably hire a top-flight
security seeing team give them invasive
access to all of your data and
communications so they can monitor
everything you do in real life because
if you had a physical threat that's what
you do you'd hire a bunch of burly
special forces people to stand around in
your house right and they're just you
know stand there and look tough and and
it sort of act as a deterrent and
they're also like shoot people if they
got close but it's really invasive and
kind of annoying right so so the same
problem but but but this is what people
actually want right which kind of makes
me a little untere atal shall we say and
as I said you know security engineer
actually not that great with humans
spends a lot of time trying to get
better but yeah it's a learning curve
but but you know the more charitable
side of me actually thinks will might
look this is complicated right and so we
hit the whole like sufficiently
complicated stuff is indistinguishable
from magic just fair okay um so the
analogy that I actually ended up using
with people frequently like sort of how
can we deal with this is like well you
know you you know what happens if you
think that you have some sort of bizarre
disease right like you go to a doctor
and say doc I think I have you know
whooping chills or something and you
know that the doctor sees like well why
do you think this you symptomatic and
you say no and look hmm well have you
been anywhere strange recently like well
no like yeah you're probably finally
well i don't i don't feel fine like I
have money I would like you to do a
battery of invasive tests on me like
okay okay and so they take a lot of your
blood in your urine and your spit and
don't know peace your arm or something
and then and then this gets sent off to
a lab where a really educated lab tech
will take a long time using expensive
tools to look at the stuff and then send
back these results and you'll never
actually meet this lab tech right and
the results take an indeterminate amount
of time to happen and then you can't
really read them when they show up then
the doctor tells you that you're fine
and and I mean this is this is actually
kind of what actually happens but this
is this is an analogy that people
actually understand when they come up to
me and say like hey how do I figure out
if my computer is compromised I'm like
well you know i'd probably take an image
of your memory and then you know
I look for hooking of processes a
process injection I try to see if you
know allocation tables have been
modified in some way you know etc which
of course again you know actually people
want the app they don't want to hear a
discussion about how the lab tests
happen and now yeah so I mean it's been
a while thinking about this problem and
you know I don't I don't actually know
about this assertion that may not be
true because that's not what I'm a
expert that but but but I'm going to
assume that we can't design better
humans right now or humans that are more
resilient to surveillance or or any of
those type of things Oh what I think we
and by we I mean this crowd can do is
design more resilient systems to to this
type of problem and I say this crowd
because the security community is
traditionally really great at designing
unusable systems which is what we've
been doing for years like I mean there
are actually some like really secure
systems it's just nobody uses them and
so it is off it goes back to what I was
talking about before which is corrosion
resistant design right and so the the
axiom that I sort of produce here and
like I mean when I first started
thinking about this I sounded like one
of the paranoid people that puts their
phone in the fridge but you know I think
I think you know sort of general
understanding of this landscape is
better these days and I've I mean I've
spent the last 18 months if you remember
what my actual day job is working on
systems for handling sensitive data
storing it transporting it and sort of
dealing with its you know daily
engagement and so I've been thinking
about corrosion resistant design again a
lot and you know it is possibly obvious
to some of you why this applies to my
day job but you might be thing like war
why does this apply to any of you also
my my assertion actually is that as your
service appt website or whatever
increases in popularity the likelihood
that you will eventually be forced to
coerce your security model becomes
definite right and I say this because
you know you you
you're creating the new wats app you're
creating Netflix you're creating fastly
or Wikipedia or anything like this right
all of that data is appealing literally
all of it I want to be able to see what
wikipedia articles people are reading I
want to be able to see what movies
people are watching you know I
definitely want to be able to see what
people are messaging each other because
I mean I have no idea how many drug
deals are conducted on whatsapp but
there's probably a lot and we've got
have gotten to the point in society
where legal coercion no longer actually
takes the point of simply asking
services for data and I mean as most of
you will be aware there's actually like
a really large political issue about
this right now so I mean there's
actually been a lot of legal demands to
like alter systems and provide key
materials and that sort of thing for a
lot of really large players and I mean
this goes back a long way actually like
this doesn't happen in a vacuum of
course this sort of like the first
crypto Wars which again goes back to the
kind of like safer punk thing in New
Zealand when I was there you know like I
sort of saw this happen and it was like
oh if you actually try to build security
into things than institutional powers
will actually want you to cause these
systems which is when i first started
thinking about this but i mean if if we
know and then we won the first crypto
Wars microsoft right when they first
launched disk encryption the head of
BitLocker engineering said he was asked
multiple times by the FBI to install key
escrow so they could read it lavabit was
Edward Snowden's email provider I mean
he got an order for the secret keys
which would allow them to look at the
email for all of their customers largest
Snowden's email Skype is a really
interesting one because initially the
way they designed it they said look this
skype was this encrypted peer-to-peer
protocol no way we wouldn't know how to
tap this if we tried there was an
internal NSA project called Project
chess basically 24 scape to be
redesigned in order to make it tap a
ball of which of course since has been
bought by microsoft that is actually now
very much so because all of the actual
servers that control it it's no longer
truly peer-to-peer so all the
communication goes through Microsoft
servers any data is interesting
I love this one world of spy craft so
the NSA and CIA spied an online games
the GCHQ which as you know Britain's NSA
has a vigorous effort to exploit game
and virtual environments and produce
exploitation modules an xbox live in
World of Warcraft if you have users and
your services popular then you have data
that is interesting to people now I mean
I'm focusing a lot on the state here
because there's I mean these sort of
documentation and history around this
however you know when I talk about
coercion I actually talked about anyone
that's likely to coerce this data out if
you write like the state has a monopoly
on kind of legitimate coercion of
enterprise but there's a lot of people
that don't really care about legitimacy
you know sort of organized crime and so
on and so forth right that will also be
interested in getting you know data
that's pertinent to them out of out of
people and as I mentioned for instance
at the moment the FBI is in a big fight
with Google Apple and basically anyone
else that in their view that actually is
trying to provide robust privacy
protections to their customers and you
know the the legal aspects of this
actually become very interesting because
it's while the FBI thinks they sort of
you know represent the interests of
government that's not entirely true
because for instance there's certain
standards bodies that are like um we're
the government to and we think this is a
really terrible idea like we really
don't want to force people to engineer
deliberately insecure systems but I
think it actually kind of shows that the
the basic assertion actually sort of
remains true and while you know I've
been kind of aware of while I'm sort of
doing this rant that I might sound like
a crazy person so I'm like oh my god you
should really engineer systems in a way
which assume governmental coercion etc
etc we actually have been building
systems that we think are important like
this for some time so for instance the
DNS redesign that is DNS SEC currently
the way it works is that a minimum of
five of the world's seven key holders
from these different countries would
actually have to converge in the US in
order to subvert the system I mean
that's a whole bunch of people from a
whole bunch of different countries and
this because we decided that DNS was
really cool and really important however
this was kind of in an age
the only things that are really cool and
really important was the network right
and all the services that happened on it
would kind of like I mean people do
stuff and these users but we don't
really care but I actually think that
that's everything now and you know as
it's been pointed out throughout this
conference and Alex said before you know
we're kind of staying to run the world
now so as everything moves online I
think it's actually more and more
important that we design systems with
the duty to our users in mind and I'd
like to finish oh so as i mentioned i
don't i don't think this is actually
that different from the way a lot of
people think right now I mean it's kind
of like designing for failure only with
a little more dystopian future you know
you guys have read cyberpunk novels and
I'd like to actually finish though by
returning to that analogy right leg I
mean currently I think the way security
is applied across the discipline is
actually a lot like Western medicine
right like if you think that there's
something wrong you consult security
people maybe you ask them to review
things maybe you actually ask them sort
of in a response capacity and so forth
and you know this this works great
financially for my industry but I think
sort of less well for sort of security
system design and I mean a sort of ammo
I mean and we there are interesting sort
of forays into more holistic approaches
some of which have been talked about in
this conference like rust and Liang sick
and stuff like this secure pausing but I
think it'll actually come from the
people that are actually designing
systems and creating them rather than
the people that are auditing systems
there was a keynote speaker who didn't
get to be here Kathy Sierra and she also
wasn't at the eff pioneer awards on
Thursday night where I was but she she
sent us this nice note and this is what
I'd like to leave you with which is no
outside help is coming we are all we've
got and thanks to all of you in this
room I am hopeful so thank you that's me
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>