<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>&quot;The Gamma: Programming Tools for Data Journalism&quot; by Tomas Petricek | Coder Coacher - Coaching Coders</title><meta content="&quot;The Gamma: Programming Tools for Data Journalism&quot; by Tomas Petricek - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Strange-Loop/">Strange Loop</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>&quot;The Gamma: Programming Tools for Data Journalism&quot; by Tomas Petricek</b></h2><h5 class="post__date">2015-09-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cYoO2RvZn7Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">there's definitely going to be a few
sharp dogs throughout the strange loop
conference so if you if you're
interested more in the F sharp side then
check out this the strange loop schedule
I'm sure there's talk on Friday that
covers type providers as well but I'm
going to take to be talking about sort
of something slightly different and
that's this project that I've been
working on recently and as any PhD
student who's working on their teases I
spend a lot of time reading unrelated
stuff on the internet in the newspaper
but it was actually useful because
there's this really interesting thing
that's been happening in in the
journalism area recently which some
people call data journalism and so I
just have an example here this is a
title page from the Guardian where they
are saying that the china overtook the
US as the world's largest producer of
carbon emissions this article is
actually quite old it's from 2007 so I'm
just going to click on another one this
one didn't even have any charts on
charts in it so you wouldn't really see
how the how the carbon emission change
is happening but if I can manage to
close this ad no yeah so in economics
they do have a bunch of interesting
visualizations this one this one is the
interesting chart here which shows when
and this is some time in 2007 when china
became larger producer of carbon
emissions than the US and what you can
see today in a lot of a lot of
newspapers is that they're actually
using some publicly available data to
tell interesting things there's a lot of
interesting data sources are the UK and
the u.s. have open government data
initiatives where the government's put
out a lot more data about what's
happening
things like police reports or housing
prices and the journalists are using
this data to tell something really
interesting about the world around you
this is just really a basic chart you
can't do too much with it and some of
them some of them are building more
interactive visualizations where you can
actually add or remove indicators and so
on and as a as a programmer looking at
this I'm always curious about like
what's behind it so for example here
there's there's two things that I think
are sort of missing in what's happening
in the media the first one is
transparency so if you look at the
article it says the China is the biggest
polluter and so they're the most evil
country but is it really is it really
the case what if we look at not the
total amount of carbon emissions
produced but look at carbon emissions
per capita does that change the story
there was another really great
motivation for me to start working on
this which is an I'm from Czech Republic
and the Ministry of Education said that
there's too many people in Czech
Republic going to universities I was
like what and they did have some charts
showing how it's really like dangerously
growing and if you just add another
indicator and compare it to say OECD or
the European Union or the US it's not
really true and this all comes from the
fact that they can show you just some of
the subset of the data but they don't
give you the ability to change it the
other thing is can we actually reproduce
it if we try to do exactly the same
thing do we get the right numbers and
this is something that's important in
science there's a lot of things
happening in in the economy where in
economics where for example the famous
speaker
this recent capital book that received a
lot of criticism because some people
weren't able to reproduce some of it
there's also a fairly well-known paper
on growth in the time of depth where it
turned out that they just incorrectly
copied some parts of Excel spreadsheet
and ended up saying completely opposite
things so and that comes that's that's
something that's really easy to do when
you just copy stuff in Excel spreadsheet
because yeah you can you can easily make
a mistake and that's where I think this
is the data journalism is interesting
because what the data journalists are
doing is that they work with data but
very often the methods they use aren't
super super advanced so in general
what'swhat's data journalism doing the
idea is when there's some interesting
story something interesting happening in
the world they try to get access to some
data about the story or related to the
story they might go to the White House
and use some of the laws and regulations
to actually ask the government for the
data then the government says no we
don't want to give it to you and then
there's a lawsuit and five years later
they do get the data more often if
they're lucky there's some data
available i'll be using the World Bank
as an example which is an international
organization that collects data about
countries and then they turn it into
something relevant to the story some
interactive visualizations that we can
look at and previously I just had an
example with a chart and then if you
have just a chart then yeah you can just
use it use Excel produce a chart or I
was talking with some journalists and
they apparently have a team that draws
the charts in Photoshop to make them
look nice
if you come to this as a programmer or
when I come to it as a programmer I
really don't see just the chart I'm
interested in what's behind it and
that's where all the motivations for
what I'm talking about comes from so can
we actually reproduce it if the if the
visualization is using some open
government data source can we go again
from the data in the source to the
visualization can we get the source code
if you look at the gut after the
economist article they didn't give me
the source code to build the chart which
is very disappointing also where does
the data come from does it come from the
World Bank or is it just some random CSV
someone found on the internet so the key
idea what I'm behind what I want to what
I want to talk about here is if you look
at these data driven articles really you
can see it as a program and you can see
it as a program that you can run and it
produces some visualization but when you
see it as a program there's a lot of
things that we can do with programs as
well so I want to start with a quick
demo and i'll show you an example of
what i was working on um so this is an
example that looks at carbon emissions
let me make it a bit smaller and when
you come to the page it looks just like
a normal newspaper article with some
text and there's a little chart and this
chart here is showing carbon emissions
per country as a total so you can see
that if we are here we are looking at
2010 and China is the biggest producer
of carbon emissions and then we can look
at the other at the other countries we
have a table
showing the total numbers and there's
another chart this one I think is quite
interesting it shows if you take China
US and India they're together are
producing roughly half of the world's
carbon emissions so that's the first
example and what you see when you come
to the page is some sort of view of the
program so the the source for this is
really just some text and some source
code and I'll show that in a second when
you come to the page you see the
journalists story so what the
journalists are doing is that they have
some story to say and they're helping us
understand or they try to sort of put
the things in a context so you still
want to start with what they have to say
but then you can modify the parameters
and maybe see something that isn't
entirely of this or maybe even find
something that's actually missed in the
story and I want to let the users who
can deal with some code actually see the
code as well so let me show you how this
looks if I go here there's um and the
projector does actually show it the gray
is sometimes invisible so there's this
options button and this gives you some
options for the visualization and this
is still something that some of the some
of the better data journalism articles
have where we can change some parameters
so for example we can have a look at the
data for let's say 1980 and this is
interesting there's actually data for
the East former Eastern Bloc is not
available but we can see that in 80's us
was producing more carbon emissions than
than China the other thing I can do here
is to look at different indicators so we
can actually have a look at the carbon
emissions per capita rather than the
total and the other interesting thing
that's happening here is that you can
see on the on the right there's the
panel with some metadata and this is
actually all generated automatically
from the data source so here I'm using
data from the World Bank and they have
lots of indicators about different
countries about climate change and so on
and this is importing all the data so
let's have a look at emissions per
capita and here again the picture looks
a lot different I think there's some of
the really small countries in the in
this area have like really large carbon
emissions per capita and then China who
was really read on the previous picture
isn't the death threat anymore so this
is what you get as a user and I ain't I
intentionally started from the sort of
really simple things so this is the kind
of interactions that anyone coming to
the website can do but what I'm really
interested in is the program behind it
so what's behind this is and um as was
mentioned before this is using the F
sharp language but the key idea is just
a simple functional programming language
that has this idea called type providers
how many people have heard type
providers before the introduction to
this talk yeah good so now everybody
everybody knows type providers are
awesome i'll see i'll show you why but
there's a couple of things in the
language and let me actually just show
you the code first so um when i click on
the source here i'll make it bigger
although it might mess up the charts
we'll see
so the hardest thing in the first
example was picking the right colors so
that's what's happening on the first
three lines but then this bit is saying
this is my this is my datasource and
this is where type providers come in so
if i delete this and actually start
typing it offers me completion so this
is something that programmers are really
used to in at least in statically typed
languages and F sharp takes it a bit
further so I can do by year and then it
offers me the years that are available
and the years here and they're actually
coming from the World Bank so this asks
the World Bank what years do you have
and World Bank says I have all these
years we can pick one year and then
again it asks the World Bank what are
the categories of indicators so i can
take climate change and then i can
continue here and choose some indicator
so let's have a look for example at
something different electric power
consumption and the thing that didn't
fit but maybe it will fit if I if I make
it a bit smaller let's try again is that
you still get the get the information
with the metadata so the exactly same
thing that I was using before in the
really simple end user mode where I was
just picking things in drop down it's
actually coming from the program behind
it so what's happening here is that the
type provider mechanism is integrating
external data into the language and it
generates these types that have all
these properties and the properties have
some documentation attached to them
which is also provided from the World
Bank and that's what I can that's what I
can access here if I look at something
else so let's say this one
here the source code does a little bit
of calculation so we are taking we get
all right we get for every country we
get the number we sort it and then we
take the first we skip the first six and
some the rest which generates this
purple bit and we take the first six and
add the rest to it so this is something
where if I look at the options that's
actually not exposed here but I can go
to the source code and make some more
changes and I did want to say a few
things here so what's behind it is that
we are using really simple functional
thing functional programming style to do
the transformations like skip they do
some mapping and so on but I think if
you take the like functional programming
has this horrible reputation of being
really complicated and being about endo
functors but if you just take the core
good parts of it that is really simple
we are relying on the static typing
which gives us this nice editor support
and I'm not sure if that's the only way
to do it but it works pretty well and
it's using the type provider mechanism
to integrate the external data into the
language now I was only showing you the
article as it looks when you render it
but if you want to see the source code
it's actually just a markdown page that
github can render I could show you the
raw source if you want it as just text
with some code so that's where when I
was saying there's no magic behind it it
really is just text and a few smaller
snippets of code and I think that's
really important because
you want to see how the whole thing is
created especially if it's supposed to
be reproducible and transparent so
there's some interesting things in the
technology behind it I think the first
one is the World Bank data source so the
type provider mechanism is fairly
general and you could you could
integrate a lots of different data
sources into the into the system I just
haven't the one sample i have done is
the World Bank and the World Bank has
this three-dimensional cube where they
have information for different countries
they have lots of different indicators
and they have it for different years and
when we were accessing it here we did
some slicing through the space so we
picked the year let's say 2010 then we
pick an indicator like carbon emissions
and we get a single line or slice from
the data set which is some sort of
series that for every country gives you
a different number so that's what was
happening here and the the system has
the other slicing where you say give me
the data for specific country and
indicator and you get the time series or
you could continue and actually slice it
by all the three and get just a single
value single number and what's that
what's interesting with the type
providers is that they give you a way to
map these more interesting more
structured spaces into the programming
environment so a lot of the
visualization tools they're just built
on top of spreadsheets where spreadsheet
is really just a two-dimensional table
and that's it but if you look at things
like the open government data sources it
really has much richer structure and I
think that's where the type providers
are interesting because you can
transform the Richer structure into
something that fits in the programming
world
and the World Bank I provider just does
two different slicing of the space so
you start with the world which is just
the top level object and that exposes
the data by country or by year where you
can pick a country or pick a year and
then it gives you access to all the
leaves which are the indicators and for
convenience because there's thousands of
them they're actually grouped in
different categories so if I if I went
back here and rather than looking at
climate change if I choose all
indicators this will either crush my
browser or never complete yeah that's
will probably never complete because the
World Bank exposes something hey
something like thousands different
indicators so I'm going to hold page
down lot arrow down just to show you
what's there and you can access all of
this in a nicely nice programmatic way
ah yeah I don't even know what it means
seconder that this makes sense so you
can met these external external data
sources into a nice programming
environment the other thing that I find
really interesting is when I was showing
the example with the options give you
the nice drop downs this is again not
something that the that the journalists
have to specify explicitly I think it
would be useful to have an option to
control it but at the moment that's all
automatically generated and the way it
works is that because the article is a
program we can look at the program and
do some simple analysis so when I was
showing the drop-down that really just
looks at codes with this sort of
structure a pattern where I'm accessing
one of members of some object so here
climate change
returns some object which has a lot of
properties or members and one of them is
carbon emissions and a lot of these
members have the same type so they're a
series that map string to a float and
when the when the editor finds this
pattern it will give you an option to
choose one of these members because
putting replacing one of replacing co2
emissions with anything else of the same
type will not break the code so we can
safely do it and it's 11 pattern that we
are detecting so if I let's let's do it
here if I go to source and options I
have the carbon emissions down here if I
choose something else this actually
edits the source code so the drop down
is just projection from part of the
source code that can then push the
changes back into the code the other one
is when I have lists of these so that's
a right right at the end of the article
there's another whoo let me refresh this
that's not that's not what's supposed to
be there as you can tell but it really
likes to be there well that's the that's
the fun with live demos if it doesn't
work then I'll just pretend you you did
see another nice example I might need
the internet as well yeah anyway there's
there's another I'll show it if it loads
so the other the other interesting thing
that I was I had in the in the article
was comparison of different countries
and how the values change over time hey
there it is so here I just explicitly
picked some countries I picked China
India
pan russia and us to show you a
comparison so this is the same with just
china and us it's the same chart that
economists had and you can see China
overtaking the US here around two
thousand five but as a reader I always
wanted to add more countries and see if
see for example how czech republic is
doing in comparison and so there's this
other editor here which is generated
when you have a list of things so i have
a list of countries i want to compare
and generate it editor if we replace
russia and add czech republic instead
then I can it changes the source code so
you can see that the changes life if we
refresh it will see that Czech Republic
isn't producing too much carbon
emissions so I think that's just two of
the interesting things you can do
there's I think a lot of potential for
other things like when you have
numerical constants that fall in some
range we can just use the normal
programming language tricks to figure
out what's the range and let give the
user some sort of bar for for picking
the value and that all comes from the
idea of just treating the article or the
report as a as a program so I'll just
say a few things about possible ideas I
actually think the first the first thing
and this is relating to the lunch
discussion we had with Sean the first
interesting problem here is that people
don't really see this as a as a
programming language research so if i
say future directions i think what we
what we need is more of a method for for
looking at these kind of programming
experiences as a research problem if I
was doing this talk at ICF p or any
other functional programming conference
I would say we need to formalize it and
we need some proofs but I don't actually
think that that's what matters here so I
have a few ideas for other interesting
things you could do with this and the
basic structure that the reports are
using is really inspired by literate
programming which I don't think there's
been much work on that since since Coon
came up since Newt came up with the term
so for example when you're writing a
report where in the text you're showing
some number you say carbon emissions of
the u.s. is this number of billions
that's not really telling user very much
but if it was connected to the data
source the web page could show you how
does this compare to other countries or
how has it been changing just based on
the fact that we know where the data is
coming from and in programming languages
this is what all the provenance research
or context-aware programming research
was doing and I really think data
journalism eizan is an interesting area
where a lot of it could be used the
other interesting problem is the World
Bank mapping that into the Thai provider
is fairly easy because it's really just
a three-dimensional cube but if you look
at the open government data sources they
tend to be really complicated and fairly
messy and some governments think that
good format for open data is PDF which
if which turns out to be really
impossible to to scrape but met being
able to map the whole open government
data into a type system I think that so
that's a fun problem and also a lot of
the visualizations i was showing our
kind of primitive i was using google
charts but there's probably a
lot more that the that the people
working on things like reactive
programming could actually bring to this
nice interactive visualization world all
right so that's pretty much all I wanted
to say I'm really looking for people who
would be interested in playing with this
using this so I don't suspect there's
many journalists in the room but if
you're working on some internal
reporting you could use pretty much the
same ideas but just rather than mapping
the World Bank and climate change
information you can put your internal
database with customers and sales into
the programming language and build some
really interesting visualizations that
let the readers interact and you can
actually trust them so the few things in
summary i think there's this really
important theme which is the general
information literacy because there's so
much data that you can you can access
these days and making some sense out of
it is really hard so that's where i
think my motivation for this kind of
work comes from the one key thing that i
think makes this all nice possible is
treating the article as a program and i
think having nice programming
environment that actually lets people
without too much programming skills do
some fun things that's the future of
usable programming thank
and I think we have five minutes for
questions yeah the question is why did
it why did why it didn't show the
category in the options so in the source
code why I don't have a drop down for
this so that's actually because if i
change the category if I just
substituted the category then I could
probably break the program because the
other categories wouldn't have the co2
emissions more technically it's because
when I do dot here when I do dot and it
doesn't automatically complete the 1i
have there before all these all these
things all these fields have different
type so education has type education
category and it's different than energy
and mining which has a type energy and
mining category so here I'm choosing
between multiple properties but they all
have the same type it's like if I had
customer and they had name age address I
can't just switch one of these because
it wouldn't fit with the rest of the
program but I did actually want to have
like a specific editor for to level two
level field access because the structure
with category dot something seems to be
fairly useful so yeah that's that's one
thing that would make sense to add but
as it is it's only doing when you have
one filled out of several that have
exactly the same type yeah
yeah we're yeah that's really good
question so where are the where are the
values and where are the properties
actually set up and configured because
that's something that wasn't in my nice
clean source code so there's there's a
you can have a look at the code if you
want later but there's another part of
the project which implements the type
provider for the World Bank and that's a
piece of F sharp code that defines how
to generate these types so that's a
piece of code that looks at the world
bank calls their API and asks what are
all the what are all the indicators you
have what are all the countries you have
and then it generates some F sharp types
that are then exposed in the editor so
the matting part is where I think the
journalists will need some help from
programmers the the building of the
reports on top of the data sources once
we have the mapping for them that's the
nicely usable part
so the question is if F sharp yeah
because I've sharp is a statically typed
language the gen does the generation
have to be done explicitly and the
answer is sort of so for what what I get
here is like just one specific data
source so I have a nice type provider
for World Bank which gives you this
really easy and friendly way of calling
it I do have another type provider which
is fairly general and works with any
Jason based data source and what that
does is that you just point it at the
sample response from some service and it
will infer the types from the central
response and then it gives u dot based
nice programming style based on that
sample Jason response so that works with
any Jason based source it can met any
Jason based service into the programming
environment it isn't as beautiful as
this one but you still get older older a
lot of the experience I think there's
yeah that's another area where there's
probably a lot more that could be done
because there's also sort of general
base linked data sources which have some
structure around them that could be
mapped in a fairly general reusable way
into the language other questions
oh why is it the gamma haha it's a it's
a programming language theory joke
because although all the programming
language theoreticians have this typing
judgment where you say in a context
program he has a type tao and all the
programming language theoreticians
always say initially the context is
empty there's nothing but really what
you have initially in the context is
this projection from everything you have
in the world into the context so the pie
here is the sort of type provider and
that's why it's the gamma but if it ever
gets commercially successful I'll have
to come up with some better explanation
yeah yeah yeah I think so the comment
was I say that the article is a program
but really in my example is text and
some code I think I would like it to be
the case that the article is really the
program I just don't have that much in
the text part yet but i think it's it's
potentially interesting to see how the
two could be more closely intertwined
one thing you could imagine is if you
come to the same article in the future
and the values changes it actually
adapts some parts of the text and then
the text would be more mixed with the
code where if you say had some sort of
conditionals in the text and so on or
embedding of values into the text so I
think there's more that could be done to
actually have that have that slogan be
true but yeah in the current version
it's not going that far</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>