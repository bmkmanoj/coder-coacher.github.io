<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# WPF UI Tutorials: 02 - TreeViews and Value Converters | Coder Coacher - Coaching Coders</title><meta content="C# WPF UI Tutorials: 02 - TreeViews and Value Converters - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# WPF UI Tutorials: 02 - TreeViews and Value Converters</b></h2><h5 class="post__date">2017-01-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6OwyNiLPDNw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so carried on from the first WPF
tutorial turns out a lot of you really
like this the WPF side of things so
we're going to try and do quite a few
more videos on WPF before we do any
others now this video we're going to go
through previews which are a collection
so previously we've done stack panels
grids and you know single items there's
another type of item in WPF and it's
anything that's a collection anything
that's like bound to a list or an
unknown length of items and so for
example when I was trying to think of
what to do here's a perfect example
so folders should you go into you know
your documents and then into another
folder this this list is an unknown size
so we're going to create sort of this
side of the folder Explorer for now it's
a good example to get started with some
basics of collection view and then we're
going to use value converters which
you'll come to use a lot more in WPF
it's going to be a really basic way of
using them again and that's going to be
to select whether the items a drive or a
folder or a file and show a different
picture and that's really what we're
going to do for this next application
just want to talk a little bit about the
upcoming things so we can't go much
further into WPF without hitting on like
view models just because the way that
WPF is naturally designed to work is
with view models and it's a good thing
anyway it's something you should get
into it's just our feel we haven't
really covered enough to move into view
models but it can be quite complicated
and understanding more so the reason why
you're doing it is going to be the
difficult things so we're going to have
to cover them in the next video anyway
but you're going to get to the stage
where you might not fully understand why
we're using view models initially like
the benefit of them because it's it will
look like a lot more work than just
creating and setting text box values and
and things like that from the initial
stages of where we are but as you
develop a full application in future
videos that the purpose and the benefit
of view models will come about
afterwards so just bear that in mind
when we touch on view models and then
also with a lot of what we're doing it's
going to be a lot of reusable code a lot
of logic and a lot of helper classes
that we want to start using going
forward we want to create this nice
library so I'm creating something called
the DNA framework which is going to be a
completely cross-platform code base that
will work on Mac Linux Windows Android
iPhone you know the whole works of all
modern devices and we'll start using
this in the next videos I'm creating it
on the videos so again you'll see the
benefit in the next videos and then to
try and get you excited the ultimate
goal now of these videos as we're going
to recreate a real application that's
actually live in the store right now on
the windows android and iOS doors and
take a quick look so one of the
companies are on school Fassett oh and
this is the app that's currently on the
store it's sort of a combination of
friends contacts files and chat so you
can you know use it like that the
problem with it is this was made
originally many years ago and process
there was a cloud storage mechanism then
it turned into more robust file storage
then we had good friends then contacts
then an auto uploader then it shot then
a health system it got really cumbersome
and the original back-end database and
servers just weren't designed for being
used the way they are now so this has
got quite slow so I'm going to remake
this entire application and we're going
to do it on these videos we're going to
do the chat application so got a new
product that's coming out with link
which is going to take over the files so
we're going to recreate this chat
application in these videos so not this
very first one but after this video
we're going to basically head towards
making this full-blown application
including the website the database the
backend the Android and iOS apps
the complete works we're going to build
this entire up so it's nice and fast
that's what's to come
so let's get straight back into the WPF
so quick recap we're going to make this
File Explorer thing here so new project
WPF up I'm calling it previews and value
converters so it's on this folder so
just call it WPF preview for now and
then here's the basic window so the
first thing we want in here is a tree
view we're going to grid let's just
quickly change the store stat panel just
so I can show you what it's going to
look like after when we come to do
something in a short while so just make
a tree view give it a name call it
folder view and then that's really able
to make the tree view and we can use
that as is but what you'll get when you
add items to this is just plain text
just like a normal strings written on
the screen for each item
whereas we want to display an icon and
the text so there's many ways in WPF to
accomplish the same task and that still
goes for each individual item in the
tree view there's also many ways to add
the items to the tree view so this isn't
the only way to do it but this is one
that we'll show you
so again aimed at just the equipment for
now so if you do TrueView resources
that's going to add we're going to add a
style that's just local to this control
itself and that style is going to
override the items we add to it so make
the style target type is going to
restrict what this is going to run on
you know what the Styles didn't apply to
and then you'll see we get some kind of
a really strange syntax here so these
are curly brackets basically dropped
down to instead of being in this is a
more normal text way just typing things
it drops back into more of behind code
behind something analyzes these code
files you do the special tag X which is
here and that's going to tell it to be
part of the sam'l
Stiles and then there's a special type
inside of the axe which you've got type
static reference and not so definitely
too much about it but that's basically
what you do when you want to specify a
type and then this is a natural type so
preview item if you went into like
code-behind
I'm sorry view item you can see it's a
class so it's finding this preview item
which is what we're going to add to each
the tree view is going to contain a list
of preview items so this little earth
style here is effectively saying for
this control only because of the
resources are inside the control and
only when the item is a type of tree
view item because inside the tree view
you can actually add multiple different
types of icing it could a preview items
you could have combo boxes you could
have buttons you have a completely
custom view so this is saying only if
it's a tree view item which we don't
really need in ours because we're only
adding tree view items but it's is good
practice to to make sure that what
you're styling is the type of thing you
expecting to style and then before we
actually make this style let's show you
what we want it to look like so go to
the stack panel and we just want to make
again with ones where are we we want an
icon and text so from the last video you
should remember you you break down the
view and it's effectively a stack panel
horizontal because we've got you know a
single item that's just the size we want
it to be and then another item so let's
just make it here so you can visibly see
what's going on so we've got a stack
panel orientation horizontal and I think
that's it for last and then inside that
we also need to add the images now so
I've gone ahead and just made a few
images so right-click on the project
add folder call it images right click
the add existing items and I'll just
dump them here for now
include these and we've got to drive
which is like that you know a natural
drive got a file either a folder open
and a folder closed which I only use the
folder closed for now add in mother go
and look further so we've got some
images to use here the first thing we'd
want for an item is going to be an image
we want the source and again this is
just so you can visibly see what's going
to happen it's not going to be the
actual exact code we use but there's an
image you can see it's one huge so we
just want to restrict the size so on
like say with 20 that's fine
we've put multiple ones of these and we
just remove that a second just so you
can try and get an idea for them showing
it see there's no gap between these two
so when we come to stock preview items
down you're going to have this
non-existent gap so it's just add a
margin as well we want the margin to be
all around we'll do say like three just
gives it a little bit of a gap that's
all we need for the image this path will
have to change based on you know the
type of file or dibble after and then we
just want the text we use a text block
and we want the text to be some fold and
remember this is just visually as an
example now you can see this is up it's
aligned vertically to the top we want
this to be nice and central based on the
image so that's really easy just do
where it alignment center and that goes
there and that's really it's as simple
as that there's a lot of stackpanel
can quite easily represent an item in
here
so that's what we want to then use per
item you know put preview acting so for
every one we add let's just shrink this
down slightly and then we're just going
to cut the stack panel let's can go back
to a grid
and then inside the style now so the
very style of a treeview item we need to
edit the degrees of data data templates
now setup proxy first so in a style you
can set something so the thing we want
to set is the header template I think on
a treeview item so yeah so a treeview
item for the most part just other you
know a header and some content which is
going to override the header and then
we're just going to set the header the
headers basically as a default preview
item is just a string just a plain piece
of text so we're going to override that
template and then instead of the value
being in an attribute which is just
going to be an actual full style if you
set the dot value now inside here we're
finally at the point where we're going
to set the actual content the direct
content that's going to be inside each
header template that needs to be the
data template which is artists the type
of this value the header template is
expecting a data template and again that
this is all fairly standard when you're
overriding template so this whole thing
all the way here is basically saying
whatever content ends up in here there's
a little bit here we don't care about
all this really what ends up here is
going to override this items content of
view of the actual WPF is going to
appear as a content so although this
looks like a lot of steps going down
this is fairly standard this is
hard-coded you've got the treeview item
and then you've got a header template
then we go to the code behind again we
did for T equal new three view item I
needed T and you can see that a header
template so you can see all the code and
you can see it's expecting a data
template so that's how you can sort of
see what's going on you can even click
on the header and see get your sets the
item that labels the control so it's
basically like a label by default so all
we're doing there is getting a treeview
item if the true your items in the list
getting the header template and then
replacing it
and just paste your stackpanel into this
product what we didn't close that up
oh all my air cut and paste design bit
strange there and there we go so that's
now inside so if we run this now which
we can do and we will just to show you
the list starting we need to when the
program opens we're going to pull in it
this the logical drives to start with so
in the window we did this in the last
video to do loaded press ENTER then
press tab to create the new window
loaded and then the code behind here
we're going to get we just do directly
let's just clean up this class a little
bit first so that this is going to be
unloaded and the application first opens
so when we load and again bear in mind
this this program now is really this is
not what you take commercial which is
just a quick one of you know proving how
to do something
so you want to normally just get the
window to load and directly add values
and things that is just to get you
familiar with a tree view and then after
this video and we move on to the the
main chat application everything's going
to start being exactly as it will be in
a final application so this is a little
bit of a quick way of doing things just
to again get you familiar with the
concepts of what we're trying to do so
when it's open so we just press f5 first
let's make sure this actually opens and
runs there you go you find you've got a
plain window you can see there's a
little gray border all the way around
just about seed between the blue stuff
inside the blue and you can see it along
there that's the actual preview itself
it's got no items in
so we're just going to do directory dot
get logical drives which is a helper in
the.net framework retrieves the names of
the logical drives on this computer for
example drive letter colon backslash so
we'll get the logical drives and then
for each of those
it's going to let me do that and I'll
forego those on an array okay let's just
a drop back to a for each seven for now
so for each drive in logical drives we
want to create a new preview item and
then for that item we want to add it to
our folder view the tree view so alright
start ad and then we can actually run
that and what we should see straight
away is just a list of items with there
we go can already see our default start
panel three drives and so we've got
three logical drives which we know we
have and we've already got the icon a
p.m. for a drive and the text which is
quite nice so we just stop that so now
we need to fill it out with some
information so we over the header
template so we want to set the items
header so I do not have it equals and
I'm going to just set it to the drive
and that's going to give us or is not
going to give us oh yeah that would give
us the value so what we've got to do now
is replace this hard coded text so we're
going to do a binding now so in WPF
instead of it being like hard text this
is an item so this is a treeview item
it's this item here by default the
context the thing that you're bind to in
terms of you know accessing data from in
here it's going to be the item itself so
we're inside I had a template so we just
want to buy into the actual header
itself which we've set
here and because it's a string if we
bind the text directly to that it's
literally going to convert it straight
back to a string so in order to were
binding you do the curly brackets we
type binding now this is the simplest
possible type of binding so we're not
specifying anything we're literally just
seen it so binding and what that does it
defaults the binding to the location of
the data context of the item which is
the header and the header itself is just
string so effectively you just bind unit
directly to the head of itself so again
we'll do more complicated binding bust
with this this is one of the key things
to WPF is you'll spend almost all of
your time in WPF learning bindings value
converters and the structure of like
templates and things they're really the
three key things and binding is one of
the massive parts of WPF but luckily
this is a simple introduction just so
you can understand that when you say
binding because we're a header template
so this template it's value it data
comes from the header itself of the item
and because we've set the header here to
this value the text now in that block
should show the drive letter what you
now does so you can see that it's got
the drive letter we also need so if you
imagine you start with a drive letter
and we're going to expand down and we're
going to go from say the c drive and
then we're going to go into say
freescale and then we're going to win
KDF so when you get to say this point as
we're clicking these items we need to
know the full path we need to know to
get the folders inside the full path
it's no good just having a name and
right now the header is just going to be
set to the name as we go so we also need
to set the full path as well as the name
again a more appropriate way to have
done this was to probably create a deep
not a tree view item but to create a new
class that contains the information we
need and binding to that but again for
quickness we can actually do this just
with a tree view item because we have an
extra thing called the tag and this tag
is let's just object roads install any
information we like
so the tag in this instance is still the
drive because that's still the full pass
but when we come to do the other items
you'll see that will become the full
path and the head will just become the
name of the folder or the file and then
you'll also see we run this we don't
have any expand icon here to actually
try and get into the drives and that's
because by default the treeview knows
there's no items inside so it's not even
giving us an option to show the expand a
quick trick to get that on first let's
go back and comment some of this every
scene and drink a new ice and forests
set the header from path to the main
tree view so here we just do the item
itself which is the current say C Drive
if M itself has also got inner items
because a tree view just keeps going
down and down if we just add an item and
literally add nothing just a banal add a
dummy an item and then we run this you
see we get the expand icon now and then
we've got a dummy no item and the reason
this is then shown and I kind of know
text is because as we said every single
item we have will override and get the
stack panel the images of right now to
set as a drive and the text is bound to
the header which in an ORM is is not so
you just gain a nothing appearing but
that isn't the purpose of of this we
added the null acting just so we can get
the expand then when we expand we're
going to listen out for that event and
instead of just showing that we're going
to remove that item we're going to
actually find all the files and folders
in this drive then we're going to add
them to the list so let's just do that
next so that's the logical drive stone
then we want to go below here and we
want to first check out on the preview
itself we need to listen out for when
the items
but expanded so we do that with what we
can do is if we were data binding we
could do it a different way but because
we've hard-coded the item here set drive
add dummy items so I'm just going it
explicitly out to the event
so let's announce for item being
expanded nice items that expanded we'll
call this folder expanded that's going
to listen out whenever the folder tries
to expand which is what we wanted and
then in this we first want to get the
item itself so we want to get this
preview item the sender of the folder
expanded as the treeview item so it's
going to be the item subscribe preview
item and the sender so this will get the
actual this item now we want to check
because you could expand and collapse
and if once you're done it more than
once this might not contain dummy day
two it might contain the real data
in which case you could either refresh
again anyway or you could just ignore so
we're going to ignore for now we're only
going to replace it once when it's
expanded just for quickness I guess so
it doesn't wipe out all the inner
previews as we go so every item only
contains these dummy data and to define
that we check of the items count as one
because we've only added one item in
this instance and there are items first
item is no that's how we're going to
detect that we've got that dummy item in
there so in fact you want to reverse
this logic so if the items count isn't
equal to one or the item is until two
norm and again you use reverse logic as
much as possible so that you don't end
up with if it's inside of it's inside of
its and then you decode halfway over the
screen so basically if the items isn't
people to want or if it is equal to one
and it's not null so just the opposite
logic then we ignore
so this ever returns here it's because
the Johnny Gator isn't gay and we've
already done something otherwise we get
to here so we get to here the first
thing we want to do is remove the dummy
data so just clear the items off so
clear dummy data and then we want to get
the folder name so by default it's going
to be this tag so folder name equals
item dot tag and we know it's a string
because we're setting it so we just cast
up for Strings
and now we want to get every folder
that's inside of this folder in fact
this is not the fault line I'm sorry the
tag is going to be the full path so get
the header from the full path and again
you'll see this being set in a min when
we do a recursive loop now that should
be full path is the tags
now we want to find every folder first
so we want to add folders and then files
so for every four directory paths skin
and we use the helper to get directories
now the thing you've got to be careful
with here plus the default path is that
this call to get directories can throw
if you see the exceptions on authorized
exception path to long in out exit
there's a lot of ways this can fail so
we don't want it to crash the
application if we go and get a folder we
just want to say for now we just want to
ignore it so this is really bad practice
in most places you almost never ever
want to just do a try-catch like this
because that basically wraps any
possible problem here and any problem
that happens just gets ignored so let's
at least try to mitigate this slightly
let's just do for directories it through
equals now we'll just do a new list of
strings and then in the try-catch only
will do directories equals and then if
we have any directories then we add it
to the main list above so all's we've
done there is inside a try-catch only
done a single call but we want to
basically catch and ignore so the user
doesn't have permission to the windows
system folder then this would crash and
in that case we just basically catch it
here do nothing and carry on so all it
means is that folder won't appear in the
list but like I say this this try-catch
thing that so many developers do as well
is a really really really bad practice
is this so few cases where you just want
to try and catch and basically ignore
every possible issue that could happen
so instead of doing a try catching them
writing the whole code inside this and
adding it to the list just because we
were expecting this to possibly fail you
could end up failing inside the logic of
adding it to the tree view and then
something else is failing and what that
result in is just nothing appearing in
your applique
and no errors to the user to just
presume everything's okay when it's not
so rarely do this but in this instance
we want to create a blank list try and
get the directories from the folder
ignoring any issues doing so so then
once we've done that we possibly got the
directories we want to learn iterate
over all the directories and we're going
to do directories path and then for each
directory we now want to add this
directory to this icon so we want to add
over the directories to by item itself
so we want to create Alcala so by them
as new preview item and in fact we can
clean this up slightly so when you
create a new tree of your item and then
you go ahead and set values like this it
doesn't quite look as obvious that you
set in the item you have to loop here
that you're doing things to it so when
you're setting properties directly on
the item you can just do it get rid of
the semicolon to do your curly brackets
and then just move the values inside and
you change the semicolons to just
commerce and get rid of the item because
you're in the item and that's another
way of setting the properties of you
know any class at the thing so you
create it that'll call the constructor
and then after the Constructors run
within setting the values and that just
makes it a little bit more obvious that
you're setting the header of the item
and the tag of the item and then things
like this items dot add you can do
afterwards because it's you know other
think things like adding to lists and
things are appropriate inside this
constructor that's more of doing
something afterwards but you could
technically put all this inside what I
do that when you you know
in properties usually to values it just
looks cleaner so we'll do that here as
well so for the silver item create the
sub item and then we want to set the
header and then we need we're going to
have now a directory path so this is
going to be a AC Drive freescale KD s so
this directory path say we're at the
point of we click the freescale item and
and we found the KD s folder now this
directory path is going to be the full
path it's going to be this and then as
you go into another folder they're going
to be this so your directory path is
going to be a full item you want to make
sure you get that we want this pair the
last bit the name to show up in the list
the last item so you can do directory
dot and I say path dot get directory
name from the directory path and that
will get the directory name to complain
about now we've got well windows is
added there our visual studio is added
all these unused namespaces we don't
need so I shouldn't complain now really
we're still using window shades paths we
using windows shapes for nothing right
there we go so I was complaining because
you've got a system dot in our parking
but a windows change paths but I just
removed the using up here that was in
there for some reason for the windows
shapes with we don't need if you did
need it then you could just type you
know system to i/o dot path to get
directly to it so that's going to get
the directory name from the directory
paths and set it to the header and then
as we mentioned now the tags which is
the thing we then look for every time
you expand something we get the tag here
we need that to be the full path in
order for the sket directories to work
so every time we're going into a folder
we need to know the full path to get the
folders inside of that so the head is
just the name of the folder like in this
case doc and then the tag is going to be
the entire
path so the tag is just going to equal
the directory path itself so create
directory item set header as folder name
and type asphalt path and then we want
to then do the same thing with s we need
the items to have a single dummy item so
add dummy item so we can expand the
folder and not start and then we also
want to listen out for the expanding
events again so so that and expand these
plus equals and then it's going to be
this function again so it's going to be
one did we call it folder expanded so
that even when the Shabbat and the call
that comes back into this weaker C will
function if you all the same function
that handles every item so that will
handle the expanding out and then we
need to add this item now to the parent
which is here so whatever item expanded
as we need to now add the sub item to so
arts and items that add sub item so add
this folder or add this item to the
parent and that's it with that alone now
when we run this and we click expand so
let's put a breakpoint and we'll go
through it press f5 and yeah those
modules when donor so this is wrong
you've got the expand when a click
expand and we should hit this folder
expanded which we do we're going to get
the sender which you'll see is the tree
view item with the head of C drive with
the single dummy item so we went down to
items
my vitamins there we go and you expand
the items as a single item and that's
the the dummy in all item we've got so
the items tab doesn't equal to one which
it is and the first item isn't deeper
than all which it is so we carry on it's
going to clear the items out it's going
to remove that dummy item it's going to
tag on that item which is the C Drive
because in their main logical drives the
tag is it's the same thing it's just the
master drive then I'm going to create
the blank directories we're going to ask
for all the folders inside of the C
Drive just the first level not you know
consecutively recursively down that
succeeds we get 20 folders this is all
the folders in my C Drive that's cool we
add them to the range and then for each
one of those directories we're going to
link to it's a sub item where in this
case the first one is recycle bin we're
going to get the directory name of the
recycle bin which should just be
recycled in it should remove the C Drive
and the tag should stay the same so the
sub item now has to go and check the
header so the head is the C Drive which
is wrong in that case so it's got the
eye doesn't basically handle the
directory switch so I'll write a helper
function to fix that in a moment and
then the tag is obviously the full path
which we know and it's going to add the
item it's going to listen out quickly
expand it and it's going to add it to
the main list so let's run that and
you're going to now see that this is
effectively going to just show a lotus
he drives but you can see it's showing
for each item so let's go ahead and fix
this directory name so we'll make a
little helper for this one because path
dot and get directory I haven't really
worked let's call this get file folder
name and this is going to be a helper
out here we'll make it public static so
that anyone can use it for now get a
file folder name
in the past from the point of this is
going to be find the file or folder name
from my full path the full path so what
we want is if we have C Drive :
something go on folder and we also have
say file dot PNG what we're looking for
for this function to return each time is
this last part so the very last part of
you know the the backslash if you will
so the first thing we want to do is make
sure path has something so if string dot
is normal empty path and just return an
empty string because there's nothing we
can do so so we have no past detain
empty then we also want to in some cases
so again thinking more cross-platform
wise so if you've running on Linux or
Mac these might be forward slashes even
if you're running on the web or your
data comes from somewhere else or for
any reason sometimes you'll find that
back slashes and forward slashes very
commonly get mixed up and cross used so
we want this function to be able to
handle that so we'll call this
normalized path what's going to equal
path and then we're going to replace
anything in the past what miss gets
going to replace any forward slash in
the path we're going to basically turn
it all into back slashes and you can't
do a single back slash because that's a
special character so you put two and the
two back slash just means one because
that's the special character to escape
things like putting tabs and and things
like that we turn lines a new line so
when you do a double backslash that's as
a single character and the fact that you
got a single quote here instead of a
double quote ie usually do means that
this is a character a single character
not a double so you can't put more than
one character in these single quotes
because a single quote
your character so we're just going to
replace every forward slash with a back
slash so make all slashes back slashes
so now we know we're working with only
back slashes regardless and then you
want to get the last index in terms of
what we're talking about here than the
index of the string so there's the
string it's say twenty characters longer
something index zero is here one is here
two is here three is here we've covered
this in one of the very first c-sharp
videos so the index is the position in
the string we want the last index of the
last position of the backslash so
basically we want to find the last
backslash in the string you know the one
furthest to the right
everything after that's going to be a
folder or file name the last index is
the normalized path dot and there's a
helper function last index off and we
just want to do the backslash so find
the last backslash and the path oops
last index or anyone lost index of
backslash and then we want to make sure
we've actually got a backslash because
one of these might be say just file file
and there's no backslash we don't want
to this would then be ten minus one so
we don't find anything it doesn't state
there but in just when you try it you'll
find out that if he doesn't find an
index of a backslash so it doesn't find
it in here this is going to be minus one
so we want to check for that if we
basically don't know where we can't find
a folder we're just going to presume
that the whole string itself is the file
or the folder so if we don't find a
backslash concern the path itself so
I've left index less than or equal to
zero even because zero would be the full
path anyway then just return the path
itself otherwise we've now got an index
we now now save this position because
it's family for us so now we just need
to return the string after that
backslash
that's a case of we can return
normalized now what we turn the path now
because we want to return the original
structure not the normalized path we
don't want to change the input together
so they import forward slash here we
correct it ejected like a backslash just
so we can find a backslash but we want
to return that's a bad example out so it
makes no difference because you're not
returning anything with a back slash
forward slash so you can return the path
or the normalized path makes no
difference
you want the substring of the path and
then you want to start it at the last
index which is the position of the last
backslash which is here then you want to
jump one forward so you don't include
the backslash that's everything after
that so the last index plus one and
that's it so returned the name after the
last back flush I'm going to leave that
little comment there so this should take
like the C Drive and the whole thing and
find just the folder name for us so
we've replaced that with the helper
let's press f5 and see if that's done
the job don't need to step over anymore
we'll just look and there we can see
we've now got the folder names so let's
fix these eyes on the next well no I
tell you what because that'll be more
complicated let's add the files now as
well so where have I got some files D
Drive link cache cache thumbnails large
so you see there's no it's not showing
anything in here because we're not
retaining files just folders up a minute
so what that so in there unloaded how we
aren't in the unloaded this is now move
this out of this region all that x1 did
so in this folder expanded we got the
item we do all that we find the
directories and we add the directory so
this whole code code here
it's almost copy and paste a box let's
just put a region for this again quite
large get directories and the region
it's got a new region get files but
let's go out get folders then collapse
the get folders get the files and this
can be Jim Mitchell is or initial checks
so you can also use regions as you see
inside of functions when the functions
get quite large you can tidy them up
with regions as well I mean just makes
it easier to to navigate the function
you could also expand this and better
practice I guess would be to make these
functions themselves to get files and
folders but again keeping it simple for
now so we just copy and pasted the
directories change it to a list of files
and try to get the files from the folder
so di ours was cool I've got files ours
call it FS for files and then the
directory I think you do get files yep
and then we'll add it to the files list
and stairs so all the same logic so
we'll try and get the files now instead
of the folders and then for the files we
want to control our are and what we name
is valuable so that it we named these
two folders as well let's scroll this
file path so for each file get file item
survived I'm set the header as file name
now we've already made this helper
function to get file folder name that
will effectively just get the last part
of the path so that will still work for
a file or a folder that's why we called
it get file folder name you know file on
a folder let's still call
have backslashes in so if it's you know
after the last backslash you know it's
the file or the folder name so this
exact code will still work so set the
head as a file name set the tag as a
full name then up the item at the
dormant item so we can expand we don't
need because this is a file you can't
expand the file any further that's that
is what it is so let's remove that let's
now click expanding actually don't let
snellie to expand in either obviously
because we can't expand it we're going
to add the item so the files is a little
bit easier you get the files you create
the item you set the header in the tag
and you're addict that's it so press f5
even we should now have the whole thing
so D Drive thumbnails large things
you've got for males and these are
pictures so we want to just replace
these icons now with a few of the
pre-made one so I've made a drive I've
made a file I've made a folder we'll use
the folder closed so we go back into the
W third zamel now you'll see the source
of the images just the drive directly
now there's a little thing here where
you're setting the source and you just
passing in a string now you might think
you could just pass in a string you can
change this to images Drive or images
file or images folder close you can't do
that directly because by default in
zamel if you set the source here as a
string zamel actually converts this to a
different thing it converts it to like a
bitmap image so it takes you from a
string and makes a bitmap image for us
so now we're going to replace this and
settied directly we can't just set a
string we're going to have to make a
bitmap image ourselves which is not
overly complicated so this is now going
to take you into the realms of value
converters so in WPF you want to keep
the bindings simple you want to bind to
something and it'd be the value you
don't want to have to start say buying
into a string and then try to convert it
to an image here you want your set it to
that strings and then just have a
converter that takes any string and
converts it to an image
and another point of a value converter
or like so you bind the stack panel to a
property of binding here and you want
this panel to be invisible when the
string is not so then you could bind to
you could bind the visibility property
with your binding and you don't need to
set the password it's the actual thing
and you can then just shut a converter
and you could set the converter to be
something that is called today string to
visibility because the Villa Bisbee is
any numerator I believe of hidden or
visible so you could then convert a
string to a visibility property and
that's be a you know simple use again
we'll cover these a lot more in the next
videos so don't expect to fully get this
but this is a nice intro so you can see
what happens before we delve into you
know the harder stuff so before we try
and bind it let's first make the value
converter so that you can see what it
looks like I'm just gonna comment it
there when I fold it as expanded time T
sub folders files that function dawn
what's the unload it done this is a
region just general helpers for now
that's nice and tidy so I just make will
just put it in we'll make new plus and
plus I will go this habitat image
converter
now a value converter needs to be static
because there's only one instance of it
actually now that's not true
doesn't need to be static you can create
instances but the way I'm going to use
it again for quick messes I'm going to
make a static version of it so we can
find it nice and easily so you make a
class you call it whatever you want
convention usually states that you end
it with the word converter and then it's
an a value converter control dot dot to
include the namespace that you need just
remove all these others that we don't
need then you can see we need to
override some properties so control dot
enter and that will give us the values
so a value converts has two things you
can convert to something so in this case
you can convert from the string to the
image that we want so the head of string
into the image and then you can also try
and convert back if you like you can try
and take an image and convert it back to
the original string now in most cases
most value converters only go one way
and that's the same here we're not going
to support converting an image back to a
string which don't need to anyway so we
just need to focus on this function so
I'll just say convert a full path to do
a specific image type of a drive folder
or file so that's the point of this is
to take the full path and then figure
out whether it's a drive a folder or a
file so we first need to get the value
so when we bind this source here we're
going to actually pass in a binding of
the full path so I start with the
binding at least we won't do it fully
let's do the binding there and then we
want what we want me to get there
full path don't Lee in fact the bindings
in a bigger area the bone is going to be
a header so we need to find let's just
do the binding so by default this
binding is going to be the header of the
treeview item well we don't want the
header we need to tag and if you look at
the toad and we created them get files
get folders so I see here of a folder we
create a tree view item we set the
header to just the name of the folder
and the tag here well we've got the
header right now were inside the header
so we can't get the tag because that's
that's part of the parent acting the
tree view item and we've only got the
header so in this binding mat now with a
header we need to step up we can't
become like just find anything the
binding only work in words so we need to
do a special kind of binding which I'll
say we need to start by stepping up the
tree we need to get back to we want the
tree view item we want to bind to that
so we can access the tree view item so
for the binding to do that you need to
have a relative source the relative
source is equal to and then more curly
brackets and its relative source again
strangely but this is to define the
relative source we want the mode to be
find ancestor we might even be able to
use template good parent but I choose
find answers to what's basically step up
the tree so we want the ancestor and the
ancestor type wants to be again the X
type oklahomans and the curly bracket
there's a lot of clearly brackets when
you do binding the title of preview icon
let's try and break this down to be a
bit more visible here so got an image
got a width got a margin so the source
here and so
let's go looks a bit wrong just trying
to make this breakdown on more line so
it's easier to see so so of that I guess
so you've got the source which is the
binding but we should put that on the
line below there we go
you've got the binding inside the
binding you've got a relative source and
inside the relative source we're going
to struggling to try and make this look
correct I'll do so you got the binding
of the image that binding wants to be of
a relative source the relative source is
find ancestor and you want to find the
treeview so again this that's what's
really messy and likely it is for the
most part it's something you have to get
used to in double ups as this whole
defining code in lots of curly brackets
and equals and X tight it's not a very
pleasant way of doing it but once you
get used to it you just get used to
doing it in these for the most part
there's there's so many ways of doing
the bindings and then once you know them
you just get used to them but again just
thinking on what this does you're
setting the source of the image so
you're trying to find an image
specifically you're trying to bind to
something which right now is the header
and instead we're going to say we want
the source of the binding and set it to
be the header you want it to be relative
to this item you want to find an
ancestor which means step up and you
want to step up until you find a
treeview item so what this binding here
is going to do is turn the binding of
the source into binding to the treeview
item directly and then from that
treeview item now we've got the relative
source there so let's just put that back
on the on line now you can see that so
the relative source has been found
now
so the relative source we've got now we
want the path which is effectively
saying preview item dot and now what you
want to get and it's the tag so now the
path can be anything that's you see
their property part so it's anything
inside their preview acting that's our
property and we want to get the tag so
now this is going to get the treeview
item and then it's going to find the tag
so this source to the image is now going
to be a string and it's going to be the
tag which is the full path because we
set the full path here so we're now
going to get the directory path inside
this binding and again that'll have set
the images of string if we just run this
let's just let's just comment this out a
second some 99% sure this won't work
like this you can't find a string today
you can see you've got nothing for their
items but it shows that this binding is
in operation now it's trying to get
something and it's getting the tag so
now we need to convert the string and in
fact you can prove that as well and we
need to see what's going on you could
cut this out and paste it into the text
so instead of seeing the image you can
then have a look at what the text box
says and you're going to see now this is
what we're binding the image to you can
see that each one is the full path which
is what we want so that's where you can
see you know the full path so you know
you're binding to the full path so now
we need to convert this strings to the
bitmap image that we were seeing so
we've got the whole path and now as well
as the path you can specify a conversa
and now the converter needs to find
again there's many ways you can find a
converter you can do a resources and
then do it by key or we're just going to
make a static instance here so that we
can just find it so we need to get
public static added to image converter
call it instance and this is going to be
a new instant to the conversion so we're
just going to create an instance of this
converter and it's static so that we you
know there's a single instance we can
access it directly that's just it's a
new object for now just source can
compile just build that in fact that
unknown because we didn't finish the
sam'l another converter we can set again
curly brackets as always
X : and then you do static and you
should be able to do we need to get into
the namespace of our headers converter
so the namespace it's in is here WPF
preview we've set up the namespace here
as local a special name so in the static
we can specify local : and now it's
going to jump to our application it
doesn't look like it's smart enough to
find it so let's just make sure that
when you doing this new in a converter
that is trying to find the converter so
we can add an attribute here called
value conversion so it knows it's a
value converter we can even go as far as
to do type of source is going to be a
string and the target type is going to
be type are Denmark image and so on
and now that should find this header to
image converter might need to compile
first for let's see yeah so let's just
remove the converter for a moment
receiver can compile and this should
make it so that just delete this image a
second
it should make it so we can find the
easiness that's not going to play ball
at a moment but usually when you flag it
with like a value conversion this should
find this class so we can do that start
instance because you know that's where
it is so we've explicitly said it's in
the local namespace which is this one
it's called this class and it's the
class dot instance because it's static
so it's the same as doing it in code
behind it's the same as going WPF tree
view dot header image converter instance
so effectively setting it to this so the
converts has been set that way again I
know this is a confusing way of doing
things but this just as WPF that's
something you just stick up and get used
to and just bear in mind that again most
of your time will be spent trying to
figure out why a path doesn't work you
know binding isn't word you know or
converter isn't working because all of
these you know things that are brand new
to most seizure of developers they don't
tend to do this type of really confusing
zamel but we'll take it slowly and in
the next videos will you know we'll
delve into a lot more depth on bindings
because I said a big part of it so we've
set the path which we've tested by
putting their source as the text block
we know that's now the full path to
their the you know the file all the
folds that we're looking at and then
we're now we're going to pass the data
into this converter which we've created
here that we can then now return a
bitmap image so we just put a breakpoint
here as the first step and let's check
that we're actually getting passed in
the values and that for each item so we
press f5 you can see now we're hitting
the converter the value you can see is a
string of C the next one is the a next
one is e and that's it so the the
converter is working it's been told the
information so we expand we should now
get the other four paths yeah so C
recycle C quick so we're getting the
full path of each file and we're now
trying to set the source of that image
so instead of
converting that now let's just set an
image back off so you want to get the
path first which we've just seen is the
value that's the full path we want to
check every path is known because we
can't do much of the path is known so so
just return nothing so we're going to
have an image of the path personal
because we can't tell what it is and
then we want to get the well when I was
trying to Street in a bitmap image so
it's a new bitmap image this is
expecting a URI so into new URI and now
we need to pass any URI to the image now
our image is here by default when you
write an image and it's a resource again
another kind of quirk to WPF something
you'll just get used to is to access say
this folder because you can't just pass
back URI and let's just prove we can't
in case things change so images drive
dot PNG things PNG see if that works
notice that's crashing invalid URI so
you can't just go ahead and pass in you
know an image as if it's just there
because this is a resource so it's
embedded in the application if you will
we need to specify and again this is a
very hard coded fixed thing and you do
with tasks which is the package call on
two forward slashes application colon
comma comma comma and then your path
which starts with a forward slash so
this lets bit here even though it looks
weird is basically a way of accessing
the way that WPS compiles the
application and it puts their resources
into packages and you want the
application packages again something you
don't really need to know you just need
to
understand that if you want to access
resources in WPF as you are eyes this is
the special string that you use and then
you just use the normal folder so we
return this we should access the images
drive and now we go back to accessing
the same icon so now what we want to do
is replace this only so let's put that
out put in let's call it image and now
specify the image by default we want it
to be so we don't know what it is a
volley of the logics fail we're going to
presume it to file so we're going to do
images file PNG by default we presume an
image and then now all you need to do is
replace the nice-looking string with you
know what we expect we're in this
project we want to replace the image
with so we want to detect if we've got a
drive so I've got the name as well which
will be useful which is B we put that
helper function in main window for now
get file folder named path so this will
get is just the name of the item by
default we get an image and then we want
to do some logic check now so to find
the drive we know if we got the file
folder name
no--don't the name we want B we'll do we
the name is going to be yet the name
it's going to another name is going to
be blank
let's try kami in fact let's just break
point here
Coop's so see what we're working with
so at first the pastor see the name is
blank yes this is the only tricky thing
is detecting the the path so I think if
the only time file folder name to get
the you know the name of a folder the
only time it's ever going to return
blank like this is in the case of if
it's a a drive or a blank string which
will never pass in so I think we're safe
to assume if we get sort of common this
so the only impact yeah we don't need to
enter in there so if the name is blank
resume tips to drive as we cannot have a
blank file or folder name so we're sort
of process of elimination here which is
good enough for this example so if
string got is normal empty and name
number a drive we want to set the image
to let me choose Drive dot PNG so we've
got a file by default so we don't need
to find a file we're doing this to find
the drive so the only other thing left
now is if it's not a drive to check if
it's a folder so in C show up the check
of like a full path as a folder so this
path here as a folder you can just you
need to first create a new file info and
they need to pass in the string and then
there's dust and I think it's
attributes one as it actually is the
house flag that's it so we'll check if
the attribute has file attributes stock
directory okay so this basically checks
if this path is a directory so file info
get things like file size last modified
date you can just press dot and have a
loop creation time last modified date if
it exists the full name the file
extension all this information about the
file usually what you see when you
right-click on a file and click
properties and then the attributes are
as you'll see here again whether it's a
file a folder an archive read-only
system file
I think hidden as well as usual in here
yeah so you know a few attributes one of
those is whether it's a directory or not
so we're saying of this path and the
attributes contains a directory we know
it's a folder so we get that we want to
show the to the folder closed PNG so
this now we press s5 and run this again
so the first three should be drives so
you got the path with C Drive the name
comes out null so we default to a file
but then we find out that the name is
null so we replace it with a drive so
the image becomes images Drive and then
we're going to return the drive image
that'll happen for all three just good
now the next one shouldn't be drives so
we've got the path of C recycle bin so
the get file folder name should return
the recycle bin which it does so now
it's not blank so this ignores so now
we're going to check if C Drive
directory C Drive recycle bin is a
directory which is so we return closed
and then we folder closed
so that's finally in folders and then
everything else that it doesn't find
there is not a directory it's going to
end up being a file so we run that and
you can see now we've got files folders
and we've got files which match the C
Drive so we go to C Drive you can see
recycle bins hidden as well so you could
go that further step and make this semi
transparent you can do like a 50%
opacity if it's a heading folder but we
just did like view head and we can see
that so you can't even see that we're
actually finding things that the hidden
isn't showing so we should be able to
access that though with tasking in the
exact name which cycles dot bin and
there you can access that folder so
we're actually finding folders that even
you know the Explorer isn't showing
which is quite cool there's quite a lot
of them not showing so those you fold us
and that's that's almost it really
that's the whole thing done so now we
expand things you can see it can browse
and you can find files and you know
that's the tree view in itself with
icons for specific types so you know
that's quite cool so hopefully this was
a nice introduction to tree views it's
complicated enough that we've done we've
done an image converter which hopefully
understand fairly basically we we get
given a full path we find out whether
it's we determine whether it's a file or
folder or drive and then we return the
images from these folders to set the
source of this image here we showed you
how to create this first before it's in
our list and then the text of it is just
centered and it binds to the header
itself
so hopefully that's all come together
quite nicely and it was easy not to
understand we can go through this a lot
more we could add more but like I say
the next thing we really need to do is
is to start doing viewmodel binding
because if you look at your code now
then this is the this is the code behind
the view so this is a sam'l code and
we've got a lot of logic well we've got
all the logic here what we're getting
folders with when we expand the folder
someone physically looks like in a UI
element with them running some code and
then we're affecting other code but then
actually adding to the actual folder
view in the actual you know another UI
element here so this is very this code
and the larger give you all your
in your logic is very hardwired to your
view so now let's say we wanted to
convert this application to a windows
forms application or a web application
it's going to be a little and then
imagine of this is also a lot more
complicated and you've got say 10,000
lines of code in here
this is very hard coded to this view you
come to change this view and go to a
windows forms application you can't just
move this code you can up the court and
paste there so you can have to change
the folder view to that access that
windows forms UI this event won't be the
same it won't have a rooted event so
this whole functional change so what
you're going to end up doing is costing
and pasting and moving and repeating all
your code it becomes completely
unmanageable so the point of view models
is to get away from this putting your
code or you know the purpose of your
software in your application instead of
it being hard tied to a very specific UI
because this could be moved to multiple
duis it could go to phones it could go
to you know an Android and iOS could go
to anything the put interview models in
short is to separate the code behind so
your actual physical code that does
stuff from the view so obviously this
code when you're expanding your drives
needs to link to a UI but instead of
actually doing it here and physically
linking to the UI and physically looking
out for events and things we make a view
model and that's still a c-sharp class
but it's like the bridge between the
view and this data so it's like an
intermediate it's sort of an adapter if
you will or like a a connector where we
start bridging the gap between these
pieces of information and then these
type of attachments so we'll go over
that in the next video and we'll take
this exact code now you see now it's
been done by hand if you will by just
manual events and physically just
finding things and we'll convert this
exact project into a view model project
so you can see the difference and you'll
also see then how much cleaner it
becomes and how much easier the UI
starts to look in terms of you know how
it works I mean these bindings won't
change much
but still it'll it'll look a lot nicer
than mess so hopefully that was a useful
video and you can actually carry on and
expand this you could you can have it so
say when you double-click the file it
actually opens up an explorer so we
double click this it runs or you get up
so you can right-click an item and open
the fold of all you know you can do what
you like you can just think on this you
can even go to the extremes of adding
another panel here so this splits off
into a grid with 1/3 and 2/3 on this
side becomes this view which could be
another tree view which could be showing
differently so when you're clicking here
it's showing the folders here similar to
you know for this so you can feel free
to expand on this and play but that
should be enough to get you some very
basics into collection views and value
converters so I'll try to this next
video in the next day or so I know
everybody's very keen on the WPF and
will take this project and will clean it
off form or do view models and then
we'll get started on the chat
application which is going to be a very
long set of videos going to go over
months no doubt but you'll learn so much
from it so we're going to start working
towards you know a real application so I
hope you enjoyed this</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>