<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# SolidWorks API Tutorial - 03 SolidDNA Custom Properties, Materials, Mass | Coder Coacher - Coaching Coders</title><meta content="C# SolidWorks API Tutorial - 03 SolidDNA Custom Properties, Materials, Mass - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>C# SolidWorks API Tutorial - 03 SolidDNA Custom Properties, Materials, Mass</b></h2><h5 class="post__date">2016-12-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fayvSkUapKE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so carrying on from the last video we
start to get into the solid DNA
framework you'll find the get whole Bri
PO you've got these files they go into
tutorials the last one we did was the
solid DNA WPF add-in I simply copy and
pasted that renamed it to coastal
properties and then rename the folder
inside custom properties and then
renamed from inside Visual Studio R then
rename this solution by pressing f2 and
giving it a new name and the same for
the solid DNA WPF R then I just pressed
f2 and renamed that went ahead and
renamed these files then I right-click
on the project and click properties and
to application and I change the assembly
name and the default name space and in
the assembly info I change the title and
product so this is a quick way of
cloning the previous tutorial and simply
getting the exact same tutorial just
with a new name so you can leave it as
the old name if you don't want to do
that but that's that's what I've done to
get to this step then I simply rename
the old zamel file so if we go to WPF it
was called my adding control I've gone
ahead and just renamed the inside Visual
Studio again just pressing f2 and giving
this the new name custom properties UI
then I go into the code behind glass
here and then you'll see this class this
will be called WPF add-in press ctrl or
R so hold ctrl and press the letter R
twice and it highlights green and then
you can go ahead and type a new name so
this was like my that we get add in or
something so you just rename that to
whatever name you want again you don't
have to do that but that's that's all
I've done to get the project to where it
is now from the last video so if you
want to follow along exactly you can do
those steps or you can simply
just get this project from github and
you can see the completed version that
gives us this Amal now I made a video
before this one on WPF making this exact
WPF light out so if you haven't seen it
already just go to my YouTube channel
and you'll see the last video with a WPF
the basics that will go through creating
this exact screen you see here so you'll
get this exact board a stack panel all
all of what you see here has been
explained in the last video so just go
ahead and watch that video if you want
to understand creating this so we're at
the stage now where we've got a a UI
ready to work with what we need this to
do we've got a little screen shot so
we've gone apply reset and refresh
button the apply wants to go ahead and
save all these properties to their part
the reset wants to clear all these
properties and make them blank and the
Refresh wants to read back in from the
pot so wants to read out the custom
properties here and the material and the
mass and then for each one I've just
made a little description here what we
expect to happen so the description
field you want it to be from a custom
property called description you want to
be able to read the normal value not a
fully evaluated one and you want to be
able to write the property back status
revision part number you want to read
the fully result the evaluated custom
property and you don't want to be able
to write back the material wants to be a
list of all materials and you want to be
able to select one and click apply to
save the material to the part these
checkboxes are still just a custom
practical manufacturing information but
this time if we selected multiple it
would then create a new custom property
with each name like this plasma comma
fold comma weld so just whatever is
checked will become a string with commas
separating the string and then when you
read it back in you want to do the same
thing you want to read in this string
separated by commas and then check the
boxes that need jacking
and the rest is all the same custom
properties and then read the mass here
so that's the point of of this whole
form and what we want it to do its
effectively reading and writing custom
properties for the most part with a
little addition they're reading the mass
and a drop down for reading and writing
the material so let's get started on
this so I can close this down now well
I'll leave it open for reference so
we've got the UI as I mentioned we made
in the previous video we want to do a
slight tweak on this so the first thing
I thought after I made that video is
this will really only work on parts so
yes you sat in custom properties and
reading maths which you can get from an
assembly but the the point of this
anyway in the requirement from the
customer was that this is to run on
parts only not drawings or assemblies so
what we want to do is create a little
screen here that overlays or just simply
shows and this mean stack panel hides
when something except apart is open so
this is really easy so go into your
border so we're inside the little
padding border and we're going to stack
panel right now let's just cook that
inside of a grid and this is a good way
because a grid will just have one column
one row by default so now the stack
panel is in column zero row zero we're
just going to create another stack panel
we're going to give this one a name so
that we can hide and show it call this
main content and we'll call this one no
part content
oh yeah imaginative name at the moment
let's just hide this main panel so we
can see what it's going to look like and
then in the stack panel and put a text
block with the text please
please open apart I want that to be
horizontally Center we want to be
vertically centering the whole stack
panel so it's in the center and then
let's add an image to this so you'll see
here I've got a part PNG
also good to get that was right-click
add existing item and then I created
this PNG file and then the important
part is make sure the build action down
here is set the resource once you've
done that it's a simple case of going
inside the stack panel type in image and
then the source is just going to be the
name of the file part PNG because it's
not inside of a subfolder it's in the
root it's just part PNG you'll see this
is a bit oversized so let's do max width
of 100 say and there's a nice little
screen that you'll see when you've got a
say drawing or assembly open or nothing
open at all it's a hint to open a part I
will just put a margin around this image
now we're going just bases off the text
a little bit so now we've got a
stackpanel
and we also got another stack panel and
because this is a grid if I get rid of
that visibility you can see one is on
top of the other because it's a grid
fills the whole space and by default
there's only one column and one rail
both of these go on the same column rail
which is what we want but obviously we
want to hide the part the police open
part when apart to open and show the
main screen and we want to flip it
around there any other instance so we
need to just hide this for a while we
hide that there so when we're working on
it we can see this and we don't get
annoyed by constantly seeing this but by
default when we open the add-in we don't
want this screen to be shown by default
we want it to be shown here by default
so we can see what we're doing but when
it's actually loaded and opened we don't
want it so in the user control here we
just go down and type loaded press ENTER
and then tab it will create a new event
in the code-behind class which you can
press f7 when you're in here to get to
the code behind or you can just expand
this zamel and double click this CSV
file you can see the loaded that it's
added here I also made a note here of
what we did so we copied the previous
tutorial files and rename them we also
change the references of the side works
dll's I noticed I've done that wrong in
the last video so we just go over to
here references
select all the solid works and drop and
just make sure this embed in crop types
is set to false I believe it was true in
the last video by mistake and then we
created a screen for when the part isn't
open which is what we've just done when
we include in an image as a resource so
we've just done those steps
we've now added a methods that gets
fired once their screens fully loaded
and the first thing we want to do as
mentioned is to show this no part
content screen and hide this main
content so we want to show this and hide
this so when we load it we just do this
dot no part content dot visibility
equals visible and this dot main content
dot visible is hidden by default show
the no part open screen and now we want
to hook into the solid DNA framework the
main thing we care about is when the
active file has changed because that's
what we're keeping track of whatever the
current model open is it's as simple as
DNA dot application dot active model
information changed and that's in the
event that gets fired by solid DNA
whenever that effectively the active
model has changed or anything about that
information has changed so that's what
we want to hook into and then once we've
done that the first thing we'll do is
check of this is a part and if it is
will do will read the information and if
it isn't then we'll show the other
screen so let's create a function we'll
call it read details so we can just read
the information and do what we want with
it comment the previous classes first
find when the control is fully loaded
the active SolidWorks model has changed
and reads all the details from the
active SolidWorks model so we've got
them there the other thing we want to do
before we get started too much as we
want to make a note of all these
specific names these custom property are
par named so let's just scroll to the
top go into private members and we're
going to make a load of private constant
strings and custom property and then
it's going to have a specific name but
we'll leave that off a second
we'll make a blank like this and we just
copy and paste a load and then we'll go
back to the top will make description
which is called description
status status and you'll see that is
just where I'm getting them from here
that's a list I've made and this is come
from the customer that's requiring this
so we've got reversion
and there's all the properties we need
so now we can reference these when we
come to to need them so we've got it
loaded we show the know part open we
hide the main content we then what's now
for the active model changing and then
when every changes rerun this function
called read details and then in here the
first thing we need to do is we need to
jump on to the UI thread because we're
going to be changing the UI you know
we're going to be loading things into
these text boxes so to do that you can
only change a UI when you're on what's
called the UI thread
and by default this because it's an
event that's been fired from here which
got fired from the DNR application this
isn't necessarily going to be the UI
thread so to be sure we call thread
helpers dot run on UI thread and then
like a function so open and close the
brackets like that but it's asking for
an action the thing we want to actually
do you know that the code we want to run
on the UI thread so to start it you just
do another open and close of parentheses
equals greater than press Enter squiggly
and then close squiggly and that's what
it looks like that's how yeah you do
this run on UI thread and now everything
inside here is going to be code just as
if you were here writing code but now
inside here you'll be guaranteed you're
running on the UI thread
which is what we need so this is going
to get fired whenever the active models
changed so the first thing we want to do
is get the active model we want to then
query what that new model is so create a
new variable called model do you need a
application to active model will get you
the active part assembly drawing
whatever it is and it'll be of time
model which is a solid DNA
class so yeah the active model now as
you mentioned previously the customer
only wants this to work on parts so not
drawings or assemblies this could also
be no model it could this gets fired
even when everything's closed because
effectively the active model has changed
its changed to nothing so we need to
check for one of this has even got a
model open and then we also want to
check if that's a part if it's null or
if it doesn't depart then we want to do
this again we want to show the no part
screen so we'll copy that and then we'll
do the check will do if modeled are so
if model is no or if not model is part
so effectively if the model isn't a part
so this is checking if we have no model
or the model is not a part show the no
part screen return so as mentioned we'll
paste this which is the show no part
screen and then we just return we don't
want to go any further otherwise if we
get past this if it means that we've got
a part so we've got a part we then want
to show the content we want to do the
opposite of this so if we got here we
have part
and I'm going to show the main content
so simply flip these around that becomes
hidden this becomes visible and that's
enough to actually test now so let's go
and press f5 and run this and let's see
if a bare minimum our form shows up it
shows the no part and then when we
create a part it goes visible so there's
our screen you can see the nice little
layer please open a part I con we go and
open a part that I've started messing
with and you can see there's the screen
it's then hidden the other icon and
showing the main screen we close the
part it should also go back which it
does and then we could even create a new
part which so still show and that's
created drawing from that part
let's just open an existing part and you
should see when we get it drawing
it shows please open a part if we close
the drawing and then we've got a part
open and it shows here so it seems like
that's working fine now we've got the
screen only appears when we've got a
part open which is what we want so the
next thing we want to do is read the
information so as well as when the part
opens when a new part appears we want to
read we got this refresh button and that
also wants to do the same thing so we'll
link that button in at the same time and
then we'll start reading the information
so let's go and do that
so we already monitor for the active
model changing here which calls read
details let's go ahead and just put that
refresh button in while we're here so
click the button at highlights here type
click press enter down and tab to create
a new event handler we'll just rename it
from button click to read button click
go to the code-behind and rename it
there as well
calls run the read button is flipped
can't type today read what did we call
it read details
go ahead and move these into the region
botany vents to keep things clean that's
just really startup and this is model
events trying to keep everything nice
and tidy
minimize that so we've got the model
we've checked it isn't Nolen it as a
part we've shown the right screen now we
want to start reading some content so
most of it is such close this down most
of its custom properties letters to all
the custom properties first and for the
most part they're all just reading so
these are reading evaluated the read
only z' and everything else is just
reading the regular so again with solid
DNA it's really simple just type model
dot custom properties and then you'll
open and close your brackets again just
like before equals greater than squiggly
squiggly and finish off so again the
exact same appearance but this time is
going to give us properties so we type
properties in those parentheses this is
now a list of all properties of the part
so inside here we can now access all the
custom properties that's in the current
model and we can also set them so the
first thing we want to do this is we we
all custom properties and now we want to
get the description
we want to set the description text and
the text of that so you go to the forum
you followed the last video you'll see
this text box here has called
description text so that's what we're
doing will gain that description text
then we're saying the actual text of
that box equals and then we just want to
query this properties because this is
all of them in the pot so we do
properties dot first or default which
will basically look for the first item
that it finds that matches this query
that will write inside here and returns
it so f is just you can call this
anything this is just a lambda
expression and I typically just start
them with F but you can call them
whatever you call it property if you
like so it's more obvious and you want
to find the property with the name
description so there's the name so we
want to do string dot equals because we
want to compare two strings we want to
compare this custom property description
the name that we said it's going to be
so we want to compare of the word
description is equal to the property
name and then we also want to put a
third check in which is an invariant
kulcha ignore case which just means
it'll ignore upper and lowercase
characters so it will match if it says
description with their capital D tour
match if it's with a lower D the match
of the C's got an uppercase so it it
just basically ignores the
capitalization the casing of the
characters so we're going to look at all
the properties going to find the first
one or nothing of the rezident one that
matches the name description so you're
rejecting the property name once we get
that because it might be null we'll do a
question mark so that it won't continue
this expression if it's not got a value
but if it has got a value you do dot and
you want the value
so that is how you will read the
property description and get its value
so if you want to see that again
slightly more broken down you could do
this first which would be for
description property equals properties
the first or default of the property
where the name equals description and
then you get a custom property and that
might be null and then you could do the
check if it's not null or you could just
type in here custom property on the
space description property and the
question mark just means don't continue
after the question mark of its null so
if it's null it will return right there
so it will set text and all but if it
isn't null it moves over the question
mark and then you're just literally
doing this you're doing description dot
you're getting the the value inside the
description so walls putting a question
mark there does is prevent you from
having to do this and then saying if
description properties null or isn't
null then do this it's like a quick way
of checking so to get that into like a
nice one-liner you just place it all in
one go
and that's read that whole line there
then reads the custom property if there
is one that matches this name of
description so all you have to do now to
read every other property just copy and
paste change the text so we'll change
this to status we'll set the status text
in the UI so again this status text here
which has got the name status text we'll
set that text property to the property
here which has got the name of status
which is just again just a string and
we've done this here so that if we want
to rename them the wall in a nice easy
location we could just type the word
directly in here like that where we're
checking of the property name equal
status and the property name equals
description but this is a bit of a bad
practice because these are variables
that have been given by the customer and
might change as well as they're going to
be used more than once so when we come
to set the values we want to set the
word description so then in future if
you change this to be description too
you'd have to change it here and then
you also have to go down when we set the
value change it there so whenever you've
got a property you want to keep it in a
variable up here so it's you know nice
and organized so that should read the
description on the status the status we
mentioned here wants to be evaluated the
fully resolved custom property so just
change this value at the end to resolved
value and that'll do that for you copy
and paste again do revision and you can
see how easy this is so nice and quick
to go through all of them
so the revision text and the custom
property with the revision word they
want to do part number same again
resolve value the material will come to
in a minute custom properties
manufacturing info will do last just
because that's a bit more complicated
so we'll put a note here of a
manufacturing info or come back to that
the mass and the length
we've want to do both the value and the
evaluated so the normal um the evaluated
so paste in here length so we've got two
length boxes the ones called text and
the others the evaluated one
so the normal one wants to be the normal
value and the evaluated the read-only
one wants to be the fully resolved value
you got the mass will do or we might as
well do Knox is really easy but we'll
we'll finish off the custom properties
because we're inside the custom
properties function here but outside
here we'll just make a quick note to set
the mass then we want the finish which
is going to come from the drop-down so
again we'll we'll jump back to this
because we want to set a list based on
the existing property if we have one in
fact let's just do that now anyway so we
want to get the finish first so we just
save it in a variable this time get
finish and we'll get the value and now
what we need to do because this will be
a text value we need to check this drop
down as combo box here when you define
the combo box item with the same name
and then select it so we'll try and find
matching item so if
let's dot finish list items dot so we're
going to do a for each statement here I
think it's going to be the simplest way
get for each item you want to check then
the item we know is a combo box item so
we'll cast it to that now the item dot
content which is a string equals the
finish so if combo box item equals the
finish somewhere parenthesis around
these then we want to do this dot finish
list stop selected item equals item and
then we want to break from this for loop
because if we found one we don't want to
continue it's going to move in that it's
not a string isn't it yeah cast up to a
string
so yeah if the combo box item has the
same name if so select it and then
before we do that in case we don't find
one clear the selection first so let's
start finish left stop selected index as
minus one so I think that's probably the
quickest way of setting the finish so
you get the property itself first which
is going to be the name then you clear
the list which is this list in terms of
the selection we get rid of the selected
item and then we loop through every one
and then we converted to a combo box
item because it's a combo box item here
and then we get the content which is the
string inside which is this we cast it
to a string because it could be anything
so we tell it it's a string and we
compare we say if it's equal to finish
and we're just in a direct comparison
for now we don't care about the upper
and lower case because they really
should be exactly the same in this case
if we find one that's exactly the same
then we select it doing this so that
should find and load in the finish if it
matches and otherwise it'll look like
this it will be blank exactly the same
thing for purchase information so we can
copy and paste this for purchase
information
so purchase MF oh yeah the purchase
information change the purchase list and
if we're doing this more than a few
times we could just put this inside of a
nice function and make it you know nicer
than this book for quickness we'll just
copy and paste in this instance so
that's the same thing for purchase info
and then you got supply a name code and
note which are exactly the same as all
these so let's just copy this so let's
apply a name
supply toad
and then note
and that's it so when we open a part we
should now read in everything except
manufacturing info and mass so
everything else and these checkboxes
they should all get filled in by they're
the custom properties as quickly at mass
because that's just as easy so all this
you'll see the indentation level were
inside this custom properties call so
you'll see it goes all the way down to
where we closed here
so outside of it so once we've done the
custom properties here and you come
outside will then read the mass so let's
start then we've named the mass out
sheetmetal mass text we've called it I
don't know why I've called it sheetmetal
it sir just rename it to mass text so
they start mass text text and again with
the solid DNA it's really easy all you
have to do is type in model dot mass
properties and that will get you all the
mass properties the center of gravity
the center of inertia or the moment of
inertia get you all those things and
again question mark in case there isn't
any this shouldn't ever be a case book
will do that and then you got the mass
directly which it says he is in
kilograms and then we got this helper
function mass in metric which basically
does a string and shows you in a nice
visual way says you know X grams or X
kilograms so we'll just use that
function and that gets the mass and then
shows it in metric so now the mass
should be filled out as well so we'll
have everything now except material and
weld not weld the manufacturing
information here
let's add the material because that
really is quite simple again this is
something that would be a lot of work
inside works if any of you have used it
before you know how we're really bad the
material API is there's basically
nothing to it you really struggle to
read and write materials or find
anything about them that's the point of
solid DNA to make it easy and so as
you'll see now it really is easy so what
we want to do is get all the materials
and set them to this list first so it's
going to populate the raw material list
so get raw materials the stock material
raw material the items source because
it's going to be a collection of all the
properties it's going to equal DNA
application get materials and you can
specify a specific database if you leave
it you get everything and that's as
simple as that that is now going to fill
the raw material list with all possible
materials inside SolidWorks now we want
to select existing material so over the
parts already got a material we want it
to automatically select from this list
and just before we do that let's also
set the what's it called the display
member path so the thing we want to
display in the drop-down and that's
going to be called display name and
that's because if you look at get
materials you press f12 you'll see you
return this material press f12 again and
here's the class for the material you
can see we've got this practical display
name and that's going to return the name
of the material as well as the
classification so that's a nice thing to
show that's what we're going to choose
to show so that's why we're going to say
display name that's why we've typed that
here so it's looking for a property in
the material
and select existing material so that'll
show all the materials now we want to
get the material so that's again just to
see you easy existing material equals
model dot get material and that's going
to get the material so if we don't have
a material then we want to clear
selection so we have existing material
as known then in fact let's not even
bother check in that way let's just
clear the selection first so let's stop
raw material they've stopped selected
index is minus one select the existing
material and then if we have one if we
have a material so if it isn't equal to
null then we want to try and find it in
this list and select it so to do that we
can do a one-liner again we want to set
the selected item and it's going to be a
the our should have kept the reference
to this material list here so our
materials equals get material set the
item source to materials and now we can
query these materials instead of query
in this item source so now we want the
selected item to be the materials and
again we'll question market to make sure
we have some so it won't run if we
haven't we want the first or default so
the first item we find and if we don't
tell return null where the database
matches because that's the file the
solid material file want to make sure
the database is the exact same as the
existing materials database
and we also want to make sure the name
of the material is the same name so if
the parts got a material that has the
same SolidWorks database file and the
same name as the one we've loaded we
know that's the same material because
that's how SolidWorks selects them so we
set the selected item to either nothing
if it doesn't find one or if it does the
first item that matches the database in
the name so that will then pre select
the material from the list so that code
will now have all these will have this
this this all that material the Refresh
works we haven't done these two buttons
and then we haven't done this but let's
go ahead and run this now and just have
a glance at what we've done because
we've got a really small file to be
honest for how much we've already done
we've got 200 lines code and we've got
the I'd say over 60% of the way done now
so let's just press f5 to spin on
SolidWorks and let's go ahead and add
some of these properties and check that
they get read into the file so it's
saying open apart so let's go ahead and
open apart and you can see here's where
I was playing a bit earlier we've got a
description there's nothing in here but
I think that's because we don't have the
properties it's found that we've got
this custom plastic - again I was
messing around with some properties and
you also see this drop down now it's got
every possible material in SolidWorks
and you can see it's got there the name
after it such as where it's from the
Steel's the plastics the alloys and if
you click on them we'll do that after
cuz you you know we want it to set
there's your materials is it's a
correctly identified the material we've
got it's read the length which is a
unresolved value SD one sketch one which
I've added a single
dimension here and then it's resolved it
to the correct value as well so we can
see what the length is and we can change
it if we like shred the mass 21.4 1
grams which if we compare that with
SolidWorks the masses and pounds let's
just change that
let's try again
so you 21.4 in grams so we've got the
same mass the side works the finish
isn't selected anything and the purchase
information doesn't so that means it
hasn't found any so let's just go ahead
and add some more properties so go to
the custom properties this should be
status so that's how the one called
status I will just keep it really
obvious my status it's okay that that's
collect refresh and it should load in
you can see that's worked slowly my
status so let's do that again for all
the others so we can check everything's
working so we should have a revision now
revision I will should have a part
number which was part a now until one
two three four materials material
manufacturing info was called
manufacturing information and it's going
to be say plasma it's going to be all
uppercase going to be separated by
commas plasma laser roll that says just
do some random one so that we can try
and read it back in afterwards the
length we've got there we know that's
fine the finish we want to be one of
those properties which I think was
painted with one of them let's call it
painted purchase information
the only one I can remember with Roberts
let's just put rubber in supply and name
was just supplier I believe my supplier
the supplier code was supplier number
forward slash code I believe why one two
three four and then note I think was
just note there's load of properties
that's okay let's refresh you can see
everything is loaded in here my status
revision part number grams paintings
worked this hasn't we'll check that in a
moment
supplier Hauser everything he has worked
as we expected
apart from this so we've got robber
nylon belt so let's check what's wrong
there got purchase information let's go
back to the value and and we've got
purchase information
P refused information so that's correct
search must be in the code where we read
and because we copy and pasted we might
have missed something here and in fact I
should put a breakpoint there sir ah
there you go just notice that so we've
checked the name of finish not of
purchase info so let's just stop that
and I'm going to have lost all those
properties because I didn't save I
should press save before I did that
let's run that again let's try and do
that really quickly I'll just
fast-forward the video she don't have to
watch that again
okay I'll save that this time before we
do anything else let's refresh I know
you can see everything's loaded in again
these two have loaded we can now change
them won't do anything yet because we
haven't done any code but you can you
know select what you want tack what you
want you can also type and then click
reload and refresh and it should reset
these so let's try that
there you can see how things change back
to what the part is so that looks like
all the readings working fine
if we close that's still working let's
make a new part with nowhere property
then it should all be blank we've got
one issue here so we have this is
actually in solid DNA where it's
effectively saying there's no mass which
really I was throwing here because it's
saying there's no mass I'm going to fix
this now we don't really care if there's
no body which I'm guessing is what too
is yeah we just want to return an empty
mass properties if that's the case so I
only want to know if it's an unknown
error then we'll throw that otherwise
it's going to be the mass properties we
also want to check status equals equals
nice properties no body then we want to
return a new mass properties with
nothing in return empty okay so that
will fix that
so let's just do that once more
let's open the original part first as
all the properties close out let's make
a brand new part and you can see it's
all blank because there's no information
and the grounders now zero because it's
not found anything
let's open part one again and it all
fills in so that all looks like it's
working great close that on that empties
so that's all the reading done already
except this so let's just go ahead and
do these checkboxes so back to here we
go the reading so manufacturing info so
first thing we want to do is clear off
all the checkboxes which is going to be
fun so we've got to go through wild
again I'll fast forward this I'm just
going to do the checked equals and then
we're going to go through every one so
assembly plasma laser
and I've done it again just need to
change us to is checked I always think
it's called checked so this is just
every single check box we're setting to
full so there's no check by default so
clear previous checks I'm going to read
in value so that's going to be the
manufacturing info you don't want them
resolved who just want the value so
we'll get the value and now we're going
to split this in by commas so that's
going to be either nothing or say plasma
or it's going to be plasma comma fold
something like that we'll also do a
little bit of cleanup in case the spaces
in between that we just remove spaces
and we want to uppercase as well so
let's start by checking if it's not null
or empty so we've actually got some
string
for in fact or check of its nor
whitespace cases just why characters so
if it's not so that means we've got
something we first want to split and
then iterate through each part so we can
do for each flower part in manufacturing
info split and split it by comma just
before we do that so manufacturing info
will do dot replace white spaces with
nothing so this will just remove any
white space in between anything first
then we'll split it by the comma
it will also uppercase it so you can do
that anywhere really so that everything
is capitalized so remove white spaces
capitalized and split by commas so now
in here for each part we just we can do
a switch now and we can switch based on
the part so now we can switch by part
and then this is the properties here so
we can actually get in case we change
these we could base this text this name
off the value you want to set which I
think's what we'll do so we'll use the
word weld and then we'll uppercase the
word wild as well so we'll do case
let's dock well dot content
why is it gone Esther content to offer
so this will get the content what's
wrong with that constant as expected oh
we can't do that okay so for here
instead of just type in Weld in here
we'll go ahead and make another set of
constant values up here so I'm other put
my new fracturing world that's going to
be weld and then we're going to do this
for everyone so actually let's just get
rid of that and that I want assembly
plasma laser
there's the values we want scroll down
we check if it's a weld so if part of
that string has a weld then we want to
check the weld box and then we just
repeat that for everyone
so this big long list now will split all
the manufacturing info by commas
find out if each part matches any of
these names and then it will check the
checkboxes if it does so let's just
press f5 and check if that part works
and if so that's the whole reading
working and there you go you can see
we've got plasma laser and roll checked
and that's because before I closed it we
added this purchase not purchase
manufacturing information plasma laser
roll so let's put some spaces in as we
mentioned can put them any way in
between words and I just put something
random in at the end and that should
still work I should still find plasma
laser roll he'll ignore random and we
could do purchase so we click OK to that
and refresh
perché should get checked as well and
you can see that works nicely so now
that's all done let's just do this we'll
reset button because that's really easy
and then all that's left is the apply
button so the reset button just wants to
clear all this information and we've got
another less you here on closing down so
because we've shut down to null check
there
right so that's all the reading reset
button how does it go to this panel
click the reset add a click event rename
it to reset button go to the code-behind
rename lap to reset button
and this one's really simple just go
let's start description text text equals
string that empty same for status
revision part number material wants to
be minus one
all these want to be unchecked which was
copy and paste because that was quite a
big line of code
length wants to be emptied now length is
an interesting one because if you reset
the evaluated is nothing but I guess
that's what they want for this reset
button anyway so let's just do that
mass that's really a read only again I
don't think we want to clear mass the
mass is what it is so clicking resets a
bit silly to clear that we'll leave that
as it is these want to be minus one
finish and purchase and then these three
want to be nothing supply a name
supply code and note press f5 and we'll
class that little function I'm which
should just wipe out all information
apart from the mass and I guess that's
if you want to wiper details which is a
another interesting thing because we
haven't mentioned what happens if we
well I guess we do if we reset all the
swipes and then I guess if you click
apply now it would still work it right
nothing at right a blank string to
description and a length and all these
so I guess that's the point of that
button I guess really those we Dennis we
should just leave as well because you
can't change them but yet it doesn't
matter either way if they want them in
they can just uncomment that line of
code that clears them out we've missed
one here got laser checked so
we'll also have to add that to the other
one
so that's now all done we want to set
the material and the properties we'll
leave that open right so that's all the
reading done as the reset button Don so
the last thing now is to apply changes
when the users type stuff so let's go to
the apply button add an event again same
as all the others so in the apply button
um first when I get the active model
we want to check we have a part so if
the model has nothing or it isn't part
then we just return we just don't do
anything now we want to set custom
properties so to do that we just do
model dot set custom property
interestingly this is because this is
quicker to set a specific name but what
you might not know is where we did the
read and we do this model dot custom
properties to get existing ones inside
here you can actually set custom
properties by just saying
so you've checked properties like here
first or default and you've got a
certain property so let's say we've got
var description it's the first or
default where it says description and
then you can say if description is in
Duplin or you can set the property as
simple as doing description getting the
custom property and you can delete it
here like this or to set it just simply
do value equals new value and that's it
that will actually save and set the
custom property value you don't need to
as well as reading here you can set so
that's just an interesting thing for you
there if you wanted to set custom
properties or even delete them inside
the same function you can do it just as
easy as that but in our case we don't
want to read the custom properties
because we don't care whether they exist
or not we just want to set them either
way so we just call the set custom
property the name will be the
description the value will be the
description text
then we'll go through that read only
we'd only read only material that's
actually call that description to set
the materials still really easy it's
just slightly different we want to we
need to set the get the active model
which is there you wanna call set
material and then you need to cast to
material and you want to get the
currently selected an item from the list
now web thought or something here is you
might not have something selected will
come to that one last well actually now
let's just do if let's start raw
material list dot selected index is less
than zero so it's not got anything
selected we'll set the material to not
will clear the material
every user doesn't have a material
selected pull.you it that also brings me
to another point just before we finish
this where we load the material list in
here one of the user wants to delete a
material we need to add another material
to this list so materials dot insert at
the start and new material and by
default when you set a material if the
material has got this database file not
found as false it means it doesn't know
where the material is it's going to just
delete the material from the pot so we
could just create a new material with
the database file not found as false
which is by default anyway and give it a
name remove material and because of the
display name using classification let's
also set that so it looks nice and just
put not specified so we'll insert this
extra material at the start of that list
so at the start of this drop-down that
says remove material through the select
that and click apply then it will find
it in this list here and set and the
material and then in solid DNA it
basically checks at the materials null
or the material database file not found
as false profile found false then it
will basically set the material to
nothing it will remove the material so
back to here if they don't have anything
selected so if they click the reset
button and then nothing selected and
then they click Save or apply then this
will kick in it will apply nothing
otherwise we want to set the material to
whatever the user has selected and
because this list is bound this raw
materials list is bound here item source
to materials which is a list of material
then we know we can cast the selected
item back to a material to set so that's
all there is to setting the material
that's the description set the material
those are read-only these will come to
again manufacturing info I'll just jump
back to this in a second length we want
to set so that's just the same as this
not set not set finished and purchase
slightly different but still just as
easy get the finish and this is going to
be finished list dot selected item we
could possibly do selected value I'm
just not sure about that
let's do selected value and just see
what happens if not then we'll do
selected item cast it to a combo box
item and then get the content of a
string but I'm guessing this might work
by default I think it will so that's the
finish
that's the purchase Mpho name code and
note
and there we go that's all the custom
properties so there's just as
manufacturing infill left so for that we
need to read all these checkboxes and
create a string from it so we'll start
off with a manufacturing info is an
empty string and then we'll just do one
at a time if this dot well dot is
shipped manufacturing info plus equals
and then we're going to add in fact
let's do a list new list of strings will
just do ad and we'll add the
manufacturing info weld to the list it's
wrong with that
that right out so we check
that's all the list so now we'll have a
list of strings based on which item was
checked and we just need to convert that
to a string separated by commas and set
the value so it's again really easy just
do set faction info and the value is
string join five commas the manufactory
info and that's it so I think that's the
entire program in three hundred and
seventy lines of code which would be
thousands and thousands of you're using
solidworks api so let's just run this
and do a final check press f5 in fact
yeah that's fine one other thing that
was mentioned by the person that wanted
this was a specific order of these
properties when you set them so if this
like plasma and laser and lay that they
wants a plasma first and lave lasts and
what-have-you while that order is
defined here so in the set so in the
apply button when you create in this
list the order at which you add them to
this list so the order at which you
check the weld and then the assembling
and the plasma that defines the order of
the string so if you want say this role
to come before purchase you'd move this
if check here above this purchase check
here so the order if you want to change
it as in this part here
so let's open up a oops wrong one
open up a part you can see it's already
loaded everything in that we checked so
let's go and change everything
let's do my description too
you can't change them let's change the
material to ductile iron let's uncheck
those let's check wild drill laser
length we'll leave is that what it is on
fact let's just change it to test we'll
change this to zinc that's two bearing
this to my supplier to list a supplier
nine nine nine and my note 2 so
basically we've added all the different
things to it so let's click apply now
we've got one issue here so let's have a
look what that is unable to cast off
type so it has a combo box item then
selected value so this is the one thing
we want to fix that's the part that I
said might work that I thought it would
so Natalie a combo box item which we
then want to cast the contents to a
string so let's fix that a little bit
run again open the file change that to
two plastic or change the ductile iron
and check those check a few others will
go wild drill and saw this time I supply
two and nine two painted two galv
Roberta motor and will click apply
there you go instantly you've seen their
materials changed so ductile irons been
set let's go take a look at all the
custom properties things in lengths gone
to test the evaluator doesn't been
reevaluated so we'll fix that in a
moment
status we don't change because it's
read-only the manufacturing info has
changed correctly while drill saw just
what we selected Galvis changed motors
changed supplies so that's all working
great let's just clear manufacturing
info and refresh and I see these haven't
been checked so that's actually
interesting
Oh SolidWorks didn't save it that's why
like okay refresh there we go so that's
working fine assembly lathe let's apply
that properties assembler lays that all
looks good so everything looks like it's
working
the only issue was this evaluated the
only issue there was that was when we've
applied we've set values once we've set
everything what we want to do at the end
of that is just reload effectively that
refresh - to pull everything back in
from the part to be sure it's all
updated so at the end of the apply just
simply stick there read details at the
end and I'll just refresh all the
details and it also has works as like a
clarification that what you then see in
that form is what's actually set in the
pot you don't have to go and manually
open it to double check and that's
everything we need there I believe there
was one other thing now which have
forgotten about which I didn't put in
this little screen shot and that was
certain rules that if certain things
were checked so save assembly was
checked them plasma couldn't be enough
plasma was checked
drill couldn't be all rules like that
basically some logic that if you go
ahead and select I can say let's use
plasma renewal assembly as the example
because we can't remember off the top of
my head exactly what it was but let's
say we click assembly then we collect
plasma and only one of those is allowed
so when we cut plasma at once assembly
to uncheck when you click assembly at
one plasma to uncheck so to do that we
just want to add go to the form click
say assembly
and then ad is checked and I'm not sure
I keep getting these two mixed up just
checked on its own add a new event
handler let's go down to it and then
uncheck plasma and this also make sure
plasma is unchecked and let's do the
same for plasma do the opposite so click
plasma tap checked
add a new event handler and that's
uncheck assembly press f5 and let's give
that a quick check
and what this won't do as well you have
to bear in mind this should work so you
can see plasma and assembly work you now
can't select both of them at the same
time but where it won't work and again
that might be by I'd personally leave it
that way if we actually type in assembly
plasma and then refresh that's nothing
the SolidWorks are saving the properties
oh yeah assembly plasma now I stand
corrected oh it will work in this case
because when we're in code we're reading
assembly so we go to the read details
you'll see why works now we first clear
everything and then we do this a little
check here as we go through and in the
order which they've been assigned in the
custom properties because we split it
based on that
we're then going to check say assembly
here well when this is checked gets
called it's going to fire the event that
we made down here keep going it's going
to fire this so the rules still going to
work but what it's going to do is it's
based on whichever appears last is going
to be the one that wins so if we went to
property and we have assembly plasma and
then we refresh if the plasma is worn
and we change that to plasma assembly
and then reload if it's actually saved
let's just double check out saved plasma
assembly yep we refresh now assembly
should be checked which it is so that's
how you do some basic rules again that
can be customized to exactly how you
want it to be just by going into the UI
selecting the checkbox that you want and
then it'll highlight here and then just
at the end add a checked event and and
then do the logic of whatever you want
to do so hopefully that'll cover
everything so that's it for this video
we've covered quite a lot in this video
I was done Mass with on materials we
don't dropdowns combos some logic we've
done setting and getting custom
properties but you can see already how
how easy it now is to work with the
SolidWorks code
everything's just you know active model
as what it is you get an event when the
active model changes you just do custom
properties to get them I do set custom
properties to set you do set material to
SAP material
everything's just really straightforward
you know it's nice and easy with no
issues and if you go into the code the
actual solid DNA code you'll see how
complicated it gets just to do all that
that it'll actually get in a wrap the
errors for you it'll check of it's a
part it'll clean up all the comm
references it just handles all of the
the hard work for you you know get
materials as you know this nasty bit of
code here to get the material so the
point of solid DNA which hopefully
you're starting to realize as these
videos go on is to just keep things
really easy for the developer the person
making this code here when you just want
to do certain things like set properties
that's it's really obvious you've got a
model you've said the active model then
you do a dot and you've got you know as
assembly of drawings part custom
properties
extension file path materials if it's
been saved to mass properties and the
mass properties has got all the values
it's just really clean and modern and
you know it takes all that hard work
away from you so you can just focus on
doing what you want to do so I think in
the next video I'll just go back on the
forum we'll take a look at what some of
the early requests were and now we've
done a lot of the work in this solid DNA
I've added a lot since you last saw it
behind the scenes to do all the stuff
that's now being done I can really focus
on the main code so I'll go back to the
forum and we'll choose something that's
needs doing and we'll do the next video
on whatever's on the forum you have any
suggestions comments queries please do
post in the video that's where they'll
get read also like the video and
subscribe to the channel if you haven't
and then that's what keeps the videos
coming so I hope you enjoyed this</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>