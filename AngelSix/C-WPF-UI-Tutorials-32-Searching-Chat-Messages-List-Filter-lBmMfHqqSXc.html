<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# WPF UI Tutorials: 32 - Searching Chat Messages List Filter | Coder Coacher - Coaching Coders</title><meta content="C# WPF UI Tutorials: 32 - Searching Chat Messages List Filter - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# WPF UI Tutorials: 32 - Searching Chat Messages List Filter</b></h2><h5 class="post__date">2017-11-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lBmMfHqqSXc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so following up on the last
vpf video really we needed to break off
and do the server work in order to you
know fully finish this application so
we've started there but now we're
getting a lot of requests where you know
people want to see more WPF stuff it's
like that you know an exciting topic so
I'm going to jump back in and do a
little bit of WPF actually there's not
much I can do until we do the server now
but I think I'm gonna do is going to be
will do the search feature will make the
whole you know chat message section
searchable as let's just jump straight
in and get to it so we want to do that
button there so we've got the button
here which is this one so let's just
document in that and then what I think
we'll have happen is when you click the
search button will slide out to full
width search over the top of this this
here which I think's in grid yes it's
this grid here I think yeah so we'll
basically have it inside this grid so we
want it here or took another grid it
will have its spanning over the full two
columns so you can then see you know
we're going over the full full width
there which is what we want we don't
need the background taller we will then
have the column definitions so we'll
have the first one I'll be like a close
button over here zoom in a little bit I
would want to finish this first one
would be the close button and then the
next one will be the full width search
so we'll have like a close here and then
a big textbox so to do that we'll just
video search overlay will call this
we'll just go ahead and take like this
this message box here that's kind of
style we want just copy all that for now
place that in here this will be the
search box doesn't need a name it's
going to be in column 2 and this will be
search text go to focus get the text
vegetable lime order padding upset just
get all of that I think and then we want
a button close search button so again
this will just be basically copy the
search button change the icon or no plus
the style change the icon here to close
button and then you can see we have some
search taps think need a bit of margin
on there and we don't want any on the
left what is 5 all the way around
otherwise let's just run this and try
and visualize what this looks like now
so this is what we'll have with the
search when he's out which I think looks
alright I think that's that's fine and
so we will have yeah let's we're gonna
have to move on to the view model now to
to bind anything else I think so
ultimately we want this to slide I'll
turn this to slide back in and this to
search but I mean that's pretty much the
UI right there we just need to now bind
it all up so we'll jump over to the chat
message list view model and in here
we're gonna have a lot of changes so
we're gonna have to we're gonna have to
search the text you know when you type
in and then you press Enter you want to
search which is fairly obvious but then
certain things say so you type test and
press ENTER and it searches and then you
type away for then you come back in the
end up with the same value you press
ENTER you don't want to research the
what I'm sending a message there somehow
fix that in a minute so you don't want
to we research the same text if you will
as you're you know you're searching so
I've drove like a last search text value
will also a half drive in this list see
working gala yes I've got to fix that Oh
which is basically allowing blank
messages okay so back to the topic we
will have this list needs to be filtered
now so that when we search you know we
limit the results so I'll have to create
a filter there we'll need a flag for
when this switch dialogues open or
closed and then all the commands to do
that so let's just go ahead and bulk out
this view model so I'll have new region
protected properties or protective
members and we'll have string and
last search text last searched text in
this list and as you mentioned will
populate that is you know as we need to
another one for the actual search text
and the reason we're not just doing
straight properties is because we'll
need to do certain things when this you
know when the text changes for example
if it goes to an empty string then we'll
maybe want to refresh the search so that
all the content reappears a little
things like that so we'll have public
properties for some of these protected
strings but we can't just do straight
get a setter because we need to do
something on the setter so you'll see
that as we go through so this will be
the tips to search for in the search
command will have will have to take this
items list and do something when it
changes because while the filtered items
list so we'll copy and paste the whole
thing we'll have a protected version and
then we'll also get rid of the getter
setter and we'll name it correctly for M
items so exactly the same thing will
come and tweak this in a minute - then
you know set this instead but let's just
get the probably the protected members
done first and I think there's one more
than for the search is open flag
indicating of the search dialog is open
which is that bar that you know we've
done to slide along so I think that's
all need for protective members public
properties now we'll have to alter this
so the getter can just return the items
as he dead the set we want to first make
sure let's just changed so air and
values are the same
turn otherwise update the value and then
in here now we since we want to update
filtered list to match so what we're
going to do this probably changed once
we integrate it into the server because
we'll have like a back-end database to
store these things and do searches
properly but for now we're just going to
create a duplicate set of items which
are filtered items so we'll just copy
and paste this will do filters items and
the Chuck message items from the list
that include any search filtering so
this is the one they want to bind to
this is really a you know you don't want
to be editing this so I even put like a
lotta notes to the developers to not
call it--and got add to I get to this
list and then we'll think about this
further down the line how we potentially
just remove this all together so they
can't access it and they have to do you
know like add message or add item or
things but for now that's fine we'll put
the note in and we'll also make it a
fried acceptable so it can't invite
enough leave it as public is fine so
this is good enough here we basically
all we're gonna swap the items public
property to have a backing member a
protected buckin member and that's all
normal so this right now does nothing
different than simply being a getter and
setter the benefit is now here we can do
anything custom and for that every time
the items get sets like the whole items
list gets changed we'll just simply
clone those items into the filtered list
the ones that you know ultimately going
to see
so we'll do a new observable collection
with the same items basically and the
reason you can't just do filtered items
equals M items is because this would
create effectively a reference to the
so they've become the exact same list
then have you added the items list or
add or remove from either list they're
gonna do the same thing and that's not
what you want so you're gonna have to
make a new list and pre populate it with
the items so we've got the items list
we've got the filtered items which is
now basically the items let's just with
any you know search text applied so
anything we've searched for one thing I
think we're missing that we've never
bothered doing yet here's if I were to
hide that a minute this display text
here the title we've never actually done
anything with we never bound we just
don't text here so it's just at least
add that back so the binding call it
display title or something and then we
just go and add a public string called
display title the title of this shot
list and again we'll set that when we
come to you know find out where we use
it we'll just want to get this view
model done first so at least we've got
the property ready we'll then need a
search text string as well so a public
string search text this again will be
the getter which will return that
underlying property the text to search
for when we do a search and then they
get we say the set will do again sure
property value is different so ramp
search text is the same as value don't
bother updating otherwise update the
value so again normal get a setter for
now and now the difference here in the
search text is
if we are an empty string as we
mentioned oh there's nothing in the
string when it changes let's just call
search to research the the empty string
effectively and bring back all the
original so we'll do if the backup
string is nor empty then so if the
search is empty such text identity
search to restore messages and we
haven't done the search function yet but
we know we'll call it search that's fine
there and that'll be the search text we
need what else did we say we've got the
public boolean search is open and again
the Gator will return the underlying
buckin property flag indicating the
search dialogue is open same again check
value exchange web search is open equals
value and do nothing
update value and now here the difference
is what do we want to do here I think
when we close the dialogue so once we
click close or closes however we want to
we want to clear the search text because
otherwise the last search would remain
active in the view so if you search for
say hello and then you close the search
dialog your results are still going to
be filtered to the hallo and not the you
know your whole results which is what
you'd naturally expect
so if dialogue closes so it's not open
for your search text
by clearing the search text it will then
invoke this anyway because then when
it's no little search so by closing the
search will clear the text by clearing
the tactful to perform a search and
because the search will be on a blank
string it will restore all the text so
that's kind of how it will cascade down
I think I set four properties so fix a
few spelling mistakes for here
so public commands now so these are nice
and easy public
I command search command which is fairly
obvious that will be for searching
command for when the user wants to
search it will have I'll see off clear
search open and close search so we'll do
open search command close it command
krumping the user wants to open the
search dialog and it's to close the
search dialog and finally I forgot I
said search open close for you you gotta
clear the text now each other then we'll
make use off because we'll do it with
the properties but it's a command that
Matt I want to do the command from the
user wants to clear the search text we
need to then create all of those
commands I think that's all of them so I
don't know it's in the constructor we
want to do it so this would be the
search what yeah search command will
have a function called search open throw
is clear
I just installed power tools to get
their present mode on so I can make the
text larger for the video since I
reinstalled the Machine and I haven't
turned off this annoying peak thing yes
I used ctrl and click to you know
instantly select the text and now it's
enabled there let me just see if I can
find it quickly at turning that off
general control click share definition
peak disabled ah I know it doesn't I'm
also just got close and reopen this
document give me one second let me just
see up and get this off control click
options to toggle it shows definition
peek all that's turned off just stop
appearance colors power commands hmm no
maybe I need to close and reopen this
chat message list view model if not I'll
just live with it for this video
nope stay not okay ignore it for now as
dr. live without me control click for
this video so we'll create an open
search or closer to clear search
function we haven't made them yet but we
will
that is or them created or initialize
allow us to create the actual methods so
in here
we will do public void search search is
the current message list and filters the
view not going to do that for now it
goes it's probably the biggest function
come back to that one sort the nice easy
ones for now public void clear search
and to be honest that now off to do a
function blast clears the searchtext
we'll do a little bit logic here so if
the we want to if the cleaving the
search text like we're gonna have it so
when the dialog is open and the user
they can see in here get rid of the
collapsed so when this message box the
user is typing and the press escape
we're going to bind it to a command so
we'll do text box got input bindings and
hos forget these syntax key binding
command yep so the command we will bind
to the close for your search command and
the key for that will be escape
so basically when the user presses
escape rather in this dialog will clear
the text if they press escape again when
it's ready blank will close the dialog
so it's like a nice keyboard shortcut so
we'll just find that to the search the
clear search command and then we'll have
one when they press ENTER to do the
search command and that's running the
keys for the return so this will be
clear text on escape search on enter so
that's those two commands that's what
they're gonna do so basically this
player search will be fired whenever the
user presses escape in that text box so
in that case if there is some search
text so if not string dot is no empty
search text
then search text equals string.empty
otherwise if it's already empty
we will then want to want to set the
search is open to false closed search
dialog so that should give us the result
we want next command is open search
that's nice and easy we're going to do
it
expression body to set search is open to
true opens the search dialog and then
we'll have long closes set it to false
shortcuts for ctrl-click is really
annoying
it says the closed the open are clear
now I think we're finally down to the
search which I'll do we'll come back to
the search we'll build everything up
first and make sure it all works so I
think potentially this and now we'll
have to bind this whole grid this search
over like the we'll have to animate this
in so I'll do a running mate in animate
the slide in from bottom left
okay looks like we've only got bottom
left okay so you need to add a slide in
from right so let's just copy and paste
the left one
I'm going slide him from right that's
ctrl click copy paste I'm it's pretty
much line them from the right and
sliding out to the right and do
animation change this to right and now
we can use that property on here and
we'll bind the value to search is open
and that should get it to animate in we
need to also bind the search button here
the main button in the first place
directly open search command so it will
open we can have the close button as
well bind to the close command and I
think that should build at a guess
yes machine is definitely slower I built
a rising machine and swapped the Intel
and this risin is not as fast right so
here's a search we click and hopefully
know that animated it fade it in it's
not sliding
I won't away we have the search grid if
you will is overlaying another grid so
it won't actually push out we need to
keep the Margie so need to just to make
another slide in property
we'll call the other one I really hate
this ctrl-click thing that's turned
itself on so sliding margin flown from
right margin property we'll go back to
our property we just made copy and paste
it again and make another one it's just
the same we just call it margin and then
we simply keep the margin so that it
will animate in with its actual width
that should fix the animation
and a really slow build come on there we
go right there's the animation and
there's the close button working then
we'll change up to orange so search text
we do that with press enter and we
should hit our search command so we type
and press Enter
yep we're ready to search if we press
escape it should clear the text
no it's closes so let's just check the
oh I know why the where are we
there's my chat page then gun search
text text box here you always forget
when you do this you have to bind the
text would help so binding is search
text and make sure you go through the
update trigger for when the text changes
so that should set the search text now
well at least I know the logic
pre-closing worked because there was no
tax and it closed so open type away
escape is clear the text escape against
your clothes which it does closing and
open you should clear the text which it
is let's go twice okay that's all word
and the only annoying thing that is it's
not focusing when we click this we want
this to focus so that should be an easy
fix just again select the text box here
and we'll make use of our local focus
property we made way back when and we
bind that to searches open
so whenever search is open goes true
this attach property tells the textbox
to gain focus so if we then click when
our water must be in the search escaped
escaped hides it click back away escape
escape click or close so that's that's
not bad let's change this
across to orange oh it's like time doing
over there so you see that time now that
10 it's stretched out to the image it
should be just stretched out to the
message the others works it's just when
there's an image cases let's fix that
and then let's change this cross to an
orange one let's do the orange thing
first that's quicker so it just changed
the foreground on here to word orange
and then the where's this is maybe a
message item control maybe yeah and time
container so let's move this time
container from the outer grid which I'm
guessing is got the image in yeah so
let's cut this entire time container and
we want to chuck it inside wherever this
grid is for just the text so where is
this grid so this one is fine so inside
the message text attachment grid I think
because they remind you the image is
there now we want to inside this one the
shop message bubble one so it doesn't
expand with the image so inside of this
grid right after the chat bubble and you
say will Chuck our stack panel this grid
row will actually be water tortillas the
second one in fact I've made a mistake
on the grid row on the other one I'll go
back and fix that in a minute add one
more row to this for the time that we've
chopped in and this rail will not be one
I believe No
what's going on here I've added the row
definition to the wrong grid this one
there we go so it's a zero-based row
definition and I remember doing the
wrong road definition somewhere in here
can't remember where I just remember
doing it
where did we do nothing this bit I'm
sure I know it was column oh yeah
column 2 column 1 it should be it's
actually worked but it technically is
wrong it should be column 1 so that
should have fixed hopefully the time and
button should be orange so that still
works and now that's better so that's
now inside the text yeah that's okay a
search now as are the orange things
that's all good it's now we need to
actually do the search so that's the
kind of why we're here
so let's get the search function done so
in the search we want to start by make
sure we don't we research the same text
twice so in this case a first will do if
the string got is normal empty so let's
check both the last search string and
the current string so both of those are
not or empty the same thing or
the strings are equal they're the last
search string to search text so
basically it's just a check in a very
call just that we also want to do a
north check in case this one's null and
this one's empty that's really the same
thing so if they're all the same return
that's that check out the way then I
guess but we have no search text or no
items so if the string is normal empty
search text or the items is null or the
icon stop count which is that you know
the actual the message is the item of
count is less than if they're 0 then we
have nothing to technically search or
either we've got nothing to search so it
should match or there's nothing in the
left so either way if there's nothing to
search all there's no items then the
filter list should be the same as the
items list so we'll simply then match
the make filter or less the same be
filtered items if there's new observable
collection of whatever items are and
then we want to update the last search
now that's validated we've done it
search text so set fast search and then
just return cuz you don't want to do
anything otherwise and then what can do
eternal can you do else routes from all
the statement is but we'll just return
we don't like to nest dips so if we get
here then it means there is a new search
that we haven't yet searched the text is
different so in that case we will find
all items that contain the given text so
filtered items and again this will
change when we do the server code
because we won't just be filtering by
the items in this UI will be filtering
by you know the whole
items in the database of UL all the
messages in the whole list not
necessarily just the ones you've
currently got loaded so for now we'll
just filter the live list which is good
enough but then when the server codes
Don will will improve this and will make
it more efficient as well so it's also
Britain out there to do make more
efficient search for now it's going to
be quite simple the filtered items are
what we can actually set it directly so
filtered items equals new observable
collection and the items that we want is
basically the items we currently have
got where the item dot message got to
lower so we can do a you know a
case-insensitive contains Jack so the
new list is four items bring on a new
line so it's a bit easier to see where
any of the items at a lower case contain
the search tab and we'll keep the search
that simple for now where we get that
will turn it to a list and but we don't
need to turn it to a list because it's
oh I'll do it for is any weight on
numerate so there's the search that will
update the filtered items and now we
just want to update or rather same text
set blasts it sets of text so that we
don't research the same thing and I
think that's it I think I should that
should search now because I know we've
got a bind to filtered items so let's
find out where where we need to change
the binding to those you know the items
to the filtered items close that a
minute
they'll be binding items
chuckle less control now chat message
less control so it's in the chat message
list control zamel and this will change
to filtered items we also where do we
want to bring back this tile that we've
banned so let's just set that first as
well we have the shot list item view
model I think has got it in and then we
yeah so here where we create the dummy
data let's also create the dummy display
tile for now so we'll say are now me as
if there's two recipients in the list
and then we'll also want to do the the
design model as well shot message list
design model so that we get that in the
UI again we got that tile for that will
keep this for let's say just Parnell so
we can tell the difference as well so
now in once you've compiled and run we
should get in the UI we should get back
our there we I should have got Parnell
but now that's bound and when we've run
we should get porn I'll come and meet to
show that it's you know they're the two
places we were sat in it so click here
and there goes who now BAM that title as
well so this should now search so let's
search for new so new enter there we go
we've got new press escape it clears the
search received
yeah it's filter by received something
don't exist then every close it should
clear if it does that's that's looking
quite good you test
okay so I'm adding to the list we are
now not seen our messages so we need to
fix that
where do we do that that will be in the
send command so in the same command now
we have make sure items so ensure list
is not no or in this case ensure all
lists or not all because we're going to
do both so copy these two as we filtered
items fake a new message this will get
updated so for now we'll remove that and
this will be wrong message equals new
message and now instead of just adding
it to here we will add it to the
filtered items as well I think I should
fix that little issue as we go to here
we now tie yep so got new ins search for
test and we see test escape we see the
mall now we need to fix that issue we've
been able to send a blank message as
well I thought it had fix that before so
why do we not don't go send a blank
message yeah bring that as no empty
pending message text with tip I've got a
swarm we've done that fix before
so now I'm do we that's it we can't send
a blank message now which is fine I mean
we'll be able to we'll tweak that ones
we have you know attachments and you
want to send an attachment with no text
is fine but certainly not just a totally
blank message as that's really that's it
it's it's quite simple you know you'll
think it's complicated to do a search
and you know he might be scared off or
wondering how but that's really all of
us to it and sir
nice easy UI nice animations and and you
know you've got you your instant search
so again this will be this would be
tweaked when we've done the real server
code but for now in order to you know
carry on doing the WPF hopefully this
was a an interesting video any comments
let me know anything you want to see
next bearing in mind that you know we've
got a limitation with not actually
having the server code spawn up yet
so I need to keep going with those
videos but anything you want to see next
in these videos just comment and let me
know and I'll consider it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>