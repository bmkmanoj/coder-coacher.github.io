<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# SolidWorks API Tutorial - 04 SolidDNA Selected Objects &amp; Dimensions | Coder Coacher - Coaching Coders</title><meta content="C# SolidWorks API Tutorial - 04 SolidDNA Selected Objects &amp; Dimensions - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# SolidWorks API Tutorial - 04 SolidDNA Selected Objects &amp; Dimensions</b></h2><h5 class="post__date">2016-12-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/t5gVvklexR8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so pecking up from the last video we've
done a few things to this project
because of updated solid DNA to use
SolidWorks 2017 dll's
I've done the same in the atom so these
now reference the 2017 dll's they're in
the github repository as well I've also
gone ahead and just added all of them so
we've included things like motion study
that's because we're now going to do
selections so you can get any objects
that are selected and motion study is
one of the things that you didn't have a
selection of so to include every
possible selected item we were just
including every Interop assembly for now
when you do read these references the by
default go to enable Interop true so
change them back to false again and then
I cleaned up this read details
so before I don't know why I didn't
click him when I was doing the video but
I made it pretty complicated just
forgetting a custom property I was using
more of a an editor if you wanted to
mess with existing ones and and tweak
them so instead of having the custom
properties and then the big long if
properties dot first or default value
it's now a simple case of just a model
dot get custom property and the name so
you can see how much tidier that is now
for all the the GAT custom properties so
the codes you know cleanest Dale
so that's it for the changes in the
previous ad and I didn't think he was
worth making a video just for those
changes so we've gone ahead and now
added the ability to get selected items
and then to cast them to any possible
type so there's been a lot of work so if
you go into the solid DNA you'll see a
model for example feature and then
features we've now got a lot of features
and a lot of feature data which we can
get it's basically every possible
feature in SolidWorks so we won't use
all of those they're ready to be used
and then I've added dimension because
that's what we want to do so you can get
a dimension as well so I'll quickly show
you how this works in the read details
which is because it's covered when the
active model changes so basically
whenever an active model changes when
we've got the part here or the assembly
in this case because we've added the
ability to work on assemblies as well we
just do model dot selection changed plus
equals and then tab tab and it will add
an event handler so if we scroll back up
you'll see it's just added this I'll say
that's now for selection changes and
then it will go to this function now
this will fire whenever a model is open
and something gets selected so to do
that we can then do DNA dot application
directive model because we know it's
what all working with it has to be
active for a selection to happen
question mark just in case it's null for
any reason and then dot select teed
select polygons that's why we named that
selected objects and same there so now
it's selected objects it's going to give
us selected objects
so I'll just say objects same syntax as
the custom property editor before where
it's basically a function so you open
and close your parentheses here and here
so we got rid of this it's it's a
function we're just and then inside the
function we then pass in this lambda
expression which is basically another
set of parentheses with the values we're
going to be given then R greater than an
equals and greater than sign and two
curly brackets and then inside of here
now this is this function will call us
and give us these objects which is a
list of all the selected objects so from
the mark we there might be non as well
it might be an empty list it won't be no
but it might be non we want to find the
selected of regard selected dimension in
this case so before we do a dimension
we'll just show some information about
any select well any currently supported
object which right now is a feature and
a dimension I'll add more support later
so we'll first go through every object
so we'll do object stock for each it's
selected and then what's gonna happen
here we're just gonna go through and
effectively the last object that's
selected if they select more than one
then the latest object is gonna take
precedence because this is just going to
run for each one and the newest one will
be last and we're just gonna set the
text of one of our text boxes to some
information about the the selected item
so we can visibly see what we're
selecting so you can do selected and you
can see right now we can support if it's
a dimensional is if it's a feature and
we've got the object type so really
quickly we'll just do
third helper Stockman on UI threat and
now before we run on the UI thread
because then that will go off this
thread and then this selected objects
will finish and if you step in you'll
see what will happen this will get all
the selected objects it will add them to
a list it will then call the action on
the list and then we're gonna spin off
onto the UI thread which means this is
going to come back and then it's going
to dispose of everything so if we spin
off onto the UI thread here and then try
and access this object or the select
object in here it's going to get
disposed so anything you want to do with
the selected object first get the values
here so we'll just say VAR a equals
object type and now in here we can
reference this local local property here
and you got to make sure when you're
referencing things as well it's not com
object because it's just going to be
disposed anyway and then this well-oiled
and work either so you just got a bear
in mind whenever you're jumping onto the
UI thread make sure you've got nan comm
data stored in variables before you jump
on to a UI thread we're gonna do let's
do the length textbox in this case and
that text is just going to equal the
object type to string for now let's just
quickly run that just to see we should
see them the sheet metal length text box
being filled with whatever object type
is selected so that'll just give us a
quick visible check of what's going on
with the selection and also making sure
it's working so we've got open a part so
we'll open the usual part and then it's
this here we're going to expect to fill
so that's like this boss and you can see
he's got a selection body feature
it's got external sketch points got
datum planes these are nothing so
nothing's happening because we've got
one
the cabinet's I think that one was
annotation view so this is a good way to
you know see what's been selected and
then it will go to the sketch after this
sketch you can see a dimension and
that's what we're going to be interested
in ultimately so we can see the
selections working so you could use this
like say to help you figure out what's
going on we'll leave that in because
we'll use that but what we want to do
we're only interested in a dimension so
we'll check if it's a dimension first so
we'll just say if it's not a dimension
then return because we're not interested
and then of it is a dimension which is
here then we'll do selected dot as
dimension and then again we'll get the
dimension given to us because it will
get disposed off after this call and I'm
gonna have to move this inside so now
we've got a dimension so now we can do
anything with the dimension right now
I've just exposed the selection name
because that's all we're interested in
we want to get the selection name like
as the example says d1 at sketch one
that's just an example of what it will
be but the name you use to select that
sketch that's what we want to get and
we're going to set that to the length
custom property when the user selects
something if you want to access the
underlying object in this case in a high
display dimension before solid DNA has
added all the abilities you can just use
unsafe object but as it mentions as well
in the description used for caution
because you're accessing the underlying
com objector you're then responsible for
clearing up your comm references and
everything else but it gives you full
access then to the whole of the the
SolidWorks object before solid DNA is
added all the extra abilities and made
it easy and you can do that on every
single SolidWorks object so you can even
do that on DNA applique
unsafe object and you can get there
SolidWorks comm reference as well so say
a useful feature
but basically bridge the gap while solid
DNA has been made
so with this dimension as we mentioned
we want to get the selection name and
it's as simple as that so wrong
selection name equals now we want to set
the sheetmetal text and we want to also
wrap it in quotes because to set a
custom property to a you know a specific
name you need to wrap it in quotes so it
isn't just a string so drop it in quotes
we want to do backslash quote backslash
quote and then the value selection name
so that looks a bit funky to look at but
that's just you start to make it so that
we can inject properties like this in
the curly brackets as your opening and
your closing double quotes which don't
get included in the value that's to you
know start this string and then the
backslash quote means to actually put
quote inside the string itself so that
if selection name was d1 sketch 1 we'd
end up with do you want to sketch 1 Lata
that's though and property that would be
sateen and you'll see that anyway when
we select their dimension so let's go
and run this code now and let's see it
working so whenever we select a
dimension the sheet metal tax box should
update so we'll open the part go to the
sketch and you see there's nothing now
if we select this and that we go d1 at
sketch 1 and it's put the quotes around
so it's automatically set you know the
property for us and that's what we
wanted
now we man I want it to be like that we
may not want this to happen the instant
we just you know click air a dimension
when that wants a button here that says
you know copy over you know get selected
or something and we might also want that
button to only be enabled if there's a
dimension selected so let's quickly go
and do that so we've got the code here
which is when the model changes at the
selection changes so first thing what we
want to do is change this code to cut
this out so keep hold of that and what
we're gonna do is add a button to the UI
so we want to do is the length we've got
a stack panel right now we don't really
want to start all that I want a little
button here so we're going to make this
an extra column definitions
which can add an extra width here and
then we want this to now be in the
second one over and then we want this to
be two and two so this is just a small
button and then in that section there we
want to add the button so let's go ahead
and do button content equals and then
we'll just do two little arrows - you
know we can you could add an image to
this make it nicer looking but we're
just gonna make it really simple and
just make a bottom with an arrow for now
and this wants to be in that's not a
valid attributes I'm using special
characters here okay let's just use yes
it doesn't Lala I'm not sure what the
breakout will be okay let's ignore that
for now I just do oh yeah I just do get
move it to the right column you can also
see it's it's quite high here because of
the we really want it to be the same
height as that so let's just split these
off into some rows
we differ from two rows and the heights
are just Auto just run them to size to
whatever is required so it's now got two
rows this is gonna be in the second row
the text box now is gonna be outside the
stuff pile um because we're no longer
stacking we using the grid itself touch
pop lock is fine where it says this is
red dot Row one
same here got the margin we gonna have
to move over that's fine there but it
wants to be read doctor column 1 this
wants to be column 1 Row 1 episode 2 one
just moved everything over just add the
margin back to that
so they've got like a a length for the
button that's to get the property I
would probably want that to be actually
no I don't think that's use auto stead
of sizing it to a set size let's make it
just as big as it needs to be so there's
the button we want we'll call this
button
thank you just call it length button we
know what it is and now we want this to
be disabled by default so is enable
that's false so they can't click it and
then in the code-behind when the
selection changes if we do get a
dimension so if we get to here we then
do the red dot run UI thread just in
fact that states a different way but
their needs are disabled as well so we
don't need to do for each we can
actually just do if object dot any any
other dimension so have dimension so we
check of any selected object as a
dimension then we spin off to the UI
thread and we simply say this dot length
button not is enabled equals if we have
a dimension so they can't like it now
until the other dimension let's go ahead
and add an event to that when the user
clicks it so click new event go to that
event and now this is where we paste the
code back in for this selected objects
so we want to do the same as here as
well copy and paste all of it
we want to get the we know we've now got
at least one dimension so we'll do first
or in this case the last dimension so
I'll get the newest selection will do
objects last where it's a dimension and
we know it's got one because the button
is enabled and won't be enabled
otherwise you could do an extra check
you and do last door default so we'll go
ahead and do that and then if we don't
have a dimension will return so get the
newest dimension the watcher we have one
and now set the link button text so now
we change this to the text
oh I've enough pasted back in the code
that with y'all
I get was they're making a bit of a mess
here so the last dimension get the die
mention name so get the variable then
set the variable so that we do the last
dimension casting to a dimension because
we know it now is 1 and then with the
actual dimension that we've got we set
the dimension selection name to the
selection name so once we've got the
selection name we then just simply set
the length text to equal the quoted
string of the dimension selection name
and that's it so now we've changed it
from being whenever it's selected to now
instead whenever the selection changes
we enable and disable this button so we
know if we have a dimension and then if
they click the button with a dimension
selected we then get the dimension
selection name and set it to the text
box so let's just run that and see what
that does so open apart
and then you can see this button isn't
collectible right now so select a boss
still not clickable just go into here
select a dimension you can see it's now
selectable so now if we click that
button you can see then set it to the
value and that value if you just
double-click this dimension you'll see
it's here this is there you know the
value it's pulling in and that's what
was required so now we've got that we
click apply just acting the sketch and
then we go you can now see the evaluated
also figured out that it's that sketch
and we go to the properties it set the
value for us as well so if we just
change that to another property today
say we don't want the length to be that
one and we want the length to be here
you can see we've got that selected
already I'll think I know we're still on
the dimension select the dimension click
get it's gone to to click apply
ha we are in an unknowns ah so there's a
thing we're in and because we're editing
the part right now so we're like editing
a editing the extrusion it's unable to
get the mass while it's on editing so
right now this is just throwing and
bobble up and crash so what we want to
do will quickly add now this is
something you don't always want to do
but in this instance we do well add an
option - don't throw on error and by
default we'll set it to true cuz I think
we don't really want the crash when we
can't get the mass property vods some
code here you don't have to add this to
your project let's see solid DNA I'm
just fixing it so every true don't throw
on errors just return empty mass so here
we just done want to double check if
don't throw on errors we'll do something
else we do this so if we don't want to
throw on ours we just return that and
then it'll still throw if it's an
unexpected exception we need to do it
here as well so if something happens
that we're not anticipating works
blessed we throw in here if something
like this crashes for no reason then
it'll still crash but we're looking at
things like SolidWorks hasn't crashed
it's literally told as it's unknown and
we originally decided to you know crash
on that exception we're changing that
behavior now to not do that and we're
going to do the same here so don't throw
on exception
return that else do that
and that'll fix that issue so let's just
run that again
open apart let's go into the part and
now let's click apply while we're inside
and it sure will notice the mass should
go to nothing play you can't get the
mass while we're inside because that's
suppressed and it's unknown but that's
fine it hasn't crashed or change the
dimension length to this one yes and
there's two click apply
use these change to this one then if we
exit the sketch just check master
property still works yeah we've got the
mass property so there's the extra
feature now you can get hold of any
selection at all and do what you want
with it and we've used it here to get
there the dimension so as well as
dimensions we've showed you quickly that
I've added the support for as well as
dimension a feature and features are
absolutely huge there's a lot in them so
once you get a feature so let's just do
hope you don't run this code this is
just to quickly show you some sample
code so a you do
if it's a feature so you do have a as
feature then you could do a dot ask
feature and then that'd be the feature
you're given and then with the feature
they can also be a lot and a lot of
different things so you can see here
they can be attributes bombs headers
absolutely massive list of features so
you'd check which one you expecting all
you'd filter by it just the same way and
let's say we're expecting a surface
flattened data you'd say if it's a
surface flattened data and then what's
going to be added I haven't quite added
that yet it's going to be similar to the
dimension they'll be as surface
flattened data and then you'd get the
surface flattened data object to do
something with so that you can see and
you can query all selected objects and
then as well as features it's going to
add every possible selected object so
you'll be able to query every object and
find out what it is and if you don't
want to do is it's a dimension if it's a
feature you can do object type to get
the type and that will return you know
the type for you to display or do what
you want with it's that's the start of
handling selections in solid DNA and
again you can see how much easier it is
to to do this and to get a dimension you
just check it here and then to get the
dimension you just check if it as a
dimension and if it is then you just do
as dimension and that's it you've got
the dimension object and it's all
disposed for you by solid DNA so there's
no messing with comp just makes it
really easy so keep an eye out on this
that's all get expanded a lot in the
near future and that's it for this video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>