<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# SolidWorks API Tutorial - 05 SolidDNA Editing Add-In without closing SolidWorks | Coder Coacher - Coaching Coders</title><meta content="C# SolidWorks API Tutorial - 05 SolidDNA Editing Add-In without closing SolidWorks - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# SolidWorks API Tutorial - 05 SolidDNA Editing Add-In without closing SolidWorks</b></h2><h5 class="post__date">2017-01-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ky167C9D24Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so this is just a quick video I'm
showing you some new techniques for
allowing you to debug SolidWorks add-in
on the fly without having to close
SolidWorks
so there's been a recent post on the
forums where it seems like a lot of
people have interested in being able to
edit code you know I got it your coding
Year add-in without closing SolidWorks
so I made a really quick modification to
solid DNA to allow this I wouldn't
bother going over recreating the whole
application I basically copied the
previous tutorial number for copy and
pasted the whole thing in just rename
the classes and then I simply moved out
the solid DNA integration class and left
the add-in part in a separate add in
here and then in the separate one so
these were a single project to split the
projects out into two so this was the
new empty project I opened up the custom
properties plug-in and I then just
removed from the top of this class this
bit of code so this bit of code was just
in here always one like every previous
tutorial and this function here didn't
exist so I simply caught this out
created this new class project and then
pasted this in to the new class project
and just give it a different names this
one was called solid DNA at an
integration and the other one custom
properties just so they've got a unique
name and then I added this over load
which is now a new thing so instead of
automatically loading plug-ins you now
have to specify explicitly which one you
want so you can do that whether now a
path to a file if you want to have them
so you can unload them fully and edit
the code or if you just prefer to
reference them directly say this project
has a reference to the main ad in the
main plug-in I could then just do
plug-in integration to add plug-in and
the type of custom properties here I had
DNA plugin which is just this let's plug
in here and that would load how it
originally loaded and then you couldn't
fully on load to debug or you can just
go and type the name of the DLL this DOL
has to go into the same location as the
main loader so the the place where
you're adding integration DLL gets
compiled which of your right click here
and go properties you have to build you
can see bin-debug so that basically is
if you right-click the project itself an
open folder in File Explorer and then
you go to bin debug this is now your
path where you have to also place this
main project so you'll see the main
project is here so in order to fix where
the DLL for this gets output simply
right-click properties and then in the
build you can see we've stepped up one
folder and then gone into the solid DNA
dynamic load plug-in which is this
folder here
so we've basically started in here which
is the default we've stepped up with the
two dots then we've gone into this
folder and then it's been and debug so
that you can see there ends up
outputting in the main this main folder
so this compiles into this folder beyond
that once you've created this a new
project here don't forget to make sure
you have make comma sembly visible and
then make sure to also use the add-in
install the tool to register both of
these dll's because this one's your
add-in for SolidWorks and this separate
add-in contains your task pane user host
control which needs registering by comm
as well so you go ahead and register
both of those and then that's
effectively all there is to it so other
than moving out this this class and
adding this code here and then making
sure that these compiled to the same
folder everything else is the same as
the last tutorial so that's why I'm not
going to go over a specific you know
doing this from the start again because
it's just a minor tweak so we've done
those two we haven't changed anything
else in here from the last tutorial
after we've changed like the text here
just so we know it's different you know
but no functional changes so that's that
we then want to specify can see I've
specified my exact path here to the file
and this is so that I can load and
unload without having any reference in
this this add-in so whatever this atom
references
then it's gonna be stuck in the
SolidWorks
domain and you won't be able to unload
so but I just explicitly telling it
where the file is we get around that
limitation so to get that file path just
right-click on the loader plug-in open
folder and file explorer go to bin-debug
where you've seen these files and then
this is the file we want to load this is
the add-in of this project here
hold shift right click copy as path and
then in here you just put the letter act
and then paste and that gives you the
location of that file now we just press
f5 so again if you've gone to the
properties of this plugin
like the previous ones and then the
debug we've told it to start SolidWorks
as the external program then you can
just press f5 to start the program so
let's do that
and let's check that this add-in loads
so you can see it's just loading there
and then you can see is now here solid
DNA dynamically would plug in so that's
exactly the same I Dennis the last
tutorial I've opened this modules window
which is debug windows modules and then
sort by name and you can now go and
scroll down to the name of the DLR we
loaded which is here solid DNA dynamic I
would plug in you can see that we've got
an app domain over here inca basis is
the only place that's main is loaded in
this solid DNA plugin domain so we're
now in full control so when we go to
unload the plugin so let's just do that
in SolidWorks we just uncheck to unload
yes it disappears from there but also
you'll notice now it's no longer in here
only the the DLR for this load plug-in
is still in so what that means now is we
can go ahead and instead of just
stopping which will close SolidWorks
just go debug detach all that will leave
SolidWorks running here now we can go
ahead and change the code in this main
it's free to be edited so we can go
ahead and type side DNA new and that's
it it's built if you have any trouble
building this it might be because you've
accidentally changed one of these two
sets of code so if you do that you have
to restart SolidWorks however these two
are this is the solid DNA library and
this is just a blank loader that does
nothing more than this bit of code here
so once those two are done which
effectively almost all the time you
shouldn't have to reload SolidWorks
because they don't change even if they
do and you want to say carry on
debugging anyway just right-click on
your solution configuration manager and
simply uncheck these two here so that
they don't even build anyway and just
bear in mind to recheck those afterwards
in case you change code they actually
want to build so just build and that's
fine
and then now to reattach and start
debugging or you know to see this now
new DLL I just go to debug and attach to
process instead of pressing f5 and just
attach to the run in SolidWorks instance
and now we're attached we should see
that we've still got their load plugins
that never unloaded just go to tools add
in solid DNA and okay and that's a load
in and you can see got the new title
maps that's the new code let's do that
once more just so you understand how it
goes nice and quickly so tools add-ins
unload that removes back in Visual
Studio detach all change this to your
nation control build debug attach
process jump back to the SolidWorks
process go back to SolidWorks tools
add-ins and click to load and then ok
and you'll load in the new DLL with the
new text so you can see you can
effectively do poke on the fly you can
you know detach from debugger change
your code and then reload and that's as
simple as that now to make it even
cleaner you could just extend this ever
so slightly and maybe make a plugin
loader that just has a button that asks
for and you know add in over a plugin to
load and then from that you could call
someone look at the code
so yes I'll actually make a little bit
more code inside solid DNA to support
that type of loading so that you can
have sort of a an add-in that just adds
a nice quick button on the menu to load
and unload the add-in nice and quickly
but for the purposes of you know proving
the point of being able to edit your
main plug-in code without we start in
SolidWorks it's all now integrated into
solid DNA so we'll do a bit more on this
further down the line you know once we
need to what this would just mainly to
fulfill the needs of people that were
wanting to do this type of thing to you
know find it useful to be able to carry
on changing code without restarting the
whole of SolidWorks every time so now a
short video but I hope you found it
useful</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>