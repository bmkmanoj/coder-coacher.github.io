<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# SolidWorks API Tutorial - 02 SolidDNA Creating Taskpane and WPF | Coder Coacher - Coaching Coders</title><meta content="C# SolidWorks API Tutorial - 02 SolidDNA Creating Taskpane and WPF - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# SolidWorks API Tutorial - 02 SolidDNA Creating Taskpane and WPF</b></h2><h5 class="post__date">2016-12-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Cwtx8cVGLlc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in the first video we went over making a
SolidWorks add-in from scratch and this
video we're going to use the new solid
DNA API which is an API I've started to
create with the purpose of making the
SolidWorks API much easier to use so the
first video you saw all the steps
involved in making a solid works out in
registering with calm and then all the
stages to get a task pane view on the
right hand side of SolidWorks and what
to the solution Explorer the whole
purpose of these videos and the purpose
of what I'm doing the SolidWorks API for
is to make it easier so this will be the
first video showing you now how easy it
is to do what we accomplished in the
first video so you'll see what I mean as
we go so create a new class line be like
the first video we'll just call this one
solid DNA WPF add-in and that's because
we're going to actually make a WPF form
in this as well which is a modern UI so
we can make some really clean and
nice-looking UI very easily that's going
to create your your standard blank
project right click on the project click
properties
I want to assembly info make your comm
visible mark before want to add
references to the SolidWorks
in drop files that we had before which
is the interrupt SolidWorks commands
comps document manager unpublished
and now we need to add a reference to so
right click on the solution at the top
add an existing project so we go to the
source code you'll find this new folder
called solid DNA this is in the get
repository if you're following and add a
reference to the project and this will
be provided as a DLL in future once it
grows a little bit more so that you can
just add a reference here as normal and
then in here you can see the source code
I won't explain all this this is the
complicated stuff that I'm doing to make
your lives easier so you don't need to
understand everything that goes on in
these classes but you can you can take a
look for yourselves if you want or
branch off it on get and make your own
versions it's completely open-source and
you can do what you want with it
so we've added a reference to solid DNA
so there's now very few steps to get
your WPF add-in file now as I SolidWorks
add-in so one of the things you need to
do is you need to make sure you create
the add-in integration as I've called it
so we'll call this my add-in integration
and then you just override the new class
which is called add-in integration press
control + dot and it will find using
SolidWorks DNA sorry angel sick solid
DNA and you can see now it's complaining
that we haven't overridden a method so
just press control + dot and implement
obstruct interface and just get rid of
this throw and that's it you know a
SolidWorks add in as simple as that
so if you do a comm register using the
tool I made for installing the add-in
this will fully register and you've got
a fully working add-in and they'll get
fired here in SolidWorks when it starts
up so it literally as as simple as these
few lines of code
so let's just put a comment on here
taste it as a SolidWorks add-in and this
is a specific application startup code
and this runs as soon as you've
connected to SolidWorks that runs and it
runs before the rest of the solid DNA
framework informs plugins which is
things that you can now do next
make a plugin so this is the very first
thing that will get called so if you
want to do any sort of application
initialization creating all your default
values or doing whatever you want just
as it starts this is the place for that
so in this video what I'm not going to
do that because there's nothing to do
there so as we mentioned we're now a
SolidWorks add-in and the next thing you
want to do you don't really want to do
much else in this adding class that's
purely to become an add-in so now we've
created something called plugins so
solid DNA plugins and this is where you
then do all your extra work let's create
a class called my solid DNA plug-in and
you need to implement an i solid plug-in
which is again something I've created in
the solid DNA library
and then you can again click on the I
solid plug-in control dot and implement
interface and you can see we've got here
add-in description my ID in description
and you can guess what this is for now
so before when you had all the
complexities of doing the comm
registration and everything else now all
you need to specify and you don't even
need to specify these it's optional
it was default to a description of not
is your add-in title and description so
the thing that appears in the SolidWorks
tools add-ins menu and then you've got
the functions of when you're connected
to SolidWorks and when you've
disconnected so again making this really
easy so what we want to do now is create
the task pane so we're now will add in
we're now integrated we've got a plugin
that a load and fire when were connected
to SolidWorks and we disconnect from
SolidWorks so now we want to create a
task pane so let's first just wrap this
off and do some comments
it's always good to comment your code as
much as possible you can never never
comment too much I'll be a little bit
sloppy on the comments just for speed
here but you get the point always make
sure you do comment and these are public
methods all this can be connecting to
SolidWorks
and I will need some private members in
a minute so to create an add-in so to
create a task pane you've guessed it
I've already made a solid DNA version of
a task pane that makes it much easier
so let's store a variable here it's
called task pane integration and you can
see it's a generic type so you open up
these angle brackets and it's expecting
a host of a user control so we need to
go ahead and create a user control and
that's the thing that's going to
actually appear as our our control in
the task pane let's make the user
control let's call it my task pane UI
and it's created a blank um user control
app before right click over here view
code and then all we have to do this
time to get this class ready again you
still have to specify the prog ID so
type prog ID control dot and it'll pop
up with you recommended using namespace
and then here we have to pass in a
hard-coded unique value so there's no
way around this because this is a what
you call a compile time value this is a
hard-coded thing so when reg as and runs
it can identify this class so all we do
inside this class just make a region
again have it members will store a
private constant string and we'll call
it my prog ID
and we'll make it angel sex dot solid
DNA dot task pane something like that
our unique prog ID book
SolidWorks to find unloaders and then
the only requirement if you want now to
make use of this as task pane
integration you'll see in here well you
actually see here it needs to also be of
type I to spin control so as well as
being a user control which is a normal
Windows thing we need to then be an eye
task pane control so control dot and
I'll show using angel six solid DNA and
the only thing that this interface needs
is a prog ID get a property so we've
created the value here and to support
this interface we just want to make
another region or public properties
string and we call it frog ID and it's a
gutter and we just return my prog ID and
that's all of us to it we've now
implemented a UI that's going to be
injected into the task pane and
obviously we need to then use this my
prog ID and the prog ID up here so that
is the whole the entire UI right there
we don't even need this you know
constructor here because we're as you'll
see later we're going to inject a WPF
form directly into this so now to make a
task pane you just create a user control
which is what this is yet
add on this prog ID you implement I task
pane control and then you create this
exact property here that effectively
returns that prog ID so the whole point
of this is just to simply create a hard
defined class with a hard-coded value
here that's unique so that it can be
registered with reg Azzam and then the
solid DNA library does everything else
so there's your class that's all
all now ready to be used so go back to
this variable was a task pane
integration that we were creating and
now we're going to pass in that task
pane UI user control we just made as the
type I'm going to call this task pane
and then when we're connected to
SolidWorks we now want to create that
task pane so I'm task pane is new task
pane you can see it's asking for
SolidWorks so we pass that in because
we've got it anyway and then we're going
to specify you can specify you an icon
if you like
so let's come to it an icon there's also
some helpers plugin integration dot
plug-in folder will give you the local
path to this solution because it's going
to be loaded as a plugin so if we have a
existing item and we just go to the last
tutorial and we get the same icon logo
small we make sure it's copy to output
and then in here we the icon is then
path combine the plug-in folder and the
name of the file which is logo small dot
PNG and now you can see I've also added
this additional thing here called WPF
control as part of the task pane
integration so you could leave it to
that you wouldn't need to do the WPF
control so let's just well we might as
well do because it's so easy but if you
left it like this
the next thing to do is to simply say
and touch pain the add task pane now the
task pane will also automatically
disconnect from SolidWorks as well as
it's that that is your entire code right
that's all you need to do so let's just
delete this throw so you can see already
this this class is the only thing in our
add-in in our application that's it
that's the whole application right there
that's a fully blown working SolidWorks
a tin that goes into the task pane
registers with these values and now
we're also going to go one step further
and add this WPF control so to make a
WPF control which I'll do some tutorials
on separately which is basically a
really clean you eyes I keep mentioning
you just need to right click on your
project add new item you want to go up
to the search here type WPF and you got
this WPF user control let's call this my
atom control and now because we're
adding WPF directly to a class library
sometimes it doesn't always add
everything you need
it's added presentation Korn framework
we also want to add system zamel which
is one thing missing so right-click
references add references go to
assemblies type zamel and i just add
this system zamel and here's the user
control so this is the WPF again I'll do
videos on this explicitly but for now
just go over to the screen here open a
square bracket type button content
equals
test and now we can see a big test
button that fills up the whole screen
and this is WPF so now we want to use
that as our main control and the task
pane so all of you have to do is go WPF
control equals new my adding control and
that's it as if your whole add-in so
let's test of this now works ctrl shift
B to build the project open up the
installer tool browse to the solid DNA
add-in and click install installed
successful now one thing that's useful
here is while we can debug so when you
start getting issues or you want to
check things are working and click like
breakpoints here in the gray line so
like we want to make sure when we're
connected to SolidWorks we get here in
order to debug in to run SolidWorks just
right click on your project here go to
properties debug start external program
and then click the Browse button and go
to Program Files
SolidWorks core SolidWorks and there SLD
works exe and then that sets the start
up path now as long as this is bold and
black meaning it's the start of project
if it's not right-click and select set a
starter project you can now just press
f5 and this will spin on SolidWorks it
will then load the add-in and there this
whole system and we should get a break
point here that the add-ins fully loaded
and about to you know create our task
pane so fingers crossed that should all
work first time so there we go so now
it's hit this it's telling us that we've
connected to SolidWorks and what do we
do so we want to create a task pane and
add it so press f5 to just jump over
this and carry on and then let's go to
SolidWorks and see what's happened I
know here we can see you've got there
SolidWorks angel 6 solid DNA Arden which
is the tile we passed down I've got the
big task button that we made
in the WPF form you've also got tools
add-ins and you can see my add-in title
and the path to where the atom went you
can see how much quicker that was now to
make the whole add-in this this class
which is 77 lines including a blank line
and all comments this class alone which
is really small is everything you need
to make a SolidWorks a tin and a task
pane and getting what is now a WPF
controller we can now make our entire
form here which is a really clean nice
way of doing add-ins it's really easy to
make UI and WPF so you're gonna have a
lot of power here to design visually
what you like with the atom which is
what we'll do in the next video but
already I hope you can see how useful
this solid DNA library if you will that
I'm creating is going to be it makes a
din as simple as that so that does the
comm registration and the add-in to hook
into SolidWorks and then the plug-in is
even create as many of these as you like
you simply define your application
through plugins so we've done a plug-in
here and we want the add-in title and
description to be this when we connect
we then use this to create a task pane
which is effectively two lines of code
if you put that in one line and we set
the title and description so super super
easy I don't think it could be any
easier so then a short video but the
point of this was to just give you a
taste of what this solid DNA library is
going to be capable of and the next
video will be on potentially some custom
properties or doing something with an
open document to start doing some actual
SolidWorks API stuff and then we'll move
on to the things that you guys wanted in
the SolidWorks API forum requests so I
hope you enjoyed
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>