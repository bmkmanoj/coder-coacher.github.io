<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# WPF UI Tutorials: 25 - Advanced Cross-Control Syncing | Coder Coacher - Coaching Coders</title><meta content="C# WPF UI Tutorials: 25 - Advanced Cross-Control Syncing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/AngelSix/">AngelSix</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# WPF UI Tutorials: 25 - Advanced Cross-Control Syncing</b></h2><h5 class="post__date">2017-07-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TkYge1sZD5k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in the last video we made the settings
page text entry control so it takes a
quick look at that and that's these
controls here where you hover over you
can click a button tightly text can
escape to cancel or you can enter to
save which coming off is not say you to
that time so let's quickly fix that book
I'm guessing if we click the button here
well yes that's a that'll be a focus
issue with the edit text box so in the
text box here by default binding to text
it'll dates the view model because
there's two way binding so when we edit
the text and the text box is meant to
update the view model and likewise when
we update the view model is mental data
text box which it does but by default
text boxes don't update until you've
lost focus and that's why when we click
the button outside of the text box it
lost focus updated and then Ram moment
press Enter the text box was still
focused at that point in time so quick
fix for that it's full update source
trigger on the binding and just set it
to property change and I should fix that
little book with the text box and you
can really do that on any text box
binding unless you have a reason not to
where you don't want it to update you
know if you go now do that enter and
that works the other thing I think
wanting to do by just need to our
guesses I want to like kind of double
click to edit I don't have to have one
single you know move the mouse and find
a place I want to double click so and I
guess you could double click to ask I
don't think you will on double fit to
escape that's more of a you know you
just really want to door click to get in
and then you you click to save so let's
add the double click that's nice and
easy so we'll put it on the main grid so
you can double click anywhere
and then here we'll do red dot input
bindings still mouth binding the mouse
action see which one is click here press
f12 it will go to this which is a mouse
action and then in here these are the
values we can have so we want left
double click and then the command on
that will be that ready command and
that's all there is to adding a double
click to edit so now if we double click
that's better we can go ahead and type
double click times much much easier
so start done so start a comment here
the book flips to edit when did we go
and then I guess the next thing is let's
start putting some actual values in here
so right now we just have text entry
control I believe in the settings view
model we already did in the last video
the properties yeah so we start binding
them to these real things name username
password email it should just be able to
now be finding equals binding name ok so
not binding Facebook context so should
have name and forgot already
good for long-term memory name user name
password email and then run this I thing
I just need to compile into show
or not so let's see why this is no
longer working so this right now we have
a we've set the data context here still
that needs to change back to design time
otherwise it's overriding our explicit
setting nope still not okay so got text
entry control case this week set the
data context and they are are we in the
right place inside of control
the settings control has the data
context set to settings which will be I
think a then we bound it to a constant
we have so I'll run the default
constructor and that's why we haven't
actually set them all so in the I think
we did in the settings design model was
it so view model application settings
okay we never actually made them so I
thought we'd done a settings design time
model we haven't even done that yet so
let's quickly make a second design time
model just go ahead and add a new folder
then pick any existing design class copy
paste and then this will be
settings to update all the references
and then a constructor of the design
design model so that's all already done
the constructor of the main one in a
design time will have name equals new
I'm sure we've done this I'm sure we
have no okay Dave you're good so we'll
have the label for this we call in the
name and the original text it was my
name and we'll have user name and
username
Luke password which is something we'll
update in this video open now is just
text and the email will be email and my
email now we have a design model to
rename the class click here rename file
I'll keep zooming in class we don't file
and then as usual in the settings
control will now do at least a design
time data context is the first time I'll
have managed to type the design time
binding right nope why do I never
remember this
static Court instance so close this time
instance there we go you can see we've
here lost all style there we go so now
we've got their data which is looking
right the it's not quite looking right
in the design time because it's not
hiding the the edit text box but let's
see if it looks right at run time I just
forced us to bind to well but for now
until we do the settings view model
until we pull this information from a
real back-end storage
let's just put same information in the
main constructor that we can then just
remove at a later date so to do remove
this with real information on our what
for now will does not in so at runtime
we should see the same thing we've made
the exact same values you can see that
looks correct here so we've just got a
slight design time glitch if you will
where it's showing the edit text field
just the underline as well strings with
not the value with we don't have a value
that's why it's not showing the value
but it's not quite showing correctly the
same here it's showing the actual value
so see we can just fix that so edited
text there fade in property well to be
honest a quick fix would just be a pasty
zero by default that's just still word
because it's going to animate him when
this becomes editing and it's going to
override that anyway so I think that'll
be a perfectly adequate fix yeah so
that's fixed the design time the next
issue would have now as you can see
before we line these up by having a
single grid with a column here in a
column here and now these are
independent we have this staggered
effect
so we need to fix that so I think what
we'll do is we'll wrap all this in like
a cutting is really wrapped in a stack
panel but we will first make it so we
can set a proxy on our control to
Delaine you know the width so this will
we can change the width per one via an
attached property or a dependency
property and then we'll the main thing
that will wrap it in the stack panel
will add an attached property that will
then enumerate its children find the
largest width and then set them all to
that I think so let's see how that goes
so I guess the first thing is in this
control the actual text entry control we
need 1/2 times first cleanup this will
now need a dependent it had dependency
property sink that prop DP tab twice and
then you can see it's highlighted the
end which is the type we want in this
case we want I think a grid column
length is a grid length for the type so
we will want a thread length and of
course let's now finish the proxy delete
that and start again now I've got the
name space probe deeply tab twice the
griddling and then tab again a name will
be call it label width and tab again
take me to the owner class down here
which will be this so text entry control
tab once more and then we're set a
default property which we're going to
change anyway so that's it press ENTER
at that point and this one now complain
that it wants to convert it to
the new c-sharp seven style because of
my editor file and this will be as the
label with alpha control you can then
see what dependency and it's condensing
and now we want this to be a default
value we also need it to be on property
changed so default value will have
Gridlink
auto so by default it'll just be
whatever it wants to be and then the
callback will create a new one so
property change callback we'll call it
little bit label which changed call back
and then we'll make that down here and
then not for avoids expecting yet but we
know it's of type property changed call
back so we just type down here property
change call back press f12 it'll take us
to it so once these values
and the comment will be called when the
label whip has changed and then D is
going to be the actual or will it be
they'll be dis control because that's
what we found the texts rented control
on its are still complaining up
non-static field or property they're
going to be static obviously yeah so
that will be probably static there we go
so this will be the instance of ourself
of this control and then the e will be
the value with a new value so every time
the label width changes which is a grid
length so that means now its first show
was put a breakpoint here and let's show
you what you can do it as it stands
right now so now this is got a label
width value so in the settings here we
can say directly label width as though
it's a property on control let's say 400
and then we run this now we should get
there we go says hit this callback and D
you'll see will be this text entry
control which is the one that will have
a label while it's basically the one
would put their value on and then e dot
new value I think it's the new value now
will have their 400 from the old value
is ordo and the property's libel with so
from this we can now set the actual
value on this control so in here when we
get the value we want to change the
width of this not this text block but
the column it's inside of which is the
first column so it's this column here so
now instead of the width being auto or
we can leave the width is auto we want
to name this and we'll call it a label
column definition and now we can edit
that one the label what value gets
changed
so in the code-behind will first say
because this can also have say in here
what you want to be careful as well this
is a string so if somebody could do that
and we don't want that to crash the
application when it's invalid so in here
we first want to wrap this in a
try-catch because the user might type in
an invalid property clicked and valid
then we will not return so if we need to
set the the dr's
text entry control so this the calling
controls
label column definition so basically we
get an access to this column we want to
set the width to auto which is basically
what it is already by default so we're
basically assuring this it's going to be
if somebody type something invalid we'll
set it to just auto you could also add
in here some no debugger which are
probably should add oh hang on we are
yeah
when defining debugger that's just there
we go so this will break if we're
debugging and so make developer aware of
potential issue so at least we indicate
to the developer who's debugging the
application of the start gate invalid
entries and then we set it to normal
otherwise we want to first yet we want
to convert the value which is a string
to a grid link so try them from the the
friend to a valid grid length so that
would be grid length equals square
length converter a new redline converter
start convert from string I doesn't lose
any try converts
now so we can't do like a track and rill
that's why they're the CAPTCHAs they're
so convert from string and then e dot
new value is the string which comes as
an object's let's just force it to a
string and if that works then set the
column definition width for the new
value it's a pretty simple
so again d is text entry control label
column definition dot width equals
griddling what that should allow us to
do now where the link then somehow made
the wrong things oh it's still things
that's just a object we to cast it to a
good length there we go so now here when
we put a value probably up the build
first or rather not here in the settings
command settings or as visual studio
going to crash now there we go so in
here now we should be able to put in a
value in fact that should have already
worked off maybe we need to build again
on here this should be updating this
size maybe just needs closing and
opening with visual studio let's first
try and just run aah so invalid well you
know what we should have done at least
caught the exception so you can see
what's going on also turn on catcher all
exceptions Control Alt + E and then turn
on this one and this should catch every
exception and simply tell us what we've
done wrong so unable to our subject
about grid length to shrink why am I
trying cast it to string I'm not help
convert F convert from strength
and unable the cast of objective type
Gridlink to type strings I am confused
I'm not trying to do that maybe it just
needs wrapping around the whole thing to
convert the return nope okay what there
convert from string let's just see what
the value is because something's I'm
doing something obviously wrong here but
what am i doing
he got new value oh it's already it's
already a greater length how did that
already convert itself I'm sure you have
to convert it okay so it's already a
grid length even though
oh of course is actually no oh we've
made it a grid link that was my mistake
the dependency property wants to be a
string because we want to be able to
pass in text like it actually worked
in fact now I think what we do is leave
is that's working as that saves us
having to do this cast
so grid like there's already a new value
as are already a grid like it's already
sort of been handled by the dependency
property so we don't have to so it saves
us having to do that conversion because
WPF is already done it based on the fact
that we have it done it from this it's
converted from string to the expected
type by default so that will actually
already be a good length so we simply
set the value there we go
so a little easier than well even easier
than before so now there we go so now
you can see that it's disappeared so
let's change this back to 100 say or 10
so now we've got control of
the size of the inner grid column width
from outside so we could set these for
like C C whatever fits so I've got 100
or probably 90 even fits and then you
could do this you could set and we're
not going to do this but I'm just
showing you this is this is the effect
or after court of we want to set the
label width on all of them
and we want them to be the the right
value but we want them to be the value
of whatever C e slightly cut off so we
want it to be the value of what it
whichever one is already naturally the
biggest so we're hopefully there with
that label with dependency property that
can now have you know you can set it on
this control and change the width so the
next thing we want to do is wrap the
whole thing in a stack panel which we
have so these are all in this group all
these are inside now I'm going to make
an attached property that we attach to
this and this will simply then well
you'll see what it does easier to do
than explain is text attached properties
I guess it's kind of small panel kind of
shy of margin so let's just copy that
one we'll call this I know it's going to
be specific to the text entry last not
text entry is it what it is it's a just
call it text entry close reading this
text entry width match and that's what
it's doing and this will match the label
width of all um text entry controls
inside this panel copy that - they're
the type touch property is going to get
boolean we just want you know true or
false
doesn't really matter I'm not even going
to use the value as such
so in here we get the panel which is
fine then we want a front of function to
we want to set the width initially so
the problem we'll have with design time
showing this correctly as this loaded
won't fire so we're going to call you
know we'll wait for it to load then
we'll work out the widths and then we'll
want it to size changes but in order for
the design time editors will also show
we'll call it at least once here anyway
so call set widths initially that's also
a counts design time kit fairly right
and to work for the pot we haven't made
this yet but we know we'll have a
function called sat widths which will
implement in a minute
then you'll wait for the panel to load
as before and we also want to fix this
because this is a we've found out before
that this can be called more than once
so let's make them turn this into a
single fire so we'll have a rooted event
handler on load is it goes no then we're
going to define that so unloaded equals
and then back and then we'll have panel
dot loaded plus equals unloaded click in
today on play big event or hook into the
loaded event as soon as we have loaded
we want to on hook so we don't fire
again so if this gets called more than
once we don't fire it more than once
then again so on Duke
here we then want to set the widths of
all the child controls and then I guess
also for every child similar to the last
loop we want to hook into any textbox to
entry that has its its size changed
because then we want to recalculate the
widths so first we want to ignore
anything that is not a text entry and
we'll have to update this one we had a
password entry field as well but we'll
do this for what we currently have and
come back and fix so ignore any non text
entry controls so child is text entry
control control and then it is not so
basically if it isn't a control then
continue the for loop ignore this one if
it is a control if it has a text entry
control then we can do control dot label
which is the only thing that's going to
affect and we don't have access to the
label do so we need access to the label
so let's first jump back to text edge
control this is the only thing inside
that column that's going to affect their
width so let's give this a name and this
can be label then in here we now have
the control dot label
type control that label and dot size
changed and then every time the size
changes so I'm just giving them unique
names I'm not using them anyway so don't
really care what the names are so when
the size changed just set the width
again
so now what will happen is when we
attach this to this stack panel here
which will be like so so now we have an
attached property on here that's true so
it'll fire come into here of course a
twits message mainly again the designer
to work then I'll wait for the panel to
load once it's loaded it will call set
wits again which will you know update
the widths will iterate through the
children and then it will loop through
all the children and we'll start
monitoring for the size change too and
when the size changes we will set the
width again so all in all we're
basically kind of keep a monitor on
whenever the children's widths change to
then call this function so this is now
going to update or child text entry
controls so their widths Marcus the
largest width of the group and then in
here we want keep track of the max size
which will be a double maximum width
then we'll have preach child again in
panel dot children but a pasta panel in
so that is the panel add a comment
which are then panel bot children again
we want to ignore any non text entry
items so for each text entry and we
don't want to get there we're going to
set the map size equal to mass dot max
so the biggest one of the to the already
existing map size and the child control
Zelda for this text entry control the
cast control dot label dot render size
now the thing with the render size is
that that's the value we want except the
render size doesn't include any this
padding that we have this margin rather
here so the render size is that you know
the render the margin is excluding
rendering is simply a spacing so we need
to add the margin as well so we need to
add the left and right margin so I'll
control label dot margin dot left plus
control dot label that margin got right
so that will find I know this value is
larger than the other controls just look
through every one and simply find the
biggest value once we have the biggest
value need to loop the children again
each child and all the text countries
and then set each child or each controls
to label with value to the max size and
that's doing what we did here when we
manually tighten them in in essence
we're then updating that property so now
it will be the control dot label
and then the attached parasite a
dependency property a rather control dot
label whipped where the dependent across
C equals max size and that needs to be a
grid length so we actually need to do a
new grid link to looser compact we can
we can move this off outside so we're
not creating it for every loop and then
the converted art and Butler scan all
the outside and I keep doing in here on
grid length equals converted after there
we don't need the variable now get there
in a minute
you're good length convert it dark
convert from strings and then we'll
simply take I don't does it convert from
forest of convert from double absolute
just to convert from strings and just do
much size doctor string so cast the
double back to a string convert that to
a grid links and then cast that to the
grid lengths as well and then finally
just set like grid link there so that
should first iterate all the children
find the maximum size width wise of all
of the children in the panel and then
once it's found that it sets label width
value of each of the controls which we
know from here works so when we compile
this should already show in line which
it does so which is cool so that's it so
every run that that should be
automatically in line and they'll go
they're all in line now and then if we
don't know whether design time will be
smart enough for this wherever we were
to say we move those two they should
shrink
oh and they though it's actually it's
working
I think it's working no it's not well I
think what you have to do is cost and
then you have to build just because of
how the design time is not going to fire
the events so there you go it's now
align those two to the right size you
put those in or line them up here so it
works in these on time it's just that
you have to compile if you change the
value to see it which is nothing so
there's the values there to test it this
works with the size changed which we
named this class first I mean in the
file again cute in class there we go
so let's go to the text entry view model
and where we edit the text let's change
that and I said it to label and then
this should fire the size changed event
which should we calculate the labels and
everything should stay in line
so we edited this one say with a longer
name you can see everything's moved
stayed in line we had to keep two small
values does the max value reset looks
like the max value doesn't work there so
we need to tweak it worked one way
worked going larger what didn't work
doing smaller so let's do a breakpoint
on size changed and run and we'll hit
this a few times on startup let's ignore
that a minute now if we were to go
smaller its ignore that one a minute
because that's larger than password to
no password as we go smaller should
definitely reduce now to smaller size so
let's see now that hasn't actually fired
a changed event so I see what's going on
there we have it's not going to change
size because we've made it smaller and
it's already set to a large size so as
well as monitoring for size changed we
need to monitor for the label text
changing as well
because that will effectively be if the
text has gone smaller then you know the
available size so I'm hoping as a text
changed preview text input wise it an
input content cable not label is a text
block and I don't really monitor the
view model for changing I'm just trying
to think of we should have
that's a look at the control text block
so you could monitor the binding you
know actually monitor for the the view
model binding but we don't really want
to do that because that binding can
change we do want to monitor if the text
has changed
sure text block should have an event for
the text changing that tortures hit test
as mouse captures visible ki aapki down
maybe layout updated would foe I think
layout of data desserts refire so let's
try that one
so now if we go smaller don't care about
the first one so this one is now Oh
laughter now it's gonna update because I
come out of edit mode maybe or is layout
updated every time it's rendering yes
we're going to hit this or let's just do
a console.writeline
just to see what's going on without a
break point because I think every time
with we're focusing and on focusing is
rear end doing which is you know it's
fine there's no issue with that but we
just want to see in the output let's
clear that make it larger and then you
can see they're threatening palace
trended a bit too much for I mean this
will work now about anymore so if we do
that it was fired but it hasn't actually
worked I will need to also remove the
label that gets tricky to go smaller
actually because now we need to remove
the label width to set it to auto before
we update so we'd have to loop each one
we'd have to to control label width and
then this are I'm guessing will not
update because we're going to have to
allow the UI to update first which is
going to cause like a glitch going back
and forward so in fact now saying now
this should be working because it's the
render size that we care about so even
though the the control oh I know we can
fix this I think by default if this was
where's the width and this wit for say
200 and the background let's just let we
learn one background of this was red
they go to the issue is the controller
stretching so what we need to do is
horizontal alignment left so it didn't
stretch another render size would be
correct so now we fired an event when
this changed it would work we don't want
we don't miss why don't we don't little
layout updated that's a bit too
aggressive I mean that will work I just
leave that in a minute too to show that
it works because now it will fire you
know over actively but it will update
and it will shrink so you can see there
that already updated that's gone smaller
that's gone larger so that's working and
some people might be happy with that but
when we've looked at how many times this
thing fires it's a it's a little too
over-the-top so I'm hoping there is a
better way I mean I know it's just
technically the layout when it's drawn
but it's not really we don't care about
that one like the resized but the size
change isn't firing when we alter in
fact no I think this I think the size
change will now change because of the
horizontal layout as well so I think
that'll actually work no just with that
horizontal alignment because you've
changed the text and now it's always on
to be aligned I think this will fire
when we make them smaller it turns up to
a Fire's as we expect change this to a
yeah so it's now firing correctly so
there we have it there's the you know
the Auto align have you will to keep
things that are these are technically
separate controls but you want to kind
of align them as if it was just a group
grid we've got the double click so we
can edit the controls and the next thing
we want to do is get the password box in
so I'll do that in a separate video
because this is a nice self-contained
video and I know people do like smaller
videos where possible so because we've
got to a kind of conclusion here we've
got to a good we've done a solid task
it's all
work in the next task as I clearly
defined new thing to replace this with
an editable password field not just a
plain text will stop this video here and
then the next one we're going to do this
password field so just before I finish
it let's just revert back that change in
the text renting view model to original
text and then that takes us back to the
app ready for the next video let's just
double check before we go yeah you can
double click and escape yeah and you can
press enter so that's that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>