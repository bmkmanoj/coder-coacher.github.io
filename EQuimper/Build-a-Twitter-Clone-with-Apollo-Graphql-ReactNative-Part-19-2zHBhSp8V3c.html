<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 19 | Coder Coacher - Coaching Coders</title><meta content="Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 19 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 19</b></h2><h5 class="post__date">2017-09-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2zHBhSp8V3c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone welcome to the point and
19 so what we're gonna do today is we're
gonna consider what we did in the last
video so the last video this is how we
quit its we quit with the fact that we
can't add a red or unsaturated twit so
when you click here and that change like
on any real time in the front end with
optimistic UI but now now what I want
it's one another used or like this tweet
you see the number go up by one or go
down by one if unfavorite in real time
so this is what are we gonna do today
it's going to be pretty easy it's gonna
be almost like what we did in other
video so the one of the first thing
we're gonna jump it's we need to do this
in the server first so one of the first
thing we're gonna do is we're gonna go
to the schema and we're gonna add even a
subscription tweet favorite dad and
we're gonna return a tweet so this is
the subscription we're gonna create copy
and paste this name and what we're gonna
do after that it's we're gonna jump on
the tweet we solve our and at the top
ear we're gonna create a variable we are
we gonna call that tweet 500 retail
equal and the thing we just create after
that so remember these so just like a
constants that always need to be the
same so that's why we create that go at
the bottom we're gonna put a comma here
we're gonna paste Twitter again and then
we're gonna do the subscribe so
subscribe
who's gonna be a function we're gonna
work with the pubsub that is sing it's a
return and we're gonna have the tweet
favorite variable that's now before we
forget that we're gonna join the resolve
our ear and now we're gonna add this ear
so we have a real equal tweet resolver
that tweet favorite so this I mean that
sounds good so now what we can do is we
gonna jump now here we see for the
create wait what we did with one set
create tweet yeah this is what we need
to call we need to corral I'll call the
pub/sub publish
with the variable tweet add in here we
put that inside crib square bracket
because this is the variable name so
tweet add and we pass that tweet so we
need to do the assemble for the favorite
but the thing about the favorite
it's be done that in the model so we can
still use it in the model you can s what
we're gonna do now go at the top we're
going to export this valuable because I
don't want to type it again go inside
your model let's have a read here and
now what we're gonna do
it's we're going to import here from
curly bracket the graph QL resolver and
tweet we solve our we're going to import
the tweet father with a constant and
also we need the pubsub library who came
from the config slash pub/sub so we want
the same instance of the top so we have
created so that what we gonna do its ear
after the T 2 G 2 G son so when we
create as a t g sell us a pop so that
publish we're going to put the variable
Twitter over it we're gonna put in
square bracket and curly bracket sorry
the variable in the variable ear for the
key so for the one who may be asked
yeah but and Irina know any s6 you can
add a key who add about who it's a
variable it's on an object I think the
SS or maybe f5 and this is all you can
do so now by doing this we can just put
here curly bracket not actually break up
a column add an object and now here what
I can do it's the tea so the tea I have
right there so now if I run prettier
this is what that happen and I'll just
copy paste this line and now what you do
is you just do this thing right there
nothing more to do here so what we can
do just to make sure that a pen if that
really work its ear like that so now
we've done the server size are we gonna
check if you get scratch and no perfect
so now we need to go in the mobile so
open the mobile side and out of one of
the first thing we need to do is create
another subscription here so we're gonna
say tweet
500 return that GS so here we're gonna
do almost like we did here so for the
subscription so we we just say well like
which variable not variable but like
which key we need from the object we can
I came to make the the thing real-time
so I'm gonna import URL from the react
Apollo library and I'm gonna export
default a graphic ul tag here and that's
gonna be a subscription subscription
whoo we're gonna to take the tweet
favorite variable and here the only
thing I need is the ideal for know which
which which tweet and also the favorite
con so because this is what we update
because this thing gonna happen on new
for someone else like example if you
like a Twitter have in my screen I'm
gonna see that change and this is just
the number I don't really care about
nothing else and we're gonna do the
subscription you like we did for the
tweet ad so we're gonna import right
there the tweet
suavo return subscription from
subscription and tweet favorito and now
we're gonna almost do the same as the
one we have here so we're gonna see so
right there in the window we get a sick
days that perhaps that data that
subscribe to more well we're gonna put
the document equal the tweet satellite
subscription and now you know we can
update the query like we did the last
one that's going to be almost the same
we can have the previous value and the
sub script share data like that and now
we can do like we did on the other one
so so i don't know what my autocomplete
don't worry that data if we have no
solution i that i we're gonna return the
previous value
after that we're gonna see current new
tweet equal subscription data that
Nana's gonna be that tweet favor real if
you don't know why it is that I came
it's that's going to be the same as here
so the square bracket is going to be
equal to this variable here and now when
we say it's return return dot dot
previews and M we can add their get to
it so the so finally we need to call
them that the Curie we did so because
what we did here is they get tweets
that's what we need to call this one
because we're going to update the cache
of this query and now here what we gonna
do its ear that's gonna be a narrow and
now that's what we can say previous that
get tweets that map we're gonna map over
each tweet and finally what we're gonna
do it some kind of logic here we're
gonna say if the tweet the underscore ID
equality quote the new tweet the two
equal to new tweet that underscore ID if
it's school equal to that what I want
it's adding all this tweet but the
favorite can't now is gonna be quote the
new tweet value so I say it's a keep my
object way like what it was before but
just update the value of my favorite
come and I'll show you by doing the map
what we say it's we go over each of the
data we we have and when we find a one
where the ID we updated and else
so here the L we're gonna just return
each other tweet that's it so now you
see that was pretty pretty simple so now
we're gonna check if this thing's gonna
break in the mobile if not that's gonna
be really good sign so once you this
kind of logic is really important you
we'd understand this point in JavaScript
it's a ternary operator it just like we
map over each one and when we find a one
we want to check we just return the same
object but we merge it with a new value
so now what we're going to do for
testing that is I'm going to create a
new user so I'm gonna do a mutation to
make it a bit bigger I'm gonna do an
imitation cow sign up I'm gonna add the
email of Jon Snow gmail.com I'm gonna
have a full name of Jon Snow
I'm gonna have a user name of Jon Snow
and I'm gonna have email for password of
Jon that's one two three and now I want
to get my token back so now I get the
toolkit I'm gonna take this token I'm
gonna go to my headers I'm gonna create
new headers authorization and I'm gonna
say a bearer don't forget they were here
and I'm gonna paste the token I just F
and now if everything in working don't
don't we don't have a loading that means
it's good so now we're gonna first thing
get every tweet while we on the ID in
the favorite card so here we know so
this going to be the first one right
there so just look here what I'm gonna
do
so now I'm going to create another
mutation so that we tweet and I just
need to pass the ID so I'm gonna pass
this one and I'm gonna say favorite car
it is favorite and now look I'm gonna
click Play so I can do this by doing
comment enter and now look here the
value if everything's work you see now
you update in real time in the front end
and now if I like this one and I redo
another get tweet or I get all the ID in
the favorite car and I change this one -
oops
I chose it sorry
now if I say mutation favorite tweet and
I pass the ID you're gonna see the
favorite Khan updating to ear so you see
so that's pretty awesome and that was
pretty easy so that's gonna be that's it
for this one so what are we gonna do in
the next one it's we're gonna do the
profile page of the user so you're gonna
have all your tweets for the same user
with the page so I hope you enjoy and
we're gonna talk later have a good day
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>