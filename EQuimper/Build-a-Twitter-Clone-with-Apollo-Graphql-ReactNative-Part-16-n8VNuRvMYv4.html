<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 16 | Coder Coacher - Coaching Coders</title><meta content="Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 16 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 16</b></h2><h5 class="post__date">2017-08-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/n8VNuRvMYv4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Allu you one time to do the collab all
what we just talked about so what we're
gonna do today about is gonna be about
tweeting this collection a very tweet
and test it with the function I just
told you so this is what we're gonna do
first thing I'm gonna close I'm gonna
close sketcher
I'm gonna open my visa pseudocode be
sure you are inside a server file and
I'd start this one by doing yan Deb if
you didn't remember so first thing we're
gonna do is we're gonna create the model
like you know I like to create my model
first so every tweet that GS
so here it's getting pretty simple for
for the beginning what we're gonna do is
we're gonna import mangroves with the
schema from Mongoose and maybe just
gonna make it 20 yeah I'm going to visa
for you after that I'm gonna create my
schema so I'm going to say father it I
can type it further with the tweet
schema equal a new schema and at the end
we're going to export the full
government goes model while we're gonna
pass favorite tweet as the name and
we're gonna pass the schema right there
so what we're going to add here so as I
show you in the in the past video we
need to have the user ID somewhere so
this is what we're gonna do gonna say
user ID is going to be a type of schema
that type object ID so this way we can
reference the user also we're gonna have
a tweet array while that's gonna be an
array of object what we're gonna add a
type of schema tie the object ID and
we're gonna have a raft of tweet
remember why I get this to name its ear
I get tweet and here I get user clothes
everything yeah
so now sorry so now what we're gonna do
about this thing it's like a total first
we need to add an index this is for
getting like better-performing we're
gonna query by default
MongoDB give us an index of the idea
only so we can add one really easy we do
cover it as chemo we're gonna add an
index why that's going to be an object
past user ID to be one so that gonna be
true and we're gonna pass air a eunuch
and I'm gonna say true that's it so this
way we are gonna make sure like in the
same time that's gonna be unique
nobody can add this same like index so
we can only add FM retweet by user so
now time to do some logic first of the
one we're gonna need to do it's inside
the user with a user user resolver we're
gonna need to put the creation of the
favori tweet like I just told you in the
past it is a so we're gonna say import
have a read tweet from da da da da
mother
sorry tweet after that inside the signup
after the user is create I can just say
avoid here because this is a premises
because we're gonna call every tweet
that we a and we're gonna just need to
pass user ID equal to the user that
underscore ID we is just create right
there
don't you see their users create after
that we create is favorite tweet and
after that we can change that by
returning the token so this is the only
part we need for the user resolver
so that now we can jump on the tweet
resolver so the tree to resolve was
gonna be pretty simple what I'm gonna do
is I'm gonna go to the bottom after my
delete
tweet and I'm gonna call my father week
to week who's gonna be an async function
we're gonna have no thing nothing coming
from the parent we're gonna add the ID
coming from the argument then we're
going to have the user coming from the
context so I don't think we're gonna do
what we always do on the other one it's
we're gonna set up the error so we'll
just throw error for now a what I'm
gonna do to its I'm going to say require
identification because I don't want
someone to favorite a tweet if it's not
out so now what we can do here first
thing it's I'm going to import my
favorite tweet at the top I'm gonna see
why in the moment
because I'm going to need to receive my
model I'm gonna see why I'm gonna be
pretty simple why because here I want to
have access to this so I'm going to see
current favorite equal and now weight
function because it's supremacist we're
gonna call every tweet that time one
because we only want one like we don't
like it's just one like a user can only
have one item so I'm going to say user
ID equal to the user underscore ID and
we know that's gonna make sure we gotta
almost I've yet because we created in
the sign up so now what we can do after
that sorry I don't know what I had today
so what we can do now is to create a
function about tsavorite here so what we
can do what we can do here it's to
finally do the logic about are we gonna
enter the fact then a user can add can
solve it a tweet and if is already there
we're gonna remove it so if it's not
there we add it if it's not we remove it
that's it it's nothing nothing too much
crazy but I mean that's pretty like
we're gonna have some kind of allergic
to do so what we're going to do first
it's we're gonna just set up that the
pattern about searching if the the tweet
is already existing inside the favorite
so what we're gonna do is we're going to
do a if we're gonna say favorites
remember favorites going to be the
object ear so we can sa favorite that
tweets and now I'm gonna use the some
features or some it's a function and app
set up to your demand this middle call
the callback function to each an
imaginary until the callback return to
so that mean if you if you get true
after the second argument you're gonna
stop so we're gonna make sure then we
don't go over each each ID inside the
array so this way that's gonna be a bit
more kind of performant if you get like
a thousand items so I'm gonna sit
some and I'm gonna say so here I'm gonna
get one tweet and I'm gonna see if the
tweets equals this is the metal we need
to crowd this is a method already build
inside that the one of the ID bill by
Mongoose and we're gonna say underscore
ID which they're going to be the idea of
the tweet coming from here so if we have
here so if we add it so if this thing
return true that means we add all we do
you favorite we have already dis ID
inside a favorite folk so we need to
remove it so first thing we're gonna do
is we're gonna call favorites that tweet
and we're going to seek that pool we're
going to pass the underscore ID after
that we're gonna need to save this
favorite because we need that we make a
change and this is that promises and now
in this is the place why I told you I
want to return is fabric true or false
so that's gonna be pretty easy but we're
gonna return for an object for a I'm
gonna in Sabah real so now we remove it
from the favorite so it's not anymore
pal rid and now what I'm gonna do here
is gonna be pretty weird if you never
seen that but I cannot say only like I
cannot say tweet like that like you know
like if I spread if I spread the if I
spread the tweet first thing we don't
add it but second thing you're gonna see
so that's gonna maybe mom make sense
it's odd when I manage that it's I'm
gonna create a function where increment
in same time so I'm gonna get that tweet
but first thing what I can only did what
I can do is I can see kirn's tweet for
now equal outweigh tweet the fine by ID
and I'm gonna pass the ID and what I
mean it if I do this like that we're
gonna have a big problem because the
tweet we're gonna add the full object of
the tweet like everything so all we can
manage that is by calling to ji-sun
right there like that what I like to do
more it's by creating another variable
whose going to be distinct and now I can
do T like that
and now finally if it's not over real
we're gonna hear have a writ that tweets
push on this yd how would cover it
that save boots on premises after that
I'm gonna just copy-paste this thing
why I do this like that now you're gonna
see that in a moment because it's not
the way we're gonna handle that then I
change it a bit okay I'm gonna say is
favor real it's gonna be true now and
I'm gonna say dot dot T now what I'm
gonna do is I'm gonna jump in my schema
in my schema and I'm gonna go to the
bottom so make sure first thing you have
ad is favorite the boolean inside the
tweet after that inside the mutation
we're going to go after the daily tweet
and we're gonna call that favorite tweet
who's gonna add an ID who's going to be
equal to underscore who's going to be a
nut nil and is gonna be an ID and we're
gonna return the trick and now what we
need to do it's we have that inside that
weasel variable we need to import that
inside the index resolver so we're going
to say feather rib tweet with resolver
that clever tweet that's it so now I'm
gonna jump on my server I can open it
and now if something wrong okay I miss
something I just didn't put the code on
here
perfect night is working so now what I'm
gonna do it's now after it a user so I
have to create a user and have a sign-up
first thing for the user so I'm going to
show you I mean I I'm gonna create a new
user
because what I'm gonna show you it's
just drop this thing because I do some
tests before so about that well now what
I'm gonna do so I'm gonna go to my
graphical and I'm gonna sign up first so
I'm going to see mutation that's going
to be easier for you I'm gonna sit
mutation and I'm gonna say sign up I'm
going to pass an email who's going to be
a test that Gmail that come after I'm
gonna have a username who's gonna be
test that I'm gonna have a password off
that's for one two three I'm gonna add a
full name of I'm test yeah that's a
beautiful name maybe better like a John
Snow and yeah I'm gonna see token yeah
so you see you have just read John Snow
I'll jump not gonna survive tomorrow so
now here I'm going to go to my idiot
HTTP headers I'm gonna take my token I'm
gonna edit this one I'm gonna remove
this I'm gonna pay Sona I'm gonna save
you and now just to make sure everything
can work inside a mutation I'm supposed
to have a favorite with pirate perfect
so saying before that I need to add like
the ID of one of the tweet I'm gonna do
this is by saying get tweet the inside
will break it get tweet and I want to
receive the ID of each one and you see
like nobody at the Thoroughbred I'm
going to take the first one here now I'm
going to come a mutation call favorite
tweet I'm gonna pass the ID and I'm
gonna pass ID equal to this one now I'm
gonna return the ID and I'm gonna ask to
return when I return the idea and just
see that gonna work
you see it work just to make sure I'm
going to go to my Robo Mongo I'm going
to refresh my collection I'm gonna open
if I retweet and you see what I create a
user the favorite word is create and it
was empty now because I have it I have
one item you see at five version so I
have update this thing five time
so if I click again because I added now
I'm gonna have nothing if I click back
because I have nothing now I'm gonna add
this perfect now I can also ask is
favorites so now you see if out mm mm mm
ooh so it's followed will you the
pattern as you asked
but the thing it's now if I ask favorite
con you don't update so this is what we
need to do we're gonna need to create a
function to end all this this
incrementation it's gonna see it's so
easy
tweet mother we're going to create some
static function what we're gonna do is
we're gonna call a function call a
increment favorite one and we're going
to create another one called the egg
however it can for decrement both gonna
be almost the same so we're going to
receive here the tweet eggy and now here
we're gonna return this that fine by ID
and update if you have seen some of my
other tutorial like the know diaspora
plate I talked about that it is that
this ear inside the static mean is there
like the schema so it's like when you do
tweet that fine body in update from now
here what I'm gonna do I don't know why
I do this here I'm gonna say tweet idea
because it's a fun baggy after that I'm
gonna increment so we can do this like
that in MongoDB favorite con because I
want to toggle this thing we're gonna
see will get a sick one because I want
to increment by one and after that I'm
gonna want to return new so I want to
receive the new update about it because
if I don't do this I'm gonna still
receive the old version but when I'm
gonna update I
again I'm gonna receive the odo warning
get a seat don't get a flu the pattern
now I'm gonna copy this one I'm gonna
paste it there I'm gonna paste this
thing here oh well I like that but now
the favorite comes gonna be increment so
you can just do this like that minus one
so we have just create this to function
so now this is why I told you before
it's now the current tweet it's gonna be
cool through that Inc favorite here it's
I want to d5 of it because we remove the
favorites on glossy deck favorite Krunk
and I'm gonna just pass the ID oh yeah
that's it and now here I can change the
same here and I can sync server it run
like that
then look inside the server crash no and
now if I like
something is pretty wrong
this one with two so it fall what I've
did wrong
okay maybe know why I know why it's
because so what I'm gonna do you're
gonna see it's because I have to do this
before everything I'm gonna delete I'm
gonna edit the command here I'm gonna
just delete this tweet I'm gonna save it
so now I have nothing like to make sure
how was I do yeah
now if I like you see now you follow so
you're going to always follow so when
someone gonna remove is like you're
gonna remove by one action ever you see
I get this error why before because I
was further it with zero so I didn't
minus one but they're never gonna happen
after that because now we manage like
this so now you see we did the favorite
and you see my friend when you're gonna
do this again every see it's every true
or false but now I just think we can
just do one little thing it's this is a
some refactoring of the curl and it's
gonna be easy really easy like I know I
always say it's easy but you this one's
gonna be easy
finally I just want to remove everything
from the resolve are because that don't
make sense what everything there and I'm
gonna put that in my favorite tweet oh
I'm gonna do this is I'm gonna create a
method so that strains between
aesthetics in the meta is the metal is
inside instance and the said X is its
it's gonna be the schema so yeah I'm
gonna seem at all and now do anything
I'm gonna sit I'm gonna call it an async
function crowd use our travel read to
eat so the name of the action panel you
I'm gonna receive the tweet ID and this
function here funnily look at that
I'll go there I take my if statement and
my all my alerts appear I'm gonna cut
this thing then go to my favorite I'm
gonna paste this thing I'm gonna change
my tweet ID to change the idea by doing
command D after I have an error --air by
favorite so remember so that's gonna be
the disk because this is the instance
and now we have a tweet error so we
because we need to import the tweet
schema
like that
so now what we're gonna do we're gonna
need to go here inside the the Tweety
resolve our again and now the thing will
get any to make its by doing we turn
favor read the user over real quick and
we'll just think about the idea of the
tweet that's it when I check if the
server's crashing no so now I can count
and now still working but looks at how
much cleaner the resolver is so it's
almost like I've done a bit about like
Alexa Phoenix and they work with context
and what I mean it's like you want your
resolver to keep like the cleaner as you
can because maybe like if I want to
change my DB or something like that my
resolve are gonna stay the same I'm
gonna just need to create like some
other kind of function like this I just
hope that gonna make sense to make you
resolver tree now so we can do some of
the stuff later but yeah so I will you
enjoyed this part so now we have the
salad working we're gonna just need on
the salami pizza to change that to to
get tweets because an hour get tweets we
don't see is favorite of of not but you
see what we did it's pretty awesome and
just for showing you you work with other
with other one so yeah I'm ganna have
one favor real I'm gonna go to my room
with one go you see I have one for real
I'm gonna go to tweet I'm gonna take
like this one I'm gonna say copy value
I'm gonna go to graphical I'm gonna
change this ID to make this value I'm
going to need to remove that like that
now if I do this
see now this one is favorite too so now
if i refresh here you see southern real
but now if I go to my favorite tweet at
to lmm so now my EULA add to Tweety f
favorite that's it and when we're going
to want to say a how many tween my EULA
a favorite we're gonna get tweet back
tweet that con here so I hope you enjoy
and we're gonna do some other server in
there let and exhibition and after that
we get a jump on the front end to
connect this thing and after that we're
going to talk about subscription in the
light so I hope you enjoy and we talk
later bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>