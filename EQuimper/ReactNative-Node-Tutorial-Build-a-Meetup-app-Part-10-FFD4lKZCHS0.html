<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React-Native &amp; Node Tutorial - Build a Meetup app [Part: 10] | Coder Coacher - Coaching Coders</title><meta content="React-Native &amp; Node Tutorial - Build a Meetup app [Part: 10] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React-Native &amp; Node Tutorial - Build a Meetup app [Part: 10]</b></h2><h5 class="post__date">2017-04-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FFD4lKZCHS0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys today we're gonna continue at
stereo we are in the episode number ten
so today we're gonna start to work more
about in the back end about doing the
user stuff like attached occasion and
build a GWT passport strategy so right
now I'm gonna show you the plan of this
story oh we're gonna update a dependency
we're gonna update the script on the
package.json I'm gonna show you the new
Bible or C file we're gonna have and I'm
gonna create with you the passport GWT
strategy and finally we're gonna just
test it in the user stuff in the to next
episode we're gonna do the face book out
and the Google out in the back end and
after that we're gonna go back in the
mobile so don't lose time we're gonna
jump right now inside the package.json
and we're gonna delete some stuff here
we don't need any more first thing I'm
gonna delete here a lot of stuff
battered polyfill battle preset battle
preset stage 0 why because we're gonna
use another way to build a project yeah
what we can do it's this way here I'm
gonna do yarn remove and I'm gonna paste
the name babble polyfill babble preset
yes 2015 and babbled stage 0 so I do
this cuz now we're gonna set up the
project the batter stuff to compile
everything to be able to already go in
production so that's gonna be almost
like if you come from a front-end react
it's like a web pack so they're gonna
compare inside of this folder and we're
gonna use it and I think too for I
forget to remove the data we just are
sorry we're gonna remove it perfect
after that I'm gonna run yarn upgrade so
we're gonna update every package we
already have
did I ok here I get that some I think I
forget to do your upgrade interactive
sorry so here we're gonna upgrade
Mongoose and now I think my yes Lin
don't change but we're gonna add it so
your add snatch the es little config
equal per so let's the recipes are on
the front we add it yes Liam and now we
can already install some other their
dependency we're gonna install battle
preset end so this is a way to have the
battle finally we need I'm gonna do
bable bable plugging transform object
rest and spread so finally I'm gonna
just add what we need so battle preset
and we're gonna give us what we need so
they're gonna check the environment we
have and that'll plug in trance from
object and rest sprayer it just for make
the babble working with rest operator
and screen we're getting delete
everything inside a babble or C and we
can I create here another setup precept
inside curly bracket right there
and we're gonna open an airway we're
gonna open a square bracket here we're
gonna put some config inside the curly
bracket ear so inside object
I'm gonna sit tour yet so we're gonna
target then the version of the node we
use right now and I think I'm using
version 7.9 yep so if you do know - V I
get 7.9 so I'm gonna target it so I'm
gonna do node and 7.9 perfect after that
right there I'm gonna add plugins and
I'm gonna add an array again with again
a square bracket
transform object read it spread and
we're gonna put here some configuration
use built-ins
to be true
that perfect now inside a package.json
we're going to update the script of when
we start this stuff first thing I'm
going to add inside the F dependency
reom graph this is for delete it's like
if you use a Mac this is the air M or F
comment but if you use a Windows that's
going to be helpful here I'm gonna
create a bill that watch come in this
one what's going to do it's going to
make better watch we're going to create
a directory this list like that
so directory this cup like this and
we're gonna bill the source folder so
we're gonna change the name server to be
source and now the now I can get rid of
index that GS cons now that are gonna
compile everything from source perfect
after that my known every known on air
I'm gonna take it from the dist folder
so we're gonna create at this folder
with that so now if I run it and time I
come in
I'm gonna run yarn bill watch so if
everything is working now I get oh I
make a typo and some other dollar see
it's transformed yeah I'm gonna be run
and now everything is compiling and now
I have everything inside my this folder
and now you see I get everything coming
from es6 es7 inside es5 so now you can
work for like when you're gonna push to
maybe ec2 AWS everything like that
perfect so now we get that after that
I'm gonna run my clean come in and this
one what's gonna do that's gonna be real
rough this so they're gonna just delete
finally that this folder when we run the
only run clean after that I'm gonna have
my lien so like we have in the last
episode and that's going to be is going
to be ESL or sorry C so if I run your
lint I'm going to surely have a lot of
error
because I change some of my yes lien
stuff so what I'm gonna do here is I'm
gonna create lint fix es Lin - - fixed
or Searcy and now if I run yarn lean fix
we're gonna have some error ear here
category we don't need anymore
so I'm gonna just uncommon this one
perfect after that year I have some new
consoles so what I'm gonna do
it's if you are the visual studio code
you can do comment and click so that's
why I'm jumping there here I'm gonna add
es lien disabled comes no console so
that gonna let me able to add the
console error just to showing you if I
do this now I'm gonna have only one
error
perfect I'm gonna copy paste this line
and I'm gonna paste it right inside my
VB here in the same time because I'm
here I'm gonna setup and now my Mongoose
set to be in debug mode because that's
gonna be easier for us in the future
already so that gonna let us to see
everything from MongoDB so now if I run
your own death now you're gonna see I'm
gonna get all everything about Mongoose
right there perfect this thing is done
if I run lint I'm gonna have no error
perfect now we can start to jump on the
code so now we're gonna add stuff here's
some dependency we're gonna add passport
and passport GWT and JSON web token so
today we're gonna just set up the
passport strategy like that so what I'm
gonna do there just for today will get
it there not for today but we're gonna
create use our folder inside of mahjongg
I'm gonna create a model that GS the
model the GS for this one gonna be real
easy it's gonna be only just for now
because I just want to show you like the
GWT so what we're gonna do here it's I'm
gonna go sit there
import mangoes from important Mongoose
coma curly braket schema vanity
structuring schema from Mongoose after
that here I'm gonna create a user schema
from
with a new schema and just for today I'm
gonna add only an email which gonna be a
stirring nothing more don't worry that
don't gonna be just what we're gonna
have the next episode we're gonna have
Facebook and the next one gotta be
Google and gonna be much better and much
sicker so here I'm gonna have user and
user schema that's it like that so now
we have the user schema after that what
I'm gonna do is I'm gonna quit my
controller GS and I'm gonna create
finally my user so I'm going to import
user from modele I'm gonna do export
current right now we can already create
it for the next day so out without 0
that's gonna be an async function with
Iraq oops that's baby in a rest and what
I'm gonna do there is I'm gonna sit cons
orgs just for now equal drag that body
and here what I'm gonna do is I'm gonna
make a try in a catch with that if I
have an error I'm gonna return a rare
that status formed red with JSON object
ear of error true and error message of
something wrong with out just like that
and the try ear what I'm gonna do is I'm
gonna set current use our equal user
avoid yours are that create and I'm
gonna just put my arts in it and finally
I'm gonna return where's that status
turned red with a JSON object with user
that's it just for now I'm gonna create
my route that GS and this world I'm
gonna do import router from Express
after that yeah I'm gonna import
everything as a user controller so like
we did on the other
story oh so I get everything gonna be
with a user controller like the object
of everything current route equal new
router and now here I'm gonna do route
that post so yes this is a post use are
that out zero and we're gonna pass user
controller than logging with out perfect
and now here I'm gonna export default my
route so now I just set up my basic
stuff here with the route so now here
what I'm gonna do it and inside my user
I'm gonna have an index I'm gonna import
user route from route and I'm gonna say
export user route and now inside my
index right there inside if you think
I'm going to export everything from user
and finally inside my index here I'm
gonna import user route and I'm gonna
add it right there at the end of my
array of my API so now I should be able
to create a user on look at all out and
not be one but like an oath ETI
user that out zero and I can have a
buddy of email and I'm gonna say test
that gmail.com and now I get back my
user but now it's I have like no no
security at all so now time to work with
durability for the one who don't know
GWT it's a way to finally you're going
to encode you can have an encode version
of you payload ear so finally you create
a token with a payload you want to get
it and only wait decoded is with a code
so if you have the code you can every
see that if you don't have you're going
to receive finally nothing so the only
way to decode this kind of token it into
have the secret and do the the
conversion and this is already do with
the JSON web token we did so now what
I'm gonna do is I'm I configure I'm
gonna create a config that folder the
config file here I'm gonna say current
Dave confit
so just for
dev right now and I'm gonna say DB URL
Mongo DB local oz meetup death and I'm
gonna say GWT secret and for now the
secret gonna be whatever you want so
like that and here for now just for now
I'm gonna say export default def config
I create this air just because here in
the future we can add like it the S
config and a projection config so we can
import everything from there now what we
can do is we can jump on the middleware
here I'm gonna import I'm gonna import
passport from passport so this is all
you sell a passport you need to initial
it first or I'm gonna do app that use
passport initialize like that so inside
my middleware so that inside my DB come
thing now what I can do is I can go
there import import config from config
yes and now right there I'm gonna delete
Oh disconnect here I'm gonna make config
that DB URL now if everything is working
yeah nothing has changed perfect we have
everything and now inside my my meetup
that I have my correction perfect no
time to work with the GWT inside user
we're gonna create a util folder inside
the user folder inside the user it just
what we're gonna put about L per about
the user so the first one we're gonna
create it's gonna be the passport
passport the GSO the passport
configuration now we can have some good
code to write so we're going to import
passport from passport after that here
I'm gonna import from passport GWT I'm
gonna import two thing one gonna be
strategy as GWT strategy so finally I
don't want to keep the name strategy cuz
if I have
any other strategy in the future that's
going to be like not really good so
that's why here you can alley ass the
thing so ali s with the ass in a I'm
gonna use extract GWT so that I'm gonna
import my user model from model right
there and I'm going to import config
from what we just create config and
config that GS perfect after that here
we're going to work with the GWT
strategy I'm going to create first thing
my GWT option so what I need to have
here I'm gonna just say that's going to
be where we're going to tell passport to
take the GWT token from the tell past
power to take a GWT token from the
author authorization to rescission
headers so we're gonna put at every
session either inside axles in the front
end and this is where we're gonna put
the GWT so you know we can have a key
with GWT from request request and this
one going to be X track GWT from out
others out or we say she'll like that
after that I'm gonna have secret or key
and I'm that's going to be the the key
we just create together GWT secret so
that a I'm going to create GWT strap T G
equal new GWT strategy so it take to
argument the first one it's the strategy
options of GWT up and that's all gone
one that's going to be like the callback
so yeah that's give me an async function
with a payload and finally the don't
call back
yeah I'm gonna have a try in a catch the
catch here with the error gonna just
return done with error and fall so no
user here I'm gonna do user equal a wait
user that's fine by ID
now that's going to be pelo that ID why
it's coming this pillow so this pillow
gonna be like this kind of stuff here so
I'm gonna save inside my token an IDE R
inside the object and that's that that's
going to be what I'm gonna have so now
here if I have a if I have a user oops
I'm gonna return the call back with no
error and the user if I have no error so
if not return but if I have no error I'm
gonna return done with nil but with no
user because here if I have a user I'm
gonna turn in the user it's not a me
return down with fall so the user only
exists in air we finally finish with use
GWT strategy so passport gonna use of
GWT strategy perfect so this thing now
it's working after that here I'm gonna
create another you'd sell called create
token that yes so this function we're
going to create the token for us so
we're gonna import you WT for JSON web
token I'm gonna import again my config
file from my config folder config file
and yeah I'm gonna do export currents
create token equal art and this one
that's going to be a function we're
gonna just return so because I do an
arrow function and this is like for the
same line I don't need to return ID so
this is my pillow it's going to be equal
to r-z ID or that underscore ID
I don't like underscore ID so that's why
I think I'm getting like another kind of
wait year and now I'm gonna say config
so this is the second argument it's you
pass your secret so I'm gonna save that
oh can I create the way to decode it
it's with this secret and passport gonna
decrypt this thing here with again this
the same secret so that's all we gonna
work it perfect so now what we can do
it's we gonna jump again on the
controller here and now what I'm gonna
do first thing I'm gonna do is I'm gonna
jump on my source and I'm gonna create
another folder call you so
this source this futsal ear it's below
the user so it's everything about the
user here they're conveying ear the new
you said it's on social everything
everyone can use it like every module
needed so this one going to require GWT
out that GS this one is going to be a
function with passport from passport and
I'm gonna import here my what we just
create with passport so just like that
so this is the passport that used and
now here I'm gonna do exponent cons
require GWT out and now this one going
to be passport that uh townscape GWT
session no session we don't want it so
we're gonna put it as false so now this
middle wire we just create finally I can
use it on some route so now here example
not there but here if I do made-up get
all what I'm gonna get it's an array of
an empty meter and that 200 okay so this
is what I want you to see it's 200 okay
now what I'm gonna do is I'm gonna jump
on meter I'm gonna go to route yeah I'm
gonna import import require from GWT out
you'd sail oops
require GWT out and I'm gonna put it
right there inside the get like that so
if I do this and I send my request now
I'm gonna get unity rights for one I
have no GWT I cannot have access to my
Meetup so now we put some security in
the application but now all can add
continue to add access should be a good
idea to when I sign up or legging I
should receive now the token so now this
is what we're gonna do we're gonna jump
inside the user I'm gonna go inside a
controller and we're gonna just make it
X make it create the GWT finally so here
what I'm gonna do is I'm gonna do import
create token so the function we just
created for create a token from util and
creat token and here now finally I'm
gonna do token so here that's going to
be success to be true first
touken gonna be equal back tip GWT why
that's portability ask to have to use it
so for the one who don't know I didn't
pass time on it fast or it's a way to
make identification with no GS pass
portability it's that strategy so it's a
way to end your attacks occasion in the
next is some kind of neck superior we're
gonna use a local strategy this is a way
to add yeah like you email and password
and everything you want so that's why
you have some password that's poor GWT
here and this is the passport GWT stuff
yeah so I'm gonna put the link in the
description and win me on my project so
if that's going to be the passport you
WT as a total to add the GT ability in
front of the token finally so here what
I'm gonna say it's create token inside
curly bracket create token and now here
what I'm gonna say is I'm gonna pass my
user so that we use our we just create
I'm gonna pass to decree token and now
if everything is working now I'm gonna
get something wrong with a certification
I get a bad week with create token yeah
I think I get it right there so now what
happen something wrong with out okay so
now I'm going to control my II so for my
error
it's and now if I send what I got it
duplicate key okay meetup death okay so
we just add finally the same kind of
email so now I'm gonna just maybe change
the email and now I get it
so now I get a GWT token right there so
now okay yes I have the GWT but now here
I still have you know direct I can add
access to my route finally so now what
you need to do it's copy and paste this
to here so right there I'm gonna copy
paste this token I'm gonna go to another
get all middle again I'm under to rise
but now here inside my headers I'm gonna
put authorization and
gonna pass my token if I do this and I
sin now you see I get that orange red
okay so now with this tool can I have
access to that if I don't have it
so if I have again this if I have this
yet also HTTP I'm gonna just copy-paste
this thing here without the token so I
have no others I sent in otherwise a GWT
right there so now my app it's working
with attach secretion with the GWT so we
can use it in the react native
application in the future now the only
thing we need to finish for now it's
it's we need to remove the dist folder
from kiddo we don't want to push to push
it on the repo and that's going to be
done for today so what we learned today
was babble to build a folder for
prediction we seen some new package like
what better preset and do so for the one
who don't know I'm gonna it's like this
thing here it's for automatically
determine which kind of battle
plugging in polyfill you need and you we
learned then now we can log with the GWT
we learned some stuff about durability
and why middle work and be really
helpful with identification when you you
want to block a route so I hope you like
it
so please subscribe if you liked it
click the like button and we see later
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>