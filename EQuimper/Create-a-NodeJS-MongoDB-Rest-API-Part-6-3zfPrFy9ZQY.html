<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create a NodeJS + MongoDB Rest API [Part: 6] | Coder Coacher - Coaching Coders</title><meta content="Create a NodeJS + MongoDB Rest API [Part: 6] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create a NodeJS + MongoDB Rest API [Part: 6]</b></h2><h5 class="post__date">2017-05-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3zfPrFy9ZQY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone
46 so what we're going to do today is
we're going to jump on the post resource
so today we're going to create the post
model we're going to set up this
controller for the creation of the post
after that we're going to create the
basic route to be to make it available
for us to work with it in postman after
that I'm going to show you a way to
resolve an error I did with joy so
finally I just forget one little thing
and that's why I enjoy didn't work the
last time so we get a jump on that so
first thing we're going to make its
inside the module folder now we're going
to create another folder called post
after that after that we're going to
create a file called closed that model
that year so that's going to be the
model of the pose so here at the top
like we did with the these are going to
import the mongoose library and we're
going to destructuring
the mongoose schema after that we're
going to create the post kima a new
schema
at the bottom we're going to already
import it so Mongoose that mother post
with uppercase P
post-chemo area don't need to always put
uppercase P or like I use this air at
the first letter uppercase you can do
whatever you want adjust for me as a
convention or always put over K so I
know when I'm using as a risk I don't
need to care about what I did so now
what do you want as a post so I think I
posed me to a title
there's going to be a type of string
going to be trimmed katroo we don't want
to I played at the M after that we want
it to be required again we can put a
certain argument here and say a title is
required so that's going to be the error
message coming from the Mongoose
after that min length I think you don't
have a total charge on adding at least
three character to get title need to be
longer
sorry like that after that we want it to
be unique why I want the title to be in
it because I'm going to use slug
what is the slug that slug is just
finally take you typed it you're going
to take my title for me and you're going
to make it all lowercase and every place
where I have a space you're going to put
a dash so this is just for good The
Advocate to go to the page that's going
to be better if I use order to do -
something like slash arrow well then
something's slash five six three five
you know the ID so after that opposed
gonna add a text thanks going to be a
type of string - we're going to add
three to at the end just to be sure
after that require need to be true so
six please require
tada mainland so that this is a the post
the post XO I think 10 character it's
really small so need to be longer
like that
and I thought
can I create a slot so that's not gonna
be a type of string I don't gonna make
it require because it's not the user we
need to do to edit that's going to be
the job of us in the server you're going
to say in one moment are we going to do
this I'm going to remove the trim and
I'm going to put lowercase true but I
know that's going to be lowercase after
that yeah I'm going to put the user so
the user is the odor so sorry I'm going
to remove that investigation the user is
the author of the pose so here some
people like to put odor but just because
I don't like to work with this group
reward in the front end so that's why I
keep the user so we know mongoose is
that new sekolah debate among the living
but they make us pretty easy for new
circle database to make some kind of
relationship and we can do this by using
a type of schema that type that object
ID so hey what that mean it's we're
going to only say the idea of the user
right there and we can use that for
populate populate it's a method we're
going to help us to get finally the user
object when we need so example you want
to show maybe the user name or something
like that in the front end for the what
is the author username actual error and
there's that's gonna be the with this
thing here we can do this you need to
say where we are going to be user this
is why I told you I always put uppercase
if you go to my usual model you see at
the bottom I put user right there or
okay so this is the same rare when you
rare this is this name here up after
that I'm going to say favorite one good
so favorite car going to be a onion
amber so it's going to be a type of
number and it's going to be default by
zero so by the rule when I create my
both
that better be a zero from the beginning
and what is pyruvate can it every time I
use organic Sarah with a post is going
to be increment by one pc unfollow not
on followed by on summary opposed that's
going to be the remove we're going to
remove one from you and after that this
is something I forget in the user we're
going to add this it's I want to
elastance them four times ten mean we
know when the user has been three when
the post I've been cleared and updates
so I'm going to copy paste this line of
code right there
and I'm going to go to my user on mother
and I'm going to add this thing right
here come on that's it you see this is
why I like I mean that I business eco
like that is it's so much easier to just
add stuff in the slide so what we're
going to do here this is the place where
we're going to do we're going to finally
add this like fi method so post keep
this post schema methods like we did on
the user here I'm going to see sluggish
fire so I want to slug my post so this
function here going to need one thing
we're going to need to add an elaborate
out slow npm install or yarn add slug
when it's done we just need to go at the
top we get an import slow from slow
and now remember a method i've access to
the dish and this is the post intel so
here I'm going to do that slot so when I
say that is the slope right they're
going to be equal to slope and I'm going
to say this a title so what I say is
this that slogan now be equal to the
slug of my title so I'm going to take
the title and I'm going to put its
lowercase it with the dash for the space
but I'll do I'm going to call this
method here so we're going to again use
the pre-hook method but this time that's
going to be validate
so when the post being very date when
the posts being very day we're going to
just finally add the slug so right there
what we can do it this that underscores
like if I and at the end I'm going to
see next
that's nothing more to do so when the
pot being validate we just certify the
title perfect so now we are able to
create a post but I want to add some
other stuff for the one who have already
used with MongoDB you know when
something is unique and you add another
stuff with this thing nine example for
the title example we can I receive a
weird error cow like duplicate T of
collection etc and this is really hard
because when you say unique we cannot do
something like unique and put like
something here we cannot do this
so what we are access it's a library we
can install called Mongoose yarn add
sorry
Mongoose unique very day tour this
a library I'm going to give us access to
make the message we want so you need
valid data from Mongoose unit validator
now what we can do it's right there
I'm going to post kima the plug-in so I
can add a plug-in I'm going to put
unique validator this won't take as a
second engine under plugin and that's
going to be what we want to do with that
there's going to be a message and I'm
going to say inside cause value so if
you remember in the I think that was in
the 8.3 I show you that you're going to
be quoted the value I mean that the the
thing will make the stuff happening so
if that was the title unique that's
gonna be decided here
oh really taken so here I just created a
message saying my post if the title is
as been used and you credit I mean you
pose with this title I'm going to say
your title it's already ticket that's it
so we can use it for the user schema to
go they're going to change it to be user
schema I'm going to go back to my post
model I'm going to copy paste this
unique validator right there that's
nothing more to do and why do I want
this stuff in the user email unique
through right there perfect
so now we have create the pose at the
model etc so now time to create the
controller so we're gonna create pose
that controller the GS so in this one
today the only thing I want is to be
able to create a pose so we're going to
take the post FEMA so the post-modern
after that we're going to export an
async function called create post we're
going to take again they reckon the rest
or request and response going to add a
try/catch here
I'm going to do the air or furnace or
air that status for Andrea to be bad we
quit that JSON and I'm going to send the
error in time I try I'm going to do
current post equal our way post that and
now this is the thing we want to add a
note our
I mean we want to add the author of the
post we can do this in two methods I can
do the create here and do inside curly
bracket I can do react that body and
here I can do like to my authors I can
do use our equal react that user that
underscore ID because of passport
remember this was going to be with the
required GWT so we're going to access
the reg that user that underscore ID
because we're going to get it from the
GWT hotel I can do this this would
so our it post create so here what I say
is I take all the stuff I got from my
body
no we're going to make the validation
with joy and just say finally we just
make one big object with this thing here
so we don't do because if I just put reg
that body that's going to be an object
inside an object this way I spread I
spread everything inside my joy so I can
do this way with post that create all
what we can do to it I can jump in time
I pose that model and it right here I
can create now and third method I'm
going to get whole scheme out that
statics and here and right there I can
say create post and create post
the argument and the us are and going to
return this because this means that
post-chemo now and I'm going to say
finally this that create and I'm going
to do the job right there arts and I'm
going to see user this would that's and
after that what I can do it came here
remove the curly bracket so I'm going to
just remove everything for now I'm going
to say create post so this is my
expected method I just read here Chris
both and now I can see it read that
buddy and now I can say in the second
argument read that user that on this for
ID it's not a big change but this way I
mean I don't know why but I like not
this matter this is just I use it I use
a lot of static method because I like it
just change the way of this is created
by myself so but I mean this is that do
the same job so go with whatever you
want here and I'm going to return aware
that status here 201 so this is for
create that JSON and I'm going to send
my post
perfect time to create the round if you
want to use it so we're going to create
the route it's going to be really simple
at the top we're going to import data
from Express as I'm going to import
everything as a post controller I don't
make a typo from post controller I'm
going to import my out GWT helper
function my middle wall sorry
coming from my service and out service
that I'm going to create an instance of
my route
route that post / post I'm going to put
the AL GWT and we get a suppose
controller that create post that's
export before route
you
I'm going to jump on my index of the
route I'm going to just delete this app
get along don't need this thing I'm
going to remove that and I'm going to do
post route from post that user route and
I'm going to do app that user slash API
so HB 1 / folks and I'm going to put my
poster up so now if everything is still
working some that I do see nothing is
great perfect now I can jump in post now
and I'm gonna call my post method so
here are Skrill original post methods
inside my savings so this is HTTP look
at all 2000 if you have u1 post that
this is a post method first thing we
need is we need to log in because if I
send that right now I get you data right
this is what we want that means GWT is
still working
so here I'm going to the game so I have
already my stuff I'm going to look
perfect now I get access to my GWT then
I take my GWT I'm going to go to the
others and I'm going to sitt
authorization I'm going to put the value
right now if I send like this I get X I
found read that request because what
happen is have nobody as nothing so what
I'm going to do is I'm going to go there
I'm going to say title this is titled 1
and I'm going to success this is take 1
now if I sell I get a 2-1 create and now
as you can see I have my so this is my x
stem right there as my slug so my so I
take this title here and they just make
with - like I told you and add my user
now and add the ID of the post and the
federal return is 0 by default so now if
I jump to my Robo Mongo and i refresh
now you're going to see my asset inside
my DB so everything is working right now
but now the thing is now if I sound like
this title is if I send that again this
is my new message I told you this is
this is title 1 already taken so this is
the message we create right inside the
post model when we see the I already
taken
so this is the thing now if I don't earn
a title I'm going to just receive a
battery question that this is not what I
want so what I want to do is using joy
to make a validation and because now I
can just send everything in it's not
what we want so inside pose I'm going to
create a post that validation the GS
here at the top I'm going to import joy
from George and here I'm going to export
diesel and object okay I'm going to see
create pose so the name of my controller
finale and now this is why what I saw
you last time I need to put body so
because now I'm thinking about this so
we're going to make it just a take the
email password for swimming everything
inside the usual validation and put body
that's this is what we missed last time
so now inside body now I can say title
to be a joy the string let's stretch but
string I
who has a minimum of three character and
this is required I'm going to just do
comment shift B to copy paste this line
below I'm going to change it to be text
I'm going to say minimum to be third
attempt after that now the only thing I
still needs to do if I go to my row at
the top I'm going to import the valid
expert validation who are forced to make
validation inside the middle war after
that I'm going to import my post
validation from my polarization time and
now the only thing I need to do is after
it after the education I can do validate
all validation that propose
on the thing is very perfect so now I
can drink back to postman and now if I
send that what I got is the message
existence what we want finally but don't
worry we're gonna change it but finally
it's just a message saying like it
director is required as you can see so
for now this is what we add as the
message but this is something we're
going to change don't worry about that
so now finally we are able to create a
post and the post it below the user so
that's why now when we look at the rebel
Mongo their user it's right there and
this is an object ID and this is the
same ID of the user right there so DB
e29 vbe 29 so and remember oh I get that
I get that because of the out GWT
that that's why I got able to make it
because remember inside the GWT have
access to the ID and a there anything I
need to show you at 40m something called
prettier it's awesome you can add this
it's really easy on atom sublime visuals
you code for a visual cue code you just
need to install prettier and I think
it's CSN yeah prettier es game after
that they're going to told you or you
can add command inside the visual studio
code or you can add like prettier I want
all my single code to be true my width
of my screen is going to be eighty
feeling more space and everything and
after that what I can do it Here I am
below the and more than speedy with so
now if I run my command shift ad F you
see now now they make me didn't make
that for me so now if I do again so this
way it just better I think I'm going to
show you another way to make it like
every time you're going to commit that's
going to be Bank automatically so that's
going to be inside other it's good so
for the next one what are we going to do
is we're going to make available to
delete not delete but to read opposed so
read one and read out so I hope you
enjoy please let me know how you feel
about this video and hope you enjoy it
and please like if you liked this thing
and without later other good day bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>