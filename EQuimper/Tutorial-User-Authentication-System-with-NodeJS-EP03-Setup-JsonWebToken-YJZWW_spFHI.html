<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tutorial User Authentication System with NodeJS - EP03: Setup JsonWebToken | Coder Coacher - Coaching Coders</title><meta content="Tutorial User Authentication System with NodeJS - EP03: Setup JsonWebToken - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tutorial User Authentication System with NodeJS - EP03: Setup JsonWebToken</b></h2><h5 class="post__date">2017-09-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YJZWW_spFHI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone we're gonna continue this
tutorial so in the past video what we've
done is we've created a 16 up and we'll
just start first thing it's really not
prediction really and we need to change
that I mean right now this is what we
can do I mean II I can read just our
first little error we have we send the
password really bad really really bad
you don't want to send it back after
that we can log in and also we send the
password the thing here it's now how can
we manage the kind of session so in the
past hour we did them in some
application we add like session and
cookies and stuff like that now I'm
gonna teach you it's all to use GWT I
know if you have watch a lot of my video
I'm always you GWT it's because I mean
for me you work really well and I just
think can go really well and you go
really well too with mobile so you
really go whoo yeah so now we're gonna
change this kind of stuff to make able
to create a GWT first and after that in
the next episode we're gonna make sure
then we can now add the user inside the
user context in the application so we
gonna jump on the code so this is all we
let the code in the past it is a first
thing I'm gonna just maybe make it a bit
bigger for you one sec yeah okay so now
what we gonna do
it's first thing I'm gonna show you all
the little tips tips you can do with
MongoDB so for now when I love example
this is what I receive really bad I mean
III don't want to have the password I
want to have only the ID email and
username oh we can do this it's pretty
easy you go inside your auto education
model right inside the metal right there
you can override a method of MongoDB so
I'm gonna just add here some comments oh
all right the - Jason metal for make
sure we down send password so here we're
gonna say - Jason make sure you have a
coma right there so we're gonna override
a - Jason met up built by the Mongoose
so it was begin SAS we want to add the
idea of the user so we're gonna sit this
that ID remember
this is the methods so that's going to
go over it's a method over the user
documents so by doing this that this
mean the user himself after we can say
username this is the user name and your
email this is the email if you asked the
question about where I get this value
just I get this value for me it is the
email there's that username and now just
by doing this nothing change I mean look
at my controller drag that user but now
by doing this now when I'm gonna sending
postman look what can happen it's now I
get only what I asked you we override to
GSM method so what you need to keep in
mind its Mongoose by default when you
send back inside a JSON format like that
so that ji-sun and you celebrate that
user you're gonna call the function to
Jason and now here we just have a write
it because we don't have to add the
versioning and we don't have to add the
pass one in the front end so if we just
keep the cookie now and this is the way
I like to make it inside the model it
just I mean by doing this if I want to
add another kind of method I can just
came here and add this and I know that's
gonna work all over my hat so know that
that was one of the thing
now we need to add a GWT token so if you
go to you to your browser and you go to
JSON web token so I think that's going
to be GWT that I owe you can I see what
is a GWT so GWT mean for JSON web token
it's so we finally to add a security in
your app so that's gonna looks like that
this is added ability here you see they
have some kind of color the red mean the
headers you can see this is the ugly rip
after that the purple mean it's the pale
oh why it's an object so this is what
you send funny inside the token in here
this is the secret you can add for make
sure then this is a verify token because
if I do this this is an invalid
signature so that means yes this is a
token but this is not the token of my
application because this is what you
need to keep in mind what you put in a
token a token can be decode by everyone
if I have added ability and that if I've
made the durability library I can be
called every token you up but what makes
sure then this is your token
by having this signature with your GWT
secret so by doing this example if you
get a token coming from me you gonna
make sure then I mean this resort it's
not a user from you because it's not the
real token and also you need to do some
other verification but you see my point
so why I told you that it's because
don't put password here
don't start put the password they use
our ear and say via example password 1 2
3
don't do this because the pass for now
is inside this thing and look if I treat
my secret I cannot continue to decode
your stuff so don't do this really don't
do this
just send what you need so for me
example I can send a I just always put
the ID in the token almost right I do
this it's because for me by doing this
the idea can just make sure this is my
real user because I'm gonna find in the
DB if this user exists so so what that
mean sorry
so what that mean it's now what are we
going to do it's we're gonna need to
first thing make sure then we're gonna
install a library called JSON web token
so this library just a really simple
library we're gonna make sure we're
gonna build a GWT come from the sender
after that good to you constant folder
in a right ear inside development
because we aren't there we're gonna
create another constant called GWT Syria
and in this one for now we're gonna just
lol but don't use it in production when
you're gonna use in production use a
really really hard thing to break so now
go back to you user model now what are
we gonna do
it's we're gonna import GWT form JSON
web token and also we're gonna import
the constant object coming from the
config file constant so now what we can
do
it's we're gonna create another method
inside the user I like to abstract my
thing so here when I'm gonna create it
we're gonna create a method called
create token so now in my user what I
can do is I'm gonna say example I can do
something like that user that create
token and they're gonna create a token
which is value here so what I'm gonna do
here
I'm going to finally return GWT that
sign right here this value take a pelo
take the take the pelo as an so finally
what you want to put inside that after
that can be a string an object etc after
I gonna take this secret and also some
app shell
so here the payload is going to be an
object I'm gonna have the ID what I'm
good at six days that underscore ID like
that so that's going to be the user of
the ID of the user after I'm gonna put a
como any I want to have my secret this
secret
current stem that GWT secret that's it
so this is all we can create a token now
what I'm gonna do is I'm gonna create
another function like that to JSON but
I'm gonna call that two out Jason like
that I'll forget the cool come on in
near this function look at this gonna
return an object for air what I'm gonna
do is I'm gonna have the to clear who's
going to be the dis that create token so
this function right there and now I'm
gonna say dot dot dot I'm gonna use the
sprayer I'm gonna say this the jason to
jason so by doing this what's gonna
happen
it's now my object here's gonna looks
like this an object where I'm gonna have
the token so the GWT after that I'm
gonna have the email and today I'm gonna
have the username and I'm gonna have the
ID now you may be asked okay yeah but I
don't really understand why you do this
spread it's because now I just take this
thing they my token and I'm making an
object by doing this I flap my object so
you're gonna see that right there
go to your odd controller right there
and here inside the login now due to out
Jason like that nothing more we do
nothing more but now come back to you
postman and click the login and now look
at this this is what we sent to the
front end right now the toe can right
there so this is what GWT token looks
like after that we have the underscore
ID the username in the email man if I'm
the front end of that I'm gonna really
happy with what I'm gonna receive here I
can get the ID I can maybe get the
username for sure
like at the top right of the screen like
Jon Snow this is your profile something
like that and also I can maybe show the
email something like that if you will so
you see what I mean it's do you friend
and now can use this value and now what
are you gonna do it's gonna take this
token gonna put this token inside the
adder so examples are the others you
notarization and what are you gonna have
access to your app you're gonna make use
of this token but we're gonna see that
in the next video so I hope you enjoyed
this video again I'm gonna add the code
on the on my repo and the repo in the
description I hope you enjoy let me know
in the comments also please share this
to your friend if you think they can
learn too and also subscribe if you
didn't so I hope you enjoy and we target
our other goodnight bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>