<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 3 | Coder Coacher - Coaching Coders</title><meta content="Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 3</b></h2><h5 class="post__date">2017-07-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3BeFarO6Wt8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">maybe one or three today what we're
gonna do it's about decreasing the use
are so make it sign up and logging so
first thing before that I want to thank
you to people who have made some pull
requests about updating the ring nice
okay yes and Stefan sorry for the name
but Steven thinking about that so the
change the ring me and make it more good
English so think about that other thing
I want you to go to this side I'm going
to put in the description so this is a
graphical app so this is finally an
electron app build on graphical Abdul on
the electron and this is like that so
that going to make you your life much
more easy to work with graphical then go
in localhost because on all the way plus
we're going to need that for adding the
HTTP headers for the next part so I'm
going to put the link in the description
after that some people have asked why
which tool I use for MongoDB and this is
a verbal Mongo now they have renamed
that for rebooted 3t and this is pretty
simple it's also not key see your
MongoDB data inside database perfect so
what we're going to do today is we're
going to start by making the user schema
so we're going to jam the DB step first
so we're going to go in the model folder
here and we're going to create a user
that GA so that's going to be the place
where we're going to put all the color
but MongoDB for the user so nothing
crazy here we're going to import import
mongoose from Mongoose in the schema
after that we're going to create the
user schema inside this one
going to put what we name and I'm going
to already explored if all the Mongoose
model well we give it the name user week
uppercase you and I'm going to call that
user schema perfect here what I usually
need so this is a tutor so Twitter clone
so we're going to need a user username
sorry
and now I'm going to say that to be
unique because I don't want to user to
have the same username after that I'm
going to jump on the first name so I
want my user to have its first name
that's going to be a string
I'm going to jump on the second one
who's going to be its last name after
that my users don't have truly another
Tower so that's going to be a string
here that because it's going to be like
a link to an s3 bucket or something like
that so that's going to be a URL after
that we're going to have a password and
also we're going to finally add an email
who's going to be a string so I don't do
any validation with this app for now it
just because I want to get jumped on the
Vietnamese for the quick care I can and
also I'm going to just add here the
salmon stem to be true because I want to
know when the user I've been create and
update maybe in the future perfect so
now we have the user schema query
perfect so we have one thing to do it's
done after that we're going to go in the
schema model on graph QL so inside
source graph QL schema that here I'm
going to create another time and I'm
gonna call that user so here I'm gonna
say ID to be an ID so unique advantage
here for the graph to a server that I'm
going to say II had a user name who's
going to be a string email who's going
to be a string and now I'm going to put
at this exclamation point with me email
for sure is going to be there for sure
100% we're going to do the other
validation about that later but you're
gonna see why I'm going to after that
say first name going to be a string
last name to be a string add at all
another string and now create app and
update on your just copy these two
things
here yes but where is the password yes
we don't need air
so why I don't put that air it because I
don't want my time to request this
password I never want it so why it
because first thing is for security
inside own thing it's in vs API we make
we manage that all in the controller or
maybe like in the model but Ian SQL
would just mean to say hey my client can
access that here at my changing just by
down adding this stuff here so yeah
that's a good thing up from your human
so time to jump on the resolve are so
we're going to create a resolver file
for the user inside this one we're going
to import import the user model from the
model folder so the thing we just create
after that we're going to do like we do
on other stuff like the tweet we're
going to export it for everything we
need that so first thing I think it
would be a good idea to sign up a user
so I want to create the user so sign up
here we're gonna have some action
committing error so the first thing is
still the root value we don't need that
anymore again here now what I'm going to
say is I'm going to destructuring the
value I need so like we did on the
Twitter is over when I say like ID where
I did searching the idk meaning from the
arts yeah I'm going to destructuring the
thing I need for my app so what I'm
going to need is its email about our
password I'm going to need its username
and here I'm going to full name so what
I mean by full name here is because I
don't want my client keeps n the first
name and the last name I separate and
make two input so that what I make use
is the full name and yes we can get the
the first thing by by doing some
JavaScript code here so what I'm going
to do is I'm going to split the phone
name inside an array so this is the
string I'm going to fit that inside an
array by making that
split like that what I mean is example
if my string is a manual super like that
for my name my result of this going to
be equal to a manual and convert like
that so now I'm going to ask an array
with my two values separated by the
space so that's why we have a space
right there so now what I'm going to say
the first thing so this is the
structuring again I'm going to put my
video about this Wittering in the
description I'm going to say your first
name so I'm going to call the first
value so maybe if I keep that like that
I'm going to cause the first value so
this one first name and if now what I'm
going to do is I'm going to put a comb
on I'm going to take the last name so
here what I say it's finally if at two
so if my have like I don't know like
Jones like that here I'm going to have
to value like this so my name is to
manage on screen per mark my first name
is the first name here but my last name
I want to be equal to these two thing
here so by doing that last name what I
say it's this thing now going to become
my my my last night that's it
now I've 19 here and now I can create my
user by doing return really important
because we need to return the user here
for make use of this inside Defty well
let's say username password email and
added or another thing we should have
done to it I should have put swimming
like that and I can make that the arts
or read like that and now we're I'm
going to put my wrists but really
important first interesting and now here
what I can do is I can see that the R is
again really important because if you do
it on the rack that's going to be an
objection side the object if you
this week an expert everything so by
doing this we know we put everything
back inside the user and in here I
forget to put yeah but now the thing is
maybe they're gonna make more sand after
we create that in the scheme also inside
the mutation I'm going to put the sign
up right here I'm gonna put everything I
need for that so everything I need for
my my sign up resolver so the argument I
need to put so I'm going to say email
there's going to be a string require I'm
going to say full name we're going to be
a screen require I'm going to say
password who's going to be a screen
require I'm going to add a Tau it's not
require and I'm going to see the user
name with the string and sign ID for now
I'm going to return the user so you see
email full name password edit or user
name when I came to my resolver I just
destructuring the phone name I make use
a different name actually two variables
first name and last name and finally all
the other stuff so email password ad
vitur in user name become inside a
variable object called rest and now by
spitting that ear I can create my user
with all the stuff here I'm going to
finish that by going inside my index
resolver and I'm going to do like we did
with the tweet and I'm going to import
my user resolver and finally I'm going
to go to the bottom right there
and I'm going to put signup and I'm
going to see user resolver that sign up
so now I'm going to check if everything
everything looks okay so don't remember
to start your server so now what I'm
going to do is I'm going to jump to my
graphical app here you can create more
than one like more than one stuff by
doing comment t so this is how I make
that and you can give it a name by
double click here so here when we check
in the ducks we can see we have the
mutation so I'm going to just refresh if
I've checked in the mutation looks like
we have something wrong
mutation I say sign now say this schema
I'll sign up here looks ok what I mean
thing is that when I restore this one
yeah so sign up is diner so now I'm
going to run my command so I'm going to
go on my Robo mango ok now I've won so
I'm going to delete this one well so
here inside my users from my collection
to development and my user with an empty
so now I'm going to run my run off via
peer so I just put email email password
full name so whenever I need to email
full-name username and password
I don't put an avatar for now and now if
I signed up that now I get back this
user right there
now if i refresh this thing here now I
get my user with a manual and confirm my
stuff here and I put my password was
password 1 2 3 was this thing here so
finally everything is working this is
what we want so you see the first name I
send my full name as American power any
take the first variable like I told you
first name and Quimper get a variable
perfect this is what we want now the
thing is something I don't want it look
at this password I don't want my DB to
save the password as a plain text like
that it's crazy it's really not good for
security so a way to manage that is by
adding a cryptic crypt dispatch work so
we're going to ask the password so all
we're going to make that is by adding a
package inside the server we're going to
add the crypt no DF so this package
gonna have to function who can create
the password and one can compare the
script version with the nut script
version so here we're going to import
from be crypt
oops that body Porsche but B Krista
we're going to import ash sink so that's
going to be in synchronous version of
the of the function and now here we're
going to start by making a method so I
mattered it's something you can column
the instance of the user schema so that
means on the user in the cell folks here
were here inside the ash password we're
going to pack a password and we're gonna
return return ash sync with the test for
minute the only thing you need a Shing
the only thing ash ending is the data in
the salt where you can put the thing you
want so here I can put like 12:01 sorry
I'm gonna have 12 wrong about that and
I'm gonna talk more about the occupation
but you can look in the documentation if
you want more about this here when I'm
going to fix I'm going to say user
schema that three six one six don't
worry I'm gonna tell you what they do so
here finally I want every time I create
a user I don't want to manage myself to
create this version ash I want to make
that progress like now on my app to make
it automatically so what I can make use
it on the preset method so MongoDB
absent hook on it so what I mean it like
it's a pre look so that means before
something happened in area when I say it
before this schema so the user have been
saved I want to do something so this is
a really good place where we can creep
the password so the user give you
password 1 2 3 and B 4 MongoDB together
is save it as a
- version you're going to see that right
there
so here we're going to do an if
statement where I'm going to take this
is muddy Phi and I'm going to say
password so here what I mean if their
face already cow also if you update the
user so if example if I update my email
of my user the precision happen the
so if I don't do this if this is modify
password so what that mean is if the
user or modify this password you get a
recur again the password this is not
what we want we only want that to trip
when you modify the password or maybe
create that yeah you do this is a
password so we have access to that this
so that is going to be the user insert
so that's why it's really important to
put function in that arrow because if
you do this you're going to lose like
the the context of the dis yeah I'm
going to say equal this so again the
user and now I can call the function ash
password become now and method on this
user and now here what I can do that
just now here what I can do is I can put
the disk that password so that's going
to be the same version here but now this
is a password going to be equal of this
thing and now I can just return next
with me now I want to continue and here
if I have nothing I return next to like
that so how can we test that now I need
to go there and deal in my user because
I want to use the same username what we
can do it down on the mug go there give
shift command D or shift control be for
the the Windows user and I'm going to
import my user schema and I'm going to
just finally remove all the user
every time that we fresh so now that we
fishing so I think my app is refreshing
okay so now if I do this now you see
I've no anymore no user anymore perfect
so now what I can do is I can call again
a user may create another user I'll get
an error so sure oh yeah sorry we don't
need to pass semi usual we don't need to
pass the number right there
looks like my mangu mine on month on
restarting I don't know why
I know if i refresh now i'm going to
sign up and boom my usual sign up did
perfect this is what we want I'm going
to refresh here now if I open my user
boom now I get the past for actions
version perfect now this is much more
secure than having the the passwords a
plaintext but now time to make it log
but now we need to do a bit more because
before I was using eg so this is the
mail if your password do they match yes
but now we need to compare that with the
cryptid version so we can make use of
the function conversing who is a
function which check finally and good
check
the password cryptid with the password
you give it I'm going to call another
function on method called authenticate
user
we're going to take a password if I can
type it in here when I return conversing
who here as you can see take some data
take their access region and return a
boolean so here I'm going to say
password I'm going to sit this the
password so there is going to be the
password of the user
that's why this is in centimeter and
this thing we know that's going to
return a boolean so we can make use of
this inside the reserve resolver so
we're going to drum here we're going to
make a logging resolver the logging
version you're going to need to be
anything one who down can add nothing
from the root here we're going to just
need the email and the password
destructuring because this is what we
need to make sure this is a good user
after that we first think search if the
user exists so we do fine one and we
pass the email so we're going to find
one with the email if we don't find any
use our anger the true and a new error
code use are not exist so that means we
have new user here so first thing we
start so maybe like the user didn't then
create after that here I'm going to say
if the user that atactic a
user so the function we have right there
so I'm going to copy paste the term if
these are and I pass the password coming
from the front the front end so this one
so what happening is here I call the
user who is fine
and I say take the password so password
1 2 3 and check if that's what I wanted
to equal the version who its script L so
this version right there so sorry
so if ear that returned as a whole so
that's why we have the the bang thing
here I'm going to true again a new error
call password not match so that means
the passwords don't match but the user
is in infinity I'm going to return the
user so we create a result VAR what we
need to do go inside the index put the
resolver here I'm going to sitt going to
be always the same kind of pattern
internally we jump back in the schema
and there's two more here
don't need a lot just need login we're
going to take the email require and
password on the B string 2 and for now
we're going to return the user perfect
so now if i refresh my collection I'd
know user so for tests that I need to
first thing sign up the user so I'm
going to create a user perfect add my
dues are right there with the reversion
cryptid now if I go in Lord so I could I
put my email I'm going to see password
walk password only and as you can see my
password was that's one two three well
not if I send that I get a never user
authentication it's not a function so I
get a error right there authenticate you
learn not a function what I am
well I think happening again didn't
refresh well so I'm going to try again
if I sign up
and now if I love oh I know what so I
know why it's here I do countries are
but as you can see I didn't make use of
the away so finally the user never
really came so now that's going to
refresh perfect
now inside my schema so my user I have
no user so I need to create one so I'm
going to create one perfect
and now if I try to learn I get past one
that match why because my email having
linked this if I send that Co I got user
on it exists because my only user has
that come here so now what I can do
I'm going to check is the real one word
so just for showing you the user
password was password one two three now
if I match perfect now I can get the
username and I can get all my
information about the user and that came
with the password one two three we know
we know equal this thing so I hope you
learn a bit here sorry about that that
was just you know I forget the away so
the promises never finish so the user
never came really ear with that was all
synchronous here what happening that's
where we get this thing so I hope you
enjoy again I put the link on the
description about a building I talked
about so about the rescue lab about the
robot Mongo stuff and about my
destructuring video also I'm going to
put the repo again on the description in
an open jar and without later as a good
day bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>