<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create a NodeJS + MongoDB Rest API [Part: 3] | Coder Coacher - Coaching Coders</title><meta content="Create a NodeJS + MongoDB Rest API [Part: 3] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create a NodeJS + MongoDB Rest API [Part: 3]</b></h2><h5 class="post__date">2017-05-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/i5yb_HRWbeg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys so part three time to do some
use our sign up stuff so today what are
we going to do is we're going to set up
the basic of the sign up of the user so
we're going to create a user model the
controller in the route because we get
an exciting to just set up everything to
be ready to be crib the past war and
everything in there next it is a so
today just we just want to be able to
create a user nothing more we're gonna
after that install some awesome tool who
is free rebel Mongo for working with
MongoDB and postman who is an HTTP
client finally for call your ETI and
we're going to add the jar and Express
validation whoo is just so fun I mean it
just it's awesome I mean for make
validation in your server so what we're
going to do for starting it here inside
the source folder we gonna create a new
folder called module so much so what I'm
going to do it how I set up the stuff
it's like I make a module for each
resource of the application so we're
going to create as the first module
called users so user going to be where
everything about the users are going to
go so we're going to start with the
model I think it's a good place to start
so I'm going to create a file called
user that model a GA a what I'm going to
do inside a user model I'm going to
import at the top Mongo's coma and I'm
going to put a schema what do they web
did I just did here with the curly
brackets chemo because you're going to
see right there when I'm going to do
can't use our schema equal new schema so
I don't need any more to take it from
the Mongoose I don't need to do Mongo's
that schema and so just I mean for me I
just love it like that so i'm this
structuring the schema function coming
from among groups method i saw that here
inside among the user schema so i'm good
i'm going to already experience I'm
going to do X
or default Mongoose that model I'm going
to call it user I'm going to use a
uppercase right there and the second
argument the model take is the schema so
we get in a name of user so inside the
Mongoose Mongoose we're gonna have a
user model and we give it a user schema
after that we're going to put what we
need for the user so we're going to need
an email we after that we're going to
need I think a first name it's a good
case first name and then be an object
again and that's what I'm going to do
last name and password because we need
to login so email emails going to be a
type of string after that I want it to
be unique so I don't want to use our to
be I wanna use our to be like unique so
I want the email to no one can use it
again after that I'm going to say
require and here I'm going to stick to
argument I'm going to say true and here
I can say which kind of message I want
to send when the user don't send email
so that's going to be email is required
nothing to is the ear after that I'm
going to say to him true I don't want
the user to maybe like put its Pat its
email in example a test a gmail.com and
maybe it did a space after that so I
want to remove that because maybe that's
going to be our after that for M to log
again after that e I'm going to do very
day everybody dick it's an object we
take a validator and take the argument
so the argument is the email in question
so here now
we need to send something and we can
send to a message so I'm going to do the
message right now it's easy so the
message and I put in uppercase value
inside curly bracket like that it's
there it's going to be like a variable
about the value about what
I guess from ear so that we omitted the
email coming from the front end so I'm
going to email its value it's not a
valid email but now I need to make some
validation so what I'm going to do is
I'm going to gonna just add a library
called validator
it's an awesome easy-to-use library to
make validation and we can use it in the
front and in the back end so why not so
here what I'm going to do is I'm going
to import validator from validator after
that you the only thing I need to do is
return very data that is email and I'm
going to put it inside a parentheses I'm
going to put email so air that's going
to return a boolean do this email send
from the user it's a real email so I'm
going to receive true or false so if
it's become foul I'm going to get this
message
err and the value from ear going to be
the email cremini perfect so that's
going to be this for the email phone
after that first name type string
require true we want to be required this
thing and I'm going to just put a
message to so true and first name is
required and finally I'm going to say
true am to be true again I just want to
be sure I have no voice but I'm going to
copy paste this line comment see an
opening curly bracket command V right
there and I'm going to just change the
name here to be last name nothing more
first thing that thing is the same
password going to be a bit get more
stuff to do again a type of string I'm
going to say require to be true I'm
going to put again my awesome message
saying password is required after that
trim true again we don't want to make
problem with the logging after that min
length now we're going to pick six I'm
going to say password need to be longer
Oh what is that I
say I want the passwords my user to be
added the year I mean I don't want a
password to be only five of them and I'm
gonna see what I mean it just for
security I know now maybe I don't need
to do this with the validator I'm going
to create but I wasn't really sure about
if I want to make it and just maybe my
write a reject don't gonna work but
you're going to see in a moment so you
don't really need the assign of code so
I'm going to say validator here and I'm
going to sleep asshole so the password
kamini the rest again a password and I'm
gonna say message value it is not a
valid password perfect before I do this
I'm going to just copy paste design
shake command D after I select I'm going
to see user name when I just forget this
one and user name is the record perfect
now password what happening here now
here I want to return again a boolean
what I can do I want to create my own
validation so what I'm going to do is
I'm going to create a new file at the
ear and that's going to be a user the
validation the gia that they starred on
came with the kind of password
additional one so that's what I'm going
to create mine so I'm going to just
create a function another year password
reg so that's going to be reject and now
that's going to be my rejects here
website rejects x-bar that calm you can
test your reject so here I've created
rejects right there you know I can save
that gonna work like if I type this this
is not working because it's not blue
what I need is I need to uppercase six
letter and I want to add at this a
number side a number going to work so
you see if it's not six it's not working
and if it's six it's working it's at a
number if I had no uppercase don't gonna
work so what I ask is I want an
uppercase and six letters I'm going to
captivate this
thing here and I'm going to put it
inside to slash like that so this thing
now is becoming my rejects so you can
post a video I mean if you want to just
type this thing I don't gonna take too
much time here but you can play with
this on reject X or after that I'm going
to jump to my user model and at the top
I'm gonna import this famous rejects
with awesome you just I just made so
inside curly bracket because export
can't I don't do export default so here
I'm going to see password reg yeah oh to
complete from Visual Studio code it's
awesome I'm here the only thing I need
to do password test password by nothing
more to do so here that there return a
boolean value to indicate whether or not
a pattern exists in a search string so
it's a rejects of finally because we
create a rejects we have no access to
this duct test communing perfect now
it's working so anything email I need
the first thing and in the left knee and
in my username and I need a password so
you see here what I mean when I see me
in them I don't really need this thing
because I have my valide so we can
remove it I'm going to keep it there
just for make me talking here so I'm
going to create a route now so user that
route that GF and I'm going to make
another funk or user that controller
that GA controller ticket s so this is I
mean this is kind of convention I create
for myself
so here inside the controller I'm going
to import my user coming from my model
so use our model that's it because of I
am using this kind of solar structure
it's so much is after that for me to
import it because I know everything is
below the sink folder so I don't need to
do that does and go from one go to you
see what I mean if that I'm going to
create a function and nesting function
so that's why I told you in the first
episode you may be going to need to at
least learn some
easing avoid programming and this is
really the I mean it's if you know
premises I think I waited just the
separatory so call back well L after
that premises came generator came and
now eating and eating it's a mini just
sugar so I use it every time try catch I
told you I love to I catch what I always
do first
it's after I clean my my controller the
first thing I do is after I do my two
racket are already returned so I
returned I read the status 500 and I say
a JSON I'm going to just send as a GSM
the error object so here is an error
object oh you see yes soon again so much
awesome you see it's the time I never
use empty block statement so it just
help you don't have error with you code
before I mean I don't run my code so
it's just awesome like that here current
user equal await so this isn't here my
premises create so this is coming from
of Mongo
Mongoose that I returned a rare that
carries a good status for creation 201
yeah not 200 ok 2 1 3 8 Jason I want to
send back my G's and my user none don't
worry I have not really I don't gonna
send a dispatch throwing everything on
the other video but now I mean it just
for testing purpose yeah not worry I
just want to make sure everyone gets the
same phone
so we're going to go easy rather what we
need to do here we create a route
finally gonna import route are coming
from Express I don't want to do Express
that router so that's why I mean a
destructuring the router from Express
after that ear I'm going to import
everything as user controller from my
controller what I do this
now my user controller become an object
with everything ads so now you see the
Autobot ring told me at the sign up and
the sign up it's my function who have
reckon rare so that's why when I do this
I'll I mean I love it so current route
I'm going to do an instant of my of the
router your router
after that II I'm going to sit round
that post I mean we create something so
it's a post here what I'm gonna do is
I'm going to fix sign up after that I
just want to pass my user controller
that sign up nothing more to do export
before route rather Rock yeah like that
so now we have create everything if I
start my project so I'm going to just
turn our projects or first window you
aren't deaf build the other terminal
join this perfect Mongo story yep and
then import this file I mean it's normal
it's normal that were I don't input if I
so finally what I never told you this
code so I need to import it so what I'm
going to do first it's inside module I'm
going to create index that gif file why
do I do
why did I do this fight so I mean you on
the samurai try to say it
I'm just abstracting some stuff like a
I'm going to take the user route coming
from my user folder route and a what I'm
going to do is I'm going to cut that
function like I did in the middle work
take the app in here I'm going to do app
that you API here API v1 that user and
I'm going to use a route that's so again
you can understand I'm going to pass the
app inside this function by doing this
and the v1 it because example this is
you further version of your application
you have made
you're out your controller your model
like that you want to update your
application but you don't want to shut
down what you have right now so here you
can have multiple version and just make
one at the time I like this one I mean
it's just much more easy you don't need
to shut down your main application you
can just change some kind of resource
like that after that now I'm going to
jump back to my index that GS so in time
I intended just now that's going to be
the place where I'm going to import
finally this this API route so what I'm
going to do it here after the middleware
I'm going to import API route from my
module just module because its index Jia
JavaScript small enough know when you
don't put a file you're going to take
the index idea so that's why we sell it
up index idea inside you project after
that I'm going to just make it after the
app that gate I mean it's normal after
the app that gear so I'm going to do ETI
route let's say ah so now at this point
that was the place where we can have
shut down everything but everything's
still working we're good to go after
that time to jump on Google Chrome first
thing to install I want you to install
rebel Mongo it's free it's awesome and
it work I mean easy work on Windows it
will a Mac zero and everything and this
is just cuddly you as you can see a GUI
to see your ruble your MongoDB I'm going
to close this for now
after that post Mel free Mac Windows
Linux or you can use it with chrome and
this is just a way to make HTTP requests
so this true thing you will really need
that I mean I'm not alone think this is
good look at all the company use it and
on every project I think I use it always
so so what I'm going to do so this is
the rebel Mongo URI when you open it
after that after you create you first
you just click on create and click Save
already so you're going to go to your
local after that you open the local is
right there and you drum and you find
the database here I'm going to open make
no GS EP ideas because we are in there
now go data a collection of user so this
is the collection I'd get created by
this team oh don't worry if at this
point your user collection is not create
because I've done some testing I mean
I'm not Adam a lot of mistake in the
past by like cutting always now I try to
and I mean try to be a bit better so I'd
sure I caught before so add this stuff
after that postman you open it what I
always do in postman is I create a
collection so you click errand
connection you click on create a new
connection you type the name of the
collection you want after that that gave
you a folder you create the HTML post
like that after that you say say that
you given a name you find your
collection that's it and now this is
working on your folder and why doing
this you just that become much more
exact alert to just came back and what I
really love about it you can import
cycle in everything so at the end of the
project for the one who don't want to
just follow every cutting stuff I'm
going to make it a importable so you can
import it add a blog post I'm going to
show I'm going to put it in the
description about how to run testing and
everything in postman I mean if you want
to read it and I take you three minutes
you're going to learn like how to run
the runner and everything and you're
going to love it
so you see like you can run some testing
and everything perfect API v1 so what
I'm going to do first is I'm going to
run to a get request inside my local
house mm perfect
I get my hello world my back end working
I get 200 right there
perfect everything is working after that
I'm going to go to my route so now you
see I've changed this stuff but because
I'm saving it inside my postman I can
just click again I'm gonna click you see
don't say and click oh it opened for me
and look here I can open xform URL
encoded why can I do that now
middleware config middleware this line
of code right there this line of code
it's the one will make you available to
make it stuff so here I'm going to
create a password
hello we know that dog gonna work I'm
going to create this address I'm going
to put a first name I'm going to maybe
create a new key so user name I'm going
to say a John do one and another thing
adjusting usually need to be unique and
trim take it no e unique true did I put
Y on everything yeah you see all about
our I am here sorry
yeah shrink you can perfect your time to
work I'm going to send this message
right there this is my error test gmail
is not a valid email so this will value
is not a valid email model value it's
not a valid email you see password need
to be longer and finally the message if
user validation fails I ate this message
I mean eight oh is that don't worry this
pain don't gonna stay until the end I'm
gonna make it pretty I mean I love
beautiful code I love beautiful error I
mean I'm the kind of person who like
perfection and I really like when my
error shine so here on I'm gonna see a
good email so give it as a gmail that
come when I sent now pass for need to be
longer so ello will now get l1 is not a
valid email password yet because I need
an age and on one boom as my user create
I go to Robo Mongo comment air
controller folder window
Allen I'll Jack I can open it ID coming
by default by MongoDB password email
first name last name username and ear
what is this stuff
what is this underscore underscore V
this
your version of this document you're
going to update it going to going to
increment by one this is a way to
remember like suddenly like a old old
version of your stuff man here and I
mean how this meditation it's made in
the in the model it's not what you want
the database not supposed to be your
secret it's supposed to be there the
security your database it's your last
layer of security in your application
this is not the place to make it do all
the validation like that we're gonna
make it in the controller so go back in
the code I'm going to go in the
controller now and you're going to sell
out of tutorial we're going to take our
username equal reacted body example
something like that I'm gonna see if
username typos like you see what I mean
type of string it should ever or
username blah blah blah what I like a
package awesome so simple to install you
go to your terminal yarn or NPM install
joy that's main that a theme of a PGs
and I mean I love it going to why I
create a folder a file here only for
validation I mean this is just I love it
yeah as you can see I'm not English by
default so I have not a lot of
vocabulary so import joy from joy here
what I'm going to do so is that's going
to be other validation of my user
controller so I'm going to export
default so I'm going to export different
object this subject and add a sign up so
here I'm going to say which controller I
want to toggle here I want to toggle my
sign up controller component object I'm
going to say what I need email password
first name last name and username so
I want to make validation for all of
them email email is going to be equal to
so I'm going to just emails going to be
equal to joy that string it's a string I
need to be an email and require that's
password the joy that string that
rejects password reg I can attach my
widget right there I do two thing in one
take my password reject you I put it in
my model I'm in my last layer of
security enjoy make my life so much
easier right there and I'm going to say
then this stuff it's require to take it
first name it's going to be equal to joy
that string and that's required nothing
more I mean I mean we cannot say like we
want a minimum for the first name I
cannot say like I if your name is Joe I
don't care I cannot say
don't make less than true character you
you see and because it's require if you
have no character that's going to be
toggled so I'm going to just just
copy-paste this thing and I'm going to
make it for this thing and this thing
we're going to make other validation for
the username but just fun Allah is going
to be good so this stuff here all can I
make it work with my controller I mean I
need add a way to make it working out
and I did I do this we go inside usual
row we need one other package yarn add
Express validation Express validation is
a way to make validation as a middle one
inside your app so that's going to
happen before the controller toggle like
before the so the idea is TTP request go
to the winter controller and everything
so that's going to be fall we had access
to direct that body here I'm going to
import validate
from experience validation here import
user validation from my validation file
and now as a middle wire as always I'm
going to put right here validate so this
is a function and I'm going to pass user
validation duck signup
nothing mark let's give that crash no
the app still working now I'm going to
send this thing this thing is supposed
to work
yeah but now what I got duplicate three
high 80s message don't worry
neck citizen or the second one we don't
gonna see this kind of error anymore I'm
going to just say so I'm need to add
another username and I need to have
another email now I'm going to send it
when I remove that top right end this
now I get the email so finally now my
controller do the job for the validation
and it's not just anymore the validation
very coming from Mongoose and we're
going to make some kind of filter of the
body so we're going to make a wide list
of what someone can send so don't worry
about that we going to work with all
these stuff so after that when it's good
I'm going to send now is working go to
my Raghavan go come an arm refresh
controller window and what everything is
working perfect so that's it guys I mean
that's going to be done for this video
so I hope you enjoy let me know in a
comment or you feel about this kind of
tutorial I hope you enjoy it please
share this stuff if you think that can
help someone else and we talk later
have a good night bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>