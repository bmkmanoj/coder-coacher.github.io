<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part: 23 | Setup of the following system | Coder Coacher - Coaching Coders</title><meta content="Part: 23 | Setup of the following system - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part: 23 | Setup of the following system</b></h2><h5 class="post__date">2017-10-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ldo0SsairC4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone welcome to this part 23
of the Twitter clone tutorial so in this
video so what are we gonna do is we're
going to start to set up the following
system so a new feature for the
application so as you know in Twitter
you can follow and get followed by
someone else follow someone don't mean
the other ones gonna follow you a shadow
a so this is something like friends and
Facebook where both need to agree then
we flow each other so so we're gonna
start to do like the following set up so
you can see it's pretty like something
like you can do pretty well it no sequel
database I know it's not that easy I
mean it's more easy in sequel database
but we can do something in no sequel
pretty easy to so what we're gonna do
today is we're gonna talk about the
schema what we're gonna do then we're
gonna just set up the basic schema what
are we gonna need in the next video is
gonna be about writing the action for
the schema and make it like work
dynamically and also after that in the
other video is gonna be about working
with the resolve are taking that to the
front end and show that to the user so
so the plan at the end of like this for
video three four videos gonna be two of
like a following system where you can
follow and follow and see someone follow
you and see if you follow someone and
also after that we're gonna maybe try to
do a better feed where you can see the
tweet the first tweet from your follower
Chalobah so when I came to do this I was
okay so what is the plan to do with the
new sequel database oh we can like join
table in sequel but like all we can do
this in know sequel so you have like to
kind of void and I mean I'm not the best
in database design but from what I think
would be good it's not this one so this
one it's finally when you have a user
you're gonna like this is what we have
right now and finally it's maybe oh I'm
gonna maybe add the following arrays
where I'm gonna add all the user idea
but the one I follow
and the same for all of our I just think
that don't skill a lot I mean that's
gonna be really better for your
performance but the thing is think about
that you have 60 megabytes mom for you
MongoDB document so if this user follow
a cousin user and get followed by it
Justin Bieber so 66 million like you see
what I mean
so what I think will be better is this
kind of stuff
why finally when I use or create himself
like we did with a favorite tweet we're
gonna create a new database a news
collection called following user who's
going to add the index of the user ID
ear so like finally when the user get
create ich we create a collection we're
gonna add the user ID there who's gonna
be indexed so it's gonna be better for a
performance to find the following
correction so when I say index it's by
default
MongoDB index the ID we can add another
index oh it's gonna be quicker and
you're gonna get a following following
an array who's going to be antibody for
so this thing work okay so this is
pretty simple I mean every time you
follow someone we fill this thing now
all acting about that it's example it's
example all we're gonna find like the
con I know what you can do it's maybe
like oh I'm gonna get my following and
I'm gonna get my following air and I'm
gonna get the con but I just think will
be good sometimes you don't want to like
get you following stuff here and maybe
just a back on here we start at zero so
every time you follows you get you
follow someone we're gonna add one ear
when you unfollow someone we're gonna
remove one ear so I'm more like what we
did with the light and that's gonna be
almost the same with the follower so
when someone follow you because we're
gonna already have the idea of the user
that this user are gonna follow we can
just add +1 to the user you you follow
so example you you follow me by doing
this you have my ID and when I'm gonna
create
just following like action I'm gonna
have my ID so I can find me an update
and I'm gonna just do plus one to my
stuff and if you unfollow me that's
gonna do minus one here so this is our
thing about that and like and see like
yeah I think that can be pretty pretty
good with this thing I've also thing
about like if we want to add example
like Twitter ado when you go to a
profile of someone who follow you they
can see follow you at cetera but you
know the beauty of nosey qualities we
can always manage the schema and change
it without migrations we think we can
think about this in the future video and
also if you think this kind of setup
here it's bad just told me I mean no
sequel it's maybe not my big desktop but
I mean I try to just give you the most I
can so this is what we're gonna do for
any just this video I'm gonna be crazy
we're just gonna create a schema finally
and it was more about talking so what
are we gonna do finally is we're gonna
go to the model we're here we're gonna
just create I'm really bad with names
I'm gonna call that following user yes
so in this one finally we're gonna
import Mongoose and the schema from
Mongoose after that I'm gonna create a
following user schema equal new schema
and now a I can put my stuff and finally
we're gonna do the export default
Mongoose the model and following user
and I'm gonna put following user like
that and sorry for the I mean I have
just set up the code insider so this is
not the like that the one normally so I
have not all my setup here so like yeah
I don't like this color here but I mean
just color so I didn't I forget to
change it for you sorry about that
so here what we need so if we check back
to the video area and then the video but
here we are following
or need a user ID in the following so
it's gonna be pretty easy so we see user
ID was going to be a type of schema that
types that Jake ID like that and after
that what we're going to say it's the
ref and we get a say we have the user a
user after that we're gonna say
following who's going to be finally an
array of objects
here who I'm gonna have like almost the
same thing the same graph so it's like
it's like it's it's almost like a
relationship between like its user to
other users so that's why it's you need
to do thing like this after we're gonna
say following user schema that index so
if you can add an index an index chain
so I'm gonna say user ID I'm gonna say
one so that's gonna mean yes and also
I'm gonna say unique true so that means
for sure we don't wanna quit two times
the stable you and you can also do the
same if you one here so now we have this
so now what we can do it's go inside the
user resolver do like what we do with
the favorite tweet so shift command D or
shift ctrl D to copy paste that below
following one user from user and now
we're gonna do almost the same thing
years or shift command D but now I'm
gonna put the following user so finally
when we sign up we create a favorite
tweet connection and we could also a
following use our connection and now the
only thing we need to do finally for the
end of this video is gonna be inside my
user now what I'm gonna do is I'm gonna
add here following it's can't so that's
the kinda just show you right there
who's gonna be type of number and I'm
gonna say default zero and I'm gonna do
the same with shift command di again
follower cont like that so now when my
user screen himself
so when you create sign up we get all
this stuff here with zero and zero
football because I mean you just create
your icon you must be like no like
nobody you're gonna create a second and
a desig on you're gonna get like a
million of followers so that's why you
like you to start out at zero and after
that year the resolve are for now we
just say the fellow following user
create blah blah so in the next video
the plan is going to be okey so all
we're gonna manage to push an ID inside
the area of the user follower for link
and also all to increment this following
current and follow work on so I hope you
enjoyed this little video and I'm gonna
talk to our again remember the code or
is on github and the github link is in
the description hope you enjoy it and we
tell you the other got 90ml bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>