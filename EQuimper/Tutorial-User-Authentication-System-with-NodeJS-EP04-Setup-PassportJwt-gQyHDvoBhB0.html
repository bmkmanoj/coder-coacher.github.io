<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tutorial User Authentication System with NodeJS - EP04: Setup Passport-Jwt | Coder Coacher - Coaching Coders</title><meta content="Tutorial User Authentication System with NodeJS - EP04: Setup Passport-Jwt - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tutorial User Authentication System with NodeJS - EP04: Setup Passport-Jwt</b></h2><h5 class="post__date">2017-09-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gQyHDvoBhB0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome everyone to this tutorial so
there's a second part of what we done
with the GWT in the past one what are we
going to do for any weights we're going
to continue the the thing about right
now what we can do it's we can log a
user and get a GWT but what we can do
with the GWT so this is going to be may
be good for the wall we never really
work with durability just to understand
the principle about where to use it and
why use it and also I'll use it so what
are we gonna do for testing this thing
and make sure then you can follow like
what that gonna change for any new app
it's we're gonna create another route
err call / lol so that's gonna be a get
method who finally I'm gonna have a
reckon where I'm gonna wear that send
just a simple message if you see this
that means you know yeah
so I'm gonna save and I'm gonna go to
passport and I'm gonna sell and I'm
gonna just check if my message work
always remember localize EDD if you have
e1 it'll well you just now you don't you
don't have the front of out in front of
it so now we have create a route now
what we need to do now it's we're gonna
need to well like a way to add the GWT
and authorization and make sure then
we're gonna make sure then like this
route can I'll work if the user is not
logged so by doing this what are we
gonna do is we're gonna go go to
passport at GS and we're gonna free
upgrade the services we bill here right
now we use on the passport local it's
really good for building an email and
password application but now what we
need it's to install that's for GWT so
npm install pass for GWT or on an you're
going to see the libraries really small
so you're gonna go really fast first
thing we're gonna need to do it's
imported from depend in port some method
from this library the first one is going
to be the strategy and for make sure
then that gonna follow the low cost we
do we're gonna say JWT strategy with you
and also we're gonna need to extract GWT
after that we're going to do almost like
we did with the local herbs when I say
tada
Beauty up pts for option and we're gonna
say ear finale
weakness sorry yeah GWT from request in
a what we gonna do
it's we're gonna just say extract the
GWT from the adder with Kim and then
we're gonna set our Beauty so wait a
minute.what min you slime that mean it's
the dude ability gonna be inside our
adverbs we're gonna be inside the
headers on every request you're gonna do
so when I use our pose delete whatever
you do if you want to keep track of the
user all you're gonna need to have that
inside the others and file any what you
can do it's that's gonna be inside a
middleware you're gonna just take the
durability and make sure then this is a
real one so here what that means--it's
the from out well that I would scheme
instead mean no GWT code I need to add
the GWT in front of it so you your m-pin
ability is gonna be do the ability space
and you're talking right there
after that's distant gonna need another
crops on you and it's gonna be the
secret and for doing this we're gonna
make sure we're going to use the same
secret as we use for the when we sign
the jaribg finally when we create it so
we're gonna use it from the constant
object right there so GWT secret so the
other thing we bill in the past video
right there and now we're going to
create finally the strategy then I say
GWT login so just follow your own
convention here and GWT new GWT strategy
here it's gonna be almost like the same
as the here it's going to be GWT option
and after that we're gonna have a nice
thing called back where we can have the
payload and the dog that don't mean we
finish the middle why because remember
that's going to be middle work so now
we're gonna add a try-catch we're
finally we're gonna if we have an arrow
we're going to return the error and also
we're going to return false oh that mean
the user is unit arrives after that
we're going to see current user equal
how wait out model that's fine by ID in
here I'm gonna sick payload that
underscore ID so now you may be say a
when I mean what is this thing here so
first thing out model find my ID so that
mean that's gonna be the ID but we're
this payload that I deem icon is going
to be come from the model ear because
when we create the two coil who can
remember we have create a payload like
that so this is the payload this is an
object and we're gonna have dot
underscore ID so that's gonna be the ID
of the user so bit by having this ID
right there in the payload we can find
the user right there and now what we can
do is the same strategy almost as the
one we did in the top if if no user
returned done with no error what do you
say you know - right so that mean the
usual don't exist hey else we turned on
and we turn no ever but err return the
user but new user here you're going to
put that in the context of the user
inside there right that user you just
get here after that we're gonna say
passport that use GWT log N and after
that we're gonna do its export cons GWT
GWT and now out GWT I just want to keep
it the same as the one pass bar that at
a TK we're going to get ability and also
we can have session calls so you see
it's almost the same so this is the
beauty of passport when you make it work
one time it's almost always the same so
so don't we add that so now what we're
gonna do is because we abstract the
service we have Bill it's now inside the
observations we're gonna say out GWT
from here and now we're going to just do
shift command the ear or shift control
be I think in Windows we're gonna say
all middle GWT middleware
and we're gonna change this thing to be
all readability so what that means it's
now we are the acts from the services
where now we add the GWT middleware so
if you want to change the strategy for
the GWT middleware what are we gonna do
it's you're going to finally just build
another function you put there but this
thing here you're going to always stay
the same so now just to make sure that's
gonna work we're gonna jump here we're
going to import the all services from
the owl services right there and now
what we're gonna do it right there as a
middleware all services that debility
middleware and now by doing this what's
gonna happen is if I send back here
without any others I'm gonna get you
know to write a for one unit arrives you
cannot go there you have no ability you
have no errors at all so all we can now
test it and make sure they're in word
for things and again and again you see
nothing can work now what you can do
it's relog again take the GWT get you
come in see blue - vocalizing postman
again right authorization right there
and now pass the value right there and
now if I sell ya not working because
remember right inside passport yet I
just told you you need to a GW team from
a bit so now you don't read that but now
what you can do you do there GWT space
and now if you send if you see this that
mean you Lord like to see this that mean
you for who will this tutorial and now
everything gonna start to make more
sense for you so now as you can see now
what you gonna happen in the front end
if you're the friend and dad it's always
always and always get your token inside
you Eddard so say the to cannainsider
either if you use that in the web use
the local storage in the token ticket to
can make it inside you fetch request or
using X or whatever and put it inside
readers this week and keep track of
which user is that thing about that as
like you go to a show and you have like
you ticket on it if you have you ticket
the the doorman gonna always let you
enter but if you forget your ticket
you're gonna say a I don't care if I see
you that before but you need to have
your ticket or you don't pass so I hope
you enjoyed this tutorial and we're
gonna talk later where now we're gonna
start to send email about confirmation
emails I hope you enjoy and get on talk
to her and again please share it if you
think that can some of your friend and
also make sure you can subscribe and eat
the bill for getting notification have a
good night if you're on bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>