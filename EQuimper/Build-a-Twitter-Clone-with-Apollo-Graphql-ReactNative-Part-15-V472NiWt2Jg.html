<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 15 | Coder Coacher - Coaching Coders</title><meta content="Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 15 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a Twitter Clone with Apollo Graphql &amp; React-Native - Part: 15</b></h2><h5 class="post__date">2017-08-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/V472NiWt2Jg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">yeah
hello if you want for number 15 I hope
you're ready to have an excited part so
what are we gonna do is we gonna finally
make this application we will all time
for one of the things we are already
build so the plan of the day it finally
be able to make the creation of the
Twitter real-time so I'm going to I'm
going to tell that because I cannot add
to simulator with the iOS 10 I cannot
have to simulator in the screen so what
I'm going to do is I'm going to do this
by using the graphic UL tool so this is
what we're gonna do today so I really
hope this it is not going to be
something you're gonna really appreciate
so just get started so for making as
working with the real time with the
graph QL we have something called
subscription so the thing I really want
you to do before jumping on this and
jumping on this it is a will be to read
this thingy about subscription inside
the Apollo developer so I'm going to
send you that so they're going to show
you like all the subscription working
like the front-end stuff like that and
so that's going to be that's going to be
a all we're going to work with so
subscription it's about using a package
called a subscription transfer website
yet so this is what we're going to do so
we need to set up the server first and
after that we can run that in the
front-end so again this is something
we're gonna talk about and when we are
inside the front-end what we need to do
is call
subscribe subscribe to more and we put
there they're like the the subscription
we want and you're going to get it
pretty easy I mean it's I was really
amazing about how easy
Apollo maker that for so I'm gonna make
it half of the screen so we can draw on
the code so first thing is we're gonna
need to manage a bit the middleware
folder because I don't want to import to
thing the same time so what
going to do what I mean by that if now I
want us to take 35 years to 49 so click
the app that used here and go air and
pace that right after the middle work
right there but by doing this now we're
going to need to refactoring some stuff
so this is it with esam so we're going
to just cut this line here the ESN show
us which line we need to give that and I
need to get the schema here I'm going to
put that right there between both and I
need to make executable and I need all
that so what I'm going to do is I'm
going to take all this thing here if I
do this here like that
let's just make them below and now we
need to remove with one dot like that
any other constraint just because I
don't use it so now I can remove that so
let me go where we can keep it like that
so another server why I did that maybe
this is the question you have is because
we're gonna need to add the schema for
building a subscription and I want to
make that ear so one of the first thing
we're going to need to install so
because we can add some package is jump
in your terminal and run yarn add
subscription transport WSHH WSHH yeah WS
so this is website cap so what we're
going to do at the top is we're going to
import sorry about not import inside
square bracket security breaker index
and I came from subscription transport
what's up yeah I'm going to import the
subscription server we are in server so
we take subscription server here
so now after that what we're going to
need to do to its import to thing from
the graphical library it's going to be
execute XE cute and sub scribe like that
so now what we need to do to is to
create the subscription and point for
the graphic Tyrael Express ear so what
we're going to do is we can access cub
scription with F and point and now for
doing that finally what I'm going to do
is I'm going to just create a constant
because I want my code to keep always at
the same place I'm going to subscription
pad and I'm going to say slash
subscription so that's going to be like
that's going to be my my tab we're going
to add at the end of the URL when we
want to have access to the like a
subscription so when we all want to do a
subscription the the graphical going to
understand why to go you're going to see
that right there if here we're going to
see can't them that subscription path
but I cannot do this like that because I
need to see what will be the full URL so
I'm going to get back here and if you
have one with word circuit before you
know we need WebSocket in front of that
so ws locos and I'm going to stay here
my content that port and I'm going to
say right there
dollar sign that's on it like that
why don't put a slash here it because I
put the slash in my constant folder here
o standpipe so we are good here so
locale oh yeah so now we just create
finally the URL where we're going to add
the data data subscription but now we
need ear inside the L so here we know
the gas cloud server is running we need
to create the subscription server and
just because here I'm going to get es
links they do not use we're positive L
I'm going to do eb l for me so es in
disabled line is because I don't want my
ears can still get ear okay I'm going to
put the schema so this is the same
schema coming from here I need after
that execute coming from here and I need
after that the subscribe for a new here
we create an elite the the subscription
server that right here inside the curly
bracket we can pass other argument and a
we need the server so which server we
want that and that's going to be grass
to the server and with tack content that
subscription path so now we say a use
the server and when you do subscription
due to this pad so now just for make
sure we are all done and then check the
server perfect it's already running
perfect so now we did one thing for we
did one of the thing we need so we just
set up like like right now
we can use web socket with the server
first thing after that it's we're going
to need to create the subscription so
for that we're going to run on the
schema like
to all your other subject orientation
we're going to create another type
called sub script shell and now here is
the page what we're going to add the
subscription in now here we can add
subscription and I'm going to say
description so all we going to manage
that so oh I I do with my suggestion
that they may give them it the name it's
always like the volume doll of what that
do so here I'm going to take we added
when a twit is add that's it and what we
return the tweet so this subscription
when you are going to finally subscribe
to this subscription you're going to see
when you subscribe to tweet ad you're
going to be seen a tweet we're going to
receive the full type of the tweet so
all this thing
perfect so we did one other thing we we
are almost done on the server you're
going to see it's pretty simple so now
what we need to do is we need to go
after that inside the config and we're
going to create a pub sub variable so
pineda is going to be the configuration
for the pub sub so the pub sub is like
the name curl it's a publish and
subscribe so for doing that we're going
to need to enter another package that's
going to be draft UL subscription so
this is what I guess we're going to do
so finally we have to L going to
subscribe to something and get a listen
to this even so here we can import from
SQL subscription we can import table so
and ear the only thing we need to do is
export the current pub sub in lower case
new pub so so I do this but don't need
to recreate this instance every time I'm
going to just use my instance ask ye now
I can join up the tweet resolve our and
I'm going to go at the top in this is
the place where I'm going to import my
pub sub I just import create so that's
coming from the config and pub sub and
I'm going to import my pops up in lower
case so now here we get the point where
we need to start to manage the pub sub
so pops up all pops at work is we need
finally to add that's the resolver ear
and we need to tell the pub so out of
your network so you're going to see here
so I'm going to take tweet and so the
same name as a before but this one's
going to be just a like an object like
that and what I'm going to do is you say
subscribe
I'm going to hear an arrow function and
now I'm going to call my pops up the is
sing in theory sorry and if you see that
here's the trigger of that is going to
be a string or an area of string so you
need ear our string so here I can click
tweet ad like this but because I'm going
to reuse it and other place I'm going to
create just a variable for that I'm
going to say current tweet an equal and
I like to keep it as the the same name
as my other concept so as the name here
I'm going to say now take this variable
like that twist app so sweet
this is what the pub's all good I do but
now you may be happy yes but that don't
make sense I mean all can you sign I
mean nothing happen here
yes that's true we need to create that
and all we get out of this is there
inside a tweet tweet because this is the
place what we're going to do the
function remember we create a suite and
we want to populate that to the
subscriber who have subscribed to this
tweet ad so what I'm going to do here is
I'm going to create a current tweet
equal oh wait create a tweet creat like
that so I'm going to ask my tweet
variable winning screen needs to be
created because remember it is the
premise here and now what I'm going to
do is I'm going to take pops up that
publish and I'm going to take tweet add
so the same name so pub publish this is
all that work
to your name in the pelo
that's it so I'm going to take tweet ad
and the payload this is all you need to
do that is to tweet app and it's going
to be the tweet so maybe that you get
confused air but thing adult like I just
read even so if you have a work which
work second before that's going to maybe
surely more make sense but this is like
we have an even color the tweet ad and
we just pass them payload on this event
so when the client is subscribed to this
even D we see this payload and now here
don't forget to return this week that's
it so now we're going to check the
storage graph and the server is not
cache and that's it no no okay some
decid I just for your one thing here
inside the resolve our index
we're just forget one little thing here
at the bottom we need to add sub script
trim and we're going to say tweet and
and tweet resolve our tweet app that's
now that's it for the server the server
is done I'm going to close this I'm
going to just make it smaller and I'm
going to take the client
I'm going to make it the No
now I'm inside a client just I'm going
to think so you see so this is the
client
don't ask then I think I need to just
set up the everything about the desk
runnin so we're going to do this all in
the store so this is what we're going to
start it the front end we have a bit
more stuff to do but I for me that
mcmarson so first thing we need in the
front end is the same subscription
transport WS for a WebSocket why we need
that I'm going to just wait finish
because we need the client are you going
to see I'm going to import from
subscription transport I'm going to sit
here subscription client and I need add
add the graph eight one I don't know to
complete graph QL subscription like that
that is to make sure
I think as yes you will subscription
yeah so now this is what we're going to
need to do first thing we need to create
a client for the WebSocket so we're
going to create a variable called WS
client
so for web socket player equal a new
subscription km okay I maybe know why
it's my final in my result your code
don't have any more
the dispute funny
sometimes I reacted my job yohko don't
have any model to complete and I know
because I don't know why but you get
just I'll get your subscription so now
I'm going to kill Mike I am the US clay
and I'm going to say it's a new
subscription Khayyam and not like that
take a string first so we're going to WS
local Oh
3,000 so the for the back end and we're
going to see subscription here I can put
that inside a variable but just because
it's a tutorial I want to go faster yeah
I'm going to say reconnect to be true so
if something happen I want you to be to
reconnect by himself and after I'm going
to say connection program I'm going to
say anything for now so now the thing
gonna work because now I'm gonna need to
create my network interface so you can
see because right now I'm using this
network interface but I need to manage
that with the with the subscription so
for doing that what I'm what I'm gonna
do is I'm going to need to go to my here
yeah yeah right there
I'm going to take my car I'm going to
create a network interface on this work
interface with subs so with subscription
and I'm going to add grass ql
subscription who take to like take the
cayenne finale and I'm going to say
network interface the one we have before
and just take the ws client and now I'm
going to submit own interface equal to
the network interface with some
you
what I'm going to do
I'm going to just restart this Expo
don't know what happening
okay we know why now that was not take
food that was ear so yeah you see in the
back end
sorry about that if I go to my servers
I'm going to click right here
I'm going to need to open the server so
I'm going to go there
make a typo
the goal is sub description that's why
my seller was crashing
you see and now if i refresh this thing
always look at your terminal you said I
didn't do happen how I see why I do well
like that and I put my photon expo sorry
Expo that wasn't new sorry about that
so we set up the subscription but now we
need to make it work so for the first we
need to create a subscription so yeah
when I told you that is because I get
subscription become like this
become now a kite so we can creat that
all you see subscription tweet AB and we
can I tweet so now I'm going to create a
fold our house subscription inside my
graph here and I'm going to create one
called tweet ad yeah so here we're going
to create what we want to receive when
we do such a subscription so that's
going to be pretty simple it's going to
be like like we did with other Kure
and I just think it's going to just look
really lot like the other Carrizo gql
from react Apolo or creating the cheek
will get my tea right there I'm going to
say subscription book for another time
it's subscription like it's like the
mutation that you can embed a mutation
or with a critter tweet with a mutation
now it's subscription like that I'm
going to say tweet and I want to
subscribe subscribe to tweet app and I
want text to come back an ID
I'm going to say create it up because I
want the date for showing here I'm going
to say five or it can use our put the
username I want the other tour - I want
the first name and now on the last name
this is what I need like a penny read
what I seen my screen so it's almost
like what we got in the gate widow or
should I be able to just copy that and
you see like it and paste all that ear
so now we did that so now time to jump
on the real codes we're going to add
that to the component and that surely be
the your question oh I'm gonna do this
going to be common chain part then you
think here what we're going to do it we
need first thing to import the
subscription let's eat wheat add
tweet at the scription from the fewer
subscription to it add and I don't going
to face that fear
why because I need to be in my
subscription I need to see my client I
need to say a I want to sub to this when
the component mouth here I'm going to
component will mount I put that before
because it will not become before they
did now and I'm going to say B that
products that data subscribe to more
this is the only thing we go and this is
already building spider that's necessary
because this is doing when you have data
inside your SQL ear the thing is that we
need to pass is going to be the document
which type of thing we want to and we
gonna say tweet and I'm going to occupy
Jack after we're going to sit all we're
going to update the curry
you
oh so long sigh again Visual Studio code
up shut down for me I'm using the
insider version and I think this that's
why
make a typo inside my graph QL
sorry about that I think that was
because I put
you
the earth
like that sorry no need to other
I'm going to go back to on the screen
sorry about my visual studio code I
don't know what you have from the less
updated just king really so now update
Curie all we want to update the stock we
have this thing we can have the previous
objects or what we have before and the
subscription data so this is what we're
going to get a subscription data so this
is an arrow function why I just finally
take the first argument and add a
structuring this thing here after that
here I'm going to say if I have no
subscription data so I also complete is
again died inside the subscription that
I add the data so this is another object
and I'm going to say if I have no
nothing just return the previews if I
have not nothing coming from the
subscription data just stay with the
previous ticker thing app so I'm gonna
see current new tweet equal the
subscription data sorry
data data that data the tweet ad oh if
you see it with ads gonna be the object
will receive coming in from that we see
tweet ad it's coming from here
so now adjusted my new tweet going to be
quote to deduce this thing after now I'm
gonna say so I'm going to check if my
get tweet that's fine I'm going to check
if we find one of the three tall video
app if you have the same ID if you have
the same ID don't put it because I don't
want to have the double time the same
thing so now you see fine found critical
once for each element on average and on
20 find one so why are you signing
because fine stuff after I've seen on
one so if you see one it doesn't go
return me to thing and every tell me one
thing and at the end you're going to
return on the fine if you have nothing
so that's why we can use with the die as
a bang here so I'm gonna see if tweet so
if this tweets at the same ID so if e so
if it's not like that openly do three
that on the soybean so
it's not there what I'm going to do yeah
I want to merge a new object and that's
going to be the previous get tweak but
the previous object and they get tweet
going to be equal going to be equal to
an array of because I wanted at the top
that's why I put it there I'm going to
see the new twist I'm going to spread
all my new objects inside this object or
if you want you can do just do that by
putting the new tweet but I like to just
keep it in table like that and I'm going
to say here como the preview that get
tweet and now after this curly bracket
I'm going to just return preview is
nothing at
so now all receive that words I'm gonna
try this would be a secure first thing I
need to create a new user I'm going to
say a sign up I'm going to email I'm
going to say what I'm going to do is I'm
going to show you a random user that me
so we let Mary know so I'm going to see
if you let Mary know email I'm going to
take this email
oh yeah but unless you are I'm going to
take that as the email I'm going to save
her full name I'm going to be equal to
yell at Moreno
going to avital equal to
a lot or equal to image area
you
after that I'm going to say password
equal to password 1 2 3 and I'm going to
say and when I need more
my password and I need
let's just check out just the number
email full name password at all
usernames I'm gonna say username equal
to
you want detail maybe share nothing or
leave that here
of that and I want to be
like the cocaine when I run back I get a
toolkit perfect
put this pokin in my HTTP
after the mirror let's say now is about
the people now I want to create but I
want you to check air and I'm going to
create a new tree so if you're visiting
words my tweet right after I'm going to
ask click clay you're going to become
ear let's make a shell create tweet with
a tag of hello world with some bang and
I'm going to suggest it on the idea now
I'm going click and you see so Violette
merino just send us a message
that's it that was that I mean for me I
can still write some and write some but
she can type another one
hello my Twitter you see I mean for that
Mme about all Apollo make your life so
much easy in that just crazy so I hope
you enjoyed this it is on my plan for
the next one is going to be the light
pink I want you to be able to light so
we're going to talk about some
relationship and stuff like this and
we're going to see that like with the
earth and the next one after that that's
going to be to make that work with real
time so I want if you've your lap like
my post I want the the pose here to
become one and the light to to better
they like to update in real time so I
hope you enjoy and we get a 12-meter
please subscribe if you didn't and told
me in the comments how you feel about
the citizen sorry if I was bad with my
English this morning I don't know why
but I have a good day bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>