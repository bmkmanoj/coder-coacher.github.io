<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>M02-Part1:  Create Facebook module for Oauth | Coder Coacher - Coaching Coders</title><meta content="M02-Part1:  Create Facebook module for Oauth - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>M02-Part1:  Create Facebook module for Oauth</b></h2><h5 class="post__date">2018-01-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pWnaW1Se-m0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone welcome to the point
number one for this second milestone so
the plan of the day it's to create the
icon context like I told you in the
intro where we're going to put
everything about the user so we can add
all the business logic about icons then
edit together inside the Phoenix
application and after that we get a star
to set up the Facebook Facebook
application logging for your server so
why not start right now so the thing we
going to do first
it's we gonna jump on the code
and what are we going to do it's right
there
smaller I'm going to close this one and
now what we're gonna do is its first
thing when I run a context generator
like we did with the pose so if you
remember what we did in the the post we
did that Jen can't expose blah blah blah
we suppose photo photo image romantic
action so we're gonna do almost the same
but now we're gonna do this with icons
so we're gonna say account now we're
gonna say user we're going to create
inside the icon a schema called user
we're gonna say the same air in pluriel
we're gonna say we're gonna add a user
name as a string and gonna be unique
that unique sorry don't know why I
create that here well I'm glad not at
our string I'm gonna also add is
Facebook ID as strength and so era a
first thing before we go for it are the
Facebook ID is gonna be a way for us to
to save the ID of the user from Facebook
so the ID of Facebook for this user
you're gonna see why in a moment and
after that we're gonna also add an email
as a string and now this one's gonna be
unique just make sure user name avatar
Facebook ID email we can also add if you
want we can also add first name as a
string and also we can add first last
name as a string like that so after that
we're gonna run this comment
that gonna create for us some good and
on fire so why not see what they create
for us first thing they create here
inside the private folder one sec I'm
gonna just make it bigger for you we
create inside a private inside a repo
inside a migration they create a second
migration where we create a table a user
so this is everything we have see we say
we're gonna need a username avatar
Facebook ID email first name last name
and we see all the type string symmetry
and we create a table inside the pass
equal we create also a unique ID with
unique index with the email and it could
be good but also what we going to do is
we're going to create a unique index
user so here you put your table name
czar and we're gonna say we want at the
facebook ID why it's so because I mean
the Facebook ID is gonna be unique for
sure it's it's an ID so so we're gonna
make use cues here after that we create
for us inside the lab between inside the
inside the Instagram fuller there create
the icon context like we do with the
post and now we have the user with the
schema and I'm gonna just I'm gonna just
say here what is this schema so I have
almost the thing to say here it just
finally a schema where it's billed for
the generator and you see this is one
thing I really like about using to like
that it's the the bill for us like a lot
of code is already done for us yes okay
using generator is not the best thing
always but it is really good when you
are in the learning process and also it
can be a really good place to make the
app starting so you can call your
business logic right away so here as you
can see we have the schema this is
almost the same thing as here but now is
this chemical you can make use and now
you're inside the chain is set we have
the cast so this is what the user can
enter inside the we need a create a user
but here the validate require I don't
want to have the username as a require
when you create you'll I come I'm going
to see why in a moment
and now inside the unique constraint I
think we're gonna do the same as that
here but we're gonna say Facebook ID
like that are you gonna have a unique
constraint in the email in the Facebook
ID so here it's for October right there
and after that they asked right here
instead I come every route like kind of
a crud crud function right here we can
get a list of user single user Twitter
user
update a user delete that a lot so I'm
gonna just remove all the dots I like
that but for this tutorial I think will
be better if we don't have that going to
be easier for us to just see this
perfect hello we have the lease use our
and the use our and this is what they
create and they also they have create
for us inside that test almost the same
thing the icon we have that contest here
were we they have already filled a lot
of tests for us so if we really what
they say they say after that run mix egg
to migrants we're gonna run that mixed
egg to my grade so that gonna create
inside Postgres inside the progress that
gonna create a new table called user
where we have ID username avatar
facebook like in everything and here
inside the structure you can see we have
some constrain like like like there the
index you get the user email and their
user Facebook ID constraint the index so
that's it so that is this for creating
an icon context so now why not add the
Facebook wrapper and make it work so the
way that's gonna work its first thing
we're gonna add this library so Facebook
this version is 0.17 right there inside
the mix so we're gonna open mixed yet
again we remember if you came from the
GS mix e^x e x s it's like your package
JSON we're gonna put a comma here don't
forget put Facebook definitely the
diversion we're gonna after that round
mix Depp get forgetting you dependency
after that like I always told you when I
get dependency I like to combine my
project so this way I'm gonna get all
the autocomplete of the Facebook library
right there is book modular me
perfect so we have at Facebook so now
all we're going to go it's first thing
we're gonna need for the Facebook like
here this you need first thing to
register an application on developer
Facebook and after that get an access
token from this place and after that we
can do a cowl with a with Facebook so
this is what we're going to do I'm going
to open a developer Facebook go
I'm going to click on my app I'm gonna
click on add a new app I'm going to call
this one Instagram clone I'm going to
three I'm going to click on treat app ID
so here I'm gonna just type the text we
seized okay good and now we create the
product right there so here we have in
sacrum is in Stockholm so you see why I
say it's a clone it just Instagram and
nothing second Facebook don't want to
add the word Graham so it's tech loan no
it's like they say you open the Facebook
access to can to right there and now you
can open inside my app right there
inside clone and now you we're gonna
just put your need to grant permission
so we're going to click on that to clean
permission I'm gonna say continue and
I'm gonna have I user token right there
so now I can use this token to do that
test like this see right there so what
I'm going to do is I'm going to go
inside item and I'm gonna run IX s mix
to open IX inside my Phoenix project and
I'm gonna say Facebook now you say kiddo
to complete when I click tab and now I
can do something they're gonna si
example I'm kin sick me and I can get my
first name so I'm gonna save me I'm
gonna say here I need like ear a string
first name so I'm gonna say first name
you know a I need to pass the access
token so I'm gonna just paste this tool
can right there not here but here so
here then it takes this tool can and now
I can page this book here right there
inside print SC and side code and now if
I click and turn you see this is the
respond I get with from Facebook I get a
two polio right there where I get here
like a map where I get my first name I'm
any well with the idea of my EULA either
you see was between odd pin pole sorry
for that ID now you may be asked why we
did on stuff area juice because you need
to get that forget the access to here
talking to for sure you can have done
that with other project you have but
we're gonna need that this app ID we'd
be getting a tip so trust me we're gonna
need that so are we gonna work with this
stuff its first thing air it's pretty
nice okay we know that's gonna work yes
perfect but the user don't gonna go in
the inside the terminal so we need to do
like a services for us so are we gonna
manage that
it's I'm gonna create inside my
Instagram where I'm going to create
another folder called Oh like that but
I'm going to create another file called
Facebook that e^x inside this so out and
now either that's gonna be my wrapper
for me I'll run the wrapper of the
Facebook library this use our eighth
grade right there so now here I'm gonna
create a module called Instagram web
that Oh out the Facebook so if you
follow all that go it's Instagram we're
all in that Facebook and now after that
ear what I'm gonna do it's I'm gonna sit
here at the top I'm going to create
right there think about that like a not
like a constant but a variable right
there where I can put like an ID email
first name
and last thing if you ask okay why I do
this the sweet because if I taste that
inside my terminal right there
and I do the same come in like I show
you so feel about that me and I paste
this one here and I'd the inside coat
now look what's gonna happen I'm gonna
get my first name my ID and my last name
right there off my user so everything
I've asked him see so finally here you
ask whatever you need and why I create
that here at the top it just because if
you want to add something you can just
add this here so here now I'm gonna work
its first thing I'm gonna create a
function called get input we're this
one's gonna receive the token of the
user so this get info another toucan and
now this Tokyo we're going to pass that
this with this pipe operator writer so
if you don't know all the pipe operator
work its its primary give whatever you
had here as a result gonna get that as
the first argument of the second
function so I'm gonna create function
here called get user and I'm gonna
create that right here so get user we're
gonna receive a token
so the tokens gonna be this one who came
here and get here you can call that like
that but for me I like to put that here
if I have no argument and now here what
I'm gonna do is I'm gonna have this okay
and use a user who's going to be finally
the result of this thing you see okay
and my user is going to be all this map
right there
there's a user equal Facebook the me and
I'm gonna say right there film equal to
fill like that
and now here I'm gonna say token like we
do finally right there here let me put
all that right there
so now when I got that the only thing
I'm gonna return is that user I don't
want to return the tuple for that so
it's gonna be just easier for working
with this pipe function you gonna see in
a moment so now if I save that I'm gonna
run I can run this command and see if
that gonna work so what I'm gonna do is
I'm gonna run again my e.x mix now I'm
gonna sit inside Graham web
Instagram web the out Facebook
now I can tell my function
get info
now this one the only thing you need is
together together
and now what we're going to receive back
is this news are right there so this is
what we just create we could almost the
same thing is just now you have removed
okay from the user but those who don't
know Alexei Alexis always return the
last line so that's where we do this
this way so here we have the tuple we
almost a structuring this stuff here
what we see here we're going to add the
atom okay and here we're gonna have the
user map and we return the user map but
now the thing it's here I'm gonna create
that as a private because I just want to
add access to the get info project so
now one thing I'm gonna do is I would
like to normalize this user to make it
the way I want my a patient and a my
application to work so as you know right
now the way that work it's like this
sorry I try to go really quick in some
time I just go that Facebook that is
info now I'm going to put back memory
we
you
okay so now you see I get first name
Emmanuel I did level and last name now
one of the thing it's one of the thing
happening right now it's I would like to
receive also my profile my user profile
picture so oh can we do this and ask
everything so if you click here in the
documentation they add food for us
inside API reference be a sweet ear so
Facebook is booked and you're gonna have
everything here you need and one of the
stuff here they're gonna have its dot
picture a picture or a Facebook user so
this is how you can get the picture so
you need to have the idea of the user to
add the size of the image you need and
the access tool can that's a Facebook
the picture so we can create a new
function for that so we can say they're
a church and their pictures are rapid
thing to watch in picture so we're gonna
create a function private wire that's
gonna be get use our profile picture why
this one here I'm gonna receive the user
object I'm gonna also after that receive
side I'm gonna receive a token so this
is the same thing and ear so I hear
there's gonna be the idea so we're gonna
take that the small for the size and the
access token and now this one I'm going
to return another total with some data
in that and what I'm gonna do is I'm
gonna say Facebook picture and I'm gonna
say use are how can I access the ID by
doing like that with bracket notation
let say side and token and what I want
to return like back here
it's gonna be the data so now here what
I'm gonna do is I'm gonna say after this
one now think about this now here after
that you add my user object so now here
what I'm gonna do it's get user profile
picture so now the first argument is
gonna be the users so I need to just
pass two argument and I'm gonna say
small and to Ken if you remember this is
that now add the user here
I just need to pass small in the to Kim
like that so now if I run this come in
again so I'm gonna rerun this convinced
I'm going to just copy paste back my
token
I'm gonna run my again I'm gonna say
Facebook Instagram where the pull out
the Facebook the get info now I put my
my token now you're gonna see what I'm
gonna receive now I receive only that
data and as you can see now I received
my URL so this year this URL right there
if open that with google chrome you're
gonna see my face right away right there
my little phrase like that because I
have asked for small
so now we are like okay so know this
function this is the only thing
returning that's not right
first thing yes okay I wonder URL but I
also want to return the user so oh can I
do this
yeah one of the thing I'm going to do
here I'm gonna add the height then I'm
gonna return ear like a list what I'm
gonna have the user and the data
so now if I rerun this I'm going to just
zoom a bit okay so now this so now I'm
gonna just recompile if you want to know
to recontact that thing you can do is
just put art and put back the only
module you want to become PI so I just
want to become tile back my or out that
Facebook so I'm gonna be compiled back
this one and now you see we defending
module data block I just make a mistake
that I like this so now we have it so
now we can we run the code so I'm gonna
just will come in okay just to clean and
I'm gonna run back again my Instagram
where Oh
the Facebook that get info and now
now you see what I got I got like a list
where the first item is the first map of
my user and now is the data so this is
this thing right there so we are pretty
close so you see this function call this
boat function so alright go the token go
inside the user right there are the
first argument you will return the user
and now with the user looking here we
can get this photo a facebook picture
with these IDs okay we did a lot so now
one thing it's now I want to normalize
that to make it as what I want here
because you see I want the image rel to
go inside that also oh can I do this
it's by treating another function and
I'm gonna call that normalize I'm gonna
say you're gonna receive a list of the
user and picture data yeah I'm gonna say
I'm gonna say do you know the only thing
I want to return in some maths I'm gonna
add my Facebook ID who is going to be
equal to this user ID
I want avatar to be equal to we load so
data URL so how we do this by saying
picture data data URL I'm gonna say that
we right now but I'm gonna send all my
lights and I'm gonna put normalize right
right there so now the normal is going
to receive this list right there
so here we receive a list of user and
picture data so now I'm going to
recompile
become tired and now one thing I'm gonna
do also okay yeah like that and I'm
gonna do do a pyro and I'm gonna rerun
that and tar now you see what I got it's
a map right there where the avatar in
the Facebook ID just the URL I need in
the Facebook ID so we can continue like
that what we need also in the DB gonna
be is first name so then we from user
first name and last name from user the
last name I say that we compile
we're on you see I get first name and
last name now the thing also I need is
the email so now if I see email and use
our the email one thing that I have been
it's not yet nil
I get nothing why and I also have asked
you the the email shield but what
happened I mean what happening did the
token they gave you inside the graph
Explorer they don't give you access to
the email but I've tried with another
token I just got and as you can see I
got my email right there so don't worry
about the email when we gonna luck with
the real iOS SDK oh I knew it is the key
we gonna get the email don't worry about
that this is something I didn't know and
I just had this thing so I'm honest with
you I didn't know this problem were
there so at least we get it to work for
us so we get the Facebook I wrap my
normalize so we can get the data from
the user above last so in the next part
we're gonna be able to create a user or
getting a user and also twinning and GWT
for that and returning this GWT inside a
graph key where mutation I hope you
enjoy sorry for this mess up car but I
hope you enjoy and we're gonna talk in
the next one
that's a good night evil bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>