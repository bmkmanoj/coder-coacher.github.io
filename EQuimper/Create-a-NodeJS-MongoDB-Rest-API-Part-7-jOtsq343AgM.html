<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create a NodeJS + MongoDB Rest API [Part: 7] | Coder Coacher - Coaching Coders</title><meta content="Create a NodeJS + MongoDB Rest API [Part: 7] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create a NodeJS + MongoDB Rest API [Part: 7]</b></h2><h5 class="post__date">2017-05-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jOtsq343AgM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guy part 7 time to do more work
with the post so today what we're going
to do is we're going to do get a post by
is ID and don't don't worry you're going
to do other stuff too
because it get by ID it's really easy so
what are we going to do first is so we
can I create a controller in a row we
get add a library called HTTP status I
really like this library it just made
your studies more verbose I mean
sometimes I get a point why I don't
maybe remember all the status and I need
to go find them on the web so this
library just make it easy for you I'm
going to show you what it's populate and
we're going to populate the user of the
post and I'm going to show you the
difference between the method I put on
my user the to address a versus a to
Jason time to jump on the code right now
so don't forget to start your boat
service or the first one it's a web pack
the so going on is your known month
after that jimana other terminal and the
yarn add HTTP status so this is a small
library really small library the only
thing we need to do for this thing is
we're gonna jump on the user controller
we're going to jump at the top shift
coming enter I can create a line at the
top and I'm going to do import HTTP
status from HTTP status now I can just
change my status like this by doing so
that was create so HTTP settlers that
create that's it so it's just much more
easy I think to read yeah I'm going to
change the 502 bf4 on the red so this is
bad request HTTP status that that
request like that you don't need to do
this if you don't want but formula I
love it
so here the 200 200 that is going to be
okay that's it nothing more to do so I'm
going to again import this line because
now I'm going to jump on my controller
of my post I'm going to go at the top
I'm going to import I'm going to copy
page the HTTP status and I'm going to
change to want to be that create and
found you to be dot that request
that's it so now we are ready to go so
we're going to just look if something
break
no we are good to go perfect so now
we're going to create the function the
controller for getting the pose by ID so
we're going to create it right there so
get poster by ID with a request and a
response we're going to have a try-catch
again again we're going to roll a work
with their catch first so I'm going to
just copy paste my line 10 and I'm going
to jump back here copy paste that
perfect here what I'm going to do is
going to be really simple we're going to
do current post so the post we're going
to get we're going to wait for that and
that's going to be posed at find by ID
because find by ID again it's a premises
error I'm going to get the ID by doing
react that parent that ID why do these
patterns come inning you let's see in 26
here I'm going to do returns that rare
that status HTTP status that okay yeah I
think that's a good number for the mg
son we're going to send the post that's
it I'm going to go to polls that route
I'm going to do route that yep and now
this is where my parents came when you
add this column right there
now ID become as a parent so this column
here is to parent object you're going to
see why in one moment but I'm going to
put color on here and I'm going to do
post controller that get posed by IB get
posed by eye that's it now I can tell my
post so what I'm going to do forget my
ID I'm going to jump to my collection
post I'm going to just close every other
thing like that so this is my post and
open them I'm going to open my both ear
and I'm going to do click write copy
value I'm going to after that that
German postman and I paste the value
right there in time I get I'm going to
face that I'm going to remove the thing
it's not the IDS of the object ID and
the code etc and now I can send that and
now this is what I got I got everything
now as you can see we get everything
this is not what we want so that's why
we're going to jump back in the code and
we're going to make use of the to Jason
method as you we made inside the user so
inside the post model I'm going to go to
the metal right there and I'm going to
create here the to JSON method here
that's going to be really simple
okay let's finally just return a new
object and we're going to need air we
need to ask what we need because air if
we see we get the ID I want that I don't
want to update that I don't need that
I'm going to need a Creed app because I
want to show in the front end when this
poll has been created I want the slug
because I'm going to use it in the front
end I need the title because I mean is
the title I'm going to the text and then
I'm going to need the user you're going
to see why in one moment and I want a
favorite turns out so finally I just
want to remove this version in the up
data so if we go back I'm going to go
right there and I'm going to do there
that ID because it's the ID I'm gonna
need the title so there's that title I
want the text there's that text I want
to create up is the tree at I want the
slug there's that slow I want the user
this is the user and I want the favorite

this is at some risk oh that's it so I'm
gonna do it go to postman and then again
boom
ID title text critter slow user favorite
code that's this is what we want perfect
the to JSON is working now you know a
new sequel database it's not made for
make relationship easy like a sequel
database but what I really like about
MongoDB and Mongoose with that if they
add a really easy way to I mean easy
with all new sequel database to add some
kind of relationship and that become air
with the user in the schema type object
ID so if we seen the post
and we have the user but I'm maybe going
to want to have the user name in the
front end because I want to show like
maybe it's like example equal per app
create these blog posts you don't gonna
say use our five nine one action ever
asked read that so time to jump on this
or pseudocode and what we going to do is
we're gonna jump on the controller post
that controller and air in find my ID
I'm going to add that populate print SC
and I'm going to put user where I come
to use our it came right here so if I
change that to be maybe otar that's
going to I'm gonna need to do over here
so now if I come back to postman and I
sin again look what's gonna happen hmm
that's work this is what we want look at
the idea of the user the user name in
the token but what happening here I mean
why do I get a token I don't want to get
a token that would be a really crazy
i I mean I can do whatever I want after
that with the user token in front end so
here what happened if this is what I
really like about a monk goes if the two
three son work also when you populate so
if you remember in the user user that
model the when we do to Jason right
there we return the ID username in token
so this is what happened right there ID
username in token so now how can I make
it work so a double tip for you what
we're going to do is I'm going to create
another function here to out Jason like
that I'm going to copy paste this line
because I want that to make two out
Jason and I'm gonna replace the two
joint on the return user name ID so now
I'm gonna save I'm going to go to
postman and now I'm gonna sell boom this
is what we want
I get the user which is ID is username
perfect this is what I want in the front
end but now if I go in load use all
again I'm going to learn hmm now I get
ID and username this is
that what we want if we won the tool can
so that's why I create a method to
audition just copy paste this link item
and make sure you don't make some typos
go inside the user controller and now
the only thing we need to do if you
place a where we do the sign up in the
login I'm going to add right there so
yeah I'm going to click here and I'm
going to click on my for magnet option
so you can windows that thing is control
I can click here so I can do both in
same time so I'm going to just add dot
I'm going to paste with control V or
command V and put fantastic so now if I
say when I go back to postman now I can
send for my login now I get my token
back because now I call the to audition
and now if I go back to my get by ID
everything still working you see all
this method make your life so much easy
and now this is what I really like about
that because if we made a populate
without the to JSON as I show you you're
going to need to select which field you
want on every kind of populate now with
this method all you nest and populate
stuff whatever you want you never gonna
send the password the user in nothing so
the two jason method of the user ear
just remove you so much code and just
dry up your code yes okay i understand
this is what i tend to in the post model
we need to again code this stuff but the
thing is think about how much pain that
removed for you after that because after
that if i want to remove the create app
from everywhere where i get the post I
just believe at this place yes I do this
six line of code here seven but that
going to change your way of cutting
trust me on that so I hope you enjoyed
this it is done let me know all that
going to comment let me know if you like
these tips I mean at the to Jason and
the two out Jason and if you learn a
deal with the pipeline next one we're
going to drum on the get out and I'm
going to show you a way to do a get out
with the list and the curing to make you
much more easy to war with some kind of
pagination or something like that so I
hope you enjoyed click the like button
please if you think that was a good one
and we talk later have a good day bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>