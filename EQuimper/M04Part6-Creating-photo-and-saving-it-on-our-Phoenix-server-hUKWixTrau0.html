<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>M04-Part6: Creating photo and saving it on our Phoenix server | Coder Coacher - Coaching Coders</title><meta content="M04-Part6: Creating photo and saving it on our Phoenix server - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/EQuimper/">EQuimper</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>M04-Part6: Creating photo and saving it on our Phoenix server</b></h2><h5 class="post__date">2018-02-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hUKWixTrau0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello guys welcome to this lies last
part for this my so number four so what
we done in the last one was inside the
caption screen what we've done is the
fact that now you can click on a photo
and click share and we get back the
image upload already on Amazon s3 and we
can see this image if I go right there
and I do this I'm gonna see my image
right there okay so this is what we've
done in the last one but now it if i
refresh uh i don't have this photo and
also i mean i mean right now it's really
not what we want so yeah so this is what
we want so i mean this is what we need
to do now it's to add a mutation where
we're going to finally create the photo
so we're going to add a mutation inside
the mutation folder we're going to add a
new one called create photo mutation
that yes we're gonna just go inside like
photo just taking this basic graph QL
tag okay and inside this one what we're
gonna do
it's we gonna replace this photo ID to
be caption there's going to be a type of
string and we're gonna have image URL
type of string also if you don't know
what i mean it's like this great photo
function where you have right there okay
the caption in the image URL that's it
now here we can call that create photo
and now for that we're gonna have the
caption equal to the caption we have at
the top the variable we'll just create
that Cashen but caption and image URL
yeah image URL is going to be equal to
image URL and now what we're gonna
return now it's we're gonna import from
the feed pay screen is frank man okay
because we want to push back that to the
feed screen when we update so we're
gonna feed photo fragment and now right
now we can say a feeds photo who came
finally from this value right there
fits photo okay so now I'm gonna import
this mutation so I'm going to create
photo mutation from and I think I forget
to do one thing yeah doing this and also
like I show you I think what we can do
now is you can export default value like
this okay so like that from like export
default as like this and now I'm gonna
the same for the create photo so that's
gonna be create photo mutation and as
create photo mutation like that okay so
now that's gonna put as an object from
the default make a mistake you made URL
ticket dollar sign here because we
create a variable okay so we create a
mutation so we're gonna get that from
the graph QL server I think and now if
you open create curly braket give
conditions okay
and now if I do create photo mutation
like that added okay
so now what I'm gonna do is also I'm
gonna import from react upon the graph
QL hoc I order component and I'm gonna
wrap my wit Apollo with my caption speed
with that and now inside that I'm gonna
put the create photo mutation okay this
one now yeah we're gonna do like I like
to do is we're gonna use we're gonna
create a props in this props remember
take a receive mutate inside an object
and inside that now you can create your
own function on create photo okay and
this function is going to be the one
we're gonna call right there so that's
going to be ear we are we're gonna
create the on on photo okay so this
function here the way you were its we're
gonna get some variables so it's gonna
be an object and you're gonna see why I
call that variable like that it's
because this thing take variables and
because I don't want to give are you the
same it's gonna be 0 so now we're gonna
have the update function for updating
the
screen after it's done updating the some
of the hurry we have the cash we have
already okay and the one we have right
now here it's we have the started data
the create photo so the create photo is
what we get back from the mutation and
now what we can do it's we're gonna need
to have the career I create why are we
gonna get the follow the same career
finally we need to get from the feed
screen so this one here I'm gonna show
you another way later but for now we're
gonna use this one in the next milestone
we're gonna do some kind of refactor
also because this thing now you can use
make use of the connection and this is
what we're gonna do so what I'm gonna do
now
here it's I'm gonna import this feed the
fragment from my screen feed screen
Frank man okay and now this get photo is
going to be the query I'm gonna add ear
so you can do store that read query and
inside that you can redecorate get
follow and now this career I'm going to
add an object of photo and that's gonna
be the photo photos all the photo you
have ear okay so what do you can do here
is you can write data to this store
passing the century and now what you can
do it sync data now it's going to be
equal to photo so the photos cache we
have here and now because I want that to
be at the top because it's a new image I
can do this like that I'm gonna open
this photo first in front of the other
one and now I can call this on create
photo right there so this one's gonna be
again a promises and you have this
function like that
asynchronous and now this one can
receive the variable we need so the
variable we need its caption and image
URL so for this one we have image URL
equal to finally the result from s3 dot
remote URL and the caption is going to
be equal
to this that state that caption okay so
now if I run this code and we check with
the server so if we see some green that
mean it's good so I'm gonna approve a
new photon when I say arrow well I'm
gonna share so you see the mutation is
done and now we get that boom okay we
get it to save if you don't trust me oh
we have some problem here it's not in
the good order we're gonna change that
so if we go to the bottom we see the new
photo we'll just create it overall and
it was created six hour ago I think we
didn't change the time but you see the
image refers to right there now we have
some kind of problem it's when I finish
to create the image when I click Share
here I was supposed to air I've ear
alluding so I'm gonna shoot loading here
to be false by default and I'm gonna
import activity indicator from react
native and what I'm gonna do with that
it's I'm gonna stiffen it when I click
here I said this this that set state
loading to be true and finally when this
one is done we say this I said state
loading to be false so now we're gonna
have that but now what I would like it's
to have deluding showing here so if this
that's eluding we want to return a view
with the activity indicator inside that
with a size of large we don't want a
small one and now I need a style I'm
gonna create a new property called
loading wrapper and this one's gonna
have the same value of this one but not
this one but almost so we're gonna do
this and change that to be one so now
here if we upload a new image you see we
get this loading spinner right that in
the middle you're gonna stop when is
going to be finished okay but now I
would like to close my windows close my
model here okay so oh can we do this
it's gonna be pretty simple so what do
we do
it's we're gonna reset finally
we're gonna reset finally the the
navigator are what you can do also with
Wix it's too close if you model because
remember this thing it's a model so you
can close the model ok so what we can do
I think is going to be easier to do this
way it's this that prop the Navigator
that this miss model and now you can
show choose the animation type and I'm
gonna choose the slide down like that so
now if we do this we're gonna upload
this image this is now some image and
now look what's gonna happen and now is
there just take it let him the time to
to fetch from the s3 bucket right there
so you see now this is an awesome image
and if we scroll down I think we're
gonna see the other one right there so
now we have some kind of problem in the
server so we'll go there so I will go
inside my server my night think if we go
inside post photo and post here we have
here the list of photo here okay and the
list of photo right now are not in order
like they go from the the you say that
like that
the first one who has created is at the
top and the other one came always at the
bottom so they go in order of the date
but not the order we want we want to get
that I owe you said I think is this and
then yeah
so this is what we're gonna we're gonna
finally change so the world will do this
for now I think it's gonna be easier to
just run my career like that because
we're gonna make use of offset and limit
in the future we're gonna have some
offset animate here because we're gonna
do some kind of pagination so for now
we're gonna create that like that so
frumpy in photo what we want it's we
want to order by a send them with the
value of inserted at app so we want that
from the time stand here while we create
inserted app and now you can say we pull
that all and you pass your query like
this okay so now if i refresh again
Essendon
insert did I miss something thinking oh
I see this and then this and then one
sec Essendon I sent SCS and I think now
would be this and then like that maybe
you check that's gonna crash so what
we're gonna do is we're gonna check so
elixir you can check search for ecto so
ecto the other really good one so we can
say order by order by and we add s and
then and that was descendant
sorry like that and now we should be
good yeah so this is the beauty of life
cutting so now we get from the top like
that so you see the latest image at the
top and old one at the bottom and now
also you can like all the follow you on
also you can like the one you are
actually wrap so that's it for the
milestone
what we can do for the next one will be
to talk about maybe the connection doing
some kind of pagination also because now
we start to have a lot in the first
query and also one of the thing we want
now it's to maybe create a profile page
and add comment to follow so what I
think would be nice for the next one
would be to add a comment to a photo
okay so I hope you enjoyed this
milestone let me know in the comments
sorry for this mistake him and I was
thinking that was like that but yeah so
I hope you enjoyed the series yeah right
now
and the codes gonna be on github so
we're gonna talk in the next one in the
next milestone we're gonna surely start
tomorrow
so either goodnight everyone bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>