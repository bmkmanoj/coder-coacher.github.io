<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>WebRTC Data Channels | Coder Coacher - Coaching Coders</title><meta content="WebRTC Data Channels - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>WebRTC Data Channels</b></h2><h5 class="post__date">2013-10-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/a321oZlrYmo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">how's everyone doing good good brains
hurt yet ready to learn some more
information so I'm dendritic i'm a
developer evangelist at pom dub and i
just like Steven I'm also here to change
the world but I'm also here to help you
guys learn how to change the world and
so you know we're really interested in
real-time communications we're real-time
communications company and so I want to
talk about the data channel and just
kind of my findings definitely over the
past you know six to nine months about
what we've been doing with the data
channel and what we've discovered so far
on the capabilities and you know how we
like it so one of the first things that
I always talk to people and our
customers and different people a pub
know about is you know what the heck is
real time I say real time you guys say
real time what does that mean you know
is Facebook real time is Twitter real
time you know is google now real time
you know what what is real time mean to
people and the best analogy i have for
this is right right when Google Earth
came out a bunch people downloaded it is
you know hot topic for everyone and the
first thing that everyone did was they
found their address and they zoomed all
the way down and found you know your
house and you probably noticed pay maybe
my car's not in the driveway I should
probably call the cops I think someone
probably stolen you know it turns out
you know why aren't these live pictures
of the earth and that's the number one
you know question on the FAQ is why
aren't these live pictures and there's a
whole page explaining on why we can't
pull down live images from a satellite
you know over a thousand miles away but
that's the crazy thing is google earth
isn't real time you know there's doesn't
say live Gore if it's not called
real-time google earth people just
downloaded it and they figured hey it's
this should be real time so you know
there's something real fun
int'l about real-time real-time data
real-time video it's it's the way I
interact with the world today I'm
playing a game I'm talking to people
everything is real time so you know it's
really fundamental to our users and that
carries over into the digital world as
well the next question I usually ask
people is how long is real time for your
users we get tons of different answers
to this question and my favorite answer
is group of Stanford people did a study
on what real time means you know what is
how do we perceive the world in real
time and so what they did was they took
a group of people and they said a
sentence that didn't make sense like all
dogs are instruments obviously not many
people say that every day so they
measured the time it took for the brain
to actually figure out when the negative
reaction to that sentence was it turns
out that the time to do that was about
300 milliseconds so you are now
perceiving the world 300 milliseconds
lag latency from everything that's
actually happening not to freak anyone
out but you know this is really
fundamental to us at prime knob and this
is really fundamental to real-time
communication we think that real-time
data especially is in the matter in the
magnitude of milliseconds not seconds
not minutes you know not ours when your
users get data they should we should
strive to get it there as fast as
possible so this is the great thing
about the data channel is that it's a
high performance low latency connection
to other browsers this is one of the
ways that we can start pushing the
boundaries to how fast your users can
get that data and this is pretty much it
I worked really hard on that animation
so I'm really proud of it i sat with
css3 properties for like two hours
trying to figure this out so this is
pretty much it you have two browsers
they have a peer connection to each
other and the little box represents a
data packet the data can be anything it
can be you know a Twitter handle my
latest tweet my facebook picture
anything and you're just sending that
directly across the web to another
browser no there's no middle server
there's
you know no routing that has to go
through other than just the internet
that we know today and this gives us a
bunch of capabilities so currently it
supports array buffers blobs and strings
ray buffers and blobs are kind of the
new binary types that are coming around
in JavaScript so if you've played with
like the file system API s you'll
probably recognize those for storing
different types of data that aren't just
strings and then they support strings
which hopefully everyone has had a
chance to take a look at it also works
in two modes so I can send data in a
reliable mode and what this means that
they're kind of synonymous with TCP and
UDP reliable mode will make sure your
packets are guaranteed in the correct
order and there's no packet loss so it
sends confirmations confirmation headers
for you to the packets which is a lot
like how TCP works today and this is a
lot like how WebSockets work how HTTP
works you know how your usual browser
technology works today the other mode
I'm really excited about is the
unreliable mode so this is no guarantees
that's completely you know every through
every caution to the wind and just send
data as fast as possible and this is a
lot like UDP this is you know technology
it's been around for years but we're
just starting to see this you know come
into the browser in really great ways
and so this is the same stuff that your
games are using today it's just sending
data as fast as possible without the
extra overhead and the and the time
taking to actually confirm that those
packets got there in the right order or
time so who wants to see an amazing demo
for for WebRTC data channel a few people
out there all right so it turns out that
data actually isn't that amazing but
i'll try my best here so what i'm doing
here is like when i click connect is
making a peer connection to itself so
this is my browser it's going out and
making a peer connection to itself that
connection can be another browser but
for simplicity sake i just made it kind
of loop around and when i click send
it's actually going to take the the data
channel and just send that across the
peer connection so this is taking that
string hello sending it out through the
data channel and it's getting
transported across your peer connection
directly to your other browser which in
this case is itself but you can see the
latency is pretty quick they're
obviously going from my computer my
computer is pretty fast but you'll see
this with other computers to you know
this is this is probably one of the
fastest connections you can get it's
going directly for me to be and and that
can be anything so it can be you know an
array buffer or a blob it can also be
JSON data too so let's see if I can type
JSON correctly so there you go and it's
coming across the data channel and it's
actually getting spit out on the other
side as an object and it turns out the
code is really really simple so if
you've used WebSockets before most of
this will probably look familiar and
that's done on purpose so they're trying
to make this really simple really
familiar just like everything else
you've been using the difference is that
in your first step you actually set up
that peer connection so this is the part
where you transfer stps between few
peers you actually have them connect
with each other and do the handshakes
and everything once you have that though
it's actually pretty simple you call
create data channel and you pass in a
label this is really just to kind of
distinguish different data channels from
other ones so if you create multiple
data channels on a peer connection
they'll each have a different label and
then you'll pass in your options bracket
and this is where you can figure that
reliable property so if you pass in true
you'll get that TCP like experience if
you pass in false you'll get that that
low latency UDP like experience there's
a few events that come off the data
channel there's like a non open and on
clothes that you'll get when it's
actually connects and disconnects you
also get a non error if there's any
problems and then on message is really
where you're getting the data from the
other client so that function will get
called event data will contain your
string or your array buffer your blob
anything that you sent over that channel
in the other client and then to send
something you just called data channel
that send and that's where you pass in
your object quick question you're a JSON
example
there was there some magic in the send
or did you actually have intelligence on
the other side to interpret that is
jason from what i remember i wrote that
example a while ago but from what i
remember i think i just i'm actually
using json de parse and all the messages
that come over so if it is JSON it
actually turns it into an object it
tries to do a best guess so it's not
that you're right right there's a little
bit of magic in that it tries to take a
guess I don't believe actually decodes
JSON for you but you'll have to do that
on the other side so now the question on
everyone's minds is it ready yet can I
use this in production can I go home and
start coding today the great thing is
that chrome and firefox the answer is
yes it actually works in android and
desktops for chrome and firefox and this
is this is really cool you know my
android phone can now talk to my desktop
can send data back and forth the bad
part is that there's no interoperability
but I put yet there because the chrome
is actually working on getting the
interoperability solved between chrome
and firefox and i think it's been
confirmed as kind of coming down the
pipe in beta right now should be here
probably within the next month so those
two browsers will be able to talk to
each other in android and desktops the
bad part is that i ii and Safari are
kind of left out the whole Safari
problems with web kid and iOS still kind
of unknown I internet explorer is also
kind of an unknown so you'll have to
kind of figure out you know when that's
going to happen still kind of unsure
opera actually opera for developers is
where everything the data channel is
working still kind of working its way
into production right now so so pretty
much ready with a little bit of caveats
kind of have to you know pick and choose
where your users lie to see which is the
best route to go the other big thing I
want to talk about security so as we've
seen before everything is mandatory
secure so uses DTLS for data security so
everything is encrypted and to end the
one thing I will say is that the focus
on these things is really
moments so if you're sending god forbid
social security numbers credit card
information peer-to-peer may not work
out for you but if you are trying to do
that stuff i would say use some sort of
encryption algorithm on top of that
you're not getting you know
military-grade security on top of your
data channels the biggest threat to your
applications when using the data channel
and I think as everyone's seen with
peer-to-peer sharing applications reason
why virus scanners probably have made so
much money the biggest threat is other
users sending malicious data so if you
have two peers talking to each other one
of those could use those for for
malicious purposes who knew there's also
a lot of other considerations one of the
big questions that people talk about the
data channel is oh my browser's can send
data to each other obviously I don't
need servers anymore awesome so long i'm
just going to write JavaScript I would
say that it's actually the flip side of
that so you're probably going to need
more servers in a data Channel
application you're going to need
something for presents so how do I know
when you users online or offline how do
i do analytics so the big thing is if
I'm sending a piece of data from one
browser to another there's no that's not
stored anywhere I don't have a record of
that actually happening so if user a
says hey user be sent me a really bad
message you have no data to go back and
figure out if that actually happened so
you're going to have to do some sort of
logging around that also user IDs you
know how to identify who's what user if
I'm using a phone and a browser how to
identify that that's one person and not
to storage as well as a big thing you
know keeping everything in javascript is
probably not the best idea you'll
probably want to database at some point
so you'll need to do storage and have a
server for that multi casting with the
mcs if as we've seen is a whole other
issue to solve on top of that and then
signaling is the big thing so you know
how do i actually connect to users
before I have a peer connection highly
recommend checking out pub nubs take on
that so we do completely serve your less
signaling which is pretty cool stuff
the other thing you'll run into is
there's whole new level of data to kind
of think about here so if I'm sending a
multiplayer game and I'm sending
constantly you know updates I have to be
able to process that on the JavaScript
side as well as rendering things at 60
frames a second as well as you know
running my physics algorithms as well as
on top of them and so on and so forth
and this is actually one of the things
that we ran into is we were building a
file sharing application using the data
channel to kind of see what the
capabilities were and we were trying to
send bigger and bigger files so we'd
send a gigabyte file okay went good now
it's in a 2 gigabyte file okay it went
good and as we started to get up there
we started to figure out that our
limitation was actually put your
pitchforks down but our limitation was
actually JavaScript you know we actually
ran into the string couldn't hold enough
information for us to save a whole piece
of data so there's just a whole ton of
new things that you'll run into doing
these sorts of applications where you
know you have to think about how do I
store four gigabytes of information if
I'm sending files between two people
it's kind of it's a whole nother dynamic
for web application developers so what
can we do with this technology and in no
way do I recommend building a sentient
browser network of browsers that will
take over the world but hey it's pretty
neat idea it's definitely possible with
WebRTC data channel stamp of approval so
this is kind of bringing out faster
applications and applications that can
handle more data so now I can do my
multiplayer gaming this this data
channel technology is the same kind of
stuff that you know battlefields using
the call of duty is using quake 3 doomed
to go even further back than that I mean
this is technology it's been around for
years and we're getting this in the
browser so quake 3 remix I want to see
them also file sharing you know you can
now send large pieces of data without
having to host you know thousands of
different servers to be able to handle
all this data it's really just you're
not paying for bandwidth
not paying for storage you're not paying
for transfer and setting it all up once
your deep once your users can talk to
each other you can build the Napster in
browsers and this is already stuff
that's been done so far and there's even
stuff like further on after that anyone
using a chromecast in here right now
anyone been checking that out chromecast
is really cool this little device that
plugs in your TV and you can actually
play netflix you know with your phone so
you can open up netflix on your phone
you can say i want to play this video
but i want to play it on that TV over
there and it just does everything for
you but WebRTC opens up this kind of
technology now my phone can talk to my
TV now my phone can talk to my computer
so you know why can't I use my phone as
a remote control to control the video
that's playing on my TV why can't I see
something on my phone and then send that
to my computer so that when i get off
the train and go to my desk everything
is right there waiting for me in the
browser second screen devices content
delivery you know we're seeing all sorts
of new technology and new applications
popping up with the data channel and
there's great examples of this today so
the first example i want to show is this
file sharing application and this is
what I was talking about where we
actually built a file sharing
application with the data channel on top
of pumped up so what i'm doing here is
opening up to different clients and
you'll see if there we go so they can
now see each other so this one is seeing
that the other one is online and i can
choose a file to share let's see there's
a good one
and now my other client can see hey this
is you know the other person now has a
file to share with me so I click get it
opens up a data channel between the two
and pipes that data directly from one
browser to another and it only took one
point three seconds no servers hosting
the files it didn't get uploaded
anywhere you know the thing if you ever
use gmail you can only use 25 megabyte
files those limitations are gone with
WebRTC you know I just shared a file
from one browser to another and there's
tons of more great examples out there
the two other links I won't go too far
into the the banana bread one is really
awesome Mozilla took banana bread which
is their WebGL kind of almost like a
first-person shooter game and took it
and use WebRTC data channel to make it
multiplayer so they had you know five
people who were playing against each
other in this 3d first-person shooter
game you know all in the browser no
downloads I didn't have to install
anything everything just worked out of
the box in Firefox so if you get a
chance to check that out it's really
really cool stuff and also another thing
that kind of popped up in the community
that really surprised a lot of people is
this peer CDN and the idea behind it is
that if I'm sitting down you know like
most you are at your computers and
you're on facebook and the person next
to you is on facebook you know why can't
I get my CSS my JavaScript and any other
files that I'm using from that person
since they're technically the closest
server in my region so the you know uses
WebRTC data channel to actually transfer
these files much like a CDN does except
between computers that you know arc that
might be close to you so really really
innovative neat stuff coming out and I
really think this is changing the way we
think about why the applications the way
we think about web computing you know it
changes the way users interact obviously
users can interact with each other but
it also changes the way you know web
developers are going to start thinking
about building applications so if I had
the capability to to send data and
all time between clients you know it
opens up a lot of new ideas now my phone
can talk to my computer and you know
they can share data not only from they
can share it from the the cameras they
can share it from the accelerometers
with phonegap there's all sorts of
things that you can just really build
really cool stuff on top of hair so you
know gone are the days of one client
talking with four servers to get my data
but now you know maybe it's more like a
mesh network maybe my client talks to
three other people in the room and two
servers to build that webpage and build
that experience so that's all I have
taking any questions there's my Twitter
github check us out on github and then
also who palmtop has there we built a
like a WebRTC kind of API framework much
like pjs out there so there's link to
that and then yeah check out pub now and
WebRTC thanks
it's it's pretty pretty darn fast in my
opinion I mean if you think of download
it was a pretty large image I forgot how
large it was it's actually like almost
like a wallpaper type background and
there will be a little bit of latency
but I think it's much faster than a lot
of the other stuff that we've seen today
yeah so the question was what about drop
connections if I have a phone and I go
through a tunnel you know what what
happens then the unfortunate thing is
that like you will just it'll try and
reconnect as much as it can but you will
get lost data if you don't try and
handle those use cases so you really
want to make sure that your your binding
to the on opens and the closes and you
know learning win you know when the data
channel opens and when the data channel
closes then I know I need to send my
data off to a server or then I need to
store it in memory for what I do have a
connection and reconnect later on so
you'll have to add your own kind of
logic to take care of those cases but
all the tools are there and all the
events are there to actually handle
those cases the so I haven't really
worked on any games in with the data
channel yet I've mostly been doing kind
of file sharing and chatting stuff it's
really going to depend on your
connection so I mean if you look at
games today you can get 5v5 in a room
all playing against each other there's
no reason why you can do that in the
browser as well it's not there's no like
arbitrary limits it's really just almost
like a pass-through to this UDP
technology that like I said the games
are using the same exact technology
today maybe you know it's a lot more
sophisticated for a game but there's
really no limits on what the browser can
do with that so you can probably get 5v5
it's like a that's all we depend on your
network and you're going to have to do
latency checks to see how long things
are taking between here and then
somewhere else and do all that but i'd
say at least 10 people probably more so
like I said the limits are really going
to be on the network you know most of
the limits that you'll see you'll you'll
hit network capability limits much
faster than you'll hit anything in
JavaScript of the browser limits wise so
if I have a bad connection that's going
to be your limiting factor you're not
going to hit anything in the JavaScript
side other than maybe interrupts in the
JavaScript vm that's running but you can
get pretty pretty pretty fast I haven't
done any benchmarks so i can't speak to
any numbers but there's i've seen
nothing that is going to limit you on
the JavaScript side so am I very limited
understanding right now is that if the
computer you're trying to establish a
mere connection with is behind a
firewall then the ice framework will
fall back on a turn server and you have
data will get routed through the turn
server yeah so my question is how often
is that the case and and when that does
happen it does that happen every time
the computers behind a firewall and if
that is the case is it still appears
that way so there's some really great
studies out there already on turn first
on and when each one happens I don't
know the latest numbers so don't quote
me on it but I think turn is somewhere
somewhere around eighteen percent maybe
even less so most of the time you're
actually using stun you're making the
peer connections successfully and a lot
of people say firewalls you know
everyone has a firewall that's not going
to limit your stun peer connections on
in the most common use cases it's more
talking about those super secure you
know seeing in a military base somewhere
firewall that's going to be the limiting
factor for wind it's falling back on
those turn servers so I'd say you know
most of the time in most of you use
cases on mom and pops computer you're
not going to have you're going to end up
using stun and it's going to make
successfully that period bear connection
without the latency from a turn server
yeah so the they're not really competing
in the sense WebSockets is really the
client to server model whereas WebRTC is
really the peer-to-peer model so it's
kind of different models of thinking
about how I'm sending data WebSockets is
really TCP only so you're not going to
get that low latency UDP connection that
you'll find with WebRTC that being said
you can probably download the the Google
is you know graciously opened up a lot
of the source code for web RTC so if you
can actually get that on a on a server
and create a connection between a server
and a browser you know using that source
code then you might be able to get a
lower latency connection yeah it's it's
going to be something on the peer
connection level so that's where you're
going to start using if you have an MCU
that can actually multicast for you
that's where you'll get your multi
casting ability there's nothing built
into the data the data channel layer
that all I to do that that being said
you can use other things like web
sockets like long polling to a server
and have a server you know multi casting
stuff is something that has been kind of
multi casting data is something that's
kind of been done a lot already so you
can definitely find ways to do that
today without using the the peer
connection
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>