<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Get MEAN! Part 1/3: Orientation to the MEAN Stack &amp; Node | Coder Coacher - Coaching Coders</title><meta content="Get MEAN! Part 1/3: Orientation to the MEAN Stack &amp; Node - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Get MEAN! Part 1/3: Orientation to the MEAN Stack &amp; Node</b></h2><h5 class="post__date">2014-11-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JYz3j5DnvkA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so this is my magic commercial moment I
am word Val I am behind this open source
product called breeze for it's both for
html5 developers and if you're a c-sharp
developer there's a dotnet version for
that well for xamarin and things like
that you can that's my Twitter handle up
top and on we go I should have said what
it is it breeze is a framework layer for
Singapore applications that want to
manage their data if because they have
rich data and they want to validate it
cash it query it take it offline that
kind of thing okay so mean is a
JavaScript technology stack for single
page apps what do we mean by that it's
an HTML javascript client application
it's hosted in a web page a single web
page that's the single part which acts
as a frame that's downloaded once
henceforth it executes autonomously in
the browser when the time comes I'll
just have to switch over because I can't
type and do this at the same time so it
executes autonomously and the browser
just sitting there does and it doesn't
go back to the server unless it needs
something it can't do on its own and
that allows it to go offline and do a
variety of other things so this is a
good model for web applications it's not
for websites you wouldn't do a search
cider with it it's where you have to
maximize the the responsiveness of the
user because you want to be close to the
most important resource you have which
is the human being close to the machine
and then you minimize the server
interaction so that's what a single page
app is and that's really mean is
targeting that kind of
application so what do we mean by a
technology stack that's JavaScript but
what is the technology stack it's these
things and once you have this intuition
you you can go home you've got a
database and that's the EM that's the
Mongo Express is going to be your web
server angular is going to be the tool
with which you construct your front and
the client and then node is going to be
the server-side runtime environment so I
mean well from our perspective as
developers it's because it's nice to us
we get one language to program in across
the entire stack it's really easy to get
started and it's easy to understand if
you once you get your JavaScript chops
because you're not changing gears all
the time it's really easy to change
what's going on and you're going to find
out about all this as you watch me go
and it's open source that's kind of nice
and it has really vibrant and exciting
community around it so it's easy to get
plugged in and that's fun and that's all
good for us but what about the people
who pay us why should they like it or do
they like it is it just one of those
toys well the fact the matter is that
you don't it isn't like you just
developed a toy and you have to
redevelop it somehow you really deploy
what it is that you build there are a
lot of large commercial deployments of
the mean stack we're talking places like
walmart and so forth it has many large
backers lots of funding in all of the
all the stack layers so what we're going
to do the three of us today is we are
going to build this little application
on the left hand side there where you
enter the question that interest you
other people vote on it you'll be able
to go to a particular site will give you
the link at the break all right and
you'll be able to build things up and
down and we're going to build that well
we're going to pretend to build it we're
going to build it from scratch in order
to do that though we're not going to be
able to spell it mean we're going to
have to spell a nema because we're going
to go from the back to the front I am
going to do the note and Express and my
friend matt is going to do Mongo my
friend aleisha is going to do
okay what is node it is a runtime it's
not a server to run time and that means
actually they even comes with a rebel so
I can fire it up and start finding out
what one plus three is and stuff like
that that stuff that you've always
wanted to do in javascript and now you
can right there a node hmm the thing
that we should know is that node is for
JavaScript developers but it's not
written in JavaScript sometimes I hear
people say I can't be any good because
you know JavaScript isn't performing
well it's not written in JavaScript all
right it's written in something else I
can see I'm not sure about anyway it's
important to know that that's a place
for you to program but itself is not
written in JavaScript the next thing
that's really helpful to know is that
it's a particular dialect of JavaScript
unlike writing in the browser where you
have to worry about whether it's an xmas
tree browser or it's this dialect of
that hey you get one get one programming
model and if you've ever had to do you
don't have to worry about that
cross-browser stuff which drives you mad
right so you've got one it's called equi
script five it will soon in its next
version be xmas script six there's no
Dom to worry about there's no bottom to
talk to you don't have a browser you're
that's mostly a good thing you don't
have to worry about shims and one of the
key characteristics of programming a
node is that it's it's got a single
event loop it has no threads so there
are no concurrency issues you're not
gonna have to worry about shared data
all right but it does mean that you're
going to have to learn to program in
this event loop style you're going to
have to if you have never programmed
asynchronously before well you will now
modularity is key to the way in which
node is constructed so you actually
build your application with other
modules that other people have written
and then you export your own module
that's just like that require than what
you need export what you're going to of
other people consume now no chips with a
bunch of core modules all of them these
I'm showing you
ways to interact with the underlying
operating system whatever that operating
system is by the way because it's cross
platinum in doze you can run on Linux
can run it on anything and there's a
package manager called NPM it also comes
with it which is how you can get modules
from somebody else so you got core
modules and then you got the modules you
can get from somebody else including
your own which you can register alright
so it becomes this whole ecosystem now
it also comes with some core modules to
help node act as a server alright and
those are the ones you kind of expect
you'd have something to help talk to the
HTTP stack to TCP stack you have some
way finding what the paths were you
might have be able to you know zip up
stuff over the wire right but it's
really just the basics for building a
server so we're going to come to that in
a second so let's think about some of
the design considerations though as you
if you were to take on node because
there's some things you have to keep in
mind all right that acing paradigm I
talked about that's new for a lot of
people all right you've only got one
thread you better be careful what you do
with it you better not try and chew it
up because you'll be blocking everybody
else who's trying to hit you all right
so get in get out you're going to have
all these modules that's great go
shopping get it but then you got to know
what's in those modules it's up to you
to decide what modules you're going to
have and are they safe all right a lot
of other environments you know you just
take it out of the box and you count on
the vendor to make sure that everything
you get is safe you have to watch that
so let's talk very clearly about what
the ideal workload is for a node server
because it's not like what you if you've
ever done any other kind of server
programming it's not the same you're
really looking for something that's IO
bound all right that's like come in get
the file turn around set it back come in
get something turn around send it back
that's what you're looking for you don't
want to sit here in calculate pi or the
meaning of life that means little
computation
you try not to do any computation get in
get out now it turns out that that's
what a lot of servers do so that's
really well-suited for high-volume kinds
of activities on servers but it wouldn't
be the place to have a JavaScript voice
analysis program now what you can do
however is if you have something that's
really compute bound you can always
asynchronously send the task off to
whatever that other into some other
language into something that is going to
do any kind of heavy computation all
right that's in fact how no itself is
built that's how you when you'll see us
talk to databases that's what's going on
you're actually talking to a plug-in
module that's written in something else
not JavaScript it's going to grind away
on another thread and then they
synchronously come back all right so if
you get this hybrid it's perfectly
possible to do to plug in to highly
compute intensive processes but they
wouldn't be part of note itself you
would be talking to them asynchronous
Lee so let's build a server in node
that's all the code tags I'm not
actually going to do it this way so I'm
not even concerned about it but you can
see it's only a few number of lines fire
it up and then you launch it and then
you browse to it and you're good to go
there's your entire server well that's
really not going to be good enough for
industrial strength and as a matter of
fact you wouldn't want to write it and
roll node so one of the things that many
people do is they've written modules on
top of node to sort take care of the
next level of things that you would have
to do on a server and that's what
Express is about it's a web app that
rides on top of node and that means that
it's itself a node module that will be
required and it in rich's the whole HTTP
stack with all this kind of stuff that
you might think you want to do in a real
server right I mean that's what a real
server does and a whole lot more now one
of the keys though is that Express can
do some of this but it doesn't do it all
itself just like no tits
a system of modules listen but it's a
pattern it's a pattern and it's called
it's a stack of middleware pattern
that's what I'm going to talk to you
about so what is middle error it's a
function it's a function with that
signature takes a request-response and a
next function alright what you can do in
there is you can examine the request
find out what the client sent you you
can turn around and report something
back send something back and the
response or you can say I don't know
it's not for me move on next thing by
calling next see that okay so here's a
typical middle airflow API request comes
in goes into a piece of middleware see
that signature well in this one we're
just going to log it and we're going to
call next so we flow through to the next
piece in the stack all right static file
handler so we say hey is that file for
me is that are they asking for a file I
know about if so send it send it back
the client we're done no it's not for me
I'm just going to call next all right so
so then we go to an API handler maybe
it's for an API so we call out to some
function right we say hey is this
request for you it comes back with data
cool we send that data back to the
client all as well that uh or maybe not
well now what do we do we keep falling
down through the stack not found head
and learn and in this case we'll send a
404 okay see how that works lu lu lu
just sank okay I lied it's really two
stacks nobody tells you this well they
do but you have to look for it there's a
happy snacking and not so happy Stan all
right how do I tell them apart well
there's our regular stag right you know
there were happy path those are the
three if you write a function that takes
exactly four variables these are
parameters these are the four parameters
it takes first one is that e RR which
you may yes that's a
so let's see how this works we go okay
so far and oh dad the new error so we
call the next function with that and you
cross over to the sad stack path where
something I hope is waiting for it well
fortunately we're able to fix it it's
all better I call next with nothing and
I'm back onto the happy path oh it's
still too bad okay call it again don't
come back over here and this is our give
up error handler and we send a 500 and
it's over okay so you can bounce back
and forth between these just they're all
stacked up like I was talking about but
you have these two worlds okay so enough
slide where and now for the high wire
act because i'm going to start building
this application if you will be willing
to hold that for me that will make it a
lot easier we have a handler okay i love
a handler i'll have to put the glasses
on to all right let's start in the
terminal window and we're going to go
express this is weird having that in
here let's see if i can am I am I in
their data I'm not I'm not able to type
holy moly that's am I what's going on in
there okay we'll try again yeah I'm none
of my keystrokes or appearing that is
wonderful let's hold that thought well
nothing's been generated yet either so
that's a good thing when in doubt try a
new window CD when we call it mean demo
/ back end and i'm typing how about that
give the guy a hand all right EJ EJ s
okay so what it just did is it used an
express generator which is just
it's a scaffolding thing it just dumped
some stuff out for me and you can see
over here that I started to get stuff
you can't see the bottom of the screen
oh because you're in the back I have no
power to to change that but I will pull
things around if I can possibly do it so
you can see that right no how about that
how are we doing yeah can you see that
in the back good all right that's a it's
going to get crazy here it's going to
get crazy in a minimum all right so I'm
going to go into here and here is the
packages the end node packages we were
talking about and i'm going to add these
are all scaffold it out for us when I
said Express so I'm going to add two
more 1 4 cores and one for Mongo we'll
talk about Korres in a little bit all
right and that is all this stuff is all
the stuff i need so i am going to go get
it and i just say using the package
manager and PM install chugga chugga
chugga chugga chugga choo things are
happening i can see Spinneys and come on
home free all right so you see this node
modules up here showed up and all the
stuff we asked for showed up that's a
good thing that's what we're looking for
so we're feeling really confident now
we're going to run it npm start and it
didn't say anything but i'll bet you if
i refresh here that I welcome to express
hey thank you very much we're all done
well maybe not because that's not really
what we want to do we want to have a
data server here so here's my apt j s
which is the server stuff and notice all
these requires I kind of show you them
before it slow and all these modules
actually the express generator what it
wants to do is build you a server that's
capable of being a model view controller
server that's sending it generated pages
and stuff like that but we want a data
thing so see this view engine here and
say goodbye to that and now we don't
need any of these routes who wants that
now because we are not generating pages
we're going to be a data server and we
don't need any of that now
alright and i'm going to change see this
render thing in here render is what you
would do if you were rendering pages but
we don't render pages we don't do that
so we are going to have our own just
turn around and send the JSON back
whatever it is all right and I'm going
to do that and let's get rid of this one
and I'm going to put on something called
node mon no ma then slide dub dub dub
dun dun dun dun oh yes it's going what
this is going to do is we make changes
it will restart the server every time it
sees that I made a change this will make
our development so much more fun is this
still working okay message not found
that makes sense we said a request we
didn't have we took away everything they
could render everything it fell right to
the bottom right through the error hang
and bang we got back an error message
exactly like we wanted back here you see
404 this is exactly what we want well
but we want to build something so let's
go build something now I I had said dub
dub dub in / dub dub dub this is going
to be a data server so i have 3000 is
usually where people go for their
application so i'm changing this to four
five six seven and i'm going to go
consult console.log all right and I'll
save this and this may start up again
and if it doesn't I can just kick it and
now when I come back here you notice
that it said it was now listening on
four five six seven so I am expecting
this not to be good oh sad face but we
would expect that it will actually work
on four five six out so we're back in
business all right we just switched
where we're going well as long as we're
going to switch where we're going this
Kriya it presents a problem for us
because now we've got two servers that
are going to be talking to each other
one of them is going to be your
application and it's going to reach
across talk to another server now many
of you out there may have heard about
the same origin policy that prevents a
browser from doing that all right well
that's not a problem for us because we
are going to introduce the
wrong thing there we're going to
introduce that's not it either I know
what I was going to do I jumped see I
screwed it up actually normally I don't
really want any data at all I'm going to
close this up but what I do want is a
little test page so i'm going to create
a little test page here and this is
going to be md three that's going to be
my HTML and i want to serve and i got to
save that hang with me i'm going to put
it right here index dot HTML all right
now I've got one of these and I believe
when I save this we're going to get a
restart over here da da da da see it
look at it restarting is that nice and
now when i refresh four five six seven I
get a test page so i can serve static
assets out of this and this is a static
page normally i wouldn't have that but
while i'm developing it's nice to have a
little page i can test my api out with
right and we're going to be doing that
ok so now we've done that now I can get
back to my core story which if i turn my
notes there we go so i have to be ready
to have cross-origin things and and what
i have to do is I have to tell the
server be nice be nice to those people
who call about your calling cross origin
and so there's a piece of middleware hey
middleware express all the way drop it
in and there's course so that's that
when I can take off the shelf and now
I'm ready to create my own middleware
i'm going to create my own route router
middleware and because what we're going
to do is anytime a request comes through
the go / AP I something then that we
know it's for us we know we're going to
serve data over that because this is our
data server alright so I got that set up
and it's time really for us to actually
create this thing so I'm going to go out
to close that up I'm going to go out to
this little folder called roots here I
don't care about that one that's garbage
this is the one that we used to be
serving that original page and it
rendered and all that stuff and we don't
care
because we are going to put our own
thing in there and I'm going to guess
that that's 76 uh-huh okay so now that
looks like a set of routes doesn't it
looks like I said I API routes doesn't
have a lead API why doesn't it have a
lead API kill that because what I've
done is I've said hey this router
mounted an API so anything that goes API
that'll start there but everything that
comes after the slash API gets routed
here have you ever seen browder stuff
before you know that this is it's going
to be looking for / questions with a
token that means the ID so that's
probably to get ID thing and this is get
all questions and bunch of other stuff
and we'll be seeing how this works okay
but I've set up this little router now I
actually got to do something with it you
can see that it says something about
data here and it's got to get that from
from somewhere and at what that is is
that's going to be a data service so i'm
going to require that data service I
hope yes notice data require data
service all right we haven't built it
yet but I'm going to require it and
that's going to be a little service
thing and it's gonna have methods on it
we're good to go every time somebody
comes and ask four questions it'll go
data get questions you're with me so
let's go do that I do need to add a new
folder here which i will call data
service because that's what it's looking
for oh that got small and now i'm going
to create a new file here and let's save
that and let's remember where that's
going to go because that's going to go
under our data service and we're going
to call this this is no D index J s
alright basically but I don't have time
to explain it but that's a typical name
for something that starts at the top of
a folder alright so let's let's now get
that stuff let's see if I've got a
implementation of that oh I do alright
so it's a no way it's that not
implemented implementation but it's an
implementation so I'm going to save this
by the way I'm going to save that oh my
servers crashed oh it's terrible no it's
not it's going to be fine all right now
I've got
I've got an implementation of it and
it's look it's healthy again isn't this
fun I get to keep writing and crashing
and having it come up again alright so
let's let's try this and now if I go for
bad file well I get message not found
but if I say get all questions I get
data service method not implemented hey
I'm working I'm routing all right if I
give it a bad round all right it's going
to message and I found but if I give it
one of many of the good routes I get
message not implemented I get to see
what I said it all right I'm on my way
all I got to do is start implementing
these data service methods so let's
straw let's um let's try that ah why not
do this one so I'll just say when it
asks forget questions hope there's a get
questions method let's put one in and
ignore the man behind the curtain while
he tries to remember where he's going
there we go all right there's our get
questions method comes in get questions
get questions send questions that's cool
don't have any questions but if I had
some I would send them all right let's
try let's let's let's get those wrong
what do ah ok we're going to get some
questions from some sample data and
we'll get those questions that will have
something descent but I don't have any
sound sample data yet do I we can fix
that because i'm going to type
incredibly fast boom
scary how good I am aren't I am one hell
of a good programmer I'll tell you this
is what our question habla looks object
looks like it's kind of interesting and
it'll play into our manga world first of
all that is a Mongol ID it's not just
any ID and we'll see matt'll tell us why
that's important later as what is also
why that name is important but the other
thing I want you to say is you know if
you were used to relational you're used
to having flat tables but what is that
okay it's a nested array it's an object
it's a JSON object I can have any model
structure I want in here that's one of
the cool things about Mongo it's also
cool thing about an in-memory database
which is all I know right now I've got
an in-memory database all right so i'll
save that and i'm going to call that
they sample data is yeah because that is
what we're pulling in here now so the
big question is did anything good happen
not yet are we worried of course we are
get a p.i questions 500 that can't be
good oh you know you do these things ten
times and it comes out get questions get
questions sample data due to do that I
put in the right place sample data that
is let's kick it again ah that we said I
just had to kick it you gotta kick the
server every once in a while let's see
that it happened this time and it's not
so good not so good I've done this 10
times and oh how about if I save the
file that might help it started again
maybe that's why it didn't start hey
thank you I thought I'm gonna have to
just like cut my throat and begun okay
so you do have to save you know I can't
yeah like what are you doing alright so
that's good how about get questions by
ID I think I'm running a little over but
I know Matt will be nice and won't mind
so uh let's uh let's do that one and
that's a that looks like this alright
we're going to find the question and if
we find the question we're going to send
it if we don't it's not so good and
we're going to tell them that but where
does that come from let's try and
implement that shall we now here's what
I want you to see the request comes with
parameters remember this thing has a
token so I can pick up those parameters
and then this is an in-memory database
and I can go look for it and if I get a
question it's all good and here's my 404
and let's see what happens did it
restart we'll know as soon as I come
back here and try get questioned by ID
oh I'm living large all right we're good
we're good Wow how about get the top
three questions not so good All Right
see these vote counts it's all over the
place and it's certainly more than three
so I'm missing something what am I
missing well it turns out that you can
pass a query string to this get
questions and I can sort by votes and I
can page up and down and so clearly I
need some extra code here and let's see
if I can come up with that code what am
i up to let's try this one but uh sort
tape and skit and then I make this I'm
going to quickly do this so whatever
this function is that it does we're
going to send its output back to the
client red cent all right what does it
do it takes the request and here's the
interesting thing remember it's a query
string so instead of rec params I go
wreck dot query dot something and if it
says votes I'll sort it one way and if
it doesn't blah blah blah and if it says
offset that's my skip it if it says
limit that's my take and you guys get
the idea all right so if I'm lucky here
this works we'll go back and we'll try
the top three questions well I got three
and it's starting with a vote count of
100 and then 50 and 36
that I just like that I've enabled a
query that has parameters it has query
parameters for our last trick we're
going to create a new we're going to
create a new question all right then a
great question hey that's a post I'm not
gonna be able to play around with my get
my browser thing anymore let's see what
it does anyway look at this it fishes
something out of the body i'm going to
send a post and i'm gonna send the body
and the body is going to have the stuff
i need to create a question and save it
into my database which in my case is
just a big ol array because it's in
memory all right well does it work it's
a post I can't do it here but
fortunately there's this wonderful tool
called postman witcha lets me create all
kinds of HTML I'm sorry HTTP requests
like and I've got these in here and when
you go to the code because but all this
code is available to you you'll have
these already prepared for you so i can
create a new question here and that's
the question and i'm going to send it
and if I'm lucky oh sad face but I know
what I know what this one is yep i
created the function but i didn't tell
it to use it alright so am I good kick
it alright we will try this again we
will come back here and we press send oh
well and you know what we're not going
to take time to figure this out because
it see see you people that's why I had
to kick it a look at that Oh without you
what would I be there it is hey they go
and if we get all of our questions and
we go to the bottom is Alfie there
what's it all about it is all right with
your help we built an Express server and
it's going against into memory database
and all we need is a real database and
for that I'm going to turn it over to my
friend Matt over here is going to tell
you all about Mongo</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>