<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>URL Re-writing | Coder Coacher - Coaching Coders</title><meta content="URL Re-writing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>URL Re-writing</b></h2><h5 class="post__date">2012-08-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nW8TfxNBWfU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Lincoln Baxter and this talk
is on URL rewriting what that means for
your own productivity the security of
your applications and the usability the
end user usability of your applications
this is what I look like in the morning
but I'd like to start with a quote
judgments prevent us from seeing the
good that lies beyond appearances when
we think about the web we very quickly
make judgments we make judgments based
on how the website looks how it feels if
it's performant and we're very quickly
able to determine whether or not a
website is going to be giving us a good
experience or maybe an experience that
we can't trust or an experience that we
feel might harm us or just take too much
of our time to be worth it and this is
something that we're very good at in all
aspects of our life it's not just the
web you know it's it's a car it's you
know the type of music that's on the
radio station we're very good at this
and if we're not careful if we don't
take certain things into account we can
immediately turn people off to the
website that we are developing and this
starts with the URL because that's the
first thing that people see when they
enter your site they get a link to it
somewhere so what is your I'll be
writing anyone here know what do you
think
right so transforming one URL into
another or i'd like to say any
modification of the HTTP request
responds life cycle as a more general
application of that practice so we've
got problems with the web a lot of
problems actually the first one is
missing or relocated resources there's a
lot of stuff out on the web that it's
just not there anymore there's a problem
with readability and clutter I'll
explain that one a little bit later but
this is just presenting people with too
much information or the wrong
information there's the formatting of
that information how do we present this
to people in a human readable way so
that they can comprehend it the web was
really designed a lot of aspects of the
web were designed for machines but
there's a lot of aspects that are really
designed for us as well and we need to
make sure that we're presenting the
right information to the right being the
other part is more related to security
so revealing sensitive information what
are we reveal to people what do we
reveal to the machines and the last one
is the validation of the input that we
get back from those those sources so
there are actually many more problems in
this but these are just a few that we're
going to touch on today you're rewriting
is not a good choice for doing it wrong
if you want to fix a lot of these
problems URL rewriting is a good choice
so this is the first problem missing or
relocated resources who saw this coming
you know we've seen a lot of examples of
this over time in particular oracle
bought sun and they decided it would be
a great idea to change everything from
suncom to oracle com but they didn't
actually fix any of the links once they
took sun's website down and we ended up
with this mess where none of the old son
documentation worked that was easily
avoidable but did they do it no here's
what I say about that right that sucks
and we start seeing this more and more
on the web where we have people creating
fluffy cute little 404 pages because
inevitably you're going to end up there
sometimes and Blizzard actually blames
you for finding a page it didn't work
people start getting a little crazy and
I have no idea what that is but this is
one of my favorites and this is mine but
eventually we start seeing people
actually invest money in these things
and I don't know how much money this
cost but it obviously took some time
they hired a designer to make an
animation that's you know clever you get
there you like oh cool its little robot
github does the same thing you can move
the mouse and the cat and the background
shift dimensions a little bit how many
people here use github a lot of you it's
cuz you all do startups probably and
then people like probably go a little
bit too far with things this is one that
I found while searching for creative 404
pages these two guys decided to make a
video and here they're there now taking
the page down there it goes and yep yep
he's down he's down then someone took
drugs
this unicorn just won't quit so what
does it mean what do these four or four
pages mean what is this experience it
means that this happens a lot this is
something that everyone everyone lands
on and it's something that if you don't
you know provide a nice experience for
you're going to turn people off to your
website but it's really just distraction
from failure this is something that can
be avoided and it's simple but there are
two ways to have this happen and there
are also two pretty simple ways to fix
it the first thing that happens is that
content existed and now it is not in
other words the website sucks or the
content never existed and you suck but
either way no one's going to be happy so
do we do easy we redirect we set up in a
sense virtual links from the old
resource to the location of the new
resource and we solve the problem this
is so much of a problem in fact that
google recommends that you maintain your
redirects for 180 days so that old
browsers and search engines can wreak
ash all of the information that was put
there by the initial page all the
initial response codes all headers that
are cached in the DNS proxies all over
the web 180 days is a long time but 404
page is not a not something to trifle
with apparently it's Kenny found out so
we have several options we can use a
tool like Apache mod rewrite how many
you guys have used that a bunch of you
okay so the rewrite module of Apache mod
rewrite the mod rewrite module of Apache
is what you would use to do this or you
could use in Java the tucky URL rewrite
filter or a new alternative a tool that
I created which is OC piece off to
rewrite which is a more javab like you
code your rules in Java it gives you
more programmatic approach both move on
to number two URL readability I think
that this
is the problem with URL readability on
the web and the reason is to buy that
you have to go to this link there's only
three reasons why would click this link
if someone sent it to me anymore and an
email the first one is it came from
amazon and that's a trusted source but
if it were some link that i didn't
really know of some stores some random
place i would probably question whether
or not i wanted to open that in my
browser unless of course i use linux in
which case i'm pretty fearless i don't
care because i'm not gonna get a virus
and the third is maybe we're friends and
i might trust you but even so you get an
email from one of your friends maybe his
email account got hacked maybe you know
someone else logged in and decided to
play a prank on or something like that
you can you never be sure because this
URL is just full of drunk this is what
it should be amazon.com / shop / Kindle
Touch it's immediately clear to me what
I'm going to get when I click this now
amazon actually has a couple reasons why
they have all that information in there
they have a refer program so if you
actually send someone to Amazon site
they track based on the referrer code in
the URL who generated the link and then
who should get a percentage of the sale
of that product but they have an option
they don't actually need to show you any
of this stuff in order to track that
information they can in fact make it
abundantly clear that you should not
care about it while maintaining the
cleanliness of the URL here we have
amazon.com / shop / kindle touch ? query
string all of the rest of the junk
encoded into a string that i know is not
for me but i still know what is for me
and that's what's in the path of the
oral this is one strategy this can also
be used to actually secure the
information that URL the problem with
Amazon's website is this link is
vulnerable it has this PF r dt and PF r
DP code and PDF PF r di those three are
the referrer codes for the person that
sent the link if i really wanted to i
could copy that link or intercept it
insert my own link insert my own codes
as a refer and hijack people's referrals
to amazon if i could intercept people's
links when they posted them etc amazon
could protect themselves if they
encrypted this and also present a nicer
experience to their users which gets me
to the next point which is formatting
this information as I already hinted
there are some things we can do the URL
path itself to make it more consumable
for people this example does not use the
path very extensively we have a
top-level domain and then a whole bunch
of query parameters that tell their
application what to do this is machine
consumable information there are a
couple problems with this the first one
is it's not cool so be cool and let's
rethink this example calm / store /
shoes / 1 and maybe we're purchasing
that item the reason the old URL is bad
for humans is because query parameters
are not necessarily ordered and being
mostly a society and a culture that
reads from left to right an unordered
query string and go back up there for a
second is not necessarily in the order
that's going to be easiest for us to
consume it actually takes me time in
seconds to figure out what this means
and while it's not necessarily the worst
experience in the world it's still
something that's going to make people
think huh should I really click that but
there's nothing malicious there it's
just a link that's a little bit sloppy
so we come down we can fix it quite
easily
which brings me to my next question why
are you afraid of buying a used car what
are you afraid of sub adequate parts
substituted parts maybe not everything
is original yep anything else maybe it
breaks anyone else have no idea what
happened to it before what it really
comes down to all of those things is a
lack of trust you have no idea what
you're going to get and this is the same
thing with the URL really any URL when
you click it you're you're making you're
taking a certain level of trust in that
URL that it's going to give you what you
expect so do you trust me no no not
really would you click this link at work
you could get fired for clicking this
link that's right so I'm not going to
click that but if we had not used in a
pass gated URL we might have known that
it would have been a rickroll how many
people have been rick rolled in their
life how many people don't know what a
rickroll is all right fine i'm going to
click it
this is a rickroll that's rick astley
performing his lovely dance and i just
lost the game and this is you you send
it to someone in the context of a
conversation where you're like hey I
just found a really cool car and then
you send in this link and there's this
not exactly a great experience so oh no
that was too far there we go right okay
all right that was the next section so
build trust by reducing the clutter in
your URLs and make it more easily
apparent what that you are all is going
to provide now YouTube again has a
reason why they do the URL encoding that
they do that's because they have so many
URLs so many accesses that they actually
build in a strategy of performance
optimization in the URL so they can
serve things faster but this is the
unique constraint to youtube I don't
think many of us have that much traffic
which gets to my next point revealing
sensitive information no one likes to
admit the usenet not even Microsoft they
actually stripped off the aspx suffix of
this link why well we have all of these
different frameworks we have jsf struts
PHP seem Ruby pearl CGI jsf again
another indication we have net we have
plain Java JSP and many more the fact
that I could name the technology that
these suffixes usually go with is a bad
thing because that's the first piece of
information that people can start to use
to attack their websites so the
alternative don't expose that
information
by hiding the suffix of the technology
we remove one piece of information that
would give people insight into the way
we've designed our systems and insight
into the way of design your system is
the only way to compromise it pretty
much unless you use something someone
else has done and someone else is in
sight a good magician never reveals
their implementation how many people use
apache in some form or another most of
us right so Apache has this lovely
little feature where on the 404 page or
even in the headers of every page that's
served it tells you the version number
and the build number and the date of
that build of the particular version of
apache you're using so that seemed like
a good idea maybe it's good for
popularity but it's not really good for
security so I actually recommend
disabling all of these features whenever
you can and if you can't disable it with
Apache sometimes you can strip these
things out in your application it
depends on your environment so just get
rid of it don't give people that
information the next part of security is
the other way right we don't want to
provide people with information that
they can use to attack us and we also
want to make sure that the information
we are giving them access to is actually
something that they can then that we can
verify and validate so the URL is user
input right it's something that comes
from the user's computer and comes to
our system the same is true for request
headers any request parameters these are
all forms of user input and while many
of us probably do know to validate this
stuff already sometimes we forget about
headers sometimes we forget about the
URL it's just it's the the less common
forms of attack but things that are
still possible an interesting study
released by aspect security actually
said that two of the three recent
vulnerabilities discovered in web
frameworks were URL based and these were
interesting because
not only that they give access to
information in the system they gave
actual root access and it was really
easy how many people are familiar with
the expression language in Java you
basically you type in you provide a
string and that string gets decoded by
the system and then that that string
gets evaluated and then executed and it
actually lets you type static java
method calls in there so if you type
system dot exec it'll evaluate it system
that exact gives you access to the route
to the user's account on the system
that's running the java application and
that was an exploit in struts that was
an exploit in spring and also in seem
i'm pretty sure that both of these have
ball ready been fixed but still
nonetheless there are people who
probably have not patched their versions
of these applications and this is a URL
based attack we can secure existing
applications without modifying existing
code by adding some functionality like
this so when we have an inbound request
where the URL is where either the URL is
not constrained by the selected
characters so there are some characters
we don't want to allow or maybe there's
a request parameter that has some of
this information that we don't want to
allow or maybe we can add headers there
as well we just want to abort that
request or we can take some other action
this is something you can do in any URL
rewriting framework it just takes a
little bit of work to set up your
constraints and your validations but
it's something you might want to think
about doing if you really have a mission
critical system because you don't want
to leave these things open
this is a real life example if anyone
here can tell me where this link goes
before I go to the next slide I'll give
you ten dollars what am I going to find
on this page okay that's good it's an LL
Bean catalog what what what kind of
products am I going to find there it's a
good answer products in category 28
right that URL should have been this and
in fact if you go to this URL it sends
you to the other one why why not why is
this not good enough what what
information and that other thing was not
good enough for us if we take another
look at that we can actually see that
it's a webapp cool I think I do that
already right we can see that it was
served from an IBM web store this is
what the WCS stands for we can see that
it was hosted from a servlet now we know
running java we can see that there's
some vectors for attack here category 28
and stride e1 those are places where we
can start entering information and
trying to break our system now catalog
anyone okay i could presume maybe there
are options for different types of
catalogs out on the web like maybe they
have a few varieties that they send out
and they're tracking who goes to which
but language ID negative one I don't
know who speaks that I mean I don't
think computers even speak negative 1
speak 1 and 0 and then I don't know what
this is someone my one of my previous
talks told me but I don't remember it
has something to do with the IBM webs
Web Store so if there happens to be a
vulnerability in that congratulations
you just expose that as well
so clean it up don't show this
information unless you really have to
and if you do have to as we'll see in
the demos there are some ways that we
can protect ourselves from this kind of
attack but since that was maybe a little
bit heavy I'm going to take a brief
interlude and say that the HTTP 1.1
status code for 18 has a small message
for us it is a teapot the resulting
entity may be short and stout this is in
the spec alright that's cool I don't
really get it but that's in the spec so
we've got some problems right we have
missing or relocated resources we have a
readability problem with people seeing
URLs we have a formatting problem we
want to present information that people
will be able to easily consume and not
make one of those snap judgments when
they come to our when I receive a link
to our website or see that link on the
page we don't want to reveal too much
information because we could potentially
expose ourselves to an attack and we
want to make sure that the information
we do expose is validated so this leads
us to our proposed solution URL
rewriting or modifying the inbound
response and up on request in bound
requests and outbound response there are
a couple types of URL rewriting tools we
have proxy based tools like apache mod
rewrite one of the limitations of which
is it is an inbound only tool so when
you have a request come in from a client
browser into your server mod rewrite
gets it one chance to handle that which
is right when it hits right before it
goes to your application
anything your application sends back is
actually so there there are two chances
when your application sends a response
back Apache rewrite can actually add
headers to that but it can't change the
content that's a problem because if you
want to apply a rewriting rule to an
existing application you might be able
to change links and redirect links that
are coming in but if you're still
delivering links they're incorrect going
out you're just perpetuating the problem
then you have to change code so it makes
sense for us to be able to do that on
the outbound as well and that's where
the filter based tools come in and as I
said there are a couple options I'll go
over those but they let us do inbound
and outbound rewriting so we can modify
not only the inbound request but also
the outbound response and the content of
that response so there are a couple
basic things that we can do with all
types of URL rewriting we can do
redirection in relocation this is to
address our missing or relocated
resources problems so we have all these
requests coming into our system and if
they hit an old URL we're just going to
send them to the new one the browser
will update itself the bad links will go
away the problem fixes itself over time
takes a long time but it works we can do
inbound perimeter ization this is an
interesting strategy for taking a not
necessarily friendly URL and taking the
query parameters out of it and embedding
them into the path so here this would be
equivalent to accessing web application
with a question mark and then category
equals whatever was at the category
parameter and then item equals whatever
was at the item parameter again so this
is how we can take an old query string
and turn it into a path we can do URL
validation we can inspect the values of
inbound links we can restrict what
people can access there
site with we can do header validation
and modification and I have no personal
investment in any of these tools but
we're about to see some examples um the
part that I really like is the filter
based stuff because we can do a whole
lot more we can do transformation
canonicalization so this is how many you
know when you type into Google right and
you type a word wrong it says did you
mean you can actually do that for your
website you can add a couple parameters
and then introduce a canonicalization
system oh yeah here we go where if
someone types the case wrong we can we
can make the case correct this could be
more complicated this could actually
reach out to a system and say what words
look like what we got excuse me what
words look like what we got and what
words does our site except that are
similar if there's one that makes sense
send them to it sorry are going from a
cold the one on top here says maybe we
want to introduce compression of certain
resources we have a CSS file and we
don't want to have to compress that when
we're developing we just want these
resources to be compressed when we're
hosting them at runtime so we say if any
resource request comes in that matches
CSS run it to a filter that's going to
perform compression that's another kind
of transformation we can do
we can do complex conversion validation
here we have a web store and that web
store takes in a product ID which we
have now restricted to restricted to
only the numbers a few word characters
and a few more numbers whatever the
format of our of our perimeter is then
we bind that to an expression language
value we actually can indirectly inject
that value in our system and maybe we
also want to convert that value into a
product itself and then validate the
product we can do all of these kinds of
things we could also perform request
interception this one's a little more
complicated and this one says when
someone accesses your site maybe they
have started to sign up for your
services but you don't want to make them
type in a username and a password to get
them access you send them out to Google
you say hey Google can you up Wow sorry
hey google and you authenticate can you
authenticate this person for me and when
you get the result back from google you
know a couple things about them you know
their name I need another email address
but maybe we don't have a password for
them yet maybe we'd like to give them
the ability to log in without Google so
what this says is ok we have a partially
authenticated user there in the database
but they have not confirmed their
username yet oh right right sorry we get
the actual name from google and their
email address but we don't have their
username what they want to publicly
display to people when they come to your
website so we see that they have an
account in the database but they don't
have a username yet so if
the case then we're going to redirect
them to the confirmation page this is
something else that we can do using a
more native based rewriting solution
that we would have trouble with doing in
a proxy based solution in this case it's
actually doing it forward so they never
experienced a redirect they access the
page the URL they access stays the same
they're just presented with a forum that
lets them type in their username any
questions about this questions so far
and there are there there are ways to
handle image requests separately I'm
personally a fan of the rule that said
or the the condition that says if this
resource could be handled by a servlet
or if this resource could be handled or
if this resource actually exists
physically on the disk then don't apply
this rule so there are strategies but
that's actually very good concern
because you can shoot yourself in the
foot pretty easily with stuff like this
there's some things that you shouldn't
do with Java you are you writing any
ideas what should you not do in Java
okay data transformations there's a
pretty generally applicable rule I'd
like to suggest and that is if it needs
to run when your app is not running
don't put it in Java because it's not
going to run that's where you put it in
a proxy so redirects and that kind of
stuff you generally want to put in the
proxy layer
so that was maybe a general overview of
you re writing but let's see how it
actually applies if you guys want to try
out these demos and you have bars
barcode scanners I'll try to put the
barcode up there for you and you can
pull it up on your phone or you can just
type in the URL as it appears on the
screen let me know if you got it
I got three seconds it's accessed a Sri
right rh cloud com but i'm going to show
you guys locally so this is an example
of using you are rewriting to control
access to a website based on certain
conditions so here we are and i'm going
to demonstrate time based access and
also domain based access you would
probably not usually want to put time
based access into your website in the
Java layer I've done it here because
it's more convenient for examples sake
but so you have a maintenance window
when you want your website to come down
you want to show people some other
content you can introduce a rule which
is going to restrict access based on
what time it is so here we see that our
timer is ticking down we currently have
access but in 10 seconds we are going to
be denied access and shown a different
resource
there we are and just to prove to you
guys let me I'm full screen here this
URL is going to remain the same for
whichever whichever content is displayed
and then we've done that we've simply
introduced a rule that says if whoops
wrong one here we go join this URL and
if it's an inbound request and time
condition is not granted then don't
actually provide access this is a little
bit more complicated than I would like
but again I'm doing this in Java the
next example the domain based makes a
little bit more sense for certain
features so I've accessed this web
application at localhost however if I
access it at 127 001 I'm denied access
maybe you have multiple clients maybe
you want to dynamically control which
client can access your website or which
parts of your website based on their
permissions this is a strategy you could
use to do that it's again not really a
particularly productive example but it's
just an example of using this technology
to do that kind of limitation so here we
join the URL to our resource on the
server and if the domain does not match
localhost or the open shift cloud we're
going to deny access by returning false
excuse me any questions about that so
the next demo is the validation and
conversion demo and this one says we're
going to implement some rest web
services but we're actually going to
implement them only using URL rewriting
tools more of a fun example but it also
demonstrates how we can validate and
convert the information we receive so
here's our demo sorry it's boring but
again it was created without actually
any HTML pages it's all being generated
by our rewriting configuration we can
come in here we can see the first
product you can see the second product
third product we can see all products
and we can actually add products I'm
going to view source here take one of
these
open up the rest client paste in our
content I'm going to is it post that
creates and I'm going to post that to
this URL if I did that right we get an
OK response and now we should see two
tickets for the football team but
because that was already in there let's
make it a little different what should
we add oh yeah getting ready would be
good that actually doesn't matter in the
system but good point let's add
something that has nothing to do with
anything here what kind of car do you
have what kind of bicycle okay no method
of transportation he is static feet
right and the price for feet is
priceless so we're going to send that
now we should let me go back to our
products list see no method of
transportation right here so let's take
a look at the interesting stuff the
configuration here we have a rule that
says if the method is get and the URL
has a product ID where that product ID
is a digit and also an integer this is
important for a reason i'll show you
soon we're going to convert that into a
product and then validate the product
then we get the product the converted
value out of the context here you could
actually just you know do your database
load or whatever and then stream that
back to xml to the client but what
happens if i get rid of this integer
constraint i'm going to save
I come back to my product list my single
product and then i'm going to start
trying to attack the website actually
how many 9s do i need all right 404
that's not what i wanted to show you
let's reload this
there we go so we actually had a number
format exception because we overflowed
the integer a very simple example of why
you should validate simple information
so let me come back and add in our
integer constraint which simply verifies
that we can actually in fact convert
what we got into an integer we'll see
that this works and now we just get a
404
the rest of this is pretty
straightforward again we're handling the
products and we're streaming all of them
then here's here we handle the post
requests where we reverse stream we
actually take the xml and then Marshall
it into a product then store it maybe
nor database or whatever not really
practical because there are lots of ways
to do rest they're already out there but
just an example of the importance of why
you should validate and convert so the
next Emeril excuse me is one of my
favorites this gets back to the whole
topic of exposing sensitive information
in your query string and also how we can
protect ourselves from attacks in the
query string protect ourselves from
manipulation and hijacking of
querystring information and also make it
abundantly clear that the information we
have in the query string is not meant
for a human it is in fact meant for a
computer
so here we have a straightforward page
and whatever I type into the address as
a query string is going to be encoded
and encrypted so that we cannot modify
it and that data is hidden what should I
type anything equals what global give me
something type this in ok what should I
type random things ok so here we can see
we've been redirected to an address with
this long nasty thing that I have no
idea what it means but the application
still knows that anything is global a
random is a thing and an SSN is one
through zero and this is again the value
of our other encrypted parameter so if
we look at the page here oops
let's see we're just I'm sorry that's
not the right one
we're just actually printing out that
information directly from the request so
our rewriting tool has modified modified
the request to now include more
information than we include the
decrypted information as if it had
already been in the original request
itself so here we just get the request
and then print out all the parameters on
the page so the interesting thing about
this is not only we have have we unfussy
did it we've also encrypted it and if we
try to modify it by adding some stuff in
here we have more information we now
have the ability to detect when people
are messing with us and we can take some
action excuse me how what happens if you
append additional parameters so I want
another parameter I'm guessing that it's
going to actually append this
information and into the encrypted
string more info yeah so we got we
already have an encrypted parameter so
it just didn't do anything with it yeah
oh yeah
it'll probably give us a Hello oh no it
didn't yeah but i'm using javaserver
faces to print it out so that's
protecting us inherently but the idea is
there right so we can do this kind of
thing by saying what we want to encode
all query parameters into another
parameter and then if there is a
checksum failure we can take some action
this is something you can implement with
or without this kind of a tool but it's
a strategy you could consider if you
want to maybe send security URLs to
people it's just an extra level of
protection so let's get back to the good
stuff so everything is going to client
side right and I don't really care about
requests and responses anymore because
now we get a WebSocket connection it
doesn't matter right i'm connected i can
send whatever data I want back and forth
across ssl right well this is how lots
of applications work as client apps in
the browser this is Twitter we can see
at the top here this is the URL that
I've used to access Twitter and twitter
says okay I'm going to serve up the
application and then inspect the anchor
tag and I know that I'm accessing either
Lincoln three my account or i'm
accessing / connect or / discover to do
a search and I'm going to use that
information to show what's relevant
based on the URL that I was given but
it's messy and with html5 we have a
better choice with html5 we have the
push state method which lets us actually
take the URL and change it in the
browser without redirecting or without
actually sending a new request back to
the server
this is interesting because now we can
load a client-side application that
client-side application can perform
navigations without actually refreshing
the browser while still preserving the
ability to bookmark your state bookmark
where what you're looking at in that
client-side application this is huge but
there's kind of a problem because well
first now you have to serve that
application from every possible book
markable URL you've got that's pretty
simple right you just take all of them
and no matter what you request you
always serve up the application that's
simple right so no matter what we get
we're going to serve it up but then we
see something like this we have our
example web page and then the example
web page with the username Lincoln and
that user has a project called project
one then Lincoln decides to create a
project called Lincoln now we start to
have a problem what is the root of this
URL was it served from Lincoln or was it
served from Lincoln Lincoln are we
looking at a user's account are we
looking at the users project it's more
difficult for the application to tell we
could hard code this into our domain but
if it's a product we're delivering to
people we don't know what the domain is
going to be so we need to deliver that
information somehow to the client and
this is something that you're already
writing can help us with we serve up the
application no matter what the requested
URL was and with the response we send a
cookie that cookie contains the root of
the application html5 actually
introduced a new element called the base
tag I believe which lets you serve that
information up in the HTML content
that's another way to do it but if
you're not doing either of those things
then you could also maybe have your
client applications send another request
back to the server and then receive the
information it needs before it loads
once it's established the socket
connection that's just one of the
strategies you can use and it's just one
of the little problems that comes up
every day one of the things that we have
to deal with that you
I'll be writing can address and we are
always finding more applications of URL
rewriting so I'd like to posit that you
already writing is not a good choice for
doing it wrong if you want to fix
problems there should be one of the
places you look first so it's at the end
absolutely not I'm hoping that this is
the beginning of your adventure with you
I'll be writing and if you'd like more
information please stay in the loop you
can visit the rewrite project website
that's the project where you saw code
examples from today at ocp soft-eyed org
slash rewrite you could follow a CP soft
on Twitter and you can definitely get
involved because this is all open source
and we we would love to have your input
so thank you very much any questions
questions so question is what in what
scope are the rules being defined in
this case you can actually define them
in whatever scope you want because are
you asking like in the scope or just
right so the rules that we saw here are
generated on every request and this
works because we're doing it all in Java
we're not parsing the configuration file
we're not doing anything like that so
it's very fast and if you want more
speed you can actually cash the rule set
based on whatever conditions you need
but because this happens in a very
request you can inspect the state of
every request as it comes in and
determine whether or not you want to
apply certain portions of that so you
can enable or disable certain parts of
the configuration based on the state of
the system by default its request scoped
if you would but you so it is actually a
circle filter there was nothing jsf
specific in the subject in fact that the
den was used jsf to do the pages so I
can explain that the reason the servlet
context is being passed into the rule
set is because sometimes you need to do
things like get the context path and in
order to verify that you're not doing
some bad things in the configuration
because like you said you can actually
shoot yourself in the foot pretty easily
the configuration is built once when the
filter starts up to make sure that
you're not doing anything on a per
request basis other than inspecting or
using deferred inspection of values so
if you try to reference an object that's
not available until the request is
active that is not allowed because you
can have a reference to an object and
then
access it once it's available but if you
do configuration on a per request basis
in a global configuration you can
actually introduce requests you can
bleed information between requests if
you're not careful and so that's why
that's not allowed but what you can do
is come down here and we're going to say
the fine rule when new HTTP condition
and now we have a servlet rewrite event
and a rule evaluation context this
rewrite event has the request in the
response in it and that's where we get
the ability to access the per request
information but we're doing this within
the confines of an object that is only
being accessed on that request and does
not modify in theory the other
information other questions
yeah so there are some pre-built rules
such as join and join is pretty much the
simplification of I want this URL to go
to this resource but if you want to do
something complicated and build up your
own more complex rule you can use define
rule and then you can create your own
conditions you can also create your own
operations in the perform clause which
is much very similar to the condition
it's just the action that you're
defining and you can chain these things
with and and you know build as as much
logical decision tree as you want cool
thanks guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>