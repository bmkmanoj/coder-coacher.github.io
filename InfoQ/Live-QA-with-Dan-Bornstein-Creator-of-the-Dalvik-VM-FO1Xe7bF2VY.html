<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Live Q&amp;A with Dan Bornstein, Creator of the Dalvik VM | Coder Coacher - Coaching Coders</title><meta content="Live Q&amp;A with Dan Bornstein, Creator of the Dalvik VM - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Live Q&amp;A with Dan Bornstein, Creator of the Dalvik VM</b></h2><h5 class="post__date">2015-09-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FO1Xe7bF2VY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I also wanted to thank then for agreeing
to do this this is actually our first
ama ask me anything those who don't
haven't heard of the term so we'll see
sort of how this is gonna work i'm sort
of excited then and then I'm you know
trusting you guys are gonna come up with
all sorts of crazy questions for them
starting from why 16-bit method count um
interesting enough I've actually known
then for some time now on so it's sort
of through my brother who's over there
who actually I've actually happens to be
his neighbor one day he found out it you
know he wasn't living since the next to
someone famous so that was sort of
awesome on and what's also interesting
for me to be here is that or just just
thought like in general is that I also
happen to co around the Java user group
and so when Andrew came out there was
this whole question of like is this
really Java is it not what is Dalek
doing um I've actually then went on my
sort of my own research of davek and
sort of dug a little bit and actually
I've been pretty impressed I mean sure
enough we now have art but nevertheless
um it's really an awesome piece of
technology so much so actually I wanted
to show you guys this that my brother
decided to get this which I had on my
car actually for very long time but I'm
actually gonna keep it now as a souvenir
at least one of them and then give the
other one too then maybe I'll just start
the first question if you can sort of
tell us a little bit about how do you
end up with a title virtual machinists
hello hello okay how did I end up with
the name virtual I I made it up so that
was I had that on my business card since
2002 I think which was when I was a
danger as with many companies actually I
don't know if if Yelp is one of these
but uh you could basically get whatever
you wanted on your business card as long
as it wasn't something like vice
president and so that you know there's
always like an important
competition of like you can have the
coolest man i pick virtual machine is
because of course I work on virtual
machines and it seemed like a fun name
so that's I they let it through and I've
been using it ever since so why don't we
just have you guys raise your hands I'll
run around give you the microphone and
we can go from there let's see who was
was first good so tell the story so what
happened where did you know from danger
to Google ok um sure so actually I mean
I'll start I'll do you one better i'll
start from just before i was hired at
danger um so the people here know what
danger was no okay i'm seeing at least a
few a few head shakes know okay so um
danger produced a a phone called which
was in the u.s. mostly called the
sidekick it was bring a was sold by
t-mobile okay so now I get a couple more
nods so the the t-mobile sidekick was a
was a little smartphone it had it had a
web browser it had an app store and you
could buy it in 2002 and I first saw a
prototype of the sidekick in it was like
two thousand one and it was a friend of
a friend well it worked at danger again
the company company that made it and I
saw this thing in my jaw dropped it was
like this is the future uh now keep in
mind at that point the future was a i
think it was like you know 320 x 240 16
bit grayscale display you know like that
bad kind of like slow refresh LED or LCD
that you know you don't really see that
much of anymore oh but still it was the
future it was you know it was connected
i was connected had a web browser it had
a camera took 160 x 120 pixel pictures
um but you know it's an email from a
thing you could chat on on aim on it
it was great um and I wanted to be part
of it I had no idea how this was like it
was some guy you know like who I met at
a party it's like how do i how do I get
a job at this place up it turned out I
had another friend who I didn't even I
didn't even know at the time that he
worked there met him at a party and he
knew what I did he's like oh you should
come work for this company that i'm
working for danger I'm like my jaw
dropped again and so I I interviewed
there and I got the job and it turns out
so that guy that that guy who I met that
first one turned out to be he wasn't
really my boss but I was a he was the
other guy doing or I guess I became the
other guy doing the vm at dangerous so
he was this is a guy named Brian
swedlund who also went on to be on the
colonel team on Android and so so that's
that's how I landed at danger I was at
danger for three years almost to the day
during the time I was there so i joined
like the date I think I signed my offer
letter the day before the first sidekick
shipped and then I was there for like
four or five different hard work you
know type of hardware software ribs
during the last year that i was there i
was i got sort of you know type
increasingly frustrated with what I saw
as management not really pushing the
technology forward it seemed like they
were just sort of like you know like
they weren't investing in the technology
anymore it seemed like they were just
trying to kind of do kind of minimal
revs and that as a software engineer of
course is very frustrating and I had
lots of ideas how i thought like this
thing could be better meanwhile you know
a year prior a good handful of folks had
left had left danger to form android
which was then a separate company you
know and so at the point where I was
like okay I was done with working on you
know like kind of my deliverables for
the whatever the current generation of
the you know
that next generation of the of the
device was going to be I said okay I'm
gonna I'm gonna start talking and see
see if there's something I could figure
out what to do next of course I talked
with my buddies who are now in Android
and that was I think I started that
conversation more or less in like june
of 2005 and during the time i was
chatting with them they got acquired by
google and then i had ended up having a
round of interviews at Google and then I
was hired on to become yet you know uh I
don't know exactly what but I was like
eight nine ten something like that
engineer at Google on the Android team
so I wasn't part of that acquisition but
I was sort of like one of the early
hires post-acquisition and that's you
know I guess that's the story that's how
I that's how I ended up on the on the
Android team hello what sort of changes
did dalvik end up going through because
I know Lee and especially like later
versions of Android like around four he
started to get better concurrent Alec
garbage collection and that kind of
things so what kind of changes they go
through um well i think you know like oh
so one thing I should i should say I
left Google three years ago so I am in
terms of sort of currency of what's been
going on I am you know three plus three
or so years out of date so I'll talk
about what was happening while we were
there or it's right well I was there the
you know the thing to remember is that
you know all you know all software sort
of you know it's kind of influenced by
the environment in which it finds itself
so you know when when dalvik was
originally designed the constraints were
different you know so of course as time
goes on so two things happen one is you
get experience with it and the other is
the constraints change you know and so
the thing I think you kind of call out
particularly is garbage collection which
is in its fine so you know that's one
thing that did change over time and one
of the other thing you know one of the
things that changed over time kind of in
the underlying system is that multiple
cores became something that we're
thing on mobile and that didn't used to
be the case so the original the original
GC whether or not you know however
concurrent it would could or could have
been designed to be it could not have
actually run literally concurrently with
with the application code because of
course it was running on a single core
underneath one of the things that did
happen though you know it at you know at
the time that we finally had multiple
cross to contend that either at our
disposal or to contend with depending on
how you think about it is that you know
that became that became a tactic for
reducing GC pause times and that's you
know the real thing that you care the
real thing that you care about is having
a good user experience so you know like
fixing GC isn't something that that say
like you know sort of came in kind of
from the top as like a this must happen
because you know because you know from
the top it's sort of like we want smooth
graphics you know we don't want you know
we don't want we don't want glitches
right that's the sort of thing that
comes in and then by the time it filters
down to my level it's like okay so what
can we do you know and you know reducing
GC pause times it was one of those
things and one of the things that we
could could do because we were on a
multiple multi core proc being a
processor or could could start to assume
that is do stuff where GC was happening
in it in more explicitly you know more
explicitly concurrently with the mutator
threads I hope that was a good answer
for you all right
so I heard a danger didn't directly big
app Android or that what happened to the
people of danger they just kind of fell
on the vine because they weren't doing
the right thing oh okay so what happened
at danger um so uh um well they're so
over over like you know when I when I
left danger I wasn't I wasn't the first
person to leave I would and I certainly
wasn't the last so if you follow the
people who stayed at danger eventually
danger got acquired by microsoft and
they i think this is pretty widely
regarded as a pretty bad debacle kind of
for all involved um they there the
danger team ended up I think you know to
the tit except they were they still
ended up working on kind of mobile stuff
a lot of them ended up getting put on a
team that was working on this thing that
Microsoft came out with eventually came
out with called the Kin which was a
private project which was already in
progress at Microsoft at the time of
acquisition and probably already doomed
I think in the end reports were that it
sold like a couple thousand units total
it was it was um yeah anyway so not not
not of not a successful product
unfortunately so that was that was kind
of what happened to danger directly um
but in the meantime they're like I said
I wasn't the first person to leave I
wasn't the last there was you know in
addition to people going from danger to
to Google or you know either via android
or more directly there was also a good
handful of folks who ended up going to
apple in the you know 2004-2005 time
range to work on at the time some secret
project and I during those couple of
years
I had friends who made that jump and we
would meet at parties and we you know on
both sides it's like that what are you
working on I can't really tell you why
are you working on I can't really we
knew what we were working on there is no
there was no doubt in on either side but
you know we towed the company line so
you know it came as no surprise to a
bunch of us when when the iphone was
announced and it came as no surprise
when Android was announced on the other
side you mentioned a couple of times
sort of the environment that dalvik was
created and shaping its form what sort
what were you anticipating the mobile
phone space how are you anticipating it
changing at the point where it was
created or when you initially created
dalvik um you know I think the I don't
think that I have we had any super major
insight into other info you know Moore's
Law is you know seems to hold with the
so you know it's like you look at what
you had in 2005 and kind of extrapolate
out you know so you knew the CPUs we're
going to get more numerous and generally
faster and there would be more RAM and
there would be more you know more flash
or flash equivalent storage you know the
thing that you know the one wild card is
still battery capacity which is has not
really been exactly following kind of
the same same kind of pace although
maybe we'll get a get something anyway
but yeah but that was that was sort of
the anticipation right so at the time
that I was designing dalvik I knew that
in the short term you know it was going
to be an interpreter it was going to be
you know and it was going to be running
on you know on you know you know a
couple hundred megahertz kind of
processor it wasn't going to have a ton
of RAM you know so I think you know we
were talking about like 64 megs of ram
is maybe being the kind of the minimal
that the
we are but you know have a typical sort
of thing that we would be running in so
you know that became very important to
sort of kind of use well but of course
over time we expected you know more RAM
faster cpu more cores that kind of thing
did you have a do that yeah okay there
was a question over there may be well
other guy kind of asked part of my
question which is like did you ever met
belviq would get this big and a but
since he kind of answered it like I
don't named it after the hometown of
ancestors in Iceland have you ever been
back there um so I'll try to answer both
up so I certainly I hoped it would be
big I mean you know I think that's kind
of like the maybe it's the the dream of
every software engineer to have a piece
of software that you use being used by
literally billions of people I mean like
you know it's like I don't you know I
didn't wake up every day thinking okay
yes it's definitely a night or whatever
it's like you know you hope for it to be
successful and that that was my hope and
I of course I was you know I've been
overwhelmed by you know by how kind of
how widely has ended up being deployed
um so I should correct the record on on
the name it yes it's named after after a
town in Iceland which by the way this
shirt that I'm wearing is has the
scientists on photo that I took at the
entrance to the town so yes I've yes
I've been there no I've never to my
knowledge I don't have any Icelandic
ancestors that was it was a it was a
prank it was a Wikipedia prank I did not
do it but I know who did so some
somebody put that in Wikipedia and it
kind of became gospel for a while so
it's it's been kind of fun but no but as
far as I know there's no there's no
Icelandic blood literally running in my
veins but I have in Iceland
um let's talk about let's talk about the
language you know of choice java and
since you don't work at Google can you
describe the controversy like that that
you know happened between Oracle and
Google or when they first pick java was
there any plan on using any other
language and if in the future do you
know how would Google support java 8 or
any of the new versions of Java and what
the difference between now just can you
get into the that topic okay yeah okay
so there's a lot there um I'll see if I
still see if I can't talk about some of
ya great great question I'm probably not
going to be be able to give you a full
answer so for one thing I don't work for
Google anymore I can't tell you any sort
of official google position on you know
on java a door or anything like that um
what i can tell you is that when we were
first starting out we had thought that
we would do three different languages
that we were going to support all his
first class we were going to do
javascript java and c++ and we were
going to do kind of full fledged
application tool kits that were exposed
in all of them and our hope was that we
would be able to have you know like one
code base for that and sort of like have
multiple language bindings and the the
thought at the time was that javascript
was going to be good for like little
apps like things again you have to think
back to like 2005 when this was
happening so like widgets on the desktop
we're kind of like a thing and those you
know like there were a couple of sort of
competing kind of widget toolkits they
were all all at least mostly based on
JavaScript it seemed like you know with
like CSS the kit was starting to get to
the point where you could actually do
some pretty cool stuff you know the idea
was like okay that would be a pretty low
bar to entry
I be able to have like oh you know a lot
of interesting little s in that and then
you know then on the other end of the
spectrum people you know it's like we
were thinking like oh you know it's like
there's going to people who really want
to be like close to the metal you're
going to be doing like crazy you know
heavy duty stuff we want to give them
you know something you know a nice kind
of a nice to the metal kind of API C++
it was sort of like the natural choice
for that and then the the idea was like
okay so then there was a sort of like
vast middle like for that's like it was
bigger than a JavaScript app but like
you know you didn't want to like have to
you know go all the way to C++ Java
seemed to fit the bill for that and in
practice what happened over time it
seemed like well on the sort of like
that widget east side it was like the
the stuff that we built in Java seems
like that wasn't so bad to build the
little apps so that kind of got
de-emphasized and then on the the other
end it seemed like you know the people
who were building apps internally like
they were building perfectly good big
you know for for for the time you know
big apps in in Java and they were
working well enough and so the C++ kind
of fell by the wayside we did know that
ultimately you know we were going to
have what what ended up being called the
NDK you know for for doing native
bindings right it although you know in
kind of Android one point out we didn't
really we didn't expose that but there
were native binding bindings all along
and the assumption at least my
assumption was was certainly that at
some point that would be sort of like we
would Benton down the hatches and and
expose that as something that was a
well-supported API going forward and we
did let's see and there might have been
some other question in there and okay
dalek was designed for java in mind
right cuz cuz you guys it's not java you
know it's it's android daleks version of
java yeah well so yes so dalvik
was dalvik was designed to be a vm to
run you know code that was originally
written in the java programming language
and and of course you know because we
were taking the tactic of at the time of
taking class files and translating them
into the dalvik into dolphin executables
then that may actually made us agnostic
with respect to source code so you know
ultimately you know that that decision
meant that it was no big deal for like
the people who like wanted to use scala
or you know any of those the other
languages that targeted that targeted
class files yeah actually if I can
answer that were there any serious sort
of thoughts about people actually using
or enabling other languages or
encouraging other languages retargeting
dalvik well I I always liked the idea of
people using other languages and so you
know I said it was no big deal for
people to host I Billings but as it
turns out we did have bugs in our in our
translation tools so like very actually
well you can either call it depending on
what you want call it up Oh may or may
not have been a bug so uh how about this
let's just let's just say I was
surprised by what it turned what the
what the class file format ended up
actually allowing as valid in certain
cases so uh so in particular the Scala
compiler produced by code which was kind
of surprising at times so I got a number
of a number of really interesting bugs
from from people who work in Scala where
they're perfectly rational skala code
turned into something that would not get
successfully translated into a text file
and it caused me you know a couple days
of head-scratching here and there to to
get it all sorted out
right so um I know this isn't exactly in
your line but when did binder show up
and how did that work you're right
that's not my line um so binder binder
was around fairly early on the so did
actually so I'll ask another question so
do people know what binder is in general
no okay so binder is kind of like the
underlying thing for doing IPC on
Android and it's it kind of hooks its
kind of straddles the border between
kernel space adduser space so originally
the the binder was a bunch of code that
was written at palm and among the people
who ended up getting hired on on the
Android team fairly early on were a few
folks from palm including some of the
original binder authors at Palm at Palm
they had ended up kind of saving that
code by open sourcing it so that it
wouldn't sort of kind of get sucked into
wherever palm got palm ended up anyway
so um so binder binder sort of had this
kind of like you know saving throw and
and landed both code and personnel on
the Android team as the you know at you
know early on it was the proposed
solution for doing for doing IPC and
ended up being the actual solution
actual shipping solution for IPC on
Android but I think that's about as high
fidelity and sr as I can give you thank
you
not to bring up any painful memories but
do you have any thoughts or anecdotes on
on the 64k method limit no it's not that
painful so I'll start with the most
general hindsight is 2020 and no matter
what you do there's always going to be
something that surprises you later right
so you know so I didn't expect that that
limit would ever turn out to be
something that was as painful as it
turned out to be at the same time I'll
say before I left before i left google i
was actually in the process of revving
the format to so that I you know a
subsequent you know version of decks
would be able to you know it would have
been a 32 bit limited instead of a
16-bit limit that for whatever reason
that work did not end up or at least
apparently did not end up continuing
after I left but that said I think you
know from the perspective of 2005 doing
this doing this format you know from
scratch I think it was a reasonable
decision I don't think I don't think you
could fault me for having made the
decision but you can fault you know like
you know you can even say it's like yes
it's caused you pain in the meantime but
you know you know the the again going
back to looking like what the
constraints were like you know if you're
if you're looking at a world where you
know you're only going to have 64 Meg's
for the entire system fathoming that a
single Dex file would be larger than you
know large enough to blow that kind of
that kind of limit just didn't you know
it just didn't seem that likely and you
know it lasted for a while um no the
limit that did end up getting blown
first was the the number of strings and
we did but and by we I mean I did
address that in in an update so you know
there's there's actually if you if you
have more than 64,000 or you know 64k
worth of strings then that's not a
that's not a problem index files today
and that's exactly because we did add
some extra bits to the format what sort
of trade-offs would have happened if you
had decided to make that whatever
represents those methods 16 bits as
opposed to 32 bits fun question right so
so why do we end up there um so I
encourage you to look at the Dex file
format doc so you can verify verify this
for yourself so one of the gym so one of
the things that I did while I was
designing the format was you know I had
the kind of the DX tool in its prototype
form right it was generating Dex files
and you know I had the opportunity to
tweak things and see how things how it
altered right so one of the things I did
a lot of was oh let's you know let's see
what happens or let's take some
statistics on you know how much space is
taken up by you know X Y or Z right so
one of the one of the ex-wives or
disease was was a method was a method
reference and the so and in one of the
statistics I could get was like how many
like how many method references were
typical in the applications that we were
seeing right so on the one hand making
so in certain places so not not in the
by code itself but in some of the side
structures there is you know there's a a
fixed width field for for method for
like for a method reference so that's
something that there wasn't going to be
an opportunity to have it be stretchy so
it's like
if the limit were 32 bits then it would
be like a 16-bit convergence 68 would be
a 30 it would be a 16-bit hit on every
single one of them whether or not there
were more in the in the fire on right so
what I had to do to pick I was like okay
so it's like if I if like I made that
change it's like so how much larger were
the Dex file is going to be compared
compared you know to not having it and
you know the marching or kind of the
general marching order from above was
basically make these things as small as
possible and of course you know it's
like well if you make them zero size
they're not doing anything right so
right so you know so like yeah so it's
really you know you have to you have to
sort of like parse what's coming in from
above right so the real you know the
real thing is like make it make it small
but don't make it not useful all right
um so um you know in this case what you
know the kinds of things i observed were
like you know typical applications
didn't seem to be getting anywhere near
the limit even our libraries right which
were like the biggest things you know
the biggest decks files on the planet
were things like you know the core you
know the core library so you know like
well the javadoc whatever's and the
framework libraries you know android dot
whatever is right so those are the
biggest text files on the planet and
those weren't really even approaching
the limit so it seemed like 16 bits
maybe not such a bad idea right but uh
and then I think there was one final
thing which was a again like look at
look at the look at the speck you'll see
in one of those fixed with fields or you
know like for like 4 method method
references like coming off of like the
class structure something like that
you'll see that like the width of those
things is a it's like a like 32 bytes or
something like that which is a nice
power of 2 and so it's like you know if
I if something were made wider than that
it would no longer be a power of 2 it
would have been
a you know like a more complicated a
couple more cycles calculation in the in
the dispatch code for that particular
thing and so that you know that kind of
decision or that kind of fact goes it to
play into making that kind of decision
as you said hindsight is 2020 can you
talk about some of the things that later
on you sewing the dalvik development has
as things that could have gone
differently or should have it gone
differently um well what what could have
I mean yet so overall I can't say I have
too many complaints with sort of like
how how things have progressed really I
think the thing that I would say is that
there were sort of developments that I
would have wanted to to have happen on
the kind of at the vm level sooner
rather than later so like you know after
immediately after you know 10 was out
the door the thing that I wanted to do
like like almost one of my biggest
ticket items was to was to do a major
rev on the alligator in the GC and I
didn't actually get to happen for about
a year you know I knew that the having
some kind of jit would be a good thing I
would have loved to that to have
happened you know you know sooner rather
than later that's it's like really like
my my complaints if anything or sort of
like more like sort of speed and speed
and sequencing and not like the actual
sort of like a followed by be followed
by C not getting yourself into legal
trouble you tell us a little bit about
that maybe the thought process that went
into even deciding to build dalvik as
opposed to go with Java standard Java or
even Java ME 400 um yeah and I don't
think there's no there's no legal
problem
with a you know I think you can tell
from what I've been saying it's like
that it was all it was all technically
motivated there's like you've see people
in the press say like oh they only did
it because you know they were afraid of
blah blah blah blah but that's that's
it's not true it's like you know if what
you want is to be able to memory map
your executables across processes and
not have that uses a lot of memory it's
like you can't just use playing class
files it's like let's start the end of
it if you want to have an interpreter
and you want to minimize the number of
you know like you want to make it as
efficient an interpreter as possible
well you want to do something other than
have a stack-based machine that has
instructions that are bite aligned it's
like you know and i think you know
people's analysis of both dalvik in
specific and sort of like that general
area I think bears that out in fact the
the there were there was like a paper
from i think it was like an academic
paper from like two thousand four or
five or maybe even two thousand three
which was like it was caught it was
called something like the case for
register machines and it was like it was
an academic group that had taken java
bytecode and had built a register
machine translation of it and they had
done kind of a bee comparisons and they
they're like hey look this seems to work
it's like that was that was sort of like
prime that was one of like the primary
sources for my decision-making process
just adding to that because i used to
write I've ever in Java ME code because
you know Java use Java runs on low
memory devices right like it it runs on
nowadays it runs on Raspberry Pi Java 8
you know but it it has been running on
low memory devices for yours and just
fine so was was there a different reason
or is just a memory so you have to take
running just fine with a grain of salt
so Java ME was a was very stripped down
in many ways compared to kind of a
full-fledged sort of you know the kind
of a full fledge java SE style
deployment right so and i just too just
so you know like at danger to date the
danger application code was also based
on java we and we we built we again
where we is kind of mostly me and call
it half me up built a Java ME
compatibility as a thing on on top of
danger and if you take a look at like
the kinds of things that Emmy provided
it was actually it fairly can fairly
constrained so yes you know you could
see it running just fine but just fine
is not like being able to run kind of
larger applications it was I don't know
if you looked at like the kind of like
allocation performance that you saw on
those like GC pauses were pretty awful
there was actually a lot of
inconsistencies and any implementations
I see it some somebody has been in that
trench ok so for you i'm going to tell
you a little story about about danger or
about about this particular aspect so
one of the so you know one of the things
that again that we're doing in danger
was building this Emmy compatibility the
idea was that you know we would be able
to to host any style apps on danger not
not that there were that many of them
but um we we ran into in the port in the
process of like trying to get some of
these onto ultrafone we saw this like
weird behavior so there's in in the Java
API is there's a static method system GC
and you call system GC and supposed to
perform garbage collection right and
well guess what you perform garbage
collection in a stop the world situate
it's going to stop the world right and
it's going to take some time so we saw
this this application which was like on
every frame of animation was calling
system GC I was like why in the world
would anyone do this because it's like
it's like pausing like crazy and you
know and it's not not getting good
performance and so you know for because
we and that was like the first of
several cases that we sought of
something like that so in the end I
ended up implementing this thing which
was like if you called system GGC more
than at like more than a certain rate we
would ignore the other calls because you
weren't doing yourself any good and so
after some time after like seeing this I
ran into a friend of mine who worked at
a company where his job was poured in
games from one phone to another and yes
because they're both Java but you still
have to do porting I said I told him
about that's like crazy things like we
saw these things were there doing sister
is oh yeah we have to do that because if
they don't do that the whole phone will
crash so anyway so that was that was
Java and me was the decision not to
build dalek davek excuse me exterminate
it to build the decision to build davek
at all versus use Java ME or java SE
what was that politically motivated
motivated by size of of what you what
the the target run time environment
wouldn't need to be this is a is this is
all before Sun got acquired by oracle
right that's right so um so what so one
of the things that I was doing at Google
on the Android team very early on was
evaluating other VMS you know for
possible use in android and among the
among the things you know among the ones
that we were talking about were some
version you know like sun sun at the
time
there wasn't yeah there wasn't just one
being you know son had like several
different products you know both oh did
you have an interesting if I can
piggyback on this so savage a had a
phone at at 11 year at javaone one year
they passed out this lovely orange phone
it didn't go anywhere so you must have
been aware of them oh yeah we get we
were I I was certainly aware of savage
they were they were worth a java SE ok i
got a nod of yes my ok so i was aware of
them in general i don't think i ever did
kind of like a direct evaluation of
their vm per se but you know so anyway
but but so let me go back to answer this
kind of the General Custer images you
know what were you know like so was that
was it a political decision was a
business decision was it it was
fundamentally we knew that the the vm
that we used had to have certain
features and whether those features came
about by acquiring something and
modifying it into shape or writing it
ourselves that was yeah that was sort of
like that was sort of the secondary
thing so the primary thing was get up vm
that had these features so to my
knowledge sons vm offerings at the time
didn't have good interpreter performance
and did not have good memory performance
in terms of running multiple
simultaneous applications in with using
using real process protection and those
were pretty primary pretty primary
things that we were we were aiming for
so like I don't I don't know this
weather the savage phone did this or not
but I I know they're there was
like son at the time there the thing
that they were talking about for doing
the equivalent of Acts separation were
these things all isolates isolates were
a tactic for running multiple a sort of
kind of running multiple VMS but in a
single address space and that would not
have been acceptable for for android you
know android took the stance of you know
we want you know like you know real
colonel processes are kind of tried and
true way of having good kind of good
intra device security and there's like
that was her like everything else kind
of flowed from that so that's why you
know for example it was no big deal for
us to have native code because you know
in the it's kind of in the old Java
model it's like oh well you can't have
native code because I'll then you can
like break the security model but we
don't care about the Java security model
because that's you know that's all sort
of in the sink within a single app you
know cross app is what mattered and for
us that became cross process so the
Android SDK seems to have a lot of
decisions made on it that are based on
some of the best practices for dalvik
applications was that a back-and-forth
or was it always just the way dalvik was
designed and then they just built the
support classes based on that well um
I'm not sure I can give you a great high
fidelity answer I mean a lot of a lot of
the development of I guess the early
development of the SDK was you know
anything there was a lot early
discussion look I mean one thing that
comes in comes to mind is like how do
you use a new more not like that's sort
of like the thing that people like to
bicker about one way or the other and I
I think it was kind of I would call a
fairly organic process you know
certainly before all the hatches had
been betand down
before Android 10 like it's like you
know we had an opportunity to changing
so people you know if people happens to
be doing one kind of idiom or another
like there we did have an opportunity to
kind of like adjust for that at the same
time you know we certainly had from a vm
teen perspective we had recommendations
about about things but i don't think i
don't think there wasn't it wasn't like
a one-way information flow i think
further organic of the thing that I
don't know is again I'm a few years out
of date i'm not sure if there's
something that's sort of happened in
more recently that you're thinking about
but if there is like couldn't really
tell you can you actually just elaborate
on the whole genome thing nada enums
themselves but there's a lot of sort of
performance versus good design i delay
in the early days a lot of things we're
done in the in the name of performance
was there any effort sort of to to speed
things up beyond just the the JIT to
make it easier to sort of adopt standard
Java best practices and apply them on
Android I just speed up basically that
transition to speed up basically be able
to use standard Java best practices
right right like be able to use a pneum
so whether it's unions or proper
encapsulation things of that nature I'd
like not to use publix everywhere you
know things that sort of developers are
used to from outside of the Android
world um I mean I so the way the way I
would think about it is more like over
time the you know again Moore's law
takes effect right you can start to do
in the so I mean two things haven't one
is just sort of without doing anything
that you know your code you know you
know it's like your code is more memory
to to to use to play with and it runs on
a faster cpu and stuff like that um so
um that alone means that there's there
are things that you can do without
worrying about how long they'll take
that you didn't used to be able to do
before but then at the same time you
know eventually the you know like when
we find
I got to have a jit out there well that
also that changes the game again right
so there's things that again would have
been too slow that have you know like
wherever that line is it's sort of like
moved in one way or the other depending
on how you want to say I don't think
that I certainly never thought about it
as sort of it like if this explicitly as
explicitly about enabling standard Java
idioms but sort of like as kind of like
the inevitable effect of it is that you
know the things that people like doing
end up being more call it more
performance Lee palatable over time
hello um thanks for tonight's
conversation has been very informative
um simple question is what phone do you
carry right now and why ah fine question
so I'm carrying a Moto X so it's not
well I guess they just announced one
right so I think think it's the
currently released of the not ginormous
one but with with 64 megs of flash and
the reason so let me tell you what I
upgraded from and we put it back my we
put back in my pocket first I upgraded
from a Galaxy Nexus I don't know if you
all remember that one that was the Nexus
device from Mike 2011 something like
that from 2011 Christmas season so so I
went I went straight from a 2011 mintage
phone to a kind of like late 2014 ish
whatever no mid-2014 vintage one and so
so why I hate configuring devices so I
use that Galaxy Nexus until it was like
on its knees because it's such a pain in
the butt to to like when you switch
phones up so and then
so I and I pick try pick because my aim
was to get something that was kind of
about as high end as you could get so
that would be as long as possible before
I have to get another one oh yeah sorry
oh hi again so you've not been working
on dalvik for now a couple of years can
you say what you've been doing since
then sure and what would it what would I
pick today by the way through all three
is just like a bit he showed up like so
what would I picked it like I got this
one recently enough that it's like it's
kind of it feels to me like the one I
would pick today um so I know I know
there's like I get a newer Moto X it's
if it's as good as this one maybe that
would would be what I pick anyway so
what am I what have I been doing in the
in the meantime um after I left Google I
joined a company which at the time was
called the obvious corporation but is
now called medium medium is a company
that's doing kind of another take on
publishing on the web was founded by a
couple of Twitter early people including
Twitter co-founders volumes in bid stone
and this other guy Jason Goldman who was
very early at Twitter I was there for a
little over a year I helped get well so
when I first joined that medium wasn't
even kind of active idea so I was sort
of like helped figure out what it was
that the company was going to do it do
it all and then eventually I ended up in
a role which is kind of familiar to me
but not what I normally do which is
basically DevOps so I was kind of like
the first dev ops guy at at medium I
have helped get the continuous
deployment system kind of up and running
and sort of set set that kind of going
up and I parted on good terms you know
so the deal was that as the company kind
found its focus with you know as a call
as a shareholder I like really liked the
the focus of the company but as an
individual contributor I was sort of
like left without a great fit for kind
of my interests and skill set so like
the DevOps toughest stuff I I know how
to do and I don't mind doing but it's
not that's like not what I devote my
life to and there there are people who
are like way better at that than I am
and I was really happy to find somebody
to replace me who was again like like
that's what stuff that he does and he
was like you know does ended up being
able to do it way better again way
better than I could so I found my
replacement and then I made a graceful
exit from that company and then I went
to a company called next bit next bit is
has a little bit of a kind of news cycle
going on they announced that they're
making a new phone and they've been
teasing about it over the last couple
weeks I so I was there for a couple of
years and a lot of so and they've been
really busy since I left so I'm and as
I'm no longer in sorry I'm still I'm
looking and very much looking forward to
seeing kind of what they're going to
come out with but I know that that you
know like I was talking about like oh I
hate switching from the stuff like that
well part of the kind of part of the
underlying tension that next bit was
sort of like founded to help out with
was that kind of tension that's why
that's why I went there so I'm
particularly excited so maybe the next
phone mega is going to be a next bit
phone and so that I did that for I
worked there for a couple years and for
the last several months since februari
I've been trying to start a new company
so right now it's just me and a business
development kind of guy we don't have
any code yet but we do have we do have
an idea that we're working on and
everybody else got up here said it
to say to so if you're looking to do
some very interesting application
platform development work and that's the
kind of thing they get that gets you off
maybe you should talk to me anyway and
I'll leave it at that so so dalvik was
released under it was really something
open sore Apache open source license can
you speak to like the decision to do
that was that like a combination of
personal preference team preference
Android before and after Google Google
you know like where did that come down
and how did that interplay with other
open source releases internally um the
uh let's see so you know I don't know
about Google in general for sure but I
do know that apache the Patrick to
license was something that was decided
to be like the license for the default
license for all of Android and that was
a decision that was made pretty early on
so the you know dalvik getting getting
released on it was not like a Dalek team
decision explicitly it was more like the
default decision right so there's there
were other so there's some stuff that
came out of the Android team that has
other licenses those are always kind of
more like exception so like the kernel
code was done under the usual linux
kernel license which is like was it like
GPL to but not going forward right you
know it's like they have their standards
they have their standard license for so
kind of the decision for that was you
know sort of like be compatible with the
stuff that that already existing open
source ecosystem and I think that was
really you know that's kind of the
beginning and the end of his or like
Apache too unless there's a good reason
not to and there are a couple places
where there was a good reason not to but
for forgot there was never a compelling
reason to pick anything else concerning
the the art vm now do you have any
thoughts either likes or dislikes
regarding the design decisions that are
in our succeeding um the i think
the general idea of what art is trying
to do is as absolutely the right the
right thing to do again I'll go back to
you know as the sort of the shape of the
underlying technology changes the design
decisions change right so with original
android you know there was particular
constraints on the amount of flash space
the you know the CPU of the amount of
RAM you know when we had the opportunity
to to start doing compilation well so
you know what's you know okay what's
interesting about jit as a compilation
tactic it means that you're not wasting
or wasting your not using flash space to
store compiled executables you're doing
it on the fly and and so the downside is
it means it takes time while you're
running the upside is that you're not
using flash space and just to be clear
if you look at compiled output like
machine code output compared to buy code
you know like that there's you generally
an expansion that can be measured in
like order of magnitude kind of so you
know I so like seven X is kind of
typical I don't I don't actually know
what the what the kind of bloke factor
is for for art but it's like I would be
surprised if it wasn't kind of in that
zone so um you know what you know one
thing that happened in again in that
intervening time is like flash space has
gotten a lot bigger and so what that
means is that it makes more sense to use
some of that sweat flash space as a
trade-off for you know time taken at you
know when you're actually you know say
actively running a nap so and then of
course what that means is yep you have
to do the compilation sometime and so
the natural point for that on Android is
effectively it's like at install time or
at you know oh it's not great time when
you have new libraries to link against
so as a kind of general shape of things
i think you know art was kind of the
right move
we have time for one last question I you
guys both have spent multiple questions
where as you learn so sorry Rick maybe
we can do more so I know there are lots
of questions began stones take off about
this question and lots of blogs out
there but being the developer of that
week yourself are there any tips or
tricks that you might know specific that
should be kept in mind while developing
android apps for just getting better
performance or there in 10 performance
so I am again I'm a few years out of
date so the so the thing to remember is
that every it's like with every change
of technology it's like the the
trade-offs are going to change and so
that's what like when saw was talking
about like oh you looks like are you
doing something to make it very you know
easier to do the kind of like the
standard idioms and it's like yes but
not intentionally right so so you know
one of the you know one of the things
that that you that has happened now is
that with you know with art you can
count on you can count on things being
already be having been compiled by the
time you're running and that may change
your you know the decision of like if
you're of how you're going to write some
some piece of code offhand I don't I
don't have like some like magic magic
bullet like you know like recommendation
but actually here to the extent that I
have like a universally a universal
recommendation is use a profiler
really you know I've been I've been in
this industry for multiple decades so
this is not going to be an appeal to
authority it's going to be an appeal to
stupidity so I've been you know I should
I should know we're like the hot spots
and Cody are gonna be it's like no
they're never there never where you
expect them to be it's like you always
think i like my god it's like I've hats
out that's tight inner loop is like it's
going to be doing it's not going to be
that it's going to be like that thing
that you didn't think about like you
know five files over that's going to be
your hot spot and then you're going to
like pull out like I don't know like
cosine and then it's going to turn out
that like that's the thing that makes it
running from running like a minute per
frame to like a millisecond per frame so
maybe I'll make an exception give you
guys a chance but if you make him quick
okay same goes for the answer thanks
Sasha yeah what's your take on the
future of Android so we've heard about
the history do you think there's a new
how long will Android dominate you know
google announced this year forget the
name of the project its Android
willpower Internet of Things devices
what do you think the like there are
other operating systems trying to you
know eat android and iOS market share
how long do you think android will
dominate for android developers ligand
and they are now so many devices that
especially that don't support google
play services in china or we have to
support you know amazon's devices so
what's your take on all of that I wish I
knew you know I'm you know uh you know I
think you know a temi and you know any
technology seems to have you know some
kind of natural curve to it and you know
if even the people who like paid to like
make those predictions like they they
never know right it's like are we it's
like are we still on the ramping up
period
bell curve i really like the bottom part
you know it's like that's the thing is
like you know it's like you look at you
look at like the daily graph that looks
like it's like going up into the right
and like you can't really tell right um
so um I have no idea I i would guess you
know androids got a good few years left
in it um so uh but but really I don't
know um there's a I'll tell you there's
a great whatever a great philosophical
thing called the Copernican principle
it's both really deep and really useless
but it's i like i like to think of it
think of it as more on the deep side the
one of the versions is given it's like
if you don't have any other information
on something that takes some that that
will be happening over some some period
of time there's a ninety-five percent
chance that you are in the middle
ninety-five percent of it so you can you
can use this to kind of put make
predictions about the longevity of
anything so it's like so how long it's
like you know how long has the United
States been a country it's like okay
well is founded in 1776 and it's still
going so it's like you know with a
ninety-five percent confidence level you
can know that it's going to last between
I don't know what the numbers are
because I don't do that good math and I
hit but up it's like you know it's like
maybe it's gonna last you know like you
know 100 more ears or made he's gonna
last a thousand years but you can know
that it's like yeah that's in the in the
zone and you'll see if you look it up
you'll find at least one or two articles
about it where they'll wear one of them
is like some guy some guy figured out
like the popularity of movies based on
like the first day of sales and it was
like surprisingly accurate anyway so so
uh android had its first it's kind of
like first technology or at least in
2007 it still seems to be going strong
yeah use the compartment use the
Copernican principle and figured out
I think that answers your question with
that thank you thanks then yeah thank
you for having me</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>