<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visualizing PostgreSQL Data with the Google Web Toolkit | Coder Coacher - Coaching Coders</title><meta content="Visualizing PostgreSQL Data with the Google Web Toolkit - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visualizing PostgreSQL Data with the Google Web Toolkit</b></h2><h5 class="post__date">2011-11-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6odpzF0-J18" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what we'll talk about is what is the
Google web toolkit really going to
concentrate on an extension to the
Google web toolkit they're charting
tools then we'll look at some of the
code and then if the the demo gods are
behaving I'm gonna do a live demo which
actually has to go over the internet and
everything so it's we'll keep our
fingers crossed
what is it according to Google their
mission is to radically improve the web
of experience for users and developers
using Ajax I started using Google web
toolkit in the spring had a client who
was really a Java shop old-school Java
shop and they wanted to move to using
some new Ajax stuff they first wanted to
just do some simple suggestion boxes as
you're typing it pops things up but then
they wanted to do some real real-time
charts which is where I started doing
this which as I started playing with I
was like this is kind of really cool
just kind of wanted to tell everybody
about it so just a real quick history
lesson the web applications as we know
them today really started back in the
early 90s Tim berners-lee with HTML
standard style sheets back in the day
moved on to doing CGI forms JavaScript
right but it was everything was still
relatively static where you had a single
form you hit a button and you'd post
back to the server you process the
requests on the server to come back and
you just you know back-and-forth
communication and you'd be constantly
reloading the page everything was really
static on the web side are on the
client-side where you had this basic
HTML you could do the view source you
could see everything that's going on it
was all kind of cool if you actually
want to learn HTML but that people
wanted to start doing more and more
things so flash came on the scene gave
you a lot more options for doing
interaction interactive web development
but the downside of doing all that is
you had to get this flash plug-in which
now with Apple and everything saying no
we want to go to html5 and everything
it's you know it is a downside of having
that plug-in which is where Ajax came
into play of being able to do the
asynchronous JavaScript and XML this
allowed even though the technologies
been there it just kind of came together
and you know five six years ago where
people really started using Ajax to be
able to do real-time updates to the
content on your web page without having
to reload the entire page it's seems
like a simple concept now but when we
first started seeing everybody doing it
five six years ago I was like oh that's
pretty cool where you just see this one
piece start updating based on what
you're doing on the rest of the screen
so it gave it a completely different
paradigm of having your signal form and
when you're doing pushing a button on
one part of the page it'll go off or
synchronously call the backend server
get the response back and not have to
repaint the entire form saved a lot on
your your bandwidth and just gave a
better overall experience to the user
which is where the Google web toolkit
came into play is the guy as I was
learning more and more about it I was
like oh this is really cool but then
Google gives you an easy way of doing it
it gives you the rich interfaces in
order to be able to create although
everything's through widgets and panels
you do get all the asynchronous
communication without you having to
build all the JavaScript by hand and
being able to process it on the
server-side and handling all that
communication back and forth it does
everything through standards so this way
if you want to pop something else in
it's fairly easy to do and at least for
me everything is done in Java Java guy
and a C guy and no job of pretty well
and my client was a Java shop so it made
it very simple in order to bring that in
a lot of the things you could do with
the Google web toolkit specifically
around the charting tools even if you
got PHP or Ruby inside your shop you
could still do that through pure
JavaScript but what we'll talk about
today is just doing Java
that's what I know best and what the
Google web toolkit gives you is really a
bunch of widgets in order to be able to
build your pages it gives you static
widgets that you put inside of different
panels so you have a group of static
widgets or your labels your images these
are all things that aren't going to
change by something the users doing you
could change it programmatically so if
your your code changes the label or
changes an image you could do that but
the user isn't doing it you have to
program it to do that then you also have
the form widgets which get the user
interaction so you have the buttons the
check boxes list boxes you get a bunch
of them so as you're building your pages
if some somebody used to be an old VB
developer or you're drawing the
different things or powerbuilder
same sort of thing of being able to draw
your different gooeys just doing it
through oh you know web page as opposed
to doing a client based application and
everything just goes into a panel those
are your containers so now to give you a
kind of a real quick overview of the
Google web toolkit no more show you the
cooler stuff that's basic UI if anybody
is a UI developer those are different
things that's common there whether it be
swing Visual Basic any of the other
stuff that was there so charting tools
is a separate add-on to the Google web
toolkit they have a number of different
add-ons and what you do is it's a
separate jar file that you load into
your project it's also known as the
visualization API there's a ton of
different charts and I'll show you a
bunch of them the downside of this
particular plug-in or ditional add-on is
you actually have to be online for it to
work which is why I need the internet
connection if because what it does it
actually makes a call to Google in order
to download a little bit
javascript it's it's open-source you
could get it but their license says you
can't make it standalone on your laptop
I don't think they'd go after me putting
it on my laptop right now for a
demonstration but you never know you
know with the different lawsuits going
on these days so your different charts
you could visualize any sort of data
that you really want with this it gives
you a bunch of different options you
have two standard
bar charts line charts pie charts
you got area charts you have the combo
charts gives you all these cool colors
you could kind of hover over them and it
gives you give you what the values are
just by they covering all that stuff's
all built in or you don't actually have
to code it it's like yeah you basically
define what the chart looks like and it
gets you all that stuff but that's you
know that you pay the price of making
that call to Google in order to get that
bit a bit of JavaScript yet scatter
point charts Candlebox
and you got the regular tables you got
some pretty cool cool ones where you
could do the geographical one so if you
want to see you know based on the the
geospatial stuff no populations or
whatever yet have that for the the
geospatial stuff you have gauges which
is essentially the simplest sharp
because it's a single value but you get
the nice speedometer effect and then
there's a bunch of other ones that
whether some of them were interactive
some some of them are the same as you
know for instance the the drink the map
map chart here that one's actually as an
image so if for whatever reason you
don't want the interactive stuff you
want to be able to display as an image
you could do that as well you know they
have that little train over there you
could have custom images in order to
create your bar charts they got it
dozens of different chart types to be
able to add to your application so
downloading it so when you get the
slides later just get it from the Google
web toolkit website and the
visualization API is also on the Google
Google site so I gave you it a little
bit of background let's look at the code
so the easiest way to get started is
inside the Google web toolkit there's a
web app creator which creates the the
scaffolding essentially for the project
itself just running it with the name of
the project and what the package is
going to be will create a full Java
project for you and the big thing that
realize is it actually splits things two
into two different categories a client
in the server because you're creating a
single web application but a lot of your
code and a lot of the logic that you're
going to build is actually going to run
on the client inside the users browser
itself so that's why you have to
separate everything so the client is
actually going to make the the remote
procedure call out to the server even
though everything is all in a single a
single project and you're writing
everything where it's all in a single
package essentially when you deploy it
using the Google web toolkit it's going
to actually separate everything out it's
going to basically turn all your Java
code into a bunch of basic HTML and
JavaScript and CSS on the client side
and then all everything on the server
side is going to run as a Java servlet
so that's why everything's kind of
separated into two different areas and
then you have your configuration file
that XML file so in order to add the
visualization API you have to you know
tell it to load it inside the config
file inside that XML file so you just
have to tell it to put the jar file in
the write Lib directory and tell it to
load the visualization API now when you
want to add the charts for the
visualization API it because it this is
one of those weird ones that actually
makes a call out to Google you have to
start up the charts in a slightly
different way you have to create it in a
separate runnable container so this is
why you're gonna be creating these
things and then you add it at the end so
what I'm going to do is create a simple
gage because it's the simplest thing to
add first you define it with a set of
options you create an option to object
you set the width the height and then
you set the
you yellow green and red numbers so
we'll go from the whole range is from 0
to 5000 and then it'll also draw the
colors on there for you now in order to
add any data to it it's really a simple
data table object we're gonna create a
single row because a gauge only has the
single single thing to worry about so
it's when you're setting a value it's a
row it's a column and then the value
those are the three numbers 0 0 0 all
right so we're gonna start to initialize
everything you know from a zero position
then we'll create the gauge and we'll
add it to a panel right because that's
the container and then after we have
that all in its own self-contained
container
no no that's going to run until you
actually bring it up and it runs on the
Google side of things right so that's
why you have to do this separate visit
realization API and you have to tell it
which packages you're going to do for
the visualization API this is the one
awkwardness of being able to deploy it
because you have to do it knowing that
you have to reach out to Google in order
to get the right JavaScript loaded on
the application if you're going to
create a regular button or anything like
that inside the Google web toolkit you
don't have to go through the weirdness
this is just for the visualization API I
think Google just wants to be a big
brother and monitor who's using their
stuff next thing you have to do is they
add a timer because everything's
asynchronous and everything's really
driven from the client if we want this
thing to be monitor everything real time
we need something to kick off an event
so you add a timer where once a second
it's going to try to get new messages
this could be some user clicking a
button it could be anything
timer is a good way to regularly for for
charting and be able to check for
updates so we'll we'll kick off a team
timer once a second and then what that
get message is what it will do is a
process the results
it makes the remote procedure call it
actually calling the grading service
which is the servlet on the server-side
and then it will process the results so
on this onsuccess method it gets back a
string that's the results everything it
with the Google of
toolkit as you're talking between
client/server is a strain it's all XML
and the results that's coming back is
the return value of the remote procedure
call you know what I'll do is I'll split
that because I'm actually sending back
to results so using the Java split
string method there I'll take that
result and actually split it into a
string array so because I'm going to get
back to values I'm going to be putting
in two gauges and I'll get back the
values for the withdrawals from the
result the first first value there and
in order to repaint that that gauge what
you have to do you have to get the
instance at that gauge and you have to
create a new data table with the new
value of a withdrawal so it's still zero
zero which because it's a first row in
row column and then we have the new
value of withdrawals and then we just
have to repaint that or redraw the that
gauge so this way everything is updated
you know so you get the nice nice effect
of that gauge moving on the server side
this is a servlet that's running
completely on the server this is where
we're going to be interacting with
Postgres it's fairly simple where I'm
just going to use the PG bench schema
we're you know further withdrawals and
deposits is I'm just going to you know
do the average of the deltas inside the
history table over the course of time so
this way gives me a number that moves
over time don't do this if you're
actually running the doing something
like this in production because I have a
timer I'm hitting this once a second and
just for simplicity I'm creating a new
database connection every second and
then closing it down use connection
pooling right this is just for examples
only but I have to give you that warning
because I've had people kind of copy and
paste my code and say hey why do i all
of a sudden have all these connections
on a database and my database is going
slow don't do that
I just wanted to demonstrate that I am
actually connecting to a Postgres
database because you know it is just a
simple JDBC connection I'm executing
that query and then I'm you know in this
particular case I'm closing it don't
close it keep those connections open if
you're polling once a second
and then this is where that colon comes
into play of I'm sending back in that
return value the world draws and the
deposits it gives me a way to parse
things out on the other side when I'm
writing production production
applications generally what I do was I'm
sending back to values like this I wrap
it in a JSON string it's a nice compact
way in order to send it back in there's
libraries on both sides in order to
parse it and creates adjacent strings
it's better than just creating an
arbitrary delimiter of a colon but this
is just for for demonstration purposes
Jason works extremely well for doing
that and that's generally what I do for
what I'm writing stuff for clients so
now let's keep our fingers crossed if
the if the internet connection still up
here all right so this is what the gauge
looks like hopefully everything is still
working right so just running PG bench
I'll run a single connection and a
single transaction that moves right it's
constantly being updated as I'm doing
this right now if we run 10 connections
and say you know a thousand transactions
what PG bench does is it keeps running
random numbers around and up between 0
and 5 thousand so everything should kind
of converge around 2500 but this is
real-time update as it pg bench is
running you have everything entirely
running in HTML CSS and JavaScript
there's no flash everything's running
entirely real time and you get real-time
updates and you see the different gauges
moving over the course of time this is
why I ran this from my client they
didn't want to use flash they wanted to
have real-time updates and they wanted
to be able to show their customers
different values of their sales as
they're going along so they're all great
on different monitoring situations if
you want to monitor a Postgres and be
able to put different dashboards and
gauges up really easily the the line
graphs are pretty cool too where you see
them moving over the course of time or
the geographic ones as you change them
as you know North America gets lighter
and Europe gets darker and stuff like
that over the
course of time as different values
change it makes it very very simple in
order to be able to create the web
application on top of that without
having to use flash or you're just
essentially using Ajax and you're
writing everything in Java and if you
want to be if you have PHP or Ruby and
use these gauges
you can you can kindly do tirely do it
through JavaScript itself it's just I
didn't know that side nearly as well as
I knew the Java stuff it was a lot
simpler for me to do so thank you demo
gods it did work thanks guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>