<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Systems &amp; Configuration Management Tools with SaltStack | Coder Coacher - Coaching Coders</title><meta content="Systems &amp; Configuration Management Tools with SaltStack - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Systems &amp; Configuration Management Tools with SaltStack</b></h2><h5 class="post__date">2013-07-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yphLKSjnSU8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
now who here as has heard of salt before
okay that's good we're running on about
sixty eight percent who here has used
salt before or at least played around
with it oh good land that's lower who
here has used or is using salt in a on a
regular basis who's actually using it on
systems excellent then I know you are
Lexi and I know chris is back there he's
been doing it since well since before it
ever even kind of worked okay all right
that helps me know where I'm coming from
and also reveals that some of the
content in my presentation is
inappropriate for the audience but we'll
see we can do all right now let me
explain what what what salt is where it
came from kind of this kind of
overarching idea because we're we're
most commonly chucked inside of the
configuration management basket or you
say well salts like these other guys who
are configuration management tools
hooray we're not the reality is is that
assault is a radically different design
from configuration management tools and
that the foundation of salt and what
most what I'm going to be talking you
guys about today has to do the fact that
salt is about communication and enabling
communication inside of an
infrastructure what this means at the
end of the day is that you're able to
run on live data and you're able to make
very dynamic decisions and do some
really crazy stuff inside of salt and
some really powerful stuff inside of
salt when it comes to managing your
infrastructure and with that said salt
is still ridiculously easy to get up and
going
it's made to be as easy as I've been
able to come up with so far we're
actually running we're actually working
on some modes to make it easier now the
history of salt I started writing it in
my basement in February of 2011 before
that I was working on a problem that I
was obsessed with and that was the idea
that I wanted to be able to query
generic information from hundreds or
thousands or tens of thousands of
systems in parallel and get it back at
ridiculous speeds meaning in a few
seconds so i could make decisions based
on what's going on in infrastructure in
real time i started working on this
problem in college and I failed and I
worked on it for the u.s. government and
it worked a little better but in the end
I think I failed until I figured out how
to pull it off with salt so the core
idea beyond salt is to send a command
out and allow lots of systems to return
in parallel information now the
fantastic thing that happens on top of
this concept is that it facilitates a
really interesting communication bus
that allows you to start doing some well
really incredible things inside of an
infrastructure so I'm going to talk
about now the goals of salt are to
continue being and becoming and easier
to use more powerful faster and more
flexible management platform salt is run
by my company salts tank incorporated
we've been around for almost a year now
and we're doing well we're funded we
have lots of customers and things are
moving up so we're not going anywhere ok
now the vision of salt as infrastructure
management and beyond this core idea of
high-speed communication is that is this
idea of state and flow and that if you
can control the state of your
infrastructure that it is in then that's
one one side of the coin and the other
side is controlling the manipulation
data gathering of an infrastructure and
that bringing those together enables you
to do anything that you need to do at
least that's the goal anything that you
need to do to manage any type of
infrastructure that you're dealing with
okay and what this really hinges on is
this concept of being able to get live
data from your infrastructure and run on
it one thing that's really cool about
assault is that it doesn't require any
database backends it doesn't require any
third-party message queuing software
doesn't require any search systems or
anything of that nature you set it up
it's all self-contained and it goes okay
I know I've said that like eight times
that went on top I'm sorry i'm not the
best slide maker now salt therefore is a
communication system that abstracts lots
of building blocks for creating an
infrastructure and by building blocks I
mean you've gotten components that you
can use and insert into your
infrastructure to solve your problems
because believe it or not other people
have those problems too and we've talked
to them and give them tools to solve
them and so it's building blocks the
state and flow idea are just these core
building blocks that we put more
concepts on top of the other cool thing
about salt is that you might look at it
and think well that looks big and
complicated because it does all of these
crazy things or rather has all these
crazy components in it but remember that
nothing inside of salt turns on until
you start using it so you don't have a
bunch of bloated stuff happening in the
background okay finally salt has been
made from the ground up to be massively
scalable the core concepts of how salt
works because it's it's all asynchronous
networking it uses internal queuing
systems it's made to be able to handle
large infrastructures and we've got
large infrastructure is using us
LinkedIn's infrastructure is a fantastic
we've got a lot of hosting providers who
are using us to manage many many
deployments in the tens and tens of
thousands of systems we're working with
a view customers right now who are
actually setting up salt in environments
with hundreds of thousands of systems
okay so the great thing there is that
you're able to start and say okay I'm
going to start with salt it's not going
to be a pain to get going with it's got
a very shallow initial learning curve
you can get going quickly but you have
the assurance that it's going to hold up
to the scale that you need it to that
what you're learning in what you're
applying early on is going to be able to
keep carrying you through the process of
growing and infrastructure which is
generally what we want the companies
were building infrastructures to be
doing right it's always better to be
working for someone who needs more juice
than someone who keeps meeting less okay
so I don't have a lot of new you usually
I pause constantly and ask four
questions but there's only like 45
minutes here yes salt competes in the
configuration management space with
tools like puppet chef and salt also
competes in the remote execution
orchestration spaces with tools like
fabric from a very high level we've got
guys who are using salt to replace well
some other kind of crazy things i'll
mention some of that okay so one of the
first things i want to talk about here
are some of the communication topologies
that exists inside of salt they can be
used to do things like build out to
massive scale work with multiple data
centers build out high availability
interface with databases and things like
that before we dive into the
configuration management component of
salt into a little more depth so the
first thing that I want to talk about is
concept of data living in an
infrastructure so there's an old concept
out there wow that gets cut off
these say things okay there's an old
concept out there of a cmdb who in here
deals with a cmdb wow we're like in
California this is cool it's not like
back east okay let's see the idea of a
cmdb is that there's a database
somewhere that has information about
your information about your
infrastructure and most people have
talked to don't like them and so one of
the one of the benefits of salt is that
you're able to take information about
your infrastructure and let it live on
your infrastructure which makes your
infrastructure kind of self aware of
what's going on all of your servers are
able to come back and instantly report
and say this is who I am this is what I
have we can insert data directly into
the into the servers in your
infrastructure so that they can be
reporting back what roles they have they
automatically detect all of the hardware
specifications etc and this can be
instantly reported on or targeted okay
so data management is a big piece of
what salt is now there's a mine there
and these actually say grains and data
how this works is a assault has a
systematic called grains what grains do
is that there's static pieces of
information about their about the
systems that you're managing and so
these grains by default it auto
populates with a bunch of properties
about that underlying system and they're
all static properties so a prompt it
populates these static properties about
your system so you don't have to run
executions to wreak weary them and then
holds onto them in the context of what
we call the minion the client in salt is
called a minion I mean because one
that's a great name
but but more more specifically the
reason that we call it a minion is
because it's uh it's something that you
give a brief command to and then it goes
out and does the work for you which is
you know hopefully what a minion would
be doing if you had them okay so out
inside of the salt minions it says
there's grains right there and that can
be used to statically set information
about the systems and categorize the
systems as well okay and so it's going
to auto populate with what operating
system it is what operating system
family it is the cpu cpu architecture
the pythonpath how much ram is a-- you
know adds stuff but then you can set
values in there so you can set grains
that say this server is filling these
five rolls or these two rolls for
instance there's an yes oh sorry that
wasn't a hand that was adjusting a
camera sorry your your hand is now
invalid no all right now the other Block
in there that you cannot see because of
X 11 says data salt manages assault is
able to manage number of data backends
directly on the minions so if you wanted
to we've run into a couple corporations
not a ton but a number of corporations
where they wanted to be able to store
really big chunks of information out in
their infrastructure about those servers
so like a warm warranty information or
stuff like that we basically we got a
bucket for that yes your hand is valid
using the Python path as it is realized
by the sole minion okay thank you
pan okay or song can be used to
integrate with any existing cmdb or
database or data whatever or interface
okay inside of salt it's all about data
management and data modeling and so the
basic architecture of salt is that
you've got a master server out here and
you've got it and it's got his minions
that are doing its bidding and that
master is holding all of the data
relative to how those minions should
should behave okay now since it boils
down to just data we don't care where
that data comes from and so let me make
it a little more succinct from a
perspective of configuration management
salts configuration management system is
entirely data-driven and all data inside
of salt ends up being reduced to JSON
serializable objects which is basically
dictionaries it's a Python group i can
just need dictionaries i don't have to
like say we're her shmoops okay they're
basically dictionaries lists strings
integers bullion's right okay that means
that it's extremely easy to make this
data malleable so I'm going to run some
commands on a command line and keep it
on the top of the screen I'll be pushing
control L a lot that's how you do that
but but all of this information this
coming through salt is always simplify
it again down to these simple data
structures again very malleable and so
that means that we can generate
information in a system called pillar on
the master and have it going query and
gather information from any arbitrary
external tool and just shove it right
into the workflow now this is really
cool because you don't you go into a big
organization and they've almost always
got some database with information about
their systems they can just drop a
python file in and if we've got time
i'll show you some of these well well
definitely a time afterwards regardless
but
but if we've got time I'll show you
these Python files and you'd plop a
Python file in to write these you don't
need to know anything about the
internals of salt you don't even need to
have to inherit some class inside of
solids you just write a function and it
works ok and then it's able to bring
data in from an external source and make
it available down here it there's some
minions so I'm sorry you know I have to
trust me i will i will make these slides
available of course Oh see ya see I've
just been trumped intellectually ok
alright that that is the bottom of this
one ok so here's another concept that we
have inside of salt and this is the pure
idea now again I already apologized for
some of the audience based concepts here
so the core concept installed is you
again you've got a master it's got
minions and the master sends a command
in parallel out to those guys and then
well out to target it guys and you can
target based on anything you can dream
of really sends it out they execute on
it and then return and it's all
asynchronous which is quite nifty
because the master sends a command out
it lets go of all the connections
otherwise we can't keep up performance
wise and then it just waits for these
guys who returned the messages with and
the messages are all tagged with the job
ID so the master is able to categorize
them properly ok and they're audited and
all that jazz so you know who did what
you know who to shoot if they ran their
own command now another one of the
concepts that we've got is that
obviously the master is where we're
originating data from or original or
originating commands from
and that means that the Masters the
system that is able to go out and query
data or send command data in these
commands that it sends out is a really
vast library of routines that are all
these system management routines that
are built into salt and so you again
you've got access to do all these things
and get information back you can get
arbitrary information back about pretty
much anything that you want now a really
good example I was talking to some guys
over here and I mentioned what some
dudes in Norway are doing and I wasn't
able to finish the conversation right I
know you're excited you want here by
Norway okay these guys basically said
okay I'm going to open it up so that all
of my minions here are able to execute a
command on everybody else and get a list
of all the other systems in the
environment and just plop it into their
hosts file and they never deployed a
bunt and they never deployed an internal
dns server okay because they're able to
continually get real-time information
about what's out there now another cool
thing about this is that say we're
running on config management routines
down on this guy we can easily say okay
let's say this guy's a load balancer is
the classic example let's say this guy's
a load bouncer he needs to be aware of
everybody who's under who's out there
all the web servers who are out there to
populate his configs right well during
his config management run he can send a
command out hey running commanded so
that everybody who's supposed to be a my
configs returns and tells me sends a
bank and he configures it and those
commands are made to run incredibly fast
and so it's still low overhead and
you're able to do real-time discovery
about what's going on in your
infrastructure okay
now
now to start tying these concepts
together you know I'm looking at this
one I'm thinking this is a horrible
presentation for people who don't know
salt just horrible because here I am
saying sounds really easy but look at
the console of the space shuttle this is
one of the this is one of the most
complicated things that we do instead of
salt okay and actually a lot of guys
don't use it but it's very powerful so
we've got the salt master here and we've
got all of these events and actions that
are being fired relative to everything
that's going on out there okay and let's
say that an event happens or data is
returned and we want to react to that
data let's say that data prompts us to
say spin up more virtual machines in a
cloud somewhere self has tools that
integrates with all the major public
clouds yes that includes digital ocean I
know they're like really popular right
now but is excited about them they're in
there so let's say you get an event that
basically says our systems are
overloaded spending more VMs BAM the
reactor can do that dynamically let's
say you get an event that says something
horrible has happened in the data center
and that poor bloke is going to be there
all night the reactor could logically
order him a pizza so it's a completely
open ended system but we're able to
process events as they come back in and
react to them again one of the cool
things about this is that this is
completely turned off by default all of
these capabilities get turned on when
you just add a line to a config as soon
as you activate them they turn
themselves on otherwise they're not
using resources they're not bothering
your system at all okay you know you'd
think I'd remember control shift p after
doing that so many times now
it says minions that's the bottom
similarly we just added the the
capability to also have hybrid on
redundancy of the master historically
people have been doing the classic bit
with a VIP you know and keep alive and
all that stuff who who doesn't know what
I just said wow we have like eight
honest people in here oh I know a lot of
you guys know what that means okay but
now we have it built in so that you can
have you can have multiple active
masters controlling an infrastructure so
I guys that have been using it for a
long time get more excited about that
one now this concept here and a fine is
the concept of being able to build tears
now as I've been mentioning and alluding
to inside of salt how this works is say
we've got our salt master for these
different data centers or different
groups of servers in a data center or
maybe you want to set it up one per rack
you know however you dream you want to
set it up actually a really good example
is how universities usually have done
this so we're deployed in a number of
universities we're being used at Harvard
we're being used at Columbia we're being
used I was just out of Clemson
University a couple weeks ago talking to
those guys fantastic guys out there and
so they've got a bunch of departments
and each of their departments have their
own salt master and those saw masters
subsequently have their own minions
underneath it and they've got these
encapsulated units because it makes
sense for their organization okay well
we also have a system instead of salt
called the Syndic think syndicate where
you take one of these masters and you
put a Syndic on it that says hey I'm
willing to accept commands from a higher
level master
this allows them to say sure we've got
all of these groups of systems spread
out through that the organization but
we're able to command all of them if we
want to from a top level now this also
helps substantially with scale so we get
into a situation where we say maybe
there's 500,000 servers in an
organization which well you guys are out
here you know that happens again
California okay some of these guys we
talked to in the Midwest so I don't mean
that some of you guys are freaking
awesome just watching this online you're
great guys I'm it's all for the crowd
yeah so have three masters up here and
three masters up here yes yes the
syndics system is made to be completely
open ended so you can have multiple
masters of multiple layers you can have
crazy topologies so this master could
have its own minions and one of these in
this master could have a master with its
own minions if you really wanted to do
something insane because it's a
transparent pass through system yes yes
not you 12 people want something
different on to master want something
different
okay every request that gets that gets
processed through is tagged with a job
ID and those are guaranteed to be unique
and so those those tags then go through
and process individually now let's say
that you had two masters and for some
reason they both told the same system
two setups a different network ports no
we don't have anything that it's
checking for that we do we do say to you
please make your you got to keep your
masters in sync and have a lot of and we
do have a number of tools that help to
help you have that happen yes sorry
spoof prevention okay no no no that's
that's good okay now everything is
authenticated and encrypted the way that
this works is that you've got all these
minions out here and they're not they're
not binding to any ports locally they're
all attaching to a higher level master
they're only going to attach to a higher
level master if they've already accepted
that masters keys so the way that you
can have a bad master is that they'd
have to compromise those keys and then
convince the minions probably without
touching them to then attached to it and
yeah we've got a number of systems in
place to to handle that but basically at
the end if somebody steals your private
key the game's over anyway but even then
they would need to be interested they
would need either the intercepting
existing TCP connections to make that
happen because they can't just they
can't push out to those guys they have
to hook back in okay that's actually one
thing that we've we've had a lot of
security teams come back and say that
they really like about salt is that you
can't just arbitrarily attack the
minions because they don't have an open
port to attack okay I shouldn't say
can't there's always a way
tcp yes it's asynchronous and TCP yeah I
know hey it's it's kind of cool how it
works it's all queuing lots of threads
down in see that we call with the C
library yeah it's all zeromq under the
hood actually speaking of zeromq we we
are in the process of exploring non 0 mq
communication mediums because well why
so I loves erm q i think is fantastic
and we don't we don't run into a whole
lot of problems anymore now we
definitely did it first and then they
came out 0 a few 3.2 and things have
been a lot sunnier yeah
sorry so a command comes into a minion
and they're dependent on yes yes sorry I
have been totally forgetting to repeat
questions after I just talked to the
guys and they told me and they reminded
me so the question is and then sorry we
kind of got derailed I'll come back to
the question about why allow something
other than 0 mq for transport but the
question is can you have a minion only
can you have a minion command to be
dependent upon information gathered from
another minion okay the answer to that
is heck yes so that pier system that I
put up on the front is one of the
methods as you can use to do that we've
actually got a number of layers of those
plausible methods the pier system idea
is that the minion itself can ask about
that other system and then execute the
command based on that data coming back
and so it's all based on live hot data
now the next layer that we've got there
is something called the salt mine and
the salt mine allows the master to
passively gather data about the about
its environment so its cache data its
old data and then let minions react to
that information instead of reacting to
live events or you can use an external
database through salts returner system
if you want to turn that on which allows
you to cache information about all the
jobs that are being run in any arbitrary
external database and by any i mean not
but we don't out of the box support all
of them but you know mysql and
postgresql in a big project and then
just you just kind of hold your breath
for a postgres got to get pissed off
they're great what yeah and then they
come in like we're gonna be trumped by
this garbage okay anyway so yeah mysql
and then by default the since we have
good minus 2 i'll support there's great
post guys support because those again
they're freaking awesome and then
support for guys like MongoDB and read
us and all those guys those no SQL
databases as well okay and then it was
why okay so um the original concept
there was to allow assault to execute
without having to install minions and
this is this one thing that I'm actively
working on right now it actually works
and get head right now it's not a
version I've got a slide that briefly
discuss it later but so you can use SSH
as your communication medium tall your
systems and you never need to install
anything on those target systems so you
don't actually have to set up a master
in minions the cool thing about that
approach is that it's it makes it makes
experimenting with salt even a little
easier and the nice thing there is that
you're able to say hey you know I'm
starting up this light small
infrastructure and I'm building with
salt but I'm using ssh because I can get
it up and going a little quicker but all
the stuff that you're building is going
to be is still going to work perfectly
fine on salt with 0 mq the other reason
why we're looking at is just because
we've got a couple of we've got a couple
of big companies that want to see the
detachment from the comm layer because
they want to insert salt into some of
their existing communication frameworks
to send commands and so that it has its
management systems in there so yeah
those are the reasons
minions want to get information they
always have to go through the master is
that true yeah that's what other claim
yes yes they broke her through the
master they're not doing cross
communication from minion Dominion the
mind data lives on the master yes so
that's that's the choke point all right
any other questions about that craziness
how does data sync between minds on the
multi master system yeah I'll get you in
a second Chris I see you now all right
fine fine i'll give you a demo punk now
okay i know him i can call him a punk
sorry how's data synced between the
minds when when mine is executed on the
system's it the minions themselves
replicate that to the multiple masters
so they push it up to the individual
masters okay all right so you want a
demo ok I will completely derail into a
demo if i can find terminal here there
we go make it projector worthy that's
except buddy read that ten points for
anybody who knows who fenrir is yeah who
said that post quest for the win now
alright so assault is easy to set up now
it has a couple of external library
dependencies and and it's packaged for
all major linux distributions it also
runs on mac OS and windows okay and so
you can download the windows installer
in next next next the windows way
okay but we've also got a script called
salt bootstrap that you're able to run
that script and it's going to go and add
the right package repositories for that
system so it'll add the Ubuntu PPA we're
lad enterprise packages sorry extra
packages for enterprise linux if it's a
if it's a rail system and then
automatically coming in download
everything for you but beyond installing
it which has been again very streamlined
all you have to do to start it up
actually let me just double check that I
okay good nothing is running on here all
you have to do started the master is
either run it with obviously the init
script or the systemd call it the
upstart call or you know it used to just
be 65 in it and bsd ok call salt master
if you pass dash D it says running in
daemon mode so it does the double pig
fork you know the double paid for ok and
then the minions only need to know one
piece of information for them to
function and that is where their master
is that's it if you have multi masters
than they need to know where their
masters are okay so we go to that's
right the minions config file and we're
telling it that it's at localhost now by
default the minion looks for a master
with the DNS dns name of salt so you
just you know if you're in an internal
network plop that into your dns and
you're done ok now we've got a number of
tools also like salt cloud that is used
to bootstrap minions in cloud
environments and that insult cloud will
automatically load these values into the
minions so that it's completely
automated so that it's really easy to
just say spin up me a bunch of salt
minions and tell them where the master
is ok
so I've got a master running I'll run
this in debug mode so it'll be loud okay
we started up and it says hey we're
waiting for our key to be accepted on
the master okay no you do not need root
by default the way that you control the
cell masters to just become root on the
salt master and then you have all power
but salt has something called external
authenticate the external authentication
and the client ACL systems those allow
you to say that if somebody logs into
the salt master as a user then they have
very limited rights as to what they can
do so it says this guy can now run these
routines but only on these systems
external off is the same but it doesn't
rely on an existing UNIX user it allows
you to use any external authentication
medium so they can do it that way okay
but root gives you all power all right
it must be coming up as
localhost.localdomain because because of
the operating system i'm running now
well I clean this up i'll i'll tell you
a joke how do you know if somebody's an
arch linux user they'll tell you okay
yeah so I'm running Arch Linux which is
probably why this happened okay so I
accept the key using salt key really
straightforward we do actually have a
mode that allows you to dangerously
automatically accept any Keith that's
given to you it works really well for
military bunkers i think i think i
mentioned that i did i did use to work
for the US intelligence community and
they did have demand for surprisingly
highly insecure systems because their
security was based on the barrel of a
gun and not the network integrity okay
so now it should be in yep alright and
so what i did here is I said okay we're
going to run salt and this is your basic
communication out to a single system and
I'm going to run a function on that
system that's in the salt library now
like i mentioned salt comes with this
big library of functions okay and its
self documenting in a number of ways got
a pipe this tool s and so we can do salt
star or systolic and it's going to go
out to all those systems and it's going
to return the documentation for the
functions that are on that are available
on the systems which you are targeting
and as we go down this will see we have
things to manipulate linux ACLs for
files which always happens to be on the
top for obvious reasons managing the
aliases file archives we have some
ridiculous ly granular
shell out capabilities yes if you've got
multiple minions then it then this
particular command just merges it all
them all together okay if one of those
minions doesn't support that we've got
another function that does that okay so
yes that capabilities in there all right
so anyway we go down and we've got a lot
of things the CP module is used to
interact with salt built-in file server
I don't know did I mention this i miss
such a blur salts got a built-in
asynchronous queuing file server that
runs on top of zeromq that has been
optimized for downloading files in
parallel to tons of systems at the same
time which is why we can run concurrent
configuration management runs on well it
back at the office we tested on 10,000
systems in parallel so that we can we
confirm that we can have 10,000 systems
running config management at the same
time which is not the same as saying we
can handle 10,000 systems ok so anyway
lots of functions manipulate cron work
with daemon tools there's that data back
end I briefly talked about a bunch of
Django interaction DNS mask yes file
management rubygems those get back there
manipulating virtual machine images type
table stuff i keyed on oh yeah that's
cool anyway you can manipulate your
keyboard configuration settings inside
of Linux locate lvm yes yes you can
setup ovm don't don't be stupid
ok there's the mind getting stuff out of
the mine mounts networks partition set
up of 0 Python group pip it I know I'm
going through this quick but this is the
function name you call description they
all have examples because all of these
functions that you execute our
convenience functions that always take
that information and put it into a data
structure that can be ingested and used
by salt so all of these routines also
make up the backbone for the entire
configuration management set up which is
why you which is why we recreate the
command line and yeah I wouldn't call it
just recreating the command line as much
as putting a bunch of convenience
wrappers around allows to easily track
exactly what's going on ok anyway oh yes
I need to mention this one this one here
pkg is a great example of one of the
really cool and somewhat magical things
that's all does pkg stands for package
so you go to linux systems and they've
got packages and package managers PKG is
going to be automatically routed to the
underlying systems package manager so
you can so you can have a bunch of
minions that have red hat and slow lares
and sorry i could keep a straight face
ok redhead ubuntu debian windows
whatever ok and you can say PKG list
packages there and it's going to go to
the correct underlying package managers
normalize the data between all of those
package managers and send it back to a
completely predictable data set that you
can work with ok because this core
concept again of just gathering data is
really important you know we've also got
there is packaged install i do know some
guys who use salt and it's their way of
not
how to use package managers but yeah
packaged uninstall is automatically
going to convert down to the online
package manager now we're going to see
where is it is it not in this whatever
but yeah oh there it is install the past
package add refresh equals true to
install with the dash s why because
that's the document that's being brought
up for my minion because it's running
arch linux yes okay all right so lots
more things on packages they there you
go post grass yeah anyway it keeps going
yes there's some Ruby stuff in there if
if anybody knows Ruby better than me
okay now the next thing I'm going to
start diving into here we go is the
state system which is what configuration
management is inside of salt the state
system is invoked through these remote
execution commands okay so you run a
state Dodd I've called the wrong
commands up there you're on one of these
lower level commands okay there we go so
you're on this state dot high state
command here to say do your config
management run yes we wrote a we wrote a
pass re the question was these are all
UNIX e commands thank you sorry the
question
sorry there we go cheese post-crisis
back 2000 windows package manager the
question is easier all UNIX e do you
have the same level of support for
windows there are a few functionality
components that we haven't covered in
Windows that are covered in Linux there
are a few functionality components and
windows that don't apply to Linux we
have a package deploy software
deployment system that makes package
management on Windows work in a similar
way to unix so yes we can deploy monitor
and manage software on windows a la the
package the package system yeah and same
with file management and registry
management and a lot of other windows e
things that my windows guy takes care of
yes yeah we've got we've got support for
homebrew in there right now yeah we
haven't seen a lot of demand for
macports yet no I know okay any other
questions that I can fail to repeat into
the microphone excellent alright how am
i doing on time I got no clocks I should
have looked at my tardis when I pulled
it out what it's eight-thirty so that
one one's eyes what am I supposed to
finish
oh oh so I gotta catch a bart before 11
30 sorry yeah yeah so the question was
what what does song give you over other
existing configuration management
systems the the biggest answer to this
is that salt comes loaded with all of
this orchestration and execution stuff
as well the next big thing is like you
said it is very fast beyond that it's
all based on yamo and the configs which
I'll get into here in a second for the
configuration management system it's
ridiculously flexible as to what you can
do there and very powerful but it's also
really easy to learn and set up and run
with one of the actually one of the
biggest problems that we've run into
recently is that we're trying to build a
repository of salt formulas for the
config management system but the problem
is that people are less than interested
in contributing to them because they
come and they say well but I don't want
to download somebody else's because
they're so easy to write and we get this
over and over and over and over again
it's getting kind of old I'm I will just
make it noobs like this stuff who cares
if they're going to write their own in
two weeks we've got a bootstrap people
but yeah it's incredibly easy to use and
very fast and it's made to be very light
weight on your underlying infrastructure
and it's made to scale to ridiculous
levels ok so anyway config management
Wow que te has betrayed me like again
daddy so config management instead of
salt is called States now they're called
states because the core idea behind them
is that you use them to enforce the
state of specific units of the system
okay and then you bring it all to bring
these individual enforcement's together
to create configuration management okay
a couple of things that I should mention
there's a paw in the way I've already
talked about the fact is data-driven
again I'll give you some examples here
in a second by default salt is a
declarative configuration management
system that means that you declare the
state in which you want a system to be
in and then salt goes out and make sure
that it is in that specific state okay
some people would rather do this in an
imperative fashion which means that you
list in order what you're going to be
executing it executes them and then once
it gets to a failure it just stops okay
so assault by default is declarative but
it has the capability to run in an
imperative mode now since it is all data
driven under the hood salt comes with so
song comes with same defaults by default
you declare things in yamo it works
incredibly well the vast majority of
guys out there use yamo for everything
but it's but salt is language agnostic
meaning that you could write your own
programming language on top of salt okay
okay so I'm going to start wrapping up
here and do some really quick exam going
to do a really quick example of config
management because it's clear that i
have talked too much i know it's not
going problem my parents hate me for it
okay so something really simple here for
the config management this is installing
and starting apache okay we say apache
it's a package make sure its installed
there's a service with Apache make sure
it's running the name of the service is
httpd and make sure that package got
installed before you turn it on are you
attracting that but just saying Apache
do you have mappings and packages or
okay we've got a couple of options as to
how to do that now the default way is
that all of these yamo files are can be
templated with your python templating
language of choice the default the
defaults jinja but if you like something
else you can use something else and
inside that templating language you have
access to not only the grains on that
system which allows you to map it out
and say you know if this then this if
this then this as one one piece but you
also have access to all the all of all
of those executions in those libraries
so you can gather data about the system
that this is running on dynamically and
have that modify the system modify
what's going on as well I clearly don't
have enough time to talk about pillar
but pillar is a system that would allow
you to localize all of your package
juggling in one place and among many
other things that it does so that you
can have one place where you just have
like a template of these are the
packages i deploy
with their own right hand debian and all
this stuff in one place and then realize
it in a very succinct way in the wild so
yes okay now yeah there we go so let me
wrap up really quick we have an event
coming up I just found out we solidified
his spot in Paris to which it obviously
doesn't apply California but we have an
event coming up called the Great Salt
sprint Alexei mentioned this thank you
the Great Salt sprint is the second time
we're doing the first time we did it was
that it was located in two places at
cars comms office down in LA and at the
c7 data center in salt lake city now
it's at the soul stank office in Salt
Lake City because when we did the first
one I have an office yet but it's around
the world all of these locations are
going to be coordinated over google
hangouts we're going to be talking about
salt development we're going to have
more poll requests than i can shake a
stick at because we love poll requests
salt is one of the largest actively
developed open source projects in the
world right now last year github said we
were the eighth largest developer
community on github thank you
ok but so we've got a lot of these
locations and if you go to sprint us all
stay calm you can see where they're at i
mentioned we're trying to make more
formulas in our big formulas repository
seriously take a look at this all code
if anybody wants to stick around i'm
more than happy to show them what's all
code looks like can we get that far but
extending salt is really easy and it's
been made from the ground up to be
really easy so you don't need to learn a
lot of internal intricacies to make it
happen in conclusion I wish I could talk
to you for eight hours but i but I can't
because like some Yelp people probably
need to go home okay but knowing
conclusion salts awesome it can do
anything that a config management system
needs to do but yeah a lot of a lot of
people use it for that I wasn't able to
talk about the sorry golly how small can
you go with it was the question a lot of
people use it for that but but yeah you
can go you can go all the way down to
just a couple of machines we've got a
lot of guys who roll out a bunch of
states for just setting up a laptop you
don't need to actually set up a master
in a minyan two runs to run song you can
just plot those files on local system
and we've got a command called salt call
that runs on the minion logically and
you can say run without ever accessing a
master and it all works
no that should work just fine actually
we've got guys in the wild doing that
yes yes I like money okay now that's a
serious concern one of the one of the
biggest concerns that I have from the
perspective of of the company is that i
don't i don't want saltstack to be a
company that isn't continually trying to
solve the problems of the people using
the software and i think that going open
core for instance would substantially
cripple cripple what we're doing as a
company and i'm really excited that our
business model is filling out and people
are paying us for support we do have an
enterprise version of salt but it isn't
it isn't a version that's got more
features in it the enterprise version of
salt is along is a long-term
commercially supported version of salt
and feature development and everything
that's going on is still happening out
in the open and we're not we're not
close sourcing our UI for instance
that's under development it's all just
being tossed out there in the open
initially it's it's been exciting we've
learned that a lot of companies still
are very interested in buying enterprise
salt even though we're not basically
forcing them to do it by saying well the
only way to get some feature is to pay
us money yes Howie the question is how
easy is it to switch from puppet to salt
that depends on a lot of things how are
the politics at your organization you
know in all honesty that's hard to say
because it differs depending on the
person that's doing it you do need to
rewrite your config management in salt
we don't have like a magic puppet
assault compiler but but the feedback
that we've gotten or rather some of my
favorite quotes is when a company comes
back and says we deployed salt
it took us two weeks or a month to do
what it took us to do in the other guy
in a year and we get that a lot and the
other things that we hear from people is
they say well it took me and the man
number of days or weeks to set up one of
the other guys and it took me 10 minutes
and salt was working so it's something
that you'll have to you'll have to try
on your own I'm not going to make any
claim that it's going to be exactly 10
times easy or any garbage like that but
the feedback that we generally get is
that people don't find it difficult to
switch over yes oh no we've gotten we
sorry what was your question ok the is
anyone managing switches with salt so
we're actually in the process we have a
number of partnerships with switch
manufacturers and we're in the process
of allowing them to deploy the salt
minion directly on their switches and
that's something that's under heavy
development we do have a few guys who
are managing switches using salt within
direction and then calling them remotely
yes but that is one of that's one of our
current heavy development components yes
over here how do we go about testing ok
so the salt code base has a has an
integration has integration tests and
unit tests built into it the integration
tests can be run on your box you can
download it and just execute them
they're not going to hurt your box
unless you pass dash dash destructive
into them which is what we which is how
we test we use these this test week to
spin up virtual machines for platforms
that we target and then execute those
then execute the integration tests on
those systems that answer your question
ok yes
so the question was what ziram q errors
did we see before and what did three
point to remedy the serum cures that we
primarily saw before had to do one with
the fact that we were running a lot of
zeromq particularly on the master and
sometimes sockets would conflict with
each other where they shouldn't they
when we I mean we were properly creating
them in isolating them but they would
still have sometimes accused would
conflict and I see I'll get you and so
that was one problem that we don't see
anymore with 3.2 the big problem that we
saw with 3.2 is that it would drop
connections oh sorry before 3.2 is that
it would drop connections and 3.2 solves
that so yeah it used to be that we'd
have a minyan connected to a master and
if it was over a network that had so
much as a hiccup in it then BAM with
loose connection and we'd have what we
called minion droppings and yeah zeromq
3.2 clearly takes care of that but that
was a headache for a long time yes not
Chad so so the only the only system
where we've got minions writing to
multiple masters is on the mine and
that's actually I mean that's pretty
much the only time when a minion reports
data back it's directly to a master in
that fashion otherwise the minion is
reporting specifically to the master the
called it but yeah there's a number
there's a number of components like that
we're still building in the high
availability and the master is very very
new and there's yeah there's still some
things that we're solving their know the
state system can I can do that very
quickly because one of the things that
we do inside of salt is that it's really
easy to compartmentalize what you're
executing so you can easily say okay
we've got a new system in in the
environment and when it's done spinning
itself up
it can either well there's a number of
ways you can do this it can either be
able to send something through the pier
system when it's done to say update
everybody else's firewalls it'll only
it'll only run that specific state
routine and then there up there up in
line or you can build it in with a
reactor so there are ways inside of salt
to compartmentalize it and and slim it
down so you're only executing exactly
what you need to execute on those
systems make it as quick as possible
this does that answer your question
thank you yes so the question is what is
the tipping point between a no client
installed or SSH based system and when
salt starts becoming more highly
effective or faster it really depends on
how you're using those SSH based systems
we've had guys come back to us and say
that they prefer salt because on their
10 systems it's substantially faster
we've had one of my favorite quotes is
actually from Harvard University they
showed up they put this on google plus a
long time ago so heavens i can't find it
anymore it's even there well you know
how these work and they were managing
1,800 systems and they came back to us
and said okay it takes five seconds to
execute a command against all of these
systems with salt and that the ssh based
tool they were using in the past was
taking them 15 minutes so it's
substantially faster another one of the
arguments that people come back with and
they say well we don't need this level
of parallelization or this level of
performance when we're executing on many
systems because we just don't see people
doing it that often well we see people
doing it all the time because they can
and so really at the end of the day it
enables you to do more with your do more
with the underlying system and
admittedly that's part of the reason why
we're developing an SSH based system is
so that because it does make sense in
scenarios with with smaller numbers of
servers
who wins okay so I think that the
question is that we need to make sure
that we don't execute something until we
sure something else is finished
successfully state ah that wouldn't
involve I'm still entirely sure I'm
perfectly following you but but you can
you can execute you can inside of the
ammo call to execute an external script
and then respond to what that script
returns you can execute an extent
external script in such a way that that
script inherently gives you back the
state information oh just oh just an
only if oh yeah we've got that you just
say only if and then script location
yeah yeah how it sounds easier it's
driven from where we want to drive it
from so so salt comes with a built-in
scheduler and so you can tell the
minions that they're going to that
they're going to do it that the that way
in which they're checking in every n
number of minutes if you want to
though you tell them even yeah you tell
them to run a high state and the high
state goes to the master and says tell
me what I'm supposed to run ordering
with the next question Jesus uh-huh
occasionally becomes a problem and you
need to do something for you do other
things you do it with really
well-defined requirements but it's
cheaper you just say okay so the
question was ordering can we order state
can we order the execution of the states
yes and to a lot and you've got a lump o
options around that so every time you
run states in salt they will always
execute in the same order and and we've
been very I mean I'm not going to go
into the the execution environment
algorithm right now but they always are
in the same order the salt has a concept
of evaluation order and runtime order
evaluation order is the order in which
the it goes through and it checks them
and then it has what's called requisites
which are similar to the requiring in
puppet from where you're coming from but
we've got a couple of these requisites
that can do some pretty tricky things
but they basically say yeah we're going
to make sure that we're only going to
run after this other guy runs this other
guy was only ever going to run once and
then we're going to run based on the
information that we get back from that
guy and we've also got like the
prerequisite that allows you to say I'm
only going to run this routine if this
guy is going to run in the future and
change something so there's a lot of
constructs around that and then in our
PI dsl you can flip on an autumn Otis a
run imperative which means that it'll
just run in the order in which they're
defined in the file yes
can I talk about salt monitoring and
commands for monitoring yes we've got a
number of guys out there that are using
salt for monitoring we're working on
some more monitoring subsystems inside
of salt they take advantage of the state
system so that so they tie back into the
reactor a little more smoothly actually
trying to remember somebody just came
out with a dashboard that does that
basically does monitoring inside of salt
and so it's going out and executing
specific salt routines and then bringing
them back in this playing them on a
dashboard so I certainly wouldn't say
that we're up against zenoss right now
but there are a lot of monitoring
capabilities in there today is that what
you're looking for ok so so you're just
saying that the management is inside a
foreign network ok how in salt is set up
is that is that again the minions just
need to be able to get to the master and
the master doesn't need to be able to
get to the minions and so if you've gone
if you're able to create any way to
tunnel out to a master from an external
Network then yeah I should work just
fine yeah that's enough oh yeah oh yeah
yeah we don't care about Nance</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>