<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>WebSocket Basics with Adobe ColdFusion | Coder Coacher - Coaching Coders</title><meta content="WebSocket Basics with Adobe ColdFusion - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>WebSocket Basics with Adobe ColdFusion</b></h2><h5 class="post__date">2012-11-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ys6BGrYJhNg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so we're going to talk about cold fusion
10 and WebSocket five so today I'm just
to clarify in case anybody's wondering
my name is Alicia Dvorak you can pretend
that I'm rupesh he couldn't make it
today so I'm just going to fill in for
him I'm a solution consultant and
product evangelist for cold fusion
that's my role here at Adobe so today's
agenda we're going to talk about web
sockets in a nutshell I want to just
give you an idea of what web sockets are
if you're not familiar yet and then
we'll get into cold fusions
implementation of web socket and how
easy it is to build that functionality
within your web applications and then
we'll get into some basics and i'll show
you in four easy steps how you can
implement web socket in your
applications with using coefficients
technology basically three steps if you
just want to receive messages and then
the fourth will be sending messages from
your server and then we'll get into a
little bit more intermediate type
advanced topic on some some of the other
additional features that you can do with
web sockets after that and then I'll
show you some demos in the end so what
are WebSockets basically WebSocket is
the name of a protocol that was
introduced with html5 it gives you
bi-directional full-duplex communication
between a tcp and established tcp of
connection this connection is permanent
so it's a little bit different from the
HTTP protocol in that in that way it's
designed specifically for rich Internet
applications and it works basically it's
supported on both desktop mobile
browsers as well as tablet bazars as
well so what's the difference between
web socket and HTTP protocol well when
you look at this diagram HTTP protocol
will allow you to have
a unidirectional communication with the
server so basically the server cannot
publish back to the client without
receiving some type of request from the
client browser the WebSocket protocol
you'll see that it's bi-directional so
you have that real-time data
communication between the client and the
server over an established permanent TCP
connection so this gives you the ability
to have real-time data streaming back
and forth between client and server
let's talk about performance like I said
HTTP is based on the response request
and it the server will not be able to
push any messages back to the client
without any type of request coming from
the client first so in from a
performance standpoint you'll see that
the WebSocket is actually a lot better
performing you'll get a lot higher net
worth the lower network latency and
higher performance based on things like
the header size and of course because
you have a permanent TCP correct
connection you get that bi-directional
data flow in real time that makes for
highly scalable environment this guy
this will show you the difference
between like a general HTTP request
header if you see the difference is
pretty large compared to a standard
WebSocket request the WebSocket request
has one bite to start and one bite to
end with the message body in the middle
but with HTTP requests you have all of
the header information and this is like
a standard one or an average one that
would include just a little bit of
session data included in it if you think
about how much session data you pass
back and forth on a larger application
or depending on your application
requirements you can see how this could
add up pretty quickly if you have let's
say eighty thousand requests coming in
and you've got all this header data on
the top so what are the some of the
common uses for WebSocket applications
twitter feed news feeds stock
the online gaming and gambling type
applications or a dashboard would be
good good implementation of this so
which browsers do support web sockets a
chrome firefox safari opera they all
have native browser support IE does not
in its current edition which is version
9 but i believe 10 is definitely going
to include some web socket native
browser support within IE for web stock
in now for the tablet and the mobile
environments iOS does have native
support in the default browser so you
can use web sockets for all the iOS
platform however the Android browser the
one that's shipped with Android by
default does not include that native
browser support what I do know though is
if you do if you download one of the
other browsers for Android for example i
think i downloaded firefox 14 it does
support web socket so you could get that
support if you if you do get a newer
version of one of the other browsers
that's available for your environment so
that's the problem with WebSocket
protocol right now it's a very new type
of technology and the browsers are kind
of just trying to keep up at this point
with supporting it so what we've done
with coldfusion is we've offered a fall
back to the flash player that will allow
you to seamlessly provide an avenue for
all of the backward compatibility
problems that are around with the old
browser support right now basically in
your code you write the code ones
implement WebSockets and then if your
user does not have that support the
native browser support we automatically
fall back to the flash player without
any code changes required by you at all
it's a seamless integration and your
user will not see any difference in the
functionality so we want to talk about
cole fusions implementation of WebSocket
just how easy it is we provided you one
single tag to establish a WebSocket
connection it's the CF WebSocket tag
the messages can be received sent and
received in any coldfusion valid data
type so you can send a struct a list an
array whatever you'd like back and forth
between that Sokka and then as I said
earlier that the fall back to the flash
player is still available so so web
sockets basically the ColdFusion
implementation we've provided you one
avenue which is a broadcast mode and
well there's there's a second one that
I'll talk about a little bit later but
the first one I want to talk about is
broadcasting messages out to your
clients and there's three different ways
that you can do this you can do this by
having your clients invoke a response
message to publish throughout all of
your other clients that are subscribing
to a certain channel the you can have
server invoke where you're publishing
messages based on a certain mechanism or
scheduled task at the server level to
all of the the subscribed clients on
your on the channel as well and then the
third method is the invoke can publish
where you have a user or some client
that's established a connection and
sends a request to the server to have
some type of data processing done on the
back end and then you process that data
and as the server after the server is
done doing the message formatting and
processing it will submit it and publish
it to the rest of the group so these are
the four steps that we're going to do
three if you want to just receive
messages you'll be all set up in three
steps first what we do in coldfusion is
set up the application that CFC which
you can think of it as a global
initialization file for cold fusion and
it's basically like a class with a bunch
of methods that will initialize your
application in this file we just
established WS channels give it a name
for the channel that you want to
establish and then for step two we would
either use the CF WebSocket tag and then
pass it a name of the channel that you
want to connect to and this establishes
the connection with the
this particular channel in here you
would specify on message on open and on
air handlers of whatever you're choosing
you just specify the names that you'd
like to use for those handlers these are
default handlers and you have the option
to set a subscribe to at this point in
time and it'll automatically set up the
the code to subscribe the user to that
channel if you do not want the default
functionality let's say you have some
type of header information that you want
to pass in a custom header or some
arguments that you want to pass in with
the subscription then you would use the
JavaScript subscribe a method below here
instead of using the default subscribe
to in the CF WebSocket tag so step 3 you
would just define the JavaScript handler
so these are the handlers that we
specified in the CF WebSocket tag you
see that there's a message handler an
open handler and an error handler you
define your custom code that you'd like
to establish within those but at this
point after these are set you're
receiving messages already so it's a
very easy simple way to set up web
socket in your and your application the
fourth step would be to publish a
message from the server so simple you
use the publish function the JavaScript
function pass it in the name of the
channel and whatever message you want to
send I want to let you know what the
format of the responses are when you do
send a subscribe for example you'll get
an acknowledgement back from the server
that gives you this type of format here
you can see the request type is defined
there's a client ID associated with it
as well as a you know message response
which is ok typically if it's ok and
then the an error message would would be
in this format below and you get a
message back saying that the client is
already subscribed or whatever the error
message is and the
these are the responses back from these
particular handlers that we've already
set up so cold fusion provides a set of
JavaScript functions that are built in
functionality already we've got
subscribe publish and vokoun publish
which is the client initiated that I was
speaking about client initiated but
server processed and published at the
server side invoke and then unsubscribe
and then on the other side we have
authenticate get subscriptions now get
subscriptions will just pass you back
the subscriptions that you have assigned
to let's say I'm a client a little just
tell me what channel's I'm subscribe to
get subscribers count how many people
are subscribed open connection and close
connection so there's a couple of
advanced type of techniques that are
involved as well that we give you access
to from the WebSocket perspective and
cold fusion basically what we were
speaking about a little bit earlier in
the last slide is invoke and publish a
user can send raw data to the server
invoke of CFC that's C of C which is
basically you can think of as a class
file with several methods within it can
do some data processing on the back end
you can take you know queries from
different databases concatenate
information and you know do that
processing and then publish it back to
the server and this gives you the option
of doing that of via the built-in
javascript function in Vulcan publish so
this would be you know useful for you
know any kind of data manipulation you
need to do before somebody sends out a
publishes a message out to the all the
rest of the clients so there's also
message filtering and this is basically
just allowing you a way to filter your
clients interests or whatever the users
interests are with respect to a certain
channel so let's say I'm Alicia and I'm
a Laker fan I subscribe to the
basketball channel for example but I
not really interested in all those other
basketball team I just want to hear
about the Lakers I want to know if Steve
Nash joined the team for example then
what i would do is add alicia i would
subscribe alicia to the basketball
channel and then i would add in a
selector with some keywords to specify
lakers or if there's something else that
I'm interested in you would specify it
here in the selector so it's basically a
keyword filtering mechanism that we
allow with in coldfusion the the
opposite side of that is selectively
publishing so you can do the complete
reverse of that and only selectively
published to the users or the clients
that are subscribed to a certain channel
based on what you want to do at the
server level so a good example with that
of that would be let's say that you have
a lot of users that are baseball fans
and their subscribed to a certain
channel and you know they're at a game
tonight there's a game and you want to
just publish to those users that are at
the game to let them know that you are
offering a special on five dollar beers
or yeah five dollar beers because
they're usually about 10 bucks at the
game right so you've got a coupon five
dollar beers and you want to get them
based on their geolocation you can
define that and publish a message to all
your users on mobile devices only that
are at the game that would be really
cool to do right so there's also channel
specific message handlers if you for
example have certain channels that you
want more granular control over you
don't want a message handler that will
will handle all of the messages for all
of the channels you want to just have
specific control over certain channels
and manipulate data based on that
particular channel then you can set up a
message handler within that's specific
to that particular channel so let's say
here we have the subscribe level this is
what you would include at the subscribe
level you put the name and then you
would define that message handler there
and then you can put in any kind of
manipulation that you want
than that message handler that's
specific to that channel so basically
what we have here is the CF listener is
uh you can think of it as also an
additional class that allow you to have
some manipulation this would be at the
the publish flow or the message flow so
during the message when the message is
sent you can have further manipulation
at this level that allows you to kind of
granule a control different things
within the message so let's say for
example I want to set up a rule to allow
only certain people that are 18 and
older to subscribe to a channel this CFC
will allow you to automatically set the
parameters for your requirements first
and let me get into the callbacks that
we allow for those basically this next
slide will will show you the the
structure of it so the client is at the
bottom the co-efficient WebSocket
servers in the middle then at the end at
the back end we have callback functions
that are automatically called for every
request and then you can specify in
these authenticate subscribe and publish
layers which requirements you have for
your particular messaging application in
order to do this you would set up the
channel listener CFC file this is
basically the the way that you would set
this up within your cold fusion
component and what we've used here is a
scripting language coldfusion also has a
tag based language but we also offer the
scripting language as well so for
example we have four of the callback
methods here you can allow subscribe
this will obviously allow whoever you
want to subscribe and you can have
requirements in there allow publish will
grant from permissions for somebody to
publish before publish just does some
business logic before the messages
publish and then at the end we have can
send message which is should I send a
user a certain message are they
interested in this message and this
particular the can send message method
is only called if as we're talking about
earlier the selectors that we defined if
we do not have a selector defined for a
particular user then this method will be
called but otherwise it will not be
called if you do have selectors already
established for your users then it will
not go through this enter this method
the way that you define the channel
listener is when you set up the when you
register the channel and the application
CFC that we discussed earlier so if you
you look at the same example that we had
earlier we setup w/s channels we gave it
a name of stock and then we add in our
own stock channel listener there it's
very simple routine and then at that
point the javascript is already built in
to allow all of the the callback methods
to be available within the application
so these are the callback methods that
we make available within ColdFusion
allow subscribe obviously allows the
user to subscribe to a certain channel
allow publish do we have rights is the
role available for the user to publish
before publish is just some you can
implement data logic before a certain
message would be published can send
message like i said is only called when
the user does not have a selector data
defined and then before send message is
another looks a little bit the same you
guys are probably wondering what's the
difference between before published and
before send message because it looks the
same but the before send message is
actually called app of after the before
published but before the message is
actually actually sent to the client so
if i have one message that goes out and
is published the before publish will be
called once and if i have a hundred
clients the before send message will be
called a hundred times so you have that
granular control over what you're
sending to each individual client
and then there's on subscribe as well
this is a basic subscribed flow so when
a user subscribes you have channel
listing they're defined it will first go
through a louse subscribe method and
then if you are allowed it'll send the
acknowledgement and subscribe you and in
the publishing process we have the allow
published goes through first then before
publish and then can send messages then
before message sent at the very very end
so the additional way to send messages
obviously is by server publish and that
is when you have some type of message
that you want to push to your clients
this is obviously a really really
integral part of the WebSocket protocol
because before now you had to use some
other method like comet or something
that was a little bit more complex to
set up but these are useful for
obviously news tickets Twitter feeds
event gateway but what we allow is a WS
published function in coldfusion you
give it the name of the channel and the
message to be published and that's it
and then we also have additional
built-in functions like get all channels
get all clients and get NWS send message
as well so those are the publishing side
of it up until now we've talked about
like a broadcast type of functionality
where we're just pushing messages out to
clients but there's also point to point
which allows you to have full point to
my point to point communication between
a client and a server so this is
bi-directional obviously real time
between a client server this would be
useful for example on like a single
player online game or dashboard or
something that required point-to-point
communication between one client and one
server
and basically you would invoke a
ColdFusion function again at the server
level to do some conditional processing
and then publish that message back to
your client let's get into some demos
now
Oh
I'm going to just dock this on right and
then I want to show you two browsers so
that I can show you the communication
that takes effect between all the users
here so my first example i just want to
show you the acknowledgement request
it's coming back and forth between the
server and the client and then how that
data is published between both parties
that are involved it's a very real time
it's almost instant ain't it's
instantaneous it looks like Thais on
this example here so let's say I want to
subscribe I'm user a on the left and I
want to subscribe to the stock channel
this is the acknowledgement that I would
get back from the server that i just
subscribed and if i get subscription
subscriber count on this side I'll see
that ok on the right side we're not
subscribe yet so let me subscribe and
then I'll get subscriber subscriptions
ok so this uh this shows that i have to
subscribers here if I click get
subscribers account I should be able to
get the same thing on this side yeah so
subscriber count is two on there and
then if i get my subscriptions on this
side i should be able to say that yeah
it says I'm subscribe to stock channel
and let's say I want to publish adobe
pro stock price went up to 39 so then
I'll get a message on the left that says
my price is 39 so this is the way it
would be broadcast out to all your
customers
so the second is a chart demo I have
let's say for example you have a sales
team that's doing a presentation and
they're manipulating data while they're
presenting and if we want to change
let's say the revenue on one of these
two let's say we had a really good year
in 2011 and we change it to 1500 then
you can get you see it automatically
updated on the other side to the
projected revenue that I put on the on
the left side this is the type of
real-time data communication that you
can get instantaneously and make those
changes that you need to and i do want
to point out this is it the chart below
cohesion has charting functionality
built into it that allows you to make a
char like this with one single tag it's
pretty powerful it's very easy to use
coldfusion has a lot of libraries such
as this one that are pre-built into it
you can take advantage of in your
application
so my next my next demo is this is like
a hypothetical dashboard example so what
we've done is we have a hypothetical
database you can have you know real-time
database as well obviously but we've set
up just a simple test where if we have a
cold fusion bug database for example and
I want to find out all the cold fusion
books that have been submitted and based
on location and what type of if they're
enhancement or an install or an actual
issue then we can get real-time data
pinpointed with the you know with the
existing data that we have this will go
through the database and the back end we
have a server delight set up so that
this will be with it actually looks like
its data coming in at real time so that
you can establish you know a map of
where you are or where all these things
are at any given time and then below you
can see there's a bar graph being
generated on the fly with this data
that's coming out and if I wanted to do
pi format we can just switch off to PI
it should work code pi as well this is
just an example what you can do with the
dashboard with some real time data
coming in on the back end
okay my last demo is doc this window
again I use this a lot this is a windows
feature sorry for you Matt users I don't
know if they have that effect but I doc
windows on the left of the right based
on the just the window key and the left
or right button and okay so my last demo
is the drawing basically I wanted to
just show what you can do in real time
with a canvas type scenario you can use
this for online gaming obviously you
know real-time communication between two
parties if you want to have some type of
drawing mechanism but let's say I was
playing a you know tic-tac-toe with my
son then he would be X always and then I
would be O's and then he always wins
because he's little so you can do
something like that with with the canvas
aspect of it as well and you can see
that it's it's a real time I mean
there's there's no delay at all in this
you know where it's drawing it
automatically shows up on the other
clients browsers
start this in
pardon oh let me show you the the code
behind some of this let's see you know I
if you're interested to I will certainly
share all of the code that's that's that
I have for these demos as well and you
can just implement them immediately in
your cold fusion environment or we
actually did a presentation yesterday on
implementing cold fusion within your
Java applications so you don't have to
just have a coefficient environment you
can use cold fusion as basically like a
JSP tag library to be used within your
application and call it from within Java
like a Java servlet for example using a
new tab that we've created called CFC
proxy I see one of our friends that went
to our demo yesterday so he already
knows ask this guy over here it's year
Dino's anyway you know oo la la
definitely like groves on this code and
show you the code as well which one will
be talking about
so in the drawing I just want to show
you this is how we set up our our
channel here same way that I talked
about this is our application not CFC
it's called as an initialization file
and then
so this is the CF WebSocket tag that was
used for the canvas storm okay
and so basically I we created a draw
Jaya a JavaScript function that was that
allow you to do the manipulation with
binary data that was sent back and forth
ok
so
I wanted to give you some resources
because I know this is a lot of
information to kind of collectively take
in just starting a session and you might
not remember but the developer guide
allows you this gives you a lot of
information based just with respect to
the weather the implementation within
cold fusion and how to implement that in
your cold fusion applications and then
we have the developer center where our
engineers actually make articles quite
often with some more advanced techniques
on that and WebSocket org has some great
information and resources as well if you
take a look at that they also have a
little feature that allows you to check
your browser or just to make sure that
it is it does have WebSocket support so
definitely go check it out there and
thanks for coming
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>