<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>15 - Preferences - Part 1: Android Bootcamp Series 2012 | Coder Coacher - Coaching Coders</title><meta content="15 - Preferences - Part 1: Android Bootcamp Series 2012 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>15 - Preferences - Part 1: Android Bootcamp Series 2012</b></h2><h5 class="post__date">2012-02-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/itOJuJatKuU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">oh so let's do um now that we have the
application object we can use it to
actually deal with preferences as well
so let's talk about preferences right
now your username and password is
hard-coded so it's not very useful to
other people right and what if we want
to configure this to be able to be able
to add support for other people so
perhaps so what how would you do this if
you wanted to support other other
accounts both of these steps what we
need to build some data values so okay
so I mean if you're like a web developer
or or a desktop developer and you have
to and you have to build a um you know
way tool to store login and stuff what
are the things you need to do you should
need to build a screen right you need to
build the place to store it like a
database or a file system or something
like that right and then you need a
logic that's going to manage all that
you basically the whole MVC right for
that okay that's potentially a lot to
work so we're gonna do that in Android
and we're going to do it by using a
facility that will be there for building
preferences because it's such a common
thing to need preferences again so what
do you think we start with what kind of
fallen in android okay it's gonna be an
activity eventually but when we write
what would we write first yeah we come
yeah we could try well we're going to
have to register in the manifest but
let's try it let's start with some XML
file right so you could do this you
could do file new android xml file and i
am asking you guys to guess so it's you
know it's that's totally normal and you
see
over time you just get much better than
guessing because certain things just
keep repeating it well some things keep
repeating so it is served start thinking
that way right so if i say i want to add
new preferences look there's actually a
resource type of preferences right and
then you give it a name like prefs dot
XML while the two yr there are two
preference Queens here I don't know i'm
not sure i have no idea cookie bug add
they're actually three right no
preference cannibal there's a this is a
new you I'd see you I just became
available with our 15th so I haven't
seen it before so okay so preferences
perhaps XML click on finish yeah and for
the name just give it some name I gave
it a name called profs Epsilon yeah so
so yeah so file new Android opens an
external file you pick preferences here
okay but you picked preference screen
here so the choices that we made with
this and this and then the name and for
a name I just think I picked profs XML
somewhere that right so um now mine
doesn't open properly by the way for
some reason prep school under XML folder
hmm
this is not the right way to open it
followed over to uh huh XML research
that worked so you want to open it with
XML research if you have the bug the
title did so so you guys have a screen
like this ok so what we're doing here is
we are defining the data part of our
preferences we're basically defining
what is what is the data that we're
going to be storing in our preferences
and not so this is our preference screen
what we're going to do is we're going to
add a couple of items to write and an
item is going to be a piece of data if
you want to store such as user name ok
so I'm going to click on ADD and then it
asks us for what type of our item is it
and I'm gonna say it's an edit text it
could be a checkbox it could be a pro
you know rink category a ring preference
could be another subcategory and so on
and so on you can put lots of different
things in there so now that we have this
i'm going to edit add edit text
preference right and so that's that's
going to be where we're gonna just be
you know just a piece of text that's why
it's an edit text now you gotta can
expand this to see all the various
properties you need it was a matter of
fact we don't need anything from the
dial preference so i'm going to close
that we just care about the preference
preference right yeah
so again you have gazillion properties
here and not all are equally important
right there a couple of them that you
care about more key is important key is
important and title is important it may
be somewhere everything else you can
kind of ignore the most part right so
what I would do is for key I would give
it some kind of key the key is basically
going to be how you're going to look up
this preference it's just a piece of
text so for example I could call this
preference username
right title is gonna be the again just a
piece of text so just like before you
can go browse you can say new string and
you can say user name and you can say
user
in summer is really optional but that's
if you want to enter some kind of
summary like Yuna the as the user please
enter you know your username or you can
want to tell the user name must be be at
no.8 characters long or something like
that right but that's it's again it's an
optional piece of string yeah because
you could be using one of the standard
system piece of text so system
apparently defines some no well known
piece of text like cancel copycat okay
and so in some cases that system
resource is more valuable than others
let's pull a out there's a bunch of them
and so on okay so you'll be fine
username username just cause it's summer
I may say something like please
I love using
that's it so you guys can now do the
same thing to add server a password and
server we adding two more it's going to
look the same rights it's going to be
two more of the same added tax
preference so like I said let me show
you to what we call we use something
called statusnet which is basically the
what implements yambar back end right
and they have the open source version
and you can just download and install it
and that's what we use so no anybody
cares but that's what that's what the
implements the twitter twitter stuff
well
ok so we were going to add two more
right so I did check box password that
Allah is going to be password
someone
yeah and then one more was for server
oops not like that
well save it everyone's got a preference
file did they are happy with yeah yeah
exactly yeah because you're ready that's
yeah you can yeah you you can but it's
in this case of Bluebell took well yes
you can yeah that's fine you don't want
to change the key because that may mess
up the some of the data yeah he's the
key right ok so let's go to the so now
that we have preferences we can create a
new activity like you guys said that's
going to render these preferences so how
do we create an activity again yeah
create a Java file so right click new
class and I'll say a perhaps activity
you
okay and and now what you want to do is
we want to extend preference activity so
in this case we're not extending
standard activity but we were either
extending a specialized kind of a
critical preference active right the
couple specialized activities preference
is one of them lest is another one tab
is another one I can think of so they're
about thing okay so what's missing in
the preference activity what's the usual
matter the tea always override yeah
don't create so so let's do let's put on
create so source override implement
methods and final create
you removed it to do so what's missing
in this and create hmm yeah so remember
line 11 from our hello world poster what
was the line 11 in our hello world
setcontentview yeah and then we were
pointing to an XML file and we were
selling the video Conan of that view
into the alright so here it's going to
be similar except with the preference
activities opposed to selling content
view you say add preferences from
research
if the research was r dot XML dot crafts
yes this will this will now parse that
XML file to decimal points to that file
there which is that file their right and
going to it's going to parse it and you
know based on that build appropriate
screen yeah it's going to do all that
for us so you can screen for free i mean
the downside is it looks a certain way
but that's pretty decent right there
will be as they will be so what we need
to do an axis we need to register this
preference in the manifest bar yeah so
you guys can go ahead and do that so we
are registering it in the manifest file
so just like services and the existing
activities are equal level citizen so i
can just go control space activity
control space name dot traps activity
done hmm it doesn't need a label no a
label is going to be what shows up in
the activity like here so this is the
label the fact that this is Yamba is the
label I believe the default may be the
default of the class or something like
that or may pull it from somewhere else
but yes that's the that's going to be
that if you want to have the same label
you can but I didn't want to complicate
it like this this is really optional
right
so far so good so just keep it simple
super simple just that for now yeah yeah
yeah the proper way is to do it but in
the past it used to be required yep the
the reason why I kind of like it is
because it removes the confusion between
the default classf is a package
visibility and you know into the full
exclusive package now and as you can see
when the templates actually do put the
dot in there so okay so now we have we
have the so what we've done is we define
the xml for the preferences right we
create a preference activity which is
super simple this is basically your
hello world with one line difference
right on line 11 right instead of
setcontentview you're saying add
preferences from users and supposed to
adding extending preferences you're
sending also activity extending
preference activity but it's just like
hello world right and then we
registering the manifest file just a
one-liner like everything else so next
we need to launch it somehow what's a
good place to launch it yeah we're at
the hell our menu might as well just
yeah I'll do that so go ahead add it to
the menu and launch it so we are adding
it to the menu one light line item right
and I 10 item perhaps right and I said
the only thing that matters is a title
Rev Run save it and then status activity
was the one who is launching it so I'm
going to do it you know great basically
just check do we have case r dot ID oops
are
nice to doing that that's good r dot
okay did I can press do something in
return sure okay so what we're going to
do is we're going to start activity
right preference now just to mix it and
match it just for fun I could have
defined my intent up here but I could
also just do it right here I'd like new
intent from this to this to that which
is perhaps activity no particularly the
reason just because it's to mix it up
right
you can click on run let's see what
happens
you can show dialogue but then that yeah
that's a Dalek that's not this is we
call me going Fred what do you mean you
should i love you i love you bleep
options you know yeah this case would be
in a vacuum yeah well the true dialogue
is not an activity it's actually a
dialogue there is a activity that has a
team like a dialogue so it looks like a
Dalek so you can make an octa to look
like a Dalek but it's an activity or you
can have a true down because we feel
that further we good pretty sure that
works when it's first remember yeah that
was yeah ok so if I go menu perhaps me
many preferences takes a while to start
what eventually starts
okay good questions so what's the
difference between this which is a
context in getapplicationcontext and so
control space cat application
soget applicationcontext also returns
the context of a single global
application object to current process so
this is only used if you need a context
whose life cycle is different the
context of the entire right so usually
you want to you usually don't want to do
the application context because in a
context of an activity get context
refers to the context of that like
activity so it's it's basically it the
capsule as its life cycle in context of
application pending is their life cycle
of the application so in other words
activity could be gone but you referring
to an lifecycle of an application so
there's also get context yes there's
also yeah plication Cummings's get
context get base context
in this if this is if it's one set so i
would use getapplicationcontext if I
mean a pojo or something like that like
our tag of fun with main building blocks
something something of that nature but
usually this works pretty well what's
that lunatic so it's going to be student
password by the way i'll tell you how to
make this not show and the survey period
is HTTP colon slash slash mara com so
yeah Martha
so if you want it not a show on own
preferences on this preference there's
an option it's not shown in this list so
you can get it from command line but
there's an option for two to put for
password basically say add a baby's like
this android password big balls
that's amusing like that
so many references
you clicked on password it should be now
invisible right so that's not very well
documented by the line that you want is
this one now even if you shut down here
I'm your attorney started but you don't
have to do but this username password
and login information will be stored
okay would stay store with stay
persistent the question is where this
where is this actually being saved any
ideas yeah it's in data data folder so
if I look at it like this well you can
do it to the club's first one example
number
what's up as its data data then your app
package name right and then you show
preferences so this is that file it
stores view the name possible
so now if you want to see this file live
what's easier to do is to actually go do
this you can do adb adb shell now you're
in the shell of that other device and
since we are route we can do this you
can do a city / data data yonder
that's my phone
to this
yeah you can kill it there it is so
we're storing all this information in
plain text is there a way to do it yet
encrypt it yourself I've heard of secure
preferences but they having to use them
now it doesn't mean the Talmud II can
just read your preferences so here if I
take my computer my my physical phone
right plug it in then and if I try to do
this adb dash D for device show a los CD
series large data / data plus commission
tonight right so so that's what
preferences are so if I now want it to
use the Preferences what i would do is i
would do that in the Yampa application
okay
what WI will define a property called
shared default share profit share
preferences so shared
that
now when i saw this name shared
preferences it was kind of confusing to
me because at the end really wanna share
my preference especially not my username
and password with anyone right but what
it really means is that you're sharing
it within the context of your
application right so when we say shared
what we really mean is that it's shared
within the context of the applications
like prophecies isn't here and it's
available to anyone in here yeah that's
women's so what we're going to do is
we're going to get these shared
preferences so this is Twitter stuff
again so perhaps becomes
no because preference manager does get
default references for this context
so this this gives you the preferences
that you need right now what you would
want to do is you can out this you can
get a specific user name password things
of that nature that you need so so
basically what we will need to do is we
need to extract it from preferences so
do i would say string student or string
user it's going to be prefs dot get
string for a key sir ki ocupas user name
right
we use are no we can't not in this case
the key is that piece of text I mean you
could have defined that piece of text
presumably somewhere else yes you could
have done it like that but I don't think
it's let me see don't do this but if I
go perhaps God get I mean I could do
something like this but again I wouldn't
but for example our key as opposed to
being the word password could have been
at string this one as opposed to being
username password whooping at that
string flash user name right so this is
now referring to piece of tags let's
define the strings so now how they do
that here so as opposed to the particle
you username I put to get string
research
you soon
oops that's weird get string and then I
could say research would be r dot nah so
I way well that's it this is a long yeah
get resources and you know I think it's
eclipse is just messing with me because
I'm inside of function so if i did all
here get string there so you can still
do string for ID so r dot string dot you
name it i could do something like that
and then how to pay is that think you'll
be in to hear if you really want it to
but I don't think it's been any
beneficial so I will not
and this is fun
so what's what would be the default
value in case you don't find it you
could do an empty string or you could do
it now it's up to you what whatever you
think is better I like ancestors so so
that's one so that's if in case the
value is not found what should it be
yeah the default value it gets not sure
what something is you can put you can do
this you can put the mouse over it and
it L sir so we do the same thing for now
for the server and for the username
Alfred L path right so string password
that's got get string
and strength
you know there isn't any finding of
sample I mean this is the bite we're
bonding it's right here oh that yes
we'll get that yes yeah now we want to
use these preferences for initializing
to Twitter so this code needs to come
before the Twitter code right
so this becomes username password answer
so with that we can now test that this
actually works
there's only one there's only one
default share preferences you could have
additional preferences one is the
default one you can then have the named
ones the idea is that usually just need
a default that's why they won't try to
make that easy they go on the
preferences and I'll look up my server
for example yeah yeah yeahs many will
not but possibly spp
I've been practicing
the idea really behind the options then
is that there would be different from
opportunity to activity that's why they
implemented that way now status bar
redesigns a bunch of these features in
three-point all makes it makes it global
different lips and you have fewer
activities with stir with in honeycomb
you're supposed to use fragments but
things are fragments sharing the same
activity just be a single status bar
multiple you are components as part of
it okay so also that worked on the data
is there but if I use the data let's see
manual refresh okay that 15
right
now the next question is what happens if
I change preferences now in the middle
of all this like if I now go to
preferences and I change the username to
student of 47 yeah
we do menu refresh that worked again why
yes what we could do is we could refresh
Twitter object when the preferences
change or all somehow notified there's a
change in preferences how do we do that
well one way to do that would be to
basically do a re-engineered some of it
what you could do is we could lazily
initialize Twitter here so we basically
we could move the twittering
initialization here we could say
something like this if weather is now do
a Twitter stuff
in that case I could also move these
guys I can move all the preference stuff
actually are now I'm just going on this
this thing I just moved a bunch of code
into that one
so far so good
now what we can do is the following we
can save crafts dot register own share
preference change listener okay so you
probably want to type this you probably
want to select it from the list it's
very long
right so the again the question is who's
going to be the listener the listener
could be this you guys got up now we're
going to do that little dance that we
normally do it you put a mouse over it
you say you let implement on clicks on
shared on shared preference and listener
that fixes that problem gets blocked
from here you click here and you say add
an implement methods
so basically when preferences change
this gets called
what do I want to do in here yeah why
you don't have to do it you can just let
it be cotton whenever it's gotten right
because it's not private nobody supposed
to be able to access to the data but yes
these new years set Twitter to be no
I mean if you want to obviously know
that this work they can say log dot d
com
survivors
and shown young well it is for this
share preference is that were
subscribing for the time to write in
sooth devil's around in the emulator
when we start
okay so now if I change a preference for
your preferences and change one to
something else
and then we'll just it's not for sale
anymore yeah
it's my change
like I said this should work with other
other sites that implement the tempo and
sells out not one of them to time no is
identical that's a sort of like a
popular sort of blogging site so you
could use something like this so you
could try creating an account there and
then following people there that should
work so let me give you guys if you let
me give you a little exercise um you
remember how in our in our let me close
all these guys and remember in our
updater service we had this delay in
seconds right it's hard coded right now
try to figure out how to put this into a
preference like I want to pick you know
how what the kind of delay I'm dealing
with okay and you can do this in to two
different ways you can first do it as
just put a number like type in 30-60 45
whatever your preferences later on we're
gonna do it do it to the pull up like
it's going to pull up a dialog and it's
gonna have like radio buttons make your
son like that more better looking right
it sounds so for now just add another
property it's a edit text field I
detects preference where it says what
kind of our preference do you have a car
how it will come in second so you can do
that as an exercise and then we're going
to do it together okay so the first
thing was to remove the delay or
frequency whatever you wanna call it
into the manifest into the menu or
personal preferences so I'll just do
this one really quick so basically just
like before we put together another
item references add and initially I said
just do the added text reference later
on we're going to do a list reference
but you know let's go small small steps
right so he is going to be call it
whatever delay right and title could be
something like new string how frequent
late to check for updates it's in like
that actually I should probably do that
as for the delay yeah delay like this
and do just a mess it up I'm talking the
same time Leon's no typing so let me
just fix this really cool it's going to
be delays summary I'm going to a delay
really okay so then this is going to be
delay delay delay here right and then
it's going to be delays summary well so
I've added it to preferences right now
in update service I need to read those
preferences right so supposed to hard
coding this one what I can do here is I
can read it in my own Star Command I
could read it even in here in case it
changes it changes it right or let's say
it's not it's not going to change it
doesn't move on we can do it in on
create as well so I could say for
example the same
delay is going to be a young buck yamba
app right and from the humble app I'm
going to get I'm going to get the
Preferences get application right I'm
going to see preferences and i'm going
to say get int four key delay right and
the value I could tape delay so in case
it wasn't specified we're just going to
go with the default alright so in still
using this one it's going to be my
default 30 seconds in case delay was not
specified and then here I'm just going
to say use delay so what I changed I
added this line here and it changed this
to use the way
now doing one way right
it's basically the only new line here is
this one and change in here that's it
right how do you force a delay mean to
be an integer in preferences like what
if they've put in a number or something
on there is a hmm there is impo type
yeah so you could try it's not available
in eclipse eclipse the somewhat limited
but the reasoning called Android input
type not even Eclipse knows about it the
type and it's a the way the reason why I
know it is because in the layouts like
for example for look at it here let's
say I look at edit text right
preferences they have property called
input type and if you put a mountain
muscles the type of data being displayed
in deep it melt inside to let the data
in so it's a flag and you can use any of
these so it gives your list of what's
possible right textext cap tax care auto
text multi-line text URL text person
named Tex personal address text password
blah blah blah so for us presumably it
would be it would be a number right make
sense so that helps the system figure
out which keyboard to bring up right but
again it's another example where cliffs
may not be telling you exactly what you
need to do so that's why number I'm just
going to do it like this
right
so if we run this
takes a long time to go through and
create initially huh well it doesn't
help the time also tracing you keep in
mind probably turn it off number trace
metals I told you they're going to take
a while it's good future
and now it's done
hmm
mhm
anybody gets an error message like this
so you get the string in the first to
end why they died showing the bank
you
there's bizarre
that's because this is final I think
that's why okay so me and yes
if
okay so this is if I do a menu
preferences delay about 10 seconds then
you start
okay so you're saying this is still
getting us in yes okay so this is still
getting us a strength so we need to get
string and then cast it right right this
becomes really ugly
you mean so why I'm today this numba
find itself because this is one big-ass
version the service of exploration of
the previous service to their valuables
it's supposed to every single time ask
what's the night the delay for the next
time around that's what's supposed to
happen let's see one two three four five
six seven eight nine ten okay so yeah
it's it runs according to my my
preference it's working right on the
problem yes it's working on every 10
seconds the problem is that Mulder
couple problems this makes this ugly the
reason why I was dying before it was
kind of interesting but it's because
they define my delay final that causes
the compiler to actually figure out its
value before it's even starting the code
so so that was that was an interesting
bizarre crash but this is just Soviet
here it's quite clear so we're going to
come up with something better hopefully
on
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>