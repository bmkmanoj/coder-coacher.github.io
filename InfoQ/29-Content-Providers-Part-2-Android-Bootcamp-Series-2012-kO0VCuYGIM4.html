<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>29 - Content Providers - Part 2: Android Bootcamp Series 2012 | Coder Coacher - Coaching Coders</title><meta content="29 - Content Providers - Part 2: Android Bootcamp Series 2012 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>29 - Content Providers - Part 2: Android Bootcamp Series 2012</b></h2><h5 class="post__date">2012-03-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/kO0VCuYGIM4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we said we didn't know refactoring right
re factoring was basically we created
Yamba provider the AMA provider is not
content provided we basically
implemented a content provided by
providing implementing you know the
standard methods on create on get type
right and then we inserted we provided
insert in query right so so they they do
something they insert a new database
inquiry database I purposes skipped
update and delete because of you guys
should be able to totally extrapolate
how to do that as a matter of fact that
will be your homework right so yes you
get to do that that's going to be on the
test but basically update is going to
give you the URI of the record it's
going to resolve to you or I this is
going to be your values and this is
selection selection arcs you pass that
on to a database you return how many
records have been updated and deleted
you delete and this is basically where
statement right now we move the DP
helper into here because this guy used
the DB helper so did we basically
obsoleted all together the status data
we do deleted it all together so we
modified the Amba app to now I use get
content resolver to insert into one
right and now in timeline activity we
did the opposite right we are reading
from we were reading the data and we
were reading the data in two places one
was here right and the other one was
down down in the timeline timeline
receiver right so basically what we did
here is we said get content resolver
query blah blah blah there's actually
another way to do that and that way is
to do something called
manege square yeah so what manage query
does it looks exactly the same soon
looking copy paste the URI right URI
projections now selection no selection
arcs now in sort order is going to be
the same as what we had before and and I
say Kurt sir is that right so as opposed
to using this approach you could use
this approach so I'm going to comment
this one out so this basically what
manage query does is is is basically
supposed to it basically does the same
thing but also manages the life cycle of
a cursor so if we close that if we close
the D activity something is supposed to
close the curse remember that database
if we never close and we never release
anything right so if you say managed
query then dad's going to close it if on
the other hand we did for example this
if I did close here I did get this if I
did debated close then that moment this
would be empty this would be not it took
me a while to figure this one out like i
was like huh as the data disappeared
right I thought I open up the database
gather data close the database the
moment your clothes database to release
the data so you can't do that right so
um so instead what you do is you do
something like this you say manage query
right and you get mm square now we're
not going to do this either because as
you can see this has been deprecated
well it's been deprecated in since honey
cone right so this really depends on
which version you're using
but basically what we're supposed to use
is use the duck the the cursor loader
yes that's correct okay so to do that
you basically use the is going to be it
you're going to use the we're gonna use
the cursor loader that's going to load
the the query okay and it's going to
notify us off when it's done okay so we
can basically create a cursor loader
with all this and we can say load in
background okay so once loading
background is the loading background
stop loading background really have the
much documentation that and let me open
it up here
the time and fragment so basically what
we want to do is we're going to create
I'm going to do it like this we're going
to implement something called a loader
manager loader called call back so that
we a synchronous the update Rui when
we're done our part so let's do it like
this um so this is the sort of proper
way right but again like I said it only
works since honeycomb so we are going to
say implements loader manager dot see
all of the manager dot what isn't it
have the magical floater callbacks
purser all right because they have a
diaper in and they should complete it
for me
sir you're not getting the loader
manager sounds like we're some of us are
stuck on the older versions remember how
I said you can go to the documentation
and you can actually do immediate here
loader loader manager so you can
actually turn on the filtering so you
can say I'm committed to 10 then this
would not be available it was available
on it since honeycomb right in the way
well I can walk you through how it's
supposed to work right so what we're
supposed to do is we are supposed to in
it a loader right so get loaded manager
initialize letter then that cares
callbacks that are going to look like
unloading finish you get a cursor loader
and so on and so on your supposed to
basically return cursor loaders and and
unload finish do something with that
loader etc cetera but but but you know
if we don't have it we don't have it
right yeah so we will basically
implement methods like this and create
loader we would do something like
initialize the URI for example outdoor
selects and create a new cursor loader
right why don't I have it so that's this
is a different story though their
manager loader callbacks did that change
mine to work on all the version I didn't
okay home
so okay so I was using the old API I was
based on 10 by the way if you are using
10 you can still do this via the
compatibility lips pretty sure it's part
of the loaders and fragments of part of
the compatibility so you can actually
run it on gingerbread as well so what I
would do here is I would say add and
implemented methods so this now added
these three methods right on create
loader needs to create new cursor loader
so we're going to basically if it turned
new cursor loader organize imports to
two tools okay so and then this is
context URI so context is going to be
this URI is gonna be the you write that
we're loading from so it's gonna be like
this right URI that's the URI we're
loading from
projection selection selection our
absence or daughter so everything's
going to be now except the last one
which is going to be that so basically
this is ID I believe because you can
hear multiple loaders ID and arguments
so what I'm doing is I'm implementing
that load imagine now again this is
optional this is for honeycomb and up
code if you guys want to do this right
but it's an asynchronous way of to
uploading data to that's to answer the
question what if you have gazillion
records and you need to kind of do it in
a background yeah how would you guys
fully downgrade um I mean sir if you
create a separate apks than their
separate application there's nothing
really to talk about right that's one
strategy but it's not the best strategy
by the strategies to get one code base
and to have it you know figure out what
to talk to Ron it's just you would have
if statements you check for the build
there's a system dog build or whatever
it's called property and you could check
you know how to do it like for example
like if one was say something like if it
system dot builder bill dot dot
bill dot version or something like that
filtered version right equal and then
you can basically compare the versions
and so on right so you could do things
like that to figure out what works
Thanks don't L since the videos yeah
windows that's it I'm so that's a that's
how you would do it now or you could
meaning you could unknowingly stick to
the older code right so so in this case
I'm going to I'm going to do this using
so so basically if I am doing it not
doing it this way right we're not doing
it that way then what I'm going to be
doing is I'm gonna say get low
loader manager god in it loader and then
you can specify which loader with what
now arguments in what call back so we're
not using any ID so it doesn't really
matter arguments are going to be now and
the callback is going to be this so it
is this code that's going to call those
callback methods right
exam
so basically what I've done so far is I
have defined the this guy here so I
basically said we are implementing the
the logger manager loader callbacks
right that added a bunch of methods
cover the bottom so as opposed to what
this was option one this was optioned to
we could have just gotten the cursor
here right or we could have gotten the
cursor here this was the worst way
because it actually then we would have
to manage the life cycle of a cursor
right this was a slightly better way
because the activity would manage the
life cycle of a cursor right but it was
all bad because everything would happen
here is blocking that was that's why it
was bad right so we are in oncreate so
that would mean that we would wait a
while to possibly do that now you don't
see any problems with our code because
we have like what 20 30 50 tweets but
what if we get way more tweets you get
you get the issue right so so that's why
the this is the third approach right is
to basically use the to use called
loader manager so to do that well
actually this is the third project so to
do that we're basically saying get a
Content the loading manager initialize
it for a specific ID or specific if you
want to pass some arguments and
ultimately who to call back when it's
done so now the loader manager manages
loading loading manager says oh ok I'm
ready to load up the class I'm done
loading or do this will do that right XO
so the loader manager is now going to
say what what happens so basically on
create we're simply going to return the
new loader so that's what we create the
loader and this creating the loader was
very similar to what we did here right
so this now kick starts loading
somewhere some some thread right
presumably now this is when it's done
this will be now synchronous this is
kind of like onpostexecute right this is
doing background kinda this is on post
executi you guys get it right so so now
we can do something useful in here and
usually this is going to be a swap
usually unfinished you're going to do
adapter swap cursor usually right
alright so this would be adapter dot
swap swap cursor cursor right so this
would be our cursor so we're swapping
and this is loader just eclipse doesn't
do a very good job filling all the
blanks so what what happen is the loader
finished loading so whatever cursor was
part of the adapter we just replaced it
right
and then finally reset loader also
happens to be swapped cursor right so
we're going to do the same thing in a
reset
so essentially it's just as different
semantics you get the same code this
code now became this code and this is
now just swapping asynchronously when
it's done right
what you call that loading manager
loader callbacks right that's gonna call
back visit a call back so these three
methods of it that we have this one is
the factory essentially the sea happens
in a background on a background thread
this one is back on a UI thread and this
is da cunha UI thread right
so now the question is just thought to
reset and Missy
so reset loader is basically starts a
new start a new or restart an existing
loader demand if this is manager there
is a blah blah blah so basically what
you want to do here as opposed to doing
this stuff we now want to say so I'm
going to comment this out just so you
can kind of see what it will used to
look like and we're going to replace
this with the get load their manager dot
reset loader ID of the loader I should
probably give it some kind of ID i'm
going to call this loader status status
loader yeah I callbacks are going to be
this is going to be now and the last
parameter was what would a callback and
the callback is going to be the parent
which is timeline activity of this right
let me just define status loader so I
just one second and on the bottom
bouncing up and down I just want to
define a constant for my loader so I'm
going to have static final int loader
and it can be like whatever 47 don't
really care so as opposed to doing minus
so so that I'm not confusing you with
this number of minus 1 right ok so
version 1 was was this right it was bad
because we would have to manage it
ourselves the life cycle of a cursory
would help to remain remember to release
it and so forth and so forth version 2
it was better because it was managed but
it was not as great because it was
blocking so if this was taking 10
minutes to load we would be sitting here
for 10 minutes to look now keep in mind
content providers are are usually backed
by database but not don't have to be
always backed by a database right my
chance so because of that that's not
good approach especially not to block on
create right because this would be this
could lead to a and are you doing
something potentially long so the third
approach was the best approach so that
was basically the best approach and that
was basically to use the loader manager
to say just load status loader and call
back this which is that once you're done
okay so that's going to cause these
little but genome api's to get called on
create unloader finished on loader reset
right so basically what we're doing let
me just double check when I reset the
unload the reset literally what you want
to do on load reset now we want to set
now
yeah we just have to say now but we
stopped you is registered that's correct
so on so that's going to swap the cursor
so we basically got the new data and
this is that yeah oh we don't need this
anymore change change
and we can actually well this is not at
this case right as a matter of fact I
don't think we need cursor anymore put
the noun right because we're not using
that variable anymore it will not
managing cursor ourselves we have the
adapter we're loading it with a null
cursor but we're kick-starting the
loader then I've could prolly put this
line like slightly below yeah so this is
gone
and at this point this may say make
sense to just kind of the organizer
orbit
so something like that so basically
these guys are now responsible for
managing the loading so let me let let's
start make sure this works actually
before we talk about it any further
menu stuffs update enough okay test to
test leather update that posted go back
menu refresh works like a charm right
are you guys following so this is sort
of the Ice Cream Sandwich ani kaam / ice
cream sandwich featuring but via the i'm
paul Washer via compatibility libraries
it's available in the older versions is
what so in other words okay daddy's is a
feature to the other like bones
questions comments on that so we can now
dis now scales right we can now handle
gazillion records in our database we can
a candle like content provided that
actually goes is very slow right all
that stuff you can handle
got it good good good
yeah everyone got any questions alright
cool so what's next so now that we have
all this working the natural so let's
see we're at the natural progression
from here would be to do this guy right
after all that's partially why we
started going down this path of creating
content project although as you can see
it's not just that why we care the
content provider also you have to do
with loaders because previously we would
have to do our own mechanism for loading
if we didn't have the loaders right make
sense yeah connect to database we don't
have a network connection but the
database the database is right here in
our own ground so there's no network I
don't care about the network connection
I don't care if this doesn't exist when
I'm connecting to a database within my
own process there's no network right I
mean there's just a local tcp/ip stack
actually there's just a local file
system there's no you know it's a sequel
I database right it's a library it's not
there's no network involved at all it
could have been that this status
providers actually backed by you know
some database up in the cloud right but
now it would work fine because we have
all these fancy loaders and you know
it's asynchronous the loading and blah
blah don't manage itself well it can
take take as long as it wants either to
timeout or to load resilience of big
data or whatever it is right
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>