<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Seamless iFrames: The Future, Today! - with Ben Vinegar from Disqus | Coder Coacher - Coaching Coders</title><meta content="Seamless iFrames: The Future, Today! - with Ben Vinegar from Disqus - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Seamless iFrames: The Future, Today! - with Ben Vinegar from Disqus</b></h2><h5 class="post__date">2012-11-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gQCm8VYn93Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">um so I'm really excited to talk about
single page applications we're gonna
have backbone WebSockets local storage
it's gonna be great okay that joke
worked better in my test audience um
we're not talking about single page
applications at all we're gonna talk
about seamless iframes okay i guess the
opposite is you're all just terrified
right then and i didn't i didn't think
about that happening so it's seamless
iframes the future today we'll get to if
you don't know what seemed the side
frames over we'll figure that out in
just a moment um first of all just a
little bit about me my name is Ben
vinegar the last name is real even
though i think i got an argument last
night at one of the parties with someone
who's convinced that it wasn't i work at
a company called discuss i'll talk about
discuss in a moment and i'm also the
co-author of a book called Thorp I
JavaScript if you're walking around
upstairs you may have seen it at the
meaning books thing the hair floating
around I was actually sculpting around
near the books area waiting to see if
anyone would read it so that I could pop
in and just be like hey but I don't
think I saw anybody and it's a little
bit about discuss um it's a distributed
commenting platform hopefully you've
seen it somewhere I'd served as a third
prior JavaScript application it's on a
lot of big web site CNN time time calm
people calm at GNN will be a huge list
if you're curious you can go to our
website and then lists a whole bunch of
them we don't get quadrillion pageviews
per day but we do get quite a lot
somewhere in the order of six or seven
billion per month just because we're
served on so many of these big like you
know top sites and if you're not
familiar with discuss it kind of looks
like this this is a screenshot i took
from droid life droid life com it's kind
like an android community website and
these are the comments at the bottom
I think this was a review of some sort
from a couple months ago you can reply
to comments you can vote stuff up you
can browse the community share comments
all that kind of stuff so one thing
that's really cool is earlier this year
actually in around June we just released
a new version of disgust and I'm really
excited about this because we rewrote
the client side from the ground up huh
that's fine use the backbone so it is a
backbone app and we use ender it's kind
of like a micro library packaging
framework I like to joke that were the
only people that actually use ender
today I don't know if that's true or not
we also use less it consumes our public
API so pretty much what you see or
what's happening on the commenting in
bed is something that you could
hypothetically build at home that's not
like a hundred percent true there's a
couple endpoints that we use or for
performance and scale that are private
and we do some real time stuff because
real time is pretty hot these days but
something that's really exciting to me
despite all that stuff is that the new
version is actually completely in an
iframe so if I go back to that
screenshot I've actually painted a red
line around what is an iframe in this
page and if I didn't paint this line
you'd probably be hard pressed to know
this because if you think about it
there's a couple cool things going on
you'll notice that there's some pink
highlight coming from the website that's
being applied to the iframe it's kind of
hard to tell but like the links are pink
and it's a highlight color that's pink
the comments section actually like
expands and grows as the you know as you
add a comment or real-time comments come
in so it's sort of a little deceptive
like that now I know what you're
thinking which is first of all not
another 3d slide deck and the second
thing is I frames really um I think that
whenever I talk about I framed for some
reason I feel like half have the people
in the audience I don't know they're not
big on iframes they're kind of like this
dirty ugly gross thing that you know
nobody wants to talk about I almost want
everyone's anyone seen the movie we have
to talk about Kevin
I don't know I haven't even seen it but
I can picture the poster and I just I'm
gonna photoshop it so we have to talk
about iframes and I think it's because
it harkens back to this time it's a
frame and it harkens back to this time
that we all want to forget where you
know we use frames to subdivide content
and everything was just gross with
lovely borders that URL works if you
want to check it out but personally I
think I frames are great they're great
especially if you're a JavaScript
programmer you're doing third party
stuff biggest thing is that they're
sandboxes code that you're running
inside of an iframe it can't really
touch what's on the outside that frame
and maybe that sounds bad but what's
maybe even better is it code that's
outside the iframe can't reach inside to
the iframe and do bad stuff with it so
that's really important that means that
we can avoid JavaScript conflicts yeah
like if you have a parent page that sort
of decided to manipulate prototypes in
funky ways that aren't fun for your code
you avoid that completely so in this
example of somebody decided for whatever
reason to replace a rate up prototype
top push with a string of this guy
flipping a table that's not going to
bother me at all it's more secure I just
talked about you know the code can't
communicate I frame in the parent page
means it can't go in steal your cookies
stuff like that it's also better privacy
for users since the parent page can't
reach into the iframe and you know I
can't manipulate the Dom can't figure
out you know oh who's logged in what's
your name maybe it could assemble this
information and do bad stuff with it so
those are some reasons and that some
reasons why I think I frames are pretty
cool and why we're using them in this
new version but the flip side is that
for what we're doing I frames are also
you know that's cool but I frames are a
little tough some things that are tough
are they don't inherit CSS so if I
wanted to you know right if I'm a web
publisher and I want to target some Dom
element
inside of the iframe and give it a font
I can't do that possibly for good
reasons like this maybe you wouldn't
want this but you can't do it even in
like a structured way hyperlinks eight
eggs that are inside of your iframe
they're actually going to navigate the
iframe and not the parent page by
default which can be annoying if you're
not thinking about it you'll click a
link and it will just load a different
page and sit inside the iframe and
perhaps the like trickiest thing and I
think the thing that I get asked
questions a lot about is it just doesn't
resize to fit the contents you've got an
iframe it's got a thousand pixels
unfortunately you can't just say I frame
height 100% doesn't work that way you
have to give it a fixed height and if
there's more content you're going to get
a scrollbar flip side of that is it will
you can give an iframe width width one
hundred percent so just to kind of
explain all this I've embedded an iframe
in this page is this an HTML slide I can
do this now this is actually just like a
synopsis of Armageddon you can't tell it
all you wouldn't want to read it but
anyways as you can see here like my
basic font color on on my slide deck is
white but I put this iframe in here and
the iframe doesn't know where where it's
being embedded so it has black text it's
a completely different font it has the
scroll bar because it doesn't expand the
width or expand the height to fit the
content I can add more content and you
know it's just that it's gross and then
I got this link here to that goes back
to my slides and like I mentioned if you
link to something instead of an iframe
this is what happens right all i did was
actually load my slide deck inside of
the iframe again and if we're if we're
you know inception fans we can kind of
do this and scroll down and get this one
more time and it's this one that's hard
to the other it goes that will do one
more time no I think that you know the
double 3c I think we all agree that I
frames are actually really useful and we
want to keep them around and that's why
you know frameset and all those frames
and that ugly screenshot I show you
those are all deprecated but I frame is
still here and we're still you know
building features on top of iframes to
make them more useful you know with
html5 we've got a whole bunch of cool
features that's what this conference is
about but despite the features that have
already come HTML is a living standard
and we're adding more and more stuff to
the specification some of which really
helps I frames and that's we're going to
talk about today one of these is the
seamless attribute so this is an
attribute I ha man can you read that ok
or is it just no good there we go and so
the seamless attribute goes on the
iframe like this and what that does is
it gives it these kind of seamless
properties it kind of fixes the things
that we just talked about we're kind of
difficult when you're working with
iframes so what does it do CSS rules
cascade through the iframe that example
I gave where you could you know target
Melman side of the Iran and give it
whatever style you want that works with
the seamless attribute hyperlinks
navigate the parent context that's fixed
and of course biggest thing of all the
content actually the iframe actually
fits the content which is really awesome
sewing a link to an example here and I
wonder if anyone can tell me what just
happened
no no pop quiz okay well if any one
piece it together this slide was
actually seamless iframe so this is
actually a completely different document
that's embedded inside and you couldn't
even tell and I didn't do anything
really crazy for it I just use the cmas
attribute let's inspect this this bad
boy so it's really hard to tell here but
and this is the iframe element right
here cool it's pretty cool and because
that example doesn't really show like
the the height stuff all that great
we're gonna just gonna bring up another
example really quick oh my god so I've
got this other example right here and
this is Armageddon returns and this is
the same text ahead from earlier but now
seamless already you can kind of tell
it's got this brutal magenta color it
actually has the same font which is uh
how about a canoe and if I do this the
content or the iframe is actually
resizing to fit it so kind of cool a
little bit
and some reason I think everyone should
be should be clapping at this I Orson
Welles is clamping um but um there's
there's the sort of the cold hard truth
to what I've just showed you and this is
true of many HTML things is that there
is not a single stable browser that
actually implements what you just saw
and and now you're probably wondering
but what did you to show us well I'm
actually running Chrome Canary right now
so it is implementing Chrome Canary if
you want to play around with it go ahead
check that out play around with seamless
um little quirks I've found it only
works over HTTP so I'm actually serving
these slides / / apache cuz it wouldn't
work / file I don't know yeah I don't
know I don't see that in the spec but
maybe it is now this is interesting
other browsers have supported seamless
because the spec has been there for a
while but the way they supported it is
they actually just sort of did this
superficial CSS on top of it they made
the iframe transparent and just took
away the border and the padding and it
kind of looked a little more seamless
but actually and I've process out
because it seems like in latest versions
they've actually undone that because
that really wasn't helping anybody so
that means it's coming soon right i mean
if from canary has it implemented in
chrome is a super modern browser it's
only a matter of time you know until we
all have this really cool feature um
well it's also been in chrome canary for
a really long time since May and so I
really thought it was like oh it's in
chrome 18 that means when you know the
release channel of chrome comes out I'm
going to have this nope it just kind of
keeps getting bumped back and bump back
and it hasn't been landed yet if you
look at the ticket for this there's a
ticket on implementing this feature the
last comment is from last month which is
like hey is anybody going to land this
so I'm not even sure who's championing
this at all there's a ticket in Firefox
that is completely unassigned and I
don't think anyone's even really looking
at it
um internet explorer 10 I mean I didn't
try it but I'm just going I'm just gonna
take a guess I've just taken I guess
it's not even listed on can I use com
that's that's that's how bad it is it
would just be red or just be red
everywhere but it's it's a totally it's
a totally legit feature and yeah so
you're probably thinking this is kind of
a funny talk because I just sort of
trolled you all with this really cool
feature and then I've told you oh by the
way you can't use it at all so good day
I'm just gonna walk off um but before
you file out of the exit for the second
half of this talk we're going to
actually do some code examples and
figure out how we can kind of simulate /
emulate seamless in in all browsers
everything that we use today just a
caveat it's not going to be a hundred
percent as good as seamless but it's
pretty good this is the kind of stuff
that we use it discuss and I think it's
probable for anyone who's working with
iframes so the plan the setup is this is
going to require javascript executing in
two environments we're going to have
JavaScript on a parent page we're gonna
have javascript running inside of the
iframe and between the two of them were
going to solve all these problems
they're going to talk to each other and
normally I mean I mentioned earlier that
I frames if they're hosting an external
document you can't actually access you
can't access each other except in one
way and that's through an html5 feature
called windowed up postmessage post
message is this way of basically sending
messages in this safe controlled way
between windows windows including
iframes and I'd say that probably like
ninety percent of the use cases through
iframes we're gonna bump this up a
little bit OOP can you guys see that
okay a little bit we can give it the
pink highlight
hmm i added something so that I could
like edit all these and in real time in
case I found a bug which is kind of neat
except now i can't select them it didn't
think of that um so if you can read the
top what's happening is I get a
reference this is operating in the
parent page so I'm in that context I
gotta get a reference to the iframe
element and I'm going to post it a
message and that message is just so it's
just a string the first parameter is the
message body the second parameter is a
target origin that's usually for
security purposes but you know if you
want to read up about it you can check
it out for now we're just going to use a
wildcard asterisk which just says you
know this window doesn't matter it's
going to get this message now we're
gonna move we're inside of the iframe
now I gotta listen for these messages
now the way that you listen for messages
is you add an event listener to window
and you listen for the message event
when any message gets sent to the to the
window this handler is going to fire you
can look at the message and react to it
in this case I'm just going to alert the
message the string message that I got
from the other window that's it so this
is just like the quickest postmessage
primer so just member that a little bit
we're going to come back to it so one by
one we're just going to solve like those
three problems we're gonna start with
the easiest relative links or having
links inside of your iframe navigate you
know the parent window and not the
iframe so if you recall it was kind of
like this and we did we did the whole
you know inception thing we're gonna
solve that now if you think about it
that's actually pretty easy you just
have to use target in all of your links
so if you've got an a tag and you're
linking somewhere you just gotta do
target equals parent and that's going to
actually load whatever that URL is in
the parent parent document
that was easy but I mean if you're gonna
use this you gotta repeat it for every
link which is I don't know I could be
kind of error prone if you ever forget
it if you make a mistake you're you know
you're going to load a page instead of
an iframe maybe you're doing widget
stuff and you're going to load a
document inside of a tiny little like
button or something and that be not fun
so a technique that we use which i think
is pretty cool involves this element
called base base is kind of like this
old-school element from HTML for that I
don't think I ever really used before
and what it does is it specifies a base
URL for all relative URLs so if you look
at this time up example I create a base
tag and I give it an href to some URL
and now if I have a relative link
anywhere in on that same document it's
actually going to point to like the base
is going to be what I put in that base
tag is that kind of make sense so here I
just had an href that went to slash but
because of the base tag that actually
translates it to example 2.com / foo now
on its own this doesn't this doesn't fix
anything but base also supports a target
attribute so not only can I give it an
href I can also give it a target
attribute so by default I can make
everything target the parent so now the
exception can be something else if I
wanted to load something an iframe I'd
have to say target equals self or
something so here's a quick example of
like what that looks like this is like a
full document I've got my base tag in
the head and I'm gonna specify sorry and
I'm going to specify parent calm as like
the base hrf because I want all the
links to be relative to the parent page
and I'm also going to say that you know
the default target is going to be
parents as well and now i got these
links below there i've got this like
relative length even with a document
fragment that works too so
documentfragment becomes parent calm /
boom I don't know a boom is um and then
below I have like an absolute link
that's going to discuss com
that's not going to be influenced by the
base href but it will still open in the
parent so that referring URL is useful
too because if you want to have relative
URLs inside of your iframe you want them
to point relative to the parent page
this is all about you trying to
seamlessly exist inside of the parent
page how do you obtain it you can use
document to refer that's just a property
kind of a global property thats hanging
out that is like what document referred
this one and if you're loading an iframe
on somebody's website it's going to be
the parent page the thing is that value
is unavailable one hundred percent of
the time probably like ninety-nine
percent of the time but there's some
situations in which you can't get the
referrer property if you're going
between htps and HTTP the browser could
just disable refer tags for privacy or
for whatever reason some do not track
plug-in and then this won't work so this
is now when we come back to post message
since we have JavaScript that's going to
run on the parent page we've got
javascript it's going to run inside the
iframe we can just get the JavaScript on
the parent page to you know poll for
what the what the URL is and send that
in to the iframe and generate the base
tag for us so at the top here um this is
a running in the parent I'm going to get
the iframe element again
I'm going to the iframe element again
just repeat myself and then i'm going to
send a message and this time you can
also send i'm getting a little confusing
air but here I'm sending a little bit
more kind of like structured data i'm
sending ashley an array the first
parameter is like the type of message
i'm going to send and then the second
argument in that array is going to be
the href that's so that on the other
side I can kind of look at this message
body and figure out you know what what
kind of data am i dealing with it's sort
of like this really stupid protocol I've
designed please don't use this and now
inside the iframe I'm gonna listen to
that message event when I get it I'm
going to pull out you know the event
name and then the data and then if I get
this refer event name well then I'm
going to inject a base element with that
refer that I just extracted from the
parent page does that make sense nods
some nods cool and and now just like
injecting the base element is is pretty
simple we're just going to create a new
element base going to assign an eight
the href that we got from the parent
page just going to set the target to
parent and then we're just going to
throw it into the head and that's it and
that solved that sort of like you know
the link problem of iframes
so we're going to move on to the next
part which is inheriting styles there's
a whole bunch of ways that you can kind
of go about this one of them is you you
have JavaScript on the parent page you
can look at all their style sheet
objects and you could just try and
figure out which of those which of those
rules would target your iframe elements
and then try to make that happen I it's
possible I'm just way too lazy so I
haven't even bothered somebody a
stronger person than me could try you
could just inject some predefined CSS
into the iframe so imagine you have some
you know website provider and they they
provide something akin to like a like a
JavaScript template but its CSS and it's
inside of a script element with a
strange type and you just extract it an
injection to see it inject the CSS in
the iframe I don't think that sentence
made any sense whatsoever I think I'm
going next level on this but anyways
just imagine like the publisher provides
some CSS and you just grab it an
injection VI frame and I mean that
totally works you probably have all the
tools you would need to do that right
now but it's not really seamless it's
not like i can just throw this anywhere
and it's going to look right it would
depend on the publisher to kind of
provide this stuff for us so kind of the
way we've been doing it is is the poor
man's choice in which we just sort of
select a couple things that we think are
really important and we apply those mvi
frame some of those are like color font
color pretty important link color could
be pretty important you know you want
you don't you don't want blue and purple
default link colors when you know the
parent page has specified these really
nice you know hilarious colors like
badass or something like that I don't
know you could select those and inject
those so the way we're going to do that
is kind of it's kind of like a best
guess you know where the iframe element
is in the page you can inject some test
elements next to the iframe figure out
you know what styles
are impacting those elements pull them
out inject them into the iframe so
there's an example of you know I've just
this is like hypothetical situation I
inject an a tag a span tag right next
the iframe figure out what the
properties are so here's a quick example
of this is the pink helping by the way
or am I just making it worse yeah okay
try and zoom into a little bit so here's
a function called get I frame styles and
given a reference to the iframe i'm just
going to generate a span and put it
right next to the iframe and then one by
one I'm going to use this is using
jQuery but jquery has like a computed
computed CSS helper that will just help
me figure out what's what's applied to
this now this is like a really naive
implementation there's a whole there's a
bunch of edge cases I'll give you the
source code later if you're interested
in that or come talk to me but hopefully
you get the idea Justin just injecting
test elements figuring out what's kind
of going on with them and then this is
going to generate a big hash of a whole
bunch of CSS properties next this is
going to look like very much like the
base tag kind of example we got to get
that data we gotta inject it to the
iframe so just like before i'm going to
send i meanyes post message send this
message now hopefully my little protocol
makes a little sense now i'm going to
send styles here's the data and over
here now i'm listening for multiple
messages on listening for the refer
message i'm also listening to the styles
message because it's important to
understand that every message that goes
to this window is going to go through
this handler so I got to respond to
every single type so if i get the styles
message we're just going to check some
styles using a helper function that
looks really kind of really kind of
simple in jQuery jQuery you can just
take a hash of style attributes and just
put them on body and I can
you kind of some you know some some base
styles for your iframe if you want to go
further you can use those base styles
and you can create you know custom
classes that you can apply so that's
something we've done like we create we
have a class called like publisher
highlight color and we take that from
the link color so if you think back to
that example I showed way back in the
beginning or a showing droid life and
there was some pink that we pulled out
that's the publisher highlight color and
we kind of apply that selectively
wherever we want and it works pretty
good so last thing on the list is
dynamic content and this is really this
is the resizing problem it's mostly
about height because I mentioned you can
give iframes with one hundred percent
and that'll work so resizing
fundamentally not too difficult inside
of the iframe you got to figure out how
big the content is you use post message
to send the value to the parent so now
we're going the other way right the
iframe has the content the parent page
is where you're going to actually set
the height attribute on the iframe
element now the thing is is that that's
okay if you're just doing it once but if
your content changes you have to do that
over and over and over again right
somebody adds a new comment to discuss
we got our resize another comment resize
ya think that's pretty self-explanatory
trying to make it more flowery and so
here's a good example of this so let's
say that inside of the iframe I got this
function it's called resize all it does
i'm using jquery here again
I just get the height of the page this
made that may not be super correct but
it's fundamentally correct and this time
we're going the other way so from the
iframe we're going to send a parent
we're going to send a crap this is why i
had this going so we're going to send a
message to the parent window same kind
of protocol idea set height and height
value and now inside the parent we're
going to set our own event listener and
when we get a message that matches set
height we're just going to put that
height explicitly on the iframe element
now so that's pretty easy for doing it
manually like if you know when you're
going to resize stuff ok i'm sure you
guys could all you can all figure that
out but would it be really cool if you
could automatically get stuff to resize
just like the seamless attribute there's
a couple ways you can do it One is using
mutation events which i think is
something that mozilla introduced a
couple years ago problem is that it's
deprecated now it's slow there are
mutation observers which are like heir
apparent to mutation events these are
just sort of like there are events that
fire and tell you when the Dom has
changed and so you could listen to them
and be like oh dude resize problem here
is its dom level forward and i think
it's in chrome chrome it's in WebKit
browsers and firefox no IE no opera I
don't know about ie 10 i'll have to look
at that another possibility is you could
just create a timer using set timeout
and just listen every hundred
milliseconds every half second and just
figure out the size and then resize have
it changed so we don't do any of that we
actually just manually trigger
everything as it happens so
we have this kind of like callback
function that we call update DOM and in
update Dom you're going to manipulate
the Dom in the first one I'm going to
append this div in a second one I'm
going to add a class that make something
bigger and what uptick Tom does excuse
me is it's just going to execute that
call back and just do the rendering but
then it's also gonna trigger resize this
is just kind of like the style that we
use I think that like using this
callback syntax actually sticks out a
lot more because you could do it this
way if you really wanted to write like I
could just manually do this yeah and
then just you know trigger resize all
the time whenever I did this but I don't
think it sticks out as much and we do
code reviews and stuff we want to make
sure that we it's very obvious when
somebody is doing a manipulation that
actually resizes the page so that's why
we kind of go for this style so whenever
you modify the Dom resize the frame kind
of sucks it's not just adding and
removing elements if you change the
style in any way that changes the height
you had a class or whatever you got to
know that that's you got trigger resize
it's error-prone sometimes we you know
sometimes we miss one the upside is that
it's fast if you're using like the set
timeout and your polling you know unless
you're polling every 10 milliseconds
there's going to be some lag between
when you know your content expands and
then it knows to resize the iframe to
fit it and I'm just I don't know running
running code on the loop just kind of
makes me feel bad
so there's kind of a side problem to
this as well we're just gonna dress
really quickly and that's just resizing
resizing the iframe is kind of
fundamentally slow I'll just try to
explain why every time you query the
content dimensions you you force a
browser reflow what that means is that
the browser you know you append upenn
some elements you add some classes the
append are the browser doesn't just do
those right away you know you write a
lot of JavaScript code and you're like
why don't I see this rendering right
away right away it is until the browser
releases and then you see all your
changes happen at once right it's just
trying to be fast it's trying to queue
up all these operations that it wants to
do and it's going to do them in one
chunk it does it by default but the
moment that you try to query like
dimensions of something the browser
can't do that anymore it has to it has
to like flush that big queue of
operations figure out where the content
is at that point and then continue so if
you're constantly resizing the iframe
you're just sort of fundamentally like
flushing causing reflows every flows are
just really bad they're just like one of
the like they are like one of the
biggest performance bottlenecks in in
kind of like web-based software here's a
quote one of the most expensive
functions of a browser Nicholas II
zachos he wrote high performance
JavaScript I thought that would make
this more compelling I don't know so the
way we saw this is we use a technique
called debounce so this up here is
actually it's just the same right i have
my callback and it's just going to I'm
going to update the Dom I'm just
signaling to my code and get update the
DOM and do this code and then over here
I use this debounce function and this is
provided by underscore but there's
implementations all over the place you
know jquery plugin or whatever whenever
i actually want to do a resize i
don'tjust I don'tjust do it I kind of
wait until I have my own cue of stuff I
wait until basically we want to stop
resizing
then it's going to actually trigger the
resize and you avoid the situation in
which you're constantly reef lowing the
browser just to resize the iframe should
probably talk a little bit more about
the balance i don't i don't want to get
into it too much but i recommend looking
into it so basically if you use that
technique you kind of guarantee that
you're only going to get one reflow
every time you're going to do like a
whole bunch of imagine you had like 30
update Dom calls in a row you're going
to make sure that you only got resize
the iframe once you're only going to
query the Dom once and you're like all
is one reflow I put 50 milliseconds on
that debounce time that's how much time
passes before you decide to flush all
your calls I've played around with you
know the minimum amount zero which i
think is like 12 milliseconds it's all
good all right so taking all that stuff
that I just kind of showed you code wise
I got a demo let's take a look at how
good it works so this is what I showed
you earlier we got Armageddon here it's
it's purple and oh damn it I was going
to show you what seamless look liked in
Firefox it's just god-awful you can take
take my word for it oh well here we go
here's seamless here this is like this
is in Canary looks good here's Firefox
exactly the same code that's that's
that's how awesome I think seamless is
so you saw this I kind of resized it and
it knows what to do over here I've got
my simulated version this is using kind
of all the stuff i showed you the code
is not a hundred percent the same but
it's fundamentally the same and kind of
does the same thing what's that
did I temporarily yeah well that's
because i had that probably delay or
whatever i could tweak the delay um hey
man I'm not as good as a browser um I
can add more content works pretty good
you didn't notice at that time did you
uh huh I click this link it works and
it's got its you know obviously it's
like I've kind of like tweak the colors
and font such a way that this is like it
looks really impressive but I think if
you kind of get those fundamental colors
and those fundamental fonts that can
look pretty good right um I think if i
expand this other one I think you can't
actually tell the difference between
them yeah kind of cool
um ooh so there is actually library out
there this is do actually only just
learned about it on the weekend NPR Pitt
had something called responsive iframe
kind of does what I showed you the same
kind of hackery kind of stuff it's a jig
it's like a jquery library but it
actually just focuses on the resizing
problem it doesn't do anything I showed
you with like the links or the CSS but
it's probably good place to get started
because the resizing stuff is arguably
the hardest part and um that's kind of
all I have for you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>