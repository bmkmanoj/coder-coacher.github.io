<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>18 - Android Security - Part 1: Android Bootcamp Series 2012 | Coder Coacher - Coaching Coders</title><meta content="18 - Android Security - Part 1: Android Bootcamp Series 2012 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>18 - Android Security - Part 1: Android Bootcamp Series 2012</b></h2><h5 class="post__date">2012-02-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PUGEqVGIO2o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so it seems like that certain things
were unclear about permissions and this
may be a good opportunity to actually
clarify the loaded to kind of explain
how things actually working under so we
had we have the the security model the
template is based on and the basic
security model basically says look one
app cannot do anything is potentially
dangerous and by potentially dangerous
we mean it cannot improve another apps
data that would be affecting privacy it
cannot do things that potentially cost
money like making phone calls or sending
SMSs or using your internet and so on
and so on right
so the model for holding this this true
is to sandbox the applications right so
each app is its own processes its own
sandbox nothing in the world can intrude
into its security right so so that's got
it works so this is what an application
sandbox looks like right you know just
yet another picture which we've been
talking about all along right you
basically have this is an app it's based
on a Linux process on top of it there's
a Dalek virtual machine which then run
runs any number of activities services
receivers and providers you can have any
number of these you know we right now
have two activities two services in one
receiver right that's what we're at
right now but it'd make pretty mixbag
app on in addition to that you may have
some permissions you may have some
libraries you may have some databases
some files some resources right just
like to put it all between a perspective
MC so if I do adb shell right so if I do
PS you can see that all my all the apps
actually do run is separate processes
right you
see that my Yamba runs here under some
UID called
app 40 some made up you IDs each app is
basically being assigned a UID at
creation time welcome and so you could
type if you want to do it all in one you
could do you could do a DB space shell
space PS or adb shell just gets you into
the shell of your device and then you're
on your own right it's just basically a
Linux very scale down right Wow
I usually start only started twice in a
month so if you look at if we now do if
I do a DB shell if I go into if I look
at PS right and we said our app is
earning a zap 40 on if I go to that
secret directory data data right Alice -
L - Alice - all right so you can see
that each directory is actually owned by
the respective both user ID mg ID group
ID so there's mine so that's how Linux
keeps tab and securing it doesn't allow
anyone else to basically intrude on this
only privacy of another app right on the
data of another app now we are root
users that's why we're allowed to no
just go and poke around Yamba to poke
around that folder it to PWD I mean that
folder that was - shell and so on so I
can go to shared libraries and do LS -
all I can do cat star and I can print
out the value of the username password
and so far so good
so that's the basic model now there is
no we were talking about this is once
you know all you want to break this
model you want to allow somebody to act
to do some things right and you do that
via uses permissions in permissions
right so when somebody says I require
permission okay
then somebody to receive to access that
somebody you need the user needs to say
uses permission and be okay by the user
it's kind of like a yin and yang ada
need to match right so broadcastreceiver
or for that boot receiver already
defines requires permission right so
when you say permission it's ready
employee to receive that notification it
already implies that so you need to have
reuses permission so we do that on the
app level right that's what if you look
at the code that's what we did here we
said our app requires to be notified on
the on the boot received completed
notification and it's on the app level
it's not on a component level I know
that I could have also within this guy
defined a permission so within this guy
I could have done permission again that
would be equivalent of requiring
permission okay let me give you an
example of that that's maybe different
example that actually make sense very
fresh service right check this out well
let me do it like this I'm gonna create
you guys were confused about permissions
in users permission I'm going to create
a brand new permission I'm gonna give it
a name and the name can be arbitrary I'm
gonna call it
dot example dot permission dot and then
make up or maybe counted example dot
Yamba dot permission and I'll make up
some refresh refresh that's a permission
I get to define other things
that's the name label icon permission
group description and protection I'll do
one the only one that I actually need is
a protection model I'm gonna say this is
a dangerous thing to do okay so so I
just define a permission but by defining
it doesn't mean I do it it doesn't do
anything it just I define it they're
like let there be a permission you know
to launch a nuke right now some you need
to if somebody needs to say I'm the nuke
I request that permission so let's say
our app refresh service now is no longer
you anyone can access in launch refresh
service I can now say permission and
then I need to match this letter by
letter it's a proper place that write
permission very formal okay so if I
rerun this on my device
by the way it's like to decide to an
open the other side for camera the
camera is only police led to the other
side all right so let's see yonder menu
refresh
it would be a log well in this case it's
all part of my same package so things
are actually that the protection dangers
is automatically given because we are
defining the permission in my package
already has it but if somebody else one
if let me let me uh let me do this hello
world in America law world I'm really
quickly gonna whip together something
I'm gonna do with your law world wants
to start
remember how we can really quickly do
buttons a public a public void on click
you be right organized import and then
I'm gonna do start service for new
intent this comma re but it's not gonna
work yeah this is not gonna work this
way I can pass a string I can call it
like this you can say comm dot example
dot Yampa dot refresh service I'm not
expecting you to follow this it's more
just a little fYI on how this works
that's more an explanation than anything
else but imports when it comes to
intense they're like a couple of ways to
do intense one of the ways to do intense
is to do them via you know from this
context to that class that works great
that's an explicit intent and that feels
great when you within an application now
we're not in Sullivan application so
this application gives no knowledge
about you know a young boy service and
all that stuff right so the other way to
do it is to make up a piece of text this
is
made of piece of text it could be Mickey
it could be anything right but for me
the ability reasons this is usually how
people do it
right now that's not gonna that's gonna
fail for it to work
Yamba actually they call this repair
service I did the unboxing needs to
filter for that so we would need an
intent filter with an action with the
name that mean if you want to call
something by name as opposed to its
class you have to do it you have to
provide the intent filter and then you
can invoke it by name make sense how
many first round the Yamba tory in
reinstall it with this modification
now I'm gonna run the Akula world
I guess I'm missing a button right old
details only think hello world actually
has that ID button I want to put the
button and I wanted this button to have
one click some left over from the old
world and showing stuff around so
Android on click equals on like that's
the binding
see this crashed right so that crash
because it was a security exception not
allowed to start service intent blah
blah without permission from example
yeah no permission refresh right
so now if I did want to have this guy
use it so down now this guy would go
into manifest file and it could say I'm
using that permission right and read
name and then I need that text that we
defined so it's in the name of this
permission that we defined here there's
a profession permission who's gonna
wants to use
so we're reinstalling it click on button
this time it didn't crash and actually
there's our data right make sense so
basically what I've just done is I took
I define some kind of permission it
doesn't matter I define it in this app
and I say this guy requires that
permission you want to touch my service
you've gotta be approved right this guy
now says all right can I please use your
have that permission and it's called a
match that's what the difference between
permission and users permission right
you're mostly going to be using from
other people's permissions but that's
how permissions work and the system like
you guys know has a whole bunch of Mena
default permissions built in you need a
permission to access the course location
fine location that's your Wi-Fi that's
your GPS right network state Wi-Fi state
battery cell phone camera install other
apps access internet this one we already
had experience with a write external
storage so this is a common you know
permissions that are out there
so in Amba we define a permission and
then in the service we said this one
requires the permission the other
components don't if somebody wants to
launch the activity or want to launch a
receiver or launch launch the other in
the update service this one is not
protected this one is open to the world
right so yeah so you can you know you
can that's this is this like a blanket
coverage of one of the main building
blocks so you just say new requires
permission by saying permission block
right now permissions also come in
different shapes and sizes the
protection level is one of the four
things
it's either and you know if I do if I do
control space you see that four things
right so it's normal dangerous signature
signature system normal means it's a
low-risk a user often doesn't even need
to be asked for it it's kind of like
granted it's more like okay you know
there's something going on here
dangerous means user needs to be
prompted that's the stuff when you
download Angry Birds and says I need to
write to your external storage that is
that it's a dangerous permission right
that's what it's asking you to do that
signature means that only apps that are
signed with the same key are allowed to
access this report so for example if you
want to create a Federation of apps
right many apps running being a whole
right like you may have one app doing
one thing another app do another thing
then you may want to do that just a
signature signature based detection or
signature system which is basically
based on if an app is installed in the
system partition or assigning the same
key it's good enough so we trust stopped
it's in a system partition because
that's baked in at it's in the factory
so it's really unlikely that the buyers
got there you know analyze the factory
none long chips bad stuff right
so that's that's that's that how that
works right so dangerous is probably the
most common the other most common would
be like I said when you do a federation
of things and
remember our design for a yam bomb this
is a different remember how I should
walk it in the design right this is the
design of yam by using a breaking things
apart so ultimately answer being
something like this so we break it into
various apks various applications we
want to keep the client separate from
the data separate from services and so
on why maybe you're building some really
bigger system like it's you know things
in Android work that way quite a bit
right they break an app into multiple
apps right so so in this case you may
want to use that signature based
permission right
so here I kind of had one yam before
just UI I know that we are but to deal
with all the services like web service
is another young but to deal with data
yeah which is a different design they
did for who does they you know they need
to break it apart in much bigger system
so that make sense the dancers the
permission question what it means to
other permission so so yeah so now you
know the question was originally what it
was Kappas if we had a permission to
boot receiver right to add the
permission and that basically means
you're just adding a permission that
somewhere of course it is gonna have to
gather permission but we don't need that
this case yeah yes yeah so in the boot
complaint so when you when the app is
installed when you install the app and
that happens by the way every time you
click run right when the app is
installed this manifest file gets
analyzed something says oh look you got
an application oh look this application
has an activity all of this activity
wants to get now you guys know what this
means right
wants to get this activity it is the
main entry point for the application
and it should be added to the launcher
which is basically your drawer where you
pick the apps right yeah so okay so now
we know that oh look there's another
preference activity oh look there's
another service oh look there's a series
it requires permissions in response to
this message right so this this gets
parsed at install time and sorry it gets
part of the install time and at that
time what happens is this is registered
somewhere so from now on we know that
the that when for example this that when
this happens this guy gets means needs
to know you get notified inside right
the channel is a good time
I think so sorry the install time so
when we finished booting the system
already knew who wanted to know about
this and subsequently it's actually
going to start our application</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>