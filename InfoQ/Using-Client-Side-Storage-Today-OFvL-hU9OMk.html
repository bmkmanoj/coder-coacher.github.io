<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using Client Side Storage Today | Coder Coacher - Coaching Coders</title><meta content="Using Client Side Storage Today - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using Client Side Storage Today</b></h2><h5 class="post__date">2013-02-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OFvL-hU9OMk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so as I was saying this talk is going to
be about client-side storage so during
the stock I will typically be talking
about not suitcases with storage this is
the only image of storage that I could
get on the internet I'll be talking
about storage on the browser and using
it today now I know what question you're
asking me the question you're asking me
is why did I say browser and put that
icon there well okay that's also the
browser and in fact a lot of people
today would say this is the browser so
yes we want to be typically talking
about cross-browser storage and when
you're talking about it let's also talk
about how to secure this and use it not
just today but also like for the
browsers that of that are of yesterday
so that's what the talk is going to be
on it's going to be on client side
storage and using it today before we get
started a little bit about myself my
name is parshuram that's a long indian
name and i'm sure that it's kind of
going to be hard to pronounce you can
call me acts as it happens to be a
partial arm in Sanskrit means a man with
the axe and by profession I'm an
engineer I like building stuff specially
mobile stuff and I've built some heavy
duty stuff for Microsoft and sneak peek
not that I'm implying that I've built
sentries and stuff like that I mean I i
I'm all for peace so and then I also
have tiny hobby projects and that's who
I am on Twitter well you must have seen
from the images on the side they were
like a lot of gaming images I am a huge
fan of team fortress how many here play
team fortress wow that's a good good
number awesome so he has gone to here's
what the agenda is going to be I wanted
to put a tough guy image there to make
the talk serious but I really hope that
because this is going to be a how many
of you here our database administrators
0 how many of you here are front-end
developers
almost all of you awesome so you know
it's kind of hard to talk about storage
and databases to a front-end group and I
hope that I am able to make this talk as
fun as possible and that's why I have
all these references to team fortress
though it's all a reference you really
don't have to understand team fortress 2
understand the stuff but it will be
awesome if you are able to get onto team
fortress but anyway so yeah that's the
agenda what I wanted to do was reduce
the big guy to a smaller part basically
meaning have less slides and get
something even heavier get more code in
yeah get some heavy-duty stuff by the
way that animation you saw there I
actually took some time to do it on
google docs kind of looks cool right ok
so as I was saying this is pretty much
going to be the agenda it's going to be
using client-side storage today just
talking about three points anyone
recognize this anyone who's well there
are actually a lot of people who are at
least as old as I am that's good so this
is the zark game and a kind of Zorka
fight the presentation in a sense that
rather than me driving the presentation
I think it would be cool if you guys are
able to try the presentation the idea
being that I mean frankly to put it I
really don't know what you guys want
here and my manager has taught me to
delegate anything that I don't know how
to do it and when I'm delegating it to
you and tell me how you want me how you
want the presentation to go so through
this presentation we will we can take
different routes different paths I just
be mindful that we have only very
limited amount of time and a question to
the team fortress fans here what images
this this is the dead ringer it's it's a
game thing so anyway another thing I
wanted to talk about was if you have
heard me talk before about index TV this
is actually a little bit different in
fact it's a lot more different because
the last talk I gave was six months ago
and in six months I've actually had a
lot of time to play a lot of games and
write some amount of code and it
actually in incorporates all of that the
image that you see is basically a
representative of that how countess file
used to be in the older x vs
the latest version so as the business
people say it's new and improved and I
guess you are the guys will have to
judge so talking about using indexeddb
or using client-side storage but what
can you really do with client side
storage well how many of you here use a
web-based client like Gmail hot hotmail
Gmail anything like that how many of you
use a desktop client and if you notice
the split here is like fifty percent so
it's kind of half behalf of us use
web-based by the other half use desktop
and the biggest complaint that desktop
mail users have is that their web
clients cannot work when they go offline
wouldn't it be cool if this entire part
of gmail was taken and stored offline as
a client-side thing I mean they they
were doing it using Google gears and web
sequel but Google gears is now
deprecated and guten Google guess is not
not maintain any longer wouldn't it be
cooler if this was available offline or
even to start with something like to do
lists this is the this is remember the
milk they also have an offline version
again based on gears not supported
across browsers and not just that but
even for ecommerce sites how about
bringing on the catalogs offline or how
about bringing your shopping list
offline not only will bringing it all
offline make your site's faster it will
also give users a very very good
experience when you when they are not
online and that's actually very relevant
especially in the mobile world so a
quick glass through about how the local
storage scenario was and people would
even call me crazy but because I'm
mentioning cookies when I'm talking
about local storage but cookies is
pretty much this it was like a primitive
primitive way of doing it all that we
has really really clever engineers have
done is put in a nice track kind of
thing on top of it and we have kind of
glorified cookies but let's be real
cookies are just not meant to be a thing
for local storage yeah the second thing
that came after cookies or something
that we are very comfortable with is the
local or the session storage concept
where you just have a very simple window
out local storage or window dot session
storage and it's like a key-value bag
that you can add stuff to so that's
local storage
and it was actually pretty useful but
then it was overloaded we started using
local storage for everything right from
network caches to say actually storing
data base kind of stuff how many of you
here use local storage for real websites
not many that's that's actually good so
does that mean that you do not have a
requirement for storage or is it more
because local store is not the not the
right thing to do it could be one of the
one of the two so yeah this is where the
game part comes in do you guys want me
to go on to web sequel or do you want me
to talk a little bit about some of the
local storage libraries libraries how
many how many people want to get into
libraries that's actually a good number
awesome Google Docs and hyperlinks doing
the magic so there are a lot of
libraries for local storage primarily
because it's been around for like three
four years and I think all of them do
some do very very similar stuff these
were some of these were the ten
libraries that have actually had
experience with and there are a lot of
other good ones outside let me quickly
go through all these 10 I will be
putting up these slides on my blog and
on SlideShare so you probably don't have
to note these down these are these are
in themselves very good philosophies of
how differently local storage can be
used for example if you notice there is
persistent jazz which kind of does web
sequel a little bit of local storage and
also supports google appengine storage
or no JS kind of paradigms there's also
the other category that does local
storage with tables and queries or so if
you have like local storage DB you have
like the Dom storage query language
these are kind of sequel languages kind
of type of local libraries local storage
libraries that let you do a little bit
of querying and then there are some
local storage libraries that come
built-in with
javascript libraries like Yui or dojo
and that's kind of the landscape if you
notice and the library that you choose
for local storage is primarily dependent
on one what is your overarching
framework or what is your general
JavaScript framework I mean if you want
to use yahoo user interface Yui library
as a joust remember you probably won't
look at any other any anything else
except say Yui cash offline or if you
were to use dojo you would probably use
your dojo storage and that's primarily
what dominates what you want to what
local storage library do you use and as
you can see a very good a very
interesting point to note here is some
of these libraries are actually trying
to trying to be just storage libraries
and support at the back end they
supports things like say local storage
or web sequel and that's actually a good
thing because this way all of these
local storage things can become faster
and also give you cross browser support
so going back to our main story line
again a local storage is available in
mobile so technically they do work in
mobile I personally have played around
with persistence yes and that does work
in mobile but I'll hold a thought for a
minute because if you're thinking that
wow they work in mobile this is how I
should go probably there's some good
good stuff that's coming towards the end
and so just hold hold hold that thought
was sometime so yeah that's local
storage and after local storage was this
whole brilliant effort by Google that
started as a google summer of code
project it was called web sequel and it
was a very very simple concept the idea
was almost all browsers those days say
Chrome or Firefox they did support this
underlying embedded database called
SQLite the idea was why not just pick up
SQLite expose it to JavaScript and why
not every every web page start using it
was a brilliant concept at that time
because the only available storage
mechanism so probably local storage and
the bad API that that is called cookies
that's how it started so as they made
shows you actually can poke around and
see what the engine is doing and it's
it's like a it's like the engine part of
the trailer truck and you can attach
attach any payload
payload that you want and run your own
queries you can do stuff like create
table from blah or you can say select
star from and you can you have the power
of queries how many of you here have
heard about web sequel or have had an
experience of with it that's a good
number so do the others want me to go
into what web sequel is a quick
introduction yes how many asses the
louder the better yes awesome so what is
this what does this look like it's a
browser the whole concept of web sequel
as are saying was it's a database inside
a browser so far web sequel you pretty
much have a database you can have
multiple databases and the way these are
separated is exactly the same their
cookies are separated they are separated
by craw by the same origin policy so for
one origin you can have multiple
databases inside a database you have
this whole concept of a transaction the
whole point being when you do multiple
operations you want them to be
encapsulated inside one single
transaction it's one or nothing and
every database can have its own version
of transaction and from this transaction
you can directly access the sequel I'd
database you can pretty much to execute
sequel commands so that's the kind of
sequel commands that you can actually
directly execute and if you look at the
google chrome source code i'm not sure
whether it's a good idea to pull it up
right now but let's just see so let's
see yeah so it's in trunk
webcor
you know what I think I'll pull this up
later but the point I was trying to make
was if you actually go into the google
chrome source code and look at the
sequel statement it will pretty much say
execute sequel and then it will pretty
much pass in this sequel statement that
you've given to directly to the database
engine of course with a lot of
sanitization and stuff so that security
of the sandbox is maintained but that's
the whole point the standard itself
basically said web see a web sequel that
that's the name of the standard so the
standard said you should be able to
execute any sequel come up query and the
sequence should be formatted as a
specific version of the sequel light
sequel language well unfortunately going
back to our main story unfortunately
this is something that not all browsers
could agree upon if you notice i was
mentioning repeatedly i was talking
about chrome and firefox and to an
extent safari also but this is something
that internet explorer could not do for
two reasons first internet explorer is
not open source sequel light is it's
probably going to be harder for
microsoft to take a non open source
project put it into next into into in
the internet explorer without having to
probably say dilute their licenses and
stuff the second thing and the second
more important thing that microsoft
actually brought up was why should a web
standard be so very closely linked to a
standard of an open source product and
remember that its sequel itself as a
standard is completely different web
sequel was talking only about sequel
lights implementation of the sequel
language and that was actually bad and
looking at looking back at it right now
it looks like it was a good decision
that microsoft made primarily because
google now has replaced a web sequel
with index TV and their underlying
database is leveldb and some of the
performance tests that i have been able
to run indicate that level DB is way
faster than Google Google's
implementation of web sequel and that's
actually a good thing so in a way it did
help innovation so while all this was
going on while I told you the story of
what why Microsoft and
even Mozilla to a very great extent
thought that index TV was a good idea
and web sequel should be retired that's
when the whole concept of indexed DB kmm
index DB is basically an is am based
database indexed sequential access has
anyone here played with berkeley DB a
couple of them so buckley the whole
concept here is that it's not really
relational in the true sequel sense
where you can have foreign keys from
between one table to the other the point
is you can kind of store key value pairs
and probably I trait over them and index
some values it may kind of look a little
bit heavy right now but let me go into
the introduction of index event tell you
how it works so index TV wanted to be
something like this any guesses on what
this is I am not able to hear any cases
it's a truck okay but people wanted it
to be this Optimus Prime they wanted
index TV to be converted to be a
convertible super powerful robot but
there are a lot of people who think that
index TV is this it's just a is just a
collection of truck parts it's not a
whole system in its own and it's not
usable at all and the whole the the
JavaScript community or the front-end
developer community is very very divided
on is index DB really the next is it
really the fusion thing because it's
actually not as powerful as web sequel I
mean in the index if he doesn't have
queries and is that a good thing or a
bad thing people are not sure through
this talk i hope i am able to give you
my opinions and you guys can decide so
submission minigame anyone wants to do
index TV time introduction yes how many
s's how many knows ok so we accept the
submission and quickly our index DB
refresher what is this awesome and this
it's a database inside the browser
pretty much very similar to web sequel
and exactly like web sequel you can have
multiple databases but if you notice
this one extra concept that i'm
introducing here called an object store
so inside a database you have an object
store and the object store is very very
similar to a table it can hold a key and
so they're only to call columns if you
may want to call it you can you can hold
a key and a value and you can hold
multiple key value pairs and this is
pretty much a simple table structure the
key there there are different types that
can be keys there are different types
that can be values i'll talk about it
later and once you have a set of these
values you would like to iterate over
them and the best way to I trade over
them is a concept called a cursor this
is a database concept where a cursor is
effectively a something like a pointer
about where you are during a writer
ation it's like it's like it's like it's
like the I counter in your loop and so
what you see here is it has an object
store it has a cursor and on these key
values or on these values you can have
indexes and indexes are pretty much like
say you have a JSON object and what one
of the properties in the JSON object is
a price you can actually have an index
on top of the price I probably tell you
why you need indexes as we go further
but for now just think that there is
there is a requirement for indexes and
you can I trade over indexes and what is
this this is exactly the same replica
same story you can have multiple keys
multiple values and indexes let me
quickly pause here and ask you if you
have any questions any questions is this
clear is this confusing how many think
it's okay it's clear that's a good
number anyone still confused okay so
some interesting parts of the API or how
the whole API was designed so if you
notice local storage is a synchronous
API which effectively means when you
once you want to set set an item or once
you want to write data it probably is
going to pause right
to the disk and come back that's not a
great idea for web applications given
that javascript is single threaded so
that's primarily the reason why index TV
has a synchronous and asynchronous API
the synchronous API is available in web
workers the async is available on your
window object as far as security is
concerned it's the same security as
cookies so it's about same dose same
origin policy it stays say is stored in
the is in almost the same place where
your cookies are stored and stuff like
that and the whole concept of index TV
revolves around the request so what you
do is you start you say I want to open
an object and what index DB will give
you back is a request and on the request
you say request at on success do
something request dot on error do
something else and the whole of index ZB
API revolves around this concept of
requests you probably think this is a
little bit heavy for now I will be going
into code questions very very soon i
will show you code examples very soon
and i hope that makes it clear apart
from that there are all of these
requests and responses they're all
inside transactions you can do multiple
reads or multiple rights inside
transactions and there are three
different types of transactions
typically in any as in any database
there's a read there's a right and a
part on that there is a special
transaction called a version change
transaction that occurs whenever you
want to say change the schema or create
a new object store or delete a new
object store and finally when I said the
keys can be JSON objects they cannot
take it they they can actually be JSON
objects that can be reproduced I mean
you can't just have a dom node and save
it into the database and when getting it
back that dom node doesn't make any
sense right so there is this whole
concept of a structure cloning algorithm
which clones your JSON object so that it
is independently reproducible and
finally keys can be of different types
keys so JavaScript so question is
JavaScript the untyped language or
loosely typed language it's a loosely
typed language right so when it's
loosely type how do you how do you deal
with keys or how do you know if number
one is gray
than a string a for example indexdb
defines those kind of collisions and it
says that this is how keys are encoded
and yes some heavy-duty stuff let's look
at some sample code so actually you have
three choices here you want to look at
sample code do you want to see how
firefox or chrome implements it or do
you want to go back to the main thread
code sample code browser implementations
wow there's like zero people ok that's a
good sample code so I put up this sample
code thing where you can look at how
indexdb code looks like so I'm sure this
is too too tiny to reiterate are you
able to read it this ok so unfortunately
like with most vendor prefixes you will
have to jump through the hoops about
creating index TV so if the window dot
index TV object is not present you'd
probably look for a Mozilla's
implementation or you would look for
WebP WebKit implementation or you would
look for Microsoft's implementation
notice that Microsoft ie10 actually does
implement index TBN I think all the
three browsers are or have either
completely unpredictable almost
prefixing it because I remember that
Mozilla like a couple of days ago they
did an prefix it WebKit also had
unpressed increment ation very very like
a couple of days ago so that's that
that's that's how you get started and
you get hold of the indexed DB object
then look at let's look at the second
example of opening a database opening a
database is very very simple let's just
look at this part so what does this do
any guesses what this statement does it
basically opens the database and
remember I was talking about a request
concept where you have where whenever
you try to do something it it gives you
back a request object and then you do
stuff with the request object that's
what is exactly happening and that's
what makes it a synchronous so window
dot index leave a door open or index d
vidot open immediately require gives you
back and open open
idb request object and what you do is to
this request you kind of attach a
success handler you attach an event that
needs to be called when the version
changes and you can kind of continue
doing that with what happens if there is
an upgrade needed or what happens if
there's an error or what happens if this
same database is opened in multiple tabs
in that case a blocked event is raised
so what you notice here is in all these
cases events are raised on your request
object so yep this is how it looks like
and once you open an object let's say
you want to like say write data to it so
let's look at adding data so the code
that you see here is all about my sample
I'm just constructing a random test data
and the best way to do it or best way to
write it is just this you do something
called object store not add and all this
does is it simply adds it or writes the
data to the database you may ask me the
question where did I get a handle to
object store right so let me show you
that bridge also so let me go here and
show you what transactions are so
remember when I had done DB rot open I
gotten a request object and using that I
had got this variable called d DB which
is which affect Lee represents my
database on the database I can open a
new transaction using the dot
transaction method and I can give it
what should be the name of the object
store and what should be the type of the
transaction in this case it's a
read/write transaction and once I do
this what I get back in return is a
transaction object and it is using this
object that i can say transaction dot
object store and we give me back an
object store so three or four steps to
writing to really writing data first
open a database when you open it it will
give you back a request object so let's
actually look at the whole example
together so
let me expand the data operations again
so there is this neat little button
called load prerequisites which kind of
loads the whole thing so let me just do
that and yeah so you remember this code
right this is how you set it up do you
remember this code this is how you open
the index database object and if the
data is a successful this is what is
called I was able to read it when I
highlight it yes okay so this is what
happens when on the onsuccess object and
what i'm doing here is on success i get
a handle to the database that is this
and let me skip over all the extra
things because i don't worry if there's
a version change or not and let me
quickly go to the transaction part so
once i have the database object i get
that transaction out of it and once i
have the transaction with me using the
transaction I grab a hundred to the
object store there you are and once I
have the object store I'm going down a
little bit more and here you go this is
how it looks like do you want me to
continue showing you more examples or
shall we go back to the top because
there's a little more to cover in the
talk and i'm not sure if i will have
time for it do you want to see more
examples or go back okay this this these
examples are hosted off online and i
will be giving out a link at the end of
the top so you can actually go go go to
this website a player on whether it
click on different examples see how they
run click on load requisites and you can
run them inland and see how they run so
let me quickly go back you want do you
want to see the implementation on
firefox or chrome awesome but a quick
note there i was i was really hoping i
can show you the implementation and
firefox or chrome but given that you
have decided not to go that route a
quick thing is if you use the SQLite
manager which is a firefox add-on you
can actually open up your index ZB
databases in Firefox and actually see
how they look like and through these
examples i can i'll also
showing you how it shows up on the
chrome developer tools so we go back we
did this and we have done our submission
and yes so if you notice for writing
indexdb you have to do four things right
what are the four things the first thing
was opening a database second was
creating a transaction third was using
the transaction get a handle to the
object store and forth is actually right
to the object store that's kind of hard
so you know indexdb in itself does not
seem as powerful you know what would be
better you probably upgrade it upgraded
using libraries you know want to be even
better upgrade it even more using
libraries and that's what the rest of
this talk is going to be about so there
are a bunch of really good libraries
that i have seen out in the open all of
these are open source libraries that
play very well with indexdb your choice
which library should i look into jake
how many people want to see the jquery
index ZB library ok that's a good number
i probably would do that first how many
of you want to see the link to index DB
library not many how many of you here
know what link is linq that's a good
number ok so let's start with probably
the jQuery index table library so the
reason I came up or I wrote this library
was because I really did not want to
write so much boilerplate code every
single time so you know what I did I
would yeah this is the best place to
look at it so you know what I did to
make it simple here's what I did I'm not
sure whether this is visible but yeah so
here's how the library looks like it
says dollar dot index DB dot object
store dot add and then it returns a
promise back whenever the addition is
completed is this better so this is a
lot more usable rain and that that's
primarily the reason why I wrote it
because all the samples that I wanted
right with index TV I thought I didn't
want to write like those four states
every single time when I wanted to do an
ad and this is how this jquery library
looks like
how about say aight rating over the
objects or listing all the items so this
is how it looks like is this readable so
it says dollar our index DB dot object
store dot each consolidating fo so its
effect lee very very similar to what
jQuery does when I trading over elements
and this exactly does the same thing for
you now let's look at how it looks if
it's the whole index DB if I was to
write native index DB code so I just
targeted the full code and here's how it
looks like so what you did is you open
the index DB library you got a
transaction which is this line you got
an object store which is this line you
opened a cursor which is this line and
whenever the cursor is successful you
start you continue writing or you
continue displaying it and you have you
have to deal with error conditions at
every single point of time so the
advantage of the jQuery index ZB library
is in the each if you have an error you
can actually say then do this so you can
use the jQuery Deford switch is then
success comma failure and that's
actually the biggest advantage because
all of your error error handling and be
done at one place or can be done at into
individual steps whatever you prefer do
you want to see more examples of how the
jQuery index DB library is yes I heard
one year so I'd probably like show one
more let's see how it looks like let's
look at something that's interesting
yeah let's look at indexes for example
so this is how indexing looks like in
jQuery index TV there you go all you
have to do is just like an object store
you can open up indexes and then you can
I trait on top of indexes so here in
this case you i iterate on price let's
go back
so here are my slides so we did look at
jquery indexdb libraries we have five
more doors to go which one do you want
to go next the people who shout the most
are going to that that's about you're
going to go so where do you want to go
back born awesome so this actually came
in very very early even when indexdb was
in its infancy and it's actually a
pretty good library because it it makes
a lot more sense to GL it with backbone
because if you notice backbone models
themselves can actually be persisted in
indexdb right and that's what that's
exactly what this does so as soon as I
bring it yeah so if you notice backbone
has this so both backbone and the jQuery
indexdb library have this constant
really nice concept of migrations where
this is what you do whenever you start
up your model in case of say a backbone
whenever you are defining or doing a
backbone dot model that extend you also
want to set up these things called
object stores because this is
effectively the way you are telling
backbone where my data should be stored
so this is basically a little bit of
housekeeping I'm saying that I need a
data I need a object store called movies
and in that movies I will probably have
indexes for title format etc and then
the model itself is very very simple
it's pretty much the exact same backbone
model you create a new model and you can
do a fetch and this fetch will
effectively fetch from your index DB
library and the bigger the bigger
advantage is the whole point of
collections so when you're doing fetch
with collections you can actually do
sudo queries you can say get me the
movie or get me the theater that has
that is at offset one and is that limit
three and on success to such and such or
you can specify ranges or you can
specify a little bit complex queries and
if you notice here in this case you have
no idea or you have you don't really
have to understand anything about index
DB all you all you need to know his
backbone models and you just need to
know the fact that you want to sync you
want to save it on your on your local
disk and this actually does a very
very good job of it and if you notice so
this is this is yet another example and
then the final part is how do you sync
it back to your server this is actually
very very cool because not only can you
save the data on your local disk or on
the low user's machine you can actually
save it and then sync it back and it is
the usual a jack sync method of backbone
and this is actually pretty cool pretty
much abstracting or ensuring that the
developer is not confused by index TV
and continues to work in their comfort
zone of backbone so that's the backbone
library
who's next how many of you here love
couchdb not a lot of people do you want
me to go in louder awesome so actually
let me not go in here and if we should
show you couch the same where I was
showing you examples so if you notice
couch also fits in very very well with
the whole indexdb paradigm because couch
is also about object stores it's also
about key value pairs it's also about
hydrating and stuff so yep there you go
Justin yeah
so this is how you so in case of couch
for example this is how so couch this is
a couch like a PIAA it's called portable
couch or pouch for example and hear all
your URLs are prefixed with an ID be
colon slash slash instead of actually
referring to the referring to a real
back end server and what you do we do is
when you create pouch and you say this
is your database name you will have you
will have direct access to your database
your indexed DB database remember this
is local this is not remote and then if
you want to say create a document let me
load load prerequisites so what you have
is you created the database this way and
then you say D V dot post and you are
you here your document is printed your
document is uploaded you can continue to
do things like fetching documents or say
querying the database in the exact same
method querying is almost similar across
all these laboratories and if you notice
does this feel like ouch does this have
a good feel of couch yes right so that's
actually that that's even better because
in this case now not only can you use
couch on the back end you can actually
use javascript you use couch so that it
synced between your back end and your
front okay so go on or one more library
oh yeah the question is there something
about the mobile world you probably have
to hold on a little bit more and I'm
running out of time so let me actually
yeah this this is where the mobile comes
in so this is actually a very good
picture that I i came across about so I
searched for browser incompatibilities
and google shows me this picture how
much more app can it be so the whole
landscape you have index DB on one side
index DB supported by Internet Explorer
Firefox and Chrome the other side of the
bridge you have web sequel which is
supported by Opera Safari and chrome
again so chrome is a chrome is playing a
good citizen by being on both sides of
the bridge but pretty much you know what
this means for the developer it means
this a developer cannot use index TV
right now a developer cannot use web
sequel right now effectively meaning
developer cannot use client-side storage
right now well once you have bridges
like this once you have badly built
bridges like this you also have people
who come up with interesting bridges
that kind of our bridges between bridges
so the picture that you see here is a
bridge that's between Hong Kong and
Mainland China the way it works is I'm
from India and the way we drive on the
road is completely opposite to the way
we drive a drive in the US and that's
actually true between Hong Kong and
Mainland China and the traffic so
instead of like putting say traffic
signals in stopping the cars that are
coming in from the right to make way for
the people who are going to the left
this really really interesting loop
pretty much in versus the way once
you're going from China to Hong Kong or
the way back so that's what it does it
is actually a bridge between the bridges
and that is exactly what the index DB
polyfill is so I was playing around with
this whole idea about using client-side
storage and enabling offline stuff on
the mobile special or at least enabling
of offline stuff on desktop browsers but
if I cannot support all the browsers
it's pretty much a failure and that's
pretty much what prompted me to write an
index DB polyfill for all these browsers
and hence meaning that the index CPI
pair can be used across all these
browsers and this so let's quickly look
at an example so I have
index DB so here's the index DB example
opened in Firefox so I say it is very
simple web store it's a sort of an
e-commerce site where I have like a
whole bunch of items it's probably books
yeah I have like a whole bunch of items
and I can say add to cart and when I add
to cart it's kind of stored here and
when I say move to wish list it's kind
of moved moved to memories the whole
point here being there are three data 33
object stores the first is the catalog
the second is the car and the third is
the wish list so if you want to see this
in chrome for example so it's exactly
the same thing i do this i move to wish
list and if i open up my developer
toolbar quoted resources go to index TV
that's exactly what you see you see that
my database is called is this visible
better so it's X it's effectively this
it has a table it has all these three
different object stores which basically
means I'm not lying this is actually a
live example and it works I mean in case
you guys had to the question so it works
on Opera also opera doesn't support
indexdb in fact let me do it and show it
to you it's yeah this is not a
screenshot there you go I can actually
do stuff like sort show all sort by
price etceteras sort by price is
basically price being the index it works
on safari also and when I say it works
in safari it means it pretty much is
going to work on your mobile browsers
too so there you go and in case of
Safari if you take a look at how it
works or how its implemented internally
it's actually implemented using web
sequel so it's the whole same story
again except that in this case all of
these are tables and the very and the
index DB polyfill pretty much stores all
of your values in tables here and I
think the bigger the best illustration
for this is google chrome because chrome
supports both of them so let me go back
to Chrome if you look at this here in
chrome there is
there is this guy called databases which
shows me all the web sequel databases
that I have and there is this index DB
that shows me all the index CPI index
databases that I have and in case of
Chrome I can switch the example to run
either on web sequel or on index DB so
going back the question is how does it
work on phonegap well here's my Eclipse
code if eclipse things that is cool
enough to open yeah so here's my Eclipse
code it's the same story on phonegap I
have a regular rudimentary Android
application setup all the magic happens
in the assets dub dub dub folder and if
you notice this is the exact same
example that I was showing you it's the
same source code here with the addition
of the fact that on my index 1.html I
have included
I have included this index DB polyfill
and what this does is even in android
and on the iphone it pretty much uses
index TBE a polyfill uses web sequel and
adds in all the data there so does that
I'll see a mobile question okay so going
back so that's the index DB polyfill and
apart from index DB you also have a lot
of other libraries that just do a save
value and return value back and these
are these work across index DB web
sequel and a local storage and these are
these are three of the libraries and I
actually came across they pick up the
store that is available and acts you can
actually use these today to ensure that
your data is actually persisted on the
client and the last section of the
presentation is going to be about
performance so given that it's about
index TV shouldn't it be fast I think it
should be so I was able to write a
couple of performance benchmarks here so
this is a this the google this is a gita
project that i was able to that I clone
from a different project and I basically
added browser Scrope to it it this will
fail on firefox because there is no web
sequence so let me run this on chrome
because chrome has both of them so run
it on chrome close my developer toolbar
and this basically compares local
storage web sequel and index DB and if
you notice here there are cases where I
mean in this case I am trying to save
something to the local storage is like
almost instantaneous but if you're not
his web web sequel is actually a little
bit faster a little bit slower than
index DB let me just reduce this yeah so
there are cases where web sequel is
faster there are cases the where web
sequel is slower than index TV and this
is effectively depending on the type of
data that i am writing and the way i am
writing these data these tests are also
available on github and i welcome you to
play around with it to see how it suits
your data and how it works for your data
and finally if you really want to play
around with index DB and see how it
works i think the best example is this
how many of you use chrome tracing for
your everyday performance analysis
chrome colon tracing one okay so the
good thing about this is chrome Colin
tracing actually adds support for index
TV so let me start recording and let me
say go to my example here and let me do
a couple of operations
then I say stop and what I should be
able to see here in this really really
ugly looking graph is if I'm able to
find it it is effectively that whenever
whenever indexdb operations happen it
shows that one of these bars will show
that it's an IDP transaction or it will
show that it's an it's actually writing
into the object store or its reading it
from the object store and this
effectively will also let you know if
you want to put multiple transaction
into using window at set timeout or you
want to use one transaction and write
multiple values and things like that and
yep so I think I am almost out of time
and like all gamer once you're at the
end of the level you will typically be
thinking I probably should have played
those other parts that I haven't played
right now looks like we don't have time
for it but I will be hanging around here
I will be more than happy to answer your
questions and while I'm answering your
questions these are the links this is
where most of your most of things that
you would want for index TV would be so
in the interest of time I think I'm
going to step down I'm going to be
hanging around here if you have any
questions or if you would like to use
index DB in your day-to-day applications
please come talk to me I'd be more than
happy to help you thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>