<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Fundamentals Training - doctest | Coder Coacher - Coaching Coders</title><meta content="Python Fundamentals Training - doctest - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Fundamentals Training - doctest</b></h2><h5 class="post__date">2011-10-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/j5184ZBBVv4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so let's take up one more topic and yeah
this will be the last topic for the day
I think in your curriculum if you're
paying attention to it you'll note that
our labs are different I did want to
make sure I pointed you at the lab
download if you're looking for extra
work to do which I know you're all are
going back to your hotel room and write
and multiply Thun code here yeah at
Simeon Franklin comm slash Python labs
if there are files that contain the labs
that are in your curriculum and we're
mostly covering the same topics I'm
trying to rewrite the labs in cohesive
fashions or kind of tackling the same
task and gradually adding features to it
instead of each lab being completely
independent which fits how I learned
better anyways we're skipping section 12
which is regular expressions my
justification for skipping regular
expressions are the Python
implementation of regular expressions
are pretty simple but regular
expressions themselves are complicated
so if you already know regular
expressions they'll be easy to pick up
the in Python implementation and if you
don't know regular expressions we don't
have enough time in the class to teach
you what they are so that you can then
learn to use them but suffice it to say
it's a language with a it's a mini
language with a syntax for doing pattern
matching on text in sophisticated
complicated ways and if you do shell
scripting or perl scripting or something
you're probably pretty fluent in regular
expressions already and python has a I
believe it's pcre compliant reg X
library so it's just like 4x is more or
less than can do all the same sort of
stuff if not quite as fluently since
it's at library level instead of
syntactic level so skipping the re
section which is section 12 I'll talk
about doc tests now let's talk about doc
tests next on the resources page that I
have up I have a overview of doc tests
it's just a link to the Python standard
Lib documentation and it describes doc
tests
it's worth reading through to see all
the various complexities of duck tests
but I can describe them very simply and
run you through some examples and then
I'd like you to add some doc tests to
your classmates file even some simple
ones and be able to run them so the idea
with duck tests are we can embed sample
console sessions in the docstrings for
our program and its functions and we can
append the required output from the
console session below the sample console
session and the doc test module will run
our code grab our doc tests look for
anything that's formatted like a console
session and execute it against our code
so this all sounds really complicated
but it's actually super simple and let
me demonstrate
let's write a function that takes list
and returns a csv string with a new line
and you all have just written this line
of code hopefully
so this should look pretty familiar to
you so function you pass it any
arbitrary length of sequence it joins
via comma and appends a new line let's
find my console here
and hey it works we can tell if there is
a new line in the string that's returned
because there's an additional new line
outputted by the print so we've got a
blank line and how do we normally tell
that our stuff works well we just run it
and if it looks like we're giving the
right output then hey it must work but
we haven't really tested it and if we go
in and change we need to remember to
rerun it and look at the output and
hopefully not miss anything the verify
that it still works so let's put in some
tests and let's make the tests also be
somewhat useful documentation doc tests
start with that three arrows thing and
they're just getting that from the
standard Python console right you notice
there's three arrows off to the side
that's the start of every line
so that's a console session I'm calling
a function format line and I expect to
get back
ABC / in okay now I can run my tests in
a couple of ways I can import the doc
test module past the doc test module the
name of the module that I want to test I
could switch my if name equals main here
again to import the doc test module and
run it on myself but one shortcut
frequently used is to use the - M switch
of the Python executable - M lets you
specify a module that should be started
so I'm running my Python file but I'm
running it with in some way the doc test
module and the doc test module complains
and says line six or the doc string for
scripting dot format line has
inconsistent leading whitespace
and I can see that it does I've got one
space before okay line six with a doctor
one two three four five
now it doesn't like the inconsistent
leading whitespace there
consistently in white space and it has a
single quote what did I format wrong
let's make this deliberately wrong to
start with there we go okay so back here
fixing my formatting failures I've made
it deliberately wrong I took off the new
line at the end and also took off my
quotes my double quotes were throwing it
off and when I now run Python - am doc
tests on my scripting file it says
failed example you called format line
with ABC as a sequence you expected to
get back a comma B comma C and instead
you got back single quote a comma B
comma C new line ending single quote
well that's actually the format that I
want so I'm gonna just my test to be the
proper format I'm trying to adjust my
test to be the proper format and it
still doesn't like my leading new line
why not
okay let me read the duck test example
myself
get rid of all the leading New Line
nonsense
that fixed my leading whitespace problem
and just noting here the docstring does
have to be indented the function body
has to be indented it's like if I unand
nted the first line of my doc string
this would be a syntax error it expects
an indented block but once I'm inside of
my triple quoted string I can do
whatever including starting at the begin
of the line if I want to which I am
because for some reason my initial tabs
or spaces are throwing it off and now it
once it's literally putting in the new
line there we go
as with many UNIX tools silence is
golden so the fact that it just said
nothing means that I was successful but
that kind of bugs me someone uses the -
V switch which makes it verbose in
output and it says okay I'm trying a
test format line pass at this I'm
expecting to get back a b c /n and what
i had to remember to do is literally put
the string slash in which means i
escaped my new line or I escaped my
backslash twice that's correct
one items had no test what um what had
no test what things can have a doc test
or a doc string rather I've got one up
at the top right your whole file can
have a doc string as well as each
function and the doc string for the
whole file didn't have a test one item
passed all tests which was scripting dot
format line it specifies the function
one test in two items one pass zero
failed test passed lots of verbose
output to tell me it ran all the tests
successful in they all passed it's
extremely common to look at people's
Python source code and I wish by the way
that my formatting would work there we
go yeah cuz that looks a lot cleaner
it's extremely common to read people's
Python source code and see tests like
this in the documentation because it's
actually helpful to know what the
function does by looking at the sample
output the doc test module adds for you
the ability to make sure that your
documentation stays in sync with your
code so one killer thing in comments and
why some people don't comment
extensively is comment rot you leave a
lengthy comment describing how your
function works later on you have to
change it under time pressure and you
change the implementation and maybe the
results but you don't change your
comment the only thing worse than code
that isn't commented is code that is
incorrectly commented doc strings lets
you at least run and check and see that
your tests they'll work and if your
tests still work then probably your
documentation it's not too awful so you
can think about it as tests for your
documentation as much as tests for your
implementation yes it is we are
embedding tests in our comments and
obviously this would get onerous if you
had to do like 10 lines of stuff to set
up your tests and then run your tests
now your documentation is like really
long longer than is helpful so there's
another library for using extensive
tests especially ones that require setup
but for a short utility functions and
short tests that also serve as
documentation doc test is great so if
you're like me you're probably going to
have all sorts of I don't recognize your
format thing the main thing I usually do
with doc tes is forget the leading space
and do this and then it complains not a
valid text but I would like you to add a
doc test to your classmates file and
have it successfully passed and it can
be something simple like this it's just
a utility line that does something like
output it could be something more
complicated like your CSV function that
reads from a CSV file and in that case
you might supply a test CSV file that
does not change with your CSV function
call your CSV function with your test
file name and check and make sure that
the data structure that you load is the
data structure that you're
affected so it's also common if you're
running extensive tests to have testing
data that goes along with it but it's
your choice and to review briefly while
there's other ways of running doc tests
and the Python documentation itself
suggests this method define a function
that imports doc tests and call the
tests mod which tests the current module
and then if your name equals main call
your testing function I'm happy to just
do Python - conduct tests and not add
any doc tests running stuff to my script
yeah so when I'm done with the official
Electra portion were - like four o'clock
but I'm here till 5:00 to hang out if
people are continue to work on labs I'll
circulate and you can always kick me
around and say come follow me and I'll
go read my email or something so alright</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>