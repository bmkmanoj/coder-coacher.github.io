<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Backdoor Invulnerable Code | Coder Coacher - Coaching Coders</title><meta content="How to Backdoor Invulnerable Code - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Backdoor Invulnerable Code</b></h2><h5 class="post__date">2017-08-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/EGshffkzZsY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">right so this this talk is how to
backdoor invulnerable code as Christina
mentioned I'm the director of offensive
security at Salesforce it was nice of
them to let me make that title up for
myself
let's get going I promise that this may
be very polarizing you're either going
to think I'm very endearing or you're
going to like hate me by the end of it
so we'll see how it goes so I wanted to
I want to take a second just kind of
like level set on what offensive
security is and your interaction with me
is going to make this go like way better
so how many in the room let's just get
actually before we even go into this
stuff in the room does anyone have like
security as their day job like in your
title is security your main purpose is
doing security stuff a few how about
like okay you you have lots of
responsibilities and security probably
kind of as one of them awesome okay and
for maybe the few hands that didn't go
up is anyone like security
revenge-seeking in here whether you're
just here to like some security guy
wrong to you in the past and you're
gonna get even now a couple okay
watching you okay
so I assume everyone's familiar with
what penetration testing is or at least
heard the term right yeah hands are not
good so what I do is like penetration
testing it includes that but offensive
security is a bit more than that
we're frequently called the red team
what that is one of our functions that
we have and the idea is that normal
penetration testing you're trying to
like find the bugs right that's what I
normally hear from people like oh yeah
you you break in and tell us where the
vulnerabilities are so that we can find
them before the bad guys do and that is
kind of what we do but the the team I
run is a little bit different in that we
are really focused on just simulating
the actual adversary so we don't
actually have like a scope where it says
you can only attack these things we
attack whatever the people system
we break into the buildings whatever it
takes the scope is open and that allows
us to do something for the organization
that hopefully doesn't happen very often
is that you get hacked for real and it's
very terrifying and that terrifying
moment is a often a change catalyst
internally for organizations right so if
you imagine your Sony the day before the
PlayStation Network breach where
everything is on fire if you guys
remember that I mean not as guys
remember that you imagine like the
security guys internal they're like hey
guys like we should do something about
security and the people who pay for
stuff are like eh imagine the day after
that it like the front line is like Sony
hacked I bet that conversation went a
lot differently they're probably like
take all of my money so what we do and
then the scope that we operate in is to
create that event kind of on a regular
basis to keep the keep the fear alive
so we're kind of like boogeymen okay I
normally hate BIOS slides so I think
that went pretty well
and in case it didn't go well I I made
this like catch-all slide so that I
could have a definition so red teaming
or in my case what we do is we're an
independent group that serves to
challenge the efficacy of the
organization and challenge them to
improve their efficacy and the idea here
since we're in the security track is the
F&amp;amp;C of protecting all the things that
you really care about right so a bit of
a spoiler alert some of you are going to
be like oh no no such thing is
invulnerable code I'm sorry if you came
here to learn the secret of five
invulnerable code also look at this look
at it because gifts that robots really
got it made nice deal with it so but
there is the ideas you can be secure
enough right like that's what we're
talking about here getting it secure
enough so that you're not getting
wrecked from the outside all the time
right so what is secure enough I mean
it's kind of a kind of a hard thing to
quantify and it's probably in this case
or at least let's just assume
progressive talk secure enough is you've
got code without a bunch of security
bugs kind of like this right working as
intended all the features are there no
secure
bugs right this is secure enough it's
actually not really related but it's a
good it's a good gift sorry if that's
distracting but the idea that secure
enough is going to be like you don't
have sequel injection right you you're
your product isn't it doesn't light up
for the OWASP top 10 of the mistakes
that everybody is making and you've
already covered that if you wanted to if
you came here to learn how not to write
bugs in your code this isn't actually
going to be that talk so for for the
purposes of this it's not another
catch-all flat I made for myself let's
just call it code that enforces expected
States rather than allowing users to do
things with your system that you did not
account for so the idea is like you're
not going to allow them to make
arbitrary database requests when all you
wanted to do was let them log in right
so you're not going to allow them to
bypass logging in things like that and
we're going to assume that we all have
that and we're going to operate in this
perfect world so I guess now the next
question is like how to use secure code
and that's probably obvious just write
code that doesn't have bugs in it right
Peevy told you it hate me so yes you
should do that and we should strive to
do that but there is more and it's that
more that I want to talk about and I
have a I have what I think is a really
clever metaphor so let's imagine that
our secure enough aka invulnerable code
is this this miss nickel and on one side
is all those perfect lines of code you
write with no security vulnerabilities
right there's no there's no flaws in it
no one's going to take advantage of the
actual code to abuse the product now
let's take a look at the other side of
this coin and flip it over and this side
of the coin is going to be every other
aspect that goes into writing the code
such as the third-party libraries that
you integrate that you didn't write
yourself but they're plugged in your
code a part of your product now and how
about the code repository that actually
stores all of the source code and the
underlying source code that makes up
that code repository as well as the
actual
server that is running maybe you are
hosting it or maybe it's somewhere else
also how about the integration systems
that put it together and they compile
all the third-party libraries file code
that you wrote and they test it and make
sure you have code coverage maybe they
do some security testing the code and
underlying systems that do that right
server somewhere and also let's include
the build pipeline right all the stuff
that moves it from system to system to
get it from point A to point B and then
deploys it in the production however I
mean that has to happen somehow and
let's not forget all the humans that
maintain all of those systems right the
administrators who have access to your
internal servers or external servers
that do all of these functions that we
just talked about and then let's not
forget the other humans who have access
to the computers of the previous humans
that manage all your systems because
someone has to do IT support inside the
company as well right so perhaps I'm
going on this list of things and some of
you have realized that there's probably
another side of this coin still and
you're like you just flip the image
that's bullcrap and you're right so it's
the side you don't see
that is actually really important
because it's the side you can't see and
it's not just because I didn't put it on
the slide I want you to feel a little
bit how I feel right you guys all know
that there's another side of that coin
that you you couldn't see but the fact
that you don't get to see it should
create this kind of like weird sensation
inside you where you're like come on I
know there's something more that's how I
feel when I people are like it's secure
I'm like I know there's something more I
know there's some other way to break it
I know that it's possible so because
there's always things we can't account
for us like like this I don't know if
anyone saw that comment that I did it so
to further harp along on this same train
of thought
I'll give us a brief expose of the black
swan theory so this guy about 10 years
ago
names knit a Nassim Nicholas Taleb he
wrote a book he thought he's a
behavioral economist and he kind of
talks a little bit psychology talks
about economies and he has this theory
that these black
Swan event right and the whole name a
Black Swan came from the fact that in
the early like I mean all of history
right everyone's you know hanging out in
the UK and they're saying like in tomes
and things that something super rare
it's a Black Swan because everyone here
has only ever seen white swans until
around 16 97 a couple Dutch explorers go
to Australia and there's like black
swans all over the place oh hey so the
idea that up until that moment everyone
thought that it was impossible to have a
Black Swan and then suddenly like black
swans
right so that's where the name comes
from but what he was really getting at
in this is that there are events and
those events you don't really see coming
but they have a huge impact not only on
fiscal markets but it applies to
security as well and if you went up to
anybody and ask someone about like hey
do you think this is likely to happen
they probably say like no that could
never happen we can never get hacked
we're fine we're secure but the second
it happened suddenly everybody thinks
like oh dang this is way more likely to
happen again because it's just now
relevant that it did happen to them
sorry if I didn't make any sense play
I'll stop ranting so the best we can do
here is to accept that there is no
ubiquitous security perfection that we
can ever achieve I told you guys would
hate me and I put all the funny gifts in
so to maybe win your favorite back but
the the idea is this is really this is
really a downer right we can never be
good at security right I'm sure this guy
understands with a kid clicking in this
chair but on the bright side we can
think like an adversary and we can
challenge where we set the bar for
people right we can we can try and see
and we can try and assume that there's
some side of the coin that we don't see
and we can always be wondering what's
more what is out there what what would
someone do to actually attack us and how
is that going to go down so so the point
of this talk is that I'm going to share
some of the tactics because I do this
every day is my day job and a lot of
those things like writing secure code
like the targets that I attack they've
got that they've got that front side of
the
poing already and they don't have a
bunch of bugs in the externally facing
app so for me the new common stuff the
new low-hanging fruit is all these other
things so I'm going to tell you some
stories and hopefully I won't get fired
for sharing this stuff but we'll see how
it goes so we can't really talk about
all this stuff without hitting on the
human element probably first so I'm just
going to dive into what is social
engineering we get some nods or hands
familiar with this concept and generally
people write cool and so probably people
are like that's just a fancy word for
lying right and you'd be half right it
is a very fancy word and we like to use
it a lot but it doesn't always just
imply lying I like to think that this
definition from the social - engineer
org they run a podcast for numerous
years and they wrote a book on social
engineering they like to define is this
any act that influences a person to take
an action that may or may not be in
their best interest so it's a little bit
different right like a con man is
normally tricking you into doing
something that's definitely not in your
best interests and his but social
engineering is something that we can use
to influence our companies to take
actions that actually might be in their
best interest maybe it's what I'm doing
up here and trying to influence all of
you to take actions that might be in
your best interest
so let's not equate social engineering
with just lying because I'm not lying to
you today and you're like - right liar
so there's a couple key concepts that I
just want to like lay some ground level
stuff with in case we're not super up on
the social engineering game and that's
typically when you're going to do some
social engineering attempt the thing
that's like the juicy stuff that you're
going to want to leverage is emotional
response and you can get that through
you know posing as an authority figure
so people are like dang like you're you
have some you know they're afraid we
have some power over them but it doesn't
have to be that that's the most common
that you see and you're probably
familiar with but it could also be pity
it could be sympathy
it could be empathy where you make
someone feel bad for you so they want to
help they want to help you
and you you suddenly have gotten what
you wanted but the person is like happy
for what they've done
I won't harp on that too much
the other concepts that I'm probably
going to say a bunch is pretext so if
I'm using pretext and that's like a word
everyone should understand that I'm
assuming that and it's not the case
pretext is the story the characters all
the facts and info that you are
fabricating or at least like training
yourself to be in the moment right it's
like method acting this is your
character this is the scene this is the
reality that you are going to impose to
be an effective social engineer so pre
Texas likes this story and excuse me one
quick note on manipulation versus
elicitation so there's no only one of
these two goals with social engineering
you either want to get info from someone
which can seem pretty benign right I
call you up and I asked you like what
kind of printers do you have I'm with
this sales company and you tell me the
printers and then I find the
vulnerability in the pictures right you
haven't done anything I haven't caused
you to take any action all you did was
tell me something and I got information
and so the manipulatation getting info
manipulation is I want you to do
something normally in my case I want you
to double click on something and run it
on your computer so that I get access to
your computer for most of this stuff
we're talking about the manipulation
side so that someone can actually get in
your company and not just get the info
so most of the time when you say social
engineering people think fishing right
someone has sent a bunch of email to the
company it does your company does
anyone's company do fishing testing
where you have like a bunch of emails
that get sent to everybody and you see
who clicks through cool so that level of
fishing is like the classic kind right
so that is a form of social engineering
that is not the only form so the like
look the classic thing that most of your
companies do is you send a link to a
bunch of people and it asks them to log
into something as part of some process
so they can win some prize or view some
document or do something like that and
you want to see if you can capture their
credentials now that doesn't give you
access to their system it might help you
later on but that doesn't that's not the
end so another example is the Nigerian
prince with a diamond mind the classic
four one nine scams anyone anyone got
that email before where some dude it
somebody was really really rich but he
just needs like a thousand bucks from
you and he's going to give you like ten
percent you're gonna make like ten
percent a month twenty percent money
this is just basically like they want
money right and the new evolved form of
this that you see is the IRS call or
someone calls you and they're like from
the IRS and if you don't give us money
that you owe and back taxes we are going
to come arrest you or something like
that and so I got that call of like I
get text I call pretty frequently maybe
I do some taxes but uh
I get that Colin I just don't know I
only this is fun I'm gonna mess with
this guy I'm pretty sure the IRS is not
calling me if you ever get this call the
IRS is not they don't do that they don't
call people so I'm starting to just like
mess with them and I'm like yeah I want
to send you the money and I just keep
giving the wrong number anything really
frustrated and he starts threatening to
like drone strike my house
he's like swats outside they have your
place surrounded we're going to nuke
your house I'm like geez man so anyway
that's highly recommend that but the
point that I'm getting at this type of
fishing is weak like weak sauce totally
lame this stuff is still pretty
effective but it's not effective enough
the reason being is it's impersonal
right and the fact that you have these
impersonal things that you sort of need
to spread it over a big blanket to get
the results you want right send out 40
emails get three people following
through hopefully but there's another
type of fishing that we can use is
another type of social engineering
that's way more personal and it's way
more targeted
yeah all right that's thank you good one
see we've got a theme
fishing and sharks put a lot of thought
into this the so this type of fishing is
more effort per person right so it's a
lot harder for the social engineer to
conduct but it's a lot less likely to be
detected because you are hoping that you
can use a really good pretext and get
one person one time and boom it's over
and if you spread that attack out over
too many people the chances of someone
reporting it to your security team or
noticing or sounding the alarm and
saying like hey watch out this is
happening goes up and for me who wants
to get into the company without being
detected
because if I get detected I get kicked
out and to start over and I wasted a lot
of my time this is much much better so
I'm going to share an example a real
story from one of our internal tests
that we did basically we are sitting
there as the red team and we are having
a bit of trouble getting inside this
company so we are turning to social
engineering as our fail through and we
see a vibe manager not do you guys have
vibe managers at your companies I don't
know what that is but this person's like
I'm a vibe manager also check this out I
am volunteering for this surfer life
program and I just got funded and
everything's awesome and go to Costa
Rica I'm going to surf and it's for
volunteering like a little lightbulb
going off at this point so what we do is
we go register this domain and you want
to want to point out what's wrong with
it
and this isn't there for life this is
surf or life a little bit different also
a lot scarier now right it's high stakes
when we register this domain and we then
here I'll just I'll just read you this
email right we send this email say hi
person first of all we'd like to
congratulate you on your successful
fundraising project whatever it was
called your projects great we're really
appreciated thank you the date for your
September trip which we know because it
was also talked about the date on
Twitter but this seems like we're the
right people because we know about the
trip right it's just around the corner
and we need additional info from you can
you download this form located here and
fill it out so that we can get all your
travel stuff books and take care of
everything for the trip and as you can
see it's our surf for a life domain that
we control like haven't I say by the way
what's up this link is a jar file it's a
Java executable if you're not familiar
when you download it it's like there's
probably good but most people will click
run because you got to submit the info
and we're like this is the secure
companion app that you must use to
submit the info and you want to go to
Costa Rica right to it within two hours
we get this email back like hey Milan
some name we made up I'll fill this out
ASAP I finally purchase my plane ticket
I need to get stuff reimbursed also this
this app like doesn't actually work just
throws an error so then later we're like
oh don't worry you can just submit it
over email and please give us all your
information we had to do that to
maintain like we don't want her to get
suspicious so we have to keep that going
on while we have a shell on her computer
so of course there's no there's no form
there is no spoon and we get a we get a
shelf so I just want to really quickly
if you're unfamiliar with this concept
we we live eat sleep breathe shelves all
day but the idea is that I have access
to computer I have this like I have a
terminal so your computer is somewhere
in your company and I can type anything
I want on it and do anything I want make
noises like that
so here's how we start doing this here's
how we take a look at the company
externally this is our general process
for social recon and for this example I
am going to pretend that Rick and Morty
perhaps Stevens are some like a huge
Rick and Morty fan and season three like
I don't know if anyone else out some nod
let's pretend that getting the like
storyboards or something for season
three is our target so if we were to
start this it's simple we said like who
has access to it for real right you
don't just start hacking on the internet
looking for Rick and more you look look
for the people who will have access the
easiest way to do it search LinkedIn I
don't want job authors I want people
that says they work on this type of
thing so I found this guy he's cool I
started looking at his LinkedIn page and
this is all public information I'm just
showing you Google result this isn't
like some scary tool this is LinkedIn so
if no one's gonna panic
so you're like pays a props designer
that might be useful perhaps if I get
access to his computer I might be able
to get access to servers that store Rick
amore stuff or be able to get further
leads to inform how I'm going to proceed
and with all this information what we
normally do this for like 30 or 40
people at the target to try and build
like an understanding of what do people
do what are their functions what do they
have access to how are they connected
where they care about so we just build
dossiers on them little picture and then
look for all their different social
online presences and this guy's got a
website
he's got Twitter we take down little
notes about it we take screenshots of
everything we upload them into Google
Drive because Google Drive will OCR all
the images and then you can search later
for just like strings of text and it
will pull up the screenshots that you
made before kind of efficient probably
could be automated more look on Facebook
guys sharing his ale Instant Messenger
name there that's the thing still look
at Google+ because that's the thing that
people use all the time I'm going to
come back to this right this seems
really noctus like computers about your
Google+ profile you'll see in a second
so where a building is this right little
document of all the publicly available
information so that we can kind of like
calculate this person and their ident
and become familiar with them and you
keep doing that until you have a good
enough picture to try an engineer some
type of situation where you would be
getting access to their computers so
yeah sorry a little bit of bad news
attackers can stock you using the
internet get access to things that you
have access to this isn't a super new
concept it's probably not talked about
openly like this because it's terrifying
for people and normally when people say
they do this there's like a line of
privacy advocates that are waiting to
yell at me no okay
also it does get worse than this so
Google Plus you can you can do something
a little nifty and clone people's
profiles right all these all these links
on this webpage they're links they're
images so I can download those images
and I can make my own Google+ profile so
here's the original one and here's mine
that I made with a new email pretty
similar to the original one and you're
like well what are you going to do with
Google+ profile but actually what
happens is cloning someone's profile
like this I wrote this so I was trying
to like come up with an idea of like
what this is called and I couldn't find
anything but so I wrote this in a
drunken fury and cloning public profiles
allow the social engineer to leverage a
target subliminal familiarity with
identity based content to gain instant
rapport I couldn't figure out with this
like you know when you see someone's
profile and you see the profile photo
and a lot of things are simplified and
the user interface is nice you're not
seeing the email that they used to
register you're seeing some online
identity and because people get used to
seeing that if I can clone that and use
it I will gain instant trust with you
just a little bit to me perhaps enough
perhaps not but you'll nothing will kind
of like spark and seem weird because
everything looks like it not only does
so here's what I mean if I send an email
from this new account that I just cloned
and I tie the Google+ profile to it
because I populated Google+ when I send
an email to you it bulbs my name it puts
a picture there the email still there
that's my email I made up not the real
email for him but on the aside boom big
bold letters like the name the same
profile photo again public posts that I
copied are there and all this content
sort of makes me feel a little bit at
ease and in this perhaps I'm sending
some kind of some kind of file so you're
like how are you going to use this Gmail
must be doing something to protect us a
bit and you know is doing a lot of stuff
they are blocking all of these file
types and if you have your own Google or
you can add additional file types
you should note that jar is not in this
list and it is a really nice malicious
way to deliver stuff because it's not in
this list but if you have your own
Google org you can add it and then jar
will be blocked too also if you zip
things it decompresses them and looks
for the thousand side so that's not a
way to get around it pretty good pretty
good if they do this we shouldn't be
emailing exps around however you can
share any file type you want through
Google Drive so if you upload something
and share it directly to the person they
get something like this like hey look
demo dot exe here you go please download
so a real example of this looks like
this we are pretending to be this guy
we've profiled him and we are thinking
like okay I know he works with this
other person he's a bit higher in the
org chart based on what we're seeing
online publicly but he still works with
this other person so they're not super
close together but the person will
probably respond to him because he's a
little bit like he's seniority he's like
a founder of the company and all I we
said is can you try and back up with
this I keep getting an error and it's a
jar file or sharing out correctly
they're going to receive something like
this hey can you check this real quick
give it an open back up relationships
jar when they click it they get a prompt
to download it there's no preview
available for jar files they'll download
it there will be a warning right chrome
will say hey you probably shouldn't run
this it could be malicious but you know
your friend that works sent it to you so
it's probably okay right it's he's
having an error there's no way you can
respond to this request without without
opening it right so this is what the
person sends back it doesn't open for me
it says I need to install JDK so this
would have been a shell but they didn't
have Java installed so of course my next
up is like okay here's how you install
the JDK please like
but yeah so sometimes it doesn't work so
what if something simple like that
doesn't work the good news is it
continues to get worse in this other
example I think this is actually against
the same target we're running a lot of
like campaigns at once trying to get in
because we're failing so hard and some
of them right or sending jars and
they're sending back screenshots of them
not having Java installed so we're
upping the game a bit in this scenario I
have decided that I am a journalist who
wrote freelances for this magazine that
covers interior design things I found a
real company out there and just
pretending that I work for them and I
email their PR portal saying like hey
we'd like to do this we have interviewed
all these other companies we've
interviewed Twitter and we've
interviewed Facebook we saw your social
media presence and we saw pictures of
your office and we think that your
interior design would be great to
feature in this article alongside these
other really great companies and for
them they're like okay so I'm trying to
set up an interview where we can go
there in person our request actually
gets picked up by a third-party PR firm
that handles us for them and they end up
getting this email which is like hi KD
by the way I'm contacting you connecting
you with Anthony Taylor that's my fake
name life edited a real company that I
just decided to pretend I work at to
help set up an interview the tour at our
target as we discuss life edited will be
featuring office spaces that have
interesting interior design and culture
that foster creativity
they'll be featuring the office spaces
of big companies like Facebook and
Twitter and also like to feature up
basically perfect this is exactly the
way I engineered it so that I wanted
them to feel like this so they're really
excited to set up something and because
this person is sending it that's normal
right they trust them already so it's
not even like a random third person it's
the PR firm which they're used to
perhaps the PR firm should have vetted
us more but funnel so they're totally
stoked to set up the interview basically
they're like yo let's set it up on this
date let's do it so what happens is I go
and I interview and tour in this office
with a colleague of mine and we take
years of everything right like we're
taking photos but really we're taking
photos of like where are the doors and
what security systems do they have other
post-it notes on people's computers
what's written on whiteboards is that
interesting like where is the Wi-Fi
password things like that and and and
this guy actually Ned never used like a
camera before in his life so most of the
pictures of the glory slots the stuff he
was he he made it seem like he was doing
it so that was the important part
meanwhile I'm interviewing this guy and
I'm asking questions like oh great we're
talking about interior design Don oh how
late do people stay in the office
alright so I want to know when I can
come back and I want to wait till 4:00
in the morning and get busted out a cop
come on like seven or eight o'clock
would probably be pretty good like oh
yeah people people stay pretty late and
like oh well but good to know so there
is one other side effect to this this
rapport and Trust we built over time
allow those to spring a trap so we've
taught we've been talking for hours and
I look at him and said hey I can't
believe I've been so forgetful I need
you to sign a photo release form and
we've been taking pictures all day and I
didn't do this so like my ass is on the
line here if we don't find he says oh
yeah sure just I'm like can you print it
for me yeah sure just just emailed me
I'm like actually I have it on this
flash drive here I just didn't put it
out he's like yeah sure and it's regular
flash drive doesn't do anything let's
just I don't know what kind of computers
he's going to have it's not going to
blow up or anything he puts it into the
computer and it pops up and there's a
mess of folders in it and he has it he
controls it I'm not like pushing my way
into anything I'm like oh can you try
like is it in this folder
Oh actually mmmm maybe it's in this
other fault actually do you mind could I
just look for it I'm sorry it's such a
mess easily yeah sure so now the CFO the
company is allowing me to use his
computer with my flash drives plugged
into it and of course I know where the
file is click click click click click
click down through the right folder path
double click my malware double click the
PDF which looks like this he prints the
PDF for me that gives me a shell on his
system because I was able to just
double-click malware on his computer and
then just to prove that this work and
also get more access he says like oh I
need to go to a meeting it allows us to
sit there and hey can we just hang out
here things like of course you know we
Open Office plan we've been
we trust you've been talking to you for
hours of course you can hang out in the
office so there's a thing there's my
computer with a shell on it and then I
go to a developer and I'm like hey
actually I didn't realize I need another
one can you print this for me and do the
same exact thing and it works so so we
get more shells normally in like
security presentations this is what
everyone's like you don't have to soft
guys to you
so at this point you're probably
sufficiently like feeling like okay it's
possible to get into our stuff and the
world is on fire but we can go further
right so what happens after you get
access right it you you just have access
to the computer you have the terminal
that you can type into but you don't
have a password you don't have anything
and you're probably going to need that
password so can we can we get a
volunteer like what is the easiest way
you shout it out to get someone's
password thank for it
we're just asked for the password so
here's how you ask for someone's
password
OS X has a built-in thing here I'll just
just demo this one so oh so script is
basically a scripting engine that can
automate UI functions and what this
script does is says a tell the system
event app to display a dialog box that
looks like this and also use the icon
from software updater and if you run
this what happens is boom it's pops up I
don't know about you but if my computer
wants to wants to do something and it
needs my password to apply updates like
I probably want to do it another thing
is because I've not added the cancel
button here pressing escape does nothing
so you can't there's no clothes on it
either so the best you can do is hit
enter which would make it go away for a
second but as you can see the text the
text returned here is like not the
password no text so I get to do this and
pop it up until you get annoyed enough
to actually type your password in now
you have your password here directly in
the command line this is another a
plausible moment while we get the
presentation going again so yeah so
perhaps you're like no problem we're on
Windows well here's the same thing for
Windows and this requires PowerShell so
if you're a good security conscious
Windows environment you know that
PowerShell is like super super super
dangerous it's like the hackers as much
as you that it gives your admins and
people who do devops in your environment
stuff like that it's way more useful for
the evil guys it is super super
dangerous but you can use it to do the
same thing that looks pretty legitimate
if perhaps PowerShell is disabled in one
instance PowerShell was disabled it was
blocked by bit 9 but Java was allowed so
we wrote a full-screen overlay it's
written in Java that looks like the
login screen just popped that program
off and boom like log in screen
personally that's weird I don't know
what you do at a login screen but I
normally type my password in to unlock
the computer and that's what
I'll tell Linux this is one line GK's
sudo basically you're prompting for
keychain access and you can make the
message anything you want
apply your password to enter your
password to apply changes something like
that also this has a super annoying
effect of giving the rest of the screen
when this pops up so I guess the point
is we're pretty good at stealing
passwords and this isn't even the tip of
the iceberg of the techniques we have
right we can key log we if this stuff
doesn't work there's a lot of other ways
to get people's passwords so what's our
defense against that right I mean it's
not all doom and clean we have to fa2 a
phase really good right if you add 2fa
on access to your systems and your
servers that are important if you add
two FA and access to your github repo
your single sign-on portals that is
going to add a nightmarish step for the
attackers and it's going to make them
have to up their game big-time to FA is
a huge huge pain so it makes it way
harder but it's not perfect and here's
some of the most common pitfalls that I
find when people are implementing to FA
refit on time so when we encounter two
FA if it's on a single sign-on portal of
some sort right it's um a web based
authentication thing the user gets
prompted for - FA then they get a
session set up we can typically steal
the cookies on the system put them in
our own system and then suddenly we have
that session we have that same access so
having fairly short live sessions and
also doing some type of VoIP blocking so
that someone can't continue using a
session that started somewhere suddenly
in China something like that would be
would be bad but on the flip side of
that if you have access to someone's
machine you can proxy all your traffic
through it so that won't work either the
best case scenario in terms of like
browser choice and where this stuff is
living is the chrome on OS X so Chrome
on OS X in order to actually do this
attack you need to be able to have the
person's password take the keychain file
off use their password to unlock their
keychain get an encryption key out of
the keychain use that encryption key in
a script to decrypt
the cookies so that you can replay them
that's that's where it's the best if
it's Firefox on a linux box or even on
LS Xbox it's like you just take the
files that are on the system and put
them on another system and it's done
like you have all the sessions so I wish
I had better advice for this one so I
yeah just just be just be aware that
this other side of the coin is there so
you can raise the bar but we can't
always fix for everything yeah so this
is what SSH multi any DevOps people in
the room that's what I thought so
SSH multiplexing is like I've seen this
almost because they see across that
target right they put 2fa on a bastion
server they have a really good model
they're like anyone who wants to get
access to our production environment is
going to have to SSH into the bastion it
is 2fa on it and that is like where the
security hardness is and then once
they're in they can kind of do whatever
they want or maybe there's some
additional layers but for the most part
we are going to secure something with
2fa on ssh so we can't have people
logging into the systems all willy-nilly
right but they also say because this is
inconvenient you can enable this
server-side setting called sh
multiplexing and what that does is
allows you to if you have a session
established open a new one with no
prompt for credentials no authentication
so if you're on as if you're the bad guy
and I'm on your machine and you have SSH
into super-secret production super
secure server and you have this setting
on all I do is look in your process
listing see that your SSH somewhere copy
that paste it and I'm SSH in there now
too because this setting is involved so
yes it's nice that we can SCP files
without having to enter r2f a token
every time but this has been like a an
Achilles heel for company after company
so maybe look into your own companies
yeah so I don't want to give away too
many spoilers because we're teaching a
workshop tomorrow on Jenkins and I don't
if there's an overlap here I don't want
people to know all the answers to
everything but continuous integration
systems have been the bane of of
existence basically in every one of our
tests where we have bumped up to some
continuous integration system it's I've
see Jenkins the most frequently but I've
seen a number of other ones it is
basically like remote command execution
in a box and what I mean by that is you
can get a shell on it basically every
time because it does things like login
the servers and running commands on them
and there's in Jenkins there's like a
console that if you type stuff into it
just execute whatever you want so it's
super super dangerous and it's super
plagued with bugs because when people
write products like this especially
Jenkins it has like a new like
authentication bypass or remote code
execution outside like a bug that has a
remote code execution not the features
that allow people to do that basically
like once per quarter if you look back
at the vulnerabilities that have come
out it's pretty consistent around for a
year so if you have these systems in
your environment like the least you
could do is patch and put authentication
on it right so also that's a good gift
right okay so let's get to the point all
right back during code this point we
sort of understand that attackers from
the outside can understand your company
and understand the people and understand
who's going to have access to what
internally also we have a lot of ways
where we can get their passwords once we
have their passwords we have a fair
number of ways that we can bypass - if
they and once we have bypassed - FA you
can use that to log into internal
portals and read all the documents to
understand further how the internal
systems work you also have access to the
servers you probably have access to the
code pipeline so the question is like is
back to on your production code really
that hard even if you've done reading
all the code correctly even there's no
bugs is introducing a bug or a backdoor
or changing how it functions or stealing
your signing cert to get into the App
Store really that hard
I think I think no even when you have
this so just just in case anyone had
like OCD and needed to see the other
side of that coin the thing the thing I
want you all to think of is just because
I showed you these things doesn't mean
this is everything this is just a little
small sample of things that I've seen
that are really common hopefully that
you can take them back to your
organization be like hey are we making
these super common mistakes everyone
else is making maybe raise the bar a
little bit but you can't stop there
right you have to keep challenging it to
keep raising the bar because the guys
that want to steal all your stuff and
wreck your companies are going to keep
keep doing that right so I'm not going
to quit this is the end of the talk or
watch this gif so questions complaints
heckling
so you're you're a small shop maybe
you're relatively new and you can't
afford to have somebody on staff doing
this all the time what do you do so I
cope do you have how small well we're a
big it now but technical sells pretty
back 15 20 minutes do you have
compliance obligations do you have any
type of external search so this is the
stuff we do there's a bunch of people
like Christina for instance works at a
third-party consulting company
I won't plug them by name because that
feels skeezy place the idea is you can
hire this right and a lot of times you
have to for compliance sakes you have to
get a pen test you can a lot of times
double dip on that budget because most
hackers that are out there working at
those companies would love for you to
open up the scope and say give us a test
like this and you can let them do the
compliance stuff and you can kind of
bake it into the same thing and sell it
internally and you can allow those
third-party people to to do this right
you have to understand that it's scary
not everyone in the company's going to
like this but if you care about it like
I understand having a team an internal
team that does nothing but this this is
a crown jewel security luxury item it's
that is that is kind of crazy and it's
honestly it's not very common but if you
relaxed the scope and you say we want to
test like this also like certify us for
compliance the the third-party
consulting companies will not only thank
you but they will do a lot more and you
can then leverage this to make like a
story of here's what's going to happen
here's how we can get hacked and so just
follow on from that so I'm the CTO and
I'm pretty keen on doing all of this and
we've gone through you know a couple of
ten tests and frankly I think they'd be
pretty different I don't I don't think
they've got the kind of talents do it
just doing Frankie so I guess the next
question is where you find the good
people so there's a couple companies
that are more or less known for for this
this is kind of as the difference
between pen testing and red teaming
and if you lead with look we're going to
do you guys a really nice solid and open
this up and we want red team like see if
they say red teaming it's starting to
become too popular already which is like
driving me nuts but see if they list red
teaming is like their core service
offering I can I'll talk to you offline
I don't want to like pitch vendors up
here but yeah thanks everyone
sufficiently terrified okay thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>