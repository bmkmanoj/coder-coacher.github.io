<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>04 - Main Building Blocks: Android Bootcamp Series 2012 | Coder Coacher - Coaching Coders</title><meta content="04 - Main Building Blocks: Android Bootcamp Series 2012 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>04 - Main Building Blocks: Android Bootcamp Series 2012</b></h2><h5 class="post__date">2012-01-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/n2XJctnQxcY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so what we're going to talk about next
are the main building blocks if you
remember briefly when I told you about
what we're going to talk about
I said main buildings blocks is
basically the things that we use to
build Android apps right so entered is
based on Java so you got all the Java
constructs it's based on Linux you get
some Linux constructs and so forth that
dot stuff is old news right main
building blocks is totally new
it's things that you can seen before in
any other place
right so it's purpose-built 400 now to
kind of explain what it is first
what I'm gonna do is I'm going to show
you a an app that they have it's called
the Ambo and Yama basically stands for
yet another microblogging app so that's
basically the acronym and basically it's
I'm just gonna use it in the context of
explaining what it is so Yamba is
actually available on github so you get
who's telling you to github ok ok so you
guys know what source code repositories
are and so forth like ways to to manage
source code versioning right so we can a
we use that for our distributing the
code as well so and gift up is basically
just a term like repository where you
can also access it it's centralized
right so you can access it you can share
the code easier it's actually the the
github company is just down the street
unpowered so you can walk down in say
green door you know so they're right
there so this is the location that they
have for for the
want to see a cool thing that is very
useful
check this out let me let me do this go
to this URL
github.com slash jest yeah so it's
changed so that's that's the URL yeah so
hold on one second
okay so you can go to this URL and keep
it open
got it so what I can do now is I can
give you useful links and I can just
copy face them so for example this is
where I can basically go here and I can
edit this file I can now say actually
check this out let's see if this works
with me goes okay so you can this is the
repo that you can go to well now if you
refresh the page right you should be
able to see it
but that's you should be get you should
get a page like this right so that's
where the source code is for the book so
learning angular look this is the source
code it's right there so what I'm going
to do it is I'm going to download this
let me think about what the best
approaches yeah I'll just do that I'm
gonna I'm not gonna clone it but I'm
gonna download it again
so you can download this source code
onto your computer you can click on the
little Downloads tab you can download as
zip for instance and this is gonna sound
on load the zip file onto your file onto
your computer
I'm sorry you guys should have now file
somewhere on your file system like for
me it goes into a desktop so it's gonna
be a file called something like this
maracanã - learning Android yumbo - and
then some code dot zip that's the
checksum for this file base for this
version okay don't open you don't have
to open it so what we're gonna do next
is is we're gonna do this in Eclipse
back in so go to Java perspective you
can close everything related to Android
so far so good so here's what you can do
you can right-click or you can do this
file import in Eclipse
right click on import and now what we're
going to do is we're going to point to
that folder that we add that zip file
that we downloaded so you can say
general existing projects into workspace
okay
you click on next and you can actually
say select an archive so you can
actually import directly from an archive
and you can click on browse go to your
desktop or downloads directory point to
that folder and and that should identify
all the possible projects in there so
Yambol 1 2 3 4 5 6 7 8 that worked
yeah click on finish and what that's
gonna do it's going to basically import
from that zip file all the files all the
projects into your workspace so you
should now have a whole bunch of things
in here now this is gonna it may be
broken initially so what you need to do
first of all it's probably building in
the background while we're talking but
what you need to do is if there's a
little red thing you may have to go to
well it's in one way is to try to do
this fix project properties if that
doesn't work out then what you can do is
you can go prep a prop you can go up
properties and make sure that it's based
on an API that actually works yeah well
they're supposed to miss Jen because the
journeys should be auto-generated I
don't check it in alright so do this
project clean man it's just eclipse is
not smart enough to recreate it because
I I purposely didn't check in stuff that
doesn't need to be checked in like John
and Bill folders
yeah if you're still getting an error
the other problem that could be is that
when you do a project you have to
specify a target remember how I says you
need to have at least one well it's
possible that the target that I used is
not a target you may have installed like
I think I use target 8 and you only have
10 for instance right so these you fix
this you right-click on a project and
you can go on the properties and choose
one of the things that you have right
because indeed I did specify 8 in the
original code and you may not here
download with every day don't worry you
don't have to download it just go to
some other use and other version so a
couple of things that we'll do to try
this and it's gonna depend on different
computer my different behave differently
right-click on a project go to
properties pick pick something on that
list write your list is gonna be
different than my my list the reason is
I picked I built this for Android 8 that
was the latest at a time I did this you
guys may not have Android 8 that's right
first you need to do that so pick
something that you do have like Android
10 or 14 click apply and then click OK
it seems like if you don't click apply
yet it actually doesn't make it sticky
sometimes then you could also try
project so right click and say Android
tools fix project properties that's also
supposed to be a little intelligent
about adjusting things that are
different between what I checked in and
to get up in what you have on your
desktop because there could be a
discrepancy right yes enough to do that
you can do project clean which would
force it to basically rebuild everything
so it's kind of a I mean it's eclipse is
not super smart about that but you know
these couple of steps should help you
import and then let it build because
ultimately it's
taking some time to recompile everything
but the little exes should eventually
disappear so again we're not really
going to look at this code right now
this is more just to illustrate an app
right so this app is it I'm firing up
right now is eBay it's one of the
versions of eundel remember it's
basically a Twitter app so this is
loading up BAM
so there's Yamba so what I just want to
show you from user standpoint look at
this right so there's a timeline this is
basically you know remember this is like
a microblogging
ie Twitter app right so this is where
you would see what your friends are
doing right this page here would be what
I would get when if I go to Twitter and
I can kind of see you know what's going
on in the world and so on oh it's a good
said something so that is this breaks a
coauthor so okay so there's nothing here
right so that's because they haven't
updated my username and password so what
I'm gonna do is I'm gonna click on menu
and I'm gonna go into preferences yeah
I'm gonna provide username and password
so username is student and password come
on stop password is don't tell anyone
its password now we are not really using
Twitter yeah
there are couple reasons why we're not
using to it for one if I have a class
like this and you guys all use the same
username and password and try to do what
we're gonna do
Twitter would really quickly shut us
down we would get great limit reached
right
so it's not very conducive for learning
so that's one reason why we're not using
quick Twitter second reason we're not
using Twitter is that weather doesn't
allow you to login with username and
password
anymore right if you write an app you
can't use username password simple
authentication music oh how many of you
know about OA okay exactly my point
so not many people know about a lot know
how it works and it's actually pretty
involved sort of workflow and it's not
what I wanted to teach you it doesn't
it's not related to our class so that's
why we prefer just to use username
password which everyone knows right and
so we run our own service that service
has an API or root which you need of
HTTP colon slash slash remember Maracana
comm api okay so that's where the
service is running so yeonbok dot
maracanã comp slash api so some time to
press ok so basically this now is
looking at that location now if I click
on menu refresh this is hopefully going
to gather data from that service and
there it is one right so there's the
data yeah yeah I'll take a look in a
second so there's a third screen here
you can click menu and you can say
status update and you can say hello from
SF ok click on update okay so that's
posted since we're not using Twitter we
are using this other service you can
actually go to Yamba dot Maracana calm
and warm there's my post right make
sense so we can actually verify that
this worked so the point of this was to
show you a sample application I joining
in the context of this we can now look
at some of the main building blocks
right so we have a very simple
application it has a way to post a page
it had a way to
see what your friends are doing and
change preferences right so with that
let's talk about some of these blocks so
one of the basic things you have is
something called activities so activity
is roughly a screen right like one
activity is roughly a screen on your in
your application your app could have
multiple screens right
most likely twelve and so you can have
multiple activities you could have an
main stream like sort of the entry point
into your app right
I usually don't work so don't shut it
down so so I kind of compare activities
to web pages so just like a website key
how many of web pages and you have a
home page so you show your app can hear
multiple activities and you can have one
and a main activity right but it doesn't
mean that somebody has to come in to
your website via this activity if they
know our URL they could come in by
ethnicity quote-unquote URL right it's
not really a URL so you guys saw in that
previous app you saw three activities
you saw status update you saw timeline
and user preferences now here's the
tricky part
activity escape a life cycle that's
managed by the system and it's a fairly
complex life cycle so first of all the
way we program in Android is different
than what you guys may have experienced
before and anybody has experience
programming applets or servlets okay so
you do so you know how when you program
your Apple two sermons you're basically
programming in so called
container environment so it's something
else is running your code it's not like
just a main main method right but you
have in it
start stop and run this destroy or
something like that right you have all
these callbacks that you implement
for your code to respond right okay so
here's what happens within active where
they would enact an activity at the
beginning of a day your activity is not
running that's my starting safe then the
user says the care on a started thing
clicks on a button
eventually that fires up your activity
right in - to get from here to there
the system is gonna invoke a whole bunch
of methods on your activity uncreate
don't start on resume so each activity
has this matter they may be empty but
they it has dismantled so it's an
opportunity to do something right now at
some point so you have an activity now
in your foreground you're looking at it
and you so it you can basically cab how
many activities active at any point in
time yeah you can only have one activity
ever active so this means that it's the
one that's in focus it's interacting
with the user but user can actually type
something in right at some point you may
say okay I want to pause I want to use a
switch I want to go to another screen so
it's gonna happen is your activity is
gonna get
pause and stopped really quickly so this
is sort of like a very temporary State
this is a stable state when your
activity is partially visible but not in
focus right the example would be like a
dialog box came on top of it forgotten
something that is mostly obscuring
obstructing input you can kind of see a
little bit around it right so it's not a
very common state to being you pass
through it really quickly
soft keypad that's a good question
I'm not sure I'm not sure it's a I mean
it's implemented by a system so I'm not
sure how that is treated
yeah your activity your still your tooth
is still gonna be in a running state so
in that case yeah so at some point your
activity is not visible but it's still
in memory that we say it's it stopped
right so it's not visible but it's still
hanging in there okay so you can have
many activities in this state all right
could be just many many actors just
lingering around so who drive soldiers
well it's the activity manager so
there's a system process called activity
manager which watches all the activities
and decides which one is going to be in
the running state which one is going to
be stopped or which one is just going to
be disposed of all together and be gone
right so you guys don't have a quit
button or in Android right you don't get
to quote an application right so this
decision what gets destroyed in one is
totally up to system does it work like a
thread not really I mean you're gonna
have a single thread to run all this but
but no it's I would compare it in more
conceptually to garbage collector right
so you know just like Joe garbage
collector has his own its own heuristics
on when to mark his sweep objects that
they're not being used anymore
so does this it because it's got some
logic that basically says look I got I
got some some classes here lingering
around having been used for a while and
use a lot of resources I'm gonna dispose
of them yeah so so why do we do it this
way well because this process from going
from starting to running could be fairly
involved right - to get from A to B from
this state to that state
you have to usually you have to start a
whole new Linux process you have to load
a virtual machine on top of it you have
to instantiate your classes you need to
load up your XML parsecs ml draw the
objects draw the screen right so these
steps here tend to be like super
expensive there's a lot of work that
needs to go into into doing all that
right the fact that you're now switching
from screen to screen doesn't shouldn't
mean that you should just get rid of it
so that's why we don't have this right
or or this so we don't have those
because they don't make sense right
because that would just dispose
something that you spend so much energy
doing right rather what happens is we
keep them all around in stop state in
case that we want to go back into
running so this tends to be
substantially cheaper steps because we
already have retained memory we're just
into free throw
so so the questions about malta
multitasking so what we are talking
about here first of all is the activity
life cycle not an application life cycle
so it is true that you're not going to
be able to have two opportunities
running at the same time right it's not
really fear I'm going to be able to tap
two applications there the applications
are different different constructs they
actually run in separate Linux processes
so Linux is gonna give you that well
together
yes yeah
now let me rephrase something again
that's important to understand the fact
that we call this one running could be
extremely misleading it's more
appropriate to think of it as visible
because an activity that is just sitting
there waiting for you to like type in
some information or something it's
really not doing much it's very much
idle but it is in a running state
because it's in the InFocus right the
similarly the fact that this one is
called stopped doesn't mean that it's
not running I would rather use the name
invisible possibly then so so for
example you could have things that are
in stop state you know do not you know
do it's not visible but they're still
cranking like doing a lot to work right
to be mindful of that one thing that's I
can amazing example is there are certain
operations that are extremely expensive
in terms of the battery right let's say
for example you get an app that's using
GPS right the way GPS works or sensors
for that matter is you subscribe to
something like GPS updates or sensor of
it and then as you get new data the data
is just pushed back into you via
callbacks right that you don't need to
process
well GPS could be providing a lot of
information all the time so that's using
your CPU and it's also using the GPS
chip which tends to be very expensive on
the battery right so when you're doing
like that you got to figure out when
would you like to really use GPS in this
context so I would argue like if I want
to be sensitive to a user and the
battery I will probably use GPS just
while in this round here okay so that's
the case then when would you turn it on
well I would say let's turn it on in on
resume because all the roads into
running go through on resume and let's
turn it off in on pause because all the
roads out withdrawn pause so so
basically that's one way to to do that
to baste to to have the to use the
callback methods to manage that to turn
some stuff on to turn some stuff off
right this calls are synchronous yes and
it does not take that long to turn it
off because you're just basically
unsubscribing from getting notification
can do that yeah asynchronously bye-bye
the unit own separate run yeah so
everything everything in this context
cap is on a single thread we'll talk
about that later on so called UI thread
so does this make sense so far yeah it's
more of a UI if you look at it like that
it's more of a UI thing so an activity
is the only visible main building block
it represents essentially a screen a
unit of screen you could so so these
methods you can do whatever you want so
it's not just using the creating the UI
but it could be initializing connection
to Twitter for example yeah absolutely
so the model and controller we're not
really splitting it that that way in the
patterns are not your standard MVC
patters we'll talk about some some of
that stuff probably could design it
differently but there are certain
patterns that are familiar but not your
typical atmosphere so I think well we
kind of probably find ourselves coming
back to this slide quite a bit because
this picture is well it's kind of like
peeling and running and there are many
layers to understanding it so we'll get
back to that just in terms of the memory
cause I'm sure what you need to know is
that this guy is guaranteed all the
memory and resources in the world to a
certain extent this guy but everything
else is not so this guy could be wiped
out at any point in time just stopped
one so Kiley managed in a life cycle
and you respond - yeah it's gonna be
stopped and destroyed and removed from
memory garbage collected the whole the
whole nine yards yeah yeah exactly so it
doesn't matter if you use it restarts it
user doesn't care if user got in like
this or like this or possibly human like
this right the the idea behind this was
that the design decision behind this was
that users should not be managing memory
right I mean when you think about it
when you use your Microsoft Word or
Excel right you start it like you go to
start and you start the application then
you tell yourself at some point you know
I'm not using word and word right now
and word is taking too much of my memory
and then you go and you
down why do you do that because you want
to free up resources on your own Windows
computer right so in other words what
you're doing birthday is you're managing
the memory of your computer right we
shouldn't have to do that just like you
don't change gears in a car anymore and
you know you know you don't allocate or
in free memory anymore right like
algorithms do that for you so so this is
the idea behind the design of Android so
user should not care how something got
started if it's running in the
background and so on the system should
take care of that you just want to see
that app you want to get something done
right that's a philosophy make sense all
right so that's a little bit about
activities let me explain another
concept it's not really a building block
but it's used internally quite a bit so
it's a concept of an intent so basically
what an intent is is a sort of like an
event or a message that is used to glue
main building blocks together so it's
used to glue you know activities and
services and broadcast receivers and
content providers all these guys
together now I'm using it in a context
of activities just because it's easiest
to understand because they're visual
right so let me kind of walk you to this
so let's say let's say I am looking I'm
checking my my Gmail right now I'm in my
gmail app and I'm looking at the list of
messages right second so I am doing this
so I'm checking the list of messages on
now the so we're right here right now
so basically I see em and I see a
message that they like I click on it
what happens next
this activity is
go from running to stop state right it
sounds another activity is gonna go from
God knows where to start to to running
state we don't know which way we're
getting back into a running state no we
care right it's gonna come back to
running city so I'm now going from list
of messages to a particular message
let's say it's a message you sent me
so I'm now reading this message and it
says Oh check out this story about
Android taking over the world right so I
click on that story that now opens up
another activity so now this one is
stopped this when you stop this one is
now running right and it's a webview
activity and I can actually see the
story you know the web story the web URL
right and so it's an article about entry
taking over the world and instead of the
article says always see the video clip
right so I click on that that now opens
another activity this is now stop stop
stop maybe this is destroyed who knows
maybe this got destroyed right but now
we're in viewing the another activity in
which we can view the video right and
you know I click on that and it's like
you can see the old androids taking over
the world right so basically what I did
is I went through three applications and
across that I did one two three four
activities right and a basically
completed a task what made is possible
or intense like they kind of glued the
whole task together right now an intent
can be explicit or it can be implicit
explicit intent is you spell out what
you want to do but like in this case we
spelled out that we want to open up a
particular message in the Gmail
application so that's why it handled it
using the Gmail's own message view
activity right now when I clicked on in
here to open up a web browser I didn't
have to specify a specific web browser
just basically said open up in a
favorite web browser right so it could
have been Firefox it will open the
built-in browser it could be in Chrome
right so that's that is not important
system is going to resolve it so that's
an implicit in time similarly here when
we said I want to view a video it opens
it up in whatever you know
yeah so as an app developer you get to
say how you would like your action to be
handled so this guy here is saying when
the user chooses to open up a web
content it should be handled by whatever
is capable of handling web content right
so if you have one browser it's gonna
open it up with that browser you have
many browsers it's gonna prompt the user
and say which one would you like write
us developer key not should not be able
to to not allow that because that's kind
of like Microsoft not allowing any
browser other than Windows on right so
that would not be a good thing and you
can't do that no if you want to open it
up with your particular thing then you
would use your you would spell out open
it up using my browser
yeah you can if you want a specific one
yeah you can spell it out but you can't
say I want to have an open generic HTML
page using a specific browser you can
say I want to open up this using this
browser but you would spell it out yeah
and that's the case here so in this case
right that's explicit right so the back
button is just gonna go back on the on
the in the task list
if you go back to the browser so if
you're clicking the back button so
presumably the previous stuff hasn't
been this poised disposed off and it's
still on the stack then if I'm going
back into running by clicking on a back
button you are going to go through these
methods so it's gonna call on restart on
start on resume so if it's gonna fetch
something from the web or not depends on
where you're fetching as long as you are
fetching in one of these three yes
that's correct
but if you're fetching it on create no
it's not that's why you have the
opportunity in which when you wanna do
it what if you do it in on start it's
not right actually
so the question is if you so if you go
to a past and then resume what's good if
you have to remember the state it
depends on
I mean system is gonna your object is
still in memory so it's gonna retain the
state so you know you don't I mean the
state is gonna be retained but let me
give you an example if you rotate your
screen like if you do this ctrl shift F
11 so you control f11 yeah so I rotate
you the screen right what just happen is
this so we went from here initially to
here right we're there when I rotate the
screen it actually did this did this you
did this did this recycle the entire
thing from scratch
right I simply just rotated screen right
so you destroyed everything any created
everything I take some time it actually
is kind of slow ish you know so there
are some other life cycle methods there
something called on save instance state
and on restoring sustains state and as a
matter of fact if you guess remembering
our killer world the mad are oncreate
method this guy here gets a bundle and
this is the on
so this is one of those lifecycle mats
right if he keeps talking about them
here in a picture right so we here we
have them in a picture on create on
starter zoom is what it looks like in
code right but this one actually has
some so called a bundle state which is
basically normally now but if you're
going through that reincarnation it's an
opportunity for you to leave certain
primitive data for your future self
right so if I know I'm gonna get rotated
and I killed off I could say oh
like this is my state detaining so that
the next guy can be resumed there now do
you have to do that not really because a
lot of form elements are gonna memorize
their own state like if you care of just
a text field like it's gonna memorize
its state and so on but some some may
not look for example playing on video
looking from playing a video see I'm
playing a movie and accidentally rotate
the screen it would actually start from
the beginning so what I would do in that
case is I would actually maybe retain
the current position right store it in
this bundle upon re-creation pick up
that information and continue where seek
to and continue where I left off to kind
of make it look like it's all smooth so
assuming the message is not well SMS not
not really going to do anything but
phone call yes it would cause your
activity to be stopped in started but it
doesn't mean that it's gonna go to
entire cycle it could actually go from
here to death and then make be created
but in other words it's not doing this
and it's not doing that so in other
words your object hasn't been garbage
collected it still has its take well I
mean you would know based on which
methods are called right
so if if if it's going wrong created
then it's not in memory right so you
need to check because you know the
callbacks you know the structure you can
also change the default behavior may say
look that's call rotating of the screen
thing that's crazy we don't want to do
that we don't want the standard behavior
of destroying everything when you're
starting everything so you can override
the default dos default you can say I'm
gonna handle my own it'll change screen
rotation into a different default or not
yeah
so that's default invitation so far so
good on this
okay so let's do this let's take a short
break because I promise you got the guys
three o'clock and then we're gonna
continue we have basically two more a
main building 103 more building boss we
covered activities we have we still have
services we have the broadcast receivers
and content providers like single top
okay so let's continue you guys are
asking some good questions so a couple
things I want to point out also here is
that this is not this is guaranteed to
be cold this is not guaranteed to be
cold
no no so as a matter of fact like what I
did if you really want the details on
this or some somewhat over details let
me point you to two places one is the
official documentation which is
basically remember I said this this
website is gonna be a friend right so if
you go under activity activities the
talk about the life cycle is actually
outlined here and it talks about what
happens when right so so that's that's
basically what goes on right so so it
tells you here if it's guaranteed
so killable after so basically after on
pause right your your activity could be
could be killable not where it's gone
not it's not gonna be cleanly destroyed
so in all these states is clickable
pause on stop on destroy right it's very
it's not very likely it's gonna keep it
killed in on pause this is very sort of
like you know sudden death because it's
still partially visible so you don't
want it become even fake user outlook if
something that's partially visible just
disappears from the screen but it's
possible so so basically yeah so that's
the that's the official lifecycle now
what we've done is we wrote a little
example code which well if you care if
you care about downloading it let's do
this if you care about downloading it
remember github there's another
repository which is kind of useful but
let's download it later because
otherwise you're gonna spend time now
downloading it but I really wanted to
show you is the is the sorry the course
and there's a file that I put called
main building blocks so what I did did
is a wrote a little program called
lifecycle demo and I ran it through
various scenarios that I could take
think about and I documented that in
this document so basically I did I run
it through through starting activity
first time what happens let me actually
show you this in HTML format it's
actually easier to to reiterate get
easier to rather than paper so you look
at it like this right so first time
starting activity on create on Stalinism
simply what my program simply does is
just logs right so it doesn't really do
anything else just basically says I was
here right just logs so what happens
when you start when you're started one
activity but then you start another
activity yeah so you go to an on pause
stop restart stop start resume right so
you start another activity go back so
you fast stop then coming back these
steps are ism
here's the rotating of the screen
remember you rotate the screen sparse
top destroy create start resume right so
in other words we went through the
entire lifecycle right pause stop
destroy create start to resume right
right so that's that pad that we took to
come back what what is meant to do you
know and create different than on start
so it's a good question so it see how on
create is only called once on start in
the other hand is going to be called
here as well as here so in other words
it's really up to you what you're gonna
do when so for example you're like let's
say let's say you are establishing
connection to a database or to Twitter
or to some web service or something like
that where you gonna initialize that are
you gonna initialize it you know here or
you're gonna initialize it here I mean
this way around it doesn't matter both
are gonna happen the question is should
i reinitialize it when I'm going this
way
right or not so that's those are the
kinds of decisions that you got to make
practically or programmatically like
what happens all during the real world
is that universally you almost always
care about this guy almost always it's
very commonly used method right you can
think of it as a constructor or in it
and you always care about that one I
also find myself often caring about on
pause and on destroy on resume because
they're the they're kind of like the
opposites if you want to keep something
just in this state just let go and start
on stop or kind of the opposite so I'll
create on destroy right can make sense
so that's that's what I find but I find
myself using this a lot like for example
if I'm doing dealing with sensors or GPS
examples of they gave you exactly the
system doesn't tell you what will you do
with these methods they're empty like
you know not technically they're not
really empty but you subclass and then
you add your stuff right so so it's it's
a different way of programming right
because you're not saying you you don't
get to say what you want done right you
don't control which state you're in you
can't control am i here am i running am
i destroyed right it's kind of
counterintuitive like I can't kill my
activity right but you do control the
transitions right you control what
happens in route from one state to
another right those are the things that
you control so it's kind of like knowing
this state diagram it gives you
opportunities to be reactive to changes
in state but it doesn't give you
opportunity to pick a state okay so
that's where it's different it's a
different way of programming it's kind
of like event based programming or
whatever you want to call it right your
code is just there to respond to when
something happens you can't call you
don't call any of these methods system
calls the activity manager calls you
so if you if one activity you can
multiple fields they're just gonna be
objects within that activity object so
there's gonna be objects that becomes a
plain old Java in that that that becomes
a plain old Java this is where it's a
little more meta so yeah yes so it's if
that's all I said
you know it's conceptually if you guys
program you know container environment
like ejbs or similar to activity of
applets wear something else drives your
activities and the state of it is
external to the object itself then it's
maybe if conceptually you know similar
to experience before you can't you can't
cause yeah you can hint to the system
that you would like something to be
destroyed right let's call the task you
know like advanced task killer for
example you guess the function called
destroy it's going to still suggest to
the system to destroy so destroy is not
let me see if it actually exists in the
activity you don't you can't do it that
way but you can do it via the activity
manager the local activity manager and
then you could dispatch so you could
basically say destroy destroy activity
but but this is basically this basically
hints
the activity manager to destroy so
you're not you're basically telling the
system to destroy something as opposed
to your discerning exactly and it's
probably gonna require permissions
because no no Terran can just yeah and
this this has been deprecated by
fragment manager but that's a different
so in did you can't you can't the
question okay so a lot of this stuff is
sort of not very well documented that's
why that Lowell code if we were just
wrote was just meant to kind of test
some of these assumptions like what
happens I think you had a question
earlier about single top versus multi
top like what happens if I start an
activity then I start an activity again
and we'll get into that again like a
little bit but but you could actually
care multiple instances of an activity
and they just kind of like be a day end
up like on a stack right so it becomes
this situation where you know yeah
because it can get confusing if not
implemented properly you can define it
there's usually two ways to do it you
can do it in XML you can do it in Java
so yes you could do it in manifest and
specify that an activity is a single top
activity each well typically XML and
manifest is static so when you define
something in there it's like that for
life of it right so it's always like
that you're not really doing things
dynamically you do it in Java if if it
depends on some kind of condition or
something
right in certain cases something makes
sense to be a single top in other cases
it doesn't so so so in is it isn't a
static decision
this activity is always gonna be one of
singleton or is then dynamic decision
depending on the state something needs
to be sometimes one behave one way
sometimes the
different way well we'll see some of
these decisions in a different context
for you you kind of see the difference
between Java and XML but yeah we'll talk
about that so far so good and there's
activities and services so sorry
activities and intents so let's talk
about services so services are another
building block right we only have like
four building blocks activity services
provide you some receivers so services a
service is something that runs in
quote-unquote background right so it's
not visible it's typically running doing
something in the background now I say
quote unquote background because it's
not really running on a separate thread
it's actually running by default it's
running on the same UI thread that the
main activity is running so it's kind of
like misleading that it's actually in
the background and we'll see this as a
problem and then we're gonna introduce
some solutions to that but let's say I
want to write a music app like let's say
I want to write something like Pandora
right so I do need the UI I need some
way to basically you know pick a song or
station give it thumbs up thumbs down
fast forward stop whatever right so
basically if this is my app and this box
is my amp right then in my app I would
have some kind I would have an activity
it would be if you'd represent the UI
for this for this guy right this is my
user interface that's why I picked this
station and click thumbs up right but I
would not own playing all the music on
this because that would mean that
whenever you know at some point the
theoretical bridge is blown away by the
system and the music would abruptly stop
playing right that's not what you want
so you will not have the long running
tasks be part of the activity rather it
be a part of a service so this guy would
simply start a service stop a service
right
so this guy now owns the actual playing
of the music by default this one is
running on the UI thread as well yeah so
services by default turning in a single
same thread as your no it's it's what
get goes away is the activity object
right we do it doesn't go away is the
process that's running all this together
so let me I'll pull up a slide from it
it's this is really from a different
course but it actually illustrates this
point a little bit so your application
is has a single process right inside of
that process you have a thread a single
trend right what happens is a bunch of
things happen right like you press a
button that's a UI event phone call
comes think that's the UI van battery's
running low
that's a u that's some kind of system
event you know new tweet that's another
event right bunch of things things are
happening those things are being
dispatched to a Q so Q is basically a
queue you know first-in first-out right
so things are basically collected here
bunch of messages I intense remember
intense so they just get placed in this
kill right so then there's this guy code
the looper looper is basically just
running in a loop and it picks a message
at a time takes this message and says
alright what does this message say ah I
have to do something inactivity doesn't
oh okay I gotta start a music Frank god
oh the user wants to fast-forward the
music okay oh I want to stall the music
in so on and some so this guy is the guy
that is processing the messages it does
it cereal one by one by one
and that's how things work right
so what is important about this picture
is that this here is asynchronous the
messages gets dropped into a queue queue
gets bigger queue gets bigger and so on
and so right it's just a message
I'm intent right so this is asynchronous
this is synchronous blocking so while
the looper is busy processing an event
ok this nothing else happens so that's
where blocking comes in well we're gonna
look into this in more detail once we
actually have symptom you know something
to demonstrate again yes well in part of
one application this is one process one
application is my app no there's the
same thread there an object that
something else drives actions on that
something else is a looper it's looper
is its own thread yeah
so you have so it's this is just an
object right it's a Java object
something calls on create on star don't
stop or destroy and process this and
blah blah blah right so that's something
that is running is a looper it processes
the messages here it says oh look I
gotta I got some work for such a such
activity alright let me go tell around
that on that activity this guy goes away
fine looper is still processing the
message if do another message says start
activity then it's gonna gets recreated
and so on
so the question so the question about
who decides which one gets dumped so it
depends on a message right a message is
really in a form of an intent yeah
usually so it says it gives an intended
accusing intent now intents which we
talked about earlier oops too far
intense I here demonstrating intents for
activities so basically this guy says
start something that is capable of
rendering HTML most specifically says
open up this HTML page right who is
gonna open it depends on users
preference so if there are two or more
possible candidates that can handle
opening a web page right then the system
is gonna pop up the window this is which
one would you like and then you can say
don't ask me again I prefer this guy
right sort of just like when you
installed Safari or I or Firefox on your
on your PC attach them not to default
browser you said please be my default
browser don't ask me this again make
sense so conceptually where's the same
right so when you install so when you
install a web browser so you go on your
download Firefox on your phone Firefox
says I am a candidate to process HTML
pages please please please next time
there's an HTML page consider me as one
of the candidates pop up a question as
the user user wants to use me right
that's how it works now intents can be
directed toward services or activities
or broadcast and so on there can all
differently different cases but
activities handle it this way so we'll
talk about the other guys that run
yes yes that's what it's misleading
because you think about it
so yes the service is gonna block and
you are through you think about service
and you're like okay it's something that
runs in a background yes it's it's in a
background of in a way that you're not
seeing it but no it's not in a
background is in a background thread
which is what you kind of think
naturally right so it's not in a UI
thread it's not only a background thread
it turns it back äúi and it's actually
kind of hard to spot I think I actually
annoyed for sometimes like you know just
like why is my app so sluggish right
like what's going on why is it not
respond it's hard to catch right and
then later on you'll learn about some
profiling tools and stuff and then I
connect well we're actually gonna
visualize it we're gonna create a
problem then we're gonna solve that
problem cool so services are hard to
visualize so they just keep on running
in the background now
services get much easier life cycle you
know it's basically you started you
stopped it yeah a typical service is
gonna run through to reduce life cycles
it's gonna go through on create on start
and on destroy so the beginning it's
starting right it's in running state and
then it's in destroyed state now there's
no pause there's no resume because think
about pause is really meant for like
partially visible no such thing
audiences can be fast
yes but audio and video service are what
we call a remote service and it's
implemented differently so to be to be
fair there are two types well that there
are two types of services but there's
also two types of usage of one type of
service so
I'm talking about the simple service
just regular plain old service on a
plain old service you it it could be
bound or unbound okay so I'm here I'm
talking about the unbound one I just say
start something stop something the quote
unquote buttons I can press on it is
start/stop that's it right so that's a
very simple simplest one simple service
it's a typical service that's like okay
start checking for my email periodically
stop checking for my email periodically
right start Facebook updates stop
Facebook of it that sort of stuff right
it just it's one of those like always on
always running background thing is right
make sense so so that's basically what
the typical services you then have bound
services which there's a there's a sense
of essentially like a session but it's
not really a session between the client
and the service right the activity in
the service for example and that
requires use of inner process
communication via something called a LDL
but binder any ideal which we're gonna
talk toward like Thursday Friday right
that's a little harder more complex but
when you do that you can actually do a
much tighter connection between the
client and the servers right so supposed
to having two buttons you can have as
many buttons as you want
now just start checking my email but you
could say stop music fast-forward music
right rate music thumbs-up thumbs-down
that's all stuff but that requires a use
of binder that's the thing that we call
a binder provides for IPC mechanism
there's a know a sense of connection
between these two guys
we'll get that later on
and by the way user can see you can see
services with running so if I go home
many are you the owner forms to go
system settings application blah blah
here's actually I think you can do it
right from here so it's a shortcut
running
and so basically you can see what we got
oops running you can basically see what
we've got so basically I have one
service as part of the Android keyboard
right yeah so that's a service input
method so I could stop it if I wanted to
like how basically says stop the service
right so that's where services would
would be reported on a standard device a
standard device if I take this is my
consumer phone if I connect a consumer
phone
nothing special phone right so if I
connect my phone by USB cable into a
distance if it fits what I can do now I
can just do this I can go to I can go to
DDMS perspective and I can actually grow
so it's eco I took shows now online
right well nastic to physical versus I
mean I can actually grab a screenshot
from the phone oh maybe I should like
open up the so this is my lock screen
right so let me unlock it now it doesn't
I have to keep on refreshing it so I
have to do the Refresh you can kind of
you know see that so I can go for
example oops
settings
and I can do applications so I can do
running services all right so I'm
clicking on on this guy here running
services right and now you can see that
I have a lot of services on a standard
phone right like clock Google Voice is
running there to services Facebook to
one service and Rideau pin I don't know
why it's still running as a serious when
companion is running there right so you
know the list keeps on going like I'm
just halfway done right so look how many
thinks I have going on HTC Sense Google
services TeleNav cheese's and all these
guys basically running there right
backup service is running touch input is
running Maps is running right so they're
all doing something in the background
right oops
so Maps has been running for this I
guess back this is how many hours no
this is minutes so 600 minutes
yeah so that's why we you know we all
want to know why battery's running low
right that's because of all this all
this stuff that you kept going on in the
background right yeah so so do you guys
understand what services are then always
on always running stuff right so so
that's that's basically what that is so
let's talk about the let's talk about
the content providers me and just this
is very noisy and so content provider so
content providers are basically another
main building block and it's a way for
you to share the data between your apps
right so your apps live in in separate
sandbox one app cannot access the date
of the other app right they can't just
poke around it's a security mech that's
a basic security sort of paradigm of
Android each app was like a Chinese wall
around like you can't just access it
right on so what if you do want to share
the data what if I want my Twitter app
to share the data with my Facebook app
with my contacts it settles it so you
can you have the option of piercing a
hole in your app and exposing today
right and basically you do it for a
content provider and content provider
essentially is is your simple crud
interface God stands for create retrieve
update and delete so when it comes to
data that's the only four things you can
do with the data right hey donut rip
update update and delete it so we call
that basically insert update delete and
query those are the functions that we
can have with the metal so the API to
content writers right so system uses
this quite a bit like for example I go
out and I take a photo with my camera
well I would like this fallen out to be
in my gallery so in my gallery app you
can see I also want to take this photo
and send it to my buddies by Gmail or
maybe upload it to Facebook for a
Facebook app or maybe share it back
Twitter it's a lots of things I care
about this little photo I talk rights
and content providers make it possible
to share this day so here's another
example how that looks in the system so
basically if you take others or contacts
app aka address book right you don't
have one app you actually have two apps
right you have one app that has the UI
so this app is all about just having a
UID activity right so this is your user
interface have the buttons in you have
the pictures and all that stuff but no
data data is actually being served by
this guy it's provided right so this guy
now serves the data exposed by a content
provider to the you are
so we're decoupling concerns we could've
all bundled it in but then we would have
less of a flexible in a system right we
decouple it so there's an expense of
doing this like decoupling right like
anything else think so much simpler when
you just put everything in same box and
so forth
but when you want to separate it there's
an expensive but the flexibility is
awesome because now you can have
somebody else come and write another app
you know that has another UI that
actually talks to the same guy right
that's a the student for example HTC
does it creates you know the sexier
version of address book right but it
leverages the same data so it's not like
you have five databases for your people
you actually have one database not only
that but because now things share data
you can basically have your contacts be
augmented with your Facebook and Twitter
information and LinkedIn information my
Christian exchange information and so
forth so you can build it's curved like
a holistic view of Bob for example right
which is really cool it's sort of sense
agency sense for example takes advantage
of that quite a bit so does your app you
have to be running content provider is
going to be automatically created as
needed to serve content and disposed off
when it's not me yeah can you specify
who can access it yes
you have certain mechanisms of
controlling that access
one is to set up a permissions
statically you blanket not give it to
anyone else except just one those who
pull out you can dynamically also check
it so there are there multiple
mechanisms you know one way to think
about content providers is that you
access it via something called the URI
which is similar to a URL right so just
like web is all public right you can go
to any URL yeah that's
similarly content provider you can go to
any data
any Content they provide a data source
now it doesn't mean that it's gonna give
you much to the fact that I know some
some customers you know Bank of America
URL doesn't mean that I'm gonna be able
to see the data because it's really
quickly gonna boss me to a login screen
or something similar exactly yeah so
there's something although it's a web is
all about public access right you know
mechanisms all control that simple
sessions or Toki answer cookies sir
any of those mechanisms work on the web
right so similarly we can similar
mechanisms some pigs to available to us
with common flight and we're gonna
explore them later on yeah as we
couldn't man
so our final piece of this is final main
building block is something called
broadcast receivers so broadcast
receivers are basically your yeah your
publish/subscribe mechanism okay or if
you guys are more familiar with design
patterns this would be observer
observable pattern right you have
something observing something else right
so simple kind of because you know
observer observable pattern you
basically have a it's it needs to be
more dynamic otherwise publish/subscribe
you can be static so to explain this I
may have some piece of code I want to
register this piece of code for some
kind of event right like like for
example we care about SMS arriving we
care about system running low on battery
we care about network disappearing not
being available and so like dig up the
phone is a very noisy place there's a
lot of sort of broadcasts going on all
the time so if you care about such a
broadcast you register yourself for dead
broadcast when it cap is your code wakes
up and gets not effect so otherwise your
code is dormant right it just sits there
something it's registered for
happens BAM wakes up does the job
yeah yeah it's exactly it is a
publish/subscribe map yes exactly we
just call them buckets deceivers but
it's a publish/subscribe necklace
yes so the question is about the
broadcast car - basically if you have an
external device how to have that
external device notify some piece of
code about something right okay so you
kept Isis here right and this way it
becomes you know the design of an app is
more of an art than a science right so
you have a choice - like I'll give you
an example you could compare that to
sensors right so sensors don't do don't
use this like for example if I want to
know when our magnetic field changes or
orientation changes or you know
temperature change so whatever the
sensor is right he doesn't work that way
nor does GPS forget way it works this
way you know uses the dis mechanism so
you say I want to know when my my
location changes you you register
yourself for updates and you keep
getting these updates keep getting this
updates keep getting these updates keep
getting this update you're getting this
of it it's a push push push push like
all the time right like it could be you
know many many times per second right so
so it uses it uses remote service uses a
IDL bind there
IPC mechanism right it uses that yeah so
it's different mechanism on the other
hand like let's say for example NFC Near
Field Communication like you want to do
something like that right that doesn't
use that mechanism it uses the mechanism
broadcast receiver where you basically
say I want to be notified when you know
and NFC devices in the area BAM notify
so something like that right
so why would you in one case use one
versus the other mechanism the
fundamental difference is is a
synchronous versus asynchronous nature
of this right in other words how quickly
do you need is response notifications
right so this stuff the this come in
this community
here is synchronous this guy is now
going to do black lip call to this guy
and say something happened something
kappa something kappa something kappa
right so it's synchronous until this
gets processed it sits there it's
waiting it's blocking this guy's now
blocking for that callback yeah whereas
in this case the nature is a sickness
something happened this guy is gonna at
some point senate broadcast to be
processed but it's gonna present
broadcast right away but that broadcast
is gonna sit in a queue until it waits
its turn it could be like couple of
cycles right battery's running low
alright you know in the couple of
seconds we'll find out about that no big
deal right estimates arrive you know a
couple seconds i'll find out no big deal
right but if i'm playing a video game
right it's like you know you're playing
like you know fast and furious or
something like that it's like oh there's
a wall I better like you know I want my
car to turn otherwise like I end up in
the wall right so it's so asynchronous
doesn't cut it for playing a video game
right exams so you have many ways to
communicate but one makes better sense
in some cases than the other so scanner
it really depends you know how you do it
we usually do we usually do the async we
actually have a similar example for our
internals class we actually build
something from top to bottom that
controls the device link of either
barcode scanner or or a missile launcher
but we use these we use the remote
services binder so so that's a so that's
basically broadcast receivers</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>