<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tutorial: IndexedDB with Mozilla Firefox - HTML5 &amp; jQuery Development | Coder Coacher - Coaching Coders</title><meta content="Tutorial: IndexedDB with Mozilla Firefox - HTML5 &amp; jQuery Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tutorial: IndexedDB with Mozilla Firefox - HTML5 &amp; jQuery Development</b></h2><h5 class="post__date">2011-04-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aUqbg-PPVyc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi everyone my name is long I work at
Maracana in San Francisco and today we
are going to talk about indexdb on
Mozilla Firefox before digging into the
details of indexdb let me just first
show you what we are going to build
today so I have this folder tutorial
final indexdb which is going to be
available to you at the end of this
tutorial
and there is two prerequisites to make
this work the first one is that you have
to solve your application from web
server it can be a local server or and
the second prerequisites is that you
have to use Firefox 4 in order to make
this work so let me go and open my
application desktop and let me start my
Python server which is the simple HTTP
server module note that my server is
launched lets me open firefox and let's
see what the application looks like
okay so here for the first time that I
open this I have a little notification
from Firefox asking me if I want to
authorize this application to store data
for offline use of course I'm going to
allow it but what you have to know is
that when you use private browsing mode
index the B's it's not gonna work it
automatically denies the storage of data
so here I'm going to allow and this is
my application I have the top yellow bar
saying show menu so if I click on this I
have a way to add notes into my
application so you know this is a new
note if I press on that note I'm gonna
have a nice fading effect I can add
another one hey I really like it's you
know they're not okay
you know it's nuts so if I press on
Germany again you can see that I have
those slide up slide down effects by the
way this is gonna use jQuery we are
going to detail few things on jQuery but
it's not going to be really armed so
even if you don't know jQuery that
should be okay so what I can do next on
my notes is to remove them on clicking
the Red Cross at the top right corner
like you know with a nice fade out
effects and same thing yeah and
basically that that's it
this is what you're gonna do so what is
indexeddb indexeddb is a way to store
JavaScript objects in the browser we
have few things that are called object
store and this object store contain
objects it's also based on a key value
pair system so for a key you're gonna
star value and this value is going to be
your JavaScript objects and that's it
we're gonna see what are the main steps
to do that let's open the project and
see what are the assets composing our
application
there you can see that I have a lot of
different files in my application I have
delayed dot PNG which is representing
the Red Cross on top of each notes which
allow which allowing me to remove the
not in question I have another Kenji
representing the notes I have then
jQuery library and script ojs which is
gonna be all scripts I have a style
sheet and I have the main page index
that HTML so there is my index dot HTML
I have the yellow bar menu that I showed
you before I have a div which allowed me
to enter new notes and who add it and
then I have a div which is gonna be
containing our notes and the last thing
here that I have is the script I have
the jQuery library and I have our
scripts where we are gonna have allow
indexdb operation a quick explanation on
those scripts I choose to include the
script at the bottom of the page for the
simple reason that intervals best
practice if you include your scripts at
the top of the page in the add elements
the browser will load the script first
then it will pass the page and render
the elements in the case where you have
pretty heavy scripts
it will take some times before the user
can see the page so in terms of best
practice it's always good to 1200 script
at the bottom of your page alright so
the core of our application is gonna
happen
in script is I start by first creating
an object which is called my notes then
on the subject I want to create a
property called DB which is going to
contain a database instance and the
database instance I'm going to get it
from the open function the open function
and start with this very first operation
which is going to open
so database if it's already created or
creates the database and then open it
so before explaining this method let me
just make a point on this Mo's prefix
the most prefix come from the fact that
the specification is not done yet it's
most likely going to change and what is
let developers have just chosen to
increase this prefix so the open method
the open method is taking two parameters
the first one is the name of the
database to create or to open and the
second parameter is a textual
description of our database this open
method is a synchronous so as soon as we
call it
it automatically return an ID B request
and store it in the request viable this
request value bar is an ID be request
again and it has the following
properties it says the unsuccess
callback and on error callback which is
allowing us to listen for success or for
error during the process in the success
callback
I start to create a version viable I'm
going to explain why in a bit and then
the next big operation is to get the
database instance on my ID B request
which is e dot target's
I get the result properties the result
properties for an ID b request can be
anything depending on what is the
operation we call here in that case we
call the open so result is going to
contain an ID b database so here we get
the database instance
this line allow us to to make the code
easier to read
I don't want who to write every time my
notes the DB so I just shorten and say
DB I added log statements showing the
database version by calling DB version
and here is the important parts I check
if the database version is the same one
as the one I specified yeah so what I
mean here is the following if it's the
first time I create the database I want
to create an object store again so an
object store is something that is going
to contain our JavaScript objects so if
it's the first time I create my database
I want to set the version of the
database so here I call DB that said
version and the version that I want to
set which is going to be this one then I
want to create my object store and you
have to know one important thing you can
only create object store in a set
version transaction so yeah I listen for
success so if I could change the version
successfully I now want to create my
object store so here is the lots of log
statements and display the new database
version and I'm just saying eh now I'm
going to create the notes store so here
is the store that I create and I just do
create object store the name of the
store that I want to create and here the
second argument of create object store
is an option object you're gonna have
details on this option object on the
link
that I'm going to provide you at the end
of this tutorial but yeah basically what
I'm doing is the following
I'm saying my JavaScript object which is
going to be a nodes they have to be
different by same by self timestamp the
timestamp is going to be basically the
ID for each node each node in the object
store are gonna I've are gonna have a
timestamp property which is gonna be
unique okay then when my database is
initialized and open I want to get all
the existing nodes in the database if
the RISM and i want to display them so
I'm gonna call get or nodes we were
gonna dig into this function in a bit
here is my error events so in case
something went wrong I just want to
display the error code the next step is
the add node function so then that
function is going to to add nodes in the
object store so the parameter here is
the text of the nodes and here is what
I'm doing I'm getting the database
instance and from this database instance
I want to start a new transaction the
transaction method is going to take the
following arguments the first one is an
array of objects tiles that I want to
work on and the second argument is the
transaction mode in that case since I
add object to the object store I want to
have a read write mode the next step is
to get the store that I want to work on
so from the transaction I call the
object store method with the name of the
store to walk on here is the notes that
I want to add in the object store Zoo
nodes is going to have a text properties
which is going to be the to do text this
one and the notes is gonna have a
timestamp properties and it's going to
be equal
to this once son God is created I want
to add this notes in the store so I call
the following store that puts two other
notes in the store and the not object I
listen in case of success or in case of
error yeah in case of success I want to
add the log statement saying hey I just
added this note with the following
timestamp and the timestamp property the
timestamp is going to be represented by
this either target results so again the
result properties property depend of
what is the operation you call there is
a little bit of jQuery what I do is I
get the the area where I enter my notes
and I want to hear it as soon as I enter
note I want to clear this area then once
I have put a new note in the store I
want to display this note so I call
display notes and so not with the not
object as an argument the error event is
just going to display what was the error
code in case of error all right
the next step is to get all notes so
same thing here from my database
instance I start a new transaction with
the object store I want to walk on the
type of transaction that one to the
transaction mods that I want to use here
is the read write mode I open the store
that I want to work on so the next store
and from this node star
I want to iterate I want to iterate this
store I want to iterate through a
every object in the store so to do that
I will open a cursor so from the store I
open a cursor and the next step is to
create a variable which is going to
contain every store on every node in the
store so from this open cursor operation
I return an ID be request again and same
thing as the beginning this IDP request
as a success on success property and
this on success property is going to do
the following so in case of a success we
want to get the cursor so here I get an
ID beaker so by calling the target dot
result in case we have a cursor we want
to add the current notes to the notes
array previously defined here the
current node is going to be an object
and this object has time stamp
properties I get it from cursor that key
it's gonna have a text property and I
get it from Castle that value which is
representing the current object and the
text properties of this current object
and then next I want to I want to
continue iterating on them on the store
so I continue to iterate this will go
again into the following step and once
there is no more object in the store I
go in the else section
so once we have finished to iterate
through every nodes in the store we want
for each nodes to display the nodes so
you know I iterate through my array and
for each node in this array I'm going to
call display node method the display
node method
so the display node method takes a not
object as an argument and it's going to
display it on the page the first
operation is to get the the elements
that is going to contain our nodes so in
that case if you remember the div with
an ID nodes which is this following this
one we get this deal then we create a
single node that we are going to add to
this deal so the knot is going to be
created with some jQuery like this we
create when you live representing the
nodes in this deep we are going to have
an image the red cross image which is
going to allow us to remove the nodes
then we are going to have a paragraph
containing the text of the nodes we then
want to define some action on this node
so air is what I'm doing what I want to
do here is the following
I want to delete my nodes as soon as I
click on the red cross so in my notes I
want to find the elements that have the
delete class so the images and when I
click on this image I want to call this
one
I'm gonna say you're going to delete my
notes using the timestamp of the notes
again the timestamp of the notes is
something unique to the note so this is
how we know which not to delete then
once we have called the late note I want
to fade out the notes and once it has
finished to fade out I want to remove
these notes from the Dom now what I want
to do is to create the fading effect
because here we display not I just
specify what's gonna happen as soon as I
click on the red cross but the main goal
here is to display the note so I first I
to note I add the notes to the general
deep section and then I call fade in
which is a jQuery function which is
going to create the fade in effect in
the page when I add a note the delayed
notes function so the delay that
function is going to basically remove a
notes using its timestamp so here I pass
the timestamp of the notes and here is
what I'm doing from the database
instance I create a transaction again I
want to work on the note object store
and I want the read write mode since we
are going to delete object from the
object store I get my notes object store
and from the store I want to delete a
note using its timestamp in case of your
success I want to display a console
statement saying a e times 6
successfully deleted so this is it for
object but now we have to wear all of
this in order to make this work so here
is what I'm doing here is a jQuery
construct which is saying the following
if the document is ready I'm going to
open or create the database and now I
specify some behavior when I click on
the button to add a note so when I click
on the button I want to execute this
function I want to get the message
entered by the user by doing this if
this message is not empty I want to call
add note with the message now what i'm
doing here is when i start a page i
don't want to show the add note section
to to the user so I'm gonna have to
click on the menu bar to display it
and finally what I'm doing is the
following when I click on the menu bar
elements if you remember it's the top
yellow bar of the page which is this one
saying show me on you so if I click it
the section where I can add a note will
slide down if I click it again the
section - I do not will slide up and
that's it this is all you need to do to
make your application work that's it
you're good to go
again if you want to show what it looks
like and your server is started it's
already started from here
you click you got a note
add notes and other notes and you can
remove them okay that was the tutorial
on indexdb and if you want more
information on that specifically for
Firefox I will recommend you to go to
the following link
I hope you enjoyed this tutorial thank
you for watching and check us out at
Maracana dot-com slash tech today</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>