<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Intro to Android NDK - 08 - The First Run | Coder Coacher - Coaching Coders</title><meta content="Intro to Android NDK - 08 - The First Run - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Intro to Android NDK - 08 - The First Run</b></h2><h5 class="post__date">2012-04-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pHS4aXqPo-A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so the way we're gonna do this is
we're gonna create a if you don't
already have one a new a VD so I'm gonna
go over here and say I want to create a
new abd I'm gonna call it for example
you know Android 15 and DK a specific
I'm gonna target API level 15 I'm gonna
go and say I don't as the card 16
megabytes and I'm gonna change the
resolution to be I don't know half PGA
so that's that's it that's my abd I'm
gonna now create it and I'm gonna go and
create and start it up so start launched
and it'll take a little bit of time and
once it launches I'm actually gonna run
my application as an Android application
and observe what happens inside of the
over here we're gonna type adb logcat of
course we have to make sure this
connects it's gonna take a little bit of
time it takes longer then I would like
but so I'll just have to restart this
there we go okay so our device is now
booting it's not yet ready to accept our
application but it will in a moment and
then when it does we'll be able to take
a look at how it deploys our application
and then of course how application
actually runs for execute so let's give
it a little bit of time and then we'll
go back over here to eclipse and test
things out okay so now I can close this
go back over here and patient is double
try this started it did I need to go and
wreak relaunch this sometimes it exits
so we are in business
and so now what I'm gonna do is come
back and right click on this say run as
and replication now if everything is
done correctly I see
libraries are here my all my files
compiled this should sometimes today go
and launch it so it did it says
displaying activity so I'm gonna go back
here unlock the device here it is
he doesn't say much about you know
anything respect to Jay and I just yet
but I do want to show you something
before we go into actually running it if
I type adb shell and I actually go into
the data slash data slash Maracana dot
Android the Fibonacci native you'll
notice that there's a directory here
called lip and if I go into that
directory LS dash L you'll notice that
there is a library that happens to be
ours now the question is which one is it
so which of these is the you know we
built essentially we compile three
different versions there's one here one
here one here so it just so happens to
be this one because this particular
meter is wrong emulator is running on
arm v7 I can test this out I mean I can
go and say for example just look at the
size and just comparing the size of that
to the size of these other ones so I can
actually go and exit this and do an LS
dash L of Lib if you will not achieve or
arm actually seven you'll see that that
size and this size are exactly the same
another another thing I could have done
is I could have said ADB pull this file
so just download it so I can actually
see which one is being used so I'm gonna
copy pasted that path and this okay I'm
going to download it here into my
current directory so oops I have an
extra missing an extra slash here or
extra lives or latent I should say okay
so now I have that file here temporarily
file Lib Liberace
welcome to this is the file that I got
and it should say that it just says
armed for some reason I thought it would
say rv7 some oh well at least we know
it's armed and it should work so anyway
I'm gonna go ahead and delete it because
I don't need it here and now I won't
actually see what happens if I type adb
logcat again and clear the screen wait
for me to actually execute something so
for example I can say right off the bat
give me if you were actually using
native recursive for 15 click on this
and it gives me that it's you know 610
in 3 milliseconds and what's interesting
is right now I can see as soon as I'm
around this code because my code tries
to use fib Lib and fib live has a static
initializer just to remind you it's
right here that we added and the static
initializer says I want to load this
library because of this one line dalvik
virtual machine goes and says ok let's
go and find a library it finds it in
this folder this is the this the path
this is what kind of pre prefix
predefined it goes and loads it it
doesn't find any sort of onload function
which we'll talk about in a moment but
now is able to actually bind to it and
you know as a result is able to give it
a give us a correct result let's compare
this to the Java version you know does
it you know does this produce the same
result if I do the ni same result if I
do the favorite whoops is the same
result this one is now the same result
is this so somehow I must have changed
or implemented incorrectly I guess I'm
gonna have to go and fix it ok so let's
take a look at our code we have it over
here I realized that actually one thing
I forgot to do is to make sure that this
I goes all the way up to and including n
not to 1 less than n so that's my
mistake missing this one equal sign so
I'm
I have to fix the same thing in the sea
version I probably made the same mistake
because it got me pissed their code and
I did so say equals here as well
now here's an opportunity for us to go
and re could redeploy it so I'm gonna go
over here and type in the K build so to
recompile it so click on OK they
repackaged it and then I'm gonna go I
usually like to go and type to do
refresh to make sure that eclipse is
aware of all the changes to all the
files because especially when I modify
files from outside of Eclipse and now I
can go and rerun the same code so let's
see go back click ok here it should
redeploy and so let's try this again 15
for junior same thing over here now we
get the correct result ok perfect now of
course if you try larger values like you
know say 25 this one will be extremely
fast it doesn't you know essentially
zero milliseconds this one takes 14 this
one takes zero but this one may take
slightly more you know on more than half
a second so and it goes you know very
very exponentially essentially it gets
more expensive as you increase this
number so don't use you know anything
above say 35 especially if using the
recursive versions well for the e30 ones
doesn't really matter how high the
number is so anyway we now have a
working version of our code base we are
able to invoke from Java the native
functions will just kind of see this
this is essentially where we're working
it now what's nice about this is the
client code has no idea that it's
actually talking to the you know C code
underneath the hood nor does it care all
of that is essentially been abstracted
by this you know function that just
happens to be marked native and then the
binding from this native function to the
C implementation happens as a result of
the correct naming of our functions and
methods so now that we know this I
wanted us to take a look at one more
little feature actually two more
features but we'll start with one and
that has to
with logging how do we know that
essentially working correctly so let's
do a little bit of logging</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>