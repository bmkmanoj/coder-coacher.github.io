<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Video: Android Application Development - AsyncTask, Preferences, and Options Menu | Coder Coacher - Coaching Coders</title><meta content="Video: Android Application Development - AsyncTask, Preferences, and Options Menu - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Video: Android Application Development - AsyncTask, Preferences, and Options Menu</b></h2><h5 class="post__date">2011-02-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uzJmi59b6oI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so basically the problem that we had
here is that everything happens on this
UI thread right and that makes execution
slower and also makes your app not
responsive while it's performing a
long-running task such as such as
updating the status online right so the
proper way to do that is to outsource
long-running work on a separate thread
um so you may wanna you may think about
that and if you're just thinking in
terms of Java you would do something of
this nature now don't don't do this
because I'm going to I'm going to take
it out but you would do something like
this so this is the long-running stuff
right and typically what i would do is i
would put all this long-running stuff on
a separate thread so i may do something
like this in regular Java so a new
thread all right I started and then I
say create a public void void run method
inside of it and then I do dot start
start so this would create a new thread
and whatever I want long-running I put
in here so I could for example cut this
out right and and put it oops and put it
into the into here make sense except its
first of all it's complaining about make
tech decimate may make text stuff which
I may you know common thought that's
another problem all together but um but
let's um it d arick basically it's the
air that you're going to show i'm going
to show you in a second yeah so it's the
same type of error but i want to show
you like this so i'm going to run this
okay um and I'll get back to that there
so I want to run this so I'm starting it
I say it doesn't matter hello something
like that I click on update and what's
going to happen is my code is responsive
on but any did put stuff on the separate
thread but you'll see you'll see when
it's done with promise and I may take 30
seconds because I'm still offline right
I still don't have a connection or
should have enabled connection or we see
going to re-login
so in the connection this time out not
yet mmm what is the IP okay so i get to
log in again kandireega so i'm logged in
so i should have the network connection
click on update and you should crash
but except we are catching and buuck are
you catching with the section sick look
at our stock price let me read on this
so I'm just going to write on this
example because it's just taking too
long with this network connection stuff
ok ok so our app is up I say hello and
click on update
hmm
well I have a different problem
altogether I have a count rate limit
exceeded the second so basically what's
going on is too many attempts to do this
and the service actually shut us down so
you may make sure have a service running
okay so I killed it service because i
have another service it keeps running in
the background all the time and that's
partially why it's partially one of the
problems um i'm going to try again to
see if i can run this one install it
I'm waiting for it to start
we'll start it this way okay hello
update
booth
okay so that actually a record ran on a
separate thread okay that actually
worked and so let me show you something
with the trace file so remember how this
trace file looks like we only have one
UI thread here right everything is
working here so our network update
happens on this guy so what I'm going to
do is now going to look at the other
trace file so I'm going to get it so I'm
going to pull it from the device I'm
going to open it up and we're going to
see that there's actually a new thread
okay so this is our new thread okay this
guy here and notice that all our network
stuff basically this is our UI it ran
ran ran when we started doing network
stuff we actually went up here did it
here then went back here did some stuff
on the UI thread then one back here did
some stuff up here then run back in and
so on and so on right so we outsource
this work and this work to the UI thread
and we can zoom in on this to kind of
see what really happened you can zoom in
on this and you can see that this is
like white buffer you can see that this
is URL stuff you can see that this is a
you know network that this these are
metric related calls right the green
stuff is status activity there's this
green stuff is internal stuff let's take
a look at this other blip here so if
you're going here so let's see the blue
is buffer read read right so it is the
network stuff you can even tell here it
is babe based on J to the library right
so in other words this works fine so
that's how you do it in Java you just
put something on a separate thread right
you guys do you guys know that from
regular Java okay now the problem with
that with that is if I want to update
the UI right so what if once we are done
with this I want to update the UI now
in this particular case with toast the
compiler is actually not even going to
let me do that right so that's what the
error back to your question what's the
error here basically it says toast is
not applicable for the argument this
okay so it needs this in this case is
what the thread class yes so if i wanted
to point to status activity I could say
status activity right okay so let's fix
that again still don't do this so now if
I run it so I fixed it it compiles right
so run it
I'll say blah click on update and it
crashed okay and so let's see why it
crashed right so this says rick this has
read the lock yet so we're now reading
the locket and the lock it says it says
this can't create handler inside
threaded he has not called loop repair
okay in this case it's kind of like on a
weird message it doesn't really tell you
really what's going on but the idea
behind this is that you cannot have one
thread update UI of another tribe right
in other words it you can't just create
a thread and have it update another
threats you I because that would doubt
cause of all social issues with respect
to you know because it's owned by the
original UI thread right so we can't do
that so we would have to provide some
kind of synchronization and I know that
sort of stuff right to synchronize the
two threads so we was here to somehow
communicate from one to the other to say
hey you know I'm this much done this
much done finally complete right so so
make sense so far make sense again so
the solution to that is something called
async task so let me show you do android
com there's something called async task
an async task is it is a convenience
method that makes it easier for you to
handle long-running stuff okay so the
way you do it is by creating a new class
right that extends async task and that
implements at least this one method
doing background so what it does is it
doesn t in the background it can
potentially send you the progress
updates meaning it says um want you know
ten percent down twenty percent done
then sort of fire
stuff and in when it's done done done
you can you can do something on post
execute on progress update it if it can
cause it when you do publish progress
so that's basically when calls it so now
here's a couple of things that are kind
of interesting you guys know generics
are right and so he not a scare how we
are using them okay so this one this
file is basically the input and you know
what variable length arguments all right
so this one is the input to this file
the output is this file long which
matches that which matches the result
which matches that so basically in
background does something sends the
result and sends it back here okay
so far so good
okay and and then if you have any
updates that that's that file that's
that integer what so let's do this what
I want to do is now so I'm not going to
do this thread new stuff because like we
explained that doesn't work for our
needs so I'm going to go back to what we
had before right right so what we're
going to do is we're going to do
something like that so I'm going to
create a new class you can make it
private if you want private class and
i'm going to say you know what do they
call it a new book update good twitter
post it to the test goes to a quick post
task or something like that keep it
simpler or let me let me let me actually
see one second so by the way so just so
you know we're at so we're talking about
you I so and there's a section on
treading right so that's that's what
we're I just want to be on the same page
post to Twitter okay I'll call it the
same so what we're going to do is we're
going to call it post to post post to
Twitter it's not just Twitter and now
the we have basically input a result in
the middle in an output so basically
what's going to be the input to Twitter
that we're making the the Torah posting
so that's going to be the status the
message a source drink right what's the
intermediary we don't really have an
intermediary result and so you know I
can sail I'll say string string string
for simplicity sake okay
so post to twitter extends async task
right and i can pacing organize import
to import async task I can do string
string string that's fine and we must
provide that one method at least which
is doing background and again the quick
way to do it is just to say Eclipse add
unimplemented methods right so Eclipse
just adds that method so so this is
going to be our what's the input it's
going to be stat status right that's
going to be our input that's what we're
getting into the doing background job
right
yeah well it can take three parameters
so one goes into doing background one
goes on post executing one goes in the
the intermediary updated of progress
doing progress update yeah so see how
like for example here not here but here
how we're going to create it is but well
when we do a class we're just going to
create a new class and then we're going
to execute by passing in only one string
so for in our case is just going to be 1
status but this would also do multiple
statuses or you know in the same point
but this sort of this map into this goes
into that this goes into that and this
goes into that yes you're seeing execute
but then class internal is going to
manage these three yes yeah yeah and
then this must match that because that
the result of doing background goes into
result yeah so it's a little it's you
know it's a little convoluted but this
is a good example that's why I kind of
wanted to implement it so this is going
to be my result right so I'm going to
have some kind of result result right
and then and then I'm going to also add
that method on post fault post execute
and this is again where you can do
source override implement methods and
see how it knows what's possible to
place in there right it's it's kind of
knows that you are inside of casing task
so only the following things are
possible alright so i'm going to say on
post execute and bam it adds that method
for me okay so far so good so this is
the structure of that right so in our
case we're doing something in a
background passing the status doing some
work here you know this the work is
going to go in here we haven't done it
yet right and then once we are done
we're going to do something here on post
execute so far so good
Oh
baby I got his spring ball into what it
doesn't matter I mean I'm not using this
middle parameter are we going yeah I'm
not using it it doesn't really matter
what it is you know if there was an
intermediary status because I don't
really I don't really know that we're
five percent down ten percent done in
this case I don't really have that
progress report thinking yeah I remember
seeing which is not quite uh not quite
you would still have the issue of one
thread synchronizing you synchronizing
one thread with the other time when it
comes to updating the UI um that message
Rupert prepare is sort of yeah it's it's
referring in directly to that let me
just kind of try to explain what that is
sort of a minute digression on on this
but actually created a picture for this
after zillion people ask this question
so looper so this is what it looks like
inside of a process right so this is our
application right and you keep pressing
the button you know you press a button
and or some system events happen like
phone calls coming in SMS arrives
battery's running low whatever that is
some new intent gets fired all those
things just go on the back of some cues
there's a queue and the message get
messages get posted under the Cure like
that right and then each thread here's
it's a looper and looper just keeps
looping and it does one job at a time
one job at a time one job at a time so
it keeps grabbing one of these messages
and then it executes sit okay thanks
sounds
so when it transit it executed now when
it grabs the next one it compares its
time stamp to the previous one so it
says okay how old is this message and
that's how it knows that if the message
is Alder them say three seconds it says
okay I'm not doing my job fast enough
and that's when the system offers to
shut it down okay so that's what that's
what a looper does it basically loops
serially over a message queue and
whenever something happens that just
gets drops onto a message queue right
when he make an intent when you press
the button and that's why if you guys
remember for me to recreate this proton
that problem i had to both start the
starting activity right but they also
had to so he had to start it I had to
let it run so yellow again right so I
need to click update so clicking an
update actually puts a message here on
the message queue but if that was the
last thing I did then I probably
wouldn't get force closing wait why
because there's no subsequent messages
so it wouldn't know how long it took it
to do the first one it only knows how
long it took it if there is a second
message which now has a tiny timestamp
that's older than three seconds make
sense so that's so that's kind of deck
how that works now what soga looper you
cannot prepare is basically an access to
this looper so looper and handler go
hand in hand Chandler is our access to
the looper I used to do this stuff more
via loopers and handlers but then I
realize that that's overly complicated
not really necessary second I'm
simplified it quite a bit so you give
something to say this man needs to
and then it's gone now Chandler is your
access to the looper so by having a
handler you can basically post jobs so
when yet money saved a handler dot post
I'm actually adding a message on to the
cure that's what that is but we're not
doing it in this case yeah so does that
kind of make sense so back to this this
is basically the shell of our code so
the long-running stuff was des trite
this is what took forever to run ok so
I'm going to cut this out I'm going to
put it inside of here that's our own a
long-running task right
okay so now the status is going to be
dis status but you guys know what status
dot string dot dot dot is right do you
know so that means that you can have
many like it's it's a variable number of
arguments it could be 1 2 3 4 5 10
arguments right just like in a printf
statement you can have variable number
of arguments you know I'm talking about
so that's what that is in Java so but
however what Java does when it sees that
it really just packages this stuff into
array so basically phone access does the
first element I just have to say status
zero let's say
so far so good okay so so since I'm not
going to be updating that taken just the
thread the UI from the main thread from
this thread right so I'm not going to be
doing it from this thread so supposed to
doing this we're simply going to return
as a result is that message right status
tailed or succeeded write something like
that right and here i would say status
fail the result Stiles failed right see
my god so this is now returning the
result but then on post execute we can
actually update it right so here I can
now say I can now say toast dot make
text and then the context is going to be
the parent which is status activity dot
dis right text is going to be a result
right in a result right and then
duration is going to be toast dot make
long and dot show so that's done however
what's one thing that you guys don't
like about this code exactly I I kind of
cheated I went back to like hard coding
the text all right i partially wanted to
do that because i wanted to say hey you
know now what how do you how do you pass
it back
let achit it here and here
so how'd you get around this here two
days so return strangers return soon as
i can tell you though those are integers
and then at the bottom just accepted
into general plan to turn a very short I
to your attachments yeah I mean one way
would be to reengineer this so that we
are not working with a string here but
we are working with the integer
corresponding to the to the actual re
source idea we could do that it's not
the most elegant and if I should
absolutely work that that's definitely a
solution but with the reason why I
wanted to bring this issue on is you
know so far we've been working with a
nice Android API that is aware of
resource IDs so you can pass a string or
you can pass the resource ID it in knows
how to behave if it's an ID right but
not all API is resource idea where
especially not non-android one right
like some other Java classes in stuff so
sometimes you actually need to look up
the actual value of the actual system
research right how do you do that yeah
so um there's a method off of context
right like we've seen a bunch of stuff
that hangs off of context but basically
I would need to get access to contact
normally it would be just this dot but
since we're we then post opposed to
Twitter so this doesn't work so i have
to say status activity dot get dot this
dot get get resources or even better get
string so what i can do is i can
basically say status activity like this
that gets me access to the context and i
can say get string so it returns the
string for that particular context
all right and now I can say our dot
string dot and then study successful I'm
going to copy paste that here and say so
and that's it
usually there isn't an expressive of
course kid mother oh that just doesn't
make text and so we're going to return
the result as a string from one method
to the other one yes because we haven't
used it yet so so what's saying is that
you have this class but you're never
using it so we need to kick start it and
we do that on click so I'm click we're
going to kick start it so we're going to
do it just like in this example right so
new blah execute right so I'm going to
say new post to Twitter right dot
execute and then I'm going to pass in
the bowstring status right so this
status now goes into here okay which is
going to go into here right which then
goes into the result of which then goes
from here oops from here to here
up oh you're looking for this line yeah
so on post execute is linked to death so
basically this is the work that would go
on a separate thread so this is the work
that was go on a separate I'd when it's
done it's kind of like doing a way to
notify it results in a notification to
this guy so this gets post posted in
here and that information right that's
kind of how so this now runs on a
separate thread and when it's done this
is going back on the UI thread so this
is sort of like this so this is a UI UI
and this is a sink no I know it doesn't
then kill ya so we didn't give it a name
right so here it's just called async
task yeah yeah there's a way that's a
good question how do you give it a name
and I think you need to do I think you
need to just insert on a generator
constructor and I think you just need to
print generate the constructor and I
think you give it a name here maybe not
I'm normal thread that's what does what
you do a bit I forgotten i saw it i know
there's our
yeah so um anyway does this does this
make sense there are more or less howdy
folks why why we care about that it's
maybe a little advanced topic but it's
important to be merry meet me then well
we didn't we are going to use it we're
going to use discipline or vanilla as
well when in the first service because
we don't have to synchronize anything
but in in this case this this is much
easier than a strange man you yeah
exactly exactly okay so you guys ready
for something now okay so um we don't
yeah I'm sure we know is going to close
this so let's take a look at what we're
at so this is our game plan so this is a
game plan right so we now have this done
done done done we exhausted it like
we've done a lot of stuff on it we've
done this it updates the online service
and so on right one thing that kind of
is not very good about it is that
username and pass a jerk hard coded so
is the service they can be really cool
if we could make this application work
with multiple services and multiple user
user IDs like for example you guys could
use it for inter inter Department
communication things of that nature
right you could just go and create your
own account and your own service just
like i did in you can even post it and
you know on your own servers right so to
do that we need a way to configure it to
do that we're going to create a
preference activity that's going to help
us
configure so let's think about this if
you want to write a configuration piece
for your app you know what are the thing
what are the components that you would
need you would need a screen you need
storage you would need validation you
would need a way to access right so
there's a lot of stuff that you need to
do to support like if you're just doing
into playing C or Java right there's a
lot of stuff you need to do to support
the simple here's a username and
password that the user can enter modify
keep around and so on right make sense
so on in android it's actually something
what that is already provided right so
it made much simpler so to do that we're
going to use a preference activity and
to do that we're going to first define
what our preferences look like what do
you think we're going to start we're
going to define where what our
preferences look like so having knowing
what you know just wild guess you
haven't done this before but where would
you start what kind of hmm XML yes yeah
so when I said define what it looks like
we're probably gonna start with some
kind of XML right but how do you start
an XML file yeah the new android xml
yeah do you use that that's a good place
to do any xml stuff right so you've core
you're realizing now that you know
android development is really just a
combination of java of xml and java
right so when it comes to xml yes you
could go and figure out where the file
goes and put it there manually or it'd
be easier if we just went file new
android xml file BAM okay I know it says
what kind of file is it well see there's
a there's a box here that says
refs preferences right so select that
and I usually need call my file preps
dot XML right and it's going to figure
out it needs to go into the XML folder
so all i did is chose press and get a
preferences and give it a name that's it
this is how it opens for you guys it
shouldn't open like this it should give
you a different view listen like it
should look like this right see how it's
retarded a little bit we know not to lay
out you still I select the box it says
preferences see it's like to the left
the preference so we're defining what
our preferences look like okay so let's
do we're gonna for now let's do three
things we're going to do username
password and the API key so that you
guys can switch it to some other API so
by switching the API key you can say I
want to use Twitter or I want to use
identica or I want to use you guys know
what identifies right it's another
service by then tika that's like Twitter
right it's based on the same technology
so you know if you want to tweet you can
whatever you do an identical see this is
another community that gives a lot of
people and so on so there's learning
android there too but it's a it's also
showed on show me down everywhere so I
keep switching right so to do that so
what we're going to do is we're going to
click on this and say add and now i'm
going to add three types of preferences
some common ones check box edit text
list preference preference schedule
preference screaming ringtone preference
so we're going to do the edit text
that's basically a preference for a
piece of text which is not username
password and and api route are did you
get it wrong Aaron others screen
when I click on that and i'm adding this
right and you may want to open up the
preferences in a section so now that we
have this we need to basically specify
what our preference looks like now the
ceiling in one property here it was the
sort of important is he is important
okay he is basically how we're going to
look it up later on title is important
so that user has some information
summary is so important okay that's
about it so the key i'm going to say
username for username okay password I
sorry a title I could type username but
better would be to use to define it in
strings dot XML right right so I'm going
to as opposed to typing username I'm
going to see click on browse new string
I'll say string or I can just you know
what I'll just keep it simple to say
user name user to user name user for
those of you and your Bunty Aur would
you have to separately add it or if your
leis you could just got caught it and
summary would be another string process
please and your
log in using your username so far so
good
does it matter yes yeah there's a
standard yep well we will get ya so
there are everyone got this pretty much
something like that I mean there's
another if you have all three do you
guys have one or two do you have a
username and password okay that it's
written in stone what I usually do when
I create a new class I'd call it prefs
and then activity so I usually say you
know what it name followed by what it is
right so you'll see later on updater
service you know the timeline activity
and so on just so I can visually figure
out what's what yeah so click on finish
and you get just a plain old java class
there's nothing nandroid dish about it
right so we haven't had to create a main
building plot from scratch yet but
whenever you create the main building
blocks it's sort of the same steps you
subclass one of the existing things from
the from the framework right that's so
you start from something that's already
there right you really start from
scratch so if I was starting from
something that's ready there don't do
this but I would typically do something
like this extends activity and that
would make this be my activity however
in this case we're not going to just
extend an activity but we're going to
extend a special kind of activity that
knows about preferences it's already
preference aware okay so that one is
called you guessed it prefer preference
activity and then organizing import so
it gets imported by eclipse and voila we
now have a blank preference activity
ah it's good question let's see control
space now show you oh there you go wow
so you say XP and then control space
reference activity yeah yeah that's
great I mean I todos extra but I guess
that's a standard controls the space
drawer space is your friend yeah um so
yeah cool okay so we now have a blank
activity so whenever you care a new
activity what do you what do you care
about on creating SR good yeah so just
like we said you know you write
activities and all these guys we write
by filling in the blanks these are
possible blanks that we can fill in
right so you know one that we said
universally almost all those matters is
on create and by the way they're not
only blanks because if they were we
wouldn't care to subclass the parent you
know call the super right so again is
opposed to typing I'm going to go source
override implement method so it knows
what's available in own preference
activity and i'm going to say on create
them there it is the leader to do it
what it calls the super and I have a
place holder to do something
okay so so far we had squirrel back at
square one we haven't done anything new
we're just going to create it you know
the placeholder for possible new stuff
so what did what would what was our
typical align 11 in a hello world set
the content view right but in this case
it's not going to be just a set the
content view it's going to be something
to do with that xml file that we created
right so if you don't remember and I
don't and I'm telling this about 25,000
times if you don't remember what the
function is you do control space and I
think it's something that starts with ad
content from aha add preferences from
research there it is control space a DD
and that should find it for you right
look this function names our method
names are extremely long they are hella
lon right do you guys know the hell eyes
are going to be an official word i'm no
i'm not making this stuff up there's an
official somebody from google actually
kiss submitted it as one of the names
for a very long like you know google
trillion billion zillion those are all
names of like very long numbers like
google is yeah so there's a very long
number i tend to do i don't know what it
is but they suggested it's called hella
it's going to be a hella long number
there you go so it's not slang alright
so Amy Oh at least it may not be one day
for now with this so so the names are
wrong write these names are long so
that's why you don't want to type them
you want to use control space so it's
nice kind of combination of both worlds
you have very descriptive method names
on the other hand you don't have to type
them so all right so r dot and then you
gotta figure it out both armed ex and
it's right here right so yeah so r dot
XML dot puffs
and again with the n-type match yeah so
you want a point so the research that
you want to point to is that research
that we just did which is so that if you
didn't prompt you that mean r is not
updated and its arms not nothing
probably didn't save this file all right
because magic happens when you click
ctrl s you guys don't see me doing it
but already told you about that right
I'll control shift us oh did you know
yeah saves everything no control shift
as saves all your files that you may
have opened in your workspace so you
know this so now that I had that so now
that we kept that that's it we're done
with this file so basically the bottom
line is it's a one-liner so this is
going to know about a special type of
activities called preference activity
and it's going to know how to load our
specific preferences that we described
in this XML file that's it no I is in
the same package so if it's importing
our it's prolly yeah so here's what can
happen sometimes and it's a tough one to
find so you mess something up let me let
me produce something you messing up here
i forgot quote again man i forgot a
quote are doesn't exist them or our
guard is deleted i'm going to delete my
are at it's disposable right
so I have a problem here which is
preventing our from ever getting
regenerated because it's kind of things
start this way and then eventually make
it here right so if you have a problem
in XML you don't even get to our and
which then breaks all your Java right so
now I go back to java and i try to fix
this problem by doing control shift or
to organize it right and what happens is
it now says okay where can I possibly
find this thing are and it finds it in
the system so it finds this Android dot
R which is a system are okay I think I
told you about this is a common should
write something on the common errors
this is typical error so then you start
you still things are not working your
tribe everything and then you realize oh
hi you made an except in the xml file
you go your fix that they're all gets
regenerated magically right on but then
you're back in this file is still not
working it's like Isaac not finding my
are and typical eclipse does this like
let me even arrange this like this right
an eclipse keeps the skin from you right
and you're like staring a blessing it's
like next thing you know it's five
o'clock and you're like panicking you're
like time this android stuff right you
just it's a card error to find so be
mindful of that right because it imports
the other are the system are so you do
not almost never wanna you actually you
never want to have that one ever
imported anyway yeah yeah well are for
resource I guess so but yeah I think I
think I think just getting Eclipse
organized inputs to be mindful of that
anti pattern and kind of saying hey are
you sure then that that would also be
helpful
well if you you can try or you can
always try project clean right and
that's going to create a force the auto
rebuilt but usually look for any clothes
that you something is wrong so you may
have an error anywhere else in the XML
look as a little X on it or something in
the town the console so what you can do
is if you're not sure if the console
stuff is too stale you can clean it then
do project we clean and then see if
there's anything you know that still
shows here is a problem I would use that
as a hint okay okay so um so back to
activity so what we've done so our steps
were declare it right declare it so XML
first right tells number one number two
was create a Java file by subclassing
one of the system files and right and
then referring to that number one that
was the number one that with it so so
far so good this is pretty standard
you're going to be doing this over and
over again that's one kind of you know
drawing it for you now there's a third
step and the third step is whenever you
create one of these main building blocks
right and remember main building blocks
from yesterday services activities
content providers broadcast receivers
you got a declared registered most
typically that's done in the manifest
file okay so so far we can look well we
looked at manifest file mostly because
we were concerned a bit with permissions
but notice that your application is
explained here remember an application
is just a loose collection of this main
building blocks so here is our activity
defined now it's got too much stuff you
don't know what half of that stuff is so
don't get too intimidated by that right
but if I wanted to declare our new
activity all
you have to do is something like this
within the same application block I
would do activity ok and then Android
name and then i would say dot crafts
activity you can even shorten this to be
like that oops see this is a bucket of
clips yeah that's it so I just gotta
basically say hey I got an activity
there it is
okay all right so let me just continue
with this second make sure this is a fun
okay so on this basically says we have a
new activity as part of our application
that is a name dot productivity why do
you think we have this dot in front of
preface crafts activities yes so that's
a short form as a so this dot is
basically pointing to that package name
to specify here he doesn't resolve but
we build it back not you the exit or if
you don't the other if you're quiet in
here so if I basically went here and
specifies add activity okay and says
browse and now if I browse to this is
actually work because well what
Professor given interesting it's all
works okay um yeah I know yeah I that's
how I know it so yeah because it should
be the full fledge it could be you know
calm dot Maracana dull 12-1 but that's
fine so if it works it works okay so we
now actually have it with we have this
preference let me just really briefly
show you something but we're going to
undo this and so if I actually closed my
activity like this this stuff here okay
intent-filter that basically says this
activity is the main activity okay so
you can kind of think of it as whoever
has these four lines of code is going to
be the main activity it's going to be
the homepage right so if I simply took
that and move
it into here okay now perhaps activity
shopping my main activity right so just
to show you really briefly if I now
start my my app was my emulator look
it's starting up it's starting up is
starting up there it is does this look
like our our application right so now I
can you know I can click on here and I
can enter username learning android
right and then password PA SS 2010 cosc
password field is being masked ok ok and
then I forget to the servers I'll look
it up but the point is it works right so
we have an activity we can start it yes
so we're that's what we're gonna do yes
but we need to first a way to to get it
yet so the problem that we have now is
we don't have a way of going between the
two activities I can I can show you this
activity but now I can't show you the
other one yeah so when we need a way is
to fight you right we need a way to fire
an intent to start from one activity the
other activity or vice versa the
question however is how are we going to
do that where we going to start this
intense from yeah so there's something
called option option manning's so that
you know the world I mean there's
different ways we could create a button
if we wanted to write but there's also
something called options menu that's you
press a button and pops up like you know
you press the menu button then and then
something comes up you know I'm talking
about so if I got to like home screen
this thing is the options menu c3222
that's that's it yeah so so what we're
going to do is we are going to create
that and then so will we Calloway to
bounce between the two the question is
how do what do you think are there going
to be the steps to create on menu yeah
so we're going to start one with XML
then to do some job right so and when
just like with before and by the way I'm
going to return this back to what it was
before so just like before to create an
XML start by clicking on the way you can
click a little a plus thing here or you
can you know you can go into and go file
new android XML right and this this
preference activity we don't have to do
like any out of there any option to do
any graphics like if you want to change
like that may be right okay so the
question is so the question is about
graphics and things like that so okay so
let me then go let me put this back to
toot it and then I'll top and down does
that take right except I have moved one
too many right like that so back to this
so just so you can see I can actually
apply so you first of all you see you
saw that it was white black on white so
it's already applied our global theme
which was what we specified here right
but what I can do is it can also apply a
style to or a team to a activity so I
could do something like this android
Team and Red Team and i can say i can
say at style
activity so I could do it like this let
me test that
okay so let me see what happened can you
do that I've got a little cursive
problem boy right because it applied my
my activity the yeah it applied to
everything so I mean artistically it's
kind of interesting use the form
usability yeah it's an F but from
artistic point of view I can see you
know I can see a lot of birds and it's
extremely slow okay but yes you can do
certain stuff like that so we could have
applied a team so it should totally
recreate my team but I already kept the
team here which are which is a global
theme which just makes it black black
and white which works and there is a
yeah so there are things you can do so
you can do inside of the activities so
they're stuffed we can do set
setcontentview know I know I can do set
title which is very useful so okay for
example do a set title and I could
create a new title that would be that
that would be a title for for the for
this one so for example i'm going to do
that really quickly in strings just like
we had zillion in one other title title
status update i'm going to create
similarly a title prefs
okay so i can do that so i'm going to go
here and i'm going to say r dot string
dot title you sit idle prefs there so
that's going to set the title just to
show you damn so that is going to do
that
why I did this right now politically we
got a Twitter its aim may be there to
destroy us activity I give some text box
on like it may not be seen by government
of that reference of you but it still
there is no I guess from the internal
well yeah so the the hold that thought
for one second so yes there was a second
approach we could have done but I think
I did it in my in this guy let me just
run this guy really briefly because I
think I actually applied I've done it in
this guy in the first approach so but
hold that thought and by the way this
guy doesn't doesn't rotate so that's one
of the features so if I go menu perhaps
see it looks nice right let's get a
background but that's because I the
style that I applied in this case was
window background that's the that's the
that's the thing that's what I wanted to
do there's a window background so i can
apply that to everything to get the same
background if I wanted to so so that
would give me an in this case so back to
our so what if somebody know so what I
do in this case is i mean you can get to
this page whenever you want you click on
the menu and you go to that page right
and and what happens is when your first
time launch it and nobody has user
doesn't have a username and password I
actually bounce them to this page yeah
actually so first time around this was
the first thing you saw yeah but back
two of my style so yes I could have
assigned the global as my global style
yeah I could have team that light I
could have actually done background and
then specified our background which was
a much cooler background I forget it's a
draw ball and then twitter BG right BG
so so that that would have done that but
so if i run our app again i got one
better right so I got yeah right so so
that that applied but you know some
other stuff didn't right so anyway um
yes yes yeah custom creation thanks boss
yes this is exactly it's quicker mix job
much easier and so on now the question
is do you want to recreate everything
from scratch or do you want to use this
build a building boards that you can
create now I used in this case I use the
preference activity which made it super
simple for me to really just point to a
resource and do this right the other
approach that I could have done would be
to not sub-clause preference activity
but subclass regular activity right and
in that case I could have a lot more
control over how things look so let me
um just as an experiment i'm going to
creat i'm gonna do that you guys don't
have to necessarily do that but I'm
gonna do a new so new xml far i'm going
to say layout i'll call it crafts accent
uh profs xml but in this case it's a
layout so don't get confused with a prof
sex
now that we have here in XML and this
one here so what I want to see is is
there a widget that is aware of
preferences okay and I believe there is
preference the reference screen I think
there's a preference screen and that
it's actually a component to control
maybe not anything wrong I believe
there's actually a preference screen
that you can then bind to to it let me
sip something like working the
documentation and I haven't done that
uses before said preference screen so
there isn'ta called preference screen
and it's 0 our preference screen is
actually when a preference activity okay
yeah so anyway so I quote that you know
there's some other ways to do it but I
would get to do a little more research
on that oh yeah so for now we're just
going to stick to to the style thing
that twitter BG and I'm actually going
to get rid of that neither offers I
don't like it do it looks so that's
that's preference but let's let's get
back to the menu so I'm going to close
this so back to the menu so we now want
to create menu and you guys said we're
going to start with creating a menu by
clicking on a plus boom right menu xml
and there is actually a choice for menu
so we're we need a way to jump see how
here I have proof menu and going to have
things that pop up and I can do that's
what I want to do
so the menu that thing that thing called
there are different menus but this one
is called options may again so what
they're going to do is we're going to
create the new menu XML so the key here
was to say menu XML in 2.2 menu yeah and
Eclipse figures out that where it goes
click on finish and see for me it does
this once in a while so if I kill it and
then reopen it hopefully it's going to
open up in a normal view there we go
okay so add exactly so we add item and
with the menu again you have zillion
things you can you can specify here some
are more important than others ID is
going to be important because we're
going to need to look up which many was
clicked on okay title is going to be
important so that we know what the title
of that item is tidal condensed is if
this is too long you may want to provide
this but it's not that important an icon
is not that important so title let's
call it item traps for example because
again it's going to go into same flat
list of ID's so that's what I want to
give it a name that's somewhat
meaningful okay um title again just like
before define it in somewhere else I
don't have title profs so but you can
either hardcore date or you can you need
or define it in strings.xml yes
so I'll show are so that's going to be
on it's going to iraq in a reverse order
and so confusing but this would be the
our part this will be the actual value
right or if you look at it like this if
i click on add like string so this is
going to be the our part the ID right
and this is going to be the value so if
i if i said something like title
timeline and I say timeline so this is
going to be strings so if I save it
right see now it goes like so there's my
title timeline right like that oops so
that is r dot string dot timeline and
title timeline and this is the actual
value add it's in reverse order okay so
menu so like I said id important title
important icon highly recommend it so
let's take a look at options so we need
to point we need to we need an icon
right image picture graphic low holding
you and you guys already know how you
can do that right you can go on google
images find some image drop it tuned
into drawable right and then you would
say something like at draw ball blah
blah blah right but on these icons are
kind of pretty standard like you know
there's already a settings icon right so
how can we use some of these system
icons and yes you can and let me show
you where the system resources are so
you can kind of see some images of that
so remember yesterday when i was talking
about the platforms I walk you through
some directories right we walked into
platforms feel it it doesn't matter if
you have 48 whatever it's always the
same
and there's subdirectory the token is
skipped and that's the data directory
and inside of that data directory
there's another directory called dress
so this is basically the beginning of
the system resource folder just like
your app has re s folder which
corresponds to your are so does the
system have its own re s folder which
corresponds to Android are right so this
is Android guitar with its zillion in
one layout zillion and one raw data for
various languages dealing in one strings
there's like there's your english
australia English Canada English Britain
Israel in the New Zealand Singapore us
South Africa Spanish in u.s. in Spain
French in Belgium Canada Switzerland
France IL oh this is Hebrew and so on
right you get the idea so just like that
we have the graphics will be under what
trouble right so I'm going to look at
drawable for example meat medium it
doesn't matter if it's medium high or
whatever right what is available yeah
this is just so Windows Explorer
quote-unquote Windows Explorer so these
are the various pictures that ship with
the system you've probably seen them
around around town right like you've
seen these pictures right I'm just
boiling them up so you can actually see
them honor these are my favorite
okay so these are the various pictures
okay and so on so you can find the one
you're looking for in here I actually
get a website which I included in inner
resources appendix in your book I should
be in there but it's a you can also just
go google android draw ball and you're
going to find the screaming pinguin a
page on and that's what i usually use to
find you know graphically to see all the
images like this right so if I'm like
trying to find something really quickly
you can look at it file windows explorer
or I can just go up here and say crap
haha there it is okay and now I know
what the name of that file is of the
three source okay and the kind of named
in a certain way like for example all
the ones that start with the IC
underscore the good size for the menu
right and so on so see now that I have
that I can go back here you can see at
and when we point into system resources
it thanks android column drawable right
yes they must be exist yeah they must
exist on everyone's phone if it's a
stand if it's a normal Android
installation right so yes a new traits
prefer to actually you reuse the system
once then to create your own right yeah
yeah yeah I can see that
so far so good so now we have our menu
now to show this menu it's kind of
interesting how it works you need to
basically create a method that's going
to interpolate this XML file okay and
you need to create a method that's going
to cook respond to xml clicks the two
methods did so in other words and
remember this picture I said these are
the products that we have right well
there are actually more callbacks that
are available to activity but they're
not lifecycle callbacks these are
lifecycle callbacks right that's why we
have them on the list but if we go back
to our status activity okay and if we do
I'm going to do it after on stop by the
way at this point i can i'm going to
take out this debug.trace because that
actually just makes stuff run really
slow so i'm just going to comment it off
lady there for you but after on click
I'm going to add just to you know I'll
say menu menu stuff right and I'll put
this as in i think this was a posting to
twitter stop right and this is a you
know
button stuff yeah so so many are so many
stuff so what I'm going to do is I'm
going to say as opposed to remembering
these and trying to tie them on go I'm
going to go source override implement
methods interesting it thinks into them
still in an async task which are not why
does it do that interesting let me know
okay okay so fine I'm here and organized
implement Metis thanks been there so
we're looking for something to do with
on options menu and look there's that
this to that we want it there's the on
options menu selected that one is called
when you want when it gets created first
away now when an actual thing is is
selected right and then there's also one
that says on create options menu then so
on create options menu and on options
menu select it so not on create options
menu and on options menu selected that's
why you kind of just gotta think about
what am i working on and then that
should give you a hint what to you know
what those things are on options item
selected on menu items selected is a
good question but it's different hold on
a second I would have to look at the
documentation yeah I'm
yeah but as I said they're different
menus so there's the when you you know
long press there's also menu we are
context menu and so on ok so I'm going
to add those two after on click where do
that ok so just have it ok so I'm going
to put it here so that it is so these
are goods that we have and if you know
now we can kind of put them out here on
a non create objects when it tells you
what what it does so initialize the
context to the activity standard options
menu blah blah blah should play place it
in there and you must return true for
this many to be displayed so that that
solves this problem so just return true
right
yeah so no sono since it's it's really
interesting this gets called when the
user presses the menu button so when the
user presses the menu yes so when they
in the current activity when the user
presses the menu button this gets cold
but it also gets called once and only
once right and from that point on it
saves it so the point is that it's
basically it's used for lazy
initialization of your men in almost
always you're going to basically do
something like this you're gonna do them
like this get menu inflator and then
you're going to say inflate your
resource which is r dot menu dot menu in
too many so it's going to confuse it but
we are basically using something from
the system called inflator to inflate
from this resource into the menu that
was given to us so in other words this
is then returned by reference right
because you know it needs to somehow
create the menu you may not have one you
might have not done the fire XML ok let
me show you an alternative way like some
sometimes I see that people do this in a
code like for example you know I'll
leave this here for you guys in case
you're typing but an alternative would
be to say menu equals new menu menu dot
add and then i would say oops many dot
add or how do i add so i need many items
worthless menu item item id
getitem any way you can programmatically
basically created many right that we
would need to create a menu item and
then add it so inflator that's a good
question what does the inflator does
what I was trying to do here manually
inflator opens up the xml file right is
there xml file opens up the external
files is okay for each element i'm going
to create that object so it creates an
object called menu then it creates this
object called item and attaches it to
that and sets of all the topics I info
so in other words it does exactly the
same what inflating from xml did for
view right parse is that xml create so
that's the process that we call
inflating from xml right that make sense
so that's what we're
oops so so far so there they were so
those are so that goes so so far I mean
don't worry about this one this one's
still I'm not done but this was the
one-liners so basically we said get many
inflator inflate that resource into that
menu so many inflator is used to take
this research and pump it into this Java
object takes XML parses it inflates it
in creates a job ok it's almost all is
going to be you can kind of use this as
a template right almost always like this
well you didn't fight with by set doing
setcontentview setcontentview line 11
that's what does the inflating opens up
the XML parses it loads up all the job
objects only after that we were looking
them up by name yeah yes so so that's
that now now when the button is pressed
it's this is going to get called on
options items selected let's get the
documentation for that so this cookie is
called whenever an item in the options
menu selected blah blah blah simply
returns false so I return force to LA
normal many processing to proceed
through to consume it here so we can
consume it here we can say we're done
with it so I can return true ok now the
question is just call we're going to
handle the button presses the many
presses and you know right now I only
have one menu items I don't really have
to check what item was clicked on but
for future explained ability they're
going to have more than one menu item I
could do something like this switch on I
think dot get item ID right
and then i can say case r dot ID dot dot
item preps do do something and then
break right why is it complaining here
Oh switch yep so this is where it's nice
the fact that I these are integers
because you can switch on them okay
that's sort of one benefit of of those
integers so again I didn't get to do
this but now I have a framework for
future expansion of this of this guy
right
so far so good everyone follows this so
what do we want to do on the button is
pressed yeah and just launched an
activity you simply to start activity
and you need to give it an intent and
that it tent you can also simply do by
saying saying new Intel's new intent new
intent and you gotta give it a create an
intent now the intent in this case one
of the simpler intent is to do from to
right so you second it doesn't really
work that way it's not really from it
too but that's an easy way to think
about it so in saying from this context
to that perhaps activity dot class okay
so they're different they're two basic
ways to create an intent one is to just
give it an action right that would be
the type the more implicit intents so
then it would go figure out who can
handle that action but we do that more
when you do application to application
type of intense we don't do that often
when it's all within your own drown when
you all within your realm usually it
pass the context and you spell out which
activity or you know in this case
activity right so it's very explicit
and this
I guess I still have it set to go to my
my manifesto still have it scab it set
to go to do pref profs right I'm going
to move this up there rewrite
right so now if I click on menu try this
on today oops my screen is all too small
to big whatever so that you can see but
it says perhaps and then if you click on
it it opens this up pack it goes back to
that one so menu opens up the order oh
we were just wrong with my bed so it
opens up the preferences it's a menu Tim
Tim okay perhaps open served in the
Preferences i can now change you know
password and all that stuff you know and
i can go back to that previous one so
that's what we want
hmm
so a couple of new things right you saw
how how to create a new activity I use
references work you so how many work and
you saw how intense work right
well so that's basically what we sow
beat today we did we will talk more
about you I you you guys you know did a
little more on top of that so I kind of
like to leave something always for the
next day to pick it up with right so
that you know don't forget it so I'll
tell you what we're going to do today or
tomorrow but so we did that finish the
UI we'd looked at the tracing like
traceview and so that you can see what's
going on under the hood in terms of the
threads then we did async task to solve
that problem and verify that works then
we did create the new activity for
preferences created a menu to get
started in something intent to get it
started in desperate right now so what
we are leaving for tomorrow what we
haven't done is actually leverage those
preferences because right now it's still
hard coded so that's why I want to leave
that so that's going to be our pick up
our rights card code again we're going
to solve that problem but that's our app
right now so just to kind of figure to
you for following in the book either one
either one of the books so where we're
at right now is we we did we did this we
did this we did set up we talked about
main building blocks so we today we did
you why we finish this right and we are
now in the middle of this right well so
that's not after that we're going to
work on services and database so that's
sort of our game plan from the next
couple days
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>