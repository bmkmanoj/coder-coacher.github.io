<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The New Desktop: Electron, React, &amp; Pixel-Perfect Native-Feeling Experiences - Forward 4 Web Summit | Coder Coacher - Coaching Coders</title><meta content="The New Desktop: Electron, React, &amp; Pixel-Perfect Native-Feeling Experiences - Forward 4 Web Summit - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The New Desktop: Electron, React, &amp; Pixel-Perfect Native-Feeling Experiences - Forward 4 Web Summit</b></h2><h5 class="post__date">2016-03-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jRPUB-D1Wx0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome awesome good afternoon
today I'm here to talk to you about the
new desktop electron react in pixel
perfect native feeling experiences so
first I'm going to start off with a
little bit of a demo and then tell you a
little bit about how electron and this
new desktop works what you can do with
it the fondly a little bit about where I
think this is heading and the future of
desktop with JavaScript so my name is
Evan Morikawa and I work at a company
called an eyeless building a desktop
email client called n1 and I'm not
you're going to use that to show you a
little bit about what we can do with
electron this is n1 it is in open source
extensible native Windows Mac and Linux
email client it exists in the taskbar it
has its own dock icon and it runs as
you'd expect a Mac application to do
with all of the basic interface elements
that come along with it as well but
under the hood this email client is
entirely written in Java Script is is
HTML CSS some react with a couple extra
api's that let us deeply integrate with
the native os's that were built on top
of it also means that we have the
ability to be more than just a single
tab in a browser but have additional
windows that come up as well for things
like composers or to spawn extra
processes on the side and a lot of this
is afforded to us by the web building
desktop enabling technologies that we
use most notably electron so electron is
the technology that powers the ability
to get us onto the desktop
it lets us his web and JavaScript
developers build for this new
environment so back up a little bit
before electron came around there
has actually for a while existed this
dream of the web and all of its tooling
and technology and cross-platform
support existing in a traditionally very
compiled difficult to use environment
Spotify was early to try and do this
light table slack Mac SAP is um another
early attempt at putting a lot of these
tools on the desktop and one of the
early tools that made this work was a
project called node WebKit made by
largely these two guys Roger Wang and
Changzhou Changzhou or ZC pens is a big
deal in the electronic community you'll
see his name come up quite a bit but
these were very rudimentary they were
pretty much a web page embedded in a
single static frame that existed on the
desktop if you right clicked you could
get reload as your only option you would
command R and the page would refresh and
it lacked a lot of the capacity to give
you a much richer experience that you
would want to build a really native
feeling application so in 2013
github started a project called Adam
which is a code text editor that many of
you likely use this they wanted to bring
the rich power of text editing and
extensibility but do it in a way that
was right where you work on the desktop
they actually took Chenzhou from node
WebKit and started on a project that at
the time was known as Adam shell it was
a much richer set of api's on top of
node WebKit and eventually in only April
of this past year they rebranded that
project to electron really split it out
of atom and have subsequently turned it
into the bedrock for an entire new class
of applications that us as web and
JavaScript developers can take heavy
advantage of so electron at a very high
level is pretty much chrome strapped to
no js' it turns out though in order to
do this it takes quite a bit of
wrangling to begin with because chrome
wasn't necessarily designed to do this
in the first place actually in order to
do this the atom team
helps patch node 12 to add sort of this
multi context executions you could get
these multiple different JavaScript
engines embedded and running together at
the same time but to understand a little
bit more how electron works let me take
a step back and talk about how chrome or
chromium the open source project that
powers it actually functions under the
hood so when you boot up Chrome you have
this back-end process they call it the
browser process the main process that's
a huge chunk of C++ which is very
difficult for a JavaScript programmer to
really do anything with about process is
designed to handle and deal with and
spawn all of the individual chrome tabs
these in these separate render processes
and one of the things that chromium did
very well in the beginning was make
these completely isolated processes so
if one crashed it another one could come
up again and in each render process they
have their own implementations of sort
of Chrome's JavaScript engine and the
DOM and CSS parsing everything else
there too
and because they're completely separate
processes they interact with each other
via IPC as well so this is chrome and
this is where ZC been started with when
trying to make electron work and
basically what he did was that he took
this very hard to program in C++ layer
and replace it with node and then
furthermore added node into the renderer
process as well which means that if you
run into the console here you not only
have your document dot body but you also
have all of the node modules that you
would want as well all in the same
environment in the renderer tab which is
a very powerful tool to use because now
as Java developers you have full control
over what Windows born and how you boot
up your application and to give that a
more concrete example I can talk about
how the novice and one email client
effectively boosts itself up with this
process so the very beginning we have a
single javascript file it is the node
entry point that is running in this
back-end
browser back in browser process that
instantiates these browser window
objects which is something that the
electron api is expose and then i load a
URL because it's it at the end of the
day is a chrome tab however because i'm
a i'm not loading this from an external
resource although i could i'm loading
this from disk and i explicitly show and
hide and can control its display very
precisely that then boots up its own
renderer process which in fact has an
index.html
on that entire email client starts like
any other single page web application
from an index at HTML that has nothing
in it except for a single script tag
that is indexed ojs i'll but from there
and on top of the fact that i have all
of the node API is i can subsequently
natively require all the other files
that I need and then subsequently render
it in our case we use react to render
the entire Dom tree starting from the
root node down but this also means that
from this back-end process and through
subsequent actions in the app I can
spawn additional windows completely
separate running chrome tabs effectively
and we use those for things like your
pop out composer or to do some of these
special work window things that I'll
talk about later as well and once this
whole app boots up here you effectively
have a running desktop application
entirely launched and bootstrapped
from javascript so that's a little bit
under the hood of what electron does now
i want to talk some more about kind of
things that can do for you and a little
bit of the challenges that it encounters
you encounter with it along the way
by far one of the best pieces that
electron provides and really helps us
get over the divide as web developers is
giving you a true native feeling
experience there existed for a long time
this uncanny valley of something that
didn't quite feel right it didn't feel
like a native desktop app that feeling
that perception is extremely important
in how people use it particularly given
the extent with which people use desktop
apps and how much
their lives they spent in it getting
that native experience right on all
platforms is really important and it
turns out that there are a lot of
differences sometimes more subtle than
others between those that exist on Mac
and ones that exist on Windows and
really making it feel like a first-class
Windows experience or first-class Mac
experience also demonstrates some of
those things here we have the ability
here to access through electron a lot of
the native api's that you would expect a
Mac app to be able to do so for example
if you're just running in chrome and you
want to display a notification you would
get Chrome's notification dialog box but
here with electron api's I have the
ability to display a native notification
that shows up in your native
notification dock on Mac and if you're
running on Windows this API pops up
specific API specific windows type
notification dialog as well as little
things like that they remind you that
this is in fact a real application that
you downloaded and enjoy using other
things like the fact I can put something
in the tool bars up here as well where
you sort of expect ancillary information
to be now a lot of it is definitely
about the UI it's certainly a large part
the look and feel of it and for that we
use a lot of CSS for that's everything
down to actually in this in our case
rendering the Mac stop lights here in
CSS but also a lot of the buttons and
pieces like that as well one of the nice
things about an application like this is
that it is all CSS so when we deploy
this on Windows this just whole body
class changes to Windows mode um and you
get an additional couple toolbars and UI
pieces as well but here we have the what
Windows users expect a little bit more
of a of the windows style buttons some
squared off and more some more squared
off buttons and
the types of UI is that windows people
expect now that being said it very much
is up the to the developer to really
work on a couple of the more subtle
details for example Windows 10 there is
a there is like a slight hover effect
that happens on all the buttons they
have these specific design specs and for
us those are all implemented in CSS
luckily because it's CSS there are in
fact an increasing number of github
repos who spend an incredible amount of
attention to detail to get these types
of things right this have this is also
true on Mac as well with these sort of
minor details on a on a new MacBook you
expect things to look and feel retina
the fact that you have that these
particular different dpi levels is
something we can detect and actually on
Retina displays we've done this trick
using a half pixel box shadows you get a
true one retina pixel border around the
buttons which is something back buttons
have that others don't and it also works
on non retina displays as well to get
one pixel things there's another like
much as small subtle interaction things
that really help make it feel like a
desk of that for example desktop apps
don't have your pointer hover States on
the buttons they don't have the whole
page is selectable like a web app and if
you turn off all of those CSS classes
you make everything have these hover
States have these will pointer icons
something feels a little bit off to you
and it's a lot of those little details
that can really help bridge that uncanny
valley and make an app experience that
feels first-class of all of the
platforms that were shipping it on
Windows Mac and Linux as well so to get
a native experience is something that
electron can really much help you with
there are lots of native extensions to
add into all the different pieces of an
application you'd expect from the
right-click menus to the dock icons a
lot of the other pieces are various
attention to detail and entirely
possible to do with CSS as well another
great perk of this new desktop of
electron that we have is the type
us data capacity and storage and offline
that we have this entire app is actually
backed by local my sequel Lite database
which means we have much stronger
offline support in the case of this
email client we're sinking down
gigabytes of email data but can save it
locally and very robustly in a sequel
database and furthermore then access it
from anywhere in the application so here
I'm querying for 31,000 different
contact objects that sort of return to
you immediately and very quickly out of
that local database having a local
database like that is one of the great
features of being able to also access
the file system as well and being able
to store a large amount of data with
that the other nice thing about having
that data storage is making it work
offline as well one big difference
between a desktop app and a native app
is you very much expect it to work when
the Internet is off one way we've gotten
around that is being able to persist all
the state locally but another one is
having this concept of a cast queue here
so if I have an email and I archive it
for example then that's something that
can queue a task it'll wait for the
network to come through and it'll
process it in the case of our kind of
spotty internet that we had today - it's
also something that can work off the
assuming it'll work offline as well we
can detect when the system comes back
online and process those tasks
accordingly that task queue is something
that we can persist to disk so even if
you close the app and reopen it again
it'll take that into account now there
are certainly many things that you just
fundamentally cannot do offline like for
example send an email but those are once
again things that we can responsibly
keep track of and queue in our
application because of a lot of the
flexibility that this provides for us so
once again because of having this local
sequel storage having
these types of task queues and being
able to listen for new events is
something that really helps us keep this
working in an offline environment with a
lot of robust storage capacities as well
one of the other big and both benefits
of electron and challenges of it is
certainly performance performance is a
performance as an issue that a lot of
people wonder about when you talk about
building a desktop app in JavaScript
luckily there are a bunch of things both
in the standard web community as well as
in electron specifically that really
help make this possible to do so one is
that we are this is entirely in fact
built on top of latest chrome which
means you have all of the modern chrome
debugging tools that you would expect to
do performance optimizations on any talk
you've ever seen the dev tools team talk
about jank busting and keeping your
performance and all of your logic under
60 milliseconds absolutely applies here
too luckily only to support it for one
browser which is the chrome rendering
engine
these actually performance tools as web
developers where we kind of take for
granted but if you're building a desktop
app in C++ or Objective C yourself
you suddenly actually grow to appreciate
how nice of a layout system and
optimizations the chrome team is made in
rendering you wise we actually get a lot
of performance implications for free
because of the efforts of the chromium
team so everything from moving
transitions to the GPU to optimizations
they make in the paint cycles and this
sort of rich set of modern tooling that
an entire ecosystem of developers has
been built around all helped make
everything here fast then once you move
something to that 60 frames per second
benchmark you really can't tell that
it's built on web technology or not it
just feels responsive people care about
the frame rate much more than they do
the underlying set of technologies but
even if even if that wasn't enough we
have a couple extra tricks that can help
you in the electron world for that when
we were doing this performance we were
noticing that as you were scrolling
along we originally had this problem
where you'd get a whole bunch of mail
megabytes of JSON we just have to parse
and at the end of the day JavaScript and
is still a single-threaded
development environment if we're sitting
there parsing megabytes of JSON it will
hang the frame and those are if you're
stuck inside of a single web browser
frame there's unfortunately not a whole
lot you can do about that
although there are increasing tools
about doing tasks when the CPU is free
and things like that
but in addition to using those api's we
also have the capacity to spawn
additional windows this is a window that
we have that is specifically designed to
do nothing but process all of our data
that's coming in this was an entire
separate process spawned which means
this is running truly in parallel with
the main render window here these are
two completely separate windows with
their own separate processes and they're
both able to talk to our single sequel
database luckily for us sequel Lite is
very robust in terms of like dealing
with locking issues and having multiple
processes writing to it which is which
is great because now we can all float a
lot of the performance issues that we
have to these separate windows that's a
pretty nice thing to be able to do now
that once you realize you have all of
the processes of node now in our case we
gave this window a UI but you have all
the node library there's no reason why
you can't spawn other processes or spoil
up other tasks and a lot of other
electron apps take liberal advantage of
that to great effect
there's a couple other performance
tweaks you can do that are specific to
electron one of the big ones is about
filesystem axis disks are still pretty
slow when it comes to loading a lot of
files and file system access is a big
problem particularly with boot up time
you're just requiring a lot of things
one of the great tricks to fixing that
though was a project that Adam made
called a SAR basically they took the
entire bundle stuffed it into one zipped
file and when you look at a mac app here
inside your contents and resources there
is a the entire app is inside of a
single file which actually makes this
seeking and things like that extremely
fast which is really convenient for
loading a lot of pieces in it I'm
actually one of our engineers even went
so far as to figure out the order in
which files are loaded out of this Asri
bundle just to improve the sort of the
ran of disk seeking activities and those
actually drastically speed up load times
and things like that to once again there
are an increasingly large number of
libraries out there like asar that are
designed to help improve the performance
of these applications and once you
realize that you do have full access to
disk and a computer and everything else
you want to you want to use you also can
can really start to optimize things at a
low level if you really want to as well
so performance is hasn't have many
things a challenge but it is entirely
something that can be overcome in most
environments through a lot of the modern
web tooling that we already have through
a lot of the efforts of the chrome team
and the work they've put into it but
because you have these parallel
processes you can you can index your
database properly you can use these
packing minification systems that also
really helps to make a system that's
very it's very easy to to use and extend
and make as performant as you would
anything else another great perk about
building on the desktop is extensibility
which is something that is particularly
key to us when specifically we've been
building this email client one of the
whole points of building an email client
in web technology was to make it easily
extensible was let third-party
developers build plug-ins for that so
for
example I say I wanted a plug-in that
can translate my email and you kept
information on the sidebar and quickly
schedule with people plus any number of
more I would want to add from a separate
library now when I compose an email I
can take advantage of these types of
plugins to schedule a time to meet ah
and load in another plugin that will
translate all of that for me on the fly
this is the these are the types of
plugins that we want it to be able to
support in the email client and do so
with the tools that you're all familiar
with in this case that was just this is
just about that translation plugins only
about 40 lines of JavaScript that loads
in there are building plugins in a
website is a little bit of a weird thing
to do right because like it's coming
from your server the concept of a lot of
third-party code running in your website
is a little bit foreign but with
electron all of those plugins are vetted
trusted and then exists on disk we can
load them as we will at runtime and
dynamically change the functionality of
what we have are we actually furthermore
then went to figure out how to we have
these concept of these component regions
or specific places that plugins can
register themselves to responsibly load
onto the page which is a much nicer way
to do plugins if you've ever loaded more
than a handful of Gmail plugins on at
the same time
you know how crazy can gets it everyone
kind of reaches into the Dom a jQuery
and hopes for the best the idea is to be
able to much more responsibly load them
in being able to have them directly from
disk and doing this is a huge advantage
to being able to work like this as well
another thing I should mention that is
keeping really key to making a lot of
this work is a lot of the modern with
patterns that we've been using as well
to power this particularly react
and sort of it's in the various data
libraries that we've been having with it
as well react was a very good fit for
thinking about plugins and particularly
thinking about very fast moving um
constantly changing desktop apps and
subsequently the libraries with it to
all of our components and actually
everything in here is a plugin from the
thread list to the composer to all these
buttons they're all individually
registered plugins they are each a react
component and they're fed from a single
data source there's sort of fed from the
same data source in the databases
everybody else this means that it's
really easy to sort of render and
display everything that we have
dynamically as well one of the nice
advantages of having a database there is
that if you build something in redux for
example you will have this single store
that exists in memory the sort of listen
to actions just reduce them to new
displays and sort of pipe them out to
whatever view system you're using in our
case that actually is a full-blown
sequel light database which has a lot of
advantages for extensibility it actually
means that when a plug-in wants to
change data or when we get new data
coming in from the server it can sort of
update this database it becomes this
single ground source of truth and one
thing we've been doing with it is we've
been using reactive X or one of the like
that our X library to sort of listen to
that because you suddenly realize that
once you have a lot of plugins but you
have a long-running application like you
would on a desktop you get a lot of
changes they kind of come in as this
continuous asynchronous event stream
which turns out is perfect for the
observables pattern that you get in our
X we actually want to step further and
had sequel Lite first of all trigger on
every single change that it has on
furthermore can make it such that we can
subscribe to a particular
query in a way get these live dynamic
queries so I the way that this thread
list here is rendered as I saying like
load threads where account matches this
have to find a query as the input to
this observable anything that matches
that anything that comes in at any time
a synchronously will automatically in
live update to do this that data pattern
has really helped in an environment
where plugins might be changing data
users are changing data all the time it
comes online and offline deltas are
coming in and syncing that kind of
declarative pattern really really helps
in complex web applications like like
the one we're using here and as a result
they the very declarative nature of
rendering components as a react also is
a very natural fit to making a lot of
that work as well so that's certainly a
pattern that we've definitely enjoyed
and something I definitely expect to see
both on the web as well but particularly
when you have these very intensive
single page applications running like
you do on the desktop so extensibility
is sort of another perk that came with
the desktop it meant that we could run
these live queries from the database
feed them directly through these these
functions that we have an output
straight to our views at the end of the
day it makes it very extensible it makes
these the ability to have plugins in it
very easy to use so overall there are a
lot of perks actually that the desktop
can that this type of experience can
give you that really wasn't available
only a couple years ago getting over the
uncanny valley making something really
feel native with all of the different
API is that you have a sort of one first
step and then making it really robust to
holding a lot of data working offline
and sort of keeping everything in sync
further or the challenge that you have
but certainly a lot easier to do once
you have access to databases in a file
system and process control as well
the overall goal of all of these is that
you really do feel like you're using a
native application the goal is to go as
long as possible without anybody knowing
that this is running our web technology
except of course for that bowmen that
you realize it is and you can modify
anything that you want and add a plug-in
and play with it and change the theme
and the sea is change the theme and
everything with the CSS um that's
certainly something that we've been
hoping to do with here and another big
goal of the atom project as well so this
is definitely a trend that we hope to
see continue into the future via through
email or text editing or any other type
of application on something that's been
enabled a lot easier to do with electron
and the tools that we've been provided
so this is sort of getting at I guess
what I mean by the the new desktop there
they used to be this in order to build
something on the desktop you have to
learn how to use objective-c you have to
use Windows presentation foundation yeah
- you see sharp or any of these other
tools to do it but you have to write
your own rendering engine so you didn't
have the dev tools and layout systems
that were all familiar with and now we
do which also leads to a sort of another
question about what we can do with it
the answer is a lot and increasingly
more so this is off the elektron page
just a sampling of the apps many of
those logos you are probably familiar
with that are heavily taking advantage
of this slack particularly in Windows
Paul Betts who works at slack has been
an unbelievable resource in making this
whole environment work on Windows I
think a lot of people just by the survey
of computers here forget the how many
people and how much of the world is
still running on Windows computers all
day long and it's and it's a market that
as web developers has largely been
forgotten and luckily is now something
that is much easier to address as well
sort of want to leave by talking about
and thinking like why why the desktop
like what are we what are we doing here
got it again um it's it feels like is
especially with a lot of mobile devices
and sort of all the efforts being put
into there one thing about the desktop
that we realized and sort of why we
ended up building a male client on the
desktop first as opposed to a mobile app
is because the desktop overwhelmingly is
still where real work gets done uh it's
the place where you're sitting in front
of for eight to ten hours a day with the
keyboard actively working on something
mobile apps talk a lot about time and
app as a metric well time an app for
most desktop apps particularly in terms
of productivity is still and will
increasingly more so be the place where
people really invest a lot of their time
effort and energy and now we are
beginning to enter a world where this
entire room can now unlock anything you
want to put in there electron and a lot
of the tools behind it are really
enabling us to bring a lot of the
experiences that have been in just a
browser and make them a first-class much
richer experience to get more work done
to it's a pretty exciting time to be a
JavaScript developer we used to be sort
of just confined to the web but as you
seen a lot of the other talks here we
are we're now in the it we're now in the
Internet of Things we are on mobile
devices as well with things like react
native and all the other tools that come
along with it and are also on the
desktop we're on the place where people
are investing their time effort and
energy into and something that I
certainly hope to see a lot more apps
moving forward through in the future
I certainly envision a time shortly when
a lot of the things you download and
play and use with on the desktop are
actually built on technologies you're
familiar with which means is what it
gives a whole community the ability to
work on and improve them as well which
is another big reason why we also
decided to open source and one and is
something you can find on github here a
lot of the patterns that I talked about
today exists in our source code and part
of the reason we wanted to
out there was both to help us sort of
wrote work run build this community of
plug-in developers but also to sort of
show and give it good examples to the
rest of the community about how to sort
of start and build and work on just
different types of desktop apps this is
something that Adam very smartly did
early on and and was effectively like a
fork for us in order to get us
bootstrapped and we certainly hope that
people continue to do the same things as
well as we build on top of this codebase
- this is a very very fun development
environment to work on I did a lot of
stuff in on the web before support it
down to ie 8 and let me tell you when
you only support a single development
environment and you can use all the
latest technologies that you want
without cross browser support it is a
very nice place to be developing it it
really you can really feel JavaScript
and as ecosystem is a first-class set of
tools that really make this that really
make this work so of course in order to
put this together is a large team that
we have at Nile as and increasingly
growing to sort of help make this work
and I sort of want to thank them as well
as out of all of our supporters on
github and pull requests and issues that
are submitted through that as well thank
you and then also a lot of the my slides
should also be posted on Twitter by now
and thank you very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>