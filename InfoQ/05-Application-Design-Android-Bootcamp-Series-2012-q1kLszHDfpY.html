<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>05 - Application Design: Android Bootcamp Series 2012 | Coder Coacher - Coaching Coders</title><meta content="05 - Application Design: Android Bootcamp Series 2012 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>05 - Application Design: Android Bootcamp Series 2012</b></h2><h5 class="post__date">2012-02-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/q1kLszHDfpY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">let's talk about that
that Yamba application that we talked
about earlier I showed you how to run
and download and all that stuff so let's
talk about it's designed a little bit so
first of all a little bit about
background on Yamba yeah so I've been
doing this class for like a couple of
years now right and I had always a
different I had different apps initially
like you need an example app right and
initially an example app was like I
think I get one point to get the
pseudocode game then I hit the
restaurant app then I got the golf app
it just came up with a bunch of
different things and I was looking for
something that is a I had two conditions
for perfect app right one was to to have
something the disease's to understand
that need to explain what he does like
you know what is the golf app - right we
could explain to people she becomes the
actual you know the user stories become
complex but the second constraint was
that in a very good way touches a lot of
different parts of the platform so the
illustrates how things work and why they
work a certain way and so on right so
that you know after after a while I
figured that the Amba is this this
example is actually really really good
because in a very natural way it shows a
lot of different things if you want to
showcase so that's why I kind of stuck
with it for a while now and it's kind of
seems to be working really well so let
me explain what how I would design
something like this on a back of a
napkin right so I'm gonna use this I
have developed sort of like a whoo you
know just symbols and stuff I guess the
the language the graphical language so
basically this is a activity it's wrong
like this kind of looks like a screen
night
and then this corresponds to our
application context on our application
so this is our application the dotted
line because so the first iteration of
this application we basically build a we
basically build the status activity
that's that is this screen where you get
to say what you would like to have done
or sorry what your status is right so
this is this screen start with something
it's simple it's a world simple screen
you type in something click on update
BAM it post does the web service call
and force it to to Twitter right so
that's first iteration and by the way
each iteration corresponds to
corresponds to the actual chapter in a
book right so so this is chapter 6 is
this iteration chapter 7 is the next
iteration so far right and also it
corresponds to the source code so Yambol
one that you guys can write here is
gonna be that so that's gonna be number
1 2 3 and so on right make sense well so
second iteration yeah we figured out
that you know first iteration username
and password more hard-coded there
wasn't really a good way to specify user
name and password well that doesn't make
your app very useful like you can't
charge more than like 19 cents per 48 or
something like so you know if you are
jack up that price you got a cab user to
be able to configure user name and
password so you basically add another
activity that now uses a file to store
this letter so this guy saves to that
file
this guy reads from that file
third iteration we basically now write a
service this service is doing the pool
every so often goes and checks the
internet and says is there any new is
there something new is there something
new right does that it's very very
boring life of a service you know just
goes every frequently in the support
right because we don't have a portion we
don't really have to wait to say hey one
it's just let me know when there's an
enum in this vacuum you know there's
there is actually a way to do it and we
did it but it's using something called
c2dm cloud-to-device messaging different
different ballgame so at the end of this
iteration with this following complete
the user can't see the data but we can
we can see the log that it's actually
the data is we're getting the data and
everything is built right we're not
renting it for user so the next
iteration is we now add this data to a
database we create a database and we now
store this data in a database yeah we
cannot verify the data in the database
we don't have a way to do it do user
doesn't but we can verify that it's
there so we are calling complete right
so for fifth iteration we finally add
our final and arguably most important
activity where you get to see what
difference ago but you get to see you
know the the like the timeline okay by
the way why why didn't we do this
every time you switch away from it you
lose the data okay that's one one one
reason any other suggestions you would
yeah I'd be making slower so it's in
another one she would be dealing with
latency right so every time I open up my
activity I would have to wait for it to
pull the data right right another reason
why this is relatively bad is it will
work when offline and usually you know
when I got time to read my tweets on the
subway or flying somewhere or something
right right
so essentially doing something like this
it shows you the difference between a
web app and like an Android native app
right on a web app this is how normally
it would work right on an Android app if
we you know we can actually do these
things like this is something that you
cannot easy easy
I mean don't get me wrong html5 I know
you got web workers you know it's
something like this could do a web
working stuff something like this could
be offline storage but it's not really
meant for all that right it's very
lightweight kind of stuff right so but
in Android you can and it's designed for
exactly this comes in more complex
architectures right so this also
illustrates why we would actually have
the database oops
oona hold on one second why we would
have the database on a tiny device like
this what's the point of a database on a
plastic little thingy that you can
easily lose it gets it gets stolen or
something like that right the good
reason for database is barely is merely
to be a cache right this David is I
couldn't care less blow it up right
that's fine we just go and pull the data
again from the from from the online
storage right so that's that's a that's
what you typically use databases on a
mobile device to begin with right
so and by the way one thing that they
didn't explain in in in one of these
iterations here what we did is and you
know this guy needs a logic to connect
to Twitter and pull the data this guy
needs a logic to connect to a Twitter
and pause the data
right so I figured wouldn't it be better
to actually move that logic into some
common placeholder right and there is a
object that's readily available to
everyone within the application context
right
that's called application so we actually
hang some common functionality off of
this object called application common
java object compensates them so that's
that's what that is and so we use it as
a to refactor some of the code into into
there yeah so that's that's the number
three in this number five right so one
thing that I realized in number six is
that this thing here the update service
right we want it to be always on always
running because I wanna have to remember
to start my you shortcomings what
doesn't different services are my
regular phone like imagine every time I
rebooted I have to remember to start
Facebook update Twitter update Google
may update blob they plot it or so and
so that would be really annoying user
experience but rather you'd like it to
be always on always so one way to do
that is to basically say look I'm gonna
write a little receiver that's going to
get a notified from the system right
when there's a new update well sorry
when the system is booted up and then
it's simply gonna go and launch this
this service right
so it's my boot receiver it's like a
couple months before the whole thing so
the other receiver here this guy wants
to get notified when the network is up
or down
right like if I'm flying somewhere I'm
up I'm up you know I can't connect to
the cloud not to the real cloud Twitter
cloud right so you know I forget to turn
off your phone while flying or some like
that right so it's not gonna get a
connection it's not so what you want to
do is you want this guy to basically
stop your service so it's not keep on
trying it doesn't keep on trying because
if it keeps on trying it's gonna waste
your battery really quick quickly
because the radio is trying to get a
connection to the Internet yeah it could
show you down there mister
yes this guy we can actually obsolete
this guy I mean this guy could do both
right but basically this guy is gonna
start it stop it as the network becomes
available on the belly so yeah that's
exactly what we want because if I'm if I
don't have internet I should not be
trying to say or yeah I should I'll be
checking the like ready is one of the
most expensive things you could be doing
on a phone it's like a second most
expensive thing right because every time
you fire up a radio your battery
consumptions goes up about tenfold goes
from 10 micron per so whatever 210
something like that depends on them
always but it's pretty pretty high yeah
especially for J yeah so that's why
you're getting this new phones with like
bigger batteries and all that but they
just lost it's shorter and shorter time
and their CPU also
uses more manual memory they now make
what's the m is a 10 media that's in the
new five core five Cora
yeah so they have sort of like a fifth
core which is for tiny tasks because of
the big four cores are an overkill in
terms of the battery cover yeah GPU is
yeah so so so yeah so those are the
kinds of things that you know we worry
about mobile but we didn't care about
you know we don't care about this from
these things right so so yes that's
that's where broadcast receivers become
handy just to mix things up what I did
is and I added the broadcast receiver
here but I used in a different way it's
this time line receiver so these to
illustrate car you get a subscribe to a
message from a system from another you
know from some outside world but what if
I wanted to notify one part of the
system send a message from one part of
the system to another right
for example timeline activity remember
time like a tunnel activities these
guides where you are like basically
seeing what your friends are doing right
and if I'm staring in this screen and
I'm you know I'm waiting for a message
I'm staring and waiting for a message
now what might have happened is our full
cycle happened right our full cycle
happened we actually did pull that new
message we actually it stopped that new
message in a database but this guy
doesn't know that it doesn't know that
it needs to any query the database how
do you tell it how do you send it a
message well one way is to create a
timeline this receiver here which I drew
kind of like this because it's not
statically registered via manifest file
but it's dynamically registered
just while this activity is in a running
running state this guy only exists while
family-owned activity is in userspace
right so what happens is this this guy
when it's got a new tweet or new message
it's broadcast dad this guy receives it
if it's registered and then refresh is
this true let's go so you loose it's a
different way of using a broadcast
receiver and it also illustrates how you
can send a broadcast from one part of
their system to another one part of the
application to another right so horse
again when it receives the message yes
this serves just this right it says go
do something yeah so he wakes up wakes
up this guy and then then God goes and
doesn't so that's basically if you
remember in broadcast receiver that's
it's gonna wake up this code whatever
that code no does presumably requires
the database the final part part seven
was basically I wanted to create an app
which I budget some things that you can
put on a home screen you know I'm
talking about the little book here you
know here we have the little of you know
this would be a little budget wait the
clock yeah you may have a widget like on
my phone I have my calendar what's my
next event that's coming up or something
like that right so those those are
called app words it's not to be confused
by with widgets that are UI on it
well I wanted to basically create
something like that
and what I did it but then I realized
hey this Apple JIT actually doesn't run
in our app you created as part of your
app but it actually gets executed as a
remote something-something by the home
screen
it's a remote view right so if it's
something that seemed odd to get data
you need to expose the data it can't
just magically open up database in
connector so that's a good motivation to
basically create this status provider to
provide it to expose the day you cannot
get to your database because you don't
have permission because it's running in
a separate process so so this is gonna
be a process called home screen yeah so
the receiver is kick-started because the
receiver is registered to be external so
when you install the app so did install
time you register it for that update you
say I want to know forever and ever
when the system boots up and that's done
via the intent filter in your mimic
manifest file those things are analyzed
statically at install time where so
that's that's true for for the manifest
file this one like I said just to mix
things up the timeline receiver is
registered dynamically because I only
want it to register it while user is
staring at that screen so cuz register
don't register register are very
different yes the question is why did I
go for status activity or timeline
tivity ydn I go this way also you know
yeah so status activity yeah but time so
why not just go this way right and then
have it use the status data you could do
that but like I said
provider from a is a level of
abstraction that scares a certain cost
actually I don't know it's probably the
least fun to write static revives it
needs they're not this is fun at all
I think they're just like a lot of kind
of code that should be there so there's
no reason to provide for separation of
concerns if everything is part of the
application sometimes yeah but you could
so it becomes the design decisions</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>