<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Context Managers the Easy Way | Coder Coacher - Coaching Coders</title><meta content="Context Managers the Easy Way - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Context Managers the Easy Way</b></h2><h5 class="post__date">2013-09-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/U2t2t_cpvoc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">let's jump through context managers here
my kind of alternative title for the for
the talk I thought about this putting
compact interfaces on for both api's of
the pythonic thing to do but I couldn't
fit that on the slide entirely everybody
knows about context managers right the
with statement in Python you know the
the famous example is the the open call
you use with and at the end of your
indented block your file handle is
automatically closed for you you don't
have to do anything right that's cool we
like that it's a it's like decorators
for blocks instead of just decorators
for functions and anytime you have an
API that kind of has like a before and
an after step or you know a do and then
an undo kind of step you should use
something like this or alternatively you
know programmers always follow
instructions so you can just tell people
you know always put the after call in a
finally block and they obey you and you
can ignore the rest of the talk um but
it would be useful if you have you know
you close a file or socket handle even
if you crash or you commit the
transaction even if you crash or you
release the lock you know you get the
picture or stateful api's reset the
thing to the original value that kind of
thing so with as awesome context
managers are great but it's kind of a
verbose API right you have to make a
class the class has to have an enter and
an exit method the enter is the before
stuff so if you need to do any
initialization you can return a value
from the inter method that is the thing
you catch with as so like you say with
open as file handle the exit is the
after method and the exit method has to
take three arguments that are all about
handling exceptions in the indented
block and I can return true or I can
return false you can use an it and
accept some arguments to customize your
manager you know like like the open
takes a file name a specific file name
to open okay you know it works a little
verbose we can do well maybe better
maybe just shorter but you got to get
several concepts kind of packed into
tight space so phenomenal cosmic power
at our fingertips and anybody living
space
David Schechter said he didn't care if I
did that for the purpose of this
lightning talk
the first concept you have to understand
is yield and I'm just gonna say like
yield is a return that pauses your
function so you can run it again from
the point at which you yielded so if you
put yield in a function it's not really
a function it's really like a
constructor for this special generator
object and quick code sample you know I
have a little do two things function it
prints something a yields it prints the
second thing when you call it what you
get back is a generator you know this
thing is what you get back from the
function that's kind of odd it has a
next method you call the next and it
prints out first thing and it yields you
call next again it prints out second
thing and then it crashes with a stop
iteration because hey that's the
iteration protocol so you'll do gotta
know about yield try finally on earth
explain this one right and I forgot one
minute 56 seconds so you try some code
usual if you do something stupid in your
code your program crashes but you could
put a finally block which is guaranteed
to always run no matter what kind of
sort of mostly usually they're not cool
I'm talking fast enough already
so decorators and no not in a minute in
36 seconds we won't explain decorative
let's just say magic applied to
functions and you've probably used these
even if you don't particularly
understand them you make a class you
make a method and usually if you leave
self off in a method there's just no way
you can call it Python makes you do the
explicit self thing but if you put that
little magic at static method in front
of it it like changes the type of the
function and manipulates its signature
and does lots of cool stuff so hey now
you can call it so decorators magic
apply to functions all that gives us
context Lib context manager quick short
hands whose use this okay good few
people a decorator that can build a
context manager for you with those
earlier concepts you just have to write
a function that runs exactly twice you
can do that by yielding once you have to
write a function that's guaranteed to do
the stuff after the yield and you can do
that by putting that stuff in a finally
block you can optionally like accept
arguments to your function
that's customizing the behavior of your
context manager and optionally yield is
like return you could return a value so
that's the thing that gets passed back
and caught with the as statement and you
just decorate your function with the
handily supplied at context manager so
with 26 seconds to go here's a sample
context manager called CD decorator to
that context manager here there's the
decorator I have a try block and what
this one does is it checks to see what
is the current path it goes someplace
else and does the expand user so you can
pass it convenient paths and then it
yields and then I have a finally block
that's kind of the after stuff and it
goes back to where it was in the first
place
so not very complicated to understand
and really easy to use kind of this
block of code says if you say with CD
changes some directory do some
location-based stuff when you're done
doing location-based stuff you're back
where you started from
automatically context managers they're
cool and I have no time for questions so
thanks very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>