<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>12 - Services - Part 1: Android Bootcamp Series 2012 | Coder Coacher - Coaching Coders</title><meta content="12 - Services - Part 1: Android Bootcamp Series 2012 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>12 - Services - Part 1: Android Bootcamp Series 2012</b></h2><h5 class="post__date">2012-02-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/40btHqESpHM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so so far what we've done is this part
of the picture right not even we did
this right we have basically this
posting to Twitter okay so what I would
like to do next is let's skip to let's
get straight to three which was
basically dealing with with with
services because that's a that's an
interesting topic so what we want to do
here is we want to create a very simple
service and have it start and have it
stop like just to illustrate what goes
on how it's working and and that sort of
stuff right so to do that we're gonna
create a new just like any main built
building blog the following steps are
always the same
to create a new main building block
you're gonna create a new Java file
first okay so I'm gonna create a new
class and I'll call it updater service
that's something
so just like before
- you never start from writing stuff
from scratch you usually basically
subclass something from the system so in
this case we're gonna subclass service
organizing ports you got to use your
common sense which one you want to
import okay and a dump unimplemented
methods so this is basically a certain
little service in a nutshell now we have
to implement this on bind method we have
to have it we don't have to implement it
we're actually not gonna worry about it
we're gonna ignore it for the time being
this biometric has to do with a binder
with bound services which which is not
what we are doing today we're gonna do
that much later on so basically for now
just successfully ignore that method so
the common things if you remembering a
service where start create your own
create on start and on destroy so out
usually implement all these so what I'm
gonna do is I'm gonna go source override
implement methods and I'm gonna find on
create on destroy and on start it's
actually on start command because your
own starts being deprecated so you want
on create and destroy and on start
yeah
like okay usually I just moved on start
before the on destroy just because it
makes a little more sense
so far so good now what we also do here
is services are invisible we can't
really see them run right for the most
part so it's very useful to know what
happened so what I like to do is I like
to put my log these to basically be able
to visualize what's going on with my
code right so I usually define my static
final string tag
I usually get rid of all the to deuce
and then I put a log the log D comma
organized efforts input that's it
so basically what you have so far is you
have the the shell or the template for
any service right most these types of
services you they're gonna look like
this and by the way you guys may
remember that I gave you a document
called main building blocks yes it
didn't show me CD Civic
so this one is useful so I'm gonna copy
HTML
so this file main building blocks up
HTML in you basically have the you know
these versions of like various things
pre-canned like these are you know what
it is they kind of commonly use methods
I put them here things that are sort of
like a Templar things that you could
just copy paste into stuff right so for
example if you're looking before a
service there's the life cycle and like
I said this is this would be a template
for a typical service so in the future
you know if you don't want to do this
you can just copy paste it and say I'm
done with it
right so after we create a Java class
what would be the next thing that we
must do for any main building walk up to
the application manifest yeah so we will
need to add it to the manifest file yes
so we need to define it to open up a
manifest file
somewhere within this application block
right you need to define the service so
it needs to be equal level citizen to
activity so what I would do is I would
do control space service control space
name and then for the name you put a
class name right so update their service
yeah but what is the full-fledged name
of this class
yes it's gonna be the conduct example of
the amadhatter updater service now a
shortcut for typing all that is to
basically just say dot of the other
service that basically know is that now
I've seen the package so it takes
advantage of that unless you want to
type the whole thing which you put
okay so now that we have this service
your question is how do we actually keep
started forgetting to run what was the
glue between main building blocks
intense yeah so so we need to fire up an
intent to to start up the service right
the question is just now how we're gonna
trigger that in then we could just put
it somewhere and say start the service
and be done with it but it'd be nice to
actually create some kind of you know
button or menu system to actually do
that right yeah so this service is moved
for more more or less done for now so
what I'm gonna do is I'm gonna close all
these files to remove the clutter yeah
and let's talk about the how to do the
menu so how do you think you did the
menu we've never done huh okay since
like it's like a UI so we in the UI we
started by doing things in laughs yeah
in XML first right and then we switch
over to Java right so let's see what
Android has to offer for me is to select
resources in go file new Android XML
file
yeah so on the research type there's
actually a menu type okay so select that
and for the name you can put something
like menu but XML for example ok finish
right now eclipse is buggy right so this
is not a proper way to look at it then
you know so I'm gonna try to do this
again I'm gonna go right click gonna say
open with menu editor so what better
yeah
so let's create the menu so by the way
the many we're creating is gonna be
demanded that shows up at the bottom of
the app device when you click on like
the menu button right so the menu we're
working on is the menu that shows up
when you click on this menu button yeah
it looks like this right something like
that
okay so let's create a new item now just
like before you are creating a nick some
kind of like I almost like a UI element
and you can specify gazillion different
properties it's not as bad as before but
not everything matters as much right the
properties that you care about
universally is the ID and probably the
title right so for ID Eclipse already
gives you something like at plus I deem
item 1 right which is meaning less so
I'm gonna rename it this is gonna be our
start service menu items I'm gonna say
main item start service
the other tendons we care about is title
so I could say simply start service but
what's wrong with that
yeah well it's not as like a language
thing but it's a boat it's supposed to
be externalized interesting sectional
right so okay so what do you want to do
as opposed to doing it like that you
want to say brows you wanna say new
string you wanna say the give it a key
to start service for example okay that
that's it okay so basically this is now
referring to that you no longer could
copy this for me right because this now
refers to something that they actually
have implemented another file so don't
copy just this piece of text like there
needs to be a relationship this is
pointing to a value call start search
again type you there
all right so you guys now do the stop
service same idea so click on add make
sure you had an item if you by the way
if you kept this selected then clicking
on add is gonna think that you want to
add a submenu to an item which is not
what you wanna do so in that case you
would have to click on here and say
Aizen right so you want another item the
equal seasons
so item stop service title again we
inject quickly a new string your
strength stop service
that's it save it to the file
so as part of this we basically we
generated the file looks like this and
you can control shift F and format it to
look at night to make it look prettier
if you just care about it but basically
we have a menu with two items in it okay
now how do we get this menu now to show
inside of the activity well for that
we're going to open our status activity
and what we're gonna do is we're gonna
add two methods I'll add them to the
bottom it doesn't really matter if I
edit two methods one is called something
like on create options many Germans call
something like own options item selected
or something like that but again use
source override implements methods
because you don't want to memorize this
stuff
so I'm looking for something to do with
on create options May and there's there
it is on create options man is one the
other one is on options items selected
those are the two so that's our main
stuff now goes here right in order to do
this
so first again
so on create options menu is called
first time that user clicks on this guy
on this menu button here so it's only
called once first time is a click Submit
as such it's a it's an opportunity for
you to create the actual menu so in
other words menu system is lazily
initialized
first time user clicks on which is no
clicks on it it doesn't create the menu
system right because it who cares about
so what you want to do here yeah so the
question about the menu button in
honeycomb they icon doesn't have buttons
and there's no physical physical buttons
on a tablet um but there's there's
something called an action bar right so
it's always present and that basically
places all that so action bar actually
uses the very same system as the as
these you know other versions okay it is
that the menu system is not gonna be a
button that comes from the bottom but
it's going to be an action bar at the
top and when you press it pulls down
from the top it has couple additional
features but I didn't that it's all the
same your code is going to be exactly
the same
yeah so yeah so it's got it's got a menu
button it's got the soft many button
because it's using the team yeah so it's
a software-based button but it it does
in the same methods get called
and that's a tab right next scale
skipping the galaxy tab okay yeah so yes
so the menu button should be the part of
the action bar so so it should be part
of this section bar yeah it's just a
little it's little like couple lines and
you pressing it from top down
no no not always
that's all saying on Honeycomb the menu
is going to be actually the talk yeah
yeah yeah yeah it's gonna be on the body
no not as an app developer okay so
basically for the many stuff so on
create you need to return true if the
menu was successfully created
so I usually just change this to return
true I don't see why it wouldn't be so
the way this works is Dwayne's
documented to work is you are given an
empty menu object you are to populate it
okay so what I could do is I could
create you know don't do this but I
could do you know menu is new menu you
know and you can do menu dot add let's
see that ad right and then sub menu or
blah blah and son right you could do
stuff like that program Africa but
instead of doing that we're gonna load
it the next small because it's easy
right so to load it from XML we need an
inflator that's going to be able to
parse XML and inflate memory so that's
readily available to us we do control
space
get menu inflator dot inflate and it's
asking you what resource into what
object right so this goes to XML loads
the data puts it into Arabic so resist
we're gonna be are say r dot menu dot
the man is going to many oops okay so we
now have the menu right inflated it's a
matter of fact if you run your code now
just be able to see a menu
yeah that's install panels yeah if your
name
yeah this first many is gonna be all his
name but a second one may not be so I'm
just see what's going on in my
somebody's in Miami oxidize again it's
not special doesn't work
folks you guys
again I have to leave with my amulet or
whatever isn't okay so now back to this
so now every time a menu item is
actually clicked on which I can't show
you right now because my amulet is still
good enough what you're gonna get is
we're gonna get this call being called
in with the actual item being testing so
if you click on start service item it's
gonna call an option side to select it
it's gonna tell you so I think you know
clicked on right so what we want to do
is we want to basically handle different
items calling back into this method and
the good thing about this is that you
can use a switch statement because
Android uses integers for IDs so here's
what we can do it it's elegant switch on
item dot get item ID
yes
now you can have your case statements
then you can have case r dot ID that ID
dot item start service do something case
r dot ID dot item stop service do
something they can have default if it's
not handled
so far so good so typically what you
wanna do is once you're done doing
something for start service you want to
return the the boolean that owns all
option settings like a Pyrrhic terms is
true if you handled it false otherwise
so false minutes with the end candle the
processing this button goes to us as
somebody else possible right so what
you're gonna do is we're gonna return
true here right to return then return
false so you have an elegant low switch
statement which you can now expand as
much as you want right the question is
how do we start a service and you guys
said by using an intent right so how do
you use an intent defining you in fact
make it explicit and then quiet we don't
have to define it in a manifest file um
we can actually use an explicit intent
right so what I can do is something like
this right I can say let me create an
intent intent new intent
now there are nautical ways to create an
intent you can create an empty intent
you can create an intent to the piece of
text in it but the Intendant we want to
create is the one that's gonna take the
context so this in the destination so
there's gonna be an explicit intent so
it's going to look like this - this
comma and then the destination in the
destination is going to be updater
service that class this would refer to
the activity which actually is a context
yes so what we need to pass in here
the destra presents' the context which
activity is a subclass of
yes
okay so now the question is what do we
do or in this case or start service but
we're going to simply say start service
for that intent
and in this case we do the opposite we
say stop service for that intent yes so
deaths in this case refers to the the
class itself or the instance of the
object itself in which in our case is
establish activity and start studies
activity is a subclass of context so we
are basically passing on context that's
when we need to pass no it doesn't it
can but it doesn't by default yeah so
you'll see all about that ok so now if I
run don't have my doing here it up but
it doesn't know about it
okay so now those
it's loading masseurs so what we now
have is a service we have AR activity
right so now if I do menu there's my
many start/stop right if I say start
there's my updater service get started
right if I say stop it actually stopped
if he's gonna say right
what happens if I do what if what
happens if I do let me clean this up I
do start start start so start to create
it started when I was happy to start
again me I felt that I see again you
guys can actually see it
okay so many start service started then
you start service started so it keeps on
starting it but it doesn't keep on
creating it right if I do many destroy
it's gonna destroy it if I do menu start
it's gonna recreate it
now for many if this is running right I
mean it's not doing anything right so
it's just in a running state then the
words are our service finish this code
it didn't really do much so what we can
do next is we can go to the I can go to
the remember manage manage services the
menu management learning applications
Google menu manage applications
right
yeah ma so there's one process in one
source right yeah I can actually so
that's our objective service that's the
service you study so it's run and run
aquatic boat running although it's not
very much right what I could do now is I
could to stop and you can say notice
that this get called on destroy so it's
all good
that's just what it does it's a service
that's basically how this works so how
would you now add to this service to
pull from Twitter okay so where would
you do that so you'd create a new
Twitter object right so I may do
something like this
twitter twitter right we're saying is
that you're gonna imports they're saying
instantiated here it's a twitter is new
twitter and then you copy paste that
username password so student and
password right then you set the API root
so whether that's that you can copy
paste this right I'm just typing it
because
okay done so where would you now pull
the data from Twitter
and then the Methodists get public
timeline or something like that but
where would you use it on create on
stardom destroy and burn and start okay
so I could do something like this you
know on start rate I could say Twitter
dot get I think it's get public timeline
right and that returns a list of
statuses control-shift
oh now be careful when you import
statuses there it's a common name you
want the last thing you want the Twitter
dot status that's the one that we are
referring to by status we're not talking
about Wi-Fi async tasks or SSL engine
talking about Twitter it's a make sure
you import the right status otherwise
everything goes to you know KY so
presumably this is where we get our
tweets right there's a list of start of
time and statuses in time what if I just
wanted to what do you want to do with
this list now we want to show it in the
UI but we got about ten minutes left so
it's not gonna happen right so but in
the spirit of being or you know Morris
will always fall and complete what works
the simplest thing to do you know we can
print it out to log and some like that
right so I'm gonna I'm gonna use the log
so you guys familiar with the for each
loop does this make sense this notation
to some of you for those of you pull on
Java before 2005 this basically means
for for go over time line and each
iteration assign
the current value into this right so I
can now say log dot the tag comma and
let's imagine that I just want to simply
print out who says what right I guess
familiar with a string with format okay
do you remember print a fluency okay so
it's like printf for Java right so it
goes like this
it was string dot format right and then
you say format comma variables right so
my format may be percent as column for
Santa's let's go said what right and in
valise you're gonna be status dot user
dot name comma starters dot txt for
instance
so that simply iterates over the entire
list and prints out who said what right
and this links to that right and then
this links to that right you can do
concatenation what if I wanted three
parameters I mean you know you kept plus
space plus blah blah I just yeah this is
what it's designed for this function
like so this call could die right you
guys so the proper way would be to
actually wrap this try-catch block right
cuz we don't know we don't control the
network gazillion things could go wrong
password is wrong access denied blah
love all right so I'm just gonna simply
wrap it in a try-catch block because you
don't want to need to die here because
then the service is not gonna be able to
start okay so let me again
okay then you start service died okay so
I had to die as wall and create walk at
uh-huh you have a same problem guys are
gonna remain trapped right right
in our current auditor service line 28
that's a problem
damn not a lot to do this
I'm sorry
yeah remember so for those of you on
older versions this may work for those
of you new versions this may not work so
if I just want to get quickly tested I'm
gonna do this source sitting on the wet
track BAM
and then I'm gonna run it yes that's
exactly the problem
so many you start serious there we go
BAM worked these are tweets who said
what student hi there Bam Bam Bam I just
took that thing and wrapped it in a try
block but they also have to gonna try
you know a thread that's it I'm saying
we're gonna fix this this is not a final
right
but it's the same issue we can do with a
UI that kind of just proves to you that
this is really truly running on UI yeah
why is the service running on you like
that that's how the designed it and I
don't know exactly why but there is an
alternative so we're looking for the
totem tip shortly sarens following this
right any questions comments concerns we
started with services there's more stuff
that we need to do with this</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>