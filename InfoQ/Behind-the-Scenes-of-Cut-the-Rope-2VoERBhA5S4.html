<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Behind the Scenes of &quot;Cut the Rope&quot; | Coder Coacher - Coaching Coders</title><meta content="Behind the Scenes of &quot;Cut the Rope&quot; - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/InfoQ/">InfoQ</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Behind the Scenes of &quot;Cut the Rope&quot;</b></h2><h5 class="post__date">2012-05-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2VoERBhA5S4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Thank You Ann it's a great pleasure to
be here today so my name is George Sr
doh I work in redmond I working the
windows evangelist team and there are a
lot of reasons why I love my job but I
think number one I get the opportunity
to work with very smart people either in
the product teams like you know windows
internet explorer javascript visual
studio but also with developers and
communities partners design agencies
around the world I travel a lot and I
try to meet as many developers as
possible and one of the developers we've
been working with for this game
particular is pixel lab is as small shop
based in in Seattle and they've been
working with us producing this beautiful
application and so today I want to share
with you some of these experience that
we will talk about games and I want to
share with you the experience of
building this game but before we get to
cut the rope just let me spend one or
two minutes looking at how we got here
in the last year or so and so about one
year and alphago I remember you know for
for the launch of IE 9 we've been
working on this side and we were trying
to demonstrate what you can do with h 2
and 5 so this is a game that you
probably know yes so you know that if I
go down whoops and if I go left okay
somebody need to send an email to my
manager asked him I need to play more
but you get the idea that I can keep
going and going and going and if I go
home here actually you know it's not
just one or two mazes but we are talking
about 80,000 mazes generated by users
like you so you can just go there and
create your own one and this is all
html5 so html5 plus the cloud and this
was one year ago and oh
you know Bachmann is a simple game so
what ever since since then well Google
had been working on a funny new game is
called maybe you know it hungry birds
end of this game working on the browser
is all html5 almost always shipment
html5 and it's great you already know
angry birds are not going to show this
today and then Mozilla more recently
came up with another great experience
it's called browser quest and the thing
I love about this game is that actually
it's not just you against the computer
but is you against other users and so
you connect to the web and now you're
using web sockets communicating to
playing real time with other users this
is kind of awesome isn't it
I mean technology is not just there to
enable is there
and then more recently this is more for
fun actually we came up with another
small experiment any all started from a
youtube video and it's all about
marshmallows so we call it birth to
death so you can play this makes my god
me too let's totally do it and this is
the game and you might think about this
must be very complex games not sure your
you have to throw a sponge and if you're
bored of punching then you can also put
them on fire I feel nothing Oh
and you can keep going and going they
got here cookie price is met as long as
you stop punching you you're you're both
Aurora don't score goes happy
and so what did all of this game have in
common it's a question try to answer
they are html5 and you're killing some
people but also the html5 so we didn't
use plugins and and so that actually is
in line with with our expectation right
if you hear Microsoft in the last say 23
years we've been telling or Microsoft is
all lean into html5 blah blah blah
internet explorer is fast blah blah blah
order acceleration blah blah blah but
actually it makes sense look at the
progress this was like what we
implemented of the html5 specification
about 23 years ago this is what we have
today and this is coming from the work
with WC with our browser vendors with
other browser user agents and with lot
of people in the communities and this
spectrum of vegetable fights back is
getting bigger and larger and better
right like there are maybe 100 specs
only on this page that we already
support and actually already supporting
in all browsers you can do pretty
amazing things with them and best thing
about what we do in Microsoft that you
know in addition to be standard
compliant we also work on performance
now let's forget about Microsoft this is
not a Microsoft talk but the interesting
fact the part here is you know my team
works on demonstrating and like on the
bleeding edge of technology and we try
to see what is the age 12 I where is the
technology going after later and we try
to demonstrate it with real application
and so we thought can we take all this
marketing message that the item is
creating and validated right is it true
or is it just marketing stuff and so we
thought let's create a challenge let's
take a native application a native game
running on iphone and ipad and it's
turning into html5 and this is what we
did with cut the rope so now i'm going
to share with you some of the code some
of the learning and some of the process
we went through to
take a native application on iOS intern
html5 application running any browser so
it's not I only write running in any
html5 power browser do you know cut the
rope or do I need to do a demo dunno you
know cat Rob have you seen the website
of catalog before okay most of you did
excellent so let's start with the basic
let's start with some code Cut the Rope
is written in obviously in objective-c
about forty thousand lines of code one
of the first principle that we said when
we started working on this project is
that we didn't want to lose by date
fidelity we wanted to have exactly the
same experience on a JavaScript as he
was an objective-c so there are 40,000
line of code in objective-c and we did
the porting of the line of code one by
one into JavaScript and that was not too
difficult but there is definitely some
learning there and on the graphic side
we started from OpenGL and we turn it
into a camp mainly a canvas game and so
let me show you the game after probably
a few hours we were working on it so you
recognize this right how does this work
how are we doing this animation here's
the trick let me show you what we call
sprite this is an image with lot of
different frames and so in the campus
then we animate very quickly over over
this window and we create the effect of
having an animation so if I show you the
code behind actually let's go to script
it's all here so this is all it takes to
create this animation let me zoom in for
you we have a canvas we set up the
canvas and we are the dynamical to the
page and then we have a drop in loop
just a basic we're not doing any
optimization yet just a basic loop every
60 milliseconds with we look into this
ravine loop with clear everything it's
on the campus and withdrawn image and
then that image is coming from you know
moving very quickly over that large
surprised that you saw before and this
gives you a nice animation this was easy
now let's get to the complex part what
we learn building this application is
that the ropes were actually the biggest
trouble for this app in terms of
performance and let me spend a couple of
words on this what you see is a rope
there is actually not a line it's not a
busier is made of 20,000 triangles
little triangles next to each other and
then they give you the idea of being a
rope why because in in OpenGL you don't
Avantia lysing and so the way the iPad
developers work that around was creating
all of these triangles and by the way on
top of those 20,000 triangles you have
other 10,000 triangles to create the
shadow on the edge and so we basically
ended up having an a grade in JavaScript
that was animated 30,000 triangles at
every drawing loop that's quite a lot
right toes out in in html5 this is
easier because the canvas bag implements
natively the Bezier line but still we
had to do some work to optimize the code
and so let me show you the application
running before so this is what the code
was looking before and on the right you
see the code optimized later and then
i'm going to show you the code you see
the difference you see it yes no it's
kind of obvious here now let me show you
the code instead so this is just a line
what do you think is this law or is this
fast fast actually no this is long I
didn't know actually you know at this
point zeptolab is the company that owns
this game we send this page 22 zeptolab
back in Russia and they come back with
an image say in a Georgia this is
embarrassing is law and I was looking
book what are they talking about we
should stop the project here I was like
what
but then you know I realized that if we
open the if you use like a JavaScript
profiler in most browsers ever
JavaScript profiler now actually sorry
this one and we provide this JavaScript
I'll show you what's going on in behind
the scene right so we're just capturing
using the f12 to now to capture like a
profile session of the JavaScript and
you will see that a lot of time is spent
on vector and also on calc two point
busier those are you know this is where
the java ski spending most of his time
and we are talking about two seconds
just allocating vectors and so let's try
to understand why spending so much time
and if we go inside vector we will see
well it's just a vector function with
wrong about this if we go inside these
this is what's wrong new vector and so
think about this point bezier is
basically the function that calculate
the position of all of those little
triangles if we call that 30,000 times
and each time we create a new vector to
return a result and then we dispositive
media immediately after to send it to
the garbage collector you're paying a
big cost right in there are ways to
optimize this code and so in the next
session at five I will actually go even
deeper into this and I will show you how
we optimize this code and so at this
point we were you know like almost about
to close the project and to go home and
to lose my job and I was crying but then
we kept you know the day after we
realized that it was possible to
optimize the JavaScript code and so the
learning was if your Java code is low
maybe you didn't write it right you
didn't write it in the right way try to
look it again to it and use JavaScript
profiler to fix it and after 4-6 weeks
we got to this which was amazing right
we have the basic element and then it's
kind of buggy yet we didn't complete all
of the code but it was mostly working
and this was already wassam like i was
dancing in my office yes I'm going to
keep my job this is going to work and
this was easy right and then from this
point on the next step was just to keep
the lead of the game and so let's look
to the code behind that page the body is
only a campus right we are using only a
canvas element to draw all of the game
then we call obviously all of the code
to start up the game experience and then
I also wanted to note here that were
using jQuery there are things in the
application that have not canvas only
and we wanted to use a framework because
you will silly to rewrite some of the
code and we decided to go for jquery and
lastly we also created with the help of
pixel labs a preloader to load all of
the images and sounds and this is
available so this is made open source
and you can use it if you're doing any
game other interesting tight bit here if
I go inside maps you will see that
actually each map is defined by an XML
file which means that you know like this
we created the engine but once we have
the engine you can go and build as many
levels of the game as you want so this
was all the fun project to work on we
will look later in the next session a
bit closer to the performance and I will
share more of the details but I wanted
to give you a very very very very high
view of other tools another possibility
to go into the browser no matter what
browser you are but into the browser and
look actually how the CPU is spending
cycles on each of like you want for
example on different sub engines and so
for example we can see here this is
called expert is a free tool that comes
with the windows sdk it actually tell
you how much milliseconds are spent by
javascript by the layout by display
extra etc so this is another interesting
tool to help you optimize the code at a
very low level and we will get into the
details later and then about eight weeks
12 weeks into the project we finally got
to this point so this was the full game
running as html5 experience click click
and then in just play champion of the
world now this was a fun project to work
on but here's the best line about this
the best thing about this when we got
here then we send back the you know the
website to dead zeptolab company in
Russia and we were like what do you
think do you like it is it good is not
and the next day I get this email saying
I'm quoting this is too fast can you
please slow it down and I was like yes
and so we did a bit of negotiation there
but eventually we end up just slowing it
down so if you actually look at the code
of this game we had to add other
JavaScript to slow down the game so the
question is why did ask to make it
slower right does it run only on the
desktop or on on on the ipod or other
devices in general so on Dave ideas to
be slower is because you know like you
know your game better than anybody else
you have your own requirements and you
know what the user expect from you and
also they were used to a different
performance on other devices and it
didn't think you know like a zine user
it would be surprised to see that you
get a different playability different
gaming experience of different devices
and then obviously we need to defer to
them to give you the all of the reasons
in terms of which platform we we
targeted this we use IE to develop it
but we test it on all browsers and we
made sure actually we had a QA process
to work on chrome and firefox safari
opera iPad Android Windows Phone so we
actually tested on all browsers it
wasn't our goal to make it work only to
lock it to one specific browser in in
terms of performance there one of the
decisions we made up front in the
process was to say we expect the
browsers to be at least
they're able to play at 30 frames per
seconds and so you will see that if you
start playing the game on a mobile
device that is low maybe starts with the
a you will play the first game and it
works so so and then we will prompt a
message saying eh maybe you're not
playing at the best experience try to
either move to a faster browser or you
know play it your own risk and so I will
do a QA about this game and I will
answer any really any question that you
may have in my next session we have like
alpha now we're only for QA by this game
because I know that you have lot of
questions but I want to show you
something else here very quickly and so
at this point we were almost two weeks
away from releasing windows 8 and you
know I work in windows and part of the
things we're doing we did in windows 8
was remade in the platform to allow you
to reuse your html5 your skills to
create applications and to sell these
applications in the store and so we
thought I thought actuated point what
does it take to take what we did for the
web and let's see if it works as an
application for windows and so that's
what I did the day I went and I'm going
to do just the step by step I just open
up visual studio is our tool environment
I created a new project for a metro
application in HTML and JavaScript so
this is the new windows 8 metro app okay
I'm just choosing a a default a template
I'm not doing anything here and we just
to do will create the template for me
okay so so far is just an empty project
and so on the right I have my
application and on the Left I have the
website so i take the website and go to
the file system and i select all of the
files and I just copy them copy we don't
need this anymore and then I go to my
major application NSA paste and then I
just overwrite everything ok
and then the other thing I need to do in
the manifest which is just an XML file
that defines some of the property of
this application like ties and
orientation etc I just switch the
default the start page to be index right
ready now I compile this application and
I run it as a local application on my
machine so this is to do is packaging
this code would you think and by the way
this is also good friend right so this
is a touch screen so that was what he
took us to be to go from web to metro
now what I just show you is horrible
horrible don't do it at all right like
we are not asking you to copy and paste
websites into application no don't do it
ever please don't I just want it to
prove the fact that you can take your
coat your skills and just eerie use them
super easily to build an application
that goes through the windows 8 store so
that was it and also actually if you
look at this application and the
application that we end up publishing to
the store that quite different right
this one for example screen
allow you to share with your friends the
context of the game if I click options
is integrating into the operating system
allow me for example to play side by
side so if my manager is around no
manager I'm writing code seriously I'm
writing code I know and then not
actually I'm playing in a number of
other things so we did explain that
Porter to be an application and in the
next session I will talk to us a bit of
the tricks to get there very quickly and
the other thing I wanted to show you is
another tool that you might actually
like a thing so I'm running I'm opening
now the full project so this is the
final HTML applic metro application and
i'm going to open it with a different
tool called expression blend by the way
all of these to love free so they work
on Windows obviously by the frame and
this is called expression blend and what
we try to do with expression blend was
to create a tool to really build complex
applications and one of the challenges
that you that you have today when you
develop a website or when you build an
application is that you don't see it
until the time we're actually open it in
browser so do you notice anything about
the stone it's slow okay what does look
closely you see the background it's
moving you see that shadow is rotating
so we are actually editing a page built
by JavaScript you're not editing like if
you open this in any other web editor
today you will get static HTML with no
preview now we're editing a page that is
running is a live page and is running
you remember I told you it's all built
by canvas right I can even go into the
game and start playing the game and go
to the video and then select for example
one level now I'm in the game I freeze
it and I say hey I want to keep building
this page from here and so the tool is
running java
to animate and to create all of this UI
this is all building in real time with
JavaScript but still you can edit it and
you can move the CSS and you can see
things as they will look like and so if
you build like JavaScript applications
and you know like the pain of not being
able to see what you're building
dynamically this is our approach to to
fix that problem and obviously as you
can see it's quite complex so there are
many other things involving this tool
from CSS styling to for example being
able to preview on different resolutions
on snap view etc etc what do you think
is this useful I have to say like this
is one of the things I'm most excited
about like it took us a lot of years to
get here but now that i think about it
is kind of obvious right like you're
building we are asking you to build
complex HTML application and JavaScript
applications and without this it's
difficult it's very difficult and so in
this session I just show you a quick
overview of our experience building the
game in the next session I think it's at
five p.m. this afternoon we will get
into the specific code and i will show
you some of the code behind and i will
talk about performance tricks that we
use to optimize loops algorithm to talk
i will talk about sounds i will talk
about you know compatibility and things
we have to do across browsers i'll talk
about touch but most of all i will
answer any question that you might have
in the meantime we are hiring a windows
8 evangelist to work on html5 apps and
so to be the other cool stuff like this
so if you're interested just ping me I
want to thank you for your time and I
see you later thank</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>