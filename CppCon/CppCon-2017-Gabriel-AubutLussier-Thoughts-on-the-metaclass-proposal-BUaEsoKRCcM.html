<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2017: Gabriel Aubut-Lussier “Thoughts on the metaclass proposal” | Coder Coacher - Coaching Coders</title><meta content="CppCon 2017: Gabriel Aubut-Lussier “Thoughts on the metaclass proposal” - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CppCon 2017: Gabriel Aubut-Lussier “Thoughts on the metaclass proposal”</b></h2><h5 class="post__date">2017-10-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BUaEsoKRCcM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Hello everyone.
It's great that we just had
Herbs at metaclass thought earlier
'cause right now I will be
able to skip a few slides.
So I just wanted to give a few thoughts
about this awesome proposal.
Disclaimer, I'm not
involved in preparing it
or in any way, I'm just
very enthusiastic about it.
Well let's get started.
Basically if I go, even more
in a nutshell than needed,
what really stuck with me, the properties
I really enjoy about metaclasses
are that it allows you
to enforce constraints,
to generate members and
transform existing members
such as by applying defaults.
So those really are the three
most interesting properties
I think that you can
enable using metaclasses.
Overall you also have this
wonderful opt-in mechanism
which allow you to name a
subset of the set of classes.
Of course you've seen this example,
except like for the private part,
which doesn't compile, fortunately,
and so if we shorten it, we can also get
the generated class like this.
So you can see that after
applying the constraints
preventing you from having
a private member function,
it's actually generating virtual
destructor on your behalf.
And it's also transforming
your member function
to make them pure virtual by default.
So enough of examples already.
Some of the thoughts I had about that
was that this can be a very great tool
in order to enforce
some of the constraints
concerning design patterns.
You can also enable those design patterns
by generating members and
reducing the boiler plate
and reducing,
at some point, there was
a design for singletons
and then new language
features made it evolve.
If everybody was using
singleton metaclass,
it would be very simple
to add up the new stuff
everywhere in your program.
Assuming you're using a metaclass.
So that's one.
Another I really like is that using
the compile time static reflection stuff,
well, you can actually
reflect on your whole
translation unit which
means you can iterate
over all of the members
of a translation unit
and maybe even discover
some conforming types
which conform to the constraints
of one of your metaclass.
And you could just use the compiler
in order to discover
those in a huge code base.
If you flip things around,
well you could actually use
your metaclass in order to
expose recurring bug patterns
you notice in your code base.
Another thing which I think
is was very interesting
is that we get to think
outside of the bounds
of the language because
of the opt-in mechanism.
So we have a language where if
I want to write a container,
I will have to write some
of my member functions
and add a type qualifier
saying that they won't
modify any of the members.
And when I want to modify members,
then yeah, I don't have any hovering.
But using metaclasses, we
could maybe start thinking
about having construct metaclass
which flips thing around.
Members are const by default, then you
could even think about
modifying the syntax
so that it's now allowed to
put immutable type qualifier
on some members to make them mutable.
So maybe we can push this even further
and go within the code blocks
and here you have an integer variable
and we assign to it later
on during this method.
So what if this could be a compiler error
'cause an int variable is
now assumed to be const
within this kind of metaclass?
And of course, you just have to qualify it
with immutable keyword in order to get
the different behavior.
This could be very interesting.
I encourage you all to read the proposal.
It's very thrilling to read it.
It's not like verbose or anything.
There's a lot of examples
of how this can be applied
and it's great.
Also you can compile
Andrew Sutton's Clang fork
which you can find on GitHub
with the link on the slide.
And you can also Godbolt
some metaclasses online
right now at cppx.godbolt.org.
And if you're even into that,
I encourage you to host
an experimental workshop
at your local meetups using those tools.
We've given it a try at C++ Montreal
and we've had a blast.
We spent a lot of time just presenting
what metaclasses can do and help people
figure out what they
could do with the example
in metaclasses that come with the fork.
It really was a success, so,
I wish you all the best of luck with that.
Thank you.
(audience applauding)</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>