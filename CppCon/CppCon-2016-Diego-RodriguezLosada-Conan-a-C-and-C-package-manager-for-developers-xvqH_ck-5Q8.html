<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2016: Diego Rodriguez-Losada “Conan, a C and C++ package manager for developers&quot; | Coder Coacher - Coaching Coders</title><meta content="CppCon 2016: Diego Rodriguez-Losada “Conan, a C and C++ package manager for developers&quot; - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CppCon 2016: Diego Rodriguez-Losada “Conan, a C and C++ package manager for developers&quot;</b></h2><h5 class="post__date">2016-10-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xvqH_ck-5Q8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello good afternoon thanks very much
for coming especially with so many
tracks in parallel so interesting so it
really means a lot
I'm Diego and I'm going to make a
demonstration of Conan if you expected
this I'm sorry I'm not taking off my
t-shirt
so actually I'm going to make a demo
about Conan Puckett's manager ok it is a
free and open source mighty licenses for
man 18 c and c++ packages as i told you
is going to be a demo I have many slides
here but I'm not going to use them I
will share with you so you will have to
review things and ask questions but I'm
going to do it live so I'm going to
start with an example here I have a
folder with three files the first one is
the source file that has some includes
two poco library also to boost I'm going
to use Papa threads and I'm going to use
boost radix as you can see in the main
function I'm using both the poco threads
and I mean using the boost rate except
to do different things so here is my
source code very simple what do I need
with Conan I'm going to write a Conan
file acronym file has three sections in
this case first I declare my
dependencies they are going to be boost
and they're going to be poco then I'm
going to say that I want to build it
with CMake so in the generator sections
I define its email id you'll see a file
that is going to generate and then I
also can define some some options in
this case I want to use both boost and
poco as static libraries this is how I
need I'm going to move to the build
folder it's a just a temporary folder I
can't move so I'm going to just make
sure everything is clear and I'm going
to issue an easel comment over the
column file
really fast of course I'm cheating the
the packages are already cashed in my
machine I didn't want to trust the the
wifey Wi-Fi here is very unreliable so
they are cached but otherwise you will
have a download for a few minutes to
download the packages ok so that's all
as you can see I have four packages
there boost Paco and also open a cell
and simply because boost and Paco
depends transitively on them ok I can in
fact expect my my full dependency tree I
can issue a quarantine for quarantine
for common and I will check that my
project requires Popham boost and then
boost require is recalled by the project
and requires internet leap so I can
navigate the the full dependency tree
upstream and downstream and I also get
some basic meta information like the
remote for example I can see that the
the place I got the boost packages was
from the Quran dot io server I could get
it from other service too so as you can
see also I have the safely package here
that is required by both by by open SSL
and by boost package ok so the canonical
common as generated to file for me I'm
going to spec just the C make one
it is very large but it's very simple it
has just a set of variables see maker
variables that define the typical things
for example defines the folder in which
the booze packet leaves it defines the
include folder for booze the library
folder for boost it will define the
libraries for boost all the names for
the libraries and it will also declare
for example here we can see that is
declaring some defines for example III I
said to use the static library it is
defined Bush uses that Eclipse because
the consumer of the project needs to use
these defined to actually link with the
static boost this file will be the same
for the poker library the set web
library they open instances library
define many variables I can use these
variables assets but I also have some
macros so does micros here are just
until even macros I will see I will show
you how can can we use it so now I want
to build my project I'm going to show
you the main simit list for building the
project it is a typical see make with my
targets my in this case I'm just an
executive all and I'm introducing just
four lines included the file I've just
so you could with the variables okay if
I want to set up everything
automatically I can use the kana basic
setup macro and it will do everything
for me otherwise I can just use the
variables and define the include
directories and everything like I want
okay I could I could also define my my
seeming targets if I want to most is I
felt it was fine for the user because
for example define boost still works so
I can use the variables obtained with a
fine package about boost so the rest of
my
seemeth file will be exactly the same
using regular boost is told by my my
mention in the machine or using column
which you can switch them just by by if
they cannot believe for see made file is
this or it doesn't exist so I'm going to
show you I'm going to
studio 14 64 bytes so I'm configuring my
project right now so the bit is slow
because I mean windows to make it's a
bit slow for configuring projects and
now I'm going to build my application
now I can run it very simple so to be
clear I'm in Windows this is a Windows
machine and I've installed boost local
open SSL and safely and use it in my
project
this is okay so what happens you you
have seen that I I'm using the windows
64 architecture
what happens if now I want to use a
32-bit Saka architecture so I'm going to
install the binaries let's promote
remove everything just in case install
so now I'm going to define an
architecture for 32 bits so I get now
different binaries the process will be
the same I just have to define that I'm
not using the 64 architecture anymore
for C make
and I can kneel again my application now
this executable is a 32 bit sexy devil
and is linking again against blue spoke
up and says lol said lip build with 32
bits architecture - we can expect what
we have in our local cache in our
computer there are some packages there I
can actually check for example that
details for this one so I fight the
current search for this package I can
see that have two binaries for this
package one is using the 32 bits
architecture and the other one is using
the 64 bits architect okay every package
you can see that it has an ID this ID is
ISA has it says how one has of all the
settings and all the options for the
package so if you change the settings
and you use a different compiler version
it will generate a different binary if
you change the option you are using the
dynamic library it will have a different
hash of the old so it will generate a
written binary too so in this way you
can have so many binaries I don't know
any any number do you want to to build
in your in your system okay so what
happens if I don't I'm not a Simic user
question over there and the the updates
are not supposed to break I bi
compatibility so actually the settings
has to be defined that they changed and
the house is different when the ABI is
income incompatible otherwise it should
generate the same class and the same
binary for for compatible settings so I
can always and now I'm using binaries if
at some point I want just to to build
from sources I can specify built from
sources everything I can specify build
from sources boost in
this case for example I'm not going to
do it because it can take a wallet as
you know it as you know but what happens
if I don't want to you see making my
product I mean isn't just business to
you okay
so let's change the current file and now
I'm going to use this story actually I'm
defining two generators I'm defining
visuals to each generator and you
complete me for being generator let's
say save the file and run con install
again okay now I have two files not
sorry I have one visual file here is the
props the property files this is a
property file for visual studio I can
open my ID I can import this file and
this part will have all the definitions
for linking with boost with Paco and
everything so I can directly work with
Visual Studio
no no streaming at all necessary and
also we can expect the it is hidden
that's the reason it has generated also
a file for vim you complete me so if you
are working with a beam it will load
this file and you will get out of
completion for boost and all the
libraries to depend on so this is more
or less the the way I use a package or
use a set of packages okay how is the
perspective for building packages okay
so if we want to create a package we
need a condom file Python file yeah
sorry I didn't get it
yeah the Python pipe for you complete me
is what you know about my corner yeah
Conant has many generators for premade
4c make for GCC for you complete me and
you can create new generators generators
just install things and with all the
information it has from the include
directories the libraries and everything
it can do whatever you want it can
generate a file with your configuration
with your build script with so it can
match any build system you want yeah we
the system color as an API that you can
access all the information and generate
a file so writing I do a new generator
for a nubile system can take maybe one
afternoon so I'm going to show you now
I'm going to create a package for a
simple hello library yeah so I'm going
to show you what I need I need a this is
a recipe this is a recipe to build a
package it is a Python script ok first I
have the meta information for the
package I have the name I have the
version I have the license for example
and then I have two things I have the
settings and the objects the settings
are defined by the user okay so the user
will define that he is using visual
studio such person whatever the object
is something that can be defaulted by
the by the package in this case this
package is defaulting to build a static
library this can be changed but it can
say Terry is going to be to be the
static library by default okay now we
have two ways to get sources okay the
first one is the one I used most and the
one I like is to get the sources from
elsewhere you will use the source method
and in the source method you will have a
git clone you will have a download from
source port or whatever and you will get
sources from somewhere else I didn't
want to use it now because the Internet
of the inter consume you seen the other
approach the
approach is using the internal code so
I'm here declaring exports equal and a
source folder this is what is doing is
getting the source code from the folder
and doing a snapshot and it's capturing
the source code and story in the source
code in the package recipe so the packet
recipe is totally full contain when it
has to build the binaries it will get
the sources from itself it doesn't have
to to fetch the sources from elsewhere
okay so are two different approaches and
then the rest of the recipe is quite a
straightforward you can use any build
system you want for example they open it
and so packet we we saw it is built in
Windows with peril okay so it is not
necessary to use teammate in this case
this package this library is using see
make so I'm going to use to make and I
define my project and I defined my build
and then I got my artifacts then I have
the package path of the package meter
just strike the artifacts in this case
the header libraries the header file
sorry and the libraries the static
libraries or dynamic libraries for
example it is taxed yes structs those
artifacts and put them in a package
folder what is the package binary itself
and finally I have a package information
method this method is similar to the PC
files in Linux
it declares for the end consumer some
things for example in this case it is
defined that my library is called hello
why because in this way the end consumer
doesn't have to figure out the name of
the library for example is typical in
Windows to add their D suffix to the
library so here the package creator can
say ok if I am in the bloody but I'm the
name of the library will be this one so
the end consumer doesn't have to figure
out it will get just the names by
default so this is the recipe I I need
the first step this is in my user space
so if I want to use it as a package I
have to explore I have to put here in my
local cache this is done with the export
common with my username and a channel
okay so now it is in the
- you can see it is here it is a package
and I can use it I can it is exactly the
same as I use the post and popular
everything in my machine no need to
upload anywhere the package I can test
develop and create packages in my
machine absolutely offline if I search
for the binaries there is still no no
binaries for this package okay so how
can I test if I in my recipes time it is
right it is working so if I want to test
it the way would be to create a project
like the boost project use a current
file required and just try it okay
instead of having this in a separate
project there is a utility it's called a
test package so in the test package you
can embed such a test such a project
consuming the recipe in the same recipe
itself so we have the test package here
with basically features sort source file
with an application that is using the
package I want to test and it also
contains a current file this current
file is not the package it doesn't have
a name it doesn't have a version it just
has the bill instructions how to build
my test application and especially it
has a test function this test function
will launch the application to actually
test this working and it has linked it
properly and it's working properly
so the test package is nothing but a
wrapper around corner export cone
install create the project build the
project
I'm testing everything together this is
really useful for continuous integration
so for example when we want to to create
hundreds of packages for boost we just
upload this recipe to github Travis and
abettor will fetch it and we'll we'll
load test packages for many
configurations it's very easy you can
see here it first got the package build
the package then build the example
project linking with the package and
then execute the example project and
this is the result of a sample project
itself now I can check they have a F a
binary for this package because it has
been built and I can repeat for example
for 32 bits and it's going to be to do
exactly the same it will now create the
binary for the packet for 32 bits
it will run my test applica will build
my test application with 32 bit bits
links with the package and execute the
test again and now you can see I have
two packages okay so all of all of this
was absolutely local in my machine now I
want to share I want to share my recipes
and I want to serve my binaries with the
rest of the team or with the rest of the
world the first thing we have to know is
that economies decentralized it's
exactly the same escape ok so it
includes also in the MIT project icon
and server icon example you can run in
your network behind the firewall and
premises is and is a cc it's just
launching a server now I'm running a
remote it is my machine but it could be
as well ok so as I said is good
lifestyle
so I can use my remotes for Conan now I
had just one remote is the corridor is
the way I'm guarding the most packages
but I'm going to add a remote I'm going
to call you local and it's going to
point to my local host okay now I have
two remotes I could upload my hello
package right now but I'm trying to do
something more interesting to to solve
the real utility for up for this I'm
going back to my previous project the
boost one you remember here safely was
got from the Conan Doyle server ok I'm
going to upload this this package to my
to my local remote so what I'm going to
do is Conan upload the package to my
local remote I've just added and I'm
going to specify that I want to upload
everything I could upload just a recipe
so the binaries will have to be built
from sources from my from their
consumers or I can upload everything I
can approve the binaries if the Reinert
is much the requirements for my users
they will get the binaries so they don't
have to build from source of the game
uploading things
as you can see it has upload the recipe
and it has upload to binaries to show
you that it is actually working I'm
going to remove I'm going to remove
safely from my local cache yes if I
execute corner search now safely is not
in my local cache anymore but I can
search in my remote and I will check
that now so babies in my remote okay so
at this point I could repeat I could do
the same for boost for pokin out for
open SSL and upload all those packages
and wineries to my remote in my office
okay then I could I could remove the
condos I Oh totally absolutely and if I
want to get my packages again I will
just specify my remote now it is getting
in sadly from my remote I don't need
Conan Doyle anymore this is totally safe
you can control your binaries you can
note that you are not getting my notes
from the cloud or from whatever and
everything is under your control in your
in your company here now sadly comes
from my remote so time to finish this is
only a very small part of Conan we have
many things of course we have the
typical dependency management ask us
conflict resolution overriding
dependencies for options you can have a
dev dependencies for tests for example
you can create packages for tools like
teammate for example and you can install
several version of Seema can switch
among them there is a full tool for a
building package on the cloud
it's called Conan packets tools and
integrates very well with Travis and
bayar it can even do things like
generate things for rust and for golem
it can make packages forego so does
everything so we ran out of time so
thanks very much
and if there is any question any
question yeah so the question if if we
are using like moderns he make features
like targets for example the question is
the answer is no because we want to
retain compatibility down to see make
2.8 so what we did is to create just
variables with those variables if you
can define create your targets you can
do it actually we there is an open
feature request for having a generator
that can create the targets but so far
we prefer to have down compatibility 2
to 8 that having the coolest features
from Timmy because they still too many
people still are using Gmail 2.8 or even
6 so we at least we wanted to make sure
that it works for everyone up to to 8
yeah and your question
can you speak sorry but I can I can hear
you with a with the son of the of the
room maybe is there a microphone maybe
we don't do cross building
if you is this the question we have a
full the question is for a method target
we manipulate the flags or whatever yeah
so the answer is no we we don't do
anything I mean everything is under the
user control so we have just set those
settings like a hierarchy of settings
like the compiler there are the standard
library different operating systems
different flags and and with those
things you can do whatever you want so
if you want to create your flags
modified your faxed you are responsible
for doing that so the package creator is
the one who defines the flag no it
Kaname is not doing it's not automatic
it's not it's not doing anything
automatically okay thank you I think we
yeah we should finish yeah the next talk
yeah so we are we're running out of time
so thanks very much probably if you have
any other questions I will be here after
the session okay thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>