<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2017: Patrice Roy “Designing A Feature That Doesn't Fit” | Coder Coacher - Coaching Coders</title><meta content="CppCon 2017: Patrice Roy “Designing A Feature That Doesn't Fit” - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CppCon 2017: Patrice Roy “Designing A Feature That Doesn't Fit”</b></h2><h5 class="post__date">2017-10-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iDztwNhIVVM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">- [Patrice] Hello.
(laughs)
How's everyone doing?
- [Audience] Good.
Good.
So, I feel terrible, I've
said so to a number of people,
because I was just at Tony's talk.
And if you were there, you know
that nothing will beat that.
Not this week.
You just saw him for a half hour.
It was tremendous.
So this will be a letdown for those of you
who were in the other room before.
I'm sorry, but it's well meant.
It's also, this is my non-technical year.
I was doing a lot of very
technical stuff last year.
This year is more process
oriented, my stuff.
Yesterday, I had something about
the abstract machine in C++
and what you should look out for.
Today, it's more of an adventure of sorts
with respect to a feature we're
trying, some of us at least,
me included, are trying
to get into the language
that doesn't fit well, but
that's what people really need.
What's interesting is that, in this room,
some people are fighting with me,
and some people are those who
are suspicious of the features
and that's interesting itself.
We'll see where it leaves us.
You will be sad, there will
be no conclusion to this talk.
(laughing)
Because we're still working on this,
so it's a process kind of thing.
How did we get where we are?
What are the needs?
What do we care about?
If you have never brought
a proposal to the standard
and you're wondering how things go,
this will give you one
example of how things go.
Some people do that sometimes.
I was there, did that a few years ago.
If you wanna get proposals in,
what should you do?
So it's more of a case
study than a how-to.
But anyway, it's a bad how to do,
because it's a very weird feature.
So let's see where this leads us.
So for those who have never
seen me, I have a few kids.
I have four daughters.
Somebody ID'ed me yesterday,
but I have two kids
who are of drinking age, which is amazing,
which reminded me that a few years back,
I went to the US with my
dad, who was older than I am,
and they ID'ed me and
then they ID'ed my dad.
So I guess it's all,
so yeah, I have a number of animals.
So because my wife works with animals,
so I have between 15 and 25
cats all the time at home.
And I love them.
And I've been teaching
for a long time now,
so about 20 years.
I'm at my 19th year, to be honest.
And in Cincinnati, I worked
on the C++ standard 17,
among other things.
I come from the flight simulator world.
That's what I used to do
before I started teaching.
Been a while, though.
And among the things that interest me,
in particular, is going
to affect this talk,
is the fact that I work a lot
with video game programmers.
So I've been teaching
and bringing up to date
those who write the triple A video games
in the Montreal area
for the last few years,
about 10 or so.
And their needs brought up part
of what you will see today.
There are some of them in the room too.
So they might react.
So this is an overview.
Working with the standards committee is
seriously a lot of fun,
in a perverse sense.
(laughing)
I really like it.
I spent part of the day
today answering questions.
People think, what does it involve in?
Well, it involves crazy hours.
You get no money out of it.
It just makes no sense, except it's fun.
It's fun if you're into
that kind of stuff.
So we come from all sorts of backgrounds.
We all care deeply about what we do.
We also, people are very bright there,
so they're all right, in a way,
even if they don't agree with
you, and you're still right.
And we all aim to make the language better
for our users, but we have different users
with different needs.
And the needs of the language, sometimes,
somehow conflict with
the needs of the people.
So it's a trade-off kind of thing.
We're trying to make
this kind of strategies
make sense out of this.
We add a direction to the language
that we try to maintain.
It meshes in weird ways,
which is a sense of
the title of this talk.
So what I'm going to try to do is,
well, try to get from user needs to,
not to resolution in this case,
because it's not over.
We're still working on it.
But crudely, the pathway that
lead us towards something
at the very least, which will give you
an idea of how it works in
some cases at the very least.
And a respectful look at what goes on
behind the scenes, because
there are ISO rules.
We don't say what's going on.
We don't name people.
But you'll still get
somewhat of an overview,
and some people will make links
that were referred to cause
they were in the room.
And as I said, there's no resolution
because it's an ongoing process.
We hope for resolution at some point.
So the initial need,
where does it come from?
Yeah. (laughs)
Sometimes we want to add
things to the language.
Sometimes we want to fix or remove things
that we see as broken.
Broken, this is a relative term,
depends on how you see things.
We might disagree.
When we discuss feature
that we want to fix
and remove over meaningless,
some people think that when people
disagree with them, they're all idiots.
It's not true, it's not true.
Bjarne said it this weekend, I think,
that one of the problems
with the committee
is that the good ideas that you bring in
with all the bright people
that get shut down all the time
because they weren't necessarily as good
as you thought at first look.
But sometimes you believe
in it really strongly
or you're carrying the will
or the wants of people,
and you want to convince people
that you're doing something right.
So you're still fighting for it.
So what will follow is kind of
an exchange between me and real members
of the gaming community whose name
you won't see here, really.
It's from a class I gave.
So I'm there, and I'm giving a grade scale
of sorts to people, and
between two projects
about C++11, because that's where
the community is these days.
I know it could be
further, but they're not
because tooling and what have you, time.
So we're discussing the
threading facilities
that they wanted.
So here they are.
And we're talking, and exercises, and fun,
and complaints, because futures
understood the time, what have you.
And then at some point, after a few hours
of pleasure like this, someone says, hey,
so cool, okay, so cool.
So now in my company, we need to fix
the stack size of the
thread that we're running.
We really need that.
We depend on that.
So how do we do this
with these facilities,
which, well, you don't.
You don't, because these kind of things,
in most operating systems I know of,
if not all of them, you have to pick
that at construction time.
And there's no mechanism
in the standard right now
to say such things at that moment.
And so, you look at the blank faces,
and you get answered.
Well, okay, we won't use it,
which I just spent hours working on that
and weeks preparing this stuff.
So, hmm.
This is kind of a let-down.
And say, well, it happens once in a while,
it happens 30 times in the
last three, four years.
It's getting annoying at some point,
because there seems to be a need,
at least some communities.
So the problem statement is, well,
we have people who have needs.
They do multi-threaded stuff a lot.
Now, they might be too low-level
for the kind of work, the kind of APIs
we want to provide.
We want to provide them with cooler stuff.
But the argument is that we'd like
to stick to the low level
for a number of reasons
that are okay in their domain.
And some of them develop them.
They would really like to
use the standard threads.
It fits with what they do.
But given that we're not covering
their needs right now, they cannot.
They would like to.
Some would never use,
I'm sorry for the popup.
Some will never use what
we're providing, also.
Because they don't believe
that standard tools
can be like your preexisting system stuff.
We cannot do anything for that.
We're trying to avoid,
some of us, at least,
are trying to avoid ghettos.
We have ghettos with
the exception committee.
Some people use exceptions,
some people don't.
Those who compile with my exceptions,
they feel let down because they feel
like the language is
not taking care of them.
We're looking for
solutions for these people,
because they're not an
insignificant quantity.
So it would be fun to develop
with the threading stuff
because it's kind of a
big morsel, a big piece.
So we know that operating systems,
they let you fix, most of them, at least,
such parameters as stack size
when you create a thread.
It's an example of something, of course,
because there are other needs.
But this one is talking,
it's an easy one to explain.
You can play with the things
that the standard doesn't cover
once you take the native
handle of your thread
or other such tools,
because you can use that,
if you know what it means,
because it's under-specified a bit,
and that's a good thing in many cases
because we don't want
to let the standard talk
about the metrics of that too much.
But once we have something,
we can make sense out of it.
We can actually call the
facilities and functions
and play with it.
The problem with stack
size is once you've created
your threads, it's too late.
You can't do that anymore.
There's other things, like
priority, blah, blah, blah.
So for these, right now we no solution
because we give the handle once it exists,
and it's over by then.
Now, I had this talk yesterday
about the abstract machine,
which I won't repeat here.
But there's a few things we have to know,
if you were in the room yesterday with me,
let's make it quickly.
So when you're writing
code, you're writing
for a machine that doesn't really exist.
It's an idea.
But it has rules, and
rules are very strict.
And if your vendor is correct,
or nice to you, it's
going to respect the rules
or cheat in ways that are documented.
So these rules give you guarantees.
There's the as-if rule that says,
oh, you will get a binary that's different
from what you wrote, but you won't notice.
A short form of the rule, of course.
And if you're doing undefined behavior,
you know what's going to happen.
You're going to lose
money, your cat will die,
and your parents will
say they don't know you.
So this machine's
interesting to know about
because, well, there are
things that come with it.
So I was discussing with
another prominent member,
but this time we're in the WG21,
and I was telling this person, well,
my users, that's each, the
stack size of the threads,
they want to control that.
So I had this idea, so,
and then people always see things.
And the person, who's a
very prominent member,
says, well, you know, you're trying
to synthesize stack size.
There's no stack in the
abstract machine of C++.
In fact, if you look at the standard
for the word stack, you'll see
one occurrence at some
point for stack unwinding,
because it's talking about exceptions,
and it's a way to express what's going on
when the exception's being thrown
and we're stinking up the place.
And you'll see std stack.
So there's no such thing
as an execution stack
where you pass your
arguments or what have you.
Doesn't exist.
So should we add those words in the text,
there would be unpleasant consequences
because we would be tying the machine
to something that doesn't really need it.
And as he told me a few times,
there's a system for you
have more than one stack
per thread, there are
features like core things
that might not need a stack at all.
So there are things you
don't want to introduce
in the standard cause
it's going to pollute it,
in a sense.
But now there's tension.
There's a feature, we want
to control the stack size.
(laughs) And we can't really express that.
So true, yeah, need to think about it,
which leads us to revisiting
the problem statement,
because there's a mismatch between
the problem that we're trying to fix
and what the committee should do about it.
So they want to control that.
It's a special case of the
general problem, of course.
And there's no such thing
as execution stack in the standard.
So how do you write the words
that carry the need, to some extent,
to a resolution that could be satisfactory
and does not pollute the standard?
So it's a real problem.
We have a real need for a feature.
It doesn't fit.
So yeah, that's pretty
much what I just said.
So I tried that first at the
CppCon 2015 SG14 meeting,
because it was the first time we did that.
You know, hold it!
Very cool.
Lots of people came in.
For most of them, for
many of them, at least,
it was a first ISO meeting experience
because it's an actual formal ISO meeting
with ISO rules.
Tomorrow's gonna be like that too.
And there were a number of
things being discussed there.
I wanted to bring the
problem to the front,
talk to people about it.
So I hacked something
that wouldn't have passed
by any means, but started a discussion.
So wasn't very fast.
And I said, well, let's
add an additional argument
to the constructor saying
that we were able to.
And that's when a member
of the committee told me,
well, no stack, so we can't
talk about stack there.
You're gonna get into trouble.
And wait, you need something
more general, of course.
So we kept the discussion
rolling through email
and other means.
And Vicente, he was not at CppCon
I think this year, who's from Brazil,
works at Nokia if I remember correctly,
wrote the proposal on his
own to address this issue.
It's P0320 in this case.
And that proposal was discussed
in Oulu, where he was.
So and I was called to
participate in the discussion
because I had been
involved with this before.
We'll get back to that.
So we're there and we're talking.
And there's, I think
it was Vicente talking,
but Vicente has broken English.
So you have to imagine weird words there.
So here's the special, a possible way
to actually specify a stack size
without talking about a stack.
So it's a whole thing.
So he described, blah, blah, blah, blah.
And then there's someone who comes in
and says, well, as I was saying earlier,
there are machines where you have
more than one stack per thread.
So how does your proposal
address this thing?
It's a reality, you gotta meet that.
Hmm, so Vicente says, hmm.
Need to think about it.
So how does it work,
when you have something
that you want to get through the process,
get people talking about, discussing,
maybe at some point agreeing
on solution of some kind,
but this is a very rough overview.
It doesn't make justice
to the actual process,
which is more complex.
So you have to have a problem
that you can express to people.
Bjarne was saying that
again yesterday evening,
if you were there.
If you don't have a real problem to solve,
wait for the rest.
I think there's just so much to do,
it's not that we don't like you.
Maybe we don't.
But that's not the point.
The point is there's too much work.
It's volunteer work.
If you don't have an
actual problem to solve
that's gonna help people,
something significant,
there are other problems
that are more pressing.
So you'll never get to develop that.
So, there, yeah.
If there's some add library,
maybe you should go to some
other forum than the standard.
Unless it's a very appropriate feature
for standard library, in which case
you have to convince people.
So yeah, there's only so much time
and so much effort we can
involve any such thing anyway.
And then if you want
people to talk about it,
you have to write a proposal.
Now, some people will
stop there, saying, no.
Writing?
Not code?
Well, maybe code a bit, but
to write a proposal is necessary.
So if you want to get to the point
where we're going to talk about it,
well, if you didn't know
about that, let me tell you.
Do the proposal, do the discussion.
In the standard, people, they cannot deal
with things that have
not been put in writing
and are not being brought
up to the committee
with an actual proposal that
people could read beforehand.
Just, there's no time to do that.
It's not because the
proposals are interesting.
There's just no way to prefer it.
So yeah.
It's volunteer work.
You can float it around first.
Say, if you're not feeling confident
that it's something ready
for standardization,
then float it on the mailing list.
And that's what people,
they're not all nice.
It's going to be a thing.
People will treat you like
an imbecile sometimes,
not because they don't like you.
They don't even know who you are.
They just disagree with
whatever you wrote,
wherever you wrote it, whoever you are,
whatever you are.
There are people who are vicious in there.
And in a sense, it's not a bad thing.
Once you've got this crust
on you, where it bounces.
Because it prepares
you with the arguments,
and that's fine.
Also because they're going to complain
about so many things, well, you can
take that into your proposal,
make it more robust.
Because when you're in
front of the committee,
you don't have much
time to defend yourself.
So yeah, you'll have an idea
of what works, what doesn't.
Float it around, discuss.
I decided to add that this morning.
While we're at it, if
you can actually have
a reference implementation,
sometimes it's cool,
when you can make it.
It shows you can do it, and it shows
you've thought about the trade-offs,
the ways you could do it that would work.
You wrote some code, makes sense to you.
And it's even better if
you have user experience,
like people have actually used that
and gave you feedback.
That's really cool.
When you write a proposal,
sometimes people go overboard
and tell the library implementers,
for example, what to do and how to do it.
The how is a bit too much.
So these library people,
you might not believe it,
but they're actually
very, very, very good.
They're amazingly good, okay?
So if you're telling them
how to do their work,
without knowing how they would do it
and what they have in mind, you're just
getting in the way and blocking them
from doing some really good work.
So express it in terms of what you expect,
what the results you wanna have.
Not the how, the what.
The interface, maybe the
complexity if you know about it,
but let them work.
They're impressively good.
And then, should you get there,
and you can actually come
to a committee meeting
and present it.
Now, it can be intimidating, especially
if it's something tied to evolution
because it's a big crowd,
and they're not nice to one
another when they discuss
in front of you.
(laughing)
And it's not because it's you.
They shut everyone down.
It's like going into an arena
where there's lions, and
people are like &quot;boo&quot;
and trying to kill you,
except in an almost as
enlightened, civilized manner.
There are other forums at the WG21
that are more civilized,
but evolution's a big group.
And when you are there,
it's rock and roll a bit.
But you have to go there or
someone go there for you.
They call them champions.
I've done that before, even,
for something I was sure would not pass.
Sometimes it's interesting to get feedback
and have people around.
But so if you get someone who believes
in what you're doing and
thinks it's a good thing,
even if it's not perfect,
you can get a champion.
So most of us do that from time to time.
Why not?
But it's better if you come there yourself
because you can actually hear people,
see how they react, ask questions,
gather together everything.
And it's also good.
Now, when you're not going to be paid,
probably, to do that.
You're going to pay to work,
to get the feeling of what this is like.
Yeah, and so if you're
sending a proposal out
but you're not coming and
no one's presenting it,
it looks bad.
Like no one cares, and it's a hard sell.
So it's better if
someone takes care of it.
And not because you're bad,
but if no one cares enough to present it,
it's hard to tell people,
&quot;you should really look at it anyway.&quot;
And then you get guidance.
So you'll get, from whichever
group you're talking to,
they will give you feedback.
That's actually pretty cool.
Sometimes it says, &quot;stop
working on that, that's bad.&quot;
But most of the time,
you'll get some orientation
as to where you should direct your thing,
encouragement to continue,
adding to its store,
alternatives to consider,
previous versions you might have missed,
other topics you should look at
because you're entering the
same pitfalls as they did.
There're just many things you can get
from people who have been
there for a long time,
ones with different perspectives,
who ask questions you didn't think about.
It's very worthwhile.
So you get the idea.
It's actually pretty
cool, even if it's a pain.
Because even if you don't
like the ideas, it's useful.
And yeah, so at some point you'll try
to convince the people.
And then you'll get guidance.
That's how it works.
And they might even like you.
To a point.
(laughing)
And they might tell you other stuff.
But that's okay, that's okay.
Sometimes you get up and say, oh,
I didn't need that because
this is way too much work
for the time I have.
Maybe you will skip a meeting or two.
Happens.
They're not dumb, even if
they seem like enemies,
they're not dumb.
They really care about the language.
And if they're giving you guidance,
it's because there's something to do.
It's not to make you waste your time.
And so pay attention.
So you might go back to
write another version
of the same proposal.
So you have R1, R2, R3, R4.
It can go way up. (laughs)
And take the guidance into account.
And sometimes it's very simple things.
It's wording, because it can go through
many groups within the standard
because it's such a long core language,
so memory stuff, concurrency stuff.
So you'll get guidance
from many locations.
That's just normal, it's okay.
And sometimes you might
even want to reconsider
the actual approach in the first place.
Sometimes you took that
from a wrong angle,
and there's no shame, part of the game.
We all go through that, even
the well-known people do that.
Sometimes you get very
far and get shut down
because there is a deep problem within it,
and you have to accept it.
And in the end, you heard this week,
if you didn't know about it,
that some of the problems
have been there for decades,
and they're big ones.
Well, you could continue, you could stop.
You could encourage yourself,
and there's something
else that comes along
that just fits in better,
and it might make your stuff obsolete,
and you wasted years of your time.
(laughing)
But you learned stuff along
the way, so that's cool.
These are different revolutions.
You're laughing.
You wouldn't laugh. (laughs)
So that's where we are with this one.
There are concepts that
have been there forever.
Everyone needs it, everyone wants it.
What's the if, that's a problem.
So we stated that thing in 2015.
We had an official meeting.
That's cool, there was useful feedback
because we have a great community.
It's the people in this place
at this time are awesome.
And we got many directions.
It was very interesting.
We started working with that.
Vicente did, I did, others did.
And so Vicente took a stab, 2016,
we were in Oulu, we were working on that.
We're discussing things.
We're getting other feedback.
So you can read the paper
if you want, of course.
It's from a little something
called thread attributes.
So the idea was, let's
make a class of something
where we know it exists, it has a name,
but we don't really say what's in it.
(laughing)
It's a blank box.
Let's just say there's a
certain word we put in there,
but let's encourage it
very strongly to be queried
with ones another.
Add to the namespace level,
we may hear something,
like you knew something,
admitted to something,
or what have you.
Something that makes sense together
that avoids an if-if soup of kinds
and if we're given stuff.
And there was something
that went with that
called get-attribute that would let people
query at runtime what would actually
be associated in terms of behavior
with individual threads.
So it wasn't shut down.
It's a good hybrid, you know.
There's a standard type, which
we know almost nothing about.
But we expect it to be useful.
So yeah, it's clever.
It's clever.
So we can try to get
vendors to get something.
We don't have tools to
fight in the standard
that's gonna work.
People are gonna be happy.
It's good.
And so the guy that ran SG1,
I'm of course, there are a few people
in the room right now, it was
much more complex than that.
But it's a continued story.
There are edge cases you
need to take care of,
but it's not a bad solution,
something that requires more thought.
Okay, why not?
So Vicente goes back.
We talked a bit.
He says, oh, you have an accent.
You must speak French.
Yeah, I do.
So that's what we did.
So we went back and
worked on the R1 thing,
as you can see there.
And Billy Baker was in the room.
Arthur was doing a talk before me,
and myself worked on the
complimentary proposal,
both of which I championed at Issaquah.
So my own proposal and
the one from Vicente
because he couldn't go there.
And there's a typo there in the middle,
that's link slash.
I'll fix that later on.
So why two proposals?
Because there's two things there.
Vicente was worried about the features
to support when you construct your thread
and a way to specify that,
which is the core problem
in the first place.
But there's also the problem
of reporting failures.
So if you're asking for
something that makes no sense,
or cannot be performed by the platform,
you're gonna need to know at some point.
The two proposals were
not really interdependent.
But the true attributes were used
or something like it in the factory thing
that I'm presenting.
And the factory thing
could use something else,
but it kind of meshed together.
There was a way to promote
them all together, in a sense.
A thread attribute-aware constructor
is a constructor, so it shouldn't fail.
There's no real way, or
from terminating, of course,
which is a good by this.
But works in some cases.
I know because I am aware of that.
You're probably going
to report your problem
through an exception in such a case.
Now you have to know
that the gaming community
is part of the ghetto I was talking about
earlier on today, and they
will not use exceptions,
even if they're faster than anything else
they could muster, because
they couldn't care less.
So if we stopped at this at a task,
we would set up our problem system.
We would have a feature
that the expected user base
wouldn't be touching
with a mild-length pole,
which would be sad given
the collective effort
involved in that.
Now, so that's it.
So if you do a good feature
but your users don't care,
you're not well off.
So the other one, the
accompanying proposal
was factory function such that
we could report the problem otherwise,
an option rule or something.
Something that would tell you,
well, didn't work, dang it.
But there was no exception involved
in telling you about it.
So at least you can use it
in your own code should
you care for other stuff.
We didn't go into detail
as to what we would return.
Well, it was beside the
point at that point,
so expected, maybe should
we have one at some point,
and I'm shown a tuple or feature
that passed or did not pass,
and see if you want complete diagnostics
as to ask for this, this, this, this.
I got three out of four,
do I keep it up anyway?
Was it sufficient, whatever.
It didn't preclude thread
attributes-aware constructors.
You could have both.
Some people care about exceptions.
Not that community, but others do.
So why not?
Thank you.
I'm gonna be fine.
Yeah.
So there was room for both.
Both were discussed in Issaquah.
So you have to remember that the Issaquah,
you probably don't know about that,
but the Issaquah meeting
was during the week
where there was the presidential election
in the United States.
And Leonard Cohen died, it
was a very strange week.
It was very awkward and all.
That meeting was one of the last days.
It was very interesting.
The SG1 people, some of them really liked
the idea of the factory functions.
Some of them were very
reluctant to use that,
for many reasons.
One of these, which is
very easy to understand
if you think about it,
is that there's direction
to what SG1 does.
And one of the important
directions is executors,
these important objects that describe
the way some computations
will be performed,
will be useful in a number of cases.
But they're not there yet.
They're coming.
We want them.
They're going to be used in many cases.
But they're in the future
as of this speaking.
And the other problem is that the users
are gonna need it today.
(upbeat music playing)
Someone's using music.
So one of the things
that pre-provide people
in the room were, well,
is this thing in tune
with where we're going,
which is totally legitimate.
It's very interesting, really.
I wanted to be there.
Even if you're getting resistance
for something that you
think is right and useful,
the comments from the people in the room,
they're all extremely bright
and very enlightening.
So even if you get shut
down, it's cool to be there.
We got guidance.
And the guidance wasn't &quot;stop.&quot;
It was &quot;explore,&quot; which is good guidance.
Certainly it was painful to get,
also because it's for use of.
So as for make-thread function,
because some people really liked that,
doing thread attributes.
And so check the design,
check what it would look like,
use cases, how you could count things,
how it would react.
Examine the return types,
and we did hear a bit.
Cache implementation, maybe, to see
whether it's involved, not
tell people how to do it,
but just give an idea of how
it could be done or something.
And there was something else that I had
slightly mentioned as a passing thought
in the original paper, the 484RO,
was that we could envision, I didn't think
we'd go there, though, the act of creating
a thread using platform specificity,
so create threads or a p
thread create or something,
whatever, p thread create.
Get the needed handle and adopt it
in any p thread.
Now, that's a very interesting add on
for threads that get.
That's a problem, but it's an
avenue that some people like.
So the access check, what
that would entail, too,
so I went outside the room thinking, okay,
worked, yeah, worked, why not?
So we have to check the trade-offs
of the two to see if we could
make it work in both cases,
and what were the pros and the cons.
One of the things they told us was
you should really support
the get-attributes facility
in a way, regardless of whether you picked
one or the other, because it's something
that we think would be useful
in the long term anyway
for the little stuff, knowing things
about the threads that are running.
Should it be a member function
and a member function that
takes an ID, whatever.
There has to be a way to do that.
Okay, so let's see what
you can do with that.
Another thing that they told us was
that even though we
had opened the door for
high granularity diagnostics
with per-feature request error reporting,
so just, shut it down.
Works, fails, simple.
Fair enough, okay.
So that's clear.
And the direction is if you want
better grain stuff, do it our way,
but this stuff that you're doing for,
it works or it doesn't work,
and that's sufficient for us.
Okay.
So it all stayed put for a meeting.
That's something interesting to know.
Sometimes you either
cannot do too many things
because, well, work, money, time.
No, I wasn't going to.
But I didn't have the
time between November
and March meeting to work on that stuff.
I had too much stuff to do.
So it stayed put, and we
worked on other stuff.
That's okay, just part of work.
Part of life.
At Toronto a few months
ago, so very recent,
we brought a revised version
of the factory function
kind of thing, including the case study
that was asked and the adjustments
to the return types, those things.
The error reporting, a short study
of the get-attributes with API.
So me, Billy, Arthur again.
The link there's okay.
So we tried to address the comparison
of a create the thread
in an unstandard way
and adopt it within or do the creation
through some factory mechanism
and see what happens.
There was no update to the
thread attributes proposal,
so it stayed as is.
That's okay too because it's
not essentially dependent,
that would be tricky.
We could use something else.
So the adoption thing
turns out to be very tricky
and very dirty because
one of the things is,
as you can see there, the native handle,
we don't really say what it is.
In fact, I was talking to
some of the Microsoft people
when I was working that
thing, and suddenly,
we don't even know what it is.
(laughs) Should it be the ID, the handle,
what are we doing with that?
It's not specified, really,
just open ground, and we
weren't really expecting
people to use that.
(laughing)
I actually told that to
someone, it's a POSIX thing.
No, it's not.
It's just whatever you
decide to do with it.
Okay, so if we wanted to use
the native handle by creating something
outside of the box and bringing it in,
well, then at least I have to commit
themselves to one or the other.
That's something.
And then the other
problem is in what state
is your thread when you're bringing it
into the machinery of the standard?
Because you created outside,
so is it running, dead, faulty?
Sometimes you can create
but not start right away,
so maybe it's not even started.
There are things like that.
And the other thing, which
is more of a thing to me
because we're trying to
avoid the ghetto again,
is if your users are creating your threads
outside of the box, and it's running,
they already included all the others.
They already went through the effort of
whatever you had to do to
use their platform stuff.
Why would they go back?
What is the point?
And so we're creating our
own ghetto if we do that.
So, in fact, that's the
point I think we're making
in that case.
And the make-thread, we
worked on again a bit,
taking into account the comments we got.
Supporting the get-attributes thing,
providing a kind of possible
reference implementation
to show how it can be done.
We needed that, very good work.
And we expressed a
preference for that approach,
but we're not the ones deciding.
If in the end someone's saying, well,
the first one is very much
better in our perspective,
that's where the language is gonna go.
That's where we need to decide.
So as you can see,
committee work is not just
technical stuff.
There's politics.
There's needs of different individuals.
There's a power play going on because
they're working for companies,
schools, countries, and they want stuff.
They don't all want only one thing.
So there's a consensus
thing that we have to reach.
There's even ethics.
If you're telling people they're dumb,
it doesn't start well.
It works well in the
email stuff sometimes,
but in real life, these
people are actually nice,
and you're kind of here for them,
so then they're dumb?
Eh, they're not interesting as much.
You have to interest people.
I mean, if they're not convinced,
they won't push for it.
And you need push.
We're numerous, and we're by consensus.
If you have a majority vote on something,
and it's a majority by
one, it's not a consensus.
You haven't won anything.
And you have to convince.
And if people don't believe
you, it's not their fault.
It's your job.
If you're not able to convince them,
well, you're going to then struggle.
Work on it.
And you have to listen, of course,
because feedback is important.
And you have to be lucky, sometimes.
Because sometimes you have
to be at the right place
at the right moment in
front of the right person,
that will spill it out.
So in Toronto, we were unlucky.
That happens.
I didn't think we would pass,
because SG1 has quite a schedule.
They have a lot of work to do,
and it's significant work.
But we got called to express this thing
at the very end of the week.
We were the last ones to present.
Now, if you've never been to a meeting,
you have to know that the meetings,
on Monday they start at nine.
The other days, they start at 8:30.
And most of the days, except on Friday,
cause we're all very
tired, they tend to end
at seven in the evening, okay?
So it's not a pleasure cruise.
(laughing)
And it gets worse, sometimes.
In Oulu in 2016, there was no moment
when the sun wasn't
shining, because we were
500 kilometers north of Helsinki.
In June.
So when you're in the library
and you're working on issues,
and it's 7:30 in the evening,
it's still very sunny because
the sun never goes down.
People say, well, let's keep on working.
It's sunny out.
Speaking as the one who
was thinking, &quot;don't&quot;
that evening, I was very tired,
I found that interesting.
So as you can understand that they have
their hands full.
They have a lot of work.
It's a very difficult group.
The questions are deep.
So we were the very last ones.
So still tried to enter, so I did
something like this to
get them interested first,
because we're all tired.
And we got the ball
rolling, started discussing,
and of course it was interesting,
because interesting subject matter,
bright people, and all.
It's going well, and then
the time runs out, you know?
So you're wondering,
what do we do with them?
There's no time left.
And we agree that there's
something to be done about this.
We don't know what yet, because
we have to think about it.
But there's no time left.
And committee work, you have to respect
the time constraints.
And we have to take
breaks at specific moments
because otherwise we'll never stop.
So we all decided that,
well, it's going to be
one of the things we
discuss hopefully early
in Albuquerque in November
because if we rush, I think
we're gonna mess it up.
That's what we said.
So just luck sometimes.
Maybe if I had been
there a few hours before,
it might be solved today,
or might be dead, whatever.
So where are we going with this?
As you can see, it is a complex matter
involving many things,
including technique,
so the plan is to discuss
this in Albuquerque.
If I can be there, I'll be happy.
There's quite a show of issues there.
We don't know whether the
state of the thread-attributes
will be still open, because
it wasn't re-discussed.
It wasn't dead or anything.
Maybe it'll be open, I don't know.
And since we have started discussions
on the make-thread facility
but not finished it,
we don't know where this is going either.
We'll learn about that soon.
I have hopes, of course,
because we fought for that.
And there's surprises that happen.
Now, Michael Wong has started something
with heterogeneous computing related
to his daily job because he's working
on intelligent cars these days.
It's very cool.
So the paper that we saw this by
in the recent SG14 meeting,
SG14 being the policy group.
There was this thing there, D0737,
so the D things, they're under discussion.
They're not a formal proposal yet.
But something about the execution context
of execution agents, that's
the actual name of the thing.
And it defines a minimal
execution context size.
So the thing that says in what state
the execution context is right now.
And there's actually a
thread execution resource
in there that describes
how the thread is behaving
and what it is about.
So that might be, should be,
included at some point.
And the alternatives,
interesting alternatives,
to the thread attributes thing
because it covers the same
subject matter, really.
But it's closer to the executor work
that has the flavor that you want.
So something interesting there.
So it might be the preferred solution,
because it's kind of the same thing.
In some cases.
And the make-thread proposal that we're
trying to push through could use
either of these, really.
Doesn't really care.
So we don't know where
it's going to land us,
but it's a surprise, nice
surprise I would say,
that came into our hands in a month ago.
So that's pretty much where we are.
Is there a conclusion?
Well, there's no conclusion,
as you can see now.
But the process is interesting,
which is why I suggested this talk.
There's lots of factors involved.
And I've been at this for three years now.
And sometimes I certainly
see how things work.
So I thought I'd share that with you guys.
On the design side, well,
as a reminder, you have to
understand what you're doing.
Describe use cases, because otherwise
you will convince nobody.
And you have to have a solution
that fits with the rest, even
if the problem case doesn't.
And it's tricky, as you can see.
Error reporting, in this specific case,
needs official ending because our users
won't use just anything.
They're special.
And I'm thinking of
value of possible APIs.
There's many things you can do.
They're not all easy.
There are costs.
If you have a get thread attributes
that takes an ID as argument,
you have to store the data somewhere
outside of the thread.
There's something to do about that.
It's worthwhile to write
potential user code,
see what it would look like.
I mean, there is some
stuff that I wouldn't
use myself, so I wouldn't propose it.
And if you have many possible use cases,
you have to compare them and make sense
out of them and pick some.
And there are painful bits.
Sometimes you can end up
with the implementation
specific stuff that are parameters
and the abstract machine.
You can have risks of undefined behavior.
In the adoption case, it's a real risk.
The diagnostics thing was a problem.
And even if you're just sticking
with the let's make a new constructor
or add arguments, you're changing
sometimes signatures in unforeseen ways.
That's nice then in simple
code, you make it more complex.
So it's never easy.
So you're never designing in isolation.
There are so many other things
that you have to take into account.
I'm almost done.
And the standard is something
we have to care for.
So it's not a thing that you can damage.
And never as easy as people think.
People complain that
standard work is too slow.
Well, you know, it's slow
because we take care.
So on the human side,
there's lots of work.
Lots of people.
Often teamwork, but I'm lucky because
I have great co-authors
and great human beings.
I'm really, really lucky.
It requires patience, humility,
because you'll always be
wrong in someone's eyes.
And they're always right.
And yeah, as Bjarne said, your good ideas
are not as good when you
express them in writing
as they were in your head.
And looking at work, I think
said that a few years back,
I think when he won these awards.
He was saying that, you know,
a fun accessory, it's not fights.
Let's not just pretend you're not
in the scientific world, you're adulated.
So the process is a pain, it's slow.
But it makes things better.
So we care, not we cares, I'm sorry.
So the real conclusion
is, yeah, to be continued.
I hope it was interesting.
(applause)
You can take a shot at it if you want.
(person talking quietly)
Why did Johns Berg arrive?
(person talking quietly)
So Mister Catto says, what if you want
to parameterize such a thing as async
for parallel algorithms?
I would need to study that question
in more detail to have an answer, really.
But if you write it and
examine the design issues,
you might have the answer yourself.
Or re-examine the considerations
and get new surprises talking to people
that have thought about
it more than we have.
Right, that person will
check it out after.
Yeah?
- [Man] All right, I'll be doing
the microphone thing.
Good guy.
- [Man] (laughs) So you mentioned
that most people don't get to the part
where they write a proposal
when they have an idea.
And you also mentioned
that the first thing
you do when you have a proposal
is show it to evolution, where it is
a wild and toxic environment.
Don't you see a link there?
(laughing)
There's not only evolution, okay?
So evolution is a big
group, interesting to see.
There's core, there's library,
library evolution,
there's many things there.
And there's the study groups also.
And the same proposal can
go through many of these,
depending on the bits
and pieces you're doing.
So new feature and new keyword,
evolution's gonna take a look at it.
If you're getting to nitty gritty
of how things work, you're
gonna end up in core.
Completely different experience.
You're in core, nobody talks to you.
There's no sound.
And every time someone speaks, it's scary.
(laughing)
I totally agree.
It's much less intimidating to some people
to live through that
fear than being shut down
in evolution.
But first, if you float
it around on the internet
and you get reaction from people,
you might be better prepared
for actual committee work
because most of the basic problems
will have been discovered by other people.
- [Man] All right, thank you.
Anything else, by anyone else?
Yep!
- [Man] There's another
feature that doesn't fit.
No, no, please, no. (laughs)
(man talking quietly)
Call cc, yeah, that's another edge thing.
Yeah, if you want to work on it,
are you the one who's
proposed the call cc thing?
I've seen it pass by a few times.
This is some kind of effort.
And should someone care about it enough
to bring it along the
way through the process,
maybe it will pass.
But it might pass through a number
of transformations before
we end up with a good fit.
And it's fine, it's fine.
- [Man] It's closely
related to the proposal.
(man talking quietly)
There's a paper that's
about those core routines.
Yeah, the stateful and the
stateless core routines.
- [Man] Yeah, but there's
definitely movement
happening on that stage.
So Jeffrey is on his one most of the time,
so should have questions,
you can actually talk to him.
Anything else?
It's better if you go
to microphone, though,
because they're going to encourage you
and find your voice so beautiful
on the internet afterwards.
And when people will
complain about my voice,
because I do that, well,
they'll have your soothing voice.
Yep?
- [Man] What would you say is the minimum
to write a proposal?
You'll see that on the ISO
CCP website, isocpp.org.
There's a how to write
proposal kind of thing there
that will guide you.
There's a number of formats we support.
Not that many, I think we
have a form of markdown,
we have HTML and PDF, essentially.
But there's things to put in there.
You'll have guidelines.
- [Man] I did read
that, but it's more like
what do you feel is
needed, like do you think
it's really needed to
get into the public forum
for the feedback on new papers?
Or do you feel that you can bypass that
and just send it?
Okay, I haven't gone
through forums with mine
because I knew there was a need
because it came from an actual big group
of significant users.
So I felt confident to go
out there and fight for it.
And there were others on the committee
who had experiences similar to mine
from other domains, so we
knew it wasn't a game thing.
It was more.
If it's your first
proposal, it's interesting
to fight for it a bit before
because if you come to the committee,
unknown person, unknown quantity,
never done that before,
the steps are very high.
- [Man] So it depends on the subject?
The fight will iron it out a bit.
- [Man] Yeah, okay.
But that's unpleasant.
- [Man] Yeah, I guess.
You have to be ready.
As long as you know, yeah.
And as long as you remember
it's not about you.
Anything else?
Have a nice end of this week.
(applause)</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>