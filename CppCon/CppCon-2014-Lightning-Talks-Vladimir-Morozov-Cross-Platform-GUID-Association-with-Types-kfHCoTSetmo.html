<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2014: Lightning Talks - Vladimir Morozov &quot;Cross Platform GUID Association with Types&quot; | Coder Coacher - Coaching Coders</title><meta content="CppCon 2014: Lightning Talks - Vladimir Morozov &quot;Cross Platform GUID Association with Types&quot; - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CppCon 2014: Lightning Talks - Vladimir Morozov &quot;Cross Platform GUID Association with Types&quot;</b></h2><h5 class="post__date">2014-10-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/kfHCoTSetmo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well had arere is going to show shares
experience implementing cross-platform
gooood support in Microsoft Office
because he's a developer in the
Microsoft Office core experience team
okay just for me you can get idea that
how many people still use Chrome enjoy
code okay so I guess you're using goods
so in our office codebase we take we use
still continue to use Chrome and then we
talk about so why we're using comma in
the first place and we want to use kind
of implement this unknown query
interface many places and mostly because
in our office codebase we don't use of
DTI so using I know I known query
interface is kind of very
well-established way to to do them then
I'm cast and and as you know like visual
studio supports come from many many
years we have all these different
facilities like how to declare good in
for Chrome how to access it using this
special grater
yueji off but for some reason go is not
supported in standard C++ so when when
our team moved to come and decide we
want to share the same codebase across
multiple platforms who want to have the
same office code like majority of our
share of is called work on Android
platform work on iOS platform the
question was like how we do goods and I
pretty much I was not the first person
who come up with this idea but tinkly is
what I saw in our code and I I actually
expanded markers so tinkly yes
definitely I call this code you will see
typically it hidden behind markers but
main idea is like you have interface
using the visual studio construct called
echo spec to define your good and some
well below you need to people typically
have some kind of template and have
template specialization and specify for
this given type I would like to have a
certain good but we know like our
template specialization
must happen in same namespace where
template is defined so if you type
happen to be in special namespace
what these people may do like they just
simply saying I would like to
closed namespace first kind of global
namespace opening space again
the other solution will be like this GUI
just simply go to a different file
altogether but in the end you have
faculty code application right you have
the same stuff written multiple places
in one case you have you good written as
a string and another case you have just
a bunch of form I can't read these
numbers it really kind of bites I ain't
no human readable I really want my good
to be kind of string ways to sapphic
this so this is what I felt about this
code it's really kind of big and hairy
so the question is can we do better like
I saw this code and it was we can't
really can we do something different and
I'm coming from kind of many years of
five C sharp development and this pretty
much what I want to do and if
effectively this code compiles in
visuals to you C++ because visuals to
C++ has support for middle interfaces
but the pattern is the same middle thing
syntax you can use for your types it's
going to great idea but don't use it
because what happened what we found that
it's a big difference between if you
using this attribute versus vehicle spec
this attribute to increase your instance
size by extra pointer and looking this
point is just zeros I don't know I found
the black visual students still didn't
fix it but just don't use it anyway it's
not standard it will be creative
standard that adopts it at some point it
just doesn't work this way so what we
can do how we can still be kind of
psychic with this but that we can
implement today so micro to the rescue
I know some people don't like markers
but I believe markers the tool as any
tool you can help you can overuse it
like you can have a camera you can smash
your finger or you can kind of put nail
to the deck right so it's a tool and I
think this is a great tool in in this
context and I believe this is how
markers should look like
I changed names a little bit in reality
it will be like a mess sauce
but just for the sake of this
presentation I believe this would it
might look like so what's important to
notice here like if you see a wonderful
approaches see sometimes people do
they're just heavy smoker and have in
service markers they have type and we
have good and ethically is a high
destructive class inside of the smoker
what we found is not good idea because
you have bunch of different tools say
like Visual Studio or sublime the editor
or inside of Microsoft we have special
kind of research tool to index all your
source code and if you put your class
name inside of marker you can't find
your class you can't simply say I'm
looking for struck blah or struck struck
fool so it would simply not able to find
so we would like to have explicit
keyword struct or class to be kind of
separated like to be kind of so it can
be easily found without any facts to
your tools which use for index in your
code and but unfortunately we in this
case marker to define good we need to
become specific as a strap to class
because in visual c++ a struct or class
is actually part of a bi so thankfully
even according to standard struct in
class interchangeable but in visual
studio if you do that and say in one
case you doing four declaration class
and of that you really say instruct you
will have warning level one warning
because it just doesn't work it works
probably probably fine in client in any
other kind of standard compliant
compilers
so in reality we need to have two
markers struck good and close good so
this is I believe much better so how
implement this macro visual C++ this
trivial we just simply kind of say in
this Marcus just the same deco spec
vehicle spec what we found this has very
nice property even you have like for a
declaration of the class declaration of
your class or kind of regulation of
class you can put this deck respect
anywhere and Visual Studio C++ will
still picked up and do the right thing
so it's totally table implementation not
interesting clamp so yes we I think we
chose just use client for all other
comes except windows so there are two
different techniques we apply here first
of all in C++ 11 we can simply take a
string and have a constellation function
to convert string to do it another thing
what we do we pretty much just simply
saying be strap itself it will be
nothing more just a function definition
like special cons expression function
which will take our good and return it
for a given type and if you see so thank
you even with this marker does we have a
four declaration for our struct we say
this external C++ why because say look
at some middle generated header files
and you often find you have the
interface declaration people put around
this external sea so the technically
saying this is C type so if you put this
motto inside the first C
context and we can rely on function
overloading and see there's no support
function of volume so you to explicitly
say this function which we declare here
it will be according to C++ code in
: convert conventions so we just use
this function to initialize good field
so in our code we just using
I feel because we need to kind of rely
on some some default implementation for
sure what I have but I believe these
things extrude work we just have
constant expression for where you
initialize it you I do becomes just a
matter which returns are filled from the
good and we also need to think about
case then say you have a Class A and
which it has a good on it and now we
have class be derived from a so if you
just forget for B it actually may return
you kind of do it from the base class so
to avoid this converter tuning good for
the wrong class we need to have default
case and we just want a special template
function which would simply kind of
throw error I didn't specify it here but
typically what we do like we have some
kind of fake template for this type and
just check in size if it size is zero
then it's kind of error because if you
say in like static assert false it would
fail all the time we need to have some
kind of condition depending on type so
any questions you not supposed to read
it but this kind of put how is
conversion from string to goo it looks
like I try different versions I probably
still don't understand how cons
expression work because what I found
like and the debugger even I say constic
expression I still then I run my code
somehow like always installation right
there in my code and if I have a call
with smart budget with if statements
taken different character ranges from an
exception it with something wrong and so
on you're going to produce me a lot of
code i kind of was a little bit
concerned at this in debug mode so thank
Lee I try to implement simplest
algorithm which erring foot does just
takes a character Maps it Maps it to its
decimal number and just forms a good
call to them so just repeat we have
string to do it as a just consecration
to convert we have get good method
and we also found some few issues I
don't know how it can be important in
your case but just decide to put them in
the slides it works only for C++ level
because we rely on cons expressions if
your code still somewhere using C++ 98
or C this code will not work and the
also fans are very interesting
situations and people use sometimes with
UID off inside afar there's a template
parameter it didn't really works but we
can actually do very simple workaround
just factory define special resolve good
PR struggling about specialization if
for example this PTR is now not now so
we can actually do it Jone just
different things but again it was
indicate specific linker error if the
same code works just fine on is or like
mark it's just something like seems like
NDK has some kind of eager optimization
just somehow kimye's I saw this code so
what I think we have a pretty good
solution for this cross-platform story
for goods but I think the similar
technique can be applied for any type of
other custom templates which you may
have in your code so imagine that today
is pretty easy you can have just kind of
some type source of shade before
yo types and you can do all this
different interesting and template magic
but what if you want to associate on
some values will calculate something
along the lines so a similar technique
can be applied here you just define some
kind of marker marker it will be
expanded to function and you have just
some kind of special type type traits to
access this value you just initialize
this value from this function have some
default case and you don't thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>