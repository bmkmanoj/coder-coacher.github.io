<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2016: Steven Breitstein “BDE Libraries, An Orientation&quot; | Coder Coacher - Coaching Coders</title><meta content="CppCon 2016: Steven Breitstein “BDE Libraries, An Orientation&quot; - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CppCon 2016: Steven Breitstein “BDE Libraries, An Orientation&quot;</b></h2><h5 class="post__date">2016-10-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Iess36CZnPI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well welcome and thank you for
interested in the BD libraries who here
has already seen them at all maybe on
github a little bit some who is familiar
with the works of John Lykos
very good so just get started in case
you haven't heard of Chris well what is
BT
my name is Steve Steve bright Stein I've
been working for John for ten years now
and before that I did other stuff that I
can't remember anymore going on 12
actually so drawing the bde team eleven
and a half years ago this first matter
what is bde or does it stand for and the
answer is we don't really know you will
see written some places Bloomberg
development environments sometimes
you'll see the basic development
environment and some wise guys suggested
that it is the bde development
environment yes if I disregard it means
what it means the term can be applied to
the libraries that we're about to take
examine to the team about 10 to 12
people about average over the last 10
years many many of whom are here today
and and the methodology which was
inspired by John Blake us based on his
book who's read this raise your hand
John
I and and subsequent work talks such as
one that's available through Pearson
called life lessons and several talks
here at CPP caught in the last three
years including one yesterday okay and
further work going into his new book
coming out in current year plus one for
many years now okay
we call these the classes provided by BT
or sometimes call foundation classes
because they are generally not customer
facing code this is code is for building
infrastructure for building
infrastructure several layers up you
finally get to the level where uber
customers are interacting with with the
software you can find it at that github
github link it is currently about nine
hundred documented and tested components
organized into forty seven packages and
five package groups where a package
group its released as a library that we
something we call a unit of release you
are the kind of problem solved by these
libraries tend to be those that are dest
on once for the enterprise such as the
definition of date and time classes
calendar types and utilities operating
on those logging systems I don't know
how many logging systems one typically
has an an enterprise I found many over
lifetimes and different projects I'll
find different you know people are using
three times or four types of loggers
through the same code body
we're trying to resolve that problem we
have one very good lager subject to an
hour talk at least by itself I don't
think other things such as command-line
parsing a great tokenizer almost called
the toka nadir threaten that management
data marshalling networking more things
it was just the highlights that I got
you know I shot it down as I was
perusing the libraries so as you can see
there are many areas of applications
addressed by these libraries they are
all component based that means they are
all levelized welcome there are no
cycles of dependency between these
components
moreover the classes that are
implemented fall into a a system of
classes of class taxonomy which we'll
look at more in the moment they are
abundantly in detailed and consistently
documented
they feature narrow contracts and to
help with the narrow contracts we have
defensive programming features all of
the types that allocate memory are
equipped to accept runtime polymorphic
allocate memory allocators including our
surgeon of the standard library so you
know our vectors our classes our hash
our maps and lists and Springs all our
allocator enabled lastly you'll find
that everything is thoroughly tested
each component has a test driver that
whose responsibility is to prove beyond
all reasonable doubt the component meets
its contracts plus more and these are
published and we invite you to peruse
them
okay so just in case somebody hasn't
been through this before what is a
component it is an example would be be
TLT date that is components whose major
class is date that is implemented in the
BB LT names space and furthermore all
the classes are also uh their further
rap by the bloomberg namespace so that
we can mix with third party code without
fear of collision okay the component
consists of two files an implementation
file the CPP and a header file which the
interfaces and inline implementations
are defined okay
they're always too we have no standalone
dot H files that's it's just simpler
that way
as I said earlier there is a test driver
for this and for every component
components are more than a pair of files
a HC PP there are rules for writing
components specifically one the CPP has
to include the dot H first why is that
anybody yes sure that there are no there
away we do that the H file is
self-sufficient you know that you don't
have any you need no other includes and
basically two and three are saying that
everything related to this class can be
found in the component okay if it's
implemented you'll find it you'll find
the interface for it in the header file
if it's in the header file if it's
defined in the header file it's
implemented here that's not you don't
have to go look anyplace else this this
component handles everything having to
do with the classes furthermore that's
any components it uses are are access
through their header files and
everything
and our clients so this will include
header file so we can examine the header
files and exam adventure manely physical
you know the the physical dependencies
there are no and externus disallowed
yeah because that would be it that would
be a way of accessing accessing
something without having specified a dot
you know said it loudly without it
saying it very loudly and explicitly
through a dot h include there are two
major design roles that there should be
no cyclic dependencies between
components any logical dependencies
between classes have to be within the
component and even then those are
frowned upon having cyclic dependencies
complicates testing and any friendship
between classes has to be contained
within the component questions yes by
review by some tools the physical the
cyclic dependencies are enforced by
tools according to that every you know I
mean every once in a while will find a
problem you know but it's a very rare
it's like you see one of those for a
while so we're usually pretty good about
avoiding them but yes BD verified does
that hmm I encountered otherwise oh and
the question was are there tools to
enforce that thank you for that reminder
yes so now we know what component
components are organized into packages
packages are related components they
have the same of physical they have the
same envelope of dependencies they have
related functionality so that in
addition to dates we will also have a
date/time a date/time date you tell
utilities being operations on dates that
don't really require access to the
innards of dates so if in order to do
something the date if you have if you
can do through the public interface put
in the utility keep dates somewhere and
time and others and as you can see that
they all have a common prefix they all
clear the symbols in the same namespace
and surprise you'll find them all in a
sunder a directory called VD LT and that
says pretty much what I just said
packages are further organized into
package groups so the BDL package group
contains VD LT and others and what
distinguishes a package group is the
first three letters of the package name
so and one consequence of that is that
when you design a package you have to
know where it's going you have to study
you have to know what its dependencies
will be you'll have to know where it's
going to fit into into the overall
software hierarchy so that so that you
know how to name it again those cyclic
dependencies among any of the packages
these define a library so this is
something you'll see on your on your
link line and you have case you were
wondering that's
these suffixes stand for mmm thank you
sir
and this is all that said and lastly now
that we have our libraries what are the
libraries available to you there are
there are these six five rather bowel
which has fairly high level libraries
this is where our we have our logging
system our metric system stack utilities
our time zone systems okay yes we have a
set of utilities that will analyze
stacks the process stacks process facts
sorry I that was a good question and it
is a and it's very useful sometime we'll
see later on we have this is a fairly
small package group it has some business
logic in it it has day counting
conventions something you can imagine
being useful at Bloomberg BDL is a
fairly large package it includes
specialized containers other packages
for encoding and hashing various
utilities on the fundamental types
memory allocators and date and time PDL
t for example the SL Bloomberg standard
library contains our allocator enabled
containers and allocators and whole
suite of utilities and components that
go into building a library which are
available for everyone to use and VT LT
is a package group that is its label not
recommended for use it's something
therefore it's there you'll see it it is
there is a requirement by some other
library nevertheless I've
I've heard that it does have some very
useful components in there for managing
bandwidth so you might want to take a
look at those as I said there are no
cycles between the higher between the
components between the packages or the
package groups this is what the
hierarchy is at the very bottom we have
compilers of linkers then our standard
libraries that more heavier fundamental
libraries and then you could think
consider relatively speaking application
libraries things closer to applications
that's you know and then we it's spread
out now our goal for today is to is to
help you find your way through BDE
the documentation reefs and other
resources that are available to you so
that you can get started to give you a
feel for programming within narrow
contracts and how to engage our
defensive programming techniques and
generally to get you to try to convey to
you the BTE mindset so if you are going
to work with this we want to get you
thinking set your expectations so that
your barriers are barriers to getting
involved in our reduced I should say
that now that this material derives from
training materials that's work that are
used for senior hires at Bloomberg
senior hires of people with several
years of experience have extensive
training on technologies of which they
really can't possibly be familiar prior
to arriving at Bloomberg and one of one
of the things is that they get like 10%
of their time as goes into bde with they
spend time listening to John's lectures
and they go through a you know some
material lab based course this material
has been adapted from that so this is
proven successful for getting people on
board to be a documentation you could
find it at github where you'll find
links to tutorials our coding standard
50-ish pages and not enough detail
there's so many rules that are not there
that are not written down how to
contribute hope you do build
instructions and link to our online
documentation the doxygen pages is
everyone familiar with oxygen okay so
another thing that you'll find there is
a taxonomy of classes because classes
are not just you know or just not
invented on the fly
there are various categories of classes
each having a well defined organization
certain expectations of methods certain
common naming conventions so that when
people design classes they will try to
they'll they will find the appropriate
place for this for example there is a
value semantic class can't even tell me
what that means anybody's been through
John's yeah so class that defines a
value value being a concept that sorry
that's a reserved word an idea that can
be that have can preserve its meaning
across processes and different machines
you know conceptually if you serialize
it and recreate it someplace else and
the meaning has not changed that's
you're probably working with a value
other classes create objects that have
state but no value those are termed
mechanisms okay of a mechanism example
of a mechanism would be something like
memory allocator something that manages
memory in this process something that
manages database connections socket
connections a
a guard that's standing by to destroy an
object on destruction
you know thread pools thank you John
okay utilities are the of the name we
use for components that provide
stateless functions
you know because not everything in C++
is an object and those are actually they
are implemented as the strokes for
pardon with static methods yes the
advantage of that being that there's
only one place where you can define them
name spaces can be open for many and
many places in the code whereas a struct
is only defined in one place and that's
what we want all right and which is the
most important
moving on is also there are also classes
that define protocols which is a term
that basically pure virtual a class that
has pure virtual methods pure no
implementation so something that can't
be instantiated so these are bits of dde
terminology and these
used throughout the documentation and so
the expectation is that when you read
you know that when you're reading them
you know you have expectations about
what each one of these are and we'll
look at some of these in more detail
later here are some examples though
value semantics classes our date day of
week date/time calendar by the way
calendar here means something different
than what you've heard it thrown out
like Renault talked allocators are
mechanisms utilities are utilities by
the way and often they're named util but
not always as you can see there is
something called current time which is
utility that is not named that way okay
if you get to our documentation you'll
find you'll get to a page it looks more
or less like this is that readable
barely all right what people often do is
they will expand you know hit the button
we say expand all and that you search
for things that are of interest to them
here we are do the search for date and
we can see the date is part of the vdl T
group a package and part of the BDL
group the thing thing circled on the
left are all links so for example if you
click on BD L T you'll get a view of
that entire package will list all the
components in it will show the hierarchy
of the components so you have like you
can see over here that this says 24
components having several levels of
physical dependency and so if you wish
to study this package you might want to
start from the bottom on things that
have no dependencies in this package and
then those are building blocks for the
next level on the next level and so
forth okay there's also usage examples
if you click on the link to the
component dock you'll get the component
dock where it will see that there is a
purpose
always a sentence almost always starting
with the word provide we'll have a list
of classes in this case there is one if
there's if there are multiple classes
defined in the component little bit
others will be listed here there might
be there might be other classes the in
the component there might be classes
there might be classes and solely for
implementation okay and there's a
certain naming convention so that people
know not to use those directly but the
simple rule is if you see the class
listed under classes and you're allowed
to use it if you find some other class
in there that you're trying to use and
it changes so you know you don't have
much of a defense if that changes we
have lengthy descriptions that's a link
to get down to class level documentation
this is getting rather rough this is
about as far as we're gonna go here
because it's we find it really hard to
read this as you can see I had to you
know the actual pages are way too big to
pick fit on the screen it's all I had to
this sort of tear up tear it up into
pieces just so that you have enough
there so you can recognize them when you
get to it I find it actually slow it's
hard to look at source code on the
screen it's actually better in this case
and try and look at those generated
pages this is this is where all the doc
comes from it's all embedded in the
header files divided into sections
there's our person first purpose line
again one line and the line can be more
than 79 columns
really yes including the slash slash no
no line of code is more than 79 so it
makes it makes us it's can be
challenging to be expressive in that
small space okay again there's our date
the class that we're allowed to use see
also and the description is self-evident
was also a usage example that typically
have pedagogical asserts that's to say
we don't actually somewhat expect
somebody to be default constructing a
date and then discerning to see that it
was done correctly that's that's just
there to just as a comment this is all
the usage examples are tested one of the
responsibilities of the test driver is
to mechanically reproduce the usage
example and show that it works correctly
okay for each so all that information is
describing the component as a whole
describing if there are several classes
in a component describing the
relationship between those classes per
each class you'll find some additional
documentation typically it reproduces
some of the things said earlier in the
component level but what you'll find
here are you know any invariance for a
class that you should know you know are
are expressed over here some things are
there's are tacitly guaranteed for the
class even though they were not
mentioned in that description so unless
you hear otherwise you can assume that
the methods of the class are cons
threats safety and by that we mean that
if you have multiple threads accessing a
object of the class that is perfectly
safe as long as they restrict their
activities to the cons qualified methods
okay that the methods are exception
agnostic let me define shortly that
things are alias safe if that's
pertinent and this is all true for
backing up for this class even though we
did not say it okay so this is one
example of despite our heavyweight
documentation there are certain things
that are tacitly assumes have to be
known by the root reader these
particular terms are defined by the
glossary and if there are stronger or
weaker guarantees for a particular class
or a particular method those will be
called out fairly emphatically regarding
exceptions exception agnostic is a term
that means several encompasses several
things one thing you get out except
exception agnosticism is the basic
exception safety guarantee that is in
case an exception is thrown it is the
object will be left in a valid state you
have exception neutrality in that if if
exceptions will pass through all methods
without without interference so if one
of our components call something which
calls something is called something
which throws an exception that exception
will not be caught and stopped it will
not be modified it just it just flows
through so you can count on that
and lastly is in sort of an inflammation
implementation detail BBE implements
these this exception safety by using an
RA I like technique we avoid trying
catch blocks we use Proctor's which are
which are guards that have a release
methods and so that this this code works
very well it would depend you can build
it with exceptions or not exceptions it
just works
bedico does not throw exceptions it's
just it's not in our programming model
except where it's required by the
standard so we have implementations of
containers and containers are required
to throw exceptions at certain times and
that is a and so they do such as bad
alec from a memory allocator exceptions
we throw many exceptions in our test
drivers because when we say things our
exception safe it's not because we
looked at it and said hey that looks
safe but we we run tests on that so to
confirm that they are safe and if we
don't throw exceptions where where do
they come from well they could come from
legacy code which other code at
Bloomberg sometimes we have there be de
classes that wrap VD
other Bloomberg methods that could throw
exceptions so anybody depending on them
will get them and also we are some
interfaces where we take user level you
know callbacks that might throw
exception so that's where they come from
lastly we have next next level of
documentation are the function level dot
the documentation for each of the
methods of the class the methods of the
class are usually organized or the
banners you see here we have you know
class methods firsts and static
functions then creators which include
all the constructors and the destructor
manipulators are methods that can change
that will change the may change these
static state of the object accessor is
archives qualified they are guaranteed
not to change the state of the object
always in that order and if you're
navigating our code it's worth
remembering because that's
helps you find your way around there is
a legalistic tone to the documentation
that you find here you know they're very
tert its first nose as it comes after
these methods signature you know ii
assume you read the method you know what
the arguments are you know with the
return type is so we don't have to
repeat that information okay
and there's a certain pattern return
true created date create a date assigned
to lobe into okay so these are always
mm-hmm gentlemen so we have a dead
regular form for writing these writing
this documentation it's always what
first thing we say is what the function
does it's always a verb it's it's done
in the imperative mood as if you the
reader are commanding you know you who
are invoking the method or commanding
the object to do something you will set
or you will load or you will create or
destroy or so forth and the next part
the next thing you will find what the
function returns and in some cases the
two convolve if all the function if all
the method does is return something well
that's what it that's what it does any
other argument optional arguments or any
of your discuss next all other essential
behavior is listed after that and there
we have I urge you to be careful and
Siri what is the actual describes
essential behavior okay it may be
different you know do not rely on
observe behavior sometimes you will say
oh I you know the method the method
didn't say what it does in these
circumstances but I ran some tests and I
found it does X Y or Z so I'll depend on
that okay in that case you will be in
trouble if that changes only the you
know the explicitly listed behaviors is
something you can rely upon next
conditions leading to undefined behavior
so the preconditions for the method and
lastly clarifications note that now the
general note that means that note that
is something that will tell you what is
something pay extra attention to this
here it means the to clarify might be
the better way to say it except we have
you know we have a lot of thought that
says note that so note deaths are not
normative you will not learn anything
new about the contract in the note that
just but it's its opportunity for the
author to try to explain something that
might not have been obvious lastly we
have a convention that the first time a
parameter name is mentioned we introduce
the expression the specified so just
going back for a moment
return true we have the specified year
month and day and and so forth the
specified right hand side date I just so
I take that as a clue to go back and
check you know
shift my eyes up and see what type that
that parameter is questions here you do
not say the specified correct okay
let's go back to look at our
component-level dock again provide a
value semantics type to date the class
is a value semantics date type for this
component defines a value semantics
class does the author of this page
dawn lake owes by the way expect you to
know what a value semantics class is yes
which is why I spend time to discuss
what goes into that briefly
now your semantic types are ones that
represent a value that have regular type
syntax I love Alex Stephan Offutt have a
reasonable operator II have a have a
operator equal equal that compares those
things so those are the characteristics
of value semantics class typically you
will find methods default constructor
value constructor where you can specify
the attributes of the class to bring it
into the state that you want copy
constructors okay no surprises
assignment equal equal equal of course
not equal and getter so setters of
difference though we don't use that
terminology okay you'll also find a
print method for these classes so that
this is there so for debugging purposes
and for testing purposes there has been
that it is it has a rather lengthy
contract which very few people read but
the key key points are that it's going
to print the value in some unspecified
human readable form and it is subject to
change and do not write do not write
parsers for this because it's subject to
change if you want something in a
different format you do that yourself
this is this
prick methods are really not part of the
value class okay there are a million
ways to print a date and the more we
thought of every every everyday we're
not going to encumber the date class
with that mmm top of the day classes to
do to represent a date value and of
course since one of these things
happened to change in the last release
of course there was a true haha about it
and the fact that we you know we pointed
out the contract really didn't didn't
protect us very much all right
so having discussed some of the things
about date as a values of Mantic type
date operator date itself you can
increment the date you can do fancier
with mythic on the date you can compare
dates you can set take values these are
things that are specific to dates there
are other value semantic classes that
are not so complicated they just hold
you know they just hold values and don't
don't provide any operators and if you
go back to the taxonomy you'll find that
they're under values event types their
various sub categories of value of value
semantic values though semantic types
and sometimes those that terminology
will creep into the documentation the
date value itself represents dates in
the range 1 from of year one month one
day one to New Year's Eve of the year
ten thousand except for some days in
1752 when the english-speaking world
switched from the Julian calendar to the
Gregorian calendar which is kind of odd
but that is a POSIX standard there are
there is code there to support proleptic
Gregorian dates you are allowed to use
them we at Bloomberg or not having
having started using the other kind
methods are provided so basically a date
a date is represented by integers you
know year month and day or year day and
year
how do you know which which combinations
of integers you can't put into a class
there are static methods provided to
tell you whether they are valid or not
so just using it The Fault construct a
date what is what years
what is it as folks the full value of a
date somebody pardon a pop no read it
fall construct the date is one one one
year one month one day one okay
okay having a date we can set the year
month and date okay three integers here
month and date be careful of the order
what happens if you do this Americans
like to put the month first 15 minutes
let's go and 20 slides should be good
thank you
so be careful of the order what happens
in this case there is no status it's a
it's a method it's it returns void if I
what's what's the undefined behavior
again you're out of contract thank you
okay though we've yes that'll be really
unexpected okay undefined behavior is
one of the features of bde code okay
there is a there is a class of library
that the library design that's saying
that the user should not be allowed to
make any errors this is not that
if you know that if you're if you know
you're putting a good date there are no
checks if you're if you're not certain
if you want validation which is not
trivial then you use the if valid method
or you can just take the invoke the
static method directly and hopefully you
copy the values back correctly down to
and create your date object date
arithmetic is you can increment you can
change things by you know you can
advance the date bike one day advance it
by three days you can the difference of
dates is an integer value and just FYI
the first lab for this course when you
have a lab is to have everybody you just
calculate how old they are in days it
seems they seem to get a kick out of
that of course they are a lot younger
than I am okay
Borel narrow contracts now narrow
contracts are placed preconditions on
the input parameters our object state we
state those very clearly okay and it's a
very common feature of BDD code if you
don't find any such preconditions that
it's a wide contract you can put in any
values that the parameters
Kanaka can can hold here's an example
highlighted in red created dates you can
use any year month and day behavior is
undefined unless those things we've
returned true by is valid year month and
day oh by the way note that the
convent's strong convention that methods
that return a boolean start with is or
has something like that reads reasonably
well operator plus plus is almost
completely wide calendar you can always
increment the date unless you're on the
last date then is support it so do
try to go past New Year's Eve of the
year 10,000 and of course setting year
month and date will always be bad if
year of day is more than 366 more on
that the moment okay I don't know if you
we have some we have things to help
people but whether or not that is it
might be what he calls a sanitizer there
intensive program might be yes okay all
right anyway key concept preconditions
are met everything at work by contract
we rarely get eight bug reports saying
you do not meet your contract maybe once
a year and that's on like a thousand
components otherwise anything could
happen has been discussed at other
places and other times other talks over
here anything of course you know except
except for the absurd it can change over
the time in our view if you've entered
on undefined behavior entire process is
corrupt
I mean a process a path of execution
that got you into undefined behavior
meant that your program went bad
upstream so this is not something you
try to cover recover from by the way
when anything you say anything can
happen there's a subtle one sometimes it
works as you expected it to work that's
within that's that's that could happen
and that might change someday and people
get very upset okay over here we have a
contract load into the specified year
and day of year the respective year and
day of year attributes of this date does
the contract say year either those
pointers have to be nonzero
could they be 0
okay contract doesn't say anything but
the tacit assumption is that those are
valid pointers they are not zero they're
also not one to twelve you know other
values that are probably not good
addresses they have to be good addresses
in this case they have to be writable
they have to be aligned they have to if
they're pointing to two non fundamental
types you know if they're pointing to an
object there we assume that there if you
give me the address of the string with
your and as soon there's a string there
okay
checking for that is hard yes sir
references are not as safe as people
think they okay can we I'm a little
under a little time pressure can we take
that up off I know what to say I just
don't have time to say it though okay
okay that so so there are tacit
assumptions about pointers and it's too
much to say that every single time so
yeah okay it's easy to slip into
undefined behavior
what's wrong with line one pardon
invalid date but easy to think I mean
three in values and those tend to be
default to zero
yep what's wrong with the second line
under flow yes default construct the
date decremented you didn't see the
method for that but you know
extrapolating from what your so about
plus plus what is wrong with number
three okay
not that many years in the in the entire
calendar not that many days it's not
that large a number if you're if you
have a function that is returning an INT
and that you're gonna be adding it to a
date yeah so it's uh you know you want
to be careful about that and of course
367 is always bad okay what's wrong with
this guy a little book more subtle load
to the specified result the earliest
date of interest between specified first
and last dates inclusive returns zero on
a success and nonzero value otherwise
the behavior is undefined unless first
is less than or equal to last why is the
test wrong vs. equals first it doesn't
work well you write that is bug the bug
I was thinking about was that last could
be it if you were depending upon date
exceeding last for the loop to end
you're going to be in trouble if last is
you know nine nine nine nine one zero
something they will rarely come up but
but they could so you don't want it you
don't want to have to count on the ton
date achieving a value past nine nine
nine twelve thirty one
okay new that day yes okay this is
buggier than I thought in the and the
band the point is is that the that this
is an idiom that is you know people
typically you know we write from this so
you go past your limit and that's what
people reflexively do but it's it could
be bad this you know in this cases also
if you don't meet the prerequisite here
you could possibly get into it think you
get into bad things happen so let's just
go on there
so just commentary on language people
will say that will say things like
validate object and invalidate object
that's really is you know the first one
is redundant the second one is
contradictory
you know if you have a date object you
see what's valid we don't check when we
copy we don't check when we assign them
okay it turns out that's a rather hard
concept for many people to get the
students I have will often seem to think
you can have that object in an invalid
you know you can that we construct an
object and somehow look at it and fix it
up like everything's gonna still gonna
work okay anyway since defensive
programming within these contracts can
be challenging though one can argue
whether that's more so than dealing with
pointers or dealing with integer
overflow and other things that we trust
people to do so BBE code has compiled
time conditional assertion checks
built-in when it is possible or
practical these are not part of the
contract so this is as part of what we
call quality of implementation bill
details okay so we're not promising this
but because we want to be you know we
want to help you
where possible we'll put these things
and they will be they're done using a
system of macros invented by
just be like OHS here excuse me doctor
likens okay
doctor doctor Legos okay
all right here's an example of where of
how they might be used behavior
blah blah blah long contract behaviour
undefined list target date is in the
range of calendar where calendar here is
something that we have a class that we
have that maintains a day a range of
dates and has that can be adorned with
information about which days are
holidays in which days are weekend days
and so forth okay so that you'll find is
that we will do a limited check on the
validity of free date will check to see
whether it is 0 or not and it happens to
be invalid to ask about to invoke is in
range on the calendar object unless the
range is greater than 0 so we first
check to see it's okay to run the method
and then we run and then we check to see
whether the target date is in range now
now what why didn't we just use assert
somebody wants that asked me recently
well these are better in two ways one we
have finer control over which of these
assertion living with asserts they're
either on or off here we have different
categories of checks that are key to the
the computational weight of the check
and we have freedom as to what happens
when an assertion fails so normally for
an assert will use the assert macro the
unadorned cert macro when the overhead
is roughly five to ten percent of the
method call if something is heavier than
that we'll call an assert safe differ a
different macro that can be turned on or
off separately and and these are you'll
see these very uh these commonly appear
in
methods because their sole inline
methods are so short and so fast that
any check is going to is going to double
the costs of a method call so they thing
a categorized as safe and lastly they
have another category for method for
checks that you want to do even in
optimized mode now the library developer
person who writes the code will
categorize put in the checks and
categorize them according to their
weight the application builder decides
what is the appropriate level of
defensive checking so to separate
independent responsibilities this table
is give you some idea of how to turn
them on as essentially if you type in if
you set the flag DSL asserts on your
score level underscore starts safe
you'll get them all turned on the
default is the second column the second
row where the safes are often the others
are wrong and optimized build modes
you'll have all the ops and you can turn
them all off and there are other
combinations if you want to these are
the ones that are commonly used
personally I always develop with asserts
a flaw why not okay and if you're doing
waffles as instructed the as instructed
at our github site you use the safe
option to off configure and more details
at that link you see there lastly the
last level of freedom is what happens
when assertion fails well that happens
at runtime that whoever is starting up
the program is going to determine what
happened what happens when assertion
fails this is something you can
programmatically change over the course
of a process lifetime the default
handler does it aborts so we have our
same behavior that we have the one that
we know from the classic assert second
method will use will sleep so that you
can then go over and examine the live
process with a debugger you know just
while it's still in memory there's also
a method called fail throw which shows
that particular exception which will
give you if you an opportunity to do a
safe shutdown remember this is something
you don't if you have gotten into the
situation where you've entered undefined
behavior you've got a process then a
suspect you know it why did it get why
is it trying to do something so bad
so best policy is to just is to just try
to shut it down safely rather than
continue and try to make mistakes
especially you know if you're an
important application course who's an
application is not important now there
is a an option to log the exception and
then continue into the undefined
behavior and this is something we use
when we have working code that's making
money but we want to encourage people to
instrument their code with these
assertions so this is a way we can
discover problems in existing code
without causing interrupts to clients
and one more slide please just a summary
so the libraries I assert and hopefully
I've convinced you that these provide
wide utility the documentation is clear
complete very regular having a tax up
well-defined taxonomy aids and
comprehension and using narrow contracts
without forcing checks when they're not
necessary leads to efficient
programs if you if you use them
correctly and use them responsibly and
and and can be handled by seasoned
developers with appropriate training any
questions okay you were first we have
little control over people outside of
out of PDE that by the way the question
is do we enforce our rules on everybody
else in Bloomberg if only we could but
it's a matter we lead by moral authority
answering questions giving classes many
people who are many of the managers at
Bloomberg are protégées of John who have
learned under him and agree with many of
his methods and so they have it has
proliferated different degrees of
strictness are applied in different
levels the BDE
methodology is very time intensive and
it is justified by the fact that we are
writing code at the bottom of the of the
software stack that's going to be reused
very heavily so you know not people that
are higher up that the stack can't make
that same justice you know you know they
have to cut corners we understand that
oh all right I'm sorry I didn't get to
your question
which we spend about half our time on
Doc have fun testing half on development
half on design yeah yeah yeah you get
you got its thang</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>