<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2014: Lightning Talks - Martin Troxler &quot;Return Values Take A Closure Walk&quot; | Coder Coacher - Coaching Coders</title><meta content="CppCon 2014: Lightning Talks - Martin Troxler &quot;Return Values Take A Closure Walk&quot; - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CppCon 2014: Lightning Talks - Martin Troxler &quot;Return Values Take A Closure Walk&quot;</b></h2><h5 class="post__date">2014-10-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/05e-C7qMWVg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Martin Troxler is next and that he wants
you to take a closure walk and in my
corner of the universe which is pretty
Microsoft focus we have stl who is stl
and mt as you can tell does mostly
multi-threaded problems in real time
systems for industrial manufacturing
machines
ok
now I'm talking about how you can pass
return values of the stack without
effectively know their type now why
would you use such a thing if you write
a kind of wrapper function we saw this
pattern for example yesterday on the
legacy talk very was used to to try
except to catch exceptions before they
were thrown out into code that cannot
work with the exceptions so you
basically call a function within a try
block call you make a scoped context it
could be a something like a mutex or
even a very complex database access why
did I not choose to make it this call
within function as a template because it
would be faster at a complete type of
the the given function would be usable
but the reason is that we want to
decouple the implementation of this
curve is in function that is also the
reason that I have to use a stative
function to reach the concrete type now
22 count to the real problem if you want
to call a function that returns a value
how would you achieve to pass that value
up to the stack so we can disco is in
function and use that a result value
the simple solution would be to simply
define the same return type but it's a
stupid solution and makes not much sense
now the first step is to declare to
return mimic a template function and
declare the return type to be the same
as part of the given function you can
use a data type and call the function
but it's not not really an call just the
type deduction mechanism introduces the
type of the return value of this
function it even doesn't matter how many
parameter day this function with Islam
de these colleagues callable expression
has another step is to separate the
implementation into an concrete function
but this version does not compile
because a call within impul requires a
void function the next step is to
declare a result and local variable that
has the same type as the return type
then we define a wrapper function a
lambda expression that captures this
result variable by reference in this
wrapper function we call this original
given function and store it in this
captured result variable next step is to
actually call the wrapper function it is
now possible cost the return type of the
wrapper is the same as test was expected
this from a call with an input
and at the end you return the result Lee
we have saved previously the nice thing
is that this a C++ move constructors we
actually do don't do any copying of
values just twice move you can put
everything within a interface class and
go now where this solution is not
perfect because what happens if you want
to call a function that returns void the
compiler would give us to follow me
mirrors cost result type is void we
cannot a treat the return type is void
we cannot declare a variable of this
type
what is a bit of simple metaprogramming
we can switch between two versions if
it's the return type void we choose the
upper version with the widget which does
doesn't return anything and if history
it's another type than we return the
result now there was there is another
problem if you want to if the
implementation itself can fail for
example is a open connection this might
fail and you want to return this
information back to the caller so you
can one variant to solve this problem is
to choose a to use a boost optional on
to wrap the result type within me if you
read the implementation had a failure we
return boost on and the original color
has to check the result value if it was
none if it was ok then it has to lift
the reference to the actual value well
that's it thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>