<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2016: Dan Higgins “Combine Lambdas and weak_ptrs to make concurrency easy&quot; | Coder Coacher - Coaching Coders</title><meta content="CppCon 2016: Dan Higgins “Combine Lambdas and weak_ptrs to make concurrency easy&quot; - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CppCon 2016: Dan Higgins “Combine Lambdas and weak_ptrs to make concurrency easy&quot;</b></h2><h5 class="post__date">2016-10-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fEnnmpdZllQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">first this is a quick topic on using
lambdas and share pointers I'm gonna go
pretty fast because I think most people
understand kind of shared pointers and
I'm just gonna new and there they
actually change the way you design so
it's a really big feature to the
language so first I thought lambdas
really ugly
look it's like oh my god I don't want
these like these code turds all over my
codebase and it's just you know what's
weird as arrow at the end like what's
going on here but in the end it turns
out to be super super powerful
especially when you know some of the
things I used to do by hand with like
making a template struck that would take
a pointer to a function that you could
then call and all the stuffs went to
like do what scope guard does which is
basically putting code that you want to
run when it goes out of scope to do
things like cleaning up an exceptional
safety and batch processing like right
here like maybe I did something and I
determine if I need to do a game engine
update or something like that so I use
scope card a lot watch it I didn't write
it's out there Alexander Jessica who did
a big PowerPoint thing on it and wrote
it so go find it if you don't use it yet
share pointers I think probably most
people are familiar with its boost I'm a
big fan of boost and so therefore it's
C++ 11 I use them a lot of in fact I
barely ever do new anymore
and but you know it's using games it's
using real-time products so don't be
nervous about them but one tip is to
make sure you use them make share
because it makes it a more efficient use
for a shared corner now where I really
gets its fun is when I combine that the
pointers and lambdas so if I would say
want to do something and I wanted
something in the future a little bit of
work so normally you could take a lambda
and it could run you can cue that
function somewhere but you really need
to validate code to make sure it can
work so imagine like I have an object
and I want to render it next frame
I want that code to execute sometime a
future without having to like keep track
of it right so maybe I make a an object
that takes a pointer to a function and
then I I can you know right here on the
X Q you can see I can just run the
function right now this gets pretty cool
when you apply it to when I can invoke
it on a thread so for example I can take
a piece of code I can say I want
execute at you know ten millisecond the
future 100 milliseconds future whenever
I want to an or if I say execute right
now I can do a check to make sure you in
the right thread and if you're not
dispatch it to the right thread so it
can be executed an order so it's a
really handy way for me to do
concurrency without having to do a whole
bunch of like all over the COBE like
what thread my am i doing this and that
and things like that I can just say you
know what I know I have a bit of work I
need them VOC it on that thread I'm in
the networking thread and I need to like
dispatch it over to the simulation
thread or whatever it is this is really
handy so the actual use of it looks more
like this so with the weak pointer a
weak pointer is does not hold on to an
object to keep it in memory so basically
you do something where you say like you
check it and you say if this object is
still alive and then I can use it so
that's where you see the game object we
call I get a share pointer of myself
I'll invoke something on thread and the
one here says like you know just make
sure it doesn't occur right now even if
you're on the same thread when this
executes it will lock and make sure the
object still exists and then it will do
the rendering so super useful pattern to
do all over the place in fact I turned
my single-player game into a multiplayer
game by using this type of this this
methodology by simulating latency and
lag by saying oh everything I'm gonna do
I'm gonna take all us work and dispatch
it as if it was to do in the future
so another handy piece of the we're said
one there and I did you know one
millisecond you put random ranges so you
can simulate problems so that's pretty
handy so thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>