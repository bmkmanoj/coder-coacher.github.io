<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CppCon 2017: Juan Arrieta “Traveling the Solar System with C++: Programming Rocket Science” | Coder Coacher - Coaching Coders</title><meta content="CppCon 2017: Juan Arrieta “Traveling the Solar System with C++: Programming Rocket Science” - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CppCon/">CppCon</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CppCon 2017: Juan Arrieta “Traveling the Solar System with C++: Programming Rocket Science”</b></h2><h5 class="post__date">2017-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YXs3DFrZZL4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Good morning everyone,
thank you for coming out
and sharing your morning in this talk.
Let's just get this started because
we have a lot to get through.
So let us start here.
We'll start at D-Zero,
and this is a very special kind of D-Zero,
because before this D-Zero
absolutely nothing exists,
not even the concept of existence.
This D-Zero is the
beginning of the Universe,
and let's see what we know and
what we do not know about it.
As it turns out what happened in the first
millionth of a second, we
have absolutely no idea.
Whoever tells you they
know, they are lying.
We have no clue what happened in
the first millionth of a second
of the beginning of the Universe.
Apparently, at ten to
the minus six seconds
after this Big Bang, we do know,
or we have a much better grasp
of what actually was happening.
So there was this singularity,
there was this point, and then boom,
I don't even know if it made a sound.
No one was there to hear it.
And very shortly after, at
about a thousand seconds
after this explosion happened,
we had this, started
having heavy particles
become, forming one another.
And a very special one
is this one, lithium.
So the third, number three in
the period chart of elements.
And I find something remarkable.
If you, yourself, or you know someone
that is unfortunate enough
to have bipolar disorder,
you may know that they
can be given a medicine
based on lithium, to improve
the firing on the brain.
Nobody really knows how it works,
but it does work.
I find it remarkable that
something that was created
ten to the three seconds
after the Big Bang,
and that's when it was created.
It was not created yesterday.
It has been alive for 13.8 billion years.
Can affect our way of thinking.
Can affect our very existence
in such remarkable ways.
And this element is very special.
Of course there's the lithium batteries,
but you know people, computers.
This is the oldest selfie
that, that ever exists.
This is a microwave background radiation.
It is an actual picture, so
it's not an optical picture
it's in a microwave.
And what it shows is the
difference in temperature
in the whole sky, that we have from
a mission called WMAP.
What you are seeing here is a variation
of plus minus too hundred microkelvins,
and what you see the hottest spots,
the little bit hotter spots,
is when matter started to accrete,
to form what we now know
as galaxies, planets, etc.
So we keep moving along on
this, evolution of the universe.
And then we enter to
150 to 800 million years
after this D-Zero.
And we have these elements here,
carbon, hydrogen, oxygen,
nitrogen, sulfur, and phosphorous,
and those are the blocks of life.
Life cannot exist without these elements,
and they were created
just very, very early on,
the beginning of the universe.
And again we come from these atoms
that were created in, during that process.
Tagging along, let me skips
a few millions of years
and we come to two billion
years after that D-Zero,
and what we have, is that, it's starting
the creation of macrostructures.
So there is, certain
regions of the universe
are more dense in matter
than other regions
and these, the gravity already exists
and it starts coming together
and we have these clouds are
starting to come together
and it start forming the stuff.
And then at about four billion
years after that D-Zero,
we have the galaxies.
As you know and you may have
seen this picture before,
was taken by the Hubble Space Telescope.
They just pointed at a very
tiny part of the universe,
and just let it there,
with a very long exposure.
And every single tiny dot that
you see there is a galaxy.
A galaxy like ours with billions of stars,
with the massive history,
impossible to understand
exactly what's going on in there.
So we are only four
billion years after that
very special kind of D-Zero.
Let me skip two billion years
and get to a special galaxy,
that was you know, it was just a bunch
of gas and particles
moving and at some point
it stabilized along an axis
so it's angular momentum
was starting to stabilize.
And this stabilization
enabled the creation
of our sun, so about nine
billion years after the D-Zero,
some of that gas has
started coalescing together,
it keeps coming together,
and when enough of it comes
together to a single point,
gravity starts causing the fusion,
and then there's heat and we have a star,
that it was a special star,
because it is our sun.
Then about .25 billion years after that,
so 9.25 billion years ago, in
the remaining of that star,
the sun, a little planet
was starting to be formed,
and that was planet
Earth, that's our home.
About 9.25 billion
years after that D-Zero.
And everything was going great,
it was hot because is had been accreting,
but it was, you know everything
was safe and beautiful,
until you know something hit us.
Something probably the size of Mars,
and then you know,
everything had to start over
from scratch but this gave
us something very special,
because it gave us our moon.
And without our moon our
planet would just not
be able to sustain life.
You know it gives us the tides, et cetera.
You know, we just keep moving along.
And about 10.7 billion
years into the evolution
our planet had this
bacteria that were formed.
A very special property of this bacteria,
the cyanobacteria that they call them now,
is that they were able to produce oxygen.
So then our atmosphere was
capable of producing oxygen.
And life started to be creating.
As you can imagine, I'm
skipping through a few details.
(audience laughter)
13.4 billion years later,
on Earth we had sharks,
and that's my best rendition of a shark
so sorry I could not draw anything better
so just imagine the shark.
I find it remarkable that
sharks are older than trees.
Sharks have been around for
a long, long, long time,
and that is 13.4 billions
years after that D-Zero
we got sharks on our planet.
Then a little bit later we got dinosaurs.
So that's a t-rex, that's
an actual skeleton,
I took the picture.
Well, not me, I took the
picture from the internet,
I didn't take the picture of the t-rex.
And then everything was going great.
We had the dinosaurs
and they were, you know,
moving along and doing
their Jurassic stuff,
and then we had a comet hit in Mexico.
I'm from Mexico, so please
don't, don't take it on me.
It wasn't my fault.
So in the Yucatan Peninsula,
this comet came, or that is
the most accepted theory,
at least.
And what you're seeing there
is some gravity variations
on that Chicxulub crater that is there.
And that wiped off all the dinosaurs,
well not all of them, some
of them evolved to be birds.
Talk about bad luck.
(audience laughter)
And then 13.77 billions years
ago that very special D-Zero
is when modern human anatomy came about.
And this, you know I'm
skipping over the Neanderthal,
et cetera, but that is
the modern human anatomy.
And then 13.8 billion
years, we come to today.
And we come to this little dot,
and that little dot is
what our understanding of
everything that happened before,
all this story that we went through.
That's what it would be if we did not
go and explore space.
So it is very important
that we choose in this,
this junction that we find ourselves.
We just, you know assume
that something happened,
assume that we're here for some reason,
that we philosophically will find out.
Or we got out to space
and try to determine
exactly what went on.
And this is when we enter
into the exploration.
So this motivates exploration of space.
Understanding all this
history, what happened,
we have been alive for negligible
amount of all this history
but I find it remarkable
that we have the capacity
to understand everything
that happened before.
If you're interested in
the year by year history,
good luck, there's lots of books.
I don't, honestly don't understand at all.
But let's try to see how do we go about
opening up this dot, which at this point
represent our understanding.
So the first one, again, you know,
skipping over a few other
important contributors.
The first one that unlocked the universe
in my eyes was Isaac Newton.
Of course, a very observant
and very capable mind
that decided to write
his Principia Mathematica
and with that really told
us in his three laws,
what's up with these
that we call existence
and reality and physics.
And one diagram that
I believe it was drawn
by he himself, it's the
initial idea of getting
out of Earth and going into space.
So what you are seeing
there, it's a little mountain
that point V, and essentially
the way he reasoned
was if I grab a ball and
I throw it or whatever,
I grab something, and I
throw it on top of a mountain
it's gonna fall, if I
you know throw it harder,
it's gonna travel farther.
So on and so forth and at some point
I'll hit it, I'll throw
it with such a speed
that by the time it
falls it won't have time
and it will me in the back of the head.
Oops, sorry.
And that is a satellite.
So he came up the concept of a satellite
just by imagining you know,
throwing from the top of that mountain
and you see you have that
D, E, F, G, et cetera
and then until you come and
hit at the back of the head.
So in space, this stuff doesn't orbit.
I mean, it, we call it orbiting,
but what stuff is doing, stuff is falling.
It, and it's, but doesn't
fall down, it falls around.
And then you have to have a minimum speed,
and your speed determines the period
with which you, you orbit
the body, et cetera.
So this falling around is the original
conception of maybe we can get out of here
and into that space.
Then the falling around,
because as it turns out
nothing really works like this.
And I can not even start
to enter into the special
and general relativity.
Newton is the one who gave
us the laws of gravity
and calculus, I know, light
and it's you know, two things.
But, Einstein's action theory is really
a much better representation,
but as it turns out,
and I hope you can see today,
with Newton's laws we can do
remarkable, remarkable work.
And so, there's just that guy.
I want to acknowledge him.
But, we won't touch a lot into his theory.
Watching how to show, for those of you,
of from Russia shortly
after you know these ideas,
we have, we got the
launch of Sputnik, 1957.
The first man-made
object, human-made object
that went into space.
It was an amazing thing, it instilled fear
in the United States, it instilled awe
and we quickly had to respond.
So then, Jet Propulsion Laboratory,
where I used to work,
decided that, well the
military decided that
somebody had to build a satellite,
and somebody had to launch it,
and they picked JPL and then shortly
after the launch of Sputnik,
JPL launched Explorer 1.
The first American satellite.
And then the, you know, the race was on
and the race was
thankfully for exploration.
Sure the original
motivation was the Cold War
and we had all these issues going on.
But it was wonderful that
in this show of capability
between two countries we
got to discover so much.
So, let's see the force of math.
So you know a little bit
going back to high school.
You get the rate of change of momentum,
has to be equal to the forces
acting on an object, right?
And then you can say like,
okay, well the momentum
is the mass times the velocity,
and then you can say that
the mass has to be constant,
because you know something
is not excreting matter.
And then so you can take
it out of the derivative.
And you get this mass times
the derivative of the velocity,
with respect to time, has
to be equal to the forces.
So that's the force of math.
And then on the other hand,
you have the, Newton's laws of gravity
that tells you that the force of gravity
between two objects is the
product of their masses,
divided by the square of
the distance between them,
times this constant, the
gravitational constant.
Well we also from the previous slide,
know what the force is
supposed to be from,
from a calculus perspective
so we can equal those
two, you know, equations.
And we end up with the
derivative of the velocity has to
be, as you know the
little m is on two sides
so I cancel it.
Is this, gravitational
constant times the mass
of the big body, divided by the
square root of the distances
and then if you notice the last v,
is now in bold because now it's a vector.
And the reason why I made it a vector
is because I just multiplied it by the,
by the line that joins the two centers.
And I put a minus because
the force is attractive.
So it's attracting, and that
force is along that line,
so now we have a vector.
So, this is great.
Now that means that we have
six differential equations,
to describe the motion of the spacecraft.
We have the derivative of position,
by definition is a velocity,
and the derivative of the velocity,
which is the acceleration,
is this minus Mu, which now is G times M,
times R over R cubed.
So now this is a vector,
six differential equations
for that point mass.
I'm not gonna be talking
about the attitude
of the spacecraft which has the other
six differential
equations, and other stuff.
So, that's the math of
force, and this is a fool.
I, I entered JPL in 2009, and I said okay,
I'm gonna go, I'm gonna do it,
I'm gonna understand everything
there is to understand about a spacecraft
and wanna know everything there is
to know about space travel.
That's my first day.
I'm proudly holding
Cassini's navigation program,
and I was gonna do the maneuvers so that
Cassini would you know, execute its
merry way around Saturn.
I was such a fool.
(audience laughter)
Those differential
equations that I showed you,
the six ones, you can train yourself
and I'll post some code and get help
so that you can do it.
What I did here is I
just tried to say okay,
give the position of
the Earth and the moon,
well the moon's relative to the Earth.
At the, at the beginning of CppCon 2016.
And then just use the GM of the Earth,
that Mu stuff and you simulate
those differential equations
just forward, up until today.
So, one year.
Do they predict?
So let's see here.
If you, I'll use the cursor here.
We can see that in the
beginning the two lines
are really riding on each other.
So that's pretty good.
But then you know shortly after
what is this about a month,
I'm already off by what?
Like four or five what are
the units, Earth radii?
So I'm off by two Earths.
That's probably, probably
an unacceptable distance.
And of course as I move
on, the error just becomes,
we should say astronomical.
It's pretty, it's pretty, pretty bad.
Or is it pretty bad?
So we can take the two attitudes right?
It can be awful because you know,
by the, by the time we are in 365 days,
I'm off by like 60 Earth radii.
So essentially I'm
pointing you the other way.
So that's, that's bad.
But I also find that
it's really encouraging,
that with so little differential equations
and so little knowledge,
you can predict that for 30 days.
So that's, that's pretty cool.
And, and again, no, no cheating here.
It's just grab whatever,
also has an analytical solution.
I won't enter it with you,
and you can solve Kepler's equation
for the two body problem.
But you can just grab the equations,
put them in Python, use side by ODI int,
and just propagate them and you get that.
No, you know, whatever 20 lines of code
or something like that.
That gives you 30 days
of where the moon is.
So the force of reality is that of course
that's not how stuff moves in space.
We not only have the
force of the central body,
we also have many other forces.
And the, the reality is
that you have to be adding
these forces onto that vector
to, to be able to really reflect
everything that is acting on the object
that you are trying to
model the motion for.
So what kind of, what
kind of accelerations or
what kind of forces
are acting on the body?
We have many, I'm gonna
try to enumerate a few.
We have N-body
perturbations, the first one,
you have you know, not only the moon,
but you also have the sun,
which kind of matters
considering that it accounts
for about 99% of the mass
of the entire solar system.
Doesn't seem reasonable to ignore the sun.
We have, the moon doesn't
really orbit the Earth.
They orbit the very center of one another.
Also they are not perfect spheres,
so we have this gravitational potential
that has to be modeled differently.
Big bodies have a bulge in the middle like
(thuds stomach)
you know.
And,
(audience laughter)
and they are squished at the top,
and then there are other bodies
that are not even round
that they just have
an irregular shape like
the, the smaller asteroids.
If there are rings, like
in Saturn for example,
the rings do exert
gravitational perturbation.
They are quite heavy.
And of course the potential
of the ring system
is the not the same as
the potential of a sphere.
So you have to model that as well.
You have the solar radiation pressure.
Like it is, there's literal solar wind
that is pushing on the faces mechanically
and you know moving everything forward.
And you only need very tiny accelerations
over an extended period
of time to have this drift
that keeps moving on.
We have relativistic
erections, so it's true
and they do matter and
we do account for them
when we model the spacecraft motion.
They are not as important
when you are just considering
short term variation.
But when you're considering
very precise timing,
for example in the GPS
constellation around Earth,
or stuff that is very close to the sun.
For example, Mercury, you just cannot
account for their motion without
correcting for relativity.
We have atmospheric
drag, for satellites that
are low in the Earth
orbit, or if you're trying
to enter into Mars.
You need to take into
account the atmosphere.
And it doesn't have to
be a thick atmosphere,
it can be completely,
a very thin atmosphere,
but again, a small
effects, over an extended
period of time can make
a lot of difference.
And of course you have
the spacecraft thrust.
You need to know when
to fire your engines,
in what direction to fire your engines,
and the speed, everything
that's gonna happen.
How aligned you are.
And then you start
putting this all together
onto that right hand side that I showed,
the sum of forces.
So, as I will show later,
our code is just essentially that.
It's just a way to model each
one of these different things
that they can be modeled
in different manners
and just adding them onto
that vector of forces
so that you end up with
differential equations
that then you just have good propagator
and you go ahead and solve it.
But that's not all of it.
We also have a lot of frames of reference.
The only way that Newton's laws work
is if they are in an inertial frame,
that would, what that means is that frame
can not be accelerated.
And we also know that doesn't exist.
That's just a construction, you know,
of the human mind.
So what, what we do is we said okay,
refer the motion to the very
center of the solar system.
We'll take that as inertia.
Then imagine that there
is a clock ticking there.
So that's, you know put it there.
And however that clock
ticks that's our clock.
And then everything you
do, something away from
the solar system very
center with a clock ticking
on the solar system very center,
has to start you know taking into account
the different frames of reference, the,
the relationship between the
clocks themselves, et cetera.
We have different shape
models as I mentioned before.
Not everything is a sphere.
Not everything can be modeled
with spherical harmonics.
Sometimes they use plates,
sometimes they use triangles,
sometimes they use cubes.
So we have been many different ways
to model the shape of an object.
Temperature models.
How is the temperature
radiating on the spacecraft?
There's many ways to do that.
Radiation models.
Something like Jupiter, has
a, the strongest radiation
in the solar system.
And, you need to do all these models
and these are represented
by a collection of data.
It's like a shell that
you have to interpolate
and find the correct
shell and then find the
eight corners and then
interpolate like this
and then like that and then like this.
And you have lots of data.
So, got quite complicated.
Attitude dynamics.
I said you know I'm not gonna mention it.
But you know you have a body that is,
you know distributed,
and instead of this thing
being like this and being like that,
and where's the center of mass and so on.
Aerothermodynamics.
You're entering into Mars.
You're hypersonic relative to
the CO2 atmosphere of Mars.
So you are heating very fast.
You are also dropping heat very fast
from the heat shields.
And, of course you're
getting mechanical motion
on the spacecraft.
You gotta model the instruments,
so you have to model the camera,
the aberration, the temperature.
Where is it looking at?
Like whether you are
pointing it correctly.
And not everything is a camera
so my radars, and so on and so forth.
All the telecomm, you know,
you have your data,
your hard drive is full,
you're in Jupiter, and you've
gotta give it to someone,
and it's not gonna be Fedex,
so you have to find Earth.
You look at Earth, and
you first look at the sun,
and then you within the
sun you look at Earth,
and then you point your antenna
and then hopefully the Earth is spinning
at the, not hopefully,
you of course model that.
That's kind of someone's job.
To make sure that, there's
an antenna ready to
receive this communication.
So that's the job of
the Deep Space Network,
from JPL as well.
They have three antennas,
California, Madrid,
and Goldstone, and Canberra, Australia.
About 120 degrees separated by one another
so that when the Earth rotates there's
always antennas listening to, to space.
You gotta model the ground
stations themselves,
like you know, because the
ground does move up and down,
and that matters even
if it's 60 centimeters
with the antenna it does
matter, where the ground move.
And there's, an international organization
based in France, the International
Earth Rotation Service,
that gives you the
parameters of that model
where Earth is and how is
the, the Earth's inertia
in that moment, so you have to use it.
I think they update it once a week.
I guess depending what kind of work
you're trying to do.
And then the avionics.
Everything that I've been talking about
is just how the stuff moves.
Like, like the physics of the thing.
Not how you make it do that.
That's all the avionics system.
I believe there was a talk yesterday
which I'm looking forward
to watching YouTube.
Unfortunately could not attend it.
But everything that goes
into the flight computer,
I'm not talking about that.
That is massively complex.
It's an entire topic in and of itself.
And I would say about
40% of this, of the cost
of a space mission is
developing, verifying,
and validating the avionics system.
And many other things that I'm not
even taking into account right now.
So the computers to the rescue.
What we have here are
the original computers.
Those are employees of
JPL back in the day.
That they were the ones that had to
figure out this whole thing.
You know, people would come,
give them the models,
and they would by hand,
go and compute everything
and just had their summing,
or their adding machines and
they had to like figure out.
And I've been told maybe that apocrypha,
but that they, the way
they would propagate
the differential equations,
was literally sitting
behind one another and
then just do one step
of the range coder and just passing it
behind to do the next step
so that people could verify
and then the last one
would come to the front
and just you know continue
the propagation like this.
Like you can imagine yourself were doing,
well it was real people.
And they were called the computers.
And maybe you have,
you're aware of the movie
that is out right now that kind of
talks a little bit about this.
So the computers to the
rescue, they are working,
but you know who comes to
the rescue of the computers?
So, the computer itself,
the digital computer
is the one that came to the
rescue of the computers people.
And now, we have there,
one of these computers.
And how do we talk to that adorable thing?
With Fortran.
That is how we talk about,
how we are initially,
talk about to, to the computer.
To the digital computer, with Fortran.
I don't need to go
through what Fortran is,
you know these, initial
you know, domain specific,
just for scientific computing,
it was great, this is for that computer,
the IBM 704, which is
actually that computer
that I'm showing in that picture.
And, I just thought this was so funny.
I'll give you a minute,
30 seconds to read it.
You know.
Any programming language,
that says stuff like that
should be looked at with a skepticism.
- [Audience Member] So did
the value of pi ever change?
(laughter)
I heard they were planning
to move it to three.
Just you know.
(laughter)
- [Audience Member] Yes that's true.
So, now, Fortran is
remarkable for many reasons.
But now I'm gonna try to explain
why is it so prevalent in rocket science.
And it's probably something that,
that you have not considered.
So this is an actual Fortran example,
is in the notation of modern Fortran.
So you know, your implicit
none. I hate that.
Yeah, here, a real foo, and integer bar,
and a logical, like a bull, baz.
And there is this thing called a namelist.
A namelist in Fortran you
just declare, give it a name.
In this case I called it mydata.
And they, here I said foo, bar, and baz,
these three variables
that I declare on top
are part of that namelist.
So now you can read that
namelist from a standard input.
So there is a specific format
that is called the NML format,
the namelist format, that when it's read,
it will populate those variables.
And similarly, you can
just, I don't show it here,
but you can spit a namelist
in the namelist format.
I, here I'm just spitting it in,
oh by the way Fortran
doesn't print, it spits.
I, I'm, here I'm just putting what I read.
And then that's, that's the program.
So for this is the actual format itself.
You have an ampersand,
the name of the namelist,
the three variables that I had there,
and then this terminator.
And you can just do it right now.
And here is what you had actually read.
And if you had say,
saved, the, the variables
in a namelist format,
you would have gotten out
something that looks like this.
So why do I say this is
such an important thing?
So, this is how actually stuff goes down,
down in the trenches.
People come with an algorithm,
to simulate something very complex.
Inevitably, because of all the
things that I told you before
that you have to model
the clocks and the frames
and the constants and the parameters
and the ephemeris.
Then you have this massively
parametric problem.
And everything has to be consistent.
If you use the masses
from one calculation,
they all have to from that calculation.
So they have to self-consistent.
You cannot use the
masses computed from here
with a radii computed from there.
So it has to be everything consistent.
So what people would do,
is just grab this massive namelist,
put everything in them,
and just distribute it
to one another, grab their program,
at the top it starts saying, you know,
MA1 A, MA1 B, MA1 C,
and all the parameters.
Hundreds of them.
And then just produce some documentation
which is better than nothing.
And distribute it to other people.
So then, you would grab that namelist,
do something, save it, and
you had another namelist,
and you have this
collection of text files.
That represent your entire design.
Now because they are text files,
and they have, they can
have comments on them,
they can be version controlled,
then people became used
to working like this.
As soon as you write a Fortran program,
you have automatically
a parser for a language
that people understand.
People who went to university
know how to write this,
people know how to read it,
you can copy and give
it a meaningful names
that you know, my rocket design v1.2_good.
You can, you can give that name
and people just keep them,
and then people write software,
they like oh, it's very easy.
It's just a namelist.
I contend that the reason
that people use Fortran
is because, the engineers can do this.
They, they don't have
to worry about gouys,
they don't have to worry about input.
And it's also very simple language.
It's very straight forward.
You just add, multiply, divide.
Matrix multiply, and you have a,
something something to report,
it spit out your namelist.
So, I found that remarkable.
Now, you, you'll notice that that was
in a single precision,
you can just change
something in the compiler,
it'll do a double precision,
so it has some sort of compiler
parametrization as well.
Which also turns out to be important.
And then there's a field of dreams right?
So then, there was also the BLAS,
basic linear algebra subroutines,
that were also massively important
because they provided a common language
to describe algebraic operations.
There was BLAS level one,
level two, level three,
then we had LAPACK, and
then we had the Netlib,
this repository of numerical software.
So then more people relied on the software
available on Netlib that was in Fortran,
and then people knew the namelist,
and the namelist were already there.
Then Cleve Moler invented MATLAB,
which was nothing but a
way to speak to Fortran.
That was it.
It was originally used a
wrapper around the Netlib,
and you know, just
literally LAPACk and BLAS.
And then we had these
book Numerical Recipes
that had a lot of the stuff in Fortran.
So people needed to do, you know,
Chebyshev interpolation they
would just hit that book,
find out how it's done,
and it was on in Fortran,
then later the authors did
produce C and C++ versions.
So you know, if you
build it they will come.
They created an ecosystem,
and the problem is if they
come they won't leave.
(audience laughter)
And, and that is exactly what happened.
So nobody defends, the
current practice with Fortran.
I don't think anybody would defend it,
but people are comfortable.
But it's not that Fortran
is bad, it is not.
It has, mainly it is not
meant for user interaction.
You cannot interaction with
the command line for example.
It has many bad things, it's excellent for
strictly numerical computing.
The problem is people
don't use it for that.
People use it for everything else,
in addition to numerical computing.
So it's been very
difficult, at least for me,
to try to convince
people to continue doing
their Fortran calculations in Fortran
because indeed it is a very good language.
And people know it.
But you know, just put the
wrapper in a more robust language
like C++ that probably you've heard of.
So, dreaming a solution.
This is you know,
approximately how a program,
have a problem solution for somebody
that works in a space or I
guess anywhere looks like.
You have some time, allocated
to the setup of the problem.
Another time once you set up the program
in the whatever system
you're using to solve it.
You actually solve so
that's the computing time.
And then you have to
post-process your solution.
Analysis, et cetera.
Now I believe that
currently what's happening
is computing is really
not, not that big of a deal
for the most part.
In 90% of the cases, that I have seen
in rocket science like calculations,
computing is not the issue.
There is special problems for
which computing is massive.
Of course, absolutely.
But for the most part,
in the day to day life
of an engineer, he or she
needs to set up the problem
in a massive amount of time.
When it's finally set up and verified
that it is the actual correct problem,
then they solve it.
Which is relatively small in comparison.
And then you have this
massive set of results
that you have to post-process then.
So people have been focusing
too much on that middle box,
that is I believe the
small in the 90% of cases.
And I believe forgetting the other
two things that are outside.
Just let me set up my problems correctly.
Let me ensure that my setup is correct.
Just go ahead and solve it.
And then give me the tools and flexibility
to analyze my results and make educated,
you know, conversations about this.
So what did, JPL did, I must say,
none of it, none of the C++
code that I'm presenting here
was done by me, this is all done by JPL.
Many people do wonderful, in particular
Ted Drains and Scott Evans.
They came up about 11 years ago,
maybe even more, I don't even know.
But, at the turn of the century.
They came up with this new system
called MONTE, well MONTE Python.
Really that's the name of the
mission operations and
navigation trajectory something.
Whatever, you know they
just wanted to call
it MONTE Python.
(audience laughter)
And, so they, they, it's built around the
concept called a BOA.
A binary object archive.
And what a BOA is is essentially
like a, a game component,
entity component, or architecture
that everything only has its name
and a set of properties
and you have a trajectory
that can have a central body,
you know orbiting bodies
and polynomial and
everything's like a string.
And then in the BOA
you store those strings
so you can exchange BOAs with one another.
And they kind of, I believe, hit bullseye.
And everything is written in C++.
And this is just, I'm
illustrating approximately
how it's used, so you can use, you know,
just load a BOA from a file.
It's, it's a binary format.
You can store and do the
same element in that BOA,
it will immediately be available to you,
and also will be written into the BOA,
so you can, use it in another process.
You can find, it kind of handles all
the complexity for you.
In this case we have these
ETs called ephemeris time,
it's some sort of dynamical clock.
And you can parse a string,
and now it allows, it forces
you to specify a clock.
And you see this thing right here.
It manages units.
Massively important.
It's not both units, it's
another units library
like within the MONTE system.
And, it is massively important.
It simplifies things dramatically.
And as you know, we did lose a spacecraft
because we were not careful about that.
And then, it can you know, if you say okay
I want to find the occultation of,
of the sun, the sun has to be here,
the moon has to be in front,
as seen from the DSS14 space station.
With that context in that BOA,
and then this is a time span
and then it just you
know give you the event.
So you become very productive.
But this is C++, which I love,
of course that's why I'm here.
But not everyone does.
So, BOAs are not the only constrictors.
So everything has Python bindings.
And, everyone works from within Python.
As it turns out this is not an issue.
Again setting up the problem
is what takes the time.
The little run time
penalty that it has for
setting up the problem
in Python is very minor.
Once it has checked the
units and built the things,
et cetera, everything runs blazing
speeds in C++ and its fine.
So this is approximately the same.
You'll notice that is very
similar, to one another.
And now, so we have,
I cannot of course talk about
all the computing problems
we have, it's a big universe
so we have very big problems.
Here I just have
approximately how it would
look in the implementation.
But programming this right hand side of
the differential equations
that we need to solve.
Of course this is just
a simplified solution.
So this is where I see
the, the power of C++
shining through and I don't
need to convince you of this.
So here, we just have some
statuses the right hand side.
We pass you the vector of the states,
Y, and I want the Y dot,
the derivative of those
given those estates.
Assume that I can read
the parameters somewhere.
Here I just used this Mu equal to one.
Appropriate units and so on.
Differential equations and just return me
whether their radius was greater than zero
which it should be right?
Of course in reality it's
much more complicated.
And there is one thing
that we need most often,
and it is the, bane of my existence
and I hate to love it
and that is derivatives.
We need derivatives.
And they are so important.
They are important for solution
of non-linear equations
and for optimization.
For solutions you need
the first derivative.
For optimization you need
the second derivative.
And it's never of a single variable,
so you need a hashin, and needs a parse.
And it's massively large.
And it's very difficult to compute.
So how can you do it?
You can do it with
finite differences right?
You can just get the forward differences
and you are order H.
And as you know this F of X0 plus H,
minus F of X0, H is very small.
So you have this you know,
catastrophic cancellation.
But then if you make H bigger,
to avoid catastrophic
cancellation, then it's order H.
So then you go and
reach for the, you know,
central differences approach,
that's order H squared.
Much better but it still has issues
and you get the signs wrong.
And it's just a big pain.
So then you can do also
complex-step differentiation.
So, this is true.
I, I think it's very
cool that that is true.
If you evaluate the function of
X0 plus I times H, divide by H
and take the imaginary
part of that result,
that's order H squared, but
there is no subtraction.
So it's not subject to
catastrophic cancellation.
And you can get numerical, like
essentially full precision.
It's as if it were analytical.
So complex-step
differentiation is wonderful.
Do I have to change anything on here
to do any of this?
I don't, because it's a
template function right?
So this is what makes C++ remarkable.
Fortran has an equivalent of templates,
it just doesn't work like that.
You still have to write
it, it has interfaces.
You still have to write it.
But in the other kind, I can
just instantiate my function,
with a complex number, I get the result,
extract the, you know X0 plus
ten the minus eight, times H, times I,
then get the result, get the
imaginary part, divide by H.
And that's it, I got it analytical.
Go try it. It's wonderful.
But that's really not the real deal.
So I have here my class real deal.
The real deal is to do
automatic differentiation.
So, have the computer, in
this case a type system,
do it for you.
And this is of course, I did not invent
automatic differentiation,
this is just conceptual.
So let's go back to high school.
You have, a the real deal, is my type,
and has a value, and it has a derivative.
So you remember how to take
the derivative of a product,
so U times V, so V times
the derivative of U
plus U times the derivative of V, right?
So that, and that's it that's high school.
And then how do you take
the derivative of sine?
It's cosine.
The derivative of cosine is -sine.
And every single derivative
has a very simple expression.
So in this case I use routes class,
here is just overloading
the operator times,
so that left, left hand
side, right hand side,
everything has a value in the derivative.
This is the value, so
you just multiply them.
This is the derivative, again,
V times U, plus U times the V.
Then for the sine, is sine, that's a value
and the derivative is
cosine times the derivative
because you need to chain rule everything.
And that's it.
Does it work? Let's see.
This function, you know, sine, cosine,
return me this product.
And this works, you can
copy and compile it.
And yeah, error zero.
This is wonderful.
This is what we need and this is
where C++ can come to the rescue.
But this is still not good enough.
So if there's any compiler developer here,
I believe this can be done in CLANK.
And I believe this can be
done at the compiler level.
And somebody will come up with it.
It won't be me, but they will just be able
to receive an expression,
an arithmetic expression,
and at the compiler level
and made the derivatives.
Because you have already
the evaluation tree.
You can just, you know,
evaluate backwards and get it.
This is the kind of
hope that C++ gives you.
If it can do this and it
can and there are libraries
that do automatic differentiation,
to any order and with a parse systems,
then you know, we are on,
we are in a great spot
to continue exploring the solar system.
So I have been rambling around.
What do you say, what
would you say you do here?
So what do I actually do?
So, I, my expertise are
gravity-assisted mission design,
so something like Cassini or a Clipper.
Planetary protection,
ensuring that we do not
bring Earth-borne pathogens
to other solar system bodies.
And that some solar system bodies
that we can samples return from,
don't come and kill us all.
Ephemerides interpolation,
meaning where the
solar system bodies are.
Situational awareness.
We have a huge problem with
so many pieces of debris
orbiting around in space.
And we need to be aware,
what's the situation,
I guess that's where the name comes from.
And, you know avoiding
this castoral effect,
which would cause this, you know,
chain reaction and destroy
where space has it.
CubeSat operations.
That's specifically what
my startup is trying to do.
Is just provide a spacecraft
operations service.
And my specialty is of course
trajectory optimization.
And you know C++, that's a thing.
So that's the trajectory of Cassini.
Remarkable mission that if you were
aware in September 15th
it died like a champ.
And this is what it did. Approximately.
So, Cassini was launched in 1997,
it's objective was to
study the Saturnian system,
and it did so by flying by Titan.
So it orbits Saturn, but it
uses Titan as its engine.
Just for you to get an
idea of how important
this Titan as a gravity-assist engine,
the entire engine of Cassini itself
had about 350 meters per
second of available delta-v.
Fuel, in a spacecraft is measured in their
capacity of changing speed.
So you measure it in delta-v.
You say it has so much meters per second.
So Cassini had 350 total.
And every flight by Titan, gave us 800.
So it is, it is, it is a
massive amount of delta-v.
Mostly what you do when
you fly a spacecraft
in a gravity-assisted mission,
you don't use your fuel for anything
but setting up the flybys
so that you get this,
this gravity assist right?
So each one of the little
dots, the white dots
that you see here, are flybys by Titan.
The ones that you see here
are flybys of Enceladus.
We found out that Enceladus has flumes
emanating from the
south pole, so therefore
it probably has water and
I believe they are positive
it's actually liquid water.
And you know, water equals life.
Or so far as we know.
Otherwise the satellites,
it has many satellites.
And then at the end we just entered into
the inner parts of the ring.
We orbiting from the out, then we came
back from the inside, and then, you know,
it just did its thing.
I'll show a movie if we
have some time at the end,
which I believe we are almost there.
Thank you.
So then Cassini is over,
does that mean that
exploration of the outer planets is over?
Of course not.
The last thing I did before I left
was being a member of the mission,
the same team for Europa Clipper.
So the next thing that we
do is going to Jupiter,
with a very capable spacecraft
orbiting the planet,
and looking at Europa.
It's the other moon that we believe,
that there is, if there's life anywhere
there is in Europa.
Europa is smaller than
planet Earth, obviously.
You can compare it to our moon.
But if it does have
water, we believe we do.
We believe it does.
It has more water than planet Earth.
And that is, you know, volume going as a
cube of the radius, and
Earth is very shallow.
The deepest ocean on Earth
is about 11 kilometers deep.
In Europa it would be like
hundreds of kilometers deep,
so there's more water there than here.
And it, it is heating because it's
coming in and out of Jupiter
and then it has the chemistry.
So let's see what we can find there.
And, here is the interplanetary
trajectory, one of them.
There's many ways to get there.
This is just the one that
I used for my design.
So this is called an EVEEGA trajectory.
Earth, Venus, Earth,
Earth, gravity-assist.
So you go to Earth, Venus,
and then you fly by Earth,
and then you fly by Earth,
and then you go there.
So that's why it's so loopy.
And then you come here to Jupiter.
This just zero.
You use Ganymede to break,
as well as gravity-assist.
So this is centered in the sun.
So that's the sun right there.
And then this is center
already at Jupiter.
And we start, these guys right here,
are the flybys so far at Europa.
So you have first exploring
one fourth of the hemisphere,
then another fourth of the hemisphere,
then another fourth of the hemisphere,
and then another fourth.
These black lines are eclipses
that we need to be careful for
because it will be a
solar powered mission.
And that's how our trajectory looks like.
The color-coding is just different faces
of the, of the mission.
So again, with the damn dot.
So now, now, now what we do here.
So that initial picture that I showed
you of the modern human anatomy,
is actually a plaque that was put
in the Pioneer spacecraft.
That's how it looks in the
actual spacecraft itself.
What it shows is you know,
the human inhabiting Earth.
It shows some atoms, it shows our distance
to different quasars or
pulsars, I don't remember,
and coded the distance in
binary, some sort of binary code.
So it shows the Earth, Mercury, the sun,
Mercury, Venus, Earth, and
then that little thingy
came out of the Earth is
in a very childish manner
the other planets and then this is,
this part over here it
looks like the antenna
of Pioneer itself.
And the reason why we did that
is because we wanted somebody to find it.
So we just threw it like a
bottle is thrown into the ocean.
Hoping that somebody someday
will know that we existed.
So ultimately that's kind
of what we are doing here.
Just trying to transcend.
And the way we aim to
do that is by exploring,
and we try to understand
to make our own reality
understandable to us.
And if we fail in doing that,
at least to tell someone
that we, you know, sometime
in this massive, massive,
massive extent of distance and time,
there was a species that existed
and that cared to look
a little bit farther.
So, I believe I have a little bit of time.
Let me try to show you this thing
of my good friend, Cassini.
Duh duh duh duh duh.
And of course I do not know
how to increase the volume but.
(clicking)
Well, if it doesn't work just
believe me that it's nice.
(laughter)
I'll put, I'll put it on YouTube.
Well it's on YouTube, I'll
put the address in the,
it's just showing the crash of Cassini,
but if it doesn't have audio, we'll just,
we'll just do without it.
So, if gravity's keeping
you down, give me a ring.
And I can help you with your spacecraft
and with that I'll finish this talk
and take any questions that you may have.
Thank you.
(applause)
- [Audience Member] How are the
coordinates of the different
bodies in the solar system tracked?
How are the coordinates
- [Audience Member] How are
they stored, like what is the
system that you store the
Okay.
- [Audience Member]
Location of everything in?
Great, great question.
So like how do we store our rotations,
and as well our orientations, et cetera.
So, there is a frame rotation system,
they can be stored and quaternaries,
or they can be stored
as rotation matrices.
And I prefer that when they
are stored as quaternaries
because then you can get
the derivative very easily.
We often need the derivative
of the rotation as well.
And it's just an abstract interface
that is from base, and then to base,
and then you have the name of the base,
and the name of the target frame.
And this forms a tree right?
And this is one of those wonderful
computer science problems that of course
game designers probably have
discovered this on their own.
But you have this, this
tree that has the base frame
and then the next frame,
and then the next frame,
and so on.
And if you just do this
breadth first reversal
from one to the other,
if you look at it as a graph,
it gives you the minimum number of hops
between the two points.
So it minimizes the
number of transformations
that you have to do.
So the system functions
a little bit like that.
You are in an arbiter-frame
you need to get to another arbiter-frame.
You breadth first search it,
you get the search graph,
and it gives you the transformation chain.
And the reason why it needs to be so deep,
again like in games, is
because you have the camera
which is mounted on the arm which is
mounted on the spacecraft
which is relative to the sun
which is relative to,
so it's a very, very extended chain.
- [Audience Member] Just an
algorithm question, (mumbles)
Yeah, what is the root frame of reference?
There are two.
So the official one is called ICRF,
the International
Celestial Reference Frame.
And then you can refer
it to the ecliptic plane,
meaning the average plane
where planets orbit.
Or you can refer it to
the Earth mean equator
of the year 2012, on UTC.
And so again it's,
doesn't matter what it is
as long as it is something,
and the one that is commonly
accepted is ICRF frame.
Then there's another one called EME 2000,
and again some of them
differ by clocks, et cetera.
But in the end all your calculations
will go back to ICRF.
And it's, it's a published standard.
If you Google ICRF you, you'll see how it,
because of course the
work of many wonderful
astronomers to come up with it.
- [Audience Member]
When you're solving the
differential equations
how do you determine
the time steps for, to
minimize error or whatever?
So it is, it, that's
an excellent question.
It is adaptive step size, so,
you cannot just, there's
a lot of experience
that goes into it, but it has
to be adaptive at the step
so you just have these minimization
of the truncation, you
also have to be give
longer time steps to slow, to
increase the propagation speed
the speed at which you get the result.
And also make it small, but not too small,
because then you have truncation error.
There is a, we use Adam's methods,
as opposed to Rashi Kuta.
That are a little bit more capable in
their throughput and
you know, error control.
But yeah, every control in propagation
of the differential equations is,
an entire topic in and of itself.
And there's also the simplecticity.
Meaning that sometimes you need
the energy to be conserved.
Which is not, with Adam's
or Rashi Kuta methods.
- [Audience Member] Right.
So there's the simplectic propagators,
- [Audience Member] So you do
correction for energy then?
If you do simplectic,
you just get for example,
Jacobi's constant, and
then it has to remain
throughout the propagation.
But those cannot do adaptive step size,
so you just have to pick the
step size and stick to it.
And if you do, Rashi
Kuta or Adam's or just,
you know whatever other method,
then you have to accept
that you will lose energy.
And propagation itself,
especially gravity-assisted
propagation is a chaotic process.
- [Audience Member] Mhm.
So, very difficult.
It's very hard to predict the future.
- [Audience Member]
Any parts of those that
can be done analytically, or none at all?
Not really.
So the two party problem
has an analytical solution,
and it still has to be eruptive
because Kepler's equation cannot be solved
for the eccentric anomaly, analytically,
so you have to reiterate on it.
But it has an analytical solution.
But a three party problem and onwards
is proven not to have
an analytical solution.
Yes.
- [Audience Member] Have you
been asked about (mumbles)
like supercomputer to
base, like hours, seconds,
The, the question is how long does it take
to compute the trajectory
of a mission like Cassini.
Not too long, I would say it's in
the order of tens of minutes.
To compute one trajectory
given everything else.
To do the optimization of a trajectory
is something that can take many hours.
But for problems like planetary protection
where you need to vary
the initial conditions
a little bit essentially
you have a covariance matrix
and you have to sample it,
to account for all the disturbances
and simulate one time and another time.
At the end you simulate millions or
tens of millions of times,
that takes many months.
And one of the last thing I did,
is try just implementing that
planetary protection system
in you know, just to deploy on the cloud,
everything is C++ from scratch,
and now it can be done in days.
So in about a couple of days
you can get five million
simulations for planetary
protection purposes.
(mumbled question from audience)
Yeah.
You cannot dispose of any
spacecraft uncontrolled.
You need to throw it to
the garbage if you will.
You cannot just say like
okay it has stopped orbiting.
So take Cassini for example.
It, it was out of fuel.
It could have remained in
the Saturnian system for,
for whatever amount of time.
But it could be the case,
we cannot control it
and it just ballistically,
that it could hit,
say Enceladus, and contaminate it.
Cassini's carrying nuclear material.
It's irresponsible to do that.
So then the NASA is of
planetary protection,
which has conventions with other
international organizations
requires everyone to
dispose of it controlled.
So we decided that it would be,
you know, crashing it into Saturn.
When you do a mission like Europa Clipper,
you could hit Europa if
you don't pay attention
to what you are doing.
So when you have a nominal mission,
you extract the covariance, in other words
the certainty of every
parameter of that mission,
and you sample each one of them
and assume that the spacecraft fails
and determine in how many instances
did the spacecraft actually hit Europa.
And then, you know, you get
probability of failure given,
impact given failure,
of granted probability
of contamination and so on,
you make this Bi-Sn approach.
And that whole analysis is called
planetary protection, analysis.
(mumbled audience question)
Yes of course.
Yes.
- [Audience Member] When
calculating the transformations,
so you talked about the transformations,
Mhm.
(mumbles) numerical problems
(mumbles) number of
representation (mumbles)
It, there is a, if we run
into in numerical problems,
in representing the transformations
everything that we do
is in double precision.
The only that has to be
done in quadruple precision
which is only implemented
itself is the time,
for very precise, ranging calculations.
So, our clocks are now
super, super, super accurate.
And they have USOs,
ultra-stable oscillators,
and sometimes to do
the orbit determination
you need quadruple, on time only,
but everything else double precision
seems to be good enough.
- [Audience member]
Continuing on that question,
do you need to modify reference frame
in order to get better precision?
Like if you're doing
calculations around Saturn,
do you try to make Saturn
your reference frame
in order to reduce the
scales of the, the precision?
Absolutely.
That is called center switching,
and it's also represented as a graph
which also, you, you'll do
the graph search to do it.
So you have this tree, you have the sun,
and the very center of the
planets, orbits the sun,
and then within the very
center you have the,
the center of planet and then you have
the satellites of the planet.
And then every planet or every body
has something called
a sphere of influence.
So what the gravity dominates.
So when you enter the sphere
of influence of a body,
this tree system does this search again
and then it, makes that the center
and then everything else
is referred to that,
precisely to take advantage of the,
being closer to the
planet that is dominating,
then you get out, and it
center switches again.
Very complex process,
well it's not complex,
it's difficult to implement.
- [Audience member] Do
you get numerical problems
when you switch spheres of influence?
Yes.
Yeah, and at some point
you can only compare
two trajectories that were propagated
with the exact same algorithm.
If I come up with my good
center switching algorithm,
and you come up with your own,
it's normally accepted that
we cannot compare them.
Precisely because yours is a universe,
and mine is a different universe.
So yes they introduce a risk,
and to the point that they become a,
a singular thing that has
to be treated consistently.
- [Audience Member] Thank you.
Of course.
Well if there are no more questions,
I appreciate you attending this talk.
Thank you.
(applause)</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>