<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Pandas Time Series Analysis 6: Shifting and Lagging | Coder Coacher - Coaching Coders</title><meta content="Pandas Time Series Analysis 6: Shifting and Lagging - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codebasics/">codebasics</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Pandas Time Series Analysis 6: Shifting and Lagging</b></h2><h5 class="post__date">2017-09-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0lsmdNLNorY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">dear friends we are going to learn about
shifting and legging in pandas time
series today for the purpose of this
tutorial I have downloaded Facebook
stock price from Google Finance in this
CSV file and I am reading that into my
Jupiter notebook and preparing this data
from here now I can call shift function
on pandas dataframe to shift the prices
by one day one means it will shift the
prices by one day you can see that the
price of 15 which was 171 is now the
price on 16 it got shifted by one day if
you do - it will shift it by 2 so you
can see now the price is on 17 and since
15 and 16 doesn't have prices it will be
not a number you can see in this diagram
how shifting works it will just shift
the data points to the right hand side
okay now what if you want to be reverse
and you want to shift the data points on
the left hand side for that you can use
minus 1 and you will now notice that the
price on 16 which was 170 is the price
on 15 so shifting with positive and
negative values will just shift the data
points at either on right hand side or
left hand side now you can call the
shift method either on data frame or on
time CDs okay so this method is
available on both of it now you might be
wondering what is the use of this
shifting method so one common use in
financial analysis is to calculate let's
say percentage change in one-day prices
okay or let's just calculating the price
change in certain amount of day ok so
what I'm going to do here is I am going
to demonstrate that so we'll first
create
previously price column in my data frame
and the way you do it is by calling
shift so now I have previously prices
for all the dates you can see that on 16
my previously price was 171 using this
new column now it should be easy to
calculate the price change in one day so
what you need to do is just subtract the
previously price from today's price okay
and you can see that now I have one day
change here so on 16 the one day change
was minus one because the current price
is 171 previously was 170 current price
is 170 previously was 170 points so
pricing is minus one okay now how about
calculating five day return so I want to
look at the prices before five days and
I were to calculate the percentage
return so I will say Friday percentage
return is equal to you take a current
price which is a DF price then you take
the price before five days so this is
how you get the price before finest okay
this way you get a difference in the
last five days okay and since we are
calculating percentage I'm going to
multiply it by 100 and then take the
base price which is the price before
Friday's
when I run this I will get my fight a
percentage return okay for all these
days it is not a number because there
wasn't there is no price available
before five days but on 22nd the price
before five days is this which is 171 so
we are doing 169 minus 171 and using 171
as a base price to calculate this
percentage return now instead of
shifting the data points which is my
price let's say I want to shift my dates
so I want to keep my data point intact
and I want to just adjust my dates how
do I do that
well pandas has support for that also
and let's do that here so first I'm
going to simplify my data frame by just
having price column and this will remove
all other extra columns so my data frame
is now simplified now first thing I want
to check is the index you can see the
frequency of this index is none now in
order for partners to shift these data
it needs to know the frequency right so
when you are saying okay shift these
dates by one it must know like what is
the frequency and how the shifting
should happen so I'm going to create a
frequency so in this case it is a
business day frequency because talks
don't trade on weekends so you can see
that weekend prices are missing so after
18 19 and 20 was weekend so it is not
available hence it is a business day
frequency and you all know from previous
tutorial that to create a new day time
index we can use date range function
with start date of this
and I have 10 videos and we're just
going to say 10 and my frequency it is
business frequency and I'm going to save
that into this index okay so you see
that I have got a business frequency
date/time index and then you know what
actually I can directly do this okay
and that way my data frame looks same
three fifteen to twenty eight fifteen to
twenty eighty the same but the only
difference is my is that now my index
has a frequency okay now you can call
data frames T shift function T shift
will adjust the date and not the data
points so you can see that now the
prices is still 171 but it moved the
date by one day so 15 is now sixteen
here 17 18 and so on in my last date is
29 same thing you can supply negative
value to shift it in a reverse order
okay so that's all I had for this
tutorial you can find the link of the
Jupiter not book used in this tutorial
in the video description below
okay thank you very much for watching
and I will see you next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>