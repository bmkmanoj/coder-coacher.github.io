<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Pandas Time Series Analysis 3: Holidays | Coder Coacher - Coaching Coders</title><meta content="Pandas Time Series Analysis 3: Holidays - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codebasics/">codebasics</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Pandas Time Series Analysis 3: Holidays</b></h2><h5 class="post__date">2017-07-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Fo0IMzfcnQE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">dear friends today I am going to show
you how to handle holidays in pandas
time series analysis I will also
demonstrate how you can create a custom
holiday calendar and generate date/time
index out of it I'm on Google Finance
here and I am going to download Apple's
stock prices click on historical prices
provide your custom date range and then
click on this link to download these
prices in a CSV file I have this CSV
from first July to 21st July okay now
let's say due to whatever reason or you
do not have this date column in your CSV
file and it looks something like this
okay so I have all the prices
information but no dates but one thing I
know is my data starts from first July
and goes to 21st July okay now I have
launched a Jupiter not booked here
and loaded this CSV file into a data
frame and if I use my usual business
frequency so if you remember from my
last tutorial you can use data range
function in pandas to generate the date
time index so let's say my start date is
first July my end date is 21st July and
my frequency is BiBi means of business
day frequency okay you will notice that
this is having force July now for july
was a holiday in u.s. because it is at
Independence Day okay and stocks are do
not trade so if you look at our
downloaded CSV file you will not see a
price on 4th of July so if I use this
date time index on my data frame it is
not going to work because it has forced
July I want to exclude all the holidays
in u.s. ok so B is not going to work
we do not have any predefined frequency
that takes into account us holidays so
you have to use us holiday calendar for
this purpose let me import the classes
for u.s. federal holiday calendar these
are the two classes that you need to
import and I will create a custom
business day here so create an instance
of class custom business day and supply
calendar to be the u.s. holiday federal
calendar now you can use this as a
frequency in your date range function so
instead of saying B I am saying USB and
now it doesn't have fourth of July so
this particular frequency will exclude
all US holidays okay and now I can
safely set this on my data frame as an
index okay and remember to set in place
equal to true and if you execute this
you can see that now I don't have force
July and I also don't have weekends so
just to recap the quick difference be
frequency will exclude only weekends and
not holidays verses this particular guy
a USB will exclude weekends as well as
holidays so this was about us holiday
calendar what if I want to use Indian or
Chinese holiday calendar well if you
look at the finders library so first of
all pandas is an open source so it has
all its code available for public on
github.com and I am here on the holiday
file so you can see that I have a US
federal for
the calendars here but I do not have any
other calendars so this calendar is
present just as an example okay and what
you should be doing really is using this
extra holiday class to define your own
custom holiday calendar okay and I will
walk you through a process of how you
can do this so what we're going to do is
we are going to copy the US federal
holiday credit Calendar class here okay
so I will go here
okay the class okay and remove all of
these guys okay
and really I am les I am building my
birthday calendar so my birthday
calendar and my birthday affects my
double birthday okay and my birthday is
the 15th April okay I will not worry
about this last parameter for now okay
this is how you can create your own
custom holiday calendar let's say you do
whatever reason my birthday is a
national holidays let's have a very
popular person okay and I want to use
this as a calendar in my time series
analysis okay so I need to now import
couple of classes I need to import this
and when I execute it it worked okay I'm
now going to create my own frequency so
this is my calendar okay and you know
how to do this a custom business day you
need to create an instance of custom
business day class and then supply
calendar arguments so my calendar here
is my birthday calendar okay and by
doing this you are creating
and instance of my birthday calendar is
applying it as an argument here when you
execute it you can see that it created
an instance of custom business day class
which you can supply in benders date
range function so let's say I'm creating
a date range between 1st April and 30th
April
ok so first and 38th Ethel
is my date range and my frequency is my
see when you execute this you can see
that of 15th April is missing
let me check what was a day on 15th
April now 15 that reel was a Saturday
actually so we don't know if this work
quite the way we expect it to work so
what I'm going to do now is change the
date to be let's say 12 so 12 here and
you can see that 12 is missing now so
whatever holidays you define here will
be missing from your date time index all
right so you can see 12 is missing here
11 and a degree 13 okay
now sometimes you have noticed that in
us if holiday comes on weekend then it
is observed on a following weekday okay
or maybe a previous Friday so in this
case my birthday was on 15th April which
was a Saturday but let's say I want to
observe holiday on 14th ok so the way
you do that is by supplying this
particular argument here where you will
say observance is nearest work date
okay so nearest work day for 15th April
is Friday okay if it was 16 then the
nearest
work day will be 17 okay so when I
execute this we'll see what happens so
now you notice that after 13 so again
going back to the calendar after 13 14
15 and 16 a holiday and you can see I am
directly on 17th here so 14 is holiday
because it the 15th holiday is observed
on Friday which is 14 right if this was
16 then you will see that okay so this
is 16 so going back to the car calendar
for 16 I will have holiday on 17 so you
can see the 17 is missing so I have 14
indirectly 18 so 15 16 and 17
are holidays okay now if you go to panel
documentation you will see all the
possible values that you can supply as
observance argument so you can choose a
nearest workday or previous Friday next
Monday whatever it is a convenient and
whatever is the correct thing in your
logic now in countries like Egypt the
weekend is Friday and Saturday and
Sunday is a normal working day so how do
you handle that okay for this will again
look into custom business day class
documentation so if you click on shift
if you press shift tab then it will show
you the documentation and you can see
that it has a week mask which is said to
be this value okay now you can modify it
so by default your weekdays are Monday
to Friday but you can actually customize
it so let's do that for Egypt all right
so I am creating a new custom business
day and as a parameter I am supplying
week masks to be death okay now for
Egypt I need to say
sunday is my working day and Friday is
my weekend okay and then use this into
your date range function as a frequency
when you execute this you will notice
that okay let me make it till I actually
now you will notice that in July on
Saturday was first July so that was the
holiday but sunday was second July so
you see that that is not a holiday
basically not we can not holiday it is a
normal working day okay and third fourth
fifth sixth and again seventh and eight
are off because their weekend so you can
see that after 6:00
I have directly nine let's say if you
are living in some imaginary world where
only working days are Sunday and Monday
and remaining days are all it is then
you can see you see here is what you get
in in diamonds of July you have to work
on you on this day I wish this that was
true but it's not quite possible
unfortunately in this capitalist world
okay so reverting back alright now what
about holidays so the holidays in Egypt
are different than in u.s. okay so let's
see my holidays is I mean I don't know
what are the holidays in Egypt was but
let's say for July was a holiday in
Egypt then you can supply it as a
holiday argument in your custom business
day function so this is the format that
you need to provide okay so when you
execute this you can see that fourth
July is missing here so this is how you
can define basically your custom
business that you can say week math and
can provide a list of holidays here and
that will create a desired frequency so
you can see that panel is pretty
feature-rich it allows you to customize
it to whatever is your need I have
provided a link of this to Peter not
book in a video description below so
feel free to download it and play with
it I always suggest that as you are
watching this tutorial you should all
start coding along with me because our
coding can be learnt only by doing it
you cannot just watch this video and
expect to learn or become a master of
pandas you have to try it out so
download this notebook and make the
changes in it play with it and that way
you will get a better understanding of
it so this was all I had for this
tutorial thank you very much for
watching and I will see you in next
pandas time series tutorial bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>