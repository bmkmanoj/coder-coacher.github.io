<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Pandas Tutorial 8. Concat Dataframes | Coder Coacher - Coaching Coders</title><meta content="Python Pandas Tutorial 8. Concat Dataframes - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codebasics/">codebasics</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Pandas Tutorial 8. Concat Dataframes</b></h2><h5 class="post__date">2017-05-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WGOEFok1szA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">dear friends welcome to code basics
coding tutorial in this tutorial we are
going to learn about pandas concatenate
now concatenate is an operation that you
do when you want to join two or more
data frames or without talking much
about it let's jump straight into it so
I'm going to run
Jupiter not book as usual now if you are
not watch my Jupiter not book tutorial
before then I would say you should pause
here and watch that tutorial first okay
so I have my are not book up and running
I'm going to click on new and start a
new notebook and the first thing that we
do or always is import pandas as PD now
I'm going to create my data frame first
okay so we are going to have weather
data stored in two different data frames
so let's say I have India weather and
for in the weather I have name of the
city okay so let's say I have three
different cities in India and for these
cities what I have is a temperature data
so this represents an average
temperature throughout the year in these
three cities and another thing I have is
humidity so the humidity levels in
Mumbai I know they are pretty high so
I'm just putting some numbers here Delhi
is pretty dry so the humidity would be
low and again Bangalore it should have a
high humidity and now you're going to so
what I'm going to do is just create a
data frame out of it
okay and so this is how you can create a
data frame by giving a JSON object as an
input and when you say control-enter
it's going to show you that date of M so
I have this data frame right now I'm
going to create second data frame which
will be let's say whether in USA so this
will be us wither and I'm going to put
some dummy data here so let's say I have
New York Chicago and let's say Orlando
ok so are these three cities and some
average temperature so which temperature
let's say New York is this much because
I know is pretty cold
whereas Orlando is hot and let's say
these are the humidity levels in these
three cities okay now I have two data
frames and I want to now join these two
so that I can get a single data frame
which has a weather data for all the
cities in India and in USA so pandas
provide PD dot concat function so in the
period concat function the first
argument you pass is the data frames
that you want to join together now I
have two data frames here India weather
and us later you can actually pass more
than two data frames here and it should
work okay all right and this should
return back a data frame object okay so
when I execute this you can see that it
created a single data frame which has
data from all the cities okay now here
what it is doing is it's using the index
from original data frame so you can see
that the New York's in there
is still zero okay so sometimes let's
say you want a continuous index so you
want to have 0 1 2 3 4 5 in that case
you can what you can do is you can pass
an argument in concrete function call
ignore index ignored index is equal to
true and when you do that you will see
that now you got a continuous index okay
so if you want to know more about all
the arguments that pandas concat
function can take then just go to pandas
website documentation and here type in
concrete and it should give you the
documentation on various arguments that
it can take
we just used ignore index which was by
default false we made it through and
then it will just ignore the index in
your original data frame okay now you
can also pass keys or let's say I have
this data frame here now I want to
retrieve the better data for Indian
cities from this data frame so the way
you can do that is when you create this
data frame right here what you can do is
you can pass an additional arguments
argument called keys okay now what this
Keys is going to do is ok let me
increase the font size a little bit so
that you can see better ok so what this
Keys is going to do is you can associate
a key with each of these data frames
that you have passed in this list here
ok so my first data frame is India
weather so I can pass India as a key and
US as a key for the second data frame
and when I run it ah alright so this is
what I get I think something is wrong
let me choose ok so looks like if you
have index ignore index then it doesn't
work so
you have to remove that so now you can
see that it created an additional index
so you have this numerical index for
each of the rows in addition to that it
created this additional index for your
subset of a data frame and the way you
can use this index is you can simply say
D F dot log
hello systems for location and if you
say India then now you can retrieve a
subset of your data frame similarly if
you say us you will get back your us
data so having this index is useful when
you have merged your data frames into
big data frame and then from big data
frame now you want to get your original
data frame back for a specific criteria
okay so that's the use of keys
okay now until now what we did is we
appended to data frames on top of each
other but sometimes you might have a
case where you want to append second
data frame as a columns instead of
appending just as rows okay so let's
look at such a use case so let's say you
have a temperature data frame okay and
this data frame contains only
temperature data so let's say it looks
something like this
okay and when you print it it's gonna be
okay I made a mistake here
I should have done PE take a thing so
let's say P get a frame and when I
execute this I get a temperature data
frame and and then you can have data op
wind spin in into let's say another data
frame so what you have is data from same
cities but instead of temperature now
you have wind speed okay and I'm just
going to put some numbers here
and this needs to be data frame it can't
be a plain dictionary and your wind
speed looks like this so now you have
these two data frames and when you
append these two data frames ideally
what you want to see is you want to see
wind speed appear as a column in your
original data frame okay so you want to
get a final data frame which has city
temperature and wind speed so how do you
do that if you just do PD dot concat and
pass in the argument these two data
frames so let me pass these two guys
here and then you okay this should be PD
okay and save your result into this DF
then what happens is it's going to just
append the second data frame as rows
here what you want is wind speed to
appear as a column so that this part
right here should go here okay it should
not create additional rows in order to
do that you can use X's argument
so when you say X is equal to 1 okay now
let's look at the documentation so when
you see the documentation by default x
is 0 means it will append second data
frame as rows but when we change X is to
be 1 now it's going to append them as
column so you can see that now you have
temperature of Moomba is 32 and wind
speed is 7 okay now what might happen is
let's say the order of these cities is
different so what I'm going to do is
data is always not perfect so let's say
you're missing data from Banglore and
the order of city is different here so
first you have boom Delhi and then you
have Mumbai ok and now when you execute
this see what happened is
it just went by the rules so first was
Mumbai and first / still here so Mumbai
and Delhi here so it just upended them
now this doesn't look correct you want
Mumbai to be here right so in order to
do that you can use index arguments so
in pandas dataframe you can while
creating a data frame you can always
pass an index okay so let's say my index
here is 0 1 2 so 0 corresponds to Mumbai
Delhi is one and Bangalore is 2 I just
pass 0 1 2 even if you don't pass it is
still taking the right index okay and
then here in my index now see Delhi's
index is 1 so I will first pass 1 here
and Mumbai is index is 0 so I will pass
0 here and when I do that I get the
correct index now you see dally has 1 so
here also Delhi has 1 and Mumbai has 0
so here also Mumbai has 0 okay now when
I run this see now it's going to work
okay so Mumbai has 32 as a temperature
well as a wind speed so here you can see
12 is my wind speed so now this is
working correctly so remember to use
index index is a way to align our rows
from different data frames while using
concat operation nothing we are going to
cover is we can also come join our data
frame with a series so let's say again I
have this temperature data frame as you
can see here and if you have let's say a
series okay so let's say you have pandas
series here okay and ponder series let's
say the name of the series is s the
event okay and let's say you have
so what this series contains is an event
like overall how is the weather in these
three cities so let's say in Mumbai it
is often humid so humid is the main
event in Mumbai in Delhi it is often dry
and sunny so I'm going to put try and in
Bangalore it often rains okay so this is
how I created my series and now I want
to append this series into this data
frame so again you can use pandas
concrete operation here and then in the
argument you can pass your temperature
data frame and your second argument is
your series and here now you are going
to say X is 1 because you want to have
event as a column you don't want to
append as new rows okay and then you get
your resultant data frame so then you
execute this you can see that you just
added your series as a new column into
date of M okay
so that's all we had a we had for this
tutorial in the next tutorial we are
going to look into better way of joining
two data frames and that better way is
March so for example in this case here
when you join two data frames you have
to explicitly mention this index
wouldn't it be nice if it can
automatically detect these values of the
cities and it just joins them in a
correct way so that you don't have to
pass the index that better way is given
by maj and that's something we are going
to talk about in our next tutorial until
then goodbye and thank you very much for
watching or the not not booked created
in this tutorial is available in the
video description below I have a github
link it is all free to download so you
can download it and play with it alright
thank you very much for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>