<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Pandas Tutorial 12. Stack Unstack | Coder Coacher - Coaching Coders</title><meta content="Python Pandas Tutorial 12. Stack Unstack - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codebasics/">codebasics</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Pandas Tutorial 12. Stack Unstack</b></h2><h5 class="post__date">2017-07-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BUOy4RUUepg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">dear friends in this tutorial we are
going to look into one more data frame
reshaping technique called stacking on
stacking let's say you're analyzing
stock market data which is coming in
this format where you have two level of
column headers the first level is the
metric that you are analyzing such as
price and PE the second level is the
name of the company itself now let's say
for my data analysis purpose I want to
transform it into this particular format
where I have taken one of the column
levels let's say company and transpose
it into a row you might also want to
let's say or take the metric from your
column level and transpose it into a row
level all of this can be achieved using
stacking as usual I have launched a
Jupiter not booked by running Jupiter
not booked command on my command prompt
and here is the notebook that I have now
I am going to use pandas read axel
method to read this excel file
remember to supply the header argument
so in this file here I have two headers
or a two level of headers so 0 and 1
that's why I am supplying 0 and world as
an argument value and this is the data
frame that I got now to stack this to
stack the innermost level of column
headers all I need to do is called stack
method on my data frame and when I do
that you can see that it took name of
the company from column level and now it
transform it into rows now if you want
to take let's say the first level of
column headers instead then all you need
to do is supply level so you can say
level equal to 0 ok and then it will
the name of the matrix and transpose it
into rows right now if you check pandas
documentation plunders that
documentation right so if you check that
then you will see level as one of the
arguments and the second argument is
drop any so if you have any any values
and let's say drop those roles you can
supply this to be true you can use
unstack to perform the reverse
transformation so let me store this data
frame into DX tact okay so let's say my
DF that looks something like this okay
and I want to now perform a reverse
transformation you can say DF stack
torque on stack and you will get your
original data frame back as you can see
here now you can perform stacking and
stacking with n number of column levels
so let's say you have another excel file
like this where you have three level of
column headers and the first level kind
of indicates the category of those
metrics so for example price and price
learning ratios really fall into price
ratios category and then you have some
more metrics such as net sales and not
net profit which falls under income
statement category all right so I'm
going to read this excel file into my
data frame so I will say DF let's say 2
is equal to PD dot read Excel and the
name of the excel file is stocks
underscore three levels dot dot xlsx and
again you need to supply the header
argument so as you can see I supplied
here there as 0 and 1 here I need to
supply it 0 1 &amp;amp; 2 values because I had
three level off column headers and
execute it I see this nice data frame
with three level of column headers now
by default when you call stack is going
to take the innermost level and
transpose it so you can see that now I
have my company name here at a row level
you can always use the level argument
and say okay I want to transform let's
say transpose my first level which is
really the category of the metric so
when you do that you get values like
this you can now you can see that price
ratios are net profit price ratios is an
end because it's not really applicable
net profit is not applicable enterprise
ratios category
you can also do level one and then there
was one is this guy right here and it's
going to transpose it at a column level
or you can do level two which is same as
not supplying that argument all right so
that was really it about stacking
unstacking I hope you're enjoying this
tutorial I have posted a link to the
Jupiter not book used in this tutorial
in the video description below if you
liked this tutorial please give it a
thumbs up comment or share with your
friends thank you very much for watching
this video and I will see you in that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>