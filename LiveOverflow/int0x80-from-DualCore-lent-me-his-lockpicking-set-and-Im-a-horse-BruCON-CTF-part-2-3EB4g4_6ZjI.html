<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>int0x80 from DualCore lent me his lockpicking set and I'm a horse - BruCON CTF part 2 | Coder Coacher - Coaching Coders</title><meta content="int0x80 from DualCore lent me his lockpicking set and I'm a horse - BruCON CTF part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LiveOverflow/">LiveOverflow</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>int0x80 from DualCore lent me his lockpicking set and I'm a horse - BruCON CTF part 2</b></h2><h5 class="post__date">2016-11-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3EB4g4_6ZjI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">last video we had a lame virtual
lock-picking challenge but there was
also a physical lock-picking challenge
on the table of the organizers was a
sealed package with a basic padlock that
you had to open the only tools available
were paperclips that's like how it's
done in the movies I'm not explaining to
you how basic lock-picking works I also
don't really know much about it and
failed the challenge at first I didn't
know that I had turned the lock in the
wrong direction and I thought paper
clips are just too weak but I wanted to
tell you a short cool story about it so
the guy who is filming right now is in
fact in 80 from dual core and makes
nerdcore music but he's not only a
musician but play CTF and even held a
talk at brew con about forensics process
execution continues we maintain
persistence we keep getting our shells
we're doing awesome he was super nice
and happy to lend me his lock picking
set and also told me I had to turn the
lock clockwise but it turns out the lock
was a bit too small for the picking set
so he showed me how I can use two coins
to twirl the wire and make the paper
clips tools stronger and then I tried
again and succeeded it's just so cool
what kind of people you can meet at
conferences so thanks in 80 you're
awesome
let's have a look at a challenge I
didn't solve OS in the description says
you have been associated with this case
apparently a cyber criminal is planning
a new attack with a partner we have a
file with an email head of sent by the
criminal this header was sent by the
former investigator on previous week to
his disappearance so the first reason I
want to talk about this challenge it's a
good example for how not to design a
challenge I have no idea what to do
apparently it's about forensics recon
open-source intelligence whatever which
probably means I simply have to look
around and try to find something that
looks like a flag but there is no goal
nothing to aim for I can't tell if I
make progress or not the challenge was
very frustrating because of this and
eventually gave it up so when I had a
first look at the provided email I want
to know what the content says so I had
to translate the subject and content
didn't tell me much from the male
headers I saw that the email was sent
from this anonymous mail service 5y mail
so the second reason why I want to show
you is challenge is that because of this
task I had a look at 5y mail and learned
when awful anonymous mail server said is
that thing is rubbish the first thing I
did was to send myself an email with
this service to have a look at the
headers when you sent the anonymous
email it will generate a username and
password for you and now hold your head
let's have a look at the email headers
for that email the email listed in reply
to looks very similar in fact it
contains the auto-generated username and
password what the at this moment I
thought whoa this challenges squawk we
are abusing this real service the plan
was clear extract the password username
from the header lock into that service
and probably find the flag there but it
turns out you can't login with those
credentials I asked one of the
organizers if he can check if the
channel still works because somebody
else could have changed password and
block out of place but he verified that
it still works and I'm on the wrong
track oh well
another small thing I learned about the
service is this weird end point that
tells you the subject of the last
received emails what the freaking out
isn't this supposed to be like a private
anonymous mail or whatever and to make
things even worse you can inject XSS
into the email subject
well what I I don't understand what why
the only good thing about the services
that based on the leak of this end point
I learned that this email service is not
used much which makes me very happy
so yeah after all this I gave up on this
OSN challenge to this day if no idea
what I have to do if you know the
solution or you figured it out please
tell me this challenge makes me crazy
okay move on to another challenge this
challenge is called selected access and
the description says that the site only
allows entry to horses and we have to
show that we are a horse there's also a
hint saying that we should have a look
at index dot BK so let's get started
this is the challenge URL it says this
is a test to verify if we are horse ok
well then I start by looking into the
HTML source to get a better feeling for
what functionality that page might have
but turns out there is not much besides
this picture in the HTML comment the
picture is a decision graph that we can
follow to check if we are a horse and
apparently there is no way for reaching
that conclusion we always will be human
now when we look into the index dot BK
hand we can find some PHP code so that
might be the source code of the other
page I copy the code into sublime to
have some syntax highlighting and let's
have a look at the code the code checks
the question parameter and then the
answer parameter and then there is a
switch case that sets a certain URL to
be fetched with curl and the response
will be emitted in this page so I
immediately thought I should go for the
input C brew dot PHP I mean what other
goal would there be other than going for
the impossible script this means I want
to question 5 with answer No
okay interesting we get an el mayo and
that horse
don't cheat that confused me they even
tried to use the sentence as a flag but
obviously that would have been too easy
so what else could it be
always when I see curl I'm hunting for
server site request forgery or similar
bugs because if we could control the
whole URL we could try to access some
other servers only available from
localhost or maybe even a file from the
system but that didn't really work
because we can only append values to the
urls we do control basically what we
append because it takes a question
number for example five which would
result in our five equal and then it
would append the answer to that and we
could set answer to anything we want but
it doesn't help us much I then started
to head into the wrong direction and try
to figure out if there's a curl back
that I'm not familiar with turns out
it's really annoying to search for PHP
call exploit or similar search terms
because so many small exploit scripts
are written in PHP with curl and that
doesn't help me but after I put this
challenge aside I realized I've been
obsessed with the wrong strategy I don't
know why I had the revelation but at
some point I realized the goal is not to
get input zero but passed the correct
answer to the five PHP script in turn
and that is fairly easy first of all we
have to make sure that the question will
be 5 but the answer not no so what we
can do is we can simply inject more
parameters via the answer variable so I
simply set the answer to yes but
follow it up with another and % URL
encoded followed by the r5 equal to No
now when the string is spilled it will
do r5 equal yes and %
are 5 equal no and that will append to
the 5 PHP for the kuru quest and yeah
the our 5 parameter is there twice but
that doesn't matter because the strip
will only see the last one in this way
we load the 5 PHP script that gives us
the flag I am a beauty horse also while
editing aria
the simple solution would have been to
simply use our five equal no followed by
an encoded ampersand because then the
answer would still be not no because it
would be no ampersand but the five PHP
script requested by a curl would then
only CD no that's it for this video I
think there will be one more broken CTF
video right up there was a challenge I
really liked and I want to show that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>