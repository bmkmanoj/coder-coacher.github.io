<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>KRACK - Key Reinstallation Attacks: Forcing Nonce Reuse in WPA2 | Coder Coacher - Coaching Coders</title><meta content="KRACK - Key Reinstallation Attacks: Forcing Nonce Reuse in WPA2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LiveOverflow/">LiveOverflow</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>KRACK - Key Reinstallation Attacks: Forcing Nonce Reuse in WPA2</b></h2><h5 class="post__date">2017-10-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fOgJswt7nAc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">a lot of hacking videos on YouTube are
about Wi-Fi hacking they show you how
you can use various tools on Kali Linux
like air crack or somedy author to dos
clients but it never wanted to do that I
find it quite boring that doesn't mean
that I'm entirely not interested in
Wi-Fi hacking it's just that if I would
make a video about it it would be about
one specific attack in detail how it
works rather than just how to use a tool
and so with the reason disclosure for
crack kiri installation attacks on wpa2
I figured that's the perfect moment to
do exactly that
keye reinstallation attacks forcing
nonce we use in wpa2 by Matt even have
released around October 2017 is a paper
detailing a specific protocol flaw and I
encourage you to read this paper because
the news around this attack is obviously
going completely insane with so much
misinformation going around and so if
you are actually interested in what this
attack means how it works and what are
the actual threats read it from the
source
I know papers can look intimidating but
it's often enough to read the abstract
and the conclusion to get a good
intuition for what this is about and
then you have all the content in-between
to go more in depth so let's start with
that all protected Wi-Fi networks use
the four-way handshake to generate a
fresh session key
however we show that the four-way
handshake is vulnerable to a key
reinstallation attack here the adversary
tricks a victim into reinstalling and
already in use key this is achieved by
manipulating and replaying handshake
messages when reinstalling the key
associated parameters such as the
incremental transmit packet number nuns
and the received packet number replay
counter are reset to their initial value
our key reinstallation tech also breaks
the peer key group key and fast BSS
transition handshake the impact depends
on the handshake being attacked and the
data confidentiality protocol news
notably our attack is exceptionally
devastating against Android 6.0 it
forces the client into using a
predictable or zero encryption key so
there is a lot of information here and
let's try to dissect the meaning of this
all protected Wi-Fi networks use the
four-way handshake to generate a fresh
session key figure 2 shows the messages
exchanged when a client connects to an
Access Point and of course those initial
messages are not encrypted you see that
after the 4-way handshake encrypted data
frames can now be exchanged the fresh
session
they were talking about is the PT K the
pairwise transient ki which is derived
here the PT K is generated by
concatenating the pairwise master key
which itself is derived from basically
the password you enter for the Wi-Fi the
access point nuns a nonce you see it
here being sent from the access point to
the client and the client nonce
S nonce which is generated by the client
and sent to the access point but that's
on all also the access point MAC address
and the station MAC address is used in
the generation of the PDK so using this
pre shared secret the Wi-Fi password
both the client and server now know the
same pairwise transient key and you can
already see here what that means
generally for the security if anybody
else knows the Wi-Fi password and
observes the nonce s being exchanged
they can derive your pairwise transient
key and can decrypt your traffic so when
you connect to a secure Wi-Fi in a hotel
you might not be as secure as you
thought you would be but that's a
different issue and then there are
different protocols to actually
implement the encryption for example if
TK IP is used then the encryption
algorithm is rc4 and that is basically
the same as WEP and therefore vulnerable
to a number of similar attacks but
another option is the ccmp protocol
which is a SNCC m-mode counter mode with
cbc-mac
it is secure as long as no
initialization vector IV is repeated
under a particular key and div here is
the nonce and the nones
is again constantly incremented to make
sure it will never repeat and basically
the same is true for the GCM P protocol
it uses AES GCM and as secure as long as
no IV is repeated under a particular key
if that sounds weird to you
you should watch my video breaking ECDSA
elliptic curve cryptography of course
ECDSA is very strong but there can be a
flaw if it's not properly implemented
namely if a
value is used for a parameter instead of
a random one so very similar in the
sense that the security of a crypto
algorithm can be very fragile and so for
these algorithms if the IV the nonce is
reused for the same key it can be
probably be broken so you can kind of
see what this is going let's continue
reading we show that the four-way
handshake is vulnerable to a key
reinstallation attack here the adversary
tricks a victim into installing and
already in use key this is achieved by
manipulating and replaying handshake
messages just in case it confuses you
what reinstalling or installing the key
means it basically just means that the
protocol decided this is the key we use
if you make an analogy of how that would
be implemented in code it's basically
just assigning the key node to the
variable the key we use
okay so radio networks or any other
communication has to handle the case
when messages get lost and they have to
agree how to handle that
for example retransmitting them and so
because messages may be lost or dropped
the access point will retransmit message
three if it did not receive an
appropriate response as acknowledgment
as a result the client may receive
message three multiple times each time
it receives this message it will
reinstall the same session key and
thereby reset the incremental transmit
packet number nonce we can show that an
attacker can force these nonce resets by
collecting and replaying retransmissions
of message three when reinstalling the
key associated parameters such as the
incremental transmit packet number nuns
in received packet number replay counter
are reset to their initial value
depending on which protocol is used this
allows an adversary to replay decrypt
and/or Forge packets and so it's now
easy to imagine that if you can keep
resetting the key parameters some crypto
stuff will be effed up
and this is a protocol flaw because the
specification is not quite clear about
how to handle a retransmit of message
three and thus opening the door for
certain crypto attacks depending on
which crypto algorithm is used some are
more susceptible than others the author
also checked the behavior of different
implementations and it turns out I OS
and windows both don't follow the spec
and don't accept the retransmission of
message three and the worst
implementation is by some Linux based
systems because there is an additional
implementation bug that resets the key
to all zeros so you don't even have to
perform this crypto attack limiting you
to maybe only in the cripton I don't
know because with this flaw you actually
know the key because all of the values
are set to zero okay there are a lot of
technical details and challenges and
nuances that you can read about in the
paper I presented it more simplified but
hopefully it's more accurate than some
other news headlines
so summarize WIP 2 uses a four-way
handshake where nonces are exchanged and
used together with the Wi-Fi password to
generate the key this key is then used
for encrypting packets how it is used
depends on the actual crypto algorithm
being used a lot of crypto algorithms
are very fragile when certain values are
reused and the attack presented in this
paper is about forcing a reset of these
values specifically the nonce which
would be constantly incremented and thus
would always be different and that's
opening the door to perform certain
crypto attacks and this is a protocol
design flaw but additionally during this
research a very serious software bug was
discovered where on certain
implementations the key was not just
reset to initial parameters but was
actually set to zero so we actually know
the key and you don't have to perform a
crypto attack but you know what why
don't you read the paper
you don't learn hacking when reading
security news headlines or use the tool
math even half row
go read the actual research or at least
parts of it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>