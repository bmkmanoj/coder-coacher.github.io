<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GynvaelEN Hacking Livestreams and how stack cookies work | Coder Coacher - Coaching Coders</title><meta content="GynvaelEN Hacking Livestreams and how stack cookies work - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LiveOverflow/">LiveOverflow</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GynvaelEN Hacking Livestreams and how stack cookies work</b></h2><h5 class="post__date">2017-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dbVvypaN8_k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey goon well cold when is the captain
of the CTF team during sector and you
probably know that team because they are
very successful goon well does English
streams every Wednesday where he talks
about IT security exploitation and CTS
and of course you can ask him anything
you are interested about I'm always so
excited about it because he knows way
more than I do and it's one of these
very rare opportunities where somebody
who has a lot more experience and
knowledge shares it with us all you
definitely miss out if you are not
subscribed to him and watch his previous
recordings and tune in whenever he goes
live make sure to enable the bell and
set the reminders and just to give you
an idea what kind of stuff you can
expect from his stream I'm gonna steal
part from his last livestream and show
it to you and to give this video at
least some information on value so
here's good well talking about stack
cookies and how they try to make buffer
overflows not exploitable anymore
enjoy hi everyone I'm so cold wind and I
welcome you again on my weekly hacking
live stream if you overflow a buffer
which is a part of local variables you
basically have the right thing can you
override bertone address which means
that you get you a direct vestibule
execution to either your code or some
pieces of an existing code in memory
which you can can use to to do your
bidding basically right to do what you
will
now in case of cookies is i between
usually between ver turn in front over
to and address versus also something
called the coop you know the cookies
supposed to be a random value but the
attacker does not know and just before
the return statement will return right
the function exits just before this
there's a short snippet of assembly
which if cookie is not equal the magical
value if it's equal then whenever
whatever right yeah and if it's not
equal then call abort oh my god being
hacked and this function is supposed to
basically exit the program in a safest
way possible
maybe print some message but hey I mean
the values on the stack they're
corrupted something has overwritten by
cookie it's not what it should be
therefore yeah you have a hacker right
this is how a cookie usually works first
of all the cookie this cookie right it
has to be a random value therefore it vs
of a requirement but the attacker cannot
know this value because if their
attacker knows this value right
he will just over overflow this and then
write the right value here the correct
value here and then override whether
whatever and then we get to basically to
the compare and the comparison here is
equal because the attacker put the
correct value ver and we can return
safely right we never call this oh my
god I'm being hacked
so so yeah so the attacker cannot know
it and I guess that's the biggest
requirement and the second requirement
is that it should not be able the
attacker should not be able to brute
force that meaning and if I cookie
should be large enough for the bad for
attacker to not be able to run for
exploit enough times to somehow suddenly
magically gets the value for example if
a cookie cannot be one bite if I cookies
one bite when you just run your X by 256
times and use you get it right well
positive probability for you and you
will get it in 256 rounds or give or
take ten depending on what method you
actually choose and and how the output
of the random generator so the cookie
must be as good should have good enough
length and should be kept secret and
generated in a safe way now if you go to
a bacterium or bacterium is actually my
previous computer computer crap
it's called like this and if you go to
slash pub or some publications by
millionth matter usually yeah and verse
something called exploiting otherwise
known exploitable
as when basically in 2011 we did with
Matteo Utrecht some research on how
Windows kernel to analyze the cookies
and verse the paper
well this paper which you can read if
you're interested is basically we
analyzed how the Windows kernel for
Windows drivers how does it generate a
cookie as as I said before the cookie
needs to be safely generated in an
unpredictable way so battacor does it
doesn't know it and it turned out that
the way it was generated I think it was
done on Windows XP maybe up to Windows 7
now maybe maybe without Windows 7 or
maybe even hmm yeah yeah running on
Windows XP Windows Vista and Windows 7
and it turns out that the way the cookie
was generated was not actually correct
now here is the plot twist on Windows XP
kernel the way cookie was generated it
was basically like this cookie equals
constant the rostec constant was no
generation the cookie was always the
same and in every kernel file it was
always the same so you basically knew
that cookie right we didn't randomly
generated it doesn't if I cook it was
constant well usually in user mode right
what you can do is you can do something
like this right I don't know for example
read from def
you round of 4 bytes right and this
gives you a four byte cookie which is
unpredictable now the problem is that if
you're just running starting your
operating system then it it's also more
problematic because your dev you random
your like safe cryptographically save
random generator isn't yet initialized I
mean you just started putting the system
where is nothing but it's just like the
bootloader and the kernel is just
started how do you initialize a cookie
for of a kernel and it's a and for the
drivers that you need to really put
really early on like start really early
on and if a boot process and they turned
out not very using for example like
virtual address of a cookie even number
of ticks from the from when the CPU was
executed and and some other stuff and it
turned out that you could boil down you
can predict most of these numbers being
on the system you could predict most of
these numbers and in the end the entropy
was about
you have had like 1.55 bit which means
basically every three guesses you could
get the correct cookie and if you want
the details basically go to again
effects
I'm sorry bad word vexy loom with I ll
i.org
and vent application exploiting the
otherwise none exploitable
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>