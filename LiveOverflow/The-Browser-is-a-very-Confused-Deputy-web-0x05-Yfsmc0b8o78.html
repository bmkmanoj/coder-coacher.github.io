<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The Browser is a very Confused Deputy - web 0x05 | Coder Coacher - Coaching Coders</title><meta content="The Browser is a very Confused Deputy - web 0x05 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LiveOverflow/">LiveOverflow</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The Browser is a very Confused Deputy - web 0x05</b></h2><h5 class="post__date">2016-11-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Yfsmc0b8o78" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is nearly a true story the events
happened about 11 years ago at Tim share
a company which provided commercial time
sharing services this story is an
excerpt from a famous 1988 computer
science paper and at the end of the
story we will understand why the browser
is a very a very confused deputy but
let's continue with the story our
operating system was much like UNIX in
its protection structures a compiler was
installed in a directory called says X a
user would use the compiler by saying
run sex X slash Ford and could provide
the name of a file to receive some
optional debugging output we had
instrumented the compiler to collect
statistics about language feature usage
the statistics file was called sirs X
slash stead a name which was assembled
into the compiler to enable the compiler
to write this as X that file we added
the compiler source explored to the user
group the operating system allowed a
program with those permissions to write
files in its home directory sis X in our
case the building information file says
X bill was also stored in such acts some
users came to know the name says X bill
and supplied it to the compiler as the
name of the file to receive the
debugging information the compiler
passed the name to the operating system
in a request to open that file for
output the operating system observing
that the compiler had user permissions
let the compiler write debugging
information over says X Bill the billing
information was lost who is to blame
what can we change to rectify the
problem will that cause other problems
how can we foresee such problems the
fundamental problem is that the compiler
runs with the authority stemming from
two sources that's why the compiler is a
confused deputy the invoker yields his
authority to the compiler when he says
run says export the other authority of
the compiler stems from
user group permission the compiler
serves two masters and carries some
authority from each to perform its
respective duties it has no way of
keeping them apart when it produces
statistics and it tends to use the
authority granted by the user group
permission and when it produces its
debugging output it intends to use the
authority from its invoker the compiler
had no way of expressing these intents
the confused deputy Norman Hardy 1988
Wikipedia summarizes this s a confused
deputy as a computer program that is
innocently fooled by some other party
into misusing its authority it is a
specific type of privilege escalation
Authority might sound weird at first but
Authority simply means that it was given
the permissions and ability to perform a
certain action and it might have
unintended side effects because there
are multiple authorities involved and
this is what we see on the internet the
confused deputy here is the browser the
browser was given authority to handle
the sensitive user authenticated
sessions of a website but sometimes a
third party is invoking the browser to
perform something unintended for example
cross-site scripting a browser simply
executed JavaScript a browser doesn't
know if the script is malicious or good
like the compiler in the story didn't
know if the file name password is good
or evil but because the browser has the
authority of performing authenticated
requests somebody controlling this
javascript can fool the browser to do
something bad it's not the attacker who
performs the request the browser is
executing the attack not intentionally
but that's why we call the browser
confused
same thing with cross-site request
forgery a browser will simply parse HTML
and fetch every image embedded on that
site it doesn't know if a certain image
source is actually a URL that has bad
side effects like deleting a user
account but again the attacker tricked
the browser into executing a privileged
action and the weird thing is these are
executing JavaScript nor handling
authenticated session is a security
vulnerability this is not a bug in the
browser this is how the browser is
supposed to behave hell even injecting
JavaScript into a site by itself it's
not a vulnerability of the web
application you don't get code execution
on the server with it you don't get
access to private user data directly
from the server only because the browser
has special Authority and we tricked the
browser into doing it for us
it suddenly evolves into a security
issue
and I relief that this is a good way of
thinking when approaching and
researching a new piece of software
don't always look for this single-shot
vulnerability this one buffer overflow
to rule at all
think about what kind of legitimate
Authority our software has what are the
permissions and privileges it has that
you don't have and once you identified
such a system ask yourself can you
outsmarted can use the system to do
something else like we indirectly use
the browser to do actions its wikipedia
says this is a special kind of privilege
escalation you don't have the privilege
to access the private Facebook messages
of another user but if you get
JavaScript into a Facebook page then
suddenly you can confuse the browser and
indirectly derived this privilege now
another confuse deputy on the Internet
is the web server or the application
running on it there's a cool
vulnerability kind that is related to
cross-site request forgery just instead
of making the browser perform a request
we make this server executing a request
this is then called server site request
forgery as srf there's a legitimate use
case why asshole would want to be able
to perform requests when a user asked
for it but this can have devastating
results but this is our F will be a
topic for another video
something I haven't mentioned yet is
that the confused deputy store is
actually about introducing a reason for
a different permission model called
capabilities but we won't go into that
now I just think the concept of a
conscious deputy is important to know
and provides a good abstract
classification of security issues what
do you think is that an important way of
thinking see you next time and I hope
you don't get confused</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>