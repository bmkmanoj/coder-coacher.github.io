<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# Tutorial 23 Document API | Coder Coacher - Coaching Coders</title><meta content="C# Tutorial 23 Document API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>C# Tutorial 23 Document API</b></h2><h5 class="post__date">2017-03-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/sHD5j8ZUFBs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">wellö Internet and welcome to part 23
in my c-sharp video tutorial in this
part we're going to focus in on the
document API and we're specifically
going to cover the flow document reader
flow document page viewer flow document
scroll viewer and rich text box and what
we're going to do is use the document
API layout managers these guys right
here to work with formatted documents
using the XML paper specification or XPS
and to simplify that that's just going
to allow us to create robust documents
like PDFs they're going to work in much
the same way and so I have a lot to do
so let's get into it okay so we're
continuing on we're going to use the
same exact code we had before let's
increase this font size okay there we
are so what I'm going to do here is I'm
going to create another tab up here I'm
just going to right click inside of
there and come in here and click on add
tab item and then I'm just going to
start creating some stuff here so we
have our grid background I'm going to
get rid of that and then I'm going to
close off my grids grid there we go and
there we go and let's go and give this a
name that's going to make a little bit
more sense I'm going to call this flow
reader and this specifically is going to
reference the flow document reader and
it's read-only however it's going to
allow us to zoom as well as search
inside of our document and likewise I'm
also going to cover the rich text box
later on which is going to allow us to
display editable data in a flow document
and also the flow document page viewer
which is going to show pages but not
zoom or search and the scroll viewer
which is going to allow us to scroll so
I'm just going to show you examples so
I'm going to come in here first and we
go flow documents reader and then
there's a whole bunch of things you can
display here so we'll have the viewing
mode and in this situation I'm going to
have this set for page you're also going
to be able to use scroll as well as to
page and I'm also going to say that I
want find to be enabled so that's going
to allow them to search through our
document I'm also going to define that I
want the page view to be enabled
so let's make that true as well these
are all defaults but I'm just showing
you them so if you want to shut them off
are we going to be able to scroll
through this I'm also going to set that
for true and then you can set them for
false on your own just to see how that
changes things and also we will be able
to display them as two pages on the
screen at once which is basically not
really two pages it's going to be two
columns and I guess that's pretty much
all the different things we can do with
that so let's just close that off and
inside of here we're going to be able to
put all sorts of different things now
I'm going to not make this the neatest
thing on on earth just so that I can
cover a lot of things now inside of here
we're going to put a flow document and
now what we'll be able to do is come in
and throw in say a paragraph and we can
throw that there and let's say we want
to throw some lorem ipsum mums out of
there we can do that and you can see
it's displaying up there and whenever I
run it you'll get to see exactly what it
looks like we're also going to be able
to define lists inside of here and how
you do that is just go list and then
you're going to have all of your list
items so list item and then inside of
your list item let's go and let's throw
another paragraph inside of here and
here I'll just go item one and you can
see they're popping up here as I'm
displaying them and then we can do a
whole bunch more of these different guys
you just copy that paste that in there
and do as many as you'd like so two and
three I can also go in here and throw in
images and combo boxes and a whole bunch
of things like that to do that I am
going to create a block UI container and
then inside of this I'm going to create
a stack panel which is going to of
course stack everything inside of here
so everything I put is just going to
stack horizontally on our screens so we
can go and get an image and I went and
grabbed one ahead of time and you're
just going to go source and I put it
over here in my resources directory like
there open this up and it's called
turtle Peng so we can just do that get a
source like this and if we want to
reference the resources directory we
just go resources and turtle and
is a ping file and of course you're
going to be able to come in here and
define how big you want it to be I'll
just have its height be set for 64 and
they'll close that off so that's going
to left there you can see there is our
turtle you're also going to be able to
put combo boxes inside of here so let's
say I want to do something like throw in
a label and you're going to need to be
able to do things like change your text
foreground is how you change your text
by the way if I never talked about that
previously and we could do something
like favorites phone and then after our
label then throw in a combo box which is
going to allow us to select multiple
different options
combo box and then you're going to say
combo box item and you're going to be
able to say things like it is selected
I'm just trying to cover a whole bunch
of different things here as quickly as
possible and then you can throw
something like Android inside of there
and let's go and get another combo box
combo box item there is close that off
and then inside of this one we could say
something like Apple and then we could
do another one it's blackberry still
making phones I don't know let's just
start blackberry inside of there and I
don't know if that's one word or two and
you can see the combo boxes are
automatically being generated up inside
of there we're also going to be able to
come in here and do radio buttons so
let's say that I want to put another
label inside of here do so and
foregrounds will just go and change the
color again let's change it to red and
we'll say something like favorite color
and don't worry about the little errors
that it's giving me up there and let's
come in and create our radio button I'm
going to put that in another stack panel
and then inside of here we can go radio
button and we can put a whole bunch of
different options of course it's
automatically only going to allow one of
these options to be selected at a time
so you have this big blue and we can
have this be green and whenever I run
this you'll be able to see them let's
throw in another label inside of here
that is going to ask for a name
put your name and we don't need to do
anything with color there and we could
throw in a text box
whoops text box to allow them to enter
their name inside of there and we could
say name like that is going to show up
inside of the text box and let's just
close off the stack panel and everything
else we have here
let's say we also wanted to come in and
throw in an empty line in this situation
how we could do so is go paragraph like
that and that's going to work just like
a regular old empty line we could also
create tables so let's go and create a
table and how you define a table is
you're going to define how many columns
you want so I'm going to say column
table columns and then you're just going
to put a table column in here for every
table column you want to be able to
represent and let's just save that right
there and do this instead and we'll do a
copy on this paste into more of those
guys and then after that you define all
of your table rows and of course there's
tons of styling options I'm not going to
get into all of them I just want to
cover as much as I can cover here
quickly as possible just to give you an
idea of the power that is provided by
the document API so we can then command
Ango table row and then put some
information inside of here we're going
to say tables so and we can change the
column size of it so we'll say column
span is going to be equal to 3 and that
just means it's going to take up 3 of
the columns in this situation and let's
go in and let's change the background to
this just to make it stand out a little
bit to blue and close that off and
inside of here we can do paragraph and
let's say we want to have a little bit
of padding inside of this isn't ID of
the table cell you can see it being
created right here so I'm going to make
it a little bit bigger I'm going to
change it to 10 and then it's inside of
here we could do something like best
based all players and then I'm going to
close that off and put table cell down
here to close off my table so save that
and make sure this is padding with an
uppercase P you can
the best baseball player shows up inside
of there and we command and let's say we
want to change the foreground on this to
white I can read of paste all players
table rows go into clothes and if we
want to throw in another table row just
go table row and then inside of here we
can define a whole bunch of more cells
so we'll say table cell and let's have
the background on this be white instead
so wait and then inside of here we'll
throw another paragraph and put
something like name and it's do a couple
more of these guys table cell again this
is going to represent the whole entire
cell as you can see name popped up right
there let's do two more of them so for
the next one we could say something like
batting average and then this will be
homeruns
okay so you can see everything's being
created and you can just keep on going
going going as many of those different
rows as you would like and if we go and
run this you're going to see exactly
what we can do with this and here it is
okay so we can click on this and you can
see I can show it as a single page I'm
going to be able to scroll through all
this different information inside of
here I'm also going to be able to
perform searches so it looks like I go s
int like that it's going to go in here
and search for me there's that and then
I can just keep going to go and going
look for more of them you can also go
and have everything divided up into two
columns I can go in here and create a
scrollbar so you can scroll through it
and of course all of these different
guys are going to work for us okay and
also you're going to be able to zoom all
right so rough overview what we can do
there so now I want to take a look at
the B page viewer so I'm going to come
up here I'm going to create a new tab
item click on that it's going to open up
this guy get rid of that and let's come
in here and create another grid of
course I come up here change this from
tab item to page viewer or something
like that
we can increase our width of course for
our different tabs let's try 64 see how
that works
doesn't look like it's enough let's try
74 so that works getting there let's try
80 does that work yes page viewer now
shows up and
course you could do that for this all
the one as well went change this from
grids though let's get rid of that to a
stackpanel
okay and then inside of here I want to
talk about the flow document page viewer
this time so let go flow document page
viewer there it is and let's go and we
can give it a name let's try FD Page
viewer we can go and give it a height
let's try like 290 close that off and
we'll throw a couple different things
inside of here just you can see all
these workouts let's throw a flow
document inside of here to hold
everything I'm just going to have a
couple different paragraphs inside of it
nothing that fancy so we go and of
course you can use all the other things
that I already showed you inside of here
paste in some lorem ipsum and why don't
we just now just make another paragraph
and there we go and if we run that
you're just going to see that it's sort
of a stripped down easier to work with
doesn't have all the funky stuff inside
where so it doesn't have the search and
so forth but you're going to be able to
flip through all of your pages and
you're still going to be able to come in
here and zoom if you'd like to okay so
there's the that guy and I'll show you
the scrolling option it's also available
to us and let's just go add tab item
that guy is will just come in and change
this to scroll instead so there's scroll
let's go and get our grid here and
divide this up so that we will have
space to put some components inside of
here once again I'm well I'm going to do
a flow document scroll view or this time
so I'm going to go flow document scroll
viewer which is an option and pops up
inside of there once again we're going
to do a flow document to contain all of
the information that we have inside of
there and I can do another paragraph
just to keep this simple
so there's paragraph and we'll just
paste that inside of there and let's go
and do another paragraph just so you can
get an example of that paste in lorem
ipsum again and then after this we'll do
something a little bit more complicated
we're all will actually have the
document get generated inside of there
if we click on that you can see all it's
going to do is
girl gets rid of all the other options
ok so there's another thing so well
let's go in here now and let's create
documents by generating them so we'll
come in do a right-click again add tab
item thumps down here and let's give
this the name of generates let's go and
increase the size of this a little bit
64 is enough yep looks like that's good
now I'm going to keep the grid layout
here because that works out pretty good
for me and let's go grid and then I'm
going to come in and I'm going to do
flow documents and let's just use the
scroll viewer here and I'm just going to
dramatically simplify this I'm just
going to give it a name because I want
to dynamically load this so I'm going to
go ft scroll viewer and then I'm going
to close that out and now I'm going to
jump over into the c-sharp code and load
that dynamically alright so what I'm
going to do is I'm going to create a
function here it's going to be called
generates dock and it's going to
dynamically load all that information so
let's just scroll way down here at the
very bottom the screen and we go
privates void generate whoops dock it's
not going to receive anything it's just
going to be called and generate all that
information and I need to create a flow
document like we did that's how we have
always been containing all of our
information with a flow document so I'm
going to generate one here so go new and
flow document of course and there that
is and then you can place anything
inside of here that we've previously
placed inside here so let's just keep it
simple and let's create a paragraph and
then you're going to define inside of it
what you want inside of it so we'll go
paragraph and then you're going to
define what's inside of it by going new
and run and then within quotes you're
going to put what goes in there so you
can do something really big like that
like the lorem ipsum we have there and
then we just reference the flow
documents that we already have there so
I'm going to go to dock and I'm going to
say blocks and I will add this paragraph
block you can play around here and try
adding all the other different
components as you can see is
paragraph and you can add combo boxes
you can add anything you'd like so then
I'm going to go para new paragraph
you're also going to be able to come in
here and define styling and how you do
that is go new and I'm paragraph in this
situations what I'm going to be using
whoops it's going to be new run sorry
about that and then whatever I want
inside of there so there's more Laura
ipsum and then after that I will define
the styling that I want to use for this
so let's go in here change that to this
and it will say things like font size
you can see everything is coughing up
there as I'm typing so I can change my
font size I can change my font style and
we'll just go I'm just picking out just
randomly whatever pops up there on the
screen so font styles and that's going
to be eight let's just make it italic
because that's the first thing that
popped up whoops
keep making that little arrow put calm
at the end there and why don't we do one
more if we want to do whatever the text
color is we can do that as well and how
we do that is with brushes brushes and
then you define what your brush color is
going to be which also conveniently pops
up there on the screen and then the last
one you don't do anything with it and
then of course after you're done you go
and add it once again to the good old
slow document that we have right here
and it's going to work
so we'll go doc and blocks whoops and
blocks and add and this is the new
paragraph that we just defined right
there and then after that we go and
reference our scroll viewer so scroll
viewer there it is and documents is
going to be equal to doc and there we
are did it all let's go back over here
and you can see it's going to
dynamically load that whenever we click
on the generate tab actually it loads it
prior to that as long as goes here there
we are and we can bring it over here and
click on generate and there sure enough
or the two paragraphs we created okay
cool stuff so the last thing we're going
to do is work with rich text once again
come up here add a new tab item
come down here let's just call this rich
and you can do so many things with the
rich text box I'm going to show you just
a couple of them going to be able to add
really cool toolbars and all sorts of
stuff if you guys want to see that just
leave a comment below can make a pretty
full-featured type of a text editor if
you'd like to just completely inside of
you're just using everything right off
the shelf so I'm going to get rid of
this background information we have
right here and I'm going to change this
into a stack panel and let's close that
off and then we'll go rich text box
that's the only option that pops up
we're going to give it a name and it's
going to be rich
tbh and I'm going to define the height
for this to be 200 you're going to be
able to use spell check with this so
I'll say spell check is enabled and
we'll mark that as true and context menu
is going to allow us to right click on
this rich text box that we have here and
then do like copy and paste and all that
stuff so we're going to put that inside
of there so what we're going to do is
we're going to say whenever it opens
that we want to call a function that's
going to make everything work here and
we're going to call this guy rich TB
underscore and context menu opening so
it's just copy that guy right there and
paste that in right there click right
here and it's going to automatically
create this for me this is it I don't
know maybe not
and we'll just copy that and then close
that guy off like this and all of the
editing is going to be done inside of a
flow documents so flow documents you're
going to use flow documents every time
here and we'll go paragraph and inside
of this paragraph so I'll say something
like you can edit me good enough and
then after the rich text box let's say
I'm using a stackpanel so let's say I
want to throw some buttons in here
that'll allow me to both save as well as
open files can do that of course so I'm
going to say button and whenever it is
clicked on I'm going to call a file
called or call a function called
of RTB contents rich text box contents
and we will have saved beyond that
button and let's copy this as well and
we'll do open down here for this guy
open and we'll put open on the button
right there and you can see it's going
to pop up there on the screen and then
we just need to make these guys work
over in the c-sharp code now to make the
context menu pop up whenever you
right-click inside of that rich text box
and remember the context menu what it's
going to do is display the option to cut
copy or paste what we need to do is go
private void and let's go and grab that
function name because I forgot what I
called it come over here there it is
rich this got right here paste that
inside of there this will be the rich
text box that is going to call this and
then issue or information about this
context menu event args and we'll just
have this be E and then inside of this
guy we need to do some things so very
first things we need to do is convert
the sender into the rich text box that
we know that it is I'm going to call it
R TB is equal to and then we'll go to
sender as rich text box and I want to
make sure that there's information side
of it so I'll go RTB equal to null and
in that situation we'll just exit out of
our function there's nothing there then
we want to create our context menu
you'll see what it looks like here in a
second
so just call this context menu equal to
R TB and context menu context menu and
what we're aiming to do is have this guy
show up to the right and below wherever
you right click at inside of the rich
text area so our TB and this guy right
here is actually going to place this in
the situation where we want so context
menu and placement and we're going to
have that be placements mode relative
point and you're going to use the same
thing every time because it just makes
sense that I want to place the menu to
the right of that click like I said
before
so text pointer position is RTB
selection and and we want to make sure
that this was not given the value of
null so we'll go position equal to null
in that situation well not nil null in
that situation we'll just exit out of
here once again and then we need to
create our menu so we'll go rectangle
position rectangle is equal to position
we'll go gets character rect logical
direction forward and then we'll set the
placement for our context menu based off
of that information so horizontal offset
is going to be equal to the position R X
X so right where we clicked at it
whenever we you know whenever we created
this guy wherever we right-click with
our mouse context menu again and the
vertical offset is going to also be
equal to fact but in the y direction so
position rect and the Y so it's the x
and y for wherever they right-click that
inside of our rich text area and then
after we do that we can go to on text
menu we could set it for open to show
that this event was properly handled and
there we are and why don't I just go and
do the open and save part of this also
so that we can check out everything all
at one time so save RTB with it I call
this guy at the save or T be content see
this guy come up here and paste that in
there just go and copy all this right
here and paste that in there just to
save ourselves a little bit of time this
is going to be routed event args
so routed whoops routed event args and
then to save a document what we need to
do is define the range of text that
we're going to save and how you do that
is with text range let's just call this
range equal to new text range and we'll
say rich text box document content start
so we're going to start from the
beginning
Naing copy everything until the end so
rich text box documents gives you every
option known to man so we're going to go
from the beginning to the end so content
end then we need to create a stream to
write to the file and here we'll just
use a file stream in this situation call
this F stream is equal to new file
stream and then we have to define where
we want it to go I want this to go in C
directory and we have to do two
backslashes to cancel those out so I'm
going to go users and there Banas the
and the directory I want to save into is
called C sharp data and test and zamel
is actually what we're going to be
saving here and the file mode we're
going to be using here is to create the
file so we're going to use file mode
create if it hasn't already been created
and then to save it we just say range
and save and we reference the stream and
the data formats means that this is
going to be a sam'l file here and then
if we do that we can close our streams
so we'll just go stream close and there
we are so that's how we can save that
data and we're also going to want to be
able to open files so come in here once
again and we will say open we can use
everything else we're going to have to
define our range once again so text
range like this and we're also going to
need a file stream so a file stream and
I'll just call this F stream again we
want to verify that file actually exists
so we'll say file exists and then we're
going to paste in the same file that we
have right here so verify all that paste
it in and if it does exist I'm going to
say range is equal to new text range and
we're going to of course go from the
start to the end so a little bit like
this which is go and copy this guy again
copy
and there's our range and then
define our stream equal to new file
stream and we'll go and get our file
once again we'll be using the file mode
of open for create and then we just call
range and load and pass in the stream
that we're referencing here and data
formats we have to define that it is a
sam'l once again because that's how
everything's saved and then of course
after we're done with the stream we have
to close it all right so that's a lot of
stuff we're learning here so let's run
this up there was a build error okay
there's no use running it it's saying
there is closing bracket that's missing
let's come in here and see if it's easy
enough let's just go like this
there you go and let's run it that
there's another whoops change this to
save not save save and then this guy
down here I probably did the same thing
open save yeah I just want to change
this open a ride run it again little
bugs creep in is crazy and we can check
out our rich text box click on it and
you can come in here and edit this of
course do whatever you want if you
right-click on it this is going to open
that context menu remember I showed you
before paste in whatever information you
want to paste inside of there we can
save this we can come out here and
delete all of it and we can say open and
you can see it's all back alright guys
so there is an insane amount of
information about the document API
that's available to you like I said
there are toolbars and a whole bunch of
other different things you can explore
specifically with rich text box and I
hope you found that useful in like
always please leave your questions and
comments below otherwise till next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>