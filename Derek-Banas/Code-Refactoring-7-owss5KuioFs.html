<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Code Refactoring 7 | Coder Coacher - Coaching Coders</title><meta content="Code Refactoring 7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Code Refactoring 7</b></h2><h5 class="post__date">2013-01-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/owss5KuioFs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello internet and welcome to part 7 of
my code refactoring tutorial today I'm
going to cover what I wasn't able to
cover in part 6 which is going to be
replacing conditionals with the strategy
pattern as well as other ways to use the
strategy pattern and also a whole bunch
of questions came up about the guard
clause I'm going to cover that again at
the very end of this tutorial
it's very simple so I have a lot to do
so let's get into it ok so all of this
code here is available in a link
underneath of the video and you should
get it if you want to really understand
the tragedy pattern and also I provide a
link to the strategy pattern above if
you want to take a look at that I did a
design pattern tutorial on it now let's
get into it here I'm going to show you
an example of why you would need the
strategy pattern now very often like
we're going to do here in this program
where we're going to calculate salary
for example you're going to have to
figure out pay differently for different
employees and very often using old
techniques you would perform many
conditional checks to see if an employee
would get a bonus or not get a bonus or
if the bonus amount would change how it
would have changed the overall pay or
you may have to go and add additional
conditions if a new bonus condition
comes up and you can get into all kinds
of problems the strategy pattern as
you're going to see here is going to
eliminate most of those problems and I'm
actually not going to just jump in here
and create an absolute terrible piece of
code I'm going to write something that
you think would work and then go through
why it would so down here we have class
employees and I'm just going to go
private and I'm going to define a
boolean and it is going to be bonus
whether they get a bonus or not and I'm
going to set it as false here in the
very beginning and then I'm going to
also create another one and it is going
to be salary and it's going to be some
sort of double that's going to be
defined and let's move that up so we can
see exactly what's going on here and
then what are we going to need to do
well we're going to have to create a
constructor for this guy so I'm just
going to go into source here and have it
create my constructor construct you're
using fields and bonus and salary are
going to be two of those fields and I'm
going to hit OK and it's going to create
that and then let's say that we also
want to throw another constructor in
here that basically just does nothing
okay so we have those two
find and everything looks like it's
going really really well so if we want
to calculate our salary we're just going
to go double get salary or get pay
whatever I'm just going to leave this
good salary you understand what I'm
doing here
then what I would do is throw a
conditional in here that's going to be
bonus and this doesn't look bad and if
there is a bonus we're going to say and
we're gonna guess that all the bonuses
are the same everybody is going to get a
15% bonus if they get a bonus well and I
think you can start to see what's going
on here but you're thinking I there's a
way to fix that then you can just go in
the circumstance where that isn't true
just send back the salary itself and
then let's say that we also want to come
in here and maybe go and create a void
set salary and it just gets a double and
it's going to set my salary for me and
then this salary is equal to salary all
right and everything seems pretty good
and it's not terrible so let's go up
here and start playing around and see
what goes on cuz remember I said I
didn't want this just to be a mess just
to say it's a mess and try to fix it now
the major problem here is everything is
going to work as long as there are no
changes now of course I could make
subclasses to eliminate the need for the
bonus boolean that we have here but
you're going to see that there's all
kinds of other problems that come up so
let's say we create a Salesman is equal
to new employees and let's say that they
have a $15,000 salary and then they get
a bonus on their salary and actually
this is going to be true and then 15,000
okay so we got that set and then let's
say that we have a secretary then she
doesn't get a bonus but she gets a
higher pay and this is also going to be
here and then she's just gonna have this
marked as false and let's say that she
gets 20,000 I don't know well then you
could see that we could come in here and
get our salesman to print out his salary
so salesman and get salaries what we're
going to use here and then we're pretty
much going to do the same thing here for
our secretary and if we save that and
execute it you're going to see here
salesman gets a payment of seventeen
thousand two hundred fifty dollars and
the secretary is going to get the two
thousand dollars okay so everything
seems to work whatever what happens if I
need to change my
Onis amount remember originally I had
15% for everybody
Wow you're thinking okay well no big
deal we're just going to go down inside
of here and we're going to go private
Doble and put bonus amount inside of it
and let's say that it's going to be 15%
just based off of that well that means
I'm going to need to come in here and
create a new constructor say I'm doing
all kinds of code changes and here we're
going to do double and type in bonus
amount and then bonus amount we're gonna
have to add on to this bonus amount and
then you have to start asking yourself
what happens if we want to create a
totally new page structure that doesn't
have anything to do with bonuses maybe
there's some other form of Commission
that we want to use and that also means
we're going to have to come down here
inside of get salary and we're going to
have to eliminate this and instead put
inside of here bonus amount so we're
making another additional change down
there and file save and now all these
things are still going to kind of work
but now let's say that the bonus amount
for the salesman is going to change and
let's say that he's doing 20% now
instead you can see that we are able to
use these calculations and make these
changes however whenever we want to add
a new feature we need to go into the
employees class and change a whole bunch
of things with the strategy patterns
going to do is it's going to allow us to
not have to make any changes inside of
employees but instead whenever we have a
new way of calculating salary just
create a new class and it's
automatically going to work so let's
take a look at exactly how that's going
to work before we do I just want to go
through here because we're talking about
conditionals and give you an example of
just how bad this could get if we try to
do this with conditionals versus using
classes well we'd have to come in here
and go if salesmen for example and then
we could go gets bonus and code like
this exists I'm snot like I'm creating
this out of whole cloth then what you
need to do is go double and let's say
you want to calculate pay amount and
this is going to be equal to salesmen
again and then you'd have to get the
salary from that make another method
call inside of there and then maybe do
another salesman and then get salary and
then multiply that times salesman and
go in here and get bonus amount out of
that and then throw that on to that and
then else and then put in a whole bunch
of different things like I said let's
decide we want to add a new way of
bonusing people well we can't do that as
you can see this gets extremely busy now
imagine if you put that inside of here
or worse yet if you would go up and put
this inside of your main function this
is when code gets to be completely
unmanageable whenever you have
conditional statements like that so now
let's go in look at strategy pattern
okay so I have this extremely long name
replace conditional with strategy and
I'm going to go through this like I said
before conditional logic is often used
to decide which algorithm to use just so
you completely understand this you can
use this in a real world and the
strategy design pattern is used to
dynamically change those algorithms that
are used by objects at runtime and that
is what makes it great for eliminating
conditionals and eliminating a whole
bunch of other problems and basically
all you need to do is create sub classes
for each algorithm both algorithms you
know about today and algorithms that
could occur in the future and that
algorithm automatically at runtime can
be added on to any object and of course
this is just another example of how to
replace conditionals with polymorphism
or a neat way to use polymorphism in
general so we have basically the same
sort of thing here except we're going to
need to define a class employee and I
went and put two very specific employee
classes here just to explain this more
elaborately so let's say we wanted to do
protected double salary it's equal to
zero point zero and I'm very happy that
I did it this way now what we're going
to do is we are going to use an instance
of the pay interface which I'm going to
create here in a second and what's great
about it is that employee doesn't care
or what pay does and what this is going
to do is allow the capabilities of
objects like I said for to change at
runtime and to do all kinds of cool
things so we're just going to go pay and
we're going to call this pay type and by
default we're going to give it a value
of no bonus so let me show you exactly
what this interface is going to look
like so interface and this is going to
be pay and this is going to be the
extremely
gated definition for calculating pay
salary there you go
done isn't that awesome one line then
what we're going to do is for each
different pay type we're going to go
class let's say there is gets bonus well
we're just going to go implements the
pay interface and then we just need to
come in here and put get pay inside of
it and it's giving me an error right
there saying add-on implemented methods
and that is exactly what I'm going to do
I'm just going to have it do the work
for me
that's much better now inside of this
guy now I can just go return and it's
going to be salary plus salary times
let's say that we wanted to put our 15%
in there I'm going to show you in a
second how easy it's going to be to
change that without adding anything to
employees again then if we want to
create another different type of pay
class like something that is no bonus no
problem no bonus and in this situation
we're just going to return salary and
that's just going to automatically work
now just to show you exactly how hard
it's going to be to add a different
bonus amount let's say that we wanted to
do a bonus amount that is 20% there we
go we just did it and now all we need to
do is go in there and change that to 20
and all of these classes every single
time you want to add a different way of
calculating pay or salary all you need
to do is create another one of these
classes implement it and it's
automatically no work without doing
anything with employee let's go back up
into employee and play around with this
now we're going to create employee and
it's just going to be passed over salary
which is very simple and then of course
we're going to go this salary is equal
to whatever salary they sent over to us
there that's done and then if we wanted
to also have them associate their pay
type of course that's piece of cake here
we're going to have our salary passed
over and also our pay type is going to
be passed over so we'll be able to
calculate that as well and what are we
going to do just go like this bang and
bang and then this is going to be pay
type which is going to be an object and
then we could also come in here and
throw in another method that's going to
allow us to set the bonus option so we
could on-the-fly change that so just set
bonus option right like that and it's
just going to receive and do pay type
object that's going to be passed over to
it and then
we'll just go pay type is equal to new
pay type a piece of cake as you can see
it's going to be extremely easy to
implement pay classes and change the pay
amount without affecting any of the
other parts of the program so exactly
how hard is it you want to be to come
down here inside of salesman and create
it I'll just highlight this and add
constructor click on that and then come
in here and create the other constructor
that's going to handle pay type and here
we can just go set bonus option and pass
it pay type and it's automatically going
to work of course we need to put pay
type in here and then to do exactly the
same thing for our secretary she's going
to be just as easy bang that in there
and then change this to secretary
instead of salesman but on the fly we
could also change the salesman types and
secretary types and everything we're not
in any way tied to any of that so that's
what's great it's flexible let's jump up
in the main and see exactly what kind of
things we can do so if we want to define
an employee and let's just call him
salesman is equal to new salesman and we
want to give him a salary of 15,000 and
then let's say we want to do the same
type of thing here with secretary and
let's say in this situation she gets
twenty five thousand there we go
and it's bounced over here
system.out.print just to save yourselves
a little bit of time copy that paste
that in there there we go and in this
situation we're just going to go get pay
instead of get salary and actually to
keep this short I'm going to jump down
here into my employee part right after
set bonus option and just throw this
inside of here public double get pay
like that and then just return pay type
which is a reference to the object
that's stored inside of there using
composition and I'm just going to go
like that save that and that's going to
stream down into all these other guys
and if we file save it and execute it
you can see it calculates all that out
which is really cool but remember by
default I had everybody not getting
bonuses so how hard is it to add a bonus
to the salesman salary at run time well
I just go salesman set bonus option and
then I just pass in a new gets bonus
that's in a new object to assign to it
and if we call this salesman again
you're going to see how is paid change
just with that one little line there
dynamically areare calculated that
completely differently which is
right you could also set the bonus type
inside of the constructor just like we
did before so let's say that I wanted to
create a completely different way of
doing this like let's do a sales trainee
new sales person have this be 15,000
just like the four and here we're gonna
do no bonus like that and then calculate
on the fly
salesman trainee like that I'll save it
execute it there you can see there's
another way of calculating that I just
chopped off the bonus while this
salesman gets a bonus should I put a
space in there the problem and then of
course I can come in here and do exactly
the same thing and give my secretary a
bonus on the fly with secretary I'll say
execute it and there we are so you can
see just how easy it is dynamically and
very easily just by passing over this
new object of the interface pay that we
created down inside of here to
completely change everything without in
any way affecting the employee classes
so that is why you use the strategy
design pattern now let's get into the
big question from the last tutorial
garde clauses now whenever I put this
together to the last time with the guard
Clause I didn't really expect to get
people confused about it basically the
guard Clause is just used to show the
normal path of execution and make it
very clear by eliminating the normal ins
and outs whenever you use if-then-else
statements and this is how I showed it
it's actually in the real world it's not
normally used this way it's used in
another way but you can see right here
whenever you program and you have four
and you have if and then you have else
you're basically giving equal weight
which means you're saying it's just as
likely that the bag is going to be less
than 50 pounds as it is likely that the
bag is going to be over 200 pounds or
over 70 pounds in this situation so if
we thought it was just as likely that a
bag would weigh less than 50 pounds as
if it would weigh over 70 pounds we
wouldn't use the guard clause however in
the world world it doesn't make sense
that people carry bags around that
heavily okay so this is kind of like
something we're just using here to
explain that whenever we do not use else
statements it means that we are
giving everything equal weight or equal
likelihood of occurring as if we would
use L statements so that's why the guard
clause is in there now why I think
people got confused is the card Clause
is normally not done this way rather
you're more likely to see the guard
clause used in a method like I'm going
to show you right here so give example
all right I'm going to give you an
example in let's say we go get bag price
this is the way the guard closet is
normally used then you're going to say
something like double weigh int and then
put it in the bag then I'm going to save
myself in half and I type out all this
stuff so I'm just going to come up here
and I'm going to grab that if statement
paste it inside of here and then
normally what would occur in the rule
world is you would get rid of this all
together and instead and this method by
going return and then you would type in
bag under 50 pounds for example and then
pass the bag and then that would be sent
back to the user of this method then
again I would end it then you would come
in here and go the bag weight is less
than 70 pounds and then put and and this
would actually be weight in this
situation like that
you would say bag weight greater than or
equal to 50 and then a return statement
and that would end the method or you
could do something to return 200 okay so
this is how the guard Clause is used and
all it's used for is to make the code
more readable but also to emphasize that
it's more likely that a bag is going to
come through that weighs less than 50
pounds then it is likely that a bag is
going to come through that weighs more
than 70 pounds so I hope that makes that
completely understandable don't worry
about it it's not that confusing of a
subject I think it's confusing because
it wasn't confusing and you guys are
used to seeing me do more advanced
things so there is the strategies design
pattern and hopefully I've cleared up
the whole gourd Clause issue please
leave any questions or comments below
otherwise till next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>