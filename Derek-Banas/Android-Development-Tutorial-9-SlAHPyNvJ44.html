<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Android Development Tutorial 9 | Coder Coacher - Coaching Coders</title><meta content="Android Development Tutorial 9 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Android Development Tutorial 9</b></h2><h5 class="post__date">2013-05-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SlAHPyNvJ44" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello Internet welcome to part 9 of
my android development tutorial if you
haven't seen the previous parts of this
tutorial mainly 6 7 &amp;amp; 8 you should
definitely watch those first and I
provide a link in the upper right hand
corner to watch those videos because in
this tutorial what I'm going to do is
I'm going to show you how to parse XML
much like I did in the last tutorial
however previously I showed you the way
to parse XML using the Dom this time I'm
going to show you the preferred way to
parse XML which is to use XML pull
parser and the reason why XML pull
parser is recommended is because it is
faster uses less memory and hence uses
less battery life so I have a lot to do
so let's get into it ok so to start off
this tutorial I want to cover one thing
I didn't cover before and that is how to
change your apps manifest file to get
permission to be able to access the
internet and your manifest file is going
to be found in a resources folder and
it's going to be called a Android
manifest or something like that dot XML
now to get permission to access the
Internet all you got to do is come into
this guy and go uses - permission and I
covered this previously but not in this
very specific way and then you're going
to say Android permission dot Internet
and that is all you're going to need to
do and now your application is going to
be able to access the Internet which is
very nice so we saved the manifest file
and we don't need that anymore now what
we have here in front of us is the
previous stock info activity dot Java
file and what I'm going to need to do
with this guy is to stop using the Dom
way of parsing XML and instead use the
XML pull parser way so the very first
thing I'm going to do is I'm going to
committed this guy and get rid of all
the things I don't need and specifically
what I am NOT going to need is going to
be this information which is in do in
background this whole entire try block
this is where we were previously parsing
XML the old way so I'm just going to
select all that and delete it and there
we go right after finally and it's gone
and in a second I'm going to show you
how to do all the same stuff using XML
pull parser we are still going to need
on post
execute because that's going to write
the information to our GUI but we're
going to do that in a different way we
however I'm not going to need get stock
information and we're also not going to
need get text value so I'm just going to
select all that and delete it okay so
now we got all that stuff that we no
longer need out of the way now whenever
I create this guy I'm gonna do it a
really simple way I'm just going to
create an array in this situation and
this array is going to pull all the XML
data that we previously were using and
if you don't remember where that came
from remember we were using developer
yahoo.com YQL console to generate all
that information and specifically we're
using Yahoo Finance quote this guy over
here and if you don't see it make sure
that you click on show community tables
and then we're going in and grabbing all
this stock information for all the
different quotes so let's jump back into
the code so now I'm going to create a
string array and like I said it's going
to hold all of those values I'm just
gonna pull in everything just to keep
everything nice and simple I'm gonna
call this XML pull parser array and I'm
actually going to set it up by saying
average daily volume and then I'm gonna
give everything a blank string maybe I
want to put a 0 in there just to show
that there's nothing in it and then I'm
gonna do this for all of these different
guys face that in there and I have a
total of 12 of them and then I'm just
gonna simply come in here and based off
of this information see over here on
Yahoo average daily volume that I'm
gonna do change 10 days low and so forth
and so on just keep on doing that so the
very next thing we're gonna put inside
of here is change like I said this is
just a simple way of doing this day's
low days high year low year high market
capitalization last trade price only
days range name symbol volume and then
for some reason I still need one of
these and I'm gonna close off the whole
initialization of the array and put
stock exchange in here last and then I'm
actually gonna cut this out of here come
down inside of this area here and paste
it in right after we define that URL
that we want to use so there we go that
is going to hold all of our information
we parse out of that XML page and then
I'm also going to throw inside of this
an integer and it's just going to help
me track the current cell inside of the
array that I'm working with and of
course I'm going to start that out with
0 ok so now that I have that set up I'm
going to go inside of oncreate and then
come down here into my async task and
specifically into - in background then
inside of this guy I'm going to create a
new try block and just like before the
XML pull parser Factory is going to
provide you with the ability to create
pull parsers that are going to parse
your XML documents so not many things
are really going to be that different
actually it's probably a little bit
easier to understand unless you're
really used to working with the Dom so
I'm going to come in here XML pull parts
Factory is equal to XML pull bars
factory and go dot new instance and
that's going to create that guy for us
then a little bit of setup here with the
factory we're gonna say set and then
we're gonna say namespace aware like
that and then inside of that type in
true we can pull this up here so we can
see it a little bit better then we're
going to need to get ourselves some
methods that are going to be needed to
parse our XML documents and those are
going to be an XML pull parser I'm just
going to call this parser and to get
them we're gonna need to go into our
factory and go new pull parser like that
and then we're going to take parser and
we're gonna say set input new input
stream reader and what this input stream
reader is gonna do is just gonna convert
the bytes of data into a stream of
characters that we'll be able to look at
and analyze and then we're gonna go get
URL data and like I said before this guy
right here string Arg 0 is exactly the
same as just defining a string array so
what we're gonna do is get the URL that
was passed into this and that URL was
passed into this right here so we need
to get that URL and to do so we're gonna
go args 0 and then put a semicolon at
the end of that so now I think it makes
sense to create get URL data so I'm just
gonna bounce out of here scroll this up
and we'll come back to that here in a
second and I'm gonna go
public input stream which is going to be
the return type get URL data and it's
going to receive a string that's going
to be our URL then what we need to do is
to list the different exceptions that
this guy may throw exception client
protocol exception and i/o exception and
don't worry about memorizing all this
information actually if you wouldn't
have put that in there it would have
told you to throw this information into
a try block and then added those
exceptions on there for you
so now what we need to do is because we
need to get our URL data is we're going
to need to get access to http
e-resources and to do that we're going
to go default HTTP clients and I'm just
going to call it client new oh just put
an equal sign in there like that and
there we go
then we're going to need a way to
retrieve information from the URL and
HTTP GET is going to do that for us is
equal to new HTTP GET and then we're
going to go new uri and throw the URL
that was passed over there into it and
then much like we did before
we want to get a response from our
client on whether the connection was
stable or not and that's what this guy
is going to provide with us and we're
going to go client execute and method
and now that we have all that setup in
this situation an HTTP entity may be
returned and to get it we're gonna say
get into T and what this guy get entity
is going to do it's just gonna tell the
system where the content is coming from
then we're gonna say get content to
actually get our content and return it
as an input string so now that we have
that set up let's just roll back up here
inside of the try block and there is get
URL data of course then I'm going to
need to create another method inside of
this called begin document and it's
going to pass the parser over as well as
the first tag in our XML document for
processing and of course that means we
need to create big document and of
course that means we need to create
begin document and of course we know
that the very first tag inside of here
is quote because this is the XML data
and that's where that's coming from so
we're gonna scroll back down here after
get URL data and define that method and
to do so we're gonna go
like final lloyd begin document and it's
going to get past an XML pull parser and
I'm going to call it parser and it's
also going to receive a string which is
going to be the first element name and
just like before this guy is going to
throw potentially XML pull parser
exception and an i/o exception
potentially throw in our curly braces
start making this guy then we're going
to define an integer inside of this and
this is going to represent the type of
tag that we're currently working with as
you're going to see here in a second and
then we're going to go while type is
equal to parser next and what next is
going to do is advance to the next
element inside of our XML document and
that is either going to be a starting or
ending tag or a value or the end of the
document then we're going to say if it's
not equal to parser dot start tag
because remember all we're really
interested in is the values and it's
also not equal to or sir dot and
document well in that situation we're
just going to put a semicolon in here
because we just want to skip all of
those situations then after we have that
set up and all the codes available to
link underneath the video of course we
want to throw an error if a start tag
isn't found at all and how we're going
to do that is say if type is not equal
to parser dot start tag we're going to
say throw new XML parser XML pull parser
exception and then we're going to say no
start tag found now if we get down into
this situation well then we just need to
verify that the tag passed in is really
the first tag in our XML document and to
do that we're going to say F or sir get
name dot equals and then put first
element name which was passed over
whenever this method was created say
string first element name and in this
situation which they don't match we're
gonna throw another exception which is
gonna be exactly the same thing except
in this situation we're gonna say
something like Oh
expected start tag found and then if we
wanted to say what that was we could say
parser get name then we'll know the
proper tag we should be looking for then
we could say something like expected
plus and then put the tag that was sent
in here that we were supposedly supposed
to find a match for and there we go now
that's all setup so we know that that's
all working so then scroll back up
inside of here right after we have begin
document now we can come in here and
create another int which is going to
represent an event type and go parser
get event type again it's going to be
either a start and end and a document
da-da-da-da-da and what this is going to
do is just save the currently targeted
event type which of course is going to
start as start of document then what
we're going to do is go do create a
do-while loop inside of this guy and
it's going to cycle through the elements
in the XML document just as long as we
don't come in contact with neither a
start nor an end tag and we're going to
create an outside method again it's
going to be next element and we're gonna
pass the parser over in that situation
and the wild part of this guy just to
fill that in before we leave is going to
be event type not equal to XML pull
parser dot end of document because of
course we would want to stop searching
for elements if we cut to the end of the
document so now let's go and create next
element again I'm just gonna come down
here after all this stuff but before
onpostexecute and here I'm doing to go
public final void next element of course
it's getting an XML pull parser and I'm
just gonna keep it with the name pull
parser or parser and guess what it's
gonna throw the same errors as this guy
up here so I'm just gonna grab this save
ourselves some time paste that in there
then inside of this we're gonna go type
again it's gonna be the type of element
and then we're just going to cycle
through the elements in the XML document
just as long as neither a start or end
tag or found just like before I'm going
to go type equals parser dot next not
equal to parser dot start tag and
type not equal to for sir dot and
document and again in that situation
just throw a semicolon in there because
that is just going to cycle through all
that data so then we bounce back up
again into two and background that's
where all this is going on and into our
dowhile loop again and then if we get
here we're going to say that we want to
switch to the next element inside of the
XML document and then we want to get the
next event type and to do that we're
just going to go parser dot get event
type we then want to check event type to
make sure that the value was found
between two tags XML pull parser dot txt
we want to make sure that it's actually
a text element here and in the situation
in which it was we're gonna say string
and we're gonna get the value from that
XML node and to do so we're gonna go
parse or dot get text and there we go
and then just to make everything very
very simple
I'm gonna go XML pull parser array and
I'm gonna use my purse or array
incrementer so where's that at I'm just
gonna screw up here and get it
so don't spell it incorrectly yeah
parser array increment save starts off
at zero bounce down inside of there make
sure that we incremented of course
otherwise that will cause all kinds of
problems and then we're going to be
storing in the value section the array
the name section would be zero we're
storing in the value part of that array
then we just need to say value from XML
let's capitalize that and that is gonna
store all the values and everything else
here is perfect except of course we're
going to need to put a finally block
inside here just gonna do that and
rather than trying to guess what all
these exceptions are I'm just gonna go
over top of it and say add catch Clause
to surrounding try for that guy you're
gonna say there it shows up and then I'm
gonna cycle back up and see if I see any
more of these red areas next element has
another one I'd catch Clause two
surrounding try so I go back up inside
of here do I
any other red elements yes get your L
dad has another one I'd catch claws the
surrounding try I'm actually gonna take
the catch block out of this guy and put
him right there instead and I'm actually
going to create another catch area here
surprise didn't show up so I'll just put
it in myself like I said don't worry
about memorizing all this stuff and in
this situation we're going to say client
protocol exception II and just print the
stack trace just to keep everything
simple I also liked it better when these
catch blocks are actually apart from
each other so they're easily read and
there you go now we have everything we
need to parse the XML data inside of
doing background using XML pull parser
and now the only other thing we're going
to need to do is get all that
information out of our array I'm
actually just going to copy this guy
right here and then come down into the
guy that's going to write our
information out to the GUI which is
going to be on post execute and this is
actually going to be pretty easy I'm
just going to come in here where it has
a name I'm going to go XML pull parser
array and if I come inside of here I can
see that 0 1 2 3 4 5 6 7 8 9 9 index is
going to be where our name is and from
now on I'm going to use all of that
information right there so I'm going to
change this guy right here to 9 that's
going to get me my name value and then
I'm going to do that for all the rest so
your low is going to be for your high is
going to be 3 days low is going to be
equal to 2 days high just to check over
here as well days high is going to be 0
1 2 3 up it's going to be your high
actually so that's going to be your high
as 0 1 2 3 4 5 your high is going to be
5 sorry about that
and then days high is going to be 3 I've
got that sorted last trade price only is
going to be equal to 7 change is going
to be equal to a 1 and then finally days
range is going to be equal to 8 then I'm
going to file save that and everything
is looking beautiful so let's execute
and here we are inside of our little
stock guy and we're going to hit quote
and there you can see all the prices
updated
so that was our really fun tutorial as
this tutorial continues I'm just gonna
keep making more and more and more apps
if you have any requests on things you'd
like to say as long as they're
reasonable I'll do my best to make those
apps please leave any questions or
comments below otherwise til next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>