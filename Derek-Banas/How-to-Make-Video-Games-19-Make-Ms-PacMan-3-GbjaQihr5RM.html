<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make Video Games 19 : Make Ms. Pac-Man 3 | Coder Coacher - Coaching Coders</title><meta content="How to Make Video Games 19 : Make Ms. Pac-Man 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make Video Games 19 : Make Ms. Pac-Man 3</b></h2><h5 class="post__date">2017-08-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GbjaQihr5RM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello internet and welcome to part
19 of my how to make videogames tutorial
series in this part of the tutorial we
are going to finish it up so that miss
pac-man will finally be able to
precisely move through the maze for our
Miss pac-man game and this mechanic is
going to be extremely useful for
numerous different games and like always
all the code I use here is going to be
available in a link in the description
underneath this video and I have a lot
to do so let's get into it so this is
where we were left off and we can play
it here and you're going to see that
basically what we did was we set it up
so that Miss pac-man is able to move
around on the screen exactly like we
would like but now what we're going to
do is have it set up so that she will
only move through the maze so how are we
going to do that well we're going to
jump into our miss pac-man code and here
it is and we're going to have to make a
whole bunch of different changes so I'm
going to come back up here all the
changes for the most part going to be
inside a fixed update and I'm going to
need to do a couple different things
here one thing that it need to do is
whenever the buttons on the keyboard are
clicked I'm going to need to define the
direction I want to move and of course
I'm going to store that in a vector too
and I'm going to call it move vector all
right I can call that move vector but
I'm gonna call it move back I'm going to
come down inside of here and I'm going
to define it so I'm going to say move
vector is going to be equal to new
vector 2 and here is where I'm going to
put horizontal move and then I'm going
to have 0 because we are only going to
be whenever the a is pressed that means
the user wants to move to the left side
of the screen then what I'm going to do
is I'm going to come in here and I'm
going to verify if that is a valid
direction I can move but to do so I'm
going to need a function that I'm going
to call can I move in direction and I'm
going to bounce down here outside of my
update function and I'm going to create
that function so what's this guy going
to do well it's going to return true or
false based off of if I am going to be
able to move in the direction that I say
I want to move in so it's going to be a
boolean I'm going to call it can I move
in direction and it's going to be passed
a vector to
and that's going to be the direction
that I'm going to test now what I'm
going to do inside of here is I'm going
to first off get Miss pac-man's current
position and to do that it's very easy
you just go it's call this position is
equal to you just go transform and
position okay so we got the current
position for Miss pac-man
now what I want to do is find out if
there is a point inside of the array
that matches up with that so I'm going
to go transform and point is going to be
equal to game object and I'm going to go
find and then I'm going to go and get
the game board grid so that I can get
ahold of my array so just go dot get
component and game board is the name of
that that's script that's what I'm
specifically trying to get here put our
parenthesis inside of there and then the
name of the array that I want to get out
get ahold of is game board points and
specifically what I'm going to get ahold
of is I'm going to use the X Y position
of pac-man that I have currently so I go
position X and then do the same thing
int position Y and I can show you
exactly what all this means so here
we'll say game object and I'm trying to
find game board grid and then game board
I'm going to jump over and show you
exactly what I'm referring to so this is
what I'm getting game board grid and if
you click on that you're going to see
the script is right here and it's called
game board ok so that's what I'm getting
and then I'm specifically we jump inside
of here again game board game board
points so that's the array I defined and
I put a turning point or a pivot point
or whatever in each part of the array
where one of them exists on our game
board all right
so hopefully that makes sense now what
I'm going to do is I'm going to say did
I find a point here so I'm going to say
if point is not equal to null because
everything else other than where there
is a point is going to have a value of
null if it is not equal to null then I'm
going to say that I want to get the
points associated with
that specific game object so I'm going
to say a game objects and I'll call this
point game object is equal to points
game objects so I'm getting the game
object version of that point and I need
to get that because I then want to go
and get the vectors to the next point
array that is attached to that point and
I'm going to store that in an array
itself so I'm going to say vector 2 this
is a vector 2 array and effect I can
just call it the same thing vex 2 points
is equal to points game object and get
components and what I'm getting is
turning points specifically lets me
spell that right turning point
parentheses and then next and then Veck
2 next point so I'm getting that array
out of there and assigning it to this
one all right now what I need to do is
cycle through the attack vector to next
point array and look if I have a match
with the direction that the user wants
it go in that's that
so I'm cycling through there to see if I
can find what I'm looking for the
direction I want to go for it and to do
that I just go back to in vex
2 next point and then for each one of
those I say if vex is equal to the
direction that I want to move well in
that situation I return true because it
means it's a valid position that I can
move to and if I go through the whole
thing and I don't get a match well then
I need to return false because that
means I didn't find a match
all right so pretty simple stuff all
right so now that I have that all set up
was this giving me an error for says not
all code paths return a value
all right let's save that and let's see
if that indeed is true if I miss
something here I see what it wants me to
do once we come down here take that out
of there and put the return false there
all right so now save it and it should
be valid again yes and it looks like
it's good and actually you know what I'm
going to change this to can uppercase so
there we go so we got this guy now we
can take it ups inside of here to our
code and right after this I'm going to
say if and can move in Direction Emma go
move vector and then I'm going to
say that I can move if that was an
option
so what I need to do is just go and get
all of this stuff whoops I'm gonna have
to change just a little bit though I'm
going to have to go in here where it has
the rigid bodies velocity and change
that to move vector instead the
direction I want to move and everything
else is exactly the same I believe yes
so let's cut that out of there and paste
that in there so if it can't move it's
just not going to move
all right so pretty simple stuff now
basically I have to do exactly the same
thing with all the other different
points so once again I'm going to come
in here right after the if statement I'm
going to go move vector is going to be
equal to new vector to horizontal move
zero and then I'm going to say if can I
move in that direction whoops I'm going
to go and copy this can I move this is a
big long name that's good sometimes have
long names all right can I move in that
direction I'm going to throw a move act
inside of there and then we're going to
go and change this once again to move X
and then copy all of this out or not
copy it cut it out of there and paste it
all inside of there so there that's good
and I see I got a little error here
that's because I need another
parentheses inside of there let's go up
here and make sure I didn't make that
error up here
Pepa no I didn't so that's good let's
put that them down there to keep all
that together I'm going to come down
here for the W which is going to be used
whenever we move upwards once again I'm
going to say move vector in this
situation this is going to be new vector
2 and I'm going to throw 0 inside of
there and avert move so slightly
different I can then change this guy
right here to move vecten Seguin so move
vector come in here again and I'm going
to say if can move in direction I'm
going to throw move vector into there
and then go open this up and then cut
this out of here and throw it inside of
there cut that out of there throw it
inside of there come down into the S
area move bucked again is going to be
equal to new
vector to zero and vert move just like
previously again this is going to be
moved back and before that I'm going to
say if and can move in direction and
then throw move back inside of that and
then cut that out of there and paste
that inside of there okay so there we
are verifying if it is possible for us
to move in directions based off of the
valid directions attached to each one of
the pivot points or turning points in
our code so let's save that jump back
into unity and you can now see Miss
pac-man is moving inside of our grid
area the only problem is is sometimes
she is not staying in the center of the
screen and she's also obviously hitting
walls but let's go and fix the part
where she's not staying in the center of
the maze first now to get it to line up
in the middle of the maze every single
time what we're going to do is we're
going to set the position for pac-man
each time it moves I'm going to do that
right before I change the velocity of it
so to do that we just go in here you
could take a guess it's going to be
transform position equal to new vector 2
and we're going to cast this to integer
even though it's going to be an integer
and then we're going to say transform
dot position dot X and we're going to
see what that looks like I'm going to
copy this and do exactly the same thing
for y so it's just going to like that
and then paste that in there and change
that to Y all right and we can copy this
we're going to use exactly the same
thing for each one of our movement
changes so I got that one there once
again put it right before the velocity
change and another one down here and
then another one right here and that
should fix it for all of them and we'll
save it and test it and we can run it
and there's miss pac-man
and whenever we go to move you know what
she's off by a little bit
so looks like she's off by about half
so let's come back inside of here again
and let's change this a little bit so
I'm going to come in here dot I'm going
to go plus 0.5 F and I'm gonna do the
same thing for the Y direction that
looks like that's right
so let's copy this once again and just
go in here and replace each one of those
and it should be able to line up
properly so let's change that and let's
change that and let's change this now
she will always remain in the middle of
the maze no matter what so save it run
it again there she is in the middle of
the maze and there she is and she is
staying in the middle of the maze
beautiful and it's also important to do
this aside from the aesthetics to make
sure that she always starts on a pivot
point so it always snaps to a pivot
point otherwise she could get locked in
a you know bad position inside of the
game now the next thing we're going to
have to do is we're going to have to
stop miss pac-man whenever she hits the
wall and that's going to be fairly easy
to do we just want to verify a couple
different things first off miss pac-man
is going to have a circle Collider owner
and is trigger is going to be set and
also she's going to have the tag miss
pac-man I covered this previously and as
well all of the points are going to have
a circle Collider with is trigger and
the radius set at point 1 and everything
else here should be pretty good and
we're going to of course trigger that
miss pac-man hit a wall by using
ontriggerenter 2d so let's come in here
and let's do that let's just come right
after this guy and I'm going to come in
and I'm going to say void on trigger
enter 2d and this is going to receive
whatever miss pac-man collided with so
Collider 2d and I'm just going to call
that Co L then inside of it I'm going to
set bull hit a wall and that's going to
be set to false by default I'm going to
say if what we collided with game
objects and tag that's why you need to
have the tag set is equal to point and
that's going to specify specifically
that we're only in
arrested in points we're not interested
in dots and all that stuff which we're
going to get to later on well then we're
going to say vector two and vex two next
point is going to be equal to the
collision get component and we're going
to get to the turning points and then
specifically we'll get vector next point
from that okay basically what's
happening is we are colliding with a
point and we are going to verify if we
are going to be able to continue moving
in the direction we are currently moving
it or if we hit a wall which means that
that doesn't exist and to do so what
we're going to do is cycle through the
attached of extra vex
2 next point array to see if there is a
vector 2 that's going to be equal to
Pacman's velocity or the direction that
pac-man wants to travel in and to do
that we're going to say if array exists
and vex 2 next point
FOMA element and what this is going to
do is search for that inside that
direction I want to move inside of said
array so I'm going to say element equal
to and Miss pac-man's rigidbody and
we're going to normalize it also which
means I'm going to convert down to
either ones negative ones or zeros I've
talked about normalized a lot of times
and change this to a buddasi T
normalized and then there's no semicolon
inside of there what this is going to do
then it's a hit a wall and we're going
to set it to false because that means
that you know where the direction we
want to go is a possible direction for
that said thing otherwise hit a wall is
going to be true hit a wall and change
it to true because it doesn't exist then
after that is all set up I'm going to
say if hits a wall and if I want to stop
pac-man from moving
I go rigidbody and velocity and set it
to vector 2.0 and another thing I want
to verify or I want to make sure that my
pac-man is in the middle of the screen
or the middle of the maze when it hits
the wall because there might be a
potential for that not to happen so I'm
going to change the position to the
middle of the maze and then I'm going to
set the velocity to zero which stops
miss pac-man from moving but to do that
what I'm going to do is I'm going to get
not miss pac-man's position in this
situation but instead I'm going to get
the position of the point that I hit so
I'm going to change this to Collider dot
transform position X plus 0.5 I think
I'm still going to need that and then
the same exact thing for this oh we can
just come in here and just go Collider
transform okay and that's going to make
sure that it stops on the pivot point
next to the wall and we come in here and
test it see if it works and here we go
miss pac-man pulling she stopped and go
this way and she stopped and she stopped
and she stopped and everything is
awesome only problem is whenever she
stops she's still animating which isn't
good so what I want to do with her is I
want to have our mouth actually shut and
to do that I'm going to have to come in
here and I'm going to define a sort of a
stopping sprite or a pod sprite or
something like that so I'm going to go
public and I'm going to make this public
so that I can drag the sprite I want to
use into it inside of unity I'm going to
call this paused sprite jump over inside
of unity and here is Miss pac-man whoops
let's go and get these scripts and miss
pac-man and where is oops not that one
I'm being silly
miss pack him like that and where is the
there it is and you can see pause sprite
and then I have to figure out which one
of those I want to use so I'm going to
say sprites and sprite sheet and I'm
just going to use that one which one is
that that is 18 so I'm just going to
drag that in Miss pacman there and there
is sprite 18 just got lucky with that
one whoops I don't have any place this
there it is so sprite 18 drag it and
drop it right there so that's going to
be my paused sprite back into the code
and jump way down to the bottom create a
function that is going to stop that
animation whenever it hits a wall and
what am I going to call this let's call
this void updates eat
animation and it's not going to receive
anything and it is going to say if the
rigidbody velocity I can't spell
velocity right velocity there we go is
equal to vector 2.0 and you know where I
set that well in that situation I'm
going to get the animator so get
components and animator and sets enabled
to false and otherwise then I'm also
going to go and get the sprite renderer
get component once again sprite renderer
and say that I want to use the paused
sprite instead and to do that just go
like this and sprite is equal to and the
paused sprite that I decided I wanted to
use goes right there okay and this is
render or okay so I got that I'm going
to say else come down here and I need to
get component animator once again and I
just need to set this back to true so it
goes back to the regular animated
version so it just changed out the true
and that is sets save that and then I
can call update eating animation right
here just copy that and I'm going to
throw that right at the very end of my
update function so this guy right here
fixed update I'm going to go and find
the end of fixed updates and throw it in
right after it ends so there it is
semicolon and now it should stop let's
run it and let's see if it works and it
is say pac-man stops moving her mouth or
miss pac-man stops moving her mouth
whenever she hits a wall okay good stuff
okay so there's mainly only one error in
or one problem with our miss pac-man if
she is moving she's able to change her
direction at pivot points but she's not
able to change her position unless she's
on a pivot point as you can see some
like clicking and it's just not taking
so what I want to do is I want to have
it set up so that she will be able to go
and also move
if she's not on a pivot point so how do
we do that jump back into our code again
and we're going to be doing this inside
of our fixedupdate it's actually not
that hard I'm going to keep this really
the code should be cleaned up a little
bit but I'm going to keep it the way it
is because I think it's going to be
easier to understand if I just stick
with the way I have everything set up so
basically what I want to do is I want to
allow it miss pac-man that is to reverse
directions if needed so what I'm going
to need to do is before I get to testing
the input from the keyboard I'm going to
need a weight to get the direction that
Miss pac-man is currently moving in on
the X and y axis and how you can get
that information I'm going to call this
local velocity is go transform inverse
transform direction and then throw
inside of it the velocity of our rigid
body and this is going to allow us to go
and find out the direction miss pac-man
is moving on the x and y plane of our
game you know our game board all right
you're going to see exactly what it does
so I'm going to do here is right after
this I'm going to come in and I'm going
to say if local velocity dot X is
greater than zero what that means is
that means that I am moving in the right
direction so X plane is greater than
zero it means I'm moving to the right if
it's lessons there it means I'm moving
to the left and likewise same is true
with local velocity on the Y plane which
you're going to see here in a second
well if that's true what I'm going to do
is I'm going to get this guy right here
throw it inside of there it's going to
be exactly the same
well actually everything's going to be
exactly the same except for this see I
know that I am currently moving in the
to the right and I'm saying I want to
move back to the left that's always
going to be valid so I don't need to
check if I can move in that direction I
know I was already moving from that
direction so I'm going to keep that
exactly the same and I'm just going to
copy all this stuff so copy just keep
everything simple and paste it in there
all right so there that goes perfect
then we're going to do
I'm going to say else and then I will
verify if I need that information or not
or then I'll verify if I can move in
that direction okay hopefully that makes
sense and then we will paste that inside
of there and save it then I'm going to
do the same exact thing with this guy
down here else if so I'm going to go and
copy this actually so right after this
opening curly bracket I'm going to come
in paste that inside of there throw in
our curly brackets and then I'm going to
change this to less than what's less
than main that means I'm moving to the
left and I'm saying can I move back to
the right yes I can every single time I
can do that it's also going to cut down
on performance issues also so we're
going to go get that guy well let's go
and throw that curly braket down here
then once again I'm going to go move
vector like this copy that paste that
inside of there and then I'm going to
get all this stuff also and copy it and
paste it inside there so copy and paste
it inside of there all right good stuff
then I'm going to say else and then we
will do all the other stuff the other
options so cut that out of there and
then right after this we will paste in
the other semicolon all right and then
we'll just continue doing that down here
however it's going to be slightly
different I'm still going to say if and
use local velocity but I'm going to use
Y in this situation I'm going to say if
it's greater than zero open that up but
then I'm going to copy and paste all
this again so I'm just going to go copy
throw that inside of there and then get
all this stuff all of this good copy
come up there paste that inside of it
and I'm going to say else and then I can
do the way that is going to make sure
there's a pivot paste out there once
again for the S come right after this
say if local velocity Y in this
situation it's going to be less than
zero
let's again copy this paste it in there
and then get all this and once again the
code could be optimized since I'm doing
the same thing twice but you know I'm
just going to keep it like this just to
keep everything nice and simple I'm
going to say else like that cut that out
of there and then come down here at the
end of it it's
that in there and save it and now
pac-man or miss pac-man should be able
to move in any direction here regardless
of if she's on a pivot or not and we'll
see if she can yeah look perfect okay
and here we are in a section where there
are no pivots and she's moving up and
down and we can do the same thing here
no pivots and she can still move left
and right all right guys so there you go
miss pac-man is perfect she is moving
around she's staying inside of the maze
and this has been a lot of fun actually
and really enjoying making this pac-man
hopefully you are as well and like
always please leave your questions and
comments below otherwise till next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>