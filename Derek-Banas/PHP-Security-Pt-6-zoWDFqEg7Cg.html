<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Security Pt 6 | Coder Coacher - Coaching Coders</title><meta content="PHP Security Pt 6 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Security Pt 6</b></h2><h5 class="post__date">2011-01-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zoWDFqEg7Cg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello internet and welcome to part
6 of my PHP tutorial today I'm going to
focus a lot on directory traversal but
first I'm going to answer a couple
questions that were sent in to me I had
talked about in the previous tutorial
about how somebody I had known had been
receiving reports that they had been
sending on immense amounts of spam well
here in essence is their comment form
with some of the information missing
basically what the person was doing just
to jump right into it as I'm doing right
here was going into their comment form
and now I don't have an AOL account
right like that what a lot of people
don't know is if you don't protect this
email area and it is sent to the mail
function inside of PHP you can add a
blind copy to this and it's just this
simple just put in a percent sign and
you're gonna see the evil of percent
signs in this tutorial fold by an a b c
c colon and then as many emails as you
want can be attached to this this is a
blind coffee feature so of course you
would always want to make sure that any
emails that are entered only have one @
symbol and follow this and i've gone
over the regular expression that goes
along with that in previous tutorials
another question that I received I can
just delete this was in regards to SQL
injection people were asking questions
about the other different SQL queries
available specifically insert update and
delete I'm approaching this from a
security standpoint meaning you're
securing from this but just to show you
exactly how dangerous this could be lets
say a malicious hacker decides to do
this to you you have this query
available for someone to put in here
using the update query where user ID is
equal to blah blah and pass blah blah
blah blah you can remember this from the
previous tutorial if you didn't watch
part 5 definitely check it out otherwise
this makes no sense to you at all well
remember how we were in here and we were
negating all this information previously
well imagine if somebody came in here
and in the input area they put boom or 1
which is always going to come out as
positive followed by - Jeff space and
MySQL and in the other ways is it's
going to be just - - this is going to
change every single user ID on the
entire database
- whatever this password is right here
so that shows you just how dangerous it
can be if you allow people to access
these different queries in - q ah so
they're showed you two very very nasty
things now I'm gonna show you one of the
nastiest things pretty much on a daily
basis my website along with hundreds of
thousands of other websites gets hit
with what you see right down here okay
this is kind of what we call honeypot
which attracts hackers anyway because it
says PayPal checkout shopping cart yeah
it's very attractive well you could see
down here they have option which is
where we're gonna assign a value to this
variable right here they have all of
this information in right here this is
what we call a directory traversal hack
and you can definitely tell that the
person at least a certain extent knows
what they're doing here because they put
an all at the end I'm going to show you
exactly why you would use this and why
all this is extremely powerful I'm going
to show you a ton and ton of examples
alright so let's just start off real
simple here and let's say they have some
PHP code or you have some PHP code and
this says if is set and no post does not
protect you from having to worry about
these things by the way you know let's
decide that you have a feature in your
website that based off of the language
that they enter in the URL you're gonna
serve up different content just to show
you exactly what's going on here I'm
gonna print down out the screen and then
you go and by the way directory
traversal is I have seen reports that
say that over 70% of websites are
subject to some form of directory
traversal right and let's say that based
off of the value of language you are
going to load a different header file
it's a JPEG of some sort or another okay
and you think well I'm gonna just
protect myself by putting the JPEG in
there that's gonna guarantee that this
is going to include a JPEG image and
it's going to print out this specific
JPEG image to screen okay just like that
then that's the end of your PHP code
I'll show you just how malicious this
can get if I'll save it bad stuff 3 and
let's say any hacker comes in here and
puts in language equal to and this is
just a way that they can print out a
file that you have students of your
current directory and see here's the
evil null at the end what this does
it nullifies that JPEG it cancels it out
so that's the reason why it's put on
there and if we execute that hello
you've been hacked you can see that this
is actually the file that I decided to
shoot out to screen it is not this
hacked right here and if we jump over
and look you can see that right here PHP
hello you've been hacked so I was able
to go in there and eliminate what you
thought was a catch forcing a JPEG image
to be put on the screen and instead I
executed to screen exactly what was
stored inside of that file so you think
well that's not very dangerous which it
definitely is and by the way if you'd
want to get rid of a hackers ability to
go in there and insert things into your
include include once and require once
and require functions in PHP I and I you
are going to see this line right here
and if it's set to on that means what I
just showed you can be done to you if it
is set to OFF and your server is
restarted they cannot do that to you all
right so you definitely want to go into
a PHP ini and change that to off well
let's say that you want to go in here
and you decide that you want people to
be able to get contents of files okay
we're just gonna leave this exactly the
same as we have right here yeah we're
going to say result is equal to file get
contents so this is a function you have
available that is going to accept user
input well here on screen you just saw I
bypassed some of the security and using
this preg replace function actually at
the same time I'm going to show you how
to I'll eliminate PHP code or injection
there's a regular expression that's
going to cancel out that ability to use
that information and in here I'm gonna
type in result file save reload and you
can see it went in there using the file
get contents and put in exactly what I
wanted it to put in there to get even
more dangerous let's say you allow
people to use a function on your
computer called exact which allows you
to perform system commands so let's get
rid of this and type in exact language
exec and I see this capability all of
the time and web sites what this is
going to do is it's going to store there
is
of this command inside of this Iraq and
for each s you have seen before cycles
through those values that are stored in
the Iraq and in this situation you're
going to print them out to screen and
will file save that and then this time
let's say that under language the hacker
decides to go in here and type in l s %
to O which is the URL encoding for space
- L a and hit enter you can see that
they were very easily able to print out
and I'll zoom out because you can see
this all of the information on all of
the files that are currently stored in
the current directory and you might say
well that's no big deal even though they
know creative information about all the
different files that are available - for
them to hack so now using that exact
technique I'm going to show you even
more malicious information people be
able to get at because with the exec
function they're actually going to be
able to access any file on your entire
system that they would want to and this
gets back to that link that I showed you
in the beginning of the tutorial that I
see constantly from computer hackers so
here what we're gonna do without making
any changes to this code that's right
here I'm gonna come up here and zoom in
and at the end of a language this time
I'm going to type in cat which is a UNIX
command % - OH
followed by dot dot forward slash dot
dot forward slash dot dot forward slash
dot dot /et say and I think you might
know where I'm going with this this will
give them access to every single user ID
on my whole entire system and you can
see right here that that is exactly what
they did every single user ID on the
entire web server is now available to
them and yes you can also get access to
the password files so let's say you're
saying to yourself well yeah I see that
you have that there but I could just
check for et Cie forward slash password
never let anything in there like that
well this is where encoding comes in and
also what a lot of people do is they
block out the two periods and they block
out forward slashes and won't allow
those things to appear on the screen
well that's perfectly fine because all I
need to do again if I have my % is come
in here and type in % - II just
like that followed by another percent 2e
which represents the periods and then if
I want to get rid of this sword slasher
instead encode it percent to F right
like that and I need three more of those
guys I'm just gonna copy this right like
this get rid of this and go one two
three and of course all this stuff is
automated by a computer whenever these
attacks are going forward and if you
data you'll see that all that
information came through again so that's
how you RL encoding works it helps
protect so that you can't tell exactly
what they're going for but you're saying
oh no III would get rid of the e TC for
such password okay well I can also get
rid of that because all I need to do is
also put in the character encoding for
all of these letters and all of these
letters also have sneaky ways of
changing things there you are nothing
but character encoding across the entire
thing and hit enter and you can see you
got the same results all of the
information in regards to user IDs on my
server this is my personal server
somewhat that's stupid this isn't new
thing thing my website so there's how
you would do character encoding you know
access to the et Cie password files so
basically what do you do if you want to
fight off hackers what sort of security
parameter should you put off to fight
directory traversal don't provide access
to functions that interact with the
system number one also using regular
expressions you want to get rid of these
guys any forward slashes back slashes
semicolons which by the way the encoding
for a semicolon is % 3b get rid of
dashes get rid of the quotes and the and
symbol you want to filter all those out
from user input Y also your webserver
should have one owner which is going to
be WWE almost all cases and this guy
should not have ownership over any
folder outside of the web server and if
you don't know this is how you change
owners of folders inside of UNIX or in
max because they're in essence UNIX
platforms also you need to have your
permission set to the maximum security
level if the
user doesn't need to be able to read it
don't allow them to read it they don't
need to write to it don't allow them to
do that don't allow them to execute it
if you don't want them to do that and
just to briefly go through exactly how
this is set up normally your files are
going to be seven five five if they're
PHP files and if you want to change a
file to seven five five you would just
type in change mod seven five five and
the name of the file or the name of the
folder and where these numbers come from
is the ability to read as a value that
is equal to four the ability to write to
a file is equal to a value of two and
the ability to execute has a value of
one so seven four plus two plus one the
owner of the file the person that
created it is going to be equal to seven
and then everyone else is only going to
have read and execute four plus one
equals five they are not going to be
able to write to those files so to
finish this off
do you not allow people access to eval
system exact file get contents because
this is what computer hacker is looking
through a pass through include or
include ones require or require once
file put contents and obviously half
open and any other files that would
access the system so there is a whole
bunch of mischievious things that are
done through directory traversal if you
have any questions or comments leave
them in the comment section below
up next I'm going to go over cross-site
scripting and how to prevent it and
exactly the damage it can do so next
time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>