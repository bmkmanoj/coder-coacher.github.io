<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Web Design and Programming Pt 21 | Coder Coacher - Coaching Coders</title><meta content="Web Design and Programming Pt 21 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Web Design and Programming Pt 21</b></h2><h5 class="post__date">2011-01-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/edzcdZBJtHY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well internet and welcome to part 21 of
my web design and programming tutorial
today because Marcus asked for it I'm
gonna show you how to build a pretty
ironclad login script that you could use
on your website here I'm going to
introduce how to use sessions securely
show you how to create multiple
different tokens to heighten security
really there's gonna be a lot of things
in this tutorial that we've covered
previously just taken up to the next
step I went in and I put in some of the
HTML code just to keep from having to
type that in and up here of course first
off we need to initialize a session and
I talked in part 20 about what sessions
were and you do it with the session
start function and then all this code is
available a new think-tank I'll call by
the way it's all free you can download
it and there's a link to it in the
underbar here I'm going to call a file
that oil connect me to my database plus
on top of that it's going to include
some security functions that are gonna
help scrub all the input people in it
and that's all you have to do there you
just started a new session now all of
your information is going to be stored
on the server except for of course the
session ID which is a cookie then what
we got to do in PHP code again before
any of the HTML is confirm the user ID
and password entered are valid in here
we're gonna do that using regular
expressions
so again if is post submitted here I'm
just checking to make sure that this
value submitted has a value which the
only way that's going to occur is if the
user submitted information on a form and
if you forget how this works down here
you can see the form information and
here's where I'm giving submitted a
value of true again from previous
tutorial okay so if they did click the
submit button and I got here what I'm
gonna do is run a regular expression on
this Craig match regular expressions or
your defense in regards just securing
your website and here I'm gonna say all
right well I know that my user ID that
they are going to enter it's either
gonna be a capital or a lowercase Z or
it's going to be numbers and that's it
that's all I allow so that's all I'm
gonna say I accept it's gonna be between
eight to twenty characters in length
that's at this regular expression says
and I'm going to run strips lashes on
and then
to trim off any whitespace you really do
need to go through all this security if
you do not want somebody to break in
your website and I'm by no means saying
this is a hundred percent secure I'm
just saying that person would have to
pull their hair out to get through all
of the security that I'm putting here I
personally don't believe anything is
ever secure 100 percent post and here
all I'm doing is getting the user ID
that they entered and oh by the way this
is what it looks like when it's done
this gigantic mammoth thing and all of
these links over here will change based
off the person being logged in or not so
what this is is it's just checking the
input that is put in to that little box
right there and it's checking that it is
valid close that off else I'm going to
set the value for the user ID equal to
false and then I'm gonna echo to screen
that they entered the information
incorrectly and I'm just typing whatever
into this okay so now I know that the
user ID and it is going to be valid so
now what I need to do is actually do
almost the exact same thing to the
password so I'm actually going to copy
this code copy paste don't need this
part and then all I'm gonna do here is
change this from user ID to password or
pass as I call it because I have the
user ID and the password are both
constrained with the same regular
expression I want them to be equally
complicated and then on top of that I'm
gonna throw in my captcha system and
remember from last time I just copied
and pasted that because I got all that
information from Google and I'm gonna do
that again here to save me time you can
see right here I put in my CAPTCHA code
and this is going to check that the
caption information was entered properly
and again remember you have to put a
private key inside of here and that's
all I need to do in regards to
validating the user ID password and also
validating that the CAPTCHA was entered
properly now I need to query my database
so what I'm gonna do here is check that
there is a positive in user ID meaning
it passed all my tests the same thing
for password and same thing for the
weird CAPTCHA system and give you an
idea of how well capture systems work on
my website people used to try to hack my
forum I would guess on average over 40
times a day and after I installed a
captcha system they've proven it pretty
much
giving off and then we got to create our
quarry for our database and it's just
gonna be select user ID first name user
ID password from users where user ID is
equal to make sure you put these quotes
in here and password is equal to sha
which is for encryption really like that
so that's the query I'm gonna be issuing
and then into result we're going to put
the results of this query or trigger
error and of course you can put a more
friendly response just typing in
everything kind of out of my head here
as I go so if my skew own affected rows
and all I'm doing here is checking that
the number of rows that were affected by
this query is gonna be equal to one
because there can only be one user ID so
that has to be the route way that it
comes back to me otherwise there's
something amiss and if that is so I'm
going to get the query results and
assign them to the array named row right
like that and this function just frees
up memory if I perform a large query but
I just always use it just in case I need
it and then what I'm gonna do is assign
to the session called first name the
value that was shot back and is stored
in the one position from the quarry
first name first name zero one so that's
where that comes from all this
information will be stored on the server
I'm just gonna copy that put user ID in
here and user ID comes from where the
second position to 0 1 2 so that's where
the user ID comes from so I'm going to
assign that to session information and
here I'm gonna add a second layer of
protection because every single time
that person logs in I'm gonna force them
to create another random token it's
gonna be a random number between those
two guys I just plugged in there and
then I'm gonna query the database again
I just call this quarry 2 and because I
changed that token I want to update the
users table and set token ID equal to
token ID where user ID is equal to the
value that I have stored in this session
remember the quotes go on the outside
the single quotes here okay so there I
created a second query that's going to
create another layer of security with
and token I also got a question I can't
remember from who and it was in regards
to how to set up a second token to add
that layer of security
nice q well query and I'm going to send
a query to and then I need to save the
value of that second token in the
session value for that token and then to
add another layer of security
I'm gonna call session regenerate ID and
what this is going to do is get rid of
the previous session cookie and create a
brand new one this is going to protect
you from what's called session fixation
here I'm going to show you something I
haven't done before I'm going to load a
page by using the header function
followed by in my case localhost ford
slash login board slash index dot PHP so
what this is going to do is it's going
to force once you get in this part of
the script for your browser to jump to
this new location right here and then of
course I want to call in MySQL close to
close the database connection and an
exit to close the script altogether okay
there's a ton of stuff right there and
then I need to just close off everything
else so else no match would have been
made in this circumstance so I'm gonna
echo to screen and I'm actually gonna
scroll up and grab this guy that's a
little bit nicer and paste that in there
okay so that's gonna port that they
entered the information incorrectly nice
qo close because it didn't get to this
previously closed database close the
script you definitely want to close the
script every single time otherwise it'll
continue to run in the background and
then we're gonna close that part off and
then you're just gonna have to kind of
trust me here there's one more of these
guys so copy this bass boink alright and
that is the end of the submission part
of the website now what we got to do is
come in here and define this guy right
here what different links are gonna show
up based off of current login status so
I'm gonna have to close off my PHP
script since I am now going to get into
the HTML section so I just did that
right there and I do do this a lot I
create the HTML part and then wherever
the PHP code goes I actually write what
needs to go in there so what I'm going
to do is I need to change my links based
off of session information know
problem I'm gonna do that come in here
and go if is set underscore session
first name I know a first name is set
that means there's an active session so
I'm going to greet this person by
addressing them by their first name and
if it's not set I'm just gonna close off
that h1 tag and just have Welcome show
up on the screen and then I'm gonna
check if the user ID is currently set in
the session and I'm gonna check here
that we're not on the log out screen and
the reason why is the only way
somebody's gonna be sent to it is if
they are trying to log out and you're
gonna see in the next tutorial I want to
show you how to create a logout screen
how exactly that works it's not equal to
okay so what this is saying is it's
grabbing the current location that you
were in with what page you were
currently on and it's subtracting 10
from that which is the number of letters
right here and it's checking that it's
not equal to that so that's what's going
on with this guy so what this is doing
is checking that user ID is set and that
we currently are not on the logout PHP
page hopefully that's not confusing if
it is leave a question but I'll explain
it further and then what we're gonna do
is to find these links based off of
where they are and then I'm just gonna
copy this paste this in here and then
type in change password and call this
change password and then end that echo
else they currently are not logged in so
I'm gonna put up a whole new set of
different links the end so I'm gonna
copy this actually I'm gonna copy both
lines paste and then we're just gonna
change this to register and then type in
register and then change this to good
login which is the name of this script
and type in login to count delete that
this forgot password forgot password
I'll need to do is close that out and
that's that part of the PHP script and
all the rest of this information you've
already seen this is where they're
entering user ID and password here's
where I constrain maximum length here's
where I call the caption information
that we got from Google and here is how
I end the entire page and that is all
that goes into making an extremely
secure little login script and here I'll
show
exactly what goes into it to login Sally
come here pe Paulsen one say it's kind
of a funky user ID that's not common
that's a great thing why is it that way
because we forced them to do it that way
and then I have to see if I can also
type in the CAPTCHA right I think that's
right
it also has a little sound thing or play
words to you hit login and you can see
here welcome Paul it found me and it
knows who are you so there's a extremely
secure login script if you have any
questions or comments or if you have an
idea on how to make it even more secure
I know I could do it secure socket layer
and so forth and so on but if you have
any other ideas aside from that feel
free to leave them below and if I click
on logout it deletes the session
information and in the next tutorial I'm
going to show you how to create one of
those as well as a secure forgotten
password script text</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>