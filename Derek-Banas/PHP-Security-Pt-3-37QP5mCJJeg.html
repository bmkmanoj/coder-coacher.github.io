<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Security Pt 3 | Coder Coacher - Coaching Coders</title><meta content="PHP Security Pt 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Security Pt 3</b></h2><h5 class="post__date">2011-01-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/37QP5mCJJeg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">whoa Internet and welcome to part three
of my PHP security tutorial today I'm
gonna go back to our more traditional
presentation style just for this one
time and go over the most vulnerable
website security flaws that hackers
commonly attack now this is going to be
a basic presentation it's going to
become a little bit complicated in some
parts but I kind of domed a lot of
things down so if I don't get too
specific in this presentation that's why
and future presentations don't worry
I'll get much more specific in regards
to how sites are attacked and how to
better secure them so typically I'm
going to go over ways you can defend
your website repeat you over and over
again that nothing sent from the client
is ever safe meaning Java Script code
and so forth and so on or user input
that you think has been secured or
cleaned by Java Script you can never
count on this being true I'm going to go
through some ways that hackers break
through user authentication and by that
I just mean user IDs and passwords and
some ways to protect yourself from the
client-side and authentication attack
and then I'll go briefly over an
explanation on some of the other
techniques hackers used to break into
sites these are the four main ways you
can defend your website through
authentication properly using proper
user IDs passwords and CAPTCHAs to make
sure that you can block automated
attacks by properly cleaning all user
input through session management and by
limiting access and keeping
administration tools completely separate
from your basic user accounts
you must always clean all messages sent
to the server on the server why is that
it's extremely easy to manipulate
the client-side and I'm going to give
you a couple different ways that this is
done first the person could go in and
download your entire website with an
application such as W get edit the code
however they like and then reload that
page they created and attack the server
now you can check what is called the
referer header which is a reference to
the address that sent the page and this
is embedded in the HTTP request however
this can also be edited so there truly
is no way to actually trust anything
sent from the client side also hackers
like to use something called an
intercepting proxy what these do is they
it between the browser in the server so
you actually have the client and then
you have the intercepting proxy and then
you have the server so an intercepting
proxy sits between what you think is
your safe secure JavaScript code or
whatever you're also using on the client
end because nothing can protect you on
the client end not even flash or Java as
I'm going to explain here in a minute so
it sits between the client and it grabs
and intercepts all the information
before it gets to the server and it also
grabs information from the server before
it gets to the client and programs such
as web scarab burp and Paris or used
these or what we call intercepting
proxies they're extremely easy to set up
so I just want to make absolutely
positive that you understand that
variables and hidden values cookies
anything can easily be seen and edited
and of course if you use the get method
for passing information it is quite easy
to change anything that has passed
through the URL so here I could easily
come in and change this value encrypted
values also might not be safe if they
are sent from the client and here it may
give you a sort of real world example
let's say for example you create a PHP
store and whenever a person chooses a
product that they want to purchase such
as a Sony stereo you also pass an
encrypted value for the specific price
for the Sony stereo let's say for
example the person might have a discount
code or what have you for any reason you
decide that you must pass the price
however you think well I'll just encrypt
that price and they won't be able to
change it wrong chances are if you do
encrypt anything in your PHP code you
encrypt everything in precisely the same
way so very easily somebody could go and
find say the price for a pack of gum
which they know is going to be
considerably less than a Sony stereo and
then take this encrypted code and place
it in the URL just like this so this is
just a brief example of how encrypted
values are maybe also not safe if
they're coming from the client and if
you're using Java applets or flash this
is just how simple it is to go in and do
it precisely the same thing as you do
with PHP code for example if you have a
Java applet you could just run it
through a program called jad which will
decompile it and then another program
called Joad which will clean any
gated code which means a lot of times
people create Java applets and flash
programs and so forth and so on and then
they run them through what's called an
office Gator and what it basically does
is jumbles up the code well program like
Joad will clean that up for you and
flash also has programs that do very
similar things so how exactly do you
protect yourself from potentially
damaging information sent from a client
well just never transfer anything
personal to the client nor transfer
anything that doesn't need to be
directly from the client to the server
how we would get around the little
problem that we had before it when
regards to whether you wanted to pass a
price well first off but all possible
just don't pass this from this price so
that person has the opportunity to
change it but if you find the need you
could take a product identification
number followed by the price and then
encrypt this whole entire value and then
separate them this would help you avoid
that issue also you want to avoid
showing encrypted and unencrypted
versions of exactly the same text so
that the hacker would be able to figure
out exactly how that text was encrypted
now I'm not saying that you should try
to secure the information on the client
because this is often a great trap to
figure out whether you are currently
being hacked let's say that you check
that a person in a name field for
example or for a user ID only enters up
to 12 characters for example well then
if you are passed on the PHP end or on
the server side a password that is
higher than 12 characters chances are
very good that the person somehow
bypassed your JavaScript checks and now
you're being presented with that same
problem again which should have been
disabled on the client end which would
mean you either have a hacker or
somebody's trying to access your website
with JavaScript disabled if you decide
to err on the side of safety you would
log the IP close the session and disable
the account and I'm going to get more
into how to do all these different
things in later tutorials you also want
to follow very proper cleaning
procedures for all data that is sent
from the client from the user you want
to validate the input contains only
valid characters and a valid length and
this order is very specific then you
want to protect against SQL injection
then you want to verify the user's
identity and then
you want to escape the HTML and the
reason why we do it in this order is
let's say you would encode this caret
bracket right here to this format and
then come in and delete out all the and
symbols and semicolons to protect your
overall security you can see here that
that's going to create a lot of other
additional flaws so how is
authentication attack mainly through
brute-force attacks but that's
definitely not it and if you think you
are being attacked through a brute-force
attack you could of course track all
your failed logins and lock down that
account based off of tracking the IP
address over this does open you up for
another hack which is called a denial of
service attack where the person could
simply come in and continually enter
wrong password for all of your user IDs
until all the accounts are locked down
and none of your users can log in
another way you can help avoid
brute-force attacks is to force your
users to create unique user IDs in the
same way that you force them to create
unique passwords I'm going to go more
into this in a second and again never
send anything personal from the client
so you want to make all your user IDs
and your passwords contain at least one
uppercase character one lowercase
character one number potentially one non
alphanumeric character and make sure
that both of these are unique you do not
want the same user ID and passwords
plus you must definitely would want to
ask a security question that you create
by no means let them create their own
security question because very often
their security question will be the
password itself and that kind of messes
up the whole security issue and also on
a regular basis you would want to force
them to change the passwords another
common mistake is telling the person
that just failed to log in exactly why
never tell them that they failed to log
in because the user ID was incorrect or
because the password because that just
makes it that much easier for them to
brute force their way in and if you put
a timeout
of say 30 minutes or an hour before they
are allowed to try to log in again
don't tell them when that timeout period
is just tell them to try again soon
remember cookies can be intercepted by
intercepting proxies if you do create an
account activation code make sure that
it is unique and in the previous
tutorial when what are going over
account activation codes and that script
believe me will become
more secure as this tutorial is
continued if you use a multi-stage login
system which means that they would for
example put in a user ID and password
and then would be required to enter a
PIN number and then be required to enter
a CAPTCHA code all on separate pages
make sure that you verify they passed on
all of the previous stages each time
they are asked to Rivera fie on at stage
2 and stage 3 otherwise of it allow
somebody to jump in and maybe just
answer a pin code number which would
also hurt you security also if you're
using a multi stage login system you
would never want to pass a value such as
verified equals true for each point in
which they pass the multi stage system
and also by no means is it secure but
you should always use post requests over
get requests in your HTML other common
mistakes is storing password information
that is easily accessible with session
tokens that are stored on the system and
I'm going to get more into session IDs
and securing this information you would
always want them to enter their
passwords before they would be able to
access anything that you would want to
secure so sessions will only store user
IDs nothing else your forgotten password
scripts must be protected this is one of
the easiest ways to hack and went in the
websites I'm going to get more into that
a second also use CAPTCHA systems as
much as possible because they are very
reliable not perfect but very reliable
and telling the difference between an
automated computer system and a human
again never allow users to define their
own security questions because why very
often they enter the password as the
question so how exactly should you
secure your forgotten password scripts
well the user does request a new
password you want to send them another
random password to their email don't
send them their original password then
you want to require them to answer a
security question remember the one that
you told them then you want to require
them to create a new password of course
use a CAPTCHA system to make sure this
isn't an automated system you want to
set a time limit for the use of this
script and then shut it down and then of
course you definitely want to log all
activity on all of your forgotten
password scripts again this is a very
often hacked area of your website
now I'll go through briefly a little bit
about other random attack
you have cross-site scripting attacks
and a cross-site scripting attack is
normally whenever a hacker embeds and
then executes client-side code that is
normally embedded in messages posted on
bulletin boards and normally whenever
this code is executed it can steal
cookies such and data and etc I mean I
don't get a lot more into cross-site
scripting basically how to avoid it
is to always validate any information
that gets posted to your website and you
have SQL injection again we went over
this in previous PHP security tutorial
always validate all of the input the
user enters then you have session
hijacking and fixation basically you
avoid this by limiting the information
that you have stored in your sessions
and then you can also use the session
regenerate ID function which will create
a new session when a person does come on
to your system and also it's a good idea
to always create secondary verification
tokens whenever you are using sessions
and I'm going to get a lot more into
that very soon in this tutorial then you
have shell attacks and this is whenever
people try to execute shell commands
through your code and basically to avoid
this is don't execute shell commands
however if you are forced to do that
make sure that all user input is first
sent through the escape show org
function which is provided by PHP and
again I'll get more into that and then
you have buffer overflows and basically
it will avoid them it's kind of a hard
thing to explain in this tutorial I'll
get into it later but basically to
eliminate those you just want to limit
the length of strings that users are
able to pass through using the string
length function so look forward to a lot
more code in the next presentation and
if you have any questions or comments
leave them in the comment section below
so next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>