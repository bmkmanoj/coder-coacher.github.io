<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Security Pt 1 | Coder Coacher - Coaching Coders</title><meta content="PHP Security Pt 1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Security Pt 1</b></h2><h5 class="post__date">2011-01-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Nx-g-0ynP_I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello internet and welcome to part
1 of my PHP or web programming security
tutorial this is a continuation of the
previous web design and programming
tutorial throughout this we are going to
explore many different ways that people
hack your website including session
hijacking SQL injection cross-site
scripting and coding tricks and a whole
bunch of other things and mainly what
you want to do the most important thing
whenever you're defining that you want
to access your database is that you want
to access the database only using
protected files preferably that are
outside of your web directory if you do
that that makes it almost impossible for
people or hackers to gain access to your
secure information as long as you use
regular expressions well and we're going
to go through a whole bunch of this
stuff so and how you want to access that
file would be let's say you have an
include folder that is right outside of
the web directory and in that file you
have all of the code that it allows you
to access the database and it pulls all
that in here and dumps it in here just
as if you typed it in yourself now I'm
going to skip over that for a minute and
go into exactly what's in this config
file this is what that config file is
going to look like the HP and then what
you want to do is you want to define all
of the variables that you need to access
your database meaning usernames
passwords host location and database
name as constants and this is how you
define constants again if you didn't
watch the other tutorials you should
watch them otherwise this is probably
confusing you and by changing these or
assigning these as constants that will
keep hackers from being able to go in
and change these values you just want to
be as paranoid as humanly possible
really because most websites out there
are hackable a lot of people don't
realize it and one of the major reasons
is so many people don't understand
regular expressions which is probably
your main defense against computer
hackers and then here we're just going
to connect to the database then we're
going to check HERE if we're able to
access the database itself you also want
to suppress errors so that it is hard to
figure out as much about your
configuration as humanly possible and
security is a major subject so I'm going
have to break this up into a bunch of
different tutorials if you're unable to
access that database we're going to
trigger an error but we're going to
suppress everything so we're just going
to say couldn't and then we're going to
kill the script all together the exit
command and if you were unable to
connect to the database server we're
going to trigger another error you could
actually not tell them you're using SQL
and that would also probably be a little
bit more secure I'm just going to leave
that in there for now and there is
everything you need to be able to access
the database now what we're going to do
is we're also going to define a function
that's going to scrape out any potential
harmful information this function for me
changes constantly each time I learn of
some new security flaw in PHP and this
is in here more for you than it is for
me I'm checking to see if this function
exists being the MySQL real escape
string and basically what this does is
it escapes characters that could be used
for SQL injection meaning people that
are trying to run SQL scripts on your
database this is just the database
itself and here I'm going to run this
function since I wouldn't get here
unless it existed I'm going to trim all
the whitespace off of it right like that
and then I'm also going to run another
function on this called strip tags what
this is going to do is it's going to
strip out any HTML tags that somebody
try to put into your input strings and
if that function doesn't work I'm going
to use the second-best function for
escaping these strings which is MySQL
escape string function again trim off
any excess whitespace and close that off
and then I'm just going to copy this guy
right here and paste that in and put
some more space here so it's easier for
you to see what I'm doing I'm going to
close that function off in return data
this function is going to pretty
effectively escape out any dangerous
information in regards to tags and so
forth and so on like I said there's a
bunch of different ways to get around
some of this this is just a secondary
defense and now I'm going to show you
the front line defense and keeping this
code out of here and that is going to be
regular expression so I'm going to come
in here and I'm going to delete all this
out hopefully you got all that and this
is how you could use regular expressions
to make sure that nobody is trying to
enter bad information or trying to
implement either cross-site scripting or
SQL injection to
to an input box that is looking for a
first name to be submitted this is
actually unsafe but for now there's only
so many things I can handle in one
tutorial about having it be an hour long
this is actually going to be a hidden
field that will be triggered if somebody
clicks on the submit button and if they
do we're going to run all this code but
first what I'm going to do here is to
form a regular expression check and I'm
going to specifically and I did a whole
entire tutorial on regular expressions
I've done bunch with some of them
actually so it's like anything else you
know what you can expect is somebody's
entering a first name and that's going
to be that there's going to be a capital
letter between A to Z and lowercase
letters between A to Z then potentially
a period and potentially a quote and
also there could be a dash just put that
in there and then we're going to define
that this is going to be somewhere
between 2 to 15 characters in length
more than likely and I'm using
percentage signs here as my delimiters
if you're wondering what that is and
what strip slash does is it unquote
squatted strings which is another
security concern and it's also a good
idea to pass everything for security
reasons through post and then this is
how you access that information it will
be stored in that array so you can see
right there with this regular expression
it's going to be almost impossible it
will be pretty much impossible for them
to put any type of n dangerous
information pretty much all you're
allowing them to enter our letters
periods and quotes and dashes and here
I'm calling the escape data function
that I created earlier in this tutorial
however if they did not pass this
regular expression test set the value to
false and then I could do something like
echo to screen and do this in red and a
valid first name whatever you want to do
there right like that and this is going
to protect your first names and make
sure they're all valid I'm going to show
you how to do a regular expression check
on an email again using the percentage
sign as my delimiter and we're going to
put this carrot in here to define this
as the beginning of the string we're
going to accept capital letters A
through Z lowercase letters A through Z
you can look at this as a return to
double check that you remember how to
use regular expressions we're also going
to accept periods and ashes and I know
that it is common to also put percentage
in here is something you want to accept
but I'm going to block that because it
potentially could cause a lot of harm
then we're going to say we'll accept the
axon follow my uppercase letters
lowercase letters 0 through 9 period -
plus and we have to escape out the
period that's going to come before
more than likely com or.net and we're
going to say we expect them to give us
between 2 to 4 characters here and then
that's going to end right like that so
this is a valid regular expression you
could use to test that they gave you a
valid email address and for Street this
isn't one of the number one fields that
hackers look for to attack we're going
to allow periods we're going to allow a
quote and we're gonna allow a - and
that's it and we're going to say that
this is going to be between 5 to 30
characters in length and then we're
going to close that off as well
city is going to be very similar to this
guy right here except it's going to be
between 2 to 25 characters in length
state I actually did this previously in
another tutorial this would be a
shortcut for looking up states again
caret symbol and then what you would do
is put the letter a capital and then
this is going to match for a K al a R
and a Z which are all valid state names
or abbreviations and then what you would
do is you would continue doing this for
every other potential state abbreviation
see a CEO CT and then put another or
sign in there and I have a link to all
this code in the underbar if you want to
just copy it from there then zip code of
course would also be delimiter caret
symbol number zero through nine five
digits in length all assign another
delimiter and telephone number there's a
delimiter and then you're going to say
okay well they might put a bracket in
there but they might not you remember
from previous that means you put a
question mark in there because you don't
know what's going to be there or not and
then you expect three digits to be
entered you want to be as specific as
humanly possible with this that's the
only way you're going to be able to
protect yourself sure enough the one
thing that you do not protect I
guarantee you will eventually get hacked
and then four digits right like that and
close the delimiter and that's a regular
expression check for telephone number
and the last thing I'm going to do is
show you how to guarantee
that a password entered has wedge least
one capital letter one lower case letter
and one number and is at the very
minimum six characters in length and
that would be backslash a is another way
to define the beginning of a regular
expression A through Z a through Z zero
through nine close that off and here
we're basically saying that this string
of characters which would represent the
password must have it can have any of
these different digits inside of it or
characters what-have-you but one of them
must be a capital letter that is between
A to Z and I went over this previously
another tutorial looks exactly how it
works and then you would continue doing
that on words I can actually copy this
guy right here by the way this is the
same as that and all I need to do is
come in here and change this to a - see
this is saying that we want at least one
of the characters they enter to be a
lowercase letter and here we're saying
we want one of them to be a number and
this way you know that you're going to
get yourself a valid password entered
and no spaces in that we want this to be
at least six in length close that off
dollar sign so right there in this
tutorial I taught you pretty much some
of the most valuable information in
regards to protecting your information
again in upcoming tutorials I'm going to
go into a lot of the other different
things if you have any other questions
or comments leave them in the comment
section below until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>