<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make Android Apps 17 | Coder Coacher - Coaching Coders</title><meta content="How to Make Android Apps 17 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make Android Apps 17</b></h2><h5 class="post__date">2014-12-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1DOeLy26hOE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello internet and welcome to part
17 of my how to make Android apps
tutorial series and today I'm going to
focus in on on save instant State shared
preferences and preference manager and
over the course of the next couple
tutorials I'm going to cover all of the
things that I haven't covered previously
so why don't we jump over and take a
look at of the finished product so
you'll know what you're going to get ok
so you see our little simple application
here and what we're going to be able to
do is come in here and enter any type of
note and this information is going to be
saved and then first off what I'm going
to use is the saved instance state and
you're going to see that if the
orientation changes or if Android forces
has got to close that it's going to stay
there
whatever would be lost if the user would
say go in there and force close the
application but since we're going to be
using something called shared
preferences we're actually going to be
able to keep it even if the user force
closes and you can also see here with a
preference manager and a separate screen
I'm going to be able to change the text
to bold as well as also go in and change
the text size so there are three
different ways for us to interact and
save data let's go and make the app now
okay so you saw the application pretty
simple but this is very important to
understand how all three of these guys
work so what we're going to have here
are five files we're gonna have activity
my just like always we're going to have
a strings file we're going to have my
activity Java we're going to have
preferences XML which is going to show
or define the layout for our preferences
slide we're going to have an arrays
section and we're going to have settings
activity that's also going to handle the
Preferences very first thing I'm going
to do is I'm going to go into activity
my dot XML and specifically into the
design section and I'm just going to
throw a couple little things inside of
here just like you previously saw so I'm
going to get a plain text view and just
drop that in there anywhere I'm going to
come over here and I'm going to give
this the name notes text view and bounce
out of there and then I'm going to put a
multi-line editable text box inside of
here so come over here multi-line text
and let's just drag it and drop it in
here somewhere
there we go and then come over here and
give it the ID of notes edit text good
enough I'm going to jump over into the
text area and define a couple things
let's have our text view that we have
inside of here let's call this in
Oates let's define our text size and
let's make this 20 SP and everything
else here is pretty good then we'll have
our editable text box and if we want to
have it have a certain number of lines
we just come in here and good lines and
let's say I want to have a maximum of
six lines or I want to define that I
want six lines to show if I actually
want to show the maximum lines I can do
that as well and let's just say that I
define both those is six and then let's
say that I also want to come in here and
put a hint so that it'll tell me roughly
you know what we want inside of here so
I'm going to use the hint enter notes
just to keep that simple and then
whenever they click on it it'll go away
that's the way the hints work now I'm
going to throw a little Settings button
inside of here as well just like you saw
previously that let's come back over
here today this guy and let's change
this to match parent go jump back over
into the design section and now we're
going to throw a button in here and
let's just drag it down here so it's out
of the way back inside of this and we
can change the name for this two button
settings and the text for this let's
also set that to settings now of course
we're going to be able to come in here
to the text section and save this to
strings.xml come over here to the little
light ball click on that and let's give
this the resource name of notes textview
good enough and let's do the same thing
for the editable text area and her notes
let's just come in here get this little
light bulb extract string resource and
we can call this notes edit text okay
and then finally for our button with the
settings area here go in and do the same
thing now we got all that out of the way
and the layout is all done another thing
we want to do is let's make this text go
up here a little bit and to do that we
just go gravity and set that for top and
I don't know if you saw that but now
it's over here it's at the top okay so
now we have the design setup now let's
go into my activity dot Java and set
everything else up now the first thing
we're going to do is create references
to our edit text box so that we will be
able to change things in there and let's
just call this notes at a text also
going to need the button because we're
going to be triggering events whenever
the button is clicked on so button
settings and then we're also going to
come in here
and to find this guy which is going to
be a final and this is how we're going
to be able to track what activity calls
for an intent to execute you're going to
see here in a little bit exactly what
that's going to look like so so let me
get that out of the way come down here
in oncreate and let's initialize our
editable text box so notes edit text is
equal to edit text and then of course
find view by ID and then that's our dot
ID dot and then notes at a text that's
why I like to have these have the same
name but it's up to you what you want to
do now as you can see here saved
instance state was passed in and what
this is it's a bundle and all bundle is
is a bunch of key value pairs so there's
going to be a key assigned to a value
that's all that is so if we want to be
able to make sure that data is saved if
the orientation of the device changes or
if the Android operating system decides
to shut down our activity what we're
going to do is we're going to save data
that we want to keep saved in this saved
instance state bundle it's pretty simple
so what we're going to do is first off
before we try to get data for saved
instance state we're going to first
check if there is data inside of it so
we're going to instance state saved
instance state and we're going to check
that it's not equal to null in the
situation in which it is not well then
we know that we have some data here that
we're going to be able to get so I'm
going to get it I'm going to save it in
string called notes and how do we get
data that is stored inside of here is we
call save instance state and then we go
get string because that's what we're
trying to get and it is going to have
the keyword of notes in a second here
you're going to see exactly how you save
stuff inside of this bundle and what I'm
going to do is I'm going to go notes out
of text this guy right here and I'm
gonna set the text to whatever was saved
previously I'm just going to send a
string there and that is all we're going
to need to do now what we need to do is
come down here and actually create on
saved instance state I'm just going to
right click and I'm going to go generate
I'm going to say override methods on
saved instance state is right there and
there it is created now like I said
before this method is going to be called
any time the operating system decides to
kill the
location this does not save you if the
user tries to kill the application we're
going to handle that in a moment but it
does save you if Android tries to kill
the application and also it's going to
protect you if there is an orientation
change now to saves a value to a key all
we're going to do is we're going to go
out state which is passed inside of here
and we're going to say put string we're
going to define a key which is notes
just like you saw a moment ago when I
was using the key to get the data and
then I'm going to go notes edit text
whatever was stored inside of here I'm
going to get that text I'm going to
convert it to a string I'm going to save
it as the value that is assigned to
notes which is the key and that's all I
need to do now I'm able to be protected
if Android shuts down my app or if the
orientation changes but you may ask
yourself well how are we going to save
our data if the user decides to shut
down our application no problem in this
situation we're going to use shared
preferences which are just key value
pairs once again what I'm going to do
here is I'm going to define a method I'm
going to call it save settings right
like this and then I'm going to open up
shared preferences and then specifically
I'm going to call for the editor we're
going to define here exactly how this
data is going to be saved and who's
going to be able to get ahold of it so
I'm going to call this SP editor shared
preferences editor is equal to I'm going
to go get preferences and then I have to
define exactly who is going to have
access to the keys key value pairs and
I'm going to make it private which
basically means my application only and
then whenever I put edit on here this is
going to allow us to enter key valued
pairs right like that now we have mode
private which is most commonly used over
a couple other different ones actually
two of the ones you have mode world
readable and that means anybody is going
to be able to read your data and then we
have mode world writable which means
anybody is going to be able to write to
your data
but you're almost never going to use
those so let's just leave those out for
now now in this situation if I want to
be able to save my notes just like I did
previously I'm just going to call the
editor and I'm going to say that I want
to put a string inside of here with the
key notes and then what I do is I just
come down here and I just go notes edit
text and I get the text just like I did
previously and of course convert it to a
string and that is how easy it is to
save to shared preferences and then
finally after you do that you have to
commit your changes editor and commit
and there we go now specifically how
this is going to be called this method
we just created is if the application is
forced closed by the user now how do we
know whenever the application is forced
closed by the user
well a method is going to be called
which we're going to override so just
come in here again and generate and
override methods and specifically we're
going to look for on stop and there is
on stop right there
and there it is now whenever on stop is
called because the applications been
forced closed we're then going to call
save settings which is the method that
we just created and it's going to save
everything for us pretty easy so now all
we need to do is go up into on create
and whenever the application is reopened
even though that data is saved we want
to go in and get it we want to retrieve
it from shared preferences so to do so
I'm just going to go string and I'm
going to call this SP notes shared
preferences notes and if I want to get
my shared preferences I just go get
preferences again going to define how
I'm going to get this information mode
private get string and then specifically
I say notes is what I want
that is the key go down to the next line
and then if I want to define something
if nothing was retrieved so that I can
check to make sure that if nothing was
retrieved I can do something else let's
just say empty is going to be passed
otherwise and then what I can do is I
can go if not SP notes equals empty well
then I know that I was able to retrieve
something from there and in that
situation I can put the proper text back
into it call the editable text set text
and then put that string inside of there
so that's going to save that data even
though the application was forced closed
by the user and now what we're going to
do is we're going to find that
preferences screen that you saw whenever
the person clicked on
settings and to do that we're going to
go into preferences XML this is pretty
cool
we're going to come in here and we are
first off going to create a check box
preference and just so you know where
all this stuff lives let's come over
here and look at it real quick
preferences XML needs to be in the XML
folder if it isn't in there you need to
create an XML folder and input
preferences XML inside of their course
strings is here just like always arrays
we're going to be creating here in a
second and that is basically everything
else of course all of your other layout
files are going to be in the layout
folder so check box preference and this
is going to allow them to check whether
they want the text to be bold or not so
what we're going to do is define a key
for this and I'm going to give this the
name of preferences text bold and this
is if it's going to be checked it's
going to make all the text bold inside
the editable text box and you can store
tons of things inside of they're also
going to give this a title and that
title is going to be make text bold we
could save that and strings that XML but
now I'm not going to do that for right
now and then you have it a little
summary which basically defines what
it's going to do and I'm just going to
call this makes the note text bold and
we use things like this because they
look like Androids and we want to make
sure that everything looks the same and
then by default we're going to say that
the check box is not going to be checked
now if we want to do a little list
preference first off I'm going to go
into arrays XML and define what's going
to be in my list and you're actually
going to define the entries which is
going to be what shows on the screen as
well as the values so I'm going to
create a string array and I'm going to
give it the name of text size entries
and then for each of the little parts
inside of here we're just going to call
them item and let's say I want to put 16
points
make another item inside of here and
this one's going to be 18 points and
then let's check this up to 20 and let's
take this to 22 and there we go
now we're going to create another string
array inside of here again this is going
to be used inside of preferences XML
this is going to be for our list you can
of course click back to the beginning of
the video and see exactly what it looks
like and I'm going to call this text
size values this is where the actual
value is going to be stored and that's
just going to be this minus the point
part got rid of that file save and
that's all set up now back inside of
here and we're going to define our list
that's going to open up for us and again
we're going to give it a key and in this
situation we call this preference text
size and then I'm going to give it a
title
I'm just going to call it text size
summary pick the text size and then the
entries which is what's going to show up
in the list is going to be in the array
so we're going to array like that and
then this is going to be text size
entries which is this guy right here say
text size entries and this is going to
be text size values it's going to be the
next one you work with and put the
actual values we're going to go and tree
values and again it's going to be array
and then text size values and then if we
want to define a default that we're
going to use for our list preference
let's say it's 16 and close that off and
that's is going to be the layout for the
Preferences folder that opens up when I
click on settings so that's pretty neat
and now we're going to go and create
settings activity dot Java and what this
is going to do is it's going to load up
that layout that you just saw there on
the screen whatever that Settings button
is clicked on feels like I'm repeating
myself now to make this work we're going
to have to extend preference activity
for this guy and then I want this to be
backwards compatible and this way of
doing things has actually been
deprecated but to be backwards
compatible I actually want to use it so
if I want to suppress the deprecation
errors I'm just going to go suppress
warnings like that and I'm going to go
deprecation right like that then it'll
get rid of any weird errors that we have
and then to define the XML file that I
want to use here I'm just going to go
add preferences from resource that guy
and then I'm going to point at the
layout folder or a file that I just
created there we go there it is okay now
that we have all that set up now I can
go back into my activity Java and make
all that stuff work first thing I'm
going to do I'm still inside of oncreate
I'm just going to continue here where I
left off come down here and I'm going to
have to initialize the button so button
settings there it is is equal to course
I have to say it's a button find view by
a ID or dot ID dot button settings
that's initialized then I have to handle
if the button is clicked and basically
what's going to happen if the button is
clicked it's going to create an intent
to open up our settings activity class
which we just created here a second ago
so button settings dot set on click
listener you go new view dot and you can
see I want click listener opens up there
just click on that there it is all on
the screen we're going to say if that
button is clicked on we want to define
our intention to open up that
preferences activity in turn preferences
is what I'll call it equal to new to
find the new intent pass in the context
get application context and then define
exactly what we want to open which is
going to be settings activity which is
the class we're going to open and that
settings activity that's this guy right
here we're going to open this up and
it's going to open the layout up and
everything's going to work so that's
what we're doing there now that we
define that we just need to start our
activity and then we're also going to
want any changes made in that activity
such as making the text bold or changing
the point size of the text to be passed
back so whenever you want stuff to be
passed back after an activity has been
fired you get a start activity and then
we're going to go for result we expect a
result to be passed back then we just
pass in the intent preferences right
like that and then settings info it's
going to also be passed in see settings
info and this is going to be passed in
so that we know what intent actually
fired back to our onactivityresult
method whenever the intent finished
you're going to see here in a second so
we're just going to put settings info
and then we'll know which intent fired
here down here because remember well
after this intent is executed we are
then going to get our whether the text
should be bold or whether it should be a
certain point size pass back and where
that's passed back to we're going to
have to override a method and let's do
protected Loyd on activity result this
is the method called and we're going to
get a request code it's going to be
passed inside of here also going to get
a result code and an intent of the
intent data that we need make a call to
the superclass on activity result and
we're going to pass in the request code
the result code and the data to that guy
and then we're going to check that
settings info was actually passed here
so that we know where this is coming
from and this is normally going to be
used whenever you have numerous
different intents that could be calling
this after they execute so we're going
to say if request code that was passed
is equal to settings info well in that
situation we know which ones coming and
we know what method to call so it's
going to be update note text which is
going to be created next so just come on
down here right after this is done let's
make this private void take note text
nothing's passed to it and this guy's
just going to be responsible for
updating the text changes in the
editable text box that was set in the
Preferences pane so to get that we're
going to go to shared preferences just
call the shared preferences just to keep
it simple and all of your key value
pairs going to be stored inside of this
to get ahold of them you're going to
call the preference manager and then get
default shared preferences and pass this
in there we go let's get rid of this
extra little guy there it is and now
we're going to check if the bold
checkbox was clicked on and how you do
that is go if shared preferences if we
want to get a bowl in which is what that
is it's either on or off
just go get boolean and then
specifically we're going to look for a
preference text bold pass in false and
that of course is going to come from
preferences XML right here we're going
to check if this is true or false or if
it's checked or not back over here and
in this situation it would be set for
true that it was checked so we're going
to go note set of texts and if we want
to change it to bold set typeface null
and then call type
this let's do bold or bold italic just
let it bold it doesn't matter either way
whatever you want to use else if it
isn't checked well then we want to make
it normal
yeah and then just change this to normal
and that's going to allow us to change
it from bold to normal back and forth
with just that little checkbox next
thing we want to check is if they change
the size of the text so we're going to
create a string and we call it text size
STR or string again if you want to in
this situation get a string from that
guy we're going to go to shared
preferences and get string instead of
get boolean like we did before and
specifically we want the preference text
size to be retrieved and once again
that's in preferences XML preference
text size this guy right here and we can
define a default for this as 16 now we
need to convert that string into a float
to exercise flu so that we can use it to
actually change the text size or Sloat
and then let's pass in the text size
string and then to change the text size
for notes
edit text we go set text size and then
put in the float value and then we go
and there you go guys those are three
different ways to save your data inside
of your android application as well as
how to use shared preferences and a
whole bunch of other different things of
course just like always all of the code
is available in a link in the
description underneath the video and
please leave your questions or comments
below otherwise till next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>