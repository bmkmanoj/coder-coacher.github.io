<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Code Refactoring 5 | Coder Coacher - Coaching Coders</title><meta content="Code Refactoring 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Code Refactoring 5</b></h2><h5 class="post__date">2013-01-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NhFmQl1FA5Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello internet and welcome to part
5 of my code refactoring tutorial today
I'm going to do a tutorial that's going
to explain how to replace constructors
with factory methods this is something
you definitely need to know how to do
because you're going to do this a lot
with code refactoring and this tutorial
basically was put together in the last
hour and part of this I'm gonna do
completely out of my head because I
received this challenge which I guess
Emil received from his professor out
there Emil is somebody that watches my
videos I guess and the professor asked
people to create a class called athlete
with subclasses for gold silver and
bronze winners make it so once an
athlete receives a medal no other
athletes can be assigned to that metal
subclass and on top of that the program
isn't allowed to contain conditional
statements of any kind so since this was
something that I wanted to get into
anyway I figured I would go ahead and
solve a meals challenge question so
let's get into it alright so here I am
in Eclipse and the first thing I'm going
to do is I'm going to answer the
challenge question here after I do this
I'm going to show you how to replace
constructors with factories and what I'm
going to do is I'm going to have a class
called customer two and it's going to
have a bunch of other customers that are
going to be rated based off of whether
they are premiere valued or deadbeat
customers meaning how soon they pay
their bills I would guess and I'm
actually going to show you this in two
different ways so this is going to be a
customer rating system and I'm going to
have things at least for now until I
change it and make it a lot more dynamic
I'm going to have the information passed
in regards to what type of customer they
are based off of these final variables
and they are going to have a number
assigned to them I'm going to show you a
much cooler way of doing this very
dynamically here after I do it this
first way and then I'm going to need to
get maguet errs and my setters for a
customer rating so just because I showed
you this before I might as well do it
again your source quick and easy way
inside of Eclipse to create my getters
and the setters and I'm just going to do
it for customer rating and then I want
everything to show up after deadbeat so
it okay
and there we are so now we got all that
set up and for now that is all that I'm
going to do in
side of customer - now I need to come in
here and create all of my subclasses for
all these different types of customers
so class and premier extends customer -
and all these guys are going to do is
have a constructor inside of them
basically just to show you that yes
everything worked so we're going to make
a call to customer rating and assign
this to premier customer so each one of
these customers or subclasses are the
only difference is going to be based off
of the customer rating that's inside of
them of course I trust that you know
that you can add as many different
methods as you want to the subclasses
important part is the factory is going
to create all these then we're going to
have valued just change this to valued
and change this to valued so these are
all my subclasses and all the code is
available on a link underneath the video
and here is my deadbeat and and I
deadbeat I just mean they don't pay
their bills that's all I don't know why
a lot of times I just come up with these
things right out of my head so and now
we need to create our customer factory
the factory design pattern is extremely
simple basically all that we're going to
do here is it is going to create a bunch
of subclasses based off of a message
that is sent of a specific superclass
that's superclass being customer to and
those subclasses being dead be valued
and premiere so I'm going to break the
rules here for a second
in regards to the question that was
passed over to me and I'm actually going
to use a switch statement in a second
I'm going to show you how to avoid the
switch statement and make all of your
code much more dynamic and very often I
write bad code on purpose so that you
see what not to do or if you see
yourself doing something you go oh wait
a minute
I did this and there's a better way and
then of course you can refer to the code
and make it better so I'm going to go
customer type this is going to be passed
one of those integers and then I'm just
going to say in here case and in this
situation this is going to be return new
premier and then I'm basically going to
do exactly the same things for the other
options this is going to be one and this
is going to be zero and this is going to
return a valued object and the
is going to return a deadbeat and then
we could do something like default and
throw an illegal argument exception
which just basically means that they
didn't follow the rules they did not
enter a 0 1 or a 2 customer type and now
what I'm going to do is come up inside
of customer 2 just for the heck of it
and create main inside here just to test
it so what do I need to do well I need
to create my factory that's going to
spit out the right objects based off of
the information that I send so I'm just
going to call it customer factory equal
to new customer factory now that I got
that all created I'm going to go
customer 2 to call this factory and I'm
going to define my good customer and
that is just going to be equal to
calling the customer factory get
customer and then passing it this is
good customer I'm just going to pass it
premiere in this situation right like
that and you're going to see here that
it dynamically went in there created
that so I'm just going to say customer
rating good customer and I can just come
in here and click get customer rating
and then execute it and you're going to
see that it comes back customer rating
is premier customer so there you are
dynamically created a factory that
creates and spits out the right subclass
based off of information being passed
into it what about this whole thing
where we're not allowed to have
conditional statements of any type well
guess what this is a conditional this is
a switch we are not allowed to have that
no problem when it come in here and
delete that then I'm going to surround
everything with a try block and to make
this dynamic I'm going to go return I'm
going to be returning a subclass of
customer two and how I'm going to get
the right one is I'm going to change get
customer into a string so let's change
this to customer name because that seems
to make more sense and then down here
I'm going to call class for name and I'm
going to put customer name inside of
here
say there's customer name and what for
name does for me is it's going to return
a class object that has the same name as
the string that I passed to it and then
once I get that class object I can just
go a new instance and that is going to
create a new instance of that class say
dynamic pretty cool and then
let's say that I wanted to do a catch
illegal argument exception or I could
just type in exception like that
whatever this isn't exactly the
important part and then print out
invalid customer and now I'm going to be
able to create additional subclasses
without any problem at all I just need
to come up here and change this guy
right here get customer it is now going
to pass over premier which is the name
of my class say premier can
automatically create instances based off
of that
so let's file save it and execute it and
you can see customer rating premier
customer comes back to me so pretty cool
however if they would type in deadbeat
just dynamically just by changing this
one thing here I'll save execute you can
see a customer rating deadbeat customer
so there you are dynamically
automatically generating subclasses
using a factory instead of the normal
constructor way of handling it so now
let's get back to solving a meals
problem that he sent me basically what
am I saying here as I read this create a
class called athlete with subclasses for
gold silver and bronze winners okay well
that's kind of generic it's not really a
big deal there then I see here the
program isn't allowed to contain
conditional statements okay well you
know I'm going to solve that now this is
the part that I haven't covered yet make
it so once an athlete receives a medal
no other athletes can be assigned to
that metal subclass well that means to
me singleton that's the singleton
pattern so that's what I'm going to use
to create or solve this challenge if you
haven't seen my factory or singleton
design pattern tutorials I provide links
to them above so now let's just jump in
here and let's start writing some code
so I need to create an athlete class not
a problem and private string athlete
name and I'm going to assign that and
then I'm going to come in here and
create my Gators and my setters generate
Gator Sutter
athlete's name okay there we are got
that all done now since I know I'm going
to use a singleton and all singleton is
going to do is it is going to be a
subclass that is only going to have one
instance and only one instance ever so
how we do that is go public static
athlete get instance and for this guy
since it's never actually going to be
called I'm just going to have it return
null and that
all that I'm going to need to do for
that right now then we need to create
our subclasses like I said before all
this code is available in a link
underneath the video so gold winner
extends athlete then I'm going to create
a private static because these guys are
only ever going to have one instance I
need a way to track whether an instance
of this gold medal winner has ever
occurred before so I'm going to set it
as null in the very beginning then I
need to create a constructor and set it
to private to keep other classes from
being able to create an instance of the
gold winner because remember it said
once a gold winner has been designated
there can no longer be any more gold
winners but I'm going to need to
construct these objects myself so I do
need this constructor inside of here and
for this one I'm just going to set a
fleet name so whatever the athlete name
is there we are and then this guy down
here is what will be called whenever we
need to create our one instance of their
gold winner so a gold winner get
instance and there may be a better way
of doing this I'm just sort of doing it
out of my head because you guys seem to
like when I do this so you can see what
it's like to think through these
problems so now what am I going to do to
guarantee that only one instance has
ever created well I'm going to go if
gold athlete is equal to null that means
an instance of it doesn't exist because
that's this guy right here so that means
it is safe for me to create a instance
of it for the first time remember it's
okay to create one instance but once
someone has been assigned to be the gold
winner they cannot be replaced so hey
this is their challenge it's not mine so
it sounds it all a little bit goofy and
otherwise I'm just going to return gold
athlete whether it is a new one which
means it got here or whether the athlete
was already assigned in that situation
I'll just return the old gold athlete
again so if they say I want to create a
new gold athlete I in essence just say
now you can't do that and whenever they
say will give me the gold athlete I send
them the original that's all I'm doing
and I'm going to be able to copy this
because it's identical for the silver
winner so there's my silver winner and I
just need to change this to silver
winner so over winter silver winner
silver winner and silver winner
and then I need to change this to silver
athlete instead of gold athlete and
there we are and then return my silver
athlete and then guess what I need to do
the same thing for bronze and an bronze
winner is gonna replace silver winner is
gonna replace this one and the only
reason I'm able to do a lot of this
stuff fast is because I've done this so
many times and I know the design
patterns I mean that's a another benefit
of design patterns once you figure out
how to solve something one time you can
just pull that out of your head and do
it again and again and bronze athlete
and bronze athlete and bronze athlete so
there you are
doing pretty much the same thing we did
in the first code that I wrote here and
now I need to create my metal factory so
new class metal Factory and all its
gonna do is spit out the right subclass
based off of the type of subclass that
is asked for and we're gonna do it in
the same way that we did it previously
so get metal and I'm gonna do something
a little bit cooler here though so I'll
get metal type and let's say that the
athlete's name is passed in as well to
my factory then I'm gonna do another try
block just like before but then I'm
gonna need to make a call to a very
specific method now if I was just
creating a constructor from this and I
could just call the constructor that
would be cool
but I'm not allowed to do that I have to
call get instance now it doesn't sound
like that's tricky but it kind of is I'm
going to use reflection in this
situation because I can't think of any
other way like right off the top of my
head how to do this so basically what
I'm going to do is I'm going to need to
make an instance of this method get
instance and I'm going to need to call
it and pass the string is the athlete's
name and then generate all my subclasses
from that point on if anybody out there
can think of a better way I might think
of one 10 minutes after I'm done with
this so if I want to use reflection what
I need to do here is define the type of
parameter that will be passed to the
method that I'm going to create here in
a second and that method is going to be
good instance say so what type of data
am i going to be sending I'm going to be
sending a string so I need to set that
up inside of this and I have a
reflection tutorial if you guys want to
look into this further or just leave a
question below
believe me I use reflection all the time
so feel free to send me questions so I
just need to say okay this is going to
be a string
which is going to be the athlete's name
that's going to be passed inside of that
and that's how that is defined okay so
after I tell it what type of information
is going to be passed I'm going to use
for name again to return the class
object by passing it the string that is
passed to it so I'm going to come in
here and create a method this is how you
do that and I'm going to call this get
instance method because that's what this
is called see get instance method so
that's where it's coming from now to get
this method I need to go class dot for
name and metal type is what I'm going to
put inside of here that's how I'm going
to decide which type of class I'm going
to use and then I want to grab a
specific method out of that class so I
need to go get method and then get
instance is the name of the method that
I'm going to be calling and the
parameter types that I'm going to be
passing to it is this it's going to be a
string there it is so now it knows it's
getting a string alright so now that
that is all setup and this has given me
an error saying that I need to bring in
my reflection library import method Java
language reflection and there it is Java
language reflection so this is another
review of reflection because that's
another thing that seems to confuse
people sometimes okay so now I have that
method I'm able to call it and if I
didn't say it strongly enough get method
what it does is it's going to return the
method that is provided which is get
instance and then the second parameter
inside of here is going to define the
type of parameter that is passed to that
method and get instance and a string
okay so that's all that is well then
what I'm going to need to do is create
an array with the parameter value that
is going to be passed over to the method
get instance and how you do that is
create an object array and I'm just
going to call this params go new object
and I just need to pass in the athletes
name see here I define what type of data
type is going to be it passed and here
I've actually passed the data type so
I'm just going to go new string athlete
name and there we are and now I just
need to pass the parameters to the
method get instance and then return an a
subclass of the type athlete and I'm
done so we can just go
Lee get instance method which is this
guy right here so for those people that
are saying my tutorials haven't been
complicated enough lately there you are
then I'm just going to put an all inside
of there and then inside of this I'm
going to put the athlete's name that's
going to be passed over to that method
and then it's going to give me a return
value which is going to be converted
into an athlete and then it is going to
be returned once it is called so this is
really cool I mean this is a fun little
tutorial and then I can just do catch
exception II then I'm going to jump over
here and just get this thing guess I
deleted it already either way
throw new legal argument this is just
here for exactly the same reason if they
try to create a class that doesn't exist
invalid in this situation it's going to
be athlete type blah blah blah blah blah
I can make that better here soon and let
me just look here for a second because
like I said I'm just kind of doing this
out of my head I want to make sure that
I'm doing everything right I think I
think I think I think I think I got
everything
there's athlete there's gold winner
silver winner bronze letter and metal
Factory
okay so now I'm gonna actually just test
this to see if I did it all right class
test metal factory now I want to call it
that I want it to be testamental winter
that makes a little bit more sense the
one get confused static void main string
args metal factory got to create my
factory just like I did before and then
I'm going to create my athletes and how
I'm gonna do that is go little factory
get metal and then what are we going to
pass in well metal type in this
situation this is going to be gold
winner because that's the name of the
class that I want to call dynamically
and then the athletes name in this
situation I'm going to mark as Dave
Thomas and let's go in here and let's
create all our metal winners and then we
can test to make sure that we are
fulfilling all of our requirements by
trying to create a new metal winner
after we created the first one and see
that it's going to just kick it out so
this is going to be silver winner and
this is going to be bronze winner again
from these classes up here say bronze
winner right there
silver winner say so I'm going to need
to do is create a new subclass anytime I
want to add an additional metal don't
need to touch this code and there's
Ahn's winner and let's just throw some
random names in here about Mack Nick
Donald and the last guy can be David
Edgerton and I'm picking those names for
a funny reason see if you can figure it
out and then let's say that I want to
come in here and print out a new gold
winner I want to try to create a new
gold winner well we're not supposed to
be able to I'm going to put gold winner
new and then inside of here I'm going to
leave this be gold winner just like
before and then here ray kroc is going
to go in there so if I didn't do this in
a special way there should now be a new
gold winner or two gold winners and now
I can go gold winner and gold winner and
you can say get athlete's name is what I
want to shoot out on a screen and then
I'm gonna do the same thing form a
bronze winner I'm a silver winner first
and then bronze winner and my silver
winner aim a bronze winner and let's
file save it execute and it didn't call
the right one so what I need to do in
that situation this is good because I
get questions like this all the time I
want to execute test medal winner I just
click on it and then come down here and
click on run as java application click
and you can see gold winner comes back
as dave thomas and then just like i have
it defined here Mac McDonald again
silver and bronze winner David Edgerton
Oh what happened with poor ray kroc down
here well you might be saying well the
reason why I didn't come up that way is
because here you defied gold winner new
and there it's gold winner right not
really that's here I'm gonna type in
gold winner new I'll say execute it
again and you're gonna see the Dave
Thomas Mac McDonald and David Ed you can
still have their metals so there is a
rundown of some things to think about
you didn't quite catch everything don't
worry about you can either leave a
question or comment below or I'm going
to be covering these topics in future
tutorials so feel free to leave a
question comment or request below
otherwise till next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>