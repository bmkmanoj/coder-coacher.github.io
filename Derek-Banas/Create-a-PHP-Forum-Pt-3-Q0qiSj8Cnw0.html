<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Create a PHP Forum Pt 3 | Coder Coacher - Coaching Coders</title><meta content="Create a PHP Forum Pt 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Derek-Banas/">Derek Banas</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Create a PHP Forum Pt 3</b></h2><h5 class="post__date">2011-03-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Q0qiSj8Cnw0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello internet and welcome to part
3 of my PHP message board tutorial if
you didn't watch part 1 or 2 definitely
watch them otherwise you will be
confused what I got right here is the
registration form for my message board
and we started this in the previous
tutorial part 2 and here we're gonna
finish it whenever this is done people
are gonna be able to come in here and
are all this information everything's
gonna be checked and all the information
is gonna be scrubbed to make sure that
nothing bad is entered in any of these
fields and then everything will be
placed in a MySQL database that we
created in part 1 of this tutorial you
can see here user IDs 1 and there's
username there's an encrypted password
there's email token ID we'll get more
into that a little bit later that's in
regards to cookies and sessions first
name last name and here active is set
for annul well I was actually asked by
somebody how to delete all the
information in a table and set it back
to the way it was before any users
information was entered in what you do
is you actually type in truncate table
users and if you click that in there and
try to show the table nothing shows up
and the user ID is automatically set
back to 1 whenever you enter a new user
and just to show you here the table
still exists as you can see right here
however it's been completely cleaned of
any information and restored to its
original default settings so what I'm
going to do now is jump in and show you
all the code that we're going to need to
finish up our registration script all
right from the last tutorial down here
in the field I have highlighted you can
see that this is a hidden variable and
its name is set for submitted and then
the value is set for true the reason why
we did that you're gonna see here right
now I'm gonna scroll up and go to the
main div inside of this guy and I'm
gonna start writing some code the very
first thing I'm gonna do and this code
is going to be called if the submit
button is hit and what I'm gonna do is
I'm gonna check all of the variables
that were submitted in the post array
and see if submitted has a value of true
remember down here value true that means
they submitted the information so that's
what I'm doing here with this line of
code if they did indeed submit
information I need to verify that it is
good information so what I'm going to do
first off is check that for
name is valid and how I'm gonna check
that it is valid or contains valid
information is with a regular expression
and you want to check that information
entered you call a function called
Prague match and then you put a regular
expression inside of it and if you
haven't seen my regular expression
tutorial definitely check that out I
provide a link to it and what we're
gonna do is we're going to say alright
the information that they entered in the
first name field is going to start off
and that's what the caret stands for the
beginning of this string and it's gonna
contain a - an underscore potentially I
don't know who would put an underscore
but just doing that just to show you
different things that it's gonna have
either lowercase letters or uppercase
letters or a space and it's going to be
a minimum of two characters in length to
a maximum of twenty characters in length
and then it will end it will not allow
anything else that is not defined inside
of here to be used in the first name
field then I'm going to strip out any
potential slashes this is in regards to
something called magic quotes you don't
really need to worry about it what it
basically does is if the string contains
any slashes it's gonna get rid of them
so that's what it does and what trim
does is it gets rid of any white space
and there's first-name and we're gonna
close that off alright so if this does
match we're going to define a new
variable called FN and we're going to
pass all the data contained in this guy
to the function that we created
previously called escape data and it's
going to scrub all of that data to make
sure nothing bad came inside of there
now you don't necessarily have to do it
because the regular expressions gonna
clean up pretty much everything but what
the heck it's always better to err on
the side of caution and then what we're
gonna do if that information was entered
we're gonna set FN first name to false
and we're going to echo out the screen a
message a lot of you are probably
wondering why I'm not using jQuery here
or JavaScript to automatically verify
all this information the reason why is
I'm just basically not going to trust
JavaScript to be able to handle all of
that and make sure that everything is
passed securely because it is very easy
to hack JavaScript you don't believe
that check out my PHP security tutorial
or just trust that that's true
in here
putting in some CSS code which I really
shouldn't do here I should have this in
a separate file but trying to keep
everything unwieldy so just so you know
why I am using font and so forth it's to
keep my code small I want to close that
off and then I'm going to check if a
valid last name was entered and it's
pretty much gonna be exactly the same
just gonna change a couple things here
I'm gonna allow the same type of
information to be entered in here except
I'm gonna take up to 30 in length for
last names and then this is gonna have
to be changed to last name and this is
gonna have to be changed to Ln and this
is gonna be changed to Ln and then this
needs to be changed to last instead of
first and then everything else is
perfectly fun we're gonna allow all this
other information get rid of this as
well all right there you go so now we're
checking to make sure that a valid last
name was entered and I'm gonna continue
because I love the coffee and paste I'm
gonna come in here and verify the email
address so I'm gonna type any amount of
course the regular expression for this
is completely different but a lot of
this is going to be the same I'm gonna
delete that out of there and I'm gonna
say for the email address I'm going to
accept capital letters lowercase letters
0 through 9 and then I'm gonna accept
periods underscores backslash this %
because I use it as a delimiter and then
that's it so I'm gonna accept any of
those characters right there one or more
followed by an @ symbol followed by
uppercase actually you know what I'm
gonna do I'm gonna copy this copy pasted
inside of there so I'm gonna accept all
those same characters and then the plus
sign stands for one or more and then I
have two backslash the dot and then I'm
gonna have uppercase letters lowercase
letters close that off and this is gonna
be for the dot-com net dot whatever I'm
gonna say I want it two to four
characters in length right there and
that's it that's how you verify any
email address and what I got to do it
have to come in here and go email email
change fn2 e and then do it again please
enter a valid email get rid of that and
then everything else afterwards is all
hunky-dory so now I need to verify that
they entered a valid user name and I'm
gonna jump up here to the last name area
and copy that and paste that in you
is his username is valid here we got it
okay so now I got to come in here and
make sure that the username that they
entered is valid and this is gonna be a
little bit fancy here also just to show
you something different this is another
way you can define the bidding beginning
of a string with a backslash uppercase a
and you can also define the end with a
backslash Z so this is to a certain
extent of regular expression tutorial
but you should definitely understand
regular expressions because I can't
totally devote a lot of time to that now
what I want to do here is I'm going to
say to them that I need this to be a
minimum of eight characters in length
actually it should be longer than that
actually I'm gonna change it to twelve
right now I'm gonna say their password
must be twelve in length then I'm gonna
say I want it to contain at least one
uppercase letter at least one lowercase
letter and at least one number and no
spaces okay so that's what the username
is going to be how you do that put the
question mark inside of here and I'm
gonna say that I'm gonna accept username
to have - underscore a through Z
lowercase a through Z uppercase zero
through nine in numbers and then to
enforce the fact that one of these is
going to have to be an uppercase letter
the star represents any number of
characters and then I'm gonna put a
question mark and I'm gonna say in here
a through Z uppercase letters so in
essence what this says is we will accept
any of these characters right here in
your username as long as you have at
least one uppercase letter A through Z
so that's what that says right there so
then what are we gonna do we're also
going to require that they also put a
lowercase letter in there
shouldn't be a problem so I just copied
and pasted that in there and I'm just
gonna change this to a through Z
lowercase letters and then I'm gonna
paste in here again and I'm gonna say
that I want at least one number to be
inside of here so that's super and then
on top of that if I do not want it to
contain any spaces I go back slash
capital S that's what that represents in
regular expressions and then 12
characters minimum and they can make
their username as long as they possibly
could want to so that's how we're going
to come in here and make sure that they
entered a valid valid username so then I
come in here into the post section and I
have to type in user ID which is the
name that I
gave it you can make it whatever you
want and I'm gonna type in UI here and
UI here please enter a valid I'm gonna
type in username or just like that and
then come in here and change that to
user ID so this is going to verify and
make sure that all the right information
was entered inside of there and now I
need to verify that they entered a
proper password and i'm actually gonna
copy this guy this time the username is
password and i'm actually gonna take in
two of their passwords if you can
remember from the previous tutorial if
not here it is c password and confirm
password so that's what that is
so i'm gonna actually get two of these
guys i need to verify both of them so
what am I gonna do
well the password this code the regular
expression I use to verify that
everything's been entered right I'm
gonna leave that exactly the same except
I'm going to come in here and type in
password 1 and then I'm gonna come in
here like password 1 and I'm also gonna
verify that both of the passwords they
entered are equal to each other so I'm
gonna come in here and say if underscore
POS t1
Corps POS T that word - and I'm also
gonna verify that the password they
entered is not equal to their user ID a
lot of people do that believe it or not
it's not equal to user ID then I'm going
to escape out the password change this
to P and then I'm gonna put in here else
if P underscore post-911 to score POS T
and n type in here user ID in that
situation I'm gonna set the password
variable name paid to false and I'm
gonna come in here I'm gonna give them
an error message saying you can't do
that else tab that in there I'm gonna
copy this well I know if they got this
error message and the user ID is not
equal to the password that means the two
passwords are incorrect so I have to set
P to false again your password doesn't
match and all this code is that new
thing tank talk call them for free of
course I'm gonna enclose off this guy
right there all right now we're getting
into the capture area so that's just
good PHP CAPTCHA I normally put a lot
better comments but I'm just trying to
make this quick all right so this is the
captcha code you're gonna be entering is
equal to
one private key that you get from Google
and like I said before it's gonna be
like six blah blah blah blah whatever
yours is I like that and then you're
gonna type in or yes be in the next
tutorial or one very soon afterwards I'm
gonna show you how to create a captcha
system that is not gigantic on your
screen because I did get that request
also private key which is what you just
entered and then you're gonna enter
super var and you're gonna enter exactly
what I have here this is Google's rules
for its caption so just put that inside
of there if at any time I'm typing
something and I'm not going into
descriptions on why it works or why I'm
doing it that means it's just something
you don't really need to worry about you
can just copy and paste it and I
continue on what this is doing is
verifying if the information they
entered into the captcha system is
correct and you would enter it in
exactly as I have here on the screen
then what we got to do is what are we
gonna do whenever this is entered
incorrectly and this is actually me font
color is equal to red this is the error
message I want to show up whatever you
can say as much as you want there and
then this is me again checking that the
capture came back as a positive that
they entered the information properly so
that's me now where I was setting this
and where I was setting this to false
and doing all these things this is where
you're gonna see exactly why I was doing
that I'm gonna verify that every single
one of those came back with a true
result so I'm gonna go in first name and
last name and email address and password
and UI and that's user ID and this guy
that's right here that I'll just copy
and paste since he's just hang in there
okay so I'm just verifying that every
single one of those came back with a
true answer and if it did I'm gonna
create a query for MySQL and if it's an
uppercase letters that means it's a
command if it's not that means there's
not so I'm saying here I want to select
usernames from the table called users
where the username is equal to the value
that they passed that they want to use
for the user name and what I'm doing
here is I'm checking to see if that user
ID is already taken so the result of
this query it's going to be stored and
resolved and you pass all of your
queries to MySQL using MySQL
hurry here I'm gonna put the query that
I just created or if it's already being
used I'm gonna trigger an error that's
gonna print to screen and then I'm gonna
close that off right like that but if
that account is available what I want to
do here is check that it is so what
we're doing is we're checking the result
to make sure that it's equal to 0 that
means that user ID is not currently in
the database that's why it came back 0
or false or whatever you want to think
of it as 0 is equal to false so if the
user ID isn't taken what I want to do is
create an activation code what we're
gonna do is after they type in all this
stuff and register I'm gonna send them
any email that's gonna have a link
inside of it and they're gonna have to
click on it to activate their account so
what I'm gonna do is I'm gonna create a
random number that's gonna be 32 digits
in length and nd5 is just a function
that creates a random string 32
characters in length and unique ID also
creates a random number of 23 digits in
length in R and also creates random
numbers so that's what that guy's gonna
do right there it's gonna create a
random number that's going to be used to
activate the account then I'm gonna
actually gonna have to come in here and
do another query in MySQL and remember
if it's uppercase that means it's a
command MySQL and if it's lower case
that means in this case users is a table
first name last underscore name and here
I'm defining all the variable names
inside of the database so this is what
they're called and then I'm gonna pass a
value to them active it's where I'm
gonna store the verification code and
user name is the last one that I got
inside of there close that off this is
how you pass values in MySQL first name
last name email I'm gonna call the Shah
function what this is gonna do is it's
gonna encrypt the password that they
gave to me before it gets sent live to
my server so I actually never even know
the password I think that's a good idea
what I could get them a new password of
course okay by using MySQL query what
I'm also doing is I'm making sure that
they don't pass more than one query to
be issued so that's another security
sort of thing that I'm going to do here
my SQL we saw this just a second ago
actually it's just copy this and paste
it in except I'm going to change
I'm just gonna say sorry an error
occurred then what I want to do here is
for security reasons again I'm going to
verify that the last query only affected
one row I'm creating one new user
account there's no reason for it to
affect more than one row and if it did
affect more than one R I know I got a
problem now what I'm gonna do is I'm
gonna create variable called body and
this is going to contain the text that
I'm gonna then send to them in email and
then close that off and scroll up now
what I'm gonna do is add on to the body
section here create the link they're
gonna be clicking on to activate their
account and here I'm putting localhost
which you would never do it's gonna be
whatever you call it this is message
board activate and I'm gonna create that
in the next tutorial dot PHP and here
just to keep it simple when I call this
X and then here I'm gonna call my SQL
insert ID and what this does is will
retrieves the value of the last Auto
incremented ID in your last query that
you perform so it's automatically give
you that user ID that you just created
and then we're gonna set y equal to the
random number that we were generated
earlier in this part of the tutorial
then I'm gonna call mail underscore POS
T it's gonna be whatever their email
address was that they entered so this is
where your email is gonna go to and this
is gonna be your subject and then in the
next part you're gonna put body which is
what's gonna show up in the body section
of your email actually I don't need
these quotes from obviously this is from
me go out the screen put a break
statement inside of there then blah blah
blah blah blah and I'm close that off
with an h3 tag right like that
I'm gonna call exit which is gonna exit
the script all together and then I have
to close this off in case an error
occurred and let's just jump up here to
make our lives a little bit easier it's
just coffee this one and this is just
gonna be an error message that pops up
sorry
something broke obviously he wouldn't I
type that in but that's just something
I'm gonna type in here just to move
things along
then we got to close off these other
guys and if you have the code in front
of you I'm sure you see where I'm
closing off these curly braces happy
paste it again and then you're getting
continue to close off the rest of these
curly braces and like I said go get the
code it will save you some time and then
here I'm gonna call my SQL close and
close the whole database and then put
the final curly brace inside of there
and then close off the PHP code so
that's the whole shebang right there
there's a link in the underbar to the
code and just to prove to you that this
whole thing works let's just come in
here and go and I'm not gonna enter in
wrong stuff I'm actually gonna put some
you just have to trust me that the error
message is work and then say it's
working typed into CAPTCHA click done
register everything worked beautifully
isn't that awesome
and then if we jump over here boink you
can say that it created the account so
that's everything for now in the next
part of the tutorial I'm going to create
the activation part of this whole
message board shebang and if you have
any questions or comments leave them in
the comment section below otherwise till
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>