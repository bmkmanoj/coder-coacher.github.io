<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tyler Tallman - Composable Healthcare | Coder Coacher - Coaching Coders</title><meta content="Tyler Tallman - Composable Healthcare - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ClojureTV/">ClojureTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tyler Tallman - Composable Healthcare</b></h2><h5 class="post__date">2015-04-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CIstdJFSSzY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Tyler tulman and I'm going to
talk to you today about composable
healthcare I work a breezy HR and we use
closure and atomic and if you're
interested in what you hear hear feel
free to talk to us about joining our
effort so my agenda today first I'm
going to talk about a health information
problem next I'm going to talk about how
we're under utilizing this new medium we
have and I'm going to talk about how we
can battle complexity in that new medium
and then I'm going to give you a demo
and a progress report of how that's
going for us so the health information
problem first thing you take a step back
health information problem is not can't
be reduced to just relational algebra
patients are sick and hurting and a
crucial part of the health care
experience is empathy this image here is
it's a painting called the doctor from
1891 and I think it captures some of the
compassion and the vulnerability in this
relationship between a doctor and a
patient in some ways this older painting
seems very distant from medicine as we
see it today but we still see we still
have that connection with their doctors
we still trust them to relate what's
wrong with us to us in a way that's
helpful but now there's all these other
things we have x-rays genomic sequencing
science is giving doctors more and more
tools to better analyze this and the
doctors are being overwhelmed by the
amount of information that's being spit
at them through alerts and
recommendations and and changes in the
ways they should treat different
diseases medlineplus says that there's
about a million medical journal articles
indexed in there every year and I have a
hard time grasping just how much that is
so a little quick math if we assume each
of the
articles or ten pages of peace and a
page is roughly a tenth of a millimeter
we end up with if we stack them on top
of each other about a thousand meters in
context we see that with the world's
tallest buildings topping out at about
800 meters and I put in here portland's
wells fargo center at 166 meters it'd
take about six or seven of them to get
as high as these piles of papers that
are produced every year and also if you
compare to Mount Hood it's almost half
of the prominence of Mount Hood as you
can see in the distance there so much
information and it's not just the
information doctors must keep up with a
whole community of people trying to
coordinate care we have doctors nurses
caretakers medical researchers insurance
companies public health agencies and
other parts of the government and the
patient and their family so many lines
of communication is going to make a
pretty complicated space I'm going to
zoom into one part of the healthcare
experience and that's the medical record
it's basically the central repository of
information that a doctor keeps about a
patient now these medical records are
called charts and they have your lab
results your family history or
vaccination record and about any
observation the doctor makes about you
the inside the charts are encounter
notes they look a little bit like this
they and they document the story of what
happened when the doctor sees you in the
in the exam room and you can see here
this is very readable for doctors
handwriting but there's a 37 year old
patient here with a cough and tightness
in the chest and they all follow this
general form of observing what's
subjective what complaints the patient
came with objective things test they did
etc and then they make an assessment of
what they think is wrong and a plan of
how to make the patient better again a
couple years ago most
look like this paper scribbled with you
know the doctors favorite famous pinned
and ship but something's happened in the
past six years if you look at this graph
you can see that back in two thousand
eight there were there's one state that
had over twenty percent usage of
electronic medical record software and
as you go 2011 and into 2014 we see that
every state has over sixty percent usage
of electronic medical record software
now this is the only image of medical
records software that I could get the
they used to use here but you can you
can see the point here it's basically
taking the same things around that paper
chart the complaints and and everything
that the patient described and it's now
it's tight it's legible there's
advantages to billing there's improved
communication you can prescribe and
order labs electronically and it's a big
win for everybody involved in 2009 one
of the main reasons you saw the huge
uptick in EHR usage is the federal
government basically paid each provider
who wanted to adopt electronic health
records eighteen thousand dollars to
gear up their system and there are
thousands of years our products now some
of the vendors have tens of thousands of
employees and many of them are doing
really interesting things right now but
there's one strange thing why did the
government need to give incentives for
people to use health record software
anyway if it was so much better for the
doctors the world didn't need incentives
to adopt iPhones and iPads enterprises
didn't need incentives to to adopt
resource planning software so I think we
should take a closer look at why those
incentives were necessary and maybe
it'll show us other opportunities to
improve so some of my progress report
here is there are many doctors that
report
of the amount of patients they could see
a day when they use electronic health
records drop from 25 to 30 percent
there's more and more information that's
being required as the stages of
Meaningful Use ramp up and it's starting
to jeopardize this human relationship
between the doctrine is patient patience
commonly complain that the doctors
typing more than talking to him and
doctors are feeling like their
secretaries now many people are looking
for big data to solve all these problems
I'm not so sure one other symptom might
we see is there's there's this new job
position that's suddenly spraying into
the world and they're called medical
scribes it's basically someone who
follows the doctor around and their job
is to attend to entering data in the EHR
while the doctor attends to the patient
doctors love it but I think scribes
demonstrate something EHRs are not being
used to make decisions I mean sure they
give you warnings if your drugs conflict
that's that's that's huge and that's
good but eh ours are primarily a log of
what the doctor does I think that's a
shame dr. facade Montes montessori makes
a point that even though most doctors
don't realize is most primary care
physicians that they can be seen as a
CEO in charge of roughly 10 million
dollars in medical spending each doctor
and what those doctors need is a lever
you know as Archimedes said if you give
them a place to stand and a long enough
lever he'll move the world that should
be our our response to this data and so
I want to talk about what it would look
like to use this fulcrum of where the
doctor and the patient are together
making medical decisions so now I'm
going to talk about the new medium this
is heavily inspired by Bret Victor and
even more so the work done by those
original people in Xerox PARC it's funny
how this stuff is so old and new at the
same time in 1968 they basically made a
personal computer ahead of anything they
made the mouse most of the interactions
that you know today were made in that
period of time and we are under
utilizing that medium this I am sure is
not what Doug Engelbart had in mind and
we can kind of see it here I imagine a
picture of a scribe writing on his sheet
of papyrus and we have so much more
potential of how to interact with the
knowledge I have a quote here from from
doug engelbart and he says this is about
augmenting the human intellect and he
says we do not speak of isolated clever
tricks that help in particular
situations but we refer to a way of life
in an integrated domain where hunches
and cut and try and intangibles in the
human feel for a situation can usefully
coexist with powerful concepts
streamlined terminology and notation
sophisticated methods and high power
electronic aids now that's not something
that even programmers would generally
characterized their environments as and
doctors the situation is even worse just
entering text mostly so I want to make
our requirements more stringent for how
we'd use this new medium so I envision a
world where our users the doctors can
touch and shape this knowledge they can
get real-time visible feedback on what
they're doing and they can allow
sandboxes so that each of them can
explore ideas on their own and then
share them back with other doctors if
they work and drop them if they don't
and this brings me to
the title of the talk composable
healthcare and so what's a closure talk
without a definition but compose which
means to put together a construct but
the definition itself is not important
to me as much as the is the connotation
most time when we think of compose we
think of either either functions or or
music and there's this underlying idea
of reaching for some sort of order or
beauty underneath it we see here you
know riches idea of things can be
composed in different ways and and how
they're compose really affects how the
system operates and so I want to take
this and we've talked about composing
functions I want to talk about two
things how can we compose knowledge and
and people so we see that again all of
these people who are involved in the
medical process have things they want to
be done in that medical encounter the
people in the billing want to make sure
the doctor stops using that wrong icd-10
code the medical researchers want to
make sure the doctor will fulfill their
medical protocol the specialist they're
referring to wants to make sure that
they did that lab order that they need
in order to not make the patient wait
now that's a lot of people and when you
have a lot of people a lot of things
it's very easy for things to get tangled
up and so we are going to go back to one
of the most commonly quoted closure
papers well it's not a closure paper but
the closure community quotes this paper
often and it's out of the tar pit x
marks and Mosley and they give us two
categories for complexity one of them is
essential complexity that's that means
it's the essence of the problem this is
the you can't get any you can't get rid
of this an accidental is in the ideal
world all these other things we manage
that we could get rid of and they give
us a determining factor to really see
which category it falls in and really
the question is does the user care about
this does it use
see this in his informal specification
and that's where you start to see things
like whether I use micro services or not
or an atom vs a ref or whether it's
concurrent or sequential the user in the
end most of the time doesn't care and he
goes on to explain different categories
for this complexity we all know state
one of the ones I want to talk more
about as control and control is
basically the order in which things are
done they make a very strong statement
that control should be eliminated in
their ideal world and that state should
be the input data the user enters and
everything else should be derived from
logic and I want to see how close we can
get to that using closure and closure
scripted atomic so they introduce
functional relational programming the
the other frp and basically there's
essential state which are a set of
relations it's what's in the database
and in our case it's going to be a day
Tomic database and then there's the
essential logic and that's these
relational algebra extended with pure
functions that you can use to derive any
of the other information that you'll
need so our central state imagine each
of these boxes are an entity this is a
medical condition and it has an
identifier it has a subject which is a
patient at points to and imagine a large
graph of all of these entities and their
attributes in a database and the concept
would be this would be our essential
state and we would be able to annotate
any other attributes on here based on
the results of query this is similar to
a materialized view if you you know use
post grass you can make a whole new
table based on a query and so it's
similar expression is that so here's an
example of in our system what it looks
like to make this logic to drive new
data so we allow the user to
build up this statement of when there's
an encounter and that has a condition
which has the code these are each
attributes that you would see in the
page before I've streptococcal sore
throat then it's going to add this new
attribute which is suggest to the side
and is going to suggest a history of
present illness which is a section of
the encounter which has a condition of
complains of cough and the fact that
it's certainty is known absent so with
this with this system you can build up
these suggestions from any part to any
part now this data is this schema uses
something called fire it's the fast
healthcare interoperability resources
it's this new restful extendable data
described API that hl7 is doing if any
of you have been in healthcare it is way
better than what we're used to with hl7
version 2 and hl7 version 3 and it gives
us all that we read this directly in to
generate day Tomic schema and so anytime
the schema changes we can generate a new
a new scheme and atomic and here's
examples of other rules so if you have
an encounter that has streptococcal
infectious disease then you can suggest
a prescription that contains a certain
ingredient and I'll demonstrate later
what it looks like to use this in
production now because this state this
logic is not just a function we can
derive it in many different ways we can
take this data that describes this logic
and we can generate the atomic queries
we can generate a function that will
return this result and we can use a
service that we have that's a rule
engine to derive this state and keep it
up to date with changes in the database
and our architecture looks like this
basically we have a set of clients they
connect to servers just like
like anything else and they asked for a
resource and they can subscribe to it
now anytime there's a transaction you
can see that arrow would be followed the
transaction goes to day Tomic the atomic
state changes it follows the arrow back
to the servers and will update any any
other client that had a subscription to
that resource and the information also
goes to the rule engine where it updates
any derived state that needs to be
derived which also goes to the server
basically this gives us the opportunity
to do use something we call storefront
now storefront gives us basically an API
that's like day Tomic in our browser so
we will use something similar to day
Tomic cinta tapi and it will in the
background record every I look up you've
done and it will request every one of
those data that you looked at and
subscribe to it it's very similar to
what Facebook's flux and Netflix Falkor
is doing it lets it lets us it lets the
client not be a full peer of the day
Tomic database but only take down the
parts that it needs and it allows us to
update in real time by default as we you
know just use the regular map interface
everything's subscribed and it will re
update the react component every time a
change comes from the server we have on
cursors for basically doing an
optimistic commit it's not the best idea
but you can basically do on like I'm
transact and change the data structures
and it'll get serialized into a day
Tomic transaction and get verified that
it's valid on the server and you'll see
the results already optimistically
before the commit comes back from the
server but what's most important about
this is as the user you no longer are
controlling when
is loaded you no longer have to
explicitly set up what is what is the
shape of this atom that I'm dealing with
at the base of my application and so I'm
going to show you a little bit code of
what it looks like so we're going to
talk about a prescription section like
this is a section of a medical encounter
where were there's prescriptions and you
can see we're just doing the standard
API of gits at the top here of the
prescription section component is this
is quiescent by the way we get the
current database and we pull the
encounter out by doing a look-up on the
ID the same you know the same day Tomic
interface and then we just pull
everything out from there from maps and
this is a current database that will be
continually updated as information from
the server comes in now there are some
caveats to this so what happens as you
pull the data well the first time you
pull it it's not going to be there on
your client and so that's going to end
up it'll go through another react render
frame until everything is there and so
there's a trade-off of whether you can
plan up front to get all this data here
or just have like a rebel like
experience where it gradually builds up
the page as it's doing it but you'll see
it's pretty fast even in that case so on
this page we hear zoomed into the same
component and we used one more method
here which is storefront and sure and
what it sure is it's a analog 2day
Tomic's pull api and when you run this
it will only return true when all the
data from that has been loaded so you
can make a you know a loading space and
you can have them make sure everything
from what you're going to render is
there before before it renders the rest
of it so I'm going to skip over this and
go straight to the demo for times sake
but I'm going to demo an encounter
where we talk about streptococcal
Pharaoh so we're going to find the
patient John Doe is probably the one I'm
after he has a lot of encounters here
we're just going to create a new one so
now he has an empty encounter and let's
say he came in with a complaint of sore
throat okay right so i can get over here
alright so we will get John Doe will
load a patient John Doe lots of
encounters create a new one for him and
we are going to add a complaint for John
Doe and we're going to say he has a sore
throat we see pain in the throat and we
entered this here now before if you
remember one of those rules was to
suggest a diagnosis from sore throat and
in this case one of the possibilities
when you have a sore throat is that it
would be streptococcal sore throat it
could be strep sore throat so I'm going
to take that suggestion and you'll
notice that when i take that suggestion
more suggestions come in every other
section of the encounter and this is the
interaction on one now so he could just
have tried that that selection of the
diagnosis and maybe he's like I want to
say something more general i want to say
that's a streptococcal infectious
disease it's not about a sore throat and
so we can select that and remove the
other one and everything will be and
will be in the place it should be now
it's not just we have multiple levels
for these suggestions and the idea
generally is the person who makes these
UI widgets could support any kind of
data they want to expose for the users
any derived data the user wanted to make
they could expose in this case we have
side suggestions for prescriptions and
we'll we'll just do a amoxicillin
now amoxicillin it's going to suggest
that several dose categories and we're
going to choose just infectious
infection mild to moderate didn't
suggest anything here because in order
to suggest an appropriate prescription
we need to wait for the patient and
we're going to enter 32 pounds or 32
kilograms and now if we go back to this
context we see that we have
prescriptions that the rules had made
that are pre-made to fit numbers that
are easily measurable by by a parent of
this child or by the patient and a lot
of systems would just in this context
they'd have some very long decimal
number for you to round off but they're
carefully set up there's often
instructions in these suggestions and
you need but select and you have it
there and ready to send if you wanted to
now another part of the story I'm going
to let's see say I go back to
streptococcal sore throat he changes in
mind you see the mostest informations
here streptococcal sore throat if we go
back to the complaint section is back
filling more complaints that are
pertinent to streptococcus or throat so
the doctor rather than having to type
each of these in is able to primarily
touch what he's after and so just
restless sleep irritability and we can
go here and we can say you know he
changed our mind that there's no that
there's no pain in throat anyways we
build up this data and I wanted to show
you one more example where we can see
that we're going to do billing and it so
happened that our biller wanted to make
sure that this physician was billing the
right E&amp;amp;M code and so she made a set of
rules for him that's going to help him
more easily find the right code and so
this patients already been seen so the
rule is seen that the doctor has more in
honors and so it's not a new patient
visit of an established patient visit
and once you have that it will suggest
the diagnosis on the encounter to add to
them and if you open this up it suggests
a set of refinements to be more specific
about what kind of visit it is and you
can see clearly maybe this was a 10
minute visit and it shows the doctor in
line how what the fee for the service
would be so that's a demonstration of
the kind of kind of interface where
we're after for the doctors but the
thing is doctors could ask for anything
pretty easily in the system and they can
make the rules themselves so I'm going
to take you to I'm going to take you to
where the rules are made at least one of
the areas and I'm going to search for
demo because we have a strep demo here
and the rules that target the encounter
and here we see more of the same that I
showed you in the screenshots here
there's an encounter that has conditions
that I have strep throat and then a lot
of things that happen so here's
different complaints let's find one
little more interesting here we go and
so this is this is one that is
suggesting that the strep test and so
it's suggesting a procedure alright this
is a condition rather and it's looking
to see if a strep test has a diagnostic
report and an observation of whether the
strep is positive or negative now each
of these things basically you can you're
able to click and edit them so I I
clicked on this I could choose a
different kind of test or I could maybe
I care about I don't care about strep I
care about cough and I can search for
these different concepts if I have time
I'll go back and show you a little bit
of about the unified medical language
system which which enables this so
anyway that and you can click on for
instance this these are conditionals
here it means all of these things but
oh it have to be true for the for the
consequence to happen and if you click
in any of these contexts you end up with
all the attributes that are valid so we
said here we're basically building up
queries and these queries drive data and
so you're able to since the schema of
these things is fixed you're able to
discover the schema and build up these
queries is very important a doctor is
not interested in remembering this name
and typing it in so it allows them to
discover the shape of this data as he's
using it so another thing we do because
that is not always the best answer oops
I've an alert box on the other page
another thing we do is we do what's
called prototypical rules this is where
we have the doctor go ahead and do what
would the ideal what would the ideal
encounter be like for someone who had
let's say a common cold and so it's
probably upper respiratory infection and
so the doctors went through here and
he's made his ideal encounter for what
you'd need to know with an upper
respiratory infection and then we take
these and generate rules from the data
in the encounter and the idea is to have
a feedback loop back and forth where we
collect knowledge from one these ideal
cases the doctor uses it to their actual
use cases like whenever they search for
something in that search box it means we
failed to suggest the right thing and so
we take that as an opportunity to
improve our system and hopefully give
them more time to look in the patient's
eyes and you can see there's many things
so you made a lot of prescriptions here
okay so next we're going to go back back
to the presentation hopefully
so here's our progress report because of
storefront we're able to keep our server
side code extremely code base extremely
small our entire back end is four
thousand lines of code and a lot of that
is still mostly dealing with interop
with other health systems that use soap
and all kinds of all kinds of stuff like
that our front-end code base is 20,000
lines which is more than we would want
but I think as we as we transition into
some better use of react will be able to
make that smaller while adding while
adding more functionality we've given
the doctor a basic ability to be able to
edit this knowledge and to play with it
in to make a environment where he can
explore these ideas and ways to optimize
his experience and we're just starting
on the collaboration aspect so those
rules you saw made there everything is
content addressable which means that if
you create the same rule in any context
the lease they're going to be hashed to
the same value so if doctors
accidentally make the same rule it truly
is the same rule and this allows us to
watch over time as these as this logic
grows and see likely a doctor when you
when you start out just talking about
what we talked about before whether they
have strip well likely if you just did
looked at the condition later on he's
going to go and extend that rule to look
at whether there was a procedure that
had a result of a positive strep test as
well and so hopefully we should end up
an environment where we can continually
grow this base and share across these
users and the idea is similar Joe
Armstrong from Berlin is talked about
this like what's the idea how could we
should have this global database of
functions like to get out of that file
abstraction and really share logic or
code with less boundaries yeah I explain
the closed loop learning are there any
questions
well we we tried to open store
storefront and time for the for the talk
but failed so we'll see if we can get
around to it will try to make that
happen yes nope so yeah I skipped over
this section because I thought I was
going to be short on time but there's a
unified medical language system which is
that this is the terminology base side
so a concept is basically an idea and
each concept has many ideas so their
strep store throw there's many different
words for it but the the interesting
thing here is there's 12 million
relations these concepts as well so when
I when I entered strep sore throat our
streptococcal infection there and the
the choice of amoxicillin was selected
there none of us entered that we pulled
that directly from umls it has a it has
a set of suggestions of things that may
treat different disorders and so it's
it's a hybrid we're pulling what we can
and adding what we can yeah just just to
zoom in here we have this is kind of
what it looks like there's a hierarchy
of thing so streptococcal sore throat is
a streptococcal infection which is a
gret which is the disease due to Grandpa
positive caucus like so we what we're
seeing here is everything that's true
about streptococcal sore throat should
generally be true of a streptococcal
infections so the rules can target
something higher in this ontology and it
apply to things below it of course you
don't always want it to do that because
taxonomy czar a challenge sometimes but
and you can see here if I click on
streptococcal infection these are all
the different kinds of streptococcal and
affections that there are and there's
huge amounts and so this it's really a
great tool to leverage for us and but
any other questions so the answer is
we're trying like I said so the rules
themselves are content addressable and
we get up to these roots that are like
references and we call them rule sets
and so these rule sets can basically be
forked none of this is really exposed to
our UI right now but we're trying to get
it to a point where basically you can
fork the way someone practices make your
changes and we can dip them and you know
like it I mean it's a classic get get
problem so any other questions
well we took a different approach like
our our goal is to tell them what they
already now like we are not telling them
how to practice medicine we are trying
to optimize how they enter the
information so yeah that was that was
something something we're thinking about
a lot in the beginning but our goal is
to increase their speed of information
entry and give them options maybe they
wouldn't have seen but it's still a very
dr. driven process well it needs to be
encrypted at rest is one of the is one
of the big ones code wise so storefront
is a challenge to secure so that's
something that's an active problem for
us that you know is one of the issues it
didn't get open sourced so as you like
like I said we were using arm cursors to
build up these transactions and you have
a bunch of AD and retracts it's hard to
know if that fits your security model so
we have some techniques to do it they're
good but we we have something better
coming up the pipeline but just checking
security models with something as raw as
day tarmacadam retracts is a challenge
well any other questions thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>