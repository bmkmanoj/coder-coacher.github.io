<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lighting Talk - SVG in Custom PDF Templates  - Daniel Glauser | Coder Coacher - Coaching Coders</title><meta content="Lighting Talk - SVG in Custom PDF Templates  - Daniel Glauser - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ClojureTV/">ClojureTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lighting Talk - SVG in Custom PDF Templates  - Daniel Glauser</b></h2><h5 class="post__date">2017-10-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/X6rxaDtZMPg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right hi I'm Daniel Glaser and I'll
be talking about SVG is in PDFs but in
the end I'm trying to show you a
technique for delivering fancy reports
fancy a PDF based reports in your
application so the project I'd like to
talk to you about uses deep learning on
the etherium network to measure the rate
of article a shal melt just kidding
we we're working on business systems
specifically we're working on financial
base business systems and the project
I'd really like to introduce you to is
called Errol eyes is a financial
modeling system focused on aircraft
valuation and trading of commercial
aircraft and for that system we we think
we made some nice-looking charts and
we're proud of that work on the web and
so a great client of ours came to us and
said can you take this nice work that
you've done and give me a custom PDF
report with all the aircraft information
in there thought yeah no problem that
should be easy it's a great library
called PDF boxing I can stick a map in
there it'll transform put things in the
PDF form done no problem then he said
what about the charts and that's when
things got a little interesting so how
do we get the charts into the so he
asked us to get the charts into the into
the reports and so we did and that's the
end of my talk thanks
you're probably wondering how we did it
so let's talk about the code we're using
reagent reframe somewhat common pieces
in the front end and we're using a
library called high charts pie charts in
their documentation they talked about
all these different ways you can ship
code up to a server or a hosted server
solution and it kind of looks like it
might do this job but it did not work
for us it was just a different use case
and
we were trying to solve we want to
control over that raw chart data and not
a packaged high chart solution so
luckily we could extract the raw SVG
from there we stick it in a multi-part
form upload and using some built-in
stuff with reframe we post it up to the
server then once you're on the server we
used the patches bot ik a wrapper around
Apaches bot ik library to take that SVG
and render in the temp directory to PNG
s we had to play a bit with quality and
scale I was surprised at how much we had
to scale this up to get non fuzzy charts
so that's a little pro tip right there
then from there I actually tore this
function out of PDF boxing because it
almost did what I wanted but didn't
quite and haven't had a chance to submit
a PR into into that library to help but
I swear I will like right after the
concert but what this does is it allows
you to take a map of this in this case
the aircraft data and match the keys up
with names of your fiat form fields in
the PDF and replace those values it's
really easy and nice to use and I've
used it on other projects as well what
it wasn't doing was flattening the PDF
afterwards so that's this piece right
there and if you don't flatten it it is
still a form with replaceable fields so
someone could edit it and no one here
likes mutable data do that all right
good I'm in the right place so are we
done no we're not done how do you get
the report back into the browser the
person wants to see it they want to
interact with it I originally initially
tried why don't I return the raw data as
PDF from my HTTP call and that did not
work out so well because it was really
hard to figure out how to actually
render that into the page but most
browsers have a PDF handling type
plug-in built in Chrome definitely does
and I think I haven't fully surveyed the
landscape but I suspect across most OS
and stuff you're in pretty good shape if
you just let the browser render the PDF
so we stuck it up on s3 in a private
bucket and generated a temporary
pre-signed URL that would expire after a
certain amount of time and we returned
that URL in our HTTP call back to the
browser once we're back in the browser
world we put it in an iframe and voila
you have a PDF report whole process
takes about 6 seconds which competing
software takes on orders of minutes have
to do certain types to do similar types
of report building so we think we are
well ahead of the game there and there's
probably some room to optimize it but
we're right now happy with that level of
performance and that's what I have for
you so beat my six minutes Daniel Glaser
cambium consulting come talk to me if
you want to learn more about PDF fun
thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>