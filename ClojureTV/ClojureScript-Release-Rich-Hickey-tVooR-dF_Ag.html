<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ClojureScript Release - Rich Hickey | Coder Coacher - Coaching Coders</title><meta content="ClojureScript Release - Rich Hickey - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ClojureTV/">ClojureTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ClojureScript Release - Rich Hickey</b></h2><h5 class="post__date">2012-12-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tVooR-dF_Ag" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">and then we got final you caught through
it just right sighs it's the power of an
actor's voice that I can command a room
then
boy
all right well everyone's quiet so we
might as well start hi everybody thanks
for coming my name is Stuart Sierra if
you don't know me Erica Thorson who
organizes this group couldn't be here
tonight but we have rich Hickey which is
just as good
so we also thank you to Google where's
Andre thank you for hosting us in this
space and giving us lots of awesome
bandwidth that is letting us do a
livestream of this event for the first
time ever how many people are watching
we've got seven hundred and seventy five
people watching the stream my biggest
audience try to post a recording
sometime later before we start any
general sort of user group type
announcements people looking to hire
closure people I just going to say if
you can't get enough closer talks and
Stewart will left lowest voice he's
going to be giving a talk on closure and
the expression problem and listen
yeah so listen morgue yeah that's right
if you didn't hear
that's I'm doing a talk on closure here
at Lisp NYC and if it'll be in this room
the upon longest night will be here will
be a co-ed neato right okay yeah the
other announcements I'm supposed to
remind you we're always looking for
speakers for both closure NYC and list
NYC so if anybody's interested in one of
those send a message to Eric or Brian
closure code talking like that I'll get
to that in chronological order so in
next week Erin bedre and I will be at
OSCON doing closure talks then on
September 18th will be teaching closure
workshops at Strange Loop and then two
days later on the 20th rich will be
giving the keynote at Strange Loop in
safe mode yes it was and then of course
closure cons is November 10th 4:12 get
your tickets now still a nearly heard
rate and you can also if you're
interested sign up for training for 3
days prior to the conference and I think
so unless there are any other
announcements or things that people want
to bring up I will turn it over to rich
with something new thank you so thanks
everybody for coming I want to talk
about something that's a lot of fun
today I hope everyone will find it
interesting and useful as to is closure
and I imagine everybody here being
closure users has a favorable impression
of closure but there may be some new
people but closure users tend to think
it's a it's a good thing
what about JavaScript
what's JavaScript's number one feature
javascript is everywhere yeah so these
these are two interesting facts and what
I want to talk about today
is something we're calling closure
scripts which as you might imagine this
closure that runs on JavaScript so why
would we why would we do this why why do
we need something like this well it's
certainly the case that not only does
javascript have a lot of reach
javascript has exclusivity in several
places in particular on the browser
there's no other programmable technology
on the browser and JavaScript is the
most portable technology in a bunch of
other places particularly mobile I see
what an affordable mobile application
javascript is is the key way to do that
however even as proponents would admit
that JavaScript itself is not
particularly robust in several areas and
while it's possible to write robust
JavaScript programs doing that well
false to the user a lot of discipline is
required
at the same time while we have we have
this pervasive JavaScript that's not so
robust we're having increasing
requirements placed upon applications
right we want more sophisticated
locations on the phone more
sophisticated applications in the
browser in particular things that are
true applications moving away from the
HTTP paradigm of hypertext and page
driven applications to resident
applications that sit in the browser on
an enduring basis update the screen talk
to services not page oriented at all
anymore and people want those
applications to do what desktop
applications used to do which puts a lot
of pressure on the applications and in
turn on JavaScript itself so there the
rationale behind this is pretty simple I
think and I think closure users would
find that many other people might find
that closure is is is just a simpler and
more powerful and more robust tool than
JavaScript and when you couple that with
the fact that the JavaScript VMs are
getting higher performance
implementations every day and it's
essentially an arms race going on in
JavaScript VM the opportunity presents
itself to take closure and have it run
on these VMs because they're strong
enough and fast enough to run closure so
by doing that we will empower developers
to
right through sophisticated applications
with a higher degree of robustness and
more power
so the strategy overall is a pretty
simple one and one that's taken by other
languages as well targeting JavaScript
we will compile we do compile closure a
substantial subset of closure and we'll
talk about the details of what's there
and what's not later to javascript
source in addition one of the strategic
goals of closure scripting calebrage
some of the best debride approaches to
doing JavaScript application development
and they involve tools that are google
has developed the other thing we want to
do is make sure we aren't targeting just
the browser right we said javascript has
all this reach certainly the exclusivity
lies in the browser area but being used
elsewhere the availability of the v8
engine from Google and its use and
things like node presents the
opportunity to run JavaScript and a
bunch of other environments people are
embedding JavaScript in databases as a
bunch of places where JavaScript is the
extension language we want to reach all
of these things it's not a browser
specific play
there are some things that we're not
trying to do we're not going to try to
do one is to completely implement every
single feature of closure there are some
that just don't make sense there are
some that have been the more modern
features of closure replace some of the
older features so we probably won't do
some of those another non objective is
to make large applications portable just
like closure reaches both the JVM and
the CLR the intent there was never to
have you write this large program on the
JVM and take the large program and run
on the CLR that's not the point of
closure being on these different
platforms the point of closure being
lines different platforms is you need to
target the JVM or you need to target the
CLR or you need to target now JavaScript
what do you do well you want to bring a
certain skill set to bear and if you
have a skill set in closure you can
bring it to bear in all three places in
fact there aren't many languages that
can target all three places in addition
you can have substantial libraries that
you can bring to bear in all three
places particularly libraries that
involve algorithms on the other hand
you're not going to try to make a UI
work in all three places or a database
code work on all three places and this
their dart there isn't actually need for
that that's a theoretical feature that
nobody needs so that's not an objective
for us
another non-objective is that this is
not about getting closer to run in the
browser so people can try closure and
try a repple in the browser it's not a
demo tool or anything like that so it
ends up as most large lists that Lisp
applications realize you know Lisp is
always had email but eval has always
been something that you didn't really
use very often in production you know if
you're worried you sort of we're not
getting it and particularly when you
have a compiled list like closure and so
the same thing is true here so we're not
trying to replicate the development
capabilities of closure on the
JavaScript platform and you'll see how
that breaks down when we look at the
particular features so the target here
is production applications we're trying
to make a version of closure you can use
to write applications that run every bit
as well as something you would write by
hand in JavaScript but with a lot more
concision with the power of macros and
bunch of other closure facilities
a toy kind of thing so that's the
strategy we're taking there's a couple
of tactics we're going to use to do it
one tactic is that closure script is
going to be and is written in closure
and itself only no JavaScript the other
is a closer script is delivered within
on Google's closure toolset and there
are a lot of very significant advantages
we get from doing this so these are the
two tactical approaches we take to this
to this effort so what are we talking
about when we talk about closure script
in closure script the compiler itself is
written in closure when you write macros
for closure script you write them in
closure the compile time environment is
a closure environment and they will then
in turn compiles to JavaScript and
that's where the libraries run the
libraries for closure scripts are
written in closure script all the way
down if there is no equivalent if you're
if you're familiar with the closure
implementation there's a substrate
that's written in Java which consists of
a bunch of the core data structures like
the sequences and the
maps and vectors and sets and then the
compiler you know glj is a more core
topsail J now is sort of a bootstrap
file that sort of defines the rest of
the language in itself but this is Java
layer we're not replacing that Java
layer with the JavaScript layer closure
script is written completely the
libraries are in completely enclosure
script including the data structures and
we get that as you'll see in a second
because we have def type and protocols
at the bottom so there's no JavaScript
source files for closure scripts so
we've talked about closure enclosure
many times and this is the first
implementation of closure enclosure
happens to have a different back
back-end target but this is sort of you
know a lot of the design work but
underneath data types and protocols was
based around what would you need if you
want to my closure in itself this is the
proof of that because closure script is
written in itself in terms of protocols
and def type so all of the abstractions
that were interfaces on the Java side
for closure are protocols and closure
scripts which is what you really want
it's quite a beautiful thing we'll look
a little bit at the code but it's it's a
lot of fun and all the data structures
the closure data structures maps and
vectors and sets are written in terms of
death type so again
we have a lot of power right out of the
gate in the in the core clj file when
we're booting up we have enough power to
define the fundamental data structures
of the language in itself and it ends up
that the mapping to JavaScript for these
core features depth typing protocols is
very good it's very straightforward it's
not awkward it's not got a lot of layers
what you end up with our ordinary
JavaScript types and ordinary jobs for
functions this beautiful thing from a
development time standpoint of course
closure is the list and we expect to
have an interactive development
environment we have one for closure
scripts there's a repple the repple is
written in closure so you start up in
closure and you start a javis at the
closure script repple inside or from the
closure repple I'll show you that in
later currently we leverage Rhino which
ships with Java 6 and higher or was it
in there at 6 yes 6
so there's embedded JavaScript in Java
available so we target that we compiled
to JavaScript on the fly send it to
Rhino for evaluation and it just feels
like a closure repple it's a beautiful
thing except for the performance of
Rhino but it's a growth area we have to
potentially replace the Rhino engine
with v8 running in Java which people
have done
so we could do that now a couple of
meetings ago here I gave a little micro
talk on Google closure and if you were
here I'm sorry you're gonna hear it
again so unfortunately we have two
things named closure in the world
although closure was released first my
friends called Google closer closer
but I'll call it Google closure or maybe
G closure google has released an
interesting set of tools for JavaScript
development called collectively closure
with an S and I'm going to talk about
only two parts of that one is a compiler
and the other is the library
these are production tools that Google
uses every day on their biggest
properties on their biggest applications
for their real meat potatoes work the
closure compiler is a compiler from
JavaScript to JavaScript we'll talk a
little bit about why you might want to
do that and what it can do for you and
the library is a large JavaScript
library this is the stuff they actually
use in all of these apps Google Plus is
the hot new thing and some of the leads
have mentioned the fact that it's built
on
the closure library
when I look at these tools I think of
them as absolutely things that most
companies would consider to be
competitive advantage kind of tools so
why has Google given them away
there's many possible reasons you see
companies give away technologies and I
think most of them don't apply here I
think Google sincerely is motivated by
having better richer more powerful web
applications be developed and I've given
away their best tools for doing it
they're not throwing something over the
wall this is not something that they've
abandoned they actively developed
they're not trying to dump it on the
community for a maintenance job they
have another motivation or several other
motivations but fundamentally they want
the web to win and and that's part of
the story foreclosure script it's for
developing applications on the
JavaScript platform and that's what
these tools are for
so let's dig into the tools the compiler
the closure compiler Google's closure
compiler is an optimizing compiler in
the traditional sense it is not merely a
mini fire it does things I look back
minification right it does whitespace
removal it can do within function name
shortening and things like that but the
key feature of the closure compiler is
that it is capable of whole program
optimization in something they call it
dance mode there's a link here you can
try it I'll talk a little bit more about
about this
so they they threw these things out into
the public a while back and people
looked at the compiler and the libraries
they looked at compiler and they said oh
this looks like another minute fire and
you can use it that way so they pointed
it at their stuff and instead of looking
at minify and it's you know as a minnow
fire it's five percent you know plus or
minus from the stuff you're already
using per minute it does do that it does
symbol replacement and it does it just
about as well as anything else but to
think about it as a mid afire is is
really to miss the point as an
optimizing compiler in particular as it
optimizing compiler to which you're
going to submit your entire program it's
able to do whole program optimizations
able to say I see you wrote this
function but you never call it so I can
get rid of it that's a lot more getting
rid of potentially then turning you know
foo into F and that's what it does so it
does dead code elimination in the large
it really does unco called uncalled code
elimination for your whole program and
the results are dramatically smaller
that minification can do
why would you care about something like
this I mean what why do you care right
everybody minifides the libraries you
look at these libraries like well this
is still this pretty tiny this got down
to em 15k and 40k 30k
the reason is that as you're looking to
make more sophisticated applications
you're going to need both larger
libraries and more libraries that your
disposal but think about your average
application right it does some UI it
does some data interaction it may talk
over communications channels right it
may have some data structure
manipulation it may use a little bit of
a bunch of different libraries but it
will rarely use all of them and as you
bring more or larger libraries into play
and they're only minified your footprint
is still the sum of the minified sizes
and you can't get around that so you
can't really fix that but whole
programming optimization can however to
do this well requires a lot of
discipline in other words the other
experience people had so people looked
at the compiler and said oh this is the
cement of fire right and the whole
program optimization kicks in in a mode
called Advanced Mode so people flip
advanced mode on they're like ooh cool
this must be better than minification
I'll turn it on and everybody found that
their programs couldn't make it through
Advanced Mode Advanced Mode said I can't
deal with this and so they said Advanced
Mode doesn't work why would Google make
this sophisticated optimizing compiler
within Advanced Mode that doesn't work
of course it works it doesn't work on
your code because your code wasn't
written to the set of conventions it
expects and that's part of the whole
trick with JavaScript I don't care what
you're doing with JavaScript you may not
be targeting a whole program optimizing
compiler but whatever you're doing with
JavaScript it requires a whole bunch of
discipline using any particular
JavaScript library requires
adapting their conventions for using
javascript it's the same with Google's
compiler it expects you to take a
certain approach to using namespaces a
certain approach to doing dependencies a
certain approach to structuring your
code and when you do that you've given
it the recipe it needs to optimize your
program so if you take an arbitrary
program it can't do a good job it
requires convention into your authoring
of JavaScript and and there's a lot of
trickiness to that right you can write
something and you can give it a name and
it can make that name go away okay but
what if some other part of your program
you're using accessing that same
property by string well they better not
have minified it right or that string
access won't work so how do you talk to
your compiler about what you're
exporting to the users it needs to be
kept
you know intact and what you can minify
it has conventions for all those things
but unless you learn it and use them you
don't get the benefits so it begs the
question right that sounds like a lot of
work and discipline of course the Google
engineers do that and they get these
benefits but as a consumer of this that
doesn't work at Google and doesn't have
an info and environment and community
around using this tool how would you do
this yourself it would be pretty
difficult but what if you are using a
language that automatically produced
code in this form
that would be pretty cool I think
now we flip to the other side which is
the library okay this is a huge
JavaScript library it has stuff for
everything it has UI has XML and has
JSON stuff it's got all kinds of event
handling things that has Dom
manipulation it's got mathematics and
collections and it's enormous
at full of medical facilities which have
been tested in production applications
by Google it has a packaging system and
a dependency resolution system which are
very good and yet it's not huge why is
it not huge I mean is plainly huge just
like hundreds of thousands of lines of
JavaScript code it's gigantic
it's not huge because it was written
with these conventions it's completely
designed to be compiled by Google's
closure compiler you can take this giant
library and say include the giant
library and then write hello world and
get a 300 by JavaScript plot because it
said oh use the whole library Oh
eliminate it and and that's oh that's
really great so again I they threw the
stuff over the wall people looked at the
compiler and said oh this is a minute of
fire and Advanced Mode doesn't work on
my code yawn then they looked at the
librarian said oh my god this is another
giant JavaScript library list it was
written by Java programmers I don't do
this I wanna use my tiny minified cool
kids sign that is completely missing the
point these two things were made to be
used together and when you use them
together it's much more powerful than
anything you could cobble together from
libraries you found on the Internet
right it's just not even the same game
and this is what Google does
Google's approach you really only get
the benefits from combining the two
things but it's a it's really a
game-changing thing to say requiring a
library saying I use this library does
not imply in pulling everything it has
in it in against your application when
you separate those two things you can
make completely different decisions
about how you use libraries and what
libraries you choose to use you're not
afraid of a large library you're not
afraid of using a lot of libraries in
your program so I consider this to be an
absolutely winning strategy and
obviously Google does because that's
what they do they've decided it's the
right way to do rich applications and
deliver them in the memory constrained
and wired delivered environments that
they that they target and I think
they've given away really stellar tools
for doing this and they're tremendously
underappreciated so what does this need
foreclosure script write closure script
is built to run in a way it's a compiles
code that's built to be symbiotic with
this just like their librarians right so
their libraries already symbiotic with
their compiler but you have to write
JavaScript code by hand that also is to
get the benefits so if you use closure
script it emits code that is compatible
with Advanced Mode it only emits code
that's compatible with Advanced Mode
it's an it's a permanent objective of
closure script to emit code that's
compatible with
you do not have to think about that it
encapsulates all the conventions that
are required to do that in addition it
bridges the gap to the dependency system
so another critical thing that Google's
closure compiler requires is that you
use the dependency system because it
needs to know the dependencies right if
it's going to do a whole program
optimization has to be able to find your
whole program how could it do that well
you have to either enumerate what your
whole program is or it has to have a way
to look through dependency require calls
and provide calls to see what's actually
being used and so the closure script
with closure script does is preserve
closures namespace model preserve the
namespace construct and omit things that
make sense to Google's closure compiler
and are compatible with this library and
I think there's a tremendous amount of
benefit to be gained from doing this in
particular closure script gains by
taking this approach whole program
optimization and the ability to target
large libraries of which it's a
contributor my closure comes with a
bunch of large library and we want you
to be able to use as much of it as you
want without having a giant footprint
and that's what you get if you're
interested in how closure works just get
the e-book with the bird on the front
you sort can't go wrong now
it's actually quite a good book so if
you want it if you do not wanna left if
you do want the full story about Google
closure - closure book with the s is a
good description of Google's closure and
I think it's terrific stuff alright so I
did not hear come here to talk about the
idea of closure script I came in to talk
about the reality of closure script so
what have we got we have a compiler a
compiles closure script to JavaScript
optionally you can also run the Google
compiler on that and get whole program
optimized JavaScript we have a repple it
does what you expect and I'll show you
that later we have all the primitive
operations that make sense which is most
of them we have aiready overloaded
functions all the stuff you expect for
closure you have macros you have full
fledged macros just like closure macros
in fact many of the macros for closure
script are just sort of imported by
theft from closure and just work which
is really terrific
so you have all the power of the list in
having syntactic extensibility you have
an interactive development environment
so this feels like listen to me
you've got the closure data structure
set you have sequences and maps and
vectors and sets and most of the library
for this is in place so you can go in
there Scioscia cons map concat all that
stuff is working
you have proper symbols and keywords so
you can write code that uses symbols and
keywords and have that all work
correctly destructuring works you have
access to regex in a compatible way down
underneath the hood you have def type
def type works all the core data types
as I said before are written in it
protocols are present so all these
distractions are written in terms of
protocols you can use them for yourself
extend type and extend protocol work and
you can extend JavaScript primitives
like the string and number you can
extend nil and you can extend defaults
you have a way to specify the defaults
for protocols so the protocol story is
completely sound here what's what's
interesting and somewhat different about
closure scripts versus closure is for
instance in particular protocols in
closure are written in terms of a fairly
sophisticated and a large set of closure
so it's kind of hard to bootstrap
closure on protocols in closure script i
implemented protocols in such a way that
they're defined in terms of the
primitives that the compiler can emit so
you have protocols at the very beginning
of core dot clj as
which is very exciting so the definition
of closure script in terms of itself is
not like sort of that really weird part
at the top of quartet clj where we have
nothing right you start at the top of
quartet C ljs with def type protocols
and macros all working so the
implementation of closure script in
itself is quite pretty and a lot of fun
to hack on what else is there there's
over 2500 lines of core code in running
ready to go so tons of it close your
string is there close your set libraries
there close your walk is there close
your zip is there and just to get an
idea of sort of what it takes to move
stuff over one morning somebody said I
think we need closure walk and somebody
else said I think we need closure zip
and an hour later somebody said what
we've got closure walk and somebody else
said we've got closure zip any kind of
algorithmic code like that is is an easy
walk to get running and I expect the
rest of the libraries to fall into place
rather quickly
so that's fun close your walk was about
to line change yeah
and of course once people know how close
our script relates to closure it will be
relatively easy to write libraries that
run without change on both my deal you
might find a closure library it has a
little bit of Java ism in it you gotta
hide somehow so it doesn't think over
there is a reader a reader foreclosure
data because why don't even know why I
have to ask this question through a
closure room why not JSON we know why
not closure data is just a much richer
format than JSON and you've got well
first of all you have two strings for
everything right you have keywords and
symbols you have sets you have metadata
so if you're writing client server
client service applications in closure
on the server and close your script on
the client it's just a terrific story
you're just going to have all the fun
you want send closure data over and
start using it on the other end it's
been fun like we've had you know we've
been debugging a demo app and
we're like I wonder what's in that data
structure we just sprinted to the log
and in the JavaScript console we're
seeing closure data and we just cut it
out of that paste in the repple and eval
it just works it's really sweet so
there's a reader what else have we got
we've got namespaces they work as you
expect
you have an NS form it has it does less
than NS enclosure its construed
circumscribed somewhat and but it is so
that it integrates with Google closure
so you can declare namespaces that turns
into Google provide calls you can
require closure libraries and Google
closure compatible libraries including
all of Google closure using require you
just say require goog
and boom array in Iraq with Google's map
library and you can use the namespace
syntax to use it it's very sweet we have
some of the you know higher-level build
tools you can compile files you can
compile whole projects including the
ability to do the dependency calculation
that's required by Google's compiler and
invoke Google's compiler on the entire
project so with the single thing you can
say build this thing in advanced mode
spit out the Java scripting at the other
side which is really terrific
we're not done there's a bunch of stuff
that's not not in place yet in
particular the first cut of the
collections are oriented towards small
collections so they don't have all of
the mechanisms for doing full
persistence so if you put a million
things into them they won't have that
nice preserving your performance
behavior but it's certainly our
attention to do that we just haven't
done that yet we want to get all the
interfaces up and get the library
running and that's all working of course
making a full ecosystem the hood is sort
of an optimization which we intend to do
def records not yet there
we don't have multi method yet but it
will be straightforward to do that we do
not have the full numeric suite yet you
know sort of ordinary JavaScript numbers
which means we have double arithmetic in
place at the moment we haven't brought
over the testing facilities of course we
want to integrate with Google's testing
facilities and do stuff that makes sense
for a browser-based testing and things
like that so that would be probably a
little bit different in closing script
and there's all kinds of little
miscellaneous pieces of the core library
still to be done you know we're pulling
them in as we need them and as people
get you know
well I'm going to go take on you know
the predicates and things like that but
a lot a lot is there there are some
things that are not going to be in close
your script in particular javascript is
not a threaded runtime so a lot of stuff
around threads makes no sense so we're
not going to have those things in
addition and this is probably more more
important to understand there is not
going to be a run time compilation
environment we're just not doing it
right closure is the compilation
environment not closure script there's
no eval it's not the objective of this
thing to write a web hosted IDE or
anything like that
so there's none of that we do not have
structs and will not have structs or
proxy or any of the java type stuff I
guess another important point I should
make here is that the target for this is
you know equus script 3 . that's the
thing that has the reach equi script
five extra script tomorrow those things
will never have this reach or if they do
it will take a long time to get it so
our target is what's out there now just
like closure right what's the benefit of
closure
it runs on everywhere Java runs now not
future think maybe later
same thing with closure scope the
targets JavaScript baseline than
everybody supports
so even though javascript me talked
about type this and that and maybe a lot
of bridges to that will never require
that in our implementation the other
thing that's not there is there's no
runtime constructs for bars namespaces
or protocols a lot of these things are
used by development time and compile
time environments in other words this
typically enlists this merging of your
depth experience in your runtime
experience and sometimes you tap into
that but often you're just sort of
taking advantage of the fact that you're
more often taking advantage of the fact
that my runtime is available at dev time
then you are taking advantage of the
fact that my def time environment is
available at runtime that makes sense
and so we don't actually have the latter
we have the former we don't have the
latter so we don't have that stuff and
we will have that stuff I should be
clear this is still new it's very new
the target is for production use it's
not ready for production use but there's
nothing
see our line that keeps us from thinking
that it's going to be quite suitable for
production system add some more effort
but it's at a good State obviously I
just enumerated a whole bunch of stuff
that works it's the only rapist people
play with them and that's why we're here
so there are some bugs they're
definitely missing bits as you'll see
there are some rough edges on things
like occasionally we see we reported a
function and I've gotten all the arity
someplace and things like that so a
narrative checking there's a bunch of
things that we'd like to make better
which would be obvious if you try it so
that's okay there's more work to do a
lot of work was done or any though it
has been done and I would really like to
give my sincere thanks to this team of
people who worked on it which is the
members of closure for a bunch of our
friends it started as a personal effort
by me and I opened it up to core and
some other people obviously can't start
from scratch but yeah
hundreds of people participating but you
know we're ready now to share that so
I'd like to thank everybody here and
give a special thanks to to all of them
because they spent their Friday time and
their spare time putting this together
over the last couple of months so yay go
team thank you all for being awesome and
so I don't say most things are awesome
so I'm really need that arrows however
just to be clear this is a closure
project it's under the closure CA all
the normal rules apply it's really stun
to the Eclipse license it's just like
closure
I'm sure students busily trying to get
the repo I'm trying to fork it right now
hopping right now so that everybody can
start playing with it
so beyond closures github repo as soon
as he finishes we have hardcore forking
action part more putting that right that
sounds like beat that sounds
inappropriate so it's up vessel and of
course that we could definitely use help
moving forward there's a lot left to do
there's more libraries reported there's
completeness stuff there's testing the
things we like to do around the
environment and the tooling we've got
everything started and we have a bunch
of pieces in place as you'll see but
the more the merrier this is really a
killer tool
in addition to the ordinary
participation things I'd also like to
remind you about opportunities to
interact in person the first is the cons
is coming up in November you should get
your only bird tickets now to discount
don't let it go you'll end up not
getting the discount it also helps us
see you know estimate things as to
attendance and how much we'll need of
this and that
so get your college tickets it was so
good last year and I expect it to be
even better this year and we do have the
training option now so if you want to
come early and get training if you're
not a closer expert there will be plenty
of experts there
I expect that train to be really good
another thing that's kind of new I
talked about the fact we did this on
Fridays it ends up that the core team
pretty much has Friday's to work
everybody has day jobs and other things
that they're doing but they're companies
that they work for sponsor open source
Fridays and the core team chooses to use
therefore Fridays to work on closure it
ends up that sometimes people in the
neighborhood in Raleigh and want to stop
by and a couple people have stopped by
including a few people on that list and
joined us on Fridays to work on closure
script and this is something that we'd
like to try to make more of so if you
think that you might be in the Raleigh
area and your closure
Davian you've signed the CA and you
might be interested in working with the
core team if I say something wrong okay
well Durham there its doors turning guys
are so there's some picky oh it's still
enduring I'm seeing Raleigh here so I
keep saying it relevance is actually
indoor which is the swell place and if
you're in Raleigh you're actually pretty
near Dora
if you're in either Raleigh or dorm or
think you might be in your closure depth
that sign the CA might have time on a
Friday you might want to work right next
to the core team that's something that
that might be arranged with some
advanced communication so that's an
invite that's been opened which i think
is quite cool and the people have done
it have had a lot of fun
oh now supposed to show you this time
for demo travel camera that means
this looks horribly distorted on MySpace
you see the bottom you want that bigger
too
okay oh I'm actually already in here let
me uh
so right now I've never seen the bottom
kinda sorta this is always bad you can
say no out loud that you can't okay
internet saying that having trouble soon
unless what and that me could be a
clarity issue yeah so right now I'm in
the in the closure repple so I just
started inferior list the ordinary way
and I have closure I'm just going to
manually start closure script so you can
see what that is but the closure script
compiler is a closure thing and I'm
going to require it ordinarily like that
this rebel environment is something that
we use to communicate with Rhino as some
stuff in it that they want to see and
finally we start a raffle with that
environment and that sends all the
closer source code through Rhino which
as I said before it's not particularly
peppy and then we get this prompt which
is now the closure script font so and of
course you don't need to go through this
multi-step thing there's a script in the
repo that just starts closure script
repple it does both of these steps and
you start with this prompt and
everything you type here oops
does something different or not
hopefully not but what happened here was
this this form was read by closure and
sent to RINO for a compiled by closure
the JavaScript was sent to RINO it was
evaluated the result was printed
enclosure script and that string was it
got printed here but by them by by
closer script so we have printing
facility for photo strips so it does the
kind of stuff that you expect you can
see some stuff here I'm just I'm just
saying about expression either from my
cursor up
it doesn't thing below so you know
that's the stuff you expect right you
can call maps like that
does that work a little
that was where
somebody's not happy
we have new longer SPECT races since I
was the one thing you know we really
sell people a lot needed some closure
was amazing right there
I'll work some races house
and maybe because every started
there we go it all works perfectly it is
just because I lo did some code and they
didn't restore this place my fault so
that's cool but you know even more more
interesting things work right so see
this
bottom here
so this is you know interrupts calls
right parsefloat that works
this is particularly fun though def
protocol works and extend string
JavaScript string to the protocol we
cave and see like the what it compiled
there's a mode where you can see
everything that's compiled in all the
JavaScript to compile and then we can
call foo on string we're defined through
to being the count and so protocols
extend types extend JavaScript primitive
types all that stuff works
over there
population
I'm actually going to hand compiled
anything but I do want to show you the
results of compilation so you can sort
of see what's happened what happens
this is close your script directory over
here so when we compile all of core
which I can show you let's look a little
bit let's look at that briefly so you
can see what we started with so we have
two things to court
two things that constitute the core of
closure strips one is the set of macros
that are used so you'll see this is a
core dot clj foreclosure script this is
a way to wrapping
but it defines a macro called import
macros and actually steals all these
macros from closure right so the arrow
macros dot end assert comment con con P
declared F on do to extend protocol fun
for if let all of these macros worked
out of the box with no modification
right we just stole them they work in
close the script right away and then
there are custom versions that some of
the macros like extend type is different
I'm sorry this is wrapping so terribly
almost rather drop the font so it wasn't
so had a border with people prefer that
I think it's probably
all right so this white stuff just gets
wrapped
massively
let's see how boys dance on cake mold on
sure tell me where I do that an
ex-junkie all right it worked
are you scared better so so you write
your macros enclosure and macros
remember are just transformations of
forms the forms right updated data those
you can still do that and can do it on
behalf of closure script boo boo all
right the other big component then the
much bigger component of a closure
script is
Quartet clj s so this is closure script
code this is not closure code everything
that you see here is being compiled by
closing script so all these all these
forms and primitives are accepted so
namespaces work like that you'll notice
we're requiring JavaScript libraries
with require forms because we've unified
namespaces and Google's convention for
packaging and dependencies there's a
couple of little portals to raw
JavaScript as a new jsr primitive to
expose the things that we don't end up
exposing enclosure script nasty things
like this and the way truth works in
JavaScript but I just thought I'm not
going to ever expose that enclosure
script so if you need to use it you can
just drop down but you can see the
jeaious the jas primitive is really cool
right what is it doing
some strain coolness it's doing
interpolation but what is it putting in
there
because I can tell you this X is not the
symbol or string X in compilation it's
this nasty munch thing so it's not
merely interpolation it's actually
interpolating things with knowledge of
how names resolve in the scope in which
it's used there's a very powerful tool
so we have defin definitely closure go
to me but look right away we need to
find F protocol we're using def protocol
here are all the abstractions of closure
associativity right dereferencing
metadata being able to reduce being able
to seek being able to print write all
those ideas that underlie closure and
the way closure works why everything
works together is based around the fact
that these abstractions are
polymorphically implemented by the
library they're all protocols and then
we can start extending like we extend
nil so the implementation of nil for
these protocols is right here it's a
beautiful thing we can extend capital
letter uppercase types from JavaScript
we can extend
primitive types of JavaScript
and you know and then this is well so
here is erasing so here we've extended
array to participate in the things that
knows how to participate so all that
gook if you've ever looked at the
closure implementation right
I could I could do things with some
types because I own them and I can make
them derive from my my interfaces but
the built-in types I couldn't modify so
I had always had to have a if it's a job
of this do that if it's a job of that do
the other that all disappears because
now we define the abstractions of
protocols and we can extend anything
using protocols and then it just goes on
and on first rest blah blah blah it's a
beautiful thing but it's more beautiful
because there's nothing else there's no
JavaScript is no big library of other
gook the entire definition for
everything is right here of course this
is a huge file it's just go go maps
whatever all the key stuff partition
more more stuff printing
Adams was that all written by hand or or
deal partially mechanized big generation
this is ring by hand yeah mostly copying
and pasting from which sports equipment
and we have some some tests here and
stuff like that so before we get to the
tests whenever it's a it's a lot of code
it's whatever twenty six hundred lines
of code so this is a great example right
because when you compile this file you
get a 366 K JavaScript file and then
Google has two modes of the compiler
simple mode and advanced mode simple
mode does just whitespace elimination
and pretty printing so rather than show
you the output of the compiler I'll show
you the output of core core simple so I
was already loaded here
so switch this reread no it says oh wait
it's changed on this this is what messed
me up before
there we go
so it turns into this boatload of
JavaScript
this in simple mode absolutely
everything you wrote in your source is
compiled to JavaScript so you can see
all the compilation of everything we're
not going to talk really about
implementation details today but this
just goes on
but what's cool is advanced load so
that's 300 K now you can minify this all
you want but it isn't going to turn to
less than you know 200 through ordinary
minification methods but look at cord
advance it's only 40 K and in fact if we
reduce our conditioner if we say
compress this thing
it's 6k laughs
what happened was nothing we didn't call
anything right so our baseline footprint
is you know in those the amount of code
we can't get them to review because we
did nothing is just this 39k at the
moment and actually we're still working
on making that even smaller you don't
and so what's fun is you can keep adding
functions to cornet clj s and core
advanced doesn't change it doesn't get
bigger you keep adding it doesn't get
bigger
that's the magic sauce here so that's
the results of compilation else we don't
know oh well it would be nice to run on
the web
so there's a sample here
yes I say the absolute we can talk
what might be a good thing to look for
in your script do you think people are
talking about focus hi yeah I've got it
yeah the Internet yeah you may need to
do it in the hashtag
questions are connected oh you better
not use the part I never connected
the problem with this is that Twitter
only lets you talk to it only so often
and so once it's decided it's heard from
you often enough it will lock you out
anybody using actually use like the
address if anybody on our team is here
you got stuff collectors we're not
I don't think I'm Filipino service
let me will they rebuild it
so we have a we have two kinds of tools
for doing builds this is the command
line one this is really slow right now
because it has to load Java then it has
to load closure then has load close the
script to rhino then it compiles to
JavaScript that has to let run closures
Google's closure compiler so it's it
takes a long time I think that's all but
we have a build thing that runs in the
repple where a bunch of those steps have
already been done and the turnaround
time there is sub-second compiles and of
course compiling to Google's closure is
is optional so I should have done this
I have nothing to say while this one
goes on so seriously it probably is if
you have an app that's using the Twitter
API we're probably all sharing the same
IP FS and getting booted off I just
killed myself sorry yeah it does it does
sort of limit you by your source ID
right
now it's definitely no I don't like that
what else was on yeah where we were in
the same room we were all together
hey Hach is that so what this app does
is that it just asked Twitter for the
results from a Twitter tag and keeps
track of who tweeted what but also who
retweeted and mentioned who else and it
builds a graph of the relationships
between people's tweets so we can see
here that disclosure also forts the lon
hover over disclosure see if it's
somebody happier here
he's probably treating Stewart saying
the same I did not say that
you're mouthing too bad yeah yeah okay
salut
so and then it lets me it pulls Twitter
as often as the lettuce and updates this
graph replacing people as they become
sort of the leaders of the conversation
and people start following them so it's
a cool thing it's not rocket science or
anything but it's written completely in
closer script there's no JavaScript it
uses the Google closure libraries it can
be compiled in advanced mode producing a
single javascript file and let's look a
little bit
how many lines I don't know let's look
so we will have to tell me how to do the
line count and Max I kill nice well
there's a bunch of file so one of the
cool things is you're not all concerned
about files right oh I don't want have
them a file what's the Browse are going
to cache it
oh that's going on right you have as
many files as it makes sense from your
development perspective because what's
going to happen to it all it's all gonna
get just going to go through this meat
grinder that's the Google closure
compiler it's going to spit out one tiny
little thing
so there's actually several files I even
know how many files a sec six or seven
files we can look at the core thing is
one of these two files knows this one
right so it's look it's just beautiful
stuff require Google Network code and
timer code and events code and Dom code
set up state with closure literals right
and have an atom for our state because
we're still going to do state the right
way and close the script even though
it's a single-threaded thing it's still
saner to do this and believe me we've
seen the benefits from doing this just
in this little tiny app right you don't
have to care about aliasing when you use
immutable data structures and you do
care about aliasing even in a single
threaded app right because one part of
your apps like I'd like to remember this
the other part of your apps like I'd
like to change that right now you're
screwed it doesn't matter if they take
turns single threaded lis that does not
work right this the state model still
has value here so we have an initial
state we have listeners and this is
looks like closure code that does this
job adding mentions updating the graph
right this is nice right to do it in
every window toggle whatever yeah
many perhaps a lot of typing
all right well you can you can mostly
see this like this so this is sort of
the main infrastructure then we have a
file for the drawing bits so there's
some configuration things and some
background stuff but this is the basic
canvas drawing code right here as a
combination of Interop and closure code
it's just like what you doing on the JVM
right you leverage the platform you
leveraged loaded data structures the
same kind of recipe it's the same kind
of power drawing the avatars and things
like that we register a callback so when
when the data changes we repaint that
kind of stuff then there's an
algorithmic component which is this
radial algorithm for doing the radial
layout is in here and this is sure
algorithm code right you write this code
in the repple you test it in the repple
you hand it data literals and you have
to go into the browser to see what
happened you just interact in the rep
one so doing this work is here so it's
really simple getting the message the
mentions right the descendants
calculation calculating the weight which
is a tree dive and the basic layout
thing which I don't understand this is
too big a function
he says needling but it works and the
coordinate conversions so the cool thing
is that this is the kind of stuff you
will not be afraid to do in
clojurescript
you have some algorithmic stuff like the
first cut because I was familiar with it
and nobody else had some free time I I
tried to do the layout with a simulated
annealing approach right which is a cool
thing for optimizing back then we were
trying to show all the relationships
with everybody it ends up being a really
crappy way to do this and it looked bad
so we've changed it to this one but you
know it's just so sweet my writing
stimulated annealing that can run in the
browser using closure it's like 10 lines
of closure this is the entire inner loop
of simulated annealing algorithm you'll
be able to do stuff like this you won't
even care that is JavaScript you don't
have any fear of I don't know if Java
scripts really good for that kind of
thing because yes closure I don't know
how to count all the works all the lines
in the directory
it's not too many most of stuffs in
those two other files we don't even use
this one anymore
see bad clothes for does not suited for
command line usage too thin you could
write a program with that that would
enumerate all the files I know wow
that's the extent of our routine by the
way you shut up so that yeah look at
this people more people are talking and
Oh Stu is now the center of the universe
over here what do you say those I said
between your Emma home some people so
thank all my fans this is a nice no cool
stuff is really nice and you know you
can use CSS on and
it's not what people are using right
people are using libraries you know from
from other places but Google is using it
and there really is a ton of stuff here
you're not limit it to this but if you
want to use a little library if you've
got to figure out how to get it to play
the game there are two ways one is it
could actually play the game and be
designed for this the other is if the
library is not too far off you can write
these descriptor files to describe the
library to the closure compiler so then
it can know what the dependencies are
and how to do the name elimination and
they've done that for libraries like
dojo so if you want to use dojo you
could do it and it would played the
whole game and the in the Google closure
book you could see the recipe for doing
that stuff so that's that and yeah so we
said we do something else I'll be over
here somewhere
so one of the other things that closure
struggles with obviously you can't run
closer in the browser enfold something
like this but one of the other things
that closure is not so great at noir or
any other jvm languages is command-line
apps because the JVM startup time
dominates your tiny little program in
addition it's hard to make a tiny little
program
but v8 is quite fast and the eight runs
of the command line the eights been used
for things like node and v8 works with
closure script just fine and so this is
a little bit of closure script written
against node libraries so this is going
to run node load closure script load
this closure script or well load the
splitter script compile JavaScript file
and enumerate the directories these two
directories again so that's much more
responsive than starting Java so you can
do that so we can target v8 you can run
VA command-line apps you can compile for
that purpose and it's just an another
example of using you know reach another
example of the reach of javascript is
actually command line so I think it'll
be a good way to do that and some people
we're just starting this site there's a
lot of little tricks involved in running
with the node libraries and things like
that but certainly possible and it
certainly starts fast
right
so to summarize I think that closure
script is the way closure reaches the
client I think it's the way closure
reaches mobile I think it's a suitable
tool for closure to do command line work
and it satisfies the thing the first
slide set right it's it's the power of
closure everywhere you can you know run
JavaScript and I'm hoping it will really
enable people to do for next generation
development in these environments you
know given a tool with macros the
ability to write dsls and you know the
ability to generate code to run on the
client it's just that's straightforward
and let us think about closure script as
a target for your DSL it's really quite
sound and a lot easier to omit them and
manipulate them strings so I'm hoping to
see some new and really interesting
applications and I guess we'll throw it
open to questions yeah
allocating releasing small objects we
make a comment about performance of
those types of the ends that
all right so so the question is the
persistent data structures work well on
Java because job is good at a small
object allocation and and clean up
garbage collection what about these
JavaScript VMs the JavaScript VMs are
getting incredibly good at the very same
things because they have to be because
it's the same same game there so we
haven't done any performance testing of
the eight but the test of the eight
against Java will be the same proposal
script as they are for JavaScript v8 is
you know is competitive so I expect the
persistent data structures to perform
really well other questions
the arbitrary humans put a vector to set
it's like take the direction saying in
JavaScript you only have strings of keys
yeah we don't have that problem but
someone's it's tricky now I mean you
have to get the is one hashing
inequality and the basic rudiments and
then you can build on top of those I
will say though that the implementation
is extremely clever right we are trying
to leverage the fact that we're running
on top of an environment that was made
for dynamic language that's not true of
the JVM so the JavaScript environment in
particular has fixed them most of the
most of the sophisticated JavaScript VMs
have fixed ohms in addition what will
take Google v8 as an example because
they've been very explicit about what
they do they have a strategy for making
object access you know constant time by
compiling little micro internal classes
as you build up an object by hand so you
keep adding properties to an object that
says well you know if I ever see
somebody has those same properties in
the same order I'll just pull up this
class I already filled where I know if
you ask for number foo that's slot 2 and
I don't do any lookup I just pull out
slot 2 we've made the closure maps that
have strings symbols or keywords as
and our small directly mapped to that so
you get that optimization and only when
they only want to have non string keys
do we end up with a proper hash
inequality based thing so you get to get
it all and and not only be made better
as we take the third step which is when
you get large you'll switch to a system
like the one that's enclosure for the
hash base trees of trees
you'll have everything you want big data
structures small data structures that
work you know using maps as objects will
work just like JavaScript and using
NASA's collections of work just like
closure
yes
the presumption is not because I
wouldn't change closure if suddenly
JavaScript had that so close also I'm
sorry the question is do the JavaScript
VMs have temple elimination and if not
how do we deal with it we already dealt
with it in closure we don't presume it's
there and so we don't presume it's here
you have looper car and all the normal
the normal facilities but the semantics
of closure were baked when I made the
decision to target the JVM and not to
have too helpful so I don't believe that
telcos should be treated as an
optimization I believe they should be
treated as a semantic promise if you're
going to have them so closures never
made that promise and closure script
doesn't make it either
yes no I also it was the greeting with
you because I guess that's what's key
after all except that it may be the
other decision but it's again cement
right but he made the promise and never
you can really leverage it you can write
different kinds of code that way other
questions
when you guys get slower questions I'm
going to open it up because I have their
people in IRC they would love to ask
questions so you guys have first dibs
cause you're here yeah use it just took
a baby we have
there are darris fastest JavaScript can
do I mean javascript has a lot of so the
question is what about numerix and the
performance of numerics and arrays of
numerics javascript has you know a
number type which is essentially a
double but mostly implementations also
have internal fix them logic in the
classic dynamic language optimization
and so we're just letting them do that
it's as good as it is I can't closure
script can't make JavaScript to do
anything it doesn't already do your
slide from today will be buggin
yes I'll make slides available I'll take
some questions from the internet we'll
go back I can't cast a different kind of
question if there is a runtime error in
the rest of Farish themself yes does the
diagnostic look like
does it look like anything useful or is
it completely cryptic okay so I guess it
depends on how you handle it I mean
there are exceptions when we throw
exceptions and then you have to you have
to decide with your strategies in your
application right no no not in that
sense but is there a way I can lack what
the browser tells me to back to my
closure script program
yeah there's there are some tools
available in Google's toolkit for doing
mapping they're used to map back to the
original JavaScript we're still
investigating around we can map back to
those scripts but we don't have that yet
looking promise it's an open area right
yeah it's definitely one of the tricky
things about compiling to another
language
get it right all right now let's take a
question from the internet so question
from the Internet what's the interrupt
with things like jQuery Yui underscore
Jas okay it depends on the library as I
said before the there is a there is a
recipe in Google's in Google closure
land for describing libraries to the
Google closure compiler the libraries
can't be too far off from what Google
closure can optimize and the purpose of
these extra files is to describe the
library to the compiler describe the
dependency of the compiler describe the
names that are exported by the library
to the compiler so that it won't get rid
of that stuff or lunge it and when that
can be done you can use the library
transparently if you can't use the
library transparently then you won't get
the benefits of whole program
optimization but you can still make
calls I know that dojo has been done and
jQuery had not apparently so far the
story in Google world is that jQuery
isn't compatible with the dance floor so
somewhat fundamentally I have no idea
what the details of that are I know some
people are trying to do it on the other
hand I would say that there are
attachments of these JavaScript
libraries should be relaxed if nothing
else right
what does jQuery do it does three things
right it encapsulates the difference
between Dom's on different browsers it
provides a declarative abstraction for
Dom manipulation and it provides sugar
for JavaScript for the access to them
now we're in colonial scripts doing eat
sugar for JavaScript we're we're like a
shot to the theorem
whipped cream and cherries and sprinkles
and everything right
so we do not need sugar for JavaScript
and we have macros just like your own
like hot fudge machine do we need Dom
encapsulation do you think Google has a
library then it caps lates the
difference between Dom some browsers do
you think they might need something do
you think it might be decent yeah okay
so that's covered by Google's library
which leaves what declarative access to
the Dom now
jQuery names are a perfectly good job of
that would there possibly be a closure
twist on that that might be more
intuitive and idiomatic for closure use
I see people's like their light bulbs
already go I could beat jQuery
I'm expecting libraries that provide
jQuery like capability to be written
encloses script so it's a mixed answer
there will be libraries that work and
ones that will but you should have an
open mind using my evil power to pick
questions
someone says core dot logic as you much
leverage any other reporters that'll
take some time it will take some time
I'd although I think to the extent
you're using verticals and DEF types
it'll be straightforward you probably
just have to suck out a lot of you know
some of the all the part high nation the
type stuff I don't know though I don't
know because the thing is you can put
some of the types in there and go script
or just ignore them you little or detect
it right now right now another thing
that everybody should be aware of is the
fact that Google's closure compiler has
actually can do static typing for
JavaScript that's suitably annotated for
instance the closure script compiler
I'm going to say closer so many ways
today the closure script compiler does
omit some annotations that are already
consumed by the Google closure compiler
like for arity purposes and the
potential exists that emit more in fact
the first statically typed version of
closure might actually be closure script
omitting type-ins so that Google closure
compiler can do the checking other
questions from anywhere
yes so there were questions about this
question does this move myself oh yeah
several questions related to closure in
closure is this moving us closer is the
first step
what's the relationship I think this is
a great a great story for a closure
enclosure right this is a demonstration
that closure enclosure is possible it's
also a demonstration of what's required
at the bottom I would say that my
experience in having designed and
implement at the bottom of this is that
I would need to get closure protocols
lower than they are currently in closure
because they're defined in terms of a
lot of closure and they need to be
signed in terms of primitives on the
other hand that's not impossible so yeah
this is definitely a recipe for how that
might be done and an experience if
nothing else gives us experience in how
to do it
so question how long is closure scripts
been in development clarification
hammock time of coding time yes both
please have a time were coding titled I
own units of time I can't
tolik have our time it's been a long
time you know there's a sense in which
the design of protocols and and f-type
are about closer and closer and enabling
this kind of thing so that's very long
time actual work on the compiler i don't
know was that three months ago maybe
somewhere in the last three months in
terms of typing and closure script code
calling it closure script
other questions here's an interesting
one how feasible is it to hoist the
compiler into the browser there's
another question about
embedding clj s in a closure web app I'm
not sure if there's a related so these
are both questions about putting the dab
environment in the runtime yeah
that's was listed as a non objective
right so I can't stop anybody from doing
it but I'm not going to do it I don't
need it I don't think people actually
need it so that's a thought exercise or
whatever but not it's not something
that's a core objective that does
prevent you from defining functions over
thought at runtime right
hey someone's already gone another
question I there's no way
somebody's not gonna do that I'm not
gonna get did you leave a thing like so
I can see help think yeah I guess I did
Wow Wow domination are not retweeting
Stu see Stu knows how this works he
knows if he doesn't mention anybody else
all night he's going to remain the
center of the universe he just has to
delete chop the conversation he plays
you should talk about somebody something
else
I told keeping every sweet me instead
that's pretty funny we can change the
keyword so yeah I mean there's fun I
have a question so what sort of child
the VA thing is creating a great even
notice trading platform that a lot of
traction or the challenges you guys are
anywhere
getting working with no
it's just the you know it's very new I
don't know that there's anything
fundamentally challenging there the the
general challenge with working with
other libraries is the fact that
Google's dependency system is one in
which they intend to resolve everything
statically at compile time and a lot of
JavaScript dependency things are
oriented towards runtime loading of
files
it's a runtime loading of files the sort
of anti whole program optimization so it
says there's no possible way you're
going to do it and so once you're doing
that you sort of get very cavalier about
loading and so if those loads can't be
seen that it's harder to you know high
thing I didn't do the node work so I
don't know what some of the other
challenges were but I think it's just
novelty like it's three days somebody
will start three days ago somebody
started working on that so it's as hard
as I've never worked with node I've
never worked with close to script we're
you know what everything's new it's not
necessarily inherently hard
other questions
someone asks I'm curious about moving
forward what kind of unified ecosystem
are we shooting for as a community ie
unify on node unified with current tools
like line again
I'm not sure that's actually a question
I'm not sure you know I think I think
there isn't there is a good question
which is sort of what's the story for
making libraries of work in both places
and I think that we are experiences been
you know if you take a closer library
you might be able to get it to run all
the way through but you might not and a
lot of times the reasons are there's
some Java stuff that sort of wasn't
encapsulated and so but it could be I
think that if you if you have closer and
closer script in hand and you're trying
to write a new library that's
substantially algorithmic and it was not
drawing on screens or writing to disk or
doing something i OE oriented it should
be straightforward to write something
that will run in both places with a
single set of code in terms of ecosystem
things I you know the ecosystem has been
varied and will continue to be buried
not everybody uses line again
I would hope that maven would never get
near closure script I'd like it you know
we have binary delivery on Java there's
no such thing in JavaScript so I'd like
to you know maintain a source oriented
delivery scheme for closures from a
little jar files
not going to superimpose that
other questions yes is there any
possible over desire to sort of unified
or the surfboard
what does that make any sense at all
well I mean pork so so there's a bunch
of cool things about closure script one
of which is you know we got to write the
compiler in closure right so the closure
deposit in the Java The Closer script
compositor in a closure and has what can
you repeat questions the question
the question is there any hope for
unifying closer script and closure you
know sort of at the lower level and and
so the closure script being written in
closure is very nice because again
opportunity get rid of all the Java code
and an opportunity to revisit the way
the compiler works in particular the
analysis phase is now discrete and the
output of the analysis phase is you know
directly consumable and is all close
your data structures so yeah I could see
you taking the closure script compiler
and emitting something else maybe Java
code pretty straightforwardly
so you think the clouds refundable it is
not written to be pluggable but it's
it's not terrible and it's actually
quite small the closest group compiler
well when I was done with it for other
people started touching it physically
there's only 500 line the whole thing
the analysis I'm the admitting it it's
tiny so yeah I think that a refactoring
would be required in order to make it
pluggable but you know it's it's not
rocket science it's a recursive descent
compiler and then in a mid or that spits
out text which is exactly the way the
original closure was already so yeah I
think there's a lot of interesting
things that could come out of it for
sure
alright there's something funny going on
so what's this thing I don't know how to
pronounce it with this question
Oh Jericho Oh the unifying one yeah so
with respect to unify enclosure
enclosure script is it plausible to have
shared memory between a server app
enclosure and a client enclosure script
I guess anything is possible yeah I mean
to extend clojurescript is running on v8
and you have access to OS level
facilities there I don't expect doing
that from the browser
other questions alright well try it out
and have fun</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>