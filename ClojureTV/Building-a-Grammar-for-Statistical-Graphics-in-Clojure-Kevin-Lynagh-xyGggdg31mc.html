<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a Grammar for Statistical Graphics in Clojure - Kevin Lynagh | Coder Coacher - Coaching Coders</title><meta content="Building a Grammar for Statistical Graphics in Clojure - Kevin Lynagh - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ClojureTV/">ClojureTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a Grammar for Statistical Graphics in Clojure - Kevin Lynagh</b></h2><h5 class="post__date">2013-01-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xyGggdg31mc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so yeah my name is Kevin lino I'm gonna
be telling you guys about building a
grammar for statistical graphics using
closure the agenda for the talk it's in
two parts the first part of the talk I
just want to kind of talk broadly about
data visualization kind of what's out
there so it's a really exciting field to
be in so kind of what's going on what do
I mean when I say data visualization and
also sort of how you go about doing it
so both in terms of tooling and then
also kind of the 101 of human perception
and you know mapping data to visual
things and that's going to lead me to
the second part of my talk which is
building a grammar of graphics so you
know there's so much out there you know
how can you think of all of these
seemingly very different things sewing a
bar charts and line charts and all this
stuff
how can you kind of put them together in
a single framework to think about them
and reason about them and so I have a
40-minute slot I'm going to talk for
about 30 or 35 minutes and then we'll
have five or ten minutes for questions
um so yeah as Stuart said you guys
should all have a handout and it's got
my email and all this stuff on there so
if you do have additional questions you
know feel free to ping me on Twitter as
I mean email and we can talk more about
this stuff cool sweet okay so part one
data visualization what why and how
rather than try and you know just tell
you about everything that's out there
I'm going to keep it actually very
limited and just talk concretely about
some of the projects that I've been
lucky enough to work on over the past
year and just give you an example and
I'm hoping that when you see those you
can kind of step back from the
particulars of it and see maybe some of
the motivations and some of the benefits
and how those might apply to things that
you're working on yourself so on your
own projects um and then after that I
want to talk about you know like what
and why right and then also how so you
know there's a lot out there you know
you can find a lot of stuff on the
internet now a blog posts about how to
how to do these things how to draw them
and make them on the computer but you
don't actually see that much about how
to actually do them in theory or how to
do them well and there's a lot of
research very good research that's done
about human perception that most people
don't know about so I can't want to give
you guys a crash course on that and then
also I talked briefly about what's out
there um so
this is the first example of a project
that we worked on this past year and
this is an iPad dashboard that we made
for a client who runs wind farms so this
is actually all closure script by the
way which was really fun of heroing at
times but fun to do and the the the
thing that this client had was basically
you know they they did done all the hard
work like they have all these wind farms
and they had all this infrastructure in
place to collect data about it right so
they were getting you know every half
second or every second information about
all the different turbines like the wind
speed and how fast the rotors are going
and oil levels and all this kind of
stuff and so they were taking all this
data and just putting it in a database
and the problem was right it doesn't
really do anyone any good just to have
this stuff in a database like it wasn't
accessible to the people who were
actually in the field so people on the
ground who had to maintain these things
you know they're not gonna just stop and
sit down and write like a giant sequel
query to answer their question and so we
did you know really what were a lot of
very simple visualizations you know so
this is just a screenshot of bullet
charts which are kind of like a bar
chart and so you know it's just showing
very simple scalar values but to put it
on an iPad and actually have it you know
in the Jeep in the desert where you can
look down and kind of see what's going
on is very powerful so it kind of put
put this information out there where you
need it and do it in a visual way where
you can just glance down and kind of get
a sense of what's going on um this is
another example of a project that we
worked on this is actually open source
so it sits on the github it's also a
closure script project this is for this
is a collaboration with the Harvard
School of Public Health and this is
actually a dashboard that they wanted
for biologists to look at gene
sequencing data so you guys have
probably heard all this stuff about
genome sequencing and all this kind of
thing and you know you have to remember
that most biologists are not like us
right they're not developers and it's
not natural for them to just get a giant
text file of all their their genes in
whatever organism they're studying and
then to start banging out like a perl
script or whatever to answer their
questions and so you know this is just a
very simple kind of like this is all
built in the browser and so it was just
like you could go and upload your file
and then start looking around you know
looking and selecting subsets of these
different distributions
but you could answer your own questions
right and so that's really powerful like
none of this is crazy advanced
computational stuff you know it's just
sub selecting on these different things
but to put that in the browser and make
it accessible to practitioners is really
powerful because they can kind of help
themselves right they can answer their
own questions they don't have to wait
you know two months for a postdoc to
come by who knows how to program um and
and one thing I want to say about this
kind of data visualization stuff right
so I showed you this bioinformatics
example on this with this wind power
example this isn't something that's
limited to just very kind of a technical
domains right and there's an example
that I really love this is a screenshot
from Orbitz so one of these flight
search engines you know you type in you
want to buy a flight somewhere this is a
results page and you can see like just
above the fold there's like two results
there and this is kind of typical and in
the stuff that we build and a lot of
times we don't think about this being a
design process but it's kind of neat
this company out there called Hipmunk
and this is their take on the same the
same page so this is their results page
for a flight search so if you search for
a query you know this is a you know just
showing from Portland to Copenhagen all
different flights that you can get but
they did it in a visual way and so you
can look at it and see what's going on
and answer certain kinds of questions
much more easily than you can in just a
straight-up Texas thing right so in this
you kind of have to scroll up and down
and juggle all of these times and prices
in your head but on here you can kind of
just look at it and get a sense of
what's going on so the actual encoding
they're using here each row on this is a
different flight or you know I guess a
trip I may have multiple flights they're
sorted vertically by the price and then
they're positioned horizontally based on
the time of departure so the earliest
you know the far-left is like early in
the morning and then moving over is
later in the day and it's just great
because you can you can just look at
this and very immediately kind of see
and compare in a way that you can't do
with something like this so yeah we have
nothing to do with this but I just love
using it as an example so so that's
enough of kind of example and so I want
to talk quickly about sort of the how of
data visualization and sort of the
theory what data visualization really is
you know fundamentally all of these
different things is a mapping from some
- there's different visual aesthetics so
you guys are familiar with what data
looks like you know it's like a sequel
table or you know a vector of Maps or
whatever and when I say visual
aesthetics what I mean are there are a
number of different dimensions that we
can use to display quantitative data so
this is just a subset of them this is on
your handout as well but doing things
like saying okay we're going to take
quantitative value and map it to the
length of a line or the width of a line
you know the size of an object the hue
or the intensity of a color these are
all different ways that you can encode
that information and that's what you are
doing when you're making a data graphic
right so a bar chart or a pie chart or
whatever so if you look at something
like the the Hipmunk example here what
they've done is you know they've used a
2d position to map two different
variables right they have time moving
from left to right and then cost going
up and down and a 2d position is a very
good aesthetic it's something that we
can perceive very easily and understand
so if I ask you right what's the
cheapest flight it's very easy to answer
that question visually right because I
said you know it's ordered vertically by
the price so you can just look at the
top and say okay that one's the cheapest
you know and if I say which one is the
flight that leaves the earliest in the
morning you know it's very easy to see
that it's this one kind of down towards
the bottom because that's the one that
starts furthest to the left this isn't
the only encoding they're using here you
can see they've used color to encode the
different carriers so different kinds of
Airlines is the color they've also used
the width of these bars is basically the
duration of the flight and but width is
not something that is as easy for us to
perceive as a position in space so if I
say look at this what is the shortest
flight that you could take it's very
hard to see you know it's not something
that jumps out in the same way that
position is something that we can jump
out and perceive so there's sort of two
lessons to take away from this I'm the
first one as I said is that some
aesthetics are better than others
visually for for encoding quantitative
data so we're much better at seeing
something like 2d position or the length
of an object
objects aligned on a common baseline so
these are you know sort of the the
workhorses of data graphics like a
scatter plot or a bar chart you know
they're using these aesthetics because
they're very good aesthetics there's
things that we can look at and
understand very easily it's very easy to
see you know if you have bars on a
common baseline to see that okay this
one is about you know this one is twice
as long as another one um so those are
kind of the two that you should really
rely on as much as possible and both of
those are better than something like
width so the width of objects that
aren't sharing a common baseline much
harder for us to see and that itself is
much better though than using something
like size so you hear data vis people a
lot of times ragging on pie charts and
that's because pie charts are using the
size of object to encode a quantitative
value but it's actually very hard you
know to see you know how much larger is
this circle than this other circle and
that's something you know if if you're
skeptical about this or if you really
like pie charts what you can do is just
take the labels off and then had people
guess right have people actually try and
assign numbers to it and they will be so
far off you know and that's because
we're not good at seeing that um so
that's the first thing to take away is
that just you know know that some
aesthetics are better than others and
you know there's a lot of research in
this area but if you just kind of use
the rule of thumb if like let's use
position or let's use length like you'll
be pretty good most of the time but
because some aesthetics are better than
others the other thing that you need to
remember is that you should always have
a thesis when you're making a data
graphic right I mean it's no different
than writing an essay or something like
that like fundamentally you're making
this data graphic because you want to
communicate data to someone else right
you're trying to make a point you're
trying to make something clear and so
you need to know what that is
you know so you can choose the
appropriate aesthetic right so I'm going
back to the Hipmunk example for their
flight search you know they say what are
the two most important things when
you're buying a flight well most the
time it's going to be you know the price
of the flight and when it's leaving and
so that's why they mapped those things
to the position because that's like the
best aesthetic that we can use so that's
something just to always remember
because you're people ask me all the
time like what's the best data
visualization and my answer is always
like what are you trying to do like I
don't know you know you have to think
about this and you have to have a thesis
um so so that's enough of the theory now
you guys probably are more interested
maybe in the how now for for the
practice and kind of what's out there
now I'm on the web and just in
programming in general it kind of falls
into two different groups that I think
of the first group of things is what I
like to think of is kind of the
off-the-rack kind of stuff so like a
pile of t-shirts you know you walk into
a store you see something that you like
you put it on you like it you buy it
you're done
okay and so this is something like
Microsoft Excel right you have all these
buttons at the top you have just buttons
for a pie chart or a line chart or
whatever and if you see something that
you like and it fits your data and it
shows what you want to make you you make
it and then you're done you're good to
go right and this is when most people
are familiar with when you make data
graphics this is sort of off the rack
kind of cookie cutter stuff so this is
excel you know adobe illustrator has a
little chart button here's like the meta
slide for my talk because in keynote you
know you can make all these things too
and so that's kind of what most people
are familiar with
now the other extreme is this sort of
bespoke approach right so if you know
exactly what you want and you have super
particular needs you can go and do all
the hard work to make it I really like
this picture because so here's this guy
wearing this plaid suit but the stripes
on the plaid between the breast of the
suit and like the sleeve they like line
up at the seam so he like he really
wanted that okay and he did a lot of
work to make that happen and in the same
way if you have a data graphic and
you've designed it you know exactly what
you want there's a some nice stuff out
there where you can make it so there's
this great project from last year called
d3 by this guy Mike Bostock out of
Stanford who is now at the New York
Times and but the kind of thesis on on
this particular project was like hey the
web is super awesome right like there's
all this great stuff in modern browsers
in terms of vector graphics and CSS and
interaction and all this stuff so this
is actually a JavaScript library now you
can use to make custom data graphics so
it's really neat and if you're going on
their github you know they have this
examples and things like that and they
just have tons and tons of really cool
stuff you know but the problem with
bespoke graphics in the same way the
color of the problem may be with bespoke
clothing is that it's a ton of work
right in the same way like doing it
graphic is a ton of code so this is just
like something that I made for like the
Hipmunk example in closure but you know
you have to have all this code to
generate the markup you have to have all
the CSS you have to do all of this stuff
and so there's kind of these two
extremes right now where you know you
have this general stuff like d3 or just
you know using the canvas or SVG or Java
2d or whatever basically saying you know
give me a blank piece of paper and I'm
gonna draw everything myself and then
the other extreme which is hey here's a
big collection of you know stamps or
cookie cutters and you know you just
pick the one that you want and then it
stamps out your graphic and that's it
and so there are these two extremes
right now and what I'm interested in is
you know is there something that we
could have in the middle right is there
something where we could have something
that's a little more flexible and then
Excel but is not as much work as just
having a crayon in a giant canvas where
you have to draw all the axes yourself
and draw all the guides and do all that
kind of stuff and so not surprisingly
this is going to lead me to the second
part of my talk which is a grammar of
graphics and that phrase maybe sounds a
little silted or strange right you know
this is programming why is it not like a
DSL for graphics or something like that
and the reason is that the grammar of
graphics it was actually a book by this
statistician named Leland Wilkinson that
came out in 1999 so this is kind of a
very thick academic book but his goal he
says in the book actually he says this
is the grammar of graphics there are no
others and this is what you would use to
describe any kind of statistical
graphics so it's actually very kind of
heavyweight and complicated you know and
he uses it to describe just everything
from from maps to bar charts to line
charts to all of these other things that
you know we don't even have names for
and so it's kind of an interesting work
from an academic standpoint but the way
I actually found out about the grammar
of graphics was through this other thing
I'm so in 2005 another statistician and
Hadley Wickham implemented a simplified
version of the grammar of graphics and
as part of his PhD thesis and he
implemented it and embedded it in the r
programming language so I think we've
heard a couple people mention that
already today but this is where I think
a lot of people learned about it and
people actually started using it
so instead of having the cookie cutter
graphics you could actually use the
grammar of graphics and our to build
kind of custom stuff which was really
neat so I'm gonna just give you a quick
a flavor of some of that stuff and to do
that I'm going to show you some graphs
made from this simple data set so this
is a classic data set used in the art
community of just cars right so each row
is a different car and the variables are
things like the fuel efficiency and
miles per gallon and the horsepower of
the engine and the weight of the car and
stuff like that so some of the graphics
this is what they look like actually
coming out of are and this is the actual
art code so you can see instead of
having some sort of function it's like
making me a scatter plot that function
is here's my data here are the
aesthetics I want you to map these
variables against so I want to map the
weight aesthetic to the X dimension and
then the miles per gallon variable to
the Y dimension I know when you use
points to represent that so that's how
you would say make me a scatterplot and
what's cool about this is that you know
it kind of splits apart these different
concerns and you can add additional
aesthetic mappings very easily kind of
in this framework so you can say Oh what
if I want to color these points by the
number of cylinders in the car you can
you can do that pretty easily and you
know the system draws you a legend and
things like that on the side and of
course you know you have other kinds of
geometries so doing things like box
plots and it is an R which is a
statistical language so you can do
things like having a curve fitting and
moving averages and things like that um
the the sort of problem with this is
unfortunately it is written in R which
aside from having this horrific the ugly
logo is also I mean this is what Edmond
said earlier this morning it's kind of
this island right you know R is this
academic language and it's great if you
can get your data and you go in your
corner and you fit your models and
you're sort of playing by yourself and
then you come back with the answer but
so many people now and you know
especially in this this room and in this
community we don't sort of have that
luxury like we're building systems in
production like we have all of our data
is not something we can just spit out to
CSV and then take over in the corner and
look at and so I was sort of think about
this problem and you know no surprise it
would be really nice
we had this in a nicer language that
that more people could use and so I've
been working on implementing the this
grammar enclosure but you know the
important thing is not actually that its
enclosure that's sort of an incidental
detail the important thing is that
closure is on the JVM right so you're
gonna have this library or this service
that is accessible by sort of the
broader community of developers right so
you have all these other languages on
the JVM ecosystem you have the actual
you know nice toys like Hadoop and web
servers and all this kind of stuff um so
that's kind of the goal of this thing
that I'm working on is to take this idea
which is a very interesting idea and
then move it over into a space where
more people can actually use it but I
want to step back before actually start
showing you code examples and things
like that
in the closure grammar of graphics and
try and motivate again sort of why you
would want to do this and you know it's
nice um I gave this talk to a non non
closure group and sort of had to explain
this stuff but here I think you guys
understand many of these ideas but you
know fundamentally the idea here is that
most of the way we make charts and
graphs and all that stuff it's totally
complected right if you have a function
that just says like draw me a
scatterplot this is just this insanely
complected function because like think
about what it's doing like think about
all the different things you have to do
to make a statistical graphic you know
you have to do things like calculate the
extents of all the different scales that
you're using so looking at the data and
the variables and and figuring out how
much room they need you know you're
doing linear scales and log scales you
have to calculate all of these tick
marks you know doing things like curve
fitting or other sorts of statistics and
then once you've done all of that right
you actually have to draw this stuff
right you have to iterate over the data
and draw all of these labels and guides
and this kind of stuff and if you you
just have this function you know that's
draw me a scatter plot and you want to
kind of change these little pieces in
here it's just insanely difficult to do
right I mean in Rich's talk when the
energy says the word complected he has
this example of the knitted castle which
well I think it's hilarious because I
didn't you know it's a knitted castle so
that's pretty funny but it really is
like a good
a good way of thinking about it cuz it's
like if this is the castle that you want
if this is the graphic that you want
great if you want something slightly
different like sorry it's gonna be a ton
of work you're gonna have to
re-implement all these things because
all of this stuff is tied together in
this this one function there in this
cookie cutter sort of thing and so the
idea again with this grammar of graphics
is ultimately you know you want to
decomp lect
all of this stuff now you want to take a
statistical graphic and you want to
break it into the different fundamental
pieces and so if you step back and think
about what those pieces are you know of
course you have your data you have the
geometry that you're using in your
graphic maybe you have more than one
kind of geometry this would be things
like points and lines if you're making a
map right you have polygons and areas
box plots things like that and then you
have your mappings you have mappings
from the dimensions of your data from
your data space into the different
aesthetics of your geometry so these are
the aesthetics that are on the handout
that I mentioned earlier and then of
course you have things like statistics
and groupings so if you're making a
histogram you want to bin the data and
sum it up or maybe do weighted sums
things like that scales all that kind of
stuff so so the idea with the grammar is
to take all of these things and you know
these are orthogonal things and you
should treat them as such and you know
and you should be able to work with them
on this orthogonal level you want to
tease apart all these different concerns
so on this is actually some some example
specifications an output of what the
system does so this is a scatterplot not
too surprising you know just a closure
map you say here's my data here's the
geometry that I want here's the mapping
from my data dimensions to my geometries
aesthetics so you can look at this this
is pretty cool so this is miles per
gallon versus the weight of cars you
know no surprise here there's a negative
correlation heavier cars are less
fuel-efficient um but you can see
there's a little bit of over plotting on
some of these points so they're a little
big so it'd be cool to do something to
say okay let's make the points a little
smaller so these are the system uses tag
literals for doing this so point it's
just you know it's like a just a typed
map basically it's a closure record but
it's nice because you know this when you
want to do these kinds of things when
you want to override the defaults
there's this kind of it makes there's a
natural place to put these things so
just
these things like you what you say I
want to make the point smaller and then
you change this data structure right
there's not some weird flag that you
have to look up or you don't have to
hope that the library author has given
you some some option and then make a
scatter plot function to do this and the
other thing that's cool right is you can
change all of these things and it's all
where thuggin also you can look at this
and say okay you know that's interesting
and what does it look like if we wanted
to look at instead of the weight of cars
you want to look at the cylinders of a
car so that's just a one-line change
right in this aesthetic mapping you want
you don't want to assign the weight to
the X you want to assign the the number
of cylinders and the engine so you can
do that and then immediately you know
some things stand out you say oh it
looks like all of these things are now
falling into just three distinct groups
right so all the cars in this data set
have either four six or eight cylinders
and then once you've done that you can
kind of think oh well you know now maybe
points are no longer the best
representation like I've kind of
discovered this thing about my data but
the point geometry no longer makes the
most sense maybe I want to use something
like box plots and so because all of
these things are split apart it's very
easy to kind of interactively explore
and look around which is very powerful
you know because again comparing to sort
of what's out there now if you wanted to
do this if you wanted to go back and
forth from like points on a scatter plot
to like a box plot like you probably
have to step back like a page of code
because you probably had to Monge all of
your data to some form of like arrays
and arrays so that scatter plot function
can eat it and then if you want to look
at box plots you probably have to step
back and like go find the appropriate
package or whatever and you know munge
the data that way I'm to get it in here
but if you can you know split apart all
that stuff and just do it in this nice
grammar it's very simple to sort of
explore which is which is really
important so one one thing that I do
want to point out and if the astute of
you in the audience may be noting that
this seems very sort of suspiciously
short right because and if you think
about it right the the map beans or the
aesthetic map beans I have x and y but
that doesn't seem like quite quite
enough for a box plot right ok so x and
y is for a point that makes sense but
the box plots they have a lot more
aesthetics right they don't have a
single lie aesthetic they have the
position of the bottom you know the
position of the middle on top of the box
and stuff like that so so stuff is
missing here um the actual full
specification if you kind of D complex
all these things that you would need is
you need something like this right
what's really going on here is that you
need to group the data by cylinder you
want to calculate these quantiles for
that group and then you you actually
want to apply um the results of that
calculation so like the q25 the the
first quartile right you want to do that
on to be the lower part of the box and
all this kind of stuff
um so so you know what's going on here
where you know you can write this to get
this graphic and you know if you show
this graph to someone that they would
kind of say like oh yeah you know this
is sort of colloquially how you you
would say it but in reality or kind of
to be fully explicit you'd have to say
this so how do you sort of reconcile
that because if you have to be this
explicit all the time it kind of sucks
because then doing sort of exploratory
stuff is very hard so so really what you
want is some some sort of way to
recognize this sort of colloquial or
incomplete expression and then turn it
into sort of the full realized
expression that has kind of all the
fiddly bits i'm spelled out you know and
and i was kind of thinking about how how
you go about doing this and you know
looked at how ggplot implemented these
kind of defaults and you know really
what you want is you want like a nice
sort of declarative way to just specify
kind of rules to say like when you see
something like this you know the user
has left this stuff out maybe you should
like rewrite it because they probably
meant this that or the other thing you
know and and it gets really nasty if you
try and put this in just like just
different conditions of the code and
stuff like that right like you if you
want to handle all these different cases
it would be a huge mess of like
if-then-else statements and stuff you
know really what you want is some just
declarative way to specify these rules
and then have the right thing
automatically happened so it would be
really nice if there was some library in
the closure community that could
declaratively do rule-based things
and luckily david wrote that library so
it's called core logic right and I was
so jazzed about this
because I found out about CoreLogic at
the last cons and I sort of I had a
running joke with Paul actually Paul the
grandest about making t-shirts for the
cons this year that said my program
would be way better in CoreLogic and
then on the back it would say if only I
knew how and I would suggest to find
this example of not a logic puzzle and
not a compiler of some kind that I could
actually use core logic but it's worked
out really great because you know you do
this kind of thing so here this is kind
of um you know this is a work in
progress as syntax but you say things
like okay if the specification map if
the person has asked for a box plot and
they haven't provided a statistic they
probably want to use quantiles right you
know you can just put out all these
different rules and you can do actual
unification right so you can move things
around in these maps to turn sort of the
the colloquial stuff into what you
actually need fully specified but at the
same time right I if the user knows
exactly what they're doing and they want
to specify everything out you know they
can still do that so so that's been
really interesting you know same kind of
story with something like a histogram
you know you really like most people
they want to write something like this
they want to say yeah I went bars I want
to use a some statistic and I just want
to look you know what there's one
dimension of the data but you know if
you actually want to do be pedantic
about it you need to write something out
like this right you need to say I want
to bin along this carrot dimension with
this many bins I want to some you know
and this is the actual mapping from the
result of that statistic to the bars so
it's really cool to be able to use
something like core logic to match on
this stuff and do rewrites and so I
definitely want to thank David for that
and also I don't if you guys have seen
Jonas is qubit library which which does
this kind of pattern matching i'm as a
linter for closure code and which is
really where I got this idea so on that
stuff is really cool and you know this
is possible again I'm and this is sort
of a theme so so chris mentioned this in
in his in the first talk and this is a
term i heard from from alan diapered but
to data all the things and this is like
so key and it just it's like I cannot I
could stress this enough it stuff
becomes so much better when you do that
right there's no way I
would have been able to you know do this
kind of CoreLogic pattern-matching stuff
if i had all of my stuff tangled up in
objects with methods and all the stuff
but because all the specifications just
with closure closure maps and records
you know you can plug into all this
stuff and use all this great stuff out
there you know and this is the benefits
of using data I don't stress it too much
in this community because you guys
already know it but you know for me it's
really nice because you know rich talked
about using services and stuff so making
you know makes our lives a lot easier as
a developer if people have to develop
this stuff to support different
languages so this is the closure API and
you know this is the Ruby API this is
the JavaScript or Python API right like
it's all just data like you know it's so
great the other thing that's great about
having data is that you can program
right we're all programmers and that's
what we do you manipulate data and if
you're just upfront about that you know
has a library author and you let people
mess with this stuff then they can solve
their own problems much better than if
you try and shoehorn them into using
whatever methods that you're providing
them and whatever options you're
providing them and nothing else so to
give you an example of that here the
actual workflow in the system as you
start with this specification goes
through a kind of compiler and turns
into this sort of scene graph kind of
thing and then it actually gets rendered
out into SVG or PDF or PNG or whatever
you want um but what's what's cool about
this scene graph thing is you know this
is just another huge data structure
right like this is just a big map though
you know it's got sub maps and vectors
and stuff in it but you can manipulate
it with your own code right so you can
say here's my specification I want to
compile it into the scene graph um and
then you know you can add your own code
into this process you can you know a so
shin and say I want to update you know
the scale here so the y-axis I want it
to go from 0 to 40 instead of whatever
extent you've calculated automatically
from the data or I want to change the
label on stuff like you can do all this
very easily because it's just code right
you know you just look at this thing and
it's very evident if you want to change
the stuff around you can do it so so
that that's really powerful and and you
know I can't again say like it's been so
great to sort of this idea of decomp
letting things like it's very very
powerful to just
look at things and say you know what's
going on here and to say actually you
know there's a lot going on here and if
you can pull apart those separate pieces
you can really get a lot of leverage and
a lot of mileage out of that stuff so
it's nice because you know having this
grammar or having this framework lets
you say a lot of very interesting things
right you know you have if you have a
limited vocabulary and you can only say
something like a scatterplot or a
histogram you're sort of caught you know
only be able to describe those things
but if you can split apart all of these
different concerns and kind of have this
vocabulary you can express certain
things that maybe you weren't able to
express before and you know really more
importantly it lets you think about
stuff I'm in a different way
right so having something like this when
you're actually up front about thinking
about different visual aesthetics you
know thinking about the role of
statistics and all these separate things
you can put them together in just
totally different ways that maybe you
weren't even we're even able to think
about before and so really you know I
think this is not something that is
unique to this particular problem domain
and it's I think a benefit that you get
from from stepping back and trying to
pull things apart into smaller pieces so
um that's all I have um I hope you guys
like it
Thanks
questions so the question was how can we
visualize our functions in our code as
developers and in light of you know
things like like table and bread
Victor's work and things like that
I don't have any I don't have any
particular thoughts that come to mind on
that you know this kind of system - is
right now very focused on sort of more
standard statistical graphics and things
like that I mean yeah I'm not exactly
sure what that what that would look like
so maybe talk to me in a year - yeah
yes the question was have I seen stuff
in the ARP or library about using
functions or formulas and stuff like
that in the lattice graphics package I I
haven't thought about how to sort of
expand it even higher level to kind of
talk about specific problem domains for
stuff I mean then this is kind of the
thing about using stuff with data like
the interface for this is just Maps you
know so and it's accessible from it all
the programming languages basically
because everything has maps so I don't
have any sort of plans to move into that
kind of stuff
but there is a sort of foundation where
you could do that right like you could
have a more domain-specific thing where
you're talking about formula and
specific mathematical things and then
sort of have your programs spit out maps
and things like that to render
oh sure yeah so it was the one thing
that I did that I didn't cover and I can
talk to you more about this little later
but one idea that had Lee Wickham the
author of ggplot had that is implemented
in the system is that the plots
themselves are a kind of geometry so it
handles faceting and things like that so
fascinating is when you take instead of
like multiple subplots so you might want
to say I want to do this miles per
gallon versus weight thing but instead
of coloring the points by the number of
cylinders I want to actually just make
three different plots so I'll make a
plot for a four-cylinder engine six
cylinder and ran a similar engine and
you can actually do that I'm kind of
think as it works recursively yeah yeah
so the question was can you have code um
yeah this is not open source right now
I'm actually it's not totally ready for
public consumption it is actually going
to be a proprietary thing there will be
a probably some kind of free version but
my hand was sort of forced on giving
this talk because one of the other
speakers cancelled and they asked me to
come in and present it so it's not quite
ready yet yeah
I'm said a yeah the question was is
there a limit to the customization of
this stuff yeah definitely I mean this
is never going to be as expressive as
having just a crayon in the scene graph
right or like a blank canvas
you know the idea is kind of to be in
this middle ground where it's going to
be expressive and customizable enough
for most people's needs but you know if
you want to do very custom things you
have a very specific idea of what you
want you probably will still want to use
something like you know d3 or you know
Java 2d or whatever so yeah
I'm so the question was stuff relating
to a closure script I'm in this and yeah
so actually last year at the cons I
talked briefly about some database stuff
and so the d3 library is a JavaScript
library I'm I have a port that works in
closure and closure script called c2 you
know and this system right now it
outputs SVG and stuff and it shouldn't
be too hard to port over to closure
script but the actual you know a lot of
people ask me about interactive graphics
and things like that
and and that's a very hard problem so
it's not something that I've been able
to think about enough to have a
satisfactory answer to I actually am
tend to be very conservative and like
having just well-designed static
graphics over kind of crazy customizable
interactive things but yeah we can talk
more later about closure script stuff if
you want any other questions thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>