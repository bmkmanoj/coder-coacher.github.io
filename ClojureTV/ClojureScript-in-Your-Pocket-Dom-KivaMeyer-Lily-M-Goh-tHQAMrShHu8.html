<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ClojureScript in Your Pocket - Dom Kiva-Meyer, Lily M. Goh | Coder Coacher - Coaching Coders</title><meta content="ClojureScript in Your Pocket - Dom Kiva-Meyer, Lily M. Goh - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ClojureTV/">ClojureTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ClojureScript in Your Pocket - Dom Kiva-Meyer, Lily M. Goh</b></h2><h5 class="post__date">2017-03-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tHQAMrShHu8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning everyone I'm Dom I'm Lily
apparel company who helped company built
web and mobile apps we have been using
react for years and reasonably had the
opportunity to use react native with
closure script was so happy to be here
today to share our experience with you
guys on how we use react native with
versions of it so let's get started so a
client of ours
Sencha provides an ios app for home
organization repair and maintenance they
really needed an Android app so they try
to outsource that to an overseas
consultancy but that consultancy was
unable to deliver what they promised in
the project was scrapped it became our
job to deliver an Android app on a
pretty tight deadline we've had about
six or seven months to replicate an iOS
app that has been almost two years in
the making now with all that said we're
web developers we've worked with kosher
scripting we act for years and we just
want them to make mobile apps so that
was our perspective going into this
project and that is as a context around
this thought because we think that a lot
of web developers would really be
interested in building mobile apps if
they could use familiar tools before
begins let's go through all those and
choosing the technologies back for this
project our plan has a tight deadline
and we want to move fast with the
project so the best environment need to
facilitate fast iteration in order to
move fast we need to leverage our
insurance so other using the technology
that we already know or technology that
we can learn very quickly having one
code base to write and maintain between
iOS and Android is a huge plus cause it
will help us cut down on time and all
that wouldn't matter without Google
users so it's got to be bad and last we
want our app to last for years and grow
and no time to rewrite it so the
technology that we use
to have some really nice future so first
let's take a quick look at Centrex text
that on the back end we have a genomic
data base and a close your web server
there are multiple closure script and
react Web Apps and an iOS Swift app
these different applications talk to the
backend over rest sort of select rest
and some atomic custom syncing stuff and
some are PC stuff and each of the
different apps communicating slightly
different ways so in terms of this
project we our first goal was to create
an android app using react native and
closure script and we wanted to fix a
lot of the data issues that plagued the
iOS app by using a more thorough
solution so we decided to use scratch 12
for the data layer for this the next
step would be to replace the iOS app
with the react native Android app poured
it over and also use that same data
layer that we used for the iOS app and
then eventually we wanted to replace the
rest ish thing entirely with this one
data layer for the entire thing now
before we go into our experience you
know actually using these technologies
for this project we should give a brief
overview of what they are what is react
native before react native most mobile
apps were one of two types first is
native apps so that is something like
Java objective-c or Swift the problem
with that for us as web developers it
has a really high barrier to entry we
have to learn new languages new tools
new API etc and it's also not
cross-platform the second type is
webview app so that is something like
Cordova it's basically a web app in
native wrapper the problem is that it
doesn't feel native because it doesn't
render a native UI components it's also
slow primarily because JavaScript
renders the UI and run
uploading on a single thread react
native is a hybrid between that with
react native UI renders using native
components so that absolutely needed and
because the UI render on a different but
then your app logic its fact you can
write in jail and just work on both iOS
and Android so you have one code based
maintained with react native you can do
anything that any native app can do
either through make a react native
edgewise or you can write native bridge
to interact with a native API
functionality yourself
this makes react native a very
comparable choice on the left here we
have a react native code within in
JavaScript and on the right is how a
render in the iOS simulator if you are
familiar with react you can see here
that react native look pretty similar to
react
the only noticeably difference here is
that in react native you have view which
is something like a div in fact we hope
that which we act to satisfy many of our
goals react native should make it easy
for our students that we should be able
to bypass Apple and Google approval with
instant updates with the make all dj's
changes this also leverage our team
trend because we already use react on
the front-end web so we're hoping that
the team would learn redecorated pretty
quickly we hoped would react native a
lot of code could be shared between
platforms and because it is backed by
Facebook and not only used in production
by Facebook but also Airbnb or Mont
Tesla and many others we believe that
it's going to follow the same adoption
rate as we act and have a really bright
diffusion if you have used react before
you probably know that all the surface
react looks very uptick arrangement
faithful but underneath it's very
functional and for that reason culture
script and react work really well
together this is the same react native
code written enclosure script with
reagent as you can see it's much shorter
and it's way better to look at we
already knew that kosher scripts this
experience is better than JavaScript but
we also hope that the benefit without
way at the time that we have to spend in
setting up the project to work with
closure script how team is already using
soldier and culture script so this
should help us with all the things well
we are also using something called Expo
for react native I was formerly known as
exponent and it's sort of a lot of
different things under the same names
it's difficult to define so we'll just
talk about some of the things that it
does so it helps provide a lot of common
functionality or iOS and Android like
push notifications native Maps social
sonication
very useful things expose also provides
a GUI and CLI that obviate the need for
Xcode or Android studio so if you have a
Linux developer on your team like we do
and they want to work on the iOS app
they should be able to do that with this
there's also an expo app for iOS and for
Android that should make sharing
development bills as easy as sharing a
URL x-bow also provides hosted
infrastructure for instant deployments
of nonbinary changes so we hope we could
use this to push bug fixes directly to
users without going through Google or
Apple approval in essence we chose these
expo because we felt like it could bring
hopefully the best parts of web
development to mobile development now
our expectations with this was that it
would help us with our fast iteration
goal we wanted to use the instant
deployment feature in terms of getting
things out quickly to users and we also
want to be to use the expo app to take
QA with
the project a lot easier we're also
hoping that it'll help with code sharing
a lot in terms of porting over to iOS by
providing a lot of common functionality
we also use graft well gravel is a query
language for API it's not a
specification but it's altered or a site
is a specification for alternative to
rest or similar things like that it's
not a binary form it's not everything
but if you are sending structured JSON
or ebn it fits into the same nation
let's look at a brief example in this
case we have a graphical server on the
left hand side that's defining a schema
and makes it available to clients so
clients can be mobile apps web apps
other servers whatever in this schema we
have one type a user user has an ID name
email and Friends ban means not knowable
and brackets mean a list so in this case
a user has a list of friends that list
can have zero friends or any number of
friends but none of the friends can be
known next a client will send a request
this particular request is a query and
we're asking for me the current user
asking for my email address and the
names of my friends and then the server
will send a response with the correct
data based on the request so as you can
see here only requested fields are
returned
there's no IDs for your friends or
anything that you didn't specifically
ask for also notes the shape of the data
returned is in the same shape as the
query that you issued so it should be
very easy to understand what you're
going to get back and though we won't do
it right now you could modify this query
to nest you know friends of friends and
friends of friends of friends and
whatever you want arbitrarily to
hopefully batch stuff into a single
query so we hope the graph QL would help
us with our iteration speed by allowing
us to delegate a lot of the data
management on the client side to a
library and also allowing the client to
develop semi independently of the
backend
if the backend can provide a full fledge
schema then the client should be able to
pick and choose what's useful we also
hope that it would help with performance
a lot in terms of the mobile app by
eliminating over fetching and by
allowing the client to consolidate a lot
of different requests into a single
single graph request last we're really
really hoping that the ecosystem would
be helpful it's you know graph school is
graded by Facebook also used by them
obviously if I get hub Pinterest Intuit
and many others so we really hope that
the ecosystem around this would be
beneficial for us and we also thought
that it would grow at a pretty steady
clip now that you guys know what each
technology is let's put this into
perspective we have here a react
community which is not a pretty big
community and a success with a little
bit of disjoint of reactive react native
we have gradual community there are
people who you think are with or without
the act and it's all community it's even
a smaller subset of react community at
last we have our lovely Georgia Script
community can you see where we are
we're right here our community is so
small we thought that this project would
be cutting edge for the most part it was
they are seeing the Turner to be
bleeding edge and we got cut that's what
we here today to share with you the
experience that we have learned the hard
way first let's start with something
nice transitioning from react to react
native was a little easy if you already
know react you are going to learn react
native very quickly and because we act
and react native are conceptually
similar react native and evolve your web
developers can become mobile developers
this is a great technology choice from
the business perspective as well
especially in a small startup where you
might have to sort constraints in a big
organization this could enable knowledge
sharing between teams and enhanced cross
team collaboration react and react
native all fundamentally similar in
concept but in practice there are tons
of differences first you are dealing
with a different JavaScript environment
it's not browser or not like what you
might be used to
as a consequence some JavaScript
libraries that work on both nodes and
browsers like AWS SDK for example just
don't work on react native this causes
uncertainty in what you can do or what
you cannot do because the knowledge or
assumption that you bring in as a web
developer may not apply to react native
things that you have learned to work
well on web or on the node environment
may not be the one that's work well on
react native from a broader perspective
user interactions are also different on
this subject you have hover click on
mobile that is pressed swipe etc unless
up the part of interaction is crucial so
it is pretty small and the user can be
exact on where the interaction happens
on mobile that is
fingertip so touchable you eyes need to
be a lot bigger and need to keep instant
feedback a purple small screen and
different screen sizes mobile also have
dynamic viewport as well for example on
this code we don't need to think about
keyboard at all on mobile where the
users are typing keyboard can take up to
40% of the screen that becomes the
problem you also have portrait and
landscape view to consider as well as a
good web designer will need to shift
their thinking to account for mobile a
good web developer who also need to
shift their thinking on mobile to a
calculus instance in user interaction
styling in react native is surprisingly
a high learning curve and I'm saying
surprisingly for my personal view
because I am a CSS nerd react native
doesn't have CSS you need to file things
with JavaScript object and it's top it
doesn't ask it maybe you're used to
doing something like them that's no
longer work there is no global styling
you need to file things in a reactive
way via in lifestyle there are no
classes there are no ID for something
like bootstrap cannot exist in react
native because there no global style
there are several attempts in making
fouling in react native more like CSS
which gives you an illusion that your
familiarity with CSS is transferable but
in the end you are dealing with a
different environment and you shouldn't
let that fool you having access to a
programming language mm it's a really
powerful thing it's open a possibility
of filing that you can easily do before
in a non programming language like the
other plus it's better to thoughtfully
choose inherit only the
that you want and not let it be big
tears I see SSN you in AK five or ten
years ago being a front-end web
developer event you need to know HTML
CSS yes and maybe jQuery x1 then the F
Scott more complex and became single
page applications the logic you know the
programming and filings were split into
two jobs as a company considering using
react native you are going to have to
think about how it's going to change
your Team Dynamics UI component should
be compostable and reusable in react
components can be composable without
filing because you can easily do it
afterward with CSS in react native
though components need to come with
styling because there is no C endless
you cannot do that outward programming
and filings are much more intertwined in
CSS or in react native than they are in
reactor for example to see if the
keyboard is active or to get the height
of the keyboard to adjust the style you
need to use a react native event
listener also Android and iOS came with
their own default files you may want to
conditionally adjust that based on
platforms and that requires programming
so programming and filings are
unavoidably intertwine in react native
on the pro side you have a more sane API
to deal with in via native then CSS
remember the nightmares you have to do
vertical align in CSS that is what our
problem is create native
but at least it still works the same on
iOS and Android right we were led to
believe or maybe we let ourselves to
believe that if these react native and
we use that info and we only use
components that work on both platforms
and we only use functions an API is that
work on both platforms it will all work
on both platforms right we were wrong
we had a working react native Android
app so we wanted to try it on iOS so I
opened it in an iOS simulator that's not
a great start it looks like a validation
error but it doesn't look like a
platform specific validation error and
I'm not even doing that
so anyway okay I googled it well there
was one result really help
okay I'll fix that problem so once I fix
that for a screen we try open up again
on the left here is our working version
on Android and on the right
stylus I don't know how the circle
became diamonds and you can tell here
but none of the buttons work on top of
that we have the middle panel here which
is collapsible it was fine on Android
that is how it look on iOS it was
apparent to after the differences
between platforms are more than browsers
and we are sure that these aren't all
the issues so when you're getting into
react native you have to be ready to
debug things like this things that
aren't easily colorable like how do you
Google things like this but if you have
been used in culture for several years
you probably stumbles on first-time
errors as well but those are becoming
less frequent over time as a community
girl so we believe that it's going to be
the same for react native react native
with expo also has some notable
limitations I think it's important to
discuss them to really understand the
trade-offs about it before you choose to
use or not use it with your react native
app the root of the problem is that
react native itself is incomplete there
are tons of native ios and android api s
and UI and your components that are not
yet wrapped with javascript and made
accessible in react native now the plus
side is that react native is extensible
to add native functionality to react
native you have to either know both tool
chains and no react native well enough
to write a native bridge to do that or
you can use a library from someone who
already knew all that
EXO provides a lot of this functionality
for you they provide a lot of native
bridges and those bridges go a long way
in bridging the gap but to take full
advantage of
though the only native code in your
project has to be from Expo and from
react native that means that most of the
high-quality react native libraries out
there are off the table if you want to
stay entirely within the expo ecosystem
so by doing this we lost access to a
good video players a camera component
good video Pitt or any video picker
really any document picker file system
utilities like lots of things that we
either need eventually or would be
useful and we've been told that a lot of
these will be provided by Expo in the
near future and we really hope that they
are but if but if that doesn't happen
within a timeline that works for our
client then we have to eject from Expo
and lose many of the benefits provided
by it now all this is not to say that
you shouldn't use Expo using Expos are
trade offs and for many apps it's
probably a great trade off however as it
currently stands the more mobile
specific functionality that you need for
your application the more difficult it
becomes to stay within that sort of
walled garden and not require additional
native code so expo may not be a good
choice for every office you know a
case-by-case basis so determine it based
on your requirements
so you might wonder what our deaf
experience is like using react native it
close to script so let me give you a
little demo on that on the left here
they have our react native closure
script code and on the right is the iOS
simulator as you can see we're able to
use big-wheel the same way as you would
with some there was web development but
it's not all that would be parted to
working with the client I had set up a
side project with react native and
JavaScript it took me a few minutes to
get the project up and running with
culture script
it took us who full days two full days
of trial and errors as we put in the
Venn diagram the combination of react
native and Expo itself was small and
together would react with culture script
it's even smaller the tooling was
premature and we ended up spending time
debugging to make it work with culture
script but in the end were glad we went
with it and didn't give up we were able
to move fast
once we got it working and understood
the sharp edges
we also we learned some lessons from
using graphed well in this noble project
now previously we had both used graph QL
with a closure script web app with a
rails back-end the neither of us had
used graphs well with a react native app
or with a closure back-end so in terms
of discussing this I think there are
three important topics there's how is it
to use as a developer how's the tooling
around it what is it like for the mobile
client to use and what is it like to
implement a graph 12 server first
tooling so because graphs well is typed
and introspect able to lling is
incredibly good for such a young
technology so look if you look at a few
examples this is called graph QL
Voyageur it's open source and it
produces interactive graphs of graphical
schemas that you can sort of explore
this specifically is github API now
because graphs well is a specification
this tool will work on any graph dwell
API you don't have to modify your API in
any way to use this this is called
graphical this is another open source
tool this one was created by Facebook in
this video we're accessing github the
API you can see documentation on the
right column at our query on the
left-hand column and the result of
running that query in the middle again
because gracioso specification this tool
will work with any graph 12 API it's
incredibly easy to use for rest
something like swagger is probably the
high point in attractivity and
documentation and as you can see
graphical tools provide so much more
leverage than rest tools can so lesson
learned for us with this was that the
gradual tooling ecosystem is really
incredible and really helped us with our
development speed now probably the most
important thing is what is it like for
the mobile client mobile clients are
very constrained they are a compute
constrained memory constrained and
network constrain and graft well helps
us deal with memory constraints by
eliminating over fetching we don't have
to pull all this extraneous data that we
don't actually need into memory
it also helps a lot with network
constraints probably the most important
constraint of these and that allows us
to consolidate a lot of what would take
many rest requests into one graph twelve
requests mobile clients are also very
complicated and as Lilly has said like
platform differences between iOS and
Android OS version differences screen
dimensions dynamic things like the
keyboard these make developing a mobile
application react native even more
complicated than developing a react web
application and because of this graph
dwell is even more helpful in terms of
using a good client because it allows us
to simplify a lot of the client code so
to explain how graphs URL does this or a
graphical client does this I'd like to
relate the to react so without react you
have something like this where you
manually have to update the UI now
fundamentally what react does is it
solves the problem of changing your UI
from whatever it currently looks like to
whatever you want it to look like you
don't need to like remember what changed
and figure out how to change it or that
that whole problem disappears a good
graphical client like relay or Apollo
will solve a similar problem but for
data it will solve consolidating many
requests into one duplicating data
notifying listeners of novelty updates
including optimistic mutations now with
rest you might like request a resource
and then request and many related
resources and then probably check
permissions on all those to see what you
can display or what you should display
to users also obviously you're going to
want because each of these are separate
requests you need to check for failures
and retry with probably some sort of
exponential back-off and like eventual
cutoff and update local stores and
notify whatever care is about it like
it's crazy and this craziness is
completely solved with using graphs QL
and a good graphical client library and
when you combine this with react it's
awesome
what happens is you get components that
are either loading and have none of the
data that they need are loaded and have
all the data that they need or there are
they're in an error state where there
was a network failure or a server
failure or something like that and you
choose whether to retry or display an
error or whatever in that case so it's
it's really difficult to overstate just
how much client complexity we avoided by
using this is definitely a huge win for
us so perhaps well makes the client
simpler what does it do for the server
in general a graphical server is going
to be more complex than a rest server
now this does not apply if you already
have a fairly complex data layer then
graphical is not going to add any
complexity but if you have a server a
rest server which is essentially just
like a minimal wrapper over a database
schema where you're serving tables then
this will add some complexity like there
has to be logic for connecting and
understanding data and in the rest case
that complexity resides with the client
because the client has to connect and
understand that data but in the graphs
well case the server understands
connecting and understanding this data
and therefore that complexity is just
moved back to the server so this may
sound like a bad thing but I would posit
that it's actually a very good thing
because remember that we have clients
that are very constrained network
memories compute constraints and most
importantly those constraints are
inconsistent and out of our control
so on the other hand our servers way
less constrained and constraints are
mostly in our control and mostly
consistent now this is a case of
irreducible complexity it's not
incidental like it has to exist
somewhere and in the case of having
exists far away from the user in this
like in this case it doesn't harm the
user so we can locate it in our control
and not harm the user it's a wig
there's all
so incidental complexity the graphical
ads unfortunately so for example you
will probably be serving a graph through
all API from a single endpoint and
because of that you can't use something
like HTTP caching you'll have to have a
more sophisticated caching layer but
overall it's still I think a huge one
now this was our first time letting a
graph QL server in closure and
unfortunately the ecosystem at the time
wasn't that great crash well clj does
not implement large parts of the
graphical specification unfortunately
and we couldn't use it actual Java is
mostly complete but it's buggy it's like
very very Java ultimately we did end up
wrapping graphical Java with closure but
it wasn't too fun Walmart also released
a a library called licinia recently we
can't use this yet it's missing some
important futures frauds like async and
concurrent queries but those are in the
works and overall looks really good and
we're excited about licinia this was
also the first time we used atomic with
graphs well and it actually worked
really well in a graphical server you
ideally you can do incremental data
fetching and caching and Atomics entity
API makes incremental data fetching and
caching really really easy so in
comparison that something like this with
sequel is is like much more difficult to
do so in conclusion in terms of the
grass Chujo stuff we reached out outside
of the closure enclosure script
ecosystem we use graphical Java Apollo
client it wasn't particularly fun but it
wasn't too bad either so really like
don't be afraid of utilizing these huge
ecosystems that closure and closure
script are built to Interop with very
easily we also think that fresco is
really awesome and we as closure Ian's
would really benefit from embracing this
emerging standard to a greater degree so
if you're deciding on data syncing
techniques for your app I would
definitely urge you to evaluate graphs
well for your needs
also I created a graphical channel
enclosure in slack so if
you if we if I pick their interest
please do join and discuss because the
combination of react native Expo graph
QL and closure script was very mean the
tooling route it was premature we ended
up working outside of closer and closer
script ecosystem and wrote wrapper for
J's and Java libraries ourselves and
it's going fine so we would love to see
closure community embrace react native
and graft well more also transitioning
from the web to mobile wasn't that
difficult most heavy lifting part has
already been done by recognizes we
thought that the react native for
Android alone would take a six month
government but we're able to deliver a
feature complete Android and iOS app in
three months this is a very powerful
combination of technology but with no a
lot of sharp edges but as long as you
can deal and learn to work with the
sharp edges is totally worthwhile
overall we're very happy if you're pure
to learn more about using closure script
with react native we have a block code
coming up on how of my friend calm and
thank you very much and we'll be graph
equation</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>