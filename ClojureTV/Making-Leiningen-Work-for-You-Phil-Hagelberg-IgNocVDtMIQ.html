<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Making Leiningen Work for You - Phil Hagelberg | Coder Coacher - Coaching Coders</title><meta content="Making Leiningen Work for You - Phil Hagelberg - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/ClojureTV/">ClojureTV</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Making Leiningen Work for You - Phil Hagelberg</b></h2><h5 class="post__date">2012-12-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IgNocVDtMIQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">let's get started so I'm sure many of
you have free bottom line again covering
this line again is a build tool with
similar aspirations we haven't had any
documented cases of air getting set on
fire so I think it's been very
successful matter guard so far the
project started about a year ago how to
release a couple weeks almost couple
weeks later so it's it's very active
over 50 tributes and 20,000 downloads
since January we moved to github where
they where they cut the Downloads so
around July when I measured it was used
by about 70% of the source closure
projects in viña so yeah and I know most
of you are probably pretty familiar with
this but I'm just gonna go through the
basics of you know bread and butter of
line again how it works
so the Eleni new command just spits out
any project for you to work with have a
skeleton the blanks
so there you go it's got project
unskilled a finals where you configure
your projects with just all kinds of
things in there we'll cover that and
then the source and the test files it
there for you the standard layout
Wooper rebel faction and this is going
to notice that there aren't any this
notices that no this is a fresh project
it doesn't have anything in the Lib
directory which is we're on the
defensive end that's been gone fetch
that before you launch a rebel the
rebels got a socket server running so
you can background that and use telnet
to connect to it from you know various
shells nice to just keep that up there
in the background
etc that works
from the test the new tests with that
skeleton was after failing tests so a
little incentive to fill that in there
say this is what project that's the old
it looks like you see you know give the
name of the version and the dependencies
are in there there's two kinds of
dependencies errs the regular
dependencies so projects that depend on
your project will pull in those
dependencies that that dependencies are
just meant for you to use while they're
working on the project itself so and
then so those dependencies landing it's
gonna look on maven central which is
where you plant a lot of your java
libraries it's going to look on the
closure build server so you can pull
them like the latest snapshot that was
just built half an hour ago
and today with on close hours which is a
community closure repository so more
about that later but a lot of projects
you're gonna want to add your own
repositories slap that in there for your
your secret password protected so close
jars is like I said the community
repository comes ahead step closer watch
it around the same time like it did and
there's kind of a synergy going on there
where you know my name is one more
useful because of closed doors because
you can if you've got your library and
push it up out there other people can
use it they just copy and paste a little
snippet it gives you in their into their
project I still day on the planet so
using line of even flow jars is pretty
easy you you call the jar task and a
palm task palm spits out a plum attic
smells like a maven speak for describing
your project and then once you have an
account in closed hours and you have
your
h-huh Kiev there SCP can keep it up
there as soon as that's done that's
available for other people to depend on
so super very low or had no you know no
administrative getting across recruit or
anything so I think that's really
important this this stage enclosure is
it's just a lot of for an explosion of
libraries to get out there and be useful
next I'll be covering some of the more
advanced features things not maybe not
everyone knows about and I don't think
most people know about this because it's
new in one point four which is
unreleased it's like the next version
should be should be out in maybe a
couple weeks so the idea here is when
you write your dev test you can you can
touch metadata and in this example it's
assumed that we've got some def test
with integration metadata integrations
that's a true the metadata so the test
selectors there's a map of keywords to
predicates so the credit can be any kind
of function keyword or you know FN
literal or whatever so the idea here is
you use the metadata to kind of tag your
functions and then you can say I want to
run this subset of functions not
necessarily just everything in this
namespace but across all the namespaces
which which functions have this thing
the data size true so we use that at
work a lot for integration tests well
this was written to intent to support
that functionality because we needed a
better way of segregating average tests
so this these kind of tests are really
slow we all run all the time but there's
still being important to run unlike the
continuous integration server so this
gives you an ad hoc way
just classifying your tests varies also
recently although this is in 1 by 3 we
have a data support for user plugins so
you noticed a sample project sale Jane
there's dependency on the spine closure
so everyone who uses Emacs once that in
there because it makes a lot more useful
but not everyone on the project uses he
makes so why should they have to pull in
this this dependency that they have been
used so now if you just simulate that
jar into your home line plenty of
drinking dens available across all your
your projects so it's very useful and
this is the main assembling things kind
of ok that's going to go away and one
before it'll be handled automatically so
now the cool thing
check out dependencies so this is great
for when you're hacking two projects
internally you've got maybe you've got a
project that depends on reading and you
want to add a feature during so normally
you would have to go in and say like ok
I have I've added this function into
ring I'm going to rings project and do a
line install and go back to my project
I'm gonna do lined apps restart my swing
server and then many functions gonna be
there oh I got it climbed slightly wrong
I'm gonna have to go back to do that
again you know the next so what we can
do with Lanigan now you can just create
a checkouts directory in your project
and similar in the radians are there and
then when Lamia calculates your projects
class path that's going to include rings
source directory and resources directory
on there so changes technically been
stuff that helps quite a bit for that
you know two projects in parallel all
situations so this is kind of like multi
module builds because I'm just totally
ad hoc in often so you don't have to
just declare upfront like this is the
structure of my projects this depends on
so in maybe once monthly bills it's
quite hierarchical top-down
this is bad luck often some of the
people on your team are going to be
using ring and hacking on that some of
the people aren't so why should they
that complexity to them question yes
this is so the question was how does
this interact quit declaring the
dependency in fact you got subject you
still want to depend to declare your
dependency in project got sealed and if
you're doing this because it's opt-in
like if you you know if you have this in
your check out of your project you know
your co-workers not going to have it so
if the dependencies nonetheless you got
still day they're gonna miss out the
retired so this is kind of overlaid on
top of that question
so another thing this is this is a
little more experimental so if you've
worked in closer and under UNIX
background you will notice that I guess
it's not just clear but jvm languages in
general are not terribly annex friendly
in terms of just command-line
interaction in general like the the Java
command line option the command line
launcher that feels like someone wrote
it in it was seven there are 97 and
totally doesn't actually sense
generously
so this is an attempt to well some part
of that is we can do anything about Java
is slow to start up the Jew name is slow
to start out and that's just we're gonna
have to wait for it groans from an off
my teen gohan team love you guys some of
its cultural and I think we can work
around some of that so now line again
will allow projects to specify that they
come with shell routers which means when
you install them they'll place the laser
shell script in home that line such bin
and so you put that on your calf and
then suddenly you've got swine closure
available as a command line as a command
line executable and you don't have to
construct your job - CPD that's
customizable you can say in a project
that some day you can say shell wrapper
true and it'll just give you the default
shell wrapper but if you want to add
some more functionality to that maybe
support some work environment variables
or something that you can you can
specify a bin that you want to do be the
shell wrapper and you just by spectrum
remain in there as well so the uses
formats just I don't know how this is
going to be used it might just be that
that doesn't go anywhere but I think
there's recruitment with command line
and it goes
commander interaction and closure and I
hope this can accommodate so tasks
take arguments perform side effects
return nineties so naturally they
represented assumptions this is kind of
just a general pattern you see and
closure to ask yourself thought okay how
should who be represented an answer you
know 90 percent of the time is so
variant of literally - function function
function function so being functions you
can leverage memorization composability
everyone knows how functions work
they're great and we'll talk a little
more about that another thing to note so
projects some projects run in the
context sorry some tasks run in the
context of a project most tasks but
there's some that run anywhere like the
new project the new task obviously their
camera inside the project health can run
anywhere so lining it can actually look
at the art lists of your defin and say
oh this guy's expecting and arguing
named project so he must be this must
expect to be run inside the appendix or
project in a little freaked out if you
try to do it so that's just a little
taste of like you know the way you can
leverage does everything in function
this is probably the trickiest thing
about raiding Lanigan plugins our tasks
is that it's really important to
separate out to force of process
separation between your code and line
against code between your projects code
and line mates code so line against
using closure 1.3 right now and
obviously most projects are not gonna be
jumping on that right away
so it's really important that that you
have a separate process space for that
our class class loaders days for that so
I need implements that with evaluate
which is a lot like eval except it takes
a project ardena first and then launches
some process of course it off and it
performs the eval inside there and
parking that over psych eval it's gonna
take its gonna take a form you can use
back clothing and little tricky to
remember anytime something runs in the
context of your project it's kinda guys
are here but it does provide serious
madness
some tasks can be expended using this
library called Robert Hooke Robert Hooke
yeah irony morning fund accepted
literary characters and Robert cook
while he was you know historical
character is also a character in liberal
psycho so let me just do this here
Robert look is a general mechanism for
extending functions of
what's going on here is we're creating
two defens called spacing and a bigot
and they take a function as the first
argument and then next string is our
second argument and so you get this T
function and you're gonna happiness
hooks onto brendlin so that is done and
covers with some older barking magic it
prepares the large to be hunting
conscious on these these rapper
functions there and composes them so
when you actually call penguin what it's
doing is it's calling a chain that's
composed of spacing and bigan and the
original print line so this is you kind
of steal some of the spectrum if you're
familiar with closure accesses pictures
my business is very similar to that but
you see that recall finland the output
you get is so that the string fubar is x
and it gets passed through in space and
it gets the spaces in which are closed
and then in a big in against uppercase
in that banner comes out so you can do
all kinds of things with robert a common
thing to do is to set up your own
bindings a test selector to implement in
this way so it reminds internal closure
not testing which is picky but used to
grant effects with
flexibility test selectors you can just
decide not to continue you can just
never call math conditionally based on
the arguments or
you can modify the arguments as they go
in you can add your own side effects you
can return a different value
donghae's and so with Robert Hooke
you're taking control of the function
and do your own things so when you're
using this of Lanigan normally you apply
those two tasks although it's also come
into a pile exceed our project as well
as you need to and insert your own setup
around everything that's going to be
found inside the project so as an
example the Java C task for compiling
Java code in a mixed mixed project
it used to be implemented as a plugin in
snap front lining but when it was a
plug-in you can write a hook to ensure
that before you compile you know you did
they ot compilation and the closure code
the Java C compilation area first so
that's kind of a standard usage of the
basic side effects the fourth point
there but if you're gonna do a function
this is really general it's not part of
lining and it's its own dependency so
you can you can pull it in without but
things can get pretty crazy if you do
this much so anytime you have a function
that you control you should not look it
you should make the function more
flexible or I know how to do what you
want it to do so this is for taking
control of functions that you wouldn't
otherwise be able to do this so it's
very important also to accept the same
ranges of arguments
this is actually something that the
example that showed he was really
terrible at if you go here you're
applying rapper to print 'ln but hey
genius crinoline doesn't take just a
single arm and it doesn't even require
that it's argument is a string so these
are these are awful examples you know in
terms of the terms of what's decent to
do it's more of an example of what's
possible so generally you wanted want to
be sure to take marks and you want to
apply F to your arcs rather than just
calling it like this just for
flexibility in case you're the function
you're cooking changes area T's in the
future or you know I mean well
adds an additional something and final
copy multi methods wraps the def multi
in a function so if you try to do a
definite it on top of that later it's
going to be like that's not even the
most effective what are you trying to do
so don't do that I'll do it if you know
anyway composability issues that and
this doesn't work with macros related
well they might be able probably so
that's extending tasks and so one of the
things I've had to do is make it very
very clear that you know there's no
distinction between tasks and sidelines
again and tasks outside Lanigan and if
you want to add your own tasks it's its
first class there's it's basically
indistinguishable if that's if you still
need to touch built-in women
they're lighting in is the most
contributed to closure project over 15
tributes here's a little emo of awesome
commits coming in so I'd like to talk a
little bit about how that works I think
what can you do to make your project
easy to contribute that's the I think
that's it's a really important goal to
having right so with lying again the
biggest thing that we just started doing
recently now is every time you release
comes out we try to have these low
hanging fruit threads on the mailing
list so it you know if they're lurkers
on the mailing list people who are
wondering you know how does this project
work yeah maybe I can blow it just kind
of you you throw out a few bug fixes you
know things that anyone could just dive
in and understand without you know you
want you want to have a roadmap with the
big the big features but you really want
to make it explicit that oh these these
little things here are great for the
great place to step in so low hanging
fruit is a big a big thing
then documentation so it's important to
have you know user level documentation
that that's you know if you don't have
any users you never gonna have people to
get to the point being contributors but
you want to go beyond that this is
actually something that I mean it's not
very good right now
I can only recently got more than 100
lines of code sorry thousand lines a
good long so I put off this or a lot
means neither hacking back as I don't
want a lot did get tripped up by Yvonne
project and just the general flow of the
project you know again how you resolve
tasks kind of environments that things
like that so that's that's really
important for people all wanting to dive
in and you really want to accept patches
probably your attitude you take towards
patches really reflects how people think
you care about contributors to your
project so this is something that I'm
actually not very good at among other
projects but I try because like I really
care about lying again I try to be
really accomplished with the finding
maybe some of the other ones my pleasure
you know sorry guys I I love you but on
the ball there but people really your
endgame I can treat contributors really
really comes across is and closely
related to that is I get forcing people
so the Rubinius project is an
experimental small effects style virtual
machine for Rudy and they have a policy
that if you get a patch applied or
exactly to be submitted passionates
that's accepted then you can ask for
commit rights and I'll just get into you
so that's kind of some people call me
crazy but talk to having the maintainer
and you said you know I've had problems
with this I've had to come in I've had
to revert less than ten commits in a
whole three or four here like this
project so the lesson there is if you
trust people and you know if you don't
like responsible adults though
and sometimes people don't want commit
rights and that's by doing and that's
just people being straightforward about
you know they don't trust me but people
people tend to respect that if you if
you should have my respect so oh one of
the things that makes people want to
stickers if you have contributed to
light again it's come talk to me let's
take a break if you've written a plug-in
I think that counts too if you'd like a
sticker and we can talk about not
hanging free sisters so I guess they
couldn't talk about the community
without talking about plugins so I
talked about writing tasks and extending
tasks plugins are either tasks or hooks
that are separate projects that you can
depend on this those dependencies bring
that kind of stuff so here's just a
little smattering of some of my
favorites my multi is really cool the
cool thing about it is I just kind of
asked that down on the mailing this next
hey wouldn't the greatest this plan
existed and then someone came along even
like a week later was like oh so what it
does is it line the multi lets you
define parallel sets of dependencies so
see if you want to make sure your
project works with clover 1.1 1.2 and
1.3 you know that'd be kind of a pain in
the neck but this this lets you say okay
I have this set of dependencies so say
your project depends on another project
that has different versions like they
have a backwards compatibility version
for closure one fine line and and you
know a stable version for closure with
my two like that and it snaps on the
reciprocal is 1 3 and this line
multi-point lets you bundle all those
together I mean that this is like my way
to reset or my to spend on one set and
you just say well TV tests and they will
run the tests over all of those at once
so very handy especially now that you
know we're getting to the line if test
is also quite handy so the idea is
you've got your clutter diet tests tests
that maybe you're doing that is equal on
a seat and it's got 10 things in it one
you expecting 10 things and you've got
11 here tonight you're looking through
there they're trying to figure out which
part is different so this actually puts
the output in like a diff much easier to
read so it's hard to explain so I'll
just show you there
you can see the plus/minus they are
what's different in that in the actual
versus expected
oh good bad against it is something that
we hooked up at the little enclosure
meaning we're at against doesn't is it
you give it a name space to instrument
and it goes through and there are magic
to flip a bit when it's called and then
so instruments the namespaces you want
instrument that runs the tests and it's
able to tell you these functions didn't
get calls during the test runs so that's
great for test coverage it's also good
for kind of shaking out so you've gotten
your space for you accumulates and craft
you're not sure if all the functions are
still needed anymore you can you can
instrument and disco band so handy
hasn't seen a lot of uses it's pretty
primitive but it's an amazing way to do
and 25 months with ultra bar
lannigan warrant is a good web apps line
deploy I had that war file it's great
for just bundling that up then they can
easy to plug into the web servers and
there's one wiki two different options
there I do find your all kinds of stuff
a little bit about what's next for
lighting it sounds like just about the
one way for release that's coming up big
thing there's test selectors and plenty
of consolidations so there's been quite
a few because of plugins tests for
plugins our first class I'm able to just
tell people if you've got this idea
let's let it evolve in a plugin first
and let it mature and then and then
scoop it up once once it's stabilized so
we're doing there with the Java C tasks
search ass run task another one in there
so the great just kind of expanding the
core yes okay so maven just has at least
a main three and lineman's based on
maven and kind of roundabout way it uses
there's a library call making an tasks
that kind of exposes the minimal API
needed for useful dependency interaction
anything uses that it's a little hairy
to go throw these layers so it made us
we makes fun out there the puss berry
handling into is a library so me them
the good part stick
another thing we're going to be thinking
a lot more about it is an explicit
public API and this is something you
really want to think about before you
think you need it because by the time
you realizing it it's too late we've had
a few issues with plugins breaking
because there's just been kind of been a
really clear delineation between a
public API and what's okay what's an
internal implementation so I use smite
closure obviously and I you know run all
my tests in there I realize not everyone
does this so thinking about supporting
am going for quick test runs for those
19x users using jars straight out of
them to directory rather than copying
them into live would be a little cleaner
the way it's done right now is kind of
further Stoffel reasons they don't write
like important last one is pretty cool
so Hudson is a continuous integration
server very nice to have music at work
so there's going to be call the five DS
is starting to offer Hudson as a service
where you you get your bill done for
like one cent a minute
just on the mint and they're talking
with them about installing lighting on
their servers so a lot of people ask me
like Oh what do I do for dependencies
that I can't find on closed hours
because they're private so this you know
getting yourself set up with one with an
account here and you know pushing it out
to a private s3 location will make that
a lot easier just real low overhead
everything's things handled for you so I
would expect an announcement on my
mailing list
yeah that's about it so I've got and the
wife has been a little spotty so I've
got lightning and being served on the
local land connection so you don't have
to try to reach out there so yeah if
you're interested just just pull it up
the canonical on the line again is on
github they're taking minutes about us
is my blog and then my slides are are
there as well so while they take
questions</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>