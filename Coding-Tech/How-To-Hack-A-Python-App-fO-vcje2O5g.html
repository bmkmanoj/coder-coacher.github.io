<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How To Hack A Python App? | Coder Coacher - Coaching Coders</title><meta content="How To Hack A Python App? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How To Hack A Python App?</b></h2><h5 class="post__date">2018-04-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fO-vcje2O5g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so my name is Assam Hussein you can find
me on Twitter at joy I blog about
angular and mainly angular and
JavaScript on my site code Croft TV and
I'm something called a cloud developer
advocate and Microsoft so I work in the
Azure team and my goal is basically
connects with developers all over the
world and feedback all of your wonderful
wonderful thoughts you have about as
your back to the teams if you've got any
if you use a jaw or you don't got any
questions about it come find me after it
and I'll try answer them so let's start
with our first story should we Equifax
okay so who's heard of the Equifax hack
that happened early wow that is a large
proportion authorities excellent so the
largest hack in history okay about 200
million people people's records were
stolen
Equifax is a billion-dollar company in
fact I think it read have been around
for a hundred years about 10,000
employees but before we break down how
they got hacked let's just start off
with a bit of explanation of terminology
okay a vulnerability is a hole in your
security so for instance not setting up
a firewall or leaving a port open that's
just a vulnerability okay an exploit is
a tool or a script or evens the series
of manual commands which take advantage
of a vulnerability to do something bad
okay who's heard the term zero-day
exploit good so a zero-day exploit is
one that no one's heard of before right
it's a secret make sense now okay once a
zero-day exploit is known it's not a
secret anymore okay you-you-you might
not you might not call it a zero-day
exploit you might call it a one day or
thirty or six month you don't call it
that but just conceptually yes might
might be one way of thinking about it
and once the vulnerability becomes no
then you know the companies or the
maintainer x' will usually release a
patch so the value of an exploit will
then just go down as more and more
people apply that patch okay basically
the clock starts ticking does this one
make sense now okay so how hard you
think would be to get hold of a zero-day
vulnerability I'm guessing some of the
people in this audience will say not
that hard okay so it depends who you are
right but typically for a lot of people
it's not very easy to get hold of a
zero-day exploit you need to roll in the
right circles yeah a report I read this
year said that a single zero to exploit
can sell for about quarter of a million
US dollars and you actually get paid in
installments as long as the exploit
doesn't become down so that's how how
hard it is to get a zero-day exploit how
hard would it be to get hold of an
exploit that's been in the public domain
for six months not very hard at all
right in fact it's really easy it's all
out in the open this is one website you
can use there's loads of websites this I
think that one with the nicest UI so it
heads where I've got it I'm searching
PHP because you know it's fun so you can
just search for the vulnerabilities with
PHP and the public can't see but we're
still on 2017 so yeah so given that did
Equifax get hacked by a zero-day exploit
know they got hacked through a known
vulnerability in Apache stretch which is
a Java web framework they had already
been fixed for two months all they had
to do to protect themselves was install
an update that's it okay but you might
laugh but the sad thing is this isn't
that unusual okay snake which is more of
a node security firm analyze the whole
bunch of data breaches in 2016 I'm not
the top 50 data breaches 12 we're
through known
abilities okay so 25% of the data
breaches were through known
vulnerabilities essentially all you'd
have to do to protect yourself was
install an update do you really want to
be that person having that conversation
with your CEO you know they spent years
building up the company but you just
come in Politan stealing an update so my
first piece of advice is just to always
keep your software updated all the time
your operating system your web server
your database the application the
application dependencies yeah all that
stuff keep updated all the time yeah but
my second piece of advice though is make
it somebody else's job to keep your
software updated ideally somebody who
knows what they're doing so I always
like to use higher level services like
passes Sean he came on earlier was
talking about service and fast functions
as a service so you make I use the
highest level service that you can okay
so the most important one there is at
the top obviously is your I put these
other ones they're just you know you
might have heard of them and I currently
speak for the others I really can't but
I can speak for is a John we have whole
teams of people whose entire job it is
all day every day to search for
vulnerabilities and apply patches and we
have entire security teams okay some
advice generally is don't roll your own
infrastructure and it's tempting I used
to do it as well don't roll your own
infrastructure
if you roll your own infrastructure
you're then responsible for applying
security patches and keeping everything
updated and unless your security expert
I don't think you should be doing that
another thing you can do that I think I
just found about this in the day I'm not
sure how long it's been released I
literally just found about it the day
before I came to PyCon so if you use
github in the insights tab has a
dependency graph and what they've added
for JavaScript and Ruby right now is
they've they can detect from your
dependent can see what dependencies are
and from your dependencies they can see
what versions we've put the penny to
using and they can say mascot of
vulnerability so it's telling you now if
one of
but dependents in your application has a
vulnerability and only one ability that
you should go and fix as I said it's
only got JavaScript and Ruby support now
but Python is coming up next in 2018 so
keep an eye out for that one if you're
using as your we've got something called
is your Security Center which is kind of
like a linter for security so you can
put your it will just scan your
application and tell you what what you
need to do to kind of keep it but more
secure what then perhaps the security
holes are and a really cool thing about
it I think is that it's really hard
sometimes to figure out what signals are
real hacking attempts so what we did we
actually trained an AI that basically
learnt from a whole bunch of test data
figured out and it can basically figure
out patterns through all the signals
through all your logs and your
application to see if you've actually
been hacked and also interestingly how
you got hacked which is the really
interesting side of it so you can see
here maybe have a sequel injection and
then from that they got in and executed
some commands you can see that path to
your application so pretty cool it's not
perfect but you only about do switch a
button on to keep it to get running
does anybody know this show only ever
one or two people it's three now
excellent and now it's crazy right so
this is the funny show in the world
that's called It's Always Sunny in
Philadelphia and this is a guy called
Charlie Kelly in the show he plays like
the dumbest character in the show but he
thinks he's a lawyer
every time they get into trouble which
you can imagine is quite a lot um he
always like to represent himself in
court really really badly so my closing
arguments for the first story is this
thinking you can create a secure
platform to host your application when
you're not an expert in security is like
thinking you can represent yourself in
court when you're not a lawyer make it
somebody else's responsibility use
high-level services
Pat keep things updated that's the end
of the first story did I scare anybody
no no I like to starve gently now let's
move on to the second story anybody
heard of this company
no so
github has a real night gap I'm not
gonna github has a bug bounty so
basically they pay you if you find a
security hole in their software and as
long as you keep a secret and give them
chance to fix it you know think they
finally give you a bit of cash there's a
really great write-up of bug bounty by a
user called orange this is their Twitter
go follow them please because it's not
my story it's as this and I think it's a
really amazing story because it gave
basically the the attacker they bills to
when any command on a github server and
they did this in a really interesting
way by chaining together for
vulnerabilities together and I think
it's a really interesting story if feels
like a heist movie when I'm reading it
so I'd like to share that with you so we
all know web hooks I hope we all know
web hooks in get up so with a web hook
you can set it up so that when you do a
git push to server it does a post to
some end point that you've defined okay
pretty straightforward but what if you
set your web Hookers localhost yeah so
now like if that if this worked then
you'd be able to basically do a post
request on the github server behind the
firewall to any port but github we're
using a sanitizer right that weren't
being they were using a sanitizer so
localhost is blocked okay but they
forgot about zero okay so I'm some
system zero come resolve to localhost
say going vulnerability number one now
you've got the ability to get push and a
post to any process on that server turns
out there's not actually much you could
do with this one
one of the processes running on on
github was elasticsearch so 9200 last
search and you can if you post to the
shutdown endpoint you can just shut down
elasticsearch but not really a big
denial of service attack that right i
mean so in down elasticsearch isn't a
biggie
so i already spent a few more days
looking through looking through the
stuff trying to figure out if there's
another another way they can change
something else on top of that and found
this this is some code from graphite
it's kind of a charting tool and it's
open source so check the source code on
github
- and found this one function called
send email which is called this function
is called on a post okay so it's perfect
and basically as well explain what it
does so gets the URL from the query
parameters when they get query
parameters gets the path which is
basically just the URL and then does it
get to that path and that's where it
doesn't sound that special at all does
it
I'll explain in a second so what we
basically done is if you use this as the
web hook URL it's now remember it's a
post originally so that's the original
post and the second URL is grabbed and
it doesn't get to it so now you can
convert a post into a get that's it okay
so now we've chained to runner abilities
together nothing special right nothing
to write home about but the thing is
this function is using HTTP connection
library and certain versions of Python
not even that longer but certain
versions of Python had a vulnerability
with this HTTP connection library Python
less than two point seven ten and before
three four four had a known
vulnerability and that vulnerability was
called carrier to and line feed
Injection okay it's a character turn is
new line on on Windows and line feed is
new line on everything else in the world
I have a MacBook so what that converted
to two hexes I just like oh do a so do a
so now what happens when you do a get
request to this actually what is a get
request actually why is a hasty request
well it's this right this is a HTTP
requests so we see this all the time we
look in in in in in the in the browser
console Network quests but what are we
doing really you when we do a hex DP
requests well we're opening up a tcp
port this host port okay and then we're
basically passing it lines lines which
end in carriage return new line and the
what i was listening on the other side
knows it's the end of the tcp end of the
HTTP request by having to carry to in
line feasible not for another that's
that's all that's all we're doing with
HTTP request we're opening the tcp port
to another process and sending in
strings that terminate in character and
line food but HTTP connection library
convert oda way into 10 line fee so what
are we doing now what's being sent to
another server so where if if from the
other side is something is expecting
HTTP it's gonna get the first line and
go i know what that is and it's gonna
get a second language is how long ago
what's this I don't know this is
malformed it's gonna send a malformed
message back right so you know we've now
done some really clever things so that
we can now send a man malformed HTTP
request right just no big you right but
what if you send that I'm gonna play a
game here what process is 1 1 2 1 1
memcache he said that well then you get
cookie that's a memcache okay memcache
so now what happens if you try and send
a hasty request to there okay so I was
actually going to happen we're actually
now sending we're not we're sending it
this whole thing to the host port 1 1 2
1 1 which is memcache so this is what
memcache is gonna see it's gonna get get
slash and it's gonna go I don't always
like sending this it's then gonna get
this and it's gonna go oh yeah I know
this yep yep yep yep I'm gonna set data
on key cool I got it you're gonna send
it this it's gonna add on all those what
what's going on why you sending me stuff
and what that is sorry up come on
what this is is something called
protocol smuggling okay so within the
HTTP protocol they've smuggled the
memcache protocol and it's all being
sent using HTTP connection library so so
as developers we really like to store
things in memcache don't we we love
storing things in memcached but we're
really lazy so we like to use libraries
to do it for us we might take an
instance of a class and pass it through
a Pickler or a serialize that cover it
into string store that whole thing in
memcached and then when we want it we
will then grab the stuff from memcache
on serialize and pickle it and execute
some code I'm really happy with that
we've that's great yeah so it's easy but
I just showed you how to set some data
in memcache so now you you've see
realized your code and you can you store
it in a memcache and and and then you
uncie realize it and you execute
something but you're not executing your
code looks clean my code
again what can you do with that snot yes
so why just just set some dummy day to
remember no biggie right well I always
had a look at the keys in memcache to
found this one the interesting word has
been read there isn't it
deprecated instance variable proxy now
we all know when we use these libraries
that kind of automatically serializer
our objects for us sometimes I'll use
the name of the class in the key so this
was the name of the class but they were
serializing deprecated means it's
variable proxy so infants variable proxy
had a known vulnerability so in a later
version they added the word deprecated
onto it so that if you want to use this
class you have to type as a developer
new deprecated instance variable proxy
so obviously it's a strong indication
you shouldn't be using it now the the
vulnerability that it had was there was
a way of serializing instance of proxy
so that when it's uncie realized just
the act of uncie realizing it would
execute the command just the act of
uncie realizing it would execute command
so that's what I did so this is the
actual eventual end web hook so it's for
vulnerabilities combined together the
red one is the first post remember that
that was so long ago so innocent then
and then we have the new their light
blue one which is to get and then this
kind of what to call that blue and
yellow one is the memcache setting and
the kind of dark blue one here is a
value that's being set in memcache and
you really can't see maybe you can see
here but that ID there that's it that is
the command you want executed when this
is unsterilized and that's it so then to
prove they worked orange create this
video get your profile repo settings you
just watch me
runs a little script to get the webhook
URL there is
pace it in save or add and then to
actually trigger this
oh well then then sets up something
running on the server so you can see the
commands that get run and then it's
actually trigger this all you go do is
issue a search so doing a search request
the data from memcache and remember just
requesting it
execute the command you can see on the
right there execute the ID can on the
moral of this story so you all like to
believe that attackers were coming
through one giant exploit in our code
and be really obvious to see how they
got in but really they were coming
through multiple smaller exploits
chained together and each individual one
might not seem so serious okay
so if you found a vulnerability in your
code you'll maybe look at something and
think there's no way okay I see the hole
but there's no way they're gonna be able
to get in just through that will they
will right you'll find a way in so if
there's no such thing there's a small
vulnerability is my opinion here how's
that buddy feeling now anyone need to go
the toilet time for them to go to the -
no okay fine so I'll just just goes for
the next one so who uses Django rest
framework we hands it are you sure you
sure oh geez Django rest framework are
you generous on it which one put your
hands up if you think you use the first
one no put your hands up everything you
use a second one
okay one put your hands up who these
thingies 1/3 1/3 that's interesting I
think at the start had about 20 hands
raised and now when you have three hands
raised it's actually the third one okay
it's a third one but you know what's the
harm what's the harm if you typed it in
wrong just tells you it's it just tells
you you can't find the package of that
name right but wife
well if you published a package to Pipe
you with that name well if you publish
one and then made your setup dot py
script do something a bit funky surely
that can't be possible is possible
yeah so it's the slow back national
security office in this September
actually posed a ten they found and I'm
only mentioning that one with this this
happens loads but this is the latest one
mention ten that they found so they're
all misspellings on standard library so
the helper here's the guess which is the
wrong one who thinks that one of the
right one is the wrong one
ok who thinks the one on the left is the
wrong one it's the one the one on the
left is the wrong one ok I always always
gets me as well but in the setup the py
is in these scripts weren't actually
that bad right they they just posted the
package name the user name the host name
over to some server and I think it had
some commenting yeah
this is just a test so it wasn't really
like a big attack but this isn't
actually uncommon at all ok it's called
typo squatting and it really came to my
attention recently from JavaScript so on
my Twitter feed once you know August I
think yeah August I found this I mean M
p.m. for those we don't know NPM is that
PI P but for node and this person saying
hey it looks like somebody's stealing
about members from across sales package
but basically cross them with the - is
the real one and cross them without the
- was the fake one that was published
and what it was doing I know it snowed
ok I'll just explain it to you so
basically it grabs the environment
rebels from your process okay and post
it to your endpoint and that's actually
my this is my I didn't do this it was
called hacked off anyway it posts it to
their endpoint so just installing that
I'm posting all of your environment
variables from your server to somebody
else's end point
so who here be honest who here stores
kind of private stuff in their
environment variables on their server no
passwords connection strings that kind
of stuff
yeah no the of those who didn't put
their hands up I'm guessing 50 percent
of you probably hard-code stuff in your
script files yeah and the and the other
50 percent of you are probably using the
is your key vault she's probably the
right thing to use but this really
scared me it would he would he scared me
you know and I thought we would he
thought about why did this game II and I
think it's I felt like I felt too
trusting
and I think the reason what he scared me
was because it's open source nice open
source there's multiple eyes on open
source in the public but you don't
expect you might expect your open source
software let's have a few
vulnerabilities inside it but you would
never expect to actually have an exploit
and the thing is like the NPM modules at
least up to two weeks before they were
discovered yeah that the crosshair
module is incredibly populous downloaded
a couple of million times every month
okay so even just a few misspellings
gonna grab a few thousand people so what
can you do
there's a whole bunch of solutions for
the node side I want to talk about that
but from the Python site the advice is
to review all of your modules in your
requirements that's possible but yeah
review all your modules in your
requirements make sure he spelt it
correctly also if you're using Pippin
it's just had an update so that now it
checks to see if you're typing something
it checks to see if it might be
misspelling of the top 1,000 most
popular modules on typing and also now
they're blacklisted a whole bunch of
slight misspellings of the standard
library so you can't publish it anymore
and I just received the whole grant I
think two hundred thousand two
the update pipey so they can then add
some security stuff I'm not sure the new
security stuffs gonna be but there is
some stuff happening in that space but
this is cross language did it scare you
on that one
hopefully so that's that's what time
that's all the time I've got for anyway
so just to summarize just some points
stop pretending now I say stop
pretending that because you spend a few
minutes thinking about security that
you're safe I mean there's people out
there they spend all day every day just
thinking you ingenious methods of going
around your security so make it not your
job make it somebody else's job
yeah user powers use a high level
servers use a faster functions as
servers if you can and just make it
somebody else's responsibility somebody
with a real security team to handle the
security of your application there's no
such thing as a small run ability hope
you saw that from the github fix it ok
and don't trust anyone okay so you saw
from the npm modules and the pypy issue
is really hard people can be posting up
stuff on on there that has exploits
inside it and i don't really have a
solution for that so here's a uniform
and that's it if you again if you want
my slides you can just follow me on
twitter okay I'll be posting my slides
on Twitter and shortly send it and
that's it thank you very much for you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>