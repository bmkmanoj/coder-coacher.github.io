<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Game Development In Native JavaScript | Coder Coacher - Coaching Coders</title><meta content="Game Development In Native JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Game Development In Native JavaScript</b></h2><h5 class="post__date">2018-04-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BmwnNAaco1w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so this is all gonna be coded I had
originally planned to make this live
coding but there's not a ton of code but
it's more than I wanted to do live
coding so we're gonna jump through
different code I'm not gonna code it on
the fly but before we get into that let
me go from my principles of game dev
they're mine because they're common ones
but they're also not official so kind of
four things the top two are the really
most important ones but every with game
development you have what's called the
game loop which can be called the main
loop you've some type of looping
construct that's always asking hey what
happened did someone press a button does
someone press a button did something
does something happen like what do I
need to do on this next frame that's
constantly having it happening in game
development and you'll see that from the
very first block of code I show second
thing it's handling user input goes
right with that game loop you're
constantly asking what what would what
changed what do I need to do now was a
button press was the mouse click was the
mouse moved did something collide was
something else I need to handle which is
not telling a user input but it could be
if you pressed a button and then the
second two are there's there's a lot of
variables involved with game development
you have to track this kind of the state
of a lot of different things so you'll
see a lot of variables today and this
and then math I remember when I was
learning about programming it was
constantly told that you can use a lot
of math when you're programming and I
never use math like I add things and
sometimes I do like modulus division
simple stuff with game development
that's and maybe I'm just not in the
right field I don't know but with game
development there's a lot of math all
the time and you're gonna see you know
not crazy math today but more math and
you would do with normal programming so
without further ado let's do with demo
and this is gonna take you have the
majority of the rest of the time so
we're gonna build single player pong and
the way we're gonna do this is I've got
a main HTML file here it's all gonna be
just canvas based uh can you guys see
this all right do I need to zoom in at
all okay if anyone if anyone can't see
it my own main shout out we've got it's
the basic index.html file here nothing
crazy going on here the big thing is we
have this canvas thing here this one
looks like a funky line don't worry
about this this is just a fancy way for
me to load in a different javascript
file based on what port I'm on because
we're gonna dig through these ten files
right here
and they build on each other so that's
just a fancy way of me saying all right
so important for example blow it up the
app - zero file nothing to worry about
nothing related to this talk at all
so we have our index.html file that
we're not going to change that the only
important thing to note is it's got a
canvas on there as you can see right
here so let's make single-player pong
and the idea behind this game is we're
gonna make it to where a ball bounces
around this area it's gonna bounce off
of this wall this wall this wall we're
gonna have a paddle at the bottom that
we use the left and right keys to move
back and forth that behaves as pong if
we miss the ball goes down here we're
just gonna refresh the page that's
alright that's our losing game thing
it's a very simple losing algorithm okay
so the very first thing we're just going
to create kind of our scaffold here very
sure we've got ten lines here we get our
canvas here we just get it and there's
no libraries at all involved with this
no jQuery
nothing just core JavaScript so we're
gonna get our canvas element by the ID
my canvas and in this line we're gonna
get the context of the canvas this is
important because you can get different
contexts of a canvas you can we're
getting the two-dimensional context
which changes how we use it you can get
WebGL context you can get WebGL to
context and I think you can get bitmap
renderer context so anything we do with
the canvas we're gonna use this context
for right here and then the next thing
we're just setting up our game loop here
now I'm using something here called
requestanimationframe
and you'll see that I did not define
that function you may also know that
this is a JavaScript native thing I
don't have to define that because it's a
thing that JavaScript has a second
question where you can get a shirt just
like Jesse had with with a wheeler
District shirt on it who can tell me
what requestanimationframe actually does
yes
yes bingo I request I'm gonna it's not
the right shirt let me know we'll work
it out I also knock things over when I
throw shirts so John is absolutely
correct a requestanimationframe the idea
is the next time the browser is ready to
update if you call requestanimationframe
this the print the argument here is a
function it will run that function
whenever the browser is ready to update
and the idea with the
requestanimationframe it only gets run
at once you want to kind of have a
recursive algorithm going here where
your callback because ideally gonna call
requestanimationframe again this is kind
of our game loop here there's another
way that you could get a game loop going
with JavaScript and that's just with set
interval or constantly calling set
timeout those are kind of seen as not as
not as optimal because it's the way
there was work as far as the JavaScript
call stack goes they can get bunched up
to where a lot of them Wi-Fi are at a
certain time they don't necessarily fire
every interval and requestanimationframe
is in a way like that too but you're
letting the browser decide when it's
ready to update it usually happens right
before the screen repaints it usually
runs at about 60 frames per second
ideally so this is gonna get called 60
times a second ideally so anyway it's a
solid way to do your game loop so
nothing crazy going on here we just have
a function draw it's not doing anything
it's just gonna call itself again so
even so that's what's running right here
on port 7000 not happening but this draw
function is getting called a lot
continuously so let's begin to have this
we can actually do something with this
we've kind of set up our game loop here
just pure JavaScript okay so more code I
tried to kind of section off what's new
and what's not new and it's gonna look
like a lot but we're gonna walk through
it all don't worry
so I've got some new code here let's
just render our ball first of all we've
got some variables I told you we're
gonna have a lot of variables so x and y
are gonna represent the center of our
ball so this ball is going to be at the
canvas width divided by two that's gonna
be the middle of the screen it's gonna
be the canvas height minus 30 for the Y
which is gonna be all the way down minus
30 pixels so which ball should be kind
of around here so and that's just the
starting position of
and then we just said a ball radius of
ten that's ten pixels we can change that
to get a bigger ball and then in our
draw function I'm gonna skip over the
draw ball function and our draw function
we call draw ball which going back to
that this is how we define it we create
a shape using a two-dimensional canvas
we're gonna begin the path
it's create a circle you create an arc
the arc arguments go as the center of
the ball so XY that's your center of the
ball the radius and then these next two
are the start and the end of the arc if
you remember geometry from back in high
school a circle starts at zero radians
and then if you all the way around it
you're at 2 PI R to 2 pi radians so
that's what this fanciness that math dot
pi times 2 is geometry the fill style
here here and you can say blue you can
put hexadecimal you can put RGB values
it doesn't matter anything that works in
CSS colors works here we're gonna fill
this shape and I'm just gonna close it
so this is just you're gonna see this
one more time we draw the paddle and
later on but this is just a simple shape
drawn with canvas so let's jump to port
7001 boom we got a ball if you look
closely it looks kind of like an octagon
and I think the only thing I can think
of is that must be a browser
optimization thing because even though
doesn't look like it we're constantly
drawing this ball over and over again
because it's in the game loop so you'll
notice when it starts movement it does
not look like an octagon oK we've got a
ball we're like 10 percent of the way
there
winning ok let's make the ball move so
the way we're gonna do that we're gonna
hop over here we've got a couple new
variables I'm defining a DX and a dy for
physics guys out there this is Delta X
Delta Y that's the change in position of
the ball with the direction so I can go
in a positive or negative direction I
said we're just gonna the idea with
these variables is that we're gonna say
every frame we want the ball to go right
to pixels and to go down to pixels I'm
sorry to go up because yeah down down is
positive and in the canvas up is
negative okay
so let's use those and don't the only
way we need to use those is on every
draw function or in the draw function
we're just going to update the center of
the ball to update
by the dxdy so xdx gets added to X and
dy gets added a Y and well this looks
like we're adding dy keep in mind that
right now and dy is a negative value so
we're subtracting it and those those
values will change DX will eventually
become a negative value later on so
nothing nothing crazy going on here
what's a let's check this out
so we should have a ball bouncing around
right now or at least going in a
direction but wait it's doing that why
is it doing that that's not a ball it's
just let's refresh again it's just
drawing it's drawing the ball but it's
drawing it over and over again on top of
what was previously drawn before so what
we need to do is we need to clear the
canvas every time a new frame happens
and this is a common thing you want to
wipe out what you don't need anymore
wipe out what's been changed and then
you are overriding it so let's do that
this is gonna be the easiest easiest
change right here it's just a single
line we're just gonna tell the context
of the canvas to clear from the top left
right the top left corner that's this
first two argument and then we're gonna
say the width of what we wanted to clear
which happens to be the canvas width and
then the height we wanted to clear which
is the canvas side so we're just wiping
out the entire canvas every single time
so as you would expect we now are gonna
have a ball bouncing around look at that
it's not bouncing yet but we at least
have it moving around okay
the bouncing comes next though so with
single player pong we want it to bounce
off of every surface except for this
bottom surface right here so let's do
that
we're gonna learn a little bit how
collision detection works and this is
kind of the eye-opening moment for me
because I was assume something like
collision detection is something that I
don't I thought it was more that was
deeper than what I I don't know then
what it actually is and it's not it's
literally just very simple math of it's
the ball over here like is it gonna go
over to the side is it gonna hit the top
but I've talked enough let me actually
show you kind of what it looks like let
me see if we have any new variables I
don't think so okay
so this is all it takes right here to
get the ball to bounce off of all of the
walls except the bottom wall let's start
off with the top one here so we're gonna
check to see if the center of the ball
Plus where it's going is greater than
the canvas width minus the ball radius
that's checking the riped
the right boundary right here so if that
ball was X is somewhere over here
but it's a but is if it's greater than
the canvas width minus the ball radius
could we want to take into account the
ball radius that wouldn't mean that the
ball has to be over here somewhere so if
that's true then we want just we just
want X to change direction we can be the
same DX just needs to be the negative
version of what it is so force coming
you know right now we wanted to go left
so it's the right wall or if the radius
of the ball plus I'm sorry the center of
the ball plus where it's going in the
next frame it's just less than the ball
radius which means because the canvas
the position would be zero over here we
just need to account for the ball radius
that would mean it's over here so if
it's less than this I mean it's beyond
this wall or about to be beyond the wall
so we need to change direction again and
then why we would do the exact same
thing down here except it's even easier
because we don't need to track the
bottom wall we we want that one to be
open-ended so we just check the top wall
so if the Y of the ball which is gonna
be you know it's gonna be zero up here
if if the Y the ball plus where it's
going is less than the ball radius that
would mean it's beyond this top wall
here we want to change the Y direction
so just to if statements
nothing crazy and let's see if we can
get some bouncing boom-boom we did it we
did it everyone we're not gonna see it
bouncing the other wall but you can rest
assure that it did bounce nicely down
here you can just we'll just pretend
okay so we've got a bouncing ball now
and that's we just did some collision
detection it doesn't sound like much but
this is the basics of collision
detection you're just you're just
detecting is the state of this thing you
know beyond or at the state of this
other thing that's it and then if it is
do something and that's just we're just
changing the DX or dy directions that's
it okay now let's draw the paddle we're
gonna draw it the same way that we did
with the box if it's not an arc it'll be
a rectangle so we're calling a draw
paddle function in our draw function
there's nothing else new down here
that's gonna call this function up here
but before I dig into that we did define
some new variables let's jump up and see
what new variables we have we define a
paddle height of 10 pixels we define a
paddle width of 75 pixels and then we
define a paddle X there
and this is the variable that will track
the X location of our paddle because
when we move it left and right we need
to know where it actually is we don't
care about the Y because our paddle is
gonna be locked at the bottom of our
canvas so and it's never gonna go up or
down this isn't this isn't crazy palm
this is just normal palm okay so we've
got some new variables here and the
paddle X we're just going to set it
initially to the very middle of the the
canvas which we're gonna take the canvas
width minus the paddle width and then
divide that by two if we just took the
canvas width divided by two it would be
kind of off-center to the right side
okay so we got some variables here let's
draw the paddle I won't dig into this
one as much because it's very similar to
the draw ball function up there the only
difference is this rect right here which
kind of like clear direct it accepts
four arguments except the x value where
you want to start the Y value where you
want to start and then the width and the
height of your rectangle so we've got
those locked in variables we're good to
go let's see what this looks like boom
we've got a paddle there but we can't
it's real pretty it's nice and red oh we
can't move it though and even if the
ball were to hit the paddle it wouldn't
do anything because we're not detecting
any collisions on it it's more or less
just a background image right now it's
just sitting there
so let's let's make a move we got to do
two things I gotta make a move and then
we gotta do some collision detection so
let's make it move first of all and this
is probably gonna be the page that has
the most code let's stop at the top but
it's nothing crazy it's just event
handlers so starting with some new code
here we've added a paddle DX that means
every time we press one of the arrow
keys left or right we want the ball the
paddle to move seven pixels we have a
variable tracking if they're the right
key is pressed and if the variable
tracking if the left key is pressed so
we're gonna add two handlers down here
I'm going to scroll down a section and
then we're just gonna add event
listeners for those so on a key down
event we want to call key down Handler
and what that's gonna do it's gonna give
us the event and whenever a key is
pressed we're gonna check the event key
code if the key code is 39 that means
that the right key was pressed so we
want to say that's just that's just what
the the mapping is for you're right the
right arrow
we're gonna set the right press variable
to true if the key code is 37 that's the
left arrow key so we want to say that
left is true that's our that's our
that's our down key handler on a key up
handler we have another function called
he up and Lursa whenever you release the
key we're gonna check to see did you
release the right key okay that means
we're gonna set the right variable the
right press variable to false did you
release the left key we're gonna set the
left key variable as false all this code
right here there's all this 20 lines
literally just tracking the state of
these variables right pressed and left
press so we have those but we still
aren't doing anything with them they're
just variables right now so let's
actually update the main loop the game
loop and do some stuff with them and
it's very simple we are just because
remember every time we're drawing our
paddle we're setting the rectangle at
the paddle X paddle and paddle X is
gonna be changing based on if left is
pressed or right is pressed so we've
updated its rights pressed we want to
update paddle X we want to add the
paddle DX to it so if we want it if your
rights pressed its gonna move to the
right seven pixels on the next frame if
left distress we want to subtract paddle
DX that's gonna move it to the left
seven pixels of the frame so that's it
for this slide let's take a look at that
and BAM I can move it you'll be able to
see that even if I'm there it'll go
right through it
oh we've got a problem still if I just
hold down right we're gonna go off the
screen there and that's that's not okay
that's a problem so before we get to
collision detection let's fix that too
it's in a way that's still collision
detection we want to detect if the
paddle hits the side of the wall and if
it does and we don't want to move it all
right so new code for that it's this
it's nothing nothing crazy right here
we're just gonna add in we're just going
to update those if function those if
statements we just had so if right is
pressed and the paddles act the paddle X
which is the left boundary of the paddle
they beat you guys with side over here
that's trippy paddle X plus the paddle
with it's less than the canvas width
that's what we're saying there is
if paddle X is over here plus the canvas
width
I'm sorry plus the paddle width so that
brings us over here if that's a is gonna
be greater than the canvas width then we
want to stop it so we're just not gonna
update paddle X anymore
same thing with the left if left is
pressed but our paddle X which is the
left boundary is that right if it's
greater than zero
let me let me let me try round just make
sure that works okay yeah that's right
okay I'm just not thinking
but if paddle X is greater than zero and
left is being pressed then we want to oh
right then we brainfart then we want to
move the paddle otherwise if it ends up
being less than zero then obviously we
don't want to move it okay okay so we've
got that going now we can actually do
some collision detection this is gonna
be our final big thing we're gonna add
to this we just need the ball to
actually bounce off of the paddle so to
do that and this is all the new code
we're adding we're gonna update an if
statement we have and we're just gonna
add in three conditions right now the
ball will only bounce off of this wall
this wall this wall we wanted to bounce
off the paddle to and there's three
things there's three conditions that
need to happen for it to bounce off the
paddle the ball needs to be greater than
the paddle X it needs to be less than
the paddle X plus the paddle width and
it also needs to be greater than the
canvas height which is down here minus
the paddle height which brings it up
here so all those three things need to
happen for the ball to change direction
and that's what we're doing here we're
tracking this is the top wall check
we're just updating the previous if
statement so that one still stands we're
gonna add the paddle check here and this
is checking if the Y at the ball plus
where it's going is greater than the
canvas height minus the paddle height
minus the ball radius we want to take
that into account to if it's greater
than that if it's greater than if the if
the X of the ball is greater than the
paddle X so that's the left boundary of
the paddle but it's less than the right
boundary of the paddle which is paddle X
plus paddle with then we want to change
the y direction otherwise we don't want
to so let's take a look at that and
see what happens can we do it can we do
it we did it we did it now keep in mind
too this is not 100% foolproof so if the
ball were to come in at like an angle
for example and hit the side of the
paddle we're not we're not tracking that
you still you still lose that and I
guess the Paul just decided to come back
up there too okay and that fan that had
that happens that's that's a feature not
a bug okay the last thing I want to add
is just a very simple kind of game over
scenario which the game over scenario is
if the ball does go beyond the bottom
wall we're gonna update the same if
statement with an else if that says okay
if the ball is going beyond the canvas
height then we just want to reload the
page you probably have some actual like
game over psychologic here but that's
that's okay we're gonna be nice
so we'll load up this page and and and
oh we got a game over okay so we've
completed building single player pong
using core j/s it's nothing crazy you
can see we are you know with whitespace
and everything we're at yeah line 92 so
it's nothing crazy I do want to showcase
originally my tutorial was a brick
breaker tutorial which is kind of this
thing I kind of brought this down to
something we could code together here
with single-player pong
this is using just core Jas and I want
to say it's about 180 lines and I kind
of added a fun little things of the ball
going a little bit faster when you
bounce it's got a score it's got lies
it's nothing crazy but it's it's it's
just a little bit more code than what we
just did and it's all using chords yes
we want without even doing anything that
last time okay but maybe you can build
games using just quarter yes as you can
see but that may maybe that's maybe
that's what you want to do I think this
is a great stepping stone but at some
point you'll probably want to use some
libraries so second question to win
fares fares we the wheeler district
shirt who can tell me a JavaScript game
library that you might
to build games yes
boom phaser okay and that's the one I
was gonna show them alright we did it we
did it
okay so phaser is a wonderful library
and I rebuilt to this tutorial using
phaser and it's just it's just much
better like everything is smooth there
we've got wobbles going on there we've
got different speeds the ball it's
actually changing direction based on
where it hits on the paddle you can see
animation this is and this is less code
than the previous version I think this
was like 150 lines or so it's and it's
just the interactions much much nicer
and when you build something when I
built this using phaser I felt like I
was actually like doing game development
like I'm not just updating a canvas like
I'm saying alright here's a ball object
he's a paddle object you know and you
have like hooks like when the ball and
the paddle achill I do this thing it you
know the same things are happening under
the hood because I think this I think
this is canvas driven but as a developer
it just clicks more in my head like okay
when these things happen do this thing
it's it's awesome and I know and Jesse's
gonna talk about Babylon which is gonna
it's gonna blow my mind soon so I'm on
there I'm on the end the homestretch
here I see we're right at noon so my new
year's resolution was to kind of just
build some game tutorial and this is
where I started and the breakout games
were party tutorial so if you go to this
page just on and the mdn website this
walks you through how you can get into
this this is literally the 2d breakout
game I built that I showed you just a
second ago this is literally the phaser
one that's that's this one right here I
just went through the tutorials and then
there's a couple other ones you can go
through to they're there they're fun and
they're awesome and they really teach
you a lot and I I want to encourage you
if you're interested in this at all to
check these out
it's wonderful stepping-stones and for
me personally you know clever labs
getting into a lot of things like game
development so I wanna I want to be on
that train whenever whenever
time comes so this has been it's been a
fun journey for me and I still with just
the beginning so I know that here's the
link you may not go to it so if you if
you don't ever come back to these slides
just google game dev with J s tutorial
and I think it's the first the first
thing so that's all I got
I appreciate it I'm the code boss
there's my blog website that's it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>