<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>TypeScript: A Love Tale With JavaScript | Coder Coacher - Coaching Coders</title><meta content="TypeScript: A Love Tale With JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>TypeScript: A Love Tale With JavaScript</b></h2><h5 class="post__date">2018-04-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0siV7xeYSbY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Bowden Kelly I'm a program
manager at Microsoft and today I'm
pretty stoked to be here to talk to you
about typescript and specifically
typescript relationship with JavaScript
just a real quick show of hands
who has heard of typescript good
everyone great who is currently using
typescript excellent so we've got a lot
a lot of new people and hopefully we can
get you started quick a couple key key
objectives for this session I want you
to understand why typescript for those
of you who aren't using it yet you need
to understand why you should even go try
it and so hopefully we'll cover that in
detail and you'll understand why it's
worth your time I'm gonna show you how
to get started fast we're gonna put
typescript in a project very quickly and
then we're going to convert an entire
Express project and show you typescript
in action so first let's talk about why
typescript why should you care we think
developers should be able to focus on
creating amazing things we have all
these tools all these frameworks all
this technology but but all it's there
for is to help us create stuff and more
times than not that's not what we do if
you think about your day to day
activities of the developer you can
basically bucket all of your tasks into
these three buckets you have
understanding code and that contains you
know reading source code tracing
execution finding bugs you have
maintaining code which might be fixing
those bugs or refactoring and preparing
for new code and finally when you've
paid all of that tax you've done all of
that work then and only then can you
start actually creating the experiences
you set out to create who's heard of
project Monaco a few of you who sort of
es code most of you so vs code came from
project Monaco and project Monaco came
from the idea that we want to create
this editor in the browser you know have
a really rich editing experience that we
can put in any browser on any platform
and so of course we made this in
JavaScript and it was a massive project
after the first couple hundred thousand
lines of code it started to get
difficult to make any progress after
about seven or eight hundred thousand
lines of code we realized that we
weren't really making any progress and
in fact when we sat back and measured
kind of where our time was going on this
massive JavaScript project we found that
nine
five percent of our time went into
understanding and maintaining what we
had this project was effectively
read-only that's two hours in a 40-hour
week that we actually got to build this
editor in the cloud in a browser and
that just wasn't good enough and so it
was with this problem we started
grappling with it it was like what we
like JavaScript JavaScript is good we
want to use JavaScript but we need more
tools we need to be more productive with
JavaScript and so we said what would it
take what kind of tool would it take to
turn our breakdown into something like
this where we could take these minor
savings from understanding and
maintenance and feed them back into
creation time what would that tool look
like and is chasing that goal that we
created typescript typescript is by
definition an optionally type superset
of JavaScript that compiles back to
playing JavaScript but I've always been
more of a show than a tail kind of guys
so let me just give you a quick quick
run-through so here we have a plain
JavaScript file nothing special here
this is just a es5 we've got functions
if statements nothing special here and
to get started with typescript all I'm
going to do and this is in vs code I'm
going to do is add a comment that says
TS check and what this is going to do
it's going to it's going to signal - vs
code that hey I want to treat this
javascript file as if it were typescript
I want you to run the typescript type
checker on this code and just tell me
what you find and so here you see we now
have red squiggles and this is coming
from the typescript compiler and the
background is looking at all the types
that exist in this JavaScript and it's
telling you where things don't really
match up and let me show you what I mean
so here we have this error that says
argument of type this object literal
right there is not assignable to the
parameter property descriptor and so
here we're calling this function and if
we actually look at this function there
are types that JavaScript expects behind
the scenes just because it's dynamically
typed in we can change them whenever we
want doesn't change the fact that
they're still there and so sure enough
there's this property descriptor
parameter that's expected and inside of
it it's basically a property bag of
config options and so here we have these
six options configurable a numeral value
writable get and set and if we look at
what we put we put read-only
probably what we intended to do was put
writable but we put read-only instead
and so what happens in JavaScript when
you do this at runtime we're gonna start
executing this function we're gonna take
this property bag try to configure this
function to act in some specific way and
we're gonna come across read-only and
the engine is gonna look at it and throw
it away and it's not gonna tell you what
it did it's not gonna tell you that it
ignored it there'll be no warnings no
errors no nothing but now this function
is not configured as you expected it's
behaving in a way that you probably
didn't intend and so it's a bug that you
now have to track down by hand with a
debugger line by line until you find
that this was in fact just a mistake
from reading documentation and probably
what you wanted was right out writable
false typescript we'll look at these
types and it will tell you when things
are off and that's primarily what
typescript does is a type checker it
takes your JavaScript and applies extra
checks to it let's look at another
example
we have operator greater than cannot be
applied to the types a function that
returns a number and number and if we
look at this sure enough we have ship
weight which is a function that returns
the parsed end of some text element
we're comparing it to a hundred to make
sure that this package is not overweight
probably what we intended to do was
actually call this function you know but
sometimes you're kind of in the heat of
things typing along you forget to call
the function and what happens in
JavaScript at runtime JavaScript will
compare this function in the number and
it will return false why will it return
false because JavaScript hates you this
is probably not something anyone ever
intended to do compared functions
numbers but it's valid in JavaScript you
can do that and it will return false and
so every time this code runs it's not
gonna behave the way you want it again
you're not gonna have errors and you
have to go find this by hand debugging
step by step type script will help you
find these little mistakes typescript
will cover your back but we haven't done
anything special here right this is just
JavaScript I've done anything out of the
ordinary and so what we can't start
doing is adding types there are places
in JavaScript where we can't guess
anything about the types for example
function parameters of course in
JavaScript if I asked for one parameter
you can give me 3 or 0 or you know a
different parameter than you expect and
so typescript knows this and it'll say
hey this type is a
any that means it can literally be
anything at run time I can do better
than that and I can actually tell it
with this J s comment exactly what type
I want it to have and so here this
comment above says we really want this
to be a string or a string array and
when I add that type annotation via this
J S doc type script now knows that this
is a type that I want to type check and
so he it's no longer an any it's a
string or a string array and this type
will follow email address throughout the
entire function body and sure enough we
found another error because of that here
it says property trend does not exist on
type string this is just a typo probably
meant to type trim but this happens all
the time and in JavaScript you won't
find out until run time when you get an
error that says trend does not exist on
email address but typescript can cut
that feedback loop down it can make it
quicker and this is only able to be done
when you give it types but at the same
time you don't have to give it types for
example we have another function here
that you know there's really not much
happening there's no need for me to add
a type here I'll just leave it as any
and move on and so this is all just type
checking JavaScript again we have not
converted this to a type script file yet
and really the point here is typescript
is JavaScript typescript is just an
additional layer of type safety added on
top of JavaScript for to use when you
want it it's an optionally type superset
but what if I do want to convert it to
typescript what does that change so I'll
remove TS check I'll change this from
food j/s to food TS and now i have a
type script file and of course I did not
disable TS lint so we'll get a bunch of
TS lint errors but that's fine and so
the big difference with the typescript
file is instead of having to use J s
comments to add types you can now add
them directly in line I mean so I can
just say this is a string or a string
array and sure enough typescript takes
in those types the exact same way as if
I had done a J's comment but it's just a
little easier and a little faster that
said now that we have inline annotations
that is not valid JavaScript anymore so
I need to compile those types away so
the second half of typescript is the
typescript compile step and so I'll go
ahead and pass food TS into the types of
compiler it will give me back a
JavaScript file that is
basically identical and if we look at
this the only difference here is really
that that parameter we have no longer is
decorated with it type we stripped it
out and so now you have plain JavaScript
again in your JavaScript file so that
runtime everything is good to go that's
not the only thing it does it strips out
the types but it also is capable of down
level compiling your code if you write
es6 code and you want it to be es 5
typescript you can do that for you so
let's say we have a class and we want at
runtime in a node it doesn't matter you
can have es6 and it's all good but if
for whatever reason you wanted to run
your code in an environment or an older
version of node that did not support es6
typescript can down level it the default
is to emit es5 code but you can choose
whatever target you want and so here you
can see we have this es6 class on the
left and it gets turned into a function
prototype based class on the right and
so this is very powerful depending on
what targets environments you're using
you can always pick the common
denominator where you want your code to
run but still right with the latest and
greatest features
so that's typescript in a nutshell so
when I say optionally type superset of
JavaScript you saw that I can add types
where I want to but I don't have to and
then when it compiles to plain
JavaScript it all starts with JavaScript
for the end of the day if you're running
JavaScript as well and so it's that
simple round-trip conversion and so you
saw how easy it is to get started
checking javascript today you can take
any javascript file you have at TS check
to the top of the file and you're off to
the races maybe you'll find some bugs
maybe you won't but it's worth to start
experimenting with a type checker and
how you can make it work for you you can
then add jazz docs to further add type
checking to your files and start playing
with what it feels like to have types in
JavaScript so you get it
typescript is adding type checking to
JavaScript but does that actually work
does it help a lot of people say I'm the
greatest JavaScript developer on the
planet I never have type bugs all of you
are wrong just kidding but they would
needed some research awhile back to see
you know how really how many bugs out
there could be saved by type checking in
JavaScript and some researchers at the
University College of London took 400
projects
and on github and they tried to apply
typescript to them to see if bugs that
had made it into production that were
later fixed could have been caught by a
type checker and what they found was 15%
of those bugs would have never made it
into production had they been type
checking that code so that's pretty cool
so the next thing we're gonna do is were
to look at how to add typescript to an
existing JavaScript app specifically
Express and so I'm gonna pop open this
app real quick and here we have a very
standard express app I have MongoDB
running in the background we've got a
few controllers it's very simple I can
run this by saying node source server
and then you will see it's a very very
simple app it's powered by Passport so
we can log in and you see it's very
simple right just a boilerplate that
most of you have probably seen before
and it's all JavaScript and to get
started converting all of this to
typescript I'm gonna add a TS config and
to do that I can type TS c dash dash in
it and it will generate me a TS config
file and we will look at this TS config
file we see there's a ton of options and
this is just a generated output of our
TS config generator and it's showing you
all of the possible options there are
with a brief description of what is
there I'm just going to delete all these
clarity know what we want and then
configure this as so so we are targeting
nodes so es6 is fine commonjs modules is
the outputted modules when we compile
common J's makes sense for node we want
to do module resolution node basically
what this does is it tells typescript to
resolve all the modules we find as if
they are node modules this is slightly
different from other module systems and
so we need to specify we're gonna do
allow J as true this basically allows us
to feed JavaScript files into the types
of compiler I'm going to briefly show
you what it would be like to convert a
project file by file and that's what you
need
js4 and then we're going to add an
includes oh we also need an out
directory we're going to be compiling
our source into we'll call it dist just
so we can keep our typescript separate
from our runnable javascript and then
finally we'll do include and this will
basically tell the compiler to look at
specific files but ignore others for
example we have this copy static assets
javascript file that's just a helper
function and we don't want to include
that and so we'll just say anything in
the source folder should be consumed and
so now you'll see when i run TS c we
will pull all these files out of the
source directory and compile them into
distributable directory and in this case
we're actually not really doing anything
we're just passing in JavaScript and
taking out JavaScript and so you can see
these files are basically identical -
maybe some white space so the next thing
I'm going to do is I'm going to convert
this server Jas to serve it out TS and
just like that I'm now in typescript
land so I can start adding type
annotations wherever I want if I wanted
to create a new function and add a type
you know I can now do this and if I call
that with the wrong argument you can see
we're getting type checking and all this
just happens because we're in typescript
and that's great and so what you can see
at this point you could convert your
files one at a time write the rest of my
files are still in sources JavaScript
but server TS is in typescript however
all of its getting compiled to j/s on
the other side which is my executable
javascript and so at this point if i had
10,000 javascript files i could convert
them one at a time if i wanted to we
have not a lot of JavaScript files so
I'm gonna go ahead and convert them in
mass real quick
and so now you'll start to see we do
have some errors and I'm going to walk
you through how we can iron all these
out and so if we pull back open our
problems window you see we have quite a
few compiler errors now and a lot of
these are cannot read Eclair blocks
built variable blah blah blah right and
if we look at these they're all import
problems and the kind of short answer
for this is modules are super
complicated and everyone did it
differently for a long time and so no
one has the same module structure and so
when you're converting from plain
JavaScript to typescript typescript
prefers that you write everything in es6
modules and most of the syntax is
currently using common j/s and so
there's a kind of disconnect this is
actually really easy to fix though it's
just a syntax thing and so I will open
my sketchy reg X txt and show you how
simply we can just convert some of these
things so basically I'm going to search
for all of the places where we're doing
this require import and you know there's
29 of them we import quite a bit of
stuff here I'm just going to replace
them all you'll see some of these errors
start going away but of course if we do
the imports we also need to do the
exports again modules are super
complicated there's actually whole other
talks going on on kind of the module the
module conflicts if you're interested I
strongly recommend you check them out
we're gonna kind of gloss over that now
though but there's basically two kinds
of module exports we have to address one
is literally module exports and that
syntax needs to change to just export
equals instead of module exports equals
and so we'll go ahead and do that and
the other is exports dot which needs to
change to export var and again we'll
just change all of those real quick and
so now we've just a couple regex
functions we've we've fixed basically
every single import you see there's
still a couple mistakes expressed
validator is one of these examples if
you look at expressive validator we're
actually exporting a function that's a
little more complicated and not really
expected and so we have to do something
slightly different and so here we'll
replace
that's syntax with import Express
validator equals require these are minor
edge cases again there's a lot of
details behind how this actually works
under the covers but you can you can get
around it with just some basic syntax
that now we have some more errors let's
see we have this module resolved to a
non module entity and so when we look
inside of user we see that again we're
doing this kind of export of a function
mongoose model is the function that
creates mongoose models and we're
exporting it directly so that we can
create user objects or documents and do
searches and whatnot and so what we need
to do here is instead of having this
export equals we want to just say export
VAR user equals mongoose model and this
will allow us to import this user just
directly and now we have this function
user that we can now use as we expected
and it's all good moving on we have
another error now where we have property
ID does not exist on type object empty
object and if we look at this user we
see that it's coming from serialized
user and serialize user has some types
and this is this is the part where I
kind of lied to you we're not completely
doing the entire conversion all in front
of you because I went ahead and
downloaded a bunch of Taipings files
what Taipings files are or DTS files if
you're if you're an unfamiliar is they
are the types that power third-party
libraries and there's a large community
of developers on a github repository
called definitely types which have spent
a lot of time taking libraries like
Express and passport and writing all of
the types for every single function and
every single variable and every constant
that's defined in those libraries
weekend that's typescript developers we
can then import those and use those
types to get better type checking when
we're using those libraries so you can
see if I go to my package JSON we have
all of these dev dependencies which are
you know at types async and
Mongo every single one of these is
connected to a DTS file and if we look
at the node modules folder there under
the @ type scope and we can go look at
the types for any of these libraries and
again this is this is work that people
have done for us and we can just benefit
from by just doing a simple NPM install
I've gone ahead and done that already
and so here we have the passport types
and if we look at serialized user we
have all of the types for passport here
and they're saying that you know we're
expecting this empty object and there's
no ID on empty object well the problem
is we have this user and it's actually a
document it's not really an empty object
and so we can go ahead and import that
type from Mongoose and then tell the
type checker that this is in fact a
document so we'll go ahead and do that
and once you have a document you know
users have IDs and all documents have
IDs and so we now get not only
completions for all this stuff but the
type checking is now sound as well but
that's actually not good enough because
this user document we defined we
actually ended up type tacking on some
methods and additional fields and so
what we could do at this point is we see
that user dot compare password you know
compare password is not on document we
could just say you know what I don't
really care about the type here I'm just
gonna put in any on it and ignore types
for now and move on but we can actually
do better than that so instead of
putting in any on it we're actually
going to create the type for user so I'm
gonna come back to user and again we'll
go kind of grab this just for the sake
of time but I a interface which defines
the type of this document we've made and
by dropping in this interface and we'll
export it as well you can see we have
email password all these properties we
added as well as the compare password
function and we added types to all of
these things and so now when we go back
to our our passport
we can decorate this with a user
document instead of just a document
you'll notice that I haven't imported
but I can use vias code to auto import
that for me and you'll see we get user
document up here you'll see now our
error has gone away and in fact when we
try to reference this user we get all of
our properties that we added as well as
the functions we added and so adding
types can give you just a little bit
more support in your tooling but again
if you want to you can always just slap
on any on it for time sake moving on we
have two more errors this one we look at
it we can see cannot use new with
expression whose type lacks a call or
construct signature this is a situation
again with the import our user we're
trying to do this as the normal es6
import but really we just need to import
the user that we switched earlier and
now you can see all of our errors are
gone except for this pesky TS configure
which we're gonna pretend like it's not
there because i've never seen that
before so now we have no more errors if
we run TSC you'll see that it will take
all of our typescript files it will
compile them it will dump them into
distributors folder it will run the type
check it came back clean so we have no
errors and now if we've run node on the
dist folder server we can see that
everything does in fact still work
oops and I can you know log out and do
all the things I would expect but
everything is now typescript right and
so in just what about ten minutes we
were able to take a basic Express app
kind of convert all of the the imports
and exports start adding types and
creating them in modules when we wanted
to but now we can proceed however we
want we can type as much or as little as
we feel and so we can look at some other
examples of where we can add types to
make things easier here is a very common
we have request and response coming in
this callback when I type request dot I
get nothing right because we don't know
what this request is this request isn't
any it could it could literally be
anything we can do better than that
and so we'll go ahead and import from
express itself request in response and
these are types that will tell us
exactly what these requests and response
objects hold and so now when I put
requests on this type in response you'll
see that our our completions get much
better as well as the documentation that
comes with it gets better and so if I
want to look at the render method I can
see that the docks that go with it and
so this saves you time from having to go
pop open the Express documentation read
exactly what parameters render could
take if you want to you can go to
definition on this and you can see all
of the different options that come in or
even the overloads for the redirect
method and it just makes your life a
little easier but again you don't have
to you can use it wherever you want to
but not everywhere so you might be
thinking types are great I want them
everywhere I want you to tell me every
time I could be doing better and we
actually have a solution for that it's
the strict flag and we can set that in
TS config that is not what I want you
can set that in the TS config just like
any other option by adding strict true
and this will basically tell the
compiler go do every single check you
know of I want all of it and so it'll do
some extra strict null checking it'll
check functions and as you can see I
have about a bazillion more errors it'll
even tell you every place where you
could have a type but you have an added
one yet and so if you look at all of the
other request responses they will come
out with an error and this is useful if
you want to get the most checking
possible there's a lot of potential and
the types of compiler but again it's
strictly optional you can use it when
you want you don't have to use it all
the time but this kind of compiles you
know write code compile loop is kind of
tedious so I can show you real quick how
to set that up in vs code to make it a
little easier I'm gonna go to my package
JSON and this is this project is powered
by NPM scripts and so we're just going
to add a TS Seawatch
tasks here and I'm going to pass in TSC
with the - W flag which is just running
TSC with a file watcher and now I can
add to my main watch task a type script
step this is basically using
concurrently which is a package that
just runs multiple external tasks at the
same time
you see I've a SAS compiler I have node
Mon running and now I'm going to add
typescript
this will basically allow us to
constantly be compiling and recompiling
all of our typescript code and so we'll
say TSC watch and now when I say npm run
watch you'll see it's kicking off the
SAS compiler the node node maaan process
and typescript and every time I change
anything it's going to recompile it's
going to launch a node again if we have
to if it crashes and it's going to
recompile all my SAS which is cool so
now I can just launch this watch task in
the background ignore it and then go to
town writing code and my server will
constantly be updating in the background
one one last little tip that's pretty
cool if you open task JSON you can
actually map this to your normal build
tasks this is the build the default
build in vs code that's control shift B
if I say instead I want this NPM script
to call watch I can now kill this
process hit ctrl shift B and it will run
my NPM run watch task and so now when
you launch vs code you can hit control
shift B it will launch your watch task
and now you're off to the races
alright so hopefully you got to see a
little bit of what types we can do but
if you've never used typescript before I
encourage you to start with TS check
just grab any one of your JavaScript
files throw TS check at the top and just
see what happens
worst case is it comes back completely
clean and you're awesome you also can
add types whip to any workflow I showed
you Express here today but you can add
typescript on top of front-end code back
in code any node library it's really for
you to use however you want it
this was just a simple example it's also
worth mentioning that this example is a
subset of a larger example we maintain
at Microsoft typescript node starter if
you want to see everything we did here
and use that as a template to play
around with if you just go to this
project you can clone it and it has all
the tasks built in for you and it's a
great place to start and then finally of
course typescript lets you focus on
creation the point of all these tools at
the end of the day is to help us build
more cool stuff whether it's node or
typescript or any libraries and I
encourage you to take a step back and
think about the tools you're using and
how you could be more productive and
focus on shipping better code thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>