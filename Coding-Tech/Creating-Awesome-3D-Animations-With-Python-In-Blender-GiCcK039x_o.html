<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating Awesome 3D Animations With Python In Blender | Coder Coacher - Coaching Coders</title><meta content="Creating Awesome 3D Animations With Python In Blender - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating Awesome 3D Animations With Python In Blender</b></h2><h5 class="post__date">2017-09-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GiCcK039x_o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">blender is an animation program a
full-featured one that is very similar
to others that you might have heard of
like three studio max or Maya modo or
cinema 4d full-featured it has modeling
and sculpting tools like this called
Maya made by a friend of mine called
fear also a texturing and shading and
lighting rigging and animation lighting
and rendering it actually has two
rendering engines one is called a
scanline engine it's a simple one for
stylized graphics and the other is a
photorealistic paths tracer called
cycles near one they're also compositing
and video editing tools a game engine a
full-featured game engine with logics
and script ability camera tracking and
green-screen VFX tools simulations like
cloth fluid smoke particles and both
physics and the difference between
blender and most other animation
packages in 3d is that it's free and
open-source the thing I'd like to focus
in this talk obviously is letters Python
API so blender has other Python API it
allows you to create custom tools
perform a dimension of manual tasks and
do write scripts that also enable you to
access the full range of Python packages
out there we do that mostly using one
library with any blender called bpy or
blender Python - blender Python a module
and it allows you to access scene data
scene is actually the collection of all
the objects that you animate within the
program so all your models and light
sources and textures and whatnot in
animations and rigs so you can access
them through the bpy module you can also
manipulate and generate objects within
the scene you can emulate UI commands so
let's say you want to automate something
that an animator or a model is usually
performs by hand you can access the UI
commands and automate that you can also
load an export assets and you can create
new menus and panels and add-ons with
you know either the existing or new
logics and operators so if you want to
help
animators you know customize their UI to
make things more efficient for them you
can do that as well would be p1 but
there's also a few other modules that
you can import within a blender that can
help you do other stuff like B mesh the
mesh is a more recent module that is
very efficient for the manipulation and
creation of what's called polygonal
meshes polygons in 3d are object that
are comprised of three main types of
elements vertices edges and faces and
most of y-you know of and I've seen from
3d printing or games they use polygons
most of the time there are other types
of geometry you can work with in 3d like
NURBS and other surfaces but this is
this module helps you work with meshes
there's also the BGE module that's the
blender game engine module that allows
you to you know write complex logics for
the game engine and interactive
experiences in general the bgl the
opengl wrapper blender allows you to
work with an OpenGL viewport and you can
actually add some functionality to it
through this one there's BLF for also
with the opengl module showing text so
enhancing the UI with text and there is
Matthew tails which is a specific module
for vector matrix and geometry
functionality it's very efficient you
could actually import it for any of your
other projects it gives you access to
very simple and very nice vector math
and matrix math without you needing to
you know do any linear algebra by
yourself so it's really nice there is
actually a lot more going on here that I
haven't mentioned these are just some of
the more commonly used modules so this
is going to be a very very practical
kind of inter
into this topic and I have some examples
that I'm going to show you and you can
find them in this github repo this
presentation is going online so you'll
be able to watch it later so in this
example we are going to actually
generate cubes 50 cubes randomly in 3d
space so let's start I'll go over the
code and then we'll see this with any
planner so the first thing we do with
this script is gonna import the bpy
module bpy something that you can import
when you write a transcript and you run
it within a blender so once you import
it you have access to everything
underneath that module that library and
we're also gonna import the Rand int the
random integer function from the Python
standard module random so something that
I this is a good opportunity mention to
mention is that blender actually uses
its own Python that it's bundled with
any blender but this is a standard
Python so you can import any standard
Python library and you can also install
any non standard library sometimes
causes some trouble and you can also
find solutions to that which I'll
mention later but this is a standard
module sore we're importing just around
int then we want to generate just 50
cubes and random location of course
we're gonna iterate over 50 instances
with a range function and then we're
calling an operator so here I'm gonna
just jump into blender and I want to
show you how it's how it works here
within a blender so I'm just gonna
really quick copy the same commands oops
don't wanna be in a catalog so this is
letter we have the 3d viewport here we
have an on line or not on line a an
interactive console for real-time typing
of commands right here and this is a
text editor which I can just launch
scripts within it so I did a quick setup
of the UI and when when you get into
that you find it it's not difficult to
do this setup it's not the default way
that the blender loads but it's not a
complex thing either to do just gonna
put the same text highlighting on so
then we have from random import rent and
and now we are going to go do this for I
in range 15 as I said I'm calling
actually an operator and
to sing bpy so what is this okay so ppy
gives us access to a wide range of
things within a blender if I go to the
interactive console where I have
auto-completion Taibbi P Y dot and then
if I go and press control space I can
see that I get a whole lot of stuff here
I have the app commands the contacts
data off staff and other stuff so I'm
accessing accessing the ops collection
here which is the collection of
operators operators are all the commands
that blender holds within and actually
all the UI commands are operators as
well you can see that the operators are
also divided into various categories
lots of custom categories actually what
we have in the example here is a mesh
operator that I'm launching so it's a
mesh operator because we are generating
a mesh cube so I'm gonna get into the
mesh and inside mesh we have again
various kinds of operators so the
operator we're gonna launch is called
the primitive cube add a primitive in 3d
is a simple object a simple shape that
you start with usually and you usually
build on it but we have a few different
permits here so there's a circle and a
cone and cube and a cylinder and grid
and not others other shapes and we want
to add a cube and this operator has
various parameters which we're not gonna
address actually in this script we are
going to address a specific parameter
only which is the location let's get it
back to the presentation so what I'm
doing here is actually generating 50
cubes I'm not I'm calling the primitive
cube add operator 50 times every time
when a different location that is
randomly generated so we have a R and
end between minus 10 and 10 for each of
the three axes in 3d XY and Z okay it's
very simple so let's repeat that here so
let's give this a little bit more space
so be able to read a little bit more
comfortably and then all I need to do
just run this script some Jonas is gonna
press run script here and we have 50
randomly placed cubes on 3d space okay
so that was a very simple
let's try and go to it another simple
example just with again for generating
cubes but this time we're going to
generate cubes along a sine path of the
sine curve so we're importing vpy again
and this time we're going to import from
amount of the mass standard library the
function sent for a sign let's do that
right here so I'm gonna replace the R an
int with importing Senate and then again
we have of 50 cubes but this time I'm
gonna give the XYZ values so all the
cubes are gonna have an x value of 0 and
the y value of I which is a current
iteration number and the Z which is the
height in blender the z-axis is the
height axis is going to be the sine
value of that I that we are currently
iterating over okay so let's let's try
that ok and now the location is going to
be just x y and z all right so if I
launch this I get cubes along a sign a
path or a sine curve and they're quite
tightly packed they're actually one
inside the other because the standard
cube has a size of two units so if I
want to space them out a little bit I
can just add or a step or just I'm gonna
double the Y value and maybe the Z value
value as well and then we have slightly
larger sign list of cubes okay so those
are two very simple examples let's just
see them right here let's go to a
slightly more complex example again with
a sine curve but this time we are going
to generate a mesh so instead of just
for the bunch of cubes we're gonna
generate a specific curve curved mesh so
this is gonna be slightly more complex
though not by much and I'm
numpy here for a very simple function
from numpy and we are gonna see an
example doesn't crime play as well
because probably not but is not
installed here at least not any blender
so let's go over a slightly more complex
example okay so now as I said I don't
want to just create random cubes or you
know cubes aligned on a path I want to
generate a whole new mesh so mesh as I
said has three types of elements it has
vertices which are points and it has
edges which are the lines connecting the
vertices and it has faces which we're
now using here but faces are the thing
the claw encloses the mesh within a
shell so a cube for instance we go to
the blender and add a little cube a cube
is a mesh that has it has six faces
because it's a cube and it has eight
edges and eight vertices okay so these
are the vertices and there are faces and
edges so we are going to generate 100
vertices so the way we do this is we
actually go and after we generated a new
mesh and how we do that let's go over
this for instance for a moment just so
everything is clear again we're
accessing vpy but this time we're going
to the data collection which you can see
here let's go to the interactive console
again bpy data has lots of stuff so it
gives you access to everything within
the scene so there are the screens of
the UI under the objects and there are
images that you might load as textures
are used for anything else curves of the
cameras and brushes and also meshes so
bpy data measures that's what we're
accessing here and we have a new
function to create a new mesh and it
returns that mesh right here to this
reference M now we have 100 vertices
that we want to create so we access the
mesh within em and go to the vertices
collection because it's a mash it
already has the vertices property or
collection and then we
call the add method with the number 100
to add a hundred new vertices and then
we also want to add edges but in this
kind of a line we need one less edge
than the number of vertices we have or n
minus 1 so we created 99 edges for the
hundred vertices so we have and then
what we're gonna do is actually we want
just to have the Y value on the y axis
we just want to have evenly-spaced
values between 0 and 10 so I just used a
numpy little space linearly spaced
values function here of course we don't
have to use this one and I'll probably
show an example in a second that doesn't
use those space but uses just a function
that I wrote and we get all the Y values
here 100 Y values for this list and then
we iterate over those and this is kind
of a silly way to use soup here I could
probably use I've used enumerate but
never mind this is gonna work and we
just have is the number of iteration the
current iteration and Y which is y value
and then we go over each and every
vertex within the vertices collection
and we give the coordinate value this
following three values so for X all
vertices get a zero and why we use the
linspace values here and then we use
just the sin or for a sine value of y of
Y sorry because we don't want to have
you know we want one or less edges than
the number of vertices I have a little
conditional here so if I is just not the
last one
everything about the last of value here
we also give the edge the vertices that
we want which is actually the current
vertex and the next vertex in the list
ok so I and I plus one then we just need
to create an object so why do we create
an object blender is very efficient
which means that if you want to
manipulate meshes you can do this
virtually without seeing the mesh in 3d
space at all so it can just be a
collection of data just like you know
with adding script this is not 3d and if
actually want to see your mesh you need
to link it to your current scene as an
object okay an object in leather is
anything that has a number of specific
data types so it could be a light source
it could be a camera it could be a mash
it could be a curve it could be various
things so I'm gonna create a new object
I'm gonna call it sin and it's gonna get
the mesh data and then we just link this
object to the scene and let's load this
script here and launch it so this is one
without numpy actually the only
difference is that I just wrote a little
space method here that does the same
thing as a non-violent space but the
rest is the same and you have more
common seriously you can read this and
github script and what we get here is
this curved mesh okay so it doesn't look
like much because it doesn't have any
volume we can use some of blenders
modifiers
okay modifiers are sub programs to do
various kinds of stuff to give it up
very quickly for instance we have the
skin modifier that already gives it some
depth then we can add some other
modifiers do all kinds of stuff like
subdivision surface so it could be just
look a little bit more curved nicer and
of course these two steps that I just
did could be automated very easily I
just didn't want to go too much depth
with a very you know introductory script
but this is very simple to do in this
script as well add these two modifiers
so what I'm gonna do I'm just gonna
continue some of my examples it until I
run out of time so let's see another
example so here what are we doing is
actually I'm gonna just skip it to the
slightly more complex version what I
want to do is I want to import a CSV
file and generate a 3d chart from it
that is are also going to be animated so
it's actually going to do this every one
of the bars within the values in the CSV
is going to just rise up this is a real
3d chart not like in some other apps
that you might have
generating three charts but with and
also has a date so let's have a look at
this this CSV so the CSV file looks like
this let's just open it and okay so it
looks very simple it has dates and sales
and simple integer values
that's the CSV file I'm not actually
going to open it because it's not that
interesting but what I want to do I'm
going to go to blender and load this
script so we have CSV - blender and I'm
just gonna change the path here so let's
run this and then we'll go over the code
I'm gonna run this and let's see if the
works right made some issues okay so we
have this little chart from the CSV
let's go full screen and if I launch an
animation will see that these bars
actually and immediately move with the
animation so let's see how this works
okay so first I'm importing bpy of
course vpy is our basis for most blender
scripts and then CSV and then what I'm
doing is importing the radience function
because rotation in blender is usually
in radians not in ordinary degrees and
then we have a file path for csv we're
opening it with a csv package csv file
and then because I really don't like CSV
actually this is the package I'm just
gonna generate this into a list of data
so we have this data a list with is
still list comprehension and I'm
omitting the titles okay so this starts
from one this is why the slicing here is
performed to just ignore the titles and
this little line here just summarizes
the sales so that we can have a total
number of sales the total count of the
sales that we can then normalize our
sales with accordingly okay so we have a
few little parameters here
that control the animation that you just
saw okay so the duration is the number
of frames for the scaling operation
scaling is the change in size that you
see here for the each one of the bars it
takes 20 frames okay that's just a
duration okay
it's the interval between the start and
the end of the animation
and then the interval between animation
so between 1 and bar and then the next
bar animating is 5 frames okay so that's
this value and then this will we just
iterate over over each row in this list
which one a row has a date and then a
sales value of managers sales value for
each one what we do is this we have a
sale height the height is the height of
the cube that we're going to generate
here in a second so what we're doing
here is we are dividing the current sale
by the all sales stuff so this is just a
simple way to normalize this value so we
can have relatively easy see differences
between the different bars and then
you've seen this operating before we
generate a new cube for every one of
those sales and it's radius meaning that
general initial size is 1/2 unit and
blender and then we're just placing the
location here so the location is set to
be on the x-axis one next to the other
with a difference of 1 a blender unit
between each cube in the other cube and
the next cube so that will be this one
and 0.1 0.1 because I just wanted a
little bit of spacing between them they
all start on the zero a y-value so
they're all aligned on the y axis and
then z is their height I'm not going to
go over this in too much easier you can
examine this and the blender in the in
the repo and github
generally what we do here I'm gonna go
over to stuff we haven't seen before so
another thing you can do is generate
animations and glide
programmatically so I'm actually doing
something that is called inserting a
keyframe
okay keyframes are a way to animate that
it doesn't require you to set values for
each and every frame in your animation
so instead of you like starting and
setting this pose and then it's slightly
different and slightly different and
then it's slightly different what you do
is you have one pose and keyframe it and
then the second post keyframe the other
one and you have an interpolation that
automatically moves between the two okay
so that's a keyframe we're inserting
here updating the scene and then just
generating some text so I'm just gonna
leave it to you to examine just wanted
to show this as something you can do and
you can see this the entire code here is
just let us see the number of lines here
just 50 lines so it's not complicated to
do this you just need to get
familiarized with a blender API a little
bit some things I want to just mention
about this whole thing that are tricky
and you need to be aware of those when
you write blender scripts one is that
you can use UI operators which is very
convenient when you're trying to emulate
what you do manually but there are
lower-level solutions usually to
everything in blender so it's not always
the most efficient way to emulate what
the user is doing through the UI usually
you can do things in the lower level
directly within a script so it'll be
more efficient so that's one thing to
note the other thing is that some
operators need a context so for instance
when you want to open an image in
blender and use it as a texture you can
call an operator that he operates within
the image editor so it's a window within
blender and if you try to run this
operator outside the image editor it's
gonna fail because it will tell you the
context is incorrect I'm supposed to run
within the image editor you can override
that and you can do other stuff or maybe
you can just add the image in a lower
level way but this is something to be
aware of also not all UI elements are
accessible through Python
some of them are actually written in c
plus plus and you don't have access to
them directly when you want to automate
them so that's something it could be
rough most of them are but not all
they're also felt something called model
operations so a script to run very
efficiently this freezes the UI so when
you launch a script blender is not gonna
respond to it to your mouse or keyboard
at all until it's finished unless you
write something that is called a model
operation it has a mode so it has a mode
for waiting and a mode for getting input
and then a mode for running so you can
do that but it's not the default way of
script runs so just need to be aware of
that there's there's also view dependent
operations for instance I can cut a mesh
from where I'm looking at it through the
camera I can for instance look at this
cube from this direction and if I cut it
we cut in this kind of way but if I look
at it from here it will be cut
differently so that's view dependent and
sometimes you need to set the view
before you run an operation and another
thing that is tricky is that the API
changes rather fast and you need to be
aware of that sometimes a function it's
usually backward compatible but
sometimes it won't be and sometimes you
need to just change something or add a
parameter so that's something that's
also important to know so if you want to
start and get into this there's the
official documentation within a
blender.org
website which is pretty nice and pretty
detailed not always but most of the time
and again a nice development environment
is blender itself that has this
interactive console and the script
editor right here but of course you
don't have to work with it you can work
with other sources or other IDs you can
also compile blender as a Python library
just import it to your Python script and
you can setup eclipse for debugging in
real time with breakpoints and anything
you want it's a little bit tricky but
it's it's not too bad and you can do
that there's a link here for doing that
there are good resources
is out there like the Blair Stack
Exchange page this is a really active
community there are amazing people there
I got answers in less than 30 minutes
really complex questions before so it's
really helpful there are good blogs
they're actually my blog here as well if
you're interested and there's a this
little code snippets page which has a
lot of practical examples so if you want
to go and have a look at some more
complex examples there's this nice
little audio visualizer you import an
mp3 file and it generates an audio
visualizer so it's moves with the music
and you can create cool animations that
respond to your audio file and there's a
few scripts in my github page you can
explore like this spiral generator and
lots of other stuff and of course since
blender is open-source you can actually
of course write directly in C++ and do
whatever you want and this is rather
rare I've been writing Blaire scripts
for several years now and it's really
rare that you really bump into something
that is not accessible through Python
it's usually something like a very
special kind of UI element in a specific
window and usually you don't need that
you can do stuff in different ways but
if you really have to yeah you can
access it in C types or just write
directly to the source additional
questions yeah
well you are ok so there's various ways
to do that actually one way to do that
there is a nice project called blend4web
that allows you to take a blare scene
and actually generate a web of you from
that an interactive and web view where
you can do all kinds of cool stuff it's
based on WebGL for the web and it's
actually if anybody here is familiar
with 3j s the library in JavaScript for
3d in the browser it's an alternative to
that and it's really integral with
blender so you can generate dynamic
views or even games rather easily from
blender and generated on the web so
that's one way to do that any other
questions ok thanks very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>