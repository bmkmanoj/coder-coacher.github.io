<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Programming Is Fun (aka The Fun of Reinvention) | Coder Coacher - Coaching Coders</title><meta content="Python Programming Is Fun (aka The Fun of Reinvention) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Python Programming Is Fun (aka The Fun of Reinvention)</b></h2><h5 class="post__date">2018-03-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Je8TcRQcUgA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">and really the topic is talk is about
really kind of just the fun of Python a
little bit a little a little bit of
history on this it also turns out that
this week is essentially the 21st
anniversary of me giving a talk at a
Python conference I first spoke about
Python it the fourth international
Python conference to 60 people so that's
it was about 60 people showed up it was
held out in California Lawrence
Livermore labs the picture in the
background is the huge fusion laser out
there and we got a tour of that it was
very cool sort of my exposure to Python
I came to it through the route of
supercomputing so obviously want a lot
of stuff that's physics computational
science and basically everything was
painful about this just this horrible
experience it's like C and Fortran and
bad she's drifting and and all this
stuff and we sort of brought Python into
this discovered about it reading in a
physics magazine Paul du Bois who is
since long retired from the Python
community had written an article about
it and we sort of saw that really I call
it looks awesome
and in the experience of doing that it
was just this awesome fun project I mean
I you know I think about how god that
was really fun doing that work and I
sort of think about like well why was
that so much fun to do that project and
I think there were sort of a number of
factors to it I'm one it was just the
fact that we were sort of reinventing
everything that we were doing I mean it
was like we were taking this really
painful process completely putting a new
spin on it it's just fun to do that you
know it's fun to kind of rethink things
but there were also facets of Python
that we're sort of great to I mean one
of the things that we've loved about
Python is it seemed very playful I mean
even even like simple things the fact
that you could have the repple and just
sit there and type commands we thought
was cool I mean that you know the fact
that you could just interactively do
things and just get immediate
gratification we thought was awesome I
mean it was keep in mind I come from the
world of see right it's like you had to
compile everything and it's like super
painful the other the other thing that
was really
about it was their work was very much
kind of a do-it-yourself kind of kind of
Essos to it or aspect to it
Python really let us build a lot of
tools but just kind of Chloe kind of
random things together I mean it's an
example of this a lot of a lot of the
work in Python I was at you know the
National Lab where the typical solution
to a problem was to throw money like we
have a lot of problems like visualizing
data and so there's solution to the data
analysis problem as well as just by a
million dollar Silicon Graphics machine
and you guys can use it and turns out
that was totally ineffective and what
was effective was sort of building our
own little skunkworks visualization tool
by kind of ripping apart this program
called exif ii i don't know anybody ever
used exif ii ÿû is this old like X
Windows program for visualizing stuff we
took the code for that and kind of
ripped it apart and put a Python
interface on part of it some sockets and
we built this whole visualization system
keep in mind this predates any of the
cool tools that you have now I mean
there was no mat plot or anything like
that so you had to really kind of roll
your own some other some other things we
really liked liked about Python is it
was just totally magical what you could
do with the language I mean sure the the
like the the repple was cool but it was
also really cool that you could get your
hooks into the language and modify it to
your own evil whims so even even
something like this you know like you
have like a container class you know the
fact that I could make one of those
things and then and it assumes that I
can type here and then hook into it we
just thought that was awesome I mean
essentially you could make Python kind
of do whatever you want and this was
actually a key for a lot of like early
playing around with Python like a ray
processing libraries and like clicking
Python it to C code Fortran codes and
stuff you could bend the language and
kind of adapt it so that was that was
pretty cool the other the other
interesting thing about it was highly
unpopular at the time too so at work we
got a lot of pushback because we were
using Python on supercomputer
and there was a sort of a feeling that
that was not appropriate like that that
was not a real programming language what
are you doing and doing super computers
you know I don't use Fortran why don't
you see I gave a talk about Python at
the supercomputing conference in the US
this is a conference that draws about
four to five thousand people and my
Python talk was in a room about this big
with 20 people so actually if you get a
talk and nobody shows up it still might
be important so keep that and keep that
in mind they're also just just giving
talks at various places we also got a
lot of kind of interesting responses I
gave up I remember giving a talk at
Stanford at one point about halfway
through the talk this computer science
professor kind of chimes up he's like
mr. Beasley could you give me a formal
definition of a scripting language I'm
like what is that kind of question is
that I think I think I responded I know
it when I see it which was not that was
not that you know another another place
you know give a talk at NASA and
somebody at the end how do you get
permission to do this project and I'm
like permission we didn't ask permission
either so so anyways it was a lot of
money a lot of qualities there but then
there's this this passage of time okay
so you have this fun project time passes
and there's sort of a feeling you know
if you if you program long enough that
you're fun kind of project sort of turns
into this you know I have a I think this
is this picture of what it's like a ship
shipping ship shipping shipping chips no
no I went around recently and I've put a
whole bunch of Python version numbers on
there and it's like okay I got my Python
program and you've got Python 2 in
Python 3 and Python 1.5 and all this all
this stuff you know it's like what
happened to your to your fun project to
be honest you know the Python 2 to 3
thing there there are some issues there
I mean it's not not not exactly the
easiest transition and people love to
love to gripe about that but one of the
things that I do spend some time
thinking about
is can you go back to that that earlier
day can you can you get back into like
the fun of reinventing things and not
not worry so much about like the Python
3 2 thing and and other things and I
guess the the reason that I've been
thinking about this is that lately I've
been working on some projects of
different sorts I mean maybe you've seen
some of these like there's like a curio
project is something I've been working
on I've been working on some parsing
projects and I've just been having like
a tremendous amount of fun with it I'm
sitting there in my office I'm just
think kindness is so cool like it
reminds me of what I was doing 20 years
ago and in thinking about the the reason
why I honestly think it might come down
to Python 3 6 I mean I'm doing some
stuff in Python 3 6 and I'm just kind of
amazed that you know it Python 3 6 if
you haven't used this it's probably one
of the most major Python releases as its
ever been made a short of Python 3 as
far as just new features and new cool
stuff and so in thinking about this talk
it was like should just do something
cool with Python 3 6 you know just kind
of like just throw out all the rules and
do this like Python 3 6 talk also I'm
kind of vamping on the 21 year aspect so
in the in the US when you turn 21 that
is when you can first legally drink
alcohol and usually it is a highly
reckless horrible experience on like all
accounts there but is it like you just
sort of throw all caution to the wind
and you have that so I iced not 21 years
of Python I should just do this like
recklessly you're responsible Python
talk here live coding and other other
things so so probably the most insane
thing to do during a talk would be to
write a framework from scratch or
something so we're gonna we're gonna
bring to do that in a second here the
right guess that's the other F framework
okay and then and and just as a preface
before doing this if you're gonna do
anything that follows here call it a
prototype everybody everybody has a bet
standard just claim or everybody well
don't do this at work I'm not gonna say
don't do this at work I'm just gonna say
call it a prototype that was actually a
standard strategy back in the 90s if you
wanted to get your work to accept Python
what you would do is just call what you
were doing a prototype and you just say
yeah yeah it will rewrite it in C++
later
and then you know you get the whole
thing working and realize that it's
gonna cost like 50 million dollars to
rewrite and C++ and it's like okay so so
just disclaimer there and then the other
thing that we need to do before we write
this framework I thought I would talk
about two things that you can do to put
old Python out of its misery like if you
really want to get rid of the old Python
so one thing that you can do is start
using F string this is my bad dead
parrot on that top of the gravestone
there so if you haven't seen f strings
before they were just awesome I mean it
essentially is a new way to do string
formatting in Python where you can kind
of embed in variables in there if you uh
enclose them in curly braces but f
strings are actually much much cooler
than that one of the things about f
strings is that you can also put like
expressions in there like that so that
is that is sort of beyond what you would
do with sort of normal normal string
formatting so that's that's kind of cool
you can also put things like like
modifiers in there like if you wanted to
change the I don't know what changed the
formatting and since in some way with
like like padding characters or
something you can you can do that if you
really wanted to make people kind of mad
at you maybe one other thing you can do
is is even put like f strings inside of
other F strings
this is gonna test my my my skills here
but the if you do is different quoting
you could you can you can do that I'd
probably just like spare that you know
maybe don't don't go down down that
route but but if you if you do use f
strings you will pretty much guaranteed
to kill off every prior version of
Python it's not even syntactically
correct and anything before Python three
six
so that's um that's one tool for for
doing that actually I think I'd maybe
had programmed F strings too much before
preparing the abstract to this talk like
you know if you look at the description
it's like the F of the F of the things I
was doing doing that the other the other
thing that you can do if you really want
to go modern is you can rely on the fact
that dictionaries are now ordered by
default I don't know whether you whether
you knew this or not but if you uh if
you put things in a dictionary they
preserve their order so if you if you
make a dictionary and then convert it
back to a list it goes back in the order
that was created I have to I have to
warn you I thought talk from Pike Cod
where Brett cannon born to people at
least like four times not to rely on
this in your code is like not a
guaranteed feature of the language and
since I'm not a core developer or on the
PSF I'm telling you that you absolutely
should rely on this I mean it is it's
awesome and the only way to make it a
required feature the language is to rely
on so I don't think bread is an Israel
so a little little safe at the moment
but yeah we're it prototype it's a
prototype exactly exactly yeah alright
so those are the two things to start got
to cleanse the palate of Python too and
like relying on dictionaries being in
order in F strings it's one really great
way to a great way to do it but then but
then what we have to do let's think
about this this framework that we're
gonna build okay so if the I guess I
should say you know where do you want to
go today with this framework what I'm
gonna start with is this GCD function
and maybe not the most exciting function
but basically computes greatest greatest
common devisor one of the things that
you know about Python is that it's
pretty freewheeling concerning things
like data types and type checking and
other things like that and you can call
this function with inputs that might not
make sense like you could do a
floating-point numbers I'm not sure how
to interpret that may be the difference
between Python 2 7 or the greatest
common doesn't do not divisor of 2 7 and
3 6 is almost zero maybe you can read
something into that and maybe you know
maybe you can pass in strings or
something and then you'll get kind of
cryptic error messages this is the kind
of thing that you see when it's like 4
o'clock in the afternoon is somebody's
not converting data off of a webform
correctly or something and they're
getting like extremely cryptic error
messages so so the thing that we're
gonna we're gonna think about here is
what you could do to fix the problem so
and you know people people look at that
Python it doesn't have types
everything's runtime checked and so
forth maybe maybe we need to turn it
into Java or something I don't know we
need a different picture for that so
instead of the green field in the
background or you want Python to be more
like the movie Brazil or something
ok so so one of the one of those one of
the things you might see in in Python
are like this move to put things like
type annotations on the code I don't
know what you I don't know what you
think about those who's been around
around it for a while the only issue
with those I mean aside from making it
look like their types they don't
actually do anything ok so it's so they
don't they don't do things they also
have a have this this feature that they
make python look like it's compiled and
frankly I just don't know whether that's
a good saying I I don't know what
prompted me to do this but I looked up
the definition of compiled in the Oxford
English Dictionary and this is what it
came up with this is a photograph of
that I mean the first definition is fine
you know to put too
but then what is the second thing like
to plunder pillage rob steal snatch
together and carry on it's just not
making me want to compile that okay so
okay so so there's that so what we're
gonna do here is we're going to take a
slightly different spin on this we're
gonna focus on checking but what I'm
gonna focus on instead is the use of
assertions and contracts this is uh this
is I think it often an overlooked
programming technique for for checking
things I admit that I'm probably a bit
biased towards it partly because of
doing a lot with scientific computing
and we used to use Python interactively
a lot and one of the nice things about
contracts is that they actually are
enforced like so if you put that in your
code I mean they will definitely fail
you got an error back you know and that
was a really important thing for me
working with don't cream with physicists
and stuff you know getting a useful
error message back so this is this is
what we're gonna focus on and we're
gonna we're gonna make a framework for
this so so we're gonna start with that
and we're gonna make a little little
thing called contract here this is sort
of a it's gonna be a framework for
enforcing basically assertion or
contract and one of our goals here is to
use Python three six features as much as
possible we're essentially throwing
caution to the wind here and we're gonna
we're gonna use a lot of stuff and maybe
a secondary goal will be to infuriate
people as well keep in mind that you
know a goal of of reinventing things is
to upset people you know the naysayers
and stuff and we'll do it we'll do a bit
of that I guess with that and uh one
other comment on this on the talk here
usually when people talk about
frameworks they have like talks with
lots of pictures and stuff you know dogs
and clouds and all sorts of stuff as far
as I know this might be the first talk
where the pictures exist before the
framework so they have some
inspirational photographs you know to go
along with the coding here we're gonna
we're gonna flip it around and the the
first inspiration here
is if you're gonna build a framework you
got to start with inheritance partly
because you know inheritance is really
gonna mess with people people tend to
hate inheritance and classes and stuff
so well we're gonna base our framework
on is basically this idea of being able
to check a classical contract and here's
an example of contract maybe I have like
an integer and what I'm gonna do is have
a method that basically checks that okay
so we're gonna put our assert in there
somebody last night was talking about
the bad bet it's a backslash is I'm
gonna use backslash is just because it
you know that irritates people as well
there okay so so so so a contracts gonna
look like that and essentially this
thing you can give it a number and it
will either work or it will fail so if I
put in put in by 2.3 it will come back
with a failed assertion so the idea is
that in my code instead of having the
like the manual asserts like that I'll
have these companies contract checks
okay so we can check a we can we can
check me
okay so we'll use that as kind of a kind
of kind of a starting point let's let's
let's make sure that it works here okay
so it so it makes that bit now having
just one thing like that okay so one one
contract that's not so exciting so
probably what we would want to do is
make some other ones like maybe make one
for a string maybe we want to make one
for a float or something okay so what
we're gonna do is kind of fill out this
you know this this code with different
different kinds of contracts that you
can that you can use since we are
working on framework code I'm gonna keep
in mind one of the goals it's probably
to use inheritance as gratuitous lis and
as much as possible I'm you might look
at that and say no it's flooded what a
lot of repetition there maybe maybe I'll
generalize this into something like
like a typed class and we'll do a bunch
of inheritance on it so what work what
we're gonna do here is essentially
assert that the value is an instance of
some type like that and then we'll use
an F string just to break the universe
here okay so keep keep my way we want to
we want to use Python three six features
as much as possible so I'm going to do
that and then what I'll what I'll do is
is modify these things to just just
specialize it okay so we're building up
let me offer a little a little little
contract system here I don't see anybody
running for the exit yet so I think
we're I think we're okay here okay so so
we've got got this little little
contract thing keep in mind the way that
those are gonna work is you know you can
you can try these things out and they
should either fail or pass okay so you
can you can you can try these try these
things and they'll either pass or give
you an error now one interesting thing
with these contracts is you're not
limited to really type checking I mean
this is actually one thing I kind of
kind of like about about this contract
idea is you could put other ideas in
here like maybe you have a contract that
expresses the idea of something being
positive that's something that's
actually a little bit difficult to
express just in the concept of like a
type necessarily and it's something
something else so you could have things
like that you could have maybe a
contract or something being non-empty
okay so same same idea here maybe assert
that the length of something is greater
than zero yeah I'm violating kept eight
okay I suppose that's good good as well
okay so okay so you could you could have
different you know different kinds of
things here where you can you can try
different things out you know like a
positive check you know minus two and it
will will
and then you can maybe even combine some
of these things in your in your code
like maybe you want your your function
there to have like multiple checks so
you have an integer and you have a you
have a positive I'm gonna make sure that
that actually works here so okay so
that's that still works if you do
anything with bad values though sorry
the wrong key there it will it will
crash that or if you give it like
negative numbers you'll you'll you'll do
that okay so this is this is kind of our
starting point got this this contract
system there well one thing that you
might want to address at this point by
the way is the fact that you've got
these like these two things kind of
combined like integer and positive there
if you wanted to fix that one thing that
you could put into the code would would
be the super function we're gonna go
through all our classes and we're gonna
put a you're going to put a super
function in there the interesting thing
about doing that is it lets me do things
like this yes multiple inheritance but
if you really want to make people angry
about this call this technique
composition know now that you're
composing integer and positive together
into one one one thing so yeah if you
really want to make people angry call it
composition so it will it will check to
things and then if you if that is not
enough like if they're still not angry
just claim that super is the glue that
holds composition together okay so
that's a little bit of a little bit of a
little bit of a side there but we're
essentially sort of making more more
interesting kinds of kinds of contracts
here so you can you can clean that up
now one thing that that you might think
about doing at this point is we've got
this
tract is maybe you don't entirely want
to abandon the the attributes or the
took that the annotations I mean Python
does have this feature where you can
annotate arguments like you could you
could come in here and say hey is
positive integer and B is positive
integer like that maybe maybe that is
something that you that you want to do
like maybe you want to support that the
problem with doing that is that again
they don't really do anything so if you
were to if you were to do that and you
were to spell it right I mean I guess
that's come on Python you're supposed to
know that okay okay so let's say you you
you spelled that right there
they don't actually they don't actually
do anything so they think these
annotations they have no effect at all I
mean essentially what they what happens
is Python stores those as a attribute
annotations but doesn't doesn't doesn't
actually do anything so if you wanted
something to happen with that one way to
do it might be to do a decorator of some
kind so there's gonna be a crash course
in writing a decorator okay so I have to
switch to the decorator picture here uh
host it knows so what I'm gonna what I'm
gonna do here I'll kind of explain a few
things this first thing that I'm
importing if you've never written a
decorator is a just a function that
helps you kind of preserve metadata
about functions and the other thing that
I'm going to import here is something
known as a Sigma signature and I'm gonna
write a decorator where basically you
give me a function and I'm gonna pull
off the signature of that saying and I'm
gonna grab the annotations off now let
me let me explain a couple things about
this the signature thing for for a
moment here this this is something that
you maybe have never seen before in code
but essentially what you can do with it
with a signature is you can use this to
get like the calling signature of a
function they'll tell you like what the
names of the arguments are and other
things about it and one kind of
interesting thing about signatures is
that if you happen to have
arguments sitting around you can you can
do what's known as a binding step like
you can bind arguments to a signature
and then what you can do is look at it
afterwards and it will tell you what you
got it will say well a is 4 and 5 and B
is 5 now why that is useful to us here
is I'm going to use that to enforce
those contracts so when you write a
decorator what you're doing is putting a
wrapper around a function so what what
I'm going to do is I'm gonna I'm gonna
do it like a signature binding on those
and then once I've got that I'm going to
come in a walk through all the arguments
and then I'm just gonna validate what
was there so like if the name is is in
that annotation dictionary I'll look it
up and I'll check the value so what
we're doing is taking those annotations
and then kind of enforcing the enforcing
the rules on that so if I've done that
correctly famous last words
the the function should now be enforcing
those rules okay so we've kind of taken
that that we brought the annotations
kind of kind of back into the picture
there
I could but not in the time allotted
yeah there's a there's a there's a
there's a lot of features that could be
added here so hopefully through multiple
inheritance but that we'll take that
offline okay so so if you got the
annotations now having having done that
yeah yeah we're we're gonna dig the hole
deeper here a little bit okay it's up so
having having done that one of the
things that you might want to do is
think about like well how would this
extend to something like a class
definition okay so let's say you're
gonna you're making a game of some kind
you have a player this is gonna be the
worst game you know player where you
have a name and you know like an XY
coordinate or something and maybe you
have some other methods on here like
they don't the only thing that you can
do is move left and right okay so let's
say you had a class one thing that you
might think about here it's just like
could you enforce type like the type
stuff on this class you know you have
the attributes but Python doesn't really
enforce anything like I mean you can set
them to bad values you can pass in all
sorts of you know garbage and it will
basically blow up and you can you could
say well is there some some way I could
do do that um one of the one of the
techniques that you might know about is
you could maybe enforce things by
through properties this is something
that's been around been around for a
while
essentially what's happening with a with
a property is you can take over the dot
so maybe maybe you do that I need a
picture for taking over the dot here
okay so like a weasel writing a bird
there okay so so if you if you were to
do that and then try to try to set the
value to like a bad type it would blow
up because you've essentially taken over
that over the X attribute but writing
that just is horrible I don't want to I
don't want to do that I don't I don't
want to write properties like that
instead what I would really like to do
is use some of the secrets known by the
framework Bill
so if you've ever used things like
Django or sequel alchemy here other
things you may know that they work in a
different way one of the ways that they
that they can work is they can own the
dot using something known as the
descriptor protocol this is not going to
be a full tutorial on that but
essentially you can implement like get
and set methods in a different way and
what I can what I can do in here is
essentially re-implement like the
setting I'm an attribute I can say want
you check it and then once you've
checked it I'll reach down into the
instance and set the dictionary to
whatever the value is okay so that's one
of the things that I can do and then the
next thing I can do which is a Python
3:6 feature is i can put a message set
name on here that sets the name of this
thing and those two things alone
basically introduce a whole bunch of
magic to this class what I can do in the
class now is I can use my contracts I
can say name is non empty string X's
integer keep in mind if you've ever used
something like Django you've seen this
kind of style being being used there so
I'll put that on my class and then all
of a sudden through magic and I probably
have a typo and actually what did I so
did they call it positive integer oh I
never did on non empty string okay well
we'll make that really quick you can
make anything really fast with multiple
inheritance so that's the you never
never use two too much multiple
inheritance care and and I have to fix
the other spelling okay so so you have
that and then what will happen at this
point is you'll find that those rules
are now being enforced it's like okay so
X is being enforced if you tried to set
the name to an empty string it would
crash or if you said name to 123 it
would crash you've got this you've got
this type checking then kind of that is
kind of it's kind of Awesome it didn't
take a lot of code to do
but you made this this this like sort of
little framework thing here
alright so so we've got that we're still
not kind of kind of done with it though
because one of the things that's really
annoying is the difference between the
GCD function in the player specification
I don't know you can see that or not but
like up in the function we've got a
colon positive integer down here we're
doing name equals and then we have to
call it as a function
I kind of hate that so what we're gonna
do to fix it is when you use another
Python 3 feature which is basically
class annotation you can say what's a
class annotation well it's kind of the
same thing as a function annotation you
can come in here and modify those to two
attributes like that
and what happens with that ok the first
thing that happens is that you're gonna
lose all of your type checking those
don't actually do anything they're
exactly like the function version
essentially they get stored on the class
but they don't actually do anything at
all so that is a little bit a little bit
unfortunate but we can fix that the way
the way that you fix it is we're gonna
use inheritance yeah big big big
surprise there
you can fix it Sam going to be quoted on
this talk like you can fix everything
with inheritance so you can never have
too much inheritance you're gonna get
people really riled up yeah and what
we're gonna do to fix it is we're gonna
use yet another Python 3:6 feature which
is the ability to monitor classes that
you're created there's this new method
or you can say an it subclass and what
happens is this will fire any time
anybody inherits from you so what I'm
what I'm gonna do in here is I'm gonna
put in some code to to basically
instantiate the contract so I'm gonna
I'm gonna do like for name Val we're I'm
gonna look at the annotations of this
class and I'm gonna make a contract this
is kind of like doing the integer paren
part
okay like that and then I'm gonna set
the name on to the name and then I'm
gonna I'm gonna basically put it back on
to the class
think of this as doing like a little bit
of brain surgery on the class when you
do that and what is going to happen when
you do that is now all of these
annotations are essentially going to be
enforced it's it's magic essentially
what happens is this this this top-level
class here can monitor the definition of
the of the child you can go in and like
fill in fill in details we can do some
other stuff while we're added in here as
well one one thing that we could add is
maybe a generalized init function now
what I'm gonna do here is I'm gonna
assert that the like the length of the
attribute of the arguments is equal to
the links at the annotations and then if
it's not we might as well just throw it
there to it as f string in here okay so
maybe that another thing that oh and
then we're gonna rely on another feature
here which is basically the order
dictionary feature since since all
dictionaries are ordered we might as
well use that so so what we're gonna
what we're gonna do here is basically
iterate over the zip of those two things
and set up attributes on myself okay so
you could you could do that another
thing that we might do while we're at it
is maybe give it a nice wrapper string
of some kind this is also relying on the
fact that dictionaries are ordered so
I'm being I'm being bad here so okay and
then we might as well use another F
string while we're at it
so no F F strings are really kind of
cool
one of my favorite uses of them by the
way is to do stuff like this it's not so
much output but like making error
messages and exceptions and stuff so so
maybe maybe we do that if we do that
then we can get rid of the anit function
and we'll keep our fingers crossed that
it actually works here okay so we've got
this this thing we can make a make a
player object it has a nice repres
and it has the type checking kind of
kind of turned on there I don't know how
are people doing with this still hanging
still hanging on there we're bending
python to our whims here we're not quite
done with it yet one thing that you that
you may want to do is maybe you want to
allow this I mean we did that stuff with
like tamp type annotations earlier maybe
we want to have that on a method like
enforce positive integer on the left and
right thing turns out that we can do
that as well if we come up to this an it
subclass thing and maybe apply the check
decorator to do that we can walk over
the class dictionary and we can sort of
say well you know if something is
callable why don't we just replace it
with a with like a checked version of
itself you know apply it apply a
decorator on that if we do that okay
let's let's see if it still works here
you still have then still the type
checking
but now the the methods also have their
assertion kind of kind of going on there
so we're sort of we're sort of bending
things even further with that and keep
in mind there's a lot of Python three
steps three six stuff kind of in play
here there's like these annotations
there's you know the ordering of
dictionaries and other other things so
so we've kind of we've kind of taken it
to that level
I even did it without my special magic
annotation slide there okay so so let me
let me pause for a second let's see yeah
people still with me we're not done yet
we have were to take this into like an
even more dangerous territory you know
you know second here the the place where
we're going with this next has to do
with the problem that I've written all
this code basically in a single file I
don't know that you write all your
Python programs in a single file or not
but probably not so so what's gonna
happen typically is that this player
class is probably gonna live somewhere
else you're gonna have a different
different file where this disc gets used
and unfortunately when you bring it to a
different file it's not gonna work
because I'm not doing all the import
statement like I have the base class but
in order to make this work I'm gonna
have to suddenly put like a bunch of I
don't know I'm gonna have to start
importing a lot of and I'm look at that
I'm gonna get really annoyed and then
I'm gonna start import it now it's not
good it's you know okay so you know you
know I'll do the star import and and now
I've just opened myself up for all sorts
of abuse you know I mean like my
coworkers are gonna hate me for doing
the star import your IDE is gonna look
at that star import and it's gonna put
like sunrise highlight on it you know
it's it's it's not it's not it's not
good and I'm gonna do a solution to this
you're not gonna like it but it's gonna
rely on these lesser-known a twentieth
cent of Python item which is more
implicit is more than implicit okay I
don't think you realize that there were
twenty items in the sin of placement
okay so so what we're gonna we're gonna
do for that no you're not going you're
not gonna like it is I'm gonna I'm gonna
come to this contract class here
I'm gonna make a dictionary and I'm
gonna use this this magic an it subclass
method again keep in mind that's a
Python three six thing and the thing
that I'm that I'm going to do here is
I'm just gonna I'm gonna keep a record
of all the all the classes that get
defined so it's not much code but what
that's going to do is it will just keep
track of all contracts all contracts
that have been defined through magic
just adding that it's like class
registration thing okay so I'm going to
do that
and then and then what I'm going to do
is I'm going to naturally I'm gonna have
to introduce a meta class you knew that
this was probably coming at some point
so if you haven't done meta classes
before I'll talk about the gist of what
what I'm gonna do here so I'm gonna make
a meta class it hurts from ty and one of
the things that I'm going to define on
here
is something known as the prepare method
and normally what the prepare method
does is it returns a dictionary now it
turns out that this dictionary is what
is used to execute the body of the class
but you're not you can you can do
something else there what I'm gonna do
is I'm going to use something from the
chain from the collections module known
as a chain math I guess it's just as a
note all serious magic and Python will
eventually involve the collections
module so you're not not using that you
should probably probably use that so so
what I'm gonna do is is return a chain
map that consists of an empty dictionary
and that contracts thing that I just
made earlier now to know just to
illustrate what is going to happen here
normally when you define a class like if
I were to say defunct like class player
you know base like that normally what is
going to happen there is Python
goes to this type function and it
basically says call the prepare method
with the name of the class and then any
base classes and then a dictionary comes
back what I'm doing is I'm doing
something sort of way sneakier where I
have a prepare method
where if you give me that same
information it will come back with a
magic chain mask insensitive an empty
dictionary and all of those contracts
combined together you're like okay
that's kind of kind of interesting
what's what's interesting about this
chain map also is if you start modifying
things in it what ends up happening is
you have two different dictionaries in
play there's there's there's kind of
like the first one that holds the data
that you're assigning but then there's
this second one that has all of the
other things that you loved that you
thought you'd find there so I'm gonna
I'm gonna return that back and then I'm
gonna do another thing with this this
medical ass here not gonna like it but
that's okay so what I'm gonna do here is
I'm gonna discard the contracts part of
this and then I'll return like the
normal normal use here okay so I'm gonna
do that now what that's gonna allow me
to do it's something way way way WAY
worse than the star import now you're
gonna you're gonna you're gonna you know
love this keep in mind like what was the
sin of Python it was more implicit as
more than implicit okay so so we're
gonna do that what that's gonna allow me
to do is just an import of base it's no
star import and just based on that it
will magically work and the thing that's
really horrible about that is that none
of these names are in the environment
integer is not in the vironment
it's not in the it's not in the class
you've set these types and they like
somehow spontaneously exist in some
weird fold of the space-time dimension
essentially so instead of getting the
flame on your code when you do that
instead you're gonna get you're gonna
get this know sort of the you know that
the head exploding image of sort of like
well where are these things
where are these things coming from yeah
I don't know okay so yeah the crowd
isn't it's like okay that's just just
just horrible it turns out that you can
you can actually take this one step
further as if you didn't think that was
possible
if you're willing to use the chain map
in one other place like in this
decorator here what I'm gonna do here is
I'm going to take the annotations of a
function combined with a look at its
global variables
you're not gonna yeah this is this is a
really horrific ly bad bad idea if I do
that I can come back here and do one
other really sneaky thing and this is
also a Python three six thing I can use
what's known as a module annotation so
I'm gonna write an annotation called DX
positive integer and then I'm gonna take
that off of my function you see there
were this is going here okay so so doing
that by the bike by the way this is sort
of a reinvention of something that I did
in the swig project called a type map
and if you've ever encountered that
you're gonna want to chase me down and
beat me later so so so so what is what's
gonna happen with that is that the I
have a syntax error okay let's let's oh
I'm missing a parenthesis okay well
welcome back fix that so if you if you
do that you're gonna find that you that
you have all this kind of magic stuff
going on like you can you can check the
types if you if you call left with bad
values it enforces that you look at the
code and it's like what this is just
nuts what's what's happening it's
especially down here with like the left
and the right somebody's like how is
that even being enforced you know so
here like a different
explosion explosion image for five for
that so so so you look at that I mean it
okay so just going through that I'm not
suggesting that you necessarily copy
this or do this but it's kind of typical
of like like what I find my experience
in Python three six to be lately or it's
like this is just awesome I mean there's
like all these like little awesome tools
going on I don't think any of this
really involved what I would call like a
gross roundabout necessarily I mean like
these these things like an it subclass
method and so forth I mean those are
just parts of the language do you use it
you don't have to like you know they've
been kind of driven by by other things
so you also so some people might look at
that so that's that's crazy
but could also look at it and say well
that's just that's just awesome
back to green feels it's like it's cool
you can bend the language in different
ways so so we've got a better framework
here we're almost at the end I just I
got some comments on this there are
gonna be naysayers to this whole oh yeah
yeah yeah no no no people are gonna hate
this big-time then there was a big
Twitter exchange recently you know that
yeah the lifes get the life cycle of
Python fried programmer you know you
scape Java and C++ and then you know
there's this whole thing where it's like
oh I don't have to type types and I
don't need braces and wait now I can do
all this magic and like do everything
and then you know the the you know glyph
is like Oh what have I done
I offered some snide comments oh you
solved your problem I don't know I in
defense of this I will say I did this
might be kind of I don't know maybe kind
of controversial I don't think people
would use Python if you couldn't do this
and no I'm serious I think here's here's
my rash now all of these frameworks that
people love to use Django numpy pandas
all of that stuff they do tons of magic
to make that stuff work and to make it
friendly for people you know to do
things so so no I would not advise
writing like a meta class for a script
or something like I'm just like doing
like some shell scripting no I'm not
gonna do that but that the ability to
really kind of bend a Python to
different problem domains and stuff I
think it's a really cool part of a port
of Python and I think it's really fun to
kind of kind of do it so I wouldn't I
would definitely encourage you to go
make the next fun prod package and have
fun with this and also not to be afraid
of kind of reinventing saying so I mean
oh you don't know I'm not suggesting
that any of these things necessarily
need to be reinvented but if you're
sitting there looking at these packages
you might you might say well you know
I'm not gonna do not gonna do HTTP
because you know like request has
already solved that problem or something
I mean it's I think there's always kind
of an opportunity for rethinking things
I actually I crossed out packaging on
here not not so much that it doesn't
need to be reinvented but there's just
no fun to be found there so I wish that
kind of kind of kind of wish that on
anybody there but then some that is
pretty much the end of this no no I I
you know I I you know thanks for kind of
listening to that I hope that maybe this
is a you know like a kickoff for other
talks in the conference I think people
are talking about some of the more
nitty-gritty of some of these things
like you know descriptors and Python 3 6
and metaclasses and other other stuff so
I encourage you to kind of have fun at
the conference and that's it I'm
basically done with it
I I don't know if we're doing Q&amp;amp;A how
are we doing on time five minutes of Q&amp;amp;A
I don't even know if there's a mic
floating around if there is you can talk
about okay okay well let's see if
there's any questions or thoughts oh the
presentation tech well I I can tell you
that this is running in the terminal
like so essentially I have like you know
I have Python you know this is this is
like an editor so you can write code in
there and I can have it run the code
itself it actually is running in the
terminal yeah that's
the images is kind of a mystery here
yeah I was early always I was I think
played a couple weeks ago is tweeting
about writing my own text editor this is
that project this that the presentation
the presentation code is written in
Python it's it is not pretty
I can tell this is part of it I mean you
could see like some of the imports on
this it's it's it's doing a lot of stuff
with like term iOS like low-level
terminal control and other things they
at the the image stuff am using a
feature I term to to do inline images so
but yeah the presentation is was a
Python script running in the terminal so
you can you can ask me about that that's
later I was actually trying to think
about you know I've done some live
coding talks it was like how could I do
to really mess with people on ADD like
you know they you know there's there's
doing the talk in the repple but then
there's this thing which is like maybe I
should just do the repple in the talk
and why some somehow fake people out so
alright let's see if there's other
questions so there yeah one over here I
can put it online but I'm not I don't
know if anybody's written like a
contract like equivalent to that or not
a lot of a lot of emotion in with with
types is all focused around like the
mypie project which they're probably
gonna come running after me as well for
for stealing their annotations but then
that's okay okay cool all right well I'm
gonna Nonna clothes here thank you very
much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>