<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building A Radio Data Network With NodeJS | Coder Coacher - Coaching Coders</title><meta content="Building A Radio Data Network With NodeJS - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building A Radio Data Network With NodeJS</b></h2><h5 class="post__date">2018-01-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4eAQ8SCyIkM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so before I actually start I'm gonna pre
start I have this this remote-controlled
car and about a year ago I wrote a abort
a piece of hardware a radio that it
could connect via USB to my computer and
I figured out I could because I'm a
JavaScript developer so I could use
JavaScript to talk to the radio
obviously because why not be invent the
wheel and this radio is super cool
because it can not only receive radio
wave but it can send radio waves and you
can you can program that and software so
it's like let's see if I can remote
control a car using javascript so let's
see if can we get like that camera up
there on the screen instead of my No
okay so now I'm pressing forward here
and the car is it's kind of movable if
you can see that pressing backward
there's no way to get that camera under
there
well it's okay you get the point so I
can use my computer here to control to
control the car very simple that's not
what I'm gonna show you today so it's
not super important and and when I build
with a built this a year ago so one
thing is that you can you can basically
emulate the the normal remote control
you get with a toy car but the cool
thing is you then you can like program
in maneuvers so that you could automate
like certain things so me and my friend
Matias we we've built like a 180 turn
way where we saw that go forward for a
little bit then block the wheels and
turn right to the car the car kind of
slides out and then we put it in reverse
and go backwards so so that's kind of
how this looks this is all automated
using using node.js with a little bit of
slowing down you can see he's really
happy
so software right okay so Who am I
my name is Thomas Watson I do a lot of
open source software on github you can
find me there
I'm a node.js engineer at elastic and I
tweet on Twitter so yeah so the the the
title of my talk is building a radial
data network with Nokia so I got this
about a year ago and I played around
with it and then I was thinking okay
wouldn't it be really really cool if
basically because I'm a JavaScript
developer if I could like we
implementing Wi-Fi in software right so
you have two of these I could make them
talk to each other and we could like
this dream data over the radio waves so
so that was that was the goal of me
making this talk and this talk is
basically me kind of taking you down the
path of what I had to learn to do this
so the concept or the field that I'm
working in here is called
software-defined radio and it kind of
make makes sense if you think about it
this is a radio and we control it using
software a lot of the normal stuff
that's in a radio like a lot of the
hardware stuff that's normally inside
the radio have been taken out and you
basically get raw access to the voltages
on the antenna either sending setting
those voltages or basically sending
radio waves or receiving those voltages
so so basically there's a little bit of
there's a little bit of of filters and
and amplifiers and there but other than
that you basically buy the USB you get
like the war radio packets and so I
define radio is nothing new so at this
company eros Research is probably one of
the most famous for doing
software-defined radios but it's super
super expensive you have to be like
doing something in a lab where this
makes sense this
starts at $5,000 and upwards but then
something happened this this guy here
you can buy today on an Amazon it's
basically a USB TV dongle that you can
you even watch a TV on your computer and
listen to to FM radio it's very cheap is
like 10 to 20 dollars but the cool thing
is that it contains this real check real
tech ship that is super hackable and
somebody found out that they could
actually access the chip directly and
then it actually supported a range from
24 megahertz to 1.7 kick Hertz
so with this you can basically listen to
airplane traffic you can listen to a lot
of other interesting things and do it
all in software so that's kind of how it
all started then a little bit later this
guy came came along and that's that's
the the the piece of hardware I have
here because this can also transmit it's
it's a top affronted project it's
open-source hardware and it compared to
the first one I've shown you it's pretty
affordable about three hundred dollars
so to do this you first need to needed
to learn radio as I said I'm a software
developer so radio hardware all that
stuff is pretty new to me so I needed to
figure out what radio actually is and
and this is said this is the most basic
form of a radio wave or any kind of wave
actually it's a sine wave it's a most
basic form of wave you can you can you
can have and what you can do with array
they said you could modify it's it's
it's frequency so the distance between
the peaks and the values of the wave if
they get longer apart you have lower
frequencies they get closer together you
have a higher frequency you can also
change the amplitude so basically how
much voltage you put out on there
tonight get a higher amplitude low
amplitude I'll do a voltage and when I
assess this when I said this is
basically the fundamental wave
it's true because you can from that wave
you can generate any other kind of wave
so if you take the wave that goes in
through this microphone it's turned into
a electricity as I speak and it is of
course that wave doesn't look like it
and I sign wave but it compose it is
composed of basically a lot of sine
waves so and computers they're pretty
good at doing working with sine waves so
basically all we have to figure out is
really how to manipulate sine waves in
software then we can generate any kind
of wave
so once we've learned that the next
thing we want to figure out is how do we
take how do we we need to do something
called modulation and modulation what is
that
Wikipedia have this very boring long
thing about what modulation is which I'm
not gonna bother you too much with but
basically it's taking it's taking some
information and encoding it onto
something else in this case it's between
code the information onto to waveform
but this is not something we've only
done with radio waves you could say we
kind of done this forever we taking the
we're taking and modulating the the
smoke with our message so and then we
get smoke signals which is basically we
if the the early form of modulation if
you so if you stretch your imagination a
little bit but the actual real
modulation came with the invention of
the Telegraph and The Telegraph is a
circuit which is either open or closed
so either there is power or there's no
power it's very very simple form of
modulation either there is something or
there is not something it's very binary
so to say the next big step forward and
the first time where this actually
became airborne was with the invention
of AM radio
or radio it was just called because
there was the only kind of radio there
were so AM radio the reason why it's
called a.m. is because it stands for
amplitude modulation and the reason is
that when I speak I actually produce
waves in the air air molecules are being
pushed and that's how you can hear me
speak in this case it's picked up by the
microphone turn into an electric signal
which is basically also a way but it's
moving really really slowly
and we could second take that wave and
plug it directly into the antenna but
the issue is that we would need to have
a really really big antenna because
they're slower the frequency the height
that the larger than 10 oh we need and
it would be totally impractical to send
and receive waves in in that speed so we
need to speed it up very very fast to
get it into smaller antennas and so the
way a.m. goes about doing this is that
to take the very slow-moving wave and
that you see on top then there is a
what's called a carrier wave which is
base that's the frequency you're tuning
to on your radio and it takes the shape
of the slow-moving wave in this case it
could be a song you're listening to on
the radio it could be my speech and it's
changing the amplitude of the carrier
wave which depending on the amplitude of
the slow-moving wave and then you get AM
or amplitude modulation so after that
frequency modulation came it's a little
bit more complicated but it's basically
the same thing you have the slow-moving
wave on top you have the carrier and red
and then in the bottom you have the
frequency modulated way where the
frequency basically changes depending on
the incoming signal so we've had that
for a long time and that's worked very
well for our radio AM FM but what about
digital so digital modulation is close
to the same red a little bit different
so what's the most simple form of
digital modulation let's go back to our
telegraph key here
you think about it it's basically a
bunch of ones and zeros either that the
circuit is connected or it's not
connected right it is what's called
on-off keying and that's actually what
this radio the the radio inside this car
is doing it's sending a bunch of ones
and zeros using on-off keying and that's
what I've emulated or or replicated with
my radio here so if if the carrier wave
is present it's a 1 if the carrier wave
is not present there's a syrup so that's
the most simple form of of the digital
modulation and in this case a 1 bit is
what we call one simple and as simple is
like a the atomic piece of information
we we are transmitting we can only
transmit one symbol at a time over a
radio wave so in this case the simple
rate is equal the bit rate and what I
wanted to find out is to speed this up
how can we maybe have more bits per
symbol
because that's what's all the cool kids
are doing today in radio so in digital
modulation that's basically three types
of modulation and by the way before I go
any further I know this is super theory
and all that stuff I'll get to some some
demos soon and it this is taking me a
long time to understand so I don't
expect you to grasp it all and you of
course welcome to talk to me later or
ask me on Twitter or stuff like that but
just to let you know this is this can
get a little bit hairy anyways so there
is in digital modulation there is sweep
basic types of modulation that we make
use of and combine in different ways so
there's the amplitude modulation as we
saw before we call it amplitude shift
keying when we are talking to digital
modulation there is frequency shift
keying which is basically the FM and
then there's another thing we haven't
looked at before which is phase shift
keying
where we change basically remove the
peak back-and-forth move the remove the
face of the of the of the side wave back
and forth to and depending on where the
peak and the valley occurs that then
that's either a 1 or 0 or some something
else how many remember one of these a
little bit elderly audience here so so I
used to go online with one of these
actually this is one of the older models
56k modem and the reason why it's called
a 56k modem is because it can transmit
56,000 bits per second but you probably
when you when you were using these you
probably came across another term called
bored so this was an 8,000 bored modem
which basically means how many symbols
it can send per second so this this
particular modem can send 8,000 symbols
per second so there's 8,000 times a
second 8,000 times a second it does
something to the wave to change it to
send a new symbol so it basically means
it can send seven so seven bits per
symbol so in some way it manipulates the
radio waves so it can send one piece of
information a symbol but that simple
contains seven bits so that's how it
gets the bandwidth up so we've got a
fast forward really really far here and
talked about basically the the one type
of digital modulation that everybody is
using today
it's called Kwan or quadrature amplitude
modulation your phone in your pocket
today is using Kwan the Wi-Fi that
you're connected to is using Kwan
everything today Jews acquire so to
understand how cran works and I'm sorry
this is
I'm sorry I have to do this to you
I mean I I had to read up on this as
well because I did not I was not a good
student so so it but but it is actually
really simple if we have an angle on a
circle and we take the sine value of
that that's basically the y axis how far
the y axis that we are we that that we
are going if we have a length of 1 and
the cosine is how far out the x axis we
are going and so if you think about a
sine wave a sine wave is basically the
YX is the point on the y axis just going
up and down and up and down as you have
the angle going around and around and
around on the circle so that's your sine
wave and similarly the the cosine wave
is that the x axis and if you plot the
two together you have these two curves
two waves which is about or not about
exactly 90 degrees shifted so the peak
of one curve becomes 90 degrees delayed
from the peak of the other curve and if
you think about it if you have these two
waves you can actually pinpoint any
point on this circle so you have an x
and y coordinate system and the way that
all of these software defined or 99% of
these software-defined radios work is
that they they work with these numbers
we call them complex numbers we don't
going to go into that but basically we
it works with an X and O and x and y
coordinate system of these two waves in
the end those two waves are kind of be
combined into one wave and being sent
out over over the antenna but when we
are working with it in software we just
have these two numbers that we've always
manipulate
and so we always think about this thing
we call the unit circle and the unit
circle is basically the distance from
the origin and then one out and that is
that that gives us a point on the unit
circle which is the cosine and the sine
of the angle and using this information
if we are clever enough about when we
look at the point because the wave is
the wave of course moving all the time
but if we agree like okay we are going
to look 8,000 times a second and we're
going to start now and we're going to
then dun dun-dun-dun
then we can actually manipulate the wave
to be at a specific point at this point
we can we can make sure it is it is in a
specific place around this circle 8,000
times a second and so we can then agree
that if we if we find the point to be in
the upper left corner it's a it's two
bits 0 1 and then upper right corner is
two bits 1 1 etc etc and that's just
manipulating basically these two waves
then we can get four points
suddenly we managed to encode two bits
into one symbol but this of course can
go up from there so we have 16km where
instead of only manipulating how it goes
round we also manipulate the amplitude
basically how much power and then we can
have four bits and if you have the 256
crammed we have actually a full byte of
information for each point and then as
the time moves on we just make sure to
remove to move that point around and as
long as the center and receiver is an
agreement of when to look and that's
some of the tricky part but there's some
math and how we can agree on these
things then we can actually send bytes
really the high speed you know with the
radio weights so unfortunately we're not
living in a totally quiet world there's
a lot of radio waves there's like
lightning strikes there is somebody
turns on the microwave there's a lot of
rain
you're going around so there was this
gonna be errors in in signal so the next
thing I needed to figure out when I was
looking into this so now I have the
theory on how to pack bits really really
tightly but I need to era correct
because errors will happen and we all
computer people we know that oh if I
receive a packet with tcp/ip and I it's
corrupted in some way or maybe I didn't
receive it so I'm sending back a signal
to the sender saying oh I didn't receive
this package or it was corrupted can you
please send it to me again that doesn't
always work in radio it could be that
you have a sender receiver situation
where the receiver can only receive it
has no way of sending or it could be
that the distance between the sender and
receiver are so great that it's simply
impractical to send a message back and
saying I want to get this data again
like think about how are we talking to
the Rovers on Mars for example they said
there's a long distance the turnaround
times is too big so people have been
thinking about this of course since the
early 1950s and in 1949 they invented
something called goalie codes that was
actually used on the void to to probe to
the on the Jupiter and Saturn missions
in the late 70s early 80s and then in
1950 Hamming codes were invented and
it's actually used today in all your
your servers for ECC memory and the
reason why it's called ECC memory is
actually because it stands for error
correcting codes and then in 54 are
something called Weedon reed-muller
codes were invented that was used on the
Mariner spacecraft and in 1960
reed-solomon codes which was also used
on the voided two spacecraft were
invented and it actually also used in
CDs and DVDs and blu-rays and backhoe
today the reason why if there was a
scratch in your in your DVD it's not
because you have a super powerful laser
that can kind of look through the
scratch it's because it's using we
solvent codes to figure out what the
missing bits are it doesn't need to you
don't go back and get a new CD you can
actually figure out what the missing
bits that was supposed to be there in
the square
and then today everybody is using turbo
codes so your your phone in your pocket
are using LTE it's using turbo codes
that's basically the new kid on the
block that everybody is using today is
used in everything from deep space
satellite communication like today
that's that's the thing the easiest
thing to implement in in understand is
hamming codes but it's really not that
great if you have a lot of errors in
your signal so either it's resolvement
code turbo code today and luckily we we
have NPM so we didn't need to reinvent
the wheel so we can just do NPM install
Reis almond and then we're good so
that's taken care of and and then we
then we just need to basically put all
this theory together in in in software
and then hopefully it will work
so I built
I built this electron app and the reason
why I build it in electron oh wait a
second the reason why I built it in
electron and not just as a web browser
was because I need it I needed to be
able sorry I needed to be able to talk
to the usb so here I'm listening on 27
megahertz which is the frequency that
this remote is operating on and this is
a remote control for the car let me just
make sure I switched it off so when I
press forward here we can see there
there is a signal at 27 point one four
four megahertz there's a little bit of
aliasing on the other sides but the main
signal is on 27 point one one one four
four so this allows me this this allows
me to look at the signals and to do a
lot of interesting stuff it also allows
me to graph what I'm sending so
so basically I I have a message I wanna
sent in this case it's hello Island I
prepend a preamble to kind of let the
receiver know that oh now the actual
missus is coming I turned that into bits
and then I turn those bits into symbols
in this case I'm using Guam for
so the 144 bits needs to be sent in 72
symbols and then if we the blue line
here is actually the the resulting radio
wave that I'm generating if you zoom in
there we go oops there we go here we
actually see that as as the bit the
simple changes I'm changing the face
basically shifting the way that that
this angle is is kind of placed using
using this wave so here instead of going
continuing up it's suddenly like it's
like it's on a different place on the
circle so I'm kind of changing the
location on the circle that that the
point is right and when I get the new
bit so and then I have the received
signal and in this case I've kind of
cheated a little bit so I've hard coded
it kind of the amplitude that I went
when I'm kind of considering that a
signal is I have a minimum threshold of
when a signal is coming in normally what
you would have to do would have to do
some what's called Auto gain control
where kind of the the further away that
the sender was from the receiver the the
gain of course is like it's a fainter
signal so you have to kind of
artificially compensate for that to kind
of get a uniform again across the entire
radio spectrum so but
cheat a little bit here and then finally
I'm basically running that thing in
Reverse where I kind of encoded it and
getting the bits or the symbols out and
then from the symbols I get the bits and
the message I sent was hello Island and
the recovered message from the radio
signal was hello Island so it woods
suburban says if you ever get a hold of
one of these and I can really recommend
that these radios here you can use my my
monster drift application you could do
NPM install monster drift you can remote
control any any car any toy car and and
then if you want to just get like really
get it get into the the dirty details of
how to work with this hack RF hardware
in with node there you can do even
install the hack RF module which gives
you like raw access to to sending and
receiving data and by the way this one
can send and receive on every frequency
from one megahertz up to six gigahertz
so you can send FM radio if you wanted
to do that should probably not because
that's illegal you could unlock cars you
could do stairs new stuff
and finally there is great cut catches
calm which is where about this one
that's the the guy who made this he runs
away beside great gadgets and if you go
to slash SDR and that one there there he
is done some really really awesome
tutorials on how to understand all the
math and and receiving and sending
signals and how radio waves work I can
really recommend that it's super awesome
which that's basically those tutorials
that company started with this and then
finally you can tweet at me I'll do my
best to help you and maybe we can become
wiser together and that's it thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>