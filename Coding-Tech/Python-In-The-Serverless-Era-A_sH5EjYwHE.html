<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python In The Serverless Era | Coder Coacher - Coaching Coders</title><meta content="Python In The Serverless Era - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Coding-Tech/">Coding Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python In The Serverless Era</b></h2><h5 class="post__date">2018-04-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/A_sH5EjYwHE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so how many of you heard about service
before I guess most of you how many are
using server lists okay so serverless is
the latest evolution of cloud
development you can think of it as an
another abstraction layer on top of
compute and platform and infrastructure
resources which makes it easier for us
as developers to build applications and
ship them but server this is also an
overused term and I'll try to to make
some order in it so there are three main
meanings to service the first one which
I call developer SAS or software is a
service which is designated managed
service managed services that deal with
specific things in the usually provided
by third parties for example if you need
a vindication for for your app you can
use off 0 Twilio for SMS sending algo
Lea for search and you get all of these
out of the box so you don't need to
implement the backend of them another
another meaning for several is back-end
as a service which is things like
firebase and AWS mobile app they're
basically a set of common services that
you will need to build your mobile
application for example you probably
need authentication you need some kind
of a basic data store push notifications
if this is all you need from for your
mobile application you probably want to
use one of the back beckon is the
service services instead of implementing
it by yourself and maintaining a
back-end for this and but there are
still times maybe most of the times when
you have your own business logic that
you need to run on a back-end and this
is the
meaning of survey lists which is faz or
function is a service and their most of
the cloud providers or the the largest
cloud providers have a service for this
so AWS has lambda asher has functions
going without those cloud functions
ibm's bluemix has open wisk which is
also open source and this the last year
when someone mentioned server lists
probably he mentions fast okay and and
this will be the focus of my talk here
so what what exactly is fast so it's a
fully managed compute you get out of the
box a provisioning of an instance you
get the patching of it you get some some
basic monitoring and and logging we get
scaling out of the box and which means
you have less operations for
provisioning instances or maintaining
your your server you take your quote and
and just deploy it package and deploy it
and then the nicest thing about it is
that you pay for the actual usage and
their the resolution of hundreds of
milliseconds which is i think that's the
thing that made server lists or function
as a service that made a hype out of out
of function of the service and basically
it means you have no idle servers no
idle compute so how it works as I
mentioned you deploy your code but then
you need to define triggers to what will
make this code execute and triggers are
many types of events that you can
configure it could be just in HTTP
requests so you define an endpoint that
will trigger your function it could be
an event of uploading a file to the
storage service of the provider that
you're using it could be a change in a
in a database row or a new row in a
database that is provided as a service
by that provider for example DynamoDB in
AWS and there are many other event type
scheduled tasks and and many many others
and they're new
almost every month you can hear about a
new integration with another service in
in that club for that cloud provider and
and it means that the architecture of
the application becomes event-driven
okay and and this is this is a big
change for building cloud applications
if you are used to build applications
that poll to see if something happened
so now it's the other way around and
then when the event occurs it triggers
the specific function that you
configured and the code is being
executed and you don't need to worry
about all the scaling and redundancy you
get it out of the box and the use cases
or analysts these are just a few within
we can have talked only about use cases
but the main things that you will hear
about them is building a back-end so it
could be a web back-end mobile backend
but or another popular use case is that
a data processing using those events of
when files uploaded when something is
changing the database when when you have
a data stream that you want to to
process this is this is very common so
as I said analysts they're so many so
many use cases and every other day
there's a new post about some about new
use case but there are also things that
you need to be aware of when when using
function in the service or service
architecture and I'm not going to go
through them because again it's another
another topic for a full talk but you
need to understand that server lists is
not
Silver Bullet you need to understand if
if it works for your your use cases and
you need to know the limitations and how
to overcome them okay so we got to -
okay we're in Python so let's talk about
Python and function as a service so out
of the cloud providers AWS IBM open
whisk and a Microsoft Azure support
Python both - Python 2.7 and 3.6 sure is
still experimental but you can already
try it but if you already had a chance
to try and and and deploy functions and
configure everything you know that it's
not easy and there's a lot of things
that you need to tweak and configure and
define and package and deploy and we as
developers we're lazy and will always
invent things to make our life better so
they're frameworks for doing this stuff
and these are some I think most of the
frameworks that support Python runtimes
we'll go through some of them I'll start
with server lists so if the term server
list wasn't confusing enough it has
another meaning which is a framework
called serve illness by the way all of
these frameworks are open source and you
can go through the code you can
contribute you can add stuff so the
service framework think it's the most
mature and when I'm saying most mature
it's one 1/2 years old maybe surrealists
is is such a new thing so one half years
in the service terms is a lot that's
that's what makes it most mature and
also support
the different cloud providers and
various runtimes so I want to show a
demo of building some simple Python
application with the service framework
servers surrealists framework itself is
built in no js' you you install by using
NPM install server list and once you
installed it you can create a project
you can create a new project out of the
template using the CLI so this is
something that common to all the
frameworks they usually the way they
work they you can figure you use the CLI
and you can figure a configuration file
with the rest of your code and the
framework does everything for you so I
want to create a Python project for AWS
- to deploy to AWS so they have
templates so my minus t4 template on
have Python this one is as a Python 2.7
and let's see what I get so sorry my dad
I wanted to create a new menu folder
okay
so what I got is I get two files created
for me I got the circle this channel
which is the configuration file and I
got a template of the function the
function itself that I'm going to deploy
so let's start with the Surrealists ya
know from the configuration file you can
see that you can configure the provider
as I said it's not only for AWS but this
project is a template for of AWS and the
runtime is Python 2.7 and I want to
configure that the region will be Oregon
so it's yes West - there are many things
examples for many things that you can do
that you can configure but I'm going to
skip them and I'm getting to the
function itself so this is the
definition of the configuration of the
function so I have out of the template
they created me hello function in the
handler PI file and now I want to bind
an event to trigger this function so
they have some samples here I'm just
coming out the things that I want so I
want to create a simple HTTP API that
when someone calls hello and provides a
name argument and this call is a HTTP
GET call it will trigger my function and
let's go to my function so this function
was created out of template let me just
move some redundant things from here and
what you can see in this function that I
get two arguments the first argument is
event event is the input of the the
input of the event that triggered this
dysfunction and context is the runtime
information about
the specific lambda so I have a body
that that I want to return and I define
the response the status code of the
response and and the body that I have up
above here and I just want to say hi and
I want to get the name out of the
argument that was sent to me so this
argument is in the path parameters and
as we configured in the llamo file its
name is name and that's about it
now I'm ready to deploy all I need to do
is SLS deploy and hope for the best
so what happens now the framework the
framework packages all my code and start
starting to create the resources that I
need on AWS to be able to deploy the
function to bind it to an API gateway
which is the HTTP gateway that map's an
endpoint to my function it also
configures a bucket to upload the code
to it will configure the different
security roles that I need to - for the
API gateway to call the lambda function
and also logs everything that you see
here if I if I wasn't using the
framework I needed to do it by myself
either by going to the AWS console or
using the a double your CLI when here I
did it with just by configuring a
configuration file and using the CLI to
deploy it so it usually it takes a few
minutes it also depends on the amount of
resources that you can figure on for the
for this project hopefully it will be
done
maybe in the meantime I can show you
what other things you can you can define
in the Yama file so I could have defined
that the event that will trigger the
function would be a NS free event which
is the file upload stored the file
upload storage event or a scheduled task
or many other different things that can
trigger my my function I can also ask
environment variables through the
configuration file I can define other
resources to be created on AWS if I need
let's say I want to create another
bucket for my project or a DynamoDB
table so I can do everything from here
okay so it's done I have this endpoint
let's curl it and say hello vikon and I
got it I got the response back then I
need to spin a server didn't need to do
anything to go to a console everything
is here from the CLI okay but that's the
simple case now I want to add some
dependencies to my Python project so
I'll create a virtual environment and
just update my pip bother us okay and
let's say I want to add arrow because I
want to display the time I know I can do
it with day time but I love arrow so
let's do it with let's add arrow and I
also want to create the requirements
file
okay so now theoretically I can go to my
function doing for an arrow at some time
viable that's right at a time
and it's right above the you to see in
and the in the fourteenth time just to
justify my my arrow so it's - yes
Pacific okay but how will how will serve
this on how to package online
requirements and also bind them in the
code so for this the nice thing that you
can do with live server list is that
it's pluggable so anyone can write a
plug-in that hooks into events in the
framework and implement stuff so there
is a nice nice plugin called service
Python requirements I would install it
as I said it's it's node so and I also I
also need to edit to my Yano file to
configure it to configure it to work
with it so let's go to the Yano I'll add
a plugins section and put in here and
again I'm deploying and now you'll see
that it takes the Python packages from
the spiritual environment and it will
create that requirements folder will my
packages and package everything together
deploy to to AWS this time it only goes
for the changes that are needed to be
done so this deployment should be
quicker and let's curl again and I get
all the data time and
and and the message so this was an
example of using circle this framework
let's see another example that is unique
for for python and this is a fragment
called zappa it was developed by rich
jones and the idea of zappa is that if
you already have whiskey server for
example you have flask or jungle and you
want to take it as a whole and deploy it
to lambda because you don't want to
manage your servers so you can use Zappa
for this and it's super simple and the
way it works it it packages your let's
say Django or flask application it it
uploads it to a lambda function creates
a proxy from an API gateway and so you
don't need to define every endpoint that
you have on your API and it handles it
for you and it's super easy because
let's say I have here a basic flask
application with two endpoints it
converts currency so if what I need to
do is just create a Zepa in it I already
pip installed zap ok and when you do
Zappa in it it will just ask you for
different configurations I'm going with
the default here and it created a
configuration file which called Zappa
settings so again here I want to to
change the AWS region and there are many
many other stuff that I can configure
here but will not get into it but it has
a lot of functionality that you can do
here and again Zappa deploy it takes
about a minute and it does again it it
takes the
varam invar the the virtual environment
that you're in it takes all the
dependencies from this environment
packages everything with your code and
creates the needed resources on AWS the
EPI gateway the s3 bucket uploads
everything creates a lambda and and then
you got it okay
so let's take this and so we said that
we have two endpoints so this is the
first one the hello and we have another
that conferred let's say from from
dollars to euros and convert 20
oops to euros we convert 20 dollars and
you you got the response again it didn't
need to spin anything doing everything
from CLI with a configuration there
there are pretty unique features in
zappa for example you can do a global
deployment so instead of deploying a
lambda to one religion you can deploy to
all the regions in AWS there's also a
functionality for keeping it warm it's
something one of the limitations of
lambda where the way it's implemented is
it runs on container and when you're not
calling this container for five minutes
it will become cold so next time when
you call it it will need might need two
seconds to get warmer
so if latency is something important you
get here a kind of a trick of keeping
keeping it warm
it also supports using the lambda
packages and many Linux Wil's packages
which are pre compiled packages for
Python pre-compiled packages that are
suitable for the AWS lambda
instance the linux version that they use
another framework is chalice it's by AWS
it looks very similar to flask
unlike Zappa it creates automatically
creates a separate endpoint for every
route that you you will define in your
code but again it's very simple to use
you create a new project from CLI and
you define everything in your code and
then you deploy last thing that I want
to show you is as it's not a front a
framework but a library called fibrin it
was developed by Eric Jonas he's a
postdoc in Berkeley and it's simply a
library that enables you to take a
function from your code and at runtime
distributed to endless amount of lambda
functions so there's a nice example by
Sean Smith that he used it for web
scraping it created the that's the whole
code so he has a scrape function that
takes a URL and using pyrin you create
the pyrin executor and then you pass you
call to the math rank function of pyrin
and you pass the function that you want
to be executed distributed li and you
pass an array of inputs so in this this
example it's array of URLs that he wants
he wanted to describe and that's it and
what happens behind the scenes is that
during execution pyrin will create those
lambdas will deploy them package deploy
them and create to configure all the
roles that you need and basically it's
just one line of code and I think this
is this is an amazing example of what
you can simply deal with with serverless
ok so we got to the end if you take ways
that that you might take is that Sarah
Lewis is pretty fast to develop it's
cost effective for most use cases we
didn't talk about we didn't talk enough
about limitation but you should be again
should be aware of when to use it and
when not and you can do it easily with
Python and using the frameworks and for
for those of you who contributes to
frameworks or build like to build stuff
and open source think there's a plenty
of opportunities in the surrealist
domain because there are many problems
and challenges to be solved there and
there are many tools that can be built
to solve these issues and python is one
of the best tools to do that that's it
thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>