<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Analytics and AMP - How to Track ALL THE THINGS (AMP Conf 2018) | Coder Coacher - Coaching Coders</title><meta content="Analytics and AMP - How to Track ALL THE THINGS (AMP Conf 2018) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Analytics and AMP - How to Track ALL THE THINGS (AMP Conf 2018)</b></h2><h5 class="post__date">2018-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/96FNOI8hb2s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">morning everybody it makes any
difference to you Paul I didn't know
anything more than what you did about
Google Analytics about two years ago but
I have the blessing of working for our
marketing agency which I heard about
earlier today and marketing agencies
need to report analytics with much
scrutiny and much accuracy as many of
you guys know and that's really fun and
also really challenging sometimes
especially when you get into amp so like
I said I'm Chris Luc I'm the chief
technology officer at the Johnson group
we're an ad agency in Chattanooga
Tennessee it's a small town there and we
do everything from Super Bowl
commercials to billboards to everything
in between web design and as the as the
chief technology officer obviously I'm
most focused on our digital efforts and
more importantly maximizing the bang for
your buck of our clients marketing
dollars month-over-month year-over-year
because we all know how important that
is to them and for the most part most
most of our work in the digital side
compromises going to landing pages so we
place a lot of digital ads between all
of our clients every single day and they
all lead to some sort of landing pages
and we know that relevant landing pages
increase your conversion so it's good to
say it's good to say you can get the
best burritos ever click here it's
better to say you can get the best
burritos catered for your wedding in
Chattanooga Tennessee and that increases
your conversions so what I'll be talking
about today and these landing pages are
going to be seen is about a company
called u.s. Express that were
transportation company however most of
these principles can be applied to any
industry because the landing page is a
landing page the landing page you're
trying to get clicks you're trying to
convert but as a little point of
reference the transportation industry is
a little unique as a whole these are
these are people that are driving on the
semi trucks and the demand has gone up
every single year for these for these
drivers because we love to order things
online we'd love to get it delivered
straight to our door and generally that
means someone has to drive it there to
us and so the demand is really high it's
going up every single year but the
amount of people that are coming into
this industry and becoming drivers has
remained consistent over the past couple
years so it's highly competitive some of
our clients pay up to five hundred
dollars per driver application so that's
that's basically $500 a conversion if
you
so it's highly competitive and we always
have to get better and we use data
obviously to get better at that back to
the landing pages over the past two
years we've iterated on them constantly
and I'm sure all of you guys are very
familiar with this process you're moving
a picture here you're adding contrast
there you're changing your headline
you're tweaking it all around and trying
to increase your conversion rate by just
a percent or two however and through and
through all these efforts tracking so
are because we work in a marketing
agency you get many stakeholders you get
your marketing team their stakeholders
they want to know how everything is
tracking you've got your ad buying team
who have their own metrics and they
won't know how everything is tracking
you've got your clients who want to
track everything through through party
software's and everything in between and
there's a whole gamut of tracking
demands when you work in a marketing
agency as I'm sure lots of you guys are
aware but we got pretty good at it
so as we as we got a little more
sophisticated or our data we had a
custom dimensions and metrics and
generally started to get smarter about
understanding who our audience was and
how they were using these pages and
engaging probably not surprising for
most of us in this room we found that
our audience these truck drivers were
connecting via the mobile device almost
80% and connecting on 3G so they were
connecting at you know rest stops and
gas stations generally looking for their
next job as a truck driver on a slower
internet on a slower internet connection
so taking that knowledge taking that
sort of understanding of the industry
and my audience and who these landing
pages were being directed to I vividly
remember sitting there and looking at
all this data and always wondering how
do I convert more I can I can move
pictures around I can put a pretty face
up there there's so much I can do but
how do I really make a difference to my
to my clients lo and behold about it a
year ago the first time I ever saw
Google i/o pause stood up there and said
amp is the answer to my problems and I
was very excited about that
one of the one of the other interests
and things that maybe a lot of you guys
are experiencing is I come from a
relatively small ad agency so I have a
small amount of developers between me
and one other full-time salary developer
and a couple freelancers we're
responsible to do all of this and unlike
many large enterprises that have the
staff to demand best practices and
really focus on the nitty gritty
we don't and so amp was a solution
because no matter what if it validates
it's gonna be fast it's gonna be good
for our mobile user so we really wanted
to do it and that was a solution amp was
a solution but we were left with the
question to amp or not Sam that was our
question which probably many of you have
either had that question in your mind
before had the question your mind today
and that's why you're here or
considering it now after watching some
of these wonderful presentations we
wanted to reap all the benefits that amp
had to offer but we wanted to ensure
that our tracking remained accurate and
insightful because we use what we report
to all those different stakeholders so I
sat down and identified what my
absolutely essential KPIs were and for
us in a lot of other industries the
essential ones basically take up these
ones sessions users clicks time on Paul
time on page and for us it's calls in
applications which probably talked about
a lot of you guys but we use third
priority software for calls and
applications so I won't be talking about
that today so let's rewind a little bit
a little bit back remember when tracking
was complicated we need to launch Google
Analytics and literally get into your
analytics jes and put all the different
things you want in there and get it all
into your database and make sure that
everything was coded correctly and
tracking accurately I don't because I
wasn't there back then I never had to do
that work today over the past few years
tracking implementation and tag
management has become much easier
through the use of Google tag manager
with this we can just install one simple
script and do everything from a web
interface pretty much and that's great
but amp just like Google Analytics was
back in the day and just like GTM was
just a couple years ago is new and so
it's not as mature it's not as fleshed
out and so we have to do a little bit
more work to get the same Anna
that we are able to do very easily using
a web interface today with with other
Google products so as I go through this
I'm gonna be talking about the different
ways that you can enter in to an amp
page and kind of the tracking problems
which I'm sure many of you are familiar
with that that poses these are the four
ways the first way is Google search
proxy cache direct amp and non app and
I'm gonna go into those a little bit
more detail here this is probably the
most common way that someone is entering
your amp page it's through the Google
search ant viewer after accessing the
page via organic search the problem is
is that when you is that when you load
this page and you're resolving to
google.com your analytics tracking
script will not fire this will create a
new session and if the user clicks
through to a non amp or your amp content
hosted on our site a new session and
user will be created that's a problem
basically I end up with two sessions to
users and everything is duplicated but
I'm one person I'm one person I've gone
here and I've searched my query I'm
looking at a page and I and I think it
looks good so I click back into the site
but suddenly you know my metrics are
reporting to users two sessions but it's
one person probably the most common
problem the next one is via the proxy is
via the proxy cache and it's pretty rare
users may access your content from the
proxy cache on CD end project org and
what you're completing that unique
client ID would be created as well so
same problem here although it's pretty
rare that someone will actually be able
to have that exact URL they'd have to
dig pretty deep to get that the third
one is when an amp pages visited
directly on the publisher domain an amp
client ID is generated and will be used
across amp and non amp pages and so we
see this most commonly if people have
saved your page as a bookmark or sharing
it with a friend
and are getting to your amp page
directly not via some sort of organic
search and finally when a non amp page
is views is visited directly on a
publishers domain a normal client ID is
generated and will be used across amp or
non amp pages and that all means a lot
of different things but let me let me
let me let me clear it up if a user
accesses
content there any like three of those
four scenarios suddenly like I said
we've ended up with three client IDs to
one user and that can really you know
stew your data up as you can see our
users and our sessions went up a large
proportion after we started piloting
piloting amp and that was really bad for
us because we do everything by
conversion rate and if you're doing a
conversion rate by sessions versus
clicks and you got double your sessions
but no more clicks you look like amp is
not doing great for you and that's a bad
thing
luckily for us it wasn't that amp was
doing bad for us it was just that we had
our analytic set up a little incorrectly
and I'm here to clear that up for you
today so the solution is actually fairly
simple
it's the amp client ID API and it's it's
relatively new it's really new but and
still being iterated on still being
worked on but it solves that problem of
your three of all the different ways
that you can enter into your site
getting different users different
sessions and things of that nature with
some minor additions to your amp and non
amp tracking code Google Analytics will
start using a single client ID on Google
search direct amp and non amp scenarios
it's really cool after implementation a
user who accesses your content across
Google ant viewer and all these things
will have one user and let me show you
what that looks like so the format of
the client ID will depend on whether you
entered into an amp or a non amp page
and it will stay consistent across the
rest of their journey through your site
whether it is amp or non amp and you can
see here because the user enter entered
in via via an amp page that you client
ID starts with a MP and we'll get into
that a little bit later it provides some
pretty cool insights the other way that
they can get into it is they access a
non amp page or navigate to an amp page
a Sano Jia GA I client ID will be used
as you can see here we've got GA
sometimes this number sometimes it's
letters but very definitively if you
enter in on an amp page you will have an
amp client ID so this is a scenario
that's that's happening and if you
implement client ID it will take
whatever whatever client ID you were
generated so if you were generated and
you
into the site via the homepage here and
you see and you came in and this is not
an ant page you would get a Google
Analytics client ID however and if you
edit and if you moved into one of my ant
pages that idea would follow you however
if you found me on Google and got into
one of my ant landing pages you would
have an amp client ID and if you moved
into the rest of my side or move
throughout you would keep that same amp
client ID
the official API documentation outlines
setting up Google Google Analytics and
tag manager we have set ours up using
Google Analytics and analytics dot J s
we didn't use GTM for this
implementation but it is possible you
can find additional vendors who have
built-in configurations for amp
analytics component you'll need to refer
to their specific documentation to set
up the tracking of client ID currently
client ID is supported with Google
Analytics and I think we talked about
this a little bit earlier today but if
you work with another analytic solution
like Adobe Analytics or Facebook perhaps
you'll need to work with them directly
and and the amp community to kind of get
client ID supported by them but it works
great for Google Analytics first thing
not now back to it back to implementing
and and it's it's much easier than we
think it is first you need to include
this line of code in the head of all
your amp pages and we're declaring that
we're using Google Analytics and we're
using Google client ID API not too bad
next you want to add this additional
piece to the standard GA create request
online non ant pages see a lot of people
taking pictures that's good
normally and and where this gets
confusing and I think where a lot of us
are having trouble is because we've
never had to write a Google Analytics
script really because we because we go
into Google Analytics and we said give
me my script we copy and paste in the
head and we never look at again none of
us have ever really had to go in and and
make custom code changes and the only
change here use amp client ID true very
easy right
finally is to add a referral exclusion
for CDN project org in order to ignore
self referrals from cached ant pages in
order to preserve the original source
medium information associated with the
first touch upon a user navigating a
subsequent page in your site has a lot
of words to basically say if you if
you're delivering ant pages via Adwords
or someone some other ad server we don't
want ant project.org to be there to show
up in our Google Analytics as a refer we
want the refer to actually show up what
it was so we set up that exclusion after
that you're done and that's that's
pretty easy right except for the fact
that we're not so great at testing as
developers which is why I've included
how to test afterwards so you're gonna
want to test it after you've got those
those lines of code set up you're going
to want to navigate to an ant page in
Google search in Chrome with the
emulator set to mobile make sure you're
in a new incognito window and click on
an ant page check your cookies and copy
or GA cookie so you can see in my test
I've navigated to the ant page I've got
the amp client ID there and the next
step I'm going to try and go to a non
ant page so next you want to navigate to
a non amp page on your domain and check
to see if the cookie matches if it does
you succeeded then you can say you're
done and then you say it up test and I'm
a great developer my boss loves me
because I never pushed through errors
and it's great but once you have this
some really cool things happen after
implementing the client ID API Google
Analytics now treats all three of these
users as one and that's really great one
of the major concerns with the amp pages
is now resolved and I'm pretty sure that
it would solve most of your concerns but
this is track all the things so we're
gonna get a little more advanced with
our trackability
implementation of just this was pretty
straightforward with the Google provided
documentation metrics that are directly
impacted by this use is session duration
bounce rate pages per session user count
and type we now have a much more
accurate reflection of our users
behavior across all of our content and
to give you an example of what that
looks like so if someone was coming into
our amp pages
and then they were going from our am
planning pages into the rest of our non
amp regular site we were seeing a very
high bounce rate because it was seeing
user came one user came in and then they
left because it didn't understand that
that same user was going into the rest
of the rest of my site so we saw a
really high bounce rate that's not good
we saw a really high exit rate that's no
good we saw really high sessions which
we've already talked about but it solves
most of those problems but amp analytics
provides powerful tools to track a wide
variety of user interactions and in the
following sections we will cover out of
fire events based on button clicks as
well as some other types of events that
are supported adding an event in the app
analytics requires using a trigger
sending a request with the type event
defining a selector and adding at
minimum values for the required event
category and action fields here's a
portion of the script we use to track
button clicks so here we have the
trigger set to click the selector which
we have named click track and the
request is event and then we've labeled
our category button clicks and this is
pretty basic but you can do dynamic
button click tracking which I'll get
into next it also allows you to pass
dynamic values into your events by
adding an additional element selector
the prefix is data bars and we've chosen
to call ours event ID you can format for
what it looks like you can see the
format for how it looks like above and
so basically what we're doing is I'm
passing a numerical value into each
button on my landing pages in an order
of 1 to whatever 10 and what I use that
information for is to understand which
button is being clicked on each page and
so number one represents our top-level
button number two is probably our hero
and it goes all the way down but I'm
doing dynamically I'm able to
dynamically pass those values and see it
reflected in analytics other things that
I could dynamically pass into these
event button clicks would be things like
maybe template name if you want to get
crazy you can do headline copy for
getting into that a/b testing anything
that anything that you're dynamically
wanting to understand on each landing
page you can pass using using amp
analytics now you can see our event
action is passing dynamic values from
the HTML we add it to our button clicks
dynamic values can be passed this way
into event category action and label
fields which is great I really talked
about button clicks but the syntax of
writing it is pretty common and very
pretty simple for the rest of them you
can find them all in ant project org
these triggers but there are some other
common common ones like visible scroll
timer and initial load generally in my
conversations with other marketing teams
and other people that are investigating
amp we have many people find a trigger
that hasn't worked for our analytic
solution yet so it's all there and
project or sending custom dimensions in
amp analytics is a bit different than
universal analytics but follows the same
concepts custom dimensions can be sent
by with page view requests event
requests or with all requests and since
we are in the business of tracking all
the things you're gonna see me applying
these dimensions to all the things we've
chosen the Seneca musk custom dimension
of customer client ID with all requests
which I'll walk through now here we have
created a custom dimension to send the
Google Analytics client ID to help with
session stitching and analyzing user
flow we have chosen to call this custom
dimension customer client ID as to avoid
any potential conflict with standard
client ID reporting in Google Analytics
maybe this doesn't make it make a lot of
sense right now but it will it gets
really cool so step two is to configure
your amp analytics script to send the
custom dimension we have decided to send
this omission with all triggers and so
we have a find it above in our page view
and event triggers this is the script
that we have implemented on our on our
amp pages step three in order in order
to tie this together completely we need
to push the client ID with page view
requests on non amp pages as well you
can see how we've accessed the client ID
and sent it along with page view
requests as a custom dimension here this
line is directly from the analytics j/s
developer documentation which was kind
of a bear to find so if you were taking
pictures of all this this is a good one
to take picture of
by replacing the standard page view
tracker with this line of code on all
non ant pages and this is important you
need to put this on your nine pages you
will now be able to see the client ID of
a specific user one-to-one both amp and
non ant pages on all standard reports
let me show you what that means client
ID now is accessible in all reports that
allow custom dimensions it is being
passed not only with the page view
tracking but also with any events that
were triggered on our amp pages and this
is pretty damn cool so let me explain
what this means each one of these IDs is
actually a single user so I am able to
break it down by a single user and say
that this person right here clicked on
those buttons nine times I can break it
down by page I can break it bind down by
a dimension I can break it down by the
dynamic values that I'm passing I can
get it down to one to one interaction
whether you came in from Google whether
you came in directly or any of those
other methods I can track it all and
what this means to me as a marketer and
what this means to you is that pretty
much when I out when I sat down and I
outlined my key performance indicators
that I absolutely had to track it solved
all my problems everything that I wanted
to do I could solve either by using
clamp the client ID API custom event
tracking or Domitian dimension pushing
another neat byproduct of this
implementation is once you have
implemented the client ID API and are
pushing the client ID custom dimension
you able to see whether a user first
interacted with an amp or non ant page
anyone first accessing your content
through an app page will have a client
ID starting with a MP and anyone
accessing your content from a non ant
page will have something else and that
gives us some pretty cool insights I can
go into my analytics report and say in
general our people who enter through an
ant page more likely to do what I want
them to do or not I don't know yet
because this is pretty new in our
analytics but we're gonna start looking
at information it's just a neat
by-product
you can see how we've accessed the
client ID and sent it along with page
view requests as a custom dimension here
by adding a few lines of code to our amp
and non amp analytics we have gotten
much more accurate and sophisticated
information here's a recap of what we
have covered in this presentation first
we embedded the amp client ID API to
consolidated sessions across amp and non
amp content this is this is the solution
to most - most of our problems it solves
coming in via Google organic and seeing
all those SKUs and metrics wonky it
solves all those problems second is
tracking events with dynamic values on
amp pages so whether your event is a
click or whether your event is a scroll
or visible or any of those things you
can dynamically pass data in each of
those events to get really sophisticated
information about what's happening
third tracking of sending custom
dimensions in amp and right now what
we're using this one is the dimension
we're using is the customer client ID
because that that gives us the ability
to track one-to-one all the way through
our ad cycle but you can send any
dimension you want through there and
fourth is sending Google Analytics
client ID as a custom level dimension on
both amp and on amp pages for allowing a
user level reporting across Google
Analytics support which I've talked
about earlier so back to the original
question to amp or not to amp while
there are some clear limitations of
using amp and which we've discussed
today where it's a new product it's
still in flux people are still working
on it and just like many versions that
are in their infancy there are some
problems and limitations however they
are being actively improved upon along
the way and the amp the amp community
and the EM team has been really great
about making sure that anything that we
have problem with and if you submit an
issue or you submit something to get it
gets addressed relatively quickly
especially if it's a more pressing
project one of the largest challenges in
trying to decide whether or not we
should pilot and test amp was tracking a
user's interaction with that content
across their entire journey accurately
that has been solved in the most
with the use of ant client ID API while
implementing this took some development
work and debugging which I was not
prepared for the end result has given us
much more confidence in our data and
allowed us to see a true picture of our
website visitors behavior and in fact
requiring myself and my team to go and
look at tracking through through a lens
that's beyond just copying and pasting
Google Analytics script allowed us to
become even more sophisticated in our
tracking and focus more on that aspect
and learn more than we originally did
for this particular client that is
primarily a mobile audience amp has
significantly improved their user
experience and and been and our
conversion rates have gone through the
roof
so there was never really a question in
our mind of we did we did an initial
pilot run and we knew our we knew our
numbers were all wonky but we knew that
our hot our conversions were going up
and we knew especially after a lots of
the information they amp is where we
want it to be for us is it for us as a
small agency a force best practice it
forced us to be to be better than we
were and it was and our users really
enjoyed it
but our main concern was tracking and
that has been resolved at the end of the
day I believe the ant project is all
about improving the user experience for
people interacting with their content
online and I think that's the goal of
all of us as marketers and I don't think
we should let analytics be the hindrance
between giving our users a better
experience online you can get the right
data you can get accurate data it takes
a little bit of work and just like most
things a few lines of code that's all I
have today
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>