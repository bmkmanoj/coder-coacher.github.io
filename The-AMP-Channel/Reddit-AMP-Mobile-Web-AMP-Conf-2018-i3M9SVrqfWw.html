<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Reddit &amp; AMP; Mobile Web (AMP Conf 2018) | Coder Coacher - Coaching Coders</title><meta content="Reddit &amp; AMP; Mobile Web (AMP Conf 2018) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Reddit &amp; AMP; Mobile Web (AMP Conf 2018)</b></h2><h5 class="post__date">2018-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/i3M9SVrqfWw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good afternoon everyone I'm Annan walk
at reddit as a director of engineering
so first of all I want to thank Google
for having me here and so I'm gonna walk
through our partnership with amp and
reddit a little bit about me so I grew
up in India I did my and then moved to
us from a higher education did my
masters at Purdue University and then
spent about a little under eight years
at Microsoft working on there some of
the compilers data analysis tools
business applications and then here at
reddit I lead the team called reddit
community experiences primarily focused
on our subreddit experiences for
consumption creation and moderation and
also lead the web platform including the
desktop mobile web and amp'd and finally
also leading the the biggest redesign
for Reddit and been working on it for
the last year quick poll how many of you
use reddit here often okay that's quite
a lot of people so for people who don't
use reddit I just wanted to give a very
brief overview of what is reddit how
read works so right it is commonly
called the front page of the internet it
has a lot of news and discussion
happening on the platform but internally
we think of it as a platform where
people can find communities that are
excited about passions as you are and
can have real authentic conversation and
that's what we think makes reddit
special so check it out if you haven't
already used reddit so even for people
who are used reddit I don't know how big
red it is so reddit by numbers so that
it is ranked fourth in the US and
seventh globally by Alexa and Alexa
ranks based on the usage and engagement
on the side and currently we have about
three hundred and thirty million monthly
active users and read it with about 1.1
million communities or subreddits which
creates about a million posts a day and
five million comments an array and about
75 milli
upwards and downwards happening on the
side every day so let's talk about
reddit how read it works very briefly so
reddit has these four things coming
together in an interesting way to create
a very engaging site number one pseudo
enormous LeConte reddit is a place where
you don't need to provide your real
identity so you can use your enormous
account which means you can be more
authentic because you don't need to hide
your opinion number two
reddit is driven by communities it's not
a like a long list of content so you
have communities which only allows you
to post video links or only allows you
to talk about sports you got to follow
the rules and number three is voting
voting is a big part of Reddit we have
upwards and downwards to similar to
other platforms and finally the hot
front page so even if you're not engaged
in any communities or not signed up for
reddit you can get to the best stuff
across all the communities and reddit by
going to the front page read reddit com
so all these four things coming up with
high scale helps us create a very very
highly curated high addictive content
internally we think of it as like a
weaponized procrastination and we are
here to take down the walls productivity
so so we got all the scale we have
millions of millions of people what do
we do with that power let me show it to
you so on the left is a cat actually
fist-bumping a human on the right a cat
actually walking a human clearly a world
where cat is in church but this content
had a bowl like a million boots or
100,000 upwards and a million views
reddit there's a lot of cat pictures we
will admit it but wait is it just only
cat pictures but no we have a little bit
more other communities that's what I've
been told
so so we put a lot of emphasis on
community or the content and both of
those things over the individual
creators which creates a unique
characteristics for the people on reddit
they are creative authentic and also the
community driven empathy is pretty
amazing here's an example our assistance
is a community where you can post for
assistance in this particular example
Kayla Davis was looking for a kidney
donor and she was able to find a kidney
donor and the whole process took about a
year from the initial contact for the
process to take take this but this is an
example of a reddit scale where
communities coordinate for like a
greater impact so the point of the talk
with this kind of an intro is like we
have all this content and how do we get
our users to find the content they like
and reddit for reddit SEO has been like
pretty huge all the time and the chart
shows the Google Trends for reddit over
the last few years
reddit has been growing and which makes
a Google SEO and especially I am very
very important for us considering the
history I thought the best way to do
this talk would be walk through our
partnership with Google around an and by
giving a brief history some of the
technical challenges we ran into and the
design considerations we had to do and
also end it with the roadmap for 2018 so
it's 2016
Google was looking for amp beta search
partners and I said as we just talked
about reddit one of the biggest source
of traffic is our SEO users and the way
Google talked about it was if we could
figure out a way to put the site on and
we could get a like really performant
experience for our users and also maybe
get more traffic on reddit so it was
really valuable for us and very valuable
for our
but the challenge was we didn't have
people to work on this at that point
read it was a very very small company
and maybe we got like one or two
engineers to work on so but so we had to
figure out should what should we invest
our resources in so since amp is
primarily a mobile experience we chose
to use reactant Redux based version of
our mobile web app at that time and so
starting with an existing code base
helped us to focus our limited
engineering resources on solving the
actual problem of how do you create an
amp experience different from your
mobile web experience quick look at the
text track react and redux might seem
like a really odd choice for an amp
which essentially render static markup
but we found the combination effective
for reddit suicide rendering is like
really huge requirement and also for our
SEO so because our mobile web rewrite we
already supported server side rendering
this combination kind of worked for us
so we have the Cova handles although the
requests for the supported urls and
every request is handled the same way
startup redux fetch the data and return
it and each request has its own Redux
store and each of the pages has this
redux action which acts as the request
Handler and all the page information the
sub reddits the post or comments are in
the redux and once the server hTML is
rendered from amp the ape API calls are
finished so this is kind of our tech
stack going in the next thing that we
had considered was react and redux as I
mentioned earlier was like a setup for
isomorphic rendering but we exclusively
used only the server-side rendering so
we were able to use a lot of how the
server-side code and the other reason
why we had to pick react and redux was
based on our people and productivity and
not on the code itself
so so the only changes that you had to
make on the client side were like two
pieces of the JavaScript and you start
using the amp solutions and react also
let us use am components are like image
amp image and picard ian which is very
similar to how we use the other hash kml
elements and it was like engineers did
not need to learn a new paradigm to use
react with that so i thought i'll just
show a quick code sample using telemetry
as you all know telemetry we use
client-side JavaScript events this code
example is from our mobile web code base
which kind of shows like once the page
is finish rendering we send out a
telemetry event for page view and the
bottom code is when you click on the
subreddit button we track that event as
well so how does how did this translate
to amp when the amp site we had to use
amp analytics which is a declarative
JSON API so we define the pixel request
by name define the interactions
triggering each request and requesters
logged on the server-side and for the
client-side informations we had used the
query parameter names and amp analytics
let us convert the predefined names with
the values and so we can collect
information like the viewport dimensions
or canonical URL so the table you should
define the request for the page view and
the query parameters on what client-side
information we want to pass and the
triggers are defined below so it's
pretty easy to set up our amp client
pages so from the technical side we also
need we also had to take in some of our
design considerations given our amp was
primarily targeted for logged out SEO
users so on the right you see the mobile
web page on the left you see the amp
page of the same post now you can
clearly see that some of the
interactivity is removed in the amp
because
when you're logged in and read it you
get to upload the content download the
content post your comment so those were
removed and a lot of emphasis was put on
the content itself so it was like pretty
straightforward to set up our first set
of amp pages and so there was in 2016
reddit has like four different so four
different post types primarily self post
link image and video so for our first
version we chose to set up amp pages for
the self post which contributes I think
roughly about 40% of our post types in
Reddit so we got about like hundred
millions of self posts created on reddit
with the corresponding amp age now and
we saw a significant growth growth in
our usage and amp was like a pretty much
a game changer for us for mobile web
because it was loading really fast and
reliable manner so of course the next
thing we did was stopped working on amp
but there was a good reason for it at
that time the giri's andaaz read it had
a completely whole new leadership team
read it was expanding and we also picked
up the goal of redoing the entire site
so that kind of took our attention of
amp but we immensely came back to it and
once we built up an engineering team we
have a little bit more people we
partnered with Google last summer for a
snooze be reddit snooze day is basically
our hackathon at reddit where everyone
in the company gets about a week off but
they can go work on any projects that
they like and some of our engineers
decided to partner with Google engineers
and and pick up all the work that we
left for the amp pages and we also use
this as a couple of as an initiator to
get started on some of the core
technical problems that we want to solve
with app and so these were some of the
initiatives and I'll go through them one
by one so night mode
redditors allow
night mode so this is what it looks like
in our mobile webpage so trying to
support this in amp we ran into a couple
of issues and the solution we came up
with was we put the whole page within a
template which means we couldn't use
other templates and also the performance
was bad because the whole page was
within the template and then the last
one is there was potentially a problem
where like the page flash from the white
background to the black theme when the
template was updating and there was a no
good way of sharing the preferences
between arm cache and read it so we had
some Google engineers we worked with
them the cable gave us a good proposal
on how to use the and dynamic CSS
classes which the endpoint will return a
set of CSS classes that should be
applied on the documents body the end
point must complete within the render
blocking window if not they'll use the
they'll cash it for the next request and
so this was a solution that we came up
with we kind of got some prototype done
and the next one so most of you who are
on reddit I believe you used the site
log dot but if you do log again you get
to do a few more actions like uploading
downloading commenting so this was again
an interesting challenge that we wanted
to solve for AB because we didn't have a
good way of logging in our amp users
figure out the preferences and again the
goal team helped us out by helping us do
a prototype on using amp axis the the
proposal was to use a declarative JSON
for authorization and users and have a
API call for logging in and amp access
also lets you conditionally display
content based on if you are logged in or
logged out so so in this in this case
you can be used amp access to show up
word button if you're logged in it led
to your output but if you logged out
it'll let take point
to the login page for you to login so
these two were like kind of a technical
challenges we kind of had solutions but
we didn't couldn't make much progress
during the hackathon but we also wanted
to work on something that we could ship
right after the hackathon so I said
mentioned earlier we had four post types
self linked image and video self post we
shipped it in 2016 Lincoln image post
also contributes turbo like 40 45
percent of our content in Reddit and
right after the hackathon we shipped
these two pages on the left you see the
the length post on the right as an image
force so we shipped this in September of
2017 so to look at some of the stats
quickly so it shows starting from
October to like January we saw like a
30% bump in our SEO amp users so it was
pretty good to see a ton of traffic
coming through amp and another look at
our SEO users by platform so if you just
look at our mobile web SEO traffic am
contributes to 60% of our SEO traffic
but if you bring in the desktop or the
web traffic it contributes to like 30%
of our traffic like one third of our
traffic is coming or SEO traffic is
coming through amp so here is the team
from reddit and Google who worked on it
and huge shout out for Paul and the team
from Google and reddit who worked on
this news day to make it successful and
I believe they also had some good fun
and they were out there
so that's hope you guys enjoy the walk
through our partnership with Google I
also want to talk to you guys about what
we have planned for the future
okay so 2018 so video post it's not
future anymore we literally ship the
change to enable video post yesterday
night and enough my colleague Vigo he
just sent me a screenshot it's actually
live now so we finally have all the post
types live in and Google and then we
have a couple of key initiatives that we
wanted to support for power users using
the night mode the logged in actions
that we talked about in our previous
hackathon and we also want to make the
site local look a little better with
align with the redesign kind of looks
okay in our opinion and also being at
the conference like I really love the
amp stories and we we also want to
figure out a way how we can start using
them so this this was was not in our
plan tool we were in the conference
yesterday so that's awesome
and then so actually even have listed a
few of these long long term looking
items we are in a very similar position
to like what we did last year we're like
we're still redoing or the biggest
redesign for reddit and we still at
least this time we're only couple of
months away from shipping it so we'll be
picking up a lot of amps stuff after we
shipped the redesign so to kind of
disappoint you guys on the fact that I
didn't have anything really cool new
stuff to show on and I thought it would
be better to show you guys how the new
reddit redesign
looks like so yeah so we all love reddit
but we also understand like the reddit
is not welcoming for new users and it's
it's kind of scary for certain people
too so this is what the reddit UI looks
like now the UI hasn't been literally
developed in the last 12 years and I
still remember like when I was leaving
Microsoft I told my wife like hey I'm
going to read it and then once I signed
the offer she pulled her laptop open it
up going to reddit calm and then I could
literally see her face she was
frightened that's like and then she's
like re d di t that's where you're going
right I was like yeah like so she was
literally scared but and then I told her
like don't worry we're gonna fix that in
the coming
so you've seen the confusion in a lot of
people who go to reddit and don't know
what it is so we spend a whole lot of
last year you know getting the redesign
done and this kind of what it looks like
so you can start using reddit the way
you'll like it based on your viewing
preference so we have different view
modes so this one is called the card
view where the images and the videos and
gifts are Auto expanded and we also have
this thing called the classic view which
gives a very iconic look for people who
like you have used Reddit and it has a
family look a similarity and the
familiarity with the new redesign and we
also put a lot of emphasis on our
communities which is like the core of
Reddit and give provided them a lot of
personalization tools where they can
have their unique identity for each
communities so that's kind of what the
redesign looks like and yeah let me know
if you guys want to be in the beta we
are going through a beta period now and
so with that thank you very much and I
have my contact info right there and
final thing and a very important thing
we are hiring hiring like crazy
reddit is trying to hire about 100
engineers this year to work up some of
the cool AM stuff
and some of other initiatives so yeah</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>