<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using AMP as a Library to Build User Friendly Sites (AMP Conf 2018) | Coder Coacher - Coaching Coders</title><meta content="Using AMP as a Library to Build User Friendly Sites (AMP Conf 2018) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Using AMP as a Library to Build User Friendly Sites (AMP Conf 2018)</b></h2><h5 class="post__date">2018-02-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/avq5Cj0PFpA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi I'm Abbi as Paul mentioned the
designer on amp before we get started I
want to do a fun little exercise so I
want everyone to turn to their neighbor
and give them a high-five yes
all right we've seen a lot of awesome
stuff today we're gonna see more and now
we're going to talk about building
websites with amp so as you can see this
Italian news site layin a has a standard
two column homepage and as you'll see on
the next slide there we go a really
awesome full-featured search with
thumbnails a timestamp auto search and
they also yeah
remember all right so we saw an awesome
search and then we will also see in
addition to this awesome search a really
awesome sidebar with a menu on the next
slide area okay so now you're thinking
no way it's not possible to build that
an amp totally wrong 100% built-in amp
so it is possible to get all these cool
interactive features it is possible to
build your entire site with amp and now
we'll talk about the previous approach
on the next slide
all right so as Paul mentioned earlier
there there was a way of thinking about
kind of building a home site and then
also building all these other extra
pages specifically for driving traffic
so things like amp an articles Apple
news all of those other platforms and as
a result of this process people were
saying things like hey Paul thanks so
much
people are saying things like it's too
much to maintain why do I have to build
another page if amp is for static
content then how am I supposed to build
these interactive pages and all of those
comments were totally understandable
so we acknowledge that this approach was
not ideal now people are just using amp
as a source of truth for their pages and
you can use your amp for your website
too now is about the time where you're
probably thinking okay this is great but
what about the speed benefits that you
get from the cache so let's talk about
how this site lien--a how they're non
amp'd page served from the origin loads
at about 6.9 seconds the amped version
still served from the origin lands 3.7
seconds faster in this case it's a
pretty big difference in addition you
don't get any of this unstyled CSS or
these flashes they you'll see on the
right all right so now that we've talked
about speed we've got the basics covered
let's talk more about why using it for
your website is actually a great idea
so am gives you higher level components
that give you UX for free as you know it
is possible to build interactive
components with things like HTML and
bind but you have to start from
completely from scratch so these
high-level components that we're
starting to build more of like the
carousel and the date picker give you
all this interaction
and developmental complexity for free so
in this case it's you just have to write
amp - carousel and for the date picker
it's ant - date picker super easy in
addition some of you may not know this
but our high-level components are
responsive by design so this means that
with these high-level blocks we
specifically keep in mind multiple
device sizes so that you don't have -
none of that messy media query stuff
also because there's a team of
contributors around amp working everyday
to update the library as there are
updates to platforms and browsers as we
know this means the library is evergreen
this basically offloads the maintenance
work of an entire engineering team so
that you don't have to go through a
painful upgrade process that's
especially great because it means that
not only can developers use these
components to create great experiences
that they might not have previously had
access to maybe resources or even
expertise it frees up everyone's time to
make other awesome things with a bigger
impact you know things like colonizing
Mars so to top it all off you also get
to be a part of this enormous community
so as multi mentioned in the keynote we
have over 560 contributors right now
internationally with this awesome slack
channel which is very active where you
can constantly interact with other dubs
get feedback we have a YouTube channel
with awesome videos and of course talk
to us here we do have a talk at 4:30
today on contributing to amp if you
haven't done that yet and are excited to
do so so check that out ok now we've
talked about the approach let's see how
it's being adopted know the Irish Times
has amped fully amped all of their
mobile article pages so that's their
source of truth for those other sites
like the Spiegel daily on the next slide
there we go tasty on the next slide and
layin a are 100% amp sites so there are
fully featured websites all the
interactivity you would expect from
normal website and every page is built
with amp that's pretty awesome other
companies which you'll see on the next
slide have taken this step I've taken
this one step further there we go
alright so these sites have combined amp
plus PWA s to provide an even richer
more app like more engaging experience I
highly encourage you to check out BMW
com it's really awesome you can see
what's possible there also speaking
later at our talk dedicated to an plus P
WI so check that out if you're
interested too we believe in this
process so much that on the next slide
you'll see our own websites are fully
built am so last year I am campeón
failed a beautiful again fully
interactive fully responsive website and
it worked so well that we also applied
the same principle to amp by example and
I can vouch for the engineers that this
has been dramatically easier to maintain
and no web pack or tree shaking was
needed so again check it out look at the
code and see for yourself
and with that I will turn it over to the
previous slide which has Jess from
BuzzFeed she'll talk about how they amp
their taste eco site
thank you all right thanks Abby cool so
for those who aren't familiar
taystee is BuzzFeed's food brand and we
specialize in those top-down recipe
videos where the hands come in and are
cooking and you might have seen them you
know throughout your Facebook feed or
Instagram feed so Casey actually has a
massive audience of over 300 million
people per month across all of our
different platforms and now we're really
excited to offer all the recipes on the
web with tasty oh cool so I'm going to
touch a little bit on why we chose to go
all-in with amp for tasty Co so amp on
desktop mobile just everywhere so before
I worked on tasty I actually worked on
BuzzFeed comm and the article pages
there and we took the approach there of
our non amp site and then our amp
templates which were two separate
entities and I've learned pretty fast
there that that definitely proved to be
a challenge at times so as we would
iterate on our main site we would always
have to remember to maintain parity with
our amp templates so definitely was a
bit of a challenge and moving to tasty
and starting tasty from scratch we kind
of wanted to avoid that altogether so
again we were in a unique position where
we didn't have a main site to base it
off of so we were literally starting
from scratch and we knew we wanted to
offer amp to our users so we figured why
not just go all-in and it kind of
eliminated framework choice overload for
us we kind of we knew we wanted to amp
so we just went full steam ahead and
again the simple nature of the recipe
page here you can see there's some text
video thumbnail these things you know
we're totally capable with amp so we
figured that it would be a really
awesome idea but of course with that
definitely came some challenges and some
learning experiences which I will touch
on once it moves to the next slide cool
so one challenge that we definitely ran
into building out
say early on was we were trying to
create a show more button so kind of
like a lazy load feature of recipes in a
list so at the time this this didn't
exist within amp so what we ended up
having to do to get this to work was
that button is actually linked to a form
submit and it would send out a request
and basically populate an amp mustache
template with the next set of recipes
the next results so that's kind of an
example where it wasn't super ideal and
you know had we've written our own
custom JavaScript it might have been a
little bit easier but having that we
went full in with amp we this is an
example where we kind of just had to
make this work so oops gonna go back
skipped over my Oh skipping over all of
my slides sorry about the one bar okay
awesome
so sorry about that so the next
challenge we definitely ran into which a
lot of people mention is CSS wait so at
BuzzFeed we have a CSS component library
called solid and we knew we really
needed to use solid for our you know our
site we wanted to maintain you know our
brand cohesiveness so unfortunately
though solid didn't really play nicely
with the CSS weight requirements with an
amp so what we ended up having to do is
add in the purify CSS web pack plug-in
to our build process and basically what
that did was just tree shake any like
unused classes stuff like that and we
were able to get our the weight down 25%
which was awesome
but this is another example of where if
we had not gone the am proud we might
not have had to spend the time working
through the CSS weight we you know like
we had to in this case scenario but
overall as far as challenges go really
one of the big ones was making sure
you're fully on the same page with
everyone on your team so whether it's
like designer or products people
everyone really has to be on the same
page with what amp is capable of and
like what an amp site is
capable of so just being aware of the
different amp components and just
knowing which features just might not be
able to work in an amp site so awesome
so I'm going to touch a little bit now
on some really awesome things that we
learned while making a fully amp site so
one of which being you know fully
utilizing the existing amp components so
for example we had share buttons on our
site here and we were able to just
really easily plug in the amp the
existing amp social share buttons and we
knew that they you know we're gonna be
reliable they're thoroughly tested and
you know they worked right out of the
box which is really awesome and it freed
up dev time to just focus on you know
more important things so that was a good
example of just being able to use the
existing components and another cool
thing was if we found that something
didn't exist within an amp and we really
wanted to add it in that was totally
possible as well so here shows a PR that
I had open to add print functionality
and to amp so basically a super simple
just amp action that allows you to print
a page I was able to open the PR get it
reviewed and merged in pretty seamlessly
so the combination of using the you know
the github and the amp slack was both
were really critical resources to get
the site up and running and that was
really awesome and it was just awesome
to know that no matter what I was trying
to build for the site I knew there was a
community that I could reach out to and
you know get help and get guidance for
you know new features I was adding in
which was cool and lastly just overall
development time and workflow was just
way easier having the full amp site and
just the one source of truth for the
site so for example bringing it back
again to my time working on BuzzFeed the
article pages comparing a to tasty the
build time we see 85 percent faster
build time the web pack build and a lot
of this is because there's no JavaScript
at all for tasty so we are able to
offload all that to amp because we're
using the amp library so that was a
really awesome win for us and again
along with this
we just maintaining that one set of
templates versus versus having to
maintain both was just really awesome
for us timewise being able to iterate
fast on the site and get it up and
running for example building out like
analytics for the site we just had to
you know build out the amp analytics and
we didn't have to then also implement it
on our main non amp site so things like
that just allowed us to ramp up super
fast and it was just like a really great
development experience in that way and
overall I'm just super grateful for
being a part of the amp ecosystem
because starting this project from
scratch it could have you know ballooned
up in size and gone kind of out of
control so being in within the amp
ecosystem and following these guidelines
and these requirements really helped us
just keep the site really lean and
really fast and so that was really
awesome and ultimately just led to a way
faster user experience so that was
definitely great and yeah that's it
so I'm gonna pass it back to Abbie now
Thank You Jess that was awesome so now
we've talked about the basics of
building your website with amp I've
shown you some examples you've heard
straight from tasty Co how they built
their site but recently as we've been
investigating this approach for larger
production sites we realized there were
some holes in this story so now I'm
gonna introduce Andre to tell you more
about the nitty-gritty of how we solved
more issues to help you in the future
Thank You Abby so hello everyone and the
special hello for the folks on the
livestream including my wife and my
daughter wants to be a web developer and
youtuber so my name is Andre Banda and
I'm a developer advocate at Google so
when developers developers first started
asking the team about creating their
websites with that they brought her up
some of the same things that Abby talked
about earlier in terms of time it would
save but there were a few feature gaps
that they thought were essential before
they went all and the biggest issue
across the board was cross-origin
tracking and analytics we heard from
developers that they were worried about
going online because doing cross warning
to origin tracking analytics across em
cache and pages and no-name pages was
hard to fix that we launched the Google
web client AG API to help developers to
uniquely identify and analyze a user's
experience across different origins we
also heard that M pages didn't provide
enough flexibility to create interactive
experiences we've been working in two
fronts to address that okay just go back
sorry so while M bind provides a
lower-level framework to allow powerful
interactivity on a page such as this
example from aliexpress higher-level
components such as the amp lightbox
gallery provide ready-made elements for
specific uses
in fact since you're now announcing your
work on this component several
publishers said that this lightbox
box gallery was one of the few remaining
features that they needed in order to
use them for their websites dampe light
box gallery is available than
experiments now and sets launched fully
by the end of this quarter another great
example is scroll bound animations
implemented with amp position server as
Holly just
talk about sooner in stock and we are
not stopping there makes Church stay
tuned for new components churches such
as the upcoming and infinite scroll
which developers at ecommerce merchants
so does is essential for them to build
their own pages with now let's talk
about performance we're serving our M
pages so MN page is only as fast as it
as an infrastructure serving it the
Google amp cache provides optimal
serving conditions but one serving from
your own infrastructure it's up to you
to ensure that those conditions are met
the two big areas to focus are
optimizing delivery by using things such
as a content distribution network or ATP
- and also optimizing the content such
as making sure that your images use the
best format and resolution those
practices shouldn't be AB surprised most
developers and they were well documented
with plenty of resources online so
service workers can give developers more
control over cached content you're
allowing even further improvements the
amp install serviceworker allows service
workers to be installed from M pages and
the data iframe source attribute loads
an iframe from the origin that can be
used install service worker and
bootstrap the site even when they amp is
loaded from an M cache so a good
practice is to cache the unparent time
itself is in the serviceworker this
example uses work work work work box js2
use to do serviceworker caching first it
creates a fetch handler that intercepts
the request for the Emperor on time and
uses I stay away over elevate strategy
to cache it then it Prime's the cache
with Emperor on time this ensures that
once the serviceworker is installed the
cache will contain the runtime even when
loading the page for the first time so
for more information on p ee features
with them make sure to watch the
progressive web apps talks later today
and a more recent developments on
m-performance are server-side rendering
ads those are end pages that have been
transformed on the server in order to
have a better loading performance the
Google amp cache has been serving
server-side rendered page since the end
of last year let's take a look at how
this works so EMPA makes have usage of
web components which have to be
bootstrapped by the emperor on time to
prevent the flash of unstyled content
when loading those components the ample
boilerplate CSS initially hided page and
once the runtime loads it injects the EM
CSS and the components are bootstrapped
putting everything in the right place
after it happens the page made visible
again the most important bit of work
happens at this track section while
calculating and preparing the layout so
server-side rendering eliminates all but
one of those steps leading to a much
faster ha foot much faster first render
but let's see how it's done it injects
them CSS in the page and calculates the
layouts on the server this eliminating
the flash of unstyled content with this
there is no need to initially hide the
page and the first render no longer
depends on the runtime loading so the
critical path for the first render
becomes something like this and now it's
possible to apply the same improvements
when serving amp from your own
infrastructure m2 box provides the m2
per m2 box optimizer provides the same
transformations used by the Google M
cache the project is open source and
it's available on github
it's fusing nodejs and provided as a
canonical implementation for the
transformations and since since we know
that many of the developers use a
different back-end stack we encourage
everyone to check out the codes and
implement the transformation on their
own languages and please don't forget to
share with us if you do so let's see how
fast
we've spent some time comparing the per
to mised version against the regular
counterparts on amp canonical websites
those tests were run on a regular 3G
network or Lim start for instance the
first render with content happens in
only 3.3 seconds as opposed to 5.10 on
the non optimized version that is at 35
percent performance improvements on lamb
by example the page is visually complete
winning 4.1 seconds instead of 5.4
that's a 24% improvement and on I'm
projector art the page is completed 2.8
seconds faster
that's a 42 percent improvement and on
tasty calm the first render happens in
only one point nine seconds that's less
than half the time it takes to render
regular amps so I hope to have everyone
excited with this out with this now so
let's see how to get started
m2 box optimizer is currently provided
as an NPM package so developers can
integrate is directly to their build
process coop web pack or even the common
line implementation simple so first
imported minimizing to the project load
your amp page and call turns from HTML
to tree generated optimize it equivalent
and for websites with a more dynamic
nature we are also providing a node and
Express middleware also available as an
enemy pain package integrations similar
to other node mirrors first imported
library applied optimizer to the
middleware stack and render your pages
as usual with using express routes so
for developers who want to test the
optimizer but don't use an odious
back-end we have provided a proxy server
demo so to test your own websites just
clone them to box repo navigate to the
optimizer Express demos folder install
dependencies
and burn the proxy sample so those are
only the first steps for the library we
are looking into introducing further
optimizations and if you've had feedback
on how it works or what our ideas for
optimizations please reach out to us on
github or on data and HTML slack channel
so I just talked to you about how to
make your existing web pages and pages
faster and here is a weight that can get
you started on building your own website
we just released a bunch of new
templates this year we've launched it
will relaunch it even cooler and
exciting experiences including some
e-commerce templates with complex
interactions like futuring and scroll
bound animations there are optimized for
all device sizes and it's being used on
over three million euros including fan
cited an American company housing 300
websites for professional sports
including NFL NBA NHL and others so stay
tuned for more templates we just
launched it on today and if you rely on
a CMS like WordPress we have an exciting
talk about our our collaboration with
CMS with WordPress and the potential to
build your WordPress site with amp you
should definitely check it out today at
half-past two and to recap we're
flipping the script we no longer want to
just focus on mobile we want to focus on
building a campus a library that
supports all types of devices and
experiences we don't want you to think
as amp as just another MDOT web we want
it to be your page we want you to adopt
this approach be productive thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>