<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Turing complete...AMP Pages?! (AMP Conf '17) | Coder Coacher - Coaching Coders</title><meta content="Turing complete...AMP Pages?! (AMP Conf '17) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Turing complete...AMP Pages?! (AMP Conf '17)</b></h2><h5 class="post__date">2017-03-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xzCFU8b5fCU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys my name is will I'm a software
engineer at Google and today I'll be
talking about some of the exciting new
ways who are adding interactivity to end
so we've gone over this a thousand times
but first let's quickly review some of
the things we can do in amp today you
may be most familiar with amp pages in
Google mobile search amp supports rich
multimedia content through a wide array
of amp components and there are many
different types of AM content from
mostly static content like news -
dynamic content like live blogs and ads
the dozens of M components available
offer rich but predefined interactivity
and within the scope of the individual
element we do also support ways to have
interactivity across components with amp
actions with amps custom on attribute we
support a simple way for one amp
component to invoke actions on another
amp component there are a few events
that we support most common one is tap
so in this simple example there's an amp
sidebar with an ID sidebar one and a
button with that on attribute that on
tap called the open action on the
sidebar fairly straightforward
that's a slightly more complex example
showing a common use case you may see on
the web today we have two image
carousels a large one and a small one
showing famille we're tapping on an
image on the smaller carousel updates
the display on the larger carousel so
you can see in the code each image and
the smaller carousel has its own action
we're on tap it calls the go to slide
action on the larger carousel with the
ID foo with the index of the
corresponding image now this method
works but it's not ideal as you can
probably tell because of the duplication
of the action markup so recently
released a new amp component called
and selector now AM selector selectors
goal is to make the selecting use case
more concise and natural to use so
instead of duplicating the action markup
on each image and selector wraps all
damages and has a single action and its
own select event contrasted to the top
event we saw earlier and each child
image is identified with an option
attribute and then on select the app
selector just called go to slide with
the option value of the selected image
now I'm selected is not constrained to
only be used on amp images any child
HTML element with an option the
attribute works so it's kind of a
general abstract component and AM
selector and these actions are all
documented on project org
okay so that's that but moving on so
what about more complex interactivity
something that amp actions can't support
for example an e-commerce product page
with an interesting matrix of a product
SKUs and different SKUs may have
different prices or availabilities and
you want a dynamic UI that can represent
that well today you could use an by
frame but as we said it's kind of sucked
ap and you lose a lot of the benefits of
amp or you can work with us to build a
new amp component and this has happened
in the past but of course not the
fastest solution or you do cue dramatic
music
Street Fighter fan you could use and
bind so what is it
M pined is a new component that supports
custom interactivity via data binding
and expressions I just read the slide on
the right you can see a sample to
implement the e-commerce product page
use case we saw on the last slide this
case you're buying apples with different
colors and sizes so if you suspend
disbelief for a second this this is
actually implemented using amp mind and
it's available on the code is available
on my example calm today so how does it
work
there are three main parts state binding
and mutation we'll go through each of
those so the first part is state an fine
introduces the concept of document level
JSON mutable state and it adds a new sub
component called amp state which
basically is just a component that wraps
JSON data in the DOM and M State
initializes this document level data so
in this simple example we see we have a
ham state element ID foo and wraps a
simple JSON object with single key value
pair bar that map's to the string hello
the second part is binding which is
where and line gets the same from
binding aka data binding basically it's
just a link between an HTML element and
an expression where the elements
property and the square brackets is
bound to or updated with the results of
the expression
expressions in a bind can also refer to
the state in this example we have a
paragraph element whose text content or
text for short again in the square
brackets is bound to be expression food
bar plus s now if you remember who was
the ID of the amp state element on the
previous slide and the third part is
mutation or more specifically state
mutation so remember I mentioned that
amp action is the way to add cross
component interactivity part of AMP
binds is the introduction of this new
action and passat that state which takes
its argument and merges it into the
document level state so
since expressions can reference the
state changing the state changes the
resulting value of those expressions
right and then changing the resulting
value of the expression changes the
state of the element that is bound to it
put those all together and see what that
looks like
so these are just the code snippets from
the last three slides put together let's
choose our simple hello world example
for an bind at the top the amp state
which again initializes the document
level JSON data in the middle a
paragraph element whose text is bound to
an expression food app bar plus baz and
on the bottom a button where on tap it
will merge this simple object with a
single key value pair bad to the strain
world into the document level state so
tapping the button makes the paragraph
element say hello world so how does this
work in the more complex sample
ecommerce Apple product page well the
product data is stored in the app State
so that's what color apples are
available and what is the price and
availability size availability for each
color bapple the currently selected
color of Apple is stored in a state
variable called selected color which is
changed when you tap on the individual
color button via a set state and the
price label is bound to the expression
you see their product in brackets
selected color table price which is just
the reference again to this document
level state and mentioned already let
this code and documentation for this
code is on my example calm
so diving a little bit deeper how do you
expression Zin and Vine work well it's
basically a subset of JavaScript with a
few caveats keeping fast and safe so no
loops or custom functions or classes
expressions only have access to the am
state data so no Global's like window or
document and no modifications of J's
internals so funky stuff like you know
swapping out standard built-in objects
and things of that nature also no eval
or
function function constructor or some of
the more crafty things you can do in
Jess as you all know one cool thing
we've added to the expression system is
concurrency through web workers so what
that means is heavyweight tasks like
expression parsing evaluation and
validation are performed on a worker
thread this avoids blocking the main
thread and introducing Jenk to the UX so
just to address the elephant in the room
the point of an bind expressions is not
to re-implement Jess we wanted to make
the syntax familiar to web developers
and focus on keeping it light weight
fast and on the use case of building
cool interactivity within the scope of a
single hand page rather than say the
next grade j/s web app framework that
being said check out how cool it is so
turing completeness which is in the
title of this talk to little quick shady
i know is basically an academic
measurement of expressiveness or
powerfulness above programming language
so am fine being turing complete means
theoretically academically it can be as
powerful as other programming languages
tor which are turing-complete which are
most languages and the way you can prove
that is by simulating a Turing machine
which is the thing on the right there so
basically I eat gray bubble of the line
of gray bubbles is the tape of a Turing
machine and the colored cell is the
current head of the Turing machine and
clicking the step button is the crankset
advances the head of the Turing machine
and process the next instruction and and
so on so the way that it works is we
encoded the state of the Turing machine
via the M state component and step uses
amp dots that state to advance the head
of the Turing machine and process the
next instruction now that being said
please don't actually do this yeah
thanks the more cool technical details
concurrency via web worker like I
mentioned we amortize the initialization
cost live and bind
I mean it's looking up all the bindings
in the Dom with request idle callback
make sure that we don't introduce jank
again abstract syntax trees and
evaluation results are cached and to be
determined determined but we're that's
the getting reasonable performance
constraints on the AP to the expression
and again JavaScript light bindings are
verified by the same logic that we use
to validate in the am validator and we
also sanitize the results of expressions
at runtime the main point is that we
focused on making things fast and safe
and really making sure that Han vine
lives up to the principles of amp that's
fast safe and user-friendly so what else
can you do with implant the first item
we've kind of already covered with the
Apple product demo which I think
personally is very exciting new area for
amp next we know that amp actions
already before offers some cross
component interactivity but I think
Empire really takes it to the next step
because you can also mute a text content
and CSS but I think there are also many
more applications you know including
things that we haven't thought of we're
really excited to see what you guys come
up with so M bind is available today in
experimental and we're currently working
on making it even faster and more useful
with deeper integrations in existing amp
components and better documentation and
we really appreciate feedback hoping
these things you love things you hate
and everything in between
yeah that's a bit of a stretch but I
couldn't resist Lord of the Ring and
okay Street Fighter that's last one and
just responds these I made a miniature
clone of the popular game 2048 using an
bind this basically works by encoding
the state of this 2x2 grid with a 2d
array in the amp state and really
abusing the ternary operator
so why I'm not showing any code on this
slide but please like look at this like
you know the people that build a
calculator in Minecraft don't like shows
to show some of the cool stuff you can
do but maybe not a real world to this
case so that being said I think an bind
is expanding the horizon of
possibilities with amp so please check
it out I take them a lot of time left
thank you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>