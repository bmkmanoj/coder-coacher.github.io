<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Start Contributing to AMP, feat. LaterPay (AMP Conf 2018) | Coder Coacher - Coaching Coders</title><meta content="Start Contributing to AMP, feat. LaterPay (AMP Conf 2018) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Start Contributing to AMP, feat. LaterPay (AMP Conf 2018)</b></h2><h5 class="post__date">2018-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9-GDmi_FsCs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so today's talk is about
contributing to amp and I'm going to
give a brief walkthrough of why I
contribute different ways to contribute
and walk through a very basic technical
example and then handed over to Thiago
who will walk us through his experience
building amp access later pay so so I
wanted to start by emphasizing that by
contributions we're not just talking
about code and everyone interested in
amp can be a contributor we're gonna
spend some time talking about different
ways to contribute today but I wanted to
start a little bit by talking about why
so why contribute well we don't have
JavaScript for the next six months so if
something isn't there yet it can be a
little bit harder to work around but if
I achieve anything today you'll
hopefully find out that it's actually
really easy to just jump into amp and
build it as an amp extension or maybe
you are one of our ecosystem providers
and you do ads analytics or you produce
embeddable content you want to make sure
your products are amp enabled well it's
really easy to do that too as an example
we have about 12 video player components
in amp right now added by their
respective vendors amp is becoming a
significant part of the web ecosystem
and maybe you want to have a voice in
shaping its future contributing is also
a great way to make that happen as for
developers it's also a really easy way
to start with the world of open source
it's a mature project with a committed
core team a very detailed contributing
guide and lots of great first issues so
where do we begin
well we're on github under amp project
we have several different repositories
here and one of the easier ways to
contribute is to file a github issue for
a feature request or a bug report is
thing broken or is there anything you
would like to see more of you can also
join the conversation by commenting
under existing issues there are a lot of
situations where there are multiple
solutions to a problem and we could
really go either way
so under issues like that you'll see
this a lot we could go with approach a
or approach B and it would be good to
hear from the community about that and
you can do that without even typing so
we can sort by reaction count now so if
one of our p3 s is at the top of the
sort by app vote list then maybe that
priority needs to change another way to
contribute is by fixing documentation or
speaking up when something isn't clear
sometimes there are things that are
obviously broken like this dead links
and very straightforward ways to fix
them this was actually somebody's first
pull request or sometimes something
isn't clear or isn't working this was
the end of a really long thread about
course documentation and you know it's a
really good example of basically a
situation where a lot of different
people chimed in to talk about what was
wrong what they were what they were
working on and it finally resulted in
better documentation you can also
contribute by being active in the
community slack and Stack Overflow are
great channels for that another way to
participate in the dialogue is by
joining our weekly design reviews these
are great opportunities to directly
influence the future direction of the
project or hear about challenges facing
other members of the community they're
also really easy to join the time agenda
and conference link video conference
link of each design review can be found
on a github issue under the label design
review we also have new international
friendly meeting times one for each time
zone that's labeled on an issue so it's
also if there's a particular
issue you would like to discuss or
something you'd like to have feedback on
just comment on the issue so of course
another way to contribute is to write
some code
so apart from amp HTML we also have the
repositories and start which is a
collection of production ready
high-quality amp sites and amp by
example which is a collection of simple
to advanced demos that show you
basically how to use different amp
components and across all of these
repositories we have a good first issue
label as well as end to end details set
up walkthroughs good first issues are
pretty big and they're friendly and
usually targeted at first-time open
source contributors but contributions
are welcome on any issues you find
interesting so what's a good first issue
not like that where you you know not
that where you have no context on what's
going on but they look more like this
it's going to tell you that this is a
feature request to implement something
that embeds a github gist component it's
gonna tell you the background the
motivation of why we want this and it's
also going to walk through an
implementation strategy as well as a
step-by-step setup guide and finally
it's going to tag a core member as a
point of contact so this request future
requests for a github gist embed was
actually picked up by a member of the
audience in AMCOM here last year and
we're going to use that today
as an example to walk through the basics
of building an amp component amp
components are the basic building blocks
of an amp page and most contributions
revolve around creating a new component
or updating an existing one so if you're
unfamiliar with github gist they look
something like this
they're basically code snippets that you
can create and share on github a couple
of developers last year we're using an
for technical blog post
they wanted a reasonable way to embed
code snippets in an amp page so somebody
proposed this idea for a component to
embed github gist's so like all amp
components amp gist the component is
going to live in the extensions
directory of amp HTML and if we take a
closer look at amp gist here's what the
directory structure of a basic amp
component looks like we're going to have
a folder containing the initial version
0.1 of the component a owners Dom will
file that's just the github handles of
the component maintainers a amp gist MD
or your component name dot empty files
which is basic documentation on how to
use your component and it'll have a
validator validator file
this tells the amp validator how to
check if a user of your component is
producing valid amp so if we take a look
at the 0.1 folder that's going to
contain a test directory for your unit
and integration tests JS file for the
implementation of your component and
optionally for a component specific CSS
file which would here be called amp just
dot CSS but amp just doesn't have a CSS
file cool so the majority of your
implementation is going to be in that
JavaScript file and it's going to
implement the base element class if you
ever implement a component that's a good
class to a reference but for now a very
basic implementation would look
something like this
really easy right cool
so before we dive into that
implementation let's take a very tiny
step back and think about what amp is
amp is effectively a resource manager
and it's responsible for managing and
components on a page each component has
a resource lifecycle this is a slight
oversimplification but when we build a
new amp component we're essentially
specifying what we want to do at each
stage of this resource lifecycle so I'll
briefly walks
you stage and there will be a little bit
of sample code from amp just pertaining
to each stage so don't worry about that
too much because there's a code lab for
it too so we start with building the
component build is what happens
immediately when page loads think of
this as creating the bare-bones of your
component which is usually just a
container div nothing too much happens
here no loading external resources no
heavy weight computations what this
function or stage is mostly good for is
for reading and validating component
attributes so amp just actually doesn't
have a build callback it does nothing at
that stage so pre connect happens after
your component is built but usually
before we start laying it out on the
page it is exactly what it says it does
write it pre connects to sources that
you'll need for fetching anything later
which in the case of amp Geist is just
connecting to Geist github.com it's not
always necessary but it's pretty common
with video players and anything that
loads an iframe the next stage is layout
here is when your layout happens when
your component is going to be seen it's
going to fetch external resources it's
going to do any heavyweight computations
it's basically going to do the things
that you only really want to do when you
know your component is going to be seen
so for amp just here this involves
constructing and getting an iframe from
github and then telling it to fill up
its container with its contents and
finally you get to the unlaid stage
that's what happens when your document
becomes inactive your document becomes
an active when the user swipes away from
it in the viewer or when another tab
it's focused in situations like that you
want you for your resources like memory
or CPU so for amp gist this simply means
removing the iframe we created during
the layout stage it returns a boolean to
indicate whether or not we should call
layout again
blast stage when the document becomes
active again so at this point this is a
little bit of an oversimplification but
you've basically told your amp component
what it needs to do at every single
stage of the resource cycle and you've
basically implemented the base element
class so once you've done that you can
start testing it to verify that it
actually does what you want it to do
you can basically write a amp page in
the examples directory or the test flash
manual directory and you can name it
after your component and then so that
other people know what your component
offers you can create an example on amp
by example this would usually involve a
short introduction on what your
component does and a few basic examples
showcasing your API all right now that
I've gone through
why contribute and some ways to
contribute I'm now going to hand it over
to Thiago to talk about his experience
building amp access later pay yeah so
I'm Tiago I'm a front-end developer at
light repay and I'm going to tell you a
little bit about our experience
contributing an extended component for
amp so let me start by telling a little
bit what the lighter pay is we are
primitive structure provider for digital
content so we allow people to sell
individual digital items like articles
or videos anything digital and we allow
them to sell this in different ways so
they can sell just the item or they can
sell a time pass like one day one week
one month or they can sell subscriptions
which have recurring payments and these
smaller these items with smaller amounts
like for instance like in this example
they go into a tab so a merchant can
define oh I want are my users to only be
able to pay this later so this goes into
the tab and they only pay when they
reach five euros so this just makes it
easier for them to like start buying
content without really having to pay
immediately
and they can share this type across
anything that uses what you pay any
website is later pay and it can pick
just which sales models they want so if
you just want to sell articles they can
do that if they want to solve also time
passes they can also pick that so why
did you decide to go to build an amp
component well first of all most of our
users or the big majority of our users
of our customers are in the publishing
market and amp initially was also very
popular mostly with the publishing
market so it just kind of makes sense
for us to to have an M component and
also some of our publishers could
eventually see not having later pay in
the amp platform as a hurdle to not
adopt later pay so yeah it was a bit of
a no-brainer for us so how did we get
started with this well when you start
out developing this component which is
back in late 2016 the contribution
process wasn't entirely clear yet there
were some guidelines most in terms of
tooling how to set up the project
locally how to get it running develop
code but not so much on how you get
around it like how do you track an
extended component how do you use the
existing code base so we started we
initially start a conversation with one
of the product managers this helped us
and the EM project understand does it
make sense for us to be a part of this
ecosystem and once we figure that out we
started talking to developers so at this
point we try to understand what the best
approach would be Emperor D has an axis
which is which allows developers event
pages to have an app to have a login
mechanism mostly for paywalls
so it's a bit like a generic paywall
integration which publishers can
integrate with their server sides
subscription services and we spent some
time like looking into this and
explaining our workflow and realize that
our work flow and the flow from M axis
were a little bit different so at this
point the question was do we
to build an entirely new component or
can we use or can you still use impacts
somehow this is the flow the user flow
on an axis where if he's not tries they
can just look at the documents they've
they have a subscription they can access
it otherwise they might have to go to
the login process so if you're
developing an EM page you can establish
you can define some logging links for
sign in or sign up the user quick-set
log in link opens in the pop-up window
goes through the dialog to the log in
workflow and that one set validated get
pretty active back to the back to the
page and you can look at the document
however we had our flow is like a bit
different because we provide some other
options and we don't entirely require
login upfront so the solution here was
to essentially vendor eyes and access so
we could extend it but still use parts
of it as we saw fit so the flow that we
ended up having is a bit similar with a
few changes here and there initially
it's the same thing if this is
authorized they can look at the document
immediately otherwise we need to get a
purchase configuration because our
merchants can define if for instance if
different items have different prices
some prices might not and some items
might not be covered by a time pass or
by subscription so each thing on a
website can actually have different
purchase options and those purchase
options are those links that we show to
the user directly on the on the end page
so we get that purchase configuration we
then render that purchase dialogue you
just like the purchase option then this
part is a bit more true our it's what
can happen on our login flow which might
not exactly be login so the simplest one
is if they log in if they tablet their
tablet even hasn't been rich it just
affirm the purchase and then they can
access the article so it's like two
plates otherwise I might have to settle
a tab or if it's not a pay later item if
it's obtain our item then they will have
to pay now and they go to that and then
once that's done they can access
document so yeah we're using quite a few
parts of the actual and
here you can use amp axis has some tags
that you can use to define which parts
of the documents are not available
initially until the user buys it so you
can still use those we're using also
like some other parts of the code and
then we just tap into our own code when
we actually need to so getting started
with the codes we initially just further
discussed what the actual code flow
would be kind of based on that previous
diagram and then we got this skeleton
for an access extension component which
is not exactly like a regular and act
amp component and we had a bit of a
whole design review even before this
concept was a bit more established as it
is nowadays and yet then we just started
working on the code and start working on
this implementation we also had to work
quite a bit with existing code base so
the existing code base event has a lot
of utilities for working with the Dom
for networking but there wasn't a lot of
information back then on how to get
around all of this however like a lot of
this code is very well documented
there's a lot of tasks a lot of type-ins
so it's fairly easy to understand the
API to understand like what's there and
how you can use it and you can also look
at other components that already exist
to figure out how these things are being
used these days there's a lot more
documentation on this there since this
document which explains how to build an
app extension and it also takes you
through some of the existing components
like why you should use vsync I think
which is a component that allows you to
batch up rendering and some things like
those are good practices in terms of amp
components which if you're new to the
project you might just not know about
it's not entirely obvious that those
things are there and that you can use
them and we also got to help with
improving this code base we made our own
pull requests for some of the networking
utilities for the impacts base component
as well some things that need to be
changed
that could be improved as well and it's
also very straightforward because yeah
there's already a lot of tests a lot of
type int so it's fairly easy to
understand how to do it
so how did this whole flow go that we
open the work-in-progress or request
once we already once we really had some
stuff to show and this allows us to push
some code ask for review as arguing in
the right direction that we're doing the
right thing is there are other modules
that we should be using and once we
figure that out we could finish up the
code clean it up write more tests
make sure all tie pins are okay and just
continue working on it
once we were done after a few rounds of
reviewing fixing and our code was ready
to emerge
it was initially merged with the
experimental flight turned on and this
is a bit like on Chrome and you can turn
on like experimental features you can
also turn on experimental features on em
which are only active in your browser
and then you can try that out on an
actual production environment from based
on the actual production and code base
instead of just running it locally this
also allows us to eight-hour while we
were finishing our back-end service so
that we didn't have a pull request open
for too long until we actually have had
back-end service to work with this and
yet once this was all done and they had
tested it made a few more fixes we could
we submitted like a last pull request to
remove the experimental flag and then I
could just turn that light off
so in conclusion while some of these
contributing processes at the time
weren't exactly there the communication
with the amp team was pretty great there
was a good flow of a good feedback cycle
and yeah overall the an team they took a
lot of our feedback in what could be
improved what guides were missing what
information was missing and they made
the whole experience a lot better and I
think it's especially having contributed
more than a year ago looking at it these
days the experience is a lot better so
yeah thanks to the engine</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>