<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a new AMP component (AMP Conf '17) | Coder Coacher - Coaching Coders</title><meta content="Building a new AMP component (AMP Conf '17) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a new AMP component (AMP Conf '17)</b></h2><h5 class="post__date">2017-03-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FJEhQFNKeaQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good afternoon everyone my name is Han
che
and I'm a software engineer on the am
project and today I'm going to talk to
you about building a new amp component
I'm gonna walk you through what is an
amp component why you should care about
building one when should you build one
and then how to do it so first what is
an amp component well you can think of
an amp component as a building block
with which you build amp pages and a
good example is the amp lightbox so here
on the left hand side we have a page
that has an image and when you tap on an
image it expands and goes to the full
view this is the lightbox and this is
one of the blocks that helps to build
this page now why would you ever care oh
I am a couple sides behind why would you
ever care to build an amp component well
you might have an e or an idea that
doesn't yet exist you don't want to wait
around and hope that someday maybe
someone will hopefully build it you're
dying to join our amp community and we
welcome you to join our community and
you want everyone to see what wonderful
work you're capable of doing you want to
showcase your skills and also you want
to have impact in case you forgot
we have over 1.4 billion amp documents
out there in over a hundred languages
and we see about 26 million pages every
week and you can be a part of that now
let me ask you a question how many amp
components do you think are out there
today that were created by people
outside of the amp project anyone you
yes what's your name
Jacob how many amp components do you
think there are 20 well I didn't
actually count them but these are all
amp components that were created by
people outside of the amp project there
are a lot of them and we have a few
statistics about them too they are being
used in the millions that's pretty
amazing no beds told us earlier today
that we have 300 unique contributors to
amp and we have over 9,000 developers
engaged with the amp community so there
are a lot of people that are a part of
this community and you can be one of
those people as well now when would you
build an amp component a great use case
if the component does not yet exist and
it needs JavaScript a good example is
that light box that we talked about when
you tap on an image it expands it needs
JavaScript to do that another use case
is if you're loading external image
external resources so for example you're
welcome to use the image HTML tag when
you build web pages right it's there for
you the problem is that if you have an
image all the way down at the bottom of
the page it's going to have to load
before your users see something in the
viewport and if you want to have control
over when an element loads and you want
to do smart things like prioritization
then you can create amp components to do
that for you another good use case is if
you have some useful semantics so I can
use the amp iframe to load a YouTube
video but maybe I can make good use of
an element such as the amp YouTube
element if I have a user enter the video
ID and then I can verify that this video
actually exists
as a side note if you're building a
component for a video player I hope that
someone else is using it and not just
you that's one of our requirements that
it's being used by more than one person
now all these things that I mentioned
they go they're considered core
components they belong in the amp HTML
project under the extensions directory
now there is a use case where you might
want to develop something that already
kind of exists but you want to add a
twist to it you need it to be a little
bit different and a great example is amp
tabs amp tabs does not exist
it needs JavaScript and tabs it's a
pretty common thing in webpages so we're
like yeah let's build an amp tabs
component however it turns out that the
amp selector is very very similar so in
this case in this use case instead of
building amp tabs you would take amp
selector add some markup and then you
have amp tabs and we encourage you to do
that as well but when you do that please
take your code and put it in amp by
example so other developers can see how
to use it and follow what you did now
there is an exception and there always
is and that's a use case that hides
complication so another example is amp
rating it turns out that amp rating is
very similar to amp selector as well and
it's just a little bit of CSS except
it's not just a little bit of CSS it's
actually pretty complicated and it's a
lot of work to put on the developers
shoulders so this does exist an amp by
example but because it's complex and we
wanted the user the developer experience
to be easy we also made an amp component
for it so now that you know everything
about amp components let's talk about
how to build one congratulations you've
decided
to bring an amp component in the world
now in many cultures it's usually custom
when you want to bring a child into the
world it's usually custom to talk to
your partner about it ahead of time most
people like to know and would not want
to be surprised and we are no different
so please the minute you decide to build
an amp component please let us know
about it please talk to us early on so
that we can help you out and make sure
you're doing the right things before you
put all the work into it and there are a
bunch of ways you can contact us the
best way to start out with is to file a
github issue where you can write down
all your thoughts then you can ping us
in slack and say hey guys here's a link
to my github issue please take a look at
it and that's great as well but if you
want to show up in person we also have
these weekly meetings where we have
these design reviews and they're open to
the public and you're welcome to come
with your questions and it happens every
Wednesday from 1:00 at 2 p.m. all right
so now you've decided to build an amp
component and now you have to think
about a name and we have naming
conventions every component has to start
with amp - and then the next name that
comes after that has to describe what
you're doing and for this presentation
we thought long and hard about a very
wonderful name because when you name
your baby it has to be a great name so
we came up with amp blah that's what
we're gonna name our component for this
presentation and now that we have a name
we have to think about the document
structure so under the extensions
directory you're going to create your
own directory and it's going to be in
the name of your new amp element and in
that directory you're going to have a
folder called 0.1 that's gonna have all
of your logic and you're gonna have an
MD file this is going to be
documentation for other developers to
know how to use your element and when
you think about how other developers are
using your element please put yourself
in their shoes and make their lives very
easy you want to make sure that it's
very easy for developers to implement
the code that you're writing that you're
putting so much time in you want it to
be used so this is what's gonna go in
the MD file now let's talk about what
goes in 0.1 you're gonna have a
validator file these are the validator
rules we talked about a script that
validates that amp pages were created
correctly well these are the rules that
you're going to write to make sure that
other developers are creating your page
correctly you're going to have a
JavaScript file with all the core logic
and then you're going to have a test
directory where you put all of your
tests now let's talk about the lifecycle
of an amp element what makes it work so
well initially an amp element is gonna
start off in a state of not built and
what happens is the browser is gonna see
this element for the first time before
the JavaScript has been loaded and for
that split-second the browser has no
idea what this is so it's gonna treat it
like a div but because CSS is inline and
already their CSS is going to be applied
so the user won't see anything different
eventually the JavaScript is going to
load and the amp element is going to be
upgraded to an official amp element and
the browser is gonna know exactly what
to do all right now most amp elements
extend the base element and what you're
gonna do is you're gonna have a
constructor to initiate your variables
and then there's going to be the build
callback and the stuff that you do in
the build callback is gonna be a you
want to validate that your element was
created properly so for the example of
amp Hulu one of the requirements is to
have a video ID for the Hulu video so
you can Matt have these validations in
your build callback the other thing you
can do in the build callback is
manipulate the Dom so here we let's go
back to the amp carousel example on the
left side this
is how an amp carousel is created by a
developer know we're here in the HTML do
we see arrows or buttons or anything
like that the developer never had to
deal with that they shouldn't and in the
build callback that's where you can add
these manipulations and add all the
functionality we also have pre connect
so if you go back to videos for example
there's a lot that goes on when you load
a video it's a very heavy operation and
one of the things that you can do is pre
connect so that in the video example
when it's time to load the video it's
gonna be much faster so here we've
already connected to the host now after
all of these elements all of these
methods have been called the state of
your element is going to be built you
can think of this as getting ready to go
on stage for a performance after that
you're gonna have the layout callback
this is what you're gonna call when
you're gonna do the expensive operations
and when you're actually going to be
loading the heavy things like your video
files and the state here is gonna be
laid out or you can think of it as
you're ready to go you're on the side of
the stage and you're waiting for your
cue then you're gonna have the viewport
callback this gets called when your
element goes into the viewport when the
view when the user can actually see your
element the state of your element is
going to be in viewport this is show
time this is you front and center
everyone's eyes are on you
and finally there's gonna be unlaid
callback that's going to be called
occasionally when you want to remove the
expensive resources from the page and
this is your cue to take about an exit
and the state is going to be not laid
out so to go back to the lifecycle of an
element you're going to start off with
not built built laid out in viewport and
finally not laid out now you've gone
through all the work you have a
wonderfully working element
what's the approval process how do you
get this thing live well what you need
is two reviewers to approve your your PR
on github and then once you've approved
you have a brand new amp element into
the world now you've worked long and
hard on this element and you put your
heart sweat and tears into it and we
want to make sure that you continue to
have ownership and responsibility over
this amp component we don't want to take
it away from you it's yours so what you
want to do at this point is create an
owner's file where you put the github
names of all of the component parents
all the people who are responsible for
this little component child now as your
component grows your versions might
change as well and I talked about a
directory called 0.1 what a 0.1 even
mean well 0.1 is the version of your
component and you can continue to
contribute code and make changes and add
things to your component and your
version will stay 0.1 the only time it
ever changes is if the API changes and
what does that even mean let's say you
have some attribute that a developer
adding your component has to put in
their page and for some reason you have
to remove this attribute and put a
different attribute and that's going to
break any of anyone else who is still
using your component with some attribute
so in this case your version number
would increase that's what it means now
a lot of components when they're first
released into the world they're released
as experiments and we encourage you to
do the same
and to do so you want to put your
component in the experiments file and
then in the build callback you want to
verify that the experiment has been
enabled because maybe not everyone wants
to be a part of the experiment now when
you bring a child into the world when
you're a first-time parent usually you
have a lot of questions you don't really
know what you're doing a lot of the
times you go to the pediatrician and the
pediatrician is there to help you and
answer all your questions and we're also
your pediatrician in this case you can
ask us questions through github you can
file issues you can contact us on slack
and you can also show up in person to
this hangouts meeting that we have every
week Wednesdays from 1 to 2 p.m. and if
you're too afraid to talk to us at this
point or you want to look something up
online by yourself there's also the
contributing MD file and that hopefully
will have a lot of answers to your
questions as well
now finally as they say it takes a
village to raise a child and it takes a
village a 9300 person village to raise
an amp component as well and you don't
have to be a contributor by creating
your own component you can be just as
impactful in a components life by being
there on their uncle their grandmother
their grandfather you can make an impact
as well there are many issues out there
and we encourage you to take on these
issues and help contribute to grow these
components and make sure that they're
successful so now you have an idea you
don't want to wait around for someone to
hopefully someday maybe implement it
you're dying to join the amp community
the amp village you want to show
everyone what amazing work you're
capable of and you want to have this
great impact
so stop waiting get on out there and
build am components thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>