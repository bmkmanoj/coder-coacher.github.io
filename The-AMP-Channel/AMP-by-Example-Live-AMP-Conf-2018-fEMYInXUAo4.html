<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AMP by Example Live (AMP Conf 2018) | Coder Coacher - Coaching Coders</title><meta content="AMP by Example Live (AMP Conf 2018) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-AMP-Channel/">The AMP Channel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AMP by Example Live (AMP Conf 2018)</b></h2><h5 class="post__date">2018-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fEMYInXUAo4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone I'm Sebastian
and as Paul already said like we both
work on and by example and today we want
to do something special like we want to
work on a sample there we're going to
publish later but we want to create the
sample life and I personally find this
always really interesting because once
you need to with one thing to see like
sample code but it's a complete
different thing to see how this code has
been creative and so I think it's like
really interesting to see that the whole
progress of what it's like to to develop
something that's what we're going to try
to do so today we want to implement as
many of you probably have been traveling
here a hotel landing page and there we
want to show a few like really nice
dynamic feature searchers like filtering
rooms things like that and why we're
doing this women show some of the really
cool new components that have been
recently added to that want
so we prepared a very basic on page here
so as you can see we already have
imported the runtime Franco we have some
basic CSS and we have the UM boilerplate
CSS so today we want to build a page for
our Oden called the Amsterdam so we did
like in this yes as you've seen earlier
so we just have a default styling for
buttons because otherwise you probably
won't be able to see them later on in
the demo and there's nothing that we're
doing is we simply use the system fonts
as the default font for web page and I
think there's a really good pattern
because this ensures like for example
using when I've asked you're gonna
you're gonna be using Co on an Android
we're going to be using Roboto so this
ensures that your website really matches
into the current device and the big
advantage of this like you don't need to
load any additional font resource
initially when the page is loaded so
this then can greatly speed up initial
pages of time so yeah by local web
server running which is serving some
page so we can already see how it looks
like so if we load the page so this is
gonna be the page we're gonna build up
today so we want to pull the list of
available rooms for the Amsterdam hotel
so first thing so I'm gonna use the amp
list element in order to do that so I
start by importing it I'm just by the
way it's such a useful component or the
same time it has such a terrible name so
it's it's so misleading but it's not
really it's good for having dynamic list
content but it's also really good to
render dynamic content so I think I'm
much better name would be amp dynamic
content because that describes a lot
more what what this does components
actually about so I've imported
and please send Leon - of course so
let's let's start adding the um please
to the page so let's yeah I'm pleased so
I'm pleased offers a set of layout that
you can use so we have the fixed the
responsive they fit slide layout when
the content of an implicit actually a
list of items we we notice that the best
layout the layout the works better is
the fixed ID so this is what I'm gonna
use it today I'm just gonna use a fixed
eyes here and then as a source I'm gonna
use the endpoint that I mentioned
earlier which provides an API to
retrieve the available rooms for the
apps and important so this is rooms so
now that I have my amp list them I can
shown the page some information like I
can show an image so let's import an
image so let's give it some way the eye
and the source and then for each image I
can add like the name of the room next
to that all right we can see if that
works
now let's see the three of the page and
actually I cannot see any Roomster so
let me go to the console and see felony
others yeah so the console is telling me
that the response must contain an array
an array of items what it mean is that
iam please is expecting an object
containing an array progress with an
array with the property called items and
because my endpoint is just returning a
plane away I need to go back and tell to
the at least that my items are just
inside the array that is returned so I'm
just going to use the items attribute
and say just take the array that paradox
so let me see if that works now yeah I
can see the list of the rooms can you
see the the room star okay actually me
personally if I'm looking at them I
cannot really see those images because
they are too small so wouldn't that be
to be able to just click on those and
see an a large version of the image and
actually it's really easy to do with one
of the newest component from the from
ampere which is called amped like box
gallery so let me show you how to use it
and anyway it's a component in
experiment so first thing I'm gonna
import the elements so it's called um by
box gallery and the cool thing is that
it's very easy to use just go to the amp
image element and just add like a
lightbox attribute and that's it and you
can also use it with the amp car as a
component so let me show to you how it
looks like ever saved ok reload the page
and as you can see I click on image and
the see on a large version of the image
I can even swipe between the images I
are on my page and it gives me a gallery
of thumbnails of all the images in my
page so I think that this is really like
awesome to be honest like just like you
at this little attribute and you get a
fully blown lightbox experience and
although I like one thing would be nice
because I mean this is a hotel page so
I'm looking at different rooms and I
would actually like to know for each of
the images like which room I'm actually
looking at ok it's very easy to add a
caption to images when using this new
component let me show to you so I'm just
gonna go back to the amp image element
and I can use the alt attribute of an
image to specify a caption for the
images in the gallery it's so it's I
mean you should be adding that out that
we have anyway for accessibility reason
but you can also use like that different
ways on how you can add caption to to
the lightbox you could use the Aria
label at
you could use a pickup figure caption
element so they're quite a few arrays so
now that I can see that on the bottom I
have the name and the description of the
room said that that's pretty nice
okay so now we have the list of rooms
but we were thinking maybe the amps at
the motel is going to be very busy
during this conference so we are going
to go and try to implement a filter of
the rooms based on the availability so
in order to do that I'm very excited to
use one of the newest and component
which is the amp date picker it's
probably one of the most highly
anticipated components either like how
often I heard the question like how can
I do a good date in platinum so again
this is an experiment this is still in
experiment so I've imported the
component and actually let's start using
it so we have maybe I cannot here just
pick a date and then I'm going to add
the under picture so do it so there are
two types of amp datepicker
one is for a single date and one is for
a range so because I'm gonna need the
arriving and the living date I'm gonna
use the type range and then it requires
to specify two inputs so again in our
case we have an arriving one and we are
gonna have a living date let's see we
can already see how this works
maybe you really want to see how the
antique picker looks like and yeah we
can see we have we can select an arrived
a frequently liked living date and
that's it as you can see it on the right
turn you may see some errors this is
because the the
the curry cylinder experiments so
sometimes there are errors in the in the
console the MEP can also give us a
button to clear updates so I can click
on this and the dates will be cleared
and I'm doing this just simply by adding
the show clear dates attribute to the MD
picture element so now that they have um
date picker in place I want to be able
to I want to make an additional request
to the server and get the rooms
available for the states so in order to
do that I'm going to rock yum the picker
into a forum and as you already know
forms are available in um but they need
their own extensions so let me out
beyond the forum expansion first I've
created these like snippets just for
this demo and I was like how could I
lift a business before it's so useful so
I really recommend like doing this like
when you're working with them so what
form is gonna have get metered and we
are gonna use the same endpoints I was
talking about earlier which we already
set up which is able to we can mean we
can query this endpoint to get the lists
of rooms based on availability so then
we can move the object picker inside the
forum because we want to use the inputs
as inputs of the form and we will
probably need a pattern so yeah the nice
thing about the date picker that it
works like simple text input so you just
drop it into an art form and your
servers are able to receive the dates
that the user entered right now so we
have our peak date picker so we can pick
some dates and then we have a button for
check availability but this button is
not doing anything at the moment so what
we want to do now is take the
response from the server request and
update the list of rooms on the page so
let's go back to our code so the young
form
so another DM for returns with either a
successful or narrow response it meets
an event the submit success event or
dismiss error so in this case I'm gonna
use the submit success event to know
when the response is returned so I'm
gonna say on submit success I wanna set
they wanna set a new variable by using
the amp set state such date and I'm
gonna call this new variable guess what
rooms and this variable is gonna contain
the response of this server calls so
this is gonna be set to the events dot
response so now that I have is global
variable availablein I won the typo
actually I am so not a play of this
variable available I wanna use it as a
source of my amp Lee system and you are
good to do that I'm going to bind the
source of jump list to the variable
rooms this actually really cool feature
of endless is that you can add bindings
to the source of the man and it has like
two modes like one side you can provide
in URL which is then if I'm straight
update I'm just going to fetch in new
and we're another content or you can
even like just simply find it to
specific and state variables which can
be very very powerful actually let's see
if that works
reload them so let's pick a date so 96
of February 20 a check availability and
yeah I am unbind it's not installed
actually that's that's that's true
because I forgot to import the unbind
expansion which I'm going to read now
so damn fine
reload pick at it again 26 to the 28th
checked availability and as you can see
they rule the list of room the rooms is
updating with the with the content of
the variable rooms so we can also clear
the day turned on in that case we are
returning the list of all the rooms and
actually since this hotel can be very
busy during the uncomf
let me check the availability during
those days so let's say from the 14 to
the 15 checked availability and as you
can see there are no rooms available for
this period but actually it would be
nicer if we would show a message to see
that there are no available rooms and I
think now Sebastian can show to you how
to implement this yeah so the problem is
that like it's really important for the
user to learn like there's there are no
rooms available but there's like no
building way in am please know how to
handle the empty list state so we have
to find find a different way to do this
and one thing that we can do is to to
use and bind again to show like a
message if if the if there are no rooms
available
so let's first create the message so
something like sorry no rooms available
and then we gonna bind show this message
only if the list is empty so it should
be hidden by default and I'm using the
hidden attribute here this is part of
them runtime and surprise it hides
elements but it's it's very useful if
you combine it with actions for bindings
and what I'm gonna do here is I'm gonna
add a binding for this so so this should
only like hidden should always be
present if the list of rooms is not
empty so let's see
the quotes so let's let's try if this
works so reload the page initially the
message is not visible now let's check
the availability during an conf and we
see still it's at the bottom and this is
like the settings second annoying bit of
about am please so when you dynamic lis
changes its content it doesn't resize so
busy we have to do this this as well so
you can take a look we see here's a
empty list still taking up all the space
and which is like very ugly in this case
but this is like quite an easy way to to
fix this and the idea is to again use
Empire to to update the height based on
the number of elements so and this is
like I only like talking a while until I
learned this you can actually add
bindings to to lie at layout attributes
such as height so in this case I'm going
to calculate the height based on the
number of elements and in our case if
you look at our sample we see that each
item has a they're the same dimensions
so in this case it's 73 pixels so it's
basically that the height then should be
73 times the number of elements in our
room so let's see I'm going to check the
availability for I'm configuring and we
see our message to snow at the correct
position and that list has a height of
zero so these are two really really
interesting best practice for when
recommends and this first thing is
channel the empty list state in the
second when to always make sure that to
adjust the height based on on the
content so this is quite nice so far so
basically what we've done is we
implemented suicide filtering for we
rooms list but it would be nice to to to
be able to back filter this list even
further for example was considering
whether I should bring my dog to
Amsterdam so it'd be nice to to see
which of these rooms are our pet
friendly so let's let's implement
pet-friendly filter but I don't want it
to have to make another request of
back-end instead I want to implement
client-side filtering
so before we start implementing the
filter I quickly want to to highlight
that the pet-friendly rules and
conveniently our room so object contains
a figured chord fret pet-friendly which
simply returns true if this room is is
pet-friendly so and whenever rooms
pet-friendly i wanna print a nice pair
of pause so we see quite a few of the
rooms up head friendly and now we want
to filter this so first thing we need is
a checklist a checkbox so let's talk the
labor saying show only pet-friendly
rooms and then we need to the final
import and this is a check box let's
quickly see if it's there yeah and now
we want to to implement a filter based
on this check box so the first thing
that we need to do is basically update
and state based on the value of the
check box so we once again need to
register to an event in this case it's
the change event and when the check box
changes we're gonna set the am state and
we're gonna write a new variable and
write a new variable let's call it show
pet-friendly and then the variable is
the state of the check box and we have
to get it from the event and in this
case the value is called checked so
there's one thing like events are super
useful and and however like the naming
of the value fields are it's not
consistent so you have for each of the
different
elements you have to know how to access
the correct values and there's a really
good page in the official documentation
it's called accident events it lists all
the different events and actions plus
how to use the defend values access to
different values of an event this is
really useful so if you want to start
working with am pine definitely take a
look at this page so let's see see how
it works so I'm gonna reload the page
and here's another really nice trick
when you want to debug your unbind
expression so I'm going to switch on
development mode by adding hash
development equals 1 to the to the URL
and then you can access the print state
function on the console E and what it
does so once I'm doing this we see
initially the Sam state is empty but
hopefully when I changed the value my
check box you can see now or show
pet-friendly value has been written to
the to the M State so this is super
useful when you're working with an bond
so now we've got the filter status in
our state now we use it use it to
implement our filter so and how we do
this is like when we bind the rooms
variable to in our amp list we we have
to filter the list of rooms and Anne
pine provides the filter operation and
it works exactly like the filter
function of an on an array and and in
JavaScript so whether you provide a
function which receives a room and then
based on the value of a shop Fred
friendly check box we are either gonna
return whether this room is actually pet
friendly so let's do this and if we
don't care about pet friendliness we
simply return true so this means we
don't want to we want to see all the
other rules okay so let's see other
Smurfs so loading my page and I'm
clicking on my check box and nothing
happens
and at this point the crew the console
is actually having and having us so it
says rooms is not defined now that's
true if you think about it because
initially we are ending the available
rooms using them list and not AM state
so the rooms wherever is actually not
yet initialized on on page load so and
we have to do this and the way it's done
is using the the M state component so
this is barely an easy way to pre-fill
your your on state and we gonna assign a
response from our rooms and point to the
rooms variable and the trick here is
we're using the same end point as for
our analyst and this is quite a common
pattern and so basically this ensures
that the amplest and bam state have a
consistent state and as we are both
components are making a request to the
same end point we can mine we benefit
from the Emraan times response patience
so even though my components like
specify a request to the same URL it's
going to resolve in only a single
request so it's this is no problem at
all so let's see so we're gonna reload
in all rooms and yeah we can filter by
preparedness now and the nice thing is
even that it also works for the rooms
that are also further based on date but
now that you have this filter all the
height of the um please yeah that's true
that's that's probably yeah it's most
likely not going to work let's let's
take a quick look so we see here or am
bliss
once again the height is off and this is
because the way how we calculate the
height in our code we see that the
height is is it here we simply use the
rooms variable to calculate height which
is of course wrong because it doesn't
include then additional feature a filter
like in this case the the
friendly filter so what we have to do is
basically we have to put the filter
every time we access rooms marble which
feels very wrong because we're basically
duplicating quite a complex expression
so there's like thankfully nowadays in a
really easy way to avoid this so
recently the the new amp bind macro
extension has been added which basically
allows you to declare functions you can
call from within your bindings and this
is like such a fantastic addition
because it finally makes it easy to
write maintainable and bind expressions
so the way it works is you define an ID
so in this case it's let's call it theta
rooms we don't need to provide any
arguments because we can ask macros can
access amp state so I'm simply gonna
copy the whole filter expression added
into a macro then every time we call
you've ever used rooms before
I'm simply calling our macro which will
then run our filter so let's see if this
works
so filter still works and if we combine
the multiple filters you see the height
is also calculated correctly so wait a
second so does this mean that the filter
is gonna be executed all the time that
yeah right so yeah that's that's a bit
inefficient here if you want sir because
basically that the filtering on the
rooms is performed three times so yeah
that's that's not very nice however in
this case our data set is quite small
like how many rooms different room times
as a hotel usually have 10 20 and ambien
expressions actually execute really fast
so for small data sets this isn't really
a problem so in this case this approach
I would prefer this approach because
it's a lot easier to implement if you
have like really large data set then you
would have to do it differently
basically then you
after everytime them states change so
when you're loading new rooms from when
you get new rooms went back end or when
someone clicks on the filter then you
would need to update the state with the
photon result so this is a little bit it
takes a little bit more effort to
implement but still would be still
possible but apart from that I think
this is like a pretty pretty good sample
page so what we've seen it's like you
can do server-side filtering client-side
filters and bind and these work together
so we've seen the the really nice new
light particle permits playing you add a
single attribute and you get a really
nice fullscreen my work experience and
then we've seen like some best practice
and how you implement how to work with a
list so pianos link this is now
production ready code a couple of things
we could do here so for example when
when we load the page if the height that
I specified for the amp list is not
enough for all the items we could use a
button to show more rooms or in other
things we could do here is to have a
personalized place older when loading
the list of rooms and what about you
what could be done here so yeah I create
like shouldn't handle all the the corner
cases but but also like one interesting
thing optimisation could be here like at
the moment when you when you reload the
page so first the page is going to be
loaded and then the amplest components
load that this is gonna file for request
to pull in the rooms forever like the
default number of rooms is actually
really static this is not very likely to
change often so in this case action
would make sense more sense to
server-side render the rooms so the
whole page is going to load a lot faster
because amazing the second request
required and yeah
and then basically when you implement a
filter what the filter does as soon as
you click somewhere the server-side
rendered version of the rooms is hidden
and then you replace it with an with an
app list but apart from that if you want
to play around with the code that we
just show today you can check it out on
on by example and we've done for today
so thank you all for all your attention</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>