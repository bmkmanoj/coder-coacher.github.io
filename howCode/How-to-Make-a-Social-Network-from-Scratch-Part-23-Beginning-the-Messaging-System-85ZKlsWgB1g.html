<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make a Social Network from Scratch: Part 23 - Beginning the Messaging System | Coder Coacher - Coaching Coders</title><meta content="How to Make a Social Network from Scratch: Part 23 - Beginning the Messaging System - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make a Social Network from Scratch: Part 23 - Beginning the Messaging System</b></h2><h5 class="post__date">2012-08-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/85ZKlsWgB1g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so why I'm welcome back to this video so
today what we'll be doing is creating
the private message system
I'm making that button work so let's get
started
so I'm going to delete these two PHP
tags and make this all one and then I'm
going to say if is set if it said post
send a Miss msg think that's correct
you might be wrong so it's funded its
and message without an underline okay so
then we're just going to simply send the
parts and the user to this page here
sad message dot PHP we don't wouldn't
send the sad message that PHP then we're
gonna say a question mark you equals
which is going with user name and that
was saying easily so that before you hit
send message takes us to a page called
Sam as it's a PHP u equals use cinema in
this case but you the value username is
just going to be here we send this
private message to so if I was to go to
France is his profile hmm not as friend
sad message exchange to Frances so that
way that took them am used to be script
on though which user might want to send
the private message to so that's all we
have to do on the profile page because
all
the hard works carried on this made you
so we can copy this code here from the
profile
um just paste it in because it will
still work
oops Oh crash so if I just actual
username okay so changes out
so if I click OK the problem is I just
forgot to include a header file because
because and this caused the error
because the header file has the connect
script in it ok so now we get Francis
then if I change this to my user doesn't
exist we don't get anything but we'll
only the it will only work for users who
exist in the database so we also know
we've checked it works you want to make
a check it stops users being able to
send themselves friend requests RM
private messages what it's a isn't
sending themself
yeah maybe but it's private message ok
so now we can just say if
username username is the value that's
all you hear and we don't want that to
equal cinema basically because then the
way I was trying to send myself a friend
or a private message so we can just said
doesn't equal user and user is the value
of flowers logged in so let's kiss
cinema then we can say our else echo you
cannot you can't yet come on send your
sound up message so if I change this to
cinema we get you cannot send yourself a
message but if I change it back to
Francis we should get nothing and let's
go that means it's working so on second
thought we can actually just change this
to had our location and send them back
to the profile so if I change this to
cinema we gets that back to my profile
and if we had a just get sent back to
the profile so we go back to sad message
now we get nothing because we're trying
to send a private message to someone
else so I'm gonna create a forum
form action is going to equal send mmm
actually send msg top HP u equals user
name the method it's going to be post
and we only need one input which is
going to be text area which is the one
that's going to hold a message so it's
going to have safe forty calls no
columns and ten rows a bit bigger so 50
then 12 maybe
so it's name is going to be sad message
no message body and that's it so so I
could just bring the Institute hug sighs
sand no yeah compose a message
so it's Eve and there we go
so we could also just
but in brackets the union spa they know
for definitely they're sending the
message to and we could just say so
finger fries there we go so now we just
need to create us an invertible submit
the name is going to be just a submit
and the value is going to me seven
message okay so i'm actually let's just
put a paragraph break in here
okay so there are days so i we can say
another if statement you can say if um
if is that post submit let's just say
then we can echo your message has been
sent so if I had Sam message says your
message has been sent
okay so now we know that it's a form
submit incorrectly we can create a few
variables the first one is going to be
user no it the first one is message Adi
it goes that's gonna post a message body
second one is the T and the third one is
a value called opened
nobody faulty it doesn't know the reason
for that is because we need to check
whether the person opens the message
you're not so we can tell them if they
have an unread message basically okay so
the I've created a table called private
messages don't worry it's in the
description in the source code link and
we get structure now we can see that is
six rows first one is the ID which is
autoincrement
and it's set to the primary key the next
one is user from user to the reason we
didn't create it variables for those is
because these are from is user is the
variable user which is in included in
the header file which as I've explained
those times is the value of the session
of the user session so it's that
username whoever's logged in the user to
is the variable username
is already declared so we don't need to
read the class so this is where our
messages are stored and that's it so
since that's basically all with all for
the money I mean it it will get more
complicated with displaying and deleting
them and things but and right now all
we're concerned with is actually
submitting sending a message basically
so we're gonna say great query calls and
message that's gonna call my school very
obviously and it's going to be insert
into users values and these values are
just ID but just because it's auto
increment nights at two the primary key
the next one is a user from oh but which
we said was user user to which was user
name message body and open so if we
refresh we just type in a message I I
was going we had sad message your
message has been sent
we go to private messages hmm so
something's gone wrong
yeah
I told it to insert into users yeah I
know I told it to extend the wrong
database so our tip so we'll just change
this to private messages refresh now we
can say again ha I I was dead
we had sad message you messages been
sent and as you can see now we have one
row in the table we're sad by cinema
which is correct which is so I was
logged in us um it was sent to Frances
which is correct as well the only thing
that is wrong is message body yeah okay
and that's just simple because I spelled
this wrong so we can try this again we
it's a message and I we should have two
rows and yep I'm not we have our message
so we can also add a bit of security on
the message body we could say they just
but yeah parentheses run up and say
Mike's Corral
real scamp know it yeah it's not
actually my skill restrain escape string
is just strip tags so stop people
sending him tie well stop people trying
to hacking our website basically so if I
try anything
go ahead sad message it should have
ignored yeah okay it's made the message
go blank because the message I sent was
in between two peach whoops
to PHP tag so whenever I type in between
these won't be sent but whatever I type
after it will be sent so if I am sad
message we're gonna get there we're
gonna get the bit time I sent top left
side of the tags so we can do another
check and we could say if message body
equals we can just copy this echo M
please enter a or please write and
message and then we could say else if
STR then STR line message body it's less
than three then we can echo your message
cannot be less three car
and then we'll finally just sales and
then we can send the message through so
if I just hit send message me right we
got please write a message if I type in
a message that's less than three
characters so to come I'll say one two
so send message your message cannot be
less than three characters and if I type
in the message that is three characters
long yeah I just need to put this
outside so less than three so now if we
it's and message we get please write
message and if I to card use two
characters we get there the other error
and if I use three characters which is
the correct amount so type message and I
hit sad message your message has been
sent
no it's been sad correctly so thanks for
watching this video don't forget to
comment subscribe if you liked it and
yeah see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>