<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make a Social Network from Scratch: Part 20 - Allowing Users to Add Each Other as Friends | Coder Coacher - Coaching Coders</title><meta content="How to Make a Social Network from Scratch: Part 20 - Allowing Users to Add Each Other as Friends - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make a Social Network from Scratch: Part 20 - Allowing Users to Add Each Other as Friends</b></h2><h5 class="post__date">2012-08-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/as3kciOvfVc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so hi and welcome this video so
last time we laughed off oops
with um user by user being able to
accept a request and then I would add it
to the friends array but I currently
that won't work if they have more than
one M if they have one or more friends
because at the moment we haven't told it
to add a comma to separate each item in
the array I hope that makes sense but so
am today that's all we am doing and I'll
try and keep it shorter than the last
one because 52 minutes is ridiculously
long for one video okay so um we're just
going to do simple similar things what
we did up here actually you can just
copy this and just change null to
greater than or equal to one oops so
what this means is if M changes to
actually just friend friend or account
so it means if they have more than if
they have one or more friends so greater
than or equal to one ABB's of in the
friend array if there is more than one
friend or one or more friends then we
run this ik then add friend query is
this line as opposed to this line and in
this line up here we told it to now I am
just append the user from which the user
name of whoever sent the friend request
and in this line what we're just going
to do is put a comma to start so we'll
just append and comma and then the user
add from just change these are from and
change this to user so the only thing
that's different about this query is and
the comma
start and we can just copy this one
again do the same thing we did up here
so greater than or equal to one
unjust and append comma the start of the
whoops and a comma to start and then
that should be it for the odd friend
function no functionality so I'm just
going to refer sorry
run little bit slow to this computer we
also know it we know we don't I was
going to think so we need to put a check
for whether they're already friends but
we don't need to because we're going to
get this to disappear and once they
accept it so just for it I'm just going
to log out I'm going to log in as cinema
to I'm going to send a friend request to
Francis and Francis is all it is it this
is the M row for the user Francis and I
already have one friend which is cinema
so theoretically if that code works it
will just a pad comma and then the user
name cinema to onto my friend array and
in the cinema to friend ray I'll just
set Francis okay so go to sources
profile once around slow
okay so am you just add as a friend
friend request has been sent and we go
to friend request stop here to me no hmm
okay so
just I need to fix 9:21 okay and okay I
think I'll come back when I fix this
okay so that was just a pretty simple
problem I just forgot so if they have no
friend requests we haven't to add
declared the variable user from and here
we've said dot user from is we just use
this line of code here but it doesn't
know the variable user from we need to
assign a value to it
so with the value whatever we assign to
the value of user from doesn't matter so
we could just say so we just say we can
just give it a value of nothing and
since I have no friend requests let's
see that was way so now if I log in as
Frances oops and go to the friend
requests to PHP page now it says cinema
two wants to be friends and wait just
give me a second okay so the reason
lines talk to start I stopped for
seconds because um in our friend
requirement I'll just refresh this
action so am in our friend requests
table we have three rows nine and I was
just I just thought that it wasn't
working because um I thought the France
has had two friend requests
turns out user to cinema so I sent them
all the ones to make sure and it closed
work for the agencies to so I'm just
going to go back to friend requests and
I will just add a break hmm their own
each okay so I will just add app and a
break home to the end of this maybe to
break so now we get both friend requests
hmm okay so alright I will move this
form up into the while loop because it's
only been displayed once so we want it
to be spread more than once so just put
it in here and since we are M using the
single quote thing we have to put a dot
if I'm a dot spaced on in a single quote
when we're declaring a variable so see
that this fix it huh okay so that's
fixed and we can actually skip this so
now I figure out it finally
theoretically if I click accept requests
and I go to users hopefully if we did it
right mmm okay so I'm I will fix this
and come back to it I'm sorry I made
some onion snakes okay so I'm what I
believe the problem was is me being an
idiot forgot
to remove these echo and the PHP code
blocks on the Akal thing because I
forgot that now we're actually in a PHP
block so we don't need so we can just
make sure that works and we don't waste
time we can just check okay so that
looks like it's work that I think is
going to work so if we click accept
request hopefully nine hmm Justin why is
that on organ okay so finally I think I
know what the problem was
so as you can see the code is slightly
differently and we did at least two I
store them so what I've done is I've
moved the form and for adding a friend
and accepting requests down to the
bottom and I'm going to put in two curly
brackets here to end the code up here
which is why I got rid of these so now
this means that the when this wire loop
will run everything inside of it each
time for every single row so hopefully
now this means tool work so um every
trash click except request you are now
friends it's good sign it shows it poor
and hopefully no the user Francis should
have comma unlimited to cinema to on any
friend or a yeah but just a slight
problem the user cinema to you also has
the comma so we'll just
fix this
okay so I'm sorry for making so many
mistakes but I've just worked out why
this bad code is feeling and why it was
giving us the comic start so the reason
for that was because I'm I did a check
here and it's um it says cinema Tudor
and I was looking for friend of a friend
which is the front and array of the user
the users friend and as you can see
friend of a friend equals gap friend row
friend with a friend or a but that's the
variable we specified for up here so she
said gap friend or get friend row friend
and that was such a stupid errors I
never noticed that
so if we refresh we get zero on that
means that's working so just don't do
this back to low we had it okay so um
the story had it so all we need to do is
once again exchange friend or gap friend
row to get friend row friend no I just
refresh this to make sure that it's
clear okay so what we should see now is
when we click accept friend requests
friend Google should M have it should
say Frances in here and Frances should
check out a cinema - karma Google so if
we click accept request
and it's work
no the since Google hired a friend since
the friend rare for Google equalled null
which meant it was empty and we didn't
add a comma and since the friend or a
rule for Francis I had a friend in it we
had a comma and then we out of the
friendly so now that works we just need
to add code to actually remove it from
the friend or a table because once you
add it once you accept the friend
request you want it to disappear for a
you want the these buttons to disappear
so you don't keep accepting seen
requests so that's quite simple so all
we have to say is create a variable call
it delete request an equal MySQL query
oops
delete from friend requests our user 2
equals user 2 which is their the user
that set the from the user that's
received the friend request and user
from equals user um so what this query
does is just deletes the friend request
on and since we're specifying these two
rows there can't be more than one friend
request in the table that equals the
user the variable the user sent a friend
request and who sent who to receive the
friend request basically um so it means
that he L it it sort of means that it
will only delete the friend request
that's accepted because that's your
unique friend request because there's no
friend request it's going to equal and
where the user from and the user to are
going to be the same as another friend
request like the two these two rows and
Frances and sent user farming cause
Frances and user to equal cinema and
there's can't be another friend request
in this table that equals those two rows
which is basically why we did it so I'll
just go to users and I will and just
edit these two rows and just delete the
friend request star Dex their friend
array and then we will accept it again
and no we should we will see they n
friend requests disappear from the
friend requests table so then it will
disappear here so you can't keep
accepting the same request so refresh
and we click set request says your no
friends and then you click enter it
disappears and you click enter it to see
yours we could also make a check let's
say that's so they can't just keep
clicking the button or we could just yep
that's working or we could just simply
say um header location location and then
we can just a friend request da PHP
because there that's the page their own
it's from the quests row where so now
they don't have any friend requests so
I'm just going to send a friend request
and I'll come back when I sent it
because I actually I didn't need to do
that I just logged in cinema it says I
have a friend request from Francis so
they click accept request
now I would click it it disappears and
we go to the friend array and now the
top results cinema says Francis in the
friend array and Francis's friend erases
cinema 2 comma google comma cinema so
now he is three friends and cinema has
one friend and it's all working so then
I
thing we need to do is say what if they
ignore the friend request just quite
simple so underneath here we just say if
is set host ignore and then we just say
ignore and once again a pen user from so
that it's unique so ignore every friend
request you have when you ignore one so
I always just say is we can just copy
this so basically what we're doing here
is if they ignore the request words and
everything we and we're just ignoring
we're just doing the same three things
we did in the last time request and they
um if they accepted it we're deleting it
telling them they deleted it and then
we're just going to em but the way I
take them back to the header dope our to
the friend requests pho that disappears
so we just we it doesn't matter what we
could just change this to ignore
requests and you can just say requests
ignored and that's basically it so um
I'll go to cinema and I will send a
friend request
mmm oh yeah
so I'm there's no point checking up
because I know that would work so the
next thing we need to do is go to the
profile oh wait actually let me see it's
turning who's not friends okay
I'm like so I change my mind and I'm I'm
I'm just going to prove that this work
so I'll say ignore request maybe doesn't
work let me see okay yeah it wasn't
going to work just got that good thing I
checked it so we just refresh click
ignore request now I would ignored it so
I sent him it was from cinema I think so
now if we go to cinema - yeah we don't
have any more friend requests and don't
worry about that that was just a problem
whenever I was testing and I must have
just forgot to delete one of the friends
doesn't matter so what we're going to do
now is we're going to go to the profiles
and we're going to make a check to so
that someone can't keep standing friend
requests the people if there are any
friends so that's pretty simple all we
do is so we go to the profile code
obviously just delete that so I'm we go
to the profile page code and
looking for you so I'm okay we can just
create another PHP block here um-hmm
okay that's not what we want to do
that's what we're going to do in the
next video
so am okay what we got what we're going
to do is we're going to go down oops
we're going to go down here
I'm create a new PHP block and what
we're going to stay we're going to
declare some variables first so friend
array for friends Laura
count friends and friends array I know
it's weird but I'm calling her friends
right well because that's how many
friends will show on the profile so and
what we're going to do next is create a
query called select friends query let's
go in to equal my MySQL query select
friend array for all my users where
username equals username which is that
as I keep saying this a value here so
now we've got the friend array we need
to UM get the front row so you can
create a variable called friend row
which equals - well match
okay so um oops
I love it I just copy this actually um
the next thing we need to do is just
create a variable called friend array
which equals friend row which is the
variable we made up here friend row a
friend array so now we've got the friend
array now that what we're going to say
is just something simple if statement so
if friend array equals nothing so if
it's empty and they have no friends yet
we can just say oh wait no what's wrong
we say F friend aware isn't empty now
we're going to create a set a variable
friend array equals explode so we're
just a rename or just given tree and the
volume of this is current of the value
of the variable friend array is
currently am the rule from the database
and now we're changing the value of the
variable friend or a2 and the exploded
version of a row which is because it's
an array so we're using the explode
function to separate it with commas into
a different and for example if they have
four friends and there's um they're all
separate by commas in one big long or
read will string what we're doing is
letting that string in the commas and
we're just taking h1 and sort of making
it its own string kind of so we can use
it individually so the explode function
takes two parameters the first one being
a comma and the next one is what the
array you want to actually explode
so that's in our case friend all right
and and now we just want to count the
number of things in the array so you
want to count how many things are left
after it's been exploded so that will be
if there's four friends there'll be four
things laughs so then we just create a
variable called friend all right well we
don't create it we've already created up
or just a sign a proper value this time
and we're using the array slice function
so we're going to slice it into twelve
parts basically so even if there's four
friends it won't slice the four words
into twelve parts but if there's a
twelve friends and they're all it's
separated by commas it will take all
those twelve friends and basically make
them their own
sort of string I don't that's not
exactly not what does but and that's
just sort of a way of thinking of what
so the rest slice function takes our
method or whatever takes em two or three
parameters first one being the exploded
array you want to actually as slice the
next one being add then they M where you
want to start slicing which is in our
case zero because we want to start on
the very first friend and we want to
slice all the way up to the twelfth
friend so now it's or not we just quite
as if slimmer and we can just say we can
create a variable called I which equals
zero and basically we'll create another
F steamer and we can say it f in array
which is another function so if an array
a equals user which is the variable of
whoever's logged in so if I'm logged in
as a cinema to the variable user equals
cinema to
Alma friend array so it's just checking
if oh wait no the variable user for some
reason M seems to change down it is the
variable user is at the name of the for
example whatever call this is hard to
explain so if they have four friends in
the array
they'll be for variable or the user
variable will equal each of those
friends in the array so the user
variable the first time will say if
there was if the first friend in the
array was a cinema to Java see it isn't
because I'm not going to soon - then the
variable user would equal cinema - then
the next friend the next friend it would
also it would equal Google and so on and
so forth until I got to 12 so a and we
just say add as whoops as friend equals
and then we're just going to and create
the submit button and oops my dude input
type equals submit name and this is
going to be removed from because if
there are M if the name of the friend
already exists in the parameter by we
don't want to be able to add it again so
it's kind of a complicated way of doing
it which is why this video these videos
talk a while come on because I was
having trouble getting to work correctly
and I'm going to say else so if they are
not already friends basically then we
just do the same thing as above except
we'll change the button status friend
and we allow actually add them as a
friend so we just say add friend like
the bottom we used earlier and we say
odd
as friend then underneath we just echo
the variable add as friend and since
we've done now we can get rid of this
here let's import and now since I'm
logins myself it won't chicken ok so
yeah ok I think that's because I'm
logged in as myself so let me just okay
we can fix that in a second sir wait
yeah you'll always be logged in as
yourself so to fix that let me see
no wait it wasn't that because I use the
wrong variable so we just change that to
your oops change that the actual
variable friend array we used and it end
hmm so we just also am say add and Dada
add as friend just give it a blank value
mmm 112 for salt
I'm making so many typos yeah so I click
enter
finally it's fixed so since you're
logged in as yourself and let you add
yourself as a friend but if I was to go
to someone else's profile since I'm
friends since the user Francis is
friends with cinema as you can see it's
in the air friend array then it just
says remove his friend or remove friend
but if I logged in as Google
and I went to cinemas profile which I
don't the friends
now it says out as friend so click that
and it works so that's this that's it
for this tutorial because I wanted to go
too long so next time what we'll be
doing is on the users profile we will be
actually showing the friends like
profile images here and maybe if we have
time and allowing them to remove friends
so we don't forget to comment and
subscribe thanks for</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>