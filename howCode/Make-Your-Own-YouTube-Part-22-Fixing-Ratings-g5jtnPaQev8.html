<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make Your Own YouTube Part 22 : Fixing Ratings | Coder Coacher - Coaching Coders</title><meta content="Make Your Own YouTube Part 22 : Fixing Ratings - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make Your Own YouTube Part 22 : Fixing Ratings</b></h2><h5 class="post__date">2013-07-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/g5jtnPaQev8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm welcome to this video so today
we're going to be doing is we're going
to be finishing off the rating system on
the videos so as you can see here we can
click like over and over and over again
on a video and it will let us like a
video more than once and what we want is
we want to actually only make it so you
can really liked the video once and or
dislike it once we want I also a lot of
people to be able to change their mind
so what we're going to do is we're going
to set it so that when you click like
and the like button becomes inactive and
the dislike button stairs active so that
you can change your mind and decide
which one you want to do so that's we're
going to be doing this video so let's
get started so we're back in our video
watch page file what we're going to do
is we're going to scroll down to the
code where we display the like button on
the dislike button I'm just going to
show you what it looks like whenever we
set one of them to disable so that we
can't use it so if I just have been
disabled and just like this with their
no value or I mean no equals and no
quotes or anything after it I just type
in that word and I put it at the end of
the input type and I click back over the
web page and refresh what you'll see is
neither like button is disabled and I
can't click on it so whenever I try to
click on it nothing happens so but the
ad dislike button still works so that's
what we're going to do in this video
we're going to set it so that whenever
each whichever one of these you click
becomes disabled so you can't click it
again and on the same video so to do
this what we need to do is we first need
to well we actually need to go into our
ratings table what we want to do is we
actually want to empty it and by
emptying it what to do what this does is
I'm it I just get rid of everything in
the table so this way wouldn't meet what
happens is we start with no likes on
this video and 0 dislikes because at the
moment we have a load of likes and a
load of dislikes and if that'll just
mass of our code if we don't correct it
first so we want
do is we want to click OK edited trunk
it the ratings table which basically
just means delete so whenever we've
deleted that if we come back here and
refresh what will happen is the the what
the array nice car should actually
disappear because there's a no ratings
to display ok so I just had a refresh
again because the table didn't add
delete quick enough but there it's gone
now so what happens now is if we click
on like once what this will do is it
just likes it obviously so we'll get up
on our green bar here that is one
hundred percent green and there's no red
in it if we scroll down as you can see
we have a full green bar night so what
want to do now is we want to set the
like button to disabled if the if the
person is like the video so here I am in
the ratings table and as you can see we
have one rating and it's bag contains
the video ID the type of the rating
which is in this case like and the user
who liked it so what we want to do is we
want to query this table we want to
check did the person liked the video so
what we're going to do now is we're
going actually going to do that we want
to check this wherever the page loads
not whenever a button is pressed so what
we're going to do is we're just going to
come up here and we're going to go above
this just here in the PHP block and what
we're going to do is we're going to just
query the database and see if the person
is like the video so just put a comment
in to check if the person is like the
video so so I'm just going to put a
comment in here and I'm just going to
say um check if you if already like /
dislike I what I'm going to do is I'm
just going to say a check underscore so
I need some of the check underscore l
equals MySQL query
I'm what I'm going to say is I'm just
going to say select whoops i'm going to
say select type from whoops from ratings
we're video underscore ID equals the
variable video ID oh we got this
variable just because it's the gat
variable at the top of this file as you
can see here so what we want to do is we
just want to check if it's the video ID
for that video and what we want to also
check is on a user let's just have a
look at the row in the database for the
new ratings ok so the Rope for the
username like the row name for whoever
ok this here row name is username and
this means that if we check this for the
ward Francis which is which we are
checking because I've logged in as
Francis so we check it against my
username so if we check against that and
we check against the video ID as well we
were able to check whether I've actually
liked the video or not so we wanted to
do is I'm just going to say well use I
actually have to say username as well as
video ID and I just say a username
equals user so I user username and what
I want to do now is I just want to hit
enter once just to make any line I'm
just going to say if MySQL num rows
check underscore L doesn't equal zero so
if there if the video has actually got
is if the video has been liked by me or
disliked by me so if I just left a
rating of any sort then we want to check
what the rating was or else we just want
to say taco and nothing so I of the
video hasn't been liked by me we want to
do nothing because we just want the
other code to show up and run but if the
video has been rated by me we just want
to say a while row all right let's just
say I really raining equals mysql fetch
associative all right and then we just
want to say check underscore l and this
just lets us select all the fields from
the table what we actually want to do is
we want to change this to all because
I'm get all the fields so what we're
going to do is we're going to get the
video ID so video ID underscore l and
equals reading video ID and what this is
doing is it's just I'm actually check ok
there's no wonder scored the value ID so
we need to change that so what this is
just doing is it's getting the value
from the database of the video ID so in
our case it's just pulling this
information here from the database so
what we want to do next is we want to
say reading let's actually we got use
that variable I'll just a rating
underscore l equals raining at type
let's actually change that to type and
then user underscore I'll equals reading
user
so now that we've got that we want to do
is we just want to echo type with which
our case we'll just act with the word
like out onto the page so if we come
over back to our video watch page and we
click refresh okay so as you can see
here we have a undefined variable so
that's okay all we need to do is come
back into our code and change this to
the variable user and then let's try it
again and as you can see now we are
correctly pulling the the row out of the
database and we got the word like if I
was like just like now as well we'd
actually get like and then just like
printed beside or I could beside it but
to make sure we don't mess up the code
and have to delete the table again rme
now to the table again I'm not going to
click either button for an eye so one
we've done that now that we've got the
type what we also want to do is we want
to set the video or the buttons so that
they are disabled so what we're going to
do is we're just going to come in here
and its really simple all we have to do
is create a variable we're just we're
just going to act with a variable and
we're going to call the variable day and
we're just going to copy it again and
p.s sit down here and what this variable
is is it's going to be equal to nothing
unless the the event your husband liked
already I mean yeah if the video hasn't
been rated then it's going to be equal
to nothing's that way and the buttons
won't be disabled but if it has and if
the video has been rated and the correct
button will be and sad to disabled and
we actually need to do is write D and
then d too because we need the two
variables to be separate and different
from each other so we want to stay up
here instead of akwa not or a co nothing
what we want to do is we just want to
say d equals and whoops nothing on d 2
equals
nothing so what this will do is it just
sets the variables equal to nothing so
that our code will run just like it
should so if we refresh again nothing's
going to happen it's just going to so
it's just going to get rid of the like
up here and for some reason we have an
undefined variable okay the reason we
have the undefined variable is because
we're not actually running this block
because the reigning actually does exist
i have created a reading so we're going
to run this block but if i hadn't
created a rating it would run this block
and that's and this is what the block
the variables are defined in so if i
wanted to i get rid of this error all i
have to do is copy and paste this up
here and this way it would since it's
running this first block here this first
block in the if statement then the
variables get and defined up here
because they weren't actually defined
because they were to find in a block
that wasn't being executed so as you can
see now the hours go on so what we want
to do is we just want to say we want to
get the actual type of the video so
since we have actually a selected the
type from the database we want to just
do a check of which time it is so if I
was to say if and whoops type is equal
to like then we're going to set a day
equal to a disabled and i'll just say
else the only other option is if it's
des like so or else we're just going to
set d22 disabled and to prevent errors
were actually going to come back up here
and copy paste these two variables just
to define them so that we don't get any
on defined variable errors so let's try
that now what should happen is the like
button should get disabled and as you
can see now the like button is disabled
so we can own it we can't like the video
again but if we just like it now it's
just going to create another dislike and
so if I click this it's just going
sepa with buttons tonight B and disabled
okay so actually it works the way want
it to but I can like it again but as you
can see it didn't remove my previous
like so what we want to do is we want to
set it to that whenever you click Submit
on the like button so what we want to do
is we want to set it so that if you
click if you click on either one of
these buttons when you've already
collect on wanted AG actually set just
updates your previous reading instead of
actually adding a new one so
unfortunately we've run out of time in
this video so we'll have to do that in
the next video so thanks for watching
don't forget to Like comment rate and
subscribe and I'll see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>