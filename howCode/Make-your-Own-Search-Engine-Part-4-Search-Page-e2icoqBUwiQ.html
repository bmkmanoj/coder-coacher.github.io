<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own Search Engine - Part 4 - Search Page | Coder Coacher - Coaching Coders</title><meta content="Make your Own Search Engine - Part 4 - Search Page - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own Search Engine - Part 4 - Search Page</b></h2><h5 class="post__date">2016-08-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/e2icoqBUwiQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in the last part of this series we
left off being able to insert rows into
our database and in this part what we're
going to be doing is updating existing
rows so this way if our crawler sees a
website it's already crawled it's not
going to insert a second row for it it's
just going to update the row it already
has so the way we do that is we first
off just copy this because this is an
insert statement we can just pass it up
here and we can change this to an update
statement so the only thing we need to
change is this insert here and we're
going to change it to an update so the
way we do that is we say update index
set and then here we just delete that
and say title is equal to our title that
we get from our array our description is
equal to our description from the array
our keywords are equal to our keywords
from the array or you are out on our URL
hash
we shouldn't actually update because
they are now we're going to change but
if we don't update them and then
essentially keep them the same we're
going to get an error because the number
of parameters in our query won't match
up with the number of parameters in our
array so we simply just say your L is
equal to URL and URL hash is equal to
your hash so this updates them but it
sets them to the same value they're
already have and just prevents us
getting an error the next thing we need
to do is delete this we need to say were
URL underscore hash is equal to URL if
we didn't have this word clause in here
what it would do is every time it when
it sees Google it's gonna update the
entire index and change every title at
Google every URL to Google and every URL
hash to this half here so let's just run
this and if we run this now the first
thing I'll do is run it on an empty
table so we'll just empty this out I
will run this
and we'll stop that so we should have
enough websites in it no let's just
refresh you see we have 10 rows and our
database so the first time this rom
there was no rows in the database so
every single query it round was this
insert the next time what it's going to
do is update it because we're updating
it with the same information as and none
of these websites have changed in the
last 30 seconds we're gonna get the same
thing again but what we're not going to
get is occidental rows inserted so if we
just run this again we're gonna let it
run on a bit longer than asked times we
have a couple more rows so we can see
some more inserts so that's enough and
we'll stop that I'm gonna click browse
so now we have 22 rows in our database
and you can see they're all different
roads
there's no duplicates or anything like
that and we look up here there's no
duplicates up here either but you can
see there's a slight problem here our
URL has been changed to our URL
underscore hash so what we need to do is
just check out why that's happening so
the reason that happened is because you
can see we have two updates here for URL
we have one setting URL equal to URL and
we've another one setting your equal to
URL underscore hash so we just need to
change that to you i underscore hash and
if we run this game you can see last I'm
not shows that our query actually worked
it was updating our websites so what
we're gonna do is just run it again
that's like browse again that refresh
the page and as you can see the URLs
have been fixed they've been updated to
their correct URLs so now we've actually
inserted the rows into the database it's
time to retrieve them using our search
engine so if I just go down here you can
see this is the folder that holds our
entire project our index page at the
moment is our crawler on our starts page
it's going to be our results page we
don't need pages dot JSON anymore and we
don't need tests on HTML anymore so now
what I'm gonna do is I'm just gonna copy
indexed up PHP and I'm gonna rename it
to crawler some PHP an index dot PHP is
going to be the index page of our search
engine it's going to be our landing page
so if we go back to our tax data you can
see we have nine three files
crawler is identical to index dot PHP it
just
better to call it crawler I know we can
change index dot PHP and make it look
more like our search engine so I'm just
going to call it hi start I'm just going
to do a really simple layout it's going
to be a Hatter I am at a tax box and a
search button
you
so those are a very basic homepage for
our search engine please submit this
form what it will do is we'll go to such
that PHP so if I say my code you can see
it goes to setup PHP so we're just going
to change our method to get we will run
this again type in haiku something that
I know you can see which passed Heiko to
our search that PHP page and now you
start our PHP can query the database
based on and whatever we sanded so
finally on the search new page PP is
what we're gonna do is connect to our
database so to do that once again we're
gonna use P do which is PHP data object
and we're gonna say PDO is equal to new
PDO we have three parameters first one
is MySQL : we set host equals 127.0.0.1
and then we say a DB name equals hi
search username is root and password we
don't have at the moment so let's just
refresh the page and we get no errors so
that means that our connection has
succeeded
so now what we're gonna say is search is
equal to the value that we sand it from
our form so we're gonna say get Q
because if you look here you can see we
have Q equals hi code and we want to get
the value our code so what I'm going to
do is I'm going to say it results equals
PDO query select all from index then I'm
gonna say a print underscore R results
fetch all so let's run this again and
you can see we got everything printed
out of the database so if I just I'll
pre tag up here you can see what has
been returned is every website in our
database and if we scroll to the bottom
you can see there's 31 items and in our
database if we click browse
32 here there's actually 32 items here
because this is a PHP array that is
starting from 0 so there's 32 items so
that's it for this video don't forget to
Like comment favorite and subscribe and
the next video what we're doing is
completing the search engine hopefully
and we'll be allowing the user to use
add keywords and things like that
because at the moment it's just
returning every result from the database
so thanks for watching and I'll see you
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>