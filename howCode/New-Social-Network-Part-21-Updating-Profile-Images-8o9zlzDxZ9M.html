<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 21 - Updating Profile Images | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 21 - Updating Profile Images - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 21 - Updating Profile Images</b></h2><h5 class="post__date">2017-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8o9zlzDxZ9M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're gonna be
finishing off uploading a profile image
so let's get started so the first thing
we need to do is create a new item in
our database to be able to store these
new profile images so we're going to go
to the users table and of course profile
images are associated with a user so
we're going to go to the structure up
top and we're going to add a new field
to store the users profile image and
we're gonna save our char I will set it
to 255 image your URLs are usually quite
short so we should never actually reach
this 255 character limit and we are
going to like that to be null because
the user might not have a profile image
in which case we can provide them with a
default so now we've added a new column
to our table we need to update our
register script to take account of this
new row so if we go to create account
when we insert into users we also want
to insert an empty row for our profile
image so as tasks that that still works
if I click create a current it's a
success and we check the database now we
have a new user and they don't have a
profile image by default so our register
script still works as expected so one of
my account page we also want to add a
check to make sure the user is logged in
so we'll go to my account and here what
we want to do is check if the users
logged in and we've already done that on
the index page so up here we're just
gonna paste our login check and we can
get rid of the post class the comment
class and the timeline variables so here
we're just gonna check if they're logged
in otherwise we'll say I'm not logged in
instead of saying echo we'll just said
died not logged in because if we die it
kills the page so none of the other code
will get run so now that we've checked
if the users logged in we're going to
check the size of the image that gets
uploaded so we're gonna say if files
profile image size is greater than a
certain number and the number we want to
check is 10 megabytes so we could say if
the size the image is greater than this
number which is 10 megabytes I think
dammit I said I image too big must be
something like that and we could check
the type of the image but we're just
going to leave that for now we're gonna
let people upload animated images if
they really want to and what we want to
do after we know the image is valid
which is down here is we want to insert
it into the database and we get that
from the response so if we print our
response and if we actually above that
echo pre tags and then we just close
those pre tags off and that it's much
easier to see the data so if we run this
now we can see we have on a rare cold
data and within that we'll have all
these different items we have ID we have
title but what we want is way at the
back and it is the length to the image
and the response that we get returned is
a string of JSON so what we need to do
is say response equals JSON decode to
decode it into a PHP array and we'll
decode the response and we'll store the
response in itself and what we'll
actually do is copy that and paste it
below so we can see what the array
actually looks like we'll upload that
again and we'll see the array now so you
can see here these aren't just stun and
arrays they're objects so to access an
item within an object what we want to do
is use PHP special arrow operator so in
order to get the length which is down
here at the very last one we can't just
say response an end data and then for
example link that won't work what we
want to do is we say echo response and
we'll use PHP arrow operator to go into
data and then we'll use the outer
operator again to go into the link
property of that data property or within
the response so if we run that what
we'll get is just the length printed out
so if we run this one more time
you can see we got the link printed
right below and that's the link we want
to store in the database so what we want
to do now is insert that into the
database what we want to do is run a
query so we'll say a DB query update
users' sat profile image equal to
profile image where I'd a equals user ID
and then here we just want to pass in
these variables so we create an array
the first one's gonna be the profile
image to a profile image it's gonna be
response data link and the user ID is
going to be equal to user ID which is
what we got when we checked if the user
was logged in so that should be
everything we need to do to update the
user's profile picture so we'll run it
one more time
and before we run it we go to sequel pro
we refresh you can see there's no
profile images
we click upload image everything worked
we go to Sigma Pro again and we refresh
and there's our profile image it's been
uploaded so that's it for this video
don't forget to Like comment favorite
and subscribe don't forget to follow us
on Facebook Twitter and reddit I'll see
you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>