<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 48 - Sending Messages with Javascript | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 48 - Sending Messages with Javascript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 48 - Sending Messages with Javascript</b></h2><h5 class="post__date">2017-07-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Kr8v_9s43jI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
learning how to send messages using
JavaScript because you can see at the
moment we're able to retrieve messages
that we've received on matches that
we've said at the moment anything we
type into this box and clicks and will
do nothing it will to actually send a
message so let's fix that in this video
so the first thing we have to do is
create an API endpoint that will receive
our edge ax request whenever we click
send
so our Ajax request is going to be a
post request so we're going to scroll
down and here's what we're getting the
post message and what we're gonna do is
just copy this
like this and we're going to change the
end point from users to message so we
send a post request to FBI / message
we're going to send a message so of
course we want to get the post body and
we want to get the fails in the post so
we'll paste this in here and we want to
have a body failed
and we'll have a receiver field
we'll just print underscore our host
body to see what it looks like through
barcode messages that HTML what we want
to do is we want to get the sand button
and here it is here and what we want to
do is give it an ID of sand message and
we're going to scroll down and after we
run document already what we're going to
do is we're going to add an on click
event so we're going to target send
message
so we click send message you want to
send a post request so I went to our
login page and copied the post request
and we're going to use that as a
template so when we get an error we're
going to run a function and when we get
a success we're going to log it to the
console and we're going to target API
slash message and the data we're going
to send it's going to be the message
body which is going to come from our
text box which you can see is right here
so we're just going to give this an ID
of message content will say or message
body doesn't really matter and then here
we're just going to say a message
content and then we're going to get the
receiver and it's going to be equal to
our global variable which if we scroll
up you can see our global variables
sander and sander is probably a
misleading name but sander is going to
be equal to the person who were sending
the message to and the receiver is going
to be sander it's the receiver from the
perspective of us sending a message but
from the perspective of us receiving a
message it's the sander so if I save
that and I click send you can see we got
a response if I put some information in
here we sand it again we get our
response the receiver is still seven and
the body is whatever I put in this so
that's working and what we want to do is
go back to the API and we can do some
simple validation we're going to check
the length of the message we're gonna
say if STR land of body is greater than
say at 100
we'll just echo some JSON was there
error message too long otherwise we're
going to insert that into the database
so we're going to say DB query
which has a body a sender receiver a
flag that does is if it was rat or not
so we have the ID now we have the body
and the sender then the receiver and
then one of the zero for the last one
because by default all Matthews will be
on red
so sander is going to be the ID of
whoever's logged in so we leave that as
a string for the moment and our receiver
is what we're going to get from the post
body so the receiver is just going to be
equal to the receiver variable and the
sender is going to be equal to user ID
and user ID we're going to get just like
we always do we get a login token and
then we use the login token to retrieve
the user ID so after all that we're just
going to echo success message sent and
just make sure we spout this properly
and we also don't want to forget the
body which is just going to be the party
we got from up here so now if I just
type in something I try to send a
message you can see it's a success
message sent in the database now you can
see we have a new message the receiver
is seven and the sender is one and now
if i refresh now we have a new message
that was sent by me so now we're able to
send messages and were able to receive
them so before we go we're just going to
cheat we're going to go to our masters
page and a non success instead of
logging in our we're just going to say
when note location equals an empty
string which will refresh our page to
have a refresh and I try to send a
message us a message two clicks and you
can see the page refreshed at the master
showed up so that's it for this video
don't forget to Like comment favorite
subscribe to free to follow us on
Facebook Twitter and reddit in the next
video we're going to be making this left
side menu work so that we can choose who
to send messages to so that's it for
this video and I'll see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>