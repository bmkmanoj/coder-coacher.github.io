<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own Instant Messenger - Part 7 - Update() | Coder Coacher - Coaching Coders</title><meta content="Make your Own Instant Messenger - Part 7 - Update() - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own Instant Messenger - Part 7 - Update()</b></h2><h5 class="post__date">2015-07-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6Z_Cxdpzsj0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so now what we're gonna do is gonna work
on the update function so the update
function is an AJAX function again so
we're just gonna save our XML HTTP is
equal to new xml httprequest so the rate
you're probably wondering you know why
can we use ACTA my needs to be up here
and the card is a variable and use the
same variable down here the reason for
that is the scope because since we
declared the variable in the function
its scope is limited to within that
function only so that means that these
this variable up here has no idea that
this variable here exists there are
actually two separate variables even
though they have the same name it's
because there are two different
functions so we want to get the username
again for save our username is equal to
cat cookie a messenger Union then we
write credit app a variable called
output which is gonna hold the output of
all the messages I want to send equal to
nothing because it's it's gonna be
padded to whenever we get the data back
from the file and then we're going to
run this function again so we'll just
copy it instead of pasting it instead of
doing it making it again let's just
delete this I'm down here we're going to
run this again we're just going to run
it onto the page so we'll just copy and
paste it down here so instead of update
messages that PHP we're going to run it
on get messages page P and we're going
to pass it one parameter of username
it's going to be equal to username
variable so we're gonna put a variable
called response and we're gonna set it
equal to a response whoops it's actually
an XML HTTP got response text adopt
split and we're going to split firstly
on the new lines which means we'll spit
and we'll get individual messages so
we're getting array of our messages then
we're going to click or create a new
variable called RL which can be short
for response length and it's gonna be
equal to response link which the
response at length is equal to the
number of masses we retrieved from the
database
then we'll create another variable
called item is coming empty string and
we're going to loop through the response
we're gonna save R equals 0 while I is
less than R L and we're going to say I
plus plus then what we're going to say
is if item 1 actually can't do that yeah
so then we're going to say is item is
equal to response dot split and this
time we're going to split on the back
slash so this way what the way it works
is the response is an array that holds
all of our messages and our user names
so if we go back to this page you can
see this would be an item in response
this will be another item in response
and what we're doing here in item is
we're splitting on the back slash so
therefore item 0 is the username on item
1 is the message so because we know that
we can say if item 1 doesn't equal
undefined the only way item 1 would
equal undefined is if some way a blank
message managed to get into the database
or whatever some living that so that's
why this would probably never be needed
but we just did it as an extra safeguard
then we're saying here is if item 0
is equal to username so if item 0 is
equal to user me and that means the
message was sent by the user who is
logged in which means we want to display
the message as for example let's just
put us in that's just a hello world
again if the message was sent by the
user we want it to be blue and then if
it wasn't and we wanted to be grass so
that's why we have this and we're gonna
put another else here so that way it's
this a the blue message is pulled over
here and the gray ones a go here
so this is where the output variable
comes in we're gonna set output plus
equals I'm going to append on the
message then here we're a salvage for
the colossus equals I'm gonna pan on the
gray message so well here we pan the
blue one here we append the gray one so
we're gonna do is I'm just gonna paste
this in from the source code because
it's exactly the same as done here it's
mostly styling and so it makes no sense
just to explain the tablet so here we
pasted it in so the only thing we've
changed from this one to this one is you
can see here it says message and
username that's because we're using the
local variables that we're getting from
the actual script we're not retrieving
them from anywhere but here what we're
doing is we're saying item 1 which is
going to be equal to our message and
then item 0 down here which can be equal
to the username of the person who sent
the message but the reason this is
different is because item 1 and item 0
are both pieces of data that have been
retrieved from the database so therefore
there we have our I plot it has been
appended but now we have to actually
update the I put on the screen so the
way we do that is we are going to go
down here I'm going to say msg area dot
inner HTML is equal to ID pop then we
rinse the msg area dot scroll top
msg area dot screw height
and this means that but first what we're
doing is we're setting the I were going
here and were filling it up with all the
messages then if there's any scrolling
and they a scroll bar it's going to
automatically push the scroll bar to the
bottom so that you have to scroll the
singing messages so we're going to
upload this and what we should get is
unloaded leave messages returned so if
we run this we actually don't get
anything because we haven't run the
update function yet so we're going to
inspect element okay so response that
split is not a function okay we have an
error so the reason we have the error is
because it's not response not split its
response I dot split because we're
splitting the item or we're spending a
specific item from the response array
we're not splitting the whole array
so we'll run this and there we go we got
all the blue messages printed out
because they've all been sent by me so
what I'm going to do is I'm going to
just go to the database and I'm going to
change this one so let's say it was
standby code and
change this one said
that my uncle as well
so let's just really refresh you'll see
we'll get gray message here another
grand one here because they were sent by
hard-code instead of me so that's it for
this video don't forget to Like comment
favorite and subscribe we have one more
part left and that part will be doing
the updating and the retrieving new
messages automatically from the database
so that's it for this video don't forget
to Like comment favorite and subscribe
and I'll see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>