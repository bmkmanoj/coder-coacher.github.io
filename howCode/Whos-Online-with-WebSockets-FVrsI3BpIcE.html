<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Who's Online with WebSockets | Coder Coacher - Coaching Coders</title><meta content="Who's Online with WebSockets - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Who's Online with WebSockets</b></h2><h5 class="post__date">2017-03-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FVrsI3BpIcE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're gonna be learning
how to tell how many users are on our
website at any one time using sockets
this is extremely easy and it might
sound wasteful for a use of a socket to
just tell why the users online but
because we're creating the socket and
it's there for the entire duration of
the users that visit on the website we
can send the user any sort of data we
want all we have to do is make sure our
page can accommodate that so let's get
started so we're going to come into our
server and here we have our connection
we want to also create an event listener
for on disconnect so for disconnection
we'll run a function with some data and
then whenever the user disconnects we
want to decrease the count by one and if
we scroll up you can see there is our
current it's equal to zero and when the
user connects we want to increase
current by one as well so we want to
increase can't be one one to connect and
decrease count by one when they
disconnect and whatever the user it
connects we're gonna send some data to
every single user who's connected
because we want to tell every user how
many people are online so to do that
we're gonna use a broadcast which is a
part of socket dot IO
so we're going to say IO dot sockets
emit and here we're going to say a
broadcast because that's what we want to
send out once that in a broadcast with
some data and the data we want to send
is current people online so therefore
it's gonna say one person online two
people on line three people online
whatever someone goes online but
whenever they disconnect we want to also
send another broadcast
kind people online as well so now we're
gonna save that and we're going to go to
our index page and here when we create
our socket what we're gonna do is we're
gonna say a socket on and here we're
gonna say broadcast and then we're gonna
run a function and we need to get the
data from the broadcast we passed that
in as a parameter and here we want to
say document.body
innerhtml is equal to theta now if we
run our server you can see it says one
people online because we're not worried
about whether it says person or people
but as you can see it also increased to
two because I have two tabs open and
this second tab connected so if i
refresh now there's three people online
if I close a tab and the reason that
didn't quite work is just because it's
not disconnection its disconnect just
change that so the reason the disconnect
didn't work is because the disconnect
event isn't fired by the library itself
it's fired by each individual socket so
if I copy this what we essentially have
to do is just take it out of there when
we have our connection this data is how
we refer to a socket so I could actually
change that to socket to make it easier
to understand and then what we can do
here is paste in our disconnect inside
of our connection so now the disconnect
is associated with each socket so
instead of saying iota on disconnect
we're gonna say socket dot on disconnect
so now if I run that again and i refresh
we have one people on line now we have
two people on line if I close that tab
and now it goes down back to one person
on line and you can open as many times
as you want and because we're
broadcasting every tab will get updated
so when I close one tab all the other
tabs get updated and receive that
information now we can tell how many
people are on our website at any one
time that's it for this really simple
video teaching you how to check how many
people are online on your website at any
one time so that's it for this video
don't forget to Like comment favorite
and subscribe don't forget to follow us
on Facebook Twitter and reddit and I'll
see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>