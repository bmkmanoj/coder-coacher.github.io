<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Simple Server in Python | Coder Coacher - Coaching Coders</title><meta content="Simple Server in Python - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Simple Server in Python</b></h2><h5 class="post__date">2017-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DIPZoZheMTo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
learning how to create our own simple
server in Python so our server is going
to be really simple it's just going to
take whatever we sand it and it's going
to send it back to us after we create
this simple server we're going to create
a chat server and then after that we
might even create a peer-to-peer version
of the chat server where there's no
central server and every peer connects
to each other and can send messages
without there having to be a central
server so let's get started so the first
thing we have to do is we need to create
a file so I'm going to call it chat pay
and I'm going to import the socket
library when we want to communicate over
a network we have to use what are called
sockets so in Python to create a socket
we import the socket library then we
create a variable I'm going to call it
sock and we set it equal to socket
socket because we're accessing the
socket library and the socket method
within that and then we pass the socket
method two parameters to assess socket
AF underscore ina and socket saw
underscore stream the first parameter
just tells the socket that it's going to
send the information using IP version 4
as opposed to IP version 6 and sock
stream just means that we have a TCP
connection if we wanted a UDP connection
we would say sock underscore D gram but
we're going to set sock underscore
stream because we're creating a TCP
connection next what we want to do is
want to bind our socket to an address on
the port so we said sock bind and we
pass a Python double which is just two
more parentheses and then the first
parameter in the parentheses is the
address any second parameter is port so
the port is going to be port 10,000
that's just the port I chose to run it
on and then the IP address is going to
be 0.02 0 that's 0 because it'll make
our server available over any IP address
that's configured on the server after we
bind to the port and the address we want
to listen so we say a sock lesson and we
pass in a variable of the number of
pending connections you want to allow so
I'm just going to say 1 and then what we
can do is we can create a loop to
actually handle the connections so we
create a variable called C another
variable called
a and we set it equal to socket except
and this just means we accept the
connection this function returns the
connection which we called C in the
client address which we'll call a a nope
here we can create a variable called
connections and we can set it equal to
an empty list whenever we get a new
connection we can set connections dot
append and we can append C which is our
connection and we can then print
connections so if I was to run this now
it would actually work but it wouldn't
perform very well because if multiple
people try to connect at once the server
would only be able to handle one of them
at a time so to fix that we're going to
use threads so what a computer a thread
is just something that's managed by the
operating system that allows us to do
multiple things at once within our
program so to use threads in Python we
have to import to the threading library
and then every time we create a
connection after we accept the
connection we're going to create a new
thread so we're going to call our thread
see thread for connections red and it's
going to be equal to threading dot
thread because we're accessing the
threading library and the thread method
within that and we have to pass this
method the name of the function that was
going to run when we run our thread so
to do that we say target equals on the
name of our function which in this case
is going to be handler which is going to
be the name of the function that handles
our connections after that what we do is
we say C thread dot demon equals true by
setting this parameter to true it just
means that the program will be able to
exit regardless of if there's any thread
still running because normally when you
want to close a program if you have any
threads that are still open the
operating system will let you close the
program until all the threads are done
by setting this property to true we're
able to close our program regardless of
any threads that are still running then
we can set C thread dot start and that
will start our thread and then up here
what we want to do is define the
function handler and it's going to
accept a variable called C as a
parameter we just want to come in here
and say args equals and we create a
topple and we say args equals c air
because we want to pass the connection
and the address to our handler and then
what we'll do is we'll actually come up
here and we'll accept the address as
well so what we're going to do when we
handle a connection is we're going to
receive data from that connection so to
handle the connection we're going to
create a loop that will run in the
background because it's running in a
different thread I will say wild truth
data is equal to CR e cv C is our
connection and we're saying we're
receiving data on the connect from the
connection and we're going to say the
max amount of data we can receive is
1,024 bytes next we're going to do is
we're going to have a way to break out
of our loops we're going to say if not
data brick on this receive function is
what's called a blocking function which
means the loop won't run until we
actually receive some data so after we
receive some data we can send it back to
the user and we're going to send it back
to every user who's connected so to do
that what we're going to do is therefore
connection in
connections because you'll remember we
store the connections in this list we're
going to say connection dots and and
we're going to stand back the data we
can always sound raw baits so we have to
say ass and baits and then pass data
into that function to convert the data
from string to baits and if we're gonna
break out of this loop that means we're
done with the connection so we're just
going to say see dark clothes before we
do that we're going to say connections
dot remove C and we'll just create a
global variable called connections
that'll give us access to this list so
if I save this and I run that I set
Python 3 chat to pay now you can see our
server is running so now on another
server what I'm going to do is I'm going
to connect to that by using the talonnet
command
I said telnet the IP address of our
server and the port town that just
allows us to connect to remote computers
I hit enter on that now you can see I'm
back on the server we have a connection
and allows us to say hello world the
server sent out back to us so here I
have another computer down here if I
want to connect from that I do the same
thing again I said town that I give the
IP address and the port you can see that
we're connected and our connections all
have their own thread which you provide
much better performance if our server
how to handle lots of connections and
now if I said hello again you can see it
printed out hello again to me and also
sent hello again to the other client
that was connected because on our server
what we're doing is we're going through
the list of connections and we're
sending the data to every one of those
connections whenever we receive some
survivors to send something from here
hello client - it sends it back to me
but it also sends it to the client - you
can see I've disconnected from both of
these servers and now I'll just make
some new lines in there I connect it one
more time now you can see we have one
address connected because we deleted it
from our connections so it looks like
our server is working so that's it for
this video in the next video we're going
to be learning how to create an actual
chat server and after that we're going
to learn how to create a peer-to-peer
chat server building upon what we've
already learned in this video so that's
it for this video don't forget to Like
comment favorite and subscribe to forget
to follow us on Facebook Twitter and
reddit
if you have any questions or it's email
me at Francis at haiku org but that's it
for this video and I'll see you next
time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>