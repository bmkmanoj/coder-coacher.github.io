<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 20 - Profile Images with Imgur | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 20 - Profile Images with Imgur - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 20 - Profile Images with Imgur</b></h2><h5 class="post__date">2017-02-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/T3yUQN5l90o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
learning how to let people upload their
own profile textures to our website
we're going to be using an external
hosting service for these images called
imager and that's because it's free for
non-commercial use and it means you
don't need to worry about image hosting
or security so let's get started before
we get started there's a bug in the
index page that we need effects so let's
accept first on the index page you can
see at the minute the query says or
follower ID equals one and that's the
same no matter who you're logged in as
so that means we're only ever showing
posts for the user with the ID of one so
what we need to do is change that to
make it dynamic
so what we want to do is change where
follower ID equals one two or follower
ID equals user ID and then after our
query we need to append on our array of
parameters and here we just depend on
user ID and we get user ID from up here
when the user logs in we assign the user
ID using the is logged in function so
let's refresh and we shouldn't see any
difference on the page you can see
everything works the way it should
because we're already logged in as the
user with the ID of one so now that we
fix that bug we're ready to start
uploading profile pictures so the first
thing we need to do is go to imager here
we go to API image or comm we're going
to be using the imager API to upload
images to our account so the first thing
we need to do is create an application
and we click register your application
here so we have the first login and here
what we want to do is register our
application so we want to give it a name
so I'll call it social network then we
want to click a las two authorization
without a callback URL and then we want
to scroll down here and put in our email
and give it a description
and then here we want to click I'm not a
robot and we want to click Submit so
it's just given us our client ID and our
client secret I know we're ready to move
on to the next edge so now that we've
registered our off with imager we need
to authorize the app to be able to
upload to our account and if we read
this it tells us that after we authorize
ourselves
it gives us an access token and a
refresh token and the access token is
valid for one month and the Refresh
token is valid indefinitely and we use
the Refresh token to get a new access
token before it expires so what we need
to do as we register our application is
authorize our current and we need to use
this URL here so if we copy and paste
our and here I pasted it into the web
browser so we need to go back to the API
and it says that we need to give it a
response type on a client ID and the
state is optional the client ID we get
from here so we just paste the client ID
up here and we need to give it a
response type on our response type is
going to be token because we want our
access token on our Refresh token so we
just type in token and state is optional
so we're going to remove the hot I know
we're going to hit enter
so it wants us to authorize so we just
click a load and as you can see what
it's done is sent us to the image or
home page but along with the home page
you can see there's some parameters in
the URL so I'm going to copy and paste
this URL and a new page I'm just going
to paste it here and in here we find our
access token and we find our refresh
token so now that we have those two
tokens that we can upload images to
imager so what we'll do is we'll create
a new page called my account my account
page we're going to create a form and
then here we're going to create the form
below that
you
so those are forms so let's refresh the
page and
look so here's the my account page and
here's where we're going to upload our
profile image so we need to create a new
PHP blog and we're going to check out
the forms being submitted
submitted we're going to stab print
underscore R 5 I will actually change it
to an the submit button has been pressed
looks like to upload and now we can see
some details about the file so now that
we know some details about the file
we're going to try and upload it to
imager so to upload files to imager
we're going to use the file get contents
function in PHP so we're going to say
the response we get from imager is equal
to file get contents we'll say the image
upload was that imager URL is false and
then we'll say contact the imager URL is
the variable of the URL that we're going
to upload to and the contact allows us
to modify the header files and to modify
the body of the post request we're going
to send using the file get contents
function so we need to create the
contact context is going to be equal to
the return value of a function called
stream contacts create and then here
we're going to set options and the
options that we provide to the string
contacts create function are the parts
of the request we want to modify such as
the headers on the body so in here we
set options it's going to be an array
and this array is going to have one
element and it's going to be called HTTP
and it's going to point to another array
the first item in this array is gonna be
method and we're going to set that to
post the next one is going to be Hatters
so one of the headers we need to stand
is the authorization header you can see
here it says update your access token
you need to stand it in each of your
requests in the authorization header so
in here we need to set authorization let
me share its bearer how many pass the
token and that is the token we have here
this is our access token we pass that
here and because we passed this token
will be authorized and then we pass a
newline we also want to pass another
header called content type and we pass
application/x-www-form-urlencoded the
image so we say body and that's going to
be equal to our image which is the image
we just uploaded and here we'll actually
just cut these into this function here
because we only have the image once it's
been uploaded so we need to put it in
here okay so now that we've moved them
in we need to change that to just header
instead of Hatters it's not supposed to
be called headers and we're going to
change body to content those are just
some typos so now we want to get the
image up here what we can do is say
image equals file
like this so we got the image name from
the files array on the item from the
array we got is the profile image which
is this form item here and then we wanna
get the champ rename the PHP assigned to
the image when it uploaded it what we
want to do the NSF file get contents on
that to get the contents of that file
and then finally we want to say it
base64 encode to encode it as base64
that way we don't have to worry about
file types or anything like that because
imager will just take care of all that
for us and if we look at the imager
documentation for endpoints you can see
to upload a new image we go to this URL
but we can pass it an image as a binary
file base64 or the URL to an image
channel can be up to ten megabytes so
now that we have the image encoded in
base64 and stored in the image variable
we should be ready to go so if i refresh
my uploaded images page you can see
there are no uploaded images and now I'm
going to upload an image
click upload image and we have a small
error it is image or URL not defined
that's because we need to copy the
address to the endpoint and here the
imagery URL is the address of that
endpoint we want to say imager URL and
we pass in that string will not print it
files variable anymore so we'll try that
again
so we've got no errors if I go to the hi
code imager page and i refresh now we
have one image uploaded so that's it for
this video in the next video we're going
to be finishing this off we're going to
be storing the URL to the image in the
database so that we can associate it
with the user's profile we'll also be
putting in a bit of validation on our
own site image you're already validates
it's or images always have to follow
that rule but we want to provide our
users with feedback if they upload an
image that doesn't work when they upload
its imager for example an image that's
bigger than ten megabytes we might want
to limit the file types on our sites to
prevent people uploading gifts or things
like that like animated pictures we
might only want stills to be uploaded
but we're going to do all out in the
next video but that's it for this video
don't forget to Like comment favorite
and subscribe don't forget to follow us
on Facebook Twitter and reddit and I'll
see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>