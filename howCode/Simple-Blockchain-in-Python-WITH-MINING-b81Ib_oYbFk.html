<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Simple Blockchain in Python WITH MINING! | Coder Coacher - Coaching Coders</title><meta content="Simple Blockchain in Python WITH MINING! - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Simple Blockchain in Python WITH MINING!</b></h2><h5 class="post__date">2018-03-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/b81Ib_oYbFk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're gonna be learning
how to create our own blockchain so most
people have heard of a blockchain
because of Bitcoin Bitcoin uses a
blockchain to store and verify
transactions to prevent double spending
attacks but block chains don't have to
store transactions that can store any
data we want so we're gonna be storing
strings in our blockchain so here you
can see the ID part of our program and
this shows our whole blockchain so if I
scroll up here you can see the Genesis
block this is a very beginning of the
blockchain and then after the Genesis
block we have the first block the second
block and the third block and you can
see each block has different numbers of
hashes that were required to find it so
to find the first block we had to do 1.6
million hashes the Genesis block
obviously has zero because that block
was built in to our blockchain so what I
did was a generated ten random blocks
and here they are so let's learn how to
create one of these so our blockchain is
just two classes it has a block class
and a blockchain class and the whole
thing is running about 60 lines long so
whenever we mine a block we're adding it
to the blockchain and that's where this
block class comes in every block is an
instance of the block class so every
block has a number it has the data we
want to store and it has a pointer to
the next block called next every block
also has a hash and it stores the hash
of the previous block this is what makes
the blockchain immutable because to
change the hash of a block and the block
chain requires you to change the hash of
every subsequent block because of this
previous hash the previous hashes were
ties them together the timestamp isn't
really relevant to our blockchain but if
this blockchain was part of a network we
would use the timestamps to synchronize
all the block chains so you can see when
we create a block all we do is we store
its data but where things get more
interesting is where we calculate the
hash of the block so to calculate the
blocks hash we get the nonce the data
the previous hash the timestamp and the
block number we add them all together in
one big string and we run that through
the sha-256 function and that gives us
the blocks hash that gives us this hash
here so that's the structure of a block
and finally this function just means
that when we print out a block we can
see it in this sort of format here so
that's what a block looks like so let's
see with the blockchain itself looks
like so we have a blockchain class and
you can see down here we instantiate a
blockchain class when we have this for
loop here and what this does is it just
generates ten random blocks that's why
you can see the I put here I have ten
blocks that's just this for loop that is
continuously mining until it mines ten
blocks and then underneath here all
we're doing is printing out each
block in the blockchain so a blockchain
is pretty much just a link to list
except all the items are the list are
tied together because of this previous
hash so you can see whenever we
calculate the hash of the block we
include the hash of the previous block
and this is what ties all the blocks
together but because if I was to change
the hash of any block every block that
comes after it is gonna have a different
hash so because a blockchain is just a
linked list to add something to the list
all we need is these two lines here if
you remember every block has a pointer
to the next block so we set the next
pointer equal to whatever block we want
to add and that adds the block to the
end of the list and this line just moves
the next pointer up so that we can keep
adding new blocks but because this is a
blockchain we have to set the previous
hash equal to the block that's currently
at the top of our list so self top block
refers to the block at the top of our
length list and because we're running
this before we add a new block this
refers to the previous block and then
the new block we have to set it equal to
the current block number +1 so the very
first block is the genisis block that's
here it's built into the blockchain and
then this dummy equals head equals block
is out of a Python specific thing when
you're implementing a linked list you
have to remember where the start of the
list is and you call that the head so
it's not enough just to say head equals
block to set it equal to the Janice's
block because in Python objects are all
passed by reference
so the through the head and block
variable would be the exact same if I
have to change block it would change the
head variable so in Python there's a
trick you can just type in the word
dummy or any variable equals head equals
block and that will mean head doesn't
point to the same object as block and
that gets around this sort of python
quirk for implementing a linked list so
the interesting stuff is in mining so
every block has a hash you can see here
and every hash is just a number these
are just hexadecimal numbers so the way
you determine whether a blocks hash
should be put into the blockchain is you
check whether the value of the blocks
hash is less than a specific target
number and this is exactly how Bitcoin
does it so here's where the nonce comes
in you can see the maximum nonce is 2 to
the power of 32 which is the maximum
number you can store in a 32-bit number
so the nonce has to be less than the
target number and if it is then we
accept the block and that's why we can
change the difficulty so we set the
target equal to 2 to the power of 256
but by adjusting the difficulty which is
up here
we've set it to 20 at the moment so that
will be 2 to the power of 10 or 50 6
minus 20 or 2 to the power of 236 so by
increasing the difficulty number what
we're doing is we're decreasing the
target range so the acceptable range has
become smaller so it gets more difficult
to mine a block because a blocks hash
has to be less than or equal to the
target range to be accepted that's how
Bitcoin controls the rate at which new
blocks are mined and I can demonstrate
that so if I set the difficulty to zero
every single block will be accepted
because every single blocks hash will be
less than the target so if I was to run
this again and generate 10 blocks you'll
see it'll do it instantly you can see it
generated 10 blocks and we didn't have
to weigh it and if you look at it you
can see the number of hashes it took to
calculate the block was zero because
every block was accepted but when I
increase the difficulty earlier to 20
you can see this took 422,000 hashes to
figure out this block so if I was to
change the difficulty to 20 and I was to
run this you'll notice there's no
instant blocks anymore it's actually
taking time to generate a block there
you can see we had to make one point
eight million gases to gas this block
now as opposed to zero and the nonce
number is what we use to change our gas
so whenever we're trying to figure out
the hash that will be accepted we have
to change our data somehow so we have to
change the hash of the block the nonce
is just a number that we increment every
single time we make a gas and by
changing that one number we're getting a
completely different hash so this for
loop just guesses pretty much from zero
to the maximum nonce and every time we
loop through what we're doing is we're
checking the curb blocks hash is less
than or equal to the target we have to
convert it to an integer because we're
using the comparison operator in Python
if the blocks hash is less than or equal
to the target then we can add the block
to the blockchain we print out the block
and we stop mining because we've got the
block we were looking for otherwise what
we do is we increase the nonce by one
and we go again and that's pretty much
it for our blockchain so I'll put all
this code on github but that's it for
this video don't forget to Like comment
favorite and subscribe don't forget to
follow us on Facebook Twitter and reddit
but that's it for this video and I'll
see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>