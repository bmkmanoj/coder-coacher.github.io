<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own Search Engine - Part 3 - Inserting Sites | Coder Coacher - Coaching Coders</title><meta content="Make your Own Search Engine - Part 3 - Inserting Sites - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own Search Engine - Part 3 - Inserting Sites</b></h2><h5 class="post__date">2016-08-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3t9Bk2Cu0EI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in the last video we left off being
able to cut all of the rules in our
database in this video what we're going
to be doing is counting all of the rows
in the database that are equal to one
URL in other words checking if a URL is
already in the database to do that what
we need to do is access the URL out of
details so the way we do that is we just
said details and then we access the URL
property so what we want to do is say
select all from index where URL
underscore hash is equal to md5 details
URL the reason we're not just checking
in the URL is because for some reason
whenever I did this and my prototype
version before the series just didn't
work at all I have no idea why but this
is what fixed it so before this will
actually work if we just run this now
what we'll do is we'll get and nothing
just like we did up here you can see we
got nothing printed out so what I'm
gonna do is say echo empty fine details
URL and we're gonna run this again so
there's the md5 string of google.com
because Google comm is the first link on
our test on HTML page so what I'm gonna
do is just modify in this rule we've
just inserted I'll just call it Google
I'm not giving you description at the
minute I'll just put in a fake URL
Google calm and then I'll put in the
heart here cut going out and save and
now what will happen when this runs
we'll get one printed out for the first
result and we'll get nothing printed out
for any other results underneath because
we've only got one result in our table
so let's just run this now so it looks
like it didn't work but it actually did
this one has just been placed at the end
of our md5 string you can see that
because it's one character longer than
all of the other strings an md5 string
to roll 32 characters long so we can
just uncomment that and we can say down
here
if Rose is greater than zero that will
just echo update I will echo insert I
will just append new lines on to make it
easier to read it up here will also just
a quite details URL and append on a
space so if we just run this everything
will make a lot more sense and it
probably does now we run this and we
stop it you can see that for google comm
we say update and for all of the others
it says insert that's because we want to
insert the row into the database if the
result isn't already there but if the
URL is already in the database we're
going to update it so that if we crawl
it more than once we don't want to
insert multiple copies we just want to
update the results that we have the most
recent version of the website so the
first thing we're gonna do is the insert
this is just gonna be a MySQL query so
what we will do is we will say result is
equal to P do repair because this time
we're using a prepared statement so a
prepared statement instead of using the
query method we're gonna use the proper
method and we're gonna say insert into
index file use the first value is the ID
which is auto incremented so we can just
leave that blank the next parameter is
title so we're just gonna say it : title
the next one's going to be : description
Col on keywords cool on URL and come on
around underscore hash the next thing we
need to do is get these values out
underneath here what we say is result is
equal to P do execute
and in here we pass it a variable called
params which is an array which holds all
of these parameters we've just created
here so we'll just combine here and
we'll say params is equal to an array
and it's an associative array so we say
: title is equal to details title you
can see that if we go up here our title
is there on our title as capital T
that's important it's case sensitive so
we say a title then we say description
whoops :
description is equal to details
description
these are the same except for this one
except for this one here we just run
this in the md5 function to hash the URL
and that's stored in the parameter so if
we try to insert this knife we'll get an
error most likely that's because we got
an error if any of the fields are no so
to fix that what we do is we say if is
underscore no params title so if the
title is no then we obviously can't
insert it into the database and what we
can actually do is just say if it's not
no then we will insert it into the
nativist and we'll say and description
isn't no then we'll insert it into the
database and we just need to say a
result is equal to result to execute not
PDO execute so if we just stop that we
see what we get in our table you can see
we have a couple of websites and we have
a couple of blank titles so to fix that
what we could also say is and instead of
saying if it's not know just our params
title doesn't get called nothing I would
just copy this and we do it again and we
do it one more time
I would like to just say that because if
we don't have a title then we can't
insert it but if we don't have a
description we can just say something
like no description available so let's
just run this again
and let's just stop that so to test it
with empty titles we're just gonna add
to the table I will just run this again
and stop it
and we'll see how many rooms are in our
table so you can see the only things
that have been inserted into the table
are the results that had a title so in
the next video what we'll be doing is
working on updating rows in the database
that are already inserted so that's it
for this video don't forget to Like
comment favorite and subscribe and I'll
see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>