<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own Instagram - Liking Photos (8/10) | Coder Coacher - Coaching Coders</title><meta content="Make your Own Instagram - Liking Photos (8/10) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own Instagram - Liking Photos (8/10)</b></h2><h5 class="post__date">2017-08-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4KnoVvcUaQY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
learning how to like photos because you
can see down here if I click on this
heart nothing's going to happen entice
you're going to give us an hour behind
the scenes and liking photos is actually
really simple
all we have to do when we click like is
we send an air Jack's request to the
server with the details about the photo
that we just liked and we increase the
light current on the photo by one and we
have to have a separate database table
which tracks who liked which photo so
inside our models file we just want to
create another really simple model and
this model restores the idea of the
photo that we're calling post ID and it
has the username of whoever likes the
photo so of course not we created a new
model we have to run make migrations
then we have to run migrate to actually
create the database table so now that
we've done that we can run the server
again and refresh and we have our new
database table so no other we've done
that we want to create a new URL for
liking photos and we're just going to
call it edge acts like photo and it's
going to link to the edge acts like
photo view and our view is just another
edge acts view similar to most of the
ones we've created so far except we're
sending a gat request not a post request
I know all this has to do is to actually
like the photo so here is our edge acts
like photo class and of course we
validate our class to make sure it
wasn't malformed and we just retrieved
the post ID from the request and we
check if the user was logged in and here
is where we do the actual liking so what
we do is we go to the photo likes table
that we just created and we find any
rows where the liker is the user who's
logged in so if I'm logged in as Francis
we're going to check if Francis is liked
to photo and the post ID we're checking
if that is equal to whatever ID was send
to us in a request by checking those two
things we can tell if this particular
user has liked the post and I'm going to
invert it using this not keyword if we
have it like the photo we're going to
run this code otherwise we're going to
unlike two photo and run this code so -
like a photo all we have to do is update
the number of likes on that photo by one
that's what this line does here and now
what we do is we just insert a row into
our photo likes table so we can keep
track of who liked which photo then we
just save that row and if we want to
unlike the photo we do the exact same
thing except we just reduce the number
of likes on the photo by one and then we
remove that row from the photo likes
table to set of this user no longer
likes that photos we just want delete to
delete that row and before we run that
we just want to scroll up and we want to
add our new model and what happens is I
click this button then it sends an ajax
request you can see we have our like
photo class here that's the button we
click on and we add an on click event so
that whenever the heart is clicked it
will send
to ajax.request off with the post ID and
against the post ad from the data
attribute so if I was scroll across here
you can see we have this data
post ID attribute and that's the
attribute that stores the post idea when
we like a photo and whenever we like the
photo if it's been successful which I
guess that resulted in the user having
liked the photo or on liking the photo
so if they unlike we make the heart
Hollow I have to have liked it we fail
the hard end so if I click on this heart
now you can see the heart went purple
you can see it says there's no one like
and now if I click it again what it's
going to do is it's going to check that
like away but you can see the color of
the heart didn't stay whenever i refresh
the page so to fix that we're just going
to go back to the Ajax photo feed and
when we print our eye pop I scroll
across you can see that by default liked
is always equal to false that's why it's
not storing the like so to fix that I'm
just going to replace it with this so
it's exactly the same the only
difference is for each photo that we
were returning we are checking if the
current user liked that photo so we just
go to the photo likes table and we check
if the licker is equal to us and the
post ID is equal to the current post so
we're just checking if the user liked
this photo if they did we set like
tickler tree otherwise we set it to
false and that's what we returned in the
JSON and what we want to do is just copy
and paste this for our profile feed as
well so I'm just gonna replace this and
this should be self dot user username
and we're just going to scroll across
and paste this back in so that we can
see the profile photos now when i
refresh you can see we're tracking the
number of likes and the heart is already
filled in if I click at neither the
heart becomes hollow refresh the likes
have gone down in the hollow again one
more time and it's working as expected
if we check the profile page click on
the photo you can see it says that I've
liked it so that's it for this video
don't forget to Like comment favorite
subscribe don't forget to follow us on
Facebook Twitter and reddit if you have
any questions don't forget to email me
at fineness of our code or don't forget
to check the description to get your
free upload care account in the next
video we're going to be learning how to
follow users but that's it for this
video and I'll see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>