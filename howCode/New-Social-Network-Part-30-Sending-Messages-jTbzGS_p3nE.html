<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 30 - Sending Messages | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 30 - Sending Messages - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 30 - Sending Messages</b></h2><h5 class="post__date">2017-02-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jTbzGS_p3nE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're gonna be learning
how to create our own simple private
messaging system so let's get started so
the first thing we have to do is create
a new table to store the messages we're
going to call this table messages and we
need an ID field to uniquely identify
each message we also need a sander a
receiver and the message body so the
first thing we're gonna say is message
body the body is gonna be of type text
we're not gonna let that be no because
if it's no we don't want to send the
message sander it's gonna be next it's
gonna be an intense gonna be the ID of
the person who sent the message and
receiver it's also gonna be an int and
it's gonna be the idea of the person who
received the message and we're not gonna
like either of these to be no and
they'll go and they're both gonna be
unsigned we're also gonna add another
field called red and it's gonna be a
boolean and that's just going to tell us
if the user has read the message or not
and we don't want that to be no and we
want that to be unsigned so now that
we've created our table we need to
create a new page to let us signed
messages so we're going to create a new
page so our new page is called San
master PHP and what we want to do is
first create a form
now we want to create our form
I know we've created our form we want to
add
textarea and we want to add a button to
actually send the message and we've
already done this here so we'll just
copy our text area and our button from
our profile page or move the file type
and remove that other text
and we're gonna refresh the page so
here's our sand message form and we need
to give it a parameter of receiver and
that's gonna be equal to the ID of
whoever is going to receive the message
and in this case we're gonna set it to 3
so that hi code can receive the message
next we're going to check if the users
logged in and we've already done that on
the index page we'll just copy and paste
that so we're gonna delete post and
comment because we don't need them we
only need the login class and the DB
class we don't need your timeline we
don't need your timeline down here so
now we have our user ID of the user
who's logged in we also know that the
user is logged in we can display this
form otherwise we'll change this to die
not logged in just to kill the page and
now what we want to do is send the
message you can see here that the form
submits to receiver and then it aqua
site whatever is in the address bar and
this could obviously cause cross-site
scripting so we're just gonna echo HTML
special chars or on dot and that should
prevent that so now we want to do is run
a check if the button has been submitted
so we want to check if sand message is
being clicked
like this if the sand button has been
clicked then we're going to send the
message so to do that we're going to do
a DB query
and we're going to set insert into
messages the values first one is going
to be ID of course which is going to be
nothing the next one is going to be the
message itself which is gonna be the
body the next one's going to be the
sander and the next one's gonna be the
receiver then we want to add our array
at the end the body is gonna be post
party the sander is gonna be the user ID
and the receiver is what we're gonna get
from the address bar and we could put in
here ste ml special chars here just to
make sure that we're not getting
anything that isn't a number but either
way if we got something that isn't a
number it should give us an error
anywhere and then here we'll just echo
message sent and after receiver we also
want to add read which is going to be a
zero that says by default the message is
on red so we'll run that and see what
happens so I want to send a message to
my code which is the user with the idea
of three so I'm gonna click send message
it says message sent
and we go to content and there's our
message sent Weaver said we have a
center Vaughn receiver of three and it's
unread we're not quite finished because
at the minute we've nowhere to verify
that the receiver is actually a
legitimate number there's nothing to
stop someone putting in a number of a
user's ID who doesn't exist
so what we want to do before we send the
message is we want to run another query
and say if DB query I will select ID
from users where the ID is equal to
receiver and then we'll pass the
receiver variable
just like that so here we're just
checking if the query is successful then
we'll send the message otherwise you
won't so now if I go in here and I
refresh we should what this should work
if I send another message if I could
extend message it works if I put in an
ID that doesn't exist like 20 for
example and I clicks an message we got
nothing I put but we refresh and we get
nothing in the database in fact if the
ID is not valid we could just die in
valid ID and then refresh you can see it
says invalid ID no so that's it for
standing masters some people had asked
for real-time messaging and that's
something I'm gonna give some thought to
and I might make a video on it soon but
for now this is a simple messaging
application that just sends a message
and stores it in a database and then
we're gonna receive the message and
retrieve it from the database in the
next part so that's it for this video
don't forget to Like comment favorite
and subscribe don't forget to follow us
on Facebook Twitter and rat it and I'll
see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>