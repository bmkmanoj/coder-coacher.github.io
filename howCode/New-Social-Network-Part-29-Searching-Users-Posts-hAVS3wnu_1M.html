<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 29 - Searching Users &amp; Posts | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 29 - Searching Users &amp; Posts - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 29 - Searching Users &amp; Posts</b></h2><h5 class="post__date">2017-02-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hAVS3wnu_1M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
creating a search form that lets us
search for specific users or search for
posts just by type again their username
or some tax from the post so the first
thing we need to do is create a search
box on the index page so we'll create
the search box above our existing forms
so we'll see how that looks in the
browser so those are search bugs again
because we're not focusing on the design
we're not concerned about that in a
minute so we're just going to leave it
like that but what we want to do is
focus on the functionality behind it
so we want to check if is Sat
post search box like this so if the form
has been submitted then we want to
search our database so we're going to
create our search query in our SQL
client and it should make things easier
so we're inside of our SQL client we're
going to create a query we're going to
set of select username from users where
username is like and we're going to use
MySQL like operator on in here what we
do is we pass a string for example
Francis and put two wildcards either
side of it so any user name with the
word Francis in it would be returned so
if we click run you'd see we get Francis
classist one and fascist back to me so
what we're going to do in PHP is we're
going to split up these words so we're
going to split us up in a chunk so you
can match for example the first three
letters of the word processor and you'll
get the entire word returned so right
before the username we also want to get
the post we also want to be able to
search for posts so we're going to
search from posts as well and we're
going to select posts posts top body and
we're going to set where users don't
username is like Francis in this example
or where posts top body is like and
we're going to pass in another word so
for example if I go to the posts table
you can see we have a few posts to have
the word hello in them survived searches
all of the post bodies for a post with
the word hello in it and I click run and
we have a syntax error because we're
coming up one word clause in our query
we run that and now we get every post
with the word hello in it or was the
user name of the user that's returned is
Francis but as you can see we're getting
the same body printed out more than once
for the for one post we're getting the
user names repeated as well so what
we're going to do is use two queries to
create the tables and we're going to
join the results using PHP and then
we're going to I put the results one
after each other using PHP so MySQL is
just going to see two individual queries
but PHP is going to sort of merge them
together into one so we're going to copy
this query and we're going to say a TV
query and we're going to sign that to
users and we're going to paste in this
query we only want the username we don't
want anything else and we only want to
search from users in this query and
we're just going to say where username
is like username and then we're going to
put in our array we're going to say
username is going to be replaced with
the post value from the form which can
be post search box and then here what we
want to do is append on the two wild
cards just like that then what we're
going to do is we're going to print out
users
we're going to see what we get returned
so here if i refresh and I type in
something ended up form for example
Francis now you can see we got all of
the users with the username Francis so
what we're going to do is we're going to
go up here to search equals post search
box and then we're going to do is split
it up on spaces so we're going to say
explode on spaces and we're going to
exclude that string and what I'm going
to do is I'm going to say if STR Lam to
search equals one which means it was one
word which means it was probably a
username I'm going to set to search
equals STR splits we're going to pass it
itself and we're going to split on every
two characters that would take the word
Francis and it would split it on fr and
on ta and then it would split like this
into an array so that means we don't
have to have the entire name correct to
be able to find the user then what we're
going to do is we're going to save for I
equals 0 and I it's less and current to
search I plus plus so just a normal
standard for loop to loop through an
array and in this array what we're going
to do is really create variable calls
were close and we're going to set work
Clause dot equals to app and on it up or
user name like and then here we're going
to pass in a parameter called you and
then we're going to put in the variable
1 and then we're going to put in the
variable I so therefore we're saying
where the username is like and then
we're taking every chunk inside the to
search array and we're comparing it
using the like operator and then what we
want to do is when I pandas on here so
here we have our query where usually am
is like username and then here we want
to append on were clause so we'll just
paste in were clause and we need to run
that as a variable so now that we've
done that we need to append on to our
arrest so to do that what we're going to
do is we're going to take this array out
and we're going to replace it with
params array and then params aware is
going to be equal to an array and then
the first thing we'll do is we'll give
it a value of username is going to be
equal to the value out of the search box
and then what we'll do is we'll see our
params red square brackets equals and
here we want to put in the new variable
that we have up here because we use
single quotes we'll use double quotes
actually so they can run the variable so
we're saying parameter a and then we're
giving this value here and we're saying
that is equal to two search and then
we're passing in I and then we need to
define know proms Rea above the for loop
just like that so here we've already
exploded it so what we want to do is
just change
- correct 9 ft island and we're getting
this other error because to search is
already an array and ask just that only
works on strings so what we're going to
do is just pass it to search and we'll
pass at the 0th index one which should
be the entire string because it should
only have one word in it so now we get
our username printed back and what I'm
going to do is put in just the word fr
I'm going to click search and we get
everything we would expect if I put in 0
for hi code and click search now you can
see we get haiku back we don't even have
to put in the whole username haiku so
rather we can search for users we're
going to start proposed so we're going
to do a very similar thing and we're
going to keep this in its own function
for now later on in the series when we
build our own simple MVC framework we're
going to be moving all these into their
own classes but for now we'll leave it
as it is and here what we want to do is
essentially copy our query and instead
of searching for users want to search
for posts and we want to search posts
body from posts where posts body is like
body and we got that from our workflows
and our proms right so down here we're
going to just copy that and we're going
to piss it here I'm going to overwrite
our existing variables so our params
Reds go start with body and it's going
to be the value from the search box now
we're going to modify our work clause
instead of saying we're using them like
you we're going to serve our body is
like I will just change that to a P that
doesn't actually matter that's just an
internal thing so here what we're doing
is we're just essentially copying what
we did above what we're using the posts
table and we're using the body column in
the posts table instead of the username
column and the users table but it's
virtually the same and here what we're
doing is we're splitting the search
query up based on spaces so we're
searching each individual word and if we
do this for posts what we'll do is we'll
get loads and loads of post returned if
we search on every single word in a post
so what we might want to do is only
search on every stack in our third word
so what we could do in our work clause
is say if I is divisible by 2 for
examples we search for every second word
then we'll run it otherwise we won't
select run this we want to change that
from users to post so in our table of
posts there's a post hello world that's
when we see a lot so we're going to put
in the word hello and there we can see
we got a lot of posts printed out
so here we just changed it to pray
exit easier to read so we didn't get any
users printed out because there was no
users with the username hello but we do
get a lot of post printout because
there's a lot of post-its to hello world
and we'll type in something else for
example we hope we'll make sure we spell
the right there's a poster suspended
differently so we'll search that and
there we can see we have two posts and
they both have the word woohoo in them
so that's our simple search feature done
obviously we haven't put it any data yet
to the screen and we're just using pre
tags by doing that and not sanitizing
the eye part we're opening ourselves up
to cross-site scripting but because
we're not worried about the design where
we only worried about the actual
features and we're going to be moving a
lot of this code into its own class and
things like that another video it's not
that important a minute so that's it for
this video don't forget to Like comment
favorite and subscribe don't forget to
follow us on Facebook Twitter and rat it
and I'll see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>