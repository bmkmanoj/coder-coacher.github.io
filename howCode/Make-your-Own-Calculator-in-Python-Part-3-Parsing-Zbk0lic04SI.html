<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own Calculator in Python - Part 3 - Parsing | Coder Coacher - Coaching Coders</title><meta content="Make your Own Calculator in Python - Part 3 - Parsing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own Calculator in Python - Part 3 - Parsing</b></h2><h5 class="post__date">2016-09-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Zbk0lic04SI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in the last video we left off having
created our lexer in this video we're
going to create our parser so what we do
that is we're first going to just delete
that and we're going to get the input
from the user and we're going to pass it
to the parser this time so we're going
to say it while true again to create a
loop we're going to say s is equal to
input which gets the user input and then
we're going to say we're actually gonna
put this in a tripe and a try block
because we're gonna say try it to get
the input otherwise if we get an
exception which is an end-of-file
error an end-of-file error is what you
get in the terminal if you press ctrl D
you can see it has just reached and a
file and it's just logged me out so an
end-of-file arrow is just when you press
ctrl D on your keyboard and we're going
to just break out of the loop then if we
get one of those and then we'll say well
actually leave it for now so what we'll
do is we'll create our parser so we'll
create a function called P underscore
calc that takes a parameter called P and
then what we do is we create a string
this string is we're gonna put our
grammar rules so we're gonna say a
calque is equal to an expression or an
empty which is another non-terminal when
you create so these are called non
terminals if I was just said calc is
equal to int that would be terminal
that's a direct token but since I said
expression which is going to have its
own grammar rules it's a non terminal
and what P is it's a Python double and
for example P and P Zero is calc 1 is
gonna be expression and P 1 it's going
to be empty
this means a calc can be an expression
or it can be an empty it sounds sort of
weird to say like that but it'll make
more sense when we see and the other
grammar is getting put into place we'll
say I print P 1 because P 1 is going to
be whatever our expression evaluates to
be or whatever on empty is an empty is
just going to be simply an empty line so
it means if you press ENTER on the
keyboard then we're not going to see
loads of parser errors trying to parse
an empty string so we're going to say
def P underscore empty
P underscore empty we're going to create
a string for it
and we're gonna say empty and we're
gonna say an empty is equal to nothing
it isn't equal to a non-terminal and it
isn't equal to a terminal so we simply
say a 0 is equal to none
there's our empty non-terminal created
now we have to create our expression
non-terminal so we say app a underscore
expression we pass it P which is the
data that it's going to look at we say
an expression can be simply an int or a
float this is just initially we're going
to change it and make it more
complicated in a minute or a float
and what I'll say then is p0 is equal to
p1 so our expression is essentially
going to be evaluated to whatever the
value of our int or our float is
unnecessarily passed it to this grammar
rule which will in turn print out the
expression so essentially what this will
do if we type in 1 it will print out one
underneath
so what I need to do is I need to just
say parser is equal to yak dot Yak just
like up above lexer was equal to lac
start Lacs and dine here what I do is I
say a parser dot parse and I pass it the
string we take from the input so let's
run this okay we get an error that says
P our function is undefined as you can
see up here we have T error which is for
the relaxer errors pierre underscore
error is for our parsing errors we just
need to create that s not an error it's
just a warning and here are just tokens
we haven't used yet because we haven't
actually used them in our grammar rules
but it still works so we're gonna say it
one we're just going to say one x a
print and you can see one gets printed
out underneath we'll say one hundred 100
years printed out underneath and we get
no errors if I was to say 12 and put a
hitch in that's not a number it's not
gonna value it to either an integer or a
float which is what we told it an
expression can be so we got an error
yeah syntax our on line one so let's
just ctrl C to get out of that and know
what we're gonna do is say we're going
to change that to P expression on the
score and float just to make it a bit
more readable and up here we're going to
create another function called P
underscore expression and it is going to
be equal to expression is equal to an
expression this sounds sort of weird but
it makes sense in a minute plus an
expression so essentially what this is
doing is vais add an expression is equal
to an end president and an expression
could be say 1 plus 2 but if I want to
say 1 plus 2 plus 2 or 1 plus 2 plus 3
that wouldn't work we need to create a
recursive expression which essentially
means an expression can be equal to
expression plus expression or an
expression can be equal to an int or
float so that means this expression
could be an int but this expression
could be an expression which can itself
be an expression plus an expression that
sounds weird but essentially what it
means is we can have an infinite number
of numbers when we add them together we
can a value an infinitely long
expression so we're gonna say an
expression is equal to an expression
plus another expression or an expression
is equal to an expression minus an
expression and up here I'll actually
just create another one
what's that an expression multiplied and
I'll create another one divided by want
a multiply and divide to be done first
and here what I'll do is I'll start to
build a tree because if you remember in
the first video I said we were going to
create a tree so essentially this is
what our tree is gonna look like up here
is ten plus five times four which is our
expression over here is what the tree
will look like essentially it looks like
this the plus is at the top the ten is
the branch on the left and whatever's to
the right of that is another branch but
because what's to the right of it is a
multiply dot itself branches into a five
and a four if it was just ten plus five
for example without the times by four it
would just be a plus in the middle and a
ten and a five either side and that
becomes this which is a Python couple
this is the sort of tree we're going to
create in Python this is how we're gonna
represent it but this is what the tree
would actually look like there's a more
visual representation so this is what
our tree looks like in Python this is
how we're representing it using trouble
and this is the tree that's going to be
produced by our parser and then it is
this tree that we're going to walk using
our special run function that will
actually evaluate all of the nodes on
the tree so we're gonna say at p0 is
equal to a tuple as I showed you in that
slide and the first thing it takes is
the type of operation which is going to
be multiplied divided plus or minus so
this p variable is a topple in itself
and p0 is expression p1 is going to be
this expression and p2 is going to be
multiplied divided plus or minus so the
way we do that is we say p2 then we want
to pass it the parameter on the left
hand side followed by the parameter on
the right hand side so we'll go left
first layer p1 and p3 so let's just run
this you see we get 16 shift reduce
conflicts
know what that for night but we're going
to resolve that in a second if they're
not actually ours they're just conflicts
and we can fix them in a minute but
essentially what happens is if I say one
plus two print that instead of printing
one like before we're printing the
expression and if we look at this
expression we have ten plus five times
four so we're going to just run our said
ten plus five times four and we get
exactly the same topple as we had
expected to get this is the tree that
we're going to pass to our special run
function so that's it for this video
don't forget to Like comment favorite
and subscribe and I'll see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>