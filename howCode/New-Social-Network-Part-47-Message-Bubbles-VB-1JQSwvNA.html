<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 47 - Message Bubbles | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 47 - Message Bubbles - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 47 - Message Bubbles</b></h2><h5 class="post__date">2017-07-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VB-1JQSwvNA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in the last video we left off having
retrieve messages from the database that
were sent to us by the user with the
idea of 7on messages that we sent to the
user with the idea of seven doing that
allows us to create this sort of chain
effect that we have on our design here
and what we're going to do in this video
is we're going to implement that so it's
implement that what we have to do is
first export our design so in bootstraps
to do I'm just going to export this so
now we've exported that what we want to
do is just paste in our new messages
page and we want to replace our assets
folder we just want to replace this we
want to merge these two folders and now
we've exported our design and here's
where we're loading our messages in
which you can see there's a message and
then there's a spacer and then there's
another message so there's the message
here and the way we get it onto the
left-hand side of the screen is we have
an identical message on the left-hand
side and we just call this one on the
left-hand side
the message spacer so we want to run an
edge axe request whenever we load this
page so in our profile page we're
already calling an ajax request when the
documents are ready function runs so
we're just going to copy this and use
this as our template and join here below
all of our JavaScript we're just going
to create some script tags and we're
going to paste our function in here
obviously we want to close that function
off like this and we want to put in an
error code so whenever we get an error
we want to run a function and this
function is just going to log the error
so we want to call API forward slash
messages and we want to pass the
standard variable and the sender
variable is going to be equal to just a
global variable we're going to create
called sander and Sandler is going to be
equal to seven initially because seven
is our test number so whenever we get
our response from the API what we want
to do is convert it into JSON so we're
just going to say R is equal to json dot
parse and we just want to pass R itself
so if I just log that and before I log
that we have to go to our API and we
want to just scroll down you can see
here we were acting out some pre tags
we're just going to see of that and
remove those pre tags now if i refresh
you can see we get four objects returned
because in this case we have four
messages so what we want to do now is
find out the username of the person
who's logged in so what we want to do is
go to the API and we want to actually
create a new function we just want to
use our login token and we want to do is
use our login token to get in the user
name so we're going to go to the users
endpoint and what we're going to do is
we're just gonna paste this in and we're
going to rename receiver to user
underscore ID so what you get the user
name all we have to do is just say
username equals and we'll just copy this
query and we'll say select username from
users where I'd a equals u ID and we'll
just pass in you ID equals user
all righty so we're going to have now
we're going to have a username and this
variable and we're just going to echo it
out so we're going to echo username and
we just made a mistake this is an array
I'm going to want to access the first
index and I'm going to access the user
name that's returning from that array so
now you can see our username is being
printed out depending on whoever's
logged in we're going to get a different
username I'm back in our masters page
what we want to do is go back down here
and we want to run another request just
to dine on the username so we're just
going to say get username and then up
here what we're going to do is we're
going to create a function called get
username it's going to send an AJAX
request and all it's going to do is
retrieve the username for us so I'm just
going to copy this template I'm just
going to call API slash users and
onsuccess we're just going to say
username equals R and we'll create the
global variable username up here so now
we have the username what we want to do
is we want to compare the receiver and
the sender to the username so to do that
we want to loop through all of our
results
and we want to say if the current result
which is RI dot receiver equals user
Hamm then we know that we were the
receiver of the message otherwise we
know we were the standard so if we were
the receiver what we want to do is we
want to print out the red bubble and if
we were the receiver we want to copy
these first two days we also want to
give this let's group an ID just so we
can access it we're just given an ID of
M and we'll scroll down I'm going to m
dot append to append on these days I
will just paste in this string I'll just
put on one line get rid of those errors
of course want to change the
message
and the message is going to be are a dot
body let's say we retrieve the message
so we're just going to copy this we've
put it on our spacer and we want to do
is I'll also put it into the red speech
bubble and when we create our global
variable you just want to set it equal
to nothing initially and instead of
running a GATT username function what
we'll actually do is we'll just copy
this antiox request because if we run it
inside a function what we're going to do
is we're going to sand off the request
but we're not going to wait for the
response before we run the rest of our
code so we're just going to put this
rest of our code in the response like
this if this code up we're just going to
rename this so we'll just call it u
we'll call this u and we actually use
Jerry's selector just to set em to the
pan now if we refresh you can see we got
our new messages so we're just going to
copy that paste this in here and change
the class from message from me to
message from other we're going to delete
these CSS styles and we're going to
scroll up and we're going to delete all
of these dudes in this list because at
the moment they're just taking up space
and we don't need them because we're
replacing them with our actual dynamic
content and we actually have these mixed
up what we want to do is we want to say
if the receiver equals our username that
means we didn't send the message so we
don't want to display the read messages
so we just want to invert this because
we could just say if our sander equals
using him or and keep it like that I'm
now if we refresh you can see it looks
like we received three messages and we
sent one and if we look at it you can
see the sender was three times it was
Francis Mac to me and the receiver was
once Francis so that's how we get the
bubbles to display properly in the next
video we're going to be learning how to
send messages on how to get this
left-side navigation to work but that's
if this video don't forget to like
comment favorite and subscribe if you
have any questions don't forget to email
me at fascist at how code or don't
forget to like comment favorite
subscribe don't forget to follow us on
Facebook Twitter and reddit so that's it
for this video and I'll see you next
time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>