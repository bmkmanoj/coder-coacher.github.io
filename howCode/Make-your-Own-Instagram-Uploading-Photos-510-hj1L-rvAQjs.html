<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own Instagram - Uploading Photos (5/10) | Coder Coacher - Coaching Coders</title><meta content="Make your Own Instagram - Uploading Photos (5/10) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own Instagram - Uploading Photos (5/10)</b></h2><h5 class="post__date">2017-07-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hj1L-rvAQjs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
learning how to actually upload files to
upload character on my website so the
first thing we're going to do whenever
we log in is we're going to have our
photo feed so to get the photo feed what
we want to do is go to our URLs and
we're going to rename this one from
index we're just going to call it home
and inside views instead of index we're
going to have home so I'm just going to
piss this method in here and then I'll
explain it so the first thing we're
doing is we're checking if the users
logged in that's what this request user
is authenticated does and if the user is
logged in we want to retrieve their
details so we do that by querying the
database based off the username of
whoever's logged in and we retrieve the
one row that's returned then what we do
is we assign a profile photo and then we
just have a contact like usual so we're
going to have a variable on the page
called user which is going to be all of
the users information such as their ID
the username their profile pic and then
we're going to render a logged in
version of the index page otherwise
we're just going to rag render the
regular index page that we've already
been doing so we're going to have a
version of the index page for when
you're logged in while we're on the
profile pic we're going to create a new
column in the database for our profile
picture so I'm just going to paste in
this new fields for the profile picture
it's just going to be a tax field and a
max with the maximum length of 255 and
by default it's going to be empty we're
just also going to put in is
authenticated up here because we're
using a custom user model so we have to
have this is authentic it is and once
again we just migrate up
so in our tablet
I'm just going to paste in this template
I'm going to open it up so it's much the
same as before so now we're going to try
to log in but before we can do that we
have to go to settings coming out to add
what Django calls an authentication
back-end it's just something we have to
do once because we're not using the
default user model and then we have to
just create our authentication back-end
and this is it here we only have to do
this once so after we've done that we
should be able to log in so if i refresh
so now once we've done that we're able
to log in and you can see here is our
photo feed without any photos so what we
want to do is start uploading photos so
if I click on this upload button so
here's our image uploader and here's how
it works here is the code for uploading
images these first two chunks just deal
with making the image uploader appear
and disappear and then what we do is we
provide our public key that's the only
field that is absolutely required then
we can tell a blue card only upload
images because upload car can upload all
sorts of different files it can upload
PDFs and all sorts it's really what a
lot uploads of images and this system
dialog just means that whenever we click
upload a dialog will slide down from the
top of the page and we can pick a file
on our computer rather than upload cars
dialog where we can drag files in it's
up to you you can turn that on or off
the preview URL is the string that we
manipulate whenever we're adding effects
to images and the current rotation just
tells us the current location of the
image the base URL is the URL of the
photo when it gets uploaded upload car
without any effect so we're storing both
the base URL and the URL with upload
cards on the fly effect added to it and
this is just how we decide if it's a
profile photo or not so this function
was actually taken just from the upload
car website and what it does is the
widget will display the photo you just
uploaded it's on the applicant website
I'll include a link in the description
of the video what I've done to customize
it is I check when the file is finished
uploading I figure out the size of the
file in terms of its dimensions then
what we do is we start the preview URL
equal to the URL we got from upload car
and the base URL equal to the preview
URL at this point there's no effect on
the image next what we do is we show the
image by just creating a new image
element on the page and we set the
source equal to the preview URL which is
the URL that can have a fax on it and we
update the height width of the container
to match that of the image now what we
do is we scroll down and we go through
all the effects and whenever we click on
an a fact we we set that effect when
there's a cat effect method we check if
it's a JPEG because because the invert
effect doesn't work on PNG
once we want to check
if it's a JPEG so that we can invert the
image and then after we've added the
effect we just update the preview image
URL this cause just for updating profile
photos and whatever the upload button is
clicked that's what we send an ajax
request to our server to store the image
in the database and refresh the page we
did the same fits a profile photo as
well this is more code from the upload
car website I'll include the link in the
description but this cat effect method
is the method we use for adding effects
images so all we do is we go to the
preview URL and we add for example
greyscale or we are the invert effect
just like we saw in video number two
when we looked at the upload car API and
how it works and then we scroll down
some more and we can and then where we
rotate an image is when we click rotate
we update the current rotation and then
we update the image with upload cars
rotate effect now we rotate the image by
whatever this current rotation number is
now we're on the logged in index page
that's the page with the photo feed what
we have to do is we include the upload
current wedge it then we include are
uploading script and that's all we have
to do to actually upload images and the
rest of this is for displaying images
and we'll learn about that in a later
video but for uploading images that's
all we need but before it will work we
have to create a table in our database
obviously to store those images so in
models I'm going to create a brand new
model call it photo and we have a base
URL the the URL with the effects the
data was uploaded the owner of the image
how many likes it has what the caption
of the image is the number of tags image
I'll and what the tag is is it's just
whenever we detect a face and the photo
upload car has face detection built in
so whenever we detect a face we can
increase number of tags in the photo
because people can tag people if there's
a face in the photo then we have the
main color of the image and we just
store that so of course we migrate that
now we'll do is we'll just add this new
URL for saving photos it's called Ajax
CF photo this is how we upload an image
and it goes to the view Ajax in photo so
back on views I'm just going to paste
this in here
Ajax a photo and it's a very simple one
it's just a regular edge axe request the
majority of the code the validation and
such goes in Ajax a photo in forms so to
upload a photo we have to have the URL
the base URL and the caption that's what
we stand in the post request and the URL
is the link with the effects added into
it the base URL is obviously the one
without any effect and the first thing
we do is we check the request came from
a logged in user then what we do is we
check the length of the caption and then
what we do is we make sure that the URL
of the image starts with upload cars CDN
because we don't want people to be able
to send fake requests to the server
putting in URLs that want to upload it
to upload car we do the same thing for
base URL as well now what we do is we
send a request after upload car to
retrieve the main colors out of the
image we already looked at this in the
second video then what we do is we get
the results and we pick one of the
colors at random you can see here's
where we do that we store it in this
main color variable and then we just
insert the photo into the database just
like we do when we create a user and we
see if the photo so if I save that and
then finally to upload photo will send
an ajax request off here's our post
request here's the data in the post
request and that's all we have to do we
don't have to do anything fancy with the
images because upload card takes care of
that for us i note our forms don't
forget we have to import our new model
which is called photo so now if we
refresh that we're going to try to
upload an image so here's the image
we're going to upload and what i'm going
to do is just drag this on here so
that's been uploaded to upload care when
i refresh the page you can see now
there's a new file that's been stored i
can add a caption to the photo I can
just say hello world I can add a filter
I could invert it I could blur it I
could flip it I'll just make it grey and
I could rotate it if I want
so rotated
down I'm going to click see a photo you
can see the page refresh nothing
happened because we're not loading
photos yet but if I go to sequel pro and
I refresh we have our new table called
photo and there is the image we just
uploaded to upload car you can see it's
already figured out the main photo the
caption the upload did the URL and the
base URL so base URL has no effect on
the regular URL that we should be users
is the URL with our effect which is
grand scale and our rotation of 180
degrees so that's it for this video
don't forget to Like comment favorite
and subscribe so in the next video we're
going to be doing our photo fade and
making the photos show up properly but
that's it for this video don't forget to
Like comment favorite and subscribe
don't forget to follow us on Facebook
Twitter and reddit also don't forget
there's a link to upload car in the
description so you can set up your free
account and get started straightaway
but that's it for this video I'll see
you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>