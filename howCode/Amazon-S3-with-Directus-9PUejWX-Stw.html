<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Amazon S3 with Directus | Coder Coacher - Coaching Coders</title><meta content="Amazon S3 with Directus - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Amazon S3 with Directus</b></h2><h5 class="post__date">2017-08-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9PUejWX-Stw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're gonna be learning
how to modify directors so that when we
upload files to direct us instead of
uploading them to our database server
it's gonna upload them to Amazon s3 this
way we have unlimited file storage and
we can also use Amazon CloudFront which
is Amazon's content delivery network to
make our photos load really quickly so
in our photos table we still have one
photo that was uploaded and it was
uploaded by Frances but if I was to
click on this image and click on the
eyeball you can see this photo is being
stored on our database server it's the
same server that's running direct us and
our database so inside of Amazon Web
Services what you want to do is you want
to create a new bucket because you
create a bucket and buckets or where you
store your files so click create bucket
and we have to give our bucket a name so
I'm gonna call it hi code to rack this
something like that and because I
already have a bucket with that name let
me create it so just call it how code
rack just one I have to pick the region
that I want it to be in but I'm just
going to leave it in Ireland click Next
click Next again and click Next again
now you just want to click create bucket
and you should be good to go so here's
my high co-directors bucket and here's
we're going to upload our files too so
before we can do that we have to go for
this github page fly system AWS s3
version 3 scroll down and here we just
want to we just want to copy this
command and we want to paste it in here
and just run now
so that should be it installed I already
had it installed which is why you didn't
see that all we have to do is modify our
directors configuration file so go to
API slash configuration dot PHP and open
that up and here you want to change your
storage adapter from local to s3 because
we're using Amazon s3 and here we want
to put in our key or secret key or
region version in our bucket name so to
do that what you want to do is you want
to go to Amazon's I am which is this
here and you can see I already have a
test user but I'm going to create a new
one I'll call it to actus and I'm going
to enable programmatic access click Next
I want to attach a policy and the policy
I want to attach is Amazon s3 full
access which will allow us to store
files and read files from Amazon s3
using directives so I click Next and I
click create user so now I have my
access key so I'm going to copy that and
in our configuration file under key I'm
just going to paste that in then we have
our secret case we want to copy that
piece that in there for region I created
the bucket in Ireland so the Amazon
region is a u West one as you can see a
full list of the regions here just by
googling err WS regions you can see EU
Ireland is EU west one for version I'm
gonna leave that empty just use the
default version for bucket we put in our
bucket name which is our code direct
Asst so next what we want to do is we
want to set the folder we're gonna
upload it to so that folder is gonna be
slash uploads so it's going to go to our
bucket it's gonna create a folder called
uploads and we're gonna store our files
in there and then for root URL and root
thumb URL we're gonna put in the address
of our bucket but we're gonna worry
about that in a minute so we're gonna
upload some files and then we're going
to modify this configuration file with
the address of our bucket when you
modify your configuration files react
just will log you out and I'm gonna
upload a new file so I'm gonna upload
this image and I'm gonna say it was
uploaded by Frances and I'm just gonna
see if that
so you can see that new image was
uploaded the reason we're not getting an
image here is because we haven't
modified our configuration file
completely yet because you can see we
still have modified the root URL and
read thumb URL and we're gonna do that
now when we know the URL of our bucket
so now if i refresh you can see the
bucket has the photo color uploads that
your actors created and it has our photo
we just uploaded and if I click on that
and I try to view it using the URL of
our bucket you can see we get access
tonight so the reason for that is
because by default all our files in s3
are private so to make them public what
we want to do is go to our bucket we
want to go to permissions and we want to
create a bucket policy and to create the
policy we want to click on policy
generator which will take us to here we
want to select s3 bucket policy for
principle we put in a star for actions
we want to say get object is the action
and or I was on resource name is up here
this is the Amazon resource name we want
to paste in it's just the name of our
bucket click Add statement click
generate policy copy that paste it in
and if you get an error it's just
because we have to put in a forward
slash here and a star save that and our
bucket policy has now been set so now
all of the files in our bucket should be
public so if I click on this image one
more time click on it's direct link you
can see our image loaded but you can
also see we got the URL of our bucket so
we copy this and I go to a configuration
file and I paste it in here go to slash
uploads do the same thing for wreathed
um URL save that so now because I
modified the configuration files
reactors would have logged me out you
can see the photo we just uploaded in
stored in Amazon s3 is now displayed but
our old photo isn't because that old
photo wasn't uploaded to Amazon s3 so if
I delete that photo and I reapplied it
you can see now we have our two photos I
don't I was to click on one of these
photos click the eyeball you can see
that photos being loaded from Amazon s3
so hopefully that explains how to use
multiple storage adapters with tractus
but that's it for this video don't
forget to Like comment favorite and
subscribe don't forget to follow us on
Facebook Twitter and rat it but that's
it for this video I'll see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>