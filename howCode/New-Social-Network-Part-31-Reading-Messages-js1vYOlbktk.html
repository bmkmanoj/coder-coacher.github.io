<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 31 - Reading Messages | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 31 - Reading Messages - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 31 - Reading Messages</b></h2><h5 class="post__date">2017-02-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/js1vYOlbktk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in the last video we left off being
able to San Matthews in this video we're
gonna learn how he received them so we
need to create a new page first so we go
to our text editor we want to create a
new page and here we have our new page
called my messages we're gonna copy the
old San Matthews page and just paste it
in here because it has some of the
things we already need such as being
able to check if the users logged in and
we're going to delete this PHP code and
we're gonna delete this form
so here we have our my messages page so
what we want to do is select all of the
masters from the database where the
receiver is the user who's logged in so
to do that what we're gonna do is create
some PHP code and we're gonna run a
query we're gonna say messages equals DB
query select all from messages were
receiver equals receiver and receiver is
going to be the user ID then in here
what we're gonna do is loop through all
the messages so we're gonna say F for H
messages has message now we can refer to
every message as message we can just
print our message and we just need to
change this to an array
I know will refresh and you can see we
have no messages the reason for that is
because if we go to the database the
receiver is three and the receiver is in
this case hi code if I go to user as you
can see that I'm we're logged in as
Frances so what we want to do is we want
to actually get where the sander is one
or the receiver is three because
whenever you send a message you wanted
to show up in your messages as well so
what we'll do is we'll select all four
messages where receiver equals receiver
or sander equals sander and Sandler is
going to be user ID as well
I know if we refresh we can see the
Masters either that I've sent all the
messages that I've received so what
we're going to do is print out every
message so we're gonna say echo messages
body like this and then we're gonna
print out a horizontal line underneath
it and what you're seeing is that your
message so those are two messages we're
gonna print out the message body then
we're gonna append on a string and we're
safe from I'm we're gonna print out the
user who sent the message which in this
case it's gonna be message and we're
gonna say message username and then what
we're gonna do is we're going to copy
this query based in here and we're gonna
change receiver to one once an or to one
just for this purpose and if we run that
we'll get exactly what we had before but
what we also want to do is select
messages all and then we want to select
users username from messages and users
and now if I run that we get everything
from the master's table that I never get
usernames from the users table then we
need to amend our where clause to say
well receiver equals one or sander
equals one and users dot ID equals
messages dot sander and I rerun that and
we can see the sander of each message
was Francis so now if I copy and paste
this query back and I just put on one
line and then we change it from Sandra
equals one and receiver equals 1 to
sander equals sander and receiver equals
receiver now if you run that we'll have
access to the username column and we run
this now now you can see it says hello
world from Francis so we want to make
these Matthews links so we're gonna pan
on another string and then here we're
gonna say a hits ref it's gonna point to
the current page which is my messages
it's a PHP question mark and we're gonna
say M ID for message ID equals and then
in here we're gonna pan on a new
variable message ID like that and then
obviously we want to close off our link
so now we have two lengths we also want
to build links from messages that are on
read so to do that what we want to do is
just copy this echo we want to say if
message read equals 0 then it's unread
so with a Q that otherwise we lack go it
again but we're going to make the first
a kobold so we're going to just change
this to strong and change that to strong
so now if we run this they've both been
bolded because they're both unread but
if I go into the table and I change the
second one to red which is a 1 now you
can see it's on bolded because it's been
read and what we'll do is just move this
link from there to after the bull tag so
that the only bet that's clickable is
the message title so what the minute
we're displaying the entire message on
the my messages page and what we want to
do is sort of display a title which is
gonna be a shortened version of that so
we're gonna just instead of displaying
the entire message we're gonna display
em and then up here what we'll do is
we'll say if s to your LAN of body
message it's greater than equal to 10
well actually say greater than 10 then
we'll say M is equal to the substring of
message body we're gonna get the first
tank characters and then what we're
gonna do is append on three dots
otherwise we're just say M equals
message so we'll run that and now you
can see hello world has just been shrunk
because it was more than 10 characters
and we have three dots now at the end of
it but hello wasn't affected because it
was less than 10 characters so now if we
click on this we want to be able to see
the entire message so what we'll do is
we'll go up here and we'll say if is sat
cat M ID then what we'll do is we'll run
a special query that says DB query
select all from messages for ID equals m
ID and then here we want to add in our
array you want to say m ID is equal to m
ID I'm gonna store the output of that
query in a matter variable called
message and we only are gonna have one
message returned which is gonna have an
ID of 0 and then what we'll do is we'll
a KO message body and then we'll act
with that otherwise we run the rest of
the page this way we only see my
messages if m ID isn't set in the
address bar so now if we run it we see
how to world but if we take that away we
see my messages and then what we'll do
is we'll just echo another header will
say a view message and then we'll give
them the option to reply and before we
do that we want to just put in HTML
special chars just to prevent cross-site
scripting and then we're going to do is
echo a horizontal line maybe I never
want to have a form we already have a
form on our sad message page so we could
just simply hop
piss this forum close the PHP tags open
them again and then in here we can just
paste in some HTML that goes to our sad
message page and replies to the user and
instead of using gap receiver will just
say message Sandler and let's run this
and see what happens so now we can reply
we can say thanks for your message this
message came from a user with an ID of
one so now if I stand up it says message
sample to talk us to this and message
page if I go back to my messages there
is the message I just sent but we do
have a slight bug Sweeden effects up so
the reason for that error is because the
sander and the receiver were the same so
what we could do is when we echo at the
sander we could activate some random ID
variable and we could say if message
sander equals user ID then we'll say ID
equals message receiver else ID equals
message center this way our message
receiver and sander can't be this in
person so if we just for the sake of the
video we'll just change the receiver and
we'll run this we'll say hello again
look likes and message it says message
sent we go to my messages and now we can
see is the new message hello again
so instead of thanks from we could
change that to sent by and then finally
when we view a message what we want to
do is do a query that says DB query
update messages sat/rad equal to 1 or
we're ID equals m ID and then we'll just
run the array here
set the red to one and finally when
we're viewing a message we're checking
where the idea of the message is the
idea in the address bar but what you
also want to do is check where the
receiver equals receiver or Sander
equals center because we only want
certain people to be able to read the
messages so here we just want to put in
receiver and that's gonna be user ID and
then we want to put in sander and that's
gonna be used ready so we just need to
put in back text here for some reasons
so we just save that and we refresh and
we click on one of these for example
hello and we go back you can see the
arrows gone but if we go back now it's
been red because it's no longer bold
later on in the series we might end up
doing something more advanced like for
example adding notifications to the
messaging feature or showing messages
and chains depending on the user ID of
the person who sent them or things like
that but we've kept things quite simple
in this video so that's it for this
video don't forget to Like comment
favorite and subscribe don't forget to
follow us on Facebook Twitter and rat it
but that's it for this video and I'll
see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>