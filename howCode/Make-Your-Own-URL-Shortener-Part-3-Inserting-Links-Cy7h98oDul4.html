<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make Your Own URL Shortener - Part 3 - Inserting Links | Coder Coacher - Coaching Coders</title><meta content="Make Your Own URL Shortener - Part 3 - Inserting Links - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make Your Own URL Shortener - Part 3 - Inserting Links</b></h2><h5 class="post__date">2015-05-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Cy7h98oDul4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this part of the series we're
going to actually be doing some of the
code we need to actually shorten our
links so the first thing we need to do
is whenever the user click shortened
link we need to sound that to our
database so the way we're going to do
that is we're just going to say if it's
sad post shorten now we're going to just
put a comment here and insert link into
our database so do that I want to do is
we're going to use MySQL IE prepared
statements so let's create a variable
called DB and we'll set it equal to MU
mysqli so we're creating a new instance
of the MySQL like class and we're going
to pass it some parameters so what's the
local host is the first parameter that's
the host of our database relative to our
server and some snow on the same server
we can just use localhost tell me what
our username we can get that from cpanel
we just go to mysql databases
we scroll down you can see the database
is fastest one on a score min and the
user is fastest 100 scored high code so
if we just go up here so we're going to
put our username intrinsic Francis one
underscore highcode the username then
we're going to put in a password on we
pasted it into this file we piss it out
in there and finally we're going to put
in our database name so that is a
Francis one underscore min so let's just
upload this on so you may get an error
so go to our page again we're going to
refresh we don't want to resend it it
makes no difference at this point we'll
just refresh and you can see we have no
error if there was an error since this
is a production environment we would
just see a white screen but because
there's no error and then everything's
working
so now you have our instance of all my
sqlite class we're going to prepare a
mysql a statement so the way we do that
as we say and we could have variable to
hold the ipod of all this so we're just
going to say call that result negative
screen from night then what we'll do is
we'll say a result is equal to D be on
to access a member of a class we use the
arrow operator in PHP so we're using
we're going to the DB class and we're
accessing a function called prepare and
here what we're doing is we're passing
the MySQL I query so here we're going to
say oops insert into and our table is
called links will set in turn into links
values how many of three columns in our
database as you can see here we have
three we have ID you're on title so
let's put ID URL title so for ID we can
either black because it's an auto
incremented value and for your last one
we're going to pass data to so we're
just going to put a question mark here
so notice there's no single quotes
around it it's just a question mark that
would make more sense a moment and for
the actual link we're just going to put
tastin 49 okay so what we can do now is
we can delete this results variable from
here we can just assign it directly here
i'm going to do here is we're going to
say d be buying the prom so this is a
function called buying / arm and what it
does is it binds parameters so this one
looks pretty weird if you are used to
mysql non prepared statements so the
reason that's unsecured is because a
user malicious user can insert code into
your mysql query that can give them
access to your database that's if you
don't escape things properly and
escaping things is can be bad because
it could end up with your data getting
all messed up and things so the best
we're solution to this is to use
proposed statements the reason prepared
statements more secure than non prepared
statements is because they send the
query to the material server in pieces
so the first thing they send is this
query but they fill it but every time we
want to put a variable in we put in
question marks so the question mark is
sort of a placeholder for the variable
on what happens when this gets sent to
the server is it expects the parameters
so we need to send parameters but since
we're sending them separately we don't
need to escape them because this string
and the parameters never actually mix
the never interact with each other so
the an attacker never has an opportunity
to insert malicious code into your MySQL
query so as I said the question mark is
a placeholder for a variable or
parameter so this is a placeholder we
can't actually do anything without being
told what the placeholder stands for so
that's what the buying promotion does it
binds the parameters to the query so any
word sees a question mark it will
replace that with an everybody tala to
in the bind prompt function so this
function takes two parameters it takes
the first parameter towels what type of
parameter is so just say that we're
sending a string we just put an ass in
here and then we put a comma and then
too we pass the actual variable want to
send so this case it's post on the post
I want to get URL to shorten
and finally all we have to do is say DB
execute this is it so because we're
breaking the query up into two separate
pieces whenever we execute the query it
doesn't matter what the user puts in
here whether it's malicious or not they
won't be able to interact with this
actual query above here so they will be
able to insert malicious code into our
query and Massimo database so now we're
going to do to see if that work is going
to say echo don't
so let's refresh the page and let's put
in a link so i'll say hi gorg
so we got a white screen that means we
did something wrong let's just check did
I get inserted into the database so it
didn't there's zero rows returned the
reason for the white screen was actually
because I we need to just change this to
result so basically what that means was
we were just we were trying to access DB
by and prom when in reality it's
actually kind of like accessing DB per
park and then setting this find prom and
then putting the problems on so we can
actually chain them onto each other but
we're just leaving them on one line for
the moment so let's just run this again
that's just hope it works this time so
let's refresh put in hi co.org
it says Dogma got no errors we click
browse and you can see I returned one
row
so that's it for this video don't
fertilize common favor and subscribe and
we'll see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>