<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 27 - Receiving Notifications | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 27 - Receiving Notifications - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 27 - Receiving Notifications</b></h2><h5 class="post__date">2017-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/u4hujVEVupo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're gonna be learning
how to display notifications properly
because at the minute we can receive
them but we can't actually display them
properly because a notification with the
type of one doesn't mean anything to an
end-user a receiver of one means nothing
and a sander of one also means nothing
so let's get started the first thing
we're gonna do is we'll actually a quite
a header and we'll send notifications so
what we're gonna do is we're gonna say
if and type equals one that means it's
an OP mansion so we're gonna say echo
out mansion we refresh you can see it
says op mansion so we're gonna set
something more descriptive so we have
the user ID and we have the receiver ID
so what we want to do is get the Sanders
username so we're gonna create a query
we're gonna say Sander name equals DB
query select user name from users were
ID equals and the ID is gonna be equal
to sander ID and we're gonna say it's
Android e in the array comes from the
end variable and we want to get the
sander and then of course we can have
what item returns so when I access the
zeroth item that array and we want to
get the username column from that item
so now we've the sander name we could
set something more descriptive we could
say echo is sander Neum mentioned you in
a post so if we refresh we have an error
so the reason for that error is just
because we call it sander ID and we
called it sander in our array so we'll
just change that and refresh that says
Francis mentioned you in a post or put a
hitch or line there and if I post
another one for example I could say that
Francis again i refresh the
notifications and now we can see every
mansion twice and two posts but we can't
actually tell which post it was because
their notifications table isn't storing
that so what we're gonna do is we're
gonna go to our table we're gonna create
a new row called extra it's gonna be
taxed because we could create a row
called post ID but that would made all
notifications would have to be by posts
but we could create other notifications
for other things this way because we
could store something generic like JSON
for example and that would mean all of
our notifications can fit in this table
and follow that same structure well that
actually be null if it wants to be no
because not every notification might
have extra data associated with it so
what we'll do back in our code is
instead of
saying the notification equals one and
what we'll do is store an array and the
array the first item in the array is
going to be the tape and that's going to
be equal to one the next one is going to
be extra which is going to be extra and
it's going to be equal to a string which
is JSON so the JSON string and we'll use
single quotes actually the JSON string
is gonna say a post-party and that's
going to be equal to text because we
have exploded text we want to implode
text so we'll say implode text on spaces
so before we can run it we have to
scroll up and we have to modify some
stuff so getting the ID from the K
should still work but getting type won't
work so we want to say n and we want to
say type to get the type and then we
want to append on extras as well so
we'll say extra and then because we're
accessing an associative array rather
than just throwing the value we have to
say extra and then we want to just
append on the end and then the extra
item in that associative array so we'll
copy and paste this and just paste it
below because we want to use it for our
posting images as well we'll run this
we'll say hello world
and we actually want to post our to
Francis look like post now if we go to
content now you can see we have this
JSON string and it says app Francis
world because that's the code that's the
content of the post so what we want to
do with extras I on the notify page is
when I say it this person mentions you
in a post
what we could do now is display that
post so what we'll do is with a quite
some pre tags and in here we'll print
our the end variable will refresh and
there we can see the variable and this
last one has an extra field so what
we'll do is echo and when we echo and we
want to get the extra field
so we'll say extra when refresh and
there we can see there's the extra field
and what we want to do is JSON decode it
so we'll say JSON decode and extra and
we want to print our that because that
will return an array so there is our
text but the reason it didn't work is
because you can see this isn't a proper
string so what we want to do is go back
to our posting page and we want to make
sure post body is a string here we want
to also use HTML entities to make sure
that if there's a double if there's any
double quotes in the post
they got escaped so that they don't mess
with the JSON so we'll try this again
we click post we go back to notify and
there we can see there was our JSON
string and there's valid JSON this time
so now what I'm going to do is I'm going
to print our JSON decode so there we can
see there's are decoded JSON so we can
copy this variable we can say extra
equals our decoded string and then we
can say this Center mentions you in a
post and then we can show them the post
for example we could say the extra post
party and now you can see there is the
post and here we're getting errors
because they don't have any extra
variable so what we could do is actually
up here if and extra equals nothing then
we'll print something out otherwise
we'll print this out so what we could do
is just have two versions and then print
this one right up here get rid of the
variable extra this one would only run
if the notification was something
different so we could say something like
you got a notification in reality they
should never actually see this because
the only reason we would ever see this
code is because when we set it up we
didn't actually include an extra but
every time someone signs a post the post
body will be stored in action no matter
what so the user should never actually
see this but we're just gonna put it in
to make sure we don't get any errors and
if we refresh there just says you have a
notification and we're getting this
error just because on this one our JSON
was invalid so I'm just gonna change it
to make it valid JSON and there we can
see it everything worked so that's it
for this video don't forget to Like
comment favorite and subscribe don't
forget to follow us on Facebook Twitter
and reddit
and I'll see you next time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>