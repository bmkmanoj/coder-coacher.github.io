<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make a Social Network from Scratch: Part 18 - User Profile Pictures + Posting on Profiles | Coder Coacher - Coaching Coders</title><meta content="How to Make a Social Network from Scratch: Part 18 - User Profile Pictures + Posting on Profiles - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make a Social Network from Scratch: Part 18 - User Profile Pictures + Posting on Profiles</b></h2><h5 class="post__date">2012-08-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/svLU2skgeNw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so hi and welcome to this video so
today of what we're gonna be doing is
adding a user adding the option for a
person to upload a profile photo to the
social network and we'll be sexing are
finishing the posts thing is this
doesn't work properly currently so we've
got a lot to do so counting I won't be
able to explain it all as thoroughly as
normal but well it still thinks I'll
still get most looking it done properly
okay so I didn't see first I've created
a photo and it's just a person's head in
the body and it's in my image folder and
it's called default pic so don't worry
if you don't have that well I've seen
without of this what it will be in the
source code in the description so you
can just download it from there okay so
what this default pic is it's the
default pic so it's going to show up
here and it is I think 200 wide and 250
I which is the dimensions of this so
let's go into the crunch settings page
scroll down I'm done I'm gonna create
another hitchhike shall we go back to it
number 2 HR tagging in between them you
kind of sorry messing up the buttons
today not being able to type very well
ok so what I'm gonna write here is
upload your profile photo so we're just
creating a Fulham except it's slightly
different to usual so I so the action is
the current setting Oh with okay I'm
sorry I just remembered there isn't
actually in action just form
the method for the form is still post
user settings more settings data way and
finally the tank type and see typ
and then we say multi-part you know it's
multi-part phone data yeah we're gonna
draw with me today okay so the next
thing we add is an input type of file
the name is important but once as usual
you can call it whatever you like so go
on profile pic that's it for the input
field
okay um the next thing you have to do is
and just just gonna have another input
and then this one is a button so submit
its name and I'm it doesn't really
matter but sort of does the value okay
so now we have a form on our card
settings page upload your profile photo
so just to make it look a bit nicer I'm
gonna well for now at the moment it's
the default image before anyone uploads
profile photo but we'll change it so it
shows whatever which assualt shows the
person's profile photo and once they've
uploaded it or just shows the default
one like that's not so that's just the
default photo and go into profile or we
can use the default photo here so we'll
profile light and that's what it looks
like by default okay
and as you can see if I just try it up
with a photo don't do anything because
they have until it okay so what we're
going to do its profile we're gonna go
under here it says do nothing from the
last thing we done on this page I'm just
gonna write yeah okay so first thing
we're gonna say is if is set so like if
someone's actually tried to upload a
photo we say if so if they've set files
and this is where I'm at the name is
important because as you can see I
called that profile pic and that's both
avec you have to match and what we do
not a lot for this so it is it is
important that you pick a name you're
gonna remember so then we we do another
if statement other say if is set files
once again whoops my mistake it's not
actually if it's set files so it's not
but it is another statement and what
we're going to say is file
square brackets in here where just comes
at profile pic and then we come more
square brackets let me say type A equals
equals equals take two equals and then
image slash Ampeg so this is just a bit
of security to check whether it is
actually what so we can a large us a lot
of different types of files not in case
we get that error we normally get a not
sign there so not checks for if it's a
jpg and we also want it to check we
wanted to check for PNG Xin dot gif or
gif so what I'm going to do is whoops so
I'm what I'm gonna say is or which is pH
in PHP it's these two vertical lines I
mean just say again at symbol dollar
sign underscore files that profile and
two more square brackets and then type
equals equals image slash PNG and then
we can say get once more for the cops
gif files just copy this I'm actually
I think gif okay and then we can say
almost forgot we're gonna need two more
open parentheses or whatever here and
then we can say here oops we can sound
two more parentheses files this time
we're gonna still write profile back in
here but here on the right size and when
we say is less than one what 1:04 it
five seven six
yeah five seven six which equals one
megabyte so that's one zero four eight
five seven six is one megabyte in bite
okay so next what we're gonna come up
stops I almost forgot we need to put
those parentheses in just check yeah
that looks alright so it was just you
almost forgot you need to open these
disease or curly brackets we need to say
we need to have condition there us we're
gonna get an error so it doesn't look
like
well the hour won't show up yet forget
one okay we've got no errors that's good
okay so in here what we're gonna say is
well actually first let's go out of here
let's go into um let's create a new
folder and this folder is gonna be
called user data and inside here we're
gonna create one more new folder and
it's gonna call profile X and this is
the folder where all the profile images
for the users will be stored but to make
it harder for people to stick up well to
make it harder for people to just go to
the links directly and like see
everyone's profile pictures in the
folder what I'm gonna do is I'm gonna
create I'm gonna make it create around
and folder it well it's gonna every time
someone uploads a photo was gonna create
a folder with a ramen 15 character mium
and then that folders gonna have their
profile image so just makes it harder
for people to yes steal other people's
images okay so create a variable called
chars and we're just gonna put the hold
off of it in here so there's the
alphabet and now we've got the uppercase
okay
and we'll just put some numbers in so
could say 0 1 2 3 5 6 7 8 9 okay so
that's all the characters are folder
names could possibly be called and I'm
going to create another variable called
round around their name around directory
name and what this is gonna say is
Str shuffle and then we say chars which
is just gonna rearrange all these
characters so what we kill again is we
say sub STR for substring and the week
it says 0 to 15 so I picked an random
well let's pick the first 15 characters
of this string week of the value of the
string in the variable chars
so now we actually need to make it
random so we just say know that it don't
mind just ignore that that I just
remembered the STR shuffle is what makes
it round so ever without the answer I
shuffle it wouldn't be wrong and it will
just be displaying this the first 15
characters of this strength so we can
just say make chair for make directory
and we just say the the directory is
gonna be called user data for slash
profile X which is why we needed to
create these two folders and just say
round there you need okay so if I load
this okay what the outcomes in 105 okay
that's what it is I just left to calm I
know yeah I did so I just left the
comment after this first condition
they're part of it okay
our prom or even so if I put a photo me
hopefully this yes
so when I we have a folder that's with
it that's got a randomly generated name
inside the folder user data profile pics
Scot randomly-generated me in its 15
characters long and this is where
eventually we will upload the profile
image okay so so I'm under here we can
just do more air until Samara jacking
so we could say five exists then we
could yeah what we also have to specify
more the file we're double-checking
exists is actually located proof of
access round the name forward slash and
now we just append the file name oops
and don't forget this hot sign isn't
required it's just because I seem to get
hours when I don't use it I should say
we have all these big long sort of
strings we keep or whenever we these big
long lines of code that we could
basically paste into variables well you
can do that but I'm going to do it at
the moment so once again we put the
parameter profile pic then we open more
wire brackets and then we use the
parameter me and so a little get the
name of the image and then we just say
what we want it to say so we could just
attack oh don't forget the odd sign
profile pic okay so profile pic name dot
was it that these are these two
we shouldn't get this error but if we do
that's what we will be given that's what
it'll say and just things you don't know
the dot and then the and an act just a
quick thing to help so in an acro
statement normally you do that then you
just put what you want to say in here
well you can also append two things
together which is what we're doing here
so it means I add them together so
that's the first part of the echo
statement and that's the second part so
as you probably already saw there's a to
append something in an acro statement -
I thought you just put a dot and then
either two double quotes or just two
single quotes so that's why the dots
there okay so no we say else and then we
continue on with actually upload well I
probably didn't explain this very well
but when we actually upload default pic
it actually is uploaded it's uploading
to the website but we just can't see it
because it's in a temporary directory so
we actually do have all these files
uploaded right each time I upload the
picture it does work but we can't see it
until we move it off its temporary
directory into where the folder we want
so we're gonna move it now but when you
hear me saying move our only upload a
file in but when you see me saying our
hammy thing we're going to upload the
file into one of these folders we aren't
actually uploading it straight into all
these folders we upload it into a
temporary directory and from the
temporary directory we move them to
these randomly named folders and that's
actually works so we said that's a
and once again we give the profile APEC
barometer and he said TMP underscore
name which is the temporary name the PHP
gives it whenever it uploads it to the
website and then we said comma and this
is the photo we want to move it into so
we said profile X user data for sauce
profile
oh we just say user data for sauce
profile pics forward slash around
underscored dare name um we all once
again we just append name it's a file
well we also need an afford slash so it
goes in the directory so we just depends
once again profile okay um we just give
it me because we're not getting it we're
not reading it were just that he needs
to keep the name it actually odd okay so
we could now just echo uploaded and
stored in just append so I'll should now
aqua or the directory of the image when
I when we upload it so I'll just
uploaded different one this time this
time to PNG so you can see that okay
what's this
okay so says we have an undefined
action oh so they spelled it wrong
let's move uploaded file Edie I forgot
well I didn't forget I just mistyped it
so this time we're doing a PNG uploaded
and stored in hmmm let me just see that
should still have actually uploaded
actually I just didn't give it the right
directory so yes it did upload it and
store it here so we can okay so here we
can you'll say user data forward slash
profile pics forward slash and then not
oh it around there
minion four slots so now if we upload it
again it will talent it'll give us the
exact directory that it's stored in and
this time it's a JPEG we're putting yes
uploaded and stored in slash user Nina
slash profile Vic's are big long I
randomly generated a string and then
slash default pic so if I go to that no
we have the picture so it is uploaded
and it has been moved to the correct
directory so the next thing we need to
do is actually I should have told you
this first um so in our users table we
need out we need we need add a new row
called profile pic and I'm not going to
show you it's simple it's just a new row
I gave mine is just attack it's just F
type text there's no limit on it because
you don't know how long someone's name
of their image is gonna be so I just
give it a type text so not just create
that row and you ready
move on so now we know that's been
uploaded we can just remove that because
we know it works
I'm here we can we need to create a
MySQL query which is just going to
update that new row we just created so
what I'm gonna call this query is
profile like query that's my skew ah
great
so this is just simple it's a size of
the user's profile pic which is the row
but users is the table as I mentioned
load times
I'm profile pic is a row you just
created in your database and we need a
separate I'll pick equal to um what the
profile pic is gonna equal is the random
directory we just created /um create a
variable called profile pic you need and
I will create that variable a second or
user name equals that's just user user
is the variables session is the just get
this
okay so user is this variable in your
session user login which is just the
username of my logged in so we create a
new variable called whoops I'll I think
profile a name which equals well you can
probably work this one profile pic which
is just the name we took from the image
okay so now if we on we can also just
say that should we park noise well
before we do that we can just say header
location or we can just I can't settings
dot PHP she let the person see their
profile pic change well they won't
currently because haven't told it to yet
but they will
so this time I will upload the logo for
five friends loaded go back to their
folders with a new folder and it's the
logo for five friends and if we go to
our database we refresh the page so it
load no ok so now we start image we just
talk ok so it's worked so we do have
that in the database not which is good
because that means now that person's
profile photo has actually uploaded and
it's associated with their account so
the next thing we need to do is actually
show it which is a lot easier so let's
go away up to the top well the top of
the profile image upload script
and we will create another query I could
just comment it and say we can't spell
today either right check whether the
users so this will check whether to
display the default photo in the photos
in the image slash default pic dot JPEG
phone one enough in the image folder
though when I created or whether to show
the one they upload themselves so great
and your query called Shaq pic she's
gonna equal MySQL whoops
query this time we're selecting the row
profile pic users that's pretty standard
query we've been to them a lot so now
the next thing we do is create variable
with cat pick row and it equals mysql
fetch a so spell a sock and then it's
just gonna check yeah it's gonna fetch
the data from the query so we just
bought the variable check back in here
and we create another variable and calls
profile take DV which is just the
variable and it's just a very like it's
just one calling it's because it's
checked it's so I can get it from the
database so close
hey bro-bro phobic so when I whatever is
in the profile Peck row in the in our
database so whatever this is is going to
be placed in the variable profile Peck
TV normally just makes simple if
statement says F like DV equals empty
which is m1 these are blank
well there's nothing in between the
things if it's empty then we're just
gonna display the default one but if
there is taxed in it we're gonna display
that there are actual profile image that
they uploaded themselves so we're just
gonna say profile pic which is a
variable recruiting obviously I'm
arresting slash image slash t fault doc
jpg which is we go to tear that's the
default image we all I created earlier
so I'm don't we just need to see it
otherwise profile pic equals user data
for slash profile so I am and then we
just depend the variable profile pic
will onto the ended up so then we just
come done alright
or else we can just say echo in valid
file we're gonna say your file must be
no no no it just set your image must be
no larger on MV and it must be either a
dot jpg dot jpg PNG or gif and then
that's basically it so we can just check
this out now okay I'm declare undefined
variable so
oh yeah I should put in the wrong car
let's go DB so and we actually I
have a better way to check whether it
actually worked
so in here we told it um as the image
source so just say yeah that go profile
pic and we get a checker out here to
check whether they have a photo or not
so if they don't yeah since we do have a
photo we are being negative but the
photo I uploaded is transparent with the
righteous white text and a strong spot
then I can't see it so I'll just upload
them alone just to prove it works search
icon
so we'll upload this and most urgently
now we have the search icon here and if
we go to prove oh yeah so I just need to
go to our profile page yeah we need to
include the check we've gone up here
this one here so we just copy this then
we go to profile and we just paste it in
here okay
so when you change this variable to use
your name and that's it
so now we just go down down here we just
say the same as we did last time echo
profile click refresh now we have that
weird search icon well it's not weird it
looks weird because it's
like that so we just no no we won't see
that okay so we can just upload this
photo I used earlier and and now it
looks like we have the default photo but
we actually don't I thought because of
what I can prove it if we go into these
folders one of these is the ones we
upload is the one we upload I can prove
it by dragging it up to the address bar
release any management say instead of it
being saved in an image slash default
pic it's actually saved in in the
directory it would be if we upload it so
that is definitely an uploaded image
okay so not only the profile photo in
works we need to make the post form work
which is quite simple Thanks so we just
go out of here and we find the file sad
post op PHP we just copy this code copy
it and we can just piece this on our
page so here we go we just be sitting
here so outed by user that doesn't need
to change that is the variable of
harbor's logged in so that well works
fine regardless of what page wrong this
one we need to change to user name so
it's post
yeah posted by survivors logged in so
whoever posts it is obviously the person
that is logged in and the username
variable this was posted to and we went
up here we can see these are meaning
equals mysql risk really skip string cat
you knew is the value of what I was
typed in here so
and whatever is typed in after you
equals is the variable of you which is
to average profile you want to send it
to right okay that's fine
that's just to fix that undefined index
post simple you just have to put the out
sign in front of it and yeah should yet
all right okay so it still isn't going
to work correctly because in other words
it it's still trying to use the
JavaScript method we used like our
function you created on you so if we go
on to that are we gonna stop create a
form the form action is obviously a user
which is the address which is whoever's
Pro following your own and we can just
say slash formed and it okay and the
method is going to be post so that
should be it
so just reload refresh the profile page
so this if you can see this it's walking
rightly so if I just go over and click
post
I just go up here I'll just pause the
video here and I'll find what the
problem with okay so I find the problem
and it's quite simple to fix so what the
problem was was this code this code
needs to move above the profile picture
code so um should be it sorted night and
we just come on sit over and once you
got to say this is a test post
I know we get it and it says it's
supposed to by cinema which is whoever
which is the username I'm logged in with
and it also works on other peoples pages
so if I was to type in Frances Frances
is an actual person even though I have
nothing here because we chose as you can
see our new if I just type in my
username building just we redirected to
at the home page
so I go to Frances and I type in I going
I can post things on this page or my
page there's no boom icons okay so
thanks for watching don't forget to
comment rate and subscribe and in the
next video I'm not quite sure but will
probably be allowing users to comment or
something like that because I know it
was asked by me a long time ago
so I'm asked by me asked and someone
asked me if I would do it so I don't
forget to come rate and subscribe
yeah and if you tell anyone if you know
anyone who might be interested don't
forget to please tell them because any
subscriber of your house
so uh I mean they're all all these
videos are free so it doesn't cost
anything but whatever it's up to you
I just speaking out of any extra support
or whatever and he help I can get
wants publicity or whatever um don't
forget to comment subscribe as they've
said like three times me and if you have
a question or whatever just comment or
send me message because I look at the
ball and I call I answer any of them
that are I answer any of them really so
thanks and bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>