<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>New Social Network - Part 40 - Autocomplete API | Coder Coacher - Coaching Coders</title><meta content="New Social Network - Part 40 - Autocomplete API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>New Social Network - Part 40 - Autocomplete API</b></h2><h5 class="post__date">2017-05-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QaEIXYqKLtI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this video we're going to be
working on our search box specifically
we're going to be creating an
autocomplete feature so that whenever so
many types in the name of a post a list
of available posts shows up underneath
so to be able to do this the first thing
we need to do is we need to modify our
API one more time because if we go to
the old index page you can see we have
this search box and if I was to type in
hello and search that you can see it
returns a list of all of our posts with
the word hello in it but it returns it
as a PHP array and what we want to do is
return it as JSON so the back on the
index page whenever we type the name of
posts into the search box
it sends an adjunct request to the API
and the API will return some JSON and
then we can use JavaScript on our index
page to format the JSON to display it
underneath this search box so the first
thing we have to do is we have to go to
our API so the first thing we're going
to do is we're going to create a new URL
so if I copy this and then say else and
paste it in there we're going to create
a URL called search so we send a get
request to FBI so search we want to
search our database and since we've
already implemented that on our index
page what we're going to do is click on
index to PHP and we can see if it said
search box this is our search code what
we're going to do is we're just going to
copy this I'm back on our API we're just
going to paste this in so the first
thing I'm going to do is just delete
this query to do with our users table
we're going to delete that and here we
have our two search variable we're going
to change that from post search box to
get query that where the two starts
variable is coming from the URL when we
type in question mark query equals and
in this case the word hello will be
inserted into that function next what
we're going to do is we're going to go
down here and change this from post
search box to get query as well
and down here when we actually run the
query we're going to change it to DB
query because we're using our new DB
class now if I was to run this you can
see we get all of our posts printed out
with the word hello in them if I change
if I change this to world we only get
posts with the word world in them and if
I change this to dot PHP you can see
those opposed to a PHP and I hit enter
we only get posts with the word PHP in
it so we're going to do is we're just
going to say echo JSON encode posts to
convert our posts array to a string of
JSON and now you can see here's our JSON
if I was to right-click and view the
page source you can see here is all of
our JSON and if I was to go above here
and echo some preach
eggs so you can see all of our JSON got
returned but you can see we have these
weird zeros elements in each of the JSON
objects so to fix that all we need to do
is go into our database class and then
here when we wrote our fetch all we want
to say fetch all PDO fetch Assoc which
stands for fetch associative which is a
gg-ghost means we're only going to get
the column names and the column values
so if i refresh the page you can see we
only got the actual column name from the
table that we selected which in this
case was body we can handle world and we
got a printed out like that if I wanted
to select more what I could do is I
could select posts body I would select
posts top posted at refresh and now you
can see they get printed out and I can
also get the user who posted it I could
say users user name and then I could run
a simple join here where I said where
users dot ID equals posts dot user
underscore ID and then I could put an
ant here just to append that on so now I
will have join those two tables together
and before I run that I also have to
select from the users table and now you
can see we know who posted the post we
know why that was posted we know the
actual post itself and if I delete the
query from scroll down you can see we
have posts from other users and then
finally what we can do is we can just
put a limit on the number of posts that
are returned I just come in here and I
said limit and I could put in a limit of
ten for example and I if you look at
this scroll bar and i refresh the scroll
bar has just shrunk because the number
of rows returned is limited to ten
because if you're typing into this
search box you're not going to want to
search box equals all the way down to
the bottom of the page to appear you
want the search box to be limited and
then to get more specific as the more
you type so that's what this allows us
to do by limiting it to only ten rows
returned and in the next video what
we're going to be doing is we're going
to be using jQuery and Ajax so that
whenever we type into this search box it
queries our API and it returns us all of
the posts that are relevant to our
search query below to make it easier
when we're searching for a particular
post so that's it for this video don't
forget to Like comment favorite and
subscribe don't forget to follow us on
Facebook Twitter and reddit if you have
any questions don't forget to email me
at francis at haiku org but that's it
for this video and I'll see you next
time
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>