<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Make your Own VM in Python: Part 3 - VM Instructions | Coder Coacher - Coaching Coders</title><meta content="Make your Own VM in Python: Part 3 - VM Instructions - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/howCode/">howCode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Make your Own VM in Python: Part 3 - VM Instructions</b></h2><h5 class="post__date">2014-04-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/wdNKKIqIMBQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so hi and welcome to this video so what
we're gonna be doing today is we're
going to be creating our virtual machine
we'll be doing some of it because it's a
complicated process so let's get started
what we're gonna do now is we're going
to get rid of the print hello world and
we're going to actually start or start
our virtual machine so what I'm gonna
say is I'm gonna create a function
called run program and that's going to
obviously you've got our program and
what I should have said already Ron I
feel what our virtual machine is going
to do is it's going to do simple mouths
so we're going to say like add two
numbers together multiply two numbers
something like that so what I'm gonna
say run program and I'm gonna pass it
the Arg V 1 which means the first
command-line arguments ORV means to mine
line arguments are giving 1 means the
first command line argument so as you
see now if I actually just comment that
I covered that right and I just print
the Pokemon night arguments and I run it
again you'd see the first command line
argument is actually the name of the
file but if I put in anything after that
you'd see we have two command line
arguments no and this is in actually a
list and by using me warm we're actually
access and we second an item of the list
so if I print this so this is sort of
like this looks like the first argument
but it's actually the filename is the
first argument and by saying we want to
print the first argument arming the
second argument by putting a 1 in there
it looks like we want to put the first
argument but since computers come from 0
instead of coming from 1 and this is
actually the second argument we're gonna
print which means we're gonna print when
I was off to the file so if I put in
anything I just say Francis as the
command-line argument after the filename
as you can see it just prints Francis so
what we're going to do is we're going to
create the run function or the run
program a function though so we're say
def run program and then what we're
gonna do is we're going to the run
program function is going to actually
hewed two more functions first one is
going to be and
what's the program the second one is
going to be executed so when a comet Act
we're gonna carve a comment I'd execute
program for now because we don't need
that at the moment I want to go off the
air I'm gonna create low in the load
program function so let me now I'm just
gonna put print and nothing in here for
the moment so what I've just done is
I've created a file called hello dot VN
this the file extension is our retiree
meaning you can call it whatever you
want I just chose dot VM because we're
creating a virtual machine I'm what I'm
going to do is I'm going to put in some
code to actually make our virtual
machine work I mean to some code that I
Russia she's been wrong so the way I'm
going to do it as I'm going to create
you create instructions so the first
instruction is gonna be zero zero zero
zero zero zero zero zero and what that
instruction is going to do is it's going
to say and of the instruction the next
instruction is going to be zero zero
zero one actually we're going to use two
digits but I will tell you more about
that later actually zero one is going to
be end of instruction this is going to
be end of the program all together on
the program C zero zero it's gonna end
it completely so 0 2 is going to be the
push instructions because what we're
going to creating is a stack based
virtual machine so how a stock based
virtual machine works is basically
whenever I push a number on the stack
basically what I'm doing is I'm saying
when I said pushed 10 for example what
I'm gonna do is it put Stan on the top
of the stack so just imagine this is the
stack then whenever I push another
number on the top of the stack it pushes
10 down and it pushes the next number up
so set up at 5 on the top of the stack
not so our stock has two items and five
is on top so then if I had a function
called print if I use the print function
it would print the top of the stack
which in this case is 5 so would print
the number 5 there's other there's other
commands like pop which is
three which is what we took we remove
the fur the top item of the stocks when
we just use the coupon command
it's going to remove the number five and
then that means 10 it's going to be the
top of the stack so ad what I'm gonna do
here isn't going to get a fourth one
which is going to be print the that's a
fifth one is going to be ad the second
one is going to be subtract
well leave it like that for now we'll
add more afterwards so as you can see
that's what our instructions mean so
what I'm going to do now is I'm going to
create a simple program out of it using
our own instructions so the first
instruction has to be pushed because the
first thing we want to do is you want to
push a number on at the top of the stack
if we don't push a number on at the top
of the stack we can't do anything
because all the virtual machine does is
it manipulates things on the stack and
at the moment there's nothing on the
stack because we haven't told it to push
anything so if I use them as if I wrote
0 2 then I put a number of segments in
the tab actually to keep make things
easier understand what I'm going to do
is I'm going to use hexadecimal notation
basically to differentiate between
instructions and numbers I mean the
instructions and things like numbers and
letters or whatever so as you can see
the instructions while I'm sorry to
actually see what the instructions are
gonna be in base 10 and then the
everything else will be in base 16 or
hexadecimal so if I was going to push
the number 10 on the stack I would say 0
0 0 a and the 0 0 0 0 is actually not
necessary but I'm gonna use 4 digits to
represent anything that isn't an
instruction so instructions can be made
up of two digits and everything else is
gonna be made up of four digits which is
why there's the three unnecessary zeros
at the front so 0 0 0 a is actually 10
and acted a square will just be a 16 so
the way X with a hexadecimal works is 1
2 3 4 5 6 7 9 and this actually is 0 at
the top so these are all fine these are
all exactly the same as they are in
decimal or base 10 but whatever we get
past 9 and that's not what we do is we
just move on to 10 which is made up of a
1 and a 0 but in this 16 there's 16
cymbals and missed hands over ten so in
base 16 what we do is we use air for the
next number which is 11 in this case I
mean 10 so this is 0 1 2 3 4 5 6 7 8 9
so a equals 10 B is 11 C is 12 days 13 a
is 14 and half is sexting or 15 I mean
but as you see there's actually 16
symbols so if I just yes there you can
see there 16 symbols not other 16 lines
so that's how accidents my works not so
are where it's machines gonna work so
what we're doing is we're first we're
pushing 10 onto the top of the stack
then we're going to say 0 1 because
we're going to say that's the end of the
instruction because we're just going to
push 10 and that's it we're done then
the next thing we're going to do is
we're going to push another number on
the top of the stack okay actually know
before we do that we're just going to
print the top of the stack so we're
going to say 0 4 so what we're doing is
we're pushing 10 on the top of the stack
adding the instruction and we're
printing the top of the stack and that's
what our simple program is going to be
so I'm going to just copy that and I'm
gonna see this as that so this is our
program for mine now what I'm gonna do
up here is gonna create a comment so we
remember what our instructions are ok so
now we've done that we're gonna open a
file
we actually have to open the file B to
be able to and load in the program so
here what we're doing is we're passing
the command-line argument from of the
file and we want to open to the run
program function and then in the run
program function we need to accept the
argument so I'm gonna say armsie that
means we are passing the variable we're
going to store it in this function and
we're gonna give it to the load the load
program function setting up an RV in
there as well and then now we've passed
it to the know program function we need
a pass it alright now we've given it the
low program function the new program
function has to accept it so I mean to
say we need to give it here so that we
can accept it 20 videos we're going to
print our V and as you can see it's just
going to print the file
or I mean it's gonna print this for
example is gonna print Francis exactly
as it did and if I put anything else
like Ho code it shows exactly the same
thing so that's it for this video and
fortunately I've run out of time so in
the next video what we're going to be
doing is loading the program into the
virtual machine so thanks for watching
I'll see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>