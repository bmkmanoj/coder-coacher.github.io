<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make a Day/Night Cycle in Unreal Engine 4  - Sam Pattuzzi | Coder Coacher - Coaching Coders</title><meta content="How to Make a Day/Night Cycle in Unreal Engine 4  - Sam Pattuzzi - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udemy-Tech/">Udemy Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make a Day/Night Cycle in Unreal Engine 4  - Sam Pattuzzi</b></h2><h5 class="post__date">2018-03-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CbFYqvCS0s0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome in this video I'm
going to be showing you how to create a
day/night cycle in the very powerful
Unreal Engine so you've probably used a
day/night cycle before it's a very
common feature of lots of different game
engines but let me just show you what
it's going to look like at the end of
this video so here i've got the project
that we're going to create with you in
this video nothing added everything's
done on-screen and if we go ahead and
play the game you're gonna see that
we're inside this Cove that is a very
nice little bit of level design that
we're going to just import and you can
see the day/night cycle just happen
there you can see the shadows running
across the cave walls you can see the
night outside then the dawn the Sun
comes up goes up to its peak the shadows
again and the cycle repeats and we get
to see the star light on the sky map so
I'm gonna be showing you how to update
the sky map I'm gonna be showing you how
to move the Sun across the sky and
change all the lighting using Unreal
Engine features and we're going to
program this together in this video so
that's gonna be fun and I'm gonna take
you through every single part of the
process you don't really have to have
any experience with unreal though it
will help obviously and you do need to
have a copy of Unreal Engine if you're
going to follow along but if you just
want to watch out of interest then
you're perfectly capable of doing that
too with this video so without further
ado let's dive in so let's start off by
setting up a project that we can use as
a base for our day/night cycle Here I am
in the Epic Games launcher and I'm going
to go ahead and use it to launch the
latest version of unreal for me which is
for point 18 point 2 but basically for
point 18 so there you're gonna see any
minor differences if you're using a
later version than 4.18 now for this
project we're going to use mostly things
that are already built into unreal we're
gonna go to the new project tab go I'm
gonna keep it a blueprint project here
for simplicity it's easier to do most of
this in blueprint you'd only do C++
really if you have a preference for it
or what you are trying to do a lot of
heavy lifting and you try
to make you again really performant but
we don't need to worry about that so
we're going to go in to create a
blueprint project and it's going to be
the third person base that we want to
use and we can leave it without any
starter content and leave the default
for the other options here and we'll
give the project a name which for me is
just going to be the day-night so I
notice that I'm not putting any spaces
here day/night cycle with camelcase
capital letters for each work basically
let's go ahead and create that project
and what we're going to add in addition
to the built-in stuff from unreal is an
asset pack which is freely available on
the marketplace and I've already
downloaded it's fairly large so you
might want to go ahead and start
downloading there right away before
looking any further into the tutorial if
you want to follow along and the asset
pack in question is the Infinity blades
and I'm going to be using the Infinity
Blade not the warrior let me find it to
do iceland's that's the one I'm going to
go with so now that it's creating my
project I can go and add this asset pack
to my project go add project and I'm
going to go ahead and look for my
day/night cycle add a project so that
we'll can Bob you late for a second and
we'll end up with the iceland's pack
inside a third person example project
and once that has completed we can go
over in to the Unreal editor where if we
go to the root of our content browser we
should now see that along with all the
stuff that is there from the
third-person example we've got a folder
for the Infinity Blade assets so if we
double click into that you can see
there's effects environments and maps
which is maps is the one I'm most
interested if you're go into maps and
open up the frozen Cove map go ahead and
do that as soon as you can because
there's a bunch of shaders that unreal
is going to need to compile in the
frozen Cove so because it's quite a big
scene and it's quite impressive there is
a lot of complexity in here so do go
ahead and open it right up you might get
a message log pop up like this and it
will I've already got these shaders
built but you may need to have
the shaders rebuilt let's go ahead and
play and see if we can pop ourselves
into the world there you go we've got
our third person asset and he can go and
run around in this third person world
and you can see it's actually quite a
beautiful piece of level design that you
can just go ahead and explore all to
your heart's content but this is going
to be the basis for our day/night cycle
that Sun that you see in the sky over
there here's what we're going to be
trying to manipulate so how is it done
how does this all work in unreal how
does sunlight work well basically it's
just a type of light what's known as a
directional light so if you go to your
world outliner pane and look for light
then you'll notice there's quite a few
but one in here is called light source
and you'll distinguish it from the rest
because here to the right of the name of
this particular actor is the named
directional light now basically what
that's saying is that this is an actor
of type directional light and if we look
into our details pane we can see a
little bit more information here we can
change things like the intensity the
light color but most interestingly is if
we double click on a light source to
locate it in the world you'll see that
it's not anywhere near where the Sun is
and in fact if we take a little bit of a
closer look at it you'll see there's an
arrow and that arrow is the important
thing because that arrow is telling us
the direction of the directional light
now that Sun up in the sky what is that
well actually that is part of the sky
sphere the sky sphere is a mesh that
basically encompasses the whole world
and makes it look like there is a sky
there and it's what we draw the stars on
it's what we draw the clouds on all
these distant objects and that is
somehow linked up to our light source so
if we look for sky they go BP sky
underscore sphere and we double click on
that then you see that it's this
absolutely massive massive sphere that
we've just zoomed out to and if you
click on it and
go into the details pane and have a
little poke around you'll notice that
there is a directional light actor here
and that is pointing at none other than
the light source we were looking at
before so what happens here what happens
with this light source well if I go in
to rotate mode you can also do that with
the e key then what I can do is I can
rotate this light source and you can see
that the lighting is changing basically
looking like the Sun is at a different
position in the sky but if I go and have
a look at my Sky box my sky sphere
rather nothing seems to have changed why
is that because you have to go to your
sky sphere and there's a funny little
checkbox here called refresh material if
you check that refresh material and then
go and have a look up in this guy you
can see that the Sun has now moved I'm
gonna have to get out of the Cove in
order to see where it's gone to but it
is there still it's just now in a
position in the sky which relates to the
rotation of our directional light so
that seems fairly clear what we need to
do is write a little bit of blueprint
that rotates as Sun and updates the sky
sphere so that's what we're going to try
and do first of all with the first step
rotating the Sun let's try and do now
for this we're going to need easy access
to both the Sun and the sky sphere
because they're both actors in a level
the easiest place to do this will be in
the level blueprint itself so to get to
the level blueprint which is a blueprint
belonging to the level which has access
to all the actors in that level we can
go to the blueprints button in the
toolbar and then go to open level
blueprint okay so now that level
blueprint is open I'm going to buy a
basically prop it into the main window
and we've got ourselves the event graph
for that level blueprint now what I want
to do first of all if I'm going to
rotate the Sun it's something I want to
do on every frame so I'm going to have
to add a tick event in here so event
tick and zoom into it
that's what we're going to be doing
every frame we're going to be updating
the rotation of the Sun then what well
we need to be able to actually get hold
of the Sun so I'm going to look for a
light source again in the world outliner
okay here it is
and I'm going to have it selected
because if I then go over into the level
blueprint and right-click and you see
there's an option to create a reference
to the light source and using this
reference in the blueprint I will then
be able to go ahead and do things like
set rotation by pulling the pin off and
doing a set back to rotation so here you
can see I could set a new rotation of my
choosing that let's try that that ontic
I will go ahead and play and my sunlight
should be updated to a 0-0 location if I
FA out of here select my light source
and oops go back to the details pane
want to select the light source okay
then Oh looks like the rotation hasn't
updated
reason being is that it's not a movable
object so let's stop go and select the
light source one more time and with that
light source we want to make sure this
mobility is movable so I'm going to save
that and okay let's try one more time to
go ahead and play out of here and then
we're going to select the light source
and check the rotation indeed has been
reset to zero zero zero so that's great
it's rotating but we do want it to be
rotating in a certain way and basically
a day/night cycle for this we're going
to want a little bit of information
which is how long is a day and we can
encapsulate this bit of information in a
variable so I'm going to go to the my
blueprint pane create a new variable and
call this seconds per day like so and
I'm going to change the variable type
over in the details pane to be a float
and I go to compile
The Blueprint because I want to have the
default value available here and we're
going to choose a seconds per day now
I'm gonna go for something really
ridiculous at the moment we're just
going to be 10 seconds per day that's
going to be a really quick day but it'll
get us started so what do we want to do
here with seconds per day we want to get
the time elapsed since the beginning of
time so that we can figure out where we
should be in a rotation basically so
let's start off with that so I'm going
to get seconds or get I think it will be
total seconds let's see now it's under
utilities time get time seconds and the
return value here is obviously a float
as well and what we want to do is divide
this time by the seconds per day so that
we end up with a number of days think
about it we've got a seconds per day and
seconds essentially so we've got seconds
divided by seconds is going to cancel
out the per day bit is going to just
become the thing so it's going to be
days so I'm going to do a divide
operation here so it's float divided by
float and I'm going to have the seconds
per day be the second argument that
we're dividing by and then we're gonna
have to do something interesting because
it's going to give us one two three days
etc well what we want to do is go round
360 degrees every time so we're going to
multiply by let's see x a float and that
float we can just set the value to be
360 like so I don't need to add any more
pins that we remove that accidental pin
add and what we can do with this
rotation is just rotate one of the axes
so I'm going to right-click split the
struct and let's see which axis are we
going to want to do it around go into
the world and say probably the y axis
and okay let's give this a shot compile
it and hit play and see if sure enough
the Sun is rotating round and round
which is exactly
once it seems to be doing it roughly the
right rate you can play around with a
variable yourself to see that that
variable will make it faster or slower
if we do have a bit of an issue where
we're getting lit from underneath which
is something we're going to fix later by
changing the intensity of the Sun so
when it dips below the horizon it's not
going to be illuminating things anymore
but before we move on to the next step I
just want to tidy up here just a little
bit because what we've got here is a bit
of a mess so here this whole section
where we're doing this x 360 is we're
trying to get the number of degrees or
to rotate the Sun by so I'm gonna
highlight all those nodes right click go
to collapsed a function and then I can
rename this function to be get Sun
rotation like so and I can actually you
can see it's got an execution pin here
we don't need the execution pin because
it's what's known as pure if you go into
the details you can get a check off pure
and it just removes the execution pin so
it will just evaluate it when it's
needed that's very helpful and for now
the rest is not a mess so I'm not going
to bother bother tidying what is not a
mess okay so as we said the next step is
making sure the sky sphere updates so to
do that it's very simple to the same way
as we got hold of the light source
really we go into a frozen Cove scene
and we're gonna look for the skies
sphere select it go back to the level
blueprint right click create a reference
to the sky sphere and then from that
reference we pull off a pin and what we
want to do is look for a blueprint
function called update Sun Direction and
all we want to do there is simply go
ahead and call it after we have set the
actor rotation so that we refresh that
sky sphere so let's go ahead and compile
save and play that's how I look what it
looks like so they go you can see the
sky sphere is actually updating its
going through a dawn the Sun is rising
and then we've got it
showing the stars
night so the only problem we've got here
is that the light is shining on two
things at night basically it's coming up
through the sea the sea isn't blocking
it and creating shadows so it's not
working properly but that's kind of okay
for the seated not to be blocking
shadows but it's not okay for the light
to be shining up through the ground at
night that's the bit we do need to fix
but before we do that I want to do a
tiny little tidy here because what we've
got is not entirely clear we are doing
an event tick but then we've got a
couple of nodes and they're doing
different things so what I want to do is
make it really super clear what's going
on here and that's going to be by
selecting these three nodes the light
source that gets Sun rotation and the
set active rotation right-click
collapsed a function and the function
names just going to be rotate Sun like
that so it's really clear that on event
tick we rotate the Sun and then we
update the Sun direction and the next
thing we want to do is change the Sun
intensity so that's what we're going to
have a go at doing and to do that I'm
going to first go ahead and create a new
function called update Sun intensity
like so and then I'm going to update the
Sun intensity after we've updated the
Sun direction on the sky sphere because
it doesn't really matter at which stage
we do that what it might do maybe this
function takes it into account I'm not
entirely sure that it does but just in
case it did it'll be safer to put update
Sun intensity just before an update Sun
direction so now a tick is reading very
very clearly we were at 8:00 the Sun we
update the Sun intensity and then we
update the Sun Direction I'm fairly
happy that that reads well let's go and
actually make update Sun intensity do
something so let's think about how we
want this intensity thing to actually
work out when we've got the arrow of the
Sun
pointing upwards this means that the
sunlight is coming up through the ground
this means it's nighttime and we
basically want to have that intensity
set to zero so we aren't lighting
ourselves from underneath from under the
sea and that workaround to do that would
be to set the intensity to zero and
where is it that we want to start
setting the intensity to zero well
basically when it's horizontal basically
when it just dips below the horizon is
when we don't want it to be shining
through the ground anymore so we want
that intensity to go to zero at that
point but what about when it's pointing
right down that's when we want it at its
maximum intensity when we want it it's
whatever the initial intensity we want
it to be is that could be let's factor
to have a look at what the maximum
intensity is if I go and look for the
light source select it go to the details
pane and you can see we've got an
intensity here of three but I would like
to point something out but if you set
this down to zero then the sky sphere is
going to go into some kind of default
mode so we can never actually set it
fully to zero we need to set it to a
very small number like naught point
naught naught naught 1 and then the sky
sphere will still be responding in the
way it should be but the at least the
intensity here is minimized and there
are no lights and no shadows in the
scene so that's what we're trying to
achieve programmatically and if we go
ahead and hit play
watch our Sun go round and round it
round and I've got f8 out to D possess
my pawn and I'm going to go and select
the light source in the scene and I'm
going it - I can't see my light source
why can't I see the light source let's
just try selecting it D selecting it to
select something else anything else and
then go back to find my light source
again select again just seems to be a
different object at this time
and what I want to do is have the axes
visible and I'm going to check the goat
globe to show the gizmo in local space
and you can see that x-axis is basically
the forward axis of the Sun it is the
direction the sunlight is shining in
right now and that's what we want to get
hold of we want to get hold of that
vector that forward vector and say when
it's pointing fully down basically the Z
of that vector is fully 1 we want to set
to our maximum when it's set to zero we
want it to be zero when it's negative we
also want it to be zero how can we
achieve that how can we get to that
state well it's fairly straightforward
actually so let's go into our level
blueprint and what we want to get hold
of is that reference to Sun so I'm going
to go into the rotate Sun function and
copy it go up to Sun intensity and paste
it in here and off there we can do a set
in density which I think should be set
the intensity of the light component you
see it gets hold of the light component
automatically for us and sets the
intensity and we can feed the execution
pin through to do that but we don't have
an intensity yet we want to get hold of
the intensity so how are we going to get
hold of said intensity well we can go
ahead and get the forward vector of the
light source so I'm going to copy the
light source again the forward vector
being the X the direction that x-axis
was pointing so get forward vector
that's not quite what I wanted let's do
forward get actor forward vector is the
one I'm looking for now I can split the
return type so that we've got its x y&amp;amp;z
Zed is basically gonna be the up-down
component of that vector so when it goes
negative is actually when it's daytime
when it's positive it's when it is
nighttime so how are we going to map
that on to the intensities that we want
well fortunately
math is exactly what we want if I look
for map range clamped that's the one we
want because clamped means that when you
go beyond the bounds it stays within the
second range that you want it so we've
got two ranges basically the A to B in
this is the in range and the a to B of
the out range and it maps one on to the
other it's very very simple so I'm going
to take this said put it into the value
and say basically what we've said on
this slide here that is when the Z is
minus one we want a max intensity so
minus 1 in in range a minus 1 and our
out range should be the maximum which we
said was 3 what about where do we want
it to go to zero well we've already said
that the out we don't want to go fully
to zero because that does a funny thing
with switching off our intensity which
we don't want so we'll use a small
number instead but zero is where we want
it to go to that small number so then I
can take the return value of this
mapping and set it into our intensity
go ahead and compile hit play and let's
have a look at the result so we've had
nighttime daytime gives us some sunlight
we can see all the shadows coming off
everything but we go into night time and
we're not seeing sunlight shining onto
our bottoms anymore which is fantastic
so they go you've got yourself a full
day night cycle you can change it to be
a more sensible amount of time in that
variable but you can this is just for
illustration purposes and you can see
that it's working very well and we've
even got around the issue that sunlight
often shines upwards through terrain so
Pat's on the back
that's gone really well ok so I hope you
enjoyed that video if you did go ahead
and like and if you want to see more
videos like this go ahead and subscribe
and please go into the comments and let
me know how you would like to extend
this project or if there's anything else
you would like to know how to achieve in
unreal I'd really like to hear your
ideas and I'd love to make some more
videos like this one
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>