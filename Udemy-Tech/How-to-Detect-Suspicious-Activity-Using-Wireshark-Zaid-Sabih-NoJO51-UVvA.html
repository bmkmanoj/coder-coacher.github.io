<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Detect Suspicious Activity Using Wireshark  - Zaid Sabih | Coder Coacher - Coaching Coders</title><meta content="How to Detect Suspicious Activity Using Wireshark  - Zaid Sabih - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udemy-Tech/">Udemy Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Detect Suspicious Activity Using Wireshark  - Zaid Sabih</b></h2><h5 class="post__date">2018-03-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NoJO51-UVvA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so now let's see how we can use
Wireshark to discover suspicious
activities in our network and before I
do anything I'm gonna go to the
preferences
and I'm going to go to protocols ARP
and I'm going to enable the option to
detect ARP requests terms what this will
do it will actually discover if anybody
is trying to discover all the devices or
on the network and it's going to give me
a notification so I'm going to click on
ok and I'm going to start my capture
and now I'm gonna go to my candy machine
and I'm gonna use net discover so I'm
not gonna do IRP poisoning I'm only
gonna do try to discover all the
connected devices to my network
so using exactly the same command that
we used before the discover interface
and the range I'm gonna hit enter
and we can see that net Discoverer
finished it discovered all the devices
that we have
so if we come here even before we look
at the output of the notifications let's
just look at the packets that have been
generated
you can see that there is a device here
this source is broadcasting so basically
it doesn't have a destination it's
asking all the other devices and the
network and it's inquiring about each
possible IP so it's basically asking who
has this IP and tell the 67 IP and then
it's asking who has the two for one IP
tell the 67 who has these 251 tell the
67 and it's doing this for every
possible IP so it's basically at
checking if any possible IP in the range
exists and it's asking to return the
response to the IP at 10 2014 67 so from
this we can deduce that someone's trying
to discover all the connected devices
and that someone is at 10 2014 67 now if
we go on the analyze and expert
information
you'll see that we detected and AARP
packet storm so basically it means that
there was a single device sending a very
large number of ARP packets so they're
probably trying to discover connected
devices or try and discover connected
ports so it's telling us that this
person is trying to do something
suspicious
let's go and I'm gonna do a ARP
poisoning attack using man-in-the-middle
framework and we'll see if we can get
any notifications or warnings and
Wireshark
now I'm going to go to analyze and
expert info again and if we look we'll
see we have a warning here and the
warning is telling us that there is a
duplicate IP address configured so again
this is telling us that the IP address
of the router had two different MAC
addresses
what this means basically it means that
someone was tampering with this and
tampering with our ARP table trying to
place themselves in the middle using an
ARP poisoning attack
now we've seen a number of methods to
detect ARP poisoning let's discuss how
we can prevent it or protect ourselves
from it now I'm just gonna run an air PA
and we're gonna look at our table there
is switches that will monitor this for
you as well and they'll notify you or
even prevent ARP poisoning attacks
another way to do that is if you look at
here if you look at your router you'll
see that this entry in the table is
dynamic so the type of this entry is
dynamic well that means it basically
this can change its the system allows
this value to be changed you can see
right here you have static values which
basically means the system will never
allow these values to change so you can
use static ARP tables which basically
means that you'll have to configure each
IP address so you have to actually
configure your IRP table and map each IP
address to the MAC address to the
relevant MAC address but once you do
that even if someone tries to send a
response to your computer trying to
change it the system will refuse to
change anything because you configured
your ARP table to be static the only
problem with that is every time you
connect to a network and every time
there is a new device connecting to your
network you'll have to manually
configure that device to you to work
with your network so it's not a very
useful solution if you are in a big
company or if you're in a big firm but
maybe in a small house or in a small
company then this would be a really good
solution to prevent ARP poisoning
attacks because everything is going to
be static you're gonna have to set it up
manually but when someone tries to do an
ARP poisoning attack even if their
attack is successful and they use the
best tools they can your table is set up
in a way that it's not it's it's fixed
it can't be changed so the system will
always refuse to change the values of
the MAC addresses which will basically
mean ARP poisoning attacks will never
work against you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>