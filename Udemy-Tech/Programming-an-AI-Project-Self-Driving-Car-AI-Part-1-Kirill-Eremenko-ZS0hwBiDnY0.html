<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Programming an AI (Project): Self Driving Car AI Part 1 - Kirill Eremenko | Coder Coacher - Coaching Coders</title><meta content="Programming an AI (Project): Self Driving Car AI Part 1 - Kirill Eremenko - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udemy-Tech/">Udemy Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Programming an AI (Project): Self Driving Car AI Part 1 - Kirill Eremenko</b></h2><h5 class="post__date">2018-03-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZS0hwBiDnY0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey did enthusiasm my name is Carol and
I'm part of the super data science team
where we teach dozens of data related
courses which have been taken by over
400,000 students globally and this is a
quick preview of our best-selling
artificial intelligence course which has
been taken by over 45,000 students and
where you can learn all of the ins and
outs of this amazing field I hope you
enjoy and happy analyzing hello and
welcome again to our self driving car
mojo so in this tutorial I'm going to
explain the environment on which we will
implement our artificial intelligence
and that will contain of course the car
that we will train to drive itself and
to avoid obstacles and on which we will
draw some roads and some blocks for our
car to navigate around them so we will
later build this artificial intelligence
to train this car to drive on the road
you know without crossing the limits and
avoiding some obstacles that we'll put
inside the road so this is a pretty
exciting challenge and actually there
are two separate files as you can see
there is the AI Python file that our
artificial intelligence that will do all
the training to train the car how to
sell Drive and we have the map that py
file that is the code that makes all
this environments so here is that code
that's actually 200 lines of code a
little more so this code is not
typically related to AI it is just a
code to make the environment to make the
map so I'm gonna go through each of the
sections one by one to explain but we're
not going to implement this code line by
line from scratch because we want to
focus on artificial intelligence but
let's still go through the sections
one-by-one to understand what's
happening so first we import the
essential libraries that's for any code
we need some libraries to perform some
tasks more efficiently then we import
all the Cavey packages so that's not
very important because this is all
specific to cavy we're using kb to make
the map and so we're importing a lot of
classes and objects to be able to make
this map and
some tools in the map alright then this
line is important this line is a I
related because basically this is where
we import our brain the brain of the car
which will be an object of this dqn
class and the dqn class is our
artificial intelligence itself you will
see we will implement the dqn class in
the following tutorials and as you might
have guessed DQ n stands for deep cute
networks so we will implement a deep Q
Learning Network and then once it's
ready we will be importing it here with
this line from the AI and the AI is of
course our AI Python file alright so
Kent's way to implement this this is
gonna be quite a journey but you will
see this is going to be very exciting
because thanks to the AI the car will be
able to drive itself alright and now
before I move on to the next sections we
have to explain how we will train this
car I'm not going to explain the neural
network right now but I'm going to
explain the idea of how we're going to
train the car to drive itself and to
avoid obstacles so you know in real life
if you want to train a real car to avoid
some walls or some obstacles well what
would you do you would definitely not
take real walls or real big obstacles
and smash your car onto them that would
cost you a lot of money instead the more
intelligent idea would be to punish your
car not when it smashes a wall or an
obstacle but when it goes on to some
cent so it's like you have a field this
field has some roads on which the car
has to stay and the roads are delimited
by some cent and each time the car goes
on to the cent it's like it's going on
to an obstacle because once the car goes
into some cent
it will be slowed down and we will make
sure that the car is penalized is
punished for that and that is one
essential points of artificial
intelligence the bad reward comes
whenever the car goes onto some sand and
it slowed down alright and therefore
here I'm introducing last X and nast Y
which are the coordinates of the last
point in memory when we draw some sand
on the map all right and then we get our
artificial
which we call brain and that contains
our neural network and we will call it
brain because this is actually the brain
of the car and that contains our neural
network all right so in this line of
code as you can see I'm creating an
object of the dqn class I will remind
what classes and objects are but brain
is the object dqn is the class and 5 3
and 0.9 are the inputs of the class so
that's very simple 5 corresponds to the
states that are encoded vectors of 5
dimensions we will see what they are
perfectly describing what's happening in
the environment on the map then 3 is the
number of actions there will be 3
possible actions go left go straight or
go right and 0.9 is the gamma parameter
in the DQ learning algorithm all right
and then we have the action to rotation
so action to rotation is a vector of
three elements 0 20 and minus 20 and so
we have to do this because the actions
are encoded by three numbers 0 1 and 2
and that corresponds to the indexes of
this action to rotation vector so for
example if the action that is selected
at time T is 0 well 0 corresponds to the
index of this action 2 rotation vector
and the value of index 0 is 0 and
therefore we will go straight then if
the action selected is 1
well 1 corresponds to the index of this
action 2 rotation vector and the value
of this vector that has index 1 is 20 so
20 corresponds to a rotation of 20
degrees and that means the car will go
20 degrees to the right and then if the
action selected is 2 well 2 corresponds
to the index 2 of this action 2 rotation
vector and therefore the car will do a
rotation of minus 20 degrees and
therefore it will go to the left all
right then we introduce the last reward
variable because at each state we will
be getting the last reward so remember
if the car doesn't go on to some sand
then the reward will be positive and if
the car goes on to some
and well it will get the bad reward and
at each time this variable will contain
this reward that it gets at each time T
and then we initialize the scores which
is a vector that will contain the
rewards not all of them but the rewards
onto a sliding window so that you know
we can make a curve of the mean score of
the rewards with respect to time all
right
then in this code section we initialize
the map so we initialize for example to
send variable so that's important the
stand variable is actually going to be
an array in which the cells will be the
pixels of the map and in each cell we
will have a 1 if there is some send and
a 0 if there is no sent at the beginning
who will not be drawing anything so
there will be no send at all and
therefore all the cells of the same
array will have a 0 so there will be
zeros everywhere and as soon as we draw
some sent while the cells on which we
draw the sends will get a 1 and we
initialize the erase with all the zeros
right here
send equals and P zeroes then we have
this important thing which is the goal
so the goal is a point in the map which
we will train the car to reach so it's
like a destination so what is this girl
going to be well this is going to be the
upper left corner of the map so we'll
turn the car to go to the upper left
corner of the map and then once it
reaches the upper left corner of the map
then we will train it to go to the
bottom right corner of the map so we can
imagine the following scenario the upper
left corner of the map is the airport of
a city and the bottom right corner of
the map is the downtown of the city and
we will turn the taxi or uber to do some
round trips between the airport and
downtown and of course we'll make the
task difficult to this taxi by drawing
some more and more difficult roads and
adding more and more obstacles on the
street to see if the taxi can still
manage to go from the airport to
downtown so this is going to be fun and
so that's why here I'm setting the
coordinates of the first goal that is
the airport which is at the upper left
of the screen so the map will be like a
square like this and the coordinates of
the origin that is the coordinate 0
is right here and then larger is this
distance here so the coordinates 20 and
larger minus 20 will therefore be right
here the upper left corner of the map
and why did I choose 20 and not 0 well
that's because we want to train the car
not to rush into the walls you know we
want to train it to avoid the walls as
well and therefore the goal must not be
zero because we don't want the car to
touch the wall we want to touch the goal
so we have to put it right here and then
I'm just introducing the last distance
variable which just gives the current
distance from the car to the goal and
that I'm initializing to zero all right
and now time to make the car and the
game so we're gonna make two classes one
class for the car and one class for the
game and inside these classes we will
already make some connections with our
AI so we'll do that in the next tutorial
and until then enjoy AI</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>