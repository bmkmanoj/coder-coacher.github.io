<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Arduino With Helium Part 4: Sending Data to A Web Service - Peter Dalmaris | Coder Coacher - Coaching Coders</title><meta content="Arduino With Helium Part 4: Sending Data to A Web Service - Peter Dalmaris - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Udemy-Tech/">Udemy Tech</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Arduino With Helium Part 4: Sending Data to A Web Service - Peter Dalmaris</b></h2><h5 class="post__date">2018-03-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SL-gTwSCGIU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now that you know how to send sends the
data from your Arduino to the helium
Network and then to an external consumer
like request bin and also you know how
to update local configuration variables
of your adeno application from your
helium dashboard there is one more thing
that I'd like to show you and that is to
show you an application that is kind of
closer to what a realistic Internet of
Things custom web application might look
like so at the moment we've got our
gadget sending its data to request bin
like that that's the latest set of data
and the ural where that happens is right
up there for the request bin and that
has been configured with it is earlier
in our channel settings right here in
our header to be helium test Channel and
that is the location that is the URL
where this particular channel will send
its data using the post method what of
god is a little application that is
running on the hero co-host now this is
probably the topic of a whole new course
on how to do such a web application on
Heroku using high-level language like
Ruby with a very lightweight framework
like Sinatra but I think it's a useful
demonstration just to show you what the
power of the helium Network is to be
able to work with all sorts of different
types of applications including custom
applications so Heroku is a very
easy-to-use platform that takes care of
a lot of the problems that traditional
web application hosting
has to deal with and that includes
things such as provisioning service and
dealing with operating systems and
patches and uploads and things of that
sort and what we've done is that we've
written a little application that is
available for you to play around with
you can look inside the course
repository and let's get to it
it is this one right here so 2 3 4 8
helium's not a web service example going
here this is the application but the
file that you need to look at that
contains the actual application the rest
are just tests and some other helping
type files is this one here ta helium
underscore demo dot RB in here we've got
an application that is using the Sinatra
framework and it allows us to respond to
particular types of requests so for
example if you go to the base URL for
this application then you'll just get
this message out actually let's do that
now so we can go back to the hiroko
console and I click on open app you can
see that it brought up a new tab and
it's calling the application now in its
base URL and there's a little message
this is they take explorations hilum
demo app which is exactly what we put
inside the double quotes here in our
case that we want to do something a
little bit more interesting and that is
we want to send a post request to the
application so that it can record the
comma delimited formatted data that we
are sending across I've got a bunch of
endpoints here they've got helium
receive God get helium master value this
is
a post request as well it will respond
to post requests but it's able to decode
a JSON message instead of commenting
limited values as we are I'm gonna
scroll down a little bit more and right
down here you'll see that we are making
a post core we are responding to a post
hole
this is HTTP POST Helium receive CSV so
this is going to read the body of the
message that the helium Network is
sending it and let me go back to the
request bin example see how it says here
roll body well this is the only content
of this body so the Sinatra application
is going to grab a bit of text that I've
got highlighted and it would read it and
store it inside this local variable and
then it's going to use this lit function
in order to break it down into little
components as those components are
delimited by the comma character and
then we'll be able so this is a little
array here then we're able to construct
a new piece of string that will restore
in a local text file that is also hosted
on Heroku some we're not storing
anything in a database or in something
else expenses just old text files so we
are grabbing the current time put a
little bit of space and a - a bit more
space and the word temperature a couple
of dots and then we're saying get the
values stored in the first cell of the
data array and print it out here and we
did the same thing with the rest
so all this text is thought now in the
local variable data underscore new then
inside the beginning right under the
begin keyword we've got a block here we
open up a text file and read it
and then we've got some file management
happening here because we don't want to
exceed 100 lines of stored content in
this text file because of various kiraku
file system limitations so we are one is
to become a gigantic file we only wanted
to store up to 100 files then the next
few lines that I want to go into the
details because Ruby and Sinatra is a
whole different topic this is just a
quick example but what we're doing in
the block of text that I've got
highlighted in between lines 1 1 1 and 1
1 8 is to count how many lines we've got
already in the text file and then as
long as we have not exceeded that 100
line limit to add the new line at the
top of the existing lines and then in
lines 123 onwards until the end of this
method is to store the new set of lines
back into the original text file so the
whole idea here is to not exceed the 100
line limit that we've self-imposed for
our little data building application of
course if this was a real life
application you could just remove that
limit altogether and just constantly
write into this text file without any
limit at all the latest record always
appears at the top of this text file
instead of appending at the bottom a
recap in line 91 we create an endpoint
that receives a post HTTP request that
contains that comma delimited text that
we want to store in our local text file
so back to the helium dashboard I'm
gonna go now inside the web app and the
score CSV Channel and you can see that
for the endpoint I
have defined the Hiroko application with
the end point being the helium
underscore receive underscore CSV method
and I'm using the post method to sent
that data over so let's try this out can
we go back to my Arduino application she
close that and go to the beginning of
the file
right there oops a bit too far comment
out this channel name and uncomment the
hero code on the school web app and the
score CSV and that's the only change
that I need to do now upload this sketch
to the Audrina
okay so complete it with the uploading
now the autumn will start sending its
data to the hiroko underscore web on
this call app underscore csv channel you
can see that that is already coming in
instead of the previous hello world
channel so there's a data coming in you
can check out the atom the backlog to
see what the data looks like there's
what the data looks like exactly the
same payload as what we were sending
over to the request bin earlier and you
can also have a look at the consort of
the logs on my Heroku app to see what
kind of traffic is happening in the back
and you can see that we've got requests
every few seconds coming from the
internet hitting this particular method
using the post request there's a method
the post request method and this bit is
working so you can see that there is
traffic so the next thing that we can do
one of the methods that we've made
available is this one here helium get
CSV all so let's call this method and
see the data that is being recorded
there you go so this is the data that is
being recorded and as I upload I'm sorry
yes I'll refresh the page you get more
data coming in you can also view the
page source to see the rule data without
any format even though there is no HTML
information there but we can now see the
rule data as it's coming in and this
page eventually is going to fill up up
to the 100 line mark so what you've got
here now is that helium is 10 e is
sending the data from our sensors to our
own custom web application now from here
what you do with the direst totally up
to you you can decide to send it to
forward it on to other ilt applications
like for example tweet thought I urge
I'll be creating lectures on this
particular platform a little bit later
but this is another option
it can also store your data in a
database if you are doing data logging
you can create charts and graphs you can
also have logic embedded so if for
example temperature exceeds a particular
amount then you can send a command back
- you are doing it in order to switch on
air-conditioning or turn on a fan as a
configuration variable is quite possible
as well there's all sorts of things that
you can do once it direct your gadget
data to your own custom application so I
hope that this demonstration and
presentation of the helium IOT platform
was useful to you it gives you a good
view of what a modern IOT platform looks
like and perhaps gives you a few ideas
of what you can use it for for your own
projects as always if you have any
questions or comments please feel free
to get in touch thanks for watching if
you'd like to learn more check out my
edweena step base
that getting started and Audrina
step-by-step getting serious
courses on udemy there I'll help you
develop basic and more advanced at the
inner skills including how to write your
own programs how to use all sorts of
sensors and actuators and how to create
your own gadgets you may also be
interested in my project courses where
you get deep into the development of
wheeled robots remote-control cars and
drones please use the coupon code in the
description below this video to get a
YouTube exclusive discount to my courses
see you there
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>