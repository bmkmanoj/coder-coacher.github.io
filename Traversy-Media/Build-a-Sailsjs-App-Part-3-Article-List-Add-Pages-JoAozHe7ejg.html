<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Sails.js App [Part 3] -  Article List &amp; Add Pages | Coder Coacher - Coaching Coders</title><meta content="Build a Sails.js App [Part 3] -  Article List &amp; Add Pages - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a Sails.js App [Part 3] -  Article List &amp; Add Pages</b></h2><h5 class="post__date">2017-08-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JoAozHe7ejg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to video number three
of our sales Jas and MongoDB app in the
last video we implemented MongoDB we
also created the home page with the nav
bar in the bootstrap poor layout so now
we're going to do is work on the
controller I think in the last video I
think in the end I said we're going to
work on the model the models done model
is very simple but the controller is
where we're going to add basically our
routes and what's going to happen when
we go to certain URLs so let's go ahead
and open up API controllers and then
articles controller so in here we're
going to have a bunch of different
functions the first one's going to be
lists that's what we're going to work on
first is the list page so we just want
to set this to a function and this
function is going to take in a request
and a response and then what we're going
to do for now is we're just going to
return a view so let's say res dot view
and we want to load a view called list
okay so we're just going to do that for
now let's save it let's go to our views
folder and create a new file called list
dot ejs alright and let's just write out
lists we'll just test it out we'll save
let's go over here let's click on our
articles tab you can either click there
or view articles and that's going to go
to our list page and you can see that
it's getting loaded so it's as easy as
that to create a route and to to link a
view now we don't just want to show a
list template we want to fetch the the
articles and output them in the list
template or view template view I'm using
those interchangeably so what we need to
do is reach in to the model so let's
just get rid of this for now and we're
going to say articles which is our model
that we want and then we want to call
dot find and here we're going to say
we're just going to put some empty curly
braces because we want to get all
articles we don't have any special
queries or anything and then we want to
do dot exec for execute and then we just
want to pass in a function here and this
function is going to take in an error if
there is one and then the article
that it's going to grab for us so we
just want to check for the error first
so if there's an error then what do we
want to do we want to just read send you
can see that this kind of works like
Express if you're familiar with Express
we're going to send a 500 error and then
we can pass an object with an error that
we can define and we'll just say
database error okay so that's if there's
an error if there's not then we just
want to load a view which I just showed
you is read dot view we want to load the
ListView and then we want to pass in an
object with articles that points to the
articles that are being passed in here
from the find okay so we're just
reaching in we're grabbing the articles
we're loading the ListView and passing
them into that view so let's save that
and then we're going to go back to our
list ejs file and we're going to just
set up some some markup here let's put
an h1 and I'm going to put a class of
display for okay which is like I said
one of the new bootstrap for classes not
really new but bootstrap for and we'll
say articles under that we're going to
start our table
okay our table is going to have a class
of table as well as table - striped and
let's see and here we're going to have a
tea head so when the tea head will have
a tea row and inside there we're going
to have three table headings so 3 th so
with Emmet I can just say th times 3 oh
that's not right th times 3 and let's
see this one is going to be the ID this
one is going to be the title and then
this one I'm going to leave blank
because that's where the buttons are
going to go okay so that's it for the
tea head now let's do the tea body and
in here we're going to what we're going
to do is we're going to loop through all
the articles and then output a table row
with each article now to do our loop
we're going to use ejs syntax which is
going to be a
angle bragging and then a percent and
then what we want to do is take that
articles object and call dot for each
and we want to pass in here a function
like that get rid of that slash and we
want to end this right here with a
percentage and greater than and we also
need brackets down here to like that all
right and then in this function we just
want to pass in whatever we want to use
as a keyword which in our case is going
to be article so it's looping through
all the articles and then we can access
each one with article so let's go ahead
and put our TR and then in here we're
going to have three TDS or columns so
we'll say TD times three and let's see
the first one is going to be the ID so
we're going to use our each a s syntax
now when we're actually outputting
something you need to use your angle
bracket percent and then equals okay we
didn't use the equals here because we
weren't actually outputting something
like we are here so we're going to
output article dot title and then we
need to close that up I'm sorry this is
going to be the ID a ID first and then
the title so I'll just copy that and
then this one will be the title and then
we're going to have our buttons here but
I'll just leave that for now so let's
save let's go over here and reload and
there we go so we have our article one
and article two now the edit and delete
I want to do last the next thing I want
to work on is adding an article so we
need to first take care of our route we
want to click on this link and have it
go to our add page so let's go back to
our controller we're going to go right
under the list put a comma right there
and say add okay which is going to be a
function and all we want to do here is
load the add view so we'll say res beyou
and we want to load add alright so we'll
save that we'll go to views and create a
new file called add
EJ s let's just test it out we'll just
say add ands go over here and click Add
article and that doesn't work
add ejs articles controller see did I
screw something up here oh I don't have
the request and response which I should
yeah because it didn't know what Reds
was so let's try that again
there we go so now it's loading ad now
let's go ahead and add the markup to the
ad ejs file which is going to be a
bootstrap for form so I also want to
have breadcrumb in here so we can easily
go back to the the dashboard or to the
to the list so we're going to put an O L
with the class of breadcrumb and let's
see in here we're going to put an li
with a class of breadcrumb - item and in
here we're going to have a link which is
going to go to slash articles slash list
and it'll just say articles and then
we're going to have another breadcrumb
item okay this one's going to be active
and there's not going to be any link
it's just going to say add alright so if
we save that and reload it should look
like this this way we can go back to the
articles very easily all right so let's
put an h1 under that we'll give it an h1
with the class of display - 4 and we'll
just say add article ok under that we
want our form now this form is going to
have an action of slash articles slash
create okay we're going to create that
in the controller let's also add a
method of post
okay and then inside the form let's
create a form group so it div with the
class of form group we'll have a label I
will say for title and then under the
label let's put an input type text and
let's give that a name of title all
right we also want to give it a class of
form control okay so then we'll copy
this form group paste that in this is
going to be for the body and we're just
going to change this input to a text
area okay text area needs a ending tag
all right and then we'll just put an
input
let's give it a typo to submit and see
we're going to give it a value of submit
and we're going to give it a class of
BTN and BTN primary save that let's go
back to our add page and there's our
form now it's going to get submitted to
articles slash create so what we're
going to do is go to our controller
which is right here and we're going to
go right under add make sure you put a
comma here and we're going to say create
which is going to be a function okay
function should take in a request and
response and let's first get the fields
from the form so let's save our title
set it to request dot body dot title if
you're familiar with Express this should
look very familiar
so this will be a request dot body dot
body
and then what we're going to do is take
our articles model and call to create
okay we're going to say articles dot
create we're going to pass in an object
with title title and body body all right
then we need to run exec so dot exec
inside the exec we're going to have a
function okay with a possible error
we're going to check for the error okay
if there is one we'll just go ahead and
send out a database error message with a
500 status if there's not then we're
just going to redirect so Reds dot
redirect is how we can do that and we're
going to redirect to slash articles
slash list okay and that should do it so
let's save let's go back to our add page
and we're going to say test article
it'll just say this is a test submit and
there it is wait a minute what the hell
why the hell is it why are they both in
the title oh you know what I think on
the form yeah I have name title for the
text area so this should be body dammit
all right so we'll just leave that there
for now but let's just try and add
another one and it should work correctly
so say I'll just say Brad's article
hello there there we go so now it's just
the title don't worry about this
well we'll delete that when we get to
the delete but everything is working as
it should now so in the next video we're
going to start to work on the on the
edit and the delete functionality</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>