<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ExpressJS Crash Course | Coder Coacher - Coaching Coders</title><meta content="ExpressJS Crash Course - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ExpressJS Crash Course</b></h2><h5 class="post__date">2016-07-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gnsO8-xJ8rs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to another web
development crash course in this video
we're going to cover all the basics of
Express j/s now if you've been building
applications with Express for a while
then you're probably not going to learn
too much more in this video than you
already know
however if you're either just starting
out or maybe build one or two small
applications with Express then this
could help you out a little bit alright
we're not going to focus on making some
super application but we're going to
look at some of the core concepts and
how they work all right so let's first
talk about what Express actually is so
it's a minimalistic open source web
framework for nodejs
and it provides us with a bunch of
different features to build powerful web
applications and api's Express is also
the most popular web framework for
nodejs by far and don't quote me on this
but I think it's the most downloaded
node module in general if not it's
definitely within the top five okay so
it's really popular there's a lot of
documentation and support on the web for
it Express also uses the MVC or Model
View controller design concept or design
pattern controllers are used to do
things like direct traffic and load
views and models are used to work with
databases and data stores and then views
are used to display the user interface
all right of course all applications
vary on how much of the MVC design
pattern they actually use but in general
Express is considered an MVC framework
all right so let's take a quick look at
what you'll be learning in this video so
these are just the main topics we'll be
branching off into other areas but these
are the core concepts that we'll be
talking about so we have the
installation setup of Express and this
includes creating a package JSON file
and including our dependencies okay
we'll also look at middleware and
routing which are two really important
concepts in Express I'll show you how to
handle
an incoming HTTP requests and route that
to a template engine all right some of
the template engines are view engines
that will talk about our ejs handlebars
and Jade which is also known as puck
we'll also talk about forms and input so
we can create a form in our view and
submit that to our to our application
and handle that data accordingly all
right and then we'll even implement an
ORM with MongoDB so something like
Mongoose or Mongo Jas something that
will allow us to query a database all
right and then we'll also take a look at
the Express generator which is used to
to prototype a quick boilerplate
application and we'll do that last
because I want you to really understand
how to set things up manually before
just using a generator to to create your
code so we're going to start with
installation and setup of node and
Express all right so there are very few
requirements for Express the only thing
you really need to have installed is no
js' all right you also need npm but npm
comes with nodejs
and that stands for node package modules
and it's used to install modules from a
repository into your application alright
and then the only commands that we
really need to install Express is first
of all NPM init is going to be used to
generate package JSON file
all right we need that for our
application and then we can go ahead and
install Express using NPM so if we say
NPM install Express and we add the save
flag what that's going to do is it's
going to add it to the package dot JSON
file
alright or of course we could just add
it to the file and then run NPM install
all right so let's jump in and take a
look at how this works all right so
before we get into Express you need to
have no js' installed all right I
already have it installed on my machine
so I'm not going to go through the
installation but it's very simple if
you're on Windows just go to node.js org
go
and download the package the the the exe
file and install it okay really easy
once you do that you'll have node
installed and you'll have access to NPM
all right now once that's done what I'm
going to do is create a new folder and
we're just going to call this customer
app okay we're not building a
full-fledged application here it's just
something to work with and give you some
examples with all right and then what
we're going to do is let's open this in
a command line now I'm using this get
bash utility which I'll show you the
link in a second basically it's just an
alternative to Windows command prompt it
includes the git version control system
although we're not really going to get
into that but I just prefer using this
over the standard Windows command line
and if you want to get this yourself
I think it's get - SCM dot-com yeah get
SCM comm and you can go ahead and
download that if you want alright or of
course you can use your regular Windows
command prompt so what we're going to do
now is we're going to create a
package.json file now we could just
create it right in our folder but the
easier way to do it is to run NPM in it
right and like I said if you have no js'
installed NPM should work with no
problem all right so it's just going to
basically ask us a couple questions here
make this a little bigger okay so the
name of our app the default will be
customer app which is what we called the
folder so I'm just going to click enter
version I will keep that that's fine for
a description will just say simple
customer management app entry point I
usually like to call this app dot j s
but of course you can call it whatever
you'd like and then the rest of these we
don't really need you can put your name
here or your company ok and it's going
to ask us to check it and we'll click
enter or yes
all right now if we look in our folder
we now have a package.json file all
right now I'm going to open this up in
my editor I'm using sublime text but of
course you can use whatever you'd like
so let's say add folder desktop customer
app ok so let's take a look at the
package.json file so basically it's just
all the stuff that it asked us in the
command line now there's basically two
things we can do here to install Express
alright so one would to be let me just
go back to my editor hump let me editor
my command line and we could run NPM
install Express and that would install
it and then we could even add dash dash
save and that would actually add it to
this package dot JSON file alright we
could do that and just install all of
our modules like this for instance we're
going to need another one called body
parser which is going to handle parsing
requests that come in incoming requests
and there and make it so that we can
grab form data things like that all
right so we would have to also run
install NPM install body parser alright
and then any other dependencies that we
wanted but another way to do it just get
rid of this another way to do it would
be just to add them ourselves to this
file
alright so that's what we're going to do
we're just going to add in here
dependencies set that to an object make
sure you put a comma there okay and then
we're going to say we want Express and
then what we need to do here is you'll
put some kind of version all right now I
don't know what I do know the latest
version but oftentimes you won't so what
you could do is just put an asterisk and
that's going to basically say that you
want the latest version all right so we
want that and then we also want body
parser
and we'll get the latest version of that
as well all right so if you have a ton
of dependencies it's easier just to
include them all here than to just do
them one by one with NPM install of
course you could add them all to the
same NPM install command but I find it
easier to do it this way so we want to
save that and once we have our
dependencies in there we just want to
run NPM install by itself
okay so we'll run that and you can see
up here it created a node modules folder
and it has Express installed along with
body parser
alright so technically Express is now
installed so now what we want to do is
create our entry file and you can see
here that we defined app J s as the
entry file so we're going to go and just
say new file and let's save it as app is
now using nodejs we could run this file
if you want so if we say console dot log
and we'll just say hello world save it
and then down in the console here we'll
say node app and we get hello world okay
so the node command along with app which
is the name of the file okay we could of
course say node fjs as well all right so
let's go ahead and get rid of this and
what we want to do usually what you'll
see at the top of your your entry file
for Express is a bunch of import or
requires ok so we want to require any
module or any other file that we're
going to want to use so of course we're
going to need to bring in Express so
what we'll do is set that to require
Express
all right or you might see the es2015
syntax where we import stuff will say
like import app something like that all
right we're going to stick to this
method of requiring modules all right so
we're also going to need body parser
which we installed so we'll save our
body parser and that's going to require
body parser okay and then we're also
going to use a module called path now
path is used to simplify just that path
file paths all right so the reason that
we didn't do any I'm install path or
added to our package dot JSON files
because it's a core module okay so we
don't need to install it separately so
we're just going to set that to require
path okay so those are the requirements
that we need and now what we want to do
is initialize a variable usually called
app and I'm going to set it to the
Express function just like that all
right now it's not going to run yet what
we need to do is we need to listen on a
port so we can take that app and then
call dot listen and specify a port which
I'm going to use 3,000 and then that has
a callback function we can use and we
can just do a console log and usually
we'll say something like server started
on port 3000 okay so that is officially
an Express app okay so if we save this
and then we go and rerun node app you'll
see that we have server started on port
3000 and if I go to localhost port 3000
and you'll see that all we get here is a
message that says cannot get slapped
so slash when we're dealing with routes
is equal to the homepage okay so that's
what that means if I was to go to slash
a boat then it's going to tell us that
it can't get the about route all right
and we're getting this because we
haven't set up any kind of route for
slash or for about it for anything all
right so that's what we need to do next
so we'll go back into sublime and let's
go I usually like to put the route
somewhere around here so we'll say app
dot get now we're using get because
we're we want to handle a get request
when you visit an application in you
type in a URL and you go to that
application of that website that's
making a get request all right if you're
submitting a form to and you're
submitting data to a server that's
usually a post request so you would do
ab dot post but we'll get into that
later so we want apt-get and we want to
put the the URL which in this case we
want to handle requests to the home page
which is represented with a slash all
right and then what we need to do is put
a second parameter in here which is
going to be a callback function okay are
just an unnamed function and that's
going to take in parameters of request
and response all right and then what we
do in here is is completely up to us in
this case what we'll do is just say res
so we're going to take that response and
when you could we're going to use the
send method okay and then we can just
say hello world all right so if I was to
save that and reload I'm not going to
get it's not going to change yet because
we edited this file and we didn't
restart the server so there's no change
so let's go ahead and restart this we'll
do control C to stop it and then we'll
run node app again you can see it
started back up and if I go and reload
now we get hello world alright so all
this send method does is just print out
whatever you put in here onto the screen
all right if we look at the source code
it's just hello world
now ideally you're probably going to
want to do something like render view
when you handle your win in your route
handler okay generally not going to want
to just put something on the screen here
all right but we'll get to that before
we get to that I want to talk a little
bit about middleware so middleware are
basically functions that have access to
that request and response object and
also access to the next piece of
middleware that's going to fire after it
all right now most modules have their
own middleware that needs to be set up
for instance body parser actually does
have a couple lines of middleware we
have to include here but I'm going to do
that after what I want to do is just
write some very very basic custom
middleware so you can see how it works
all right now what we'll do here is
we'll create a variable called blogger
and we're going to set that to a
function that is going to take in a
couple parameters it's going to take
request response and next all right and
then in here what we'll do is keep it
simple we'll just do a quick console log
and just say logging and then to end
this piece of middleware and fire the
next one we're just going to call the
next function like that all right now if
we just run it like this it's not going
to do anything what we need to do is say
app dot use to be able to use that
middleware and then we'll just pass in
logger okay so let's go ahead and save
that and then if we restart our
application and then we were to reload
the app and let's look in the console
and you can see we get logging okay
every time I reload it's going to do
that logging it's going to run that
middleware all right now the order of
the middleware is important if we were
to take that away and put it after the
route handler like that and then
restart and reload our application you
can see it's not printing out logging so
the order is very important and the
functionality that happens in middleware
is completely custom and you can you
have full access to the request and
response you can stop it if you want you
can up you can change it you can do
pretty much anything and it will run
every time the application is loaded
alright so I'm going to take that out
because I just wanted to give you that
as an example actually I won't take it
out I'll comment it out alright and then
what we'll do is we need to actually add
some middleware for the body parser so
let's say app dot use and we get to put
in body parser dot JSON so that'll
handle parsing JSON content and then
we're also going to do another app dot
use and say body parser dot URL encoded
and then we need to pass in an object
here extended false okay and this this
middleware is writing the documentation
for body posture so let's just say party
parser middleware alright so that should
be all set the next thing we want to do
is we want to set up a line of
middleware for our public folder okay so
our static folder because we need a
place to put static resources like CSS
files things like jQuery stuff like that
alright so we can actually define that
so let's say set static path
and we'll say app dot use and then we
want to pass in here Express dot static
and we're going to use that path module
we're going to say path join and here
we're going to do double underscore
their name and then the name of the
folder we want to use which for the most
part I call public alright some people
might call it client something like that
but I usually call it public so if we
save that and then we create a folder in
our application called public that's
where we want to put any CSS files or
anything like that any kind of static
resources alright if we were to actually
put in a file here called index.html and
just say test and if we reload well
after we have to restart the server you
can see we get that that file that
index.html is going to always overwrite
what we have in our app j/s all right so
if you wanted to just have your server
and then maybe have something like an
angular application which is a
client-side JavaScript framework you
would put all of that in the public
folder alright but we're not going to be
doing that we actually want to render
views from the server so I'm going to
delete that now having to restart the
server every time we make a change can
get quite annoying so there there are
utilities we can use to fix that and one
of those is node maaan so let me just
show you how we can set that up all
right so we want to install it so we're
gonna say npm install node mon now what
we want to do is we want to install it
globally ok we don't want it just in
this application just to go on the node
modules folder we want to be able to use
it anywhere so all we have to do is add
- G and that's going to install it
globally
ok so we'll let that run
all right so now let that set up instead
of saying no dap we're just going to say
node mon okay and if we reload you can
see we get our hello world and let me go
and change this we'll just say hello
save reload and we get hello okay didn't
have to go and restart the server node
Mon did that automatically for us
all right so very very handy utility now
so far we've just used this res dot send
and what I want to do now is show you
that we can also parse Jason all right
so let's say we have an object let's
call this variable people and actually
let's just say person and set that to an
object and let's give that person a name
say Jeff and an age of 30 okay so let's
say we want to parse this object out to
the browser what we could do is instead
of saying res dots end we can say res
Jason and then we'll just pass in person
all right and if we save that then
reload you can see that it actually
parses the Jason for us all right we
could also make this an array so if we
said people and set that put a bracket
here and here
okay and then we'll go like that say
Sara and we'll do one more okay and if I
save that reload oh we going to put
people in here okay so there we go so
we're parsing an array of objects all
right and this is exactly how api's are
written so if you wanted to have some
kind of client-side application that
made a request to our server to fetch a
list of users and then render it in that
application we could easily do that and
I actually have a couple videos on my
youtube channel that will show you
exactly how to do that all right so I'm
going to get rid of this for now and
what we're going to do we'll just go
back to send for now okay so now what
we're going to do is I'm going to move
on to working with template engines so
let's go ahead and start with ejs which
is embedded JavaScript and this is
actually the template engine that I like
to use because it's very very simple
it's just standard HTML with with some
variable includes that we can use other
than something like pug or Jade which
kind of changes the whole syntax it uses
indent instead of tags and can be a
little confusing so I like to use ejs
and it's very easy to get set up so what
we'll do is let's go to our command line
here stop the server and we're going to
say npm install ejs and let's say - -
save
okay now if we look at the package.json
file you can see that it automatically
added it to to this file because we use
that save flag alright so what we need
to do to set this up is first we need to
add some middleware so let's go right
here we'll just say view engine and
let's we need to say app dot set and
we're going to set view engine and set
that as ejs now we also have to specify
what folder we want to use for our views
so right underneath let's say app dot
set and we want to set views and then
we're going to say path dot join and
then specify views okay just like we did
with the static folder down here so
let's save that and then we're going to
create a folder called views and let's
create an index view so we'll say new
file so I'm going to save it as index
dot ejs alright and then in here let's
just say I'll say hello from ejs save it
actually we'll wrap it in h1
okay and then back in our app J s what
we can do is go down to our route for
our home page or four slash instead of
res dot send we're going to use res dot
render okay and then we're just going to
pass in index save that reload and
whoops we have to start our server so
we'll use node lon
and there we go so we get hello from EJ
s so setting up a view is as simple as
that now it's not just static content
that we can render that we put in the
EGS file we can actually pass values
into it so for instance let's create a
variable called title and we'll set it
to set of two customers all right and
then let's say we want to pass that into
into our index view so what we can do is
just add a second parameter which will
be an object and we could give this a
variable name that we want to use inside
the view let's say title and we'll
actually know what we won't put it as a
separate variable let's just go like
this okay so what we're just passing in
a title to the view now in order to get
that to render what we can do is use the
less than and then percent and then
equals and then whatever we called it
which was title and then percent greater
than okay we'll save that reload and you
can see we get customers now you
probably want to have HTML structure so
let's do I guess I don't have the
shortcut I thought I did that's not
working all right so I'm just gonna have
to type it out so we'll say HTML
and we'll put head tags body tags okay
we'll take this and put it in the body
and then inside the head we'll put a
title I'll save my Express app okay if
we save that and reload and we do a
control you you can see that we're
getting that HTML structure now you're
probably going to have multiple views in
your application and you don't want to
have to keep repeating yourself you
don't want to have to keep putting these
in in every single view so with ejs
usually you would use partials for this
so what I'll do is create a folder
inside the views folder called partials
and let's create a file called header
ejs and then another file called footer
dot ejs and then what we'll do is take
from here to here cut that out put it
inside the header and then we'll take
from here to here cut that out and put
that inside the footer alright and then
what we need to do is then include them
in this file alright so right here let's
say include and I think we should be
able to just say partials
yeah partial slash header
and then we'll put this one will be
footer alright so let's go ahead and
save it reload and if we look at the
source code you can see it's still
included and just to make sure that it's
coming from the header we'll change this
to customer app save it reload and we
get customer app so now what I want to
do is show you that we can also pass
along arrays or objects or other data
types as variables okay because in this
example we're just passing a string so
what I'm going to do is create a
variable called users and I'm going to
set that to an array this is basically
going to be just like the the people
objects that we created earlier
so we'll say first name last name and
let's do email and let's also give them
an ID
all right and then we're just going to
copy this change these up a little bit
say Jill Jackson all right so we have
this array of users and what we want to
do is include that down here as users
users alright so we'll save that now if
I was to just stick in here let's just
do users and let's save it okay so
that's what we get if we try to do that
and that's because these are objects we
can't just print an object like that
what we have to do is iterate through
the array and then print out the objects
one by one along with whatever property
we want to output so doing that is not
too hard what we'll have to do is let's
get rid of that and now notice that here
I use the equal sign and here I didn't
the reason for that is because when
you're actually outputting a value like
this you want to use the equals if not
you want to use just the percent all
right so this is going to be a for each
loop so we're not going to do the equal
sign here we're going to say users dot
for each and then what we want to do is
put in a function like that okay we have
to make sure that both sides are capped
off with this percent and then greater
than or less than
okay and then in here what we can do is
let's actually put a ul on the outside
okay and then inside what's inside we'll
have allies and in here now we want to
use the equal sign because we're
actually outputting and actually I need
to put in here user okay of course that
could be whatever you'd like but
obviously user makes sense
so we'll say user dot first-name just
like that okay we'll save it reload and
now you can see that it's printing out
each user's first name okay if we want
the last name I can copy that paste that
in change that to last name and now we
get the users first and last name now I
was going to try to fit in an example
from POG or Jade or some other template
engines but we're really running low on
time here
and it's basically the same kind of
thing you just want to set up the
middleware in the app j/s file right
here and then go ahead and just call
render res dot render whatever the view
is if you're using pug
I think the extension is still dot Jade
but I'm not sure you just want to
include the correct extension and then
just use the syntax that that particular
template engine uses alright so what I
want to do now is get into forms and
input alright so let's go back to our
index and I'm going to go right below
the header up at the top here and let's
put in an h3 h3 now let's do an h1 and
we'll just say add customer
and then we're going to put in a form
here so just standard HTML we'll have a
first name be an input with the type of
text and let's see we're going to give
it a name of first name okay they'll do
a line break let's copy that this will
be the last name and then we'll have the
email okay we're going to want to put a
submit button here so we'll say input
type is going to be submit and value
value will also say submit all right
let's put blind breaks here okay if we
save that there's our form let's put
line breaks after the label as well all
right now in our form tag up here we
need to specify a couple things one's
going to be the method okay the request
method is going to be post and then the
action is going to be the route that we
want to submit to so let's say we want
to users slash ad all right so if we
were to save that and then we'll go to
app J s and we have to catch that
submission so it's a post request so we
need app dot post and then the actual
URL is going to be slash users slash ad
okay and then we'll have a callback
function just like we did above and
that's going to take request response
and just to test things out we'll just
say console dot blog and it'll say form
submitted okay save that reload submit
and if we look down here you can see we
get form submitted alright so what we
need to do is we want to obviously grab
the values that are typed in here all
right now to do that very easy let's
create actually you know what let's say
console.log and then we'll do request
dot body dot first name what's that what
happened oh I went to users add all
right so request up body dot first name
so let's put in Jeff okay these don't
matter submit and you can see we get
Jeff so that's how you can access the
actual value now the first name right
here where that's coming from is the
name attribute alright now what I'm
going to want to do is take those values
and then have an object create an object
so we'll save our user let's say new
user equals let's see new user equals
and then we'll say first name will be
request dot body dot first name
then we'll have last name and email okay
so when that forms submitted its going
to create this new user and we can test
it out by console logging okay so let's
say Jeff Smith okay if I was to submit
that and look at the console you can see
that we're getting that object now in a
production application you're probably
going to want to use some validation for
your forms for your input all right now
there's there's a few different options
for that you could do it manually and
then there's a bunch of modules you
could use and the one that I'd actually
suggest to use with Express is actually
expressed for the alligator alright so
let's go to the github page here and to
set this up we're going to go ahead and
run this NPM install commands so let's
go and stop this with control C will say
NPM install Express validator and then
dot dot Save
okay so we'll run the application again
with node Mon and if we look in package
Jason you can see that we have Express
validator alright so now we need to go
back to our app J s and we need to first
of all require it up here so we're going
to save our Express validator and then
put in our require all right now this
has middleware that needs to be added as
well so if we look down here this is all
the usage but if we scroll down a little
more you can see the middleware options
so what we want to do is grab this block
right here okay we're going to copy that
and let's bring this down to right here
put in a little comment here so
basically it's just setting up the error
formatter and so on now once we do that
we should be able to go down to our add
function here and we should be able to
set some rules for our field all right
so to do that let's see
yeah we want to do this right here
request check body all right so let's
say request dot check body and then we
want to put the field that we want so
let's do first name and then second
parameter is going to be the message for
this particular rule so let's say first
name is required okay and then we just
want to add to the end here the the
actual rule that we want and this is
going to be dot not empty okay so should
be able to do that and that's going to
specify that first name now is required
and let's do the same for last name and
email so we'll copy that okay this one
will be last name and then this one will
be email all right then what we have to
do is put a variable called errors and
set that to request dot validation
errors
and then we want to check to see if
there's any errors so we'll say if
errors then we want to do something else
if there's no errors then we just want
to do this create our object create our
object and then we'll say console.log
success all right and for now we'll
check for errors and we'll say
console.log hours okay now we'll get
more specific but just to test up to
this point let's go ahead and try this
all right so let's see go back make sure
our server is running and let's just to
test actually we'll just try it we'll
leave it blank and submit and then down
here you can see that we're getting
errors all right so that's good if we're
if we do fill in all of these and submit
we get success so we know that the
actual validation is working so now it's
just what do we want to happen when
there's errors all right we obviously
want these messages that we wrote to be
output on the screen so we'll just want
to re-render this view so up here let's
grab this actually you know what no yeah
that's good we'll just take the hold
this whole thing and then put it in here
and let's see that's good and then we
also want to pass along the errors
themselves okay Oh
so if we to submit it just kind of rear
Enders the form for us all right now
what we want to do is since we pass
those errors in let's go to our index
ejs file let's go right above the form
and we're first going to check to see if
there's ours so we can do that by going
like if hers okay remember we need to
begin and end these lines like that so
if there's errors then what do we want
to do we want to loop through them just
like we did with the users so I'm just
going to copy this hole for each and
then we'll just change users to errors
and here we'll say error and let's see I
think put you ELLs I think that what we
want is going to be error dot msg all
right now if I'm not mistaken if we try
it now we save it and we try to go to
localhost 3,000 yeah we get an error
okay it's saying errors is not defined
and I'm pretty sure we need to just add
errors as a global variable so if we go
back to our app j/s and let's go right
above the validate our middleware say
global VARs and this has to be put in
its own middleware so app dot use and we
should be able to put function
and this is going to have request res
and next and then all we want to do is
set a global variable so I'm gonna say
res dot local dot errors and by default
set it to null all right and then we'll
call next okay and then any other global
variables that you want to add to your
application you can put in here just use
this res dot local dot whatever all
right so let's save that and cannot set
property errors of undefined oh it needs
to be locals plural there we go all
right so now if I submit there we go
there's our required messages okay if I
was to fill out just first-name we get
the other two if I fill out the first
two we get email if I fill out all of
them well then we should see in the
console success all right so that's how
Express validators works all right so
let's see we're running out of time here
so what I'm going to do now is move on
to working with a database and we're
going to be using MongoDB all right now
if you don't have MongoDB installed what
you want to do is go to MongoDB comm
click download and you can see those
options for Windows Linux and Mac if
you're on Windows go ahead and download
it just install it using the MSI and
then you should be all set I do have a
video showing you how to install MongoDB
in Windows and I think I have one on
Linux as well so I already have it
installed so I'm not going to go through
the
but get that set up and then what we'll
do is I'm going to open up a command
line all right now I'm going to just
open up a standard Windows command line
because for some reason I get issues
when I use that get that get bash
utility with MongoDB but what I'm going
to do is navigate to where I installed
it which is in my C Drive MongoDB and
then in there we should have a bin
folder so we want to go into bin and
then I'm going to run the Mongo shell
all right so from here we can do
commands like show DBS you can see all I
have is this local and test DB so I'm
going to create a new one and we should
be able to do that with use so use and
I'm going to call it customer app so you
can see it's a switch to DB customer app
and then I want it to create a
collection so I'm going to say DB dot
create collection and I'm just going to
call this users okay so now if we say
show collections you can see I have
users all right now what I want to do is
just insert a user so to do that we'll
say DB dot users dot insert okay and
then in here actually let's make this an
array okay first user object will have a
first name
of John then we'll do last name dough
and then whoops email okay there's one
user put a comma here and then the next
one will say yeah okay and we'll do one
more say Kevin all right go ahead and
add that and let's see and inserted
three so now we'll do DB users dot find
okay so now we have three users in the
MongoDB database and you can see it
creates this this object is underscore
ID which is equal to an object ID and
then we have our first last and email
okay so now that that is done we want to
be able to bring our database into our
application now there's a lot of
different Oh our M's that we can use
Mongoose is a really popular one but
we're going to stick with a really
simple one called Mongo Jas all right so
down here let's see all right so first
thing we want to do is install it so
just close these up
and let's go to our get Bosch utility
and we're going to do NPM install Mongo
j/s and save alright so now that's
installed let's go ahead and run node
Mon and we're going to open up our app
j/s and just like it says here we need
to require it so we'll put that in right
there and then let's grab this and paste
this in okay so the connection string
let's replace that and we should be able
to replace that with customer app I
think and collections will add users all
right and then if we go down here you
can see this query here is going to find
everything so let's go down to go down
to where our home route is and let's
grab this copy it ok we want to change
this to DB users and then in here is
where we'll have an array of all the
documents in the collection so for right
now let's just do console dot log Docs
alright and then we want to move the
render into there
oh all right so let's save that and go
back to our application oh we get to
start the server
what's this customer our app is not
defined all right so the actual name up
here we gotta put in quotes like that
okay and now if we look in the console
you can see that we're getting the users
from the database okay so that's coming
from our console log right here now what
I want to do is instead of including
this static array of users let's include
Doc's
which is coming from the database okay
if we save that and reload now you can
see we're getting our users from the
database and if I can now get rid of
these that and there we go so we you can
tell if these are fetched from the
database because they're different names
all right and if I was to open up the
console again and then just let's see
I'm just going to um I just want to add
one more user from here change this to
Jen Williams
okay and now if we go over here and
reload now you can see we get Jen
Williams so we're now talking to MongoDB
now if we want to be able to add a
customer we can do that as well let's go
back to this documentation and let's see
we want insert if they have an example
okay so right here insert so let's go
down to where our ad is and we want to
go right here where we're just creating
the user and then we want to just say DB
dot users dot insert okay and then in
here let's say new user and then we
should be able to put a callback
function so the function will take error
and result and then what we'll want to
do here is check for an error and we'll
just console.log it okay and then if
there's no error let's just redirect so
we can say red dot redirect and it'll go
back to slash all right so let's give
that a shot
so say Ted Ted Wilson
and submit and there we go Ted Wilson if
we reload he should stay there so that's
how you can not only read from MongoDB
but we can add customers to the database
now to make a delete request is a little
more tricky all right because we can't
just put a link that's going to just go
and just fire off a delete request what
we need to do is well there's a few
things we can do but what I would
suggest doing is using something like
jQuery or just regular JavaScript to
make an ajax to make a delete request
through ajax all right so that's what
we'll do I want to try to do this pretty
quick so we can wrap up but what we want
to do is in customers let's see and the
index let's see let's go right after the
last name and we'll put an a tag here
we'll just send that to nothing and
let's see we're going to say delete
okay so now each customer has a delete
link now what we want to do is we want
I'm going to use jQuery to tag to create
a click event for these delete links all
right so let's go to header ejs and
we're going to include jQuery here let's
grab the CDN so copy this okay save that
and then what we're going to do is go to
public and let's create a folder called
j/s and then inside j/s we'll create a
file and save it as main dot j/s all
right and then we want to also include
that in the header so say script source
and since it's in the public folder we
can just say je s slash main dot J s
alright and just to test it out let's do
an alert one okay so now we know that
that's linked and now what we want to do
is we're going to use jQuery so let's
say document dot what not that we want
to talk you mndot ready
passing a function and we're going to
add a class to that link that we created
so we'll say class equals and we'll say
delete user ok now inside here we're
going to use jQuery and I'm going to say
dot delete user dot on and it's going to
be a click so on click and then we're
going to create a function called delete
user all right and this is wrong this
ending parenthesis should actually be
right here okay and then down here we're
going to say function delete user and
let's just do an alert save that so if I
click one of these you can see we're
going to get an alert all right now
we're going to need a way to to send
along the users ID with this with this
click ok so what we can do that is by
adding on an attribute to the a tag here
so we're going to add a data attribute
I'm going to say data - ID and we should
be able to use ejs here and say user dot
underscore ID just like that save that
now I want to have a confirmation before
we actually do the delete so let's save
our confirmation and we're going to set
that to confirm we'll just say are you
sure and then below it we're going to do
an if statement checking for that
confirmation and let's just test it up
to this point ok asks us ok and we get
the alert all right so now what we want
to do is make an AJAX request using
jQuery it's really easy we can say
dollar sign dot Ajax and in here we'll
pass in a little like that and the type
that we want is going to be a delete
request and the URL is going to be slash
users slash yeah we'll do users slash
delete
slash and then we have to add that ID
now since we put it how we attach it to
delete user to this class right here
then we're going to concatenate on like
that and we're going to say delete user
dot data and then pass in ID all right
because remember we use that data ID
attribute this is how we can actually
grab that all right and then down here
we're going to say dot done
passing a function and here we'll get a
response and then we're going to
redirect by saying window window dot
location dot replace and pass in a slash
for the home page and then for this
confirmation we're going to do an else
and if they say no then we're just going
to return false
all right so that that should do it
let's save it and then what we'll do is
go to app J s and we have to make that
delete route
so we'll say app dot delete and then
remember we submit to slash users slash
delete slash and then we're going to do
: ID ok because remember the the ID of
the user is unique and that's going to
get passed along in the URL so then
we'll put a function and let's do
request response all right now we need
to get that ID so I want to just do a
console log here and we're going to log
request dot params dot ID all right so
let's save it up to this point and if I
click one of these are you sure ok and
then let's look at the console ok so
it's giving us undefined ok so it looks
like this is undefined for some reason
let's see oh I didn't put a dot here for
the class let's see if that makes a
difference so delete look at the console
still undefined Oh No
up there we go ok so now we're getting
the object ID if I press this one delete
ok and we get her ID
these just know these are different good
all right so it looks like the IDS going
through so we're almost there now we
just need to do the delete query so back
in app J s you can get rid of this and
we're going to say DB dot users dot
remove all right and then I think in
here what we need to do is put an object
say underscore ID and then we have to
say object I'm pretty sure we have to
put this object ID and then pass in
request dot params dot ID all right and
then the next parameter will be the
callback okay so when here we'll put an
error and we'll check for the error okay
and then we just want to redirect all
right let's give it a shot
we'll save reload see we don't want Ted
Wilson click OK all right so he didn't
delete let's see if we got anything here
object ID is not defined so that's
that's not working oh you know what I
think I have to do is go let's go up
here to the top and create a variable
called object ID and then we're going to
set that to Mongo J s dot object ID
let's do that
nope
property ID undefined
Oh should be params
huh
request params ID
Oh what happened oh that's not right
okay so it deleted the wrong person
I'm actually going to check this out and
I'll be right back alright guys so as I
was able to find the issue and the issue
is in the main dot J's file that's in
our public J S and the reason that it's
deleting the wrong one it's it's always
deleting the first user because they're
all getting the same ID the reason for
that is you can see right here we're
choosing them by the class delete user
and if we look in our index file they
all have that same class so it's what
it's doing is it's just grabbing the
first one and deleting it so the
solution for that is to change this from
the dot delete user to just this and
that'll grab that particular user or
that ID all right so if we save that and
reload
if I click delete you'll see Mike is
still there if I reload he goes away all
right so the delete is working it's just
afterwards it's not refreshing the
reason for that is for some reason we
this isn't running it's going right
after it so what we can do is just copy
that and then paste that right there and
then save it reload let's go ahead and
add someone we'll just put whatever okay
and now we'll reload click delete okay
and now they're gone all right so we can
now do we can read we can delete and we
can add customers all right so this has
gone way longer than I expected I
apologize for that
hopefully this wasn't too confusing and
what I would suggest is that you try and
make it so that you can update these
customers as well all right that's kind
of a little task that you guys can do if
I have the time I'll figure it out and
I'll paste it in the description
okay so that's going to be it hopefully
you enjoyed this crash course on Express
j/s and I will see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>