<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LoopBack REST API with Authentication | Coder Coacher - Coaching Coders</title><meta content="LoopBack REST API with Authentication - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LoopBack REST API with Authentication</b></h2><h5 class="post__date">2017-09-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/UTxhKZuVaG8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's going on guys so I'm planning
on building a full stack application
with loopback which is a nodejs
API framework along with probably react
on the front end I'm not sure yet now
this is gonna take me a while and I'm
not sure if it'll be a youtube series or
a udemy course but anyways I've been
experimenting with loopback and I just
want to give you guys kind of a
practical tutorial and introduction to
it so what we're gonna do is we're gonna
create a restful api using loopback
where we're gonna connect the MongoDB
connector so that we can actually work
with the MongoDB database
all right loopback can work with just
about any database we're gonna use
MongoDB I'm also gonna show you how to
restrict parts of the API with user
authentication now when you build a
restful api with let's say just node and
express one of the biggest pains in the
asses is setting up token-based
authentication handling on the server
side and loopback gives us that right
out of the box which is pretty awesome
so we're gonna have a user model with
predefined routes to get an access token
and then we can basically choose what -
you know what we want to restrict with
with that token with that authorization
so that's what we're gonna be doing in
this video now I am using Linux Ubuntu
but you can follow along in Windows or
Mac the only two things you need
installed are nodejs and MongoDB alright
I'm not gonna go over installing those I
do have videos showing you how to set
those up but just make sure you have
those two things set up alright so let's
go ahead and get started now the first
thing we need to do is install the
loopback CLI we have the command right
here on the home page of loopback I oh
so we need to do that you want to go to
wherever you want to create your project
actually this command doesn't matter
because it's global but you do want
somewhere where you want to create your
project folder in a second so I'm going
to run this command I'm going to say
sudo because I am on Linux and then I'm
gonna do NPM install - JEE
loopback - CLI all right now I'll get
that set up for us that'll give us
access to the elbe command where we can
create models and generate our
application and do all kinds of stuff
all right so now that that's setup what
we're gonna do is create a new
application so I'm in my projects jas
folder this is where I create my
JavaScript projects on this machine and
what I'm gonna do is just run elbe okay
just just lb and then enter so this is
gonna ask us some questions now one
thing I want to make excuse me one thing
I want to mention is that if you're on
Windows and you're using git bash you
might have some issues with when there's
questions with with selections and you
need to move the arrow up and down it
might not work if that happens just go
ahead and run the standard Windows
command line not get bash okay I just
wanted to mention that because I did run
into that issue so the name of our
application let's call this meetups okay
so we're gonna say this is an API for an
application to list meetups or like you
know whatever react meetups or angular
or whatever so we'll hit enter the
directory the name of the directory
that's fine
which version we're going to choose the
latest which is 3x and then here is
where we can choose how we want our
server to be set up and this is where
you may have some issues and get bash in
Windows we're gonna choose the API
server and this is going to be just a
standard API server with local user
authentication okay so this is what's
going to give us all that token-based
crap that that we're not going to have
to set up on our own okay but you can
also choose an empty server you can
choose the hello world some other stuff
but we're going to choose the first
option API server and it's going to go
ahead and it's going to generate all of
our application files alright and then
what I'm gonna do is I'm going to open
up visual studio code and we're gonna
open that folder up so let's go to
projects Jas and meetups
all right so this is the the structure
it generates let's see how we're doing
okay still going all right so to run the
application we of course need to see the
into that folder which is meetups and
then we can just do node a node dot okay
so it's gonna start it up on port 3000
now if I go over here and I go to
localhost port 3000 it's just gonna give
us basically a timestamp and an uptime
this is this is nothing what we want to
do is we want to go to slash Explorer
because this is the client that we can
use to actually make requests and we can
we can pretty much do everything from
this from this a this GUI right here
which is really nice you'll see if I
click user it gives us all of our user
based routes so we have a login route
logout even things like change password
we have all of this stuff built into the
API and this would take a ton of work to
do on our own with just node and Express
alright so let's take a look at some of
these files now server obviously look
server is obviously where our server is
if we look at data sources Jason by
default it just uses memory ok so
there's different data sources you can
install you can use Mongo which is what
we're gonna do you can use MySQL Redis
postgrads
I'm pretty sure you can use any database
but the default is just memory which is
not what we want so we're gonna install
the Mongo connector alright and then
once we set up a model we'll have a
common folder that'll have our model
files in there alright inside the boot
folder we have our authentication j/s if
you're going to use authentication this
has to be here the server dot enable off
let's see what else we have our config
file so let's see our API it's going to
be at slash API
and I think that's really all I want to
go over right here and this is where all
the ACL all of the access control stuff
will go but what we're gonna do now is
we're gonna set up the Mongo connector
so let's go back to our command line
here our term an Olmec I'm gonna stop
the server with ctrl C now you're going
to want to make sure Mongo is running if
you're on Linux you can you can do sudo
service Mongo D start ok that'll start
it up and what we're gonna do is we're
gonna do let's see let me just check
this real quick so we're gonna say sudo
npm install we're gonna do - - save save
it as a dependency and then we're gonna
say loopback - connector - MongoDB up
connector - MongoDB alright so we're
gonna get that installed alright let me
clear this up once that's installed
we're going to use the elbe command and
we're gonna say data source and then I'm
gonna call this Mongo D s ok so Mongo
data source and then we're gonna add the
connector flag so - - connector and then
we want the Mongo DB connector
ok so enter the data source name that's
fine Mongo D s click enter alright now
here's where we need to select what type
of data source it is if we go down
you'll see there's options for Cassandra
Redis MySQL Oracle we're gonna choose
MongoDB alright so we're gonna choose
that we're gonna hit enter for a host
let's say localhost port the default
port for Mongo is 2 7 0 1 7 user we
don't need that password don't need a
database I'm going to call it meetups
and we should be good all right so since
we did that if we go back over to the
data sources JSON file you'll see now we
have the Mongo des all right now what
I'm gonna do is I'm going to just get
rid of this and change this to dB
okay so I'm gonna change that to DB and
get rid of this and the reason I'm doing
that is because it's going to refer to
DB in other places like if we go to
model config you'll see data source DB
so instead of changing all of these I'm
not going to be using that memory data
source anyway so I'm just gonna change
that there all right and that should be
good so make sure that that file is
saved and then Mongo DB should be hooked
up to our API all right so the next
thing we want to do is create a model
let's close that up so if we create a
model it should show up in our Explorer
so let's go back to our terminal clear
it up
and we're gonna create a model called
meetup because we want to be able to
list meetups so to do that we do lb
model enter and it's gonna ask for a
model name so we're gonna call it meetup
okay and then you'll see that we
actually have DB as an option which is
Mongo DB so we're gonna click enter and
then the type of model or the class of
the model is going to be persisted so
enter expose the meet up via REST API
we're gonna say yes custom plural form
we're just gonna hit enter there and
then common model or server only we're
gonna choose common alright and then we
can add some properties so for our
meetup we want a name
alright so we'll say name enter we can
choose a type I'm gonna choose string is
it required yes we'll say required and
leave blank for default click enter and
then let's add one more property of city
ok I'm going to keep this really simple
that's also going to be a string and
it's also going to be required alright
so what when you're done adding
properties you can just click enter and
it'll get you out of that screen
all right so now if we go over here and
we look in common we have a models
folder with our meetup je s and we have
a meetup JSON file okay so this is gonna
hold all that ACLs the access controls
and all that stuff all the properties
you'll see the name and city properties
here and of course you can edit these
files directly you don't have to use the
CLI of the CLI just makes it much easier
alright so what we're gonna do now is
we're gonna start our server back up and
we do that with node dot and then let's
go back to our Explorer and reload and
you'll see now we have Meetup okay so
now we have meetup and it gave it gives
us all these routes so if we want to get
meetup so we can actually click right
here and it gives us it tells us what it
includes it concludes a name in a city
which is what we put in also an ID okay
with MongoDB it'll it'll automatically
put in a unique object ID so if I click
this button here try it out it'll
actually make the response you can see
it gave us a 200 status back which is
good but there's nothing there because
we didn't we haven't added any meetups
yet now we can access our API outside of
Explorer by just going to localhost 3000
slash API slash meet-ups
and that's the same thing we're just
making a get request to meetups and we
could do this through postman or through
we could do this through reactor or
anything that makes HTTP requests
alright so let's go ahead and add a
meet-up so we'll go down to post and
we'll go down to where it says data and
we're just going to input some jason
here so let's say the name of the Meetup
and we'll say angular meetup and we'll
give it a city okay it has to be JSON
format make sure you use double quotes
here and we'll say Miami alright we'll
click try it out we see we get a 200
response and we get the actual the
actual record back with an ID okay so
now if we go back up to get
so get meetups and we click try it out
you'll see that we get our angular
Meetup all right and just to check it
out in MongoDB let's go ahead and let's
open up another command line here and go
into the Mongo shell and we'll say show
DBS and you can see we have meetup so
we'll say use meetups and let's say show
collections we have a meetup collection
so we'll say DB dot meetup dot and there
it is angular meetup so we're connected
to MongoDB we're able to make requests
and we're able to persist to the
database all right so I'm just gonna get
that out of there all right so we now
have a full restful api where we can
make post requests we can make put
requests and all that so what I want to
do now is just go over a little bit of
authentication so up to this point
anybody can do anything right let's make
it so that you have to be authenticated
to do anything with the meetup model so
to do that we're just going to go back
to our terminal let's get out of this
with control C and then what we're gonna
do is we're gonna say L be a CL all
right and then it's going to ask us what
model we want to apply these off of this
authorization stuff to so we're going to
choose meetup and we're gonna say all
methods and properties and we'll say all
and then we're gonna say any
unauthenticated user anyone that's
that's unauthenticated we're going to
explicitly deny access all right so once
we run that we can go ahead and run our
server again and let's go back to
Explorer
let's go to meet up and let's click get
and let's try to make a get request and
we get authorization required okay so
we're not allowed to do this anymore if
we even go over here and we try to do it
we get an error okay so what we need to
do is we need to actually
log in and get an access token okay now
this is something that you would also
implement in your front-end you'd make a
request to two users to get your access
token
you'd make a post request get your
access token and then you could make
requests to meetups all right and this
makes it much easier the loopback makes
it very very easy to implement this on
the backend so what we'll do is we'll go
to post users and we're gonna create a
user so go down here we'll add some
Jason all we need to add here oops all
we need to add here is an email and a
password so we're gonna say email let's
say Brad at gmail.com and then we'll put
a password and the password will say one
two three four five six and say try it
out and you'll see we get back a
response here alright now we created a
user now we can log in with that user so
let's go down to the user login route
which is right here click on that we're
gonna go to credentials put in our JSON
object
so we'll say Brad at gmail.com oops
need to put email first so double quotes
email
and then we have our password okay so
notice if I put a password that doesn't
work we're gonna get a response that
says logging failed okay if I put the
right one four five six we're gonna get
a response and we get this ID right here
this is actually gonna be our access
token so when you build your front-end
application you're gonna want to take
this and you're gonna want to store it
in local storage or something like that
so that you can use this to make further
requests all right but what we can do in
this Explorer is we can just take it and
we can put it up here and paste it in
and say set access token and now it says
token set all right so now what we'll do
is go back to meetups and go back to get
and then we're gonna click try it out
and there we go we can get it because
we're now logged in in the backend we
have our token set all right so we can
do anything we want now with meetups
because we're essentially off to our
authorized alright and we even have a
user's logout route that we can go to so
if we go back to user go down to let's
see right here logout and we click try
it out it's gonna log us out and then
you want to go up here and you want to
just clear out the token and then say
set access token and now our token is no
longer set so if we go and we try to do
get meetups again we're gonna get
unauthorized all right so what if we
want to make it so that anyone can get
meetups can see them but only authorized
users can update them and add them and
things like that so if we go over to our
files here and we go to our models and
then meetup Jason when we did that whole
lb ACL thing and we added those
permissions this is what it added okay
it added this object here saying that
unauthenticated users are denied so we
can actually just clear this off so what
I'm gonna do is just completely get rid
of this and that's going to basically
just reset it it's going to
get rid of those permissions that we
added so I'm going to save it and then
we're gonna go back to our command line
and we're gonna do the same thing we're
gonna do lb ACL okay we're gonna do it
for the meetup we're gonna say all
methods and properties but this time
we're gonna say only write only write
stuff so basically post requests and
updates things like that all right we're
gonna say any unauthenticated user is
gonna be denied all right and you can
see that actually got added to that file
and you can MIT like I said you can
manually add this stuff in the files you
don't have to use the CLI but now even
though we're not logged in we should
still be able to get meetups try it out
Oh what are we doing here actually is
the server running no the server's not
running all right so let's reload this
okay so we can get a meet-up now we're
not logged in so let's try to add a
meetup we're gonna go to post meetups
let's go down here and let's say whoops
keep doing that let's say name react
Meetup
let's give it a city
and we'll say Boston try it out and we
get author authorization required
because we're not logged in and we set
it up so that we can read but we cannot
write unless we're logged in so let's go
back and and let's login so we'll go
back to user we'll go down to let's see
post users login put in our credentials
remember it's stored in MongoDB so we
don't have to recreate the user so it's
whoops email Brad at gmail.com and
password password is one through six
okay we'll try it out there's our
response let's grab our token pass it in
there set it and now we'll go back to
meetups and now we'll try to post a
meet-up so post meetups we still have
the data in here so now I'm going to try
it now that we're logged in and there we
go react meetup so since we only need to
be authorized to do write stuff right
methods we should be able to go like
that and we can see our our angular
meetup and our react meetup alright
hopefully this is making sense to you
guys and if you've ever built a restful
api if you watch the mean stack
front-to-back series that i have you'll
know that doing this kind of thing is a
real pain in the ass when you have to do
it all manually so loopback is a really
nice technology and I look I really look
forward to building something with it
well I should say building a full stack
application because we actually are
building something right now we are
building an actual back-end it's very
simple but it is an actual back-end all
right this is a lot more you can do you
can even build you can even create
static pages on your application here
you can do a lot of things the
documentation is pretty good the only
thing I'll say about it is there is a
lot of information
so it's a lot to soak up and it can be a
little overwhelming but there is a lot
there if you take your time and you look
at it but I will be doing more videos on
loopback in the future I do want to do
more full-stack videos I'm working on a
full stack node application with with
react with Google OAuth and some other
stuff so be on the lookout for that and
I think that's it so I'm not gonna put
this code in a repository or anything
because it's very general that we didn't
really do much with the actual code we
worked mostly with the CLI and with the
Explorer so what I'm gonna do is in the
in the description I'm gonna paste all
of the commands that I ran alright so
you guys can kind of follow along and
you have those commands there alright or
I might but just paste a link to a text
file I don't know but thanks for
watching please subscribe if you're not
please leave a like if you liked this
video and that's it I will see you guys
next time
so if you guys really like my videos and
you learn a lot from them and maybe you
have a couple extra dollars to spare
check out my patreon page I'm working on
creating special content for patrons you
also get special deals on future courses
and there's even an email support tier
for all YouTube videos and projects to
learn more visit patreon.com slash
travis e media</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>