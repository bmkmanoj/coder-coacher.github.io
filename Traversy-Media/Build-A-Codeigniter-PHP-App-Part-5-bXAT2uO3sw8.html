<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A Codeigniter PHP App - Part 5 | Coder Coacher - Coaching Coders</title><meta content="Build A Codeigniter PHP App - Part 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A Codeigniter PHP App - Part 5</b></h2><h5 class="post__date">2017-03-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/bXAT2uO3sw8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to part 5 of the
CodeIgniter blog application series in
the last video we went ahead and made it
so that we could add categories from our
application and we also added the
categories link here so that we can view
the categories by name and we can view
the posts in each category so what we're
going to do now is we're going to add
comments functionality to our blog posts
ok we want to comment form down here we
also want to list the comments for each
post now there was a small mistake that
that I had on the github page here in
the SQL I wasn't putting the primary key
for the post table or Auto increment on
ID so if you if you cloned this
repository and you used this SQL dump
right here you're going to need to add
the primary key for ID and the auto
increment to your database ok so this is
the database here and if I click on post
you'll see there's an idea of zero and
this isn't the primary key so what I'm
going to have to do is delete the
current post so if I go to SQL and I'm
going to say do um say delete from post
where ID is equal to zero and we'll run
that so now we shouldn't have any post
in the table and I'm going to go to
structure and let's click change for the
ID and we're going to add Auto increment
right here and then we're also going to
we're going to make this the primary key
so what's let's click Save here oh you
know what we have to do the key first so
let's just click C primary and ok and
then we want to add Auto increment so
we'll go to change and let's go to AI
and save okay so now it's the primary
key and it's Auto increment and if you
didn't clone that repository and use
that that's qol duck then you should
be fine you won't even have to do that
alright so now that that's done let's go
back to our front end here and I'm just
going to we have no post now so I'm
going to just create a couple say blog
post one and I'm just going to grab some
dummy text generate a couple paragraphs
here all right so save that and say
technology and choose an image and just
going to grab this bun to file and there
we go
all right we'll create one more say blog
post to we'll just change this up a
little bit okay and I'll choose business
and grab an image and grab this quote
igniter image and there we go so now we
have two blog posts now we're going to
create a new controller and a new model
so this is the file structure here let's
go to application and controllers and
then create a new file here and we're
going to save it as comment dot PHP all
right and then in the model models
folder we're going to create a file and
save that as comment underscore model
dot PHP okay and we'll have that open as
well now when you create a model you
need to add it to the autoloader so
we're going to go to config and then
auto load dot PHP go down to the bottom
here and we're going to just add comment
model okay I save that close that up
so let's now add the form to the blog
post so the view is going to be in views
and then posts and view dot PHP okay
this is the single blog post view and
what I'm going to do is just add an HR
down here at the bottom and then we'll
put an h3 and I'll say add comment
we're also going to have to add a
comments table to the database so let's
do PHP echo form open Thanks form open
and in here we want to put where we want
to submit to so that's going to be to
the comments controller and then to a
function called create and then we also
want to put the post ID in here so it
knows which post to use so you can get
that with post and ID all right so
that's the opening form tag and then in
here let's create some field so be class
of form group okay and this is going to
be the user's name let's give it a label
of name and let's give it an input type
of text and the name of name and a class
of form control
alright now we'll just copy this and
then we're going to have the email and
then let's paste in one more and this is
going to be the body of the comment and
this is also going to be a text area
all right okay let's do the input button
submit and let's see just have it click
Submit
and it's also give it a bootstrap class
of BTN BTN primary now we're also going
to want to send along the slug because
we're going to have some validation and
if it doesn't validate we need to reload
the view but we need to also reload the
post which has a slug in the URL so we
need to tap that along so we're going to
do that in a hidden input so this will
be type hidden' and the name will be
slug and then the value we're going to
do PHP echo post slug and that will pass
that along all right so let's save this
and let's reload okay let's see comment
model just what doesn't the class
because we haven't created the file yet
all right or we have it added the code
to the file the class so let's do that
so we don't get that error anymore we're
going to shape HP and create a class of
comment on the score model and that's
going to extend c i underscore model
alright and let's let's do constructor
so public function struct
and let's just make sure the database
library is loaded all right now that
error should go away and now we have our
comment form all right so let's go ahead
and create the comments table so make
sure you're in the correct table and
we're going to add down here comments
and save five columns click go and then
we're going to put in an ID which will
be an int you want to make sure that
this is your primary key and also Auto
increment all right and then we're going
to have the post ID they have to know
which post the comments bar and then
we're going to do the name the username
and email body okay this will be a
voucher with two and then this will be
text and biochars need the length I'm
just going to put 255 I want to add one
more so I'm going to go to right here
and click go
and this is going to be the create or
let's say created at and this is going
to be a timestamp and then for the
default we're going to choose current
timestamp all right so let's save that
now we have a comment table all right so
when this form is submitted it's going
to go to the comments controller a
method called create and ID is going to
get passed in as a parameter so let's go
do that so this is the controller and
we're going to say PHP class comment and
that's going to extend c i underscore
controller and then we're going to put
our create function so public function
create
and remember that that's going to take a
post ID all right so what I want to do
is get the slug and remember we sent
that as a hidden field and I'm just
going to put that in its own variable so
we can get all the fields that we submit
using this input and then we want post
and slug okay now we also want to get
the actual post because if the form the
validation fails we need to load that so
let's say data post and we're going to
set that to this post model and then get
posts okay and we're going to pass in
the slug so we're all set for that now
for the validation let's say this form
validation then we want to do set rules
just like we did with the other stuff to
post and we want to get the name and
name is going to and then we want the
readable version of theme which is
capital and names and then we want the
rule which is going to be required all
right so I'm just going to copy this and
let's see the email will also be
required now and the body
and let's also validate the email make
sure it's valid address so we just have
to change this to valid underscore email
alright so there's our rules now we want
to check see if it passed so we'll do an
if/else and we're going to test if this
form validation run is equal to false
okay if it hasn't run or if it's failed
to change that then we want to just
reload the view so let's say this this
load view
and in here we want to put the header
which is in the folder called templates
slash header and we'll just grab copy
that and we want the footer here okay
we're loading the header in the footer
and then the view is going to be post
slash view and then we want to pass
along that data like that okay that way
we can access the post from inside the
view all right now in the else so if
everything goes okay and it validates
then we want to call a model function so
this comment the score model actually
that should be a lowercase P so this
model and then we're going to have a
function called create comment okay and
that's going to be passed in the post ID
and then we're simply going to redirect
and we want to redirect the same post
we're on so we're going to say post
slash and then we just want to
concatenate the slug and that will bring
us or that will keep us on that page all
right so let's go ahead and save this
now our form validation needs an output
and we don't have one yet
on the view page so let's go to views
post view PHP and we're going to put
this right under the add comment h3
alright so we just want to put PHP echo
form sign up form validation underscore
errors okay and it'll save that so now
we need to create our model function so
it's going to be public function creates
comment and that's going to be passed in
the ID the post ID so now we want to
create an array to submit okay so let's
say data equals array and we want to set
in here post ID which we're going to set
to that variable post ID all right and
then we want the name okay that's coming
from the form so we can save this input
post name and I'm just going to copy
that and we're going to do the same for
the email and for the body
okay this will be body good so now we
have our array and then we need to
insert it so we're going to say return
this this DB insert and in here we want
to pass in the table we want to submit
to it which is comment and then we also
want to add the data and that will do
our insert so let's save that and then
we can try it out
so reload here and add a comment
so first we'll try submitting the front
property comment post model and then it
lays this post model okay so this should
be lower case
try that there we go so if I submit you
see we get the name fails required the
body field is required
I'll see what I did wrong here name name
equals name email also this should be
body right here name equals body still
not reading the email though huh
alright you know what I think it is guys
because we have two of these I think we
can actually just pipe this in and say
valid email I think we can do that and
then just get rid of this let's try that
so submit and all it didn't work either
all right that's really strange if you
guys I'm just going to take away the
valid email if you guys know why the
hell it's doing that please let me know
because if we do this then it works it's
just not allowing multiple multiple
rules for some reason but whatever let's
just deal with it all right so let's say
you'll say John Doe and email Gmail and
body we'll just say it's a great post
and submit okay so we're not going to
see it here yet because we haven't added
that functionality but let's look in the
database comment and there it is ID one
post ID is to name email body and a date
good so what we want to do now is
provide the functionality to show the
comments in the blend the posts so let's
go to let's see we're going to go to our
post controller and we want to be in the
view function that's the single post
view and we want to grab the comments
now we're going to need the post ID and
we can actually just grab it from this
because this is getting a single post so
let's create a variable called post ID
and we can set it to data post and then
we want to be specific and we want the
ID okay and then we can do we can get
our comment so we want to put that in
the data array as well comment and set
that to this
comment model this comment model and
then we're going to have a function
called get comments and that's going to
be passed in the post ID so let's save
that and then let's go to our comment
model and create get comments so get
come to score comments okay and it's
going to be passed in the ID and what we
want to do here see we want to she's
going to be pretty simple we're just
going to have a query and set it to this
DB get where all right and it's going to
take in the table we want which is
comment and then going take in the
conditions in the form of an array all
right so let's say array and we want to
match post ID with the post ID variable
that's being passed in whoops post I be
ok and then we just want to look the
second of this right that ends there
alright so now we just want to return so
we're going to return the query and we
want the result on the score array
alright so that will give us an array of
comments so let's save that and then
we're passing we're passing the comments
into the view because we're adding it to
the data array and data is being passed
into post / view so now let's go to the
back to the view PHP and we're going to
put the comments above the add comment
form put another HR there and then we'll
put an h3 and we'll say comment okay so
what we're going to have to do here is
use a for each loop and loop through the
comments and display each one so
first of all let's check for make sure
there are comments if there's not then
we're just going to say no comments to
display all right so PHP if and go have
an else as well and then end if okay so
if comments then we'll do what we need
to if there's not then let's just spit
out a paragraph and we'll say no
comments to display okay so in here we
want to do our for each loop so let's
try PHP for each and then we'll end it
okay and we're going to say for each
comment as comment and then let's put in
an h5 right here and we're going to echo
out the body of the comment so comment
body and then we're going to say
actually going to put the name in
brackets and we'll say bye and put some
strong tags in and then by PHP echo
comment name and that's it so let's go
ahead and save that and let's reload
this page and there we go
great post by John Doe I'm going to put
I'm going to wrap each one in a well
class
all right that looks good so let's try
to add another comment will say from
Jane Doe say Jane at yahoo.com and we'll
say thank you for this awesome post
submit and there we go
so now we have comment functionality for
our blog alright so in the next video
guys I think we're finally going to get
to use the login system okay we want
users to be able to register and log in
and manage posts okay so I'm not exactly
sure when that will be hopefully it'll
be soon if I can find the time but
that's it thanks for watching and I will
see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>