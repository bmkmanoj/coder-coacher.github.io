<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular 2 Auth0 Application | Coder Coacher - Coaching Coders</title><meta content="Angular 2 Auth0 Application - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular 2 Auth0 Application</b></h2><h5 class="post__date">2016-09-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/i_dHFvi1BJc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys in this tutorial we're going to
be creating an angular 2 application
that uses the auth0 authentication
system so if you need access control and
authentication in angular 2 I can't
stress enough how awesome austero is not
just the functionality but the analytics
behind the scenes to track users to
build client lists control what content
can be seen by guests and logged in
users it's just a really great system
alright so like with most of my videos
this is based off of a more in-depth
course so this is based off of the 12
project angular 2 course I have which is
my personal favorite and I'll leave a
link in the description all right so I
just want to tell you guys that when you
purchase these affordable courses it
really supports me in the company at
onyx that makes these these courses
possible
I like to get you guys the best free
content on YouTube but if you ever want
to get in more in depth in terms of
coding and extensibility these courses
are pretty great alright so enough of
that let's go ahead and get started now
first thing you want to do is go to off
dot R 0 comm and just go ahead and
create an account alright you can read
through it there's just a ton of great
things that this can do very
customizable and you can use it for all
kinds of different platforms you'll see
this angularjs angular 2 which is what
we'll be using PHP Ruby on Rails and the
list goes on all right so I might in the
future make a video on how to use this
with some other platforms but angular 2
is happens to be my favorite framework
at this time and you guys probably
notice that I've been doing a lot of
angular 2 videos so let's go ahead and
I'm going to click login and like I said
you're going to have to sign up so just
if you click sign up enter your
information here you might have to
verify your email I'm not sure but I'm
just going to login and this is actually
the same interface that our application
will use
and you get this nice dashboard and
there's all kinds of links on the side
here and I don't even know quite a bit
of this stuff but I do know that you can
track your users can see I have one user
for one of my clients and if we look at
that we have all types of information
for that user which happens to be me the
devices that they use their history
locations all kinds of stuff all right
now what we want to do first is create a
client so if we go to clients click
create client and you can name your app
let's just call this just call it ng ng
auth or ng auth zero and then you want
to choose single page web application
and then create alright and then that's
going to give you some options as far as
platforms we're using angular 2 and then
it will give you a nice quick start to
go through a nice tutorial which is
basically going to do the stuff that
we're going to do except we're going to
add some some steps to it all right if
we click on settings that's where you
can get all the information for this
client so we have the name the domain
okay you don't want to change that the
client ID on the client type which is a
spa or a single page application the
only thing we need to do now right here
is we need to add our allowed callbacks
so I'm going to say HTTP localhost port
3000 all right that's what we will be
developing so let's go ahead and save
that alright so now we have our client
now what we want to do you want to make
sure you have no js' installed if you
don't just go to node.js org and go
ahead and download it install it and get
that set up that will also include NPM
which we'll be using to to install
modules all right now for angular we're
going to be using the QuickStart which
if we go to angular dot IO click on get
started and go down to this link right
here clone the entire QuickStart
takes us to the github page alright and
then what I'm going to do is grab this
get clone link right here alright if you
don't have git installed if you're using
Windows I'd really suggest getting what
does it get - SCM yeah I get - SCM comm
and I'd suggest downloading this it
gives you get it also gives you a really
nice command-line tool called git bash
alright which adds some additional Linux
type tools so I would get that and for
as far as an editor I'm using Visual
Studio code which is free and open
source if you want to grab that alright
now what I'm going to do is open up a
command line and I'm going to head to
where I want to set up this application
which is in my C Drive and then in a
folder called sandbox all right now I'm
going to paste that get clone command in
which is going to clone the QuickStart
and I'm going to call this ng what I
call it ng auth0
so that'll go ahead and clone that into
that directory now we're going to CD
into that directory
alright and then we'll run npm install
and that will install all the
dependencies with that QuickStart which
includes all the angular packages
reactive extensions and some of the
other dependencies for angular - all
right we're going to try to move pretty
quick through this as well because there
is quite a bit to get to all right so
now that that's all set let's try and
run NPM start and that should start off
our application on porch 3000 alright so
there we go my first angular app I'm
going to open up my console with f12
make sure there's no errors or anything
like that and we should be good to go
now before we get into creating our
service to interact with auth0 and all
that I just want to create a couple
basic components so I'm going to bring
in
that folder to my editor so sandbox ngr
0 alright and we're going to in the app
folder we're going to create a folder
called components and inside there we'll
create another folder let's call this so
you will call this dashboard alright and
then side there will have dashboard dot
actually know what let's not call it
dashboard let's call it home ok so
inside home will have home dot component
dot TS ok remember I always use TS these
are typescript files and they'll get
compiled down to JavaScript alright and
then we're also going to create a file
called home dot component dot HTML which
will be the template for that component
alright now what I'm going to do is go
to app component TS which is the core
component for angular 2 and we're going
to just copy everything in there and
paste that in home component TS whoops
and then grab it up why is that not
copying
okay so let's go ahead and change the
selector to home and the template now I
don't want to stick my template inside
of this file I wanted to have I wanted
to use that HTML file so to do that
we're going to change it to template URL
and then just change this to home dot
component dot URL all right now in order
to use this relative path like this we
need to just include up here module ID
and then just set that to module dot ID
all right and then we'll save that and
then inside the home component will just
say home for now inside the HTML now
we're also going to have a profile
component okay so let's go and create
inside components once again we'll have
a folder whoops
will have a folder called profile and
let's say new file called profile
component dot T s and then let's also
create the HTML file profile component
dot HTML all right and then let's copy
what we put inside the home component ts
file and paste that in there and then
just change this to profile profile and
then oh I didn't change the class we got
to do that too so this will be profile
component and the home one should be for
the class home component alright so
we'll save that in the profile component
HTML let's go ahead and just put in the
text profile actually we'll put an h1
and we'll say user profile alright and
in the home let's just put in an h1 and
we'll say welcome
okay now what we want to do is we want
to import these into the app module ts
file okay this is where we need to bring
any components that we create we need to
bring in here so let's say import home
component and that's going to be from
dot slash components slash home slash
home dot component all right then we
also want to bring in the profile okay
change this path all right now we need
to add these to the declarations array
right here so we're just going to say
home component and profile component all
right so let's save that now if we go to
our app component TS file you can see
the template is just this string right
here we're going to do the same thing
here and give it its own file so we'll
say template URL and then app dot
component dot HTML and of course we need
to add the module ID up here save that
and then let's create that file so app
dot component dot HTML and for now let's
just put in home and that should display
our home component all right let's see
what's going on here home component URL
whoops that's not right where did I put
that right here this should be HTML and
I did the same thing there didn't I in
profile
okay so now we're seeing welcome and we
know that that's coming from the home
components HTML alright hopefully I did
I haven't lost you guys yet so now we
have these two components and we want to
create a router so that we can go to a
different URL so home will be at the the
home page and then profile will be at
slash profile
all right so bear with me we're going to
implement the router this is the latest
version of angular angular 2 it's the
let me just show you package Jason it's
two two point zero point one so we're
out of the Release Candidate stage
finally that was a real pain because
every video I did for instance in RC for
a week later RC five would come out and
have a totally different syntax and new
files and I had to redo it it wouldn't
work and people complained so finally
we're in the stable a stage of angular 2
all right now we're going to create a
file for our router so let's go in the
app folder we're going to create a file
called app dot routing dot TS alright
we're going to bring a couple things in
here we're going to import something
called module with providers ok that's
going to be from at angular slash core
ok next thing we want to bring in is a
couple things from the router so import
routes and also router module and that's
going to be from angular slash router ok
we also want to bring in our components
so we have our home component and that's
going to be from dot slash
opponents slash home slash home dot
component okay we also want to bring in
the profile all right and then we're
going to create our routes so let's say
Const app routes give it a type of
routes and then we're going to set that
to an array and in that array we'll
define our routes so this is going to be
an object it's going to take a path and
this is going to be the home page so
we're going to leave the path blank and
then say component which will be the
home component alright now we also want
a path for our profile opponent for that
is going to be the profile component
alright and then down here we just need
to do a couple of sports so I'm going to
say explore Const app routing providers
ok app running providers we're going to
set to any array and then just set to an
empty array all right then we want to do
export
Const routing and we're going to set
module with providers equals router
module dot for route and then we're
going to pass in that app routes
variable or array and that's it that
what that sets up our router let's save
it now we need to import this file into
app module dot TS so let's go up here
and say import ok we're going to import
routing as well as a prowling providers
okay that's going to be from the file we
just created which is app dot routing
and then we need to include that in the
imports so right here after browser
module we're going to say routing all
right now we also have to add in a
providers array here okay and inside the
providers we're going to put in app
routing providers all right so that
looks good for now let's save it and now
to finish up our routing we need to go
to our index.html file and right under
the body tag we're going to add in a
base tag and say href equals slash which
will be the base URL alright save that
and then we're getting an error saying
it can't find an outlet so we need to go
to our app component HTML file get rid
of that home and put in router outlet
save it and now we see we see our home
page and now if I go to slash profile
it's our user profile okay so our
routing is now set up now I do want to
use bootstrap just to make things look a
little better by default this angular 2
QuickStart has a style CSS file with
some stuff in it we're just going to get
rid of all of that okay we'll save it
and then what I'm going to do is I'm
going to use boots watch which is
basically just custom bootstrap CSS
files and let's see we'll just grab
let's grab this journal one so if I
click download gives us all the CSS what
I'm going to do is just copy the link up
here and then go to my index.html file
and let's see we're going to put this
right here will say link rel equals
stylesheet
hrf and we're just going to paste that
in save it if we go back to our
application you can see that it's
changed a little bit font alright now
what I want to do is I want a nav bar so
I'm going to go to get bootstrap getting
started examples and then this starter
template will click that and then
control you to see the source code and
I'm going to grab this nav down to where
this container div ends all right and
then we're going to go back to our app
component HTML file and we'll go ahead
and paste that in and then I'm going to
take the router outlet and cut that and
replace this starter template divs right
there
alright now for this up here let's get
rid of navbar fix top get rid of that
class and then the project name will say
ng off zero and let's see for the links
here let's just keep the home and I'm
going to get rid of the class active and
instead of an href right here we're
going to say router linked and set that
to slash all right so let's take a look
at that see that that looks like alright
so Wow pink I didn't know it was gonna
be pink yeah it's fine I guess let's see
what the navbar default class looks like
for the navbar
all right yeah that's better okay so
what we're going to do now is put our
profile link now I want the profile link
to be on this side so we're going to
take this ul and copy it paste it right
underneath and then just add a class of
nav bar right and then let's change that
to profile and then that will go to
slash pro
file save that okay so now if we click
on this link here brings us to the
profile and we can go back to the home
page all right so that takes care of
that so now we're going to start to
implement auth0 now there's a couple
modules we need to install so let's go
back to our server and stop it with ctrl
C and we're going to say npm install
angular 2 - JWT - - save alright so
that's the main package and then we also
want to install the author lock and what
that is it's it's a widget it's that
login and sign up box widget that pops
up so we're going to say npm install let
me see i forget the exact if we go to
QuickStart that should tell us right
here npm install off 0 - lock ok and we
want to add the - - save as well
all right so we'll go ahead and run NPM
start and then there's a couple things
we need to do before we create our
service and we need to go to our system
jas config dot J's file and we need to
map the angular to JWT library so down
here where it says other libraries we're
going to go right here and say angular 2
- GWT and this actually stumped me for
at least an hour trying to figure this
out but what we want to do is set it map
it to node underscore modules slash
angular 2 - JWT slash angular 2 - JW
t.j.s alright and then down here we want
to add to our packages angular 2 GWT and
I'm going to set that to an object make
sure you put a comma there as well and
we're going to use double quotes here
it's a default extension default
extension and then set that to Jas
alright and we should be good for this
file so let's save it and then another
thing we need to do is go into
index.html and we just need to add the
CDN for what is it for the lock module
or the lock widget all right so I'm
going to paste that right there alright
so we'll save that let's also change the
title from angular QuickStart we'll
change it to ng off 0 app
okay so now we're going to create the
service now there's a really good
starting point in the QuickStart okay so
if we go click login and this file right
here I'm actually going to copy all of
this alright and then let's go to our
app folder and create a folder called
services okay inside there we'll create
a file called auth service dot TS and
we're going to just paste that in so
we're bringing in injectable so that we
can inject it as a dependency we're
setting this auth0 lock value variable
and then our class name is off and right
here we're setting a variable called
lock and then we're basically
initializing it here we're passing in
the client ID which if you're looking at
the tutorial inside of your client here
it's going to automatically put those
values in so you just want to leave that
if you are doing it this way if not just
put your client ID that you find in your
settings so this right here and then
also the domain goes here and then
there's a set of options you can use but
for now we're just putting an empty and
empty object all right next thing we
have a constructor and what we want to
do with this error right here is
happening because it doesn't have it's
not assigned to a type so I'm just going
to say : any just to get that out of
there all right and then what it's doing
is it's authenticating it's getting an
ID token and putting that into local
storage all right so that's how we can
tell if we're logged in or not is we can
check for this this token and then down
here we're using the the lock module or
calling dot show all right so this is
going to display the widget to to have
us login all right and then we have this
authenticated function with which just
returns token not expired and that
basically
allows us to check to see if the users
logged in or not if they're
authenticated and then of course logout
we're just going to remove that token
from local storage and that'll log us
out all right so we can save this and
then we have to import it to a couple
places
so let's first go to app dot module TS
and we also need to bring in our off
providers from the angular to JWT module
so let's say import auth underscore
providers from angular 2 - GWT alright
and let's also bring in that service we
just created so pour it off that's going
to be from dot slash services slash auth
dot service alright now that these have
to be added as providers in this array
so let's say auth providers and off
alright so that looks good let's save
that and then we're going to go into our
app component TS file and import the
service there as well oops just off
services ok and we need to inject it in
the constructor ok that's how you do
dependency injection with angular 2 so
we'll say private off and we'll set that
to off alright now let's do the same
thing in the other component so inside
home component TS just paste that in
and of course we have to import it okay
this time we're going to say dot dot
slash dot dot slash services our
thoughts service all right and now for
the profile component all right
save that make sure we're not getting
any errors good so now we're going to
add a login link let's go to our app
component HTML and where we have the
profile right here I'm just going to
copy that
okay we'll paste that in now for this a
tag we're going to do href and just set
it to a number sign and then we need to
add a click event so we're going to say
click equals and it's going to equal off
so that's going to be the auth service
and then the login function that's in
that service alright and obviously we'll
change this to login all right so let's
save that and see what we get so we have
a login link if I click it it brings up
our login box ok which we can sign up
with or login we can use these social
accounts or just use an email and
password now before I go and sign up for
an account I just want to add in my log
out link so I'll copy this paste that in
down here change this to log out and
change this to log out alright so let's
try signing up so we'll click log in
we'll go to sign up and let's go ahead
and actually
make sure I have no users all right I
got this user so I'm going to delete him
let's say actions
delete all right so I'm going to reload
and let's click signup then down here
I'm just going to put in an email and
what's really cool is that if it
recognizes your email as a Gravatar it
actually pulls down your avatar which is
really neat so let's put in a password
and sign up alright now what it did is
it signed us up and then it signed us in
okay now that right now you can't tell
that we're signed in but we're going to
change that in a minute let's just make
sure that that got added here so if I
reload this page now we have that user
okay so it's last login a few seconds
ago all right so as long as people
register through that that module there
you'll get their information here so you
can build a nice list of users or
clients all right so back in our
application what I want to do is I only
want the login link to show if we're not
logged in and then profile and logout
should only show if we are logged in and
that's really easy to do we're going to
go back to our app component HTML file
and we're just going to add in an NG if
okay so we'll start with the login will
say ng if set that to not okay so we use
the exclamation mark we're going to say
not off dot authenticated which is a
function all right and then I'm going to
copy that and I'm going to put this in
for a log out except we want to get rid
of the exclamation if we are
authenticated we want logout to show
same thing with the profile all right so
let's save that and now you'll see that
I don't see the login link because I am
logged in
so if I click logout it logs us out
and now we have the login again now we
can do the same thing with in the inner
page or in the home component let's go
in there
and we'll just put in
oh let's see we'll put in a paragraph
and let's just give it a class of well
okay and then for this we'll say you are
logged in now we only want this to show
if we're logged in so we're going to add
ng-if auth dot not finna cated okay then
let's copy this and actually you know
what we'll do let's change this to a div
and we'll change the class to work and
if we're not logged in let's do alert
danger
okay then for this let's change this to
success alert success and then just put
an exclamation mark in front of this and
actually now I want to change this this
should be success because we're logged
in and then this should be danger
alright and then here will say you are
not logged in and save okay so we're not
logged in if we go and I'm just going to
use this link here so I don't have to
redo tree login now we are and we get
the green alert that says you are logged
in alright so you can now hide and show
things throughout your application based
on if the user is logged in or not now
we can also get profile data that we can
list on our profile page all right now
the way that we do that is through the
service and through this this dot lock
dot on authenticated the documentation
doesn't show you how to do that or at
least the QuickStart that we looked at
but I'm going to show you how right now
okay so what we need to do is say this
dot lock dot get profile and we're going
to take this off result object that we
have pasted that in there and then just
say dot ID token okay get a pass in your
token and then we'll have a callback
function alright and then in that
function it's going to take in and error
will say any and profile object which
will just say any all right and inside
here let's check for the error if error
then we'll throw new error and then pass
in that error value all right and then
under that we're going to we're going to
take the
is where we set our localstorage token
we're going to put that up here and then
we also want to store the profile
information so let's change this to
profile and then change this to profile
now with local storage you can only
store strings so we're going to actually
wrap this in Jason dot stringify and
that'll make it a string all right so
let's save that and then when we log out
in addition to clearing the token we
want to clear the profile data so just
go profile okay so once we have that
profile data let's go into our profile
component ts file and then add a
property of profile and then then the
constructor will say this dot profile
equals local storage get item profile
all right then we can use that in our
view so let's go to our profile
component HTML and let's create actually
you know what we'll do is in here
instead of just saying user profile we
can say profile dot nickname and then
we'll just put apostrophe s like that
all right so let's see if that works
what's this cannot read nickname of null
all right so we have two real aughh in I
believe okay so if we say login and then
click on profile
hmmm let's see that didn't work
local storage dot get item profile do we
not have a nickname maybe you know what
we'll do is in the service let's go oh
we need we need to UM convert it from a
string back to Jason that's right so in
the right here we're going to wrap this
in Jason dot parse all right there we go
tech guy infos profile and we can get
things like the avatar actually let's do
a console log just to see the things we
can get so right here will say console
dot log this dot profile alright so down
here we get the email we can get the
name which is also the email updated at
and then picture which is a Gravatar so
what we can do is let's create a row
bootstrap class of row
call md2 this is this is pretty much
identical to the project and they can
the angular 2 course so this will be
call MD 10 on 10 all right so let's grab
that put that in there and then for the
image I'm going to give it a style and
we'll say with 100% and then a source of
profile dot picture and there we go now
let's give this a class we'll say image
circle and then we can get some other
data here let's do email which I guess
we can get in profile name and we could
say last update profile dot created at
and there we go so now we have a nice
little profile okay so the last thing I
want to do here is I want to implement
something called off-guard because right
now I mean we can go to profile if we
log out the profile link is gone but if
I try to go to slash profile wait a
minute yeah see what it's taking us to
profile
and we're getting some errors so what we
want is we want to boot us out to in
debt to the the home page so to do that
we're going to go and create a file in
our app folder and we're going to call
this off guard TS and I'm actually going
to just paste this in so we're bringing
an injectable so we can inject it as a
dependency and then from our router
we're getting router activated route
snapshot and router snaps state snapshot
we're bringing in this can activate and
then our off service all right then
we're creating a class called off guard
and we're going to do implements can
activate and can't activate is what
allows us to basically block certain
routes and add conditions all right and
then we're injecting here the auth
service as well as the router and then
an hour can activate here which takes
next and state we're just going to run a
test we're going to say if we're logged
in if authenticated then we're going to
return true that's going to let us
through all right we'll also console.log
that we passed else if we're not logged
in we're going to console.log that we're
blocked and then it's going to redirect
us to the home page and we're going to
return false
all right now if we save that there's
one last thing we need to do to
implement that and that is go to hold
two things we need to go to app routing
dot es and go to the whatever route we
want to block which is the profile and
we just want to say can activate and
then pass in here off guard okay now
we're getting an error because we need
to import off card
so auth dot guard all right save that
and then we're going to go to our app
module TS and we're also going to bring
an auth guard okay and then we're going
to add that as a provider down here and
save ok let's see how that works so
we're not logged in let's try to go to
dash profile and it brings us back to
the home page and we get blocked by off
guard and then just to make sure let's
log in and we're getting this error now
the reason we're getting this is because
this route slash profile isn't in the
list of allowed callbacks so what we
need to do is go back to our interface
here and go to clients and then ng r0
and just add this in the list of allowed
callbacks and save and then that should
take care of that issue all right so if
we go and login
and now we're logged in and we can go to
our profile page all right so that's it
we now have a full user registration
login system with with access control
alright so hopefully you enjoyed this
little application like I said this is
part of an angular 212 project course
that I'm sure you guys would love if you
like this video alright so thanks for
watching if you're not subscribed I
really appreciate it if you could
subscribe leave a comment whatever you
can do alike anything helps so thanks
for watching and I'll see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>