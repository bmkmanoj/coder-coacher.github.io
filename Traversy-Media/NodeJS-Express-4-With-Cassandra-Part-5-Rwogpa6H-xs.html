<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>NodeJS &amp; Express 4 With Cassandra  - Part 5 | Coder Coacher - Coaching Coders</title><meta content="NodeJS &amp; Express 4 With Cassandra  - Part 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>NodeJS &amp; Express 4 With Cassandra  - Part 5</b></h2><h5 class="post__date">2015-01-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Rwogpa6H-xs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to I believe this is part 5 of
our nodejs
Express cassandra series up to this
point we have made it so that we are
grabbing our subscribers from the
database we're showing them on our index
page and we click on one and it's going
to take us to that subscribers details
which is just their name email and user
ID so now what I want to do is I want to
create a page where we can actually add
users and this could be your public page
that you give to your that you put on
your website so that your users can
actually fill out a form and subscribe
to your newsletter or whatever it is so
what we need to do is first we're gonna
have to add our new routes so open up
your app j/s and we're just gonna put
that here so I'm gonna copy this
okay so this will be had user
I'm sorry not add user adds subscriber
okay and then down here I'm sorry where
is it
yeah right here copy this okay so this
will be add subscriber alright now what
we want to do is create inside of our
routes we want a new text document and
call this add subscriber dot J s and we
can open that up and we also want to
create the view file
you could just as well put the form on
your index page but that also has all
your subscribers listed so you really
wouldn't want to use that as your public
page so we'll make a separate one
besides should we add subscriber dodgy
yeah what
okay what did I do for routes that I do
add you alright so we'll open those both
of those files up well okay and for the
add subscriber j/s I'm just gonna copy
the subscriber J s file just gonna grab
everything for now and put that in there
alright and then we want to keep this
stuff we want to keep this will change
this right here to add subscriber I
don't know if I changed it here as well
subscriber
and then let's see so basically we're
gonna have a get and a post request here
because the get is for someone just
comes to the page we want to be able to
show them a form the post is when the
form is submitted so for this get
request I'm just gonna get rid of all
this this is just gonna be a slash and
then what I'm gonna do here is we're
just gonna render the form so res dot
render add user okay so that's it for
the for the displaying of the form
alright so we might as well create that
so we'll go to the g8 file okay and we
want to extend the layouts and we want
block content
and we'll have an h1 I will say
subscribe subscribe now I guess and then
we'll have a forum forum name will be
add subscriber okay will have a method
the method will be post and we also want
an action and let's see the action
action will be slash add subscriber
alright and for the fields I'm gonna do
an indent and then have a div and then
another indent will have input and
actually let's give the ID input email
actually this act this should be a
number sign import email
okay and we want type is gonna be text
and we'll give it a placeholder email
and we also want a name okay so for the
name we're just gonna put email and
we'll do another div give it an ID of
input first name type again will be text
placeholder
first name and then we also need a name
attribute and that's gonna be equal to
first name okay another div I'm just
going to copy this okay and this is
going to be last name
okay and then we need a submit button
and put that in a div as well
so button and will give an idea of BTN
submit that's gonna have a type of
submits and then the text will also say
submit actually let's make it say
subscribe
okay so we'll save that and restart the
server whoops
all right and then we'll go ahead and go
to slash add user
I'm sorry add subscriber
okay so I must have put adduser
somewhere I keep getting this mixed up I
would add subscriber yeah okay so right
here
okay so actually I should put a link on
this page let me go to my want to go to
the index Jade file and where should I
put this I guess I'll put it at the
bottom
so basically I'll have a link and it's
gonna go to slash ad subscriber
yeah and then the text all right so
let's see if that gives us a link add
subscribe or click that
unexpected character
what are they do wrong here
whoops this ain't the right when you dad
subscriber Jade
also looks like that I think the
exclamation mark kind of threw
everything lost so let me get rid of
that No
oh okay I think it was it's this this
quote right here that shouldn't be there
what it here too
you probably saw that a while ago
alright let's try that alright so here
we have our forum subscribe now so this
is probably what you'd have in your
public front-end for your users right
now it's not going to do anything
because we haven't created that code yet
so we want to go back to the add
subscriber javascript file and we're
going to create the query first so
we don't want this so I forgot to get
rid of this
we want to go under this the get request
okay I'm going to create a variable and
we call this up cert subscriber now the
reason I'm saying upset is because when
you're using Cassandra and you try to
insert a row and it has the same key the
same press so in our case the same ID
then it's going to update it usually in
a lot of times SQL if you're using a
relational database that it'll fail the
query will fail if you write an insert
and it's already there
so that's what's what's cool about this
is that it'll just update it so we can
use it for insert and update all right
and what I'm going to do here say insert
insert into people dots oops
people dot subscribers
and we're gonna go with the ID ID what
else email first name and last name
all right and the values are going to be
questioned arms now when we did when we
when we didn't insert inside of the cql
shell we used a function to generate the
ID called now well we can't use that
just using this core driver so we need
to use something else to generate so
I'll be using that inside of our post
function okay so now that we have that
query we want to create a router post
all right so let's just do a little
comment here we'll say add subscriber
to say post
okay so we want to say router dot hosts
yeah / and then we want the function
okay this function is going to take a
request and response just like the get
functions
say client dot execute and then we want
to put in the up cert subscriber all
right and we're going to pass a bunch of
things with this to post okay so we can
do that using our EQ body and then the
parameter which first one will be ID all
right and then we'll have our V Cube dot
body dots email
first name
last name
all right and then after that we want a
comma and we want our function
okay function is going to take our end
result okay and I'm just going to copy
from one of the other JavaScript files
this if error
okay so if there's an error we'll send
the message if not then all we need to
do we don't need to render anything what
we want to do is I'm just going to log
to the console so we'll say console log
subscriber added and then we'll just
redirect so you can say red dot redirect
and we want to be redirected to index
all right so that should do it
we'll save that and then go ahead and
restart the server all right and then
reload ad subscriber let's say user for
at
gmail.com first name Henry last name
white subscribe alright so we're getting
an error 'invalid null value for part
keep our ID
oh you know what I'm sorry we shouldn't
we shouldn't even have the ID here we're
not inserting an ID we need to generate
it so nope actually you know what we do
have to keep that the ID but it needs to
be generated so what I'm gonna do here
is I'm going to copy I'm gonna cut out
this whole line alright and then I'm
gonna put it inside of our post here and
put it above the the execution method so
I'll put it here
alright now above that I need to
generate an ID so ID is going to be
equal to Cassandra dots types dot UUID
okay I think that's it and that is going
to generate a UUID for us put it in here
an ID and then we need to put that here
so we're not gonna have this request
body because that's perform information
that's what's coming in from the form we
only want to have ID here
all right so hopefully that works let's
save it and restart the server
okay we'll add a subscriber
so user what do they put for a name I
forget say Nathan I don't know Connor
okay so it looks like it redirected us
to index I think it might have worked
but it's just not redirecting us
correctly yeah all right so it did work
user for Nathan Connor so we just need
to fix that redirect we should be able
to just do a slash
okay so we'll restart try one more time
and that should work so ad subscriber
we'll do user six at Gmail and we'll do
Sam
Sam Smith there we go so now you can see
user six is there click on them Sam
Smith so that's how you can add a
resource through nodejs
and Cassandra in the next video I'll
show you how to update the subscriber
basically we'll have a link to update
and then after that either in that video
or the next I'll show you how to delete
a subscriber</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>