<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Flask From Scratch [Part 4] - Dashboard &amp; Articles | Coder Coacher - Coaching Coders</title><meta content="Python Flask From Scratch [Part 4] - Dashboard &amp; Articles - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Flask From Scratch [Part 4] - Dashboard &amp; Articles</b></h2><h5 class="post__date">2017-04-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/EgnyWxKFwjs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome back to the flask
application series what we're going to
do now is start on the articles okay
right now the articles are coming from a
file called data PI and that's not
ultimately what we want we want them to
come from the database so I'm going to
go to my SQL which I have open down here
and we're going to create a table for
the articles okay just like we did for
the users so this will be articles and
then for our fields we'll have an ID
which will be an int we'll say 11 it's
going to be auto increment and also our
primary key let's spell that right
primary key and then we'll have an our
name title which will be varchar' and
for the title I'm just going to put in
255 for the title and let's see when we
have the author which will be varchar'
let's see for the author let's say 100
the body body is actually going to be
text which can be longer okay we don't
have to don't have to define a max value
either and then we want create date and
clips going to want those create date is
going to be a timestamp and again we
want this to have a default of the
current timestamp okay and that should
do it so now if we say show tables we
now have an articles table so what we'll
do first is we'll add the add the
article functionality okay so let's go
ahead and login
and I want to put an ad article button
right here so let's go to our dashboard
HTML and I'm going to put a link that's
going to be formatted as a button with
bootstrap okay and that's going to go to
slash ad underscore article okay which
is which will be a route that we create
okay and then under that I'm just going
to put a HR okay so now we have a button
now let's create the route inside of app
pie I'm just going to go below the
dashboard here actually let's just copy
that actually no let's some we're going
to we're going to use WT forms for this
as well just like we did with the
registration so what I'll do is copy
this register form class right here okay
and then we'll go down here paste that
in let's change it to article form class
and call it article form and what's nice
is we can use this class for both the ad
and the edit articles okay but we'll get
into editing later alright so this is
basically just going to have two fields
a title and a body everything else is
kind of inserted automatically the date
and the author so it's changed this to
title and see let's give it a max of 200
and then the body so body is actually
going to be a text area field
and then as far as the length it's not
going to have a max but it will have a
minimum of 30 and that's it that's all
we need for the article form so now we
want the add article route I'm just
going to copy this remember that's going
to be a add underscore article okay and
this also can take a post so we want to
say methods equals get as well as post
and then this is another page that the
user needs to be logged in so all we
have to do is take this and put it there
oh it's already there online oh I did
want to put it in the log out as well so
let's just put that right there
okay so let's change the name of this
function to add article and we want to
let's see get rid of that for now
and what we want to do is set the form
to article form and then that gets
passed in request dot form now what we
want to do is check for the post
so if request dot method is equal to
post and everything checks out as far as
validation then we want to get the title
from the form and get the body
then we'll create cursor it's going to
be MySQL dot connection dot cursor okay
then we want to execute so we'll say car
dot execute and this is going to be an
insert so we want to do insert into the
articles table and we're inserting a
title body and author the date will go
in itself and then we'll set the values
and these just have to be using
replacements so percent s three times
four three fields okay and then we'll go
right here put a comma open up a set of
parentheses and first one is going to
come from the title variable then the
body and then the author is going to
come from session and username now if
you want it to be a little I guess a
little more in-depth
you could fetch the user from with their
username and then put their real name as
the author but we're just going to use
the username that's fine this should be
in single quotes all right
so that's that now what we want to do is
commit
so for that we're going to do MySQL dot
connection dot commit and then we'll
close it close connection so for that we
just do kirat close okay then we'll send
them a flash message and we'll just say
article created that's going to be a
success and then we'll redirect
I'm going to redirect to the dashboard
all right now we also need to render the
template before we check for the posts
so that's going to go right here and
yeah so let's just return this is going
to be ad underscore article and then for
the second parameter we just need to
pass in that form okay just like we did
with the registration all right
so let's save that and now we need to
create the actual form so let's go to
templates say new file add underscore
article dot HTML now for this I'm going
to paste it in the initial form and
we'll just go over it so extending
layout we have the block body h1 and
here we're importing the form helpers
which is in the includes folder and we
have a form with two fields we're going
to render field for form title and for
the body and then you have a submit ok
very simple so let's save it and let's
see template not found add article
Oh should be dot HTML okay so that is
our form and let's go ahead and say
article one to the body I'm just going
to grab some dummy text
article created all right so let's go to
MySQL and we'll say select all from
articles and there it is article 1 the
author is Brad and then the body and the
time so we can now submit articles now I
do want to implement an editor when we
add an article or edit we don't want
just a plain text area so there's a ton
of different solutions you could use one
of my favorite is CK editor because it's
really simple
let's see download we don't even have to
download it we can just use this script
tag right here okay so what I'm going to
do is go to let's copy that and then
we're going to go to our layout file
we'll put this in the header actually
now let's put it down here under
bootstrap j/s okay and then all we
should have to do is put a script tag
right here and just say CK editor dot
replace and then whatever class or I'm
sorry whatever ID we want to use for the
editor so I'm just going to use editor
so if we save that and then we go to add
article and just add on to the body
right here and say id equals editor
and it's as simple as that now we have
an actual editor okay now this is the
basic one you can get different versions
and all that but this one's fine for
what we're doing now on the dashboard we
want to be able to list the articles
okay just like we do in the front end
here which will change we'll have this
coming from the database because right
now it's still coming from that file but
right now I want to take care of the
dashboard so let's go back to app dot PI
and go to our dashboard route which is
right here and we're going to just first
create cursor set that to MySQL dot next
cursor and then we want to get get
articles so let's create a variable
called result and set that to Kura dot
execute and then we'll just going to do
select all from articles very simple so
then we'll set a variable called
articles and set it to car dot fetch all
okay which is going to fetch it in
dictionary form and then let's do if
result is greater than 0 so if basically
if there's any rows then we're going to
render the template but we also want to
pass along the articles
all right and then we'll put an else and
if there's an else then we're going to
actually think we can get rid of this
and put it in the else but we're going
to send a message
so we'll say MSG equals no articles
found and then we'll pass along the
message all right and then we just want
to close the connection so now we should
have access to this articles from within
the dashboard template so let's go back
there and this is going to be in a table
so let's say table and we'll give that a
class class of table and also table
striped and let's do a TR and this is
going to have some headings which are th
so we'll have the ID
well the ID will have the title the
author the date and then these two are
going to be left blank because these are
the buttons that edit and delete buttons
so then right here we want to loop
through all the articles okay so we can
do that by saying for article in
articles and then we just want to put TR
and then we want all the columns which
are going to be tdys okay so this one
will be the ID which we can get with
article dot ID this one will be the
title this will be the author and the
create date okay now in here we're going
to have the edit and the delete now the
delete is actually going to be a form
because you have to make a post request
but the edit is actually going to be a
link so let's say a href and let's set
that to see that's going to go to edit
underscore article slash and then the
article ID and let's see we're going to
give that a class of BTN let's do BTN
and then BTN default and also pull write
because I want it to align to the right
and then for delete I guess I'll just
put a link in there for now and we'll
just change this to button danger and
it's not going to go anywhere all right
so let's save that and then let's go to
the dashboard and reload and there it is
there's article 1 good for the delete we
don't want pull right and it should be
pulled - right ok so now let's make it
so that the front end article list comes
from the database okay which is going to
be pretty much the same logic that we
just did in the dashboard so what I'll
do is just copy all of this really and
then we'll go up to where the articles
are - right here and let's just paste
this in and then we just want to render
articles dot HTML and then right here as
well so we'll save
and now you can see there's only one
because it's actually reading it from
the database so we can just comment this
out right here this pulls it out from
the file which I guess we can comment
out right here as well okay because we
don't need that anymore
we've moved on to bigger and better
things so now let's do the single
article page okay so this right here now
we have the route let's just go down to
right here this is the route and it's
just passing in the ID but what we
really want to do is take this ID make a
query so that we can get the real
article and then pass it to the view so
again we're going to create the cursor
let's grab that so let's just grab all
of these okay so we have the cursor then
we're going to say to get article we
want to execute select all from articles
but we want to add a where clause and
say where ID equals percent s and then
we'll go ahead and put in ID all right
now we're not fetching all we want to do
fetch one and this should just be a
single article then we'll render the
article template and instead of passing
in just the ID we're going to pass in
the entire article alright so that's all
set now we'll go to the article dot HTML
file and let's replace that with
actually we don't need that I think well
yeah we do
article dot title let's try that there
we go
so in addition to the title we want the
author and the date which I'm going to
just put inside of a small tag so let's
say written by article dot author on and
then it'll get the date and then right
under that let's put an HR and then
we'll put in the article dot body let's
actually put that inside of a div okay
go and reload and there we go so just to
test it out let's add an article we'll
say article 2 and I'm just going to grab
some crap here and submit article 2
there it is if we go over here there we
go ah let's see we don't want that we
don't want the paragraph tags to show so
what we can do here is put in a pipe
character and where the body is and say
safe and reload and now we don't see
those paragraph tags alright so I think
that's we're pretty good oh let's put
our buttons here so this will be a user
login and a register button if we're not
logged in so let's go to home home dot
HTML and we'll go right under the
paragraph and what we'll do is add a
little bit of logic so we'll say if
session dot logged in if it's equal to
null meaning it's not there
then we'll show those buttons so this
will go to slash register all right and
then we'll do slash login let's also
give them a class of dt n LG make them a
little bigger okay so we're not we are
logged in right now so we don't see them
if we log out and go to home there they
are
alright guys so in the next video we're
going to take care of the editing okay
so when we're on the dashboard we want
to be able to edit we also want to be
able to delete ok so though that's what
we'll get to in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>