<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>NodeJS &amp; Express 4 With Cassandra  - Part 6 | Coder Coacher - Coaching Coders</title><meta content="NodeJS &amp; Express 4 With Cassandra  - Part 6 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>NodeJS &amp; Express 4 With Cassandra  - Part 6</b></h2><h5 class="post__date">2015-01-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/akZI52ZUWbo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys so we are in I believe it's
part 6 of the nodejs Express cassandra
lesson or series what we have to this
point is we were grabbing all the
subscribers from our Cassandra database
we're listing them here you can click on
one and it's going to show you all the
subscribers details ok and we also have
a link to add a subscriber you can add
one through this form now what we want
to do is be able to edit subscribers ok
so if we click on one I want an edit
button down here that's going to take us
to a form that's prefilled with their
information ok so let's go ahead and do
that ok so what we need to do is I'm
going to create a new route and I'm
gonna call this edit
subscriber dot J s
and we might as well open that okay and
then as far as the views we want to
create a new view
okay we'll call this edit subscriber
dodgy
and then for the app in our app das file
we just need to add those as well
and I'm down here
okay save that close that up now the
edit and the add are going to be very
similar so I'm going to copy everything
from add subscriber j/s and I paste it
into edit subscriber dot J s so we're
going to want to render out the edit
subscriber template but we can't just
change this to edit subscriber because
we need to do a select statement so that
we can get the current users information
and insert that into the form
automatically and let me just change
this here just change that for our log
alright and I'm gonna get rid of this
and actually right above this we're
going to create our query so this is
going to be say get
subscriber by ID
and basically this is going to be
identical to our index I'm sorry our
subscriber so if we look at subscriber J
s I'm actually going to copy this okay
I'm gonna cut coffee all the get
function and the query itself and put
that into edit subscriber overwriting
what I just put there alright so what
we're going to do is it's going to get
the ID from the URL so it's gonna be
something like it'll be something like
edits edit subscribers slash and then
that long string which will be the ID
okay
we want to change the render we want to
change the name of the view to edit user
I'm sorry edit subscriber
and the form
actually yeah actually that's fine this
looks good so let's go ahead and create
the form before we go ahead and do the
processing function or the post function
so I want to go to edit subscriber Jade
I'm actually going to go to add
subscriber Jade and copy everything
paste that into edit subscriber and
let's just change this heading will say
edits subscriber the form is going to go
to the name of it is going to be edit
action also is going to go to edit
subscriber and let's see what we want to
do is we want to insert values so this
email at the end here we're going to add
a value and that is going to be equal to
email
all right and we just want to do that
for all of these fields
so value
okay this will be first name
and last name
okay so we'll save that make sure your
edit subscriber j/s is saved and then
we'll restart the server
all right and then we'll go to actually
you know what we need to add an edit
link on the subscriber page so go to
that view go to subscriber dot Jade I
don't think I have it open subscriber
dot Jade what and I'm just gonna add an
edit link down here so under the the
unordered list let's add a link and I'm
gonna give it a class edit subscriber
and then an href this is gonna go to
slash edit subscriber slash and then the
ID ID
and that'll say edit
all right and while I'm here I'm also
going to add a delete link so I want to
pipe in between the links so I'm going
to do this and then let me just copy
this here
okay this will be delete
delete subscriber the link will go
nowhere because a delete actually has to
be done using a n HTTP request so we're
going to use a jQuery and Ajax to do
that and we'll do that in the next video
one more thing I want to have an
attribute called data slap data - user
I'm sorry data - ID and we're going to
set that to the ID as well okay so let's
save that if we go to a subscriber page
you reload up we gotta change the text
here to delete
okay so if we click Edit now we get a
form with all the user information okay
so lastly we need to create our method
for when the user actually submits and
posts to the server okay so to do that
we want to go back to edit subscriber
j/s and we're gonna go under I'm gonna
go down here
remember we copied this from the add
subscriber so this is what was there
change this to edit subscriber and it's
not gonna be much different if anything
now one thing here we don't need we
don't want to generate the ID because
that'll just insert a new record
so I'm gonna get rid of this and I'm
gonna change this here to request that
body dot ID just like the rest of these
okay and what I need to do is our form
now has to submit an ID and that's where
this is going to come from so save this
and then I'm gonna go to edit subscriber
dot Jade and we need to add a hidden
field that's gonna pass on the ID for us
so above the I'll do it right above the
submit button we want to have input and
it's gonna have a type of hidden okay
and then the name is gonna be ID and
then the value is gonna be the dynamic
ID all right so I'll save that
okay if I reload this form I just want
to look at the source for a second and
you can see that we do have this hidden
field with the ID and it has the ideas
embedded right here so that should be
sent to to the row file which is here
and it's going to be passed in right
here alright so that's how it's gonna
work so let's take Bob Johnson and let's
change his yahoo email to let's change
it to a live.com email okay we probably
want to change the text here as well
subscribe and now you can see that well
actually we have a problem
user two at live and user two at Yahoo
alright so it looks like it just added
it so let's see we do have an issue
all right so I actually paused it and I
looked into it for a little bit and
apparently since we used email as a
primary key we can't update it all right
so basically we shouldn't have the
ability to change the email only because
we made it as a primary key if I would
go back and make it so that ID was the
only primary key so that we could
actually update the email without this
problem because if you go and let's say
user 3 at Yahoo okay William Smith let's
go ahead and edit and change him to Bill
Smith okay leaving his email intact now
you can see that user 3 there's still
only one it didn't get duplicated all
right basically an email is a key all
right so since we changed the key here
it's a it's a whole new it's a whole new
entry or a record actually you know what
real quick you can do this we can change
this real quick if we just want to drop
the table and then add it so let's say
drop table subscribers and then we'll go
ahead and create table
subscribers and we want to specify ID is
a UUID
and we'll say it's the primary key and
then email text first name text last
name text all right so let's go ahead
and run that now if we go back to our
application and reload you don't have
anything here if we add a subscriber say
user one at yahoo.com John don't what
just John Doe subscribe at another one
say user too
and we'll say Mike Smith subscribe and
now let's say we want to head it John
Doe we can edit his email we'll change
him to Gmail so gmail.com update and you
can see that it updated his email and it
didn't create another user alright so
that's it that's the solution to that is
just to remove the primary key off of
email and just keep it on your ID
alright so we're getting very close last
thing I want to do is be able to delete
a user and that's gonna take a little
bit of time so I'm going to stop this
video and we'll continue in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>