<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a Chat App With MongoDB &amp; Socket.io [Part 1] | Coder Coacher - Coaching Coders</title><meta content="Build a Chat App With MongoDB &amp; Socket.io [Part 1] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Build a Chat App With MongoDB &amp; Socket.io [Part 1]</b></h2><h5 class="post__date">2017-07-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8Y6mWhcdSUM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys in this video we're going to be
building a really simple chat
application using MongoDB and socket IO
so MongoDB is a new SQL database in
socket il allows us to have real-time
communication between our client and
server ok now this isn't going to be a
production level application or anything
like that the purpose of this is to
quickly show you how these technologies
work together and how we can build a
really simple chat application alright
so don't think that this is something
that you're going to you know use in
production ok now this actually comes
from a course so they did with edge
wanax called mob
projects in MongoDB which is a course
where we build 12 different projects you
can see to see where is it right here
this is the one we're doing here Mongo
chat with socket IO this is loosely BOPE
actually it's really based on that that
project alright but if you want to check
this out please use the link in the
description because that has my
affiliate code in it alright so let's go
ahead and just give you an example of
how this works so we're just going to
put a name in here and down here we can
type a message we'll say hello world and
enter and it's just going to add the
message it says it gives us a little
status thing here that disappears after
a few seconds and we just have the name
and the message now if I were to copy
this link right here for the HTML page
and go to another tab and let's go ahead
and first of all you can see that Brad's
message is there but let's add a new
name here we'll say Kevin and we'll say
hello Brad enter and we get Kevin's
message and if we go back to the other
tab you'll see that it was automatically
upload or automatically added we didn't
have to refresh or anything that's the
beauty of socket IO is it's real-time we
don't have to do any refreshing or
anything like that and if I type back to
Kevin I'll just say hi Kevin and we'll
go back to Kevin's tab and there we go
so it shows
hi Kevin so it's very very simple
if we go ahead and reload the messages
are going to stay there because they're
being persisted to MongoDB okay I also
have a clear button here if we click
that it's going to clear out the
collection so if I reload now we have no
chats all right now obviously this isn't
something you would you would have on a
production application because you
wouldn't want anybody to just clear the
chat out but the point of it is to show
you that we can do that and show you how
this stuff works
okay I reload that so that's what we
building guys hopefully you enjoy it and
let's get started
all right guys real quick some
dependencies for this project you're
going to need to have no js' installed
if you don't have that just go to
node.js org download it install it
you're also going to need MongoDB I do
have a video called MongoDB in 30
minutes and that will show you how to
set up Mongo on Windows I also have a
video showing you how to set it up on
Linux Ubuntu so you do need that
installed and then I'm also using a
command line tool called git bash for
Windows which is much better than the
standard CMD or powershell so I will be
using that as well now I'm using Visual
Studio code is my editor okay you can
use whatever you want but I am using
Visual Studio code I'm also using the
integrated terminal and what I've done
is I've integrated get bash with the
terminal and if you want to do that you
can just go to the settings file and you
can add this setting in right here for
terminal integrated shell windows and
then just point to the git bash direct
uh vxe file all right but you don't need
to do that that's just what I prefer so
let's go and get started I have a blank
folder called Mongo chat and we're going
to start off by just saying npm in it
and we're going to create a package.json
file so Mongo chat that's fine I'm going
to click enter version good description
we'll say simple chat app using sockets
entry point I'm going to say server dot
J s and just enter through the rest and
that should be good all right and if we
look at our package JSON file it should
look something like this now we're going
to need two dependencies
for our server we're going to need the
MongoDB driver and we're also going to
need socket IO so let me just pull those
documentation pages up those might help
you out even further so we're going to
be using the MongoDB native node driver
and click on the github page here so to
install we just need to do NPM install
MongoDB and if we go down here gives us
some examples shows us how to connect
and all that how to insert a document
it's not the most intuitive ORM
something like Mongoose or Mongo Jas
would be better but this is very simple
and it's more than you know more than
enough for what we're doing and then
we're also using socket IO it's a github
and this is the documentation for socket
IO so enables real-time bi-directional
event based communication and this also
shows you how to connect and stuff like
that so these are definitely some some
documentation pages to check out and
people often ask me you know what do you
use to learn with some good relearning
resources in addition to you know
courses and stuff like that the
documentation is is usually the best way
to to to really learn you know what's
up-to-date you know the syntax set that
you should be using the most up-to-date
syntax so you really want to check out
the documentation for everything you're
doing so let's go ahead and install
those two things down here I'm going to
say npm install MongoDB and also socket
dot IO and we want to just want to do -
- save that's going to add them to our
package JSON file
alright so now you can see those two
have been added so let's close that up
let's create our entry file which is
going to be server dot j s alright and
what's the first thing we're going to do
is bring in those two things so let's
create a variable called mando and we're
going to set it to require and we want
to bring in MongoDB which is the native
driver and we want to just add on
to this and say dot Mongo client like
that okay we also want to bring in
socket IO actually we're going to call
this client and we're going to set that
to require and here we're going to say
socket dot IO and then we also want to
listen on a certain port so I'm going to
say we want to listen on port 4000 and
then we just want to add on dot sockets
okay so that will allow us to run our
server or run socket IO on port 4000 so
now what we want to do is connect to
MongoDB okay and I'm going to really try
to comment this stuff because some of it
is a little confusing so I want I really
want you guys to understand what's going
on so it's a connect to Mongo okay so
for that we're going to take that
MongoDB variable that we created and
actually it's just Mongo and we're going
to call connect alright and this stuff
is all in the documentation if we go
let's see right here so they called it
Mongo client and they're saying doc
connect they want you want to put the
URL in then you have a callback function
so let's go ahead and do that Jesus have
so many things open here so Mongo doc
connects we want to put our URL in which
is going to be Mongo DB and that's going
to be our local host which is 127.0.0.1
and we're going to say slash and the
database is going to be called Mongo
chat now we don't actually have to go in
and create the database it'll do that
for us okay which is nice and then we
have our callback function and this is
going to take error and it's also going
to take what we'll call this DB okay so
DB is what we're going to use to to run
queries and stuff all right so let's
first check for the error
so we'll say if there is an error with
the connection then we're just going to
throw the error
all right and then let's just do a
console.log letting letting you know the
console know that we're connected
so we'll say Mongo DB connected alright
so let's see let's try that out
so we'll save it let's go down here and
let's say node server dot J s and we get
MongoDB connected ok so that's working
out
let's ctrl C to stop it now instead of
having to do node server J s what I'm
going to do is add an NPM script so if
we go to package jason we don't need
this test here so I'm going to just
replace this with start and let's change
this to node server dot J s alright so
that way down here we can just say NPM
start and it starts up our server
alright so let's go back now we're going
to start to work with socket IO first
thing I'm going to do is we need to
connect so if we go back to our
documentation for socket IO let's see
right here so they called it IO we
called it client but we're going to do
dot on connection and then we have our
function and then we do everything
inside of that so let's do that all
right so it's go to comment let's take
connect to actually I want to put it
under this console log connect to socket
IO so we're going to take client dot on
connection
that then we'll have our function okay
now we want to create a collection for
Hmong in MongoDB and I'm just going to
call that chat so let's create a
variable called chat and let's set that
to DB and I remember we have this DB
value that that's being passed in and we
can use that to run queries and stuff
like that so let's say DB dot collection
and we're going to call this chats okay
so let's at equals DB collection chats
then what we're going to do is create a
function to send send the status to the
client from the server so let's say
create function to send status all right
so we're going to say send status equals
a function oops spell that right
function it's going to be passed in a
parameter let's say s and then we're
going to emit that so if we say socket
dot emit S and that's going to emit the
status whenever we want to basically
pass something from our server to our
client to the index.html file we're
going to create we want to do this a dot
emit okay so we're just this is just a
function to emit the status actually you
know what we need to name this too so
we'll name it status so two parameters
we're going to name it and then we're
set we have the value we're actually
sending so now we want to do is we want
to get all the chats from the collection
so let's do that I'll say get chats from
Mongo collection and we're going to take
that chat value okay because this is the
collection we created right here and
we're just going to say dot fine and
let's let's go ahead and limit it to a
hundred so we'll say limit to one
hundred chats and let's also sort them
okay and this is all this is all on the
MongoDB driver if you look at the
documentation you'll see this kind of
stuff so we want to we want to sort it
by ID okay every entry is going to have
an underscore ID value and that's what
we want to start that's what we want to
sort it by so we're going to say
underscore ID one okay and then we just
want to set to array okay so we're going
to say to array and then in here we're
going to have a function alright and
then this function is going to take in
an error if there is one and then a
result and then we want to take that
result first of all we want to check for
the error if there is one then we'll
just say throw error okay if there's not
then what we want to do is we want to
emit the messages okay and to do that
remember we say socket dot emit okay
just like we did here to emit the status
but we're going to call this output and
that we want the actual data that we
want to emit which is the result okay
so again we're fetching the chats or the
messages and then we're taking the
result that's being sent back and we're
going to emit it to the client to the
index file that we're going to create
later on okay so now we want to do is
you want to handle input events okay so
we want to handle when someone on the
client types in a message and sends it
we need to handle that so it's a handle
input event
all right so for that we're going to say
socket dot on this is how we can kind of
catch things from the client and we'll
call this input then we have a function
okay and then that function is going to
include the data
okay whatever the user sends from the
client will be put into that data value
now we're going to make it so that they
can send a name and a message so let's
create variables for those we'll say
let's name equals data dot name and then
we're going to say let message equals
data dot message okay and a lot of this
might not make sense to you right now
but once we start to build the UI and
the client it'll it'll be a little more
clear alright so first let's not let's
make sure that they actually included a
name and a message when they send it so
what we'll do is go right underneath and
let's just say check for name and
message well just do a simple if
statement and we're going to say if the
name is if name is equal to nothing so
if it's left blank or message is equal
to nothing okay so if either one of
these are blank then let's send a status
we'll say send I don't I'll send error
status and remember we created that send
status function so we can use that out
okay so send status and we're going to
say please please enter a name and
message okay now the send status right
here is coming from here we created that
function okay so now let's put an else
okay so as long as they do put in a name
and a message then what do we want to do
we want to insert it into the database
we'll say insert message so again we can
take that chat variable and we can call
insert okay and then we want to pass in
here an object which is going to be
first of all the name I'm going to set
it to name which is this right here it's
going to be coming from the client
and then we also want message set that
to message all right and then the next
parameter is going to be a function okay
and that function what we want to do is
we want to emit the output back to the
client so remember we do client emit
okay so we're just going to emit we're
going to call it output and then we just
want to emit the data okay and then
we're also going to send the status
after we do that insert or after we emit
the data so let's go right here and I'll
just say send status object so call our
function send status that we created and
in here we're going to pass in an object
and it's just going to have a message
which we're just going to set to message
sent and then I'm also going to include
a value called clear okay so if we
should clear the message or not I'm
going to say true for that and you'll
see why we're doing that later on
all right so we're almost done with our
server now we want to handle clearing
the messages remember we have a button
that will clear everything so I want to
handle that so see we're going to go
right after this socket dot on input
which ends right here and let's say
handle clear so for that will say socket
dot on and we're going to say on clear
okay so if from the client we initiate a
clear then we're going to run this
function which will take in the data all
right and then in here we're going to
remove all chats from the collection
okay we can do that by taking that chat
variable and calling remove and then
sorry about that we want to remove we
want to pass in just a blank
blank curly-braces because we want to
remove everything and then we have our
function and then we just want to emit
an event letting the client know that
everything's been cleared okay so for
that will say socket dots emit and we're
going to pass in we're going to call it
cleared okay and that's it so just
realize that when we're communicating
back and forth with socket i/o we do
this this dot emit okay to send things
from the server and we can also send
things from the client to the server
which we're going to do next so let's go
ahead and make sure we can still run our
server by saying NPM start all right so
we don't have any errors which is a good
thing
now we still don't know if everything is
going to work because we haven't created
our clients ID yet so what I'm going to
do is I'm going to stop here and then in
part two of this sea of this application
we're going to set up our front-end
we're going to set up an index.html file
so that we can connect to our server and
we can start to build out our UI and the
functionality to actually communicate
with the server so if you guys really
like my videos and you learn a lot from
them and maybe you have a couple extra
dollars to spare check out my patreon
page I'm working on creating special
content for patrons you also get special
deals on future courses and there's even
an email support here for all YouTube
videos and projects to learn more visit
patreon.com slash traversée media</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>