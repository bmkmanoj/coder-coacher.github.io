<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Node.js &amp; Express From Scratch [Part 4] - Mongoose &amp; Model Setup | Coder Coacher - Coaching Coders</title><meta content="Node.js &amp; Express From Scratch [Part 4] - Mongoose &amp; Model Setup - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Node.js &amp; Express From Scratch [Part 4] - Mongoose &amp; Model Setup</b></h2><h5 class="post__date">2017-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cVYQEvP-_PA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys in this video we're going
to start to work with MongoDB a little
bit now if you want to really focus more
on MongoDB and really you know get into
the syntax which is basically just Jason
I would suggest watching my MongoDB in
30 minutes video you could also benefit
from watching my Jason crash course now
for some reason with the git bash
utility I can't get Mongo to start on
the Mongo shell to start up it just I
think it has something to do with my
path and variables and windows but it
does work with the standard Windows
command prompt so we're going to go
ahead and open that up as administrator
alright and I'm sure I could figure it
out but I just I don't want to get into
it so we'll just use this and we're
going to just navigate to the MongoDB
folder which is in my C Drive or okay
wherever you put it you want to go there
and then into the bin folder inside of
that and then this is where you can see
Mongo exe that's the shell program so
we're going to just write Mongo oops
alright that's going to bring us to the
- to the shell and we can clear the cell
with CLS all right so what we want to do
first is actually let's do show DBS so
by default we have this admin local
database we don't want we don't want
anything to do with those so what we
want to create a new database so to do
that we can say use and then let's just
call this node KB and then you can see
it not only created the database but it
switched us to it alright now we're
going to have articles stored in this
database so let's insert some articles
so to do this we need to create a
collection so to create a collection we
can say DB dot create collection
all right and then we just want to put
inside here the name of the collection
so let's say articles all right we get
this okay one now if we say show
collections we see we have an articles
collection so now we want to insert an
article into that collection so we can
say DV dot and then the collection name
which in this case is articles dot
insert and then in here we're going to
put a set of curly braces and we want to
put each field now the idea is is going
to be created automatically so we don't
want to put that but we will put a title
so let's do that I'll say title and then
we want to surround the value with
double quotes so say article one and
let's put a comma then we'll say author
I'm just going to put my name in there
and then let's put another comma and we
want the body and let's just set that to
this is article one alright so let's try
to run that okay we get this n inserted
one now to list all of the articles we
can say DV dots articles dot find and
you'll see that we have an object here
with an ID or underscore ID which is set
to an object ID that was created
automatically that's that's a unique ID
that we can use in our code and then we
have the title the author and the body
so let's create one more I'm just going
to click the up arrow and go back and
then let's just change this to two and
change the title to article two and
we'll run that and then let's run find
again and you'll see we have two
articles we can also attach a function
called pretty so we can say dot pretty
and that'll make it look a little nicer
for us
so now that we have these articles in
our database let's go ahead and I'm just
going to minimize that and we're going
to go to our application and we want to
install something called Mongoose so let
me just look that up will say Mongoose
jas and this will give you the
documentation there's a lot in here I'm
not going to go through it but I would
suggest looking looking at it we need to
install it and then require it just like
any module then we need to connect to
our database then we can create a model
okay we can actually create a model in
our application which will have all the
fields and stuff like that and then we
can create articles we can read them and
so on so let's go over to our command
line here make sure you're in your
application folder and then we're going
to just do NPM install - - save Mongoose
all right so that installed Mongoose so
now let's go let's run no daman again
and then go back to our application
we'll go to app J s and we're going to
bring in Mongoose
and then we're going to connect to our
database so let's say Mongoose dots
connect and in here we want to say
MongoDB localhost and let's do slash and
what do we call it we called it node kV
all right that's the name of our
database and then we're just going to
create a variable called DB and we're
going to set that equal to Mongoose dot
connection actually we don't need those
curly braces so let's see I guess what
we'll do now is create our model so
let's go to our folder over here and
we'll say new folder call this models
and inside here we're going to create a
new file and we're going to call it
article dot Jas all right now creating a
model gives us some some infrastructure
to our to our database no SQL databases
like MongoDB there's there's not much
structure there it's very flexible which
can be a great thing but it can also be
kind of a downfall because your data
isn't structured at all so Mongoose
gives us the opportunity to structure it
on an application level rather than
being forced to do it on a data level
like something like MySQL because you
know you have to create all your tables
and columns and all that even the field
types but Mongoose lets us do that but
on a much lighter level and also on the
application level so in this model file
let's go ahead and we're going to bring
in Mongoose here
detect require Mongoose and then we're
going to create a schema so let's say
article schema and we're going to say
let article schema and set that to
Mongoose schema and then in here we'll
pass in some curly braces and we can
define our field so let's do title and
we want to set that we want the type to
be a string and then we also want this
to be required
so we'll say required true all right
and then let's set the author also going
to be a string and let's set that
required true I'm just going to set them
all to two required and then we have the
body all right
now we want to do is go down here and
create a variable called article and
we're going to set it to module dot
exports and then we want to set that to
the model so Mongoose dot model and then
that gets passed in the name of the
model which is going to be article and
then the schema so we can say article
schema so let's go let's save that and
go back to AB Jas and then what I want
to do before we start interacting with
the database is let's check let's make
sure there's no database errors and we
can do that by taking that DB variable
let's just say check for DB errors ok so
we'll say DB dot on and we'll say on
error then let's function okay and that
should give us an error and then we just
want a console dot log that error and
let's also give a message if we're
actually connected so for that we'll say
let's do check connection and we'll say
DB dot once and then we want to pass in
here open
and then we'll just do a console dot log
and we'll say connected to MongoDB so
let's save that and now you can see down
here when we when it restarts it says
connected to MongoDB and if there's
errors then it should display those as
well so let's go down here and go to
where we have our static array that we
created and we're going to just get rid
of this you can comment it out if you
want to leave at the end but I'm just
going to get rid of it and we need to
first bring in our model our articles
models so I'm going to go back up here
actually and we're going to do that
let's see let's do it right under where
we initialize the app so bring in models
and we're going to create a variable
called article and set that equal to
require and this is going to come from
the models folder so we want to go to
dot slash models slash article and that
should bring it in and then we should be
able to use that article variable so
let's go down here where are we and
let's say let articles equals article
dot find or actually no I'm not going to
do that what am i doing we're just going
to do article dot find and that's going
to take in first of all a query but we
want all articles so it's just going to
be an empty and empty curly brace and
then the next parameter will be a
function and that'll take an error if
there is one and then the response which
will just call articles because that's
what the response is going to be all
right and then in here let's see in here
we want to render the template so we're
going to just grab this and cut it and
put that inside of here all right and
then
we're passing in articles from the
function from the query and then we're
passing it to the view okay now if
there's an error then we want to check
for that as well so right here let's say
if will say if error then let's just
let's console log error all right and
then we'll just put an else and then
let's put the render inside the else all
right so let's save that and we'll go
back to our application and reload and
we get article 1 and article 2 okay so
these are now coming from the database
if we were to go back to our Mongo shell
and add a new article let's just click
up and then we'll add article 3 change
the title and enter and then go back
over here and reload now we have article
3 so we know we're connected to the
database and we know we're fetching
articles alright so the next video we're
going to create our add form which will
be at slash article slash ad alright
we're going to create a form and then we
want to be able to submit to our
database using Mongoose
alright so that's what we'll do next I
will see you then</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>