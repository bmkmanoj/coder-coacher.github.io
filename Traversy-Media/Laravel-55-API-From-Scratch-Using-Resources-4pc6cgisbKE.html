<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.5 API From Scratch Using Resources | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.5 API From Scratch Using Resources - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.5 API From Scratch Using Resources</b></h2><h5 class="post__date">2017-12-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4pc6cgisbKE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's going on guys so in this
video we're going to create a restful
api using laravel 5.5 and we're gonna be
using the api resources that shipped
with version 5.5 so this is this is
fairly new few months or whenever 5.5
was released and I find this really
interesting I haven't really used it
before today I've just been researching
it today so this is gonna be kind of an
off-the-cuff type of video but we're
gonna create a full crud API using these
API resources so they're basically kind
of like templates for your response okay
so when you send out a response from
your API you can format your data in a
certain way and you can add other
information along with the data you can
get pagination links and metadata
conditional attributes and relationships
so it really allows you to map out your
your API responses okay so to generate a
resource you just need to use an artisan
command of make resource and if we look
down here this is basically what it
creates a resource file with a class and
then a method called to array and in
that method it returns all the data and
you can format this however you want so
if you don't want these created at and
updated at you can simply get rid of
them or if you want to format let's say
your name to be the first name and last
name fields in your database you could
set this to this first name and then
concatenate this last name and so on so
you can basically just format your data
very very easily alright and then to use
it in your controller or in your routes
you just say return new and then your
resource name and then you pass in
whatever user or whatever the resources
that you want to return now if you're
returning more than one like a list of
users that's a collection so you would
say return user resource collection and
then all your users
so it's as easy as that and then down
here let me just show you everything all
of your data is going to be wrapped
inside of this data array here and then
in addition to that you'll have links so
you'll have your pagination links first
last previous/next and you'll also have
metadata so this is also helpful for
pagination you have the current page
last page of how many resources per page
so this is very very helpful not only
for the backend API developer but also
for the front-end developer that's you
know building the react application or
angular application that's working with
this API they'll easily be able to
create pagination which has always been
kind of a pain in the ass for me and
this makes it very easy so this is
really interesting to me and I really
want to build something with it so we're
just going to build a simple articles
API where we can create read update and
delete articles and use these API
resources all right now as far as my
environment I'm using xampp which is
gives us an Apache server
mariya DB which is basically a drop-in
for MySQL in PHP and this is completely
cross-platform so you can use it on
Windows Mac or Linux
you also need composer installed which
is a dependency manager for PHP this is
how we're going to install laravel
alright guys we're doing this from
absolute scratch so I have nothing
prepared that's how I like to do it I
don't like to just start a tutorial
right in the middle where I already have
something created and you guys don't
know you know where the hell I'm at so
if you want to follow along you can do
that just make sure you install xampp
and composer all right so I have my
terminal open here I'm using git bash
and I'm in my htdocs which is basically
my web root and I'm gonna go ahead and
just I'm gonna create a new new laravel
project by just saying composer create
project I'm gonna add the
I prefer dist
flag and then specify that I want this
to be a laravel application by saying
laravel laravel and then the name which
I'll just call this will just call it L
articles are Lara khals I guess all
right now this is not gonna be this is
not an intro to laravel type video if if
you're brand new to laravel I would
HIGHLY highly suggest watching my
laravel from scratch series on YouTube
it's on YouTube it's free and we start
from scratch and I explain everything as
we move along in this video I'm not
going to so much explain you know that
the basics of laravel we're just gonna
be kind of just explaining the newer
that the API resources and stuff to do
with the API I'm not gonna like explain
the folder structure of laravel or
anything like that alright so that's all
set so I'm gonna see D into L what was
it L articles our laurels and let's open
up visual studio code I'm just going to
do code dot of course you can use
whatever text editor you want if you're
following along and we have our project
over here now we're gonna have to set up
a virtual host if I go ahead and I open
up a browser let's just open up a
browser real quick and go to localhost /
what do they call it whole articles
uh localhost /l articles slash public I
might have to restart Apache actually so
let me just stop and start Apache okay
so laravel is in the public folder of L
articles so I'm going to create a
virtual host to go to L articles dot
test so the way that we do that is we
need to edit two files one is the the V
host file in Apache so you need to go to
wherever Apache is in my case it's an X
amp Apache and then you want conf extra
and then it's this V host conf and I'm
just gonna open that with sublime text
cuz that's a default and then go down
here and we basically just want to copy
one of these entries and just paste it
in create a new one and we're gonna get
rid of these number signs here because
those are basically just comments and
then all we need in between here is the
document root and the server name
alright we're gonna remove these and
then the document root will be el
articles slash public and then the
server name that I want to use is El
articles dot test and save okay so we
can close that up and then the other
file that we need to edit is the host
file now to edit it we need to open
notepad if you're on Windows we're gonna
open notepad as administrator now my
taskbar is off screen so what I did is I
just typed in notepad and I'm gonna
right click and choose Roger ater
important to actually run it as
administrator you won't be able to save
your host file so once it's open we'll
go to file open and you want to navigate
to your C Drive if you're on Windows and
then the windows folder system 32
drivers et Cie and then just choose all
files and you'll see your host file ok
and then we just want to edit this by
putting in our local hose
star loopback address which is 127.0.0.1
and then just put in that domain that we
put in our server name which was el
articles dot test and save all right so
now we just need to restart apache so
i'm gonna just stop it through my xampp
panel start again if you're using a real
lamp stack on let's say on a bun - or
something like that just go ahead and
type in the command to restart apache
you guys know what you're doing and then
we can just go to l articles dot test
HTTP l articles i always do that
and there we go so now we have our
laravel site up and running on this
domain or this server name so the next
thing we want to do is create our
database so since i'm using xampp I'm
gonna use PHP myadmin
so that'll be available at localhost /
PHP myadmin
or using mysql you could use a different
database if you want but it's you know
you know if you want to follow along
exactly then you're gonna be using mysql
or mariadb so if we click databases I'm
going to create a new one called
L articles and that's it we're not going
to create any tables or anything that'll
be done through migration files alright
so now what we need to do is configure
our database so we're gonna go to the
dot env file and laravel go to the MySQL
section and put in our database name
we're gonna put in the the user name of
the database which in my case I'm using
the root user and then my password ok
whatever your past or it is and save
alright so now we have our database
setup now i'm going to open up my
integrated terminal in vs code and the
first thing we want to do is create a
migration okay so we're going to be
creating an articles table and we're
also going to be using seeds and
factories to generate some dummy data so
let's go ahead and create the migration
so we'll say pH
P artisan and we want to do make :
migration and we're gonna say create
underscore articles underscore table and
then we just want to do dash dash create
equals articles all right so let's run
that and then if we look in database
migrations you'll see the default users
table and password resets table those
are included by default and then the one
that we just created now for our fields
by default we have an ID in our time
stamp fields but I also want to add in a
title and a body so I'm gonna say table
let's do table string for the title and
then let's do table text for the body
okay really simple schema so we'll save
that and close that up
now one thing I want to do before we
move on is since we're using xampp with
maria DB we're gonna have an issue when
we try to create our model or i'm sorry
when we try to run our migration because
of the length of the string so to fix
that we need to go into at the app
folder into providers and then app
service provider so i was actually
hoping that this would be fixed with
version 5.5 because this this was
happening in 5.4 but unfortunately it's
not fixed so what we need to do is we
need to bring in the schema package so
we're gonna say use iluminates
which is basically laravel support slash
facades
facade / schema like that and then we
need to go down into the boot function
and we need to say schema colon colon
default string length and we're going to
set that to one nine one so that'll
prevent the the length error from
happening so that's it we don't have to
come back in here so we'll close that up
and now what we'll do is create our
sample data so we're gonna use a seed
you can see we have this folder called
seeds it has a database cedar but we
want to actually generate an articles
table cedar so we're gonna go ahead and
say PHP artisan make cedar and we're
gonna say articles table cedar
all right so we'll go into that file and
what we want to do here is go into the
run function and we're gonna say factory
and in here we want app back slash
articles colon colon class and then the
number of articles we want to create so
let's say we want to create 30 of them
so then we just need to say create
alright and that's it we'll save that
file we'll close that up
and then we're gonna go into let's see
we're gonna go into the database seed or
file now and you'll see this commented
out they have this call on the users
table seeder we're not actually dealing
with the users table so what I'm gonna
do is uncomment this and change this to
articles table seeder okay and we'll
save that and then we'll close that up
and then we need to have a factory for
our articles so we can generate a
factory by saying PHP down here in the
terminal PHP artisan make factory and
we're gonna say article factory
alright so now if we look over in our
files under database factories you'll
see article factory and this is where we
can basically format our data or our
fake data so all I want here is I want
to generate a title so we'll take faker
let's use text and we'll say 50 is words
the number of words so we'll say a 50
num sorry not words letters or
characters so 50 characters and then the
body
let's say faker texts and let's do 200
alright so let's go ahead and save that
close that up alright so now what we
want to do is create our model I'm gonna
try to clear this which never works for
some reason lately in vs code I don't
know if it's a Windows issue or what but
if I do ctrl L or try to do Claire it
just messes up so I have to just scrap
the terminal and open a new one if
anyone knows why that happens please let
me know alright so we want to create our
model now so we're gonna say PHP artisan
and I know this is a lot of setup but I
wanted to do it from scratch so let's
say make model article
okay so model was created now what we
want to do is run the migrations so you
can see we have these three migration
files that need to be run so we'll say
PHP make I'm sorry PHP artisan make not
make migrate okay so that should have
created the tables now we want to add
our seed data so we do that by saying
PHP artisan DB : seed what does this
class app articles not found why do that
actually I think I know why did that oh
it's gonna say cuz I put articles table
factory yeah you know what this should
be article right here not articles let's
try that again
unable to locate factory with the name
article wait a second
factory article alright so let's look in
fact article factory and oh right here
this should be a p-- slash article
alright let's try it again
third time's a charm good
so that should should have went all
right so let's check our database so I'm
going to open up PHP myadmin let's go to
our database and go to articles and
there we go we have 30 articles alright
it's limited to 25 but we actually have
30 ok and we have some sample text for
the title and body we have ID created at
and updated at alright so now that we
have our data we need to create our
controller and routes so I'm gonna just
scrap this terminal and get a new one
cuz for some strange reason I can't
clear it let's close these up and let's
go ahead and say PHP artisan we're gonna
do make controller article controller
and let's say - - resource now we're
doing the resource so that it
automatically creates the index index
method the show store things like that
so we'll go ahead and run that let's
take a look at it so we'll go in tap
HTTP controllers are
controller and you can see we have our
index create store show edit we're not
going to be using all of these but I did
want some of them all I want is index
I don't want create I want store I want
show
I don't want edit I don't even want
update we're gonna use store for
creating and updating and I do want
destroy so yeah those for alright so now
let's save this and let's go to our
routes so we need to go to the routes
folder and we're gonna go to the API dot
PHP so we're gonna create our routes so
we need one to list the articles so this
will be route it'll be for a get request
to articles and it's gonna call the
article controller and it's gonna be the
index method okay next one will be to
list single article I'll just copy this
so this will be for article slash ID and
this will call the show method okay next
we want one to create new article so
this will be article but it will be a
post request and that's gonna go to
store okay we also want one to update
and that'll also go to store except it's
gonna be a put request okay and finally
we want one to delete article and that's
gonna be article controller destroy and
that'll be a delete request alright so
those are our routes so let's save this
and now it's time to create our resource
so we can close up our routes will leave
the controller open because we have some
work to do there but let's create a
resource so this is basically what the
reason we're doing this so to do it will
say PHP artisan make resource article
alright so what that did is it created
inside the HTTP folder you'll see a
resources folder and then an article dot
PHP so if we look at this file this has
that two array now this by default is
just going to return everything so I'm
gonna leave this for now and let's go to
our controller and go to our index
alright so in the index let's go ahead
and grab some articles so we'll create a
variable and we'll set this to our
article model which we're gonna have to
bring in but we'll say article
let's do paginate let's get fifteen of
them like that and then we're going to
return the collection of articles
as a resource and we do that by saying
return article resource which we're
gonna also going to have to bring in and
then collection remember in the
documentation if you're returning a list
of items of resources you need to use a
collection and then we'll pass in the
articles that's it so let's go up here
and bring in what we need so we need to
bring in our model so app slash articles
or I'm sorry article and then the
resource so use app slash HTTP slash
resources now it's called article but
since our model is called article I'm
gonna say as article resource like that
and then I believe we need to bring in
the HTTP requests as well so that's from
app slash HTTP slash requests all right
so let's save this and we should be able
to now make a request now you could use
your browser if you want for the get
request but I would suggest using
postman which is just an awesome program
for making requests to api's I'm just
gonna close this thing out and then
we're going to make sure this is a get
request to http l articles dot test
slash API slash articles okay we'll send
that and there we go so this is what it
gives us and I'll just maximize this so
as you can see we have this data array
with all of the different articles okay
so it should be 15 because we set it to
paginate 15 now under the data we
automatically have links for pagination
we have first last previous and next we
have the the metadata with the current
page
the last page so basically it's telling
us there's going to be two pages we have
15 per page okay we have the total which
is 30 so this is all stuff that will now
be available to your front-end when
you're connecting to this API now let's
say that we don't want to return like
the created at and updated at so what we
could do is we could customize our
resource so I'm gonna just comment this
out right here this is the resource file
and we're going to just return put some
brackets in here and let's say we just
want the ID actually should be in quotes
so we want the ID this ID we want the
title this title and we want the body
this body and save let's go back to
postman and let's send the request and
there we go so now I'll notice all of
our data only has the ID the title and
the body so we can format this
absolutely however we want and that's
why I said it's kind of like a template
it's basically an API response template
all we had to do in the controller is
simply return this this one line and
then we can just format this how we want
which i think is pretty damn cool now if
you're not a back-end developer and you
don't really understand creating api's
and all that and maybe you just do
front-end react stuff and you just
connect to api is this this is pretty
powerful to get the pagination and all
that and be able to format this so
easily it's it's a pretty powerful thing
for a back-end developer or a full stack
developer alright now the next thing i
want to do is add to the show method so
the show is going to be for an
individual resource alright so let's see
we want to
get a single article so create a
variable and we'll set it to the article
model we're gonna use find or fail and
pass in the ID now this ID right here is
coming from our route when we created
our routes I know a lot of you guys know
this stuff but when we created our
routes we have slash ID so that's where
that's coming in so once we get that
article what we want to do is return the
single article as a resource and we do
that by saying return new article
resource and pass in the article all
right so now we'll save that we'll go to
post man and let's make a request to
article so so singular slash let's do
three and send and there we go so we get
that one article of the ID of three now
notice it's wrapped in this data object
okay that it's going to be like that by
default now if you don't want this data
object then what you can do is you can
use that without what is it without
wrapping I believe let me just let me go
back to the documentation so let's see
where is it where did I see it right
here so it's actually in the app service
provider that's where we did that weird
thing with the boot function but what
we'll do is you bring in this Jason
resource and then just do resource
without wrapping so I guess we can just
try this out so we'll just grab that and
let's go to app providers app service
provider and we'll just throw that in
there and then in the boot we can simply
do resource without wrapping all right
we'll save that let's go back to postman
and let's do the send okay looks like
something happened here I've got the W
without wrapping
and there we go so now you can see
there's no data object it's just this
one object with the value all right now
I'm gonna take that all I'm gonna
actually just comment those two lines
out because I want to show you something
else and we can't have this here for it
to work so let's save that and I want to
show you that if we go back to the
resource and under the two array here we
create a new function called width and
then that takes in a request and then we
can add other stuff with the data okay
so we want to return and in here let's
do like let's do version 1.0.0 so you
can do absolutely anything you want in
here
let's do offer URL and we can use the
URL helper uncle Travis E Mediacom and
yeah we'll just do that
and then save and then let's go back to
postman and let's send and there we go
so now we have our data object and then
in addition to that we have the version
we have the author URL so you could add
whatever you want in here excuse me and
you can do like all types of stuff with
relationships if you have related data
again I'm not sure if I showed you guys
this in the beginning I plan to but I
don't know if I did the JSON API spec
so this is a specification for building
API is in Jason so it can get kind of
complicated but it has the data it has
links for pagination it has all your
relationships this this example has
articles with car blog posts what is it
articles
yeah with comments with people it shows
all the relationships so this is like a
standard for Jason api's and you could
create something like this with laravel
in fact there's a there's a pretty cool
article on medium right here using
laravel 5.5 resources to create your own
jason api formatted api so this actually
yeah right here so this is what we just
looked at here and this article it gives
you the gist of how to create something
like this with api resources and laravel
it doesn't give you everything you need
in the article but if you go down to the
very bottom there's a and i'll put this
in the description there's a github link
for the entire application and if we
look in resources not that resources
where the hell is it app HTTP resources
look at all this articles relationship
resources author identify a resource so
this can get pretty complicated i'm just
basically just showing you the basics
alright but you can do a lot more you
can do stuff like this alright so let's
see so what i want to do now is just
finish up our api i want it to be a full
crud api so we're gonna go back to the
controller and let's go to let's go to
the store
and what we're going to do here is say
article equals request and we want to
check the method so we'll say if is I
should probably should have got a
laravel extension for vyas code before
this tutorial is method put so we're
going to check for a put request let's
see and we'll say article find or fail
and we're gonna pass in request article
underscore ID so basically if it's a put
request we're gonna have to include an
article ID field else then we're just
gonna create a new article alright and
then we're down here we're just going to
specify article ID equal to request
input and this will be the article ID
oops am I stuck let's see what else
we'll actually we'll just copy this
alright so we get the ID we get the
title so this will be input title body
and yeah I think that's it so we don't
need this one ok so then after we do
that we just want to say if article save
then let's just return the resource so
say article resource and pass in the
article okay so that's the store and
then the destroy is gonna be very
similar to the show so let's just copy
the show
and destroy so we're gonna get the
article initially and then we're just
gonna wrap this and if so it's gonna be
if I want to delete it so article delete
and let's make sure that we wrap this
okay so that should do it let's go ahead
and save and let's test the rest of this
API so we're gonna go back to postman
I'm gonna open up a new tab and we're
gonna make a post request actually let's
do a delete first so we'll delete HTTP
el articles dot test slash article I'm
sorry
API slash article slash let's do two so
that's a delete request and let's send
what is this method not allowed did I do
that right el articles dot test API
article - let's check the routes
routes roads roads route delete articles
oh you know what these the update and
the delete should be singular should be
article the only one with the s should
be this one here the index and then for
the delete I actually forgot the ID so
it should be slash ID because it's just
looking at article it needs to know
which one to delete so let's save that
and then that should work so we'll go
ahead and try again and there we go so
it gives us back the deleted article now
two should not exist anymore so if I go
to make a get request to API slash
articles send you'll see it goes from
one to three there's no more two and if
we want to double check and go to the
database and reload you can see there's
no more number to article so the delete
works let's try to add one so I'm going
to open up a new tab make a post request
to http l articles dot test slash API
slash article and let's see we're going
to go to headers I'm gonna add a content
type of application slash Jason go to
body and I'm gonna add raw data so raw
Jason
so Jason should have double quotes
around the keys n values so let's change
our let's add a title of test title and
the body
of test body send that there we go you
can see it has the ID of 31 because
initially we had 30 of them and if we go
back to our this end point here of
articles and send and go down well
actually this is paginating so it won't
show but if we go to our database oops
let's say database reload and there it
is 31 test title test body alright so
last one to check is the update the put
request so I'll go ahead and let's just
copy this endpoint open up a new tab and
let's do a put and for headers we want
the content type as application Jason
and then for the body I'll put in raw
Jason and remember this actually needs
an article underscore ID field that we
want to update so let's update article 4
and we'll say title oops title updated
or updated title body
all right so let's try that same
endpoint send okay we get that back
let's go to the articles endpoint and
send and go up to four and there it is
updated title updated body so we now
have a complete crud API and we're using
the laravel 5.5 api resources alright so
hopefully you found this tutorial
helpful and you guys will use this
laravel is a fantastic framework even if
you don't like PHP it's just a very
elegant framework and this I like it to
build api's but this made it a lot more
enjoyable so thanks for watching guys if
you like this video please leave it a
like if you are not subscribed and you
like these types of videos please
subscribe and that's it I will see you
next time hey guys if you've been
watching my videos for a while and you
really like what I do when I've helped
you out a lot consider becoming a patron
even for one dollar per month it pushes
me to keep bringing you guys the best
content I possibly can there's reward
tiers for discounts for you to me
courses personal support and more so
check out the patreon link in the
description below for more info</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>