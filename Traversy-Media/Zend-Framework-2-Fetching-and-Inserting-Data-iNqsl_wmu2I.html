<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Zend Framework 2 - Fetching and Inserting Data | Coder Coacher - Coaching Coders</title><meta content="Zend Framework 2 - Fetching and Inserting Data - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Traversy-Media/">Traversy Media</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Zend Framework 2 - Fetching and Inserting Data</b></h2><h5 class="post__date">2016-02-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iNqsl_wmu2I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome back this is part I
think it's part four of the Zend
framework miniseries in the last video
we went ahead and created our database
and also the album's model so now we
want to do is we want to interact with
that model with the database okay and we
want to list all of our albums so we're
gonna do let's go back to our
documentation here and we want to be
right here it says now that the service
manager can create an album table
instance we can add a method to the
controller to retrieve it so we want to
go into the album controller okay so
let's go to source album controller
alright now we need to add this method
right here get album table so let's copy
that and we're gonna go ahead and put
that down at the bottom here just like
that and let's see we're gonna grab the
album table and return it alright now we
will also want to add protected album
table as a property so let's copy that
and this is going to go up here just
like that and then to list albums we
need to in our index action we're gonna
grab this so we're gonna be doing the
same thing we're returning the view
model except we're adding in some data
work we're gonna send along the albums
which is coming from fetch all which is
in the album table alright if we take a
look at model album table we have fetch
all okay it's going to return the result
set so let's see it we'll save that and
then let's go now we're gonna go to our
index view okay so view album index and
let's just copy this whole thing
all right now we'll go through it a
little bit we have for setting some
variables a title this is going to be
the heading with the title let's see
it's gonna have a button to add a new
album and right here we're just using
the URL helper alright it's just
pointing to the album ad and then we
have a table with title and artist and
then what we're doing here is we're
looping through the albums using a for
each loop
now this albums right here is coming
from this alright we're loading that
view and we're passing in the albums and
then we're just simply looping through
it with a for each and then we're gonna
output the table rows we have the title
here we have the artist and we're
escaping it we're using the escape HTML
function here and then we have a link to
edit okay again using the link helper
you don't have to use this you could
just have a just a regular you know
album slash add or edit whatever and
it's also gonna pass in the ID because
we need to know which one we're editing
same thing with delete alright so let's
go ahead and save that and let's take a
look okay so we're getting an error
class album result set not found now the
reason for this is because we need to
include a couple things in our module
dot PHP file
alright so let's see in addition to this
stuff actually let me see this say it in
the documentation
doesn't look like it
huh yeah it doesn't tell us anyways I'm
sure it says it somewhere but we're
gonna want to just add some stuff in
here so let's say use use end / DB /
result set DB result set / results set
okay we also need our table gateway
let's see then / DB /table gateway /
table gateway and I think that's it
let's save that and there we go look at
that we have all of our albums listed
that's in the database awesome so we can
list them now that we can list albums
now what we want to do is be able to add
them okay so if we click Add we need a
form here let's go back to the
documentation and so styling and
transitions I don't think we really need
any of this so let's skip on to forms
and actions alright now there is a form
helper that we can use basically we need
to go into our album module and create a
form file alright so inside of let's see
album source form we need a file named
album form dot PHP alright so we'll save
that as album form dot PHP and then
we're going to grab everything here and
paste that in
okay so what we have is a class called
album form and then we have a
constructor and inside there we are
creating the different fields okay so
this is for the ID field this is a
hidden type then we have the title this
is a text field and you can add options
such as a label here we have the the
artist field which is also text and then
we have our submit button alright so
this stuff is all created here so let's
save that and then what we want to do
let's see I also need to set up
validation input filter excuse me now we
need to go to our model and then album
PHP and let's just copy this whole thing
here alright and what we're doing here
is we're loading our model up and we're
also doing some validation
okay so we're using the input filter
okay we do set input filter and then we
have get input filter all right so
basically what we're saying here is that
the ID is required okay it needs to be
there and then also it has to be an
integer all right so we have required in
our filters for the artist same thing
it's required and we have stripped tags
and string trim okay so let's just gonna
clean it up a little and then in the
validators we're saying that it has a
minimum of one character and then a max
of a hundred characters alright so that
has to do with the string length for the
title same thing where we're just
cleaning it up and then we're setting it
between 1 and 100 all right so that's
how we can do validation with send so
let's save that and let's see what else
we have here
now we need our controller action all
right so if we go back to album
controller
we have this ad action alright let's see
I don't think we're including the model
yet no so we need to add these alright
and then in the ad action let's let's
just copy this whole thing alright and
we'll replace this okay so what we're
doing is we're creating a new instance
of album form and then we're checking to
see if the form was actually submitted
with is post if so we're gonna create a
new album instance we're gonna run our
validation with set input filter we're
gonna set data and then we're gonna make
sure everything's okay and it's valid
then we want to call exchange array from
the model and then the get album table
and then save album okay so it's gonna
create a new instance of the album and
then it's gonna save it to the database
and then here we're going to redirect to
our album controller okay
so let's save that and let's see this
just explains everything that I just
said and then finally we need the view
which is the form itself so in our ad
dot P HTML we want to add this stuff
okay so let's go down there add and I'll
paste that in okay so this is basically
just setting up the form we're creating
in our form we have our hidden ID we
have the title the artist and the submit
button alright
this here will create an open form tag
this will create a closed form tag and
then up here we're setting where we want
this to go we want it to go to the add
action
alright so let's save that and let's
check it out
okay so there's our form it's not too
pretty but that's fine so let's see what
this does
so title I will say my new album artist
will say sample artist and add okay so
now we have my new album and sample
artist so we can now add albums to our
application so in the next video we're
going to take care of our edit and
delete functionality all right so I will
see you then</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>