<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Sentiment Analysis in 4 Minutes | Coder Coacher - Coaching Coders</title><meta content="Sentiment Analysis in 4 Minutes - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Sentiment Analysis in 4 Minutes</b></h2><h5 class="post__date">2016-04-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AJVP96tAWxw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello world welcome to sera geology
today we're going to be building
sentiment analysis in four minutes let's
get started
sentiment analysis is the process of
determining the opinion or feeling of a
piece of text we humans are pretty good
at this I can look at this tweet and
immediately know that it's negative it
feels like the writer sentiment is one
of anger and disgust do the negative
wording companies across the world have
implemented machine learning to do this
automatically it's super useful for
gaining insight into customer opinions
once you understand how the customer
feels after analyzing their comments or
reviews you can identify what they liked
and disliked and build things like
recommendation systems or more targeted
marketing campaigns for them in this
demo we're going to be building a
sentiment analysis program in Python
that will identify whether a movie
review is positive or negative
based on the text in the review we'll
get our training and testing data a
bunch of labeled reviews from a site
called kaggle we'll start off by
importing our dependencies will import
the operating system module to help us
perform command line functions then
we'll want to import the scikit-learn
module which is a machine learning
library in Python with a fast learning
curve then we'll import a helper class
that will help us clean our data pandas
helps us read our data CSV files and NLT
K will be used to remove unnecessary
words from our data set all right
so step one is to just read the data
from our hard disk will import the label
training data and the testing data then
we'll print out that we're first review
to the command line to ensure we read
the data set correctly once we've read
in our data step two is to clean it that
means ensure that we remove all the HTML
non letters and stop words stop words
are words that are insignificant we can
download them from the NLT K or natural
language toolkit library words like the
or 2 or as since it's hard to analyze
emotion from them we'll iterate over
every review in our training data set
and fill our new clean review array with
it cleaned reviews our helper class will
do the cleaning for us step 3 is to
create a bag of words the bag of words
model is a simple numeric representation
of a piece of text that is easy to
classify we just count the frequency of
each word in a piece of text and create
a dictionary of them this is called
token as a
in natural language processing will use
the count vectorizer object in the
scikit-learn package to create it we'll
set the max features to 5000 to keep
things simple so our bag of words will
contain ad max 5000 words and their
associated frequencies then we use a fit
transform method to fit a model to the
bag of words and create the feature
vectors we can then store the feature
vectors in an array step 4 is to create
the classifier a classifier is a machine
learning model that will be used to
classify whether a piece of text is
positive or negative in this example our
classifier is a random forest consisting
of 100 trees a random forest is a set of
decision trees decision trees are grass
that model the possibilities of certain
outcomes so let's say a piece of text
has a word hate up here more than 20
times the probability that it's negative
could be something like 80% then based
on other word frequencies we increase or
decrease that probability accordingly
until we get to the leaf of the tree
which will be a positive or negative
rating this is different from a standard
regression classifier where if a data
point is on a certain side of the line
of best fit we can easily classify it a
random forest tree is more like a series
of lines one for every tree that
segments our possibilities once we've
mapped all the lines onto the graph and
we plot a new data point or review based
on its coordinates we can then classify
based on whether it's in a positive or
negative space it's time to test our
classifier on our testing data so let's
format the test data by cleaning the
reviews and creating a bag of words once
we have our feature vectors for test
data we can move on to the last step the
last step is for our program to
correctly classify the reviews in the
testing data set as positive or negative
we'll use our random forests to make a
prediction well then take the result and
write it to a new CSV file that's it
let's run our program and see what
happens ok it printed out the first
review that means it's correctly reading
our data set then it's going to clean
and parse a training set create the bag
of words train the classifier then
predict the test labels awesome let's
test the first three predictions where
one is positive and zero is negative
let's see the first 3 are 1 0 and 1 so
positive negative and positive let's
skim these it's truly a masterpiece
positive it's so awful that once you
know ok
negative awesome
seconds performing sentiment analysis
like a charm sentiment analysis is still
an evolving field of machine learning
there's so many grammatical nuances and
misspellings and slayings involved in
human language that we haven't really
taken into account but we can with more
powerful algorithms so check out the
links in the description below for more
information and please please subscribe
for more technology videos there's so
much I want to make thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>