<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Unity AI - Unity 3D Artificial Intelligence | Coder Coacher - Coaching Coders</title><meta content="Unity AI - Unity 3D Artificial Intelligence - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Unity AI - Unity 3D Artificial Intelligence</b></h2><h5 class="post__date">2018-01-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/bqsfkGbBU6k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello world it's Suraj and have you ever
tried unity before if you've ever wanted
to create a 3d game or 3d simulation
unity is the easiest way to do that
recently unity released a tool to let
developers train and test new AI
algorithms in a 3d world called ml
agents let's explore how this toolkit
works and use it to build a simple
simulation that trains a is to balance
balls with the rise and machine learning
breakthroughs virtual reality and
processing power simulated environments
are becoming more and more commonplace
across a wide variety of fields they
allow scientists to test out their
hypotheses in a safe repeatable
environment for all sorts of experiments
and if you want to test out how powerful
your algorithm is it's a lot funner to
watch it perform in a three-dimensional
world than a 2d one or trying to
decipher logs in a console when it comes
to building a 3d environment for gaming
or simulations the two standards that
have become commonplace are using Unreal
Engine and unity as a toolkit Unreal
Engine is great for high-end graphics
but if you're a beginner unity is really
the way to go it's allowed small budget
indie developers to create really
popular games through rapid prototyping
games like Minecraft limbo and Super
Meat Boy were all created using unity
but even large studios like CCP the
creators of EVE Online use it for
rapidly prototyping game concepts unity
provides a game engine in a box that
means of physics and a rendering engine
with hooks for several scripting
languages it gives us this really cool
visual editor from manipulating the game
environment which lowers the barrier to
entry to development substantially if we
started completely from scratch with C++
and OpenGL it would take us days to get
to the point where there's actually
something rendered on screen but with
unity this takes about 10 seconds take
that deadlocks
to get started with unity there's a free
version and a pro version we can just
use the free version to as little dickie
would say say
the big difference between the two is
that the free version doesn't have some
of the advanced rendering options that
creates better-looking fast running
environments but for beginners we can
just skip that for right now installing
unity is pretty straightforward we can
download an executable right from the
website and follow the Installer
instructions unity supports both c-sharp
and JavaScript
we'll use C sharp since that's what's
most compatible with the ml agents tool
a class file will lay out the definition
of an object and we can instantiate an
object from a class we can attach a new
script to an object easily so if we want
an enemy logic object that handles AI
for an enemy in our game we'd write an
enemy logic class then attach that file
to every enemy entity when we run our
game each enemy will be equipped with a
copy of the enemy logic object once
we've installed unity we can clone the
ml agents github repository let's build
a pre-existing example environment train
an agent in it and then embed the Train
model into the unity environment first
we'll launch the unity editor and login
if necessary inside the unity
environment folder we'll see the project
panel at the bottom of the tool we can
navigate to the ml agent examples folder
and select the 3d ball environment once
we double-click the scene icon it'll
load all the environment assets I guess
we are now officially bawling haha no
there are three kinds of objects within
any kind of learning environment the
first is the agent which has a unique
set of states and observations takes
unique actions within the environment
and receives unique rewards for the
actions it takes in this environment
this is classically called the agent
environment loop in reinforcement
learning each agent has a brain
unlike Sophia the brain defines a
specific state and action space and it's
responsible for deciding which actions
each of its linked agents will take the
brain can be external meaning decisions
are made using tensorflow
internal meaning decisions are made
using
a trained model embedded into the
project the tensorflow sharp player
meaning player input decisions or
heuristic meaning decisions are made by
hand coded behavior the last kind of
object is the Academy it contains all
the brains within the environment we can
set multiple agents to a single brain or
give them their own brains decide
actions to take in batch fashions and we
can even utilize parallel computation
there are lots of options here
adversarial play cooperative play let's
go ahead and expand the ball 3d game
object and locate its child object ball
3d brain within the scene hierarchy in
the editor will ensure the type of brain
for this object is set to external then
it's time to build this thing
under file build settings will choose
development build to log debug messages
then click build this will save the
environment binary to the Python
subdirectory of our cloned repository
now we can train our agent brain using
reinforcement learning there's a
pre-made Jupiter notebook in the
repository we downloaded that we can use
directly to train our agent it's using
the Python API that unity provides for
machine learning will launch Jupiter
then find the proximal policy
optimization algorithm notebook I've got
a great video on how PPO works to see a
link in the description we'll set the
environment to the name of our
environment file from earlier then set
the run path to a directory of our
choice lastly we'll run all selves of
the notebook except for the last one we
can use tensor board to observe the
training process in more detail as it
runs by running the tensor board command
from command line we can observe how
rewards are being accumulated how the
loss functions decrease and how the
policy and value functions are changing
over time after the average reward is
about 75 we can stop the training
process since the script periodically
saves models that we can use this is a
trained tensorflow up model our job now
is to convert this model into a unity
ready format to do this we'll use
tensorflow sharp these are dotnet
to the tension flow library I know I
know it's Microsoft but it's okay
we need this right now we need to enable
it so first we'll download it and place
it in the assets folder will target our
platform set the scripting runtime
version to experimental and add the
enable tensorflow flag to the defined
symbols we can save the project and
restart the editor then we'll export the
trained tensor flow graph and move the
exported bytes file to the TF models
directory we can select the 3d ball
scene in the unity editor and select the
ball 3d brain object from the scene
hierarchy we'll change the type of brain
to internal and drag the bytes file from
the project window of the editor to the
graph model placeholder in the 3d ball
brain inspector window then set the
graph placeholder size to 1 our
placeholder will be called epsilon with
a type of floating point and a range of
values from 0 to 0 once we press the
play button we can visualize the train
model being used to control the behavior
of the balance ball within the editor
itself the three points to remember from
this video or that unity is the easiest
way for developers and researchers to
train their AI algorithms in a 3d
environment the Unity ml agents library
lets us build AI using tensor flow and
export them to a 3d environment directly
and it revolves around three key objects
an agent a brain and an Academy one or
more agents can share a brain and they
all live in the Academy environment
last week's coding Challenge winner is
Brendan Hans nicht using Karros he
implemented his own version of deep
minds alphago 0 but for a different game
called Othello I'm blown away a platform
of A+ Brendan and the runner-up is shad
mong-koo chakkar who used chaos to
detect happiness levels via sentiment
analysis great work this week's
challenge is to build something with
unities ml agents post your github link
in the comment section and I'll
personally review them and announce the
top two entries next Friday please
subscribe for more programming videos
and for now I've got to get some Sun so
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>