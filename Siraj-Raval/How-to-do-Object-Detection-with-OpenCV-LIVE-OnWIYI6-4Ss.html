<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to do Object Detection with OpenCV [LIVE] | Coder Coacher - Coaching Coders</title><meta content="How to do Object Detection with OpenCV [LIVE] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to do Object Detection with OpenCV [LIVE]</b></h2><h5 class="post__date">2017-01-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OnWIYI6-4Ss" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right hello world its Raj good to
see you guys good to see everybody today
how is everybody doing I'm going to list
some names today all right Ashish
against Carta Dean
sumit Spencer how's everybody doing
today yo good morning or good night
wherever you are uh so good to see you
guys um today this livestream I decided
to this livestream today we're going to
use open CV to detect a strawberry in an
image and it's going to use no deep
learning it's going to use no
straight-up machine learning it's all
open CV um alright so that's what we're
gonna do and I'm here in a co-working
space so that's why the environment is
different uh so um okay so I'm going to
start off with a five-minute Q&amp;amp;A and
then we're gonna get into the code all
right so here we go 5-minute you an N
hello hi how is everybody doing tension
flow versus I can learn uh so tensorflow
for like 95% of anything you want to do
but for like the most simple type of
machine learning that has nothing to do
with neural networks it's like a linear
regression so I could learn there's also
TF learn but even that later linear
regression you just keep a deep neural
net to do that um they're both the same
amount of code but like you know just
for like that line of best fit why
ms+ be like what even is any machine
learning so I can't learn but then for
everything else tensorflow what's your
book about decentralized applications is
about building apps that are that no
central entity controls and everybody
gets paid for their data do you think
Google's TP use will take off absolutely
absolutely and we're going to see more
Hardware focus on neural networks in the
future
Google's just ahead of the curve all
right are you going to show how to set
OpenCV up um yeah I can do that as well
yeah I can do that as well are your
models deep so keep that I'm not going
to say that uh-huh TF Lauren versus
chaos TF learn for sure
um which algo are we going to use uh for
this one we're going to use oh there's
several they're all open CDL goes and
I'll explain them as we go um rap a song
in Hindi maybe at the end uh and I'll
probably get an English just to be
accessible to as many people as possible
how our self-driving car is going to
cope with 3d third world messy roads
that's a great question we need like uh
one great example would be India like
trying to think about self-driving cars
in India is like this is like never
going to happen but it has to happen and
the way it's going to happen is just
better better algorithms and better
better data because that's what we use
right we have a great algorithm and
we've got great data here um what we see
um what's the best Network for image
classification supervised then try and
convolutional neural network uh image
classification uh probably uh well
convolutional nets for anything image
related how high should we should I be
for Friday's really high I've been
working with a team on this I'm so high
I mean we've been working on the weekend
to bring what's coming out on Friday so
really high did I miss anything not yet
uh detection included uh uh not face
detection we're going to detect
strawberries but this this applies I
mean the same kind of logic will apply
tensorflow performance on mobile versus
open CV um performance wise uh open CD
is probably more performant
no it is more performance because you're
not using the computation that deep only
requires we're not doing deep learning
right now there's a trade-off here will
it be a real-time option object
recognition I mean live video feed not
real-time it's gonna be an image we're
gonna read it and then write it okay
thanks Brian uh one more question then
we'll get started are you going to build
a strawberry feature descriptor yes are
you going to be using hard
Kaskade no is this still image
recognition yes are you part of Linux
community yes okay so that's it for our
five-minute you and a let's get started
we are going to use open CVD to detect
strawberries okay it's going to be its
image of strawberries
Rainy's OpenCV elope to detect it's
gonna be a 100 lines of code we're gonna
do it in 45 minutes
uh and I'll explain things as we go
there's no deep learning coming out um
and there's no deep owning that we're
doing right now so let's get started
I'll start screen sharing and then we're
just gonna get right into the code all
right here we go
screen share time okay I've got two
monitors so I can move this one over
yeah two monitors I don't have to switch
back and forth so that's great okay let
me move everything as I need to this
over so I can see what you guys are
saying alright cool so it text that yeah
everything works okay so let's get
started with this um make myself smaller
so we can see me and the code okay so
here we go so we're going to start off
by importing our dependencies and then
so there's gonna be about 100 lines of
code and then we're going to get right
into it alright so step one is to import
our dependencies okay so let's get
started with this so the first thing
we're going to do is import um let's see
what what do we want to import here we
want to import open TV oh right I said I
would help you guys uh install open CD
right okay so let me just let me just
get this so open CV installation uh so
it depends on what
operating system you're using but if
you're using Ubuntu is just much easier
if you're using Linux like OpenCV is
just like made to install on Linux you
can just use apt-get and there's like
three of these if you're using Mac I
would recommend homebrew to install
OpenCV or or anaconda and if you're
using Windows so I've actually never
installed opens open CV on Windows but I
assume it's going to be pretty easy
there might even be a binary for it
maybe not on this page but um but yeah
okay so uh anyway look okay let's just
get to the code so we're gonna so the
first thing we do is import over TV
because that's the library we're going
to use for computer vision and then
we're going to import Maxwell live
because that pot life is going to help
us show our image we're not going to do
any actual like wrapping we're just
gonna try to show our image okay and
we're going to call it PLT um there's
that and so now we're going to import
numpy because we're going to do some
matrix multiplication pretty much
anytime we're doing any kind of a
computer vision machine learning deep
learning we're going to be importing
numpy it's like the library for because
everything has really just Nations
multiplication in the end right we're
just multiplying matrices okay okay so
okay so we're gonna import math in math
because because we're going to use some
things that are not related to we're
going to do some math that numpy just
doesn't have another important vision
for some more math okay so that's it for
our dependencies and we're going to just
go ahead and write our high-level method
and then we'll write our helper methods
okay uh so let's go ahead and write our
highest-level method okay and we'll call
it find strawberry okay so let me show
you guys the image that we're going to
be using for this okay so the image
we're going to be using for this is uh
let's see it's called uh it's called
very JPEG okay this is it and we're
gonna I'm going to ask you guys to just
throw out a strawberry image and then
we'll detect it that as well okay so
I'll ask you that later and we'll see if
our code can detect that random one as
well okay
so this is a strawberry and the idea is
we want to be able to segment that we
want
draw an ellipse around it and then we
want to you know distinguish it from
this background so I'll show you guys
what this looks like um and we're going
to be able to apply this to many other
images not just this one this is just an
easy image okay okay so and we're going
to talk about the map as well so this is
our first method it's our main function
and we're going to use our helper
function to do this the first line of
code I'm going to write is I'm going to
convert our image into the color scheme
that we want okay so that is where open
C B's a convert color function comes in
we're going to take our image and our
image is that strawberry image that's
going to be our input parameter we're
going to take that image and we're going
to apply this um conversion to it it's
called color VTR to RGB now I'm gonna
explain what this is doing but I want to
ask you guys does anybody know what the
difference is between VTR and RGB I'll
be actually very impressed because this
took me a quite a bit of googling to
figure out why we do this in the first
place I remember when I first started
doing this so if anybody knows there's a
shout that out in the next 10 seconds
alright I made it really to color BGR to
RGB okay
so anybody Shh going once going twice
and okay so what happened exactly so yes
order is one of them exactly yes blue
green red and readability exactly the
channels are it works right so all right
so RGB stands for so okay so RGB is red
green blue and VTR is VTR is a blue
green red so what's the difference here
well it's just except it's how it's how
the colors are stored like the memory
schemas of the colors right and in in
the ordering it's all about the ordering
and and whenever we're applying some
sort of transformation to an image or
whenever we're playing some kind of
we're trying to morph an image in some
way the order of the colors matters
depending on what's what technique we're
using so depends so for the techniques
we're about to use orangey RGB the RGB
color scheme is better than vgr and I'm
going to explain why this is but it's
basically the order of of the colors in
memory so creep so like uh
in a so a blue occupies the
least-significant area so a bytes in a
32-bit or 24-bit format so it's just
about bytes and memory and ordering okay
and so that's oh that's that so that's
our first that we want to convert
convert to the correct color spirit
that's our first step once we've done
that it's the same image it doesn't look
any different it's just that the color
scheme and how its ordered in memory is
different okay so that's our first step
um and so now that we've converted to
the correct color scheme we're going
we're going to make sure that it's the
correct size so we'll say okay we want
to get the size of this okay so we're
going to say we're gonna use Python
built in max function to take that image
and get its shape okay so that the shape
of that image is of the you know the the
size of it the window cells and we want
it to be um we want it to be the right
size so to do that we're going to get D
we're gonna scale it so we're gonna say
okay let's let's get that let's get the
scale of it cuz we're going to resize it
in a second so I would say out of seven
hundred take that uh divide what we just
got by seven hundred why are we doing
this because the maximum window size up
that we're gonna use is seven hundred by
six hundred sixty pixels so we want to
make our we want to make our a
strawberry image fit in that image so
it's gonna be seven hundred divided by
what it already is so it's smaller than
that okay so we're going to scale it
like that and then finally we're going
to resize it okay so so all three lines
of code here are charissa are to scale
our image properly okay so that's just
step let me just say step one and then
step two right step one step two that's
what this is step one step okay so um so
we're gonna use open TV very handy
resize function for this okay um so
we're going to take our image and then
we're going to say um so this value is
going to be none but this is a this
isn't this is an optional value which
we're not going to deal with right now
but um so this but we want to make the
width and the height the same scale so
it's going to be a square instead of a
rectangle so what's so what's the length
of that X so what's the length so we're
going to say that's going to be scale
and then
whatever the 700 / that max mention is
and the FY is going to scale right so
it's the same just the square the same
length same wood okay so we should we
scaled our image and it's square and
it's ready to be a it's ready to be a
we're going to apply our open CV
techniques to it okay so that's step 2
and so now step 3 is we want to clean
our image so what away money but ever
put on your buttocks let's say
step 3 is clean our image ok so I'm
gonna say uh let's blur our image right
so I'm going to say image blurred equals
and I'm going to use open to this
function called Gauss Gaussian blur what
is this so Gaussian blur is whenever we
want to eliminate noise from an image we
want we want to smooth the color so like
think about a strawberry right has
strawberry um can have you know it's got
those uh what are those little yellow
dots on the strawberry like the kind of
seed like things whatever they are we
want we want to remove that because we
just want to see the clean red image and
sometimes when we take an image and we
convert into a different color scheme
it's got like little black dots in it we
don't want that we want a clean smooth
color across the image so we could just
say boom this is what it is so that's
what that's what that's what this is
dude that's what this is the Gaussian
blur does it takes the color scheme
across a Gaussian distribution and in
edit and it smoothes the image across
the distribution um so uh you're risking
the tension to watch a stream life spark
chicken thank you so much I appreciate
all right um so we're going to apply to
our image and we're going to uh so
that's the input image and we want the
kernel size what the kernel size is
going to be well it's gonna be seven by
seven because you know 700 by 700 uh and
so like with the size of the image and
then how much do we want and then the
last one is good the last body is going
to be zero which is how how much we want
to filter it which we don't really need
right now because uh we've the Gaussian
blur like by default already does that
so the last the last parameter we're
just going to leave your because that
that's an optional value we want to deal
with that
um so we've got our image right and we
blurred it but there's there's one more
thing we have to do um we have to
convert the colors can get again why is
that we're going to convert it to what's
called HSV format okay um all right so
um okay so we're going to convert it to
HSV and uh so we're going to use the
convert color again and we're going to
take that blurred image and and then
we're going to add so then we're going
to add the and hope ECP has a bunch of
these like conversion attributes we're
going to take the organ fee and now
convert the HSV
so we converted it to RGB so that we
could scale it and now we're going to
convert it to another format called HSV
so that we so once it's blurred because
now we're going to filter by the color
okay so what is HST so HSV format is a
different color scheme but basically it
separates two things it separates the
doluma or the image intensity from the
chroma or the color information okay um
so we're separating the color from the
UH from the from the brightness of it so
we just want to focus on color right so
that's what we're segments indeed these
things RGB and BG are they don't really
separate the luma or intense color
intensity from the color itself it's
just one it's just one thing so that's
what HSV is going to help us with so
we're going to separate these two it
we're going to filter it based on that
okay uh yeah exactly a hue saturation
down okay so so that's we're going to do
for that and now that we've converted it
to HSV um we're going to do what we do
best
do what HSV is best for which is to UM
define we're defining a what are we
defining here we're defining our filters
define our filters okay so to define our
filters um ah no worries Paulo thanks
for thanks for saying that
okay so
we're going to filter by the color so
then we're going to filter by the color
filter by the color that's the first one
we're going to filter by the color um so
copper color is separate from the
brightness color is separate from the
brightness the intensity of the color is
separate from the intensity of the
brightness and and so we wanted to tech
strawberries in a certain color range
right so there's a certain redness of a
strawberry if it's if it's more red than
that than it's not a strawberry it's
less rather than that
then it's not a strawberry but it's in
it in a particular range and generally
for this we would guess and check what
this is so I've got I've got miss a
looks a minimum amount of red and this
is what we're using them
because remember colors are computers
read fillers as up thank you one in
thank you wanna okay so so we're gonna
use numpy array function to do this
right so remember colors are like you
know like if we if you guys use CSS
before or anything right 255 QT blacks
you say these are these are hex values
its release numpy array function to
define these hex values we're gonna say
ok so this is the minimum minimum red
value that's cuz it works a 0 180 okay
oh and then not the minimum amount of
redness then the max amount of redness
is going to be M again another numpy
array and we're going to define this
these are bounding colors so this is the
max amount of redness that we want so
sitteth we'll say it's ten fifty three
six and then visit the six that is red
as we want to get so anything in that
range of redness uh um no I did get an
Elan shout out um yeah I mean it's all
good yeah I mean it's not a big deal i
mean i i'm i'm gonna i'm gonna hit
eventually you know do more stuff with
em and stuff no but I was just speaking
with Sebastian Thrun recently anyway
okay so um okay so one with book so
we're filtering by the color and now
we're going to create a layer with this
okay okay so we're gonna create what's
called a mask mask we could call it a
mask where you call it a filter mask a
filter or the same thing so we'll call
it a mask and this mask is like if we
were to take an image and we just focus
on one color and we just black out or
blur everything else like we don't care
about everything else okay so that's
that's the mass
and she's fine by the color value okay
um okay so this is so that's a mask um
in range uh so we're gonna say okay so
what is that value which is fine image
blur it's just a min red and then max
rip okay
so minaret and match red so those are
our values for image blur right so that
so that's our first mask we want one
more mask and that's why we converted to
HSV because we're filtering by not just
color but by intensity okay um I did I
did a video for opening I would just
steal on squad AI squad and he'll on
washed it and liked it and so like now
you know he knows about you know what's
good and all you know with me and stuff
so okay um so minimum red so okay so
we're going to focus on the brightness
now right so this is why the converting
HSV so minimum red
I got focused on the cooker so we're
gonna take minimum read to write already
finer one called minim written and again
we're going to do another array so this
is going to be 170 100 and then and this
is focused on the brightness okay so if
we have a minimum value in a max value
and Max red to we Holson in Python gray
and what my max brightness we want 256
if it's it okay that's our that's our
max value make sure I've got my commas
there okay cool
so let's see this is filter five
brightness okay doctor by brightness
okay so that's that and so now we're
going to create our second match we have
two masses to make and we're going to
cut our second max is going to just
focus on the brightness so we're gonna
say open CT has this in range function
that we we can use for colors for for
hue / saturation for a bunch of ranges
that we want to define okay and we'll
say image blur it go see that's the same
image and this time we're going to bound
it by our our colic our brightness
variables okay so now we have our two
masses anybody know what we're going to
do with these two masks I'll be
impressed
who knows okay so shout out if you know
what we're going to
do with these TMS take these two masks
and we're going to we're going to do
something with them okay so what we're
going to do with these two and and them
no mathematical double masks spark
chicken exactly we are going to do
double masks
double rainbow double net we're going to
combine our masks we're going to combine
both of them okay
so we'll say mask equals mask 1 plus max
- that's it we've combined our mass how
easy was that
okay so if we've done that for our masks
and now we're going to with combine our
masks and now we're going to do some
that step 4 and then step 5 is we're
going to segment segment step 5 is
segmentation we're going to segment the
image what does that mean step 5 its
segmentation we're gonna we're gonna use
those maps to separate the strawberry
from everything else okay
that's step 5 segmentation so we'll call
this a kernel and let me explain that in
a second but so okay so a kernel is
we're going to use open CDs get
structuring element method and let me
define what that is in your episode see
you could morph clips and we'll say this
is going to be 15 by 15 okay so um we
want to circle our strawberry so we'll
circle it with an ellipse which is like
a circle but you know not as not a
perfect circle uh with this with a shape
of 15 by 15 and that's I probably use it
the more limbs function because we're
going to get that structuring element
basically kernel is gonna have an
ellipse in it okay and we want to we
want to make that ellipse fit around our
strawberry so we solo segments all right
um okay so we got segmentation and ah
now we're going to say uh now we're
going to do some what's called
morphology let me try that in seconds
we're excite NASA clothes um
morphology
and X we'll take our masks we'll take
our more clothes and then our current
okay then our girl um okay so what is
this before I find us on the right about
one more line but this is gonna be
called mask clean because these are both
related to each other so let me write
this last one out
morphology X uh this is a lower case X
gotta be perfect about the syntax here
mask closed c2 or open and then one more
thing the kernel okay so what is what am
I doing here so we want to work the
image so uh we want to add that ellipse
around the strawberry so uh we're gonna
first perform a closing operation what
does that mean
a closing operation is dilation followed
by erosion it's process called dilation
followed by erosion what is this it's
useful for closing small hole small
holes inside the foreground of objects
like small black points in the object it
helps further refine that um that that
that smoothness it helps it's like
another it's like an it's like another
safety check to make sure that it's a
smooth in this case red lay and then uh
more and then mask and then more open is
taking is is the opposite its erosion
followed by dilation so the first one is
dilation followed by erosion and the
next one is erosion followed by dilation
okay um yeah definitely thanks same for
helping me answer the questions as well
uh okay and so in peacefull for removing
noise so both it's not that they reverse
each other they both add to each other
okay so um so we got that and so now
we're going to find the biggest
strawberry so SEC six is a find the
biggest strawberry we don't we don't
just want to detect all strawberries we
want to find the biggest strawberry so
if we have a bunch of them we only want
to circle the biggest one okay so say
what's the big strawberry contour and
contour is the shape okay so we're gonna
get that and so and so we want to get
and we're gonna get the masks as well so
this is the method that we're going to
um
okay so we're gonna say uh and we're
gonna write this method out but it's
gonna be a find of biggest contort then
that is fine the biggest ellipse so so
what are what our album is gonna do is
it's happened in French it's just going
to say Oh strawberry chocolate Oh
strawberry Johnny lips Oh strawberry
draw an ellipse and then this method on
the biggest contour is gonna find the
biggest ellipse and say that's the
strawberry out of all of them so that's
what this method is gonna do and we're
going to write that in a second um and
we're gonna use a mask clean parameter
which to do them okay so that's going to
find the biggest strawberry and now
we're gonna um step seven is to overlay
um we're going to do that uh to do this
and uh yeah short history Columbia wrote
a book travelled around the world for a
year went to San Francisco worked at
Coolio as a developer educator best
technical writing team on the planet uh
worked you know some contract work here
in their mobile development did a lot of
research it with a couple distributed
systems research there's been some AI
researchers that I just knew you know
it's just like you know moving around
and figuring things out and by the way
these Android applications was the
best-selling software engineering book
on Amazon of 20 2016 so but I'm not I'm
not like super happy with it even though
it was because it wasn't my best work
and the reviews weren't like as good as
I want I want like perfect five-star
reviews so I'm gonna write another book
in the future probably this year I'll
write another book
um and I wrote that book before I had
any following and so now it's gonna be
awesome to write a book but I gotta make
time for it anyway to get back to the
subject um uh okay so so so so step
seven is to overlay the mass that we
created that we created on the image
that's the next that step set up so
polish it overlay so we've created these
masks for color for brightness and we're
gonna overlay them on our image and
we're gonna write this function right
we're gonna take mass clean and an image
okay um and so now we're going to find
the page strawberry and now step eight
is to circle the biggest one because we
differentiated which one it is and now
we're going to circle the biggest
strawberry okay circle the biggest
strawberry to do this and a parent born
in India I was born in Houston Texas
um but I been to India and it was a lot
of fun uh it's fun is uh yeah fun it it
is more like a really hard adventure to
travel to India like I went till I see
where my parents are from and see what
my culture was like and so beautiful
experience and it was handy is is an
adventure to it'sit's me wait uh I
really like Mumbai though great city
okay um so what was it doing so we're
going to circle the biggest strawberry
I'll say circled circle contour and
we'll say overlay big strawberry yeah
cool cool Oh a big strawberry contour
and then so we circled it will show it
now and we'll write the show function to
show it and yeah that the show puncture
is going to show our circle - or final
result and the last step step 9
last step is to convert our image back
to the original convert back to original
color scheme thanks Robert
thanks for Jay uh okay so so convert it
back to our original color scheme take
you to color circle CD - and now it's
opposite method RGB - big deal okay
that's our last step and we convert it
back and we'll just return that
reconverted value okay so that's our
main method now we have to write our
helper methods okay we've written our
main method and now let's write our
helper methods all right so um so
that's our main method now let's write
our Huckle methods and I'll start of at
the very very top okay so um the first
thing I'm going to do is define the
color green which I'm going to use in a
second I'll define it as a global so
I'll say 0 255 0 and that's just defined
grid okay um I'm 25 years old so um the
first thing we'll do is write that show
method right I'm sorry the show function
remember that show function how we're
going to show our in it um so we're
going to say that images that you clip
get the figure size 8 inches and then
we're going to and this is where we're
actually using that ball library this is
this is it's the reason we importing
that whole life because we're going to
show images with it Samantha life isn't
just good for plotting it's also good
for showing images easily in Python you
can do it in one or two lines of code so
10 10 and then show the image so I I've
got the bigger size and now I can show
it image and then the interpolation is
nervos interpolation equals Newark's
since that's that shorthand for nearest
neighbor interpolation um ah okay thanks
to 13th um I've been streaming for 30
minutes now PLT to show nearest okay
that's for that's not for nearest David
insulation that's going to help us short
image ah okay so that's our show
function and now remember the overlay
mask function okay so let me show you
guys where I define oh and what that's
going to do so remember the show image
was down here and now be overlay mask
image where was that was here and that's
going to overlay the masks we created on
the image so I'm going to take that
cleaned mask and we're going to apply it
to the image and this is the actual
application process of applying the mask
to UM the the process
okay so overlay mask on the image so
let's make the make the mask RGB so it's
a RGB
mask equals CD 2 dot convert the color
I'm going to pick up Matt and we're
going to convert it to a grayscale this
for this conversion process there's a
lot of as you can see there's a lot of
other skin conversion happening here up
and in this case we're converting it to
grayscale because well let me let me
write this out and then explain why
we're converting it to grayscale but the
second line is you um add the weighted
sum of two arrays and let me combine in
a second drugs out and then we'll return
the image
okay so what's happening here choke but
so what add weighted is doing is this
Calculon two weighted sum of two arrays
all right in this case is going to be
our image arrays because think of our
images as arrays and so if we just think
of uh D uh both images in Israel arrays
when we add and we add them together
we're adding two weighted sum of the of
the image values like the shear of the
numerical value of images we just think
of images as just raw numbers that just
build up into an image that you can see
if we add the weighted sum of those of
the mask and the original image we'll
get the mask overlaid on top of the
image and we're converting it to a just
the mask to RGB because the original
image is in RGB so we'll just well
because the mask is going to be in
grayscale will convert to heart to be so
they're both so they're both going to be
they're gonna be they're RGB to gray ah
right because it's because we're not
going to read the image we're converting
the the mask from greater hard to be
okay and then we're going to turn the
image so that's that how many helper
functions dude's got with that we've got
two more helper functions and then we're
good to go
okay so those are our first two and now
we're going to do our next two helper
functions so next one is going to be
fine the biggest conflict right so we've
got our contours or ellipses and we're
going to detect the biggest one out of
all of them and we defined this function
right here where did I define it right
here find the biggest strawberry it's
going to return the biggest ellipse for
that strawberry as well as the mask for
those strawberries okay so let's do that
right now so to find the biggest contour
first we're going to make a copy of bin
right we want to we want to retain the
original image um and we're gonna retain
the original image but we want to copy
of it so we can modify it and this is
this is where open CDs image copy odd
function comes really him come to really
handy
we could copy the image but then keep
the other one separate so now we're
going to we're going to get those
contours so how do we do this well
luckily for us open CD has a function
called find contours so given unpainted
given an image um and these two values
that kind of find is convert I'm going
to explain these values in a second so
the first is retrievelist RT ret our
list with the shorthand for retrieve
list and the next one is called chain
aprox simple it's a chain across symbol
what what what are we doing here ok so
what we're doing here is what is what
this function does is it gives us all
the contours and the contour
approximation to come and we want to so
we're going to use the retrieve list to
get the contour approximation that
compresses the horizontal vertical and
diagonal segments and leads only with
their endpoints and so that's what that
what procs approximation approximation
simple function does we only want the
the ones that get women with their
endpoints we don't want all the contours
so it limits what we're contouring so
for example for an upright rectangular
con contour it's encoded with four
points um and we're going to get a list
of those contours so that's what the
retrieve list does it is we want to list
those contours okay um okay so so that's
what that does and we're gonna get we're
gonna get the contours we're getting a
hierarchy of those which is a the the
chain of contours from that from the
greatest to least so that from you know
the size of all these contours or
ellipses okay um and so now we want to
isolate the largest one now that we have
a list of them let's isolate so we get
just the largest so say contoured sizes
we want to get a list of all the sizes
and we're going to use um we're going to
use open CDs function to do this um
contours the final contour area and
all right um contour contour for contour
in controls okay so for every contour
analytic contours get the area of that
and then store it in our contour sizes
array okay that's what that does let me
make sure I have a syntax correct here I
do have the correct syntax okay cool so
now we want to get the biggest one we've
got a size of all them and so now how do
we get the biggest one luckily for us
luckily for us um my phone has that
built-in max function we'll just get the
max value of our array which will
automatically detect the biggest value
in our array of contours and oh let me
see something where this out lambda um x
ms zero and then once we want that first
value um so yeah so then for the key
we've we just want that so once we've um
we've got that we want the max value
certainly right down around max um and
what's their order we want the one we
want the contour in the first position
that's where that that's where that a1
value comes from and then which is going
to be because it's ordered right so
we'll get that biggest one at the
beginning of the array and then let me
say let me say what this is we're
isolating the contours or isolating the
sorry by setting the largest contour
okay um uh okay so that's isolating the
largest contour and AH so then our last
step is to return the the biggest one
return the biggest biggest contour okay
um line 25 what do we got here
contour hierarchy CV to define contours
image to each other the whatever yeah
we're good here right oh yes contours
thank you ostrich contours hierarchy and
then air okay cold so now we return the
based on for let's get that mask
we'll take my two zeros
and then if the shape of the image and
then UNH
we're going to get the mask of via the
shape and then we're going to draw those
contours and we're going to return it
right this is where we actually draw the
conflict is on our strawberry ah and
then I'm gonna I'm going to demo this so
hard for you guys in a second it's an
Bialik we're going to try multiple
images bringing it all the beautiful
contours to get work to show up okay so
we're going to draw those contours with
the range from using the mask from the
biggest conch using the biggest contour
in the range up till 255 in terms of the
color scheme and then we're going to
return it okay
return biggest contour mask we have one
more method to right okay purple contour
this is where we actually define this is
where we define the actual contoured
stuff so we'll take we'll say the image
contour okay um this is okay so this is
where we um uh this is where we define
the shape of that ellipse this is where
we define the shape of that contour um
so we'll say okay so get the bounding
get the bounding ellipse first mister
last function it took me about five more
lines and we're having then we're done
we'll say we'll get our bounding ellipse
say image with ellipse and then I'll do
I'll demo it and then I'll do my last
five and a few minutes and I'm going to
use a copy of the image because we want
two copies of our image we're going to
right so then um we'll say the ellipse
is um we're going to pick our lips to
our uh contour and then we're going to
add it and by adit I mean in fact a lip
function to make the image with the
ellipse we're going to leave an image
with the ellipse on it and then add our
fitted ellipse so it's a size a better
size we're going to say I won't be
ellipse to be green um ah with a value
of two because we want
that's the size of the link of the the
width of that that contour lines
um and then t2 dot T V a a um and more
charge okay and then um image with
ellipse
okay so let's compile this baby on and
see if it works
we'll just go pop okay so let me just
you to that this works
oh no no I forgot something guys I
forgot something we've got to actually
write that that last code to read in the
image I never did that
so it's three lines read the image in
three lines so what is that we'll get an
image using a open cds imagery function
and with the images call yo that's jpg
which is the image of the strawberry i
showed you guys the beginning will take
a result um
um alright ciao Carmen Carmen Carmen ok
so let's say I find a strawberry and
then using that image and then writing
that's it okay so now we're going to
demo our code - new image
ah cute and I'll write it using open CDs
image write function yo - - JPEG we'll
call go to the new image and just use
for result as the parameter for that
because that's our new only image okay
so let's let me open the very edge of it
so this is our initial strawberry right
this is our initial strawberry and now
once we hook run this code which I've
called spun got pied once we run this
code which are called fondant pie okay
let's see we've got an error here fine
strawberry image so on line 100 I said
fine strawberry image ah just what am I
doing here
oh right equal sign yes here it comes
guys here comes so uh let's i'm future
comport the vision Oh future points have
to happen at the beginning of a file I
forgot about that
okay so remove that or add it there
let's try that um okay
so this says okay so the problem with
that is um
okay so this is a weird error so okay oh
let me make this bigger so you guys can
see um so python on the PI right
oh right it's not very it's a Python up
enough pata right oh yeah
that's so um interesting okay lets you
to color BGR to RGB and finds strawberry
okay no no that's definitely correct um
just remember what the deal is
oh right we got to convert berry not yo
we'll call this berry - it was the wrong
image right okay so that's what it was
all right so let's the front is this
gonna work
bubble name biggest is not defined okay
let's see what that is
um debugging time exactly debugging is
fun as hell sometimes um it's starting
to become more fun even when run live
because I'm getting more used to this
okay so what is so biggest let's find
biggest biggest it's not defined are you
talking about i define biggest obviously
I didn't because it's not there but okay
so I said biggest um and right so where
should I define this so biggest um Oh
biggest contour not biggest uh that's
its biggest contour contour okay let's
try that okay
interpolation on line fourteen
unexpected keyword interpolation image
interpolation nearest PLT of mo image
show not show image step okay let's try
that oh okay that worked like I mean
well let's see if it worked
so it's called berry - okay yes
how cool is that so this our original
berry and it's the one that it detected
okay so how the hell did it do this okay
it detected it right so to do this we
here's what we did here are the steps
and
and now I want you guys to find a
strawberry image on the net and just
post it in the in the chats so I'll try
it on that image as well while I explain
this what we did was the first converted
the color scheme to from BTR to RGB so
that we could so that we could scale our
image properly the next step is we
scaled our image so it fits in the
window size that map plot live requires
which is I'm you know under 700 by 700
it's a square image we turn our
strawberry into this word then we clean
our image using the Gaussian blur
function which smooth of the image so
that it's a it's it's a one uh which one
color scheme that we can just focus on
like red instead of a you know little
black holes and yellow and all and so
then we define our filters what's what's
the minimum red what's the maximum red
um and then what's the minimum
brightness in the maximum brightness so
we use two filters we combine them we
apply them to the image we segmented the
strawberry from the rest we got a list
of strawberries in this case we only had
one but this would apply to multiple
strawberries as well we added a mask we
overlaid the mask and then we circled
the biggest one and then we showed it
and then we converted our original image
back and that wasn't necessary but we
just let's just convert it back to UM
BGR so that we can perform other
processing tasks on it so okay so that's
the code for that let me try it out one
more image okay
strawberry image ah
and we'll do several let's pick up let's
pick this one okay and we'll save that
and we'll go to our um I will move that
to this block here and we're going to
rename so then we'll open this file and
we'll say well what's a call we'll do
called it was called yo test dot jpg we
will rename it yo test JPEG we'll use
JPEG and then in our code we're going to
AH exactly
yo test dot JPEG and I will say yo test
two JPEG and let's see what happens well
I've never tested on this code
ah let's see what happens your phone up
hi hey and now we'll open yo cats to
JPEGs
you were hit okay so these are okay so
it just circled the entire thing but and
it's because these these strawberries
were bunched together so well we can
further improve on this to make sure
that it only right segments the best one
our code is ideal if the strawberries
aren't touching but these are tough
these are touching so that's that um uh
and this there's one more thing I want
to say about this so neat let me start
screen sharing again I mean let me stop
screen sharing you get back to UM stop
screen sharing okay so so yeah I mean
OpenCV it's been in used for so long you
know there's so many built-in methods
transforms different types of you know
all sorts of research has gone into
OpenCV uh to to do that but deep
learning now is slowly taking over so if
we had and let me just show this right
here so it's like it's like it's like if
this is deep learning can you guys see
this oh my god it's backwards right I
forgot about that um how does Schiffman
do it where it's like not backwards
interesting ah okay so I can just do it
with my hands guys I do that anyway so
it's like deep learning was like OpenCV
was everything it was all a computer
vision with a deep learning showed up
and now he pointed slowly taking over so
right now you can use a little bit of
OpenCV and a little bit of deeper in but
eventually people will just take over
and a whole bTW point so like right now
what I need for the fight at is like
well we can use OpenCV to segment a
strawberry and then we could use deep
learning to identify it as a strawberry
so we can say okay this is a strawberry
in a picture right is trimble around it
and then use deep learning to shoot a
text well what is the name of that thing
okay so we said we can define the shape
and color and some pub something and
then we could say well you see point you
to recognize what that is um and also
deep learning is computationally
expensive right so sometimes you want a
quick and dirty solution you just want a
segmented image and you don't want to
have to and although deep learning
learns features you just want to encode
those features yourself because it's
something simple you're doing OpenCV is
great for that ah so yeah that's that
and let me do a five-minute Q&amp;amp;A at the
end and then we'll and then at different
livestream any any other questions oh
it's only backwards for me
right you're right I forgot about that
um yeah Shipman is awesome uh will you
make us here series where you make build
a robot using a yes that's coming up I'm
gonna use a drone uh will you make any
Google search algorithm that's a great
idea um that's a great idea app or I
never thought about that I should do a
search algorithm um what was your big
announcement last Friday wait two days
it's coming out deadline it's coming out
this Friday come hell or high water it
is coming out this Friday um if you
release more videos I am on that the
thing is I don't wanna I don't wanna I'm
never I'm never gonna let anyone else
write the scripts for my videos I don't
care who it is I don't care who pays me
how much I every single word that I
speak will come from my heart my soul my
mind so if that doesn't scale it doesn't
scale but I will never speak the word
that someone else tells me to speak okay
I promise you that uh make a search
algorithm that would find the most
complete complete answer to any question
um yeah I'll add it to the search
algorithm video immediate please make a
dedicated video for Q&amp;amp;A section Rakesh
I'll do that in the future can I get a
shout out how JD can you recommend can
you recommend CNC K um I I wouldn't
recommend CNC K actually I would
recommend tensorflow uh yes please
support me with patreon I'm not for sale
exactly Thank You JD is there a simple
way in OpenCV to get the total variation
or for hue and saturation um uh yes
there is and I um yes there is um I
don't have time to show exactly that uh
Thank You Enzo how to use neural net in
open CV I'll get more on this stuff
later uh two more questions and then
we're good to go okay two more questions
uh can you make a video on motion
tracking in open CV that's a great idea
that's a great idea um I can do that
Alejandro one more question um where did
you learn all these from how much rollin
do you drink I stopped drinking Soylent
I used to drinking a lot um where did
you learn all these guys it's um so I
think a lot of us are bounded by the
idea of we have to learn a certain way
and
to be in this exact format for us to
tell ourselves that we now know this but
look if you if you like you know read if
you really take a dick to read like I
don't know
Andre karpati is that famous lsdm blog
post from start to finish and you're in
every time you see a word or phrase or
equation that you don't understand you
google that and then you go back to it
if you complete an article like that
like a very heavy article you now
understand a high level how LST M works
you don't necessarily need you know like
a 4-year degree to say now I know how
I'll see in four so we have to we have
to shift how we think about learning
it's not so much about about having to
do a certain structure it's about
telling yourself and believing in
yourself that you can you can know this
you do know this and you can build
something with it and so that's what I'm
here to help you with I'm here to
inspire you guys guide you guys on this
journey that we are all on okay we're
all learning ok so um one more research
internship or internship in at the
startup ah that's a great question it
depends when you're doing in the start
if you're doing research stuff uh me
personally I would do a research
internship just because I'm interested
in research um cool so that's it reddit
AMA that's coming up someone has to like
request me right like request me to do
it hey man let's just say hey I want to
do a name it
okay so write up contact me or somebody
orange okay well I know the CEO he's a
cool guy
okay um so that's it for this Q&amp;amp;A and
for this live session I love you guys so
much thank you for watching um ah
something cool is coming out on Friday
it's it's happening this Friday come
hell or high water I I made I'm making
this promise you guys it's going to be
awesome
um and thank you so much for uh for
doing this for being here okay so for
now I've got to find a place with better
lighting because I love natural lighting
so thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>