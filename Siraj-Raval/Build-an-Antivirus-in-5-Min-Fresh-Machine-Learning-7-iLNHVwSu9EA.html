<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build an Antivirus in 5 Min - Fresh Machine Learning #7 | Coder Coacher - Coaching Coders</title><meta content="Build an Antivirus in 5 Min - Fresh Machine Learning #7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build an Antivirus in 5 Min - Fresh Machine Learning #7</b></h2><h5 class="post__date">2016-08-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iLNHVwSu9EA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Oh check out my friend Daniel walked
ones YouTube channel for some fool virus
videos and coming to you straight from
San Francisco is a world it's Suraj and
in this episode we're going to learn how
machines can learn to detect viruses
then we're going to build our own simple
antivirus script in Python since 2010
the amount of malware that exists on the
web has skyrocketed reputable antivirus
programs like Norton I'm sorry I can't
even say that with a straight face
Norton sucks have to constantly upgrade
their systems to defend against new
threats and it's not just the security
systems that are getting smarter if the
viruses as well for example polymorphic
viruses encrypt themselves in a
different way every time they infect a
host machine making them harder to
detect a worm self-replicate so it can
spread to other computers as well using
a bandwidth and computing of every host
machine infects along the way right
under your mouse
I mean knows maybe I should make a worm
to infect a bunch of computers and use
them as Bitcoin miners at its core
buyers detection is a classification
problem if we can train a program to
recognize whether a piece of software
either is malware or is not know where
we can delete it in a paper released
last year a group of researchers in
Nigeria trained a K nearest neighbor
classifier to detect viruses on an
Android phone
the K nearest neighbor or knn algorithm
pops up a simple problem cancer no you
have a set of points in n dimensions
given a new point let's call it query
you need to find the K closest points to
that query KN n finds those closest
points so it's great for finding
similarities between say a set of
documents and because it can find
similarities it can also help find
anomalies in the case of this paper
anomaly would be a virus in order to
train the classifier to detect anomalies
and needed a set of feature vectors
representations of a clean machine they
ended up using four features SMS text
calls device statuses and running
processes as in they took a set of these
label them as clean so it was a
supervised problem and trained their
classifier on them a model ended up
having a 94% accuracy pretty good
results a more fresh approach from three
months ago was aimed specifically as
detecting botnets on Android phones
botnets form a distributed network of
infected machines and utilize their
computing power for things like sending
spam without
the owner's knowledge there are two
approaches when it comes to malware
analysis static or code based and
dynamic or runtime based the static
approach looks at software as it is on
the machine a dynamic approach looks at
ongoing processes on the system these
guys decided to go for the dynamic
approach they use a neural net to train
on a label botnet data set then hit
labeled an unlabeled data set as either
botnet or not botnet then took that
label data set and trained six different
classification algorithms on it like
logistic regression a random forest and
a support vector machine they found that
a simple logistic regression got the
best results who would have thought and
they call this framework of mining
features training a classifier and
performing dynamic analysis smart BOTS
extremely original but let's talk about
a super fresh approach a paper released
two years in the future just kidding I
can't literally see into the future yet
which released just a week ago that used
Bayesian classification to detect
Android malware they first reverse
engineered a set of clean Android apps
to map them into feature vectors like
API calls Linux system commands and
permissions containing the manifest file
they didn't train their Bayesian
classifier on those features Bayesian
classification uses Bayes theorem to
measure the likelihood that an object is
of a certain class using feature vectors
as inputs and the results in the paper
showed way better detection rates than
traditional signature based antivirus
software so there are many different
ways to approach virus detection and a
software eats the world malware tries to
as well viruses can use machine learning
as well to avoid detection so only one
way to fight fire with fire that analogy
doesn't actually make sense does it so
let's build a script in Python that uses
scikit-learn
to train a classifier to Detective a
file is legitimate or malicious in
learning duck PI will import the
necessary libraries pandas is for data
analysis not actual pandas sadly numpy
is for math pickle will help us save our
learn features as a byte stream and
scikit-learn will help us build train
and test a machine learning model the
first thing we want to do is load a data
source we have a csv file on our local
machine called data CSV that contains a
labelled data set of PE files labeled as
either legit or malicious and their
associated properties will then print
out the total number of features per row
then it's time for us to identify which
features from our data set we will
identify as
for our classifier in order to do this
we use an extra trees classifier this
fits a number of randomized decision
trees on sub samples of the data once we
have our important features or print
them out and sort them accordingly then
we want to create an array of models
we're going to test each model on our
data set using our extracted features as
inputs and compare their prediction
results whichever model has the best
results is the one we will use to detect
malware in our for loop we'll test each
algorithm out fitting it on our feature
set then scoring the prediction accuracy
we'll print out each score then
calculate a winner by finding the
highest prediction accuracy we'll print
out the winner then save the algorithm
weights and features to the classifier
folder as a series of Pikul files so
that's how we train our classifier let's
see what it takes to write the main
script and our main method we'll
initialize a command line parse so when
we type in the name of this file the
argument will be the target file we want
to classify as either malicious or legit
then we'll load our classifier the one
we trained from our classifier folder as
well as our features will then extract
the byte stream from our input file and
extract a set of features from it we'll
feed those features to our trained model
and it will output a classification that
we then print to command line let's try
this baby out on the command line by
feeding it first a legitimate PG file
and now a known malicious PD file
malicious links through the codes in the
description and please hit that
subscribe button if you want to see more
machine learning videos for now I've got
to go code up a girlfriend so thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>