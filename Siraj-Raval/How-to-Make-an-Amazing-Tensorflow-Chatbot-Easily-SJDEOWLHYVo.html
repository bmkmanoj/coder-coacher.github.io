<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Make an Amazing Tensorflow Chatbot Easily | Coder Coacher - Coaching Coders</title><meta content="How to Make an Amazing Tensorflow Chatbot Easily - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Make an Amazing Tensorflow Chatbot Easily</b></h2><h5 class="post__date">2016-12-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SJDEOWLHYVo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello world it's Suraj and in this video
we're going to make our own chat bot
using tensorflow
2016 has been the year of the chat bot
messenger WeChat skype and a bunch of
other popular messaging platforms now
host chat bots that developers have
built for them and brands are
increasingly using chat bots to engage
their customers because the data doesn't
lie
90% of apps that get downloaded are only
used once with a chat bot there's no
need to download anything it lives
inside of the chat app that you open up
a dozen times a day and competing for
space on your phone's home screen is
really hard but for space on your next
most you screen your chat app that's
more doable
you can now chat with CNN to get the
news or chat what they bought to get
flowers delivered to your boo or even
chat with a matchmaking bot what but
even though the chat bot space is
getting really hot it's nowhere near
saturated just think of an app that you
like and build a chat bot for it
chat BOTS are the new apps before
deep-learning hit the scene a few years
ago all chat BOTS had hard coded
responses a program wrote try to predict
everything you would say and build a
huge list of responses for every
question they could think up all of them
were pretty terrible deep learning
changed everything and still is as new
discoveries are being made instead of
telling a computer what to do you can
say this is what I want as an outcome
make it happen some chat BOTS that have
used deep learning do so by taking
different components and applying it to
each of them I could create a deep
learning based system to interpret the
language and another one to track the
state of a conversation and then another
one to generate a response each of these
systems would be trained separately to
do its own task and the chat bot would
collectively use the results from each
this is unnecessarily complex to build a
better type are called end to end these
are chat BOTS that use one system that's
trained on one data set they make no
assumptions about the use case or the
structure of the dialogue you just train
it on the relevant data and say I want
you to be able to have a conversation
with me about this data and two end
systems are what we should all be
striving for intuitively they make sense
and there
starting to outperform all other systems
so let's talk about how to do this with
deep learning the most simple type of
neural net is feed-forward that means
that as it trains data just flows one
way from the input node all the way to
the output node it only accepts data
that is a fixed size like an image or a
number give it a labeled data set like
whether or not a temperature is hot or
cold and it'll be able to predict if a
given temperature is hot or cold but a
conversation isn't a fixed size it's a
sequence of words we need a network that
can accept sequences as an input a
recurrent neural net in a recurrent net
we feed the data back into the input
while training it in a recurring loop so
we're going to build a chatbot in
tensorflow using recurrent neural Nets
our steps will be to download our data
set create a model train it on that data
set and test it out by chatting with it
the first thing we'll want to do is
decide what data set we want to use if
we were creating a chat bot for a
specific use case like customer service
we want to use a data set of
conversation logs from a real human
representative but for this demo we just
want to make a fun conversational bot so
we'll use a movie dialogue data set
compiled by Cornell University it
contains conversations between
characters from over 600 Hollywood
movies hopefully transcendence is not
included in that list well download our
data set and put it in our data
directory next we'll want to split our
data into two different sets for
training we'll call one set encoder data
and the other set decoder data the
encoder data will be the text from one
side of the conversation the decoder
data will be the responses then we'll
want to tokenize our data and give each
token an integer ID tokenizing means
taking each sentence like a lamelle and
chopping it into pieces so that it's
easier for a model to train on and
giving each token an Associated ID we'll
make data retrieval faster once our data
is properly formatted we can create our
model we can define our own function for
this that takes our tokenized encoder
and decoder data as its parameters our
function is going to return tensorflow
built-in sequence the sequence model
with what's called the embedding
attention mechanism let's break down
what the f this means a sequence the
sequence model consists of two recurrent
neural networks one recurrent net is the
encoder it's job is to create an
internal representation of the sensor
it's given which we can call a context
vector this is a statistical value that
represents that sentence the other
recurrent net is the decoder its job is
to given a context vector output The
Associated words the type of recurrent
net we'll be using is called a long
short-term memory network this type of
network can remember words from far back
in the sequence and because we're
dealing with large sequences our
attention mechanism helps the decoder
selectively look at the parts of the
sequence that are most relevant for more
accuracy so our model will be able to
create context vectors for existing
questions and responses and it'll know
to associate a certain type of question
with a certain type of response so once
we create our model we can train it by
first creating a tensor flow session
which will encapsulate our computation
graph then we'll initialize our training
loop and call our sessions run function
which will run our computation graph
which is our sequence the sequence model
and we'll use it as our parameter now we
can save our model periodically during
training using the TF train dot saber
function this will save our model as a
checkpoint file which we can later load
once we're done training using the
sabers restore function when we run our
program it'll take a few hours to fully
train we can periodically test what kind
of responses we get from our bots in
terminal if we'd like and as you can see
responses are pretty meaningless at
first but as our model improves through
training eventually it becomes more
coherent so to break it down deep
learning allows us to make chat bots
that are way more human life than any
kind of handcrafted chat bot we've made
before and to end systems are systems
that allow us to use a single model to
give us our desired outcome and we can
use sequence to sequence models using
two recurrent neural Nets to create
conversational chat BOTS the winner of
the coding challenge from the last video
is Georgie Petkov he implemented three
different methods to estimate a solution
to the travelling salesman problem and
benchmarked the results in an ipython
notebook badass of the week and the
runner-up is Nick Van Holtz he used both
the nearest neighbor and simulated
annealing algorithm to estimate a
solution the coding challenge for this
video is to use TF learned to write a
script that generates sentences in the
style of Lord of the Rings
he'll take at most 50 lines of code to
write this and details are in to read me
post your github link in the comments
and I'll announce the winner in my video
one week from today please hit that
subscribe button for now I've got a hack
snapchat spectacles so thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>