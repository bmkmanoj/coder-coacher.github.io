<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DeepFakes Explained | Coder Coacher - Coaching Coders</title><meta content="DeepFakes Explained - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DeepFakes Explained</b></h2><h5 class="post__date">2018-02-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7XchCsYtYMQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Hello world, it's Siraj. And, there's some
serious hype lately about this AI algorithm
called DeepFakes, that's able to swap the face
of anyone in a video with anybody else.
Some of the example I've seen are amazingly
realistic.  I'm gonna how this
algorithm works through theory and code
and then talk a bit about the moral
implications of this
at the end of the video. Last month a Redditor by the
name of DeepFakes, of course, was making a
name for himself by posting convincing
let's say, not safe for work videos that swapped
the face of the person in the original video
with a famous celebrity, like say,  Taylor Swift.
He did this by training his deep learning algorithm on some
publicly available videos with just his
home computer,  and in the past few weeks,
the practise of  doing this has exploded
There's an entire GitHub and sub reddit
community dedicated to maintaining this,
ensuring the results of this algorithm.  The subreddit
grew massively in size, and there's even this
desktop  application called FakeApp, that lets anyone
recreate one of these videos with their own
dataset, no knowledge of programming necessary.
Because of this, people are putting Nicholas Cage's
face on literally everything
and making a meme out of it, because, it's the internet.
So, how does the deepfake algorithm work?
Let's say we got this video of Harrison Ford in
Indiana Jones and we wanna replace his face
with Nicholas Cage, because, why the hell not
Our first step is going to be to gather some training data.
specifically, images of both, Harrison Ford
and Nicholas Cage, to later train our
models on. Possible sources of these images
could include Google, DuckDuckGo or Bing image search.
Luckily, the face swap repository has
scripts to automatically download large amounts
of images from one of these sources to our
home directory. Once we got a couple hundred
images, we can place them each in their respective
folder. Notice, though, that these images
full of stuff not related to our characters.
There are all sorts of objects and distractions in the environments
of these images that have nothing to do
with our characters. We're going to want to
perform some face detection on each
of these images. Pretty much all cameras that have been
created in the past decade, have some sort of
real time face detection algorithm.
The open computer vision, or opencv library
will allow us to easily recognise faces in images
with just a function call. But the way it's doing this in the
background, is by using a method called histogram of
oriented gradients or hog for short
It starts by making our image black and white to simplify it.
We don't need color data to find faces.
Then it looks at every single pixel in the image on
one at a time. For every pixel, it looks at
the pixels directly surrounding it. The goal is to figure out
how dark the current pixel is compared
to the pixel directly surrounding it.  Then,
it draws an arrow showing in which direction the image is
getting darker. Once it does this process for
every single pixel in the image, we'll end up with every
pixel being replaced by an arrow.
These arrows show the flow from light to dark
across the entire image. If we analyse
the pixels directly, then really dark images and
really light images of the same person would have totally
different pixel values. But because we're only considering
the direction that brightness changes,
both types of images end up with the same representation.
making the problem easier to solve.
Saving all these directions is too space intesive.
So we break the image into smaller squares.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>