<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Recommendation Systems - Learn Python for Data Science #3 | Coder Coacher - Coaching Coders</title><meta content="Recommendation Systems - Learn Python for Data Science #3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Recommendation Systems - Learn Python for Data Science #3</b></h2><h5 class="post__date">2016-10-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9gBC9R-msAk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello world it's Suraj in this video
we're going to write a script that reads
in a data set of movie ratings then
recommends new movies for a user in 40
lines of Python we are in the midst of a
new Renaissance right now and the reason
for it is data in the past 2 years we've
created more data than in the entire
previous history of the human race your
options to learn or experience or create
are limitless on the web this is awesome
oh my god I'm going to throw up but all
of this abundance presents a problem the
paradox of choice because we have so
many choices
we could spend way too much time trying
to pick one we could end up not picking
anything at all or worse pick something
and then get FOMO or fear of missing out
if there was a way to have an abundance
of options and have certainty in our
decisions that would be ideal right
that's how recommendation systems help
us they use machine learning to go over
all of our options learn what we like
and recommend which option we would like
best and they're getting insanely
accurate like they know us better than
we know ourselves sometimes Amazon
recommends products we'd like google
recommends search results we'd like
Facebook recommends friends we'd like
pretty much every service doesn't know
there are two main types of recommender
systems collaborative systems and
content based systems collaborative
systems predict what you like based on
what other similar users have liked in
the past content based systems predict
what you like based on what you've liked
in the past and some services like
Netflix combine both approaches to be
even more accurate so let's write our
own script that recommends movies a user
would like we'll install our
dependencies then write our script we're
going to use three dependencies both
numpy and Syfy will help us do some math
and light if M is a library that allows
us to perform any number of popular
recommendation algorithms we'll start by
importing numpy and call it NP line if M
is a big library so we're only going to
import the sub modules of it that we
need or use the from import combination
to import specific methods from sub
modules as necessary well import the
fetch movie lens method from the data
set sub module in the light FM class
directly from light FM which will later
create a model for us
now that we've imported our dependencies
we're going to fetch our data set let's
create a variable called data to store
our data set in well use the fetch movie
lens method we imported earlier
from our light FM dependency to fetch
our data set the movie lens data set is
a big CSV file that contains 100k movie
ratings from 1k users on 1,700 movies
each user has rated at least 20 movies
on a scale of 1 to 5 so hopefully they
gave this a zero I'll create a GUI
interface using visual basic see if I
can track an IP address the batch movie
lens method takes in an optional
parameter called min rating min rating
is a minimum rating we want to include
in our data will set it to 4.0 which
means we're only collecting the movies
with a rating of 4 or higher so this
method will create an interaction matrix
from our CSV file and story in our data
variable as a dictionary a dictionary is
a way to store data just like a list
except instead of just using numbers to
retrieve data you can use anything in
our case we'll use strings our fetch
movie lines method splits our data set
into training and testing data and we
could retrieve each by using the Train
and tests strings as keys we'll print
out both let's quickly see what this
looks like in terminal when we compile
it it will print out both our training
and testing matrices we can see that our
training data contains ten times more
items than our testing data will store
our model in a variable that we call
model well initialize a light of M class
using a single parameter called loss
loss means our loss function and it
measures the difference between our
models prediction and the desired output
we want to minimize it during training
so our model gets more accurate over
time in its predictions we can choose
between several we'll go ahead and
choose a loss called war which stands
for weighted approximate rank pairwise
warp helps us create recommendations for
each user by looking at the existing
user rating pairs and predicting
rankings for each it uses the gradient
descent algorithm to iteratively find
the weights that improve our prediction
over time this takes into account both
the user's past
rating history content based and similar
users ratings collaborative it's a
hybrid system now that we have our model
we can go ahead and train it well use
the fit method of the model object to
Train it the fit method takes three
parameters the data set we want to train
it on the number of epochs we want to
run the training for and the number of
threads we want to run this on for our
data set we use our data dictionary we
created earlier and point it to the
training data using the Train string
we'll set the number of epochs or runs
for this training session to 30 and the
number of threads or parallel
computations to 2 now we want to
generate a recommendation from our model
to do that
all right a sample recommendation
function which takes three parameters
our model our data and a list of user
IDs these are users we want to generate
recommendations for first we'll get the
number of users and the number of items
which are movies in our case using the
shape attribute of the data dictionary
we created now we can create a for loop
to iterate through every user ID that we
would input and say that we want the
list of known positives for each line if
M considers ratings that are 5 positive
and ratings that are 4 or below negative
to make the problem binary much simpler
we'll get the list of positive ratings
from our data in compressed sparse row
format this is a sub array inside of our
data matrix which will retrieve using
the indices attribute next we'll
generate our recommendations and store
them in the scores variable using the
predict method of our model we'll use a
user ID as the first parameter and then
a list of each movie the a range method
of numpy will give us every number from
0 up to the number of items so we can
predict the score for every movie then
we'll sort them in order of their score
the Arg sort method of numpy will return
the score indices in descending order
thanks to the negative sign let's go
ahead and print them first we'll print
out the users ID % ads will convert the
ID to a string then we'll print the top
three known positive movies that the
user has picked by creating a full loop
ending in the third index
lastly we'll create one more loop for
printing the top 3 recommended movies
that our model predicts we'll call it at
the end using the model data and a list
of 3 random user IDs as the parameters
each user has movies that they like
listed as well as movies that our system
has recommended for them so to break it
down recommendation algorithms help us
make decisions by learning our
preferences there are two main types of
recommendation algorithms content based
and collaborative and lastly light if M
is a great library to get started with
building recommendation systems the
winner of the coding challenge from the
last video is Rohan Verma
Rohan went above and beyond by creating
a web app where you can search a topic
and it will list a bunch of tweets on
that topic with highlighted sentiments
badass of the week and the runner-up is
arnaud Villani well documented and well
defined methods the challenge for this
week is to modify this code so that
instead of using the default fetch movie
lens method you'll write a new method
that fetches and formats some other
recommendation data set train it on
three different models
compare the results and print the best
one post your github link in the
comments and I'll announce the winner in
the next video links to everything in
the description please share this video
and subscribe for more programming
videos for now I've got to wonder why
yahoo still exists so thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>