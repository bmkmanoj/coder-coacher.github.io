<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build a TensorFlow Image Classifier in 5 Min | Coder Coacher - Coaching Coders</title><meta content="Build a TensorFlow Image Classifier in 5 Min - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Siraj-Raval/">Siraj Raval</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build a TensorFlow Image Classifier in 5 Min</b></h2><h5 class="post__date">2016-09-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QfNvhPx5Px8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello world
it's Suraj in this episode we're going
to build an image classifier using
tensorflow
in 30 lines of Python and I don't mean a
classifier that can detect handwritten
digits or iris flowers I'm talking
literally anything you want you'll be
able to train this thing to classify
chocolate if you wanted the
possibilities are endless there's so
many industries that can be disrupted by
just this simple solution a Japanese
cucumber farmer built a machine to
detect whether each of his cucumbers was
one of nine different types using this
thing let's say we want to build a Siraj
classifier if we think about this
problem in the traditional programming
paradigm we want to handcraft a bunch of
features maybe we could do some edge
detection to save the shape of my hair
or use a color histogram to save the
color of my teeth the problem with that
is there's so much variance in Suraj's
my hair is a lot seriously it's never
the same this is where convolutional
neural networks come into play they're
essentially a black box that constructs
features that we would otherwise have to
handcraft
and these abstract features they create
from training are so generalized that
they account for variance if we wanted
to train a CNN ourselves we need a lot
of computing power and a lot of time
both of which we don't have I don't even
have time to do my dishes
sorry remits that's why we want to use a
pre trained CNN model called inception
inception was trained by Google on 100 K
images with a thousand categories our
use case in this video will be
classifying Darth Vader pictures but
inception wasn't trained on Vader so
we're going to perform a process called
transfer learning that means applying
the learnings from a previous training
session to a new training session if we
look at the inception model we can see
that when we feed in an image is an
input at each layer it will perform a
series of operations on that data until
it outputs a label and classification
percentage each layer is a different set
of abstractions in the first layers
it's basically taught itself edge
detection then shape detection in the
middle layers and they get increasingly
more abstract up until the end if we
look at the last few layers these are
the highest level detectors for whole
objects for transfer learning will
basically just want to retrain that last
layer on features of Darth Vader so it
can add a representation of him to its
repository of knowledge so this is going
to be a seven step
process and we're going to go through
each step in order sound good step one
is to install docker which is a tool for
creating a virtual container on your
machine for running apps the benefit of
docker is you don't have to install any
dependencies on your machine so we'll
eventually download a docker image that
has all the necessary dependencies for
tensorflow
built in just download a docker toolbox
go through the installation process and
then you can launch your dr container
anytime easily by double-clicking the
docker QuickStart terminal cool now that
we have docker open that brings us the
step to installing the tensorflow docker
image by pasting in this line it'll take
a few minutes then once it's installed
we'll move on to step 3 downloading our
image data set to our local machine will
stop docker with control D and create a
directory called TF I'll slash Star Wars
and our home directory locally we want
to put a folder labeled Darth Vader that
contains a couple hundred Vader pics in
here there's this dope Chrome extension
I found called fat con batch download
image that bulk downloads all the images
from your google image search results
just go to google image search type in
Darth Vader and start downloading all of
those images once we got them we'll just
drag that folder into RTF file slash
Star Wars folder that brings us to step
four now that we have our images in RTF
files directory if we want to link them
to our docker container with this
command boom all inked up step 5 is to
download the training script via get
just CD into the tensorflow directory
then run get pull this code will allow
us to retrain the inception classifier
with a newly linked Darth Vader image
data set step six is the actual
retraining part the bottleneck directory
will be used to cache the outputs of the
lower layers on disk so they don't have
to repeatedly be recalculated we'll run
this example for 500 iterations the next
flag asks where to store our trained
model our output graph which we can
later view in tensor board our output
labels which will be the same as our
training data folder name and the image
directory where we stored our Vader
images let's go ahead and run the script
right from terminal it'll take about 30
minutes or so to train our classifier so
do something productive
the script should output a training
accuracy somewhere between 85 and 99
percent when it's done and this brings
us to our final step we want to write a
script that will use our new retrain
classifier to Detective a novel image
contains darth vader where i disrupt
ourselves
first things first we'll import
tensorflow then we want to create a
variable to store the user input image
path we'll create another variable to
store the data from that image and one
more to load the label of that image
from the label file next we'll want to
grab our model from the saved retrained
graph file store it in the graph def
variable and parse it now that we have
our image and model ready it's time to
make our prediction by feeding the image
data into our retrained model to get our
prediction output in order to do this
will create a tensor flow session this
will give us an environment to perform
operations on our tensor data in the
first thing we'll do in a session is get
our softmax function tensor from the
last layer of our model the softmax
function is using the final layer to map
input data into probabilities of an
expected output we will execute our
softmax tensor function on our input
image data via a session run function it
will output our predictions as an array
well next one to sort our prediction
labels in order of confidence and lastly
for every prediction we have we can get
the predicted label and the score and
print it out to terminal let's take the
script and run it on one of our Bader
pictures the result is pretty good
tensorflow makes it much easier to
classify an image and I've got a
challenge for you guys on this episode
the challenge is to create a classifier
that you think would be a useful tool
for scientist to have it can be any
field of science you'd like upload your
code to github and then the readme write
up a few sentences on how a scientist
would use this poster repository in the
comment section and I'll judge them
based on utility and accuracy the winner
gets a shout-out for me two videos from
now so in two weeks and I'll also send
you a free signed copy of my book
decentralized applications for now I've
got to go not buy the iPhone 7 so thanks
for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>