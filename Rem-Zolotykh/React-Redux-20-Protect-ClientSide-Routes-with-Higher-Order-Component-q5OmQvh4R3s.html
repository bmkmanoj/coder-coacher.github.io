<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React &amp; Redux #20. Protect Client-Side Routes with Higher Order Component | Coder Coacher - Coaching Coders</title><meta content="React &amp; Redux #20. Protect Client-Side Routes with Higher Order Component - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Rem-Zolotykh/">Rem Zolotykh</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React &amp; Redux #20. Protect Client-Side Routes with Higher Order Component</b></h2><h5 class="post__date">2016-08-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/q5OmQvh4R3s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi and welcome now we need to protect
client-side routes we already created
new event route but now even when we
logged out we can access this round have
a look so if we go right now I'm logged
out so if I go now to new event I can
access this route and that's not what we
want and in this episode we're going to
fix it and for that we'll use high-order
component higher-order component is cool
fancy and maybe a little bit
intimidating term but it's quite simple
it comes from high order function and
it's basically function that takes
another function and wraps it with
additional common functionality well
let's have a look at a simple example of
that so easy way to understand it is a
logger higher-order function let's say
that we have function print hello okay
and now we want to wrap it in logs so we
create a new function and we call it for
example log and it takes any other
function and after that it will have two
logs for example the first one is going
to be start and the second going to be
end and between this logs will have
function call and that's basically it
very simple idea and kind of a building
block of composition in react we can do
the same thing but with components in
our case we want to have high order
component which will check if users
authenticated and if not read right to
log in page with flush message otherwise
it renders passed component so let's try
that so let's create in utils in client
utils folder will create require out J's
file and here let's create component and
we call it authenticate that's going to
be our high order component so the
difference is we wrap this component and
function and we're going to export it so
we'll export default function and this
function will take any other component
will call it composed component so now
we can ship this authenticate component
right here and instead of exporting
default now we just return this new
component so next in render if
everything is ok we
just need to render pass component and
also pass down all props to it so
instead of this deep here
we'll return compose component that was
passed to us here and we pass all props
that we have on this component ok so you
can see right now that it's a wrapper
function basically we pass here
component we initialize another
component and inside of it we just ran
the pulse component so let's try to use
it right away
let's open routes client routes that we
have now let's import require off from
you Till's require out file and instead
of here where we have our new event
route we surround this with brackets and
recall require out and we pass this new
event page component into it so right
now if you go back to browser and reload
our page nothing has been changed
because we don't do anything we just
created two wrapper basically but now we
can add authentication check so for that
let's go back to our authenticate stuff
and let's connect it first of all we
need to connect it to read X store
because we need to get is authenticated
field from it so let's surround it and
we connect and then connect will have
map state to props function and we going
to define it right here as usual we'll
have state and it's going to return just
is authenticated to be state L is
authenticated okay now that we define it
always defining authenticate prop types
is authenticated should be boolean and
it is required okay nice pretty usual
stuff for now right now that we have in
football authentication stage we need to
add some behaviors so for that we're
going to use life cycle hook of the
react component one of them is component
will mount so right before it mounts we
want to check that if this props is
authenticated so if it's not
authenticated then we'll do two things
first we're going to add
- message so go have another action here
props add flash message with type error
and with text you need to log in to exit
this page and after that we just
redirect it with context router push and
let's redirect to logon okay so for that
to work we of course need to improve
this section so let's import ad flash
message from actions flash messages and
we need to pass it so here in prop types
let's define add flash message to the
prop types function and of course we
provided from redux so we do it here add
flash message and the second thing we
need to define router context so we'll
have authenticate context types and
router is going to be usual object is
required and that should do the trick
let's have a look in the browser so now
here if you try to reload the page we
are redirected to login route with this
error message excellent well another
small detail if I log in and I go back
to this page and after that I log out
you can see that nothing happens I've
logged out but I haven't been redirected
so let's fix it for that we're going to
add another life cycle hook to our
component right here we'll use component
will update and it takes next props so
if next props is authenticated again if
is authenticated is false then we just
this contexts that push and we going to
redirect to router we redirect to my
page so now if we go back here I'm going
to login and I'm going to new event and
now if I log out I'm immediately
redirected back to home page nice let's
commit require our
i order component and this is how we can
protect client routes thanks for your
time and if you found this episode
useful please share it with your friends
and subscribe to this youtube channel or
follow me on Twitter to get updates
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>