<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>React &amp; Redux #16. Authentication: Verify User Credentials | Coder Coacher - Coaching Coders</title><meta content="React &amp; Redux #16. Authentication: Verify User Credentials - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Rem-Zolotykh/">Rem Zolotykh</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>React &amp; Redux #16. Authentication: Verify User Credentials</b></h2><h5 class="post__date">2016-07-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/O8z0F8Lqz1k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi and welcome now to the interesting
part when we submit logging form we will
get arrow back with wrong credentials
error or we get your token in this
episode let's implement both of these
scenarios so let's open editor and let's
go to server index file to add our new
route so we're going to just copy this
one and change users to let's call it
out because we're making out requests
and let's copy this one and change users
two out as well okay so now let's create
routes of GS and here we have just
simple route so we have router we're
making post request to route route and
we have requests and response objects
here so first let's get data from
request body so we have constant and we
deconstruct it with identifier and
password from request body next we query
user trying to find user by user name or
by email like we did before so we'll
have user query and we have where
username equals to identifier or where
email equals to identify and of course
we need to import user from modal's user
ok after that we're going to fetch it
and then we'll have our user ok so now
we need to check if we find user and if
we find one we need to check its
password so first if we have user then
we do something here we're going to
compare password else we didn't find
user with such identifiers so we need to
respond with status for a one and we'll
have Jason here with error subject and
in this object will have special field
form which we'll use to display global
form errors not the field specific
errors and we'll use it invalid
credentials
ok so now if we found user we need to
come
passwords and for that we're going to
use big ripped so let's import bcrypt
from big crypt and bcrypt has this
compassing function that we're going to
use here so if bcrypt compare sync and
we compare password that is given to us
and request where the user get password
digest so if comparison returns true
that means that we verify user identity
and here we'll create JSON web token and
we're going to send it back in a moment
but in other case we'll just respond
with the same error status like we did
here and we have two errors here and we
could be more specific for example here
we can return error that tells that no
such user with such identifiers and here
we can notify that the password is
incorrect
but I prefer not to from security point
of view so now that we have this error
let's render this error in our form so
let's open login form and here now form
right after login will add check for
errors form so if we have such an error
then we going to render deve with class
name equal to alert alert danger and
inside of it we can render errors that
form let's save it and let's try it out
so here in login I provide wrong email
and when I try to login I have this
invalid credentials displayed to me and
if I have correct email but wrong
password I'm having the same thing okay
cool so we finish with first scenario so
now let's handle valid credentials so
let's go back to our route and here is
where we handle valid credentials so we
need to generate JSON web token and
return it to the client so for that
we're going to use JSON web token
package so let's install it so we
install save JSON web token okay cool
and now we can use it to create out
token so let's define constant
touken and jug library has this method
sign and it takes two parameters the
first one is the payload just an object
that we can decode on the client and in
our case we're going to have very simple
one we'll have ID and we get it from
user and we'll have user name also we
get it from user of course just remember
that this object can be encoded without
any encryption without any codes with
secrets etc so it's basically public
information so you shouldn't include in
this object any private information so
the second argument is the secret some
secret key that is going to be used for
encryption and light it will be used to
verify this token and we're going to
store it in config object dot secret
like this so let's import this config
object from config gs now let's create
one will have config digest and that's
going to export default simple object
dot secret and here just some secret key
for JSON web token very secure string
here
so now that we have this token we can
respond with JSON with this token and
that should do it
let's have a look so here I am in login
page and if I submit this form I'm
rejected back and if I go to network to
our request and have this preview tab
you can see the token right here this is
our JSON token that we're going to save
on client and decode it and use it later
in future episodes
so let's commit we verify user
credentials so thanks for time and if
you found this episode useful please
share it with your friends and subscribe
to this YouTube channel or follow me on
Twitter to get updates thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>