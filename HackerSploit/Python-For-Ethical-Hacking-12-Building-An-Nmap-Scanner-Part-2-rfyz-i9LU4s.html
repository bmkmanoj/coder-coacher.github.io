<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python For Ethical Hacking - #12 - Building An Nmap Scanner - Part 2 | Coder Coacher - Coaching Coders</title><meta content="Python For Ethical Hacking - #12 - Building An Nmap Scanner - Part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/HackerSploit/">HackerSploit</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python For Ethical Hacking - #12 - Building An Nmap Scanner - Part 2</b></h2><h5 class="post__date">2017-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rfyz-i9LU4s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys huggers Floyd here back again
with another video and welcome back to
Python for ethical hacking and in this
video we are going to be continuing
working on our nmap custom scanner that
we're building with Python and using the
N map module so let's pick up where we
left so as we already did
we basically imported the N map module
or the package and we initialized the
port scanner we made it display the
version number we then scanned an IP
range for looking for a certain amount
of IP ports and again I have to point
out I do know that this means verbose
all right so we also suppose to the
information we then print out the scan
information that we got and then we
print it out into an CSV file now I just
want to point out one thing before we
continue these videos are not showing
you how to build your own network
scanner yet I'm gonna those videos are
still to come but it's very important
that you understand the basics and of
course the advanced of Python before you
can start creating your own advanced
scripts what these scripts are gonna be
used for and what I'm trying to teach
you here is that you can create your
very own lightweight small Python
scripts that perform a specific task
like you'd create one that would utilize
nmap and would can also utilize
something like multi go for example you
can scan an IP address and then you can
also choose to use it with multi go and
then you can D spend then you can
display results that's what I'm trying
to show you how to do and again we'll be
moving on to building advanced scripts
with Python but for now I'm just going
to be explaining everything as we go
step-by-step
right so let's get started now so we
looked at how to scan an IP and again
you can also include a range here so
this is the NS thoughts scan so this way
you specify your IP or your IP range so
you can really just scan your network
and find IPS or you can find computers
and probably what you can do is if
you're using Metasploit able you can
actually use that to scan and then you
can perform attacks etc etc
so what I was talking about is you can
use an IP range like so for like say one
way to 24 that's pretty much the
standard you can alter then specify your
ports right now we're looking at 1 to
1,024 but now let's look at getting some
more information yes so what I'm gonna
do is I'm just gonna change the port
from 22 to 445 I believe so essentially
we're just going to reduce the amount of
time it's going to scan for ports in
addition to that if we save this and run
this let's see what we get right so it's
still scanning it's going to print out
the version info and this IP does not
have any service running in that port
range so what I'm gonna do is I just
loaded up a Zen map here but actually I
do know the IP so let's just go back to
that and I'm just gonna scan to a
thousand all right that'll keep it
pretty much simple and really doesn't
matter what IP what port range of course
you can specify what port ranges you
want open but for now let me just scan
that one I want to find one of my
devices that has alright so we have the
TCP and HTTP I mean SSH and HTTP ports
open about 80 / 22 so that's pretty cool
and we can now change this back to the
what I wanted to specify it which is 22
and a 445 so let me just specify that
and now we also want to print out some
more information right so what I want to
print out is on we just print or the
absolute version so all the information
so I think that's done with the a right
over here so VA so if we run this I'm
not sure it'll work or idea so we got a
problem here
if we debug it's essentially what it's
saying is the argument is incorrect
so I know what the problem is it's pro
it's going to ask us to use something
else here and we have to specify the the
full argument that we want to use in
that in this case it is essentially the
version version all alright I think
that's that's probably going to work
because we are for boozing and now I'm
going to print all alright so there we
are so they're pretty pretty much print
everything that we need and as you can
see it's displaying the TCP we also have
these services which are going to be the
pots 22 to 455 they're not specified
anything else yet and here it's
displaying the IP again you can specify
an IP range that works perfectly in fact
let me show you that right now
let me just run this again like so of
course it's gonna take a long time there
we are so it's gonna bring up the
devices on my network and yeah we have
some open ports here we have the 277 I
know what what that is we have the email
port SSH those are the standard ones
opened on my router and HTTP standard
stuff okay nothing important or
interesting there but you can basically
scan for a range of IPs
now we've printed the version and now
let's look at something else let's look
at how to specify the scanner a little
more or make it specific to any type of
IP that we want to scan alright so what
I'm gonna do is I'm just going to change
this back to one in two point which is
essentially the IP of my router and what
on to do now is what I'm gonna do is I'm
just gonna comment these two alright so
let's factor let me just bring them back
here what I'm gonna do is I'm just gonna
comment them because I don't want to
delete them and now if I just go down
here let me just get rid of that we want
to get some more information so let's
get some scan test stats
pardon me so these are essentially just
gonna be stats about the scan like the
amount of time that it took so let's
print that out which is well very very
helpful so print I we created the NS
dots can scan stats like so that's a
pretty simple one all right now what if
we wanted to print all the hosts alright
so essentially what we have to do now
is what I'm going to do rather is I'm
going to have to print out just below
this I'm just gonna say print out we are
printing out all the the hosts on the
network so NS which is essentially all
so NS dot all hosts alright and that'll
pretty much scan for everything but if
we just print it out we'll get the
results as you can see it's gonna scan
okay firstly let's start off with these
scan stats as you can see it's displayed
here the elapsed time which is 0.2
seconds which is pretty fast and the NS
not almost is gonna scan for hosts and
as you can see it's detected one host
that's up and that is the host
alright so pretty interesting now that
really isn't very helpful because we are
we are scanning for all hosts let's
specify this a little more all right so
let's scan for what I'm gonna do is I'm
just gonna comment this right here but
keep on pressing my other key all right
so let's print out I'm thinking of a
specific type of range here let's just
scan for the state of of an IP address
all right so let's say we want to scan
for the state of an IP which in this
case we'll just use my my route IP which
is always going to be on but let's just
test it so in here I'm just gonna say NS
alright and now in here we have to
specify the IP so in the square brackets
so 192 point
168 I believe we have to specify that in
single quotes point 168 point zero point
one alright as simple as that
and after this after the square brackets
dot state alright
I believe if that is correct I'm not so
sure we'll have to test it out right so
that is essentially gonna print out this
state so if we run this and yes it's
gonna tell us that the state is up so
that is pretty pretty cool and we can
also comment this so essentially what we
are saying is we are just checking to
see if this host is up again you can
check
see if the entire network is up which as
you see what we're getting to is you can
create really awesome scripts for your
home network or even if your systems
administrator you can create scripts
I'll make your job a whole lot easier
okay so let's just comment that and
let's specify something a little more so
if we save this now and rerun this you
can it'll essentially just give us
information about the scan which are
these scan stats let's look at something
different all right what I'm gonna do
now is I want to check the protocols
running on on my router IP ok so we want
to check the protocols running so what
we can do is we can just print out and
we can say NS and again we specify our
IP or our IP range point zero point one
oops I forgot you have to include our
single quotes on a two point one sixty
eight point zero point one alright
pretty cool now what we have to do now
is obviously we have to use an extension
so dot all alright dot all let me try
and remember it
dot all under score protocols I'm pretty
sure that's the one and we use our
parentheses to specify any additional
information but right now we don't have
anything so if we print this out it's
gonna scan for all the protocols that
are running for example we could have
let me just scan this and see yeah we
have the TCP that's currently open the
TCP protocol and that's pretty cool that
it does show that so that's how to
specify any protocol specific protocols
that you want to scan for on a specific
IP or on a range of IP addresses so
that's pretty cool but what I want to do
now is we're going to comment this as
well and let's specify some other stuff
okay there's a lot of stuff you can do
with the nmap module and I'm just
showing you how to incorporate it into
building what you can call may be a
specified or a specific type of script
that you know you can tailor to whatever
you need so we'll scan for protocols now
one of the most popular ones that I find
out there is how to scan for open ports
right so you can specify an IP or a
range of IPs so that's really very
simple right so we are printing and now
it's a bit different we have to use the
ns and of course we specify or IEP hanya
1 168 of course you can use any other IP
of using a Metasploit able machine or
virtual machine you can just enter that
IP and we'll give you much more
information I'm just using a
standardized technique here so one
ninety two point one sixty eight point
zero point one so specify the IP now you
have to specify the protocol that we are
using because we are trying to find the
ports that are open but now let's just
say we want to check for TCP okay and
we're just going to use the keys right
so that will show that will show us
what's currently running and I believe
that is the correct way and if we run
this there we are so it's gonna tell you
what ports are open on your host one so
you can see eighty twenty two and we can
actually just change this to whatever we
want so I have another IP I believe on
my network right now that's currently
running and we've got nothing here hmm
that's because we have scanned for the
top scanner all right no problem so I
know the array is there so there we are
that's to scan a specific IP for a
number of open ports okay with a
specific protocol we have learnt we have
seen how to use to scan for all
protocols and now in here you can
specify pretty pretty awesome as well
now let's look at how to search for
specific ports let's say we want to
search for port 80 which is very very
popular as well this is at this is
really really cool and I know you can do
this with the nmap scanner but it can be
really awesome like if you're doing this
on a daily basis or your particular
you're scanning for an open port let's
here on the Systems Administrator and
you're always scanning for an open port
you can run this script on your network
and you know it's awesome it just runs
it really really quickly so what we can
do is you're say print NS and we can
open that up and we specify our
when 168 point 0.1 awesome okay but now
we have to we already know that we are
searching for a specific pot so what
we're gonna do is you're gonna say has
we're going to use the extension has
underscored TCP so we're searching for a
TCP protocol with the port 80 so it's
gonna search where they does have put 80
we already know it does so it's gonna
give us the the answer which is going to
be either true or false
all right so it'll test for that pot and
then we'll lay the display to a false
depending on what the answer is so there
we are get rid of that code block and as
you can see once you've saved it it's
going to give us our our scanned stats
and it's gonna tell us indeed it is true
we can search for something like a
random on like four hundred all right
which I know is not going to be
available and it's gonna say false as
you can see it does really work we can
also scan for 22 which is SSH and if you
run this it's gonna say yes it is using
TCP pretty pretty awesome and as you can
see that is how to essentially just use
modules in in relation to in relation
with Python really and it's pretty it's
very very awesome and you know you can
really really experiment with everything
you can check for the nmap documentation
and try all of the commands and you know
you can build yourself a very very user
specific type of scanner that can really
really say save you time so that's going
to be it for the end map section again
I'm just using this to teach you how to
use all of these commands and the
functions that come with an map alright
now in the next set of videos we're
actually going to be building our own
password cracker but we'll get to that
in the next video anyway that's it for
this video guys
I will be seeing you in the next video
if you enjoyed this video found value in
it please leave a like down below if you
have any questions or suggestions let me
know in the comments section or you can
hit me up on my social networks if you
have any personal questions you can hit
me up on kik and if you want the latest
hacking news and resources you can check
out my website link will be in
description and I hope you have a
fantastic day peace</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>