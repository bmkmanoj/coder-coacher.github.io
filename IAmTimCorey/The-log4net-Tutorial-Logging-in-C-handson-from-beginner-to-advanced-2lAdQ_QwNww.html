<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The log4net Tutorial: Logging in C# (hands-on from beginner to advanced) | Coder Coacher - Coaching Coders</title><meta content="The log4net Tutorial: Logging in C# (hands-on from beginner to advanced) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/IAmTimCorey/">IAmTimCorey</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The log4net Tutorial: Logging in C# (hands-on from beginner to advanced)</b></h2><h5 class="post__date">2015-09-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2lAdQ_QwNww" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">application logging is a big deal
keeping track of issues in your software
in production needs a priority of any
application developer analyzing what
went wrong monitoring the application
responsiveness and getting metrics about
usage are all important to delivering a
healthy sustainable app if you search
the web for application logging in
c-sharp it brings up a number of options
and suggestions if we come down here to
the dotnet logging tools and library
you'll give us a list of a number of
different loggers so where do you start
well if we come back over here to the
Stack Overflow questions and answers
you'll note that a lot of these when the
answers will point to things such as
log4net in fact if you could beat all of
these answers you'll find somewhere in
here
something about log4net if you're like
me at this point you figure that now is
a good time try out log4net to see how
easy it is to wire up and use in a
project and that's where you hit the
wall there isn't a lot of great
information about log4net
if you look at the log4net site which is
this right here you'll find there's not
a lot of good information here it has
documentation but it's rather ugly and
confusing that is why five years ago I
wrote an article on log4net
for code project after spending days
digging through the documentation
experimenting and test apps and figuring
out the answers to my questions
I decided to make life easier for myself
and for others I compiled my notes into
an article that covers how to setup and
run log4net
in a production environment since then
the article has had hundreds of
thousands of readers and it continues to
generate about 4,000 views each week
that tells me a couple things first it
tells me that log Fernet is still a
popular logging library
and second it tells that people are
still confused on how to implement this
library that is where this video comes
in I learned bats when I'm shown how to
do something I figure there are others
of you out there just like me so I'm
creating this video as a companion piece
to my code project article I am going to
walk you through sing up log4net for the
first time in your application you can
follow along as I build the application
and then add logging to it we will start
out simple but then we will dive into
the depths of what a real-world
implementation might look like by the
end you should feel comfortable adding
log4net
into your application let's get started
all right to get started I'm going to
start with a console application this is
going to start off with a basic hello
world style logging demonstration we're
going to do just enough to get logging
working the cool thing here though is
once we get logging working we can
actually scale this app out into
something that would look like a
production app very easily so when I
start small and then build from there so
here I set up a console application I've
named it log4net tutorial as a solution
and the product name is console UI okay
let's go ahead and create this
application so here's my basic console
application if you're not familiar with
console application it looks a lot like
the dos windows of old and if we run it
right now it's kind of pop-up a DOS
window it's going to go away let's
instead go ahead and add a couple of
commands just to have something on the
screen first we're going to create the
console.writeline and say hello world
and next we're going to say
console.readline in order to stop the
console from going away this way the the
console and it pops up it's going to say
hello world but that's going to pause
until we hit the enter key let's go
ahead and run this and there we go
there's our hello world application
really simple right now it just says
hello world it waits for us to give a
some kind of input we hit the enter key
and it goes away the application is done
so now adding logging to this is going
to take five steps the first step is to
go to our references and say manage new
get packages in here let's search for
log4net the first one it comes up is the
official log for net new get package the
ID is log for net let's go ahead and
install that and that's it for step one
we go back to preferences and expand
this will see the log for
that DLL is being brought in step two is
the step that really trips people up
okay so don't panic when you get into
the step it can look overwhelming but
once we break it down you'll see it's
not really that complicated so step two
is to go into our app config file this
right here now if you're using a web
application this with a web config file
for our purposes it's the same
difference if you're a desktop
application it's app config if you're in
a web application its web config the
first thing we need to do in this
section is create a section dedicated to
log4net so let's talk a config sections
inside here right create section the
name of log4net
and that mean can be anything you want
but I recommend keeping it log4net and
the type equals log for net dot config
dot log for net configuration section
Handler and then comma log4net all right
we're done with all that we just need to
close it out okay so what I've done here
is I've said I'm going to create a
section in my config file called log4net
look for that all right so now let's
create a section called log for net log
for net everything in here is going to
pertain to creating our log files Wendel
in our log files what information to log
and how to log it the great thing about
putting information in here is that at
runtime we can change the configuration
of our logging without having to
recompile our application the first
thing you need to add to
our log4net section is what's called an
appender now in appender is basically a
logging tool it's what do we want to log
to in this instance we're going to log
right to the console window since we
already have a console application it's
the quickest way to make sure you get
feedback and it eliminates a lot of
problems of do we have permissions of
file system do you have permission that
database is there a problem with the
connection string all those kind of
things go away because it's a very very
simple logger or a Pender so first when
you give it a name again it's going to
be anything you want but let's call it
console appender next the type and this
is specific so log for net dot appender
dot console appender we're going to look
at more appenders in a bit but for right
now we're just going to use the console
appender
and i'm going to walk you through how to
do it later I'll show you how to go to
the documentation and find all the
different appenders and how to use each
one so now you define the appender line
now you put things inside the appender
for the console appender when you tell
the console how to write out our message
and that's called a layout the type
equals the log for net dot layout dot
pattern layout alright what that's going
to do is it's going to say hey I've got
a whole bunch of information that I can
put the console but what do you want on
the console and how do you want laid out
there's more than just the actual
message we want to log for example there
might be exception data or the date and
time or the log level inside a layout
for the console appender we have a
conversion pattern
the value has to be that pattern you
want to write out log Fernet has a
specific way of designating what each
item is and we're gonna go over what all
these different values could be but I'm
going to give you a pretty standard
layout first we'll put the date and then
we're going to specify that it should be
absolute there are a couple things to
note about the state first this is the
local date and time if you want the UTC
date you just need to specify UTC date
basically important if you're running
log4net on a web application that may be
installed on servers in different time
zones the second thing to note is that
absolute the absolute is a pattern it
just tells us that this is a specific
way I'm going to lay out the date and
time you could put your own pattern here
but it's a much slower process for
log4net to figure out how to lay out a
date compared to using one of their
three built-in patterns for date and
time in this case the absolute pattern
next let's put the thread and this will
just give us the thread number for the
currently running thread next let's do
the level of the error that could mean
just an information log or it could mean
that it's an error log or a fatal log or
anything in between
finally let's put the message this is
the actual message you give the logger
and then just in case we have an
exception to log as well for example say
we threw an exception one it we want to
give it a message we also wanted to
capture that exception information as
well we can pass both of those pieces of
data together to the logger and in this
case right here if we didn't add
something for the exception to be
displayed nothing would show up so let's
go ahead and create a new line first
and then next we're going to put the
exception and no there's no spaces there
the % indicates the start of a new tag
and so I'm saying right at the end of
the message put a new line and then
right away put the exception if there is
one otherwise going you blank and that's
it
we now as close out our tag and now we
have an append or called the console
appender that has a layout that
specifies the date the thread number of
the thread where these log was called
from the level of the message the actual
message that is being logged and then if
we have one we're going to put the
exception as well all of this
information will be written to our
console every time we log a message so
that's an offender appender again is
just something we're going to write the
log two in this case to the console you
can have more than one appender in your
log system you can even specify that one
appender gets certain type of log
messages or certain messages based upon
criteria you give it we'll get into more
of a depth and detail those kind of
things in a little bit but for now again
we're just going for the very simple
tutorial just to get you started then
we're going to add on to it so we have
one appender but we're not done yet in
our log4net section the final piece me
to add is called route and in here we
need to tell log for nets
what appenders to use and then we also
can specify the overall level of logging
to do so let's start with our level of
logging
so level value equals now start a debug
what this is saying is that I want log
every message that's debug or higher now
there are a total of seven different
states for the logging levels of which
we can only actually write to five of
them the other two are just for our
config sections so here I'm specifying
the debug level
that is the the lowest level meaning
we're basically the log all of our
messages where I say if it's a debug log
it if it's info log it it was warned log
it it was an error log it and it's fail
go ahead and log it if I said instead of
debug I said error then I wouldn't log
the debug message the info message or
the warn messages I would only log error
and fatal messages so in this one
setting we can change how our system is
working think of this as a production
app typically we only want to log error
messages we need to know that the
application is crashing or throwing
errors that we're not expecting but say
we have a machine that's throwing errors
consistently we could come onto that
machine and while it's still running
change this log level from error all the
way down in debug then all those extra
messages that aren't being logged
normally will get picked up and put into
our logs this will make our logs much
larger but that's what you want when
you're trying to track down problem
once you're done tracking down a problem
you can go ahead and change this log
level back to error so this right here
is our first look at a filter that we're
getting to filters in more detail
especially when we're looking at
appenders and the idea of having a
Pender also have a filter level but for
now let's go ahead and change this back
to debug one thing I know is I've given
you five logging levels I've mentioned
five the debug info warned error and
fatal but I said there were a total of
seven the other two are all and off so
if I want to turn logging off entirely I
go ahead and change this to off now
nothing is logged or if I want to log
everything I could also say all all and
debug are very very similar in the fact
that both of them will log all messages
so for right now we have our overall
filter call a level and we've set it to
debug which would give us all the
messages from debug on up or basically
all messages the other thing we need to
do is we need to specify that we're
using the console appender
the reason we have a do
is because we could have extra appenders
in our config that were not currently
using so let's go ahead and specify the
console appender we just create we do
this by saying appender - ref and then
both space and ref equals console
appender close the tag pretty simple the
thing to note here is this console
appender gets its information from this
name right here remember I said that you
can name this anything you want but if
you do decide to change this name you
have to change this as well calling it
console appender makes it very easy to
understand that this appender is the
console appender without having to look
back to the appender and then looking at
the type alright so go ahead and save
your app config file if you look at now
if you're a first walk in with all of
this already done it can look a bit
intimidating but just remember this just
specifies that we have a log4net section
in our config file and go ahead and call
that this just specifies that we're
going to write to an appender or a
source to capture our log information
inside here we have a conversion pattern
this just says here's what the log
message should look like and finally we
specify that we need to call that
console appender and that the overall
filter level for our messages is debug
the config section isn't something that
I typically rekey from scratch every
time I copy and paste quite a bit for my
previous configs or from my log4net
article remember I said that I wrote
that for myself as well as for others I
use as my own reference guide because I
find easier to go to than keeping notes
somewhere else copying and pasting
config isn't a bad thing it's just
important that you know why things are
doing what they're doing that's one of
those pitfalls that I see a lot of
people do when they first start using
log4net
they look at the config section say oh
my goodness that's so confusing so I'm
gonna go ahead and copy a working config
section from someone else and then paste
it into my code
odhh cross my fingers and hope it works
that's not the wisest choice so that's
why I walked you through details step by
step of each piece of this configuration
I don't expect you to type this over and
over yourself but you really should
understand what each piece does and why
it does it that way when you decide hey
my application shouldn't be logging
anything below an error message you know
exactly where to go in this case right
here and exactly what they change it to
in this case error so that's step 2
remember we have 5 steps to implement
log4net
and step 2 is pry the biggest and most
tricky step of them all step 3 is to
come back to our program dot CS file and
we're going to add an assembly reference
so under this tasks entry in my using
statement I'm going to add a bit of code
assembly colon space log for net dot
config dot XML configurator watch equals
true so this can be a bit confusing but
basically what this is doing it's saying
I can go ahead and use the XML
configuration to configure log4net and I
want you to watch it what the watch does
is make sure that if it changes that it
updates the logging appropriately so if
we have a specify the XML configurator
that stands to reason that we could
configure log4net
and different way and that's true you
don't have to do all this app config you
can configure log4net
right inside your code without a config
file
I'm not going to demonstrating that
today because it's a little outside of
scope of what we're doing and it makes
things a little confusing especially for
the new user instead we're going to use
log4net
as it was designed using the XML
configuration in the app config so this
assembly statement neezy
in your application in one spot in one
spot only this just says I'm a configure
log4net to point to that app config we
don't need to do this multiple times so
if you're building a wind form
application or WPF application typically
what I would do
put this line where you're starting your
application so look for that static void
main somewhere wherever that is I put
this I'll set a namespace in that same
file again this is copy and paste code
it's not something you need to change
based on your application unless as an
edge case so that's step three step four
is we need to create inside of our class
program we need to create a log
reference and what this does is it
creates a new instance of the logging
system so let's go ahead and create
private static read-only log4net dot I
log alright so that's the type and now
we need to give it a name typically I
call it log and I say equals log for net
dot log manager that get logger now this
is going to ask you for the name of your
logger this is where people get really
confused and I say they get confused but
they may not actually even know that
they're confused the way log4net is
designed you create a logger for each
class that you're in you give it a name
based upon the class that you're in so
this case I might give it program CS is
my name that points to this specific
class that way later I can look at which
program was I in when I logged this
message it will point to program CS some
people get skittish about that they
don't want to open more than one log
instance it doesn't create a problem and
it is thread safe but if you really
wanted to open one log instance for your
entire application not recommended but
if you do what you can do is just give
it a generic name and then pass this
instance around to all of your different
pieces of your application so the most
basic thing to do is to give it a
generic name based upon where you're at
so in this case program CS now when I
change over to a new class I'd have to
give it the new classes name and if I
had more than one program dot C s say I
had one
in the test folder that I need to make
sure I included the path based upon
where it's at so say slash program CS
and then from the test folder I'd say
slash test slash program SES but that
means they're set up for each one of
your classes there is another way of
doing this and that is to use reflection
to figure out which class were in and
give that to the logger to do that we do
system dot reflection dot method base
dot get current method dot declaring
type it's long but what this does is it
says using reflection give me this now
if you've used reflection at all or if
you've read anything about reflection
you probably have objection right about
now it's the same one that I have my
first start and that objection is
reflection can be slow so if I'm doing
this a lot or if I'm doing this in a
resource intensive application this
could be a serious problem it can slow
my application down significantly enough
that it's a concern and there's a couple
responses to that first of all we're
doing this once per class so unless
we're spinning up classes at a very high
rate and by classes I mean classes that
actually use a logging library unless
we're spinning up these classes at a
very high rate that reflection is a very
very very tiny part of our application
in that case it's not going to be a big
deal second it makes our application
less likely to break in case of change
for example what if I aside halfway down
the road after I put logging in that I
want change they have programmed ICS to
be my app CS that would change the class
name but it wouldn't change a static
string right here where now this would
pick up that new class name and log it
as such it may sound an edge case and
really it is but it does make life
simple in the fact that I can just copy
and paste this exact line into every one
of my classes that I need logging but
there is a new feature in dotnet 4.6
then
that kind of meets the middle of both of
these methods I'm going to show you that
in a little bit once we get the login
working so let's get the login working
and then we'll come back and see how we
might go to be a little more efficient
but yet still be as simple as possible
okay so now we go ahead and save and now
I've done step four so the step one was
we need add that new get package step
two was we've modified all the
configuration step three we add this
assembly reference and step four is we
add this log property so that leaves us
with one step to go to finish out and
that step is to actually log something
so let's go down here and we're going to
say log that's this right here so if you
call it logger it be logger down here so
long dot and here's where we specify
what type of message we're logging so I
can say log dot error so here I'm saying
this message whatever it is this is my
error message this message is an error I
want to write to my appender in this
case the console appender so I'm going
to say console.writeline HelloWorld and
then I'm going to log an error to the
console that says this is my error
message let's see how this works we hit
run
I have hello world and then I have this
string right here I have my time I have
the thread that I'm on I have the type
of logged message in this case an error
and then I have this is my error message
note that if we look down here this is
my error message that's the actual
message that gets written out and the
restless' information is pulled from the
system itself if we go back and look at
that conversion pattern we see the date
we see the thread the log level the
message and then we didn't give it any
exception information so that's how you
use log4net to write to the console
pretty simple but from here we can move
on
to a more in-depth example
now that we have login working there's
one thing I want to go back and address
and that is this section right here
where it's the reflection remember I
said that we're going to look at
different way of doing this and this is
the one section that's the dotnet 4.6
specific okay so if you're using dotnet
4.5 our previous then you're not able to
use this method right use so if if
that's the case continue to use the
reflection or type out your own name
here but if your dotnet 4.6 or beyond
you go ahead and let's create a new
class now I call this log helper it's a
public class and I'm going to create a
new method called public static log4net
dot I log is what's got returned or I
call it get logger now here's the tricky
part
dotnet 4.6 has an attribute called
caller file path now in order to use
this we need to get a control dot and
add the using statement for system dot
run time dot compiler services it has
been called caller file path and then we
give it string file name D equals empty
string and so what this does is it's an
optional parameter and if we don't add
something to the file name then by
default the caller file path attribute
takes over and gives us the path to the
file that is calling this method now
that's the full path so keep that in
mind when you're storing its information
you're starting a full path to a file
that also means that if you have two
classes in one file you're going to the
same file path for both of them but if
you follow standard convention of having
one class per file then you'll be fine
all right in here we're going to return
log4net dot log manager dot get logger
then here for our name we're going to
pass in file name and that's it every
time we call this get logger method
we're going to instantiate a new
instance of the logger with this file
name of the file name from where this
method was called not where as methods
located so let's see us in action and
come back over here and right now I'm
still using the old reflection method of
getting my name but let's see where that
what that does first so we have a
baseline before we make a change go
ahead and hit run as you can see we
don't have any spot here is telling us
where that log message is coming from we
don't see a program dot CS anywhere in
here so we need to go ahead and change
our appender to make sure that we're
displaying where this information is
coming from so let's go ahead and close
this and change our Pender we come back
to our app config and go to as
conversion pattern right now I'm saying
that I want to see a date the thread
it's on the level meaning error info or
debug and the actual message I'm passing
in along with the new line and the
exception if there is one instead of
seeing this thread let's go ahead and
change this to be the logger the logger
is our log source or where the log is
coming from so if we run this program
again we should see the console UI dot
program okay so that's the namespace and
the class name for which this log
messages error was called now that we're
capturing that information and
displaying it let's go ahead and change
this to use our static class instead so
first let's comment this out
and next we're going to say long helper
dot get logger and that gray simplifies
the log call makes it much easier to
read and it makes it much easier to copy
and paste without fear note that this
does not allow us to stop the practice
of copying this once per class we still
need to have once per class in order to
get that logger name to be changed based
on where the log is called from let's go
ahead and run this again this time I see
something a bit different inside of our
square braces we have the full path to
our programs ES file what this is doing
is it's saying this is where the file
was when I was compiled so that's a bit
different from our namespace dot class
name that we had previous with the
console UI dot program but this can be
pretty helpful in the fact that it's
telling us which file to look at when
you are looking to debug so for those of
you running net 4.6 or above that's an
option instead of using the reflection
now that we have log for networking
we're gonna go back through and look at
each of our sections and expand it into
a more full featured section so for
example what we're going to do right now
is look at those appenders in the app
dot config we started with just one
appender it was the console appender
that's great for testing and this may
even be something you'd use in
production depending on your
circumstance but probably this is not
the only appender you want to use ever
so in this section we're going to expand
out what other appenders there are and
we're going to wrap this section up by
looking at the list on the apache
website that covers all the different
vendors that are available
the first appended we're going to add is
the file appender so name we'll give it
as file appender again that's something
you can name yourself but for
consistency sake I like to keep it
similar to or the same as the name that
log4net gets it so the name is when you
file appender
and they type is log for net dot pender
dot file appender inside here the first
thing you add is the tag called file
with a value of the name of our log file
now store this on c colon slash logs
slash my log file dot txt and we'll
close out that tag and then when I say
append to file the value equals true so
we don't want to overwrite this we want
to go ahead and append to the file each
time and then a locking model
type equals log4net
appender file appender plus minimal
block let me close that out so what this
tells us is that we want to make sure
that we can write this log file easily
especially from multiple different
locations without stepping on toes so
we're go ahead and try and lock this as
little as possible the final thing we
want to add right now is our layout type
and this is very very similar to this
right here in fact it's the same as up
here unless you want to change how the
layout looks in this case we don't
I want copy and paste so now the way the
log will actually print out in the text
file is the same as it will print out in
the command line we could get in to
change this conversion pattern and a
little further on this course we will
we'll talk about different layouts and
different ways to get information out of
the system but for right now we're just
going to use the same pattern since
we're not worrying too much about the
layout pattern yet we're just trying to
figure out how these different appenders
work the last thing I note here is we
could also add a filter in here to say
which type of log statements get written
to the text file but we're not going to
do that here we're going to talk about
filters a little bit later so we're just
going to say that everything gets logged
as long as it passes this check down
here where the level is set a debug
remember debug or anything higher gets
logged right now so I'll leave it like
that for right now so we have now
completed our first new appender the
file appender before you can see us in
action we need to come down to this roof
section and add this as appended to be
used so appender - ref ref equals file
appender
and you make sure you spell it right and
that should be it so let's go ahead and
test out this new appender I go ahead
and resize this note have my folder open
over here to my logs folder if we hit
start it opens up and my log file gets
created and we have a message on the
screen
if I hit enter forward to go away I
won't do that yet because I want to open
up this text file and just compare looks
very similar so I have the time I have
the location in this case the program
dot CS I have the type which is error
and this is my error message so they're
both the same ones just in a text file
of ones in a console now if I close this
out I start it over again I only have
one log message here because it's a new
console window but if it open up my log
file txt I have two messages so that's
one of the benefits of saving to a text
file so that's the file appender now
there's one flaw that you may notice
with this and that is that this file
will grow unlimited because the longer
you run this application the more it's
going to get appended to this text file
it's never cleaning itself out well this
next appended we're going to look at
will help us with that so let's just
this next appender and this we're going
to call rolling file appender
and the type is log4net appender that
rolling file appender
inside here we still get a file name so
file name equals C colon backslash logs
slash rolling file log dot txt Andres a
append to file value equals true we're
going to say they're rolling style the
value will be size so it's going to say
let's go a new file every time we hit
this size
maximum file size value equals ten
megabytes so once this file gets to ten
megabytes we close it out and start a
new one the next entry add here is our
max size roll backups in this value
aggress set to be five so what this does
is it says I want a maximum of five of
these up to 10 megabyte files so what
we're going to have here is once our
rolling file log txt hits the 10
megabyte mark and we're going to want to
write one more entry into it then the
system is going to rename this file
rolling file log txt dot one and create
a new rolling file log txt once that
rolling file log txt hits the 10
megabyte mark it's going to rename
rolling file log txt 1 to be rolling
file log txt 2 it's going to name the
currently full one to be rolling file
log txt 1 and it's going to create a new
rolling file log txt once it has five
extra files so we have archives dot 1 2
3 4 and 5 when the current rolling file
log txt which is always the latest
information when that one hits 10
megabytes it's going to drop dot 5 it's
going to kill the file and then make dot
4 dot 5 make dot 3 4 all the way down
the list and then it makes a new rolling
file log txt so your latest day is
always in the file you named it so
rolling file log txt the next newest
data is in the dot 1 and then all the
way down until dot 5 is the oldest data
you have stored so in this case we're
going to store 10 megabytes in each of
those files or I have 5 backup files so
once we have a full backup set once
we've exceeded our maximum storage
capacity we could have anywhere between
50 and 60 megabytes worth of data
as it stands right now next we're going
to say one more item the static log file
name value equals true omits just make
sure that the file name doesn't change
now last thing to do is we copy and
paste our layout because it's the same
and so that's once you get used to how
Pender's work really it's just copy and
paste and then we just modify that
things that are different for a specific
appender in this case the file name is
the same for both the rolling file
appender
and a file appender they both have a tag
called file name and they both have the
idea of appending to the file versus
overwriting the file there are some
variations based upon the type so it
gets a little more specific for the
rolling file appender than it does for
the file appender but basically these
appenders are about the same before we
go on and look at something a little bit
different a little bit outside the norm
for file appenders I want to go ahead
and make sure we see this in action ok
so let's go ahead and save we're on
resizes again and one last thing before
we forget we have to come down to the
root section and add this file appender
I'm Pender ref ref equals rolling file
appender all right we should be good to
go
let's save one more time now we hit run
and nothing seems to happen
this is the part of the episode I the
call fine Timmons mistake let's go back
and look at I couldn't fig something is
wrong hey you spied it yet for some of
you may you picked it up really quickly
for others it may have taken longer but
if you look here remember I said these
are similar this appender and this
appender have a lot of similarities
their layouts the same the file is the
same but look up here I said file value
equals and down here file name equals I
was talking while I was typing and it
came out as name instead of value let's
try this again
I hit run and now I have a rolling file
log dot txt let's close it out and look
at our file log it looks very very
similar to our
it's just now this one has just one
entry whereas this one has multiple all
right so that is the rolling file
appender pretty similar to the file
appender I would recommend however that
if you're going to log to a text file
that you use the rolling file appender
so you don't get burned with a server
that clogs up with a massive text file
even if you're fairly certain you're
gonna come back to that file and get rid
of it every once a while make sure it
stays small you really don't want to
have a file that can grow without end
so make a rolling file appender and
always just keep it deleting those
oldest files that way if you don't get
to something or if you get an error in a
loop and just keep spinning up issue
after issue and keeps logging the log
file you don't shut down your computer
or your server
this next appender can get a bit tedious
to type out so I'm go ahead and copy and
paste and I'm going to walk you through
what each thing does start out with the
appender the name equals a do net
appender and the type equals log for net
dot pender dot a do net pender alright
so in here I'm going to paste in my code
and that's a lot of code so let's go
back and look at what does the very
first thing well look at is the buffer
size the a do net appender writes to any
a do data source in this case we're
writing a sequel server so this right
here is one of those guaranteed things
that will trip you up if you copy and
paste someone else's config I have seen
a number of questions from people either
on Stack Overflow or code project or
else where we're saying my a do dotnet
appender does not work I've tried it I
tried the text layout and it works I
tried the rolling text it works and then
I come to a do and it nothing works it
always comes back to or almost always
comes back to this buffer size so what
this buffer size is it says instead of
writing at a query to sequel server
every time you have a log message I'm
going to wait until I build a buffer so
in this case after 10 log messages have
been written I'm going to write all 10
of those to sequel server and that just
keeps the traffic down a sequel server
like
Aker here is by default whenever you see
a demonstration online or even at the
log4net site the default will be 100 so
you have to write a hundred log messages
before any of them show up in your
sequel server now when you do close out
your application those are supposed to
be written to sequel server so if you're
watching this applications open you may
not see anything but when you close it
you may see those 10 20 to 30 log
messages written to sequel server at
that time my recommendation for demo
purposes is that you set this to 1 that
way every time a log message gets
written to the server you see it in high
logging times it may put an extra strain
your sequel server but nothing that it's
not able to handle the production value
should probably be much higher than this
but where really depends on your
scenario for instance if you rely on
up-to-the-minute reporting on your
errors and logs then you really should
have this as low as possible maybe even
1 because if a system does not write a
log message very often and you have a
set at a hundred it may be hours or even
days before that buffer gets filled up
waiting days to find out that you have
an issue is not ideal so for
demonstration I'll keep this at 1 the
next thing is our connection type and
this says hey we're going to use a
sequel server connection and feel free
to copy and paste this this is a whole
bunch of stuff that no one memorizes
next we have our connection string and
this just says how do I connect to the
database in this case I'm connecting to
the local database or dot the catalog
I'm using is my my database itself and
that's application DB and then I'm using
the integrated security which means it's
going to use my login as the security
for my sequel server next is the command
text this is the actual query to run in
this case let's get down to here the
command type is text that means I'm
wearing a raw sequel statement in this
case on the insert statement so I'm
saying insert into the table logs here's
the columns to use and then here's the
values to put in them now there is an
alternate that's much easier to do in
this file and it's also in my opinion a
better practice and that is to use a
stored procedure so instead of these two
lines I'll leave them here for now to
show you a difference but you would put
the command Tex
the value would be the store procedure
name and that's it and then the command
type the value equals stored procedure
so you wouldn't put both of these in
here this one and this one you choose
one so either you have it like that or
you have it like that personally I like
this method better because it's so
concise I don't need to type all this
out I can also do things with store
procedures such as having extra it
statements around my insert statement or
making an up search statement so that if
it's already a statement there that
matches this which there shouldn't be
but if there is we could do an update
instead of an insert there's a number of
things we can do in a stored procedure
besides just the actual insert but how
you use it is up to you so choose your
stored procedure or the actual command
text let's go ahead and take this out
both work the same way so I don't feel
like I need to demonstrate both they do
both work I guess before I get rid of it
though I'm going to show you one more
thing and that is the parameters right
here these match up to these parameters
down here now in the store procedure it
takes parameters and they're named just
like this but we don't need to specify
them because they are specified for us
but for the insert statement where it's
just text I have to specify each of the
parameters so that is one thing to note
is that we have to actually specify the
parameters that are getting passed in
and where they're getting passed in all
right let's take us back out so we have
a number of parameters down here let's
go through them one by one
the first parameter is the app log
underscore date so we can specify the
parameter name the DB type in this case
it's a date/time type now this is a
c-sharp type not a sequel type so no
that's date time not date time too which
is what I actually store it in in the
database next is the layout this looks
very familiar if you're looking up here
looks very familiar this only instead of
doing the pattern leh
I am doing the raw timestamp layout so
it's giving a timestamp for this log
entry and so instead of specifying the
conversion pattern like I am up here it
just knows okay you're asking for the
timestamp I'll give that to you so that
is a bit of a deviation from what we're
doing up here we could do that so we
could take this out instead put a layout
that uses the percent date and call it
absolute but this allows it to deviate a
little bit and show how it look a little
bit different our next parameter is the
app log underscore thread and this is of
type ANSI string now ANSI string
identifies varchar' if you're familiar
with sequel there's two type of string
fields you can storing there are two
major types the first type is varchar'
and the next is n VAR char bar chart is
a variable length string whereas n VAR
char is still a variable length string
but it can store unicode characters in
this case I've said I don't think I need
to store unicode characters in my
database therefore I'm going to use
varchar' fields and so we have to pass
in an c string as the type if we were
storing n VAR char instead of anti
string we would just do string so that's
the difference the size is the size in
our database so in this case I have 50
characters and then this should look
familiar the layout pattern just like up
here the layout pattern can be very
complex but this is the layout pattern
for one field I'm storing each field in
a separate column therefore it's very
very simple
here I'm just storing the thread so we
come down here to the next item we have
log level it's an ANSI string as well
again it's 50 characters and this just
stores the level and that's our debug
error warned fatal or info the next one
log source that's the location where the
log originated and so I made that 300
characters long and the pattern is just
that percent logger next we have the
actual message this is what we send when
we call log and it's still anti string
and it's 4,000 characters pretty large
but you make sure that's going to fit
you could do a var charm axe which is
much larger if you want
but in this case I say you know what
four thousand characters is plenty so
that's what I'll choose and finally down
here we have the exception again anti
string again four thousand characters
and a layout type instead of being one
of these items I'm saying give me the
exception layout so these are the fields
that I'm inserting into my store
procedure note that we don't have to put
just one item into any one field and we
don't have to use it just once so you
could get creative in here where maybe
you write each item to its own column
but then at the end have a column that
is the printed log or what you would see
in a text file or something like that
where it's the combined file what you
write the database is totally up to you
you just need to make sure that your
insert statement or your store procedure
will take that information and so
speaking of store procedures let's go
ahead and look at our store procedure
first here's my table this is the logs
table it's in the application dB
and I have my ID the log date the thread
the level the source the message and the
exception that's all I did
note the varchar' size is match up with
what we have in our web config file next
I created a store procedure that takes
those same names and it inserts them and
there's my insert statement does nothing
different than what we originally had
with the insert statement for the
command text but now I have it wrapped
in a stored procedure finally if you
come over here to this window I had a
select star from logs and if I run this
I see that I have no entries so far
let's go ahead and change that we'll
come back over here when you come down
here to our root section and add this
appender
a deonette fender and let's just
double-check that to make sure it's
right a deonette appender so we should
be good let's run this I have a message
on the screen if I come back over here
to sequel server I run this again I now
have one entry for my log date there's a
date and time there's a thread number
there's the log level there's a source
that came from and there's the message
and we don't have an exception so in
just a few moments we were able to use
this pattern to write to a sequel
database now we're starting to get into
things that can be more useful in a
production environment now we have data
writing a sequel server let's look at
other options for writing our data if we
go back to the log4net site it's logging
Apache org slash log4net and we come
down here to the SDK reference there's
just log4net dot append err and if you
know every time we have created a pender
it's always been logged for net pender
dot something so let's go ahead and open
that up and as a whole list of things in
here and if we look down here we have
the file appender class and this will
tell you all about the file appender
it's not great but it is something and
does give some clues as what to do it
also gives you an idea that you can do a
file appender which we already knew but
there are other appenders in here you
might not have known about for example
the ansi color terminal appender i've
never used that there's also the
buffering appender skeleton is buffering
forwarding appender maybe not useful for
you in your case but there's others in
here that might be for example there's
the event log appender this writes to
the Windows Event log it's something
that sounds great but I would recommend
against trying to use in too many
situations there are situations where
it's right but the most part it's not
great and the reason I say that because
you have
to have special permissions for the user
that's running this application so if
this is a web application typically
you're running under the asp.net account
if you're running under that account you
either have to change the permissions
for that account which I don't recommend
in order to give it more rights or you
have to write to the event log once
using an administrator account in order
then kind of allow that to be written
from then on using the asp.net account
it's a little clunky but it does have
its purposes another one that has its
purposes that may be a little clunky for
you but it may be perfect for somebody
else is the SMTP appender this will
allow you to send emails out whenever
you have a log file written my advice
here is to make sure that you're only
sending emails out when you absolutely
need to don't send emails out saying yes
I got to this piece of code especially
if it's in a loop and especially if
you're saying that to your boss this is
just one more way that you can do
something with technology that you
probably shouldn't so I would encourage
you to look through here look for the
different appenders find ones that maybe
you want to use or that fit your certain
scenario where you think they might and
then go find the examples of how to use
them and there are examples in here if
we come down to config examples we can
scroll down and find there's the MS
sequel server example there's an access
example both using the a deonette
appender in this case the access one
versus the generic one for the sequel
server there's Oracle Oracle and it's a
whole bunch more in here and you can go
through and not only see a is an asp net
trace offender but also how to use it if
we come back up to the sequel server one
you'll note that the buffer size is set
to 100 so just make sure that you take
whatever information you get in here
with a grain of salt it may be a valid
setting but it may not be the setting
that's right for you and so that wraps
up our section on appenders
we've gone through and identified each
of the major types
appenders and also where to find out
more information about other edge case
offenders next I want to look at filters
if we come down here to the bottom we
have this one filter that says only give
me items from debug and above but there
are more options we can add to our
Pender's to limit what information they
get so let's get to that now
before we get into setting up our
filters I want to do a little bit of
housecleaning first let's go ahead and
collapse all of our appender suite have
a better looking file here I'm going to
leave the console appender open and
we're just going to use the console
appender for now so let's go ahead and
comment out these other three appenders
from being used note I'm just commenting
them out from the root section I don't
need to actually change the appenders
themselves if an appender isn't
mentioned in this roof section then it
won't be called so now I have just the
console appender here and I have just a
console appender up here let's come back
to the program CS and let's make a few
changes here in order to have more log
statements first I'm going to delete the
ones we have and then let's start
creating new ones say log dot debug
that's the lowest level message so for
this we're going to say developer colon
tutorial was run next let's do log dot
info this is the next level up it will
say maintenance water-pump turned on
next log dot warm one says this remains
as well and we'll say the water pump is
getting hot now for the log dot error
which the next level up let's actually
create an error let's start with VAR I
equals zero I'll do a try and we'll make
this a / 0 exception
and here if we throw a divide by zero
we're going to do a log dot error and
just happy air it can be logged on in
file log to debug if you want it just
makes sense logically usually if you're
throwing an error if you've had an air
thrown on you that you call it an error
in your log statements but again it's up
to you if you want to say it's only for
debug or this error message isn't a bad
one that's fine in this case we'll just
call it log error I'm gonna give a
message okay so it's my message and then
here actually include the exception so
this is one of those things that I told
you about but you haven't seen yet it me
that's the idea that we can pass the
exception along as well back over here
our app config we have this new line and
then the exception and so far that's
been blank but now we're actually going
to use it so that's our exception but
let's go ahead and create that exception
by saying var x equals 10 divided by I
and since I is zero we're going to throw
that exception last and highest on the
log scale is the log fatal
the rest of the water pump exploded okay
so now I have five log messages in
increasing order of severity
so from debug the lowest to info then
warn then error then fatal first let's
make sure they all run all right I have
a bit of a mess here and the reason why
is because I'm logging out this very
very long path to my program dot CS so
let's change that let's get back the
reflection method let's run this again
and now it's a lot better it's a little
shorter in fact we can trim this message
down even more so let's go ahead and go
back to our app config and say you know
what we're going to adjust this
conversion pattern to only give us the
level and the message where you get into
conversion patterns more in the layout
pattern in a little bit but for now we
can just trim out this message and make
it a little simpler
let's run this again and now we have a
little better system we have debug info
warned error and then underneath the air
we actually have the exception and we
have a fail so since you haven't seen
exception before let's look at it we
have the error line that says developer
we try to divide by zero again we have a
new line and now we have a exception
message
the exception is system dot divided by
zero exception attempted to divide by
zero and then it gives the where it was
at line 25 in the program CS so that can
be really great debugging information
for when you have an issue since we just
want the actual information on the
screen though let's go ahead and take
out the exception we know it can do it
we don't have to do it let's run this
again and now we have a very clean
screen that has just five things on it
and in the order from debug through
fatal that's a great setup for teaching
us how to filter out different items
there's a number of different ways we
can filter an appender we're going to
touch on the
most popular the most used and then
there are some extra ones we can go look
at later on the documentation so let's
start by Korean section called filter
the first filter gonna do is the level
range filter so type equals log for net
dot filter dot level range filter and
this has two entries in it first we have
the level min I'll leave this blank for
now and then we have the level max I'll
leave it blank as well for now so level
min and a level Max are the brackets
around which you want to capture your
log entries remember that debug is the
lowest and fatal is the highest so if we
only want to capture warn and error
messages below the min will be warned
and the max would be error what this
says is it has to be at least a warned
level and it can't be any higher than an
error message which means that we're not
going to capture the debugger info and
we're not going to capture the fatal
let's run this and see how it works and
there you go we have warned and we have
error but that's it the rest of them
don't get logged to this console and
since right now the console is the only
appender that's actually logging they
didn't get logged at all at first that
makes selling a bad thing that you're
logging messages that don't actually get
captured anywhere but think that one
through for a minute if you put a bunch
of statements in your code that are log
dot debug and they're only for debugging
your application you don't want those
debug messages store anywhere most
likely unless you have a problem then
you come in here and adjust your filter
to say yes give me debug messages so we
can adjust as a GIF you want if you want
to include up through fatal
because change the max2 fatal and now we
have three statements war an error and
fatal so that's the level range filter
this is one of the few filters that if
it does not fall within its boundaries
the log message does not get written I'm
going go ahead and comment this out and
create a new filter that way you can see
how each filter works in my code let's
create a new one and this one is going
to be filter type equals log for net dot
filter that string match filter so what
it's going to do is going to match the
string pattern inside of our log message
so string to match value equals and
let's say a that has maintenance so now
only maintenance messages will get
logged right well let's run this and
find out and we have a lot more than
just maintenance messages if we look
through those messages we see no
reference to maintenance in either the
error or the debug message and yet all
five are showing up why is that well
remember with the range I said this is
one of the only ones that if the message
falls outside of that range it does not
log it in this case it matched
maintenance on three of those entries
but for the other two it didn't match
and it fell through to the next filter
since there are no more filters it
assumed we want to log it it seems
counterintuitive because it feels like
we would want to not include something
if it didn't match our filter but the
reason we do this is because you can
have more than one set of filter
inside of an appender but if you want to
just match on this filter you have to
create one more filter at the end this
is a type log4net that filter that deny
all filter there's nothing inside this
is the if you get here you're done don't
log it so now it's going to match the
maintenance string and if it doesn't
find it it's going to drop down to the
next filter the next filter says don't
log it let's try this again okay now we
only have three statements and all three
are maintenance statements this should
also tell you something important about
the filters order is important it
matches against the first filter if it
doesn't match it will typically drop
down to the next filter the exception
being the level range filter if it
doesn't match here it's done so that
means if I move this filter the denial
filter above the string matched filter
and I run it again I get nothing that's
because the first filter to match was
this deny all filter so let's move it
back down to the bottom the next filter
we want to look at let's go ahead and
comment this one out the next filter is
a type log4net that filter dot level
match filter this seems very similar to
the level range filter except it's
matching on a level so let's say level
to match value equals error this is only
going to grab the error level but it
does fall through just like a string
match filter which means that we have to
continue to have this an eye all at the
bottom
let's see this in action all right there
is just the error message but let's get
a little more tricky and create another
level match filter a copy and paste this
and say I only want debug messages so
now I have both error and debug remember
these fall through so if it's not an
error it falls down the next one and
says are you debug let's run this again
and now I have two statements the debug
statement and the error statement there
might be times when you want to capture
two of the five and they aren't right
next to each other so all debug messages
but all fatal messages as well so as you
can see there are many different ways we
can configure our filters to pull out
exactly what you want from any situation
next we're going to look at the log
patterns the information we actually
write out to the database with a text
file of the screen we'll look at the
different pieces of information we can
pull from a system and any drawbacks
that may be associated with gathering
bat information
now let's dive in that logging pattern
the string that gets printed out on the
screen or gets stored in the text file
right now we have just the level and the
message and then a new line an exception
in our conversion pattern or that
logging pattern let's go ahead and clean
up a couple things in here first before
we make some modifications to this first
let's go ahead and comment out all of
these in fact let's go ahead and remove
them we don't need them anymore so since
I've removed all of my filters
everything will get printed out now note
you still have this down here that says
debug and higher if I change this to
error it would only print out error and
higher even though I don't have a filter
up here just to demonstrate right now if
I run this I have all five messages my
debug info warned error and fatal but if
I change this to say error I write again
I only see the error and fatal message
for our purposes let's go ahead and
change it one level higher to say fatal
now we're only capturing one message
just that fatal message saying the water
pump is exploded that's good enough for
our testing purposes because what we're
going to concentrate on is this
conversion pattern now you've already
seen the standard pattern so for example
the date the logger the level the
message the newline and the exception
these are pretty standard entries and is
a few more standard ones for example we
had at one point the thread but there's
a few extras we can add I'm going to use
the new line after each entry so we know
what we're looking at first let's leave
a level here will just say level and
then put a new line at the end of it
next we're going to say message and
leave a new line at the end of that and
we're going to take out exception that
gets us a start if we run that we now
see levels fatal and message is
maintenance water pump explode now we do
have an extra space there let's take
that out if we run this again we should
see one per line laid out nice so let's
add a few extra things one line per time
so we know what we're looking at the
next one is the UTC date
let's put UTC date and we'll do absolute
for that as well this is just like the
date only it's in it's the UTC date so
let's go ahead and compare this let's
put a new line and then put the date %
date and make that absolute as well okay
so we have the UTC date and the regular
date let's go ahead and run this now for
comparison so we have the level message
which we recovered the UTC date is oh
five thirty nine forty three the date is
oh one thirty nine forty three so I'm
four hours off of UTC time next let's
add the timestamp
and this one can be a bit confusing for
people they're not quite sure what what
information is giving them in this case
149 let's run it again and now it's 79
so what is that well whoops I input the
newline let's go ahead and put that in
there first before we start talking
about it let's once again and that's 110
so what is that timestamp well a
timestamp is the number of milliseconds
since the application started there's
situations where that can be very useful
now is when we get into the deeper
waters the things that aren't as
straightforward or aren't as efficient
these things so far fairly efficient
when it comes to writing to the log cut
had a new line and we're going to add
two new pieces of information first one
is the identity and this is going to
pull from the principal name property
and the second one is the user name and
that user name poles from the windows
identity property so these two right
here can be a bit slow and they can also
sometimes give you non information or be
empty let's go ahead and run this as you
can see the identity for mine is blank
and yet the user name is office tower /
Tim which that's my login name so
depending your environment this may be
great information or it may be non
information so just be aware that it
might not always show up the way you're
expecting it to this is doubly true when
you're talking about a web server
remember that this application runs
typically under the asp net account in
that case the username will probably be
the
a asp net username not the name of the
user logged in next there are a few
entries that can pinpoint where in the
code we have the problem first let's
look at the location and this is the
location in the code where there's a
problem now in order for the system know
this you have to have the debug
information it works a lot better than
debugging that does in the production
environment after that we can pull just
the line number same thing here as far
as working better and debug than it does
in production and finally we want to
pull the method name again same as
claimer so in this case since I'm
running in debug mode in Visual Studio
it knows that I'm running from program
CS it knows that on line 32 and the
method is the main method
these last three can be very very useful
when you're debugging just be very clear
that this is going to work great in
debug on your machine but when you get
into production you may find non data
here you may find it empty you may find
information that doesn't quite make
sense because it doesn't have the
reference to pull from the right
locations so that's a brief overview of
the more advanced items you can log
besides the ones we've already covered
but we're not quite done yet we also
have the option to pad or shrink down
our information remember when we're
adding information to the database we
said that a log message shouldn't be
more than 4,000 characters or that
exception information shouldn't be more
than 4,000 characters well what would
happen if we had more than 4,000
characters that would be a problem
trying to put that into the database
well log fernette has an option for that
if we come back here let's choose the
message itself and let's say the message
should only be 5 characters long
now that's obviously not a real-world
scenario but that will give us an
obvious delimiter we say dot 5 that dot
5 indicates that the message at most 3 5
characters if it's more than that
it's going to start trimming off from
the left let's see it's an action so my
message is Elodie Edie okay that's the
part of the word for exploded the reason
its LOD II D and not m AI and T which is
the beginning of the message that's
because we capture the end of the
message everything else is trimmed off
so if you go over your 5 character limit
in this case the first part of the
message gets deleted that isn't
something you can change with a setting
so that's one of those things that could
be done a little better and log4net I
would like it where you would add the
first part of the message and then trim
off the end but that's something you
could do in code or you can make a
interface for your log message that goes
ahead and trims off the end of it it's
definitely doable it's just not
something that's built in to be done
with log4net okay there's a couple more
options we can do here we can put
numbers before this dot and this would
be the minimum number of characters so
if I put in here a minimum of two
characters and a maximum of five
characters what this is going to do is
it's going to trim off anything one in
five characters but if it's less than
five characters say it's one character
it's going to add a space and that space
is going to go at the left-hand side of
your message so if I had just an H in
this field it's going to now be space H
because I have that two there if I had
hello exclamation point because it's six
characters it would say hello e ll o
exclamation point so those two can work
in conjunction with the spacing if I
instead put a negative sign in front
that's going to put the spacing at the
end so again my example of just an H in
that message it would be H space instead
of space H so if you're doing a space
delimited text file you could make sure
that your minimum and maximum x' are the
same and then anything less gets spaces
anything more gets cut off and that's
all there really is to logging
information out to our file in a layout
that we like that's the conversion
pattern now that we have a handle on all
the information that log4net provides
for us and these log messages let's take
a look at how we can bring in our own
information when we talk about the
advanced features of log Fernet
sometimes when your
information log4net you just want a
little bit of extra information you
could bring in the message but maybe you
want a different field or maybe you're
using that a deonette appender where you
want to put it in a different column if
that's the case there is a way you can
bring that information in let's start by
cleaning up our conversion pattern here
let's just do the message itself let's
see that looks ok so we just have
maintenance water pump exploded that's
fine for now let's go over to our
program and we have these five messages
only this one's getting pulled because
it's a fatal message and that's the only
ones that we're pulling in using this
log level so let's create a loop down
here in here I'm going to do a for loop
I'm gonna say one two less than five
which means zero one two three and four
so it's five total messages and we're
going to say long dot fatal this is
message number and I add the I at the
end and actually we're going to change
that from I to something different
because we're already using I up here or
we can just take away the int
declaration since I already is an int
okay so we have I equals zero is less
than 5 let's log use 5 messages we can
go ahead and comment this out so now we
should have five fatal messages let's
say this is message number and then 0 1
2 3 &amp;amp; 4
let's run less and find out okay so we
have this is message number 0 1 2 3 &amp;amp; 4
well maybe we don't want to have that in
a message itself maybe we want to say
something a little more generic like
this is this is a fatal
error in the process and maybe we want
to capture that that I information
somewhere else the way to do this is to
use the properties of log for net if we
come here and say log for net dot global
context and there are multiple contexts
there's the global context and there's a
thread context and you can go through a
list here and see all the different
contexts the logical thread context
these are all scopes so the tighter the
scope the more likely is to be captured
so for example if I have something a
property name in both the global scope
and in the logical thread scope then the
logical thread scopes variable is going
to overwrite what's in the global scope
that can get really complicated don't
worry about it if you don't know which
scope you want use a global scope that
will work across the entire application
the smaller ones are for specific
threads typically so let's do global
context dot properties and now we can
specify our own property let's call this
property the counter property and we're
going to say this equals the current
value of I now we can put any kind of
string information into this property we
can also put other types of data in here
and we'll get to that in a minute but
for right now we're going to store I and
that's it
we don't actually change our log message
because we have now create a new
variable we can pull in in this
conversion pattern so let's go ahead and
pull that in so instead of having in the
message I'm going to say the number -
the message so let's start with our
percent sign and then we save property
and then I give it the name in our cases
counter and make sure those curly braces
so we have percent property curly braces
the name of your property the one you
called it
and now let's put my - here and let's
run this so now I have 0 1 2 3 &amp;amp; 4
within the - and then the message a
doesn't seem like a big difference
because I could have put that in the
message itself but the difference is I
now have this as a separate property I
can pull in different way so if I have
my a do net appender I can put that in
different field now what I've done here
is I've just passed the value of I in
and in an IDOT - string and got the
information and stored it as text but
there is a way to have a dynamic
property so let's set that up I go over
here and create a new class and I call
this class the counter class I'll make
it public add one property to it make an
INT property I'll call this loop counter
so this is going to store the
information on that loop so my 0 1 2 3 4
you'll store it all in this number here
and then last my do a public override
string to string and instead of
returning the base to string I'm going
to say that I want the loop counter that
to string so whenever you call this
class and say dot - string on a class
instance instead of returning the class
name which is standard for a class
instance it's going to return the string
value of the loop counter into variable
so we can save that and now we write
come back over here to our program CS
and I declare a new variable o counter
recall this hour I let's call it J since
we already have an i J equals new
counter next I'm going to move out this
global context out of my loop now pasted
up here when it was in my loop it
reassigned this property every time I
went through now I'm going to sign it
once so instead of assigning it this
I've area bewitch is just an int I'm
going to cyan't j j is the instance of
my counter class now whenever j changes
the two string value which remember to
string is actually just that loop
counter whenever it changes it's going
to change the property and log4net so
down here i'm going to make things a
little messy don't do it in production
JW counter equals zero and then J dot
loop counter is less than five and then
J dot loop counter plus plus so I
replaced that I variable with the
property loop counter using my instance
called J so that's all I've done and
I've moved this outside of my loop so it
only gets assigned once
let's run us again and there we go it
looks like nothing has changed except an
only assign that property once it picked
up the changes using that two string
method so this isn't great right as it
is this is definitely a test just to
show off what it can do but what this
demonstrates is that you could create
some sort of property or some sort of
class instance that captured information
or sent information to log for net based
upon certain circumstances in your
application then you just need to set at
once in that global context and in your
configuration you can pull that property
over and over and over again and we'll
always get the latest information it's a
little more advanced it's not something
using every application but when you
want it it can be a great
help so they are a couple ways you can
get the most out of your log4net using
some advanced logging techniques now
let's review what we've learned and see
where we go from here
so that's the basics and the more
advanced topics of log4net
really once you break it down it's quite
simple we started off with those five
steps to get logged for networking first
adding our reference using nougat to the
log4net application next we went into
our program CS and add this entry right
here which is once per application then
we add this statement right here which
happens once per class or once per time
you want to instantiate it you don't
have to do it once per class if you
don't want to and then we moved on to
creating this config section so we
created this section right here that
says hey I'm creating a log4net section
and then in that log4net section we add
our appenders some with filters some
with different conversion patterns then
we came down here and add our route
section which points out which appenders
are working and then what the overall
filtering level is finally we created
these log statements that log
information to log4net
as long as it accepts them to wrap up we
create some advanced data to log to our
log4net instance we create a dynamic
property using our class instance that
allow us to in our can fix it pull the
information dynamically based upon the
point in time at which was called so
that's log4net
very very simple at the end of day you
just want to create these log statements
you pepper these throughout your
application where you need them at the
level you need them since you know how
to filter and how to limit which log
statements get logged to your log
appender source whether it be the text
file or the database or even the console
window you can mix and match and play
with these things for example you may
have a console window that you don't
care if it Scrolls like crazy and so you
send all of your data to it where you
have your sequel database that you might
want to protect a little more and you
only write warnings and above
and find that text file which might be a
backup for your sequel server but you
only want to write the exception data
the errors and the fatal entries and you
may say you know what I'm going to get a
rolling file because it's just a backup
and I want to only keep a hundred
megabytes worth of files across ten
files based on what we've learned in
this course that's definitely possible
it's possible using examples we've
already done just to recap this video is
a companion piece of the article I wrote
on the log4net tutorial so all the
information that we've gone over in here
in this video can be found in some
format in this article so if you want
the written copy of it go ahead and go
here if you want more information from a
source you can go to the Apache log4net
site and get the SDK reference or the
how to's or even config examples for the
appender that you want that's really all
there is for log4net
I encourage you to play around try
things out build a demo out and then
once you have your config file the way
you want it go ahead and convert that
into production use these statements
whenever you want to capture information
inside your running application down the
description you will see links to all
these different sites you will also see
a link to the github repository where
all of the code that I went through in
this course is stored if you look you
will see that the code has been tagged
at various levels for each of the
different sections in this video so you
can dial the code back to where it was
at that specific section also if you
like this video if you want to find out
more information on other videos that
I'm providing both here on YouTube and
other places as well go ahead and sign
up for my newsletter
I don't spam I don't sell a lot of
emails out but when I do I tell you
about the new and upcoming courses that
I'm creating and I also ask for your
feedback I love hearing from you what
you're looking for your feedback shapes
these courses so please let me know what
you'd like to see next
Thanks enjoy using log4net without being
afraid of that config file</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>