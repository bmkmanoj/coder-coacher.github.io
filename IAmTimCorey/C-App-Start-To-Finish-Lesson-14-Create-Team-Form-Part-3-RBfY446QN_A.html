<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>C# App Start To Finish Lesson 14 - Create Team Form Part 3 | Coder Coacher - Coaching Coders</title><meta content="C# App Start To Finish Lesson 14 - Create Team Form Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/IAmTimCorey/">IAmTimCorey</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>C# App Start To Finish Lesson 14 - Create Team Form Part 3</b></h2><h5 class="post__date">2017-07-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RBfY446QN_A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to lesson 14 in the c-sharp from
start to Spanish course my name is Tim
quarry and today we're going to finish
working on the create team form so far
we've wired everything on the create
team up except for the button that
actually creates the team so in this
video we're going to change that let's
get started before you get started in
the lesson
I remind you that if you'd like to get
all of these lessons right away plus all
these other bonuses click the link below
in the description to purchase this
course for just $67 and when you're
considering that don't forget to hit the
thumbs up in this video I'd really
appreciate it ok so let's get back to
the lesson now we have to figure out
first what this button should do we have
a team name we have the people on the
team sometimes I find it helpful to go
back to the database where you've
designed things out and see where this
is going to live so you can kind of help
see what ideas were when you built this
thing out so we have here teams let's
design this it has just really two
things an ID and a team name
they have team members and that has the
row ID the team ID and the person ID
that's it so we have two tables to fill
in first one has teams and the second
one is team members and that order is
important because in this one we create
a record we'll get this ID back we'll
use that ID right here when we also add
each person so in a two-step process the
first thing you do is create our store
procedures we have the team get by
tournament but we don't have any inserts
for the team or the team members so
let's create those new store procedure
delete out all of this again I would
leave this and actually throw it in if
you're actually creating these two
procedures and the format is SP teams
insert now what do you know for creating
a team well we need the at team name and
if we look at the teams here the columns
we can see team name is an n varchar'
100 so Ethel's coming in but they're
going to have this at id int equal zero
output and that'll be the ID going other
direction will leave the no count in but
take out the comments and we're going to
say insert into CBO teams team name
values at team name then select at id
equals scope identity and that's it so
we have our team name being passed in
and they're pulling back that ID as an
output and that's we capture here just
as before so you run this and while
we're here let's also create the team
members insert so expand this out and
create a new store procedure the
temptation here is a copy this and just
modify it what we need but I recommend
against that because again just like
copying and code and c-sharp the
likelihood that you miss one little spot
and cause a problem is pretty high
DDO 2sp team members underscore insert
and here we have at team ID int adds
person ID int and add ID int equals zero
output take out the comments we're going
to say inserts into DB Oh dad's team
members team ID person ID values at team
ID at person ID and then again select at
ID equals schoo by daddy and we're good
to go
so run that make sure it runs we will
refresh down here just to make sure
those two do pop up in the list so there
is the team members in search and
there's the team's insert so both of
those are working or at least they
should let's come back over to here and
double click on this button to create
the event so now we have the event and
what should we do here and the decision
here is do we call two different methods
or do we call one method and have it do
both jobs so we have two different
things going on we have a team name
being sent an idea get pass gets passed
back then we send the list of ID's from
here and also the ID from the team and
then we have our team members list
so is that two actions or one now we
have the idea of the single
responsibility principle from the solid
acronym and the idea there is that each
method does one thing but the question
is is this one thing or two now I'm
going to argue this is one transaction
you can decide note I wanted two
different ones but here's why to argue
it's one transaction because you're
creating the entire team both the name
and the members are one set of data they
go to different tables and it'll be two
different insert statements but it's one
set therefore I like the idea of doing
them together so we don't do half the
job and then fail and not do the other
half so let's start at the I data
connector or connection and we have here
our create prize create person and now
we need some type of create team and if
we look at our team model we see we have
a list of person model and then team
name so that's perfect
so we're going to say let's put up here
it doesn't matter where you put in a
list team model would turn the whole
model all over again creates team team
model model so I pass in a team model
justly do it with prize hood person it's
a little more complex and we're going to
get back a team model we've got passed
back in that ID but if you notice over
here there is no ID so let's add that
and also that's ordering is bugging me
I'm not sure why I ordered it that way I
switch those around so if team names
above the members
all right so just like with prize model
we have the ID with team member we have
the ID which also makes me think do we
have ID in person model and I believe we
do let's just check yes we do so you
have all the ideas we need be passing
back and forth so now we have a create
team part of the contract our I did a
connection contract our interface and so
now each of these two connectors Segal
connector connector and the text
connector they both need to implement
that interface so let's do that
going up both and make sure that they
both implement control dot and enter as
creates our public method with the throw
new not implemented exception that's
fine we'll come back to Texas a minute
let's start sequel so here we have our
sequel where it says okay you want to
create team great go for it so let's
start with a using in fact we can copy
and paste this using pivot because it's
really the same thing whoops let's not
copy a a query let's copy and execute
instead because it has the way we're
going to do executions let's copy this
and paste it right here so we're
actually going to do two different
inserts the first one takes in the team
name I mean only other thing it takes in
is actually output and that's the ID so
team name where I say model dot team
name
since you copy and paste it we'd be very
careful to check everything so let's go
in through make sure we have our
databases correct it is then we have our
team name our ID
it's an output we come down here this is
not correct and come back over here to
our sequel and I copy that and paste in
right there so you have the correct
value or correct name for our store
procedure we do have a mild ID and that
is the team ID so that's perfect but
before we turn the model we have to do
some more work what we need to do is we
need to insert every one of those people
into our table we come back over here to
our sequel and look we take in one
person so this team members table is
going to have a number of rows per team
one for every team member and doing that
is fairly simple we just need to do a
loop in this case of for each for each
person model P in model dot t members so
we'll loop through this but we already
have P we'll say two TM for team member
alright so for each one of these we have
to do a new insert let's copy this paste
it in there
alright so instead of SP teams its team
members inserts so we'll change that
store procedure
and this is a tricky but here we are you
happy but it's a dynamic parameters
which you want to use therefore we can
just change it to not say var in front
of it and now we're going to overwrite
that P every time which is great it's
what you want now let's grab our
parameters so you have team ID and
person ID so at team ID and that's model
dot ID and it's same for each one of
them we're not actually going to need to
grab the ID coming back out because we
don't need it in any way so ignore that
instead do the at person ID equals and
it's not model because per person miles
we would run say t m dot ID emission are
you filled in because these people are
already in our database and so we have
IDs for all of them even if we add a new
person we first get the ID back after
saving them and then put them in our
list so we all we always have IDs for
all of our people they're adding to a
team so that's all there should be for
the create team portion for sequel so
let's ignore text for now we'll come
back over to our form and the code
behind all right so in here first we
want create our team member object so
team model T equals new team model T dot
team name of members name equals
we have to grab whatever the name of
this is it's team name value so team
name value dot text and then the T dot
team members equals and that's just our
list up here of selected team members
and notices a list of person model and
this is a list of person model so that
works fine and now we say global config
dot connection dot create team pass in T
you can say T equals just a capture back
out and now we're done now the team has
been created and really this form should
close because we're not going to leave
us open to create a new team we're going
to go back to our other form that called
this most likely but just in a safe side
we can do is we can reset up all of this
information so let's create a note to
just remind ourselves hey if you're not
going to close out this form reset it so
let's do that over here I say to do if
we aren't closing this form after
creation reset the form so I'm not quite
sure how we're going to use this form
you haven't really talked about how
these forms all interact but I think
that we're going to drive everything off
of the create tournament
form and so creatine will come back
you'll add that team and they'll say oh
come on create another team and do the
same thing over and over again so in
that case we can just close out the form
because that will wipe everything out
there's no reason to set everything back
up new so I'll leave it like that for
now and the only other thing you do for
testing purposes is make sure we change
this back to sequel and now let's run
this before it too far though I want to
look at both the team table and the team
members table I'll run both of those and
they are both blank so I just played a
start now let's run this and call it
this first team let's call it team first
place add Tim and Sue this team just we
have two and then I'll say create team
now remember we didn't wipe anything out
we're going to assume if it's formal
clothes when you hit that create team
let's go over our sequel and run us
again and we can see that I have the
team first place down here we can zoom
in here there's team first place an ID
of one then we have two people both on
the team ID of one the first person is
one that's a person is two I would
assume that that person one is Tim and
person two is Sue now you can look at if
you wanted to that's not hard we could
say select star from dbo dot people
where
peep purse note for ID
sorry ID in 1 comma 2 and that it says
give me all the people that have an idea
of one or two and every Tim and Sue so
yep that all seems to work just fine
so now let's wire up our text side so
it's first changes but weird text which
right now will throw an error which is
great because then if we were to do this
accidentally we had set up yet notice
different people because we're in text
now we create team it's going to throw
that new not implement exception which
is great so let's go ahead and implement
this method right here now again I'm not
going to reinvent the wheel so let's
look at what I did in other areas for
example here I first load all of the
prize model in and then I find a max ID
I go up one I add the prize I save that
to the file and then I return the model
so let's follow that same pattern but
now don't forget we have two different
ones we'd add so first let's look at the
teams and it's at this point you should
have kind of a quandary you get yourself
into and you just step back and think
about what you're doing because the
reality is and here's what I'm going to
land on this the reality is we're not
saving it to files
in the sequel table we are we're saving
to two different tables but there's not
really a point to that if you look at
the team model which we are passing in
if we look at that we have an ID great
we have a team name great and we have a
list of person model we don't have a
separate model for these people and by
that I mean it feels a database and look
at team members there is a team I did a
person ID and the ID of the row there
entered in we don't have that reflected
in this model and that's okay we don't
need to have that information in fact
it's kind of worthless instead we like
to have the person model which has their
name and their email address and their
cell phone number all the rest so we
don't need to have two different text
files instead of you have one text file
that just handles the idea of having a
list and how we're going to do that now
the list can be a little more
complicated and so we're going to figure
a head do that in a way that makes sense
but first let's start with the basics we
need to have a file - save it - so let's
start there private cons string and this
is the team file equals team model
models got to CSV alright so there's a
team file
and justly up here we can say let's get
a list of team model
teams equals there's our file name dot
full file path dot load file dot convert
to team model plural models we don't
have that yet so when you create that so
let's do that let's put in the same spot
as convert to prize models and it's okay
there's a yelling at me right now I kind
of want that because I know I'm not done
there yet so we have these two converts
convert to prize model convert to person
model let's create another one public
static list of team model convert to
team models this list of string will say
lines okay so what exactly does the text
file look like remember it's a comma
separated list so we'd probably have ID
comma team name comma and that's where
it gets kind of tricky because if we
look at a team model it's a list of
person which doesn't make sense to say
the whole person it's kind of
duplicating information so instead what
if we have a set of values that's
separate and normally be a comma
separated list but because this is a CSV
file where it's already comma separated
let's do something else so let's take
take the list of ID's
separated by the pipe that's going to
look like let's say three comma Kim's
team comma one pipe
three pipe five that's what a road look
like and so that represents the ID of
the team the name of the team and then
each ID of each person now we're not
done there because we're gonna have to
rehydrate that rather pull those people
out and say okay we have these IDs
what's the full model for that that
person so we have to do some other calls
here to pull in our list of of people
and so we'll do that at some point but
first let's get this part of it done so
we're going to do a for each let's
create a list first sorry list of team
model output equals new list of team
model I do a for each string line in
lines and let's say string array calls
equals line dot split signal quotes
around a comma notice I'm just following
the same pattern I have up here and so
now we have a team model T equals new
team model T that ID equals calls 0t
team name of some team name equals calls
one and don't forget to wrap this one
with a dense parse and now we have to
deal with that pesky last column which
is our list of ID's for people so we're
going to do about that let's go back and
look at our text connector real quick
and look at the create person here the
first thing we do is we pull in the
people file and convert it to a list of
person or person model that would guess
every person that we have saved in our
text file which would give us something
to look up then by ID but this constant
people file is in this file now we have
two options here one we can load this
down here and pass it in to the convert
T Mouse or we can pass in just the
string for the people file and then have
it do all this work I kinda like that
second option better so the cop is an
entire line but then down here pass in
people file now that breaks this that's
okay come back over here and say comma
string people file name and now it's
going unbroken at least as far as
passing information now why is there
only one parameter again again this is
because the first parameter is actually
the output of this right here and you
can tell that because it says this in
front of it and that's the extension
method how it works so the second
parameter becomes the first visible one
you see inside those parentheses
and that's the people file name so up
here right after right after I do my
output I paste in that line and I'm
going to change the file name to the
passing file name people file name and
now we have a list of people so now I
can say string array or si people now
person Wow there we go
ID IDs equals calls to dot split single
quotes pipe character so what does that
do
it takes the ii actually the third
column calls number two since 0 1 to
take a third column splits it by a pipe
character and put that into an array
called person IDs now comes a tricky
part how we going to deal with looking
up these people IDs not because it's
looking up the ids is hard it's because
what happens if we have an ID that isn't
in our list of people that could be a
problem okay
so we have a couple options one we could
gracefully skip over that person or two
we can blow up I think for right now
we're actually on blow up because again
that application in uncertain state or
half-done state isn't what we wanted so
the first record succeeds and a second
record we can't find the person that
doesn't mean a team should have one less
person on a team it means we've got an
error in our list somewhere but in this
case we're now blow up and that way we
know nope that didn't work
so for each string ID in person IDs and
we're going to say T dot team members
dot add and here's we do a lookup where
I say people dot where X arrow key X dot
ID double equals int dot parse ID and
the rest say first like so and that
should do it as a lot of curly brace
curves are um parentheses in there a lot
of stuff go on so let's break us down a
little bit so this right here what it's
doing it is saying take the list of
people all the people in our text file
and says search for it and filter where
the ID of the person in the list equals
the ID from right here so in theory it
should find only one person we're going
to parse int on a string don't forget
that otherwise there's a string compared
room int and that won't work so the
theory is each ID is unique and
therefore we should never have one one
but C sharp is know that and so it says
I'm returning a list and so we say give
us your first item now if you did return
three items in this list it would still
only give you the first one but since we
know is she a one-to-one relationship
then
the first one is the only one now here's
where it's going to blow up on this
first if there's there in the list it's
going to say I can't do that as they
explode there is an option here first or
default and what that will do is will
return null if it can't find a record
instead of blowing up but again that
wouldn't crash our application therefore
we could conceivably think that this is
working when in fact it's not so we're
going to leave like that it's going to
find the person object and add it to the
team members list of object so all that
to say for each line in our text file
add the ID and team name and then loop
through and add the team members based
upon splitting out calls to which is
this value right here split us out by
the pipe and therefore we know which ids
which we can then look up in our people
list to find a full person object to add
your team members list with all that
being done we can return output and now
convert team models is complete we come
back over here no more yelling ass and
theory we have a list of team model
called teams now we need to follow the
same pattern as up here where we get the
idea in fact let's just copy this and
paste it current ID and teams dot count
is greater than zero
teams order by descending by the ID
which is the same name as we give it for
every
though so that's fine find the first
from the ID add one that's our new
current ID put that current ID in in the
ID area for our team and then we're
going to say teams dot add model so
we've taken the model passed and we give
it the ID now you've added it to our
list of teams we found from our text
file if any and now we need to do two
things first we need to say teams dot
save to team file and pass in a team
file name and return model return model
works is fine because we already have
that done let's save the team file
that's not created yet so we come back
over here and you have saved apprise
files say two people file and now we
will have public static void save a team
file this list of team model models
string file name first we're going to
create that list of string now what we
save at the end they're going to our for
each and say team Model T in models
whereas say we need to add a line for
each one of them before we do we have to
address that list in there that we have
to convert over to our
our pipe delimited set so how you undo
that well we probably have another for
each but it seems like that's doing too
much miss for each loop so let's create
another helper method create a private
static and we have return type of string
that's we want and let's call it convert
people list to string
let's pass in a list of person model and
call it people so this methods job is to
take that list of person model and
return astray instead that way up here
we can just do the same kind of thing
only instead of passing in just the
value for that last one we will pass
that value to this method and use the
returning string in this place so that's
a little complicated to kind of
visualize if you're not seeing it at
first that's okay we're going to do it
here you'll see it and I think the
lightbulb will click on okay I know that
I'm doing so let's start with what we
need we a string output equals an empty
string the last thing we'll do is return
that output before we do we're going to
do a for each person model P in people
and we're going to say outputs plus
equals P dot ID and
let's do this as a our special string
here with dollar sign in front of it
that way we can do the pipe right in
line so for each person in the people
list we're going to say add to the
output this first the ID which we get
converged with string and then the pipe
character so everyone's going to have
that so after the first entry say the
first entries - it's going to look like
this after the second entry so that's
five it'll look like this now before you
jump a gun say okay we're done
and the very end the last thing to do is
take off this the trailing pipe
character and the way to do this it's
very simple we're just going to say
output equals output print spell dot
substring start at position zero and go
to output dot length minus 1 and finally
return output so what's going to happen
is after you loop through where I have
something looks like this the last thing
we're going to do is when to a substring
of our output and what substring does it
takes a piece of our string and returns
that value we're going to start position
0 each character is one number starting
at 0 it's a zero-based array and so I
said start at 0 and count this many
characters well the length which we all
the characters minus 1 and that's
arts at position zero that's right here
then one then two and it says well I had
a length of three so I stopped at I'm
sorry for so stop at position three
right there and therefore we're done so
zero based arrays and with one based
counts and all the rest can get very
confusing my encouragement to you is
you're not absolutely certain what I
would do is create a little test project
that just as one thing is a very simple
version of this in fact I did that just
to double check to make sure this is the
way it's supposed to work because I
always seem to get it wrong except when
I don't that question myself so just
test this out in a simple fashion in a
test project just to make sure you have
your counting correct especially if
you're doing things where you're you're
counting only a certain number of
characters or you're going from the
middle or something weird like that
where you really need to make sure you
get your numbers exactly right before
you go out that's method we have one bug
to fix and you may not have noticed it
but take a minute and try and figure out
me pause the video and try to figure out
the bug is in this method you figure it
out the bug here is what happens if we
have zero people in our list should we
no we shouldn't but maybe we did maybe
we have a team and no people in it if so
the for each would work just fine it
would say for each person mile P in
people people's empty therefore and
never run but down here substring of
output which starts off as an empty
string so count of zero this is zero to
output length that's zero minus one
substring of zero to minus one that's
going to crash
so the few ways to handle this but
probably easiest way is to come reppin
the top and say if people dot length
I'm sorry count equals zero returned
empty string and so what that does is it
kind of short circuit this process if
there's no people in list there's no
reason for us to loop through the list
or to do the the substring all the rest
just say if it's the count zero return
empty string because that's what really
what would be so that solves this method
right here
so now just like in here we can say
lines dot add we can do our dollar sign
and two double quotes so I call in the
end and come back we can start off with
our P is t dot ID and our curly brace
comma no space curly brace T dot team
name curly brace comma another curly
brace with no space and then we're going
to say convert people list to string and
pass in T dots team members then close
that clear brace out now this method
passing in a list of people gets back a
string of these pipe delimited items
that's going to put it in this spot
right here
and so our end result is something looks
like this which is exactly what you want
so the only thing left to do is to do
our file dot write all lines this is a
baked into c-sharp method this filed out
rail lines it takes in a filename
actually a file full path so we'll give
the full path and then a array of lines
or a list of lines and that's our list
of lines
so we've now saved to the team file and
theory life should be good let's find
out if it is or not so we'll pull up our
art form
I'll also pull over my files here just
we can see there is no team models file
so create team of second is best let's
add both Joe Smith and Sue Storm but not
Bob Smith we will create that team and
now the team models dot CSV has been
created if we open that with notepad
I'll pull it over here we can see that
we have the ID of one second is best and
then that pipe delimited list of ID's
for the people so life is good it seems
to work and with that we have completed
the create team form at the beginning it
seemed a little intimidating with all
this stuff going on but we broke it down
into sections this section here this
section here this section here then this
and then finally they create team button
so I break you down to little chunks
sure it took us a little bit but we got
the job done and it
wasn't that overwhelming once you
started getting to get rolling in our
system and the way we guys do things it
really was just follow the pattern and
do the same thing over again make small
little decisions not big ones now that
you've handled this form in our next
video we're going to tackle something a
little bigger we're going to get to the
create tournament form this is a big one
because once we have this done then our
system is pretty close to complete the
only thing we'll have left after that is
to load which tournaments we have so you
them and the actual viewer and those are
kind of small so stick with it we're
getting close let's finish strong get
this application at least up and running
and they're going to come back through
and make some improvements and upgrade
this with a couple different fun
features that really make the
application stand out and be more
intuitive so stick around for that
before you go you'll see a link in the
left of BIOS course check out the intro
video in this playlist for more
information all you get if you pay also
if you are ever wondering what you could
do to help this channel out without
paying money I've listed six things that
really help I'd appreciate if you
consider doing one or more of these
thanks again and don't forget to keep
practicing what you learned</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>