<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CIS163-101: Working with the ComboBox | Coder Coacher - Coaching Coders</title><meta content="CIS163-101: Working with the ComboBox - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/IAmTimCorey/">IAmTimCorey</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CIS163-101: Working with the ComboBox</b></h2><h5 class="post__date">2013-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-BNmOMFpPOg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we're going to discuss
data binding in the combo box in windows
form so our entire application here is
going to revolve around this people
drop-down list okay this is called a
combo box in windows forms now I have
created a simple little form here that
has a couple different pieces to it
first I have an entry screen where I can
add a person to my list I then have a
drop-down of all the people in my list
and finally I have the selected users
age okay so let's look at the class
behind all of this
the person class contains a first name a
last name an age and a full name
property the full name being just the
first name or last name of the space in
between and the age being an integer
value so in my code behind for this form
I have a list called people it's a list
of type person and it's called people
alright so in my initialization in my
constructor right here I first
initialize a components and then I do
this load test data this just starts me
off with some data on the screen before
we do anything else and this load test
data method just creates four people and
puts them into the people list okay so I
create Tim Mary Sue and John and with
their last names and ages and I put them
into the list of people the next thing
in my constructor is right here this is
a binding source for my drop-down my
combo box so if you notice up here at
the very top I have in the at the class
level I have this binding source source
equals new binding source this is what I
use to wire up my list of person to my
combo box
so I create this new source up here and
I say the data source for this biting
source the data source is people that's
my list okay and then I say my drop-down
its data source is my mining source okay
so basically this binding source is
sitting in between the drop-down list
and the list of type person and it just
hooks the two of them together using
this deer source okay and then the final
piece is to set the display member and
value member of the combo box in this
case I set both of them to be full name
the display member is what shows in the
actual drop down the value member is
what the representation of that value is
for example if you are pulling
information from a database and you had
an identity field a unique number that
represented that row of data you would
put that in a value member field and the
display member you'd put whatever makes
it most understandable so for example in
this case full name makes it most
understandable because you know Tim
space corey identifies that specific
person so in our case we don't need a
change display member display member or
value member to something different
we'll keep them both at full name okay
so that's that wires us up and gets us
started so if we run this we have this
drop-down with Tim Cory
Mary Jane Sue breeze and John Doe so
initially the first thing that happened
is we load our combo box now I've
created this form here up top with the
first name field the last name field the
age field and that's button this has add
person if you look behind this button
that says add person I parse out the age
field since it is text I
convert that using tryparse to an age
value and then I create a new person
object called created person and then I
populate the first name last name with H
the first name gets the first name field
dot text that is that box right there
and then the last name gets the last
name field dot text again that's that
box right there
and the age gets that age variable which
actually comes from age field dot text
it try it gets parsed so in that age
field dot tax is right there so it takes
those three fields it creates a new
instance of the person class and then
just does a people again that's at the
class level right here take that people
dot add and it adds that new person
the final thing it does is a source dot
resent bindings with true okay so what
this source not reset bindings true does
is it updates this binding source and
says refresh anything that's dependent
on this binding source now remember that
we use this binding source in our
drop-down as a data source so since this
uses source it will get updated the
drop-down will get updated because our
binding source gets updated so when we
update your binding source it updates
the drop-down so what that does is it
takes this list and just refreshes it
let's see what that looks like so again
here's a drop-down for people in it
let's add a new person let's call this
Bob Smith and he is 87 years old I had
nothing visibly changes but if we do our
drop-down here we know notice we have
Bob Smith at the bottom that is how you
can bind the drop-down to a list that
changes
all you need to do is when you do make a
change the list like adding a new person
you need to do this source dot reset
bindings true the final piece here is
getting information out once a user
selects something so when a person
selects when the user selects a person
from the list we want to get that whole
person class instance out in this case I
just want to say you know what
take the age from that instance and put
it down here in a label so to do that in
my drop-down you go to events I create
an event on the selected value changed I
could have done that selected index
change and either one will work in this
case so I am saying when every the
selected value changes meaning when you
do a drop down and select something
different fire this event and the
background it's really simple this is
the selected value change event the
first thing I do is I create a new
instance a new class called selected
person of type person but instead of
saying a new person i immediately a
cyan't the value of the people drop down
that's that drop down box of combo box
dot selected item now if you notice in
the list
there's selected item so the text
selected value selected index now
remember that value member is full name
so selected value would be you know tim
space corey or mary space jane select
attacks would be the same so if it index
would be that I'm sorry the selected
value how the text would be the display
member and again so that index would be
the value member basically bottom line
in this case we want such item one of
the entire item so this item is a person
instance but we can't just assign it if
we try this out we can't just assign
this to a person variable because it
doesn't know what that is it's not sure
what type this is what we do we give the
compiler a hint and say you know what I
know that the ID on this list is of type
person so put that in parenthesis if you
knew this type string you'd type string
here if you know int you type you put
into here but in this case it's type
person so I put person here in
parenthesis and that just says this will
be a person instance now if it wasn't
this will throw an error so make sure
you have this right what this does then
is it takes the selected item it makes
it puts it into a person instance now we
can use that instance for anything you
want so for example I'm going to take
the selected age label dot text that's
the label of front-page and say you know
what let's use this instance there's an
age value in the instance and I just do
it to strength since that's an integer
okay let's look what this does so if we
run this again okay we have Tim quarry
notice is what the selected users age is
35 now if I do a drop-down select Mary
Jane it changes to 21 against Sue breeze
it changes a 29 and finally John Doe for
you too so every time I change it fires
an event and cast that into the selected
person instance and then we use that
to populate information on our form what
you could do instead is then pass this
instance around and say you know what
let's populate the entire form you know
show the first name the last name the
age we could put this into this box up
here and then have an edit button that
says you know what let's take this
information and updates that value all
that's possible so that's the overview
of how to use a drop-down you started
putting the drop down the page you get
your information in this case we used a
list of type person called people you
create a binding source to hook the list
up to the comma box just in the middle
you say that the binding sources data
source is your list in this case people
you say that the drop-down or combo
boxes data source is the binding source
you set your display member and value
member for your drop-down list and
that's a text representation of the
field so for example full name if you go
back to our person class I have this
full name property and that that
represents I couldn't put full space
name that wouldn't work it has to match
exactly to the property once I wire all
this up the display will work properly
if I want to add something to the array
once I add it down here I've added it I
have to do the reset bindings to my data
my binding source so binding source
where it's called in this case source
dot reset bindings and set that the true
and finally to get information out of
the form out of the select the drop-down
box
I say in my selected value changed or
selected index changed event I take the
selected item I make sure I specify what
type it is in parentheses I put that
into an instance of my type so person
selected person and then I can use that
instance however I want to in this case
I assign one of the values to a label
and that's it hooking up the combo box
it's rather simple but yet the end
result is fairly powerful
you can a fully functioning form that's
interactive in just five minutes and
that's all there is to hooking up a
combo box in Windows forms</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>