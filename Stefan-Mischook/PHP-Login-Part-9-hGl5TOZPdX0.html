<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Login - Part 9 | Coder Coacher - Coaching Coders</title><meta content="PHP Login - Part 9 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Stefan-Mischook/">Stefan Mischook</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Login - Part 9</b></h2><h5 class="post__date">2010-09-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hGl5TOZPdX0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so we want to go ahead and get the
data but the difference is we don't want
to insert it immediately we want to
check that the current password that the
user enters matches the existing
password for some reason if the user is
logged in and someone else has access to
the computer temporarily we don't want
to be able we don't want to enable that
new user to be able to easily change
their password without knowing the
existing password so this is fine we're
just going to do a little bit of changes
here the first thing we're going to do
is we want to check if the old password
matches the current the password of the
current active user so if I'm just going
to call this one check and we're going
to use a MySQL I statement mysqli and
we're going to prepare a statement will
do select password from members where ID
equals ?
and if that's fine we're going to bind
the prams the S stands for string is
we've talked about in the past and then
the second one is we're going to pass in
the session variable ID that we created
a couple minutes ago ok so we bound the
session variable within this query now
we just need to execute it so check
execute and then we want to bind the
results so check find result and I'm
just going to put that in a variable
called current pass and check fetch so
that's going to actually get the data
from the query and finally we're going
to close the query out so check close
okay so assuming that's all good we're
going to skip on to the next thing we
want to actually check that the data
that we got is currently in the current
pass matches up so if this one's going
to be a little bit tricky because
remember we do a couple things to this
password so its md5 and input
current pass so this is the data that's
gotten from the form and we're going to
add on to that excuse me one second oh
here we go config we add the salt so if
that's going to equal the current pass
so this is the md5 hash of the users
current password and this is the current
password that the user entered in from
the form so if that match is actually I
take that back now i'm going to go ahead
and do if it doesn't match we're going
to show an error so error loot
and then we're going to go ahead and
include our view again and display these
errors to the user like so otherwise
let's go ahead and continue so I'm going
to go ahead and grab the section of code
paste that in place and we just need to
do a little bit of some changes to this
query here so rather than the insert
we're going to do an update I'm just
going to delete this entire thing update
members set password equals ? where ID
equals ? and we want to buy in
parameters we want to create this new
password so we're going to describe this
section here and we want to save that to
the database
and then the second one is again the
session
okay so I believe that set yeah that
should be fine we execute we close it
out and I believe we're good so let me
save this and open up login dot PHP it's
like that's good let's make sure we're
good make this work correctly okay so it
logged in let's go change password if
you open up the incline see and check
your config we need to change this if i
remember correctly we set this to a very
low value in our last couple examples
because i wanted to show it to you in
action be a session timeout so go ahead
and change that and while we're at it if
you open up the password view let's go
ahead and change the input type of the
first input from text to password ok so
i'm going to go and refresh this let's
try one more time change password
and it looks like we're just about good
I believe we just need to change this
message and rather than remember added
successfully let's just go ahead and say
a password updated successfully that's
taken care of and one quick thing I also
noticed you need to make sure we're
updating the correct information so
instead of current password you can just
go ahead and put in paths this we want
to make sure that this password that
we're saving the database is the new
password not the old one so let me go
ahead and save it going to refresh this
page we log out log back in safely okay
so change password
I'm putting in temp temporarily let's go
ahead and log out and check to make sure
the new password was saved so I'm trying
admin and it tells us the username and
password is incorrect and I'm trying
temp and I'm successfully logged in well
that wraps up today's tutorial thanks
for listening and hopefully you found it
useful</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>