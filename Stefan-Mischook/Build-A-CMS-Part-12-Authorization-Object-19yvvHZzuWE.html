<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A CMS Part 12 - Authorization Object | Coder Coacher - Coaching Coders</title><meta content="Build A CMS Part 12 - Authorization Object - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Stefan-Mischook/">Stefan Mischook</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A CMS Part 12 - Authorization Object</b></h2><h5 class="post__date">2011-05-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/19yvvHZzuWE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now basically all that's left is to
build out our controllers and build out
our authorization object so I'm gonna
work on the authorization object next we
want this object to contain functions
related to authorization basically login
logging out checking if a person is
logged in so that's what I'm going to
start working on so like the other
template object I'm going to start with
a class I'm going to call this one off
and it's going to start out we're going
to use two private variables and I don't
have a private database which I'll talk
about in a second and I'm going to have
a private salt and I'm going to set that
to a value which I'm going to pull from
our temp dot PHP file so I'm gonna grab
these characters copy and paste them
into our authorization object now let's
go down a little bit I'm gonna start out
our usual constructor and we're going to
be using the database PHP include to
create a date to create a database
connection and we need to be able to get
access to this and by default the scope
of the database variable is set up in
such a way that we don't have access to
it within this authorization object
however what we can do is we can
reference that by using global database
so now we could have access to the
database object that we created within
database dot PHP and what I'm going to
do is I'm going to set this database
equals database so now instead of having
to use the global database line in every
single line of this object we can assign
the database variable up here to our
database object and all of our functions
can access the database now now below it
let's add a couple functions the first
function I want to build out is a
function called validate login and we're
going to provide it a username and a
password and this function will return
true or false depending on if the login
is valid so what we'll need to do is
we'll need to make a connection to the
database which we do using databases dot
PHP we'll need to access that database
check the variables that we were
provided with in user and pass check
that against the database and the turn
true or false so let's start out by
creating the database query so if st st
mt for a statement equals this database
prepare and i'm using a mysql i prepared
statement for security so we're going to
do select star from users where username
equals question mark and password equals
question mark
and otherwise else if it can't prepare
the statement for some reason maybe it
can't access the database or something
I'm simply gonna use a die statement and
I'm gonna say error could not prepare my
SQL I statement and you could
potentially include in your template
object the ability to show error
messages
perhaps error page that could have this
error message in it but for the sake of
this tutorial I think I'm gonna keep
things simple and I'll just use a die
message so now assuming we were able to
prepare this statement correctly let's
go ahead do statement by into program
and the bind prim refers to these two
question marks and my first value is
gonna hold SS because these two will be
strings and then a comma and we're going
to pass in user and then finally the
password which is the md5 of our pass
plus our salt
like so and then we're going to execute
the statement we're going to store the
result and now we will check how many
rows are a turned
so if the statement has a number of rows
over zero we know that it did find the
user successfully so we're going to
close out our statement with a statement
close and we're going to turn true
otherwise we'll have a failure message
we're gonna close out the statement as
we did above but this time return false
okay so that's that function we have
just one or two more minor things this
is basically the meat of this particular
object and let's do one other function
for check login status
and it's going to be a pretty simple
function it's just going to check if a
session variable that we're going to
call logged in so if that is set so if
that set we want to return true
otherwise you want to return false and
the last thing we want to have a logout
function which is pretty simple you're
just going to destroy the session oopsie
and then start it again so basically
these two lines it'll destroy the
session which means it'll remove any
session logged in variables and then
it'll start it again which is important
if we need to display any alert messages
that use the session variable so I'm
going to save this and this particular
object is done so the next step is to
show you how to work with the
controllers and actually access the
template and the authorization objects</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>