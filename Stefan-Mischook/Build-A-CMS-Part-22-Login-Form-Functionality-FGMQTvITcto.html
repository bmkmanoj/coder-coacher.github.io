<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Build A CMS Part 22 - Login Form Functionality | Coder Coacher - Coaching Coders</title><meta content="Build A CMS Part 22 - Login Form Functionality - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Stefan-Mischook/">Stefan Mischook</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Build A CMS Part 22 - Login Form Functionality</b></h2><h5 class="post__date">2011-05-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FGMQTvITcto" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to part 22 in the last video we
have our login form popping up correctly
within the color box but clicking on the
login button doesn't actually do
anything yet so what I'm going to do is
I'm going to start work first with a
tiny fix so if you go to the login dot
PHP file which is within the app folder
you'll notice that I have two lines here
setting error messages to appear if
either the username or the password
field is not filled in and if you
remember from the last video or two I
talked about simplifying the way error
messages show up so rather than
displaying a full error message next to
each input we're simply going to add a
red border on that element to indicate
that it's missing so one quick thing I
need to change is rather than saying
required field for this error underscore
user and error underscore pass I'm just
going to use required and you'll see
this change in a couple minutes once we
actually get the form working now to
briefly go back to my test page the next
step is going to be working to make sure
that this login functionality actually
works so I'm going to open up the
underscore login dot PHP which is
available within the app folder core and
views and I'm gonna add a jQuery block
up top here
so that looks like this and what I want
to do is I want to use jQuery to catch
the form submit process and we're going
to use the submit function for that so
let me show you that it looks like this
and we're gonna make sure the form has
an ID so I'm gonna add that in here I'm
gonna call it login and up here within
the jQuery I'm going to call the login
ID and call the submit function
like that and this in itself doesn't do
anything yet
but when the forum gets submitted it's
going to catch the submit process and
learn whatever jQuery code or JavaScript
code we have within this function so the
first thing that I want to do is I want
to disable the browser's default
response of refreshing the color box
once we hit submit and to do that I'm
going to use a function called prevent
default and I'm going to add a variable
within the function call I'm just going
to call it E and the first line is going
to be e dot prevent default looks like
that and this prevents the default
action from occurring some people will
use return false for this but it's
generally known that the prevent default
function is the best practice solution
to preventing the default action so feel
free to check out the jQuery
documentation on the prevent default
function in case you want to learn a bit
more about that so I'm going to save
this and let's take a look at our test
page again and see what's going on at
the moment so we click the login button
and nothing happens so at least that's a
step in the right direction now how do
we actually go about processing this
form well to do that we're going to use
a bit of ajax and the first thing that
we need to do is we need to capture the
data from the form and pass it along to
ajax we're going to provide it the URL
to the login page that will process the
form and return the results so I'm going
to set up two variables I'm going to
setup borrow username and that's going
to equal I'm using a bit of jQuery here
the value of input with an ID of
username
thought foul and I'm going to do the
same thing to password and if I look
down here it doesn't look like we have
you to me we have the ID set for either
username or password so I'm going to add
that in like so and just so you can see
this working and add an alert here so we
can actually see what values these
fields hold I'm going to put tests in
both fields click login and you'll
notice we get tests tests and if I just
remove one of the fields we get tests
and a blank string so you know this is
working properly
and I'm going to combine those two
variables into a single variable that
we're gonna pass into Ajax which I'm
going to call data string and do user
name equals and a plus username and
password equals plus password so
basically what we're doing is we're
going to provide this variable we're
going to pass it along to a PHP script
that processes the form and that script
will return data back to us and this is
how we go about processing the form and
actually supplying the form field values
to the processing script the next thing
is to actually call Ajax so we're going
to do that like this a pound sign or a
dollar sign for jQuery AJAX
and we're gonna pass in a couple
variables here we need to set some
things so first we're going to set the
type which is going to be post so it can
either be get or post but we're going to
use post in this case I want to set the
URL which means the URL of the script
that processes this form and we're going
to use a little bit of PHP here and
we're going to echo out the site path
and then app slash login dot PHP because
we basically want this login page or
this login PHP page to process the form
for us or display the form depending on
what's going on
so that's the second line and then we
want to actually pass in our data so
we're going to include the data string
variable we want to make sure that this
data is not cached by the browser so
we're going to set cache to false and we
need to provide some sort of success
function what occurs when the Ajax
completes successfully what do we do
with the data it gets returned by the
PHP script that processes this form
so we're going to do that like this
we're going to do success and we'll do a
function which includes HTML and the
HTML is the result of our process script
let me check that I've done this
correctly okay yes that is correct
so and then within this success function
I'm going to replace the some of the
content on the page with the content
that was returned from the PHP script
and there rather than simply typing this
out let me show you how I got this
result so let me open up this test I'm
just gonna copy this URL and paste it
into Firefox here we go
so I'm gonna look for the ID of the div
that creates this login form so I'm
gonna use that
I'm gonna do that using Firebug and it
looks like we want C box loaded content
because this actually creates the day of
let me delete this element and you'll
notice it disappears so I want the
contents that's returned when the form
is processed to replace the existing
pop-up so if I go back to my login view
I'm going to use a bit of jQuery here as
well I'm going to pass in C box loaded
content and the HTML within that div is
going to contain the HTML from the PHP
processing script this
so let's go ahead and test what we have
now to test test and we get a form
refresh but it doesn't seem like we
actually have anything appearing here so
let me check and see what's going on so
probably the first thing we need to test
is we want to make sure that the Ajax
call is working so within the success
message I'm going to add an alert and
I'm going to display the contents of the
HTML variable and as I said earlier the
HTML variable contains the results from
Ajax call the HTML and CSS that's
returned by the PHP function so let's go
ahead and test this and it looks like we
are getting data within the HTML
variable so that's good and it looks
like it is the HTML from the login view
which is good but it doesn't look like
it is showing any sort of processed
message so for some reason the login dot
PHP this section is not getting called
and it's defaulting down to this line so
probably the key culprit here is going
to be this line and if I remember
correctly this is a line left over from
the object-oriented series that I did on
a PHP login and you'll notice if we
check the login view that we're only
passing along username and password
we're not passing along submit so post
submit is never actually set so I'm
gonna get around this by instead of
checking for post submit I'm gonna check
for a username or password because we
know those will be set so if I change
this let's go back and test this again
and see what's going on
okay so it looks like you're getting a
fatal error it looks like we have an
issue within our authorization model
probably a piece of leftover code from
the Opie login series but I'm gonna go
ahead and take care of that in the next
video we're headed in the right
direction because we know that this is
now getting processed and it is working
correctly</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>