<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>MySQL Advanced - Introducing Many-to-Many Part 1 | Coder Coacher - Coaching Coders</title><meta content="MySQL Advanced - Introducing Many-to-Many Part 1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Stefan-Mischook/">Stefan Mischook</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>MySQL Advanced - Introducing Many-to-Many Part 1</b></h2><h5 class="post__date">2010-10-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SENtNG5SSIc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi there this is John Levin sold for
killer PHP calm and in this video on
advanced MySQL usage I'm going to be
looking at many to many relationships so
in the last video we created a table
called category and a table called
author and a table called post and we
had a one-to-many between category and
post and a one-to-many between author
and post in other words there could be
one author that would author many posts
and there could be a category and the
category would contain many posts so now
we're going to switch things up a little
bit and we're going to create another
table that will act as a join table or a
cross table in order to facilitate a
many to many relationship between
category and post so I'm going to start
us off by adding a drop table by the way
it's case insensitive but drop table if
exists on the top here and this is my my
script by the way and it's just going to
be a table called post category in other
words we're going to be joining the post
with the category now other
modifications that we need we're going
to have to create of course this table
and we're also going to actually get rid
of the category ID from our post because
we're actually not going to need it
anymore
and I'll explain why in just a minute so
I'm going to start by deleting that and
I'm also going to delete the foreign key
reference or actually I'm just going to
cut it so if you look now basically I've
gotten rid of any relationship between
the category table and the post table
the next step is to of course create
this table that will join the two so in
this case I'm going to create a table
called post category and it will have a
ID
which will be an integer primary key
autoincrement
and it will also have a post ID which
will be an integer and it will have a
category ID which will be an integer and
then we are going to have a foreign key
on category ID that references the
category table so if we just look at
this for a second here we have the
category ID and then we have on delete
no action so that should be good there
so we've got a foreign key here but we
also want to have another foreign key
and this foreign key is going to be for
post ID so I'm just going to copy this
paste it and then I'm going to close
this bracket and then specify the engine
as nodb and here instead of it being a
foreign key on category ID it's going to
be post ID and B it's going to reference
the post ID so there we go so now we've
got a category table a author table a
post category table and a post table so
if I also this select statement down
here is no longer going to work for us
because we won't be able to just do a
very simple left join on category we can
still do the left joint on author but we
won't be able to do the left joint on
category anymore that's going to require
a little bit more work so the last
little thing I need to do is actually
get rid of the category IDs from my post
here
so I'll just delete that and that and
that and make sure that this all looks
okay and there we go and in some ways
our post table has actually gotten a lot
simpler because now we only have one
foreign key constraint there and we've
moved all the count of the foreign key
constraints constraints to the post
category table so we've decoupled the
two essentially so if I select all this
copy it and then paste it into my
terminal I'm getting some error down the
line let's see this looks ok can't
create table post category error number
150 it looks like there's something
wrong here so if I say create table post
category maybe I'm missing something
here
let's just go back for a second I yes so
in order to be able to do this again
order matters so I can't just put the
post category anywhere I mean I need to
insert this after I've got the post
table right because it's got foreign key
constraints so actually I'll just put it
at the bottom after the insert posts hit
save again copy it paste again and it
looks good except for the error on the
select statement down here which can
easily be mitigated or remedied rather
good okay so if I do a select star if I
first do show tables we'll see that we
now have four tables instead of three if
I do a select star from author you can
see that I have my list of authors and I
have categories and I have posts
with corresponding author IDs but no
longer a category ID and if I describe
the post category table then I can see
that it's got a post ID and a category
ID now in order for this to properly
function it actually requires Oran keys
and here is our first example of that
one too many are that many too many
rather so down here what I'm going to do
is just start with linking politics and
international as two separate categories
for the first posting so to do that it's
actually very simple I just say insert
into post category post ID category ID
values and the first one is going to be
the post ID so it's the first post and
the category that I want to insert is
going to be politics so it's going to be
one one and then if I want to link it to
international at the top here then it's
going to be one two and so I'm also
going to use this double dash which is a
comment so link post with politics and
this is going to link the posts with
international
so select all copy paste it in now
things get a lot more interesting</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>