<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DerpNStink CTF - Privilege Escalation to Root [Part 2] | Coder Coacher - Coaching Coders</title><meta content="DerpNStink CTF - Privilege Escalation to Root [Part 2] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Cristi-Vlad/">Cristi Vlad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DerpNStink CTF - Privilege Escalation to Root [Part 2]</b></h2><h5 class="post__date">2018-04-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ptT5EPz7fas" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to the second part of the
walkthrough for Durbin stink which is a
vulnerable virtual machine from Bond hub
so in the first part of this series
we've actually managed to get inside the
server through WordPress we found a
vulnerable plug-in which was exploitable
to arbitrary file upload so let me try
and repeat those last steps so the
username so we had poor credentials
admin and the password was admin but
this wasn't an administrator account it
was actually a lower privileged user
with the vulnerability in the slideshow
plugin so we actually uploaded a shell
which is in Reavis dot PHP as you can
see down here and we're actually gonna
set up a listener so let's say if config
so mine is 0 103 and let's cat info dot
txt cat Reavis so our reverse shell so
it throws a shell to my local host to my
Kelly box on port 449 so we'll listen on
port 449 and we have to execute this so
we can get the shell and we got the
shell ok so let's move on from here so
once again make sure to watch the first
video to see how we got here
step-by-step
now let's buy thon mine and see import
BTI and we're gonna spawn a bin bash
shell so we're going to get out of here
of this like low privilege shell
okay so I actually forgot a quote over
there let's execute it again so Python -
see import BTW i BTW i spawn a bin bash
and close the quotes okay now the first
thing since we are inside the wordpress
folder the first thing that i thought
was to actually check the wordpress
settings file or the config file so
let's go back more so over here it was
under the settings or the config but i
guess it was the config file because the
config file mine is going to hold
credentials to the my sequel database so
let's get it and as you can see over
here we have the username for the my
sequel root and the password is my
sequel so let's use those because right
now we are nobody so we are dub-dub-dub
data and we don't actually have any
credentials for this machine so no user
and maybe the my sequel database is
gonna give some more information or its
gonna give us some users too to be able
to work with privilege escalation anyhow
my sequel - you routes and the password
was my sequel okay now let's show
databases okay
now let's use WordPress let's show
tables now let's select everything from
WP users okay so we have our admin for
which we have the password and
which is hashed and we also have another
user uncle stinky with a password so
this is what we are going for let's
actually leave bad and two info dot txt
and write this down and to save some
time I'm gonna tell you that I already
know so it's uncle stinky stinking I
already know what this hash is because I
cracked it with hash cat but I'm gonna
show you the command that I used so this
actually is the hash for wedgy 57 so
let's see how we can crack it with hash
cat
so let's first leave bad and - stinky
dodd hash okay let's based our hash and
now we're gonna use hash cat - m400
which is for wordpress - a zero - output
is gonna be lets say stinky fast
txt we're gonna remove that hash from
stinky down hash we're gonna use rock
you txt which on my machine is so this
is a word list user share word list it
was in Derb and rock you txt and so the
output weren't gonna be moved stinky
down hash we're gonna have the word list
and i also have to say force if I don't
say force it says not a native Intel
open CL
one time so I'm actually and you can use
force to override so actually gonna use
force and since I already cracked this
it's probably gonna say that it is an in
some file so all hash is found in pod
file so at this point if you don't have
the password crack ill gonna try to
crack it so if I just specify pod file
disabled to actually show you how a hash
cat works hash cat is empty cat stinky
that hash so there's nothing in stinky
because it removed it so leave bad
stinky that hash were actually gonna
paste it again and we'll actually gonna
run that command again and right now is
gonna start trying to brute force it to
find it so it will probably take more
than half an hour I'm not sure but let's
just leave it maybe it will find it
while we we actually try to escalate our
privileges anyhow so we know that we
have uncle stinky with wedgie 57 so what
are we going to do with them now let's
go back to our shell and let's what was
it Sh
okay so we're back and so we are outside
my sequel and let's get at the password
maybe we have uncle stinky and we could
login with this password on the SSH cat
Etsy password so we have mustard herb
and we have stinky
so there is no uncle stinky but we could
try logging in to stinky with this with
this wedgie 57 so let's try and do that
SSH stinky at 192 168 0 102 and we get a
permission denied so we can't we can
log-in with this password ok the next
thing that I thought of was to try to
log into FTP one I ate 168 0 102 with
the user stinky and the password YG 57
and we are actually in the FTP server
let's see where we're at gonna CD back
so we have files let's CD into files we
have test dot txt let's get it
so tests dot txt we have network logs
let's see what's inside
derp issues let's get this one as well
dot txt let's go back and there was
another folder I guess yeah so two
folders SSH and time TMP so TMP is empty
let's make sure it is ok now we have the
SSH let's CD into an SSH LS we have
another ssh LS and another ssh LS and
another one oh god LS and another one so
you might think that there is actually
something in here because this is I mean
this is unusual but to a real world
scenario but this is kind of usual to
capture the flags so LS we have another
folder inside the folder SSH and we
would eventually get two key dot txt
let's get this key dot txt and let's
also exit okay so we have one two three
files so test.txt derp issues let's get
the test txt so it's a test file let's
remove it
okay let's cat key dot txt so this is
actually a key for the SSH
let's try actually logging in with that
key dot txt and to stinky at 192 168 0
102 permission denied we have to remove
permissions from the key file so chmod -
RW x - the key and let's try logging in
again so we are inside as stinky ok what
we actually didn't do is to login into
the WordPress panel so as uncle stinky
with the password wedgie 57 ok so over
here we have our second flag as you can
see let's copy it into our leafpad so
flag - right let's continue so we also
had another file and there
derp issues let's get their issues so it
is a conversation between derp and
stinky
I can't login to WordPress
yeah did you need a password I just need
to log on I'm gonna pack it capture so
we can figure out find derp I think I
fixed awesome I guess we are all right
yay okay so let's keep that in mind so
we are in home stinky I guess yeah let's
see what's on the desktop this is I
guess the third flag yep so we have our
third flag over here ctrl shift C and
we're gonna put it over here so remember
that I said that we have four flags so
one more to go and let's get out let's
go inside the Downloads nothing in here
let's go into the documents okay so we
have a derp issue pcap so this is a
packet capture file and we could analyze
it with warfare but first let's get it
on to the killing machine so we're gonna
use SCP which copies files over SSH so
SCP we're gonna use our key txt for
login and we're gonna log in stinky 192
168 0 102 and we're actually gonna get
the file from let's say home stinky
documents ctrl shift C ctrl shift V
without the extra forward slash
documents and the followers derp issues
dot pcap yeah and we'll get it on to our
root downloads train so this is actually
the folder that I am and I'm in right
now train Vaughn hub derp okay so let's
see yeah so we have a derp issues pcap
now let's wire frac it their issues pcap
this is a nice machine i actually
enjoyed it a lot so let's see what we
have inside here and to skip forward I'm
gonna actually use some filter so we're
gonna frame contains it says and the
conversation between derp and stinky
it's sad let me see if I can so is mr.
derp I can't log into WordPress anymore
and stinky actually stinky actually
fixed it for him so he probably created
a new user or did something in the
WordPress account so we're actually
gonna filter for frame contains let's
say mr. derp and we have some packets so
user new like I said create new user
user user name and pass equals so let's
try to follow the TCP stream and view it
more beautifully so over here we can see
mr. derp email named user so home
mr. derp and bass equals derp derp derp
blah blah blah so let's copy this into
our info dot txt so let's say mr. derp
with this password ctrl s and what we're
actually gonna do now we can either
switch user in the SSH so we are we are
stinky we can either switch users or log
into another SSH as mr. derp which is
exactly the same thing but before that
let's try to see what are the privileges
of stinky so we need the password for
stinky is it white g-57 yeah so user
stinking may not run sudo Underpants
tang okay so we're gonna switch users to
mr. derp and we're gonna copy this
password ctrl c ctrl shift V to paste it
in the terminal and we are mr. derp okay
let's see what we have here there are
issues let's go to home mr. derp so you
can see that inside home there is mr.
drip and stinky so cd2 mr. derp over
here we're gonna go to desktop ls-
a helpdesk log helpdesk log and I
actually read this and I think it
redirected you or told you to go to some
paste bin base bin location oh yeah so
this one pastebin copy link location and
we're gonna go over there
and it says mr. derp all all home their
binaries blah blah and if you're
familiar with Linux systems you'd
actually know that this is what mr. derp
can sudo can execute as pseudo so
everything which is in binary is derpy
we could also get that information
simply by saying pseudo minus L and
again get the password for derp ctrl
shift V and it says basically the same
thing user mr. Tuerck may run the
following commands as route on home mr.
dog binaries so let's get back into home
mr. derp and we see that we actually
don't have any binaries directory but
we're gonna create one make their
binaries okay and inside winery's so
this is this was the tricky part
but CD into binaries and what we want to
do now since we can't execute everything
which starts with derpy as root we'd
probably want to create a file let's say
derpy so this is only one way to do it
derpy Sh so this is gonna be a bash and
let's nano
into derpy sh since it's gonna be a bash
script so let's save in bash and what we
want to do here is to try to get a TCP
shell the same way we did for getting
inside as dub-dub-dub data so over here
at the pen test monkey it has a reverse
shell cheat sheet which tells you how to
create reverse Charles diff using
different programs so we're actually
going to take the
one the Bosch which is the simplest and
taste it
we're actually gonna modify here so our
IP is 192 168 0 103 and let's set it to
port let's say 450 let's control o enter
control X to save it to exit so let's
get there psh
okay now let's set up a listener on port
450 LVP 450 so we're listening on port
450 so the hash is still not cracked so
like I told you it's gonna take probably
more than half an hour to crack it but
let's just quit this okay so we have our
listener and right now we need to
execute derpy as pseudo so from mr.
d'oeuvre so we're gonna use sudo execute
derpy Sh command not found so pseudo
derpy Sh what's inside the therapy Sh
so then bash bash clearly I'm missing
something so sudo
pseudo Derby Sh
pseudo
what if we say pseudo Vash there psh
let's sudo Sh Derby Sh oh yeah so let's
change mod + execute derpy Sh and right
now pseudo derpy Sh
okay so that was it we have to we had to
actually change to executable to change
the file to executable so as you can see
we got the route back to our local Cali
so Who am I
root ok present working directory
mr. derp I guess we have we have the
three flags and the fourth should
probably be inside root over at the
desktop so CD desktop cat flag so this
is probably it flag number four ctrl C
and paste it over here so this was
actually mr. dirt or the Durban stinky
machine from Vaughan ha so like I said I
actually enjoy enjoyed doing it because
it kind of had multiple it had you work
on multiple with multiple programs like
the Wireshark the WordPress the
arbitrary file upload and yeah overall I
think I learned a lot so I hope you
learned a lot as well from this
walkthrough anyhow if you want to see
more cybersecurity videos or videos
and/or videos with walkthroughs with
machines from retired machines from hack
the box or machines from bone hub leave
a comment below and let me know about it
other than that thank you for watching
and hope to see you in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>