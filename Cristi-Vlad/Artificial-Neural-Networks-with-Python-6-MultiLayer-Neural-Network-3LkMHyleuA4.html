<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Artificial Neural Networks with Python - 6 - Multi-Layer Neural Network | Coder Coacher - Coaching Coders</title><meta content="Artificial Neural Networks with Python - 6 - Multi-Layer Neural Network - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Cristi-Vlad/">Cristi Vlad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Artificial Neural Networks with Python - 6 - Multi-Layer Neural Network</b></h2><h5 class="post__date">2017-11-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3LkMHyleuA4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this tutorial we're going to work on
a multi-layer neural network for a bit
of a background you can watch the
previous videos in this series so we're
using neural lab a Python library to
help us with the neural network so that
we don't have to code everything
ourselves like the feed-forward
propagation so like or the forward
propagation the back prop the optimizer
the cost function and so on but we might
get into those details in another series
because they are really important if you
want to deeply understand how neural
networks work all right so let's get
going so we're following the code that's
in the artificial intelligence book
which is linked in the description and
in the previous video we've used a
single layer neural network for
classification purposes here we're gonna
use a multi-layer neural net as a
regresar so we're gonna start by
generating some data to train the net on
our data points are based on the
following equation let me write it here
so equation y equals 3x squared plus 5
okay so generating the data points let's
say Manville's
equals 20 or minus 20 maxwell's equals
20 the number of points that we're going
to generate equals 140 and then the
actual generation of data points so
let's say x equals NP linspace min Val's
Maxwell's and non-points all right let's
now actually do our Y so y equals three
times let's say NP square X plus five so
this is actually this equation and then
we're actually going to have to
normalize these points for more
efficient computing this is often done
in pre-processing so let's say y equals
NP linear algebra dot normalize dot Y ok
now let's run this now to actually
create the data set by the book we're
going to reshape this data points so
let's say data ax reshape num points 1
and the same thing for the labels so Y
reshape non points 1 and a little bit of
visualization like we're used to so
we're going to do a scatter plot of data
and of the labels and we're going to
name our PLT X label is gonna be
dimension 1 and our PLT Y label is gonna
be dimension 2 and the title of our plot
is gonna be PLT title data points all
right now shift enter again let me make
some more space here okay so nothing in
the realms of Extraordinary here now
moving on to build the net with neural
lab so we're gonna have two hidden
layers ten neurons in the first hidden
layer and six in the second one
and the tasks the regressor task is to
predict the value which is why we're
gonna have only one neuron in the output
layer so let's say multi-layer neural
network is gonna be in your lab net new
feed forward and it's gonna be nan Val's
Maxwell's for the dimensions okay and
then for ten neurons for the first
hidden layer six neurons for the second
hidden layer and one for the output and
then we're gonna use gradient descent a
training so let's say an L and n dot
trained F equals neural lab trained
trained GD which comes from gradient
descent and then the actual training on
the data so we're going to name it as
we've gotten used to so let's call it
error progress is going to be M Ln the
Train on our data with our labels for
2008 box we're going to show 100 and the
goal of learning is to reach point of 1
now let's run this to see how the actual
training goes
okay it should reach by about fifteen or
sixteen hundred the the goal of learning
Oh even faster so eleven hundred epochs
what we're going to do now is to run our
train net on the data points for
prediction purposes to see how it
actually learned during training so
let's say output equals M L and n so our
multi-layer neural network sim so the
same method on the data and then Y
predict is gonna be output dot reshape
non-points okay now let's plot the
predicted output versus the actual
values so let's call X dance the dance
layer and peel in space then vows vows
max Valles and non points x - okay and
then Y dance predict it's gonna be so
our multi-layer neural network simulate
X dance we're gonna reshape it to X
dance dot size and one and we're gonna
also reshape this one to x dance dot
size and then the actual plotting so PLT
plot the PLT plot x dance y dance
predict we're gonna use a solid line
okay
then x y and we're gonna use a point
marker so point
marker and X and wipe predict here we're
gonna use a Pentagon marker so P and
we're actually gonna title this one PLT
title let's say actual versus predicted
let me make sure everything looks okay
but we'll see if we get any error over
here now shift enter to run it okay so
this is the actual and this is the
predicted training the multi-layer
neural network further thus reducing the
error is going to lead to a convergence
of these two curves the actual and the
predicted okay so a couple of things to
point out now in most machine learning
and deep learning projects you're gonna
have to do some more pre-processing of
your raw data it's not as simple as it
was here and then based on the type of
data you have you'll need to pick a
neural network architecture or model and
do some additional work on the
parameters before training and depending
on how well the training goes you're
also gonna have to tweak these
parameters to optimize the results all
right now in the upcoming tutorial we're
going to look into sequential data with
recurrent neural nets in neural lab so
please like this video and subscribe if
you enjoyed it and if you want to follow
along with the series thank you for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>