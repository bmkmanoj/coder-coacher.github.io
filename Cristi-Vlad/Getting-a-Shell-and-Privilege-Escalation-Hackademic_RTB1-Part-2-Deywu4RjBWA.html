<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Getting a Shell and Privilege Escalation - Hackademic_RTB1 - Part 2 | Coder Coacher - Coaching Coders</title><meta content="Getting a Shell and Privilege Escalation - Hackademic_RTB1 - Part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Cristi-Vlad/">Cristi Vlad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Getting a Shell and Privilege Escalation - Hackademic_RTB1 - Part 2</b></h2><h5 class="post__date">2018-03-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Deywu4RjBWA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so let's resume from where we left off
in the previous video now we have the
users and their logins for the WordPress
dashboard the first one that I tried was
Nick James and I thought that maybe if
his password is admin he's probably the
user with the most privileges in that
the WordPress dashboard and I spent
quite a lot of time there trying to
upload a PHP shell so the next step once
we have the logins for the WordPress
would be to try to upload a PHP shell
and find a way or get away into the
server and I spent quite a lot of time
browsing through Nick James's WordPress
dashboard and I wasn't able to find a
way to find a way to upload a PHP shell
and after about an hour or so I was at a
point where I thought of quitting but
then I thought if if we have the logins
for more than one user why not try and
log in with with each one of them and
see maybe that their dashboard would
have different privileges or different
permissions for WordPress and this is
really one important point that I have
to make so it's always a good idea to
take a few steps back and try different
things when you get stuck because you
might find you might find your
resolution so there's not only one way
in which you could get access into a
server so if you're at a point where you
get stuck try something different
so what I did here was try logging in
with Mac's bar key and the password
kernel and Mac's Bucky's as WordPress
had even fewer privileges than Nick
James so
no luck there but then I got to George
Miller and let's see George Miller which
is the user that I'm logged in right now
has much more privileges or options or
permissions over here so I'd say that
George Miller is more of an admin than
Nick James so I was able to go to the
plugins directory and there were three
plugins there and the one the first two
of them didn't allow for editing PHP
files so editing their PHP but the third
one this textile a1 dot PHP allowed for
for editing the file and we'll just
gonna do that right now so this is the
code to upload a PHP shell and right now
I have to find out what my IP is over
here so if config so is 104 and we'll
connect through port 4 4 4 5 so we'll
set up a net cat LVP 4 4 4 5 and then
we're just gonna update this file ok so
we should have had a shell over here so
0 4 oh yeah right so we have to execute
it so once we have the file updated
we'll have to execute it so we'll just
we'll just browse to this file which is
in the WP content plugins textile 1 dot
PHP I guess this is it and we should
have our shell up and running and there
you have it so we are into the server as
as Apache so once we get into the server
we'll have to go through so the next
step would be to try to escalate our
privileges from the low privileged user
Apache to root so in order for us to
escalate our privileges to root we
should look out for sensitive files and
also for misconfigured services and
permissions which could ease our
privilege escalation and and the first
few vulnerable machines that I went
through I tried doing it manually by
looking into for example the guide from
God milk let's say god milk basic
privilege escalation yeah so this is a
great way to start when you're inside
the server and you want to escalate your
privileges it shows it gives you a very
big list of commands that you can run to
find misconfigured services and
permissions so this is a good manual way
to start but there have been a couple of
scripts that automate this process so
let's say Linux basic let's say prevents
and let's say Python I know there is a
script in Python yes this is the one so
Linux proof checker that'd be why so if
it's always a good way if you don't know
how to do it it's always a good way to
start with these and go through each
command itself and see where it leads
you but once you have done this for a
couple of times
to ease up and to speed up the process
you can simply use one of these scripts
like Linux proof checker and another one
I guess was Unix
Provost check yeah so yeah this one but
we'll use for this purpose you will use
Linux per desk check so we'll just have
to download it onto the server into one
folder in which we have permission to
download so let's first try to escape
this shell with Python minus C import PT
i PT I spawn so will spawn a bin bash
shell okay let's see where we're at so
we're in the plugins directory let's
head over to so I've already done this
let's head over to temp and I downloaded
the privat checker dot py and we
actually will have to execute this file
so let's say Python Linux breathe
checker which will automate the process
that we saw on got milk sis blog and I
think it also includes more more
commands not only those that are on
guard milks is a website but additional
commands to check even for exploits so
dot py and we can just direct this to
let's say out three dot txt so right now
it doesn't display on the screen it
doesn't show the output on the screen
but it actually prints that all the way
to our three dot txt and once we finish
this we'll probably will move
- one of the WordPress directories and
will access it for better visualization
- through the WordPress panel okay so we
can just we can just get it but let's
not get it let's just say move out three
dot txt
- I think let's see let's see what's
inside home let's just get it so cut out
three dot txt we can read it we can also
read it over here so there's a lot of
output in this file we have the system
information which you could have got it
with you name - a and there's a lot of
output over here so you'd probably spend
a lot of time on this going through and
trying what this profess collation
checker gave you but I probably start if
if they give you suggested exploits that
you should try over here so finding
relevant privilege escalation exploit
exploits you should probably start with
them so and you have the links to their
exploit db2 their exploit DB files so I
actually tried quite a few of these and
the first one that I tried was the my
sequel one so these are ranked higher in
probability of success so I figured why
not try why not try why not start with
these ones so I started with this one
user-defined function and local
privilege
scalation let's see what it's all about
so for this exploit you'd have to probe
you'd have to know the username and the
password for the my sequel database the
the password for the root and I tried I
tried this exploit first because while I
was looking through the files on this
server I went to WP config so let me see
let's go to VAR w w let's go to HTML
let's go to academic RT b1
okay and now we have here the WP config
dot PHP let's look at it so we have the
username root and the password for the
my sequel database so if we know that we
can we can use we can try using this
script so we'll just we'll just say my
sequel - u root and the password is this
one and we're actually into the my
sequel as root and right now we can
start executing these commands so after
we've compiled the exploit we'll go to
we'll login on the my sequel database as
root with the password and we'll just
let's say use my sequel so use mine
sequel and then we'll just gonna try to
do all the commands they say in here and
then when we execute these commands it I
kind of got stuck on this command
and I wasn't able to move for forward
because because of some user permission
so I spent at least half an hour here
trying to figure out if there is any
workaround but I wasn't able to so I
couldn't execute this exploit all the
way to the end and as you can see here
when you escape when you get out of the
my sequel database and you can't EMP
that out you'll you'll actually be rude
but anyway so let's get out of let's get
out of the my sequel so let's get back
to TMP and I could just like I said I
could just copy the out file so I'm
three dot txt for better visualization
but this is optional so let's say
account copy and three dot txt to VAR w
w HTML academic or TV 1 w content
uploads let's just copy it to uploads
uploads out three dot txt
so no such file or directory
let's copy to plugins okay so it is
inside plugins so we'll have head over
to to view it inside the browser
so it's an three dot txt okay so it's
easier to understand rather than seeing
it inside the the terminal so as I was
saying I kept trying all these exploits
and none of them worked until I got to
to the RDS one which should be lets say
RDS yeah this one so let's head over to
this exploit okay let's get back to TMP
I think I've downloaded it so it is one
five two eight five let me just read
download it and execute it for for
exemplification purpose let's make
another directory let's say there -
let's get into dirt - and let's download
this one
okay so we'll have to use no check
certificate no check certificate okay so
it downloaded it so we'll check once
again who we are we are Apache then
we're gonna compile it - oh one four two
eight five okay and then we're gonna
give it permission for execution and
then we'll actually execute it and it
should give us route
okay so Who am I
so we are route right now let's go to
the root folder and right here we have
our flag so Kat key dot txt okay so this
is actually the challenge this is the
capture the flag academic RTP one so a
few points to to cover and I'll
reiterate once you're inside the server
if you haven't done privilege escalation
if you've never done it you should try
with and there are also other guides to
provide escalation not only got milk
which is like seven years old at this
time but if you just google local
privilege escalation tutorial you'll
find let's see local privilege
escalation tutorial I think you'll find
quite a few results which are like newer
ones like this one from 2016 so anyway
if you've never done a local privilege
escalation you should try with them
doing it manually and only thereafter to
start using scripts like Linux proof
checker
the other one was UNIX proof check or
prevents check which is this one and
this is I think it's a bash or yeah it's
a shell script so once inside the server
either do it manually or download one of
these provisions collation scripts and
you should download it inside a folder
in which you have permission to download
that so one of the first one that you
should try is the temp one okay and then
when you run the script after you run it
and you get your output like like I did
here probably start with the exploits
they suggest and only thereafter see
what the rest of the output tells you or
suggests you to do okay so I guess this
is it for this capture-the-flag if you
enjoyed this video and you'd like to see
more cybersecurity related videos please
let me know another of the comment
sections below thank you for watching
and I'll see you in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>