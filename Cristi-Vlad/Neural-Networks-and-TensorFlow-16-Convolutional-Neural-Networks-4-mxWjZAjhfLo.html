<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Neural Networks and TensorFlow - 16 - Convolutional Neural Networks - 4 | Coder Coacher - Coaching Coders</title><meta content="Neural Networks and TensorFlow - 16 - Convolutional Neural Networks - 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Cristi-Vlad/">Cristi Vlad</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Neural Networks and TensorFlow - 16 - Convolutional Neural Networks - 4</b></h2><h5 class="post__date">2018-04-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mxWjZAjhfLo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">as we've defined a few helper functions
in the previous video let's now start
building our neural network model in
tensorflow
so as a reminder we'll do a
convolutional neural network which will
apply to the amnesty data set and we're
going to start with creating or
constructing the computational graph so
we're gonna have placeholders for our
inputs and for our labels so since we're
dealing with images we're gonna have x
TF placeholder TF float 32 which is the
data type and shape is gonna be none and
784 784 because of the size of the
images we're dealing with so we have 28
by 28 images Y is gonna be TF
placeholder TF float 32 and the shape is
gonna be none
so none basically means that we can feed
the placeholder as many samples as we
want and we're going to train in batches
of maybe 100 images at once we'll see
when we get to that point and ten for
the number of possible labels so those
are gonna be the digits from 0 to 9
okay now we'll have to reshape the input
so the images will say TF reshape X so
we reshape our X and we're gonna reshape
minus 1 28 28 1 so we have minus 1 okay
so 28 for the size of the image and one
is for the color channel in this case we
use grayscale images so the color
channel is 1 okay now we'll start
building the first convolution using the
previously defined functions like come
to D and
conv layer so but before that I gotta
mention that uh we're gonna be following
the textbook linked in the description
so a big shout out for these examples
goes to Tom Hope which is the author of
the textbook so for inspiring inspiring
these videos
okay so comp 1 is gonna be a
convolutional layer to which we're gonna
pass our X image so our reshaped inputs
of shape equal to 5 5 132 so 5 5 is
gonna be the size of the filter 1 for
the color Channel and 32 for the feature
map
ok now the output of this is going to be
28 by 28 by 32 so we should keep that in
mind okay then once we have the first
convolutional layer we'll have to apply
max pooling to it so we're gonna use the
max pool 2 by 2 so let's say comp 1 pool
is gonna be max pool 2 by 2 to come one
ok so after we apply this type of
pooling the output is going to be 14 by
14 by 32 because the strides were 1/2 to
1 all right so so from 20 by 20 by 32 we
go to 14 by 14 by 32 okay now we'll have
another convolutional there so we'll
call it come to and well actually gonna
do the same thing say come to comm
player and this time the inputs are
going to be what we get from comm one
pool okay and the shape is gonna be 5 by
5 so for our filter 32 for
call our Channel in this case and 64 for
the future maps okay and then the same
thing so okay at this point the size the
output size is 14 by 14 by a 64 now
we're gonna do the same thing so we'll
say come to pool we're gonna have
another max pool to buy to apply to comp
- okay so and now the output becomes 7
by 7 by 64 so from 14 by 14 by 64 we get
to 7 by 7 by 64 which we'll have to
reshape before going to the fully
connected layer so we'll say come to
flat it's gonna be TF reshape come - so
we're reshaping the come to pool and
we're gonna reshape it so minus 1 7
times 7 times 64 okay and then we were
going to construct the fully connected
layer so we actually had to use the
reshape function so that the output of
the second convolutional there would fit
in the input of the first fully
connected one okay so then the fully
connected the first fully connected
layer let me delineate them over here so
the first fully connected layer let's
say for 1 is gonna be TF and
Rayleigh and we're gonna use the full
layer which is a previously defined
function so we'll say full layer full
layer okay and the input is gonna be the
com2 flat comfor - flat
1,024 okay so we have the input and the
size the size is for the weight and bias
I've explained this previously so we
have the input and the size and the size
is gonna be used and defining the weight
and the bias okay and what we also have
to do is to define the keep probe or the
key probability which is the dropout
rate for for the training
so we'll say keep prop equals TF
placeholder TF and this is gonna be of
data type TF float 32 32 okay
TF so TN float 32 keep prob
and then we'll just apply the drop out
so we have to apply the drop out before
getting into the output layer so we'll
say full one drop it's gonna be TF and
then drop out so we're gonna use the
drop out method from tensorflow and
we're gonna use we're gonna pass it the
full one okay and we'll say keep prop
equals keep prop this basically means
that whenever we start executing the
graph we'll have a defined keep prop and
we'll use that keep prop
whatever that is probably it may be 0.5
or
1 okay and then ultimately we have the
output so the output layer Y kampf is
gonna be full so it's gonna be another
full there so it's gonna take full one
drop and ten so the full layer takes the
input and the size so the input in this
case is gonna be full one drop and the
size is gonna be 10 so for our 10
possible outputs okay so I guess that's
it for now so remember this is only for
constructing the computational graph now
for training we need to create a session
instantiate or initialize these
variables feeding data and execute the
graph we'll stop here with this and in
the next lesson we're gonna instantiate
the data set and proceed to training the
convolutional neural network if you
enjoyed this video please give it a
thumbs up and subscribe thank you for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>