<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP Build  a social network - Image Upload | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP Build  a social network - Image Upload - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP Build  a social network - Image Upload</b></h2><h5 class="post__date">2016-03-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cwB-H7wJItc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey welcome back so the last video we
set up our account whew
now it's time to well enable us to
actually change well the name you're
saved as and of course upload the file
and display it here sill
let's start by well just changing the
name because it's very simple part right
in my routes file here I'm using this
post safe account action here in my user
control notice action this function
doesn't exist yet
so I will create it public function then
post update user turn my brains not that
good today post post save account
well close post save account and here we
will get a request so let's just inject
it here and the first we're going to do
as always when we're getting data from a
forum is we're validating it so I will
call the validate method pasty request
and well define my rules now the only
rule I want to have here is that my
first name that is the name of the input
field in the account later PHP file well
this first name it should be required
and should be no longer than 120
characters because that is the rule we
have here when we're creating a user so
we shouldn't change it here right so
that's the validation um the next thing
is I want you to retrieve my current
user and I can again use the office a to
do so so I will set a first name by
typing first name and then we'll
assigning the first name passed into
this function through the request so
what we were entering whatever you enter
the form I can already whoops I can
already then save the user or updated
important use update not safe because
we're not creating a new one we're
overriding the old one so you can do
this anyway next thing is I want you
well upload the file but only if there
is a file of course so I start by
getting the file from the request I can
do this by using my request of trickier
which when checked akin to this method
and here I will call the file method now
in this file method I specify the name
of the file and this is image because I
will show you in the account to apply to
PHP file I I set a name of image to this
input field to despoil input field here
so this is the name of using here in
this image name and the next thing is
I'm going to set a file name now this
file name will always be the first name
of the user let's say then we want to
have a dash and then we want to have the
ID of the user so that we've got a
unique file name of course we could also
only use the ID but I think it's a nicer
phylum if you have some extra actual
text in it therefore I'll choose the
name as well and then we need the
extension and I will only allow
shaping's here I will always set us to
shape it because I know I'm only getting
JPEGs because I'm saying this in the
form now obviously you could upload
whatever you want you could upload PDFs
P and G's JPEGs and I'm not doing any
checks here so obviously implementing
such checks would be a great is great
idea and is of course doable allowable
now here I only want to show you how to
upload store and fetch the file
therefore I'm making this simple and I'm
just using this jpg extension here so
then I want to check if well actually a
file was retrieved from the request so
here we're getting the file now I'm
checking out well we did actually get
thing if this is the case then I want to
store it I use the storage who say for
this make sure to use it to use
illuminate support facade storage here
the storage has saved is a helper like
all of the sales level which allows us
to access levels powerful storage engine
now this engine is quite complex if you
want it to be soon
and it basically allows us to store
files of any kind on our file system on
our yeah on our server so to say we can
configure it as storage here in our
config folder in the file system dot PHP
file the default configuration is five
for us you but you can set up different
drivers for let's say if you want to use
external storage on Amazon s3 or we can
set up different drivers for our server
here change the storage path by default
it is app here in this storage folder
but if we create a new folder here then
we would have to change this app to the
new folder name if we want to use that
and so on so this is a really powerful
engine allowing us a lot of
customization and yet it can really set
up do we want to store it external in a
cloud or on our server and so on now
from the storage for Sayed we can easily
then access all these settings and store
files in a very natural way in a very
intuitive way without having to worry
about ok which folder do we have to
access on which older are we currently
and so on so all they do here is well we
first say which disk do we want to use
it will make the local disk and disk if
we go back to the conflict fun just
refers to this area to disks area now
here we set the local disk FTP does TS
free disk and as you can see the local
disk is actually local on our server it
has the local driver and you
this app storage folder we could also
use the s3 disk - well here's Amazon s3
if you have of course provided your
setup details here okay so this is the
storage we're saying first okay which
disk do we want to use so which
filesystem where do we want to store the
files in this case local and then we
just say ok put because we want to put a
file there and what do we want to put a
final name should be the the name of the
file should get we could also have some
subfolders in our filing so if we have
in our app store let's say a folder for
each user we don't have to change this
now in config here and create a new disk
- well let's say it routes to this user
because you might not even know the
users if you dynamically create those
folders right in this case we can also
in our file names just include and you
folder by while adding just a slash now
obviously this whole area has to exist
but in theory we can do this now here
I'm saving everything in the root folder
now if you want to know more about
storage and lateral file system I'll
attach the link to the very useful
documentation in the description so this
is and we put it but we're only
specifying filing so far we also need to
say which file to put now we can't use
file here what we will have uses file
and this is again of say we're using
here so make sure you're using this file
for Sayed and then get file so this will
store the actual file it's just a helper
method basically transforming this in a
format and doing all the stuff in the
background that level is easy be able to
put this file where you want it to be so
that was a lot of talking but that's
very important to understand but
and with this command we're storing our
files the level storage engine in the
destination we specified in the fastest
config and if we did so in any
subfolders for specifying the filing now
the last thing I want to do is I want to
return a redirect to the account road so
that we reload our account page so this
will store the file and now there is one
last thing required now we're storing
the file but we won't be able to see it
to do so to be able to see it we have to
make sure that we're providing this
relative this account image Road where
we then actually retrieving this file
because we can't provide a direct link
to the storage folder it's protected by
default it's not like our CSS or
JavaScript folders in the public folder
it's in storage folder in this folder is
not accessible by the public therefore
we need to separate routes to access
this file I will create this route and I
will just recreate it down here right
below the update account broad route get
and this will be user image oops
image and then slash file name because
we're specifying which father want to
retrieve when accessing this route then
again I will use a controller here
through controller and here we'll use to
get user image action now this trouble
of course also have a name and the name
should account dot image okay the last
part is in our user controller file add
a new function public function get user
image and we'll have to file them as an
argument passed into this function and
here
I will get this file again through
storage system so I will just access
disk local
yet
and then the filename this is how we get
a file and we know it exists because
we're only executing this route in our
view here if we found it in our storage
ruby has method here so again we're
using our local disk here with the
storage has saved and with has we're
just checking if this file exists we're
not getting it we're just checking if it
exists if it does exist well then we can
get it through this function here and
all I do here is I will return a new
response here and this response will be
our file and status code 200 now why am
I'm not returning a new route or a
redirect because this route is accessed
through this source attribute so we
don't want to redirect to any page here
we want to provide the actual file here
the link to that file and we're doing
this by returning this as a response in
our user controller just a file as pure
response and this response can be
handled because the route is called by
our image element which wants to have an
image file right so let me save this and
I'll reload this account page and I will
upload an image of myself safe account
now obviously we gathered arrow here
let's let's see what it is okay
important arrow here if using this
response here I also need to import it
so make sure you use luminate HTTP
response now let me save just a little
note and now you can see BOM Here I am
here is my image and it should work for
YouTube so this is how we do file upload
through the storage system level
obviously the basics only support how we
can well upload a user image and how we
can change your account see you in the
next videos bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>