<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Channel Analytics in Excel – Finishing our Input Section | Coder Coacher - Coaching Coders</title><meta content="Channel Analytics in Excel – Finishing our Input Section - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Channel Analytics in Excel – Finishing our Input Section</b></h2><h5 class="post__date">2017-04-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GTUPO2_OFBU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome back to the series in
this video we will finish the input
summary sheet that we created last time
and that you can see right here and we
will do this using some formulas now
before we start let's have a look on how
exactly we are going to do this so this
is what we just saw we have that input
summary sheet with the row names which
is basically a list of all the countries
we have statistics for without any
public heads and we have that column
names which are basically the statistics
so like views watch time in minutes
and so on in each of the columns we have
so what we want to do today is we want
to retrieve results and we want to do
this with one single formula this
formula must be able to do three things
the first thing is we want to be able to
identify the country name in that input
summary sheet and find that name in one
of the input sheets now I'll come back
to that input sheet and which input
sheet that should be in a few seconds as
a second step we want to be able to
identify the column names so we want to
define which statistic should be
retrieved from the input sheet and third
thing and now I'm coming to that input
sheet that we want to retrieve the data
from we want to create a sheet reference
in an input cell so this means we want
to be able to have a cell in which we
can write the sheet reference so that
the formula knows it should look for the
country and a statistic in the sheet
that we want in that case that would be
the January to June 2016 sheet sort of
first period as soon as we finish that
formula and that first table we will
copy down the table two times so because
we have three periods we need three
tables of course in these tables the
period would be wrong sort of sheet
reference this means the last step will
be to change that sheet reference and
the period to the correct periods now
this is a lot of work but as you can see
this will be a bigger formula but as you
will see we will create that formula
step by step so it's quite easy in the
end actually now time to start and time
to
how this works now back in Excel and
back where we stopped last time let me
first write a direct link to the first
input sheet to see what result we want
to retrieve and to check if we will
build the correct formula in the next
minutes so I'm in cell c2 and write
equals go to the first input sheet and
also to cell c2 now this 4 6 3 to a 2
this is the value we want to have with
another formula now now I just cut that
by pressing ctrl X and pasting the value
right here we will delete that later
it's just for us to see if we build the
formula correctly and now I go back to
cell c2 now remember what we just talked
about a few minutes ago we want a
formula which can do three things let's
start with the first thing or the first
two things actually we want to be able
to find the country and the statistic in
the first input sheet to do this we will
use the index match formula now what is
the index match formula the index match
formula is a combined formula it's a
combination of an index formula and the
match for me obviously so the index
parts are the first part of the formula
retrieves the result so that value in
the end that we want to have the match
part is responsible to identify the
country in our case so it will find the
United States in the input sheet and as
soon as it found the United States it
can find the corresponding statistic
with that index part now while I'm
telling you that you see that this is
kind of the wrong way at least in my
opinion to be honest because it would
make more sense to me to start with the
match part so to tell the formula but it
should look for and then to write the
index part so the part that retrieves
the value on this is why I will start
with the match part right now and as
soon as we finish the match formula I
will put the index formula in front of
the match formula so that in the end
it's an index match formula but we start
with the match because it's more
intuitive that's at least what I think
maybe you share this opinion now after
telling you that let's write that
formula so I'm in cell c2 still typing
equals
match well I'm not writing match I'm
writing ma and you can see that a menu
or a little table opens this is a good
function of Excel because if you now use
the arrow keys on the keyboard like down
or up you can select the formula you
want in our case we want to match
formula so we could now write m80 CH or
we could simply click that formula or
and that's what I always do
simply press tab on the keyboard as you
can see Excel automatically completes
the formula and opens the first bracket
for you and if you have to write a lot
of formulas this is really a great help
a little help but a good help as we now
have that match formula it's time to
define the lookup value as we can see
right here actually the lookup value in
our case is either the country name or
the country ID as both columns are
unique so we have each country and the
corresponding country ID only once we
can decide what we want so I will use
the country ID because it's shorter as
soon as we got the country ID we have to
write a comma or a semicolon this
depends on your Excel settings so in my
case it's a comma now we have to define
the lookup array the lookup array is
basically the area where Excel should
look for this country ID we will start
with the first input sheet so the first
period and the column B which is also
the country D so what we're doing right
here is we tell Excel find us in the
generally June 2016 sheet that's
everything for the moment and I can
select the entire column because again
we only have unique values in that
column so if you would have public hits
in here this wouldn't work because Excel
would simply match the first country ID
it finds so if US is in the second row
and in the fifth row you will have wrong
results in the end so be careful about
that in our case this is possible
because we have that unique values in
column B so it's fine another common now
we simply have to define the match type
in our case it's simply an exact match
because we really want to find us and
nothing close to that
let's close the bracket and now we have
to write the index formula and as I said
the formula is called index match so we
have to write index in front of the
match part so I'm simply clicking right
here writing IND and again pressing tab
to start the formula now the only thing
we have to do not the only thing let's
first click and hold the left mouse
button to drag that box to the right to
see what we actually want to select and
here I will now select column C because
you can see that we are now identified
the area the results should be retrieved
from in our case this is about seven
minutes because that's the first
statistic that we want now we will
change that soon don't worry but for the
moment this is how we can do that now we
write another comma and press ENTER two
times so one time and the second time to
let Excel automatically complete the
brackets which is a nice little help so
I'm pressing enter again and as we can
see we have the same value as with the
direct link we put here into that cell
before now this is nice right we can now
dynamically retrieve the data and if we
copy that formula down or to the right
it would get those data as we want it
but is that already what we want to have
remember the three things you want to
have we want to be able to identify the
country and to define the column and to
define the sheet reference we got the
country the column is still inside that
formula so we cannot define anything and
the sheet reference is also inside that
formula so we are not there yet so we
have to add something else and before we
add that formula let's add a row and a
column because in the row we will write
that column reference in the end and
into the column right here we will write
that sheet reference now let's just do
that so that you can see what we want to
do here so I'm clicking into the first
column and now I'm pressing ctrl+
this simply enters a new column and we
can do the same thing in the first row
by selecting the first row and pressing
ctrl+ again now as we got that we have
to think about another formula or not
another formula an additional formula
actually because the thing we have right
here this is good it's just not complete
so as we want to be able to refer to
other cells which include the real
references so the sheet name and the
column reference we can use an indirect
formula because the indirect formula
simply can do that it allows us to refer
to sheets or cells in other cells as
long as those cells you refer to include
those sheet names or column references
now this sounds a little bit complicated
maybe but let's just write it in direct
formula step by step and then you will
see again this is actually not that
difficult so let's do this so the index
part is fine we need to start changing
the formula after the first bracket and
the first thing you will see is that
there is that single quotation mark and
we will come back to that in a few
seconds let me first write that in
direct formula so I and D so we can now
press the down arrow key and press tab
now we already got the indirect formula
or at least the beginning of the formula
to be honest and now we have the single
quotation mark I just talked about why
is this here well if you look at the
sheet reference we have you see that
this sheet name includes non
alphabetical values so these little
dashes basically the same thing would
happen if this sheet name would impute
spaces as soon as something like this
happens
so non-alphabetical values or spaces
excel automatically writes those single
quotation marks it's just how it is
actually and it's not a problem the only
thing you have to know right here is
that you have to include those
simulation marks in your indirect
formula and you can simply do that by
Framing those single quotation marks
with normal quotation marks like this
and like that now this is the first part
of the formula so that single quotation
mark now we can combine that with our
sheet reference by writing and
this end is by the way also great if you
want to combine two cells for instance
in Excel but that's just a side note
actually so now we have that end and we
have that sheet reference in the formula
let's just select that sheet reference
and press control X to cut that out
so that you can paste it in a few
seconds and now change that reference we
had before so that on that name actually
that was in the formula to a cell
reference and this should be a cell a3
so in cell a3 we will copy or we will
paste the name which has cut out in a
few seconds that is the first part now
we have a dynamic cell which allows us
to refer to the sheet that we want you
let's just complete that by writing
another end now you see another single
quotation mark you just learned what
that is and we have an exclamation mark
the exclamation mark is simply the
combination of the sheet name and the
cell reference in Excel this is also
something set automatically so the only
thing you have to know right now is that
you have to keep that and how do we keep
those things
well we again frame them with a normal
quotation mark or with two normal
quotation marks so first one and second
one so now the sheet reference and this
connection between the sheet name and
the cell is complete we can now write
another end to combine that and now you
see a problem not a problem actually but
something that's not really reasonable
because indirect now expects a cell
reference in the entire column C and
this obviously doesn't make a lot of
sense so what we should do right here is
we should delete that C so that column C
reference and refer to cell d1 right
here let me just drag that to the right
so that you can see that right here now
in this cell we will write C C in a few
seconds it's the same logic we just had
with the sheet name just with the cell
right now this is how indirect works
actually and you will see that this is
really great
let's finish that formula by writing the
second bracket now this looks correct so
we can now press ENTER and we get a
referal now if you follow that formula
you probably know why this is happening
we have to add the sheet name and the
cell reference of course so let's go to
sell a free press ctrl V + Enter to
paste the sheet name and increase the
column width with a double click right
here now we have still a ref error but
we simply have to correct that with the
cell reference so this was C C and now
we see that we have the same value as
with the direct link so we made a great
progress right now we can define the
sheet name and the column reference so
if we change C C to D D for instance
then it will retrieve two views no we
don't want that here of course but it
just allows us to do that more
dynamically and this is what you want
now let's first complete that formula
because the index part is fine but the
match part still contains that sheet
reference and after we did that let's
have another look at the formula so I
will select the indirect part we just
wrote because this is still correct and
copied until the third and so ctrl Z now
we select that part right here you see
how far I select the formula because
that BB well we have to have a look at
that and press ctrl V to paste that in
the Reg part and now you see the same
thing we had in the index part in direct
now expects a cell reference in column B
again this doesn't make a lot of sense
but there is a difference when comparing
it to the index part in the index part
we made that dynamic reference because
we know that the columns to retrieve the
statistics from might change depending
on the statistic you want to have in
that case we always want to refer to the
same column so the country D this is the
country name here by the way because we
inserted that column to the left so
another is about that we still want to
find the country ID as you
right here in Colombia in one of the
input sheets so what we can do right
here is we can simply write this B be in
quotation marks and this means that
indirect will now look for the country
ID so on this part right here in column
B of the corresponding sheet that we
define and this is exactly what we want
to have so this means that our indirect
formula is now almost complete we need
to make the bracket of course now press
ENTER and we see that it works perfectly
and to show you how perfectly this works
let's simply change that part so the
sheet reference to the July to December
reference for instance and see if it
would reach the right value so I'm
writing July to December 16 now let's
see what happens
oh sorry for scrolling down now we have
that nine seven nine nine four one let's
remember that nine seven nine nine four
one so this is how it works and to be
honest I really like that because this
is now a really dynamic way on how we
can retrieve the data and yeah that's
more like it we can now change that back
to the January to June 2016 data so we
got that and now let's have a look at
that index in direct formula that we
created one thing I'm not liking at the
moment is that if we copy that formula
down right now and there are other
issues I'll come to those issues in a
few minutes and if we copy that formula
down now then we have countries netlist
for which we don't have data for in the
first period because you remember this
is a list of all the countries we have
data for in either one or all of the
periods we consider so if we copy down
we would get an error and this is not
nice so we should change that because if
we just assume that if this country is
not in the list there should be a zero
right because if it's on the list then
there is zero of use zero likes and so
on so what I want to do is if this
formula results in an error
I want this formula to return a zero and
actually I just said the formula we will
write an if error formula this formula
will exactly
what I just said so if this results in
an error it will return zero let's see
how we can write that so I right if
arrow in front of the current formula we
created go down press tab now this is
the value so the whole index in direct
match formula go to the end of the
formula press comma and now define the
value that should be retrieved if we
have an arrow here and this is simply
zero so I'm pressing enter again well
sorry I didn't close the bracket as you
can see here in the end so let's do that
now it's fine of course nothing changed
right here because we have data for the
United States but you will see when we
copy the formula down in a few minutes
then we have some zeros so let's now go
for the de formula and see if we have to
fix any references now this simply means
if we press f2 now to jump into the
formula we see that if we copy that
formula down for instance then the
reference for a free so the sheet name
would change and this means the formula
would not work anymore let's just try
that so if I press shift and hit on
arrow key and control D then we have
zero yes because we wrote that if error
but in this case this if arrow is wrong
because we have data for that and so we
have to fix that reference and we have
to fix the row reference for our cell
reference lots of references here at the
moment so let's go back and see how we
have to change that so I'm pressing f2
again and then we go to a 3mm
a three should not change at all if we
copy down or to the right it should
always refer to sell a free now let's
press f4 once and if you look at the
reference now you see that we have those
dollar signs in front of the column
reference so da and in front of the row
reference so the free now this means
that neither the row nor the column will
change if we copy the formula to the
left to the top to the right to the
bottom so this is what we want to have
let's do the same thing for the second
a3 right here so I'm selecting it and
press f4 and now the sheet reference is
fine let's now have look
the references for the country ID so in
the match part and here we can see that
the formula should be able to go down so
if we copy the formula down it should
select the next country but it shouldn't
move to the right so if you copy the
formula to the right to retrieve other
statistics it should remain in column C
this means I'm pressing f4 once twice
and the third time because now the
column is fixed this is also good let's
now have a look at the cell reference
finally and this is right here again put
that to that area and now we see that
here we have well it's like the other
way around we had it just for the
country ID we want to fix the row
because if we copy the formula down it
should remain right here but if we copy
to the right it should move to the next
column so I'm pressing f4 once twice now
this looks fine so let's press ENTER and
we see that nothing changed but things
will change now because now we can
finally copy that formula down and
complete the first table let's do that
so I present hold the shift key press
the down arrow key and scroll down to
the last country we have in our list
this should be right here now I keep
shift pressed and go to the right I
think it was column I right I'm not sure
now we will see in a few seconds now I
stopped pressing shift and press control
D to copy the formula down and control R
to copy the formula to the right and now
we see that we have lots of zeros in
here but this makes sense because well
we didn't complete the cell reference up
here so let's do that quickly so this is
d e oh sorry e f g e again sorry and H
now this is fine and now we completed
our first table we now retrieve the data
totally dynamic with that great formula
we built mmm the only problem we have is
that if we copy the table down now the
references would be wrong because what
we just fixed like for instance the
sheet reference
is totally fine for that structure which
was created but if you copy that whole
structure down then the sheet reference
has to change and so jump down to the
next table so that you're able to define
another period for that sheet reference
as this is not working at the moment we
have to go into the formulas one less
time to change that now
let's do that and let's first delete
that little helper we have because we
don't need it anymore so let's select
all the formulas so I'm pressing shift
ctrl and the right arrow key and the
down arrow key and now comes ctrl H
which is defined and replace function
and this is really what we need right
here
because we want to find dollar a dollar
free and I'm writing that because if it
would just write something like a then
it would also change the a in match for
instance so we don't want that and we
want to replace this dollar a dollar
free thing with dollar a free because
this means that the column is still
fixed which is fine so not a problem
with that but the row is dynamic or can
change and this is what we want so let's
press replace all now we see that Excel
replaced all of the values and we see
that the formula still seems to work so
this is fine and now we have to do the
same thing for the country name because
this is not fixed and it's not the same
thing as I just saw it's the other way
around
so we unfixed a free and we have to fix
the row for that reference because same
logic the list we have right here is a
unique list or a list we created so this
reference is not allowed to change
because if this changes then the country
list is wrong also something we don't
want so let's press shift ctrl + E down
arrow key and press ctrl H and now we
don't want to replace a free we want to
replace exclamation mark a again why not
writing exclamation mark a year if we
don't write that then we would replace
that a in January not good because then
the formula doesn't work anymore so this
is why you can always
things like that easily by including
that exclamation mark for instance now
we want to replace that exclamation mark
a with exclamation mark a and a dollar
sign because then we will fix the role
and that's what we want so I'm pressing
replace all now and we see that Excel
mate 216 replacements so this is the
amount of countries we have and as this
is a link to the input sheets we can now
simply press and hold shift press the
right arrow key and press ctrl R and now
we also copied that fixed row to the
column IDs to the country IDs so let's
go back to here and now it's finally
time to copy down the table two times
you remember in the beginning that's
what we actually wanted to do so I'm not
selecting cell i3 press shift ctrl and
down key press shift ctrl or keep it
pressed actually the left arrow key ctrl
Z now I will select cell a 219 because
it should be a list without any blank
rows press ctrl V scroll down to the end
of that table select a 4 3 5 press ctrl
V now we got that now let's see if it
works still so I'm selecting the sheet
reference of the third table so the last
period which is January to February 7 17
and we see that the values changed now
let's see if this is the correct one
let's select Canada for instance so for
200 for 8 Canada for 2 / 8 + 96
subscribers let's see if that's also
correct yes so this seems to work really
great now I'm selecting a 4 3 5 press
and hold ctrl and press the up arrow key
to change the reference of the second
table and this is July to December 16
this also seems to work we can check the
quickly India 2-6 7-6 for instance let's
see choose
seven six subscribers really great so
this is it right now we finished our
input summary sheet and we created that
dynamic combined formula now this is
really great because we can now build
our analysis part and we will do that in
the next video so thanks for watching
and see you then
bye bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>