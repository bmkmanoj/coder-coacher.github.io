<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP Build  a social network - Likes &amp; Dislikes (1/3 - Models &amp; AJAX) | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP Build  a social network - Likes &amp; Dislikes (1/3 - Models &amp; AJAX) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP Build  a social network - Likes &amp; Dislikes (1/3 - Models &amp; AJAX)</b></h2><h5 class="post__date">2016-03-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/y5qZJ7sYN88" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi everyone welcome back to the next
part of the level
serious so where are we currently
currently we are let me reload here on
the page dad while we get our post you
can create posts edit them delete them
and so on we got these like and dislike
buttons and oh nothing's happening here
that's not the best so maybe we should
do something here that we can actually
like and dislike posts I think it's fine
if we are able to like just like our own
post so leave that in but yeah the
channel functionality should be there so
in order to do this um there will be a
couple of things to do let's go to the
project I'm at in the dashboard view
here and I want you highlight one thing
are already prepared which is important
because yeah I had to do it for for this
section here basically over this video
the next videos right now in your
project you probably have VAR URL here
at the bottom in the script tags of the
stash board for you I change this URL
add it and the app dot JS file I get rid
of this I also changed it here I'm
passing your added no longer URL I'm
doing this because soon we'll have
multiple URLs for the like functionality
as well as the added functionality here
therefore I had to well separate them or
create individual variables unique
variables okay so that's the first thing
you have to do to set this up and with
that we're ready to go now let's think
about what we're what we want to achieve
I want to have two functionality where
users can like or dislike a post and
that is different to Facebook for
example where you can only like aurilla
nowadays also happy number emotions but
there is no minus one or dislike button
can
live things that will be different here
we can like or dislike so we need a
table which will store let's say the
idea of the post which is liked or
disliked the idea of the user who did
this and as a third column well if it is
alike or it is like so let's say boolean
where one is like and zero or false is a
dislike so this will be the table we
need and then we need to be able to well
figure out if the user has actually
already liked this and if you then
clicks I don't like this anymore we have
to remove this like but that it's not
the same as if he clicks I dislike this
then we would have to remove the like or
just change it into a dislike so you see
the difference there I hope so okay that
is a bit complex but we will be able to
do it
oh also I want to achieve all this again
with Ajax calls so that if I click on
like or dislike here
I will not what send a request and
reload the page here but I will all do
this in a background I will send an ajax
request and if this is successful I will
then interact with Dom here and change
it without reloading the page like we
did when editing a post let's start with
well the migration files with the files
or that the database setup I will create
them with the artisan command and as you
can see I set up my project here or I my
my tables a few seconds ago before I
started this video because of course I
tried out everything I am going to teach
you here before and ever had to roll
back everything now so first thing is I
want you create a new model so make
model which is a call like and I add - M
- also create a migration file
okay so it just works and now in my
migrations fuller I get this new file
here and I want to add three columns the
first is an integer which holds let's
say the use ready so the user who liked
or disliked the next comes all the
integer but it will be the post ID oops
lower case I and the last thing will be
as I said a boolean which says let's
call it just like and if this is true it
is alike and if it is false it is a
dislike so this is one way to do it you
could of course also use this as a
string where you actually write like or
dislike or whatever just a way to
determine if it is a like or dislike so
this is my migration file and I will run
this right now or it isn't migrate so
now this table is created or exists the
database and then I have to like model
file now here I want to set up all the
relations I have to relations because I
like has let's say belongs to a post and
belongs to a user each individual like
or dislike is done by one user and by
and under this well mentor is attached
to one post so the first relation I will
name it user is which user gave dislike
or dislike so here I will then return
this and then belongs to because Avocet
this light belongs to one huge user so
app user is the model and the second
relation is pretty much the same but now
it's post and I have returned this
belongs to and then I have well app
this is from the few of the like now
let's go to the post model and define
well the other few so to say so here I
have public function likes and now it's
plural because when post can have
multiple likes not only one one light
can only be attached to one post but one
post kind of mud likes so here I will
return the oops dollar sign this has
many app like and I will just copy this
because it's basically the same for the
user here we will also have has many up
likes it's it's the same function
because one user can like multiple posts
so we can have multiple likes therefore
he has many likes potentially at least
so this is how we set up the relations
so now we have the table and database we
have the relations set up and this is
the first things these are the first
things I want to do in the backend now
let's leave it like this for the moment
and focus on the HX call so to do this I
will give to my dashboard view here and
I want to hook up these two links to
events which are fired when I click on
them basically therefore and we'll give
them CSS classes here which I will just
go like both will have this like class
or no like and dislike because both have
to do with the liking action so now this
is like and now in my app dot J's file I
will add a new well jQuery statements
here to say a new event handler with
jQuery where I will well kind of listen
on all elements with like
CSS class and then on a click on such
element I will execute this function
here and this function will pass and
well the event so here I then want to
say console.log and then just you know
let's output event for example let me
save this and reload this page and now I
went to open up my dev tools and click
on like and dislike and as you can see
we get two events here which will hold
all kind of information about the you
Enzo and what we clicked and so on so
for example here the target which was
this anchor with like in it so that's a
yeah that is how we listen to that event
so with that I'm getting you went now I
want to determine if we clicked on a
like or dislike button now one thing of
course would beat you not use the same
CSS class but named as dislike and then
lesson to do differently whens by just
adding well by just copying this and
listening for let's say dislike here to
would be one way now I think we get all
the information we need and there again
will be a couple of ways you can find
out if you're clicking on like or
dislike but I will make it very easier I
know that the like button is the very
first of the two lengths here and
dislike us a second
therefore we got this previous element
sibling property on our event target and
I will just check if that is null then I
know there is no previous element on a
sibling level and then we have to be
well on the like button because this
element is a this anchor element doesn't
have a previous sibling or a previous
element sibling because it's a first
element in this note in this div
here the dislike anchor tag on the
opposite side has a previous element
sibling namely this anchor tag so I will
use this to find out on which I clicked
so I can just like well find it out like
you're here let's say I have a variable
is like and I will just check if you
went target previous element sibling is
null if that is the case then I know it
is like so then I have true otherwise I
have false and then I can just output is
like here so let me save this reload
scroll to the bottom here let's just
clear a console like true dislike false
so this works now of course I can as I'm
already doing a boolean check your
simplify this and just remove the latter
part so now there's a student the same
let me just prove that to you quick so
same result as before so now I know if I
have a like or a dislike event next
thing is I want to send this a checks
request right okay one more thing before
I do this I will prevent the default for
this event that's important and then I
want you well sent ehx requests so here
I will use the jQuery HX function which
takes a JavaScript object to configure
it and I will have letter data the
method first this will be a post request
I will have a URL we'll have to see what
we use there and it will have some data
now what do I want to pass well I want
to pass if it is a like' or dislike'
action we're taking here because like
here with the event listener
the backend we will use one single route
and we will pass as a parameter if it is
a like' or dislike' action therefore I
will well just pass is like parameter
here and I can't just use is like the
variable I created up here next thing is
I will need the post ID so that I know
which post was liked let's see how we
get that I'll just add three dots and
token and we already got that set up in
my dashboard down here we get this token
now that we're here I can use this URL
here but this will not be the URL added
but you are alike and should lead to the
like route which we haven't set up yet
but we'll do you shortly
so this is my like URL which I will use
here as a URL so URL like last thing is
the post ID well we had the same problem
when when editing the post so all I do
is I just copy that code here and reuse
this to get the post ID because remember
before in the edit well part we were
clicking on added here and this is on
the same level as like links it's just
indented because of that if statement
but it's on the same level in the dome
so therefore I can well use the same
traversal so to say to get the posted II
which is attached to the article element
if you remember that from the specific
video so therefore I get this post ID
here and I can just pass it so now the
HX call is configured and I will of
course also have a done callback which
should be executed
cause as I said I want you to document
without reloading the page and this will
be done here change the page so this is
the basic setup for now in the next
video we'll all setup the route because
currently this will throw an error
because well this route this light road
here is not setup Waldo does the next
video and if you want to test it without
an error by the way just replace it with
added for a moment and we will of course
also take care about editing our
document when we successfully liked or
disliked it see you in the next video
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>