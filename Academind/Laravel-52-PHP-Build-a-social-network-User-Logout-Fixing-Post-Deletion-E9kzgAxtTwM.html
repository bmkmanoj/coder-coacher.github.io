<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP Build  a social network - User Logout &amp; Fixing Post Deletion | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP Build  a social network - User Logout &amp; Fixing Post Deletion - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP Build  a social network - User Logout &amp; Fixing Post Deletion</b></h2><h5 class="post__date">2016-02-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/E9kzgAxtTwM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi everyone welcome back to a new video
in our laravel series we finished when
we were able to delete posts
unfortunately also posts of our people
so let's work on that first I'm already
locked in here I want to create a new
post therefore it would be cool if I
could log in as someone else therefore
it would be cool if I could lock out
so let's implement that for it to begin
with I'll start in my user controller
here where I will add a new function at
the bottom which we call well log out
get logout inside this function I will
have a very complex expression or a very
complex code and watch closely to get
this right we use of logout so that's
all we're logging out using this off the
side which we're importing here at the
top and done this will log out the
currently locked end user now all that
is left to do is add a redirect to get
us well let's say to our home page so
next thing is I want to add a route I
will do this right here below the sign
in route and there's a gap Road just log
out which will use a controller
obviously since which has created a
method not just users and then what will
I use what will the user controller add
get logout this will be used and then
here we use this as logout this will be
the name of our around next thing is and
my header I want to include it and I
will include it here and the easiest way
to do that is to well head over to
bootstrap here under components navbar
I'm making this very easier I'm just
going to copy which one we want this
part here just going to copy this part
to position it at the right of our
header copy this into it
here I don't need to drop down all I
need is one single link which will say
logout and which will will use our fresh
created route or newly created route
called logout okay let me save to this
close this and reload here now we got
our logout menu item here let me click
this and now unlocked out now I'm going
to log in as someone else I don't know
what is this password Chris yeah and I'm
just creating a post as to someone and
now we got mixed posts and now it should
only be able to delete well this post by
me by Chris and not by the other people
I see we should maybe also change the
sorting of the post to have the most
recent post at the top let's quickly
implement that so in the post controller
where we get all our posts all I do here
is when I get all posts here I'll change
this I'll not get all I will first call
ordered by not may well order by and
then we have by created add it should be
order descending so this is how we were
you're descending we specify by what you
feel do we want to order and then we can
either enter desc
descending or ask for s ending here and
then we just use get to get all the
elements matching well the conditions we
define before the select could select
part class you but we're don't have any
therefore we select all the items but we
order them we can't use all anymore
because what we added something to this
query polar here no let me reload them
now we should see that Chris posts at
the top anyway that's just a little
fine-tuning here what I want to do is I
want to first remove this buttons here
if I'm not max in this case and second I
also want to make sure to check that if
I hit delete if I'm the user logged in
because even if I
the buttons I might still be able to
well query that route or to try to
target that route via a terminal or by
directly entering URL appear so we have
to make sure we're safe in the backend
as well as in front-end so to say now to
begin with with I will start in my post
controller here in my post controller
here I will check if the user of this
post equals the user who is currently
logged in if this is not the case then I
don't really want to delete the post so
therefore I'm doing this right below
this post variable where we fetch our
post and then I want to retrieve the
currently logged in user
I do displays in the office aid so make
sure you're importing that at the top
and here I access the user method to
retrieve the currently logged in user
and then I check if this is not equal to
well the user of the post which you can
retrieve by using this user property
since we set up this relation if you
remember the last videos if there is
users do not match and I want to return
a redirect back so I don't want it to
lead I'm not continuing here and yeah we
could provide a message here an error
message but if we get here even though
we deleted the buttons on the front page
probably you've done something fishy
already so I don't think we need to
provide the best user experience here
but you might add as a message and
output it so now we technically can't
delete users if you're not the same user
excuse me posts if we're not the same
user so the next thing I want to do is
in my dashboard here I want you only
show these buttons if we are allowed to
delete and edit it goes for edit as well
even though we haven't implemented that
yet so therefore I will well let me put
this in on two new lines and her new
line here I will add an if statement
with my polite expression syntax and if
and this should only be shown
conditionally so I'm going to put this
inside the if statement make sure to
also have this pipe here with you
that you don't have floating pipe at the
end of the like and dislike button even
though no buttons are coming after that
and then here I use the same check off
user should be in this case it should be
equal otherwise I'm not showing it
should be equal to the user of this post
we're having here and we're accessing
post since we're looping through all our
posts here let me save this and reload
good as you can see not seeing the
buttons here I can delete my own post
that's still working let me try to
delete the post of max here to do so
I'll have a look at my database my posts
I did you I'll try to delete the post
with an ID of two I can do this if you
have a look at our routes by just
accessing delete post and then the idea
of the post so I'm just going to copy
that instead of dashboard and posted
these two as we just looked it up and
well now I'm just taking back taken back
let me see if the post got deleted no
it's still there so our security check
here is working now we can only delete
our own posts see you in the next videos
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>