<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP - Build a Shopping Cart - #16 Finishing Touches | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP - Build a Shopping Cart - #16 Finishing Touches - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP - Build a Shopping Cart - #16 Finishing Touches</b></h2><h5 class="post__date">2016-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/M9nXcs4x03A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">like a back everyone it's really
summertime over here it's extremely hot
but it won't stop me from finishing this
shopping cart serious here so where are
we currently at we have our shopping
cart here or our product page you can
add items to the card and we can then
successfully check out while stripe so
that's all great but there's one thing
that is missing we get this action
drop-down here but currently it's not
doing anything I want to be able to
either reduce it by 1 which of course
means I want to take just one item off
that item group here off the card or I
want to reduce all words basically chest
remove this whole item leave Oliver
items in your shopping cart if there are
any but remove this one and yes of
course you could add plenty of our
functionalities tudors but the core of
this series it is called shopping cart
after all right we'll be finished after
that you'll know how to create a card
how to manage it how to check it out and
how to store it in the database of check
out so I think that really is a lot but
before going into all this finishing
talking stuff well let me go back and
implementing your functionality I was
just talking about manage this card back
in the project at like I just bring that
over here I'll start in my cart PHP file
in my card model currently we got a
function to add items but since I want
to be able to either reduce item but one
or remove it entirely I also need
functions for well these actions I'll
start with the reviews function so I'll
go in here and treat a new function
which I'll call reduce by one something
like that
and reduced by one will take an ID as an
input because I need to know the idea of
the item which I want to reduce right
think that makes sense so in here let's
think about what should happen if i
reduce an item by one well it's kind of
the opposite of the add item here i want
to reduce the quantity of that item i
want you reduce the aggregated
aggregated price of that item group and
i also want to remove d total quantity
or a reduced d total quantity and reduce
the total price so really just reverse
that of course there is one catch I also
need to make sure that if I well reduced
the item below zero so basically if I
remove the item well that I actually do
remove it and that I don't get negative
quantities or prices so let's start with
the easy part first I'll select my items
so this items just refers to the items
in my cart and then I can select item by
ID remember that I'm doing this over
here when I store this item I also store
it with the ID being d well key in this
associative array therefore I can
retrieve it with that ID and the year I
can access my quantity field of that
item not of teetotal card quantity for
now but just opted item through and well
decremented reduce it by one and kind of
a similar thing happens for or with the
price i select the price here and then
of course I don't want to reduce it by
one but I want to reduce it by the price
of one single item so I'll use this
minus equal operator to basically just
set this price equal to the old price
minus T whatever i'm going to subtract
here aunty whatever i'm subtracting here
is again my item here items selected by
ID
and then the individual item remember
we're storing this individual item in
each item group so that so that we have
access to you title description and also
the price of one single item so on that
single item then I can access the price
again and that is what i want to
subtract from the aggregated price so
with that the item group will be updated
two quantities reduce that the price is
well adjusted and I also need to adjust
the overall card totals so the total
price until the quantity therefore I'll
just access total quantity so that's now
a detailed quantity off the card I
reduce that by one and I also access the
total price and I want to reduce that
and of course I want to reduce it by the
very same amount i reduce the aggregated
price of this item group so by the price
of a single item like that with that the
card will get adjusted correctly and we
can actually see this in action so in
order to see this in action I need to
hook it up though for that I'll go into
my product controller and I need to add
a new route and I'll add it right here
after the get add to cart route or the
new action should be precise since I'm
in controller so this action should be
called get reduce by one for example and
i will pass an ID to that action by at
the router of course Adam here I well
what do I want to do well first thing is
I want to basically copy the code from
my add to cart action here so to fetch
the old card and to create a new card
well of course I don't want to call a
cart add here instead I want to call
cart and then reduce by one this new
function i just read
you
in my controller here the dollar sign is
omitted though so with that I well
created the route of course I need to
configure it so I want to use my product
controller here and then we get reduce
by one method i just created and i will
name this route let's say product
reviews by one something like that so i
can copy that already and then i will go
to my shopping cart view here and here i
got my two well buttons basically the
second one isn't what i have written the
code for that yet but i can hook up the
first one so entered you played template
expression here oops didn't mean to do
that and in here i want to call the
route method to wear out function here
to then navigate to my reduced by one
route and keep in mind i need to pass
the ID here so ID shall be well I can't
just access this here the product and
then keep in mind product is not an item
from the database instead of this an
array an associative array so here I can
then access the item and again this is
my single item which has its ID in the
database so i can then also access the
ID on that so with all these changes in
place if we now go back and reload the
shopping cart we should see that if i
click reduced by one it gets reduced by
one you also see the price updated and
quantity here at the quantity in the
euro on the right as well as the total
price and i can reduce again and now
that already the behavior i don't want
the price is correct at the quantity 2
but what sense does it make to have an
item in the shopping cart of which you
have no copies in your shopping cart in
the end so you basically try to buy
nothing but still want to have it on
shopping cart that doesn't make sense
and it even gets weirder if i reduce it
again well now we have an
active quantity of a negative price well
that certainly is a great way to earn
money of you would have a shop like that
you get money back after all but not
really the paper we want here right and
the reason for that of course is that in
the card model here at the end of the
reduced by one function we're never
checking if we're while reaching a
quantity of zero or or lower and we have
to do that so what I want to do here is
I want to implement a check here where I
basically check if this items well
select by the ID here if the quantity is
smaller or equal to 0 because that of
course means now we have no item and
ecard anymore and then I want to remove
it from the card and how do i remove an
item from the card we can use the PHP
function unset for that and that
basically allows me to well destroy
variable and here that i can destroy an
element in my items so in order to do
this I will call unset and then unset
this items ID so this items will still
persist only the items selected with the
idea with the key of ID will be deleted
and with that I remove it from the card
now since we got that we can also write
the function for simply removing an item
from the card remove item so here we
don't want to reduce it by when we just
want to remove it entirely and of course
one step of removing is calling unset
but we also need to adjust the totals of
the cards so we'll just copy that code
and reducing the quantity / 1 is not
really right here because we might have
had three items off that in the card and
since I want to remove the item entirely
I can't just reduce by one I need to
remove all copies we had in the card so
to make to do this correctly i need to
subtract x well while the item we want
to remove but then by the quantity off
that i cannot just buy one and cattle
similar thing is true here for the price
I don't want to subtract the price of
one item I want to retract the
aggregated price and I can simply do
that by removing the item here so I'm
not just selecting this single item
anymore but instead you aggregate again
with that remove item should all the
work of course with that back in your
product controller I also need to add an
action for that so a public function get
remove item for example which also gets
d id passed into it and then here what
do I want to do well of course I want to
fetch my cart again and I will also
finish with the same actions redirecting
to the shopping cart and putting the new
card into my session but between these
steps i will call cart and then remove
vital and pass ID so to use the action
or the function i just created what that
this is prepared and now with if I
hooked it up in my routes file I can
treat and you get route here route get
and then maybe remove then the ID then
again the configuration for that route
so of course I want to use my product
controller Hyrum and I want to call the
get remove item method or action and I
want to give this route a name off let's
say product remove something like that
and then I can go into my view here and
hook this route up I will just copy the
code of my other out because technically
it's very similar but I need to rename
it to just product remove since that was
the name I just
sign here so with that if I reload this
page and well that is rather stupid here
so I'm just removing it all that worked
as you already saw now let's add a
couple of items here maybe like that and
now let's try out the things we just
added I reduce this by one looks great
now your for a song of ice and fire
notice I have two items and notice that
this makes up twenty dollars so if I
click reduce all we should see that we
only got harry potter and lord of the
rings left and total should just be
thirty dollars then looks pretty good to
me you also saw that it updated here on
the upper right now if i also remove all
these items here that looks good but
there's one thing i don't like i'm still
on the shopping cart page and i could
select like check out even there were no
items left on the shopping cart and we
also should fix that as you'll see it
really as easy to fix I'll go to my
product controller and we can apply the
fix here in the gate card function which
is responsible for giving us our
shopping cart do you hear the problem we
have is that we never check if the total
quantity of the card might be zero yes
we check if the session has a cart but
it does have a card here and we never
delete a card I agree that indicate
remove item we might all just forget the
card so that we check if the shopping
cart still has any items if it has items
then we well do nothing but it has if it
has no item left over after removing an
item we might just clear the session so
that might be worth doing so we could
basically check if card and then items
and then what well keep in mind that
items is an array so we might just check
if the count
of that is greater than zero if this
East case then I want to put my shopping
cart otherwise it looks like well we
have no items left so then I might just
call session forget card which will
basically delete the card with that if I
reload this well it will still look like
that but if i add a new item harry
potter and then i reduce that now we see
no items in card because now that gets
cleared however if i have multiplied the
most you for example and i only remove
one we still have a card only if i
remove dad is it gone and now we see the
problem again the reason of course being
that i only forget it here in the gate
remove item action but not only reduce
one action however here i also have to
make sure you well deleted if we have no
items left so it matches copy this and
yes of course you could refactor that
too but i think we should be fine like
that so with that just to do a final
check if i add let's say these items
here and then i reduce that by one it's
gone i would you step by one and buy one
again and now we have an empty cart and
with that we have a working shopping
cart again i also touch to this at the
beginning of the video yes you could add
further functionalities but you would
never stop with this serious than and I
rather prefer making additional sirius's
on well Albert topics then stretching
this out and lessly you saw how to
create a shopping cart how to store it
in a session how to make charges how to
store orders in the database how to see
your shopping cart page if you also take
my social network series on a channel
account you should also be able to work
on an admin backend which allows you to
create your own products and at the end
programming really is about all these
things you have to set your own
challenges and then try to reach them
that being said future serious welcome
and
we'll attach some other interesting
topics there too happy to see you Derek
and I really hope you enjoyed this
series by</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>