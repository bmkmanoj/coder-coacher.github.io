<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP - Build a Shopping Cart - #10 Stripe Payments View | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP - Build a Shopping Cart - #10 Stripe Payments View - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP - Build a Shopping Cart - #10 Stripe Payments View</b></h2><h5 class="post__date">2016-07-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jNWDrw3vRU4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we're getting closer to the end or at
least to the part where we can actually
buy our products or go to the checkout
process right now the state of our
application of course is that we have
our projects here products and we can
click on them add into our cart and have
a look at our cart but there's checkout
button doesn't work and in this video I
want to work on that I want to make this
checkout button working and I want to go
to a check out page of course next steps
that are to actually implement a
checkout but let's do it step by step
and focus on creating the required views
and routes first for this as a first
step I will head over to my shopping
cart plate PHP file so the view which
renders the shopping cart and the ste
button which actually should well
navigate me to the shopping cart over to
the checkout excuse me should never get
me to to checkout now I'll just change
this to be an anchor tag so simply by
replacing button with a also replace it
in the closing tag here of course I'll
keep the button classes to keep the look
of it and why did I change this well
simply because I want to make this a
link pointing to around which I will
create next but I will enter it right
now here so entering the template
expression here with double curly braces
I'll use route to create a link to the
check out route now as a chess set this
route doesn't exist yet so let's create
it any route stop PHP file here I want
to set up this route and I'll do it
right here below the shopping cart light
routes so this will be a get route and
it should give me my checkout page so
I'll I'll give it a URL of slash
checkout and then of course my array to
configure this route and here I want to
use my product controller but I want to
use to get checkout action which I also
haven't created yet and I will do so in
a second I'll give this route a name and
of course the name should be checkout
because that's the name I just used in
the anger
Tagg right so of that I created my get
route the next step of course is to
create this get checkout action in the
product controller so I'll head over
there to the product controller and at
the bottom of course positioning doesn't
really matter I just want to keep my
cart related routes up here and then
I'll go to my checkout related routes
down here or actions I will create a
public function which I will call get
checkout and of course will be the
checkout action triggered by this link
and then here what I want to do is I
first want to check if I do have a cart
so I'll just copy the code from my get
card action here and if I don't have a
cart
I'm fine with redirecting the user QD
well empty a shopping cart page which
basically will tell him hey you don't
have items on the cart please add some
so basically it's kind of a redirect
since I'm clicking on you checkout link
on this page so I could also use
redirect back I guess but yeah I will
keep it like this just in case that
something fishy is going on and the user
tried to enter the checkout page by
entering slash checkout in the URL well
then I will make sure he's not getting
to the checkout page if he doesn't have
a card so if we do have a cart
I will first fetch this why are these
session for Sayed and then from the well
cart so get card this is G card store it
in the session and there are all things
we did in the last videos right so like
up here where I get D card - I don't
need to check if we have the card like I
did here because I did this year in the
first step keep that in mind so with
that I'm fetching the old cart and I
will create a new cart that's the same
wall scheme or the same well approach I
used before in the last lectures and I
will create this new card based on the
old card of course and then just to keep
that well approach I could of course
also just access the total on this old
cart so then I will use my cart and
access total price which of course is
as the user should pay and then I will
return with you and I want to return a
view I still have to create I didn't do
that yet I will place it in the shop
folder and I will name a check out later
PHP so here I'm accessing shop dot
checkout whoops stopped checkout which
will lead to this view I've yet to treat
I also want to pass the total price to
that view
so total total like this so with that I
make sure that I do have that price on
the view so that the router set up but
of course the view doesn't exist yet so
in the shop folder here I will create
this new file the checkout plate dot PHP
file which will be well my checkout view
here in this view I'll first go to my
shopping cart view just to grab the well
didi first view view lines here so with
the extending layout and so on and then
I'll close my section here too and with
that I'm ready to write the markup for
my checkout page now which markup to a
want here I'll go back to the shopping
cart and I will grab the diffs here with
the bootstrap well formatting with the
bootstrap columns because I want to keep
that well that style I also reuse
throughout the rest of my application
though I think I can make it a little
bit less white on bigger screens so I
will increase the offset by one to get
it a little bit more in the middle and
therefore I will decrease the width to
have it a little bit smaller a little
bit tight or not not as broad in the
middle of my screen but that's pure
stylistic things and you might change
this of course then just a little header
where I say checkout and then I want you
have another header where I inform the
user what is current total is so your
total is remember everything is in
dollar so I will hard killed you dollar
sign here then enter my template
expression and here I want to print out
total which I do have because this year
does total refers to the
variable I'm passing here in the product
controller down here so I will have
access to this total price but that the
user knows how much is supposed to pay
and next it's time to create D well the
form to fetch the user information so
here I want you also to trigger a post
route and I'll name check out of course
I also have to create this route later
on and I will use the method post like
that and now here's an important thing
how will I actually handle the checkout
well I need some information like credit
card number because I will enter I will
provide a credit card base to check out
here so I need that I need to name I
need the security code on the credit
card and how would I actually do this
will I create some code to connect to
American Express or MasterCard not
really I will use stripe which is a
third party
well provider or service you can use
which basically already has all the
connections to the credit card companies
and offers you a very simple API you may
implement in your project to then easily
create charges and basically charge
customers based on the payment data they
provide it will also verify the data and
encrypt it protected so a lot of stuff
you don't have to worry about and you
really shouldn't worry about because
that is really complicated and not
something easily solved with you have
you lines of code especially since you
also would need to kind of negotiate
your deals with the credit card
companies and so on so that is why such
a third-party service is really worth a
lot and I will use stripe which is this
service so therefore the questions which
information does stripe need so which
information do any to gather in this
form here well let's have a look I will
hit our to the browser and google for
stripe our not strip I'm not
for any hot girls so Stratcom is the
page of this service and right here you
can
well basically read what the service is
all about certainly interesting and you
can also go to the documentation and
then as you can see they got quite a
long documentation which also has this
nice getting started guide which leads
you through all the core well
steps in the process to charge a
customer and basically here you can
already see which data we need we need
two credit card number expiration month
and here and the security code ECBC code
here if we fetch these four information
pieces we can basically send them to
stripe stripe verifies them and then we
can charge the customer so we need to
collect those four pieces of information
so that is what I will implement in my
form here I will therefore throw in some
code and now here's a part some of you
like it some of you don't I think I will
always make it wrong I will just copy
exam prepare to cohere now the reason
why I copied this code into here is it's
really just some bootstrap form control
HTML markup nothing special about that I
will of course lead you through that I
won't fetch a bit more information than
the one required by stripe because later
on in this application we might want to
store for example the user address if we
want to ship whatever he ordered right
so therefore the first input here is the
name of the user and this is required
with this html5 required attribute here
then I'm fetching the address also
required and then I want to get the
cardholder name which of course might be
equal to the name up here but I want you
enable the user to have a different
shipping name or shipping address and
cardholder name therefore I'm fetching
this on a separate input and one
important thing to notice here is that
all these inputs don't have a name
attribute so I'm not assigning
name's the reason for this as you will
see is that I'm not submitting this form
to level so even though I'm setting up a
poster out here in my form tag
I will actually capture this post
request whenever I click on the button
with JavaScript and you will see all of
that no worries and then not send it to
the server but instead read this form
here and I can access all the fields
with the IDS I am setting notice that I
do have IDs and then I collect its
information and I will send this
information to stripe and that's very
important to understand that I will
basically not send this to laravel
directly but instead I will capture it
with JavaScript and send it to stripe
first thereafter
I will let my level application handle
the response stripe gives me but I need
to reach out to stripe this service
first because it's the service
validating all the data and basically
being responsible for well me being able
to charge customers that's why I have
these two steps and you may read more
about it in the documentation the stripe
documentation where you will also find
examples for nodejs or PHP or whatever
code and how to implement it so back to
this form this is you form I have
without names but with IDs which I will
need in my JavaScript code then I'm
fetching the credit card number the
expiration month and the expiration year
and this CVC field here so the security
code I also need to fetch and all the
layout here with the columns has chest
setup so that this doesn't look queue
Ackley actually hopefully of course
since we're here in a lateral form I
will also need to enter my CSRF field
here because that is still needed CSRF
protection is still in place in though
we're using stripe as a first step we
need to validate the session of the user
nonetheless and then I will add a button
of type submit' which will give a class
of button intend but
success and I will just say by now here
so that I'm almost done now we'll go up
I will also give my form and ID here so
I'll just name it let's say check out
form like that and I will add some other
things in well when we progress with
this whole stripe process for now that's
what you will look like and we're
returning this view since we're getting
does get act checkout action here in the
route and then the product controller
remember we're returning this view now
since I will use the post checkout route
in my view here - in the form I also
need to set this up in order to avoid
any errors so I will create a new route
a post route also slash checkout I can
do this because every route is a gator
out keep that in mind
so I can easily use a route with the
same segment here which is or uses a
number HTTP word I will also use the
product controller here so product
controller and then let's say post
checkout and then I will give this a
name off checkout which all this is the
same name as the get route has but again
we're using different HTTP works here so
with that all the routes here are set up
let's see if that doesn't have to get it
working I will basically reload my
shopping cart page if I now click on
checkout I'm taking to the checkout page
and as you can see I could enter my
details here if I click buy now though
or well let me quickly fill something
out here max and then I will grab this
example dummy credit card number here on
the arm nibbler on the stripe page and
then let's enter any arbitrary month
euro and here and code click on buy no
well and I of course I get an error
because the post check out act
which I'm using here in my routes file
doesn't exist yet but besides that well
the checkout form at least does work and
that's a huge first step on what you can
build on to implement the actual
checkout process with stripe now a good
practice for you might be you try this
on your own before while watching the
solution in the next video on the
documentation page here on stripe you
should get all you need and you can also
click on examples down here to have a
look at some examples for example a
payment for build with PHP and so on and
you can also generally dive through all
these links here to learn how to
implement stripe it's not that difficult
to getting scars started guys here is
certainly also a great resource and well
if you feel stuck or are not sure how it
works well then definitely we're in all
other cases to come back in the next
like video and we'll do this together</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>