<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP - Build a Shopping Cart - #16 Finishing Touches (Reupload) | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP - Build a Shopping Cart - #16 Finishing Touches (Reupload) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP - Build a Shopping Cart - #16 Finishing Touches (Reupload)</b></h2><h5 class="post__date">2016-08-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/UlGZY15ter4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">like a back everyone it's really
summertime over here it's extremely hot
but it won't stop me from finishing this
shopping cart serious here so where are
we currently at we have our shopping
cart here or our product page you can
add items to the cart and we can then
successfully check out while stripe so
that's all great but there's one thing
that is missing we get this action drop
down here but currently it's not doing
anything I want to be able to either
reduce it by 1 which of course means I
want to take just one item off that item
group here off the card or I want to
reduce all words basically chest remove
this whole item leave all other items in
the shopping cart if there are any but
remove this one and yes of course you
could add plenty of our functionalities
to this but the core of this series it
is called shopping cart after all right
we'll be finished after that you'll know
how to create a card how to manage it
how to check it out and how to store it
in the database of checkout so I think
that really is a lot but before going
into all this
finishing talking stuff well let me go
back and implement your functionality I
was just talking about manage this card
back in the project add like I just
bring that over here I'll start in my
cart PHP file in my card model currently
we got a function to add items but since
I want to be able to even reduce item by
one or remove it entirely
I also need functions for well these
actions I'll start with the reviews
function so I'll go in here and create a
new function which I'll call reduce by
one something like that
and reduce by one we'll take an idea as
an input because I need to know the idea
of the item which I want to reduce right
think that makes sense so in here let's
think about what should happen if I
reduce an item by one well it's kind of
the opposite of the add item here I want
to reduce the quantity of that item I
want you reduce the aggregated
aggregated price of that item group and
I also want to remove D total quantity
or a reduced the total quantity and
reduce the total price so really just
reverse that of course there is one
catch I also need to make sure that if I
well reduced the item below zero so
basically if I remove the item well that
I actually do remove it and that I don't
get negative quantities or prices so
let's start with the easy part first
I'll select my items so this items just
refers to the items in my cart and then
I can select item by ID
remember that I'm doing this over here
when I store this item I also store it
with the ID being D well key in this
associative array therefore I can
retrieve it with that ID and the year I
can access my quantity field of that
item not of T total cart quantity for
now but just up that item through and
well decremented reduce it by one and
kind of a similar thing happens for or
with the price I select the price here
and then of course I don't want to
reduce it by one but I want to reduce it
by the price of one single item so I'll
use this minus equal operator to
basically just set this price equal to
the old price minus D whatever I'm going
to subtract here ante whatever I'm
subtracting here is again my item here
items selected by ID
and then the individual item remember
we're storing this individual item in
each item group so that so that we have
access to title description and also the
price of one single item so on that
single item then I can access the price
again and that is what I want to
subtract from the aggregated price so
with that the item group will be updated
to quantities reduce that the price is
well adjusted and I also need to adjust
the overall card totals so the total
price until the quantity therefore I'll
just access total quantities so that's
now a detailed quantity off the card I
reduce that by one and I also access the
total price and I want to reduce that
and of course I want to reduce it by the
very same amount I reduce the aggregated
price of this item group so by the price
of a single item like that with that the
card will get adjusted correctly and we
can actually see this in action so in
order to see this in action I need to
hook it up though for that I'll go into
my product controller and I need to add
a new route and I'll add it right here
after the get add to cart route or the
new action to be precise since I'm in
controller so this action should be
called get reduce by one for example and
I will pass an ID to that action by at
the router of course add them here I
well what do I want to do well first
thing is I want to basically copy the
code from my add to cart action here so
to fetch the old card and to create a
new card well of course I don't want to
call a card add here instead I want to
call cart and then reduce by one this
new function I just created my card
object so in here I need
pass the idea which I get passed into my
controller action here and with that
I'll reduce the cart or I'll adjust the
cart but of course I also need to store
it in my sessions a with session put
here and of course well you already
should have it otherwise this old code
would not worked but make sure to have
this use session import here at the top
but back to this code here I want to put
something on my session and of course I
want to put this new card that's just
following the same logic I was using
throughout this application with
recreating my card as a last that step
then of course I also want to redirect a
user or return a view here I will
redirect so I will redirect to a route
you route to which I want to redirect is
the shopping cart so that is shopping
cart no I think I called a shopping cart
here like that let's see product
shopping cart to this route here do I
want to redirect so we're almost there
of course I also need to create a new
route now and I will create it here
below the add to shopping cart route
this will be a get route of course and I
want you well URLs totally up to you I
will call it reduce and then very
importantly that's not up to you I need
to pass the ID and of course it has to
be named ID since I also named it ID in
my controller here the dollar sign is
omitted though so with that I well
created the route of course I need to
configure it so I want to use my product
controller here and then we get reduce
by one method I just created and I will
name this route let's say product
reviews by one something like that so I
can copy that already and then I will go
to my shopping
our view here and here I got my - well
buttons basically the second one isn't
what I have written the code for that
yet but I can hook up the first one so
I'm sure do you plate template
expression here oops didn't mean to do
that and in here I want to call the
route method to wear out function here -
then navigate to my reduced by one route
and keep in mind I need to pass the ID
here so ID shall be well I can't just
access this here the product and then
keep in mind product is not an item from
the database instead of this and array
an associative array so here I can then
access the item and again this is my
single item which has its ID in the
database so I can then also access the
ID on that so with all these changes in
place if we now go back and reload the
shopping cart we should see that if I
click reduced by one it gets reduced by
one you also see the price updated and
quantity here at the quantity under your
on the right as well as the total price
and I can reduce again and now that
already the behavior I don't want the
price is correct the quantity - but what
sense does it make to have an item in
the shopping cart of which you have no
copies in your shopping cart in the end
so you basically try to buy nothing but
still want to have it in shopping cart
that doesn't make sense and it even gets
weirder if I reduce it again well now we
have a negative quantity and a negative
price well that certainly is a great way
to earn money if you would have a shop
like that you get money back after all
but not really the behavior we want here
right and the reason for that of course
is that in the cart model here at the
end of the reduced by one function we're
never checking if we're well reaching a
quantity of zero or or lower and we have
to do that so what I want to do here is
I want to implement a check
where I basically check if this items
well select by the ID here if the
quantity is smaller or equal to zero
because that of course means now we have
no item in the cart anymore and then I
want to remove it from the cart and how
do I remove an item from the cart we can
use the PHP function unset for that and
that basically allows me to well destroy
variable and here of that I can destroy
an element in my items so in order to do
this I will call unset and then unset
this items ID so this items will still
persist only the item selected with the
idea with the key of ID will be deleted
and with that I remove it from the cart
now since we got that we can also write
the function for simply removing an item
from the card remove item so here we
don't want to reduce it by one we just
want to remove it entirely and of course
one step of removing is calling unset
but we also need to adjust the totals of
the cards so we'll just copy that code
and reducing the quantity by one is not
really right here because we might have
had three items off that in the card and
since I want to remove the item entirely
I can't just reduce it by one I need to
remove all copies we had in the card so
to make did you do this correctly I need
to subtract by well while the item we
want to remove but then by the quantity
off that I cannot just buy one and get a
similar thing is true here for any price
I don't want to subtract the price of
one item I want to subtract the
aggregated price and I can simply do
that by removing the item here so I'm
not just selecting this single item
anymore
study aggregate again with that remove
item should also work of course with
that back in the product controller I
also need to add an action for that so a
public function get remove item for
example which also gets D ID passed into
it and then here what do I want to do
well of course I want to fetch my cart
again and I will also finish with the
same actions redirecting to the shopping
cart and putting the new card into my
session but between these steps I will
call cart and then remove item and pass
ID so to use the action or the function
I just created with that this is
prepared and now with if I hooked it up
in my routes file I can treat and you
get route here route get and then maybe
remove then the ID but again the
configuration for that route so of
course I want to use my product
controller here and I want to call the
get remove item method or action and I
want to give this route a name off let's
say product remove something like that
and then I can go into my view here and
hook this route up I will just copy the
code of my other route because
technically it's very similar but I need
to rename it to just product remove
since that was the name I just assigned
here so with that if I reload this page
and well that is rather stupid here so
I'm just removing it all that worked as
you already saw now let's add a couple
of items here or maybe like that and now
let's try out the things we just added I
reduce this by 1 looks great now your
for a song of ice and fire notice I have
two items and notice that this makes up
$20 so if I click reduce all we should
see that we only got Harry Potter
Lord of the Rings left and the tool
should just be $30 then looks pretty
good to me
you also saw that it updated here on the
upper right now if I also remove all
these items here that looks good but
there's one thing I don't like I'm still
on the shopping cart page and I could
still click checkout even there were no
items left on the shopping cart and we
also should fix that as you'll see it
really is easy to fix I'll go to my
product controller and we can apply the
fix here in the get card
function which is responsible for giving
us our shopping cart view here the
problem we have is that we never check
if the total quantity of the card might
be zero yes we check if the session has
a card but it does have a card here and
we never delete a card I agree that
indicate remove item we might all just
forget the card so that we check if the
shopping cart still has any items if it
has items then we well do nothing but it
has if it has no item left over after
removing an item we might just clear the
session so that might be worth doing so
we could basically check if card and
then items and then what well I'll keep
in mind that items is an array so we
might just check if the count of that is
greater than 0 if this East case then I
want to put money shopping card
otherwise it looks like well we have no
items left so then I might just call
session 4 get card which will basically
delete the card with that if I only load
this well it will still look like that
but if I add a new item Harry Potter and
then I
reduce that now we see no items in card
because now that gets cleared however if
I have multiplied the most you for
example and I only remove one we still
have a card only if I remove dad is it
gone and now we see the problem again
the reason of course being that I only
forget it here in the get remove item
action but not only reduce one action
however here I also have to make sure
you well delete it if we have no items
left so it matches copy this and yes of
course you could refactor that too but I
think we should be fine like that so
with that just to do a final check if I
add let's say these items here and then
I reduce that by one it's gone
I would use step by one and buy one
again and now we have an empty card and
with that we have a working shopping
card again I also touch to this at the
beginning of the video yes you could add
further functionalities but you would
never stop with this serious Dan and I
rather prefer making additional serious
on well our topics then stretching this
out and lessly you saw how to create a
shopping cart how to store it in a
session how to make charges how to store
orders in the database how to see your
shopping cart page if you also take my
social networks series on a channel
account you should also be able to work
on an admin back-end which allows you to
create your own products and at the end
programming really is about all these
things you have to set your own
challenges and then try to reach them at
being said future serious well account
and I will attach some other interesting
topics there to you happy to see you
Darren and I really hope you enjoyed
this series bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>