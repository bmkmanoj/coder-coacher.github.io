<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Node.js + Express - Tutorial - Express-Validator and Express-Session (Validation &amp; Sessions) | Coder Coacher - Coaching Coders</title><meta content="Node.js + Express - Tutorial - Express-Validator and Express-Session (Validation &amp; Sessions) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Node.js + Express - Tutorial - Express-Validator and Express-Session (Validation &amp; Sessions)</b></h2><h5 class="post__date">2016-03-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hE5zeEiVqpw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">everyone welcome back to a new no chairs
video and the last video way to look at
get and post requests and now in this
video I want to take this a step further
and also add validation or show you how
you can add validation if well for
example user submits a form to see if
the values entered are valid also I will
show you how to enable sessions in your
node.js application let's get started so
so for this video what I will do is I'll
create a new folder and I'll call this
validation sessions whatever and then I
will just copy all the files from my
last video because I will use handlebars
and setup is fine yes so now I got this
and a near one that is all good now
where I will start is I want of course
to add this functionality I want to add
a validation and a session functionality
to this application and I'm going to
import packages which will handle this
so that I don't have to write as myself
and this generally you probably already
got this is the way we use Express and
note it's a framework which is very
straightforward and then you add all
kind of packages to extend it in the way
you need it and you don't have
unnecessary things you don't need but
you only add things you do need so for
this example for this section here for
this video I will need some session
management package and a validation
package for this I will first go to the
terminal and here I will then enter my
newly created folder and I will run npm
install - - save - also save it to my
pack
shall chase the file and then I need
Express validator and if we have a look
at my package to chasten file now we see
we got this Express validator here so
that's great and for the session I will
use npm install' - - save Express oops -
session now after two packages I need
for this to work now I first start in my
app dot JS file where I will setup both
packages or both functionalities I will
add - imports here at the top first my
Express validator which is required from
Express validator that's one of the
packages I just added and then I will
add Express session and let me zoom in a
bit and those from Express session so
now both packages are there and now I
need to also set them up regarding the
Express validator all I have to do is I
have to add one entry after this body
parts are you that's very important that
you have it in this position that not
before the body gets parsed but after
the body was parsed because my our
validator needs access to these parsed
values and then I will just write app
use Express validator and just call it
like a function with parentheses this
will start and setup this Express
validator the next thing I need is the
Express session which I will do here at
the end and for this work I will call my
Express session also like a method but
here I will add a configuration
JavaScript object where I will have a
secret you will just pick max you pick
whatever probably more secrets than your
string you want then I will add save
initialized will set this to false and
if all the Centers to Falls what these
two values do is safe initialized with
if we sell to to make sure that our
accession is stored your session storage
even though it may be uninitialized but
won't do this in our case here because
of the set of fold which should be the
default by the way for this package and
really save will if it is set to true
save our accession eat after each
request even if it is initialized or
wasn't modified and modified so by
setting forth we will only save or a
session if we change something and this
should also be the default for this
package now talking of memory storage or
above about session storage this Express
session does but it will use memory
storage which is not good for production
for production you might use another
storage and you can find a lot of
storage is available or compatible with
Express session by well just search for
Express session you will find again a
proposal for e I can show it to you it
so this is the repository off this
Express session packet we are using and
at the bottom of this readme here you'll
find a list of compatible session stores
which you can set up on your production
server to store your session on the
server because if as you probably are
aware sessions are stored in a server
not on the collide not on a cookie on
the server the client the cookie will
only store the session ID so that well
we can identify which client belongs to
which session but the session itself is
stored on a server like here for example
in a database or wherever the default
here again we don't have to setup
anything is to use memory storage which
is in the memory and which is not
recommended for production just to make
that sure with that out of the way
everything is set up in our app torch as
file and we can move on to our index dot
JS file in the routes folder in here
what I will first do is I will get rid
of these two routes
I will keep my index route but I will
change the values I passed
it all well title and we'll keep that
just call it for invalidation but then
here I will pass a success property
which is set to false by default and an
errors property which is set to request
session errors and this will also be
empty at the beginning because this
refers to the session which is handled
by express session which is just setup
and there I will later add an error
proper in errors property to it which
will hold all the validation errors you
might have that we can output them in
our view view which is rendered after
entering the view I will reset my errors
property in my session to null so that
while all the errors are cleared after
we've shown them to the user now to
actually have some errors I first need
some way to separate some data so we'll
add a post route here which will lead to
let's say slash submit also of course
you call a function with default
parameters here and then in the body of
this post route here I will check the
valid validity of my values so here
check check validity before I do this I
will first set up a form which can be
submitted so that we know what we
actually want to check there for my
views I go to my index dot HBS file I'll
leave Tyler but I will get rid of the
level to rest and I will add a form
action should be slash submit method
will be whoops will be post and in this
form I'll have in input div just for
some styling which I will import in a
second and then here I'll have label
let's say for an email which says email
and on an input of type
tax you could also make it off type
email of course which has an email idea
of email and the name email and now I'm
just going to copy this two times two
also half your password should be of
type password and then let's say we want
to have another password here which
should be called confirm password so
that we have like a normal sign up forms
that we have to confirm the password
we're using or we're entering so confirm
password so that's the tiny little form
we're going to use at the bottom I'll
add a button of type submit' and well it
was just say signup so this will be the
form now let me import some styling
which i already prepared
okay styling is there chorus you will
find it in the github repository and now
let me reload this and then let me run
this server and reload this page now we
can see this form great now back to my
index dot JS file where my routes are I
want to check the validity of whatever
I'm passing here to do this I will call
requests dot check a new method which
sent reduced by Express validator the
package we added and this allows me to
say which parameter do I want or which
which for fields such as I do I want to
check so for example email and of course
this string we enter here has to match
the name of the input field we want to
validate see how I want you check the
email field I want to output the error
message invalid email address if we have
an error and then I change the check I
want to use now we can write our own
validators but there are a lot of
built-in ones
show you a list of built-in validators
one second and you will find this link
as well as this session storage link in
the description here is a list of all
valid edges built in validators we can
use so in my case here I will use the is
email validator which will we'll just do
what the name implies check if this is a
valid email address I'll add another
check which is for my password field and
I will output password is invalid and of
course you can find you need your
messages to be more precise I will check
if the length is at least four
characters long I do this by using is
length and then I pass a JavaScript
object as the argument where it has the
meant property and then the value of the
minimum length and then I will chain
another method which is called equals
and equals allows which compare two
fields or two values so here I will
check if this password field here equals
the value of my confirm password field
because that of course should be the
case now these are the two well things I
want to check with my validator here and
then I will set up the well appropriate
action after doing this validation so
here I have a very low errors and I will
store all the validation errors I might
have validation errors of course is a
method introduced by the validation
package we added if we do have errors
then I want to set them to my session
and do this by adding of property errors
and after this I will redirect to well
the index rod here
good so let's try this Oh
so restart my server we load here and
then let me enter anything here task
which is not a valid email and then two
valid passwords and this should be
errors here we load so this is invalid
this is valid sign up as you can see
we're redirected but of course we're not
seeing the messages but what we don't
know if it worked or not
so let's output some error messages here
I want to add a handlebars block
statement where a check if success is
true or false and if success is true
then I will just say at the section
where I say successful validation
otherwise if we're not successful here I
will output this form and I want to
output all the errors I might have so
here again another block where I say if
we have errors if this is not null or
undefined then I want you output my
error section all the styling of course
isn't a style sheet I imported a few
seconds ago and I have mine or last year
and there I want to loop through all the
errors I have so each errors and then
list item where I will just output this
message and this message thing here this
property is by default included in the
validation errors we're extracting
through our validator for express
validator so what I'm doing here is I'm
whipping through all the errors if we've
got any
and these errors I'm talking about are
course these errors here now in order
for this to work that way I need to
change this a bit and I do this a way by
setting another session variable success
here which is false in case of failure
but otherwise this will be session
success will be true and then up here
where I set it to false by default now I
will set it to session success restart
reload submit an empty forum we get two
errors submitted with a valid email
address only the password is invalid
submitted with both being well at
successful validation so this is how you
enable validation in your Noche Express
app how you add sessions and of course
you can have a lot deeper there can use
all these validators you can build
custom validators but this is how you
generally use it and good starting place
to to go from see you next videos bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>