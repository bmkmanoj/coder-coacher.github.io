<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>NodeJS / Express / MongoDB - Build a Shopping Cart - #8 Validation | Coder Coacher - Coaching Coders</title><meta content="NodeJS / Express / MongoDB - Build a Shopping Cart - #8 Validation - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>NodeJS / Express / MongoDB - Build a Shopping Cart - #8 Validation</b></h2><h5 class="post__date">2016-06-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/js5hI2moBY4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back as explained in the last
lecture one problem we currently have an
assign a process here is that I can
enter invalid email addresses like this
one and that certainly isn't the
behavior I want so I need to change this
and one thing to were one way to change
this is to add validation now you could
of course write your own logic but
that's pretty complex and unnecessary
like as for many things in your express
applications there are third-party
packages you dump into your project to
add functionality you need in the case
of validation
I recommend Express validator and this
is deal github repository off the
Creator or off this package and there
too you find a link on how to install
this as well as some usage examples and
well in the documentation for this
package so over in a project I will
install it with the save flag though to
also place a entry new package to chase
and file and then my first step is to
set it up here in my app J's file so I
will name is a validator and require it
Express validator and you need to start
this validator after your body parts are
here is done this order is important so
validator should be executed here
because the validator will on its own
parse the body and retrieve the
parameters you want to validate from the
submitted request body therefore this
has to be done after the body is parsed
of course otherwise you can't validate
it so with that being set up the next
step is to add the validation in the
route however here we're using passport
to handle all the requests and create a
user so the right place to continue is
passport a s now in this file here I
want to validate inside this callback
I'm getting the request pass to the
callback since I set this to true and
therefore I can access all the
parameters off the callback so before
checking if the email address already
the database and doing all that I will
simply validate the past parameters so I
will do this by running request check
body a function added by this validator
and I want to check the email field and
I want to send back T message invalid
email if validation fails so this is
specified as a second parameter here and
then I chain the validators I want to
use in my case is email is one of the
validators as well as before even
checking the email if it is not empty
because I wanted to be passed and then i
duplicate us to also validate the
password and check if or say invalid
password if this fails and I check if it
is not empty and I also replace its
email here with is length and then I
pass an object where I specified a
minimum length to be four characters and
with that I have validation in place but
I'm currently not handling any errors so
this would check it and it would
recognize that maybe the email is wrong
but it wouldn't do anything in order to
do anything I will add a new variable
called errors where I will check if any
validation errors appeared I can do it
like this validation errors is a
function added by this package and using
the arrows thrown by my validators I
registered here on my request
so with these errors extracted I can
check if I have any with the function
here and if I do have errors I want to
create an array of messages which I want
to pass back to the view so I will then
loop through my arrows with this for
each function here and for each error I
find I will simply push it on my
messages array here however I will not
push the complete error but only the
message now dot message here is of
course a field this validator package
adds for each error so each error there
basically has a parent field describing
which parameter through the error
and the message field as well as a
number field but this message feature is
the important food for us and with that
I can in this case then return done now
because while we didn't get an error in
the case of a technical error or
anything like that
but it was also not successful so false
and I want to flash an error message
now I'm not returning message here like
before as this argument but instead I
will add the arrows myself by calling
request flash and then assigning it to
the error field there which I'm already
extracting the view and then assigning
my messages with that I'm sending my
bundled messages to review with this
flash milah we're here and interview I'm
looping through all the message I'm
displaying them here so this should work
I'll restart my server revisit this page
and I'll try to enter an invalid email
address missing credentials so I enter
both now I get invalid email I enter
both and a password which is too short I
get invalid email or invalid password
and now only the password and now a
valid email address which has already
been taken emails already news so the
complete validation here is working in
the way I want and I make sure that only
well valid values can be passed to the
database with that the signup process
looks pretty pretty good and it's time
to continue with the next part which is
about signing in the user and then also
protecting the routes see you there bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>