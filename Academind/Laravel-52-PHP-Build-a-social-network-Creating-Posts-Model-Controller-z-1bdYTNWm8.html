<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Laravel 5.2 PHP Build  a social network - Creating Posts (Model &amp; Controller) | Coder Coacher - Coaching Coders</title><meta content="Laravel 5.2 PHP Build  a social network - Creating Posts (Model &amp; Controller) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Laravel 5.2 PHP Build  a social network - Creating Posts (Model &amp; Controller)</b></h2><h5 class="post__date">2016-02-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/z-1bdYTNWm8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi welcome back and the last video we
prepared this beautiful view here now
let's fill it with some life what I want
to do in this video is I want you enable
a user to post something that will be
the first step so in order to do this we
need a post model or a post model the
first step is to actually create a model
so in my workspace I am in my console
here and I'll do this again with the PHP
artisan command we already use in a
earlier video and what i'm doing here is
i'm running the PHP artisan make model
command and i want to make a model with
the name post this will if you remember
and also relate to a database table
called posts so plural and to create the
micro migration of this database table
i'm entering - m at the end
q yeah creators migration file so now i
hit enter and now you can see in my
migrations folder here I got this create
post table now in this table we already
got the idea at the time stamps field
now what I want to have for my posts to
is I want you have like a text where I
stored the body of the post so to say
and I also want to store an integer and
here the field will be the user ID so
which put a user created this post so
that's all we have a very simple post
model because all we have is really a
body we have no title or tags or
anything like this
so this is enough so that's all I do not
need anymore
but in my but in my post model PHP file
under App the post file here what I will
do is set up the relation to the user
now we haven't talked about relations
yet you are aware that our models a
laravel have kind of a connection to a
database table
the background we already learned that
now database tables have relations and
connections right so we have to have a
possibility to depict that relation in
our PHP file so in the code we write so
that we can access these relations
because like we can create a user really
simple through our user model we might
also want to attach a post to a user now
to be able to do that we need some
chance of accessing this relation
therefore we have to define those
relations in our model files and you
will see how this works in my post file
here in the post model I will create a
new function a public function which I
will call user because each post has one
user who created it
this will take no argument but it will
return something and what it is what the
bowl returned is kind of a query builder
so this will return this and then I
describe the relation in this case a
post belongs to one user so this is a
belongs to relation and here I have to
provide a string as an argument and in
the string I disrupt the path to the
model to which this post model belongs
so the user model in this case and the
path is a p-- backslash this is
important use a backslash here user so
this means ok the relation out of the
view or from the view of a post is that
this post belongs to something to a user
now obviously we are going to define the
inverse in the user model here I am also
creating a function which I will call
posts because one user can have several
posts not only one and here I'm also
returning something I'm returning this
and now it's not belongs to because the
user doesn't belong to the post and the
relation is more like one user
has many poets or can have many posts
therefore what we need is this has many
which means it can have several of those
models we're specifying here so this is
a p-- post m so that's clear how you set
up these relations that you're defining
how models are connected so in order to
actually create a post what i will do is
i will create a new controller here
which will call post controller i'm just
copying the start of my user control of
file here will rename this to post
control of though here I will use the
the post method I will need to request
but the office set is probably not
something I'll need and then here when
this video we're only creating logic to
create a post therefore I'm creating a
public function post create post this
will be the action or the function will
call through our route now here we will
get request variable and inside of this
function what we will do is we will need
some validation here but that will be
done in the future video I'll just start
with creating the post here and to do
this I will create a new post so a new
post and this post has a body which I
can find in my request and I'll name
that body that field let's see in my
dashboard here I I called it new post
now I like body mayor more mayor German
so yeah that should be called body and
in my post controller this will retrieve
that value and store it in my body
filled with
created here as a text now in order to
save our post we need our user because
we need to create that connection right
now we do this by accessing our user for
a request we can always access the
authenticated user through the request
we're injecting into this function here
so we can access the user there and you
remember we set up this posts relation
in our user model now we can call this
relation here like a function because
well it is a function we set it up as a
function and what this function will do
is it will return as disconnection so
that we can now call the save method on
this and pass the post as an argument
now this will save our post as a related
post to the currently authenticated user
and after that I want to return a
redirect to the dashboard route now let
me run my migrations so that we got our
tables created okay it's now in order
for that to work I need to create a new
route here the route which will get cold
when we click on the submit button this
will be a post route and I will call it
create post or I will give it a URL of
create post and this will use the post
controller add post create post method
there and we'll call it a or it will
give it a name of create or let's say
post create okay now in my dashboard
here I want to include my hidden value a
input field here to pass my my session
code so sure
you think of think of that otherwise
you'll get nasty errors and well you
will be a name will be name will be
token now here I will execute a route
and the route we just created post
create now also add method post here and
now let me see if that works
let me refresh this page here and enter
something well we didn't get an error
now let's have a look into our database
so if we have a look here at our posts
table we see that this new post was
created and attached to a user with the
ID 4 and if you look at this this is
indeed the user arm locked in with
currently so now this is working this is
how we create posts and how we attach
them to a user and level and now in the
next video we will give this a little
bit of fine tuning with validation and
so on see you there
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>