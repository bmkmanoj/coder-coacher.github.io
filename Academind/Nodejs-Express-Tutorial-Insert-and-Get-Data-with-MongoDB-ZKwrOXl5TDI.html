<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Node.js + Express - Tutorial - Insert and Get Data with MongoDB | Coder Coacher - Coaching Coders</title><meta content="Node.js + Express - Tutorial - Insert and Get Data with MongoDB - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Node.js + Express - Tutorial - Insert and Get Data with MongoDB</b></h2><h5 class="post__date">2016-03-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZKwrOXl5TDI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi welcome back time to actually use
MongoDB in our Express application to
get started up first
also as waste create a new folder to a
call Mongo DB and I will copy the
structure from section 7 lecture 7 get
posts because I don't need validation
session management in this video here so
that's fine and in here the sort of
package of JSON file looks like any in
here I first want to install a new
package the MongoDB package of course
so let me CD enter this new folder and
then I run MP install - - save MongoDB
and this will install the official
MongoDB Express extension or the general
noches MongoDB driver
so whatever can use MongoDB so this is
done as you can see it updated it here
and now we don't have to set up anything
we can use it straight away and first is
I want to create a pleasant front-end
and I prepared something here as it is
really just some HTML and styles so let
me copy that into my project so first
styling here
and then I need to test you by the way
and then hear some HTML all this will do
if I run this server here oh and I have
to stop the other server first let me
run the server if I reload this is what
I created which will allow us allow us
to do the four crud operations insert
data getting data update and the leading
data so this is just lay out a few and
of course you'll find the code in a
github repository as always with that
out of the way let's jump right into our
index dot J's file on the routes
directory get rid of all the other
routes you for the moment and then I
need to add to imports here at the top
the first is called Mongo and this
requires of course MongoDB next is
called assert requires assert and this
is a built-in packaging nodejs normally
used for for testing it allows us to
compare values and so on and we use this
when we connect to our MongoDB database
or when we do some operations here there
to check if everything went right the
next things I will set up the URL which
points to the database this will be a
string and now this is of course not not
optional and not arbitrarily it does
Mongo DB da a colon slash slash and then
localhost as is running on our local
machine here we're doing all the
development here now local machinist you
probably noticed and that it's by
default port 2 7 OS 17 but you may check
this here in the terminal where your
server is running when it started up the
very first message here said the port or
specify the port on which is running to
seven
not even my case here and this is the
default so this will connect to this
MongoDB then we add another part to this
URL in this case slash test which
defines database you want to use in our
running MongoDB server so it does case
we'll use the built-in test database
which you already have now with this out
of the way I will also change this to
just render my index page here and then
I will set up some new routes which I
will need I want to have a route to get
the data let's call this get data
and I won't do anything there as of now
I will this I will add the step by step
then I will have a post route insert by
the way here I probably should add this
that's more correct this way and this
insert route is post or I'll copy this
two times because I'll also have update
post route and a delete post route let's
start with inserting items in my own
certain route from my view from the form
I have here for inserting items I will
get a title content and offer so in here
I will extract these parameters and
create a new item which I want to insert
so this will be a chava script object
which of course will as I just said have
a title I'll find us in the body of my
post request and there it will have well
property of title because that's the
name of the foreign field that I will
have content which is request body
content and then I will have my offer
request body offer and I have a typo
content so this will be the item I want
to insert and after inserting I want to
redirect to let's say my route route my
yeah this is in extra audio
now this interesting part actually
inserting the item so to actually insert
something I will call Mongo connect
connect to the database I specify the
URL to connect you and then I call back
once the connection has been well
established or possibly declined a
denied so here I will have an error
we do have one or the database if we
were successful I will then use assert
tui to check if well if we do have an
error or to check if we don't have an
error to be precise and if we don't have
one it's fine we will continue I will
then access my database type it your
fast here access my database which I
went back to which I connected use the
collection method on this and here I
will specify the name of the collection
into which I want to insert my data now
the collection is not the same as
database databases test but one database
might have multiple collections like a
sequel database might have multiple
tables so I may enter whatever name I
like here I will just call this user
data this will be the name of my
collection and here I will use the
insert one method to insert exactly one
entry this entry I insert will be my
item here of course this function has an
hour argument which will be the callback
once this insertion has been completed
or again an error has occurred so I get
the error or a result I will again
assert if we don't have an error so that
we only continue if we do not have an
error and then I just want you well lock
to the console that we inserted item and
then I will close the database
connection by right typing we're using
DB closed now we could test this but as
of now we would not be able to see if it
were it because we haven't specified to
get data functionality so let's do this
next to get data
I will also open a connection to my
database here so I will use Mongo
connect to the URL and have the very
same function or call bag i eated have
whenever as inserting items of course
because this is just a connection thing
here I will then copy that assert test
here or this check if we do have an
error
and if we don't have an error I will get
the items now getting the items a little
bit different you inserting one because
here obviously were just well pushing
something into our database but we don't
have to store any result value here I
will get something back so we'll create
a new variable which we'll call cursor
because it will be a cursor pointing to
well the data we're getting back and I
will use DB collection again and use of
course the same collection as below when
we insert data but now I will call the
find method which will get me all the
entries in this collection and all these
entries where pointers to these entries
are stored in this career variable now
in order to get the actual data I will
run through all the entries I've found
by using cursor for each and then a
function which should be executed on
each of these items so this function
will be one that has first F argument
which will be the current document and
possible error again let's assert that
error that error is now and then I want
to store the actual value in some array
which it will once I've got all the
values returned to our view so in order
to do this I will create a new variable
here at the top which will call me salt
array which is an empty area to begin
and here I will then push all the items
I'm extracting here so I will push dock
which is the current item where we're in
we're at the current iteration so we're
running through all the items our career
points too and then we're getting each
item in each iteration which will be
stored in this dark variable here and we
just push this dock our very
onto a results array so this will be the
items through which we run and then I
will have a number call back here in my
foreach loop because this will be
executed on each iteration but after all
these iterations I will have a callback
which is executed once
well once I have looped through all the
items I'm pointing to you so in this
case I then want to close my database
because I'm finished I'm done I
retrieved all the items I wanted and I
will render my index page and it doesn't
work they do this in this callback
because if I would do this outside of
this whole block here it would get
executed immediately because this plot
runs asynchronously
this means we started and then we
immediately continue with the next
command we might have here so if we
render our you here it would not
actually have data because this might
not have yet finished so we couldn't
output the data therefore we're
rendering the view once we're sure that
we're done fetching all the data and
here I will render the index page and I
will pass the items the result array I
created and items is a variable which is
used in the view here to output them so
that's been a lot of coding let me
restart the server and I get an error
here right this should be assert equal
of course so let me restart the server
reload this page load data won't get me
anything
insert some data like this is a test
test the content by me and now let's
load data and I do have a tiny mistake
here this should be error so now start
and let's try this this is a test test
content max insert load data and also
got some other data this is because
behind the scenes I was looking for this
error here and I well tested it of
course and therefore I have our data
here but this is the data in our
database and this is how we insert data
now regarding updating and deleting
we'll have a look at this in the next
video see you there bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>