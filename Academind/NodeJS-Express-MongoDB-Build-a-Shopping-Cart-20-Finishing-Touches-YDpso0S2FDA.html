<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>NodeJS / Express / MongoDB - Build a Shopping Cart - #20 Finishing Touches | Coder Coacher - Coaching Coders</title><meta content="NodeJS / Express / MongoDB - Build a Shopping Cart - #20 Finishing Touches - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>NodeJS / Express / MongoDB - Build a Shopping Cart - #20 Finishing Touches</b></h2><h5 class="post__date">2016-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YDpso0S2FDA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back everyone time for word
finishing touches of this serious and
yes you could add many more features I'm
aware of that but it's called shopping
cart after all I think we really got
there you saw how to create a shopping
cart who to store it in a session how to
manage it how to store orders how to
make charges and that really is a lot
I prefer making new series instead of
stretching this series out endlessly but
I'll come back to this at the end of the
video of at first well let's finish this
so where are we at right now well
together a shopping cart here and we can
add our items to the shopping cart now
we can go to the shopping cart we can
check out there's one thing we can't do
these actions here won't work
reduce by one remove all that doesn't
really work the way it should right so
or currently doesn't work at all so we
should wire that up so that we're able
to manage the shopping cart and remove
items or reduce the quantity of an item
by one so that is what I'll do in this
series or in this video back in my code
I'll start my cart model for that
currently I get my function here to add
new items but I don't have any methods
to reduce the quantity of an item or
remove it totally I'll start with the
reduced by one functionality so add a
new method to this model here I'll name
it reduce by one the supporter should be
a function and this function will get
the idea of the item of which I want to
reduce the quantity and what do I want
to do in here well basically this
function should be kind of the opposite
of the add method here it should reduce
the quantity of this items of this item
group of the aggregated amount of items
here it should reduce the price by the
price of one single item so it should
adjust the price at the end and it
should also remove or reduce the total
quantity
the card items as well as the total
price so that is what I want to do
really just the opposite of the add
method well as it is the opposite it
shouldn't be too difficult I can access
my items and that access the item I want
to change by ID add I can remove or
subtract decrement the quantity by 1 so
now I removed one well amount off that
item I also want to adjust the price so
ID and then prices the next field I want
to take care about and here it can
either simply recalculate recalculate it
or I can also reduce it by the price of
one single item and I'll choose the
latter approach so Alves again selected
then select the signal item which we do
store in this item group keep that in
mind we have the information about one
single item and then I want to subtract
the price of one single item so with
that I'm setting D or I'm adjusting the
overall price of this item group let's
say the Gothic video game for example
I'm setting this total price to D well
old price minus the price of one single
item since I'm removing one single item
with that we're halfway there but I also
need to adjust the card totals so the
total quantity of the card should also
be decremented and D total price of the
card should also be adjusted by the
price of one single item here in the end
because well it changes by exact same
amount as the aggregate of this item
group does change so with that we're
almost there and I want to implement
this functionality right now so the
place to implement it of courses in my
index chairs file where I have my routes
here I'll go to my add to cart route and
well the place is totally up to you I'll
enter my new route load
the route should be a get route now
we'll just call it reduce slash and then
the idea of the item which I want to
reduce of course I have my middleware
function here in this action here in
there's function here I want you well
call my reduced by one method I just
created on my card model however for
that I first also want to retrieve my
card as I always did so I'll just get my
card here and then I can call card
reduce by one and pass the ID to it
since this action or dysfunction expects
to get an ID keep that in mind
thereafter I can store my card in the
session again like so and then I want to
redirect the user and I want to redirect
a user to D shopping card route so with
that in place I will restart my server
here and I also need to go to my
shopping cart view and hook up this
route so this should be reduce and then
I need to insert the ID of that and I
want to reduce and I can access this ID
on my item and then on the underscore ID
field since underscore ID is just e ID
field I get back from my MongoDB with
that if I save this and reload my
shopping cart page here if I hover over
reduce the one you already see that
while we're querying this new route and
if I click on it I get the error that
IDs not defined ok that was unexpected
so let's have a look i de clearly is
undefined because I'm calling a product
ID here so little must take certainly
show to watch out for that so restart
the server now
and then go back here try this again now
it worked but you all did see something
I don't like here we get this zero
pricier and a quantity of zero but it
should disappear if everything is zero
right I don't want to have it in the
shopping cart if the overall amount is
zero because what sense does it make to
have this item in a shopping cart if we
don't have anything here and the worst
is I could reduce it even more and now
we would have a negative quantity at hey
now we can shop for free or now we even
get money back so that certainly is not
the behavior I want and I do need to
adjust this here in my reduce action
specifically I'm not changing it here
but in my cart model here in here in D
reduce by one action or function here I
need to check if the quantity is equal
to or smaller than zero in which case I
want to remove this item and not reduce
it any more so therefore I will check if
this items select by ID quantity is
smaller or equal than 0 in which case I
want to get rid of it and I can get rid
of it by simply calling the or using the
delete keyword and then deleting this
items ID that will delete the item if we
have a quantity which is zero or smaller
so if I restart the server with that in
place and I reload my page here and
click reduce again now it's gone and now
that's gone to you and I got no items in
cart which is great which is what I want
though of course this is still wrong
here on the right because well I messed
this up early on so I'm just going to
clear my session for now to start at a
fresh cart again or a fresh app again so
with that I'm able to reduce the amount
by one but of course I also want to be
able to remove and I
entirely right so not just reduce but
one but also have this remove all button
work that's what I need to work on next
so time to add the remove item method to
it so remove item should be a function
which also gets an ID because I need the
ID of the item I want to remove and then
for one I want to delete the item but
before I do that I also want to adjust
the shopping cart so I can't almost just
copy that but that would not work
correctly the reason why this will not
work correctly as that right now I'm
reducing my quantity by one but I need
to reduce it by whatever quantity I had
on this item before since I want to
remove the item entirely therefore the
right approach here is to select the
item by ID here and then take the
quantity off that item off detail the
quantity so if we have three copies of
the gothic in the shopping cart
and we remove it well then we should
have no copies left the same is true for
the price I'm not interested in the
price of a single item but in the
aggregate price here so with that I'm
adjusting the shopping cart correctly
and then I'm removing the item from the
cart it's all the times you hooked it up
and you're out followed that so I copy
mine reduce route here because it is
very similar I call it removed here
though and I'll still fetch the cart
that's all fine but then here I want you
remove an item of course then I'm good
to go so with that I can go to my
shopping cart view I will copy the route
from the reducer out here and just
replace this with remove very simple
restart by server after that reloaded
here looks good and then I'll add a
couple of items to my shopping cart like
so and then let's see I reduced is it's
gone I removed this entirely it's gone
you also saw that totally updated
accordingly and then remove this and
it's also gone and
see no items in card which is what I
want to see here excellent
so that really looks great and with that
we got our shopping card finished now of
course there are improvements you could
put into place and of course you can
enhance the son of courses will not
suffice the needs of a very complex shop
but it does show you how a shopping card
works in its core how you can use note j
s to set up such a shopping cart how to
use an external library like stripe to
make charges and to easily hook up your
shopping cart to the capabilities you
need to actually earn money with it and
well to charge customers you also how to
store orders now to retrieve it how to
manage your card and from that point on
it's really up to you to take this
challenge and expand this card expand
this application add new features make
it more robust find potential errors
this application might have or where you
can improve it that is where you really
learn the most I wish you a lot of fun
with that but of course I'll be back for
future series on no GS and so on and
we'll learn much more but I really have
to have state of this series I'm happy
to see you in all the future videos bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>