<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LARAVEL API + SPA SIGNUP | Laravel + Angular 2 / Vue.js 2 | Coder Coacher - Coaching Coders</title><meta content="LARAVEL API + SPA SIGNUP | Laravel + Angular 2 / Vue.js 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LARAVEL API + SPA SIGNUP | Laravel + Angular 2 / Vue.js 2</b></h2><h5 class="post__date">2017-02-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9Jf0Etr8CEE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome welcome back to this pointless
to this series where we use letter vole
together with English Q and VHS and in
this video we're going to have a look at
authentication now in the last study we
had a look at the theory behind that now
we're going to start implementing it on
the back end first and what do we need
to be able to authenticate users but we
need users right now in the level
application in the app folder we already
get a user file a user object the model
here by default and then the model the
level application ships with now you can
also create your own one I'm going to
use the built-in one and I'll leave the
model as it is this is all I need for
now
I also need an entry in the database
though and for this any database folder
in the migrations folder I need a
migration file for this user model now
maybe you already have to file I deleted
it so I'll recreate it and for this I'll
go to the consult terminal here in the
project folder and I can create a
migration saw with the artisan command
line tool and then make colon migration
give it any fitting name like create
user table something like this and with
this you see a new file was added here I
can now copy my schema create function
from the quotes migration file edit here
and name the table users the naming is
important it should be users so that
level actually is able to point this
table when it is looking forward table
for the user model the cost to table
name is always lowercase plural form of
the model name so looking for users and
their what should we have we should have
the ID field increments as okay so
incrementing we should have a timestamp
or we should have the timestamp say and
we also want to have a string field to a
text field a short text field holding
the name of the user you can see this
here in the user model we have name
email and password by default so of
course you can change that you can
adjust it to your needs
now besides the name I also want to have
a string feel the text field which holds
the email and this should be unique so
change unique method and then I also
want to have to remember me talk in
which you're not going to
youth but if we don't add it here well
our app is going to break so let's
simply add remember token for now I also
have we got everything we need besides
the password right so let's duplicate
this string filter once again add the
password of course they should not be
unique because well no reason to make it
unique but probably not lead to the
desired behavior of our app I will never
get everything we need important thing
here about the password field don't
restrict it don't restrict the amount of
characters exhibit can hold because
we're going to hash it later we're going
to store the hashed value and the hash
will be longer than the actual password
so don't restrict it or if you
absolutely need to restrict it it should
at least be able to hold 60 characters
so with this setup here we can also add
the function for the down key face here
here if we roll back migrations so here
we simply drop the users table and as
again as if we roll back our migrations
then this removes the table so that the
migration file is created now back in
the terminal we can run PHP artisan
migrate to run those migrations now
chances are that for you you already had
a quotes table I removed it before it
started recording this video so it ran
both migrations it definitely should run
the users table migration with that
being run we can go back to the app and
here in the app folder under HTTP in the
controls folder I want to create a new
controller now we could also use the
addition command line tool for that but
I think it's worth practicing this from
time to time by doing it manually and
they're all trade a new file all damaged
user controller the PHP now you could
use the bulk in off controllers but
we're going to use a different way of
authenticating users later so I think
it's a good idea to create your own
controller now I'm going to copy the
start of my quote controller because
it's equal or relatively equal I can
remove the quote import and of course I
should rename it to user controller
that's important and with that I want to
start by adding one simple method public
function named signup which allows me to
find a user up to create a user here I
first want to validate the input for
this I need to get access to the request
so I'm going to inject this why this is
why I added the import at the top and
check the request and then with this
validate we can validate the request
against our set of rules here so for
example that the name should be required
that the email address here should be
required and should also be an email and
it should be unique unique in the users
table this is how unique works you pass
an argument by adding a column and the
argument is a table name you want to
check the field here and this will be
the color name it will look for it so
here for this validator it will check if
in the users table we have an email
column and if in this column we're
already using this email address with
this we're making sure that we're not
trying to store email address which is
already taken oops now with that I also
want to validate the password of course
so password should be required and you
could also add a minimum lang for
something like this I'll leave it like
this and now you might wonder how does
validation gear work because we're kind
of sending the request differently we're
not sending a request as we do the
normal metal app because we're not using
the lateral views right I'll come back
to this with validation place if
validation succeeded I want to create a
new user using my user model which they
import from app back slash user and we
can use this mass assignment syntax but
passing an array as an argument to the
constructor to set the name year to
request input name to then also set the
email to request input email and of
course to set the password to whoops
request input password you could think
but we want to encrypt the password
right storing it like this
the raw value would be terribly bad
you definitely want to encrypt it and we
can USB bcrypt helper method to do so
this will attach our password and store
the hash in the database important it's
a good practice to not only encrypt it
here but all that you have a HTTPS
connection so a secure connection
between client and server so that the
password is encrypted at all times so if
this we're storing we will be creating
the user
let's now store it in the database with
the safe method and that's almost all
now other ones return a response in a
normal level at we often return a view
here I'm returning a well the response
helper method I'm returning a JSON
response jason is this JavaScript object
data format I'll set the status code to
201
does the second argument of the chase
method the first argument is an
associative array which kind of is the
JavaScript object we sent back so you
can think of these square brackets
getting replaced with curly braces later
on and I want to have a key of let's say
message and say success fully created
user something like this of course you
can find you this to your needs with
this in place we also need need to add a
route so in your route folder in the API
folder I need to add a new route down
there it should be a post route and it
should be slash user let's say because
we create a new user and to configure
this route with this array I'll set up
the users key and point to my user
controller and their D sign up method
this should be all let's now go back to
postman to test it I will let of course
also show you how to do it and you real
angular affronted but for this we need
to create a signup form there too now I
want to just check if it works so back
to postman we should enter the URL to
our application for me this is this URL
don't forget these slash API at the end
make sure to use your URL slash user
than at the end and there should be a
post request because we added such a
post route and we send some raw data in
the body and there should be some JSON
data the data I want to send of course
is to make
and don't forget the double quotes here
we're sending JSON data so the double
quotation marks are important name could
be max you always want to send an email
that could be tested task.com whatever
you like and finally password this could
be test one this could be the data we
send but if I hit Send now we see if we
click on preview we see the lot of a
starting page now what's wrong here
well lateral is not getting that we're
sending JSON data so it's not able to
retrieve our data correctly and
therefore it's displaying as the home
page because we're getting redirected
back kind of to the home page with an
error with which we don't see because we
don't edit code to display it but we're
not able to get our data to the back at
this is what is happening so we need to
inform level about which data we're
sending we do doesn't the headers tab
here by setting some headers and we need
to set the content type header
oops content type Q application slash
JSON this informs lateral that some JSON
data is coming and this allows it to
retrieve it correctly now if we hit send
again we get back successfully created
user and that we have a look at our
database using sequel Pro here we see
that indeed a user was created here we
see that the password also is hashed
this clearly is not the password we sent
there now let's try creating another
user with the same email address if you
had send again well we see that starting
page again what's going wrong here well
we need to set one additional header for
validation to work we need to set the X
requested with header and set this to
XML HTTP request which tells level hey
this is an ajax request now with setting
this header here - if I hit Send again
now I get back my error message instead
the email has already been taken I will
tell you see how validation works it's
the exact same validation code you would
use in a normal level application with
this validate but it
texts that we're setting @hx requested
we're sending such a ajax request and
therefore it sends us back any error
messages we might get any validation
errors asked Jason beta so it doesn't
send us back the normal home page it did
before when we didn't set this header so
it didn't know that we sent a ajax
request but if it does notice we get
back to request ask Jason data to add
response excuse me to get back the
errors in JSON format and then we can
use them in our application we've
altered this later when we hook up
everything but first let's move on to
the next video where we actually sign
users in see you there bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>