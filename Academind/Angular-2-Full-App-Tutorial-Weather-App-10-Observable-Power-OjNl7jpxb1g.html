<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular 2 Full App Tutorial - Weather App - #10 Observable Power | Coder Coacher - Coaching Coders</title><meta content="Angular 2 Full App Tutorial - Weather App - #10 Observable Power - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular 2 Full App Tutorial - Weather App - #10 Observable Power</b></h2><h5 class="post__date">2016-05-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OjNl7jpxb1g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back time to not only have to
profile styling here but also to well as
a me to yet make it work I want to
manage my profiles for a profile service
so I will create a new service a new
file first called profile dot service
and then dot TGS of course for
typescript indeed that folder here and
this service of course will get exported
profile service and all this service
should do is just manage my profile so
an array of profiles add a new one
delete one and get my profiles so in
order to do this I will add a new
property which should be private called
profiles and this should be of type of
profile array of course at the import to
your custom profile class here and this
could be an empty array but I want to
provide one default profile and now keep
in mind since I only provide a list of
city names here this actually works is
no dummy data these city names will be
looked up in open weather map so
whichever city names I specify here as
dummy data will actually work later on
and will be looked up so I will trade
one single you profile here the default
profile I want to have and I will gift
us a name of default profile and then I
will add an array of strings so of city
names in my case and as you probably saw
before I really like in New York and I
like London and will live in Berlin so
let's add this she was your favorite
cities here of course and this will be
the starter kits here to say but of
course I want to be able to add new
cities or new profiles to this area in
order to add new profiles I will add a
new method called save new profile which
will take the array of cities which is
an stringer in the end as an input
now I want to give each profile a name
and you could let the user assign us but
I will auto-generated name and I will
have an incrementing number at the end
of my profile name so profile 1 profile
to profile free the good thing is I
can't just take the current every length
as a number since the first profile is
called default profile if I add a number
1 the second profile in this array I
will give this name profile 1 and then
an expert profile 2 so I can just use
the length of the array so I will use or
create a new constant profile name which
should just be profile and then the
number this profiles length so the first
profile add by the user will be called
profile 1 which is what I want next I
will create a new profile by well using
a new keyword and creating a new profile
by based on my custom class and I will
pass the profile name as well as well
the city's array here which is a string
array which is exactly what my profile
class expects here by the way I forgot
to add this public key here in front of
Celeste's is important to use the
shortcut of not only passing data to the
constructor but also automatically
creating fields in this profile class
should have mentioned that before sorry
about that
here is the explanation and also make
sure to add the public key word here
before cities so with that I can now go
back to my problem profile service and
now I want to access my profiles array
and push this new profile onto it like
that and that's really all you know
saving is great in order to all to be
able to see it I will add a new method
called get profiles which will just
return this profiles array
so that's awesome let's see this in
action and add this to well the rest of
our apps so that this actually works
therefore I will go back in the sidebar
component and the template looks fine
but now I want to add a new property
tudas class to this component and I will
call it profiles to make this an array
of profiles of course also add import at
the top here and this will be
uninitialized at the beginning next I
want you in check to services the first
one being my profile service I just
created also at the import and I will
also need my weather service because I
want you reach out to that to fetch data
about the cities in a profile later on
so I will also inject the weather is
service here now the injection of the
Webber service will work because I'm
providing it on a root level and the
boot dot yes fall
however the profile service also needs
to be provided therefore I will add the
providers metadata here since I will
only need it in this component and I
will set the type here to profile
service to let angular to know how to
create such a profile service I want to
get unchecked it here next would be
great to get a list of all profiles
which are saved upon initialization
which will of course only be the default
profile since the let rest will get
wiped out whenever we restart yep but in
a real application where you would fetch
these profiles from a server you would
of course get them all so in order to
implement that I will use the on in add
lifecycle hook so implement you ng on
init method here and I will set this
profiles equals you well just use my
profile service to get profiles and also
add the on init method at the top from
English
core so if this I'm getting all my
profiles up on app loading so if I know
have a look here you can already see
this dummy profile now in order to see
this I will go to my template and
replace the stomach code here I no
longer need this placeholder text in the
title so I will use string interpolation
to our put my profile name but wait I do
have an array of profiles right not one
single profile in order to use this I of
course have to loop through this array
and create such an article here for each
element in the array that's easy to do I
will just use D ng for loop and then I
write hashtag profile and important out
here this works as of beta version prior
to beta 17 after Peter 17 it still works
but you should use lat
instead of hashtag this was changed to
clear up some confusion with local
variables and references in your
templates where you have this hashtag
being used to create reference to this
button element here and the hashtag
being used in the energy for loop as
well so you may use hashtag and you
should use it if your version is prior
to Peter 17 but from that on use let
instead but with that being said I will
loop through all my profiles with the ng
for loop here and now I may access this
profile variable here inside this
article of course since I'm looping
through it so here I will set the title
to profile and then profile name and the
cities should also be output and I can
use string interpolation your cue
access my cities which is of course an
array and I'll use the JavaScript join
method to join this area into a single
string separated by commas like this so
comma and a space empty space so this
will transform my array of cities into a
long string separated by commas now if
this if I have a look at map location
doesn't look too bad does it I have my
default profile with the cities I
specified I want to make one extra
change if I delete a profile I now also
want to pass this profile which should
be deleted so that I can later on
identify the right one so if this were
outputting the profile next step is of
course to allow us to really add our own
profiles this is done by implementing
the spawn save new method here on save
new and here I will create this cities
array I need to pass to my profile
service and I will of course get this
array from all the cities I currently
have list here below my search bar which
disappeared because I now have an arrow
since I didn't finish my code but you
know what I mean right so I need to
concatenate all the cities I searched
and saved already or yeah which I got
weather data for I can of course get
these cities by accessing my weather
service where I store all my whoever
items so by getting all my favorite
items and then I want to use the map
function this is a Bolton JavaScript
function which I can use on an array and
here for each element in this array I
want to do something I want to return
just the city property so the map
function your basic allows me to access
each element in an array and just get
one field off the individual object and
then again return me an array of these
fields instead of an array of letter
items which I don't need I just
DeRay of the cities of these whoever
items and this is how I can do this
now phpstorm complains that it as known
as city property on this element but I
know it will be there and I can tell
phpstorm by adding a type declaration
which is always a good play practice by
the way so this note will not be a
weather service it will be a weather
item and it complained correctly as I
just recognized this should be city name
oops
so now that works city name and with
this as it's just explained I basically
get all the individual cities and add
them to one area of cities now I may use
my profile service and call the save new
profile method to add this array of
cities now if I have a look at map
location search for boolean again and
click Save list to profile you see that
a new profile was created with Berlin as
a city now of course clicking on these
profiles as well as clicking on the axis
here doesn't do anything as of now but
will soon get to that so that really is
a final step of this application make
these profiles clickable and deletable
and to be honest that is not that much
work so what I do now let's start by
making them clickable so that if I click
on a profile I load it and automatically
search the weather data for all the
cities in this profile and output them
here where we currently only have Berlin
of course I also need to clear the
existing weather items here as I don't
want to append them but instead replace
this data so I want to load a new
profile and not append it to another to
be able to get rid of the existing data
I need to add a new method to my weather
service and I will call this clear
weather items and here I will simply
take my Webber items array and splice it
reply serie will begin at the first
element and since I don't specify an end
we'll wipe out the complete array with
this back to the site bar component
where I can manage my profiles or load
them I will add a new click listener to
this article click on load profile and
of course past profile which should get
loaded I will add a new method in the
body of this component on load profile
and of course this gets such a profile
passed into it of type profile of course
since we're looping for an array of
profiles which all have this type
profile here and the first thing is I
will call my weather service clear
weather items method let's try this
works so if I search for Berlin added
and click it's gone
so dis works good first step the next
step is to fetch the data for all the
bevor I teams in this profile or for all
the cities in this profile to do this I
will simply loop through all these items
so through all the cities in this
profile and then for each city I want to
call my weather service search the
weather data for this city
just by accessing it with the current
iterator this single city and I also
want to specify the retry operator an
operator introduced by rx Ches of course
which will just make sure that if for
some reason one call should fail because
open Weber map is currently under too
much load or whatever it will retry to
fetch the data for this city and I will
then of course subscribe to this
observable so why configuring it that it
should be retried upon error I then
subscribe to it to actually send a
request and in the good case or in the
case where we get back data I will use
the state and this will be the data for
this individual city to create a new
Weber item so also import Weber item
here at the top and pass like well like
before I may just copy that from the
Weber's search component to be honest
because it is the same code here we're
creating exactly the same Weber item
just not with this day that's just only
use data so great as new ever dated
weather item here and thereafter use it
to well call the add Weber item method
in the Weber service and pass this newly
created Weber item so with this if I
save this and go to my app and click
here and then you get the strange
forever now this behavior comes from
little arrow here in the profile service
my default profile shouldn't have one
string with comma separated cities but
instead have multiple strings one for
each city so so now if I save this and
try this again this looks much better
and I get the Weber data for these free
cities cool thing in my opinion last
step make profiles
deletable that of course isn't difficult
at all
I'll just implement the only profile
method I'm calling when clicking on the
X and here I will get my event as well
as my profile and I will then first stop
the propagation of this event to make
sure that it doesn't bubble up and of
course I will call my profile service
and here the delete profile method
however this method pasty profile hasn't
been created yet so I will do that
the profile service I'll add this final
method delete profile which expects to
get a profile as we already passed it
into it in the side bar and here of
course I will access my profiles array
and here I will call the splice method
splice from the position of this profile
index off profile and then just one
element you only delete this single
profile which should be deleted and
we're good so let's try this okay this
worked I will create hey I am mistyped
but that's ok I will create a couple of
profiles here so this is the first one
and let's create create a number one
this and now if I delete this one works
great but for example you could also add
a button here to clear this list simply
be calling this clear weather items
method we set up in the Webber items or
in the weather service but for now I
will leave it like this I have the
application I wanted we are able to
search for weather save it and new
profiles
load our profiles delete them and I
think or I hope you really learned a lot
about Englert you hear again about how
to use observables how to work with data
use services to
and several components interact with
each other and yeah I'm looking forward
to all the future videos all to you on
angular 2 and other stuff as well be
sure to share your feedback and I will
see you in the next videos bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>