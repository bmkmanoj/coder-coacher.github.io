<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular 2 Full App Tutorial - Weather App - #9 Requesting Data via HTTP | Coder Coacher - Coaching Coders</title><meta content="Angular 2 Full App Tutorial - Weather App - #9 Requesting Data via HTTP - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular 2 Full App Tutorial - Weather App - #9 Requesting Data via HTTP</b></h2><h5 class="post__date">2016-04-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zszkRlvN5os" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back everyone here's the state
where we left our regular to ever up at
the last time we while we have a
nice-looking app already but currently
we're not fetching any data from the
Internet we're not really fetching any
weather data I want to start with this
now though
because I think now it's actually time
to well at this very important feature
to this application now to get data I
will use Open Weber map org because they
have an API which you can freely access
to get weather data now the access is
free but you will need an API key to
well should you access it doesn't cost
anything but you will have to sign up
and you may just click this link here
and then sign up to get the rape API key
specifically we will use these current
weber api and here you got a
documentation how to get the weather for
certain city names and so on and this
will be exactly the API endpoints we
will use of course now in a first step
of this app I won't implement the order
with search functionality that it would
suggest a city matching your your typing
here but I will just make it that you
have to type a correct city then click
add city and if this city exists and
it's been found by the API you will get
the weather for it and the next step I
will of course also add the other
functionality so provided that you
signed up and got your API key let's go
back into the editor and make the
required changes in the weather service
here I want to add a new function and I
will name this function search weather
data for example and then this function
will take a city name which should be a
string as an input and a bull of course
return and observable
which will hold some response data
object now to do this I will need the
angular 2 HTTP service so I will inject
this in a constructor
I will also bind it to my private HTTP
field here so HTTP to use the angular 2
service and of course you need for one
this angular 2 slash HTTP import here
and you also need to make sure that you
provide these HTTP providers in your
boot RTS file and in your index.html
that you are importing this HTTP module
or package of angular 2 also what I will
add right away since we will add it or
need it anyway is the import of all the
rxjs operators like the map operator
which we will use on your server now if
you're totally new to angular 2 HTTP I
recommend you watch one of my other
videos where I explain more about it I
will take for granted here that you know
how to general use it and that it
returns an observable and so on so what
I will do here is I will return of
course something and something is such
an observable which I will get from
angular 2 is HTTP service and since I
want to get data I will use get and now
I need to provide the URL which I want
to access now back on in my API
documentation here for the current
weather you see that we want to find it
by city name here of course so what we
need is this URL so we'll just copy that
and then enter it here as a string and
at the very end I will need to replace
this city with the city name we're
getting here as an argument so a city
name also I will append my API key and I
do this by using and and then app ID is
the query parameter open weather map
will look for app ID equals and this
should equal your
see here so here's the place where you
should enter your API key for this to
work I will enter mine in a second I
will also add an upper query parameter
with a + sign here and those optionally
you don't have to do this but I will set
my units to metric
since I'm in Europe and we have the
metric system but if you're in the u.s.
you may of course leave that out or set
it to let's see what is this what's the
hour option you can see it down here
units format you can set it to your
period to get far in height instead of
Celsius so these are your choices so I
now get this set up here but the next
step of course is to add the map
operator to transform the response we
get back so I want you take the data
part of this response and get it back as
a JSON object which I do by using the
Chasen method on this response we're
getting back also if we should get any
error what I wanted you is I will get
take this error and then for one out put
it in the console and as an hour step
very important this still needs to
return an observable so I will return
observable fro and then here I may pass
the error or deep-well extracted error
so this basically does the same as the
map function here but it does it for
well the error case and by calling Jason
on the error what we'll get as the
actual error data attached to this error
with some information probably as a
chase an object which we could use in a
more elaborate error handler so we get
this and this is fine for now now if
this being set up the next step leads to
this Webber search component where I can
submit my form in this onsubmit method
and when I click this
submit I want to actually go out to the
service and get the lever data for the
city I entered here so in order to do
this I will well access this method in
my service and therefore I will first
and check my service here so private
Webber service and of course I also need
to add my providers here and here again
if this is totally new to you I
recommend checking out the video on
dependency injection I have but
basically what i'm doing here is again
telling in order to how to create such a
weather service which i require here so
with this i can now access it here which
will of course do and i can call search
weather data here and I will pass of
course well the city name entered which
is weld of my four year and I don't want
to you form as a whole I want t value
which is adjacent object representation
of this form and I know that I will have
a control of location so I can access
this like this in this chase JSON object
and this will well pass it into this
function now in order to fire this
request of course I have to subscribe to
this observable otherwise nothing will
happen we just configured it we're not
sending it yet so now in the SUBSCRIBE
method I want to handle the case that I
get back some weather data and what do I
want to do with this data then I want to
create a new Webber item and I want to
add this 2d array of dummy Webber items
I have until now so in order to do this
I will look here at my favorite item
which currently they have a city then
the description forever entity
temperature so I will create a new
method ms service which of the call
at Weber item and this will expect Weber
item of 20 Weber item of course what
this will do is simply use my Weber
items array and push onto it
this new Weber item back in the Weber
search here I will create this Weber
item which I want to pay it pass later
so we'll create a new Weber item and as
always make sure you are importing all
these classes these modules were using
here and of course my Weber item expects
some input here it wants a city name the
description of the Weber and it wants
the temperature now how can we get this
data from our response let's see what we
get as a response first so I'm so well
already there if we have a look at an
example response this is what you will
get back this JSON object we see we have
to name here so we can access a field
name in this JSON object
we got a Weber item which is an array of
JSON objects where the first M object in
this array seems to have a good
description of the of the weather you
may also use this description whichever
you like clouds are just broken cloud so
I will use broken clouds here and then
the temperature can be found here under
main now this of course Fahrenheit gets
pretty warm otherwise but if you
requested it with the metric system you
will get back Celsius so this is a new
main object and then the temp or maybe
we want to temp min whatever you prefer
so in order to get this I will first get
the city name by accessing data and the
name because remember this is top-level
field in our data object here
next I want to get the description of
the Weber which we can get by accessing
dot Weber then the first item off the
area and then dot description so let's
do this data then Weber
the first area item and then description
and as a last step I want to access the
temperature which you can find under
main and then temp
so let's try this data main temp this
should construct a Weber item which
contains all the information we want our
better items to have so let's try to add
this to our array I do this by calling
this Weber Cerebus add Weber item and
doesn't of course the newly created
Weber item here now the problem would
have here is this would not update our
list because we're providing Weber's
service in this class which would create
a new instance we want to use the same
instance we use here in our list so in
order to do this I will get rid of this
provider year 2 and I will step provided
here in the bootstrap method so that all
our classes and components use the same
instance off this Weber service so now
before I try this out I will set my API
key and then we will test us so in the
app here I'll just written reload for
safety reasons I'll try to search for
bullying and well we have a problem with
key URL here this should of course be
HTTP at the beginning otherwise as you
see here it looks on the localhost
so in German insert my key here and then
try this again
so just reload this and let's try
looking
or Berlin again and as you can see it
added it here that looks good
I'm sitting in Berlin I can confirm this
information here is correct so let's try
in New York okay clear sky all the New
Yorkers can you confirm that today is
20th of April this is the weather I sure
hope so and this is how we reach out to
the Internet to fetch our data</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>