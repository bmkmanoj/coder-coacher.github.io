<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Prevent unauthenticated Access | Vue.js + Vuetify + Firebase FULL PROJECT | Coder Coacher - Coaching Coders</title><meta content="Prevent unauthenticated Access | Vue.js + Vuetify + Firebase FULL PROJECT - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Academind/">Academind</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Prevent unauthenticated Access | Vue.js + Vuetify + Firebase FULL PROJECT</b></h2><h5 class="post__date">2017-08-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XljsGqsZyL4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back to this video in the
previous video in this series we added
functionality to write data to the
firebase database and get from there and
we recognized it in our app we can
create and you meet up even though we're
not signed in now in this video we'll
fix this
actually here's one thing you can see in
the firebase console on the real-time
database tab or area here you see that
the default security rules require users
to be authenticated and they do here
under rules this basically reads as
you're only able to write and read data
if you're authenticated watch my video
with aid from the firebase team to learn
more about rules on how they work so
basically I can tell you that only
authenticated users are able to read or
write but we are not benefitted in our
app and still we're able to do so right
how's that happening then happens
because we use the firebase SDK and
behind the scenes when the right data
will retailer with the firebase SDK it
will send a token which is stored in our
local storage when we do sign in queue
the server to the firebase servers and
since we did sign in in previous videos
and I still have a valid token in my
local storage you can by the way check
check this if you go to application
local storage and then click on your
domain here you see firebase is managing
some keys for me some data so you have
tokens here and that is why firebase
indeed does send them to the backend and
I am authenticated we just don't see
that here and now all the would want
some protection you're on the front end
to make sure that I can't do that if I
am not signed in there's a super easy
way we can make sure that I'm not even
able to click or to go to the
organization page here if I'm not signed
in and that is a guard we can use a
route guard to make sure that whenever I
try to visit this page and I'm not
offended I'm not able to write here so
with that what I can do is I can create
a new guard in my application I'll do
this in the router folder because it is
routing related and here I will create a
off guard dot JS file now this is simply
a function 1 to exporter
holds a function which takes three
arguments q from and next the view
router and forces us to have these free
arguments that function because it will
use that function together with a view
router route in a second so this is just
an arrow function here but in the end a
normal function and in there q refers to
two routes we want to go to from two the
one we're going over coming from and
next simply means this is a function can
execute to allow the router to continue
we can also execute this as a function
and pass a URL we want to redirect you
all I want to do is I want to check if
we get a user in our store so if in our
store we get a user now you're wondering
where store coming from can just import
store from the store folder and
therefore from the index.js file there
so that's the store we're managing it's
the same store using in the rest of the
application so if we got a user here we
are authenticated in this case I want to
continue I'm just calling next which
means continue with what you plan to do
which is probably visit some route but
if we don't have a user I also call next
but I pass slash sign-in which basically
redirects the request to the slash
sign-in route which is of course the
route here now to use that guard I stay
in my index chest on the router folder
where I have all the routes set up and I
want to use it on this meetups new page
but super simple to edit all I have to
do is add a new property to that route
configuration which is called before
enter and here I want to execute my off
guard so I need to import that I'll
import my off guard from the dot slash
off guard
jas file without the file extension as
with all the other imports so here the
four enter just takes off guard and keep
in mind off guard
just imports the key for
export which is just dysfunction that's
all with that I'm protecting this route
and I'm also copying this to the profile
page which are all the only one to be
able to visit if I am up indicated with
that if I go back to my firebase
application Meetup click on organize you
see I'm redirected to sign in but if I
do sign in like this I click on organize
now I'm able to go there however as I
mentioned technically we are signed it
because firebase is storing that sign
information here so we could still send
valid firing web based requests so why
do we force the user to sign in again if
we already are signed in there's no need
to do so so let's make the bit easier in
our application in main dot Jas it would
be nice if we had some way of locking
the user in if you already is locked and
if we do have that token stored in local
storage what we can do is we can add a
new listener in here for that I need the
firebase SDK which I'm already importing
so I'm adding firebase accessing the all
feature set and Kubik at the on off
state changed method this will be
triggered whenever all the
authentication status changes and
firebase will check for a valid token
being present automatically it will give
us access to the user then so this will
be executed by firebase automatically if
it detects said well either we signed in
actively or that it detects a valid
token is already present at the startup
so what we can do is here we can check
if user is anything else but now because
this will also trigger if we log out but
then user will be null so only if user
is not null so if we find a valid user
only in this case I want to dispatch a
new method and I don't have to be a
method yet but I will name it Auto
sign in and I will pass the user tutors
action now as you might guess Auto
sign-in has
goal of automatically signing in a user
who already has the credentials or the
token actually stored in local storage
so I'll go to my store next and here
under all these actions below to sign in
action maybe I'll add Auto sign in here
I expect to get my commit method and
payload which is the user if we call
these actions we saw a second ago and
here I don't want to commit set user and
pass my user ID will be payload UID
because this payload is a user object
aspect but firebase it holds a user ID
and I will set registered meetups to an
mg array that's all for now with that if
we save this let's see if it works if we
reload this application you see we get
locked and automatically the items here
in the menu changed of course the same
is true for our responsive menu so this
is now working now we're signing the
user in automatically but we're also
making sure that the user is not signed
in we can't create a new Meetup
to demonstrate this I also want to add
of a logout button so that we are able
to well logout and although this VFW
fault where we manage the menu here we
manage the menu with cue arrays as you
can see and all these array chats have
links I don't really need to link for
the logout button so we'll make this
really easier
I do loop through my list tiles here
where I have my menu items are looping
through with all the icons I'll add one
extra list all here in the responsive
menu this list all here doesn't need a V
for a key or a - it's not a link instead
this simply holds an action where I need
a fitting icon for logging out so let's
search one Scout you icons
and they're on the material icons page
and now let's pick icon which looks good
for logging out I'll take this exit to
app I can here so I'll quickly enter
this here between the B I can't ask exit
to app and give it a title of logout and
let's do the same
inside the toolbar of course here where
I loop through my toolbar items for my
buttons here to be precise I'll add one
extra button where I'll use the flat
style they don't need to loop though
don't need the two directive instead
here I'll add the exit cue app I can
with underscores just as before and say
logout now let's see if that works we
reload this get a logout button here now
for what I want to make sure I only see
this if I am locked in so if user is
authenticated is true so let's quickly
copy that and add a V if check user is
authenticated because only in this case
a logout button makes sense doesn't it
so let's add it here to this list tall -
oops V if user is authenticated of
course so let's see if I log begin yarn
we didn't see it at the beginning we'll
see even better once I hope this button
up to an action let's see if that looks
good to death so now let's add an action
to this log out button here so on the
list
tall here and on my button here which I
add it I'll add ad click listener way
say on logout so this was added to both
elements all the to the list all on a
logout and I need to add this method now
so let's add methods on logout and then
here I now can go to my store and
Hach the logout method so I'll just name
it logout we don't have that method yet
or this action so let's add it under
actions here I think it makes sense to
add this below Auto sign-in so here we
have to log out action we may dispatch
let's add commit here of course we don't
need a payload all I want to do here is
I want to commit set user and set this
to null well it's not all I want to do
though that's all I want to do when it
comes to a managing loyalists state
however I obviously also want to make
sure that I access firebase and X my off
features and here I can simply call sign
out to remove this token from the local
storage and so on
so now you see all of sign-in is still
working but if I click logout I get an
error because it makes sense to of
course called store with a dollar sign
in front of it so if I go back to my
application and I click logout you see
this is gone but interesting if I go to
application under local storage you see
there are still far based values but
it's one less if I sign in again you see
the extra off element here is created
that's the important one so now if I
reload the application we still get auto
logged in but if I log out it's gone so
now we enhanced our application to make
sure we're taking advantage of the
authentication status of the user we
can't visit pages we aren't allowed to
visit anymore we also make sure we clean
up our front and state but if we do
everything as we should do then we are
able to login we're not done yet though
there's one other important thing I want
to save my user ID as part of the meetup
here so let's do that I'll get rid of
the old meetup and I'll go back to my
store for this and any days
story here I now want you pass one extra
property to my meet up when I create one
I'll name it creator ID and here I want
to reach out to my gathers thankfully I
can get them here here I can extract
them from this object which gets passed
to an action and from the getters I want
to reach out to my user and get the ID
which we store there that's the ID
firebase creates for us so now I'm
storing this as part of the meetup which
I stored in the database and that's
something super important I wanted to
ensure of all the want to extract as if
I'll load my meetups of course so here
I'll add this to creator ID object key
and then here is the creator ID so with
that I'm storing this ID q and I'm
extracting it with that I can now create
new meetup so let me copy the New York
meetup URL image URL quickly organize a
new meetup here check the console let's
reload everything just to make sure
everything is working as intended so
that's the New York meetup it's taking
place in New York obviously let's paste
the image in there awesome meetup and
now for the last time hopefully let's
pick a date and a time and create a
meetup let's view it here now you see
the creator ID this cryptic string here
is starting with QP and the number P
that's my user ID here so that's this
let's organize the second meet up to you
this perilous meetup here or copy that
it's the Paris meetup taking place in
Paris with the image awesome - and then
let's pick up fitting date for PMA we
create a meetup and we get this - also
with the creator ID so that's that if we
reload this application you see we fetch
this - this is all working fine now with
that
I'll call this a video and in the next
videos I want to ensure that we can do
things like register for meetups and
more awesome things see you there</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>