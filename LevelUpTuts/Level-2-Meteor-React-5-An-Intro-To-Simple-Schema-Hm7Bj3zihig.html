<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Level 2 Meteor + React #5 - An Intro To Simple Schema | Coder Coacher - Coaching Coders</title><meta content="Level 2 Meteor + React #5 - An Intro To Simple Schema - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Level 2 Meteor + React #5 - An Intro To Simple Schema</b></h2><h5 class="post__date">2017-01-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Hm7Bj3zihig" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up the Cisco would level up
tutorials and in this video working it
started with simple schema now simple
schema is a way that you can develop a
schema for your meteor applications and
your Mongo database that way the data
that's coming into your database is more
secure because the database is going to
be knowing what it needs rather than
just accepting any kind of data so the
schema is going to keep your application
organized it's going to keep your
application more secure and the best
part is a simple schemas recently moved
to be an NPM package and not only that
but it's no longer a meteor specific
package it works with other node
applications so that means you can take
these skills that you learn about simple
schema with you elsewhere in case you
need to go to a new platform so let's
get going right now okay so let's keep
this going here we now have our router
and we want to do is add a simple schema
so what we have here is this package al
deed no simple schema now this package
used to be a only meteor package and for
a long time if you would have used the
intermediate meteor series that's what
we would have used however it's recently
has in very recently moved to become an
NPM package and only that but it's going
to work with all sorts of things and not
just meteor as you can see there's even
a change log if you're migrating there
are some simple differences some really
small things for instance if we want to
have something be optional or an index
or something like that there's maybe
some difference in text there we'll go
over that as we go but what we need to
do is go ahead and copy this NPM install
you'll notice something interesting here
when we do this it's not simple spelled
correctly it's actually s impl - now
you'll want to make sure you have that
when I have - - save in here as well the
reason being is this package was
probably already had something into NPM
with that other name this way you're
making sure you're getting the absolute
right package so make sure you get the
spelling correct on that one now what
are the
benefits of using simple schema in order
the benefits of using a schema at all to
be honest well and this type of project
there's not a huge amount of benefit in
this size but as your project grows it's
going to become more and more obvious if
we head to our server actually we what
we want to do is go to our API folder
and inside of here we have items we have
if meteor is server ok we're publishing
and we have our methods and here we're
inserting right we're checking our
variables each one we're saying has to
be a string and then we're inserting
them in here item one item two and
that's great that's really great
but you'll notice when we went ahead and
voted on one what we did is we actually
added a last updated field and we set
the last updated field but when we
inserted in the first place there was no
last updated field and so what actually
is in this items object becomes a little
bit more foggy as this thing grouse what
we don't have is any sort of direct
structure it's just sort of as we're
updating or inserting we're handling
this stuff so this kind of direct
structure is actually going to be pretty
important moving forward and a finding a
schema can save you from a lot of other
security holes right here we had to
check item one and item two to make sure
there were strings but that's annoying
that we're having a check every single
time we're inserting or creating a
method or checking that thing like that
what if our schema itself defined what
items were inside of the the object
itself here and what their validation
would be so let's go ahead and get
started with that so first off let's
head to our API folder and we have this
item CAS just great thing that we have
this here now inside of this you'll
remember we created a new collection
which was items now above all this
published in his server stuff will be
refactoring this file at some point but
above here on
where we defined our items what we want
to do is go ahead and define our items
schema the first thing we need to do
before we start typing is simply import
so let's actually scroll down here to
make sure we get the import correct
you'll see we're going to import simple
schema from and then you'll notice again
the spelling here is a little weird so
make sure you keep that in mind let's go
ahead and just paste that in right at
the top here it's good to copy and paste
wherever you can with stuff like this
okay so now that we have simple schema
imported we want to go ahead and first
essentially define our schema itself and
we can do that by giving this a let's
use a constant variable which we're
going to call the items schema I have
this Capel or camel cased shouldn't
matter really as long as it's not a
variable name you've used before and
this is going to be equal to a new nut
view new simple schema and simple schema
is going to accept an object and this
object is going to be what our schema is
for instance you'll remember we had item
1 we had item 2 and we had last updated
those were our sort of root level items
and here I'm going to go over the other
stuff after this but we want to say item
1 and inside of here this can accept a
object with a type and it's an object
right so item 1 is going to be an object
and just like that item 2 is also going
to be an object you view simple schema
before you might be concerned about
something I'm doing here which will be
resolved in a minute and then we'll have
a comma and the last one is of course
what we had was the last updated which
is going to be the type of date you
might be wondering how do you know what
types exist here well if you head over
to the simple schema documentation you
can see right here down here under
schema rules we have typed the following
types
custom-built class like date array
object boolean integer number cool so
this is a good this documentation is
epically huge and that's good and bad
obviously it's great because the answers
you seek are probably in here it's bad
because it's really a lot to parse but
that's the goods way out way too bad I'm
not complaining here I think this
documentation is excellent
so let's come here to our app one last
thing we have defined our schema using a
new simple schema we're not attaching it
yet so let's go ahead and attach the
schema to our collection so we want to
attach items schema to items we can do
that simply by saying items that attach
schema and this is going to accept a
schema like this so we want to paste in
items schema like so and we want to and
then off with a semicolon so check it
out one last time before I head over to
my counsel to make sure nothing's broken
here and you'll notice we're getting a
big red error here well it's not really
red we're getting items attached schema
is not a function that's because items
right here is a new Mongo collection but
attached schema isn't something that
comes with Mongo collection right that's
not something that comes with it so
what's up well there's a great package
by all deed which is actually called
collections to believe if we do a find
for it here you can see used by
collection too let's click on this and
you can see this is what is going to be
these the package here but important
note this version of this repo is
deprecated it wants us to please update
to this new version let's actually
select this here and what we can do is
we can add it by meteor add LDD
collection to core the reason why this
changes
npm simple schema moved to NPM it made
it so that these simple schema was no
longer bundled into collection too so
let's go ahead and pop into our meteor
folder under packages we can come down
here and paste in this al deed colon
collection - - Kor save this it's gonna
go ahead and grab collection - for us
which should include the attached schema
method that we really need here now
you'll notice we're getting this weird
error right here you know this all
happened because of the packaged
versions and package files that have
changed we hit two packages let's scroll
down and you'll see we have collection -
core let's go ahead and actually look at
the versions file here for a second we
want to make sure we don't have simple
schema you'll notice what it added for
us was collections - core at 1.2.0 which
is not the version we want and because
of that it's added simple schema for us
let's come back to our packages file and
let's scroll down here and this is
another intermediate to advanced
technique really if we want a specific
version of a package we can come in here
and say at and then give this a version
number two point zero point zero okay
and now I can save this file you'll see
it actually some of these other ones
where you can see at one thirty one at
one one one so if you were paying
attention you probably would have seen
this happening or elsewhere but if we
want to say LDD core at 2.2 or two point
zero point zero come back here and what
it's gonna do is get the right stuff for
us at the end of the day really what we
want to see is no version of simple
schema within our versions and as I say
that it disappeared and we should be on
the right versions of everything now
start for making this so obtuse here the
issue is is that this stuff really just
changed over and this is probably the
only tutorial series on the web that is
going to have this information so I want
to make sure everybody doesn't get
caught up in some of these
shoes that exist here now you'll notice
we are getting a message about meteor
new version available let's go ahead and
run a meteor update just to make sure we
have the latest of everything and now
we're not getting any errors or issues
that are related to whatever a
particular version of meteor that we're
on so that way we're on all the good
latest stuff here okay now that we're
all updated look it's fire meteor once
more and check to see if we have any
errors it's always good to work this
stuff out
we can't let's head to our app and let's
hope we have no errors let's check it
out refresh no errors cool okay so we're
now in the latest version of everything
we have simple schema installed and
we've even got a preliminary schema up
let's get this finished up here so I'm
going to give us a new example and we're
essentially just going to have pen verse
pencil and let's click Add items and as
you can see I'm not getting any errors
here on my client side but this
obviously didn't submit because
nothing's happening if we come to our
terminal and you can see I am getting
errors you might be wondering what's up
with that what's up with the errors here
if we scroll up these are all really big
so let me see if I can bump the font
size down have it still readable here
basically the issue here exceptional
invoking method insert new item error
after filtering out Keys your object is
now empty okay so basically what we're
having is an issue where the schema is
essentially not validating and so why is
the schema not validating well for
starters one of the issues that we're
having here is that we've declared that
item two is a type of object now if we
head to node simple schema and we were
to say let's look for a type of object
scroll down here to find an example of
any of these with a definition of an
object and you're gonna notice something
we don't have a ton here until we hit
this part and what we have here
is mainly address with and type of
object but we don't just have it as a
type of object we also need to define
the items inside of the object for
instance we have mailing address Todd
Street and mailing address that city or
if something was an array an array of
objects you would do it like so with a
dollar sign so let's go ahead and head
this secondary properties in here for
instance sure item 1 is a type of object
but we could also have inside of a
string item 1 dot and inside of here
text now let's come here item 1 dot text
and this is going to be equal to a type
of string ok now in addition we'll also
have item 1 dot value item 1 dot value
and I know when that value is going to
be the type of an integer now how do we
use the type of integer we saw this
before if we want it to be an integer we
want to actually have it be simple
schema dot integer reason being as
integer is not an actual type in
JavaScript ok so just like that we have
item 1 dot text item 2 dot text with
their types and if this seems overly
obtuse as well this will be changing so
don't stress it but to see how this
written out is maybe a little bit more
obvious to what's going on we have item
1 dot text is a string item 2 dot value
is a integer item 2 that our item 2 is
an object where item 2 dot X is a string
ok so on and so forth now another thing
that we're gonna be getting hit on is
that this assumes that last updated is
going to be presented into our schema
every single time in fact if we wanted
this to not in fact if we wanted
anything to be
optional right we need to specifically
state that something is optional setting
optional is equal to true so if we
wanted this to work as is we would need
to say comma optional is equal to true
so check it out
we now have these items are all going to
be required because required is the
default and last updated is going to be
optional we can change that in a minute
if you'd like let's head in here and
let's try this out again we want to say
10 verse pencil it's add items and let's
see if we have any major errors there
and journalist we don't have any errors
let's go ahead and vote for water or
beer and you'll notice pen and pencil
have showed up in our voting this is
great because what this means is that
our schema is now officially working
which is a great thing because we just
took all that time and this seemed like
was really roundabout right typically it
won't be that way but because all of
these things have changed recently I
wanted to make sure you sort of got the
picture so what we have here is we have
our simple schema which is a node
package we're using collection 2 which
extends Mongo collection and then we're
defining our schema and then we're
saying hey attach the schema to the
collection now every single time we need
to insert it we make sure that
everything is validated correctly and in
fact we can get rid of these checks now
right I mean you might want to check
this if you're doing a little bit more
database tea stuff but hey before it
inserts its gonna make sure that item 1
as a string and item 2 is a string so we
don't really need to check that anymore
so that's just some of the benefits here
we're getting a little bit of validation
here there's also some really great form
generators for both blaze and react so
we can auto generate forms off of our
schema in the next video we're gonna
break this down a little bit more we're
gonna make this schema to its fullest
potential
and you'll see how this simple schema
right now which is not simple this is
not simple
this simple scheme is gonna get really
simple so don't worry about this
craziness here you probably won't write
schemas that look like this that often
so as always this is Scott with level up
tutorials in the next video we're gonna
keep on going with simple schema a
package that is well well well worth
your time so thanks so much for watching
and I'll see you in the next one if you
have any questions or comments have
become in the video hear me on that
Twitter or Facebook if you want to catch
the rest of this series have to store
doubt level up tutorials dot-com and
purchase the series or become a LevelUp
pro by subscribing to level up tutorials
we're gonna be handling all sorts of
more stuff we're gonna cover like
routing parameters I'm gonna show you
some really cool es 2017 syntax stuff
we're gonna be using decorators we're
gonna be using things like Auto bind
I'll show you exactly what's cool about
that I'm gonna be going over animations
we're going to be getting into user
roles and role based permission I'm
gonna be talking a little bit more about
meteor publications we're gonna be
talking about server-side private
settings all sorts of that good stuff so
keep on watching and we're gonna have a
lot of great content in this meteor
intermediate series</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>