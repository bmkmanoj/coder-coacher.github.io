<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>User Accounts in Meteor #5 - Roles In Meteor | Coder Coacher - Coaching Coders</title><meta content="User Accounts in Meteor #5 - Roles In Meteor - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>User Accounts in Meteor #5 - Roles In Meteor</b></h2><h5 class="post__date">2016-04-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2Vf6mXVopxs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up this is Scott with level
up tutorials and in this video I'm gonna
be showing you roles in meteor we're
gonna be able to set roles and use them
as a way to control permissions on our
site so only giving access to admins or
normal users or whatever for certain
aspects of our site so let's go start
with that right now so what we have made
a lot of progress by having custom login
systems here we've been able to add new
fields we've been able to add new
verification and validation to these
fields what we don't have yet is any
kind of role based system now roles in
meteors actually super nice there's a
really great package that just makes
working with roles totally painless
so this roles package is Elenin meteor
roles now if i pronounced alanine wrong
please let me know how it's pronounced
we have alanine meteor roles I'll make
this link available in the description
of this video we want to go ahead and
add this package just simply by adding
the Elenin roles to our package and then
we're going to get into exactly what
this package can do for us so let's go
ahead and copy alanine : rolls and throw
it into our dot meteor packages file
let's just scroll down and let's paste
it in here you can verify with our
command line that it is in fact going to
go ahead and install so if you would
like proper spelling here it is al a and
n ing : rolls rol es cool so we now have
Elenin roles here and we're ready to get
started
assigning roles in using them now the
best place to fully see the
documentation here besides though readme
is the documentation page if we scroll
down here in the readme or you could
just do a command fine for documentation
you could find a link to documentation
and it's on Allen a dead github that I
Oh meteor - roles classes role stat HTML
and what's great here is we see all of
the methods and the properties that's
allowed for us here so for instance
if we want to add users to roles you
could use add users to roles and simply
you're just passing in either a single
user ID or an array of user IDs and then
either a single role or an array of
roles in addition we can also have
groups of roles which are entirely
optional now in addition we can also do
things like create and delete roles
because these roles are going to be
saved into our database
however role gets created simply just by
adding someone to it so let's actually
go ahead and see this in action if you
remember in the last video let's go back
to our code and let's head to a server
accounts and then we have our post
signup hook now they post signup hook
only runs on the server here and it
essentially has this post signup
function that we made where is really
just console logging the users ID and
some of their information now let's say
when any normal user signs up for the
website here that just a normal user we
want to give them a role of normal user
or could just be normal if you would
like and also if you remember we had
this drop-down on register where it was
profession where they could be a
developer designer or other now it would
be really interesting if we could take
the value of this instead of to be a
role as well
and let's quickly just create an account
you can always blow these accounts out
or it doesn't even have to be real
because this is a test site I obviously
don't know it's got a gmail.com so let's
go ahead and just click register now
with some of this fake information let's
update that lets click register and
let's head to our server where we can
see the information we have the ID and
then you'll notice inside of the info we
have an object and what we want is this
profession so to get to profession we
need to go to info dot profile dot
profession and we can grab that value so
let's head to accounts j/s you remember
we wanted info dot profile
dot profession like that make sure all
the spelling is correct you can always
copy and paste these things in here like
that okay so we now have lots of
information that we would need right we
have their profession and we have their
user ID if you remember when we were
looking at the documentation to add a
user to a role all we really needed was
the ID and whatever roles we wanted to
give them whether that's in an array or
not let's actually go ahead and copy
this entire roles a dot add user to role
we can paste this in here and we can say
roles dot add users to roles now we're
getting the user ID which is nice that
this is the same as this right here we
don't have to change anything
and now the roles that we want are going
to be one normal user and then comma two
info that profile dot profession now we
don't want to add them to a group so
let's get rid of the second comma
example.com and now we can have a
semicolon here so what's going to happen
is they're going to sign up it's gonna
hit this post signup hook and and we can
leave these Council logs in here for now
but it's going to hit this post signup
we already saw that this post signup
works but now it's going to run roles
dot add users to roles and it's going to
accept the user ID and assign them to
normal user as well as whatever
profession we select let's give this a
try I'm going to come back to my site
I'm going to log out I'm going to log in
again with some phony information so
let's go ahead and give this just SEO at
gmail.com again it doesn't really matter
here because we're just testing this
functionality out I can always blow this
information out of here let's go ahead
and click register now we won't see
anything interesting right away
especially on the front end of our
website but you will see that we did
counsel log this end developer correctly
let's go ahead and hit ctrl M to open up
our meteor toys and hopefully we see
something really in
now in the brilliance of this it was
really easy the person who logged into
our account
now is a developer as well as a normal
user now if we wanted to limit
functionality based on these roles I
mean we can access this role information
simply within the users object however
there's actually a nice method provided
to us by the roles package that allows
us to check a user's role I'm gonna go
ahead back a page here and you can see
we have something user is in role it's
the very last one on the right here and
we can click this and we can see user is
in role and accepts the user that being
the actual user object or the user ID so
if you have the entire object you might
as well just throw that in there
otherwise just pass in the ID and then
the roles which can be an array now this
is cool because it basically just
returns a true or false so let's go
ahead and use user is in role so let's
go ahead and copy this first example or
you can type this out I'm going to head
to the front end of our website cuz you
can see how versatile this is and let's
go ahead and head to pages dashboard now
the dashboard page is really just an h1
here now this is going to be really
interesting because what we want to do
is check if a user is in a role and if
they're not in a role give them a
message that says hey you're not
authorized to view this especially if
this is like an admin page only now in
another situation you could definitely
redirect them to another route but for
this example it's nice just to check
because we can show them two different
things based on what role they are so
first let's make a new javascript file
which is going to be dashboard j/s and
now we can just simply have a helper now
check this out we can say template dot
dash board I believe I have that in caps
in the template name yet template dot
dash board dot helpers
and then we can have function with an
object inside of here let's just go
ahead and create a helper which is just
going to be admin now we can have admin
so it's an object obviously so we have a
colon here and let's go ahead and have a
function that's going to return the
outcome of the current users status here
remember we had this roles that user is
in role so in camel case we're checking
the current user and we're gonna see if
they're an admin I'm gonna have a
semicolon here now remember this method
here just returns a boolean so admin is
either going to be equal to true or
false
now this died user obviously we want it
to be meteor dot user ID like this and
now we can grab the current users ID
check if they're in check if they have
the role of admin and if they don't then
admin is going to return false now in
our template here we can do a little if
magic we can just say if admin and then
if they are an admin we would like to
show them this entire dashboard page of
which there isn't anything other than
just a dashboard header actually let's
do an else here we can say else and give
them an h1 and say not authorized cat
let's end this if and save now let's it
to our page let's come here and let's go
to dashboard now you'll see
interestingly enough we are not
authorized now this isn't a great
strategy right here because what we
still have is we still have access to
this stuff now one thing we could do is
also have this navigation only show up
if you are have that role and you might
think oh that's great I have to write
another helper for this template well
that's actually not true
because what's so great about this roles
package is that it actually offers a
helper for us so everything we just did
there wasn't necessary if we come to UI
helpers here you'll see we have this is
enroll helper and it's so simple all we
have to do is say if is enroll admin we
don't have to pass in a user right we
can just come to this where it says if
admin and we can say if is in role and
now pass it the string admin and we're
gonna get the same thing
so you'll notice it's not going to be
using this helper anymore it's going to
say if is in role admin then go ahead
and display the dashboard otherwise not
authorized now let's come back here and
you can see even upon refreshing I mean
it should have been fine without
refreshing but just to confirm we have
not authorized so we can go ahead and
even use this if is enroll admin on the
App layout so if we head to layouts
app layout we have the app nav here and
we only want the app Neph to even exist
if user is an admin so only show this to
them if they're an admin and we can come
back and sure enough our sidebar app
navigation is gone let's go ahead and
confirm this is working for somebody who
is an admin so I can hit command M to
open up mongaul here let's have two
users and I'm going to actually just
come down here where it says roles I'm
gonna click update because I want to
update this
and I can have comma and what we want
here is in a string admin string let's
click Save and literally instantly our
dashboard is now back and we're no
longer getting this authorized message
and we're getting this if I were to
remove that role simply by clicking
update let's delete this whole thing
here the moment I click Save not
authorized so as you can see we've now
assigned a role based on a drop-down in
our registration as well as a role just
based on
what any normal user would get when they
sign up and we're using that role to
limit functionality of this site what's
great is that you can use these
functions anywhere you want so in
dashboard jeaious we use this roles that
user is in role to limit the user from
seeing things however you could use this
same method anytime you want to check
for role so let's say you're setting up
permissions on inserting into a database
in your meteor methods you could have a
roles dot user is in roles user is in
role and check to see if they're in
admin or have posting rights before
they're able to submit any type of
content and limit their type of content
in that way so like I said we set this
up in no time
this rules package for meteor is really
really really smooth it works great and
if you ever want to add it users to
roles for basically any action let's say
you have a web store and somebody buys
something you want to label them now as
a customer all you have to do is simply
use this add users to roles add this add
the role and it's not going to remove
any of the rules it's simply just going
to add on to it in addition you can
always head to this documentation and
check out the role methods to see that
there is tons of great stuff add users
to roles create role delete role get
groups for users get roles for user get
users in role so you can see that you're
even going to get the users themselves
who have a specific role and all you
have to do is pass in the string of the
role you can even bulk remove it users
from roles where you can pass in an
array of users and pass in a role and
have it remove those roles so as you can
see there's lots that we can do here in
fact we're gonna continue to use this as
we build out some functionality or
application that's actually going to be
sort of a user database we can see all
of the users on our site and we can
easily and quickly change their roles
and their allowed functionality based on
permissions so as always this is Scott
with level up tutorials if you have any
questions or comments leave a comment
the video at me up at Twitter
or Facebook at level up tutorials I love
to hear from you thanks so much for
watching and I'll see in the next one
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>