<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>#23 Relational Data Query - Full-stack GraphQL with Apollo, Meteor &amp; React | Coder Coacher - Coaching Coders</title><meta content="#23 Relational Data Query - Full-stack GraphQL with Apollo, Meteor &amp; React - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>#23 Relational Data Query - Full-stack GraphQL with Apollo, Meteor &amp; React</b></h2><h5 class="post__date">2018-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PFy2m6jYKb0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey you it's gonna this is Scott with
Olaf tutorials in this video we're gonna
keep going on our app here and just take
this a little bit further right now we
have the situation where well we have
our resolution and we have our form to
submit new goals and as we saw from our
graphical it's submitting goals but we
don't have it displayed or anything like
that I'd like to be able to have that in
there then also get some sort of like
checking write to say like I've
completed this individual goal now it's
incredibly windy outside today so if you
are hearing some wind noise I can't do
anything about it it's you can hear the
wind throughout my house it's absolutely
wild so if you can hear this wind on the
recording that's why hopefully it goes
away
hopefully you can't hear it at all just
a disclaimer there so let's keep going
you remember we wrote this query that
allows us to see all of our resolutions
and all of our goals you can now see
that inside of our vias code here let's
head to our application and
unfortunately have everything thrown
inside of app j/s still but you can see
here we just simply are having an
unordered list we're mapping over that
list
we're outputting a list item and we have
our goal form now the next thing we're
gonna want to do is basically have
another map that's going to output all
of our different goals well what I want
to do is actually make a new file here
I'm going to head into my UI folder and
let's make a new folder new folder this
is just going to be named rows Aleutians
okay
and inside of here I'm going to have a
new file named goal dot J s you can do
RCC to have a new react component with
my a snippet package and let's have a
new goal now an individual goal if you
can think about it is simply just going
to have to return its how well it's
gonna have a checkbox so we can have an
input type and this can be a check box
okay and then we can also have basically
the
props that goal dot and then you'll
remember from our API it's just the goal
name okay so we can say gold name so
right now this is just a div and that's
kind of okay with me we'll probably want
to actually nevermind let's just make
this a list item we'll just have this be
in Li and let's head back to our app dot
j s where we can import goal from goal
import goal from dot forward slash
resolutions forward slash goal okay and
then now we can do another map over our
resolution however instead this time
saying our individual resolution that
name we're going to do a map over
resolution dot goals okay because that's
the Iran our API here and we can have
another unordered list and inside of
this unordered list we can do resolution
dot goals dot map instead of here we'll
have a goal which is simply just output
an individual goal and we're going to
just say hey give me that goal and the
goal itself is going to be set to goal
I'm saying the word goal so many times
it's losing its meaning to me it's one
of those things goal okay we're gonna
say now ki is equal to gold dot
underscore I D and we can have this like
this so we're going to be iterating over
each of our individual goals and we're
going to be outputting an individual
goal passing in that goal with the key
and what's nice about this is well
actually let's head down here to our
query our query isn't actually querying
for any goals and that shouldn't matter
and you can see we are getting an error
saying like hey cannot read property map
of undefined which actually leads us to
an important piece if we were to have no
goals in here what would this be
returning right would this be returning
null or would it be returning an empty
array so that's kind of tough to show
right now let's go ahead and actually
comment some stuff out of here I'm gonna
temporarily remove this
unordered list here you could comment
this out and I'm gonna head back to our
application let's add a another item and
have no goals in it so we can just say
new tester can submit okay let's check
out graphical okay cool so we know and
let's head back to our application and
paste this back in here now obviously we
can't do a dot map on a property that's
undefined but let's confirm that graph
QL is actually outputting an array so by
running our query now with an empty item
we can see that well graph QL is smart
enough that because let's head back to
our application here in our resolvers
for goals even though it can't find any
goals it's still going to return an
empty array here and that's excellent
for us because well now we can have a
dot map over an empty array it's just
not going to output anything so we're
going to want to make sure that we do in
fact query for goals down here and our
query and let's just give us the name as
well as the underscore ID and let's save
this so it's always important to check
sort of your state's of data right like
if there are no goals what's this coming
in is is this going to give us any sort
of errors in this case you can see it's
not because we are getting an empty
array okay so check it out we now
basically have a new do handstands more
we have some subtasks that are obviously
this check boxes I'm going to do
anything for us but that's super nice
and we can add new subtasks for a new
tester as well we can just say write
code submit and it now we do have a
little bit of an issue I hit submit did
nothing happened and if I come back and
refresh you can see that write code
shows up we can do this again by saying
delete code submit refresh and again
nothing shows up now in now a decent
short-term solution to that would be to
head back to our mutation
you remember that in our resolution form
right here we had to tell it to refetch
the query resolutions now this again is
going to hit our database and have to
grab everything again from our API so if
you're bringing in a lot of data and
stuff like that
the refetch queries is going to always
go back and hit your database and have
to re fetch those queries so this all
might not necessarily be the best option
every time in fact we're going to go
over a better solution for that where
you get to update the actual store
itself without having to re query the
database so let's go ahead and for now
as a nice little quick fix throw in this
options refetch queries into our goal
form and so on goal form j/s we have our
name property here we can go ahead and
add another property which is just
options and we're going to have refetch
queries the resolutions query so keep in
mind every single time at this point we
are going to add a new resolution or a
goal it's going to have to hit our
database and refetch everything again
now I mentioned this might not be the
most performant solution but let's check
this out you can see it certainly works
so if you're doing something like this
you're not meaning extreme performance
or something like that
this refetch queries is going to work a
ok or if you you're not really having to
hit a whole ton of stuff again this tree
fetch queries is going to work fine so
don't necessarily let that deter you you
can see this works a-okay now one last
thing is after we hit submit this input
needs to clear itself it's not doing
that currently so let's head back to our
goal form and now if we have no errors
we'll do a dot then on this create goal
and in our dot then we'll just have an
arrow function like this ok so inside of
this after our goal has finished and
there's no errors we're simply going to
set this dot name dot value equal to an
empty string okay save this well this is
going to
it's going to set our Ref input to an
empty string
therefore clearing the input so we don't
have some of this leftover text in here
so this will now say clear input submit
and you could see our inputs been
cleared and we now have this going okay
so this is all good we've we've
progressed a little bit we've added
we've added the visual component to our
goals we've allowed the forum to sort of
refresh itself and we've told our query
to refetch so in the next video what I
want to do is focus a little bit on well
this mutation right here when we check
any individual thing Oh what needs to
happen especially considering on our
goals we do have this completed property
but we don't have it stored in the
database we're not using it at all
actually I mean I do take that back
because I mean we do have it in the
database when we created a new goal we
are setting completed to false so we're
gonna need to write this toggle goal
mutation we're gonna need to toggle that
and we're gonna need to get it going so
as always this is Scott what I love
tutorials thank you so much for watching
and I'll see you in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>