<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>#9 Object Queries - Full-stack GraphQL with Apollo, Meteor &amp; React | Coder Coacher - Coaching Coders</title><meta content="#9 Object Queries - Full-stack GraphQL with Apollo, Meteor &amp; React - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>#9 Object Queries - Full-stack GraphQL with Apollo, Meteor &amp; React</b></h2><h5 class="post__date">2018-01-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IdtHO1os_Wc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so in the last video what we did is
we defined a schema in another file and
to be precise a graph QL file and we got
that file working with babble so that
understands and imports and is able to
edit to our type deaths in this video
what we're gonna be doing is well we're
gonna be actually having another query
and this time the query is going to be
for resolutions so to get started let's
go ahead and actually return some
information from a query if you remember
we simply just required the ID and name
okay
so that's what should be coming out of
resolutions so well let's go ahead and
write the query that would return in
theory all of our resolutions which is
going to be essentially an array of at
this point IDs and titles
so in our resolvers in register api j/s
we're going to have a comma here because
this is just JavaScript after all and
we're going to have what is a function
named resolutions so resolutions okay
and in here we're simply going to return
an array of objects which are going to
have an ID and this can just be and
generic string here and then a comma and
then as a title or name what did I give
this name not title so it's gonna be
name it'll be say get stuff done okay
that's the resolution here so we only
have one item inside of our a here but
what we did is we defined a query that
will return an array of items in
particular it's going to return an array
of actual resolutions now one thing that
we did before and we created our test
schema up top here is we actually had to
create a type of query and that query
returned a string well here we have a
query and it's returning
arrey of an object well what do we do
here because if we head to our HAP
you're going to get some errors and
these errors are going to say hey query
dot resolutions is defined in your
resolvers but not in your schema and
what this means is that hey we have this
query in our resolver is right but it
doesn't exist as an actual schema and
now we have a couple of solutions to
this and we could come in here and add a
another line to our query type and the
query type we could add our new query
type which is resolutions and we
actually expect resolutions to return
and if if your heads in JavaScript lands
you might be thinking something like oh
okay we just need it to be an ID with a
string and a name with the string this
is not right because we're what we're
returning here isn't an object with IDs
and strings it's a resolution which
we've already defined as its own thing
right we gave it a type of resolutions
and so actually I might want to while we
still can change this resolutions to
resolution just a small change there to
keep in mind but what this is is a
single resolution so instead of
returning a string what we're going to
be turning is a resolution but we're not
returning a resolution we're returning
an array of resolutions so to define now
we just simply have to wrap this in a
bracket so this is part of the beauty of
graph QL and right now you might not
realize how big of a thing this is for
you but it's gonna be one of those
bigger things that once we get into just
some of the cooler stuff of graph QL
it's gonna be a total aha moment so we
have our resolutions query is returning
an array of a resolution
okay now this resolution is defined as
an ID and a name both of them are
required and both of them are going to
be here inside of our object so let's
set back to our code here refresh and
you can see
everything's working again and if we
head to our graphical on our Apollo dev
tools or the graphical window itself I'm
sorry the type is small here but you
remember when we typed high the high
auto-completed for us well let's see if
resolutions autocompletes
and it doesn't autocomplete for us yet
however we hit play here you're gonna
see we get a little spinny guy I think
that it might be a more of a bug with
the Apollo dev tools themselves than
anything else it's actually head to our
graphical editor itself which will be
refreshed here and if I open this and
type R you can see resolutions does show
up so yeah this one this forward slash
graphical at your domain might just be a
little bit more reliable right now than
the Apollo dev tools you can always
close these and reopen em and I
guarantee you this would work however
right now
hey resolutions right here is gonna work
now on our other query we simply just
had the query name and we got to hit
enter and it returns string with this
query that's not going to work if I type
in resolutions and hit the play button
well graphical is gonna do something for
us it's gonna say hey did you mean
resolutions oh yeah I did I meant
resolutions but well resolutions must
have a selection of subfields and what
does that mean well when we're doing a
query especially a query well not
especially but when we're doing a query
that returns an object or an array of
objects we have to specify which items
in that object we actually want this is
some of the power of graph QL because we
only get the stuff we want and none of
the stuff we don't want so if I say ID
here inside of two more brackets I
actually may bump the font size up so
you can see this a little bit better if
we say resolutions bracket and then ID
and hit go it returns that ID and if I
on another line say name it returns that
name so this is brilliant because again
we're only getting
what we asked for and again right this
isn't hanging the database that's
nothing fancy it's simply just returning
the array that we're asking for but it's
gonna be really cool if we actually add
another item in this object do we do
like a comma okay
I don't know your formatting I don't
like this kind of formatting to be
entirely honest I prefer it like this
but a pretty Phi or prettier not Purdue
Phi prettier is deciding that this is
the way it should be and let's go ahead
and I'll change this ID to maybe a bunch
of F's and we're gonna say lose some
weight okay so we got two resolutions
here these are very common resolution
them to get stuff done I'm gonna lose
some weight you could probably do both
of these at the same time and basically
right now if we head back to our
graphical run this query again you can
see that it gives us an array of both of
these items and again if we decide hey
we only want the names of these we don't
want the ID for whatever reason we can
run this and we're just gonna get the
names again graphical is one of those
definitely aha moments because you start
to see the power of this query language
right we're not hitting an API and just
getting a bunch of data we're saying hey
give me the specific data and the app is
obliging to that and the API is actually
sending you that data that you want
rather than a whole bunch of stuff that
you're not asking for this is great for
a a lot whole ton of reasons
and a lot of these reasons are going to
become more apparent as we write more
stuff so at this point we can actually
head to our app and the sort of querying
was high query well when we can modify
this high query and in addition to
saying hi here because why not let's
leave this high in here we can actually
come in here and add in this resolutions
line as well although I do want the ID
so let me go ahead and specify that I
want the ID as well
notice other again there's no commas
here this is a string and you can see
here again and this is in JavaScript but
we do have an what you could call an
object with our query and
the items that we want from it and you
could leave this just like this and if
we were to check react you'd be able to
see that everything's available within
data now I know that it's available
within data so I'm not going to check at
this point but what we want to do now is
we can wrap this in parentheses wrap
this and maybe like a div move this high
inside of a div and I you know whatever
I'm just going to iterate over this so I
know this data exists so we can say data
dot resolutions and dot map and here we
can map over this just like anything and
we could just have this be a resolution
I should have chosen a shorter word and
inside of here we can just return I
should have actually wrapped this whole
thing maybe like an unordered list that
might be better okay and then we can
have an Li now on this Li we can have a
key and the key will just be the
resolution dot underscore ID right comes
in right here and the value of it will
simply just be the resolution name could
save all this let prettier do its thing
fix all of my formatting issues and
check it out this is really nothing
fancy all the data is coming in via data
dot resolutions comes in from this name
we map over that array and we have each
individual resolution and we output it
as a list item this should be basic
react I would just assume that you would
know this so I'll leave this here for a
second you can check it out and here
let's head back to our app and it looks
like we are getting an error okay now
this is an interesting error because
well I know this data exists but it's
telling me it can't read property map of
undefined so what's going on here
because before we had data and it output
high just fine but now that we're asking
it to say hey resolutions as an array
well this doesn't necessarily know that
resolutions is an array and if we you
know when we comment this out
we will check react to dev tools with
this comment
out and we will see that well hey this
data is going to be in here so what is
up with that let's come in here there's
a faster way to do this but who cares
data dot where are we resolutions an
array with two items so why can't it map
over this well when this component first
loads the data doesn't necessarily come
in immediately so to prevent this from
happening so how do we prevent this from
happening right how do we prevent react
from trying to load our graph QL stuff
before the data is available well
there's a couple of things we could do
we could set up some default props and
have this resolutions array be an array
so you could do that although you can't
set up default props on a nested prop so
that one's out for right now however
we're gonna fix that capability at some
point as well another answer that we
have is hey we have this data loading
what's up with data downloading and I
can't show you this because it's gonna
zoom by too quickly but before this data
is here we do actually have data loading
set to true so before anything else
loads or resolutions or any of our
queries run will have data loading
available for us off the bat so once
more let's make a modification to this
component I'm gonna wrap instead of
parentheses I'm going to wrap it in
brackets we're gonna return these
parentheses here return okay so
something like this prettier is gonna
fix all this formatting for me so don't
care about that and now what we want to
do is say if data dot loading right if
our data is loading is set to true then
we're just gonna return null you know
you'll probably want to return some sort
of loading component at some point but
what this does is graph QL gives us
access to loading right off the bat
without having to do anything this way
we can just say hey if the data is still
loading return null otherwise if this is
done loading then you can then return
our array of items okay so check this
out this is gonna work now we're not
gonna have any more crazy errors I can
refresh this I can do anything we have
on our list of get stuff done lose some
weight super cool okay so what are we
doing this video well we actually we
created a new query write our query is
our resolutions which is returning this
array here and we did so even though
it's in our register API we still
created this under the query type here
we then use that query to give us what
we wanted the ID and name and then we
then learned about the data loading so
that we could prevent our components
from trying to access data that doesn't
exist now again I'm going to fix this
with default props eventually as well
but knowing about data loading is a very
important I use this data dot loading on
pretty much every component that's
getting data so this is a great thing to
have
so yeah super cool this is all working
really nicely for us and once we have
data coming in from our database it's
gonna function just like this but
instead of returning an array we're
gonna be returning a Mongo a Mongo find
dot fetch so in the next video what
we're gonna be doing is actually
attempting to move resolutions query
outside of our resolvers file as
obviously you're gonna have enough
queries where you don't want them to
just live inside of one register API
file so just like we did with our
resolutions that graph QL file importing
and stuff like that we're gonna do
something similar but different with our
resolvers and I'm gonna explain a little
bit about of a problem that we'll
encounter along the way so fire up next
video and learn about how to keep things
more separated here as always this is
Scott with level up tutorials so if you
want to help support level up tutorials
head on over to level up tutorials com4
slash store and you can become a LevelUp
pro get access to all of the premium
content in all of the paid series if
you're a pro or if the distance on your
thing you want to buy each one
individually or by the ones that you
care about you can buy them individually
that's available to you as well like I
said there's gonna be a lot of great new
graph QL content this year so if you're
interested in graphic QL sign up now and
watch as each new series comes in and
you can vote on all the new series
coming up so thanks so much for watching
and I'll see in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>