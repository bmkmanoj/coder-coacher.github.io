<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Meteor For Everyone Tutorial #17 - Authorized Content Publishing &amp; Methods Part 1 | Coder Coacher - Coaching Coders</title><meta content="Meteor For Everyone Tutorial #17 - Authorized Content Publishing &amp; Methods Part 1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Meteor For Everyone Tutorial #17 - Authorized Content Publishing &amp; Methods Part 1</b></h2><h5 class="post__date">2015-04-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/v9n9jkwunzU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up this is Scott with level
up tutorials and today we're in continue
our talk about publishing and
subscribing by making some of our
resolutions private now you'll give
users the option whether they want to
choose to make these private and if they
become private only the user that has
created that resolution will have access
to it both on the front end or the back
end so that way you have that added
security and they're not able to access
the content that you're not wanting your
users to be able to access so let's get
into that right now so let's get started
by first adding our HTML we're
essentially going to do here is have a
button that the user can press that sets
whether this resolution is something
that they want everybody to see or if
it's just something they want to have
for themselves right so whether it's a
public or private resolution so to do
that what we want to go ahead and add a
new bracket and this is going to be for
a helper function that we're going to
have so it's going to be if and then the
function is going to be is owner so if
this person owns this content then we're
going to want to show them this button
so we can have a button and the class
will just be toggle private just like so
and inside of the button we're also
going to have some sort of an if
statement right so we have double
brackets and it's going to say if that's
pound if we're going to say private then
you're going to want to display the
words private and likewise if we want
this to be public we want to say public
so we can do bracket bracket else and
then public okay and now we want to
break a bracket forward slash and the if
and then outside of the button bracket
bracket forward slash and the if so on
the surface if you check out our app
nothing's going to change when I open up
inspect element just
I like to have it open and as you can
see not getting any errors nothing's
happening
just nothing showing up simply because
we're checking if this is owner is
owners not thing therefore it's just
failing this entirely and skipping this
code block let's go ahead and add that
helper
so that helper was a resolutions helper
so we can come down here and say
template dot resolution dot events ok
that's sort of what we want what we
don't have is template dot resolutions
that helpers so let's go ahead and add
that template dot resolution dot helpers
an S now that we can go and have a
parentheses brackets just like we've
been doing inside of this object here
we're going to go ahead and have our our
new function which we used the is owner
so we want to say is owner and like I
said this is an object so we'll have
colon and then it's going to be a
function and just like that now instead
of this function we just need to return
essentially a true or false statement
what we want to do is we want to check
whether the current user is equal to the
person who owns the content now what we
never did is we never attached an owner
to any of the content before so let's
actually scroll down a little bit and
where we added our resolution so we had
our add resolution in our Meteor methods
we had the title we had the created
added date let's go ahead and add a part
where we say owner ok so now the owner
is going to be equal to the current
media user ID just like that ok so now
when somebody creates a new resolution
we're going to get that user's ID
attached to this so to actually make
this work now we're going to delete
these two it's ok because it's really
easy okay we
added we've deleted those too and we can
go ahead and add our new resolutions so
read more make tutorials okay and to
verify that the owner is actually
attached to this we can actually just
output that so let's go ahead to our
resolutions and just pretty much
anywhere I'm just going to go ahead and
say owner just like that and as you can
see we have these IDs therefore that
these two pieces of content are getting
the owner ID correctly okay so we have
the owner is in there now we need to
finish our is owner function let's
scroll back up to our helper function
and here we want to go ahead and check
whether or not the owner of this
particular resolution is equal to the
current user now down here we had the
current user just to by simply saying
meteor dot user ID let's scroll back up
and then we can say this referring to
the current resolution dot owner is
equal to and then we can say meteor user
ID and we're going to run a return the
outcome of this so we're going to return
if this owner is equal to the current
user then give them the option to have
this button let's come back to our site
and you can see we have this public
button here now what happens if we log
out you see those buttons go away simply
because the current user is not is not
an owner right okay so let's sign back
in and here we have our public button
now we want to bring this button up so
it actually does something so this isn't
going to be too hard we just need a
template that resolution event like we
have this click toggle checked I'm going
to go ahead and just add a new one at
the end here and delete that colon or
that comma because it's the last one and
the class we had on this was toggle
private so once you click toggle
of it it's going to go ahead and call a
meteor method here
so let's actually keep this stuff here
and modify it so the method we're going
to write like we had update resolution
can just be set private because all
we're going to be doing is setting
whether this content was private or not
it's a toggle right so we're not
actually going to be doing a whole lot
of updating we're just going to be
setting whether this is private so we're
going to also pass in this underscore ID
because we want to affect a certain
piece of content and we're going to do
the same thing where we had the
exclamation point this checked however
we're going to give the result of this
dot private the opposite right it's
going to toggle so if it was true before
it's going to be false but it's false
then it's going to be true okay so we
have this dot private the inverse is
getting set to set to private so let's
go ahead and write that set private
method now down here we can just go
ahead and add a new method set private
and go spell it correctly private now
it's going to be : function now if you
remember this function was passed an ID
it was also passed whether and not this
was going to be a becoming private and
we can give this as a variable simply
like private just like that now a
bracket and instead of here this is what
we're going to be updating our
resolution right so before we wanted to
update a resolution we just use update
dot or resolution update now what we
want to do here is something a little
bit different well we don't want to give
anybody the access to do this keep in
mind a lot of the code that was running
before is just sort of front-end
protection stuff however back here with
our meteor methods this is really where
we protect ourselves from somebody being
able to Veronica and somebody being able
to update your resolutions without you
wanting them so we need to set into a
bit more protection here so we can add a
new variable and it's just going to be
res it short
resolution to keep it keep it short
right now and we could say VAR res is
equal to and now we're going to find a
resolution but we're just going to find
one and it's going to be based off of
the ID so we could say dot find one now
find one is a MongoDB method that's
essentially going to just find one
resolutions from our collection and all
we have to do is pass this the ID so we
can just say ID and that's going to find
us a single resolution and set it to res
okay so now let's do a little bit of
checking here so we're going to say if
and we can say res dot owner is not
equal to the current meteor dot user ID
so this is the same check we were really
doing before it just res dot owner
because we're finding the resolution
here instead of via this if res dot
owner is not equal to the meteor ID then
we're going to throw an error so to do
that we just need to say throw new
meteor dot error and this is going to be
a not authorized in this string so
that's what's going to get passed if you
try to do this you'll notice you'll get
a if you try to do this and you're not
the owner of the content for some reason
you were able to get those buttons to
show up then the sites actually not
going to allow you to update this and
it's going to throw an error and that
error is going to prevent you from being
able to update this resolution so now we
can do our resolutions update so let's
go ahead and copy this whole resolutions
update line from right here paste it in
down here and so we're going to be
updating resolutions passing it the ID
and now instead of set check to checked
we're going to set
private to a the variable private that
we brought in this
argument here just like that so now the
set private method is going to be
working if we come back to our page here
we click public almost we are actually
getting this error so we have this error
invoking set private method so that's
what happens when uh this is going to
get tripped and actually the reason got
tripped was because of a typo user ID is
actually a method of meteor so what we
need to do is have two parentheses like
that afterwards so that was the problem
but you'll notice that that's what
happens when you throw the error message
basically public never becomes private
and we get a little a console.log error
on our front end okay now with all that
said we have user ID method in there
correctly let's go ahead and select this
button you notice the text is already
changing to private so make tutorials is
now going to be a private resolution
okay so one last thing we don't want
meteor to publish the private
resolutions there's a difference in
meteor between front end and back end
and a lot of times when you have this
published subscribe you get to restrict
access without restricting access you
get access to everything and that's not
really what we want so now there's just
a couple more steps to finish this out
we basically need to control what we're
publishing and then we need to go ahead
and modify the rest of our methods to
check the current user state so keep
watching we're going to show you all
that in the next video as always this is
got a level of tutorials if you have any
questions or comments leave a comment
video or it is up at level of tutorials
we'd love to hear from you thanks for
watching and we'll see you in the next
one bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>