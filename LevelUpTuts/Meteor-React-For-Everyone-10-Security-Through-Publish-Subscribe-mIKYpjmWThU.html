<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Meteor &amp; React For Everyone #10 - Security Through Publish &amp; Subscribe | Coder Coacher - Coaching Coders</title><meta content="Meteor &amp; React For Everyone #10 - Security Through Publish &amp; Subscribe - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Meteor &amp; React For Everyone #10 - Security Through Publish &amp; Subscribe</b></h2><h5 class="post__date">2016-04-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mIKYpjmWThU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey whats up this is Scott with level of
tutorials and in this video we're going
to remove the other prototyping package
which is auto published so that way we
can start to learn how you can publish
and subscribe to data within meteor and
react let's get going on that now
okay so removing insecure is really just
half of the battle in terms of securing
your site now one of the other things we
need to do is remove auto publish now
auto publish produces basically every
single item in the database besides not
being performative once you have a lot
of Records this is actually going to be
bad let's say I mean we have a
resolutions application here ideally
these resolutions would be saved to an
individual write an individual user of
which we will be adding that
functionality in but what you don't want
is you don't want your users to be able
to have access to every single person's
resolution for instance right now on the
site if we were to come in and we were
just to do a resolutions dot find you
can see it returns a cursor in addition
if we do a fine dot fetch I've got a
spell that correctly okay find out fetch
you do we get the objects every single
one of the resolutions and if we had a
whole bunch of different users on here
we would get all of those users
resolutions so auto publish is great for
prototyping because it publishes
everything and you don't have to set it
up but after you get past that you're
going to want to remove auto publish and
set up subscriptions and publish methods
for your content let's go ahead and get
rid of auto publish and you're going to
see instantly when we come back to our
site all of our stuff is going to go
away tracker react is engaged and if we
do control em to bring up meteor tools
it says we have no resolutions even
though we know in our database they do
exist that's because on the server we're
not publishing those we're not making
those available cool so let's actually
head to sublime text and let's come to
our server and we created this publish
dot J's file before now you might be
wondering at the time why did we create
this to be called published well this is
where we're going to put in our publish
method so we can say meteor
that publish and now we're going to have
parentheses and then quotes now the
quotes are going to be naming this
publish command so it's going to be
resolutions in fact we can make this
something a bit more like what it
actually is for instance we can say
sorry let's do this all resolutions like
this so this published command is going
to return all resolutions so if we
subscribe to all resolutions we're going
to get all of them on the entire server
in that once we get into actually
assigning resolutions to users will make
another publish that allows us to
subscribe to that individual users
resolutions so from here after the quote
but before the parenthesis we're going
to have a comma and then a function we
can have a function and then brackets
okay so inside of here we're going to
return our resolutions sorry I need cap
resolutions dot find and inside of here
we're just going to be returning every
single one of our resolutions so at the
end of the day this is going to
essentially give us what we had before
all the resolutions in the system but
that's only because we don't have users
setup and I haven't set up a second
published command would you get into
writing performative meteor site it's
important that you're only publishing
the data that you need and that way
meteor ice to keep track of less data
has to load less data and your site's
going to be more performative so let's
go ahead to the resolutions that wrapper
and now we need to actually make this
happen we need to actually bring in
these resolutions by subscribing to them
you'll notice on our chrome we still
have nothing even though we're
publishing the information now we need
to subscribe to that information on our
component itself so the first thing we
need here is a constructor no
constructor is essentially just a method
that pond loading this class here so we
can say construct tour and then
parentheses like that and then we need
the super now if you want more
information about what super and
constructor to you can at Google
that that is an es 6 or es2015 feature
we need to have this super here and
react and if we were going to be passing
in props here we would need to be
passing in perhaps to our super but we
don't so right now let's go ahead and
just have this like this so don't worry
too much about the construct and super
they're just there and we can say this
state now this is going to be
introducing the react concept of state
now meteor also has session data or
state data that's sort of global it's
like sort of like a global session
variable well this dad state in react is
linked to the component itself this
state does not leave this component
unless it's passed in through a child
prop so it's not being passed anywhere
this state is owned by this component
only so let's go ahead and say this
state is equal to and then we have
brackets now inside of here we were
going to have a state that is going to
be sub scription if i spell this
correctly sub script tion okay and
that's going to be a colon and inside of
here is going to be another object and
this object is going to be resolutions
now we have a colon and the resolutions
a state subscription is going to be
meteor dot subscribe and then we're
going to be subscribing to if you looked
in our publish we had all resolutions so
we're publishing all resolutions we need
to subscribe to all resolutions ok so
this dead state dot subscriptions that
resolutions is now going to be equal to
subscribing to all resolutions so what's
great about that is now if we head back
to our document instantly all of our
data is back all of its back and that's
great news all simply from adding this
stud state dot subscription resolutions
now this little bit right here setting
the state subscription
resolutions to a meteor dot subscribe
that's what you get from tracker react
without tracker react you cannot do this
or at least not this same way so we have
this state dot subscription at that
resolutions and meteor and react just
take care of everything else now the
only extra thing we need to do is when
we leave this page or win this component
unmount right when this components no
longer being used you know we don't want
to do is we don't want to remain
subscribed to that data we want to
cancel that subscription so let's go
ahead and down here add a method here
and this is going to be a react method
called component and we'll unmount let's
get rid of this comma so component will
unmount so when it's unmounting we're
going to then get to call a this dot
state that subscription dot resolutions
dot stop and then parentheses because
that's a method here so basically when
this component unmount then we no longer
want to subscribe to this data so we now
have total flexibility and freedom to
publish only the data we want to publish
and to illustrate this really quickly
let's go ahead and I'm going to do
control m and it I'm going to change the
value of hello right here actually let's
make it the resolution number one which
is finished react meteor series now
click update here i'm going to change
this false to true and save this okay
since we don't have a method of doing
that right now on the front end of our
site so what we were going to say now is
you'll notice we have nine resolutions
available to us and all nine are being
displayed let's actually head to our
publish code and let's have some
brackets in here and let's limit this
query to where complete
is equal to false so now we're only
going to publish the resolutions where
complete is equal to false and if you'll
notice once it's reloads instantly we're
now have only access to one of eight and
no matter what database queries we run
on the front end we will not have access
to that ninth one nobody will have
access to that it makes it entirely
hidden from the front end cool so I hope
this was a good explanation of publish
and subscriber publishing the data we
want right here and we are subscribing
it to it in our state and then we get to
use that data and then when we no longer
need to use that data we're saying hey
stop using that data cool so as always
this is scott will develop tutorials if
you want to purchase a series before the
rest of these videos released on youtube
and you want to see what's yet to come
and what's even going to be held back
from youtube and only available through
download or subscription head to store
that level up tutorials com and check
out meteor and react for everybody I'm
doing a lot of really cool stuff in this
series and it should take you to places
that you haven't been with meteor and
react so as always this is Scott thanks
for watching and I'll see you in the
next one bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>