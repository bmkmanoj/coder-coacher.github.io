<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Meteor &amp; React For Everyone #12 - Adding User Accounts &amp; Adjusting Permissions | Coder Coacher - Coaching Coders</title><meta content="Meteor &amp; React For Everyone #12 - Adding User Accounts &amp; Adjusting Permissions - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/LevelUpTuts/">LevelUpTuts</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Meteor &amp; React For Everyone #12 - Adding User Accounts &amp; Adjusting Permissions</b></h2><h5 class="post__date">2016-05-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/eNxuaTGq4Qk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up this is Scott with level
up tutorials and in this video we're
going to add user accounts and set up a
little bit of permissions for who can do
what on our account whether you're
logged in or not logged in or modifying
your own content so let's get started
now
okay so we have all of our stuff in here
but I mentioned before I want to make
sure that each of these is tied to a
specific user so you can't actually
create a resolution without being a user
right so let's go ahead and talk about
the user accounts package now the user
accounts package is awesome with meteor
so if we head to sublime text and let's
just head to our packages let's go ahead
and add a couple of packages one's going
to be accounts UI and another is going
to be accounts password now I'm using
the accounts UI which is actually going
to be using some blaze templates now
there is an account solution that works
with meteor 1.3 but it's a little bit
more involved and it does use straight
react though now the reason why it's
more difficult as because that accounts
package is actually built for 1.2 and if
you use it with meteor 1.2 it works like
perfectly but without with 1.3 you have
to do some additional work to get that
going so it's beyond the scope of the
basic series so that's why we're going
to use accounts UI and accounts -
password now we're going to actually be
able to use blaze templates these pre
created meteor templates within our
project simply by just creating a
component this is pretty cool
so let's check this out the first thing
I want to do is I want to go ahead and
create a new component so I'm just going
to do that in the root of my client
directory we're gonna say a new file new
file is going to be named accounts UI
dot j sx now we're going to import react
comma brackets component from react and
we're going to import react Dom from and
then in a string react - dumb like that
and now we're going to create a new
component we can say export the
fault class and have this be accounts UI
extends and then component okay now we
just need our curly brackets cool okay
so this component is going to
essentially just render and what we're
going to return is going to be returned
a single span with a ref of container
okay so this is going to be the
container that will hold the blaze
template now you might be wondering
ablaze is if you're new to meteor
blaze is meteors front-end framework
that comes with meteor if you followed
the intermediate meteor or the meteor
for everyone series before this I'll be
front-end code that we did with that was
written in blaze and since this accounts
you I it says this accounts ui package
actually has so many great templates and
features we might as well just use it
for this as well so let's go ahead and
now have a component did mount so we can
say component did mount make sure
there's no come at the end there and say
this dot view is equal to blaze dot
render and then we can have template dot
login buttons okay now this is the blaze
template that already exists again we
can say comma here and then before the
closing parentheses we can say comma
react actually I'm gonna do it this on a
new line
just so we can see this react Dom dot
find dumb node and then pass them this
refs container okay
now we finished that off with the
parentheses and the semicolon so what
we're doing here is we're setting the
view equal to blaze render so we're
going to be rendering this template
button into what is this container so
that's what component did mount so now
what we want to have is component
we'll unmount so we can say component
we'll unmount again make sure there's no
comma there if you have this Auto
completion on and we can now say blaze
dot remove and then this dot view like
this okay
so check this out when it's mounting
we're getting the blaze template login
buttons we're rendering it to the down
view which is in refs container which is
this span and then when it unmount we're
removing it so now we should be able to
have access to these logins so let's go
ahead and head to our main layout we can
get there just by main layout and we had
resolutions and about let's go ahead and
add our accounts UI we need to close
that tag but if you remember to use a
component we need to import it so import
accounts UI from and since we're in
layouts we need to go back a folder so
we can say dot dot forward slash then we
can just give this account's UI JSX cool
so we're a referencing back a folder
finding accounts UI JSX and now we have
our accounts UI so as as simple as that
let's actually check out our website now
and make sure things are going well
you'll notice right off the bat we are
greeted with this sign-in now keep in
mind I haven't done any styling to this
so you'll want to do some CSS work
obviously on this and if you wanted to
use the unstyled one you can do that all
the same just by creating components for
those perhaps you want a component that
has the the login buttons or the login
window itself okay let's go ahead and
just click sign-in and now we have
access to a full user login account now
you'll notice obviously I don't have an
account because we haven't created
anything so let's click create an
account create an account and here we
are cool so we now have a login I'm
logged in now and we can verify this
simply by in our command line we could
say meteor
that user ID as a function and it's
going to give you the current users ID
cool okay so now let's say we want to
have each of these resolutions here we
want these all to end up actually with
this user ID whenever you create a new
resolution we want it to be attached to
that particular user I'm actually gonna
go ahead and delete a few of these
because in a minute here once we change
our publish settings we're going to lose
access to all of these so let's go ahead
I have two alive right now - still in
the database you see that we access to
our current user login by having meteor
user ID let's go ahead and jump into our
methods
so in our methods and now let's create a
new field in here and we can say we can
say something like user and then colon
and then now you can simply just paste
in meteor dot user ID now check this out
because we're logged in it's going to
have us this meteor user ID that's
that's super good we that's exactly what
we want okay so let's go ahead and add a
new resolution here we can just say do
yoga enter now let's check out the
command and control M resolutions and
you can see let's finally do yoga and
now it is attached to a user perfect so
what we can do now is we want to limit
somebody who's not logged in so somebody
who's not logged in should not be able
to add a new resolution we can do that
within the method itself and that's
going to be really nice because
obviously what you want is your methods
to be nice and secure you don't want
somebody who isn't having account be
able to add stuff into your database
okay so let's go ahead and say if
exclamation point meteor dot user ID so
what this is saying is if there is no
user ID then Thoreau
new meteor that error so now it's going
to throw an error and we can just say
not authorized so this is just a simple
if you're not logged in meteor dot user
ID then throw new meteor error okay we
can add a new one so we can say do
handstands okay you can see it added
fine let me just open up an incognito
window here and enter this in here
because in an incognito window you're
not going to be logged in I'm gonna also
open up my command line and we can say
let's click out of here let's add one we
can just say jump more so as you can see
it has not been added but we don't have
anything going on in our council log
there's really no indication to the
front end user but as you can see this
series has not been added okay so now
let's just step one really let's head
back to our normal window here so let's
get started working on this making this
just a little bit more security you'll
remember that we said we only wanted to
really see the resolutions that were
created by the user that's logged in for
instance we don't want any resolution
that's not created by the current user
to be visible and right now finish react
native and dance in my office are not
owned by me so let's go ahead and change
that and our publish we can in publish
j/s remember when we had all the
resolutions let's go ahead and just
change let's go ahead and copy this
let's make a new one and let's just have
this be user sorry that should be user
resolutions and so this is going to be
the current users resolutions now we can
have brackets in here and now we're
going to be looking for a resolution
where the user is equal to and now we
can access the current user within
publications by this dot user ID and you
might be wondering why this dot user ID
and not meteor dot user ID with a funk
well everywhere on meteor except for
published functions you're gonna use
meteor dot user ID as a function in this
case we're using this dot user ID
instead of a published function to get
the current users ID so as you can see
here resolutions that find where the
current user is equal to this die user
this dot user ID is going to give us the
user resolutions all right so let's copy
this and now paste this in it to our
resolutions wrapper for the subscription
and if you remember we subscribe to all
resolutions but now I want the
subscription to be to user resolutions
which is only going to give us the
current user resolutions okay so you now
can see when we tab back we now have
access to to two resolutions even though
there were four in here if we do ctrl M
you're going to see that we only have
two in our Mongo
no user is going to have access from the
server of any resolution that's not
owned by them amazing so that's really
super good this is a step in the right
direction because now obviously we can't
get at other people's content when your
things are now private to those logged
in if we were to log out again I'm gonna
just throw this open in an incognito
window and you're gonna be able to see
these two which is funny because these
two are created with no user now that
we're logged out let's just delete these
two otherwise we wouldn't be able to see
them and now that we can't add any so
either way we can't see anything here
obviously you would want some sort of
basic text to say hey log in or
something in another video we're gonna
be having a little warning message pop
up when you try to log in here when you
try to submit a resolution here but as
you can see here we have access to these
two and in the other window we have
access to nothing cool okay so let's
secure this up just a hair more you'll
remember that we had access to let's go
to our methods here we had access to
delete and toggle a resolution obviously
we want the current user to only be able
to update their own if you also notice
we were passing this this ID and
and in this one we're just passing an ID
let's go ahead and update how we do that
we actually want more information in
these methods so to get started let's
head to our single resolution resolution
single and where we pass this multiple
properties we pass this props that
resolution ID and resolution dot
complete let's get rid of this complete
and let's get rid of all this up until
where it says resolution so now we're
giving toggle resolution this entire
object of resolution same with the
delete we're going to get rid of this ID
so now we're passing this entire object
in here what that means is that our
methods we now have access to let's go
ahead and change this to resolution and
let's go ahead the same thing right here
now we actually have to address these as
resolution dot and then it's not going
to be status because the property is
complete so resolution dot complete and
instead of ID it's going to be
resolution dot underscore ID so we're no
longer passing these arguments in here
we're actually using the object as a
whole and again resolution ID resolution
dot underscore ID so why don't we just
do this well we did this to have access
to the user let's go ahead and grab this
if meteor user ID let's paste it above
each of these here okay and I'm gonna
use this to say if current meteor user
ID is not equal to that should be two
equal signs if the current meteor user
ID is not equal to resolution dot user
then throw an error okay I'm actually
going to now copy this line rate up here
and paste it down here so we're saying
if the user ID which is the ID is not
equal to resolution dot user then throw
an error and do not allow you to remove
or do not allow you to update you'll be
able to see we can remove do handstands
still and what we can add
yoga and we can add do yoga again that's
just perfectly fine but for some reason
if somebody had access to these IDs or
anything like that on the other end they
wouldn't be able to run these methods
without getting an error right so this
is just an added layer of security
basically making sure that the right
person has access to the right things
now this is really shaping up you have
to be a user to submit a resolution you
have to be the same user that created
the resolution do anything with it and
we only have access on the front end to
the information that we're allowed so in
the next video we're gonna dive into
some more JSX stuff we're gonna show you
some conditional stuff and just really
how to get around in JSX doing some
things with classes and other things so
as always this is Scott with level up
tutorials if you want to help support
these free tutorials had to start out
level up tutorials calm and you can
purchase this series right now and get
access to the rest of the videos before
they're released on YouTube as well as
bonus content including code and extra
videos that will not be made available
on youtube you can also get access to
these videos and content by subscribing
and becoming a LevelUp pro so as always
this is Scott with level up tutorials if
you have any questions or comments leave
a comment the video hand me up that
Twitter or Facebook I level up tutorials
thanks for watching and I'll see you in
the next one bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>