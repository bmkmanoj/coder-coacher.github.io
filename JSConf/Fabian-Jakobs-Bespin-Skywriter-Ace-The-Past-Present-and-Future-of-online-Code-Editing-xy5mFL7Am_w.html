<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Fabian Jakobs: Bespin, Skywriter, Ace - The Past, Present and Future of online Code Editing | Coder Coacher - Coaching Coders</title><meta content="Fabian Jakobs: Bespin, Skywriter, Ace - The Past, Present and Future of online Code Editing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Fabian Jakobs: Bespin, Skywriter, Ace - The Past, Present and Future of online Code Editing</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xy5mFL7Am_w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm very excited to send here a little
bit intimidated by this huge audience
yeah let's start off with who we are
what we do my name is fabian jacobs i'm
working at HX org on the cloud nine ID I
won't show of the cloud nine ID today
we'll just do some demos with it and
maybe you see some features but if you
want a cloud nine demo grab me
afterwards I will I will just do it
before working on cloud nine i worked at
cook sous for cooks to anyone knows kosu
in this room yay okay and yeah for the
online ID we built we obviously need it
an editor on that is what turn ours out
to be ice Kevin okay and I'm Kevin
tangora and the manager of developer
tools at Mozilla so this is part of what
we do actually when I started Mozilla I
started by working on Bespin so I've
been working on this stuff for a while
but now we've got a whole bunch of stuff
we're working on in developer tools so
that's that's me okay so code editors
yeah creditors are nothing new right i
mean we've got lots and lots of them i
don't know how many of them i mean they
seems like there's a new one all the
time so it seems kind of like it's not
rocket science and that's true but at
the same time there's a really there's a
lot of fiddly bits when it comes to
writing a code editor that's good and
usable and when you're building a web
based editor you have the web based the
fiddly bits right i mean we don't know
about those and you have the fiddly bits
of getting code editing right so one of
the things that we wanted actually from
the beginning of best bin on forward is
basically no compromises that we want
this to be an editor that competes at
the same level as desktop editors it
shouldn't have any you shouldn't feel
like oh man I'm really giving this up to
go work on this to use this editor it
should be the one you want to use so
that's what we strive for so basically
the ACE editor that's what it stands for
up their age I stood or cloud nine
editor but ace is a lot easier to say
it's fully featured so that means it
really has a lot of the stuff that
you're familiar with and comfortable
with and you'll see some of these
features in action as we go along here
it's extensible so you can write your
own syntax highlighters you can
aight themes you can write new commands
for the editor change the keyboard
bindings do all kinds of other things to
it so it's extensible it's scalable so
if you have multi tens of thousands of
lines of code in a file you should
probably make the break that file up but
if you do you can you can load it in
this editor and it's not going to crash
and cross-browser going back to ie7 so
this is basically code you can run
anywhere and that's one difference
between ace and Bespin was best been
used canvas so it didn't run out of
older browsers ace doesn't have that
particular constraint so I'll hand it
over to Fabian to do a demo ok yeah I'll
do a small demo today the goal is to
have like a small CoffeeScript
prevarication like a seat here we're
going to have to ace instances one on
the left where you type CoffeeScript no
code in and one on the right where you
see life the compiled JavaScript of this
CoffeeScript and yeah we're going to
build this thing right now but before we
can do anything useful I just want to
introduce some basic building blocks you
know what I'm talking about when I site
editor at edit session so the basic
entry point is the editor instance this
is like what you're dealing with a nice
all the time the editor is like in the
Model View controller sends the
controller it has a renderer the rainbow
right now is Dom base as Kevin said
there might be others in the future but
right now it's dom base and then there's
the edit session which encapsulates all
the state state is the document you're
writing the language mode of the
document language mode would be like
which syntax highlight is to use and
initation information and the selection
so if you were to write on editor with
multiple taps it would just keep the
editor and switch the the Edit sessions
because the edit session contains all
the state related to a document yeah
i'll just have prepared a small video to
see how the project can be set up this
is the cloud nine homepage
I'm signing in right now signing with
with github you can sign in with
password but it up is usually easier
because I'm always looking except no and
yeah this is the dashboard and I'm now
pasting the URL of the project this will
be in the in the show notes i almost
said this will be in the node so you can
check out the project afterwards and
it's now cloning the project on the on
the cloud nine server and opens it in
the ID and since we are going the demo
i'm resetting to step one so now we just
have like the basic application
framework and you see we have a as kids
sub-module but it's empty a cloud nine
supports a gift so it can just type get
sub-module update and fetch all the
dependencies of ace usually this takes a
while but fast forward this in the video
I'd reload you see there's the ace
repository a submodule and there's a
small server this is a small note
programme which is the static file
serving we run it and it breaks because
mine is not installed and we just do NPM
install mind
here we go hit refresh and this is the
candidate of the new npm 120 and this
installed mine on the inside of the
project and now the the project is
running on coffee previewed f jakub dots
in ohio if you grab your device go there
you will see nothing yet because this is
the video but we'll make it live now so
these are the preparations let's
continue from here so you've seen this
in the video I'll make this may be full
screen it full screen so pick the static
file server he'd run so in if you now go
to this link coffee preview a few cops
that's United I oh you will see this oh
that's not exciting because this is just
the boilerplate HTML let's take a quick
look at the at the layout here so we
have an index.html file it has a div for
the left pane and it did for the right
pane in the left pane there is a header
with name coffeescript and the div with
the ID coffee edit this is going to be
the editor and inside of this we have
some JavaScript code and the same for
the right pane a div a header and did
further for the editor and at the bottom
they are they are two files included one
is a Sun compressed the the package
version of s if you're an editor and
just want to a developer just want to
embed a sin your page we have like a
prepackaged version this is what you
just put in and it reference the app
chairs which is still empty like there's
also small stats fire but we're not
going to touch this so this is the empty
file so what I'm right now could have
written on my t-shirt yesterday so our
ace
so this puts an ace this has some some
convenience API which wraps some of the
stuff that you could do if you want to
really customize other editor and then
can save our editor equals a start edit
coffee edit save it refresh yeah so we
have an editor it's not really nice
because this is just plain text but we
know this is CoffeeScript so we should
tell the editor that it's in
CoffeeScript mode so what we do is we
import the CoffeeScript mode mode
coffee and typos are we are done mode
thanks and then we say editor get
session you might remember that the
session is the one which keeps all the
state and the session keeps also the
information which mode to use so so we
get this and set mode new coffee mode
and this doesn't work yet because as I
said we have a prepackaged ace and we
obviously don't want to include all the
language mode in one big file because we
have like 17 language modes now so I'm
going to tell the index HTML that it has
to load the mode as well so it's mode
coffee and since we know we're going to
use JavaScript later I let JavaScript as
well
alright let's see if I made it right oh
yeah I did just takes away so now we
have javascript mode we have syntax
highlighting we also have stuff like or
to indent if I put my cursor here press
ENTER it automatically indents puts the
curves in the right line so it does have
some basic information support for for
coffee script editing yeah the only
thing yeah what what what I don't like
about this it's the the colors I don't
don't really match what I have in mind
ace supports a bunch of teams basically
we support textmate themes which can be
converted into a steams and i'm going to
use slightly more beautiful one it's a
the Twilight theme from textmate
and as well the language modes let's
first put it here edit or dot set theme
don't have to knew it we need to include
it as well
yeah this looks a lot better this is
what I like so what's missing now is
doing the same for the right-hand side
for javascript mode this is really easy
just take this block copy it down and
then I call it viewer
and it's definitely not coffee mode it's
JavaScript much so we need to import the
JavaScript mode as well
and since we are only only want to view
this I also set this to read only sit on
this net
right oh yeah this is jay is edit yeah
we already imported the javascript mode
and their HTML files so now yeah that's
basically that's how the UI should look
like what's what we have to do now is
like hook up the the CoffeeScript
compiler to the to the coffee coffee
script editor this basically means we
listen for change events in the document
run the compiler take the output of the
compiler and put it into the JavaScript
mode javascript editor not going to type
this now just check out the step step Oh
get research out and it's gone okay
yeah you see now the CoffeeScript this
is the package coffee script file just
download it from the website see in the
index HTML just put in the CoffeeScript
is the FJ has changed a little bit so
this is what we had before and here
editor get session gets me the session
listen on change events and whenever
something changes I call the update
method and also I call update right away
because I want to have it initially and
what i do is i get the value of the
editor session stuff it into the
CoffeeScript compiler if there is no
syntax error and go here and stuff it
into the javascript editor the lines 27
and 29 are mainly there to remain to
maintain the scroll position so let's
see if it works yeah so now I can can
type something here like alert you if X
X we go to and you see it's putting it
here in the editor hey thanks
but obviously there's one problem with
this approach if you take a look at this
I have some eggs or giveaways whoever
points me to this can get a checks or
give away what is the problem with this
code yes ya know this code works now
it's it's in the broader scope its
performance issue okay exactly this is
this doesn't sound like good idea
doesn't it so the answer is I'm
compiling the entire script on each
keystroke whenever the document changes
and things get even worse I do this in
the UI thread so imagine I've like
10,000 lines coffeescript file type
something and then it takes two seconds
to compile it after each keystroke and
the browser freezes not so nice but
before we're going to fix it I'm going
to show you a little bit of the
technical details of ace let's go back
make sure to come come come to me after
their after the talk technical details
yeah as we already mentioned the
renderer is a pure Dom so but the dome
is used in a special way we basically
treat the Dom as rendering API with
primitives like lines and rectangles and
text and nothing more we start really no
stateful in the DOM and we don't really
we never read from the Dom so it's right
only fast which is really critical in
terms of performance because reading the
DOM is really one of the slowest parts
you can do a slow stuff you can do in
the browser especially if behind the
scenes the renderer kicks in and resize
computations are done by the browser you
have no influence on so we never ever
read from the DOM and the ideas also
that rendering the full document as dom
is just too expensive like have if you
have a 10,000 line document created
create Dom structure for every every
line of this this doesn't doesn't scale
so what we do instead is we only render
the visible roads this is something a
Bassman did obviously because if you're
in the canvas you only there's no point
in rendering what you're not seeing but
it's also something that other web-based
editors pick up especially code mira tu
from orion are here yay and also the
orion editor bye-bye eclipse from Boris
who is doing a talk later today they all
use a similar pro so that's pretty much
how you have to do it if if it should be
fast and also in terms of performance
yeah one of the the key concepts that we
had in mind was that document size
should never matter in terms of
rendering performance so everything
would it runs in the main browser thread
should add max scale with the size of
the viewport so if you resize the
viewport it's ok to get a little bit
slower because we have to render a
little bit more but if we double the
size of the document that shouldn't
should
difference but not everything can be can
be done incrementally so especially if
you want to do stuff like syntax
checking our jslint stuff this is only
possible if you pass the whole document
and that's where web brokers I really
need it and that's where yeah without
web workers a lot of the cool stuff that
we are that we have implemented and that
we're going to implement in the future
would simply not be possible because of
the the problem I mentioned before other
your eyes thread simply blocking us and
the way we do this is we have
infrastructure for web workers basically
the edit session has reference to the
document that that is what I explained
before and the worker for example
JavaScript parser is connected to the
edit session whatever something changes
in the document the work is notified but
since the workout that cat doesn't share
any any memory that worker cannot simply
access the document instead the worker
keeps a mirror of the original document
and basically the the change events
emitted by by the document which also go
into the under stick are intercepted and
sent to the worker and the workout then
keeps a mirrored version of the document
and whenever the workout decides that
some and some stuff needs to be done on
the document and simply can use its
local version and then send events back
to the main thread like there's a syntax
error in line 10 or there's a missing
semicolon in line 20 stuff like this so
which brings me back to the to the
source code
by the way everything I do here sissy is
online this is this is running on our
server I'm not running anything locally
yeah which is certainly good testimony
to the Wi-Fi here because that doesn't
work in every yeah yeah I was a little
bit scared to do this over the Wi-Fi and
had a back-up plan but the boy was so
good so I thought it would be brave to
do this yeah i just checked out the the
last version you see 22 files have been
added there's coffee jrs which basically
extends the existing CoffeeScript mode
in eighth and overrides the creative
work of method so this is subclass of
the build and a smoker and you see here
it's creating the work a client and then
what I said when the document changes
it's sending the deltas to to the
workers of the work it can keep the
mirror and on the other hand the work
itself emits events in this case the
worker emits an error event for for
syntax errors so when the JavaScript
compiler cannot pass the document syntax
errors are returned and we're using the
set annotation function of ace so you
can see annotations like these here
unnecessary semicolon this is this will
be shown as error in the in the editor
and the other event fired by the the
worker is the joyous event which is
emitted whenever the pass was successful
and in the data a part of the event is
the the fully passed JavaScript version
of the coffee script file so this is
like the modified version of the
CoffeeScript mode the actual work out
looks like this let's concentrate just
on the one update function don't update
function is very similar to the update
function I've shown before which run in
the fjs it's grabbing the value
compiling it with coffee script then if
an error q
I don't ignore it like before instead I
do some regular records magic to find
out which line the era was what exactly
the error metric message was and send it
back to the editor and otherwise I just
omit the compiled JavaScript and in the
the fjs I need to reload this far here
this is a lot cleaner now what I were to
do is I simply listen on the Jays event
which is propagated from the worker and
whenever this event is emitted the value
I take the value from the event and put
it into the javascript editor so when I
reload know basically nothing has really
changed so it still looks yeah it took a
little it still still looks exactly the
same except that if I make a syntax
error now you see that it's putting
unexpected identifier Jeremy are you
here I would like to have better error
messages otherwise coffeescript really
rocks and if i type here for example in
this array see that it's no it doesn't
update oh that's your next error oh yes
still syntax errors
yeah it updates the right paint but now
the difference is that it never locks my
typing so I don't don't feel any like
when i type because all the heavy
computations are done in the background
so this is the final version you can
I've put it on github I'll post the I
show the link in the last slide right so
Kevin maybe you can show some of the the
other ace features all right so yeah so
that's a good introduction to how you
can integrate ace and extend on it i'm
just going to show a few other features
that you can use an ace that are kind of
interesting so for people who saw best
bin as it was a couple years ago there
was a command line that was one of the
somewhat unique features there's a
command line because editors often grow
a lot of features and so that command
line is still available if you want to
use it and basically in this case we're
taking the replace all command you can
see that not only does this command line
give you help but it actually gives you
a form you can fill out if you prefer to
use a GUI and one other thing that comes
along with that is that if you want to
not have the command line there you can
basically run you could make it so you
could run editor commands oh a race
against time um let's see let's get this
playing again oh I want okay
well anyway what I was saying about the
command line it was that the really cool
thing about that is that you could have
you could basically have a pop-up of
that gooey window that had to replace
all command input without having the
command line if you want it but of
course the command line is great because
if you have a command line that
basically means that people can run any
command I'm using keyboard access and
they can discover the commands really
easily through the help command and all
that so that's that's a pretty cool
feature and you can use it you know if
you're not actually it's an optional
module and you can see that you know
running replace all doesn't back to
replace all and really pretty much all
the editor commands everything you do in
the editor is this sort of command you
can that you can actually use this way
another feature i want to show off is
something that a long time best Minh
contributor just contributed it's
basically code folding Julian furyk
coded this up in just a few days it's
pretty amazing now the way that code
folding is implemented right now is
unstructured code folding or what
Wikipedia calls user folding where
basically you can select any arbitrary
range of text and say fold this and it
does it drink sit down so it means you
can shrink down argument lists if you
want you could shrink down blocks of
code the great thing about this
implementation is that that means you
know we're probably most people probably
used to structured code folding where
it's based on your program structure
it's very easy to implement structured
folding on top of this kind of folding
it'd be hard to go the other way around
so so that's a pretty cool feature that
that just recently landed in the tree
yeah this week actually yeah just a few
days ago and the last thing I wanna show
is basically a Firefox plug-in made by
goes on github basically it has VI key
bindings because he really likes VI so
that's one of the unique features about
aces that you can you can do VI or emacs
tile key bindings if you like and that's
the way this one works you can see I'm
pressing like a scape kkkk to move up
and odo open the line so that's pretty
cool but the interesting thing also
about this is that he made it this is
actually a Firefox add-on so if you put
edit colon in front of the URL it'll
download that file and then let you edit
it so that's
kind of need okay so we're just going to
talk a little bit about the past present
and future of the project so i'll just
start with the past so to paraphrase
carl sagan if you want to build a co
deter from scratch you need to first
create the universe so 13.7 billion
years ago we had a universe created but
in the dinosaurs would love this editor
if they weren't so busy eating things
and then 230,000 years ago humans came
along I was probably a good thing bacon
everything is better with bacon 1770
1983 the a-team who wasn't influenced by
the a-team these guys probably were
benin dion yes so now we get into
something actually relevant svet bed and
dion in two thousand eight or so
basically we're thinking wow you know
the web has all these cool things all
this new technology like canvas and
things like that that we can use
wouldn't be cool if we could do all of
our editing in the web browser we could
do all of our coding in the cloud and so
they whipped it up and then they tried
to figure out what to do with it and one
of what they decided to do with it was
to bring it to Mozilla so in 2009 best
been made its launch into the world as a
mozilla labs project so over the course
of 2009 we were busy figuring out doing
all kinds of experiments with it
figuring out where we want to take it
what made sense for Mozilla what made
sense for the project and then in 2010
we had some ideas what we wanted there
and that became Mozilla skywriter
basically a more fully fledged project
because we had kind of had a better idea
of what it was all about and at that
point we're really much more focused in
the embedding case and we were thinking
kind of toying with the idea maybe we'd
have a server side that's based a node
and things like that and then jst you in
Berlin just a few months ago we met
these guys who actually had the server
side that we were imagining they were
actually using webdav the same way we
were thinking up and we thought hey this
is great you know we might as well work
together on this because we're really
heading in the same direction and so
that's what brought us to this point
that's you know how a sand skywriter
merged together so that you know we got
the best features of both so that brings
us to the present so edit a hobby yeah
so today
we have a couple of applications using
it one of my favorites the cook soup
playground now uses a CSS editor it's a
very cool project called source code
which is I think it's a chrome app which
you can use to access files on your
dropbox Dropbox account and edit this
boo days there's something called blue
Griffin it's based on Mozilla sewell
technology it's a HTML editor which uses
ace to edit HTML files there's our
studio this is really cool because it's
like a niche product for for the our
statistical analysis language and they
build language modes for the our
language for la tech for things like
three or four different language modes
it's used in the add-on builder at
Mozilla and obviously in the cloud nine
they also a couple of more projects but
these are some of the use cases we can
see is already being used and right now
we have something like 30 plus
contributors so it's really active it's
active on on github we have a lot of
Watchers and Fox are 11 number i'm
particularly proud office that we have
more than 230 pull requests so people
really contribute and this is goes from
like small bug fixes fixing typos adding
language modes to stuff like a code
folding are contributed by by you don't
fear which is like a major major part
and right now we have like 70 language
modes this week we got think closure and
okie are not support for the more freaky
languages the cool images and yeah for
the future we we have big plans
especially for the IDE we want stuff
like deeper language integration anyone
who has seen the talk by Peter fantasy
doing static analysis on JavaScript and
doing really
highlighting problems in the source code
code completion code navigation code
falling all this is something that we
are we are working on that should should
lend an ace probably by the end of this
year and one probably the biggest
missing feature at this point is
documentation best bin was pretty good
in terms of documentation ace isn't yet
but that's something we are actively
going to work on and that's it so check
out ace for kit change it send in pull
request just have fun using it Thank You
rose take me home to the place I belong
port the door again jazz car country
road</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>