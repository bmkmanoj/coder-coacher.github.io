<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Justin Meyer: Thin Server Architecture and JavaScriptMVC 3.0 | Coder Coacher - Coaching Coders</title><meta content="Justin Meyer: Thin Server Architecture and JavaScriptMVC 3.0 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Justin Meyer: Thin Server Architecture and JavaScriptMVC 3.0</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Pxmj_TIELjY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">ah my name is Justin Meyer I work for
Jupiter JavaScript and salty all we do
is JavaScript consulting and today I'm
talk a little bit about JavaScript MVC
and you might be wondering what is
JavaScript MVC JavaScript MVC is taking
all of our last three years experience
writing jQuery applications and then
injecting them into the ass of jQuery
what Jake wit what it is is JavaScript
it's it's jQuery on steroids all right
that is JavaScript MVC and yeah so
that's us but there is no you know this
isn't the MLB there's you can use
steroids in your JavaScript development
so what makes a real big strong beefy
JavaScript application that's quality
maintainability and development time so
what are we what are we juicing on with
JavaScript MVC well for quality we got
like the HGH of dependency management
air reporting and testing for
maintainability we've got the MVC
architecture the thin server
architecture of like is the gym and for
development time we got like the android
or and row of generators and widgets and
things like that so or talk today about
is like all these little tiny components
that with three point o are all going to
become individual that you can use
independent of the entire framework and
how the combination of them you can
really build large enterprise jquery
applications so the first thing i want
to talk about is thin serve our
architecture when we're hired by our
clients it's invariably to clean up the
mess that javed ajax left behind see ten
years ago we really had it all figured
out right the the server would just get
HTTP requests and respond with HTML that
could pretty much do everything and then
ajax came around completely uninvited
and just messed up everything because we
were left medium to decide do we put
this functionality on the server do we
put on the client the lines got blurred
responsibilities got
shared and this is kind of what we do it
is cleaning this up with jQuery so what
is then sir architecture well there's a
semi and a problem so since our
architecture is really an approach to
developing this where it's kind of
draconian that just says do not produce
HTM on your server except to just get
your page started and everything is
service based because it really benefits
from the you know service organization
everybody's been talking about for years
but nobody really does so the first
thing for jobs should we see is it kind
of leans towards an application
architecture kind of like this you don't
have to develop like this but it really
wants you to there's a lot of benefits
to this and I don't have time to go into
really any of them but Peter Svensson
he's around somewhere here he gave a
google talk about in server architecture
where if you haven't looked at it please
look that up because it goes into all
these great benefits and it's a great
way to build your applications okay so
the first thing we noticed when we were
building these large giant JavaScript
applications is that if they produce a
lot of files but at least they should
have been because we weren't actually
creating a bunch of files because
there's all this overhead where you got
to like add some functionality if you
want it to be in a its own file like it
should be you've got the problem of like
actually adding it to your build script
so the first thing we worked on because
we want to be as lazy as possible is a
dependency management system so we built
steel so steel is really the easiest way
I think to do dependency management
possible so we've got this long let's
add some extra open tabs
fun with live demos um so we've got this
basic HTML application up so we can look
at the HTML of it real quick and you'll
see we are loading reloading jQuery and
jQuery UI from the CDN and just adding
some real basic inline functionality
this isn't code that you know we would
ever do the first step for good
dependency managers just make it so or
compression is make it so you don't have
a separate script to mess up so I we
release with steel you can just run a
simple script point it at any page the
page can be online can be anywhere it
can read the scripts in your page and
then just compress your application so
this is loading from the CDN takes a
little bit because the internet is slow
and while it's compressing we can
probably go and just switch to the
compress app that it's making so this is
you know this is nothing really like
special at this point it's just showing
one little tiny easy thing we added on
to something like closure so you don't
have to worry about your build scripts
but it fails in two ways the first is it
doesn't do any dependency management at
this point right if we have another
application that needs to load a bunch
of scripts how does it handle that and
then there's that annoying bit of like
having to clear out all the other
scripts and then kind of switch to the
production bill so what we've made is
also the steel script which is pretty
easy so if we look at another page it
has the exact same functionality that's
basic HTML we can see here we load the
steel script and then tell it out for a
script to load and then if we look in
our basic j/s we steal jQuery and jQuery
UI and then describe the functionality
that we want that depends on that now if
we have another application like that
adds some bonus functionality so we can
look at that real quick so it's
okay so this is like added functionality
from the previous application we have
another HTML page with another HTML
bonus page that loads bonus shares from
getting remove the production it's going
to work yeah and then we have the bonus
GS that it loads and that just loads the
other application and adds whatever
functionality it wants its just really I
mean this is just a very basic example
but you see the syntax for loading
dependencies and then and then running
them is really easy but the really
awesome part is how easy is to take all
of those dependencies and just compress
them so if we compress this application
you compress jsu just point it to our
page can open the page in MGAs see every
script tag that's loading so this is it
could be you know this is a separate
package from all of javascript if you
see and you can use it independent of
the entire the entire product so that is
to switch to the production bill that
this is going to is going to make it's
really easy now we just do that comma
production so that's basically steel
made compressing and building your big
jQuery apps and doing dependency is
really easy so the next thing I'm going
to talk about is continue with this
theme of we're just very lazy developers
is the code generators what do you want
to do when you start building
application is get to like a working
state as quickly as possible you want if
you want to create alt like an
application structure and then you want
to be able have some real functionality
you can screw around with from the
server so we have generators which you
can have scaffold up basic functionality
really quickly
so this will generate an application
structure for us to work from with tests
and things like that it also will get to
integrates all the other features that
we're going to show and then we can
scaffold part of our data model so if we
have like a service that's producing
we're making a cook back cookbook
application here we can scaffold a
recipe model and then get some
functionality that we can we can go and
modify so oh we have to include our
files that we generated of course
so we'll include our recipe model and
rest of the controller that we just
generated we're going to get into how
these work in a second but it's really
nice to go from like absolutely nothing
working to being able to kind of edit
and delete things right away just really
basic so you can connect to any back-end
services you have just test out with the
servers working ok so the next thing I
want to talk about is class and I
wouldn't paid too much attention for
your own sake to this next slide this is
really just crap I put up just to show
that there's a lot of different ways
people do things in JavaScript a lot of
ways to write the exact same piece of
code and what you really need to do when
you're writing big jquery applications
is pick a organizational unit that you
can that you can develop from and you
want it to be like repeatable you want
it to be readable and you know just not
and basically legible so what we picked
is class this is based on Jenner Isaac's
class and we've added like all these
different features such as like
namespacing static inheritance mix-ins
introspection like it's a JavaScript
version of ad hoc polymorphism which is
just like a weird thing which is like
offshoot classes we've had a lot of
things and we basically build everything
around the structure and there's a lot
of debate if a class is needed but you
can pick you can pick any structure in
your JavaScript applications but please
pick one don't leave a bunch of nested
anonymous functions in your jquery cub
so the next thing is really the
model-view-controller is what we juice
on and we realize none of the facebook i
was talking about this these so there's
three things that you do in any
javascript application I really think
it's for and what I like to use an
example is like a Google style
auto-suggest so you know with the Google
style auto-suggest like someone will
start typing you want to respond to that
event then you're going to go to your
server and you're going to you're going
to pull back data and then maybe you'll
want to massage that data a little bit
to prepare it for the view or prepare
it put in the page or modify the Dom so
what we realize is if you can break
apart an application in these four parts
it results in much more scalar or a
scalable and modular code and this is
what the MVC of JavaScript MVC is really
about so to kind of break this down how
this how we envision breaking down
almost any JavaScript functionality this
is how we kind of do it so to use this
an example a you person types job now
that's an event and you want to respond
to that with new controller so we'll
have a will have a search controller and
that'll have a key up function these all
get bounds of that delegation will see
that more in a little bit and then you
want to wrap that service layer with
something we have a search model so
we'll make a using the search model will
make a request to find all searches and
then the search model will actually do
the service wrapping and then let's say
with that search data coming back you
want some domain specific functionality
on it right you want a little bit more
information than just the raw services
giving you like if you want to know if
it's already been visited or not you can
add that functionality in the model and
then when the model returns back the
list of searches you basically just
insert that use a client site template
to insert that into the dot this is this
is pretty basic now a lot of people
rightfully should be thinking right now
well all this takes like three lines of
jQuery code why are we turning it into
this light into this mess right here
well the difference is because those
three lines of jQuery code if you're
writing like and some of the apps that
we've worked on where they're like
hundreds of thousands of lines of code
it becomes a mess and you want to be
able to reuse and like wrap things so we
want a search model that we can call too
we want organize controllers that have
like a good layout so let's go into each
one these a little bit so this is the
controller and this is a skeleton of a
tabs code now this is really the bread
and butter of JavaScript MVC in my
opinion is what most people when they
use it they like and if you're jquery
developer hopefully right now you're
kind of marveling at its beauty it might
look like no the the nerdy
girl with glasses and a ponytail but
it's to me it's it's really nice because
first it's based on class so it's
extendable inheritable mix in a bowl all
these great things that you might want
to do with a widget you can do with it
but then it's clear the events are so
clearly labeled and linear right you
know that that Li click you're not
you're not binding event handlers and
this nested structure you're writing
rules for your widget not you're not
binding and these crazy nested things
it's just right there you just read it
you say oh it's Li click and that is
hooked up with event delegation and the
controller will automatically when it's
when you can remove the controller just
removes all its vent handlers it's all
taken care for you I also got some other
nice things like write that in the class
name of whatever element it's acting
upon it writes the its name in there so
when you're inspecting with Firebug you
can actually see oh it's a tabs widget
there must be and I'm clicking on an li
in the tabs wait I wonder if there's an
L if there's a tabs widget in my source
with an L I click right you have you can
see your code just by looking at the DOM
and then also finally God map it creates
a jquery plugin ok so model or connect
being able connect to a service is
really the linchpin of thin servers are
thin server architecture right you'll
need to be able to connect to these
services really easy so model is really
designed to do that the basic model can
connect to any service really easy and
map into that that search kind of
function out we saw previously but we
also have an RPC and a rest model that
can connect to those services
automatically so this is what would look
one would look like it's like two lines
of code and this would if you could
connect it to gears so with just this
line of real there's four lines of code
but really two lines of code you can you
can find all recipes and arrest services
you can find one recipe you can create a
new recipe you can update a recipe and
you can delete a recipe you get the full
like crud contract with two lines of
code and you're everywhere else can just
access it through this now we've got a
little demo which is that first skeleton
we made just replaced with that at one
line of code so here
can see it connected to you can see it
connected to the recipes JSON and you
can create and destroy them you can see
it making me the request for you now
this is really nice I mean this is not
anything anybody can't do but with only
two lines of code it's just nice to be
able to get this so if we like refresh
the page and now we can yeah we can work
offline this is your support right now
is prototype but uh now if we just come
back online I don't know you sure if
that will work you'd have to refresh you
have to delete it when you're offline
for any changes oh no we did delete what
I'll fine okay okay okay and then it
will make the changes for you
automatically all right built-in cool
anyways so let's the final piece of the
MVC triumph rate is views now there's
been a lot of talk on and lately about
Jake where it's like the most popular
thing is like should jQuery bring views
and everybody's like got their own
opinion and what makes what's the best
view template and to me that really
misses the point it's not necessarily
about the view it's about how you use it
because ever you're never going to make
everybody happy so with view we try to
make a stand or like a uniform
templating interface in JavaScript MVC
where you could use any client-side
template in kind of the similar way so
would it so an example of it would be
something like this this will you know
insert will render to do's ejs which is
a templating file with to do data and
then cert that after bar and what but
just by what we've done is because it's
uniform interface you get things like
compression and template look up for
free so currently supported is embedded
j/s which is this djamel and micro
templates so these are all support it's
really easy to hook into so here's a
like a brief example that's what a
djamel template looks like and ejs
template and they're all getting certain
to page in the exact same way so you can
use any template language you want on
the client with JavaScript MVC so a lot
of the benefit to the MVC approach
actually comes when you're doing like
in betweens these like little subtle
problems that everybody has to face when
you're building an AJAX application and
consider like a little to-do list you're
constantly when we are making a to-do
list having somehow label each div so it
knows that it's it to do so that later
you can call actions upon it makes no
which service to call and things like
that and figuring it out is like
something you have to do every time
unless you have a pattern that you
already know works and JavaScript MVC
work so a hypothetical to do controller
would kind of work like this so you
would first find all your to do's from
your service that you would then you
would show them and cert them into the
Dom because controller knows the name of
the controller and the action the show
actions ended it's in it can
automatically kind of like rails by
convention know where to look up the
view without you telling it to and then
in the view you'll loop through all the
to do's and you'll spit them in the page
with the template the real interesting
part is is this little bit yeah by
inserting something that's not a string
it knows to put that in the jQuery data
so that it later there it's really easy
to look up so when it comes time to
delete a single element right we listen
to delete click when that happens we
just basically go up one element to our
div and then we can get our model really
easy and then call destroy on that model
it's like that easy right it's it's
really simple so then because we use
open Ajax like published messages that
are the result of all our service
requests we don't have to if we had
multiple of these to do which it's on
the page and you delete one to do that
was shown another place while you just
subscribe to the delete of that to do
and it will remove itself automatically
all right there's just like little tions
that you're always constantly doing that
get handled because you're using this
a.m MVC approach all right so the next
thing is testing and this is really
really important and this is the coolest
thing I think to come out of the third
version of JavaScript MVC it's because
testing just sucks so bad right I look
is it noise selenium is awesome but it's
still
sucks so does all testing solutions
until now but you guys could say that my
sucks too so the problem with each
testing solution there's like three main
ways there's like a browser-based
testing which is like qunit and that is
really easy to write but it's manually
driven all right you got to stand there
and open each browser and test it
there's the simulated browser
environments like MJ s there's a bunch
of others those are really nice but
they're not really high fidelity because
it's not the real browser running but
it's fast so you can get like good gut
check if your codes really working and
then there's the like selenium the
browser drivers these actually pop open
browsers and then run your tests on them
those do have high fidelity but the
problem is very hard to write like
they're hard to write tests kind of hard
to debug test because sometimes it
happened so fast you came and see what's
going on so it's really needed is it
tier 2 you had a question ok if there
anybody is a question just raise your
hand sorry I should I said every way so
what we mean is funk unit and it's
really a tiered approach it kind of has
all of these parts in it but a really
nice asynchronous syntax that you can
write one test and it runs in in the
browser it runs an end and it runs in
selenium so the syntax look something
like this it's based on cue units syntax
but it's also kind of based on jQuery
too so you basically select something
this would test like a numeric txt bak
you can only enter in numbers all right
look at it's pretty basic you click on
it you you type in 27 it doesn't write
anything like it should and then you
type 27 the numbers and it has 27 it's
really easy unfortunate fortunately we
were we had a great enough client who
let us show some example of this running
that if we just started working on this
prototype for them so it's running all
the tests in the browser so if you look
at the funk unit page okay so this is I
mean it is qunit it's just we've added
this ability to like drive another page
with qunit so you can open another page
then click on things really easy so okay
we looks like real quick at the code for
what that looks like so basic okay so
this is what the code for that looks
like just like what we're looking at
before right opens a page clicks on it
check something exists check something
else exists then gets a text for it they
say sit the reason why it's kind of like
a synchronous like this it handles
asynchronous behavior really well you
can call weights because it basically
compiles the list of commands is going
to make and then runs them so we can run
this in selenium really really easy so
just the script this automatically is
integrated with JavaScript MVC so this
is going to open up this will take a
second or two this is going to open up
IE and then run those tests in IE so
this is all automated right so you can
actually just trigger a command and have
nightly builds run all this every night
but then be able but the awesome part
about it is I mean selenium can already
do this the awesome part is you can open
this up in your browser and debug it
right like you can you can have Firebug
hit an error and like see what the
heck's going on oh boy this is really
slow okay we can just it'll just show
some okays we could just cancel it then
yeah this is this is why i said it's
slow yeah so I should have mention that
every through this Third Point no
release it hasn't come out quite yet
we're trying to like the next week and a
half or two weeks everything should be
standalone we're trying to make
everything some things obviously depend
on jQuery but phone Canyon won't depend
on jQuery and steel won't depend on
jQuery but we're trying to make
everything is useful as possible for as
many people as possible it's a hook so
eventually he'll okay so that's funk
unit damn it is just a javascript error
reporting service a real quick demo this
causes an error
cause an air this will this is just a
really simple script that you can clue
your pages that detect errors and then
send will email you when an error
happens or prompt the user to type in
what happened so so that just sent
there's just sentiment air and the
message so that's pretty nice you can
use this it's a it's an open source free
service document j/s there's been a lot
of awesome documentation engines coming
out recently ours is based on Remy
sharps it looks like really sharps you
document it with j s stock type stuff
looks like this you can search really
basic I don't it's nice okay go to the
next so then the final two pieces that
were kind of releasing back as a bunch
of jQuery extensions and widgets we wish
it so first the on widgets there's a
milk we're releasing a bunch of widgets
but they have like everybody's release
the same type of widgets over and over
and over again so what we're going to
try to do this is a an idea a lot from
yahoo de cats and ben almond i've talked
a lot about with this is a vent oriented
architecture for widgets so the idea is
what if your widgets were like the Dom
like the Dom actually provided like a
tab widget so the idea is like you could
click on a tab you click on the tab and
then it might trigger a hide request on
another div and then you can listen to
that and then prevent default prevent
the actual hiding of it and then if you
didn't it would call show and then you
could listen to show and do any complex
functionality you want the ideas we want
to provide a very small sub reusable
subset of like an event system for your
widgets and that you can add any crazy
custom functionality on you want on
because I feel a big problem with
current widget libraries is that they're
like monolithic they have to every
feature under the Sun because there's
not a great way always to like get in
there and make changes so this is fuii
we got like this is this is all
prototype right now this isn't like
coming out anytime
next week or so but you're really
interesting one I was taking some time
to load isn't it so we got a lot of
jQuery UI ones done but the interest
rate one is menu so just by this basic
menu right here we're able to add like a
lot of different type of crazy menus so
if you scroll down a navigation so this
is just that menu but we've mixed in a
shiftable class that listens to like
open and close and a fade in and fade
out a bowl class that that listens to
open and close so it allows you to like
mix in other things that with snow
events it's a crazy brainstorming idea
but with that same menu then we created
tabs and we have like a toolbar but all
of these stuff use their like exact same
base code event system code so okay and
as you can tell we're really into event
or in architecture so we're have a bunch
of jQuery extensions we're going to put
out so these are really just a lot very
similar in functionality to a lot of the
jQuery UI ones the difference is is like
for drag and drop the source instead of
like having a plug-in do drag and drop
you just bind to the event drag and drop
and it works with live and things like
that so we had history select all these
different ones but well history is
integrated that's actually been almonds
but it's integrated in a funny way and
then Chavez going to be see provides a
bunch of other helpers so so it's oh so
the last thing I'd like to do Java sort
of EC really dependent on a lot of like
to get its fix a lot of other people's
work so these are really the dealers
that help juice up JavaScript MVC and
who's worked on these projects so we're
really excited about the three point of
release it's like a week away if you do
jquery development hopefully this
interests you thanks everybody
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>