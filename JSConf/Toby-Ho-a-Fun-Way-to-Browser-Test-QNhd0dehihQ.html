<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Toby Ho: a Fun Way to Browser Test | Coder Coacher - Coaching Coders</title><meta content="Toby Ho: a Fun Way to Browser Test - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Toby Ho: a Fun Way to Browser Test</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QNhd0dehihQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning I'm Doug I'm going to talk
about Tootie which in my opinion is a
fun way to browser test my name is Toby
ho and I want to thank my employer data
track for making it possible for me to
be here this is me i'm outside in the
parking lot taking a picture of myself
just after getting a haircut from super
walmart in preparation for coming here
to this conference to give this
presentation so now that you know my
qualifications let's begin i'm going to
show off a side project which i've been
working on since the end of last year it
is called Tootsie Tootsie is an Italian
word that means all together you may
have seen it in musical scores where it
is used as a signal to the band to play
all together Tootsie the project is a
JavaScript console that is capable of
executing JavaScript on multiple web
browsers simultaneously so the website
is to tjs calm in order to get started
first you create a room a room is just a
way in which I keep everybody separate
separate so that everybody is an
executing JavaScript on everybody else's
browsers so I'm going to go ahead and
create a room and at this point I'm
dropped into a JavaScript show where I
can execute any arbitrary JavaScript
this you're out here is associated with
the room that it is connected to so if
you want to connect another browser you
would just copy and paste the URL into
that one as well so I'm going to update
it to the room that I just created
so now that both Safari and chrome are
connected to this room any JavaScript
that you execute here will be executed
by both browsers and the results of both
will be displayed so I'm going to
connect a few more browsers now to start
start off
I have a Firefox 4 and I'm going to tack
on a cup of IE instances as well I want
IE 8 as well as I 7 so to emulate ie7 I
will go into developer tools and put it
into a e7 milk so now we can use the
browser's command to see the set of
browsers that are connected to this room
right now also i want to mention there's
just three comments that are available
in this console the help will print the
help message browsers as you just saw
and reset will reset the javascript
sandbox which basically means it
destroys the iframe that you're running
your code in and creates anyone so
everything is blown away you start a
fresh so let me let me just put all
these windows side by side here arrange
them okay and I'm going to use chrome as
the driver so in general any javascript
most for the most part you throw some
javascript at these browsers they will
give you the same at same answer but not
always so sometimes browsers just cannot
agree on what to do for some edge cases
for example let's say I were to create
an input element and set the value to a
multi-line strength if i get the value
back the browser's do not agree some
will just concatenate the lines others
will put a space in between and some
others some other older browsers
will preserve that new life so if you
ask them who they are they will give you
extremely long names differentiating
themselves from each other but then
again maybe just maybe they're not all
that different from each other so this
is just a brief demo of 2t the web-based
version but that is not all there's also
a command line version of 2t which you
can install using NPM install 2d so once
you do that you can start it by saying
2d and then giving it the room URL and
now there's to the right in your console
and here basically anything you can do
in the web version you can do here with
the exception that since this is not
actually a browser it's not responsible
for executing any JavaScript it just
sends them out so I forgot to mention
console if you if you do a console that
log then it will render it in blue
instead of green and the green the green
is the actual return value of this
statement that you just execute it and
then the blue is any council messages
that you print em so you can use exit to
accept that now also comes with that NPM
package is a JavaScript driver which you
can use to script all the browsers that
are connected to the room so i will show
you how to is this tool oh by the way
should i make it a little
maybe all right I'm going to show you
how to use it use the library so first
you require to t inside which there is a
2d constructor so you call the 2d
constructor again with the URL of the
room you want to connect to the first
thing you want to do is register our
binding to the message event this will
tell you of any messages that the
browser's are passing to you so I'm just
going to console lock this message for
now so once you do that you can start
using the eval method to send the
browser JavaScript
so I send the browser's some JavaScript
all of them executed and it sent me back
these replies some of them are the
console messages others are the replies
which give you the return value of the
statement you could also has in the
function here if you like and then that
would also just get executed in the
browser and but with the library there's
an added capability now you can load
some local you can load some local files
and have the files get executed in the
browsers as well which I'll show to you
right now
so so I have a test suite that's written
in jasmine or risk using jasmine which
jasmin have been using it for a while
and i highly recommend it it's very
full-featured and very solid so i have a
test suite and i want to run it how am I
gonna run it well I'll just write a
script using the 2d driver so this is
that script first we connect to reuse
the driver to connect to the 2t server
here I'll just update it with our URL
for the room I have a display function
that will print out any console log
messages that come back from the
browsers and right now I'm only
interested in the console log and any
errors that come out essentially the
result of the tests is going to be
locked to the council in this example
and so once i am connected first I want
to reset the sandbox to get a
predictable environment then I just load
the file the set of files that I need so
first there's Jasmine the testing
framework Jasmine console Jasmine
reporter is the reporter that i wrote to
print the test results into the console
instead of displaying it in HTML and
then there's the implementation file and
the test file and then at the end i'm
just going to use eval to kick off the
test suite at the end i'm just going to
exit out of this program but before that
I want to wait for the console message
to come in because that's what tells us
the test results so let's try running
that now
I saw it reset the sandboxes and tada so
offer so it ran the tests in our five
browsers but for completeness I'm going
to show you a felling test I'm just
going to mess up this code and run it so
that's that's what it might look like
with fouling tests now if you do TDD you
might notice that it's sometimes it's
tedious having to switch back and forth
between your editor and your console all
the time so but with no Jas is kind of
easy to write a script that or monitor
any changes in your source file and then
rerun the tests automatically so I have
a script that does that
so now this time i just have the
required scripts in an array and then i
just say for each script going to do a
watch file on it for modification and
then anytime it's modified any of them
I'll just rerun the tests pretty simple
and i'm just going to demo for you the
the workflow of doing TDD using this oh
I better update update the script to
come to the right one okay
ok the first first time around it just
it just ran on all five browsers that
there weren't any tests yet because
these are empty files so for this
exercise I'm just going to write a shim
for the array prototype dot map method
so i'm going to say describe array map
it should know
and i'm going to say expect if I map 1 2
3 2 i just multiply everything by 2 then
I should get a value equal to 2 4 6 here
I save it and it sees the changes and
automatically rerun the tests so it
passed in Safari Firefox and Chrome but
not in IE because I e doesn't support
that method so i guess i'll just have to
write the method myself so i'm going to
say if it doesn't exist and I'll just
use my own implementation
so I need a returning array and a cache
the length
at the end return and yep and so yay it
passed everything it passed it for all
the browsers that I'm interested in so
now that that's a gross simplification
of the map method obviously I could go
further and make it more correct but I'm
not going to so the point of this is
just to show you what how TDD might work
using the tootsie driver but the 2d
driver you can use it for other things
too not just testing and i'm going to
show you i'm gonna build a browser
feature comparison table using the 2d
driver so i wrote a script
update it to the room that I just
created arrow script that will it'll
first load modernizer the feature
detection library and then it will
basically loop through the moderniser
object for each of the features that it
detects and it'll built a print awesome
table headers and it'll it'll and then
it'll out the row for that browser but
it will just put an X in the rows up in
the column it'll put an X in the column
where that corresponds to the feature
that that browser supports so I don't go
line by line through this script but
i'll just show you what it does here no
so if i say like run it oh that's not
very okay i'll put it into a file let it
come
okay hopefully it's working we missed I
seven somehow but you get the idea so
it's a textual table like this so table
in ascii essentially but also happened
to have some code lying around that will
convert that ASCII table into HTML so I
run the script that does the whole thing
now
ok
ouch we lost a couple of browsers let me
see if I can get them back
sure
Oh
okay yay so yeah just by running that
script now have generated this feature
comparison table nice okay so last thing
I want to show you is you can also do
npm install to t server so in case to
tjs com goes down maybe because I'm I
can't afford to have it stay up so once
you install this you just run to t
server and it will serve to tea on port
8080 so you can access it directly
access directly on port 8080 this is
running in standalone mode which there
is only one room there are no multiple
rooms because presumably you're just
running it on your own so but you can
use this top-level URL in any of the
places that I show in the demo so this
is still early days for this project if
you play with it and you come across any
issues please report it please report
them to get up that is it for me thank
you for your attention</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>