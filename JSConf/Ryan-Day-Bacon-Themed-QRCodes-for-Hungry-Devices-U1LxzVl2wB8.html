<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Ryan Day: Bacon Themed QRCodes for Hungry Devices | Coder Coacher - Coaching Coders</title><meta content="Ryan Day: Bacon Themed QRCodes for Hungry Devices - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Ryan Day: Bacon Themed QRCodes for Hungry Devices</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/U1LxzVl2wB8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm Randy um I maintain a QR code
package for men p.m. so it's kind of
neat you can npm install QR code and
generate QR codes for your applications
stuff maybe how to make a QR code with
node what kind of error correction do
they have inside of them how to take it
way out of spec and put your own crap in
it because they're not very good looking
unless you have it night next to the
cool like jsk confe 8-bit font and then
Adam maybe sticks and bacon behind one
and then it's JavaScript so you can do
in the client side too like every day
when I'm playing out these QR codes I
get a disappointed right I bring it up
on my phone share with like barcode
scanner on Android and doesn't scan like
an iPhone user couldn't scan it right
and we're like inches apart at night mr.
greens backlit but in other situations
they work great you know other times I'm
not disappointed you know you see them
on the sides of buildings you see them
all over the place you know so you know
people seem to put them on stuff and I
think it's more of the mystery like what
is inside of that QR code you know I
mean sometimes you just want to know all
right sometimes you're like that could
be you know in fact it is a clue give
you all sorts of funny things and they
can hold about 1.2 k so you can stick I
mean they get pretty big and with the
highest level of error correction
so uh it's like I said before it looked
kind of neat if there next to this like
real blocky text but uh when you put
this on your website or you you know
print it on your advertisement you
really are sacrificing a big portion of
your real estate right there's no brand
identity there's it's just not very fun
and there's nothing to do with bacon at
all um c making a QR code with note just
npm install QR code you can have some
problems just because of dependencies on
kiro I don't know if everybody has an
up-to-date version of Cairo but if you
happen to get one in the middle node
canvas will install and seem to work
perfectly but I will be unable to
extract data from images it'll be unable
to write images to the canvas so that's
a big breaker if you're going to try and
try and put weird things on a underneath
your QR codes stuff the API pretty
simple I'm basically exporting the
functions that the canvas itself
provides ability to send a you know
today to URL save it to a file simply
draw it and return a canvas object so I
mean that's how to do it it's not that
complicated i tried to propose a
minimalistic api there's a lot more
options for configurability in a version
i'm going to push tonight maybe that'll
allow you to configure like the module
size and stuff like that provide
additional options see
um let's see so that's not really a last
slide so uh whoa um I recently
refactored this code because I was
putting the global space on the client
side with a bunch of variables because I
was kind of hacking around the fact that
I have synchronous model loading or
module loading in a node but a
synchronous module loading on the client
side on this library is fully come you
know its candidate uses the canvas it
works totally on the client side you can
just you know pipe stuff the QR code
gets more data and you know and they're
just works you can scan it you so you
can choose to render your QR codes
dynamically on the client with whatever
information they want post them back to
the server or you can generate them on
the server yourself but uh getting
creative with QR codes I mean that when
the scanner actually reads a QR code
it's a it's taking just the gray scale
of the image so like the background
could be bright yellow and it would work
just fine right it could be a very
bright color it could be like a bright
green which has the most the most
influence on our eyes and it wouldn't
influence that it wouldn't harm the data
at all in any way people could read it
from very far away it'd be very obvious
right that it was yours so see um with
canvas you can do things like you know
round edges this is terrible sorry gotta
zoom in or something um anyway okay so
uh Livy show you some cut
or not
so wow that's terrible I'm sorry White
will give you 10 C so I said like we can
mess with it in funny ways I can I made
a little web api can pass the net effect
right rounded and I can draw it and get
a canvas back I can do a bunch of
inefficient things with the canvas and
lots of weird ways and then I changed
the result right it's now like a canvas
with slightly rounded checkmarks that's
kind of neat I I wanted to make sure
that I could Brandi QR code and with
like a logo or something and have it
retain its data not compromise the
clients ability to understand it and and
bacon is a pretty good choice actually
because Browns are very dark it's
actually very difficult to desaturate
Browns I made some functions that
convert rgb2 y UV and reduce the
luminosity of the colors which is the
algorithm that's used in grayscale so to
make bacon theme QR codes I this will
scan just fine it's got a bacon heart
because i'm actually really sick of
bacon because njs comp to free jas comp
i was really excited about bacon now I'm
kind of done but it's still I still love
bacon I mean you can really just put
anything back there right as long as you
can ensure that the colors are light
enough and I provided a function with
the canvas utility that will ensure that
all pixels can be pushed below that
threshold and I made a little API and
the tests to be able to like show how to
do that
yeah yeah thank you please ask more
questions because I'm nervous and never
talk with thank you let's see um bacon
see so simply I just have this is just
my test file it's not designed to be an
API yet I mean I could expose these kind
of bacon effects as a as an API and who
knows everybody likes bacon and there's
a bacon bikini effect but i don't know
if i should show the resulting QR code
should anybody later cuz bacon bikinis
are like a actually very top so very
high google image result for bacon let's
see um so how to process the image now I
I wrote this code last night so it's not
like the best and I'm sure there's gonna
be some free variables but it works I i
set a dark and a light threshold then i
make sure that the image will fit as
best as possible you know I'll crop it
off on the longest side and so you know
an image that's a that's a wide
rectangle will get the end cut off cut
off I have a just a pixel helper I'm
provided by a canvas util library I put
on NPM just iterates over pixels you
pass it to canvas as like a generic call
back this is the raw function for
calculating luminosity which is which
after I wrote that I also pass to I've
added it to a library it's the
calculation of luminosity is based on
the seven or nine coefficients those are
used in HDTV I'm rather than the 60
whatever something are there but they're
just magic numbers that make them the
these specific magic numbers that a
a weighted average to your pixels these
are things that you can use to if you
wanted to to customize a QR code right
you can my library at its core just
provides a QR code it's it's just it's
to spec right this is how you can make
it out of spec but still readable really
a lot of this stuff i would like to
expose like just export a few kind of
trick functions that would allow you to
underlay any background I just like I've
made a bug and I couldn't I had to roll
back anyway this is my oh my development
branch of note QR code it's on github
and I will finish the tests today and
get it up so you'll be able to basically
provide any image as a background and
the code will decent will will either
darken or lighten the pixels
appropriately and then your code will
just work right so you know you have
like a node.js logo and PM logo you can
put anything right in the middle and you
know that the library is going to take
care of ensuring that I mean it's just a
simple number 1 through 100 and about 50
is the distance you need if you see like
you know 2575 anyway um and then if the
color is too light i just iterate the
pixels and then call back with the bacon
canvas so I don't know it works I guess
uh any questions
ah yes let me uh it is on my github it's
the repository node canvas util and I
should have pushed that up conversion
lip inside of conversion lip I've added
I grabbed some functions for from MJ
Jackson I don't know I don't have this
full name here I just included his is a
copyright rgb2 hsl hsl RGB RGB to HSV I
experimented with a lot of different
kinds of transforms I have one that
increases the brightness of of bright
colors which has an interesting behavior
when you're looking at like sunflowers
or something right you can have a super
like bright color and really subdued
colors underneath your QR code or I mean
under whatever right I did a lot of the
tests for that yeah it's just JavaScript
and it's just a canvas API when I see I
start that server
see so this is an actual tests for for
the different algorithms for determining
gray scale and and different
implementations anyway this column is
client-side this column is server side
and the same for the boat this is a kind
of derived from there's a fellow who
made some document documented some of
these gray scale functions but it turns
out that this is like the correct one
that's the ones the phones use to
determine grayscale that's the most
popular it's based on that HD standard
and let's see I actually implement those
transforms kind of with a plug-in
architecture for canvas util let me just
write here actually so it's let me
increase the size of that
so I mean the average is average
luminosity all grayscale limo I Lamar
and why a Brighton threshold basically
these are all filters to apply over any
canvas you can write anything to it
it'll just apply the filter blindly and
any plugin that goes into canvas you
till I mean can take advantage or extend
that pixel iterators behavior to apply
just kind of random crazy effects if
they want and it'll work on the client
side as well right in threshold
saturation threshold you know either put
you can choose instead of pushing colors
darker inside of their own range but to
actually push them towards white using
HSV or hsl and yeah um note y UV is
actually a lossy as it's a Selassie
algorithm so if you take rgb2 y UV and
back again you're going to end up with
slightly different colors it's the
reason jpg is lossy and ends used an
MPEG compression as well so so those are
why those real haci algorithms but yeah
anything else
huh Kate chilly I'm running this is my
older opensuse box i'm using Katie it's
kinda I mean it's just all the all the
que tu plugins the the Qt plugins like
spider component the files file browser
component it's all just like a plug-in
architecture all right yeah well thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>