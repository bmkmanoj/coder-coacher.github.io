<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angus Croll: Break all the rules | Coder Coacher - Coaching Coders</title><meta content="Angus Croll: Break all the rules - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angus Croll: Break all the rules</b></h2><h5 class="post__date">2012-10-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/MFtijdklZDo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi there so before I start I have a bit
of a stutter so if that makes it hard to
understand then I apologize hopefully it
won't be too bad
so I sent a tweet out a few days ago I
loved the Java scoop with the statement
so much and I got a replay from how
Yankee I think you say his name
I love the JavaScript with same so much
with sarcasm tags surround it he thought
I was being sarcastic
actually he forgot the opening tag so
maybe he was saying everything that I've
ever tweeted is like sarcastic however I
guess from this point on I can't be
sarcastic because he just like closed
the sarcasm tag on me so there we go
anyway oh and then I got this one
alright so by way of introduction how
you work at Twitter Twitter
we love javascript we love the front-end
we take the time to understand
everything understand all the parts so
that we have the widest toolkit at our
disposal we don't believe in just
restricting the language to the so
called safe parts or you know the bits
you should be able and I think we get a
lot of strength from that and we do
everything in strict mode just in case
you thought we were not very careful or
something like that so why am i making
this tool why did I write it there were
two motivations for this talk the first
one is kind of represent of this quote
by Douglas Douglas Crockford he says the
subset he carved out is vastly superior
to the
language as a whole now much as I love
the good parts I think it's a great book
and I think every JavaScript developer
should heed it I think the other parts
are really great as well the parts he
leaves out if you take the time to
understand them they are great and
they're really useful and they add a lot
to the language and it saddens me that
not enough people are actually looking
into them so that was one of the
motivations the other one is this I see
this all the time and it drives me crazy
it's like Stack Overflow you you're
reading a fairly interesting thread and
inevitably someone comes along and says
that and it's like you're not telling me
you're not explaining it you're not
saying why I shouldn't use it you just
telling me not to use it like why are
you telling me this because someone told
you you know we can't be good developers
unless we take the time to understand it
and we should not preach things to other
people that we can't explain or we're
not willing to convince others of that's
very important to me so why do we have
well that's the theory whose rules are
we actually following here and I think
right and rules apply to everything not
just a software they apply to life
they even apply to soup hears right as
it applies to soup so let me ask you
something
what is it an authentic minestrone soup
does anyone know well I tell you what we
can do research
Google Images will have the answer let's
key an authentic minestrone soup and see
what we get
oh shit turns out there is no such thing
there is no all authentic minestrone
soup it's whatever you want it to be and
actually the technical answer is it's a
regional soup and different parts of
Italy make the soup in a different way
but the point is we can't tell other
people how to make ministry only soup
and I guess that was meant to come next
and the bigger point is correctness is
sub is subjective there is no one
correctness that we all share
we cannot listen to one personal story
of what correctness is and apply it to
our to our development each of us is
unique and individual each of us we all
have our own opinion on what we consider
harmful these are all actual be copied
pasted from actual articles and you can
see everything in JavaScript has ever
done has been considered harmful by
someone like if consider how primitive
types arguments JavaScript is so
powerful
and so you know oh and look there we are
and just to really focus in the work
somebody actually read now it's got eval
considered useful so clearly harmful is
subjective - otherwise we wouldn't be
writing any code at all I really like
this quote from Swiss Swiss author
Jemaine - steel I think I'm saying that
right rules are only barriers to prevent
children from falling we should should
keep that in mind that's really
important so when you start out when you
learn a language you know rules are
really important they stop you falling
off the edge stop you're doing something
really stupid but you know we're not
children anymore right
we're adults we jump we like most of us
in this room probably consider ourselves
fairly good JavaScript developers we'd
want to code the way an adult codes and
we once we understand the rules we
should be able to break them find out
the exceptions find out when the rules
don't apply to what we're actually
trying to do it's just almost here
anybody else Thomas I apologize for this
singapore everything runs smoothly
everything's clean everything's nice but
there's a bit of a cost for that
it's the expense of personal freedom not
everyone has the liberty to do
everything they want to do and I think
Java was Singapore actually I actually I
didn't come up with this I stole this
from Andrew DuPont who said it had a
great J's can talk so ask yourself how
Singapore do you want javascript to be
that's pretty important this is a great
quote I really love this quote this is
video now this is from 11 years ago I
think it's still Wikipedia policy and
it's one of their great strengths they
have guidelines they have rules but
they're very quick to point out if it
holds you back if it prevents you
creating the site the page you want to
create then ignore it again I think we
should be adult enough to do the same
thing okay so we talked about breaking
rules how to break them let's start with
my own favor the with statement so to be
sure there's a lot to be careful about
when using the with statement you
shouldn't just use it
in just criminally here are a few
reasons not to use it
accidental clobbering an implicit global
creation is very easy to do here's an
example looks pretty cool on the face of
it okay we have an object literal we're
using a width to make another object
literal like statement two so there we
go to update the dragger that we just
created you wouldn't really get these
two lines next to each other but one of
them on the same side but look I
accidentally missed named increment as
as interval an easy mistake to make
and all hell broke loose I've now
created a global called interval it's
pretty easy to do should be careful
about them oh the obligatory ironic
footnote is with es5 strict mode they
protects against implicit global
equations so the biggest egregious fault
with the with statement would have
actually gone away with es5
unfortunately yes five dozen support the
statement it's kind of sad to be fair
the compiler cost might have been
prohibitive because trying to figure out
with a with statement whether Global's
were being clobbered a lot of browser
vendors would have complained that was
actually prohibitively expensive so that
might be the real reason there isn't a
with statement in es5 mode okay carrying
on with reasons not to use the with
statement it costs of scope closure
scope resolution so with adds an extra
scope so as you're going up the closure
chain looking for the trying to resolve
there's an extra that's an extra step to
go up in practice I think the way modern
browsers work it's an exaggerated
concern I don't think it's those
browsers down that much and the cost of
lake compilation we need to resolve the
affective property access and
assignments we can't do that at one time
so it's no extra compiles compile step
again not sure how much that costs
maybe sometimes
is significant cost turning to the
positive why is it useful well you
probably know it powers your developer
tools that's if you use Chrome or Safari
or Firebug here's an example taken from
Chrome source code a chrome developer
tools source code and actually this is
very slightly old they've changes but it
was this particular excerpt was a very
good illustration of what happens so you
may know that the kick console has this
command line API which makes available
extra functions such as the inspect
function things things things like that
which you can just use on the console
they're all within this object window
dot inspector command line API but what
if you wanted in the console to override
those functions we wanted with the user
of the console should be able to clobber
those functions this is a very neat and
incidentally very safe way to do that
you have a with windows statement nested
inside a with window inspector command
line so absolute priority will be given
to the global object and so if you
redefine it inspect it'll get to that
one first then it'll get to the
inspector command line API why is it
safe nothing could ever slip through the
global object because you're actually
including it there another reason it's
useful a lot of people like block scope
so es6 is going to be introducing
support for block scope with statement
is a pretty neat and fairly safe way to
replicate block scope let me show you by
illustration so you've all seen this one
right this is like a cautionary tale of
how closures don't always work so
because there's only one scope here the
variable I is being shared through each
iteration which means the
statement ends up pointing to know that
banks every single alert alerts knows
length length at the end the traditional
way to solve that is with a function
closure right you've all seen this I'm
sure so now we're introducing a scope
inside a scope so I is unique each eye
is unique within the function scope
there we go it has then everything works
great it's a little bit clunky it's not
very intuitive and people coming from
other languages don't really think it's
a bit over the top to do this so you
could have a with statement and here's
the key another key to using within a
safe way is don't as available where
available we don't know what's in there
person explicit hash so you know what's
there plus I as a hash then you can only
own it so there's no danger of a same of
a sane person trying to set anything
else in this with loop other than I
because it's clear that's all that's
actually there so nothing will be
accidentally clobbered and it's kind of
like wait I think compared to the
function thing and actually to be honest
it's slightly slower but so it depends
if performances are concerned to you but
I think it's a very neat illustration
and oh by the way there was a let
statement coming in es6 but like we know
that's not going to be there on all
browsers for quite a long time so this
is a kind of standby I guess the eval
statement everyone's other favorite
thing you should never do why shouldn't
you do it well we all know about code
ejection loophole if a user gets or if
some party gets their hands on the
argument the eval argument they can
invoke any code they want to also
prevents closure optimization because a
lot of modern browsers all modern
browsers I think
that they they will only persist those
variables on the outer scope that have
to be persisted so they'll look what's
reference in the end the innocent the
inner scope with a value don't really
know what you're going to be referencing
there so it inhibits optimization I'm
not sure with chrome and the latest
Firefox how much of a problem that is
but anyway that's something you don't
get if you have an eval statement and
again as with the with statement the
cost of lake compilation so you have to
compile at one time basically why is it
useful most obvious one is when there's
no JSON path so like ie7 for example
there's no ability to have a native JSON
pass in the browser these are a couple
of accepted answers from Stack Overflow
basically saying the same thing so the
effect that you should never use avowal
it's really unsafe used JSON or gets
much much safer okay
let's have a look at json dot org well
if your browser didn't actually support
the about JSON pass it uses eval so
this is why you should watch Stack
Overflow because often accepted answers
are just completely wrong why else is it
useful it's how your console works the
same as the with statements so you can
try this now go to it's been been or to
any WebKit console run this code
anything that you evaluate the eval
segment is what actually caused it this
is this is just saying what is the color
of the function the eval same because
they use the eval statement for
everything it's used every time you run
something here's a quote I really like
from John Woo I think of a query time
it's like the sensible antidote to the
Crockford ism it's like basically he
says he's island where the trivialized
misuse and outright condemned by most
JavaScript programmers but when used
appropriately they allow for the
creation of some fantastic pieces of
code that wouldn't be possible otherwise
I think that's really cool and I wish
more people would pay attention to this
kind of thing this is the the cousin of
the avowal statement slightly nicer
cousin in most people's view although
I've heard it said it's only nicer
because it isn't an eval statement
therefore you can say you're not using
eval but you actually yeah that's not
really true
it's not just an avowal in disguise it's
much more besides that in particular it
always evaluates code in the child of
the global scope so it creates a brand
new scope every time to execute in which
is one down from the global global scope
which means it only has closure
reference to the global scope and to
nothing else and we'll see in a second
why that's a good thing or can be a good
thing in the right context this look a
couple of cases ways you saw actually
talking about what I just said
you know you're evaluated code will
always run in the same scope or not the
same scope but an equivalent scope every
time now it's pretty bad anyway if the
party gets hold of your a valid argument
but at least with function you function
only the Global's are exposed they can't
get deep down into the local code
because they'll never be available in
the in the scope chain and finally
there's no closure optimization concerns
because the only variables that in the
scope chain are the global variables
which are there the whole time persists
they're always persisted so there's no
issues there it's used in J Curry's past
past Jason which is a kind of variation
on Jason orgs version it uses the eval
it substitutes the eval for function
constructor as we can see here otherwise
it's pretty much the same and this is
again presumably to restrict access to
local variables and because at least in
theory less scope chaining means
performance where else is it used
underscore.js has a pretty pretty nifty
string interpolation method and it uses
our favorite with statement first what
this interpretation lets you do is you
can optionally give a context in which
you want the string to be interpolated
it to be evaluated in if you don't give
a context it'll just create an object
hash here so like the run it in the
given context or just create an object
hash in the latter case with an object
hash it will then use it in the new
function constructor so the default hash
doesn't run in your local scope it runs
in the new function scope which makes a
lot of sense because since you clear the
stage you don't care what scope it runs
in okay I'm going to run it in
quickest and safest possible go so I
think that's I think that's cool and
that's a good example of where with and
the new function the function
constructor work quite nicely running a
bit short on time so I'm going to speed
up a bit now equals equals how many
people use it okay that's pretty good
not as good as I hoped but pretty good
way not meant to use it
coerces operands to the same type so if
you have a string and an end number
it'll it'll curse then what other way oh
that's it actually
that's the only reason so why is it
useful oh because it coerces operands at
the same time like sometimes you really
don't care if the user was input a
string or and number if it's quote - or
- or - you don't care does it is it
gonna evaluate - - it's it's useful if
you are doing that you should put a
comment no to let people know that's why
you're using equals equals because
otherwise it might confuse them and then
there's this thing undefined is equal to
know which is pretty handy because
JavaScript has to know things it has
null and undefined and some people do FX
triple equals null or X triple equals
undefined but that's a mouthful and is
logically identify it logically
identical to X equals equal so now and
you see a lot of libraries like jQuery
use the x equals equals no you know and
they use that the whole time just makes
a lot more sense it does exactly the
same thing and also if it's obvious why
the hell are you using triple equal like
type of is always a string type of
result of type of can never be anything
other than a string so type of something
equals equals function well like yeah
you know might as well do too
to an equals equals similar length and
indexable all plays a number and I
actually I mean this is a matter of
style but I actually prefer equals
equals in the sense because it's more
declarative I'm being very transparent
and saying to the read of my code I
actually know these are the same things
that's why I'm using using an equals
equals comparator or writer if I put
triple equals it suggests I don't
actually know it's the same type
personal preference
that's how I like to do it oh and in his
number two in our obligatory ironic
footnote series a lot of the people who
avoid equals equals with impunity they
use if something the whole time
well that's coercion too so it's like
why is one type of coercion okay and the
other time not and it's not even the
same coercion
so either they've understood the if
coercion but not the equals equals one
not sure why you would want to take the
time to understand one and not the other
or they don't understand any of coercion
but because Crockford said it's okay
they're just basically going ahead and
using it and here's an example of why
they're two coercion types are not the
same so you know if potato evaluates the
true but actually potato is not equal
equals true so there we go
array constructor so right you're not
supposed to create arrays this is not
how he's supposed to write but what
about this this is this is the most
beautiful thing and you need the array
constructor to do this you probably seen
this this is from prototype J s and it's
a way to repeat a string X number of
times and it basically creates an empty
array of x plus 1 x and uses as your
glue as the glue the string that you
that you provided to it I think it's
ultra cool and it makes me really sad
that some people will never use this or
we never want to see this in their code
because they filed a rule that somebody
once said and they never really took the
time to understand it so there we go
Oh wrong direction
so people that both these rules also
like to break these rules and I'm
running out of times way too many rules
so I'm going to be really really quick
but I just want to make it clear these
aren't the only rules so again Andrew
DuPont two years ago J's conf gave the
best talk about extending extending
Native prototypes just to quickly say
sometimes it's sensible I think es5
shims are one case worth sensitive
sensible has earned poverty on for in
well you know if you create at the house
your self and you didn't instant extend
it and you didn't extend object
prototype there's no way you could be
bringing anything else into your to your
to your iteration and I bet you nine
times out of ten when you do a foreign
iteration that is exactly the case the
other thing is what's so bad about photo
types
sometimes we want the prototype I've
I've done four in loops where I want
prototype objects to leak into my
foreign it for in iteration two so it's
all a question of what you actually want
in the iteration put all of our
statements at the top well good advice
most the time but in for loops it's
frankly unintuitive because you're
looking for where it was defined uh but
there's no reason to ever define it up
at the top in a for loop don't declare a
function after you use it this is
basically the hoisting thing like
function declarations to function
hoisting I start let's find it really
useful to hide the implementation
details further down the page where the
person looking at my code might not care
what the implementation is but they like
see where is it
use how's the function and I find that
actually pretty good comma operator as
chairs so I basically both the essay on
this one I could give you a hundred
reasons to use it but I'll just give you
one if you want to use multiple
expressions where the syntax the only
expects a single one like second or
third arguments of a whole loop really
good examples of that and the one I hate
is always pass
10 to pass in I mean unless you're
starting with zero or NX there's no
reason to have to pass 10 to a person so
in some way it's okay to break a rule if
you understand why the rule exists in
the first place
you can mitigate or safely ignore in
other words the concerns don't apply to
what you're trying to use it for and
maybe most importantly it adds something
like there's a reason to break the rule
and here I might mention semicolons I
think semicolons contrary to what you
might read they're pretty easy to
understand why and why and how automatic
semicolon insertion works I'm fine with
people not using them I personally don't
leave them out because it doesn't add
anything either it's very easy to put a
semicolon in this case sticking to the
convention doesn't really cost me any
anything leaving out is not really gonna
add anything to the code so there we go
this is a quote from an author I don't
know anything about the author but I
really like the quote and I think it
really sums up pretty nicely what I'm
trying to say which is become an expert
at the rules then break them with
creativity and style and like the TLDR
take away from this if you didn't listen
to anything else just listen to this is
pretty good and if you can't be good be
careful
so we're only a little bit over time
there is ten minutes till next break or
do we have maybe I would think this is
such a great opportunity to have this
guy speaking to answer questions and I
know there's something there I mean
personally I would have questions that
I'd want to ask him about stuff like
this but do we have questions if you
want to leave not rude at all go out and
you can you know have a beverage but if
we have questions maybe entertain one or
two while we have them here is that cool
I see one in the back great talk I agree
with you on a lot of this I think most
of these rules exists for teams where
the team is fairly large and not
everybody's a JavaScript programmer
don't you think that as well yes I was
gonna add a slide about that I did
actually have a slide about that and I
took it out
I think teamwork is a good idea to have
some conventions that the whole team
should follow and I guess all I'm saying
is yeah sure have those conventions but
decide amongst yourselves what those
conventions should be don't listen to
what other people say understand the
rules as a team understand how you want
to employ them anyone else all right
cool thank you so much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>