<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Brian Mitchell: JavaScript's Twin | Coder Coacher - Coaching Coders</title><meta content="Brian Mitchell: JavaScript's Twin - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Brian Mitchell: JavaScript's Twin</b></h2><h5 class="post__date">2013-01-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IuVLm4Jcwds" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">ah
I did not have time to do slides I was
going to do it on the bus right here and
I had some other stuff to prepare so
last minute we are just going to do a
short run through and discussion
anything you guys want to ask once I
sort of give a short intro here um part
of the reason I'm giving this talk on
track be is javascript is such an
amazing language that is so tempting to
use it for everything now that's great
when when you need it but we should also
always consider languages that really
fit the the problem best not not even
just good but really really well it's
always good to have that extra edge so
one reason i chose lua is because it's
almost so close to javascript you would
say that we might as well use javascript
but i wanted to show a few reasons why
why that might not be the case i'm the
first one and in kind of the provocative
point i was going to show in a demo are
some benchmarks versus v8 so if you look
at this graph it's a little cryptic but
if we scroll down here a little bit we
can see you can see some numbers here pi
digits is a is a benchmark that
generates a generates on some numbers so
pi numbers aren't generally useful in
real code but we can see that lua is
literally 87 times faster not just four
or five this is the sort of difference
that we tend to see in like see versus
something else notnot lua WebGL is great
for owned by mr. this is v8 vs Lua jutt
um so also the memory usage and other
things patterns are very impressive now
if we if we look at some of these other
ones we see that here at the top there
are a few cases where VA is faster I
think it's mostly the tune chip-based
regular expression engine they use which
is really really fast I don't think Lua
does any jit compile a scene for regular
expressions at this point but it's it's
a very compelling that you can get
something so performant in a language
that's so dynamic literally to the point
where let me adjust this comparison
let's say check against the java 6
server this is inge it very very very
close I mean I'm pi digits it's actually
faster and then on some of these it's
only just a couple times off and plus or
minus on some of these benchmarks might
as well be the same and keep in mind
look at the memories that's amazing it's
still very very lightweight to
accomplish this is really really
impressive so luige it's an amazing
piece of piece of code that this guy
Mike Paul put together and I definitely
think it's it's promising for javascript
in the future but right now if something
like embed ability and speed are both
really important you should possibly
consider this also for the education of
how you write your java program and in
JavaScript programs the the best way to
really get a hold of that better is to
actually use other languages to actually
extend the way you understand JavaScript
itself so unfortunately let's see if I
can find some examples in the original
book they have a second edition of this
book programming in Lua which is great
but it's not available for free online
but the first edition is so let me see
if I can find the link here we are
so LeWitt generally looks very much like
javascript you'll see a couple
differences I guess I have to click on
one of these sections let me go over the
sum of these short sections without
clicking on them you generally have nil
which is like null you have bullion's
numbers numbers are the same you know
single class concept in in JavaScript
strings are very very similar tables are
probably the first interesting thing
that will vary on tables in Lua are used
for both array types and hash types
tables are very very well optimized in
Lua which allows you to basically get
array like performance when you're using
it like an array and then you can get a
hash table like system when you actually
use some other key like ax and you can
also do the access just like JavaScript
a dot X does the same thing a got show
with lua though indexing starts at one
not zero I'm not going to go into that
just be aware it's it's a subject of
much controversy so if we if we go
through this a lot of this will probably
read pretty easily it's got a slightly
nicer to read for loop style here I much
prefer this over the we borrowed it from
Java concept in JavaScript with the four
and increment in the compare this tends
to be a lot easier to optimize as well
possibly one reason Lua gets a lot of
performance let's let's go to another
section we've got functions which are
obviously important if it loads okay
where's some code just need some code
okay we're going back to the table of
contents part one the language where am
I going okay so let's yeah here we go so
functions obviously wrap things up just
the way it does in JavaScript although
instead of curly brackets we we use end
let me get that higher for you guys so
generally you still have the explicit
return you have to declare your local
variables which is still a pain in the
ass it should be automatic i think in
modern languages but like javascript is
quite old so local some is just like VAR
some notice we don't have any trailing
semicolons they're all optional in lua
there are fewer problems with the
grammar when you leave them off so it's
perfectly fine to not add them in in
this case we have another form of the
for loop this is a 4 in this allows us
to get integer pairs so the actual index
and the value and then here we pass in
the actual array that we want to some so
basically we're summing this up and
returning the value of all the integer
elements in this array so very very
similar in that sense now if we go to
some of the more advanced stuff besides
syntax we start getting into some more
interesting things that we don't find in
JavaScript and this is where possibly
you can start thinking about how how you
can change the way you use or even
generate JavaScript to do other things
co routines are amazingly great tools
for certain things have you ever wanted
in your asynchronous Ajax code to write
ok send this back and assign it to a
variable I don't want to call back i
just want to assign it to a variable and
then maybe i want to do something with
that variable and send it off somewhere
else well co routines let you do that
what it basically ends up being like let
me see if i can get a good example of
pardon the web okay so here we have a
producer and consumer so you can see
that one's just looping it's not
yielding there's no call back here it's
literally saying send and receive if you
if you look at both parts we have send
and receive here so these are basically
the callback points between the two co
routines now this send and receive is
just abstract code internally you
actually have to use Co routine resume
and then coaching create now send right
here is basically a synonym for Co
routine yield so we have these two co
routines that are bouncing back and
forth kind of like parallel stacks that
allow us to pass values back and forth
so what you could have in a system that
wanted asynchronous Ajax requests in
JavaScript with the same sort of thing
is you would have to emulate co routines
with a compiler and then and then allow
the the code to to basically yield to
the Ajax calling engine then when it's
done it would actually resume with the
value in the result rather than calling
a call back so resuming versus a call
back now co routines aren't free they do
have a little overhead they are possible
unlike a lot of rumors to implement
efficiently so it's not impossible to
get these pretty lightweight but they're
still going to be a little heavier than
say the overhead of a call back you're
looking at probably four to eight k / co
routine possibly up to one megabyte if
you're using native see stacks to
implement them so there there's
something you need to use carefully but
still very powerful likewise you can
create very very easy to use iterators
one thing that's very popular is to
build a simple loop to generate values
and then externally treat it as an
external iterator and just call next
next next when you need the value so
you're pulling and this this is very
popular with generators in JavaScript I
mean
python and then also something we see in
Ruby 19 and of course it's kind of like
a cooperative multithreading so I'll
skip that otherwise it's got a lot of
meta meta programming capability and
this is probably the next and final well
I'll go over one other thing the meta
programming capability in lieu is great
like people asked Douglas Crockford when
are we getting something like method
missing and Ruby Dee and JavaScript and
we do have defined property now but it
doesn't allow us the the capability to
catch arbitrary keys for any object so
with with meta tables and meta methods
in Lua it allows us to basically set in
a meta table for any other table a table
is kind of like your object I'll explain
that in a minute and you can define ways
that property access property generation
property setting all of that works
through through these meta methods so
table access meta methods we can look at
this oh great it's not going to show me
code again let's see so you can see
those get and set meta table so s1 is
basically our pseudo object and this is
how we control the the meta tables on
objects we have things like to string
which helps control how things are
coerced to strings when we want to print
them out and such we've also got index
and new index these control generation
or mist property accesses which is
really useful it allows you to basically
do method missing and do it very
flexibly so I'm not going to go too much
further into that again trying to keep
this somewhat short the next area that's
sort of interesting is how Lua does oo
programming it's very similar to
javascript in a way it's more prototype
based so we have these tables that are
just bags of properties now the cool
thing about these tables is
the keys can be anything more than just
strings so we can we can basically
create any sort of mapping between 11
set of access ER and another allows a
very rich way to create something that
looks like an object and then you can
give it better behavior by adding stuff
via the meta tables or basically
creating inheritance via the meta table
features so you can basically say look
things up in this object when you can't
find it here since this is totally user
programmable though people have come up
with all kinds of ways to program Lua on
there are many many ways to do the meta
table set up so people have emulated
class style inheritance systems they've
emulated purely prototype and different
differential inheritance based systems
as well as something more like self if
you're familiar so the the syntax that
that you should be aware of in this case
is this colon right here is is somewhat
like passing self as a implicit argument
to the function itself right here on if
we called it without and just did dot it
would expect that first argument to be
self so as we see we don't have to
declare and it's available here self
just if you guys are wondering is like
this in JavaScript so we can see we're
setting up an account here and basically
setting up the meda table kind of like a
constructor usually you wouldn't have to
implement new unless it's you know a
base class of your own system and then
account dot deposit you can see how a is
actually our account instance and
otherwise if we did colon a colon
deposit it would actually call the meta
table so that's that's the quick intro
the rough information here do you guys
have anything you want me to explore or
questions
yes Lou is actually probably one of the
easiest easiest languages to to work
with as far as she goes so it's not only
easy to write actual see extensions and
then embed it in other see environments
but there is a huge amount of community
out there that has contributed a lot of
libraries one of the things you'll
notice let me show you how to scroll
down here a little bit is the standard
library is actually very short and small
so we have basically you know a little
bit of math some table stuff string
stuff a few IO things and some OS things
so you can start and stop and exit your
process the reason it's so minimal is it
initially it was more so for embedding
in other programs that have their own
sort of domain to work with and here we
see that we need a lot more to do say
foreign function interface stuff so
people have provided those and you can
basically require them in dynamically at
runtime and that's been a very big
benefit to the Lua community but
unfortunately batteries are still not
included so you do have to go search
those out and install them how is
debugging when you embed it into web
pages insist oh it's it's not available
in web browsers web browsers haven't
implemented it people have worked on
some early Lua to JavaScript compilers
unfortunately since Lou is a little more
dynamic it's a little hard to do a very
literal translation to JavaScript so
it's it's more so of a serious vm plus
whatever compiler you you're using
yeah so the meta table allows you to
take these objects and basically
intercept anything happening with them
in JavaScript obviously we don't have
catch all's so that's that's a big
problem wrong man proxy also a thing
that I run into very very quickly all
the time in my JavaScript code is when I
want to key an object off of something
other than a stream you have to generate
symbols to act in that place for you Lua
is nice enough to just allow you to use
anything you can put in a variable as a
key so that's that's actually quite nice
in Lua but again more emulation in those
sorts of areas um Lua is primarily an
alternative to server side JavaScript
it's the old run for instance in a
browser right right well Lulu is
actually oh yeah okay so as an
alternative to server side JavaScript is
actually quite a good point they do have
bindings to lib eV and stuff so there
are things that are still immature but
starting to become comparable to node in
Lua so that's actually very very
interesting but the the big thing about
Lua is it's it's easy to embed in any
projects that you might be developing so
if you have a piece of software that's
even you know say a ruby based web
application you want to run something
other than Ruby in that you can easily
embed lua in Ruby or Python or a Java
program via a lot of different
facilities on the client side if you do
anything with with thicker applications
not just pure web it's definitely a good
option and then on mobile platforms
we're starting to see a lot of platforms
actually install it in the core android
for example includes a lua interpreter
to help developers quickly prototype
things
on method missing is that implemented by
adding something like a method missing
key no an existing object it's it's
through the meta table so that under
under index and complete the namespace
right right so it definitely doesn't
actually touch the namespace and there's
no like special star attribute or
something like that I think the approach
is actually very very intelligently done
anything else thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>