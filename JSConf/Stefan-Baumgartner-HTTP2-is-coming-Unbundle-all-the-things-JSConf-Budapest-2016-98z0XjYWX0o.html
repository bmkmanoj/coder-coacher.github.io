<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Stefan Baumgartner: HTTP/2 is coming! Unbundle all the things?!? - JSConf Budapest 2016 | Coder Coacher - Coaching Coders</title><meta content="Stefan Baumgartner: HTTP/2 is coming! Unbundle all the things?!? - JSConf Budapest 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Stefan Baumgartner: HTTP/2 is coming! Unbundle all the things?!? - JSConf Budapest 2016</b></h2><h5 class="post__date">2016-06-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/98z0XjYWX0o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this this is so huge being introduced by
check our table that's like one that's
my most favorite moment in my life I
guess I I tried to make some some video
of how I feel right now and that's
everything I can come up with do we have
sound yea ringing Tony aquarium club and
yeah
well credit where credit's due that joke
was made by two beers bottle of just
four days ago and he took one of my
jokes so I took one of his jokes and I
thought it might be a good idea yeah so
um yeah well that's how I feel um
anybody who had a crush on Princess Leia
back then sorry that I ruined it for you
but yeah I'm talking about performance
here and I have been introduced by a
performance God so actually how I really
feel how I think this might turn out is
more something like like this yeah
basically I'm having my Tim berners-lee
moment right now which is kind of weird
because I actually I did nothing you
know I met so many people here who did
so much great stuff on Wednesday who has
been here on Wednesday yeah I made tuna
since new kids I wouldn't say he's a
childhood hero of mine but a mid 20 of
mine and yeah yeah you know walking
around meeting so many great people and
telling everybody he fan of your work
the only thing that I did that got kind
of popular or and recognized was this
one choked back then about one and a
half year ago what's power package
manager insta late with NPM % piano
package manager instil it with bluebirds
brew I'm sure you can insulate to that
something like that and i think the
choke was much much better back then and
it's better than jokes about how a
really good service has no padding
modules but hey i'm here to talk about
HTTP to and how to unbundle all the
things and when I wrote this proposal it
was called HTTP two is coming actually
HTTP ub2 is here and the question is
unbundle all the things this
professional drawing of edits dog was
done by my colleague the other one was
done by me so in case you wonder what's
going on there
it's the main javascript file going to
be beheaded because we are going to
unbundle all the things but you know
this is every time you hear about HTTP
to you hear this one advice or this one
rule unbundle all the things no
concatenation number bundling no mob
packing a logical I don't know browser
if I webpack all get obsolete I don't
know and I don't like jumping to
conclusions like that they always want
to know why we are doing something like
that I want to know why these things
happen this is like the one time back in
the early 90s at my place it was a
lovely lonely which village with about
700 people living in there and to God
the pizza joint this was the first time
those people ate pizza at all and every
slice of pizza was was served with
ketchup and mayonnaise and so we thought
yep this is how you eat pizza with
ketchup mayonnaise not knowing that this
was a sacrilege so I I when I when I got
first time outside of my religion had
real pizza I tried to question why did
we get ketchup and mayonnaise I'll turns
out the pizza so bad you couldn't eat it
without it but you know that was just
kind of this rule you you heard you saw
everybody in my village packed and
eating pizza with ketchup mayonnaise you
idiot you did it and I wonder if that's
the same case with HTTP to and not
bundling stuff so I want to I want to
question why I want to know that the
wisent why we are doing stuff and to do
so we have to go back yelled to the 90s
to my pizza joint adventure to tim
berners-lee you've seen him already and
this is tim berners-lee accessing the
web page from his his office pc this is
the first web server being a turn so
that was in the basement office office
building and this was the World Wide Web
the World Wide Web kinda small world but
what Tim berners-lee did he invented two
things one thing was the hypertext
markup language the other thing was the
hypertext Transfer Protocol
anybody remembers them must must must be
a thing of the 90s and the hypertext
Transfer Protocol was made to transfer
stuff like this so it was a protocol to
transfer text documents from the
basement of CERN up to the first floor
where Tim berners-lee was and from back
then in terms of protocol nothing much
has changed we are still working with
kind of the same protocol item a few of
you edge cases here and there but other
than that we're working with them HTTP
builds up on TCP you've heard that
yesterday at the ants talk TCB has some
sort of freeway connection that's like a
secret gang sign with your drug dealer
or something I guess if you if you add
TLS to it it's like making sure nobody's
a cup and they have this this is a round
trip this goes to the Internet and back
again so before data can be sent what
browsers and servers do is like
communicating and making sure we are
knowing each other and the first version
of the protocol could just handle one
request just work with one tcp
connection one HTTP request and
everything else had to wait in line head
of line blocking that's cold where you
can download the index.html file when
index HTML file is back to the next
resource like an image or something like
that and back in the day that was okay
but assume people found out okay maybe
we need something more and the reworked
a little bit the protocol for HTTP 1.1
and you know what's better than having
one request having two requests that was
actually in the proposals or you can do
two parallel because browsers actually
went to six so you can 26 parallel
requests pertinent domain I wonder why
didn't ever get up to 11 it's beyond me
but still for each request for each HTTP
recreate TTP request they are doing you
had a new TCP connection so it was like
the server opened up this freebie
handshake the secret gang sign every
time a new resource was requested
and this led to this one advice back
when we did the performance optimization
the best request is a request not being
made and memorize this this is coming up
lots of time during my presentation up
now the best request is a request not
being made which meant that we should
avoid self triggering stuff the triggers
requests like having a source having a
URL in your style sheets having link
href and downloading a strategy you
should do as few as possible of them
back into HTTP 11 days and to achieve
this we relied on things like
concatenation like combining one every
tribal script file into one combining
every CSS file into one just having one
javascript file downloaded having one
CSS file downloaded your third of image
sprites already this morning with nico
that's basically just all the image in
one for all the images in one file all
the icons in one file and you cut out
all the little bits and pieces and
display them and of course in learning
stuff like not making the grass at all
pack everything into the HTML and
download it and those were early
performance optimizations and they were
necessary because the web for evolving
right now this is a screen hood from
yesterday from HTTP archive the average
web page is about 2.3 megabyte in total
which is insane and two-thirds of it are
images and also on average we have about
40 TCP connections right now that are
happening per page that might not be big
thing if you if you if you think about
it but let's say 44 no actually it's
pretty big but let's say you have an
image heavy website like the most
popular search engine in the world
starts with ug anybody knows it yeah
giffey these are lots and lots of images
and if you if you open this web page on
the mobile device where you have added
latency not only getting this this TCP
request the TCP connection going on but
also having to connect to a tower
sending your signal into space and back
again and passing Starship Enterprise
that is really something and let me
visualize that for you
that means that you open up to
connections and they're pretty good at
getting forward like Jesus is a bit a
little bit a little bit faster than
chairs but chairs holding up and then
you start with downloading all the
images that was it with your website you
have to wait like indefinitely and this
is why HTTP two was made a TDP was made
to serve today's web and instead of
opening a TCP request me almost for
every HTTP request like opening it a
separate TCP connection they just rely
on one connection and he CP is really
good at handling a lots of stuff if you
ever downloaded a video or any other
file from someplace that's really huge
to see that downloading this one file is
actually really really fast but if you
do multiple files it gets kind of here
and HTTP two works in streams where you
have one stream to send requests and one
stream to get all the responses and you
can start sending a get request for one
image and no matter at which time you
can go for the second one and then the
server starts answering in small
packages that can be assembled on the
client so you have year image 1 and
image to inter whined and interleaved
and everything comes back to the client
in this assembled there so this means
that for a website that was done with
HTTP 1.1 thought when those grey blocks
to say areas are those TCP connections
is getting everything going which HTTP
to you're going to to reduce those TCP
connection because everything is served
by this one tcp connection so you start
a lot lot faster by with downloading
yourself and actually since HTTP two
doesn't have a limit on parallel
connections they also start a lot lot
earlier and that's how this this speed
up comes to be there's a nice video from
from browser where they're going to
combine to a compared to the design web
page one time on HTTP 11 one time on
HTTP two and on the left side it'll lock
all of tiny little images getting
getting across the wire and you can
really see how fast it's going to be so
this was the last time I tried it i'm
doing now another one
and this was HTTP on the run pretty fast
actually he couldn't even see it just in
a blink of an eye so that's really
really fast I tried it with some
webpages for instance my blog and on
HTTP one thought one I had about 22 that
six seconds load time that was already a
performance optimal nated blog but HTTP
two I had another 800 milliseconds less
and it's even better on mobile because
you don't have to connect to to space
anymore or to the next hour on mobile
you can really see a speed-up of it's
about it took about half as long to
download this stuff so it's all about
fighting this latency not making any
more connections than uni because TCP is
capable of handling all of that in turn
this also means that if you have a slow
website on HTTP 11 you will still have a
slow website at HTTP to it's just
downloading faster but if you don't
follow or if you don't don't respect the
usual performance guidelines you still
will have a slow htb to web page
performance guideline like minifying
chairs and CSS optimizing those images
everything basically everything that
nikka settle this morning and the most
important thing is do not block
rendering so get the thing that renders
your page out the very rare avast and
then just download all the other stuff
and this is top notch thought leadership
here with that given H db2 is not only
here for performance optimization but
it's an engineering opportunity and this
is the part where where this whole thing
of unbundle all the things comes into
place let me elaborate so the best
request is a request not being made you
heard that already this means that you
don't have to download at this dis dis
advisor it said why still holds up
somehow not by just combining everything
into one because this is basically a for
travel script files I wouldn't get any
speed up if I would combine them because
this concatenation is basically done in
the stream of the TCP connection and
just pull onto my side
but what I can do now instead of having
one huge file and transferring it over
the wire I can select the palace that
amount to transfer so let's say this
index dot HTML file doesn't need one of
those JavaScript files I just leave it
out I just transferred less weight than
it did before and that's what's meant
with the best request is regrets not
being made so you don't do this request
because you don't need this file another
example this is like half of our icons
that we have in our product and a
question for the audience what do you
think is far as transporting this or
transporting those wagons it's of course
those 2i cancer if this what is so
instead of transporting one sprite that
has like everything in it and you save
it on the client just get over what you
really really really need engineering
step one get over what you really need
engineering sep two and i'll start with
the best request it's a request not
being made again this can be thought of
some some some differently what if the
client doesn't have to make a request at
all what if you download two files I
edit some some version markers in there
and just set an expiry head off
indefinitely so these files always stay
with the client you can do then things
like okay just exchanging the second
foul so the client gets to this web page
to second time he already has the
version one from the h and SVG and his
downloading version 2 from the goddess
which is just downloading the second
file so they were the best request that
wasn't made was downloading agent we won
again and and this is the huge power of
HTTP too so yeah in some way unbundle
all the things if you think about this
writing image that's the way to do if
you think about not having bytes
transferred over that you don't need
that's the way to do it but it's a
little bit more to it and one thing or
one oddity that I really really liked
was the one from Khan Academy where it
just took an old
jquery based web application or web page
and didn't do the packaging anymore and
it turned out that the new HTTP to web
page was a lot lot slower than the
original one for one reason it was a
giclee application and everybody who has
written check variable against knows
that there's a lot of boilerplate code
really a lot and she tip is really good
at repetition so when the chi tipped all
those JavaScript files into one banner
when they combined all those JavaScript
files into one bundling gzip did the
repetition of the boilerplate code
actually improved the performance for
this bundled travel script file and this
is where this this rule like unbundle
all the things fails in this case that
just didn't work cheated at the cheat
zip performance win was much much better
than the wind ahead by by activating
HTTP two winters pushing everything over
the wire so what they then did is like
refactoring the application throughout a
little a little bit of of other
JavaScript files but other than that
really good article to read and we also
we also made some tests with one
application of ours which I want to
elaborate a little more given the time
or still halfway through with the slides
oh hey let's go in the last three
minutes or something let's go back to
this to tease two images we have the
agent that sweetie we have the gout v2s
ricci so i can interchange those images
really like i can update this cloud
image all over again and all over again
would you say that if you if you have to
change one image you have to change the
other they are completely separate from
each other let's look at this handsome
fellow you can make out the teasing
agent or guy or person or whatever what
about now something's kind of missing so
this is what we call it dependency
this is important if you yeah your head
is a dependency of yours this is
important if you take this world over to
travel script this is some weird to
JavaScript architect rivals designing we
have versions everywhere like the
version one of the payment chairs
version one of validation shares we have
a call to action that validation depends
on the overhyped framework on some
lodash or other utility and this call to
action JavaScript so every tribal
equipment lab works with with file names
so what happens if I have to update one
version of my call to action javascript
I would also have to update validation
show at the validation charl script so
instead of just pushing one javascript
file out there again in the next round I
have to put a sector put both of them by
validation v2 and collection be too so
let's try to to order our JavaScript
files in terms of frequency of change
usually if you're working with some
single page application framework or any
other library libraries are pretty rigid
you don't up them date them on a daily
base then you have the utility layer
which means that this is some sort of
here we left pad or low dash or whatever
and then we have your models and modules
on top of that and you can exchange all
the stuff on the top level freely
without having any fear that that you
have to change more than one file but if
you change anything below you have to
change everything that's on top of them
so in this one example that we had we
had a rod optimized utility layer I
think of building your own moderniser
build where you just have those tests in
it that you really like and a change
happened in this layer like I had to add
some new functionality because one of my
models was using this functionality this
meant that I had to change all the
modules as well because this utility
layer has changed and what we did to
overcome this since most of the models
just took a little tiny wee bit of the
city
italy or maybe one function or maybe two
functions nothing much we started tree
shaking this tree who is heard of tree
shaking in here quite a lot of what
everybody who hasn't heard of it this
works with Eggman stripped 16 Sumitra
between 2016 and six with a conscript
with the current version of ECMO script
um if you use egg no script modules you
can import them like that and there are
tools like roll up chess or web I guess
we pack the neck the current version of
web pack does that work as well who can
just import those bits and pieces that
you really need to if I have a huge
utility library and I just want to have
this one helper function what those
tools can do is extract those functions
so my module now has those two functions
included as well so instead of having a
broad utility labor everybody consumes
we pack those utilities that we needed
into the module and so we had lots of
highly flexible modules that we could
exchange it will and the library was
still underneath that was the way we did
it there so that's one way to go if you
request me to answer you what you want
to do with your application remember the
best request is regrets not being made
but it's all I have a few of you advises
that I can give you the first one is
create independent exchangeable
components so every package that you
have and that you can deploy without
touching everything else that's a win
for HTTP too because your check just can
update the version number everything
else is on the client and you just
transfer those little bits and pieces
over the wire that you need for the next
version create small and detach bundles
if you're going to bundle yourself try
to bundle them in a sensible way so they
don't touch anything else coat
application and edit weight is ok if the
file can stay long on the client that's
like me having a belly so I can go a
whole day without food which I did today
and think about long lasting
applications in frequency of change so
it's good to get a lot
over when you first download the webpage
but people are going to visit your
product or your application or your
webpage hopefully more than once so
everything they have there already and
they can use already is win and do we
have still to a minute I made some I
made some weird looking into the crystal
ball and doing some predictions on how
travel script frameworks are going to
handle this and the things I came up was
like amber is going to have wonderful
integrated solution ready and you can
easily migrate to it it will make for
great conference talks but sadly howdini
anybody is going to use it angry belches
observes the ecosystem for a while and
creates the undoubtedly best solution in
version free to use it you have to
include angular 1 dot 5 and go to and a
bunch of ember.js modules and react is
going to do nothing but the community
will cup amber three build tools in
several different solution that occur at
least seven ! sin test in their strings
but might turn out to be false oh don't
bet on that so a lasting remark and
that's all the things to take use tools
not rules and I'm here for about 15 more
minutes because now I confused everybody
and at around four I have to jump onto a
train go back home and getting
embarrassed for many many more people at
a wedding so yeah if you have any
questions awesome click other than that
thank you very much thank you for the
pledge for having me
and this one more thing I'm immediately
going to regret this but I announced now
javaScript conference that lens is going
to have in January 2017 and now that i
announced it for about before about 500
people i actually can't go back anymore
so i'm going to have to do this but yeah
mark your calendar january 2017 there's
going to be some funny links all right</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>