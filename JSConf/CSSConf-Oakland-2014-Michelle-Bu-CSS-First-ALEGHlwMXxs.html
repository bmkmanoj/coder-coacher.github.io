<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CSSConf Oakland 2014 | Michelle Bu: CSS First | Coder Coacher - Coaching Coders</title><meta content="CSSConf Oakland 2014 | Michelle Bu: CSS First - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CSSConf Oakland 2014 | Michelle Bu: CSS First</b></h2><h5 class="post__date">2015-06-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ALEGHlwMXxs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi everyone thanks for coming out today
I'm Michelle and I like Alex said and
from about 12 blocks down telegraph or
down Broadway so if you ever are into
Chinese food or Korean food I have
recommendations I work it's right and we
do payment stuff this is not stripe but
it's a place right across the street
from tripe because we take security
security really seriously we don't want
to show your office at stripe I'm
currently working on a rewrite of our
user facing payments dashboard with Alex
actually as for everyone else at stripe
sometimes they'll need to write CSS
usually for existing user facing
payments dashboard so it takes up a
pretty big chunk of our code base for
some people this CSS writing is not by
choice but because they need to ship
some feature they're working on and
adding that last bit of CSS or that
button to the dashboard is the final
blocker before they can you know right
their blog post you know send that email
that they ship something or people work
on CSS because they're on call and
something broke so they need to fix a
bug so it's definitely not on the top of
everyone's mind and it's definitely not
the most pleasant task for people to be
working on so in working on the rewrite
of the new user dashboard I'm trying to
solve some of these issues when we first
built our current existing dashboard we
created handful of reusable backbone
views these had the honor of having
their own CSS for each template
everything else was essentially custom /
template things that weren't obviously
JavaScript components to not get
considered for any sort of CSS for
usability as an example this modal
component complete with its own fancy
lightbox JavaScript had its own template
and its own CSS and it was really
special but this modal explanation
inside this model is stalled
specifically for this template that
appears in so it just has a few lines
and create new account view dot CSS and
this what it worked for us at the time
but as we began having more models that
needed explanation
we just kept repeating that style over
and over again in the individual
templates wait a bunch of files just
like this where it was easy to style
each individual view separately
especially because we had sass to help
us and sass allowed us in nesstar
selectors infinitely so we could go
crazy and style away without worrying
about affecting other templates except
sometimes right because they might be
used inside other templates or they
might be reused in other contexts
sometimes a particular temporary styling
might use in two places or nests in a
different template thatís tiles not
affected either way by looking at the
file names in the folder structure
there's no good way to tell because
there's no convention about which files
are which views are reusable which fees
aren't reusable and there's no easy way
to tell which side effects the CSS your
writing will have so let me take you
into a couple minutes in the life of me
who needs to add some CSS to our
existing dashboard so I need to add an
explanation to this field view so I'm
going to look for a similar similar
looking thing and I will inspect element
because I have no idea where it lists
and it looks like this particular
explanation actually gets its tiles from
like three different places so I try to
grep for the first one because I don't
think me a source Maps set up properly
and I don't find anything and that's
because it's arbitrarily nested like
three levels deeper than it should be
and if you look at the side like there's
much more nesting beyond just what the
screen shot captures so at this point
it's probably no longer worth it to try
to find styles i want so i take the last
set of styles find the color make my own
element look as close as possible and so
there's another eight lines of CSS added
to our code base there's no big deal
right unless you're doing it for three
years and over many different developers
about their own style overriding but it
definitely gets the job done and after
performing this horrible process many
times myself I have determined that
there are four stages of CSS degradation
and the first one is determination this
is where we are 10 people to let's drive
right we are starry eyed and ear to ship
a user dashboard and we're smart too
right so we'll pull the best tools in we
will pull in SAS we will clearly define
how we want to organize our views and
CSS in a way that makes styling them
really easy so we ship a thing and we
celebrate because we have an MVP one
year and 10 engineers later we are in
the development stage this is where we
start building the non MVP features and
enhance existing features so
everything's so good everything still
works everything's like semi easy to
find maybe you need you're looking to
place instead of one to find what you're
looking for and of course SAS is still
super useful super easy to add new CSS
and there's an evolution to be bugs
introduced as we continue developing but
because I'm just fixing this bug and
it's pretty urgent and maybe I'll leave
a few importance in the code but it's
okay because I'll fix it later like it's
not important that I fix it now so as
Adam mentioned before in his talk CSS is
append only so keep in mind that this
poop will probably never disappear so
another year passed and another 20
engineers and we're at thirty engineers
now developments picking up pace and
this is where we enter the third stage
of code degradation and it's denial so
dashboard still works most of the time
so everything's good I can't hear or see
any of this poop in the CSS because I
only touch it once or twice per week and
you know this is even my team's code to
maintain its not my project so why do I
care about this and one year and 40
engineers later you're growing
exponentially and so is the poopy CSS
and this is where you enter the fourth
stage despair this is where every time
you fix a bug something breaks your CSS
is growing at a rate about 3 poops per
week and there's nothing you can do
about it because everything's hopeless
so let's break down how our existing
dashboard CSS man
just spiral downhill so badly it's not
been the stage one we made the bad
decisions I think the decisions we made
at the time were one hundred percent the
right decisions and were perfect for our
size and our expertise and our timeline
for the project the way that our CSS was
handled was optimized for you know fast
development and simplicity but as an
organization grew our CSS needed to you
know our CSS needs started change not
every engineer that join was good at or
even cared about CSS and more
importantly they didn't have the context
to know exactly how every view and our
CSS or in our code base worked or was
used regardless I believe that if we can
start over and treat CSS as a
first-class tool we can avoid some of
these problems as an example we wouldn't
write JavaScript without tests or
without a winter right maybe so why
would we tolerate such things in our CSS
so what were the problems first problem
I think was that there were no tests and
some people say it's almost impossible
to test CSS and that's sort of true and
we'll get into that later the second was
that there were no conventions well
technically there were conventions right
that each template can have an S CSS
file in the same folder as a template
but more specific than that the actual
way the CSS was written had no
convention we see everything from nested
selectors to very vague selectors to you
know more specifically named selectors
in various forms and some IDs even in
there and finally what I think was our
most important issue was that we had no
CSS for use again technically there was
CSS we use just not any sort of
structured documented or explicit kind
in the art form of reusing CSS was
reusing CSS EPS styled are various
reasonable backbone views there's no
concept of like pulling out of you or
CSS that you found useful in other
places so as an example we have this
thing called transfers list view which
you think is only used on the transfers
page to display the transfers list if
it's actually used in three places and
just by looking at the file and that's
CSS you have no idea that that's the
case and you have no idea that it's
being used in many different contexts
a--'s
meanwhile sublet subscriptions listview
is actually only used in one place even
though it seems like something that
might be reusable and there's absolutely
no documentation which components you
can reuse and which you can't so what
does this matter the first thing is that
too much of this cruft filled up will
make it really hard to tackle the non
MVP problems that you eventually want to
get to write like mobile readiness
accessibility and you just can't tackle
those things unless you look at every
single file and rewrite every single
view and it gets progressively more
sluggish or snail ish to build new
things and that eventually causes
unhappiness while working in the code
base and even worse like disdain or
shame for the code base and the project
that you're working on so let's start
over this time from CSS first since we
built this iteration of the dashboard
over three years ago a lot has changed
and there's more tools available now to
solve our problems and allow us to think
of CSS as the first class citizen just
like other tools that we use most
developers would cringe as they left
crappy javascript in the code base and
we should think of CSS the same way the
first problem we should tackle was the
last one that i mentioned no CSS for use
we're tackling this problem with our own
CSS component library called boot stripe
this we also considered like stripes
trap but wasn't as good we split our
dashboard designs into composable
components everything from a responsive
content section that can be composed
with other components all the way to the
smaller details like big number and this
will form at a number into the currency
of your choice and for the locale of
your choice and all this documentation
is automatically generated and it's
written right in your code in your CSS
file so it's right in your face and you
feel guilty if you don't update it you
have to your CSS so investing the time
to build these components may seem kind
of daunting but once bootstrap was
finished it was extremely easy to fill a
page on a dashboard with these
components and then we can worry about
the ten percent less that's
implementation and polish
and and you don't have to worry about
these like little things being styled
because we probably would have thought
about them in designing our more context
specific components so one side effect
was that developers who did not know CSS
at stripe began using boot stripe for
their own projects internally and this
was something that really didn't happen
before because it's so difficult to get
something to look nice and many
developers don't know CSS at all or are
really bad at design so this allowed
them to get something on a page looking
nice without having to consult designers
or write CSS so the next problem was no
conventions so here's what we've settled
on in terms of class naming we have a
namespace stash componentname dash
descendant dash dash descriptor so as an
example we have boots stripe is our
namespace OBS big number dash delimiter
dash comma and a big number delimiter is
like the delimiter that almost your
thousands and millions and such and in
this case it's a comma because we're in
the US but in Europe you would have a
period instead so before we get too much
into that I'll briefly go over the tools
that we've adopted for our new dashboard
/ SAS so SAS was really amazing for CSS
experts it makes people's lives much
easier but when most folks who work on
your CSS only know how to pens the
bottom the file in really arbitrary ways
that somehow magically work because
that's this magic it's time to try find
a new tool that will give them less rope
to hang themselves with rework is what
we ended up choosing rework is a plug-in
for CSS pre-processing and its default
form it takes the CSS you gives it
parses in internet abstract syntax tree
and composite to the exact same thing on
the other end so that's not very
interesting and you don't need to know
exactly what it means but the gist of it
is that during this middle phase when
you have your CSS in the form of an AST
you can write small plugins that will
manipulate the abstract syntax tree
before it's compiled back into the CSS
so in this case we pulled in the we work
deciduous safai plugin which turned this
evergreen tree in
deciduous tree this difficult because
rather than pulling in a monolithic CSS
framework for CSS non-expert sees we're
now able to pick and choose specific
plugins and tools with limited scope so
non-experts don't add things to the CSS
said they don't understand so another
tool is CSS and it's a styling
methodology for component based
development includes the CSS
preprocessor built atop of rework as
well as a style guide we brought heavily
from the style guide and creating our
own and fork the suit CSS conformance
checkers for ourselves but we didn't
take the CSS preprocessor because we had
our own needs so rework stripe
conformance is fort from rework suit
conformance and enforces CSS you write
follows our predefined rules not only
does a trucker tell you if your success
doesn't conform it will not even build
the file as an example i added a big
dash number to the big number component
and a build fails and there's info about
like what line number it's on and what
exactly the misbehaving selector is so
again because developers will grumble
about being dry but pull and rework
namespace to the letter submit that
pesky namespace that's in every class we
also pulled in rework inherit a plug-in
that lets us use very simple very
limited inheritance so one in this
example one common way of styling
checkboxes is too high the input element
and then style a like fake label element
on top of that input element with your
actual checkbox style and then have a
second label element that is the actual
label the checkbox and in this case we
wrote like this whole thing for our
checkbox that falls off the page but for
a radio button we were just able to
inherit those three elements and it
works well so we have bundled these and
more into our own CSS preprocessor
called KF CSS and these are the features
available in KFC SS includes everything
from rework inherit and rework namespace
which you saw on the slides before two
smaller helpers like
rework move media which simply moves all
your media queries to the end of the
file and we work far as which gives us
CSS level for compatible variables so
something to our wages here right like
no nesting there's no fancy math or any
function stuff beyond the simple calc
function that we're allowing them again
in general we want to limit the scope of
the features that CSS non-experts like
myself can use and abuse and you know
create all their terrible CSS with so
you're probably thinking that this is
getting pretty out of hand now right
like all this accessibility stuff we've
thrown in all these long class names and
this is just for one big number right
but in reality you're not really going
to be writing that much markup you
should only be writing our markup once
and attracting it away with some
template of some sort and in our case
we're using handlebars but any templates
would work it's not groundbreaking
anyway but abstracting away components
makes dealing with deleting code and
upgrading your code much easier and the
final issue is no tests truth is testing
CSS is pretty hard one of the reasons
we're able to test the SS now is because
we're using CSS components if you've
ever had to visually difficult page
before you know that it's often not very
effective right like things changed all
the time and you don't want to always
like play find the difference for every
change the hardest part about testing
CSS is actually all the different states
that your elements can have in all the
different ways that those elements can
interact with each other so we have
pulled in rework pseudo classes which
gives us pseudo classes for each of
these states and we are able to compose
them in our tests to mock these states
and we pulled in grunt huxley which then
takes screenshots of our test cases and
gifts them in this way we can also
declaratively write tests right like you
don't want to tell your you know phantom
jay has to go click on this button and
then check what the state is we're able
to like explicitly say these are the
states I would care about and we want to
make sure that they stay the same so
huxley is pretty cool this is an example
of a diff that it found from a two pixel
vertical line change another great thing
about checking these these
in woo i don't know why it has that
other great thing about checking these
files in is that we are able to use
github stools to you know the onion skin
to lure the swype tool to see the
difference between images so why do we
care about this so why would you build
your own component library from scratch
when you know there's bootstrap around
and it's it's a lot of work right well
hopefully
sorry about that hopefully with your own
component library you're then able to
spend ninety percent of your time
building up this component library and
then every time you add new features to
your app you will then just have to do
the last ten percent of polishing and
building and then hopefully a few years
from now instead of trying to figure out
what exactly this means when trying to
sell an explanation in our settings you
will know exactly what class is to add
the hope is that if we think about CSS
first then we will eventually be able to
think about CSS much less so thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>