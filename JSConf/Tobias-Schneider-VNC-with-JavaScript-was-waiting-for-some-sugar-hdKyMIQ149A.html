<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tobias Schneider - VNC with JavaScript was waiting for some sugar | Coder Coacher - Coaching Coders</title><meta content="Tobias Schneider - VNC with JavaScript was waiting for some sugar - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tobias Schneider - VNC with JavaScript was waiting for some sugar</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hdKyMIQ149A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm to be a Schneider from unique Toby
Taylor and Twitter I haven't repaired a
lot of slides so actually that's my only
slide for today so I have to watch it
for the next 20 minutes no okay yeah I
haven't repaired a lot of sliders said
am I just want to demo you a project
I've been working on for a while
actually I'm working on it seems about
four or five years so and it all started
with the idea to create and VNC viewer
in JavaScript all of you guys know what
VNC is probably okay so it started the
first version of that means if you in
JavaScript five years ago and bought and
it worked well but it wasn't really sexy
enough to release it so I was waiting
for some sugar to push it out and that
chica came in form of noches so if you
have expected to see a remote desktop
solution which our script that's not
what I'm showing you what I'm showing
you a tool that lets you create your own
services based on wii and see with no
chairs so
so I think the most of you has used VNC
in the past as a remote desktop solution
but under the roof what it basically
does means he it's just a frame buffer
that is shared with the clients that are
connected to it so it's switch to the
text mode and reduce chosen some demo so
what I first created is a implementation
of the remote frame buffer protocol
which is the protocol that is used by
VNC to stream all the changes on a on a
screen or on a buffer to all its clients
so I can show you a little demo of that
so just start a little vincy server
adventure and first using a native in
decline to connect it just to see how it
looks like with a regular VNC client so
let's connect to local host okay nice
that is just a little trying demo now
you connect to the ravine see climbing
can draw on a screen and you can also
connect to it let the Chavez with a
shell script view well let's see if it
works yet so
so what you see here at the left is Oh
where's my mouse pointer here this is
the browser is the VNC implementation in
JavaScript which using web socket to
connect to the VNC server for the
project I'm using a modified version of
a modified version of living seas
library that is a native c library which
is used by by ro rhe in CT server and as
you can see and I let's reconnect so you
can see you can draw on the right that's
the native in C server and that's the
choice between c0m0 all the changes are
in retail but that's not all so as I
said before you can with my to you can
create your own services with note based
on the VNC or the remote frame buffer
protocol so and I give you a little demo
how easy it is so after you checked out
the project and get up you can start a
new project and first you have to
require the note screen module so let's
do this
hmm
okay and then you can create a VNC
server a frame buffer just by let's save
it in a real so screen that crude server
I'm passing an object and an option and
keyboard object as the first parameter
and let's set the dimensions of the
frame buffer so with 800 and height of
600 and the second argument is a
callback which gets fired every time a
new client is connecting to the VNC
server and that callback is taking a
client object as its argument so this so
so let's print out a little console
message every time a new client is
connecting to sue sue and then you can
start a server on localhost
on port so let's start this over ouch
Charles what is narrow
mm-hmm let's just let's have a look in
here
what happens okay yeah I did port first
hostname a second so okay so now our VNC
server is running and we can't connect
to it first with the native VNC client
today so it's an empty screams let's
just just a black screen having the
dimensions we pass to the create several
method we can also connect to it with
the new JavaScript viewer so rip so once
a new client is connected and it fires
the the callback you pass to the create
server function as the second argument
you can listen on that client object you
can add event listener and callbacks and
can listen to all Mouse events and
pointer events so for example you can
say client on pointer move
yep three star server
reconnecting should I should use this
like I know what okay let's connect into
it move it a little bit with a mouse
oh yeah let's go damn it sorry yeah
so we connect and you can see all the
pounder events or fired we can also lock
the current mouse position by this minor
works
term
hip
so now we've graded our first green sea
server and what a note screen provides
you is access to a frame buffer in form
of a node buffer which is just a
allocated bunch of memory which presents
a frame of it just presents a pixel
array when you have worked with a canvas
on client site or canvas in the browser
you know the pixel array when you have a
2d context and you're calling the metal
get image data and accessing the data
property so then you get back kind of
array which represents the pixels in the
canvas so and that's what you get in not
screen and once you've created a server
you can listen to refresh event and that
event is fired 25 times per second you
can define that frame rate by passing it
here in that option object you can see
refresh rate 10 so that's that means
daddy with the Refresh you when it gets
fired 10 times per second and the frame
buffer the pixel array is passed to that
call back as the first argument so
that's the frame buffer
so now at that point you can put any
pixel the sources you want into that
frame buffer and it gets synced with all
the clients that are connected to the
server so I mean let's make a little
little game which just puts a white
rectangle on the screen for each client
that is connected to the VNC server and
all the connected clients can just move
their own rectangle over the screen so
so frame buffer is just a regular bother
you can put in there whatever you want
that's so we can't use for example note
canvas to draw into the buffer so let's
require no cameras of course you have to
install it first wire NPM I did that
before so let's have an array of players
that are connected to the game just an
arrow so when every time a new client is
gay connects to the server we create a
new player object I'm storing the
current position started 0-0 adding at
it to the list of players so and let us
control our rectangle with the arrow
keys so that's at some look un's on it
on key down
so we check in a switch block which key
we have breast this q sim case screen
key no chain also provides some key
constants because we don't have to know
which key fires which kick-out so you
can just use the key object which is
exported by not scream by the note
scream module so you can say I'm down
just increase the stakes by 50 pixels so
let's copy that okay on up that's
decrease it okay and we add on for damn
it I hate text made for right okay put
you increase why not x plus
when you put a left is it okay okay and
he in the Refresh loop we draw all the
players on the canvas so first we have
to get T now that's wrong here canis so
we can create a canvas 800 600 and we
need a context 2d ok let's clear the
screen first maybe that's not the most
efficient code but it's okay for demo I
sorry clear right 600
nope
okay so let's iterate through the
players array and throw by electric
rectangle for each player let's do a
fill style let's make them all white CDX
correct we're position let's make 100
and 100 white height said okay okay and
then we have to copy the pixel data out
of the canvas in India or frame buffer
so let's do that by creating a new
buffer out of the pixel data image data
position know so just wonder you have to
Jehol cameras and copy it into the frame
buffer
looks good let's give it a try okay
let's connect with the native plant okay
there's our white rectangle it's not
working why is it not working okay it's
not this it's player of course
so let's see if it works now yeah you
can control it so let's connect with the
web client let's damn it over there
it is Oh mr. school yeah here you can
grade your own games you can grade your
own remote desktop solution base w just
have to write some simple note bindings
that perhaps your your mac screen or
your x11 screen and and cup just copy
that into the frame buffer and it synced
to all the clients using the VNC
protocol and or creating a super fancy
canvas super mario game or whatever and
let it run on the outside or on browsers
that support canvas you can run it and
client site in the web browser and for
clients that doesn't support canvas you
can run it on outside and connecting
with even with all the devices like a
Nokia Symbian s60 device they all have
been seat lines in Java and you can play
together with other with iphone users
with chrome or WebKit users or Firefox
use whatever yeah I will release it the
next days and get up so just download it
modify it make cool stuff with it may be
cool remote desktop solution
yeah that's it nothing more</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>