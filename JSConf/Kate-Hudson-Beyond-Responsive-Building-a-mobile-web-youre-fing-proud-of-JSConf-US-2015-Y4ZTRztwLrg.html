<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Kate Hudson: Beyond Responsive: Building a mobile web you're f*ing proud of | JSConf US 2015 | Coder Coacher - Coaching Coders</title><meta content="Kate Hudson: Beyond Responsive: Building a mobile web you're f*ing proud of | JSConf US 2015 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Kate Hudson: Beyond Responsive: Building a mobile web you're f*ing proud of | JSConf US 2015</b></h2><h5 class="post__date">2015-06-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Y4ZTRztwLrg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm a web developer Mozilla I'm the
lead engineer on the web maker for
Android project I want to start off on a
high note here the web is broken and I
don't mean the Wi-Fi although the Wi-Fi
is totally broken right now so I'm not
people to demo some the stuff I was
gonna show you but that's okay um and
you know it's not actually broken for
most of you JavaScript developers right
on Firefox and Chrome and edge I'm for
you the web is still probably pretty
awesome but for the rest of the world
coming online right now and that's like
two billion people over the next few
years it really kind of sucks and that's
just because for more and more people
the first and only experience they're
ever gonna have of the web is mobile and
the mobile web is not good enough so
let's talk about why the mobile web is
not good enough you probably know most
of this already I'm the one that you are
probably feeling a lot right now as you
iperf you know particularly particularly
when you're doing things like gestures
and lots of layout paints and/or layout
and paints you know not great not as
good as we'd like but there's lots of
other things that are broken the off
model that's based on email doesn't make
any sense for new users of the web who
don't even have emails the experience
when you go offline or when you're on a
you know 3G or less connection is really
pretty terrible for most of the web and
of course all of the access to the OS
level device integrations like push
notifications and camera and on the one
hand that's okay the web was built for a
completely different desktop based
paradigm right and it's gonna take some
time for browsers to work on solutions
right that's fine but on the other hand
it's kind of not okay because not only
does the web kind of suck at all these
things right now native platforms are
actually really good at them and there's
some technical reasons why certain
things like performance are easier to
get right on native platforms but I
think the primary thing going for native
is that it was built with these problems
at the center of its business model and
the web was
so it was actually kind of wondering you
know is this still something that people
care about are we still talking about
this and it turns out it is
it's just yesterday actually one of the
leading authorities on browser quirks
and compatibility since the 90s I think
he wrote an article on his blog and it
was called web versus native let's
concede defeat I want to read this out
because it's important I feel like it's
time to revisit the web versus native
debate and concede defeat where at least
concede that the web cannot and should
not compete with native when it comes to
complex app like structures you know his
argument essentially that is because of
the fundamental architectural
limitations of how the web was built
we're just gonna have to give up on
building these rich client app like
experiences and go back to the true
strengths of the web which is you know
URLs Universal accessibility etc you
know what he has a point you know
overlooking the fact that there's a few
things like you know offline that still
affect the overall interoperability of
the web this is a totally reasonable
rational rational argument when you look
at the current state of affairs and it
might actually even be a popular one
honestly if what you really want to do
right now today is to build the fastest
coolest most awesome UI with like 3d and
games and whatever I would have to tell
you you know what you should consider
building for Android or iOS but if what
we're saying that this is the way to fix
the mobile web it's to give up and
abandon app like experiences for
something that you know works better
with our original model of the web I
couldn't disagree more but to do that
first I want to take a look back at the
year 2004 how many of you were doing web
development back in 2004 wow that's a
lot of you this is awesome so you're
totally going to remember some of the
stuff I'm gonna talk about here so
yeah I was a big fan actually of both
Britney Spears and Orlando Bloom at the
time they were the parent according to
Google's super awesome zeitgeist of the
year they were the top two most popular
people
oops that didn't work the top two tech
topics according to Google search
analytics number one was wallpaper this
is tech topics
number two was Kazaa so that's like yeah
if we were doing Jas comp in 2004 that's
what we would be talking about pretty
awesome
so you know also PHP 5 was released that
year Ruby on Rails was at 0.5 point zero
and Google had been around for about six
years already so it's cool so something
else happened 2004 it was the year
Ashley was the year that Facebook was
released as well though I don't actually
remember that but it was actually a year
that Google first released Gmail and at
first because it was released in April
and Google had this reputation for being
notorious for April Fool's jokes people
thought it was maybe a joke um you know
actually does everybody remember when
Gmail came out were you signed up for
Gmail yeah I don't remember it being as
cool as people said it was but it was I
guess it was pretty cool you know it was
a real thing and it was it was cool for
two reasons okay one was that it offered
a gig of storage where all the other
online competitors like you know Hotmail
and yahoo offered you know way less than
that and the second thing was that Gmail
had this super neat interface that could
actually live update when you received
and received a new email without
requiring a page refresh but that was
super awesome right and you know in 2004
the idea of rerender 'adam with new data
after the page had loaded so like Ajax
was not at all common on the web nor was
it even expected you know all the other
web email clients were basically
terrible and clunky and required lots of
page refreshes but that was just the way
things were you know if you wanted an
app like experience you were expected to
use a window
email client right pretty reasonable so
when the lead developer of Gmail told
his co-workers he was gonna write this
entire app I'm totally in the browser
and almost entirely in JavaScript
they were like what really you know in
fact almost everybody talked to you even
internally at Google and he says this
himself especially people who consider
themselves to be experts in JavaScript
in the web
I thought his idea was totally naive it
was never gonna work because people have
tried to write complex things in
JavaScript before and they knew the web
was just not made to do that kind of
stuff and this was a really common
opinion at the time you know javascript
was at best a thing that you know could
decorate your pages or enhance them a
little bit and it worst it was a
security flaw it was non standards
compliant it was disruptive and pretty
terrible right so I want to show you
some things that people were actually
writing I was digging back into the
Wayback Machine and some old blogs from
2004 SiC or 2004 this is from the anti
JavaScript FAQ well I am personally
opposed to all use of JavaScript I
understand that it can do some things
you can't do with normal HTML but just
remember if Amazon can do without
JavaScript so can you so this is a
proposed title javascript is evil a lot
of designers think it's their god-given
right to annoy the hell out of visitors
with bulky JavaScript effects so turning
off javascript is almost a requirement
to visit some websites that's pretty you
know it was true at the time right this
is my personal favorite blindly this is
a from stupid JavaScript security tricks
a little bit older but still relevant
blindly accepting a high level of
security worse on the web by enabling
javascript is as shaky as a ride on a
Canadian Space Shuttle made of birch
bark and pine gun I'm not sure where
that came from
I'm Canadian so of course this really
resonated with me woo represent okay
so this is what people were seeing right
like JavaScript was not a thing so
despite all of this weird stuff and the
fact that JavaScript was terrible and it
was a total hack Gmail was a total hack
it was living proof that you could write
something in JavaScript that people
actually loved and that's awesome you
know wasn't long after this that
developers started getting excited about
the XML HTTP thing and using it all over
the place and you know before we knew it
the grid writ great rich client
experiences became something that was
essential to the web as the promise of
interoperability itself you know fast
forward 2006 and all of a sudden XML
HTTP thing has now been standardized by
the w3c and Java Script is moving
towards you know process of
standardization and universal acceptance
hooray
fly for JavaScript so the point is this
you're not here at this conference about
to learn about knitting and making music
and driving robots because someone
intended or designed to make JavaScript
or the web to do these things you are
not here because of a standards body you
are not even here because of a browser
well you're kind of here because of a
browser but not entirely because of
browser you're here because someone
wanted to do something cool and found a
super hacky but somewhat compelling way
to make it happen so my proposal to fix
the mobile web is this stop relying on
browsers to re-implement the Dom or land
device api's or do whatever it else it
is that you want stop thinking about
what the web is or what the web was
maybe this is totally naive but I don't
think that rich app like user
experiences are something that we're
gonna be able to pass over no matter how
compelling and awesome the URL is and if
you want to talk to me about URLs I will
talk to you about URLs if you want to be
here talking about JavaScript in five
years it's time to hack so in order to
demonstrate some of the ways you might
do this today I'd like to use a model
I've devised called the three levels of
hack where we start in a place that most
people would kind of agree is not that
weird and then end up something that's
really weird so let's start small first
level of hack tests new feature before
their time you know that's a great way
to push the platform a little bit to use
new browser language features right that
haven't made
into production so one way to do that is
to turn on stuff that's there and use it
easy right
one thing I'm personally really excited
about is the serviceworker which is
going to help out with offline in a huge
way and I'm not going to talk about it
in detail but if you've ever used app
cache or you're thinking about taking
your app online you should definitely
check it out there's already an
implementation in Chrome you can try
today and I think the Firefox
implementations coming out in the fall
sometime so that's super cool on the
second thing you do is transpiler
polyfill the features that you want to
make them work for users today and one
of the things we do all the time on my
team is transport is six using babel if
you want to hear more about that because
it's awesome sebastian is going to be
speaking about that later after the noon
in this afternoon so I highly recommend
you attend that session you know in
doing this kind of stuff is not
controversial but I'm mentioning it
because if you're not doing it you
should and the other thing you should do
is if you find bugs or you have opinions
about how things should be changed you
know
the implementation teams that are
building them really want to hear from
you the gecko team for example who's
working really hard on service workers
right now I mean is really interested in
getting feedback on you know the service
worker and like how you want to use it
so if you're interested in joining that
conversation just talk to me after and I
can hook you up with right people ok so
let's do the second level of hack
building new abstractions so you know
beyond things that are being implemented
cool stuff really comes out of people
thinking in completely different ways
with the tools that are there so you
know one area we're seeing a lot of
innovation I'm sure all of you are aware
probably using this stuff is Dom
abstractions like you know reacts
virtual Dom famous engines Dom and WebGL
abstraction Flipboard did a cool thing
with react in canvas you know for the
most part they don't replace the Dom
they just sort of augment and optimize
particular areas of it by building an
abstraction you know and that's pretty
cool it is a total hack let's be honest
it's a total hack but it's awesome
another thing you can do with
abstractions is build things already
exist
don't yet exist with how the counterpart
on the web so again going back to the
offline use case pretty cool example
I've seen in in the last few months is a
some colleagues that might have been
working on something called filer which
is basically like a POSIX compliant file
system interface in the browser and it
doesn't actually use a file system it
just abstract one on top of indexdb or
you know web SQL or even in memory so
that means that any modern browser who
that has access to those things can
actually do file operations and store
them offline which is amazing there's a
group of super smart people working on a
code editor that takes advantage of
filer at Seneca College in Toronto so
you should check out that if you're
interested in filer it's super cool so
ok we talked about some fairly you know
things that are exciting but not exactly
controversial because we're still
building on top of existing api's and
mostly doing things in a web-like way
but you know what if we could go
actually further than that you know if
their browser is the thing that holds
you back why not just hack on that cool
right and in this case I'm not talking
about like submitting a fad of a patch
to Firefox for Android although if you'd
like to do that there's a link you know
totally awesome you totally can and
should what I'm talking about is
basically hacking together your own user
agent inside of a native environment and
this is also known as hybrid app
development right and maybe you haven't
heard hybrid app development described
quite like that hacking together your
own user agent that's essentially what
it is and there's some frameworks out
there that can take care of the dirtiest
part of that hack if you want to try
them out I would highly recommend
Cordova which is a really brilliant
project that kind of feels the closest
actually still developing with the web
but I'm getting api's from the native
device but I do actually think it's
valuable to do yourself you know are you
going to implement a better browser for
all mobile users
you know are you smarter than the people
who work on Firefox and Chrome and you
know Windows absolutely not you know
you're not I'm sorry maybe you are I
don't know come work for us if you are
but you're probably not but you know
personally for when I'm working no
seriously like I'm talk to me personally
for what I'm working on you know I found
that building a custom hybrid
architecture well it's not the solution
for like all the web's problems it
allowed me to experiment with solving
the exact problems that we were having
with the mobile web and understanding
that connection much better than I would
you know using something like Cordova or
just building within the browser so to
put this into perspective I'm gonna talk
a little bit about what my team at
Mozilla is working on
we're interested in what Web authoring
tools might look like primarily for new
users of the web in Bangladesh Brazil
India and Kenya using only a mobile
phone so that's like what our problem is
and the first iteration we experimented
with was a more traditional client-side
routed single page app we tried doing
Android we tried doing in Firefox OS we
didn't target iOS because iOS isn't just
not a huge part of our market so but we
had some pretty specific issues that
were major blockers right so one of them
was you know obviously we need to make
something work really really well
offline and in 3G or less that was like
a huge requirement for us you know we
tried using appcache but it wasn't
really doing what we needed to do we
were seeing a lot of issues with memory
leaks popping up in client-side routing
architectures particularly when you're
you know destroying or building new
views you know especially when people
are idling the apps on their phones for
3-4 hours that was like a huge issue for
us another big issue was on UI / because
it's an editing interface when you touch
and finally at least 50 percent of our
users we're still using Android phones
that were before 4.4 which uses like a
stock Android browser or anybody
developed for the stock Android Browser
Wow like nobody it's oh my goodness you
think II's bad you should try developing
for
you know the Android sock rouser um it's
you know doesn't auto-update it's it's
pretty horrible so these are our
problems let's let's figure out how we
fix them these things in an android
custom android environment so actually
any Android developers here know oh we
got one this is good this is good all
right this is gonna be interesting to
you
so let's um I was gonna skip past this
part if you know you guys all do um
Android but alright so the basic
architecture how do we build this custom
hybrid app and by the way this is really
similar to how our Cordova works or any
other you know hybrid architecture it's
just I want you to understand how you do
it yourself so the first thing we do is
we start with an Android activity which
is like a basic view in Android and that
may or may not contain some UI like a
back button or a header you know or it
might just be like a frame to hold the
webview right so how do we do that you
know who write some Java here to an
activity we create the layout in XML and
then we add it to the manifest where we
can specify things like the name and the
parent view like the view hierarchy
stuff like that it's kind of weird but
you know not so weird
so inside that activity we instantiate a
web runtime so that's gonna be based on
WebKit chromium or actually in the
future even gecko there is a project
right now to embed gecko and Android
although it's still it's not really
production ready yet so that's super
cool and you know Android actually makes
this really easy to do it actually ships
with a built in class for embedding
chromium in 4.4 plus or WebKit in
earlier versions of Android so you just
import the class and instantiate in your
view and attach it like super easy right
sort of so you know like us you probably
want to support the most modern version
of browsers though so instead of using
the built in WebKit you might want to
use something called crosswalk which is
this super neat project lets you embed
the latest chromium on as far back as
Android 4.0 so that's like a huge deal
and the API looks really similar it
exposed a lot of the same JavaScript
Java bindings it's you know it's great
you should check it out
Spock project.org so last thing we're
going to need in this architecture is a
communication layer that binds our
JavaScript our Android code together
some of that's provided by the webview
class or the crosswalk class so you know
you can load external URLs you can load
you know packaged assets inside your app
if you're wondering yes even if you're
using the file protocol you can still do
xhr because this is your own user agent
and you can do what you want
all right so but the real magic that
happens though is that you can expose a
custom Java interface into your
JavaScript by attaching it to the window
object and that kind of lets you do
whatever you want so what does that look
like we've got you know we add a
JavaScript interface to our web view we
basically attach a class to it and we
can add some methods on that class and
those methods that are declared actually
show up on window Android or whatever we
declare you know we could call it
whatever we want there I called it
Android we can just call those Java
functions of course you're fairly
limited in what kind of data structures
you can pass through you're gonna want
to use primitives like strings and stuff
can't pass full objects or functions
around sorry but it's still pretty
powerful and that's basically it
so yeah that's how it works if you
remember from our example one of the
major issues we had was that the
client-side routing caused a lot of
unexpected memory leaks you know long
live processes were kind of not so great
in our client side app so what we did
and this is what you couldn't do in
Cordova but we could because we were
doing something you know were hacking
something together
I'm nor to fix the issue we had we
actually moved the routing into Android
so we could take advantage of the more
sophisticated memory management and a
life cycle events and we instantiate
each page of the app as an isolated view
with sone activity so actually that's
really similar to server-side routing
and it actually you know has the same
benefits like encapsulation of each page
but in Android we also get the added
benefit of super smooth transitions and
layout hierarchies you know we can get
the back button to do what we want so we
kind of the best of both worlds
which is pretty cool so what did we do
about shared state so this is where
those J s Java bindings come in because
we're using react to render the web UI
it's actually pretty trivial to both
send parameters into react and then take
the state out of react in cache and
Android so what is passing route params
look like basically you just you know
stringify
the router params send them in your get
initial state function and all of a
sudden you have all the information from
your router that's pretty simple and you
know to cache state we just create a
JavaScript interface you know called set
state that allows us to pass in a string
if I adjacent object with our react
state so that it can be cached in in the
shared preferences and android in our
react code we just need to hook into it
right so whatever time our component
updates we basically set the state and
Android so it's cached and when the
component mounts we actually just pull
it down and then restore the state so
you know it's super simple but it solves
a problem you know we can restore things
in an offline context we can get around
you know using that Android based
routing without you know having a
sacrifice or user experience so what
about device integration this is
something actually if you're going to do
you should definitely look at the crudo
of a codebase there's a lot of plugins
that primarily look at device
integration here you know we write some
we write some of the the typical code
you write an Android app for you know
dispatching the camera intent looking at
whether you want a a camera or gallery
we create a URI out of our out of our
image or we could you know we could do
something like upload it at that point
in time and then we actually post it in
this like super awesome hacky JavaScript
window thing we actually post it to a
method in JavaScript we post our your I
and then all of a sudden we can use it
in our JavaScript so you know seems
totally terrible but hey you get an
understanding of how Android is
receiving you know the camera intent you
get an understanding of what you can do
in terms of compression
you get to you know be a lot closer to
your device and you would ever would be
using some web api or just saying well
we can't support camera so what else
there's lots of things you can do you
can bind to androids offline network
caching utilities you know if you want
to do that before service workers are
available you can hook into some native
gesture so you know you could actually
read gestures on the Android side and
post them into JavaScript if you want to
do things like you know pinch zooms or
swipes that are much better architected
in Android platform and of course you
can do lots of device integration like
push notifications or whatever you want
and really it's up to you because it's
your browse well it's your user agent so
the truth is I'm not really sure any of
this is going to be actually successful
or even that it's reasonable or possible
to make fundamental changes the mobile
web in this way that works but you know
what I am certain of is that if you
don't try bold native things you know
naive things and develop a better
understanding of the platform you're
building for you know if all you're
doing is pushing up against the edges of
the browser things are not going to
change no one is going to fix the web
but you and your understanding of your
real problems so I want to end with
something inspired with my dad that's my
dad
because one he was pretty much the
coolest engineer I've ever met in my
life and two because Friday would have
been his 74th birthday first birthday so
happy birthday dad
Thanks
so my dad was totally self-taught he was
an amateur radio hacker and he also
designed some really really cool radical
electronics equipment back in the 60s
70s and 80s he worked a lot of people
who had engineering degrees and one of
the things he said all the time was that
for all their education and
understanding of theory a lot of people
just didn't really get what good
engineering was good engineering because
to my dad
really good engineering was finding
adequate solutions to problems that
really matter to people in a way that
someone in the future who's smarter and
better than you can understand and
improve on and as long as you're okay
with the fact that the web is always
going to be this patchwork open weird
somewhat hacky totally imperfect thing
as long as you're willing to think about
it and build for the real world around
you and not for what the platform tells
you to do you're probably going to make
something great you know for the 500
things that suck and are terrible you're
gonna make something great and if the
talks we have lined up you know the next
few days or any indication of what
people think about that I think we're
gonna be fine so hack the good hack my
friends thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>