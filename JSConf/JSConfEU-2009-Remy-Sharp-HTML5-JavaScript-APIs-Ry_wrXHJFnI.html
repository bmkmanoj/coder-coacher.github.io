<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[JSConfEU 2009] Remy Sharp: HTML5 JavaScript APIs | Coder Coacher - Coaching Coders</title><meta content="[JSConfEU 2009] Remy Sharp: HTML5 JavaScript APIs - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[JSConfEU 2009] Remy Sharp: HTML5 JavaScript APIs</b></h2><h5 class="post__date">2013-06-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ry_wrXHJFnI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">and then I'm going to talking about
html5 JavaScript api's and and this this
the kind of picture I think of the
Sharks me or html5 and the freaking
lasers on the top of the AP is that the
JavaScript API is in there because the
eight the html5 spec is absolutely
massive but there's a huge focus on the
language that's in html5 and that's just
like a tiny bit of the iceberg the the
really chunky bit of the spec is the
JavaScript API so so I'm going to kind
of show you some of those i'm gonna show
you some of the code that's in the
JavaScript api's and show you how they
can they can be used before I jump in
and I wanted to mention 2022 because I
kind of that's the date that rings with
html5 as well and and it came out of an
interview with aaron hexen who's the
editor html5 with techrepublic and 20 22
is the date that two browsers have a
completely interoperable implementation
of html5 so to put that in some kind of
context and CSS 2.1 only has one
complete implementation in ie8 but i'm
still using CSS 2.1 and i'm pretty sure
if any of you guys doing any web stuff
you're using CSS so that's not going to
stop me from using html5 in my apps
today so html5 is that this large
collection this is just some of the the
JavaScript API eyes on there so let's
drag and drop there's the history API
and so on and but what I want to talk to
you about is html5 which the only
difference being is that there's stuff
that was ripped out the html5 spec and
put into sep respects so I'm going to
touch on web forms and you should be at
a CEO cyber web forms the media elements
canvas and offline applications and this
stuff isn't in the html5 spec they were
pulled out and are now in their own
separate specs but they're they're
pretty cool and interesting api's i
think i want to show you how it all
works so web forms works in in opera and
some Safari and I'm kind of starting
with one that makes us not have to do as
much work and that's a flickr search for
web forms that matches on storm trooper
not sure why so JavaScript originally
liked it back in the day it was good for
a form validation and image rollovers
that's kind of where we've all come from
and image rollovers was sold with this
hover Syria class and now we have web
forms to handle form validation so Java
scripts only good for awesome now
so and what this is is just this is
straight markup on the page where I've
put and a form on the page nothing
special on initially no JavaScript and
the input type up here has type is is
email and in Opera because it has all
the web from to go stuff it will
immediately validate my my email address
for me so donkey doesn't validate as a
rly man address but when I submit the
the form I've got this this tiny piece
of JavaScript where I can actually hook
in and say is the form valid the point
being and is that it's less donkey work
for us guys to do we don't have to write
the JavaScript that does the form
validation every single time I mean
there's libraries out there to do this
stuff for us but if we don't have to
keep adding this stuff that's really you
know is it's like Dom scripting Dom
scripting been solved cross-browser
problems have been solved with you know
jobs with libraries if we can get rid of
the the form validation problem it means
that we can start you know writing more
interesting JavaScript and not have to
handle those problems my my kind of
dream for the moment is these libraries
detect web forms support and if it's not
there they kick in and kind of add the
web form support but I know there's kind
of discussion as there whether or not
the specs awry and so on but that's my
dream and I i mentioned Safari has web
forms to go support as well so you can
the way that they they're making use of
it is in their kind of assistive device
so on your iPhone these are the
keyboards that come up for the different
input types and you can see on input
type is tell you get different you get
the the numerical
add so i believe moderniser is looking
for the is checking the input types and
telling you whether or not these these m
/ types are available and it's is
putting up a false negative positive in
WebKit because the desktop browser
thinks that it can it can handle the
telephone input type is actually the
mobile phone version what's that no no i
know i know it'swork it's for it should
be it the desktop should should say not
like don't support this but you know
maybe they're going to assistive device
attached to the the computer that you
know is looking for this kind of thing
so again it is the browser spool so I'm
moving on to a meteor elements and thats
basically audio and video and they
basics they both extend out of them this
this media element i'm going to focus on
a video for for this this section so
this is embedding a video into page now
which is compressed down to this one
line with the media relevant and there
is kind of the problem of Betamax versus
VHS the codec wars and originally the
spec had discussions about telling the
browsers which code excited to implement
and that will went out the window
because they can't the for instance
Firefox has open source I can't
implement a patented or a close source
codec so that's now how to buy the
browsers so we now have to input types
and you've got a kind of wonder about
the guys who don't support the video
element a fire opera 9.6 did support
video but it doesn't anymore and it
supposed to soon and but I doesn't
support video just yet and deon mention
the release dates 15 years away so it's
a while before I II will so we need to
take our nice full line job and turn
into this to look for QuickTime and then
to look for the flash object so you need
you can drop down the support to defer
back onto the nasty massive flash thing
but we're going to look at this and the
API is attached to the video element so
this is a quick hack I put together the
other night my cat dizzy being dizzy and
down a bomber this is there is my my
control so I've got a button
stop-start and this this timer which
could be a a progress bar but it's it
the code is really simple it's when I
click on the pause button I check if the
video is paused in the first place and I
check the property video ended and if it
has ended I've set the time back to the
beginning and if they've clips on I just
play the video otherwise I'd pause the
video I realized about ten minutes ago
that this code is a little bit wrong the
orders wrong but you guys aren't going
to work that just until you play with it
so um the videos also have or the audit
in the media elements also have events
attached to them and the the in
particular the time update event which
progresses as the the video goes long so
you can hook into these events and I in
my demo I'm just setting the the current
time I'm just formatting as a time and
updating the the progress slider
basically so the API is is really simple
for video and audio you could play pause
and you've got these events can play
tells you the the actual element is
ready to be used and you can hook into
the end of the vent and I kind of see
you could create really interactive kind
of video on the side and in fact you can
have these videos and you can have the
points of which it slides change have a
JSON file that's attached latin and make
them progress action the browser and in
in testing browsers tend to be rather
quiet about bugs in with video so
firefox if you don't give it the right
content type it just doesn't do anything
it doesn't throw an error it just just
doesn't do anything you get black screen
and Safari if you tell it it's a text
HTML page and if you get a content type
of text HTML then it will just plow on
and just try and read the media and and
just play it in the in the browser
accessibility is a big question and
there's a lot of kind of discussions
going on in America at moment about
accessibility but this is a video I
found which is using the progress event
at the the time update and it's got this
JSON file with the subtitles to the
video and it's but they basically create
captioning which i think is really
interesting because this could be then
fed out to a Braille
assistive device so there's a I think
there's a lot of opportunity inside
about so the campus is kind of the the
other really sexy part of html5 and
which works in these browsers and with a
bit kicking from xjs will work for in IE
as well so you've seen some of these
demos and eons talk as well and the you
know it look good for games and bacon
basically i'm going to show you how to
do this code this in in canvas and it's
just a simple gradient so my day my
markup I've just got this canvas element
and I get the 2d context of the canvas
there's 3d stuff that's kind of being
worked on and separate but at the moment
the canvas just TD and I'm crank this
this gradient object within the top left
and the the radius of the first circle
and the outer radius is top left as well
adding color stops and setting the
gradient to my my canvas and then
filling that that that canvas itself and
it gives me this this most gradient
really really sexy which I couldn't do
you know five at Photoshop in two
minutes but there's some there's other
really nice features inside of the
canvas like things like you can do to
data URL so you can actually get all the
raw data out of the canvas and save that
as an image so you could add you fight
your photoshop app and you could
literally just save it to your desktop
using this this to data and and and then
you've got the canvas plus drawimage
plus video equals Frankenstein in some
kind of massive mashup but it's a recall
Frankenstein because you get to do
things like this again I knew I knew
dealing was going to have these slides
in here so I haven't just stolen them
from this previous one but what's going
on here is this is the the explanation
from their blog post what they've got is
that the thing that's playing is
actually a canvas element and there's a
timer reading of a hidden video and
grabbing that image and putting into the
canvas and then when you click on one of
these patterns it takes that and maps
onto the the campus as well but they're
really really interesting bit is this
canvas
and get image data so they're getting
this this this data back from the canvas
at that point in time that particular
frame and then they're going through
each one of the pixels and looking for
the white spots and at that when they
find that white spot they've got the
coordinate to map that extra canvas over
the top of it which is how it's working
so there's two ways of doing it there
the code and that demo is a looping on
like a full step so it's taking every
fourth pixel checking what the value is
and then and working out what the
position of the the late on pattern is
you can also have a kind of really small
canvas hidden away the side and go
through every one of those pixels so
this is a the same video that I had
before and I've create the canvas
element next to it I translate it the
campus so it's kind of flipped it
vertically and then I'm drawing the
video on on progress and it's creating
this mirror effect next to it and which
you know pointless for a cat but you
know you could you can see how Safari
has those you know inversed mirrors
shadow you know the mirror effects
underneath their videos and there's
there's a lot of stuff that you could do
with the video in canvas you could use
it for a lot of evil as well I can
imagine the you know the flash nasty ads
that you get from the ad agency so if
anyone can promise not to sell the ad
agencies I think we're going to be good
and how am i doing for time anyone ok ok
screw up monkey bang oh cool cool ok so
offline applications is in safari and
firefox 3.5 except there's a huge
bargain firefox 3.5 so does actually
work they fixed it as far as I've seen
and it's in the beta but it hasn't made
it into the the actual release version
so I'm just going to show you it offline
applications in Safari what it gives us
is this application cache so kind of in
a way when I e4 had offline mode we've
now got it today no 6 years 7 years 8
years later and but it just creates an
offline mode basically you've got events
like offline and online that will
trigger when you pull out the connection
where you go down to
you know no reception and you have this
navigated offline property which in my
tests doesn't prove anything you can be
completely disconnected for the internet
and online or so true so I recommend not
relying on those just yet but the
offline online prob events do fire when
you kind of disconnect and so on so this
is a this is demo hack together of a
Rubik's Cube on my iPhone so if anyone
if you have an iPhone and you try and
navigate to a page when you don't have
any reception you don't get the page
tool nothing loads up you get the white
screen you're like crap i just wanted to
look at that piece of text think about
this the screenshot is that it's in
airplane mode so i can navigate that URL
and it will load it up because I've got
the offline applications enabled on this
web page so this looks like this you add
the the manifest attribute to your your
markup you point it to a file and inside
of that file you have this this line at
the top says cache manifest you include
the files that you want to to have as a
marked as offline available offline the
other thing is the file that's including
this manifest also gets included so you
know my apt I HTML has been included in
the manifest I've included the version
number at the bottom which I'll come on
to a second so the first line needs to
be manifest and you have to serve as
cash and manifest the version number
what that's for is if you if you touch
the phone so he changed the time stamp
on the file the browser won't go and get
it again it's only if you change the
contents of the file like the offline
assets can be updated you can delete
them and your your your web page will
still work and it'll still think they're
there and by changing it by being a
version number in there the contents of
the manifest spot changes the browser
then picks that up andrew lowes your
cash and there's also the application
cache which is like the api to kind of
get updates from that you can't you
can't clear out the cash through this
this api it does it when you call the
update it doesn't actually go off and
refresh the cache or anything like that
just it tells it notifies you there is
an
date you could force a reload of the
page but haven't quite worked out how
and still how to really reload the
counter properly I strongly strongly
strongly recommend if you use offline
apps add at last finish your application
then add the manifest afterwards because
because of this version versioning and
I'll show you the process that happens
behind the scenes you can get a real
mess as to what state your cash is in so
the process is and are you going to see
the background it sucks okay the browser
and makes the request it goes off to the
server and the server serves up all the
contents for that web page to the image
and so on the browser says ah i see a
manifest file so it tells the server i
want all that stuff again so the server
gives back the manifest assets so i
don't know why this like this double hit
I don't understand being able to work
out from the spec that it says you need
this double hit but that's what Safari
is doing at the moment the browser then
triggers this event say the the cash has
now been updated and and when you reload
the the browser it'll say I have a
manifest for this this this domain this
this your own so just request that
manifest file the server then goes yeah
that hasn't changed so I'm senior three
or four and the browser serves
everything locally so that's what's
happening on my iPhone when I visit that
offline version of that that Rubik's
Cube so it's accessing everything
locally so storage is the the first one
it was recently ripped out of the year
the html5 spec and yet it's basically
giant cookies because you know cookies
are for K storage is a lot bigger and as
far as I can tell there's no
documentation on how big well how big
the key value pair storage can be and so
key value pair is literally just like
cookies you set the key and you've got
value works in most of the browser's
SQLite only works in safari and again as
Deion's said there's kind of discussions
of asked whether SQR likes the right
thing storage is really really simple
you have these two objects once for once
called session storage which is the
window basis that you know that
bap tickle session so if you have been
in your window it doesn't apply anymore
and you've got local storage which is
attached to the domain and you just have
set item and get item and it just
retrieves them and set them and so on
the set item you can only set strings so
if you you can't pass in an object or
anything like that anything more
complicated but you could convert it to
Jason stick it in there or you know
Jason just get out and convert it back
out again so this is what it looks like
in safaris debugger again I don't know
if there's there may be a Firebug plugin
for firefox to actually inspect this
kind of stuff but I haven't seen ya
there's it's also quite difficult to
debug and get rid you've got you've got
this field here but in Firefox that I
can't see any way of getting rid of that
kind of stuff you can delete the offline
cash through the properties we can't
clear out this kind of stuff but you can
you can do the recession a storage door
clear and it will get rid of it for you
sorry I should go back that timestamp
field that's not a property that comes
with it this is just the time so I feel
that I added from this test page so the
spec for html5 recently changed with
regard to sqlite and whereas before they
were trying to create yet spec out a
SQLite they've just changed it and
pulled out the whole thing and said the
user agent should implement whatever
13.1 three point six point one and nine
whatever they is an SQLite SQL also when
it fails it'll pretty quietly as well if
it screws up there's something really
wrong there's error handlers see you can
post in kind of success handlers and
error handlers but when it screws up
like it just doesn't doesn't really tell
you about it so it's pretty hard to
debug when when you're messing around
with it this is what the syntax looks
like so you open your database um you
tell it what database you want to create
you give it version number so you can
actually increment your version numbers
this is the default table and you give
it a size that you want to play around
with
and I I suspect there's not a limit to
how big you can make your database I
think it's to make or something and this
is how it works so you you call this the
transaction and you get a call back with
the transaction object you run your SQL
against it it's all kind of cool back
base so you run your SQL and once that's
finished you were you get a call back
with the the result the escrow is pretty
pretty easy to run and and you can also
you've got a command line in Safari as
well that you can just you know type
your SQL and run it and see the result
and you can you can dip into the
database and the tables and look at the
fields and so on and yeah it's it's it's
pretty straightforward but again because
it's just text I don't see a particular
particularly big advantage over just
using key value pair unless you're doing
something much more complicated in terms
of kind of rational requests so
geolocation is also one of those cool
api's which you know everyone's kind of
going geo mad and and it works in
firefox out of the box and it kind of
works in the iphone the iphone has it
baked into as well this one looks like
on the iphone it prompts you to ask you
where whether or not you want to share
your location when my gps javascript is
trying to grab the location the same of
firefox there's like a bar across the
top that says do you want to share your
location do you always want to share
your location and so on and it doesn't
always work I was sat on the south coast
of England and it said I was in the
middle of London so the the important
thing about this is make sure you've got
some kind of fullback don't rely
entirely on geolocation as bait into the
browser make sure that i would suggest
kind of using it to try and sniff where
they are and then let them specifically
point where they are or say no i'm not
there that's that's complete rubbish the
api looks like this which again i
believe it's from straight out of kind
of the gears spec which damn can nod or
shake yeah yeah yes sort of so you do is
hanging off the navigator object
geolocation get current position of
success handler error handler and the
object that comes back has this chords
prop c which has the latitude longitude
and there's also the
accuracy which i think is the thing i
was ignoring when it said i was in the
middle of London so it tells you how
high or close you are to that about that
particular point and obviously on the
iPhone we're hitting me down exactly to
where I was sat it works very well
finally web workers and yeah again as
Dean said it's a threading for a
JavaScript and it can be native or via
gears and there was a hint of trying to
write like a hack version using set
timeouts I had a play myself and I got
so as far as completely breaking ie
because just hung but I can envisage
kind of hacks coming up that simulate
workers to let you try and still use the
the syntax the web work is a completely
sandbox environment so don't have access
to the window object or the document
object or any of the Dom it's got access
to things like the the xhr and the web
databases as well and you communicate
between your document and the worker and
back and forth through the messages
debugging I found when I was playing
with it early on I wasn't a hundred sure
how to debug stuff but you just go send
messages out I mean you may kind of
simulate the console log inside your
worker and spit messages out but the
communication is just plain text as well
so this is what a non worker would look
like so what I'm doing is doing that and
i'm looking for a prime number and i'm
running a canvas at the same time and I
got my spinning ball of death and this
is what workers would like when I've
kind of allowed this thread to to run
the number crunching so a few important
things for me is that the reflow is
happening just fine and so the canvas is
able to draw in the screen capture
software may have not caught every
single frame but the canvas is able to
draw I'm still able to select text and
it's able to read you all the numbers as
I'm spitting them back to the the
document inside of the worker you have
import scripts post message on message
and connect i'll show you some of our
syntax
so my main application creates this new
worker object and I give it the the URL
to the script now that needs to be on
the same domain as well and then I
connect the on message and like a hat
set up a handler and an event comes into
this and I've got event data is the
actual message that was sent to me I can
then post messages to my worker and
those are strings as well inside my
worker script and I can import other
libraries and I can have my own message
handler which the syntax is literally on
message I think you can do this to our
message but it's the exact same thing
and it captures the event and if you
want to get the the messages passed into
the worker you need to event or data and
that's the the actual content and then
the the data that sent back out again is
you use it post data sorry post message
and you know whatever text you have is
going to go back out the door you can't
send object is just plain text at the
moment and I remember if the plan is to
have objects that go out but firefox and
safari only support plaintext going in
and out so if you want to trigger a
function the way that I've been doing is
putting a prefix and you know searching
for a carrot and that's the function I
want to call and then I run a piece of
code according to what the worker just
told me to do and as he has a lot more
in html5 so this has just been a summary
I mean there's the sandbox spray iframes
makes a chart to there's progress events
in in the xhr object so you can tell how
how far along your upload or download
has happened the query selector API is
you know basically native CSS selectors
there's this I overlap in in html5 in
the spec as well which i think is really
exciting and drag and drop if anyone
read PP keys I reviewed drag and drop
that so that's definitely worth looking
at because it's a good laugh he
basically destroys the spec and lots of
other things and the documentation was a
little bit hard to find but because
they've now gone into last call it's
going to start syncing over 2 and the
w3c documentation to what what WG to org
slash html5 is the complete spec there's
also a kind of pad
version and the what WG complete I've
just created a shortcut this is a
version of respect that includes all of
the specs of being ripped out there's a
if you if you're kind of looking for
something that suddenly disappeared from
the spec if you go to dev w3 org slash
html5 there's a directory of different
kind of things that being ripped out of
other specs there's a nice place to kind
of go and have a look for stuff that's
missing and equally the the IRC channel
is quite handy if you you're playing
around with brand new code that you have
no idea what isn't working things like
the offline and offline manifest I
couldn't work out why I couldn't get it
to refresh so if you jump on the IRC
channel there's only a few guys on there
but they do come back and ask you a
question I mean leave it a few minutes
and they've but they will go back to you
so that's my overview and that's my
geocities version of a closing page and
so if anyone has any questions I'll be
happy to take him if I have time
otherwise lunch
any questions yeah
so html5 is on me it'sit's just so the
question is html5 is currently being
proposed CSS 2.1 spec isn't isn't a
final recommendation it is but we will
use it yeah it's pretty well baked into
the browser's the browser's are adding
support pretty quickly and you know
mobile devices are adding support pretty
quickly and the spec has gone to last
call which means that they're not really
making more changes but it's down to the
browser's I mean html5 is is you know
it's a validation it's just validation
and I can use all the technology I don't
have to make it an html5 validated
document I can use content editable or i
can use drag-and-drop it's in the
browser ready and one of the key and key
managers of html5 is there count they're
paving the cow paths so the technology
already I mean a lot of these technology
already exists inside of the browser and
they've spect it out so all the other
browsers can standardize against that
and so a lot of it isn't it content
editable was an example of a you know on
flickr when you click and you can change
the title content editors will give you
that but it's been around for such a
long time that it's actually in all the
browsers and because they've documented
it now that it's it's there and i think
it's got pretty good support in IE which
is you know surprising oh but they came
up with out so you know they should be
anyone else cool lunch yeah
thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>