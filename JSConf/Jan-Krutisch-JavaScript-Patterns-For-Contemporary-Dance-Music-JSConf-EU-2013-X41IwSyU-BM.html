<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Jan Krutisch: JavaScript Patterns For Contemporary Dance Music -- JSConf EU 2013 | Coder Coacher - Coaching Coders</title><meta content="Jan Krutisch: JavaScript Patterns For Contemporary Dance Music -- JSConf EU 2013 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Jan Krutisch: JavaScript Patterns For Contemporary Dance Music -- JSConf EU 2013</b></h2><h5 class="post__date">2013-10-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/X41IwSyU-BM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">music
thank you very much so music as I said
how many of you in here would consider
themselves to be musicians in some way
well quite a lot of hands I expected
your hand to go up pull great so how
many of you actively play an instrument
on a regular basis so it should be you
know they're a little more a few more
hands there because you know I I don't
consider myself a musician somehow not
properly trained and all but usually
when I speak to a crowd like this there
are an astonishing number of hands going
up and you'reyou're not an exception
here and I find this kind of interesting
because I think playing music and and
programming computers somehow goes well
together I I still didn't figure it out
completely but you know sometimes a job
is very stressing and music can be very
relaxing and on the other hand a lot of
music is based on mathematics and we
usually like mathematics and stuff like
that so it goes well together I think
now with myself sorry my my I have a
little coat here my voice might be
failing so I'm going to play a bit more
music later on but I don't have to talk
so myself I started learning to play the
flute in elementary school who shares
this yeah and I hated it I hated it I
really hated it and so as soon as I
could quit this I quit it and I've never
started to learn an instrument again
it's it's just I I cannot tell you how
much I hated it and I I basically so
this is I have probably noted it wrong
but this is the the tune and the fourth
in the way of what you say fourth year
in school we had to play our best flute
tune we were able to do thank you and
that was one I learned in first grade
and I
just because I was so fed up with this
so anyway so I stopped doing music at
all for a few years and then I somehow
got back into it and the reason was that
I got my first home computer which was
of course looking at my age of c64 who
else had a c64 just a few hands how many
of you are actually born in the 70s this
kind of interesting information yeah
getting old and so we had this
awesome magazine in Germany called feein
zeiss tiga magazine who remembers that
okay a few hands and you know that back
in the days so when you found computer
listings and computer magazines that
were actually not there to tell the
point or something but for you to type
into your computer to get new programs
that was the main way of distributing
software like printing listings than
magazine let that sink in for a minute
if you're born in the 90s so this
magazine even had their own program that
enabled you to input binary data so they
have this program where you would type
in large columns of of hex numbers with
checksums to input a program that was
not written in basic so you couldn't
really type it into the computer easily
and I did that with one program because
I really really wanted to have this
program and it took me about two weeks
to type in this several page long hex
listing and the program was called sound
monitor or anyone remember that I
thought so it was written by a gentleman
called Chris Hills back does that name
ring a bell for anyone okay I thought so
so if you have never heard that name he
is the guy who wrote the soundtrack for
games like great giant assisters you've
probably heard didn't hear of that
either taarakian have you heard of that
well yeah I don't know he was pretty
popular at that time and what
the first freely available software to
do proper music on the c64 where you can
basically do everything with the
hardware that the hardware's actually
able to do and the hardware the sound
hardware and the c64 was a three voice
analog synthesizer with filters in all
and that's that's the most amazing sound
source you can have in the 90's in the
80s and so I started making music with
this tool and then I later on I got an
Amiga so I'm that type of guy not an
Atari which would be the better choice
probably for making music but this Amiga
had for digital voices and you could do
all some stuff with it and it was this
free software called pro tracker and the
interface to put in music looks like
this and it's it's basically columns of
numbers and sound monitor was a very
very thinly disguised machine monitor
with some some yeah basic ways to input
notes and it looked a little like this
and pro tracker just improved a little
bit in that it had buttons you could
actually click with the mouse to do
certain things but apart from that it's
it's just writing down numbers to make
music and I did that throughout the
whole 90s into the 2000s and made a lot
of music with that and it's yeah it's
you can see notes there and octaves and
you can see the sample number it should
play and then there are three columns to
do effects on top of that and then
there's the next column and you had four
tracks of these and very very basic way
to input sound and at some point I
thought well this is this actually looks
an awful lot like programming you know
it's it's just typing in stuff to
instruct the computer to do something
and wouldn't it be awesome to just write
code to make music and I wasn't the only
one to think that and so somewhere
around I would say mid 90s maybe I don't
know the exact history of this people
started building life coding
environments for music and I
I looked at a few of them and probably
the the emergence of these tool came
together with the emergence of being
able to calculate sounds in real time on
a computer that wasn't possible before
the mid-90s something like that so you
could do music without having any
external hardware that was unthinkable
at that time and suddenly we could do it
and then it makes an awful lot of sense
to to try to do live coding with it one
of the best-known
live coding tools for the Mac is
impromptu it's based on scheme and then
there's a thing called supercollider if
you're interested in this type of stuff
please take a look at it supercollider
is super awesome and super complicated
and really hard to get into and then
there's this other thing and I forgot to
look up the name and I could beat myself
up for it which is based on closure so
another list dialect and it's written on
top of supercollider does anyone know
the name and could shout it to me that
was my chance so overtone right
it's called overtone thank you very much
he googled it great you're my you're my
Google assistant from now on thank you
very much so when I when I in this
February had the chance to to play a
live gig with two other gentlemen were
playing accordion and electric bass at a
post conference event at the Google
campus in Tel Aviv I thought oh maybe
it's time to come up with something that
allows live coding in the browser and so
I came up with this very very basic
system it's not a lot of code actually
it's on github and going to show you
some music
so the thing with live coding music is
that it takes a lot of time and I
thought I could probably do it from
scratch for you turns out I'm not
unnerve Asst enough to do that so I'm
going to I'm going to show you a bit
what what this is doing so the thing
about live coding is and and using
something like JavaScript for doing this
is that you can actually use code to
produce stuff obviously and so this you
can take an array and then feed it into
something else and art is just a small
extraction I wrote to to build an
appreciator if that rings a bell and it
sounds like this and what this what this
does here is so spread strength is just
another abstraction that does takes a
few oscillators puts it into a few
filters and there's the thing about
coding against the Web Audio API I've
ever done that the code is really
verbose and it's really hard to to cut
it down so it's it's procedural code to
set up stuff it's yeah it's almost
declarative more or less and so it's
really good if you're doing live coding
to abstract it away in things that are a
little easier on on the eye and on the
on the fingers so I'm going to start
this again and just improvise a little
bit on this
thank you for the applause and the cool
thing again it's it's you know it's cold
and mathematic so what about if I mess
this up a little bit and it's like much
more interesting you know I I like
techno but
that won't work
so finally my hands are in a state where
it can actually type things it's good
it's good so let's talk a little bit or
let me talk a little bit about the
technology behind this so this is
pattern based music and this is very you
know at since since Roland
built these awesome drum machines called
808 and 909 this has been like the modus
operandi fo for electronic electronic
music at least in the drum section and
so this is a very simple drum pattern
and the characteristics of this is that
you have slots in time we can attach
events to and usually the events is
trigger a sample or trigger a note or
something and so this is one thing you
you have to do when you want to build a
system like this you have to have a
possibilities to schedule events at
certain times and the Web Audio API is
pretty good at that so that's that's
kind of cool
now usually music can be a lot more
interesting than that by varying things
in between and you know this could this
could be everything you know this this
is a not a sine wave this is something I
came up with last late night I guess so
it's it's a modulation of some kind of
parameter it could be a filter frequency
it could be the frequency of a note or
something but the the the most important
part here is that you want to vary
things over the boundaries of these
pattern slots so they need there needs
to be a way to schedule not only events
at certain times but also changes over
time and luckily the Web Audio API has
have it has covered so this is my very
scientific diagram of how stuff in the
Web Audio API works and I've now
realized that probably you can't read
the names of the methods I wrote down
there too bad so if you how many of you
have seen the tour from yon at bluejack
jeaious
on Thursday so a few so there there is
this idea that the the audio context
which is the the basic object from which
you construct all the objects in the Web
Audio API has this idea of its own time
context and you can always ask it what
time it is
that's pretty kind of good what time is
is its I don't know 5 SEC's then 5
seconds and 50 milliseconds since I've
been started and this is current time so
it's an attribute you can just read out
and it gives you the current time now
with this you can actually start
scheduling things in the future because
now you know ok this is now and I want
to start something in 2 seconds and I
just take current time and add two
seconds to it and it's floating-point
mathematics so in theory it should get
really really imprecise after a long
time and I've seen box on browser bark
trackers that actually try to deal with
this because it's kind of hairy so if
you let it run for two hours and it get
gets off by more than 20 milliseconds or
so the beat starts to crumble and that's
not good and now if you want to start a
sound and stop a sound you can do so by
just saying okay current time plus X and
that's the top one so you have a start
and a stop event now if you want to
change parameters most of the parameters
in the Web Audio API as what what's
called an audio param element audio
param class which is kind of cool
because it allows you to schedule not
only events but also changes into the
future and so there is if you say dot
value you've probably seen me typing
that once it just sets the value
immediately if you say set value at time
that's a that's a method call then you
can say okay I want this value to be X
at time Z Y and that's the and it the
the idea is that it changes the value in
a way that the audio doesn't click so it
will not change it immediately like from
one
to 0 but from 1 to 0 in like a few
milliseconds and that's kind of nice
because you don't have to worry about
that and then you have also the
possibility to say okay I want this
value to gradually change over time and
there are linear changes so linear ramp
to value at time that's a pretty great
method name if you ask me and
exponential ramp to value at time and
then there are a few others that allow
you to to Eve be even more creative with
these things and the exponential one is
extremely interesting because in music
you always you often deal with values
like frequencies or so where it makes a
lot of sense to not linearly interpolate
but do it exponentially so that's kind
of very cool to have and with this you
can actually do best of both worlds so
you can schedule events on precise
timings and then change values over time
and everything you've heard like the
small filter phase at the start of a
note that is basically me scheduling
filter changes over time and that's all
happening in my abstractions and and
they are quite easy to handle now
there's a problem if you want to
actually make music and change
parameters over time in real time let's
say you have this controller and you
want to change things with knobs then
you suddenly have a problem of well I've
just I can schedule things in the future
but what do I do with these button
thingies here and or with with knobs or
with sliders or whatever and it that's
actually a problem that is not very easy
to solve for reasons that are quite
complex trying to explain them anyway so
there are basically two categories of
categories of notes in the Web Audio API
one is the generator part which are
disposable so you start the sound you
stop a sound and the object is basically
gone or can be can be thrown away
because it cannot start it again it's
not it's not
usable and the problem with that is if I
want to attach a value in real time to
it I have to reattach it every time I
create a new object and this can be
quite complicated and then there's this
other category like filters or effects
that can actually exist for a very long
time and there it's not so much of a
problem because you have that one object
you can talk to at all time and I really
didn't solve this problem very good
so I to show you that it's it's
basically possible to do that I have a
last example that will hopefully show a
few of these things better so again I
don't start from scratch because I don't
want to bore you to for too long here so
you've heard that before
and the clap snare you're hearing there
is actually playing through a reverb
filter and this this filter has a an
attribute called mix and I I'm going to
try and attach something to it and I
hope this works
so this is a leap motion and there's
this javascript library that allows you
to do leap motion stuff in the browser
and I've just attached it so this this
method looks quite complicated but
that's just because I have to kind of
reverse the object graph of this frame
that comes from the sensor and I need to
do it in a way that doesn't crash if the
object is actually not there so that's
the best thing I came up with now let's
turn it into music
thank you very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>