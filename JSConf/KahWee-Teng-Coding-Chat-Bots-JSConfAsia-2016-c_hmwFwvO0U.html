<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>KahWee Teng: Coding Chat Bots - JSConf.Asia 2016 | Coder Coacher - Coaching Coders</title><meta content="KahWee Teng: Coding Chat Bots - JSConf.Asia 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>KahWee Teng: Coding Chat Bots - JSConf.Asia 2016</b></h2><h5 class="post__date">2016-12-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/c_hmwFwvO0U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks Justine and organized this today
I'm gonna talk about coding chatbots in
no js' so show of hands how many people
here build a chat bought before I can't
see very well but I do see a few hands
in front anybody is planning to build a
chat board okay a fear okay so this are
my lessons learned while I was trying to
build a chat board and hi my name is
khari
and I'm a JavaScript developer for the
past five years and work for tremor Vito
San Francisco which is an via video
advertising company and I work on nodejs
tools to recompile animate CC outputs
into JavaScript interactive
advertisements and I also am responsible
for the web USG chat bot so you could
try you could try talking to reboot SG
and just ask something like what are the
upcoming events and you you know that's
how I got started into chat BOTS and I
got started when Facebook just released
the Facebook ape messaging API and
Suhani who worked on reboot SG shared
with me her interest in trying to build
a chat bot for we boot and that's how I
got started you know I wanted to explore
Facebook messaging and she had
conveniently got a really good API which
if you haven't already checked out you
should it's a local community event
finder and that she on also mentioned
yesterday so I also like sushi yay yay
for sushi so what is the chat board
so a chat bar is designed to perform
tasks via chat user interface that
typically is texts enable
an example of tech symbol enabled chat
bot would be Facebook Messenger and
slack there are some voice enabled ones
such as cantana
and Amazon echo and but to me I see them
as personal assistants that perform one
or two thousand credibly well under the
given constraints so why then should you
build a chat board it reduces the
proximity between customers and
businesses these days we are noticing a
trend that business are trying to get as
close as possible using technology an
example of this would be that kya is
using the Apple watch a device that is
on your risk to surface our trip
information and you can also ask Alexa
to order an uber now and you can say
something like Alexa a scoobert to
request an uberx to Amazon echo and it
does this task that is under this
constraint is really really well and of
course there's some you can also order a
pizza you can all a Domino's Pizza with
facebook Messenger and you know so today
businesses are competing on customer
attention span over other businesses so
comScore found out that the average
Americans devote half the app time to a
single app and on a separate study you
have Manasseh buret study by business
intelligence you have messaging app
surpassing social networks in terms of
active users and chat BOTS works as
customers already in the messaging
applications themselves so for you guys
who a lot of you guys might be using
something like Facebook Messenger or
you're using cake you already have the
app on and now it's encroaching into
your personal space so which is not so
good but also good for businesses chat
BOTS are yet another way to get to your
customers so today we are going to talk
about three things and instead of me
telling you how to code a facebook
Messenger app or kik messenger or you
know using Skype I'm gonna tell you my
experience in going through coding a
chat bot and number one I'm gonna tell
you how is it like honest
the receiving messaging from the chat
services meaning how to integrate with
chat services and then also talking
about how every chat services have a
slightly differing API so how to exploit
it and how to learn more about it second
is to comprehend the users input you
need to figure out what the user is
trying what the intention is and number
three is responding to the user so first
is to figure out the integration part
your go-to thing is to read the
documentation which tend to you know be
a bit confusing sometimes what I did is
to start by using request actually
request bin so if you go to this URL
that's how I learned how to start doing
slacks outgoing web hook and you can see
that in slack you have this thing where
you can feel in an URL if you go to
request being you just click you
generate a new session you will be able
to fill it in and if you do a chat like
Jas come fascia is really cool which we
all know is true you'll be able to see
that what request being actually get
from from slack and in this case you'll
be able to build your app this way bit
by bit because now you understand what
are the inputs and what is the potential
output that you have to do and most of
the documentation they stress a lot on
what is what you should send the server
it doesn't stress enough what you're
receiving from the server so you don't
get to see what exactly is the server
sending to you and this is this is a
great way and the next example is a
Facebook messengers web who same you can
get to the callback URL and you can see
that again I feel in the request being
and it will initiate a subscription and
in this case you see that it gets
there's a hop challenge and then there's
a hot mode and that's how you you learn
their API and when you do a send on
hello how are you doing today you see
that right at the bottom it's a little
small but you can see the
you you get the Java the JSON payload
that sends back and you format it nicely
you'll see you get the sender you got
the recipient the times them and also
the text of course so next I'm going to
show you how do you do local development
with using local tano and no demon and
so local tano is lets you test and
develop things locally and the
exposes.the your IP address actually
does a reverse proxy kind of thing and a
last Facebook to be able to reach you
through a public IP address and in this
case you also can use no daemon which
I'm not sure if you familiar this but it
just restarts each time you change and
we're going to do a live demo which I'm
very nervous about so here goes nothing
and so
so we start already installed this local
tunnel so I have I have my app running
so I'm going to close in and I rerun my
app and so this is actually the web hope
that is going to be that connecting let
me get my orientation right little
confused with this so in this case if
you are if you want to follow you can
download this demo that I will give the
link to later and then I will use local
tunnel to expose this Airport eight nine
five five I'm going to copy this URL
make sure it works
so this is already an external URL that
Facebook can reach is already got HTTPS
and it will hit my local computer in
this case you go to your web hook
subscription if you have familiar
fixboot
as how you can change the URL here and
you change the URL right here to this
new one and my verify token is 2016 to
verify and safe and so after which you
can go here and you can say hi and you
should be able to get deeper information
that is here so you can also do things
like hello and I wrote this to call
wrong car so that it can show you things
like the your typing and then you can
send Chiefs as well so for more
information you can check out the source
code that I have so I'm showing you is
how you can do debugging and then the
next is to comprehend the users input
and let's start by imagining that we are
going to have a doctor's application
where you do like a book and appointment
tomorrow at 4:00 p.m. and using this
example you first have to discover what
the intent is in our app we are going to
have two main functions one it's going
to be get appointments and the other one
being book appointments where it accepts
a date and time so how you figure get
appointment sorry how do you figure out
book and appointment as an intention and
you know the simplest way is really just
to use red X right so incredibly naive
but works really well so you could try a
book an appointment tomorrow at 4:00
p.m. that works that's the red X but
what if you want to do a like book
appointment and you know you do you need
to change your red X to be more flexible
and what if people want
an appointment that's fine too this red
X book and what about people wanting
reserved my appointment you can keep
adding reg access and through this you
are determining the intention of the
user so I'm just gonna skip through this
and you can so now that you determine
the intention of the user which is
booked an appointment tomorrow at 4:00
p.m. you know that we need to use booked
appointment where for that date and a
time and so now it's really about
extracting out tomorrow at 4:00 p.m. so
how do we get the parameter tomorrow at
4:00 p.m. and reg X isn't very
straightforward anymore because there's
you can people can say something like a
book an appointment next Saturday at 3
p.m. and you it you know things get
really complicated so that there's a
package for that and you can use simple
NLP tools ok and there is this component
of NLP if you guys are familiar with it
it's called the parts of speech tagger
and some people use Python and there is
this really good library called NLT Kay
in Python but in order GS we that there
is a few libraries like natural and one
of the easier to use one I found was an
RP compromise which itself is a
compromise because it doesn't give the
full set of NLP tools for you to it's
kind of like good enough is good enough
thing and a parts of speech tagger is a
piece of software that reads the text
and the science parts of speech to each
word and other tokens based on both its
definition its context that is its
relationship with Jason and related was
in a phrase sentence or paragraph so it
sounds a little complicated so I'm going
to break it down for you in like
preschool English and we shall start a
phrase like I have a pen and I have a
pen it's a really popular song and you
can pass iron I have a pen with NLP
compromise and this is how you do it you
can you have to require the NLP comp
package I made a mistake there is
actually enough IDI underscore
compromise get a sentence and you can
pass through the terms and you can log
out to see what kind of term it is and
the first you get I I is a pro now so
that's not what we want
you get half which is an infinitive
infinitive vote and you get earth which
is an article and already determiner and
also a pen so in this case you you get
to see like the first one is a pro now
the second one is a verb then an article
then they a now so you kind of get the
gist of it and what if we want to push
it even more and we want to get things
like in emoji and we have a library for
that too and it's all in MPM and so
again i have an apple and an apple is
not something that is supported by an LP
compromise so you get a little question
mark and so when it couldn't find
anything that seems to be representable
in this little database it will assign a
question mark because it doesn't know
what to do so we passed it on to an
emoji tagger instead and what there is a
library called game OG I think it might
be github emoji not really sure so what
it does is it passed the Unicode correct
us if you pass in an apple it tells you
the description being a rate Apple right
and then you can you can then do complex
things like detecting what exactly the
emoji means and so going to do live demo
again probably bad idea
so if you type I have a pan in here it's
going to give you you have a pen
so that's right and what about in emoji
so so I say I have an apple and it tells
me that you have a great apple so there
are a few things to notice here firstly
it knows that it is already PO and it's
not a great apple because the the NLP
compromise has is able to detect what
sort of article should follow a soup
procedure now and if you try things like
if you make mistakes that you decide to
choose I have a cow it's able to fix it
for you by saying that you have an ox
because their stocks emoji and so what
you can do a lot of things by this
because you're you're reading the user
input and they tell me what the user is
trying to tell you including things like
emoji and there's a lot of passing
involved but it works okay so now for
the real thing right so initial passing
we do any show pass with an LP
compromise and we pass book an
appointment tomorrow at 4 p.m. and this
is how it's going to be like it's good I
bought it mistakenly thought that it
wasn't now because book is also it now
it's not really smart but a book and
appointment
and notice that it grabs you tomorrow at
4 p.m. as a complete as part of an item
as as a term right so in this case you
see that the text is tomorrow at 4 p.m.
and the tech is date unfortunately NOP
compromise isn't smart enough to figure
out things like what sort of data so it
couldn't get the year couldn't guess the
month and the day but not to worry we
have another package for it and you can
pass through this call a true chrono
note and you'll be able to receive
tomorrow at 4 p.m. and you will get the
date and the time
and then you can even do with more
interesting things that figure out the
date and time based on between something
to something so you can say February
23rd too much second and you'll be able
to get to different data and time so
with this you can complete your doctor's
appointment app and so can do much more
complicated things like book and
appointment for next Sunday 4:00 p.m. so
it will tell you this actually tells you
the day so if he goes that next Sunday
is actually referring to November 27th
and I use moment to format it with the
time zone okay so so the next is about
responding to the user and the general
rules of thumb is that you need to be
succinct and you need to be friendly
respect the medium which is in this case
in my previous case was Facebook and
also you need to figure out how to
handle the arrows if there are any and
try to give the simplest and clearest
answers are the best for the user and
that's because the mobile messaging are
typically limited by space and you
wouldn't want to return a whole bunch of
text and they had to scroll and scroll
to figure out where they have to read
the shorter the ball responses are the
better and remember the emojis are also
valid responses so if you could use
things like you're thinking use things a
take a few more personal to the user and
at the same time it saves a lot of space
as well so the next is to be friendly
use pronouns like I on you so so
disclaimer first this might work for
things like Facebook messenger it might
work for kick it might not necessarily
work for slap if you want things to be
more formal and so if you most of the
boss in
Facebook if you tried chatting with them
when you say hi they will say back hi to
you sometimes they wave back at you and
it's okay to say things like you don't
understand the input or you know you can
say sorry I don't understand and you
give them a suggestion of what sort of
inputs you can give and try to use
active instead of passive voice for
example your flight has been booked is
not as good as I booked your flight
because the reason being chat in
facebook is a lot more personal so
people that is the way people talk and
lastly you know be humble so that people
won't get frustrated and some of this
humans are smart enough to figure out
the parameters it needs to fit the chat
bot interface and if you try to build
something there is entirely conversation
in this case if you check out some of
the apps you can actually do a really
conversational things like say hi how do
you do and is able to respond fine thank
you you effectively you put the bow of
your app incredibly high because now
your your users are thinking that wow
this is a really small app so I can chat
with it so if you if you just make it
you manage expectation and you set it to
be straightforward whereby you just give
a very structured command it helps so
it's okay and respect the medium so
notice what sort of responses there can
be for example facebook Messenger
supports text emoji locations and
buttons and you can format things using
under stall screen and you can get
sentences so try to make sure you use
things don't make don't make the text
too long and you cannot be able to the
user have to scroll and that wouldn't be
too nice and if you look at slack this
is G fie and slit allows you to find
different gifs that you can share on
your enterprise chat board something
that my company my co-workers and I do a
lot and read the respective
documentation is
what sort of things are available so for
slack it has this little button where
you can click view more and you'll
refresh things that are there and so
this does not apply to say the Skype
using the face and Skype has something
that is similar but it's not quite the
same as this so next is to respect the
medium poncho actually has a send
location button so users can tap on it
to send a location and poncho is a
weather an able app so it can tell you
every single day whether you need to
wear poncho where you need to bring an
umbrella and stuff and for whip USG we
use generic templates and facebook
Messenger so in this case you can see
that there are buttons where you can
click and this is entirely only it's
something that is very Facebook specific
and it's really trying to exploit the
API and you can use ron-karr which is an
app that I wrote this is a library that
I wrote so what it does is it allows you
to write like send text and it gives you
the ellipses and you can't wait for
3,000 milliseconds to send the next one
and you can do simple things like
sending imagers there are a lot of
libraries out there and the odd differ
in the expressivity of the API and I
want to do something like being able to
do something like what a to express what
a human could have done and lastly is to
handle errors so you know we need to
make sure that so always test for
negative scenarios so more often than
not we we always expect that the API
that we are connecting to will always
give a positive result
make sure you have another negative use
case as well so that's so I'm going to
go through like the the problems I faced
when building blocks choosing what to
view is actually pretty hard your
business functions can be represented in
so many ways of the raw and not every
part of the business makes sense to
develop into a chatbot and if the more
so the next is you are encroaching the
personal space such as phase
messenger meaning that their friends are
there the last thing you ever want to do
is you you tell them more than their
friends tell them and they will just
delete your app and if you're more
spammy than the other BOTS people won't
like it too and if you try to become
more conversation or just make sure that
there are real human beings they are
also using the messaging app they try
and chat with their friends so if you
were to do that you set the bar very
high and lastly every chat messenger
messaging system is a medium with
special characteristic hence they have
different api's and if you support more
than one chat system you might want to
build things like micro services to
connect to and so instead of having one
app there just saw facebook Messenger
you have a facebook messenger interface
you have a pic messenger in the face
slight interface and they all connect to
a central micro service that is able to
figure out the responses there is
appropriate so just to touch on
conversation and structure text for
conversational text is less predictable
and potentially it's more open-ended and
it requires complex rules based system
or machine learning capabilities so my
recommendation is that if you cannot do
that you should not try to do that
there's this app that is really well
done called human in Jesse's story and
if you can see the dialogue you know it
tries to be very conversational I'm the
blue by the way I have not the de crayon
and if you you can say hey Jesse and is
is able to pull off a pretty decent
conversation with you and I realized
that it's is one of those it's like a
very it's like a little go
so I reply back with what I think a
little girl would have replied okay so
on on that note structured text is more
predictable hence it's is with limited
functionality but you get to control a
lot more so we built SG is an example of
a structure chat bot so it's built by me
and the web us G API and you can try
asking about upcoming events and he only
tells you that
and he also tells you things like you
can check the latest repository it tells
you about podcast by the specific things
then it knows what to do
it doesn't do more than more than just
three functions essentially so lastly
sometimes coding by yourself is not
necessarily the right solution depending
on the scope sometimes you might find
that Bob building platforms that does
things with machine learning is much
better choice and you might want to
outsource your entire bar building your
entire board and so you have bought
building services like octane API - AI I
know this my phone is vibrating a lot I
think everybody is sending messages to
repute ok key reply and push ring and if
you want to look into machine learning
and NLP services you can check out Lois
story I which is by Microsoft I believe
we thought a inap either a I one of them
is bought by Facebook or con remember
which okay so that that's all special
thanks to Spencer Kelly who is the
author of NLP compromise
he's been very responsive and he helped
me a lot Spencer Young who does key
reply and Jenn shoe and Suhani both of
them tried by bought and gave me a lot
of remarks on how well it works and how
well it how it didn't and I put most of
my source code online so you can test it
up and that is all so thank you
you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>