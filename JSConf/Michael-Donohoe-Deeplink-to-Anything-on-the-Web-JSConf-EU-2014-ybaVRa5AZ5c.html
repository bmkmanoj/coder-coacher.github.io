<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Michael Donohoe: Deep-link to Anything on the Web | JSConf EU 2014 | Coder Coacher - Coaching Coders</title><meta content="Michael Donohoe: Deep-link to Anything on the Web | JSConf EU 2014 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Michael Donohoe: Deep-link to Anything on the Web | JSConf EU 2014</b></h2><h5 class="post__date">2014-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ybaVRa5AZ5c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good afternoon the the less serious Tyla
for this talk is just linking to
anything in particular in the web but as
Jed said my focus will be specifically
probably around text content some of
this is more applicable to that you you
can go into iframes and images and all
these other assets as well but as you
said my focus has been on more the
journalism side from blog posts to
long-form articles and just while I'm
here I've tried to adding some element
of German to my slides and failed
miserably so you may see some of the
workings of Google Translate at work
here I I feel gratified that I'm in a
country where the population speaks my
language so well and I feel terrible
that I do not have a word of German I
had tried to actually brush up on a
little bit before getting here but life
work anyway so good to be here as you
said I've worked out a few journalism
companies for probably like almost 12
years in total I'm currently at The New
Yorker I started there six months ago
I've been working on the redesign prior
to that I was part of the team that
conceived and built quartz which is a
American business focused new startup
and prior to that the New York Times
were worked on front end CMS platform
and it was at the New York Times
actually that I kind of stumbled upon
this problem that we were trying to
figure out the type of that was at it
today is about links links are like
these amazing tenth intangible things
for the web they bind everything
together
they are pretty much everything you know
everything we've built today kind of
goes back in some shape or form to being
able to move from one document
seamlessly to another but within links
it would be
it's kind of like the DNA like if you
ever see a good descriptive link that is
a thing of beauty like something that
not only is unique and defines its place
on the web but also has meaning in
itself in terms of readability and not
necessarily as an SEO kind of kick which
is a side benefit it's something that is
you know definition and context is a big
win and so that was one of the things
that I kind of really liked about it but
that would only get you so far
the problem I'm trying to solve or at
least it's a solved problem I guess but
kind of build upon is actually linking
within the document so you get to the
page what next and there is a question
of doing that in a very reliable way so
right now you know people are probably
saying that we actually have that
solution it's anchor tags or URL
fragments or whatever you want to call
them but if you actually take a look at
that landscape you'll probably find like
that there's not actually many anchor
tags out there in terms of light being
used reliably being used consistently
most of the anchor tags that I've seen
that are trying to reference in line
within the document are usually there
because they are actually overloading
that with Jack with jQuery to do
something else and they just wanted
something to fill it and you're kind of
wondering why is the page jumping back
up when I click this the other problem
that we have with adding the the URL
fragments within URLs is that it's a
very manual process people generally
don't want to do manual things from my
position it's hard enough to get
journalists and writers to moderate
comments on their own articles and posts
but having them to actually go in and
find kind of even to understand markup
half the time you'll have a CMS or a
system that will not expose them to
markup so they actually can't go in here
and do it and you know ultimately like
if it is a manual process and you're
actually trying to name things well you
know I'd be better off trying to explain
cache and validation to a writer than
actually dealing with anchor tags so
there is there is a few things that you
can do like you can just adopt a
sequential numbering pattern you can you
know but again people just won't do it
and you also have to have like
people are usually abstracted on a CMS
level and if they're already kind of
like handcrafting their own webpages
then they're not typically to use k7
trying to cater to within a CMS though
you you do actually have the ability to
generate these and I'm going to get to
like what you can do once you generate
them by the way to generate them in a
kind of a structured manner but then the
problem that we're trying to solve is
that many writers will their work will
change if you have a long-form article
even with the New York Times we didn't
actually change the articles very much
it was only if there was a known error
or a correction but every now and again
between like that you know the time that
it was actually published to ten minutes
sometimes there was a window where
things would change dramatically
paragraphs would move up sentences would
be flipped things would be moved around
something would be rephrased and it
didn't happen often they don't want to
do that once things are published but it
did happen from time to time it was an
edge case that we had to cater for the
worst thing you can do is have it's a
deep link to a paragraph and you're when
you're linking to that paragraph let's
say you're doing that out with a purpose
you're saying that there's something
here that's important and if you're
landing somewhere else that's a problem
so how do you do that without digging
into a CMS where you have to track and
manage like all these dynamically
generated keys that map up to content
which could be in flux the content that
is changing it's a very hard thing to
describe and it's kind of like leads to
a lot of really crazy situations within
the CMS where you are syncing keys you
are trying to match them up you're
parsing markup within within let's say
something like Drupal or WordPress it's
not something actually we would like to
do so you take JavaScript and you
reinvent or reimagine what is already
technically a solved problem and what we
were doing here is coming up with
there's a few approaches we can take and
the steps to it is you need something
you need to be able to generate key off
content that can change you need that
key to be unique you need that key to be
tolerant so that if the context of the
paragraph or the again on this using
paragraph is an example if that changes
and the key changes do you lose that
kind of pairing
and with intolerance again peace can be
updated it can be corrected sentences or
sometimes rearranged you know human
error it plays a part you also don't
want a system which is tied to a back
end where if you do make changes and
things get out of sync and you have to
manually go in and kind of like jiggle
these things around so they match up
again and so the other thing you have to
accept being the web where things are
not pixel perfect you need something
that will cover 90% of cases there is an
acceptable margin of error here and no
one expects it to to get it right all
the time but when you fail you need to
fail back to the original URL now you
still need to be able to deliver the
person at the correct destination even
if it's not necessarily within the page
so there's a couple of methods and
actually is like five or six different
pretty detailed methods that I'm just
gonna dig into two of them and the first
one being the one that I would recommend
we created a system called not called
anything such dynamic unique keys where
you you take a piece of text you
generate keys from it by the first three
words of the first sentence in the last
sentence last sentence and first
sentence sometimes they're the same
sentence if a paragraph is just one and
from that you use that to uniquely
identifying kind of tag the paragraph
and it actually worked remarkably well
so that when you actually use that as an
identify err and you actually kind of
build in something like a you measure
the distance between keys you can
actually end up with something that is
kind of robust so for example with that
URL you could actually throw in multiple
different keys with different variations
and it would still successfully match
against the original key and the way
that we did this was actually measuring
the the difference between the two of
them I cannot pronounce this word I
don't know if most people here probably
can do you ever have it where you read a
book where there's some magical
character that has a name and you only
say it inside your head and then someone
else verbalizes it and it doesn't match
kind of got that thing going here
essentially we use this function to in
JavaScript to pretty much match keys so
if you generate a key of a paragraph
and if you you you cut off one of the
sentences or you change how one of them
begins if you change anything in the
middle its agnostic to that kind of
change and it will still pair against
the correct key and you don't have to do
anything on the back end you can do
everything on the front end essentially
you don't even add overhead to the page
because the page won't even try and
generate these keys unless it found
something in the URL that I could use
that's just a kind of recap so yeah
though the flow would be if you hit the
page you provide a link with this key in
it at that point and then it inspects
the page generates keys looks for the
match by splitting the key and kind of
like saying well do I match this or this
and what's the level of difference and
typically we found out in like we ran
this for several hundred articles with
several well about ten to twenty
paragraphs in each and we only found
like two cases where technically you
know there was a false positive where
two keys were similar enough but in all
those cases the first key happened to be
the correct one so the the tolerance was
pretty high so you could actually even
extend this to two images for example
but you probably want to kind of
restrict it to something within you know
the HRF value or something like that so
this is the fun part I I'm going to
attempt a live demo and fall back on
some screenshots just to show what we
actually did with this now that I've
kind of described it in death there is a
great article here Oh Priya
something I should say so the New York
Times recently did a wonderful redesign
and as part of that they cleared away
everything and started from scratch
which you should do if you're going to
tackle a good redesign this is actually
functionally that did not make it back
then told it was an oversight and
someone's going to do it but yeah until
something gets done but luckily they
they've published all their pages prior
to the redesign statically so
technically it still exists but it's not
just being carried forward let's see
what happens if I try a one so this is
an old article from 2012 and the idea
was that well one of the things is like
well I'll give you a very quick back
story my first job at the New York Times
was I just got my work visa and I was
working as a temp doing
from her service for email and there was
one particular day where we got 200 300
emails about an article that the times
had run and on the same article half the
emails were saying you were so
pro-palestine do you know that there are
terrorists and it's going off on that
kind of tangent the other half were
saying you're so pro-israel do you know
what they're do and this was about the
same article and the the thing I really
learned was that context can matter like
if someone wants to kind of you know
tweet something saying lies lies lies
and provide a URL you're probably not
going to read it but if that same person
could go in and actually go in and say
well actually on sorry on this paragraph
this line and here like these are the
things I'm disputing these are the
things that are interesting these are
the things that are interesting facts
whether it's a business based article
where you are highlighting like the core
takeaways and you're sharing it you you
would typically share the link now and
you would necessarily have to give this
long like copy and paste of the various
quotes and figures you can do you can
use a key like structure not just for
deep linking which is the first part but
the second part in terms of highlighting
or sharing or annotation so we did this
at the times and was actually rather
successful is one of those kind of power
user features that not many people knew
about simply because you have to double
tap the shift key on these articles in
order for those pilk rows to appear at
the side and even then it was like when
it was used it was actually used to some
like really interesting occurrences we
would try and track exactly how these
were being shared on Twitter we could
actually see people coming in on these
because we didn't set it up to to look
for what was in the in in the URL hash
but in terms of seeing things on Twitter
people were actually kind of making fun
use of it so it's kind of sorry that it
was gone but anyhow back to so that was
a times case so within that we built the
ability that you could actually linked
to a specific paragraph and you could
also highlight content as well so as you
can see like these keys are now
necessarily readable that was one of the
downsides it wasn't very legible however
depending on the level of granularity
that you want you could probably say
changed rules to say instead of the
first character the first word the first
three words of each sentence and that
would take you on to so as a screen shot
I talked about doing more readable URLs
so the first option is the one I would
recommend if you have like very long
articles if you require kind of more
robust measures of tolerance this one
can be get fluffy like as soon as you
start changing you know the URL or the
the text and you want that to correspond
you need to include a certain amount of
fuzziness when you look it up but as a
straight kind of like hey AMA this is my
blog I'm never going to change it then
you can make that call but for the times
and also our course we tried to kind of
do something a little more specific
and again the examples I'm using are
mostly text-based there are questions
about how you would do this in terms of
embeds if you wanted to link to
interactive content if you wanted to
link to anything else that you would
want to have in a page and I've avoided
that because it kind of gets a lot into
the context of what you'd be using those
for and I could talk about that for
hours but ultimately like readable text
it's a robust solution if you need to
just deep link quickly and you could
write that in five to ten minutes and it
would it would work pretty well but the
the key generation that's really like
the little more robust solid stuff that
worked for us at the times so we did you
know to to go the other way so after we
did this with the times it worked really
well
it was pretty solid the people who used
it were happy we avoided the whole
problem of actually integrating it with
the CMS it's entirely a front-end driven
process in terms of you interact with it
upon like basically a double shift
tap event you can change that to be
whatever you can have a button that just
said edit and it didn't add any overhead
to the page something because it was
being loaded after the fact and likewise
there was a simple check to look at the
urologist to say is this person trying
to deep link and if they weren't no more
code got loaded and if they were then it
would start doing the not very intensive
process though of generating keys for
the entirety of the article and
confirm matches wick warts we had a
different problem to solve and we in
hindsight now I would have gone more
towards the front end but we had a few
different constraints we wanted to build
an annotation system we wanted to not
only allow you to link two paragraphs to
highlight paragraphs but we wanted you
to annotate it and the original plan was
that we were going to kind of leverage
social media in terms of using like the
larger web as a platform that by
highlighting and annotating and tweeting
that that in itself was your annotation
and we could pull it back to a specific
paragraph and the annotation component
is actually pretty powerful if you look
at comments and I started off thinking
comments are a great way for readers to
interact with the author and I've kind
of now on the other position of like
Commons can be accessible that's a
terrible thing to say but essentially
you know you look at YouTube unless
you're going to put in the time and the
resources from the editorial side to
properly maintain and work with your
community you're going to have problems
like SB Nation has great common system
they have a great community there but
they put in a lot of time and people to
do that and a lot of news or can simply
because they're you know they're
strapped they brought to have more
writers than a dedicated person to to
police the community so what annotations
the plan was that if you get someone to
actually say instead of saying this
article sucks
which is not very helpful to actually
let them go in and say within this
paragraph saying hey there's paragraph
sucks because that's actually more
that's just a little step up to give
more helpful information like they
dispute this paragraph and maybe while
they're there they'll actually make
specific reference because they knew
that their comment was just going to get
lost in the in the larger crowd so of
course we wanted to kind of do that and
in turn people could annotate and they
could all we would tweet the annotations
and it would actually link back to the
page to the annotation themselves
whether it was approved or unapproved it
was there and I'll just quickly show you
what a what it isn't and explain how we
did it and maybe what I would change so
within a given article you get these
little things at the side you can link
and you can highlight last time I
checked I said I
I don't work there anymore so things
sometimes change but then within here
you can actually have these annotations
and again these this was if you look at
the source of the document within here
it's creating a unique ID for every
single paragraph as well as list item
and other things but what they're doing
that is different from the New York
Times implementations that this is
heavily tied into the back-end system so
we used WordPress but we almost went off
the the upgrade track as a result
essentially we do generate the keys and
we do try to sync and the difference you
know in engineering effort required for
that was pretty high in comparison to
the times where it was just was just me
and one other person and ultimately like
yes so this took I don't forget how long
it took actually it took weeks yeah it
took like I mean was spread over months
other projects kind of come in that we
have to kind of stop one and do the
other but it took a long time where's
the New York Times could be measured in
days and it's still one of those things
where annotations can get lost you have
to go in to the back end and you have to
map the key to the correct paragraph the
other thing too is on a CMS level as
well you really don't want the the
writers worrying about matching keys up
because or then getting the emails that
you know a comment or an annotation has
been lost which kind of did happen so
again that was kind of like lessons
learned like we we thought we could nail
the back end approach and you definitely
can I would just say that the level of
effort and the return you need to
balance that so one of the reasons why I
bring this up too is that there's a lot
of other things that we could build on
top of this so like linking to
paragraphs is pretty simple and
straightforward linking to content that
is potentially mutable that will
actually change and having a system that
will be tolerant of that is extremely
helpful but also that that can go the
other way too typically let's say within
if you're a wordpress user or a writer
you know they have short codes so you
have your short code and you have
YouTube URL and we all know the intended
behavior of that that is to pull in and
embed a YouTube video what if we can do
that with articles well that's kind of
straightforward what I could build a
wordpress plugin I provided a New Yorker
article URL and that would pull in like
you know the Open Graph information and
just do a nice embed
well what about embedding parts of that
article maybe there's something I want
to reference I want to cite I want to
have that piece that I'm quoting like in
the context of the before and after
paragraphs how do I build I mean
building a service to do that is
straight for the hard part is kind of
figuring out how do you actually link it
back to specific bits of content within
the page without like you know I framing
the entire article and figuring out a
way to injecting JavaScript so it jumps
down to a specific point I mean there
are things like that that we could
probably do to build and extend and
something you know I'd like to
definitely explore within within the New
Yorker for example but but it seems to
me that there's a lot of potential still
there the other thing too in terms of
like services that you can build on
within your page the main examples I've
shown as I said linking highlighting and
annotation
I'm sure does there's other things that
people can come up with you know there's
a lot of people here at this conference
you're extremely bright I know that
there's one some of those things you
hear ideas all the time and then someone
else would go and build upon that and
I'm kind of hoping that that kind of
happens today will see there is a repo
on github that we did at the times we
call the project emphasis and it's
simply like a drag-and-drop I think the
only dependency was jQuery and even then
it's no longer required if you're only
targeting modern browsers it was more so
that for the select basically for those
CSS selectors but you should dig into it
and fork it and play around with it and
see if it works for you
the slides are available here thank you
very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>