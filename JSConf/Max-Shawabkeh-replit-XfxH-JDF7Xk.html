<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Max Shawabkeh: repl.it | Coder Coacher - Coaching Coders</title><meta content="Max Shawabkeh: repl.it - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Max Shawabkeh: repl.it</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XfxH-JDF7Xk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Oh everybody so max your aapke and I'll
be talking about triplets
before I start you want to mention that
although I work at Google this is a
project that I did before joining Google
and I'll not be representing the company
so let's start
what is repli'd rep let's basically a
web app for playing around with
languages you can find it on rappel dot
IT or if you like more traditional
domains repli'd comm will work as well
so the name comes from Apple the read
eval print loop from languages like
Python and lists that most of us know
and love the idea behind repli'd is that
you don't just want to compile and
execute your program you want to
interact with it in your browser you
want to run snippets of code and build
up state interact with it similar to
what you would do in account in the
console so what is special about repli'd
first we support 17 languages all on the
same web app so we have things like
Python we have quick basic we have half
a dozen entries from the JavaScript
family things like CoffeeScript
interests ER and others of course we
also have rainfall control code because
really if you don't support flow code
kind of business are you so another
special thing about droplet is all of
this happens in a single you I use the
same editor the same console for all the
languages you have the same shortcuts
same behavioral input output all that
and what's more interesting it's not
just one URI it's also one API so if you
want to use repli'd as part of your web
app you can execute code in all of these
17 languages through a single simple API
all you have to do is load language give
the name of the language then call eval
pass a string and you get the results
and this also means that if you want to
add the language to repli'd all you have
to do is wrap it in a simple shim that
provides the interface we're looking for
you know once that's done
that use uses repli'd can use that
language as well for most of our
interpreters the the shim is really 30
or 40 lines of CoffeeScript so it's very
simple and at this point you might be
wondering why I'm talking about this at
a JavaScript conference after all
javascript is just one of the many
languages we support so the secret
behind repli'd is that all of this runs
in the browser so we interpret Python
and Ruby and all the other languages
inside your browser on the client this
of course gives us several advantages
one of them is it's fast many other
compilers on the web or interpreters on
the web we'll send a your code to the
server and there is a roundtrip there is
a delay what we do is we load the
interpreter on the client so there is a
slightly higher delay when first loaded
but then when you want to execute each
line or each bit of code it's instant
also there is the fact that there are no
security issues because everything's on
the client we don't have to execute
arbitrary code in our server so that
makes security much much simpler also of
course it scales indefinitely we're
serving static files
there's nothing simpler than that and
finally if you use html5 appcache or
package it up as a Chrome App or Mozilla
extension you can run it offline so this
is how repli'd looks this is the
language selector this is the workspace
itself on the Left you have an editor on
the right you have rapo where you can
write code execute it on the fly because
you can see there the variable values
keep state everything works
I won't dive too much into the UI
because it's very simple and you can go
and explore it yourself so let's go to
the more interesting implementation
details so what makes interpreter well
not much turns out all we need is a
constructor that won't realize a new
copy of an interpreter a new instance
with a fresh state and we need
an evaluation function which takes a bit
of code as a string runs it updates the
interpreter state and returns the value
of this bit of code and finally we need
I or callbacks so we can do input and
output interact with the outside world
so once we do have an interpreter what
do we do we we isolate it into its own
world if we have a web worker below just
in a web worker if not we use an iframe
and of course this this makes us immune
to the issues of global named scape so
if an interpreter writes random very
values or variables into the global
namespace we don't care it's all
isolated no two instances of
interpreters can interact and switching
languages in this case makes it very
simple you delete the old web worker
iframe you create a new one and you're
free to go
and once we guys the interpreter loaded
we link it up to the console and it
works
so there are several types of
interpreters that we use the first
category is reused or interpreters for
languages that existed before repli'd
was created these include of course
JavaScript CoffeeScript and all the
syntax sugar languages for JavaScript
this also includes the languages or the
implementations of language standards in
JavaScript to example the excellent
viewer scheme project that implements
most of schemes are 5 RS standard is
included and used in repli'd the other
category is interpreters that we created
specifically for a repli'd these are not
very exciting they're mostly for
esoteric languages we have low coffee
for low code we have unlearned the
coffee for an lambda and we have a multi
coffee for amore take a memo taken all
of these are written in CoffeeScript
they're not very interesting
technically but if someone wants to
learn programming and has never used
wants to learn compiler programming and
has never written a compiler before I
advise you to start with something like
this because that's a project you can
finish in a few days maybe a week and
you'll learn a lot about real compilers
from toei project like that and finally
the most interesting type of compilers
or interpreters that we use is named
scripted ones these are the compilers or
the interpreters that were originally
implemented in C or C++ and using
Emscripten
we ported them to JavaScript and run
them in the browser these are for
languages like Python Ruby and Lua for
which writing an interpreter from
scratch in JavaScript would be a lot of
work so as I said one of the most
interesting parts of this project is
using inscription so for those who don't
know Emscripten is a compiler from LLVM
byte code to JavaScript LLVM is a
compiler middleware it provides an IR
bit code format which many C C++ and
other language compilers can omit so
once we have the LLVM byte code for a
given program that was written in C or
C++ we apply inscription to it and we
get JavaScript so as the byte code is
similar to assembly so what you do is
you translate each assembly statement or
bits code statement or bits construction
to JavaScript statements so we get of
course a whole huge heap of JavaScript
for example the Python compiler without
minification is about 30 Meg's of
JavaScript so once we do get the
JavaScript code out of the bytecode we
are still missing two key parts that we
need before we can run it first we need
memory because obviously native memory
is much different from JavaScript
JavaScript memory model is really
garbage collection garbage collected and
abstracted
so you don't have pointers you can't
access addresses none of that so we have
to emulate that and what we do is simply
emulate it as I an array so if you have
typed arrays we use that if not we use
normal JavaScript arrays and that takes
care of memory and then also there are
system calls when you're writing C or
C++ program you know that the US will
provides a certain services memory
allocation system time file system
access all that kind of stuff and of
course the script does not provide it in
a similar way as C or C++
so whatever scripting does is it
implements all of these by hand in
JavaScript so one of the biggest
contributions that Triplette made to M
scripting during our development is we
created a virtual file system that
implements most of the POSIX standard
and can be backed by data inlined into
the script or by files on the servers
which are loaded and fetched lazily so
with the memory taken care of with the
system calls taking care of and with the
program itself translated to JavaScript
we're ready to run so we have a program
that runs and it's it's working but many
of you will say okay that's great but
surely it's way too slow for practical
purposes it turns out it isn't
most of the scripted code runs within
one order of magnitude of the native
optimized code speed which is pretty
impressive and some benchmarks even go
as fast as three or four times slower
than native so in our case we compile
see python and ruby 1.8 both of those
were good enough for Apple they weren't
fast enough to run large programs really
but again as we are really just a
wrapper we we ran several lines of code
at a time they're perfectly fine
so I'd like to speak more about him
scripting but of course this is about
Triplett and not inscription there is a
great talk that Alan Zaki the creator
from scripting did at Gia's confit you
you can search on google or on them
script and wiki he goes into more detail
about the various issues or
peculiarities of inscription and he does
some very very cool demos with it so go
ahead and do that and if you have any
questions I'll be happy to answer them
about in scripting so of course once I
get off the stage and don't expect you
people to uninstall cpython and switch
to repli'd that would be rather
ridiculous but at the same time why why
create this project at all so our
original goal really was well first of
course to have fun and prove that it's
possible rather than that also to create
an easily accessible place where we
could experiment with little snippets of
code in many languages and once we do
that we can share them with other people
and the code would be executable right
in their browsers so for example if I'm
answering a stack overflow question I
want to post a code sample I could just
post the code itself or I could link to
repli'd where they will get the code
itself plus they can run it in the
browser without installing anything in
their machine and they'll be running it
in the same exact environment where you
wrote it so you can be sure that the
result is the exact same not only that
you can also record an repple session so
you can show your work step by step
which can be very helpful when we did
release the project what we found is a
lot of interest was from the online
education community people who were
teaching programming online really were
interested in repligen using it since
one of the biggest turtles that and you
someone new to program
has to overcome is installing a compiler
and setting up a development environment
so with repli'd you eliminate that step
so you can easily execute any code you
want in any of the 17 languages in your
browser without having anything
installed just seconds after typing in
the URL so several of these
organizations or websites use gzip
already one of the most notable is code
Academy they currently use repli'd for
their courses they provide gamified
course courses aimed at beginners for
JavaScript and now I think today they
released HTML and CSS and all kind of
web development courses so other than
that of course there is the more general
open source spirit goal so once we
create a droplet who contributed all of
this code to open source it's hosted on
github it's available under the MIT
license which is very permissive you can
take any bit of code from this project
use it for your own either the whole
thing or each interpreter alone and so
free and finally projects like I'm
scripting and repli'd really push the
boundaries of what browsers can do so
while we were developing we found quite
a few cases of bugs and v8 and spider
monkey or inefficiencies that we then
reported to the teams and they were
eventually fixed and now everyone's
happy so I'm getting close to the end so
this project was created by my friend
I'm Jade Mossad in myself I'd like to
give him credit he is the one who came
up with the idea originally he did have
the word convinced me to do the other
half
he's currently working in code Academy
they mentioned before and that's it
thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>