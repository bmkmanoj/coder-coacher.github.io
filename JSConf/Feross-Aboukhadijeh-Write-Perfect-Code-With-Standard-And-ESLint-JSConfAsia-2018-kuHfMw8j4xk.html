<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Feross Aboukhadijeh: Write Perfect Code With Standard And ESLint - JSConf.Asia 2018 | Coder Coacher - Coaching Coders</title><meta content="Feross Aboukhadijeh: Write Perfect Code With Standard And ESLint - JSConf.Asia 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Feross Aboukhadijeh: Write Perfect Code With Standard And ESLint - JSConf.Asia 2018</b></h2><h5 class="post__date">2018-02-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/kuHfMw8j4xk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so in this talks you'll learn how to
write perfect code so just install
standard and that's it thank you
of course I'm kidding
so I will be talking about how to use
standard NDS lint to catch programmer
errors before they cause problems for
your users
we'll discuss how to get started with
linting as well as how to improve
the setup of your linter if you already
have one in your codebase so i'm for us
i work on lots of projects most of them
are open source and you might have heard
of web torrent a torn app that works in
the browser on the web or maybe standard
jeaious which will be discussed in this
talk and i spoke it jaesik on asia
actually about web torn in 2014 so i'm
really honored to be back here speaking
about standard this year so thank you so
if you know me you know I never wear a
suit but since standard is all about
writing pretty code code that's
enterprise approved and you know all
dressed up for business I figured
there's no better time to try wearing a
suit so what do you guys think thank you
okay so let's start what's a winter so a
linter catches bugs it analyzes source
code to flag bugs and suspicious
constructs so suspicious constructs
meaning things that you know maybe bugs
but aren't necessarily bugs the term
lint comes from a UNIX utility that
examined C code we still use it today so
what's a bug when your code doesn't work
but that's pretty broad right so we
should try to be more specific about the
cause of code not working that way we
can think about how to address the true
cause of the bug
in our code so let's look at the word
bug as commonly used by programmers some
people say bug is an old term for a
monster you can see this meaning still
used in obscure terms like bug bear
Bugaboo or even boogeyman which is I
guess still sort of related to bug but
there's actually a better story for
where the term bug comes from maybe
you've heard it already in 1947 the US
Navy used this electromechanical
computer really big computer called the
mark to to perform computations and one
day they were getting wrong results so
to fix the problem they actually opened
up the computer and found a moth stuck
inside which was causing the problem
real story so the operators removed it
and they they pinned it on the log
report and they wrote the following
description which you can see up here
first actual case of bug being found
so some versions of this story say that
Grace Hopper herself actually found the
bug and and then also coined the term
debug at the exact same time so it's
such a debug meant taking the bug out of
the computer to get it working again so
I like this story a lot it's a it's a
great story but the thing is there's
actually some evidence that Thomas
Edison actually used the word word bug
about 70 years before this story
happened but the thing is it's such a
good story that I think like it just
always gets retold in conference talks
like this one so I digress
so anyway in both of these origins
stories the one about you know bug being
a monster that comes from outside into
your into your code and you know takes
otherwise perfectly working code and
ruins it and then this this actual bug
that goes in the computer and both of
these stories the term bug is implying
that a bug is an external force that
that that messes up your code and the
thing is this is just not true when's
the last time that a bug in your code
has actually been caused by hardware
malfunction right there's a saying that
goes
you know if if you think you found a bug
in the compiler you probably have an
it's just a bug in your code right so
the famed computer science a computer
scientist Edsger Dijkstra once spoke
about how he despised the term bug
because he said it just it's disguises
where bugs in software where software
sorry where software defects actually
come from he said that we could for
instance begin with cleaning up our
language by no longer calling a bug a
bug but by calling it an error and
that's much more honest because it
squarely puts the blame where it belongs
namely with the programmer who made the
air the the animistic metaphor of the
bug that maliciously sneaked in while
the programmer was not looking is
intellectually dishonest as it disguises
that the error is the programmers own
creation end quote ok Dijkstra so calm
down a lot of a lot of Dijkstra's talks
and writings can often sound like an old
man yelling at a cloud he's a very
grumpy person but I think he's actually
right about this this terminology
confusion so back to yes lint so so what
is the point of a linter the point of a
linter and the point of the eslint is to
catch programmer errors so let's let's
dive into the the history of linters and
j/s really quickly so jslint was the
original winter it was created by
Douglas Crockford in 2002 that's 16
years ago which in I guess in JavaScript
years that's like a hundred years or
something so so then then Gia's hints
came out in 2010 and that was basically
designed to offer a little more
configurability
and added a few more rules finally we
have es lint which came out in 2013 and
that offered better es6 support more
rules that specifically rules about a
code style so that's like punctuation
and things like that that don't have
anything to do with correctness as well
as a flexible plug-in system that let
develop
make their own style rules so these
three categories of things are what what
es Lynch x4 so the first is the most
important the first is programmer errors
so programmer errors are a correctness
issue they they happen when the they
basically cause the program to do the
wrong thing we never want these in our
program there's there's they're never
okay basically now best practices these
are about avoiding confusing code that
they're about avoiding patterns that
lead to that often lead to errors so
it's possible for code to be correct but
still be very confusing and and so so
when you when you check for best
practices what you're doing is you're
it's about minimizing the risk and and
also helping with clarity so that
programmers that come along later can
quickly understand what's going on and
lastly we have style issues so these are
about spacing punctuation how the code
looks and you want a team to agree on
like tabs or spaces for instance so the
code looks consistent and so the the I
guess the ultimate goal here is to to
make an entire code base look like it
was written by a single person so if you
can get your entire code base to look
like it was written by a single person
that's that's easiest and best for for
readability and and and you won't you
won't get distracted by you know things
that look at a place for example this is
why we have copy editors and newspapers
at least we used to before we went to
online news okay so let's talk about the
first and most important use of a winter
catching programmer errors so you can
obviously just like run your program and
try to test all the cases at runtime and
and you know that's what qada
the point of QA is at the point of
integration tests and even unit tests
but a linter can help us catch these
errors statically which means we should
be shortening the feedback loop we don't
need to run our test suite or or
actually use our app and make sure we've
exercised all the possible code paths in
order to to catch an error so we can
catch it immediately ideally directly in
our editor so let's look at a few
examples of the types of errors that can
be detected okay so quick quiz do you
see the bug in this code raise your hand
if you see it okay
not very many yeah it's tricky
it's it's subtle basically what's going
on is the for loop is going in the wrong
direction the eye is being decremented
with each iteration of the loop and so
this will never terminate this is an
infinite loop because it's going down
and we're only going to stop when we get
up to ten so this is a kind of bug that
you know if it's in your code base and
it's not exercised in your integration
tests or by your by your you know your
testing your manual testing you're going
to miss it and you're only going to
discover this when when this bug affects
your users in production so a for loop
with the stop condition that can never
be reached such as this one just should
never be in your codebase that's what
that's what es lint is is an example of
a rule that he has not will enforce for
you here's another one this is another
useful one so this is this is a
assignment that's actually happening
inside this conditional so it's actually
going to always be a truthy value or
actually not comparing the string to the
to the property here it's actually a
signing manager manager string to the
property and then returning the value of
that whole expression is the string
manager so it's always gonna be true
the-- so this is easy mistake to make
but it's very easy for a linter to
detect so this is another example
something that you'll get saved by feeis
lint let's do a few more so here's
another one um this one here is this is
actually this is an example of really
something that probably should have just
been like a syntax error in the language
honestly having having parameters to a
function that are named exactly the same
like that's so silly that that's all
hard but but it is and so what actually
happens is the second parameter that
will actually take will actually shadow
the preceding one and so this this is
probably like a typo and
practice is probably typos in your
codebase or like something that happened
by accident while refactoring and so
this will just you know yes some will
just catch this for you here's one more
so this rule enforces comparing type of
to valid string literals so type of can
only return one of like five or six
strings so let's just make sure that
every where we're using type of we're
comparing it to one of those five or six
strings if we compare it to any other
string than those five or six then we're
it's always gonna be false so it's an
error this one's kind of subtle so if
you actually have a reg X in your code
base that uses the literal the reg X
literal syntax that's the one with the
slashes where you put your X between the
two slashes that one is actually parsed
and if you have an invalid reg X that
will be caught and it'll be a syntax
error but if you have one that's a
string and you're doing Arreaga click
this then then this is going to be
caught at runtime only when this code
code path is executed but we can catch
this with the winter
okay so there's dozens more of these
they're all great things to check in
your code and you can you can get them
all but I'm not going to go over them
all obviously okay so let's let's take a
break from talking about the examples of
things that can be caught and let's talk
about how you actually use es lines
because you obviously want to use it now
right so you make an es on our C file
and add it to your code base this is
actually the one that standard uses it's
over 200 lines long
so yes the config files can be really
long they're often really long and if
you don't want to decide on each of
these rules one at a time you can extend
what's what's called a shareable config
c by extending a shareable config that
gets you a bunch of rules that you can
inherit by default so in this case we're
inheriting from the standard rule set
there's a few other alternatives you can
look at there's one by Airbnb that's
really popular and there's another one
by Google that's quite popular as well
it doesn't matter which one you choose
just pick one
and stick with it one thing I'll say
though is if you use an ESL into our C
file in your codebase
beware of rule overrides so one
disadvantage to using this file is that
anyone can go in and override the rules
by just adding a new line to this rules
array here and that's where standard
comes in so so and this is where
standard really shines so it's it's more
than a shareable config it's actually an
entire command line program that you
install and then you run directly and it
comes with the more than 200
pre-configured you slunt rules but the
thing is it bundles them up into a
single command that you can just run or
that you can add to your test suite so
this is how you would use it and I think
it's the easiest way to add a linter to
your project because there's no need to
setup any config files there's no need
to decide on which rules you're going to
use you just install it and then you run
it and then it tells you whether your
code passes or not you can also add - -
fix and it will try to fix any errors
that it sees so for example this error
here with the triple equals can be a can
be actually fixed automatically in some
cases which is really nice so standard
has a vibrant community it's downloaded
a million times per month and there's
editor plug-ins for every major editor
and it's also built into the webstorm
editor by default and you can go into
preferences to turn it on so I don't
want to make this too much of a sales
pitch but I will say that oh yeah this
is just how to how to add it as a dev
dependency you can you can then just add
standard to your test script and prepend
it to whatever your normal node tests
are and there's nothing to configure but
the point is that you should probably be
using you know yes lint or standard or
something like this in your code and you
probably already are but I guess I want
to go into a little bit about sort of
the choices and the trade-offs for
thinking about what to what to use so
using the eslint directly is a totally
valid choice and it's it's
it's something that some of the projects
I've worked on do but there's just a few
gotchas that you should be aware of if
you do this so the first one is bike
shedding so some teammates will propose
rule changes to suit their own personal
coding style and now your team has to
debate the pros and the cons of like
tabs or spaces or whatever in your issue
tracker so this can take like days or
weeks and the thing is like the less
important topic is the more like the
more subjective it is the the more
opinions people have and it's so easy to
have an opinion when when when the the
issue is like insignificant it doesn't
matter and this is why you know the
example of bike shedding is the color
everyone has an opinion about what color
we should paint the bike shed but no one
has an opinion about like you know let's
say the like shape of the bike shed or
like how how how to architect it so that
doesn't fall over that stuff's harder
and and and so only the experts can
actually participate in that part of the
discussion but the more trivial the
issues the more like everyone just wants
to wants to like debate it and talk
about the pros and the cons so these
kinds of things can suck up a lot of
time for a little to no benefit so
really when it comes to these decisions
stainer just picks something and then
you know if it's a tries to be
reasonable and just pick something and
then you can move on
so when debates happen they happen on
the standard issue tracker and me and
all the other contributors we do the
bike shedding so that your team doesn't
have to anyway if you want to use the
eslint directly that's fine just be
aware that some teammates on your team
may mean we try to change it they might
try to debate the rules they may
actually was just talking to Tim Tim
earlier and he was telling me that
someone on his I guess what if it was
his team I don't want to call it anybody
but someone that he knows frequently
well in their poll requests actually add
like an es lint change to the rules to
get the the pro requests to pass and
they'll sneak it in inside of a huge
polar quest with a bunch of other
unrelated changes and that's their way
of avoiding actually convincing their
teammates to make the change they just
kind of sneak it in like that so maybe
you know someone who does that
um so really you want to lock down the
file and make it like much harder or
impossible to change it one other thing
beware of duplication so checking the is
lint RC file into every repository that
your team manages can lead to
maintenance headaches to keep them all
in sync so you you want to think about
how to solve this you can put the es
lint file into its own package that's
one solution there's another one I'll
talk about at the end of this talk - you
can use okay so we we said there's three
reasons why you would use a linter let's
talk just quickly about a few of the
best practices types of rules that es
lint has because we've already talked
about the first the first one programmer
errors so remember best practices were
about avoiding confusing code patterns
that like often lead to errors but
they're not necessarily like the code
can be technically correct but still be
terrible so here's another quiz for you
guys which are what do these expressions
up here these three expressions
evaluates to think about it very
carefully yeah so this is all or
probably should just be never written in
any code base the answer it who thinks
they have an answer actually I'm curious
raise your hand if you think you have an
answer I can't see anyone their hand up
Wow okay so they're all true makes sense
right so what there's a whole talk
filled with examples of stuff like this
in JavaScript the the lesson of that
talk was or to me was don't just don't
try to memorize the rules they don't
make sense they're pointless to remember
use a linter and use rules that try to
make it harder to to own yourself like
this just here's an example use require
trip require triple equals and you'll
never run into this issue oh and that's
because that's because triple equals
enforces that the types that you're
comparing are the same in addition to
their set values being the same but I
want to say one thing so standard tries
to help you write good code but it
doesn't want to get in the way of being
- you just want to be too pedantic and
and be annoying to use so it the focus
is on preventing like actual errors so
if you want to use like the double
equals null shorthand to test whether a
variable is null or undefined that's
fine standard doesn't treat it as an
error because it's a comment JavaScript
idiom all right this is is actually C
code but you should should still be able
to figure it out do you see the
programmer error in this yeah so this
actually comes from Apple's SSL
implementation and this was in the news
I think like a few years ago and this is
the reason why you should never omit
curly braces if you have multiple if if
statements that that go onto multiple
lines so if you see like right there
there's to go to fails this was called
the go-to fail bug which is great
because it was quite a fail it led to
basically SSL not even working correctly
and you could get men in the middle by
like anyone who is running the Wi-Fi
network you were on really bad bug so
this is yeah this is the other part that
was the problem so what's actually
happening is this codes being
interpreted like this so even though
they're the two are indented like the
only the first expression after an if
statement is gonna be part of the if
body and so you have to use curly braces
if you want to make more than one
expression be part of the body so like
you we can require curly brace
conventions and prevent things like this
from from getting into our our code base
so this will like hopefully reduce bugs
in your code but again standards
pragmatic so it doesn't want to get in
the way if there's a common community
pattern that that doesn't introduce
significant risk
so omitting curly braces for single line
if statements is allowed in standard so
you can see the first line is it's
pretty clear unlike little leads issues
it's just when you when you when you put
it on the next line without curly braces
that's when it starts to get dangerous
that's when you start to get this kind
of thing where someone will come in and
add a second go-to and think that it's
some kind of work
okay so just some final tips for before
we conclude here so if you don't want to
use standard that's fine if you want to
use the Esalen directly because your
team has its own style too much work to
change blah blah blah that's that's
great it's fine
I just recommend one thing consider
wrapping your excellent rules into a
package and and that way all of your
repositories can depend on that package
and you also raise the barrier a little
bit to having people just go in and
change it whenever they want and you
make it harder for there to be like
waste of time and debates about style
things also you consider providing a
command line program so that you can
just install it and add it directly to
your to your npm tests script field and
if you want to do that there's a really
great package for this called standard
engine this is what actually powers
standard itself so a standard engine you
just point it's here you slunt rules and
then it will give you a binary like a
command line program you can just run
that'll that'll you know run the checker
and it's not configurable at all so
you've kind of encapsulated your rules
and made them unconfigured
and it's probably worth mentioning
prettier here because prettier is gotten
a lot more popular in the last year so
what about prettier what do I think
about prettier so prettier is great it
formats your code to have a consistent
style it's kind of like go formats but
for JavaScript the thing is though that
out of these three things that the es
line checks for prettier is only
handling the last one is handling style
so it's not going to check for for
potential bugs over for like actual bugs
and your code it's just gonna it's gonna
read in your code make an ast and then
how to put your code and then you know
it'll look nice so you still need a
linter in my opinion and I think that's
I think it's it's fine because prettier
and and a eslint work great together
cool so one last thing before I go I've
been working full time on open source
for the past three years but it's not
sustainable so last month I launched a
fundraising campaign on patreon so the
goal is to get enough donations that I
can continue to work on standard and the
other 100 plus NPM packages that I
maintain so at least for like a few days
a week
so if you like what I do consider
becoming a supporter cool thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>