<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Parsha Pourkhomami: JavaScript CSS | JSConf US 2015 | Coder Coacher - Coaching Coders</title><meta content="Parsha Pourkhomami: JavaScript CSS | JSConf US 2015 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Parsha Pourkhomami: JavaScript CSS | JSConf US 2015</b></h2><h5 class="post__date">2015-06-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Bt7-cx5AOQc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Harsha I'm going to talk to
you guys about mixing JavaScript and CSS
so before I start I want to warn you the
song is about ideas not code even though
I'm going to be showing you a lot of
code I'm not necessarily saying it's a
good idea or that if it'll even work my
goal here is to share some ideas and get
you guys thinking so if you hear
anything that you think is awesome and
might solve your problems or if you
think I'm totally crazy then you should
come find me and tell me about it so
before we talk about JavaScript let's
talk about CSS CSS enables us to take
websites that look like this and turn it
into this CSS even makes craigslist look
better going from this to this I don't
even think Alexis use CSS aside from
enabling rich user interfaces CSS also
lets us create cool animations and other
visual effects like whatever this thing
is that's actually not showing up in the
projector so let me just show you that
there is something on my screen and it's
kind of neat it's this is an animation
that's utilizing the GPU to compose
several layers together and then
transform them on top of each other oh
there it is so yeah CSS is pretty
awesome
but CSS has its fair share of issues and
limitations too there's no way to define
constants there's no way to extend the
language with your own logic there's
basically no dependency management we
have the import rule but there's
limiting performance product
characteristics there there's no way to
reuse code or do any sort of meta
programming and there's no
interoperability with the rest of our
front-end code JavaScript sometimes
these limitations are good they force us
to write easier to understand code but
sometimes especially in large-scale apps
these limitations often lead to copy and
pasted code and stuff that's hard to
maintain but we've been able to work
around these issues by creating new
languages we call CSS preprocessors
we've been a bit of work around some of
these issues at least but preprocessors
are weird they often have ambiguous
syntax and non-standard semantics and
they give us features that look and
smell like things were used to like
functions but then their behavior is
different in unexpected ways let me show
you a couple of examples of what I mean
looks like a look at Silas for those of
you who are not familiar with Silas
Silas has very Church syntax basically
gets rid of things like semicolons curly
braces colons basically almost
everything let's take a look at this
example here's the compile output we get
what we would kind of expect there is a
form that gets the color applied to it
and then there's an awesome font apply
it to inputs and text areas inside that
form but what would happen if we
accidentally swap two lines in our Silas
source
so in case you didn't see that let me do
it again the top two lines get swapped
with each other well this no longer
really makes sense the source doesn't
make sense what do you guys think will
happen hopefully we get some sort of
compile time error nope Silas gets a bit
confused and instead thinks our color
declaration is actually a selector this
is still valid CSS so there's no error
hopefully the developer cache is this
but it's going to take some effort to
debug let's take a look at less less
gives us a way to import dependencies
actually less gives us a trace import
dependencies they all have their
different semantics actually sometimes
they have the same semantics as others
depending on the condition of what we're
import importing basically you end up
having to look at the docks every time
you want to import something
let's look at variables class gives us
variables here we have a variable
defined called heading color and then we
use that to set the color of h 2
elements but we're defining the variable
twice once before we use it and once
after we use it and the output SAS uses
the first assignment of the variable and
we get red but let's see what les
decides to do if you have the same thing
but here less those opposite thing less
uses the value that we last assigned to
the value to the variable and we get the
value white weird maybe not either of
them are wrong but you just got to get
used to it and make sure you switch into
the right context when you go between
languages les also lets us do arithmetic
here we see 10 pixels minus 2 pixels is
8 pixels great but you better be careful
with spaces because adding or removing
spaces might change the result that's
right whitespace sensitive math and you
better be careful with parentheses to
because parentheses will change the
results in an even worse way so what
else can let's do less has this awesome
feature you can automatically convert
units for us so here we have the same
values but using different units 10
centimeters minus 1 centimeter and 10
centimeters minus 10 millimeters both
come out to 1 centimeter cool let's see
this in action with division here we
have the same units on both sides of the
operator 10 centimeters / 1 centimeter
10 centimeters as you'd expect what
happens if
mix units like we did with subtraction
doesn't work less silently ignores units
on the second operand when you're doing
division so would last we can do
arithmetic but you got to be really
careful so my point is language design
is hard syntax scoping types compilers
air handling all these are really
complicated things it's understandable
that these few processors have gotten
some of them wrong so CSS in school but
it's got issues if you have
preprocessors to solve some of these
issues but preprocessors have their own
issues is there a better way can we use
javascript to do CSS better well let's
take a look at what using javascript to
write CSS might look like let's express
a simple rule in javascript here it is
in CSS we've got a red button let's
convert it to javascript it's actually
not too different you basically add some
quotation marks change out some I call
into a comma and we've got valid
JavaScript syntax all right that's a
pretty basic example what if we had
pseudo selectors we wanted to have a
hover State for our button well it's not
too much different from CSS or one of
our pre processors and we can do even
more complicated selectors child
selectors and descendant selectors still
nothing too surprising I hope and here's
the media query
and in CSS sometimes we want to do
something called property fallbacks
where we define a property more than
once so that browsers that don't support
a certain value can fall back to
previous ones in JavaScript we can't
quite define the same property more than
once in an object but we can use arrays
to accomplish this CSS also has a bunch
of other at rules at care set at key
frames for CSS animations at font-face
rest assured that we can express all of
these things using javascript so we've
got rules with selectors your to-dos
electors child selector is any kind of
selected really got property fallbacks
media queries at rules that's pretty
much all of CSS so I think it's safe to
say we can express the SS using
javascript and it's pretty simple to all
we're using our literals literal
expressions this is essentially JSON so
we can express CSS and JavaScript but
how do we actually use this JavaScript
this JavaScript and a browser to style
elements so far we've got these plain
old JavaScript objects but we need to
turn this in a way that into something
that the browser understands well all
you really need is a function that can
transform one of these objects into a
CSS source string now we can take to CSS
source string and let the browser use it
so yes we can express the SS using
javascript and you can use that to
actually style elements in the browser
awesome JavaScript for everything but
why would we want to do this are there
any actual advantages to start with
remember the issues and limitations of
CSS that I raised in the beginning of
the stock the reasons we've invented all
these new languages to the CSS
preprocessors well javascript sols or at
least addresses all of these issues for
us automatically let me show you what I
mean CSS has no way to define variables
glass less and sass both give
accessibility but they have their own
weird semantics javascript has variables
built-in in with semantics we know and
understand you can use variables to
define our constants in one place
javascript also has the earth metic
built-in 10-2 pixels is eight pixels and
best of all unlike some CSS
preprocessors doesn't matter how many
spaces or parentheses use you still get
eight pixels in CSS we have no way to
extend the language with our own logic
say we wanted to mix two colors together
in CSS you would have to pre compute
this value and hard coded into our
source code less and other processors
give us a set of built-in functions that
we can use to do some basic things but
we still can't define our own logic
with JavaScript we can define arbitrary
functions here we create a function that
mixes the two colors for us we can even
share this function with the rest of our
front-end code of course we don't
actually have to write our own functions
we can take advantage of the JavaScript
ecosystem and use modules to do the work
for us here we're using the color module
from NPM to do the mixing of the two
colors
and we're not limited to just functions
that operate on colors or single values
in JavaScript functions are the most
basic unit of code reuse we can use
functions to generate entire sets of
sound Eckler ations here we have a
function that takes in a base color and
generates isles for a button based on
that color we're getting the same sort
of code reuse we get as what some
preprocessor is called mix-ins but with
semantics that we understand but CSS we
have no way of sharing values between
CSS and the rest of our front-end code
for example here we have some CSS that
defines the color then say we have some
JavaScript code that draws to a canvas
and we want this canvas drawing to have
the same color as we define in CSS sure
you guys have probably run into
something like this before you end up
having to leave comments to tell other
developers that when they change one of
these variables one of these values they
have to make sure they go into the other
place and change that value to match to
this is brittle but if our styles are in
JavaScript and our canvas code is in
JavaScript it becomes trivial to share
values between the two
of course we don't need everything to be
a single file we can use modules to
organize our styles and import
dependencies and it's just JavaScript so
we can import whatever you want
Constance functions or entire sets of
Sal declarations speaking of modules we
can take advantage of NPM not only do we
have access to the 150,000 modules we
can use NPM to publish and reuse style
modules imagine having an ecosystem of
reusable styles for things like buttons
and tables and other common interface
elements or utility modules that help
you build styles for example a module
that takes in the background color and
automatically generates a foreground
color for you that has good contrast
spoiler at that module already exists in
on vm so I've shown that there are
advantages of using javascript to write
CSS by using a touring complete
programming language to build our styles
we're not limited to what our CSS
preprocessor has implemented we can even
said use the full power of JavaScript to
implement whatever logic we need we
don't need to reinvent variables
functions scoping or anything else
javascript has all these things just
waiting to be used of course with great
power comes great responsibility maybe
it's not a good idea to do a network
requests to build your styles but that
should be up to you to decide
so we've successfully used JavaScript to
write CSS how else can be mixed
javascript and CSS let me pause for a
second until you that you should
consider the following experimental
thinking the details are vague I don't
know if it's a good idea and I
definitely don't know if it'll even work
so think about it and give me your
feedback but let's see how else we can
mix j/s and CSS we can use javascript to
apply styles in the browser what I mean
by this is taking over the browser's
role of parsing CSS and applying styles
to elements I know this sounds crazy but
bear with me for a second and let's see
what we can do if we do this
first writing CSS and JavaScript like
I've been talking about is not a
prerequisite to this you could just use
regular old CSS actually what is a
prerequisite is having some sort of CSS
abstract syntax tree or CSS AST
available to us in the browser what I
mean by this is we need to be able to
take a CSS source string and be able to
understand and inspect it and see
exactly what's being defined in that
source of course there's an NPM module
for that here we're parsing a simple CSS
rule we have access to the selector the
declarations what property is being
defined and what the value is and of
course we can do the inverse we can take
a CSS abstraction tax cream and generate
a CSS source string cool but what does
this enable us to do well CSS has a new
feature called CSS feature queries it's
kind of like media queries but instead
of testing the devices width or
orientation or something like that we're
able to test whether a device supports a
certain CSS feature
this example lets us use flex box if the
browser supports flexbox otherwise we
use float unfortunately not many
browsers support feature queries yet but
if we're executing javascript in the
browser then we have access to
information about that browser
environment like for example whether or
not the browser supports a certain CSS
feature or not and if you can access our
CSS abstract syntax tree like I showed
earlier then we can use that information
about the browser and transform our CSS
into new CSS then we can take that new
CSS and inject it back into the browser
by injecting a new style tag into the
document this means we can take CSS and
create new CSS based on what browser
were in
we can use this technique to polyfill
CSS feature queries we would walk the
CSS abstract syntax tree and when we
come across an app supports role we
would do the feature detection in
JavaScript and then based on the result
of that feature detection we could
generate a new CSS ast either including
the rule or excluding the rule that's
nested under the featured under the app
supports role now we have future queries
in every browser so what else can we do
one of the browsers jobs with CSS is to
take selectors and figure out which
elements match then the matched elements
get Stiles applied to them in this
example the browser knows to apply the
color red to our spin because the span
is a child of a div element that's what
our CSS rules selector specifies another
way we can take over the browser is by
doing this matching and applying of
styles ourselves this means for each CSS
rule we have defined we would find all
of the elements that match using
something like query select select their
all and then for each matched element we
would apply the rules files to the
element why would we do this the browser
already does this for us well again it's
about having new information this time
we would have information about the
hierarchy of elements in the document
when we're applying files to an element
meaning that for each element we're
applying files to you can see what its
parent is what its children are how many
siblings it has we would know exactly
where in the document in documents
hierarchy that element is this
information lets us polyfill even more
CSS features
take first child and last child for
example if we know about the siblings of
an element you know the position of an
element within its parents then we know
if it's the first child or not and if
it's the last child or not this means we
would be able to implement first child
and last child ourselves so when we're
iterating through elements we can use
this information about the elements
physician to determine if the element
should get our first child or last child
files though that's not really too
useful since basically every browser
supports first child and last child
natively but with the same kind of
information in the same technique
looking at the documents hierarchy maybe
we can probably fill something more
useful flexbox is a new CSS layout
feature that makes it easy to express
all the crazy things we use floats and
tables and various other layout hacks
if we know the flex Fox styles we want
to apply to an element and we know that
elements parents and its children and
all the styles of those elements then we
can calculate the position and
dimensions of every element this example
has a flex container with two children
each with an equal grow factor of one
this means we would have a container
that has two side by side columns inside
of it each with equal width I was able
to determine that by just looking at the
CSS and our documents hierarchy of
course computers can do this for us too
and you guessed it there's an NPM module
for that so if we can describe our
document creating a representation of
our document hierarchy and the styles we
want each element to have then we can
use the CSS layout module to calculate
the layout of our of our elements so
here we're describing the document i
showed in the previous example a
container with two flex children so if
we pass the right information to CSS
layout they can calculate the exact
dimensions and positions of each element
for us here we can see we end up with
our parents and two children side by
side each with equal width we get the
width height top and left of each
element
that's awesome I think we can use that
to implement a runtime flexbox polyfill
I think we're nearly exciting place
right now the JavaScript module
ecosystem is implementing some great
things I think it's going to be really
interesting to see what we can do with
them so I hope I've shown you some
interesting ways you can mix JavaScript
and CSS and essentially re-implement the
browser in the browser come find me and
talk to me about any of this I'd love to
discuss it you can also tweet me at
parsha p thanks for your time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>