<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Jon Bretman: Ask not what JavaScript can do for you -- JSConf EU 2013 | Coder Coacher - Coaching Coders</title><meta content="Jon Bretman: Ask not what JavaScript can do for you -- JSConf EU 2013 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Jon Bretman: Ask not what JavaScript can do for you -- JSConf EU 2013</b></h2><h5 class="post__date">2013-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Pl8ei4cug8k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
you
yes I'm John bratman I work at a company
called badoo in London and I'm not going
to teach you about the future of the
universe and everything and I want about
JavaScript and that probably doesn't
come as much surprised because we all
here to talk about JavaScript but I want
to talk about JavaScript just JavaScript
maybe not a lot of things we're talking
about here just for 30 minutes of your
time and I write a lot of JavaScript not
coffeescript nothing like that
javascript a lot of it and have to
contend with a lot of problems I think a
lot of people do and we talk about these
things a lot we may be bashed JavaScript
a little bit I want to talk about what
we're doing in production now today with
things we have not maybe the things that
are coming soon although that's really
cool and there's four things I'd like to
talk about I think these come up almost
every day for me and it may seem quite
basic and quite a level but still I'll
have a little chat so type checking
javascripts dynamic which is really good
we want a dynamic language that's why we
probably why we love it but sometimes we
need to check for things so sometimes we
need to actually know that something is
what it says it is what we think it is
before we act on it and fall over
ourselves what we don't want to happen
is this then we've got a year to make
sure this doesn't happen and he's a
funny guy and what does he mean what
does he mean by literally wrote
everything in JavaScript nothing works
well I think we all know what this is
this is a web app and it doesn't do
anything unless we have JavaScript so
let's assume we do have JavaScript we're
not and something like we disable
JavaScript we have JavaScript bat file
is going to load and it's going to
change the world for us and we might do
something like this which is very
reasonable and you know nothing
inherently wrong with this but there are
some things that could go wrong with
this you know there's a lot of things
that could go wrong but those things we
don't know what conversations is we
assume in this case is an array or
something that really like we don't know
that and actually a whole lot of things
have to go right
for that not to break this is common we
do this all the time save data values
the truth a truth is fine we liked
Ruthie but in this case no again which
you know so truthy data they do not
value it really kind of going down this
road of saying do we have what we want
but we don't an interesting with this
example what's value is it a string is
it an array is it something else that
implements the same method who knows we
don't know again similar example gamma
you know truthiness we check for this
thing of saying we had we have something
does it contain something yes is what we
think it is no so we use type of you see
that a lot its operating jobs get built
in awesome and it does what it should do
for all these examples that's really
great but it doesn't do what it should
what you expect it to do for these
things and we that's probably ask all
know this we all know this type of a ray
object type of null object Oh helpful
and type of not a number number not
broken but not useful not useful so a
lot of people know we can use this you
see this in joint Java's get life is all
over the place here is an underscore
season jquery we know we can use this to
check for types and why because there's
a really good spec for it it's very
specific spec that says if this value is
undefined we should return this string
object undefined same for null it's
awesome it's really really specific and
then it got to be more interesting it
says that class b the value of the class
property of this so you're talking out
internals of the javascript engines
which i'll be honest i know nothing
about and then return this string we
have objects class square bracket
fantastic and we've kind of probably a
lot of you would have seen that string
this the square bracket object thing and
we write something to use this because
this is dynamic because this is great
this is JavaScript and everything's
dynamic so we can use our caller apply
function prototype to change the value
and get to it we see this in or versions
of this and kind of loads of JavaScript
libraries again
it's an underscore similar ish things in
j korean other libraries and the magic
here is that where we're calling this
method calling it the context I mean a
lot of you may have seen this isn't yeah
I know this but this is not a lot of
code and I wonder how many people have
got maybe underscore or something
similar which again isn't a lot of code
in the grand scheme of things but you
know this is a lot of what we do so
checking is this is some thing what we
think it is this is such six lines of
code really not massive problem to you
need to write yourself I have something
that does something similar so going
back to what we have a four we have good
at good results for all the things we
started with we had good results for
four which is obviously we want they're
starting to get bound more useful things
back for everything else so now we're
saying right array no date but there's
two on here that still still not really
your useful when we set about the class
the internal class property so in this
case you know the body is h2 my body
element image to my span element HTML
anchor element almost too specific for
most cases you probably want to say is
it an element but you know it's your app
you do eat want and and type a number
still number still in this case just
check a type it's not really useful you
know we're gonna have to go further so
we could go further we can write
something a bit more complicated
application specific we can say we want
to check if that we want not a number to
be a type in our app because it happens
a lot we want to handle that case we
want to we want elements just be
elements and that's just pulled straight
of underscore but you could do that a
lot of different ways the point here is
we're making some special cases for
these things and we could make more
special cases for the app you're writing
that makes sense for the app you're
writing and I think that's fine we go
back to original example rewritten to
make sure we don't have these errors and
if you're thinking was just a lot more
code though really your rise an extra
one hundred and thirty-seven percent of
code or minified again yes it you've
that's how you look at it I mean yeah
it's more but do you want for me to
break in production you've got million
of users do you want Gary's prediction
to be true probably not but it's about
being sensible check four types we're
not doing so could cause an exception or
make code ambiguous don't have to do it
all of the time but when we're talking
about external data things from api's or
whatever let's check it then let's just
make sure that if we haven't been
completely in control of what we're
doing that we're actually checking other
libraries and things like that sajal
move on let's talk about classes
inheritance jos who doesn't have classes
again know this and why does it matter
why do we want classes i feels that we
gravitate towards its developers i feel
like we always end up going back to this
as a structure and rightly so i kind of
want to do this and maybe something no i
don't want to do this but kind of we do
everyone wants to write this and the
reason I say Evan wants to write this is
because things like this exist and this
wouldn't exist if someone didn't want to
write the previous slide and this
compiled to JavaScript me a more popular
example much more terse but still you
know class stands super we going back to
these same concepts all the time and
this exists because someone didn't want
to write this which again I understand
you know you've got a large code base
you're already in JavaScript world and
coffee script comes along and you look
anything I it's really really good i
really like that but i'm already here
i'm already in this world we've got all
this code i kind of don't want to don't
go there and i also don't have to write
this but this is you know half of this
is a utility methods thirty percent are
so we're not going to include that
that's only once okay so we can we can I
throw that away and that's our class
definitions so we can pull that
that'sthat's compiler output now so i
would write this or you know or similar
and sighs look a bit nice in out a bit
more more compact bit more like we want
it to worry we want to be and this is
just JavaScript okay this isn't anything
special this is all stuff we all know
and the only magic bit is this the only
thing we've had to bring to the party
and yeah like you know so lots of cool
things coming we're going to have class
extend
soon but right now we do things like
this and that does this so what's this
doing again not a lot of code really for
you now for to say all you know Java she
doesn't have class so it can't do
classes we can't do this we have to use
something like coffee script appeal to
achieve this and we have something like
this in our code base that you know more
or less exactly this copying static
properties and methods and we'll come
back to static stuff in a minute and
sitting at the prototype chain this is
like classic interview question
javascript isn't it we probably all know
this and I just think it's interesting
to point out that is again it's you know
six or so lines of code so it's
interesting when we come back to these
things are saying we can't do this in
JavaScript roids know it's really
awkward to do this in JavaScript I just
think I disagree i think this is really
not a problem although it's nice that
these new things are coming right now
still this is fine and we end up where
we want to be we end up in the right
place that few extra lines are closed
slightly different syntax we've got here
and this all does what you would expect
it to do and from then on it's about
good practice and how you're managing
teams are so you're just you and you're
very lucky it's you code review yourself
but we have a small senior developers we
look at each other's code and and from
then on it becomes about standards you
set yourself you don't have to use
getters and setters but it's quite good
too and I've momentum I saw it all go
down with some sort of a you see we're
coming that into define properties and
kind of the s5 s6 stuff where we can do
guesses and setters through the first
example we could actually have gets as
letters for those but if you don't you
know something like the bottom example
there's like kind of an bo who have a
simple set method that takes the key in
the value and allows you to move bind
some staff or listen for those changes
and stuff like that this is just kind of
personal bugbear of mine just because
I'm on stage I get to tell you my
bugbears and not defining things in
class is just so irritating and just you
know just say what you're doing and
describe it usually use it as an
opportunity to put a dot comment in
there and you know say what you're
trying to do is kind of randomly having
this tour a door example you know it's
just kills me
we you know obviously you can do things
with closures in JavaScript really to be
easily but if you are writing you maybe
you want to write some tests may testing
private methods is a bit too boo but if
we want to do things like this then just
mark it as such you know this is this is
fine you you know this isn't someone can
still call that method yeah let's not
we're not going to convince ourselves
otherwise but you know it's simple but
let's make it clear to other people and
to ourselves coming back to hear what
we're trying to do i mentioned static
earlier and then the first example isn't
wrong yeah i mean it's not wrong but i
just think it's I think so maybe we
forget we can do this this is just you
know with it with this extends method we
saw previously we're copying all this
stuff along as we extend stuff and this
is just a nice estructura thing for
things that exist across all instances
and you know standard i/o stuff but we
don't you don't see this in JavaScript I
don't see this in other libraries by
thing you know she's really nice so
we've got classes we've got type
checking we've kind of gone down this
row if I think these things are not
really big problems for me no can we
deal in this all the time and
asynchronous code everywhere everything
in Java is a synchronous pretty much so
it's in the web would we live in this
world of asynchronous and we live in
this world is going two choices I said
we have callbacks or promises and you
kind of sit on one camp maybe in you you
know like one of the other more the more
than the other promises you need a
library let's say it's not part of
JavaScript this isn't something you can
just do no open a fire laughs and you've
got it you're going to have to include
something and there's different
implementations of these things you've
got a decision another another choice to
make in the project of what you want to
use and if you're thinking of doing it
yourself but it's kind of complicated I
mean this is just the then method like
this isn't easy this isn't trivial see
if we don't want to go about writing
this yourself so I suppose you're here
and we all know this everyone knows this
and there's no choice you have to now in
to call back hell and I'll share with
you something I found
I've come to the conclusion that
callback hell is a design choice and not
an inherent flaw in the concept of
asynchronous function plus call back
design choice means bad code basically I
don't have to go down this road we don't
have to its use call back to you still
have some relatively nice code this was
my callback hell from maybe like a year
ago when i joined company i won't name
and shame anybody there was something
along these lines and I kind of like
lots of things going down this chain
getting deeper and deeper and have to
set for callbacks success failure
there's a lot of this going on because
professionals anonymous functions action
in our hand is miles apart really hard
to follow really hard to work out what's
going on node style for me is just this
is you know this is cool this is this is
great this is really elegant and it's
really simple nope it's not complicated
in any way this you kind of stick to a
standard pattern of we've got a callback
our first thing is going to be some kind
of error or null if there's narrow and
everything else is our is our is our
response and over the say like a year
kind of answer me now general
refactoring and moving towards this with
that previous sample kind of became
something more like this a simplified
version but this kind of thing and
didn't have to include any additional
libraries didn't have to wait for some
new features to be implemented just you
know just a change of structure and I
think we've left call back hell for me
now and we have named methods and we
have no binding also should mention that
all of these methods of bounds the
correct contacts and you know instead of
a one big method or ii do think creating
all these anonymous functions we just
set up a scene we have all these methods
ready to go and it gives us this nicer
structure so to avoid callback hell the
officer would avoid anonymous functions
well why watch for Voight anonymous
functions and get use of stack traces
for one a kind of assigned pore
structure because an anonymous function
generally is kind of just thrown away
after you're done with it it's kind of
rare that we do something well we just
throw away their we did we do something
once you know so make an API call we
probably do it quite a lot of times so
we might as well hold on to that
function others are just creating it
over and over and over
and every single time we keep things
really shallow but interesting about
this if things aren't shallow you're
probably using anonymous functions
because that's how you've got into this
deep world and which means you've broken
the first rule which means everyone will
hate you so a synchronous code so
finally all tying together these things
up a bit bad performance really briefly
because it's a talking itself how do we
stuff affect performance how much do we
need to worry about it in production so
we only win that you can do we do
benchmarks and we see what's faster
what's not faster when you're actually
working on something we're looking at
when you know it things like kind of you
I performance and things like that and
profiling in a memory management this
often comes up first when we talk about
kind of performance talk about things
like this and you know I've been I've
been down this road I think a lot of
people been down this road do you think
you know the top example is just so much
better it's going to be so much faster
and it is fast so we all know it's
faster okay don't even need a benchmark
service that it's going to be quicker
but is it going to be noticeably quicker
is it gonna make any real difference and
is it going to make things easy to read
or harder to read I think this point
where we have to make good to be
sensitive about things and as I mean
beginning the talk right sensible code
so yes it's obviously faster but is it
going to make things better for us in
the long run another example is
something like this and I think the top
line is kind of fairly rookie jquery but
you know whatever it's the concept here
is we're saying i want to get every
anchor in the world and i want to bind
click listeners to it that could be a
lot of anchors in the second example
we're using some delegation these
delegation you see in every NBC library
it's really not very hard to do and
again I mean I think you see there's
quite a lot I think this is used a lot
and but huge memory management benefit
here and finally just we go back to our
vision example of this kind of HTML file
that has nothing in it we're going to
have to do things like this were
probably gonna use templates so this is
kind of trivial example but we're going
to build up some HTML and we're going to
put it in the DOM and if we do it in the
first example we're kind of appending
things and then searching for something
and then appending something and they're
searching for again and then append
any like messages might be like a 100
messages we want to render and it's
going to just look awful on let's say
mobile and I work Pacific on mobile and
even your iphone 5 and kind of you know
android s fours and things like that
it's just it's going to just look awful
it's going to it's trying to render all
these things and any animations you're
going on any transition just going to
fall off flat on their face and you know
and it's just a good good person while
we're doing the bottom we do this
everywhere in our code and moving from
this top example again we saw a lot of
that and would like that no it's bad so
when we talk about performance I think
actually we should be here first we
should be at Dom operations before this
is good we shouldn't even worry about
everything else because well I'm talking
I'm talking web josefina doesn't apply
if you're purely server side stuff but
web you know this is where we should be
we should make sure this is really good
when this is really good I think then we
kind of start here we start saying event
listeners and things like that how much
stuff are we holding in memory then we
start looking at that finally if you've
done all these things you're lucky
enough to go and look through all of
your for each and map and filters and
change them into four loops then you
have a happy person another spot
performance so I talked about a little
bit it's kind of things like this and we
had weird something like this in our
code simplified version but very very
similar where we're just kind of
wrapping local storage you're probably
doing a few other little bits and pieces
but ultimately just kind of getting and
setting from local storage loucks which
is quite slow reading writes a disk and
on mobile really quite slow and so we
were seeing on you know again any
animations any transitions only it's not
that you know you start seeing these
real light or a door and you realize
you're getting when you get down to the
bottom bit that we're just saving
something for local storage you know so
how can we avoid these things easily and
there are some good libraries for
storage and you know kind of abstract
oil these things and maybe give you the
ability to use index DB and things like
that and but really again not that hard
to just say okay well you know let's
just optimize this a little bit let's
have something from memory just hold on
to it let's make reading quicker by
holding onto things as we've got them
and it's save things for later so all of
this works this isn't really very hard
again like like a lot of the previous is
I'm saying I mean these are kind of an
extra six to eight lines of code
I think that's fine and that's the end
of my topics so thank you very much
you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>