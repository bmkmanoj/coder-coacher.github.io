<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Alex Castillo: NeuroJS - Capturing And Visualizing Brainwaves With Angular 2 - JSConf.Asia 2016 | Coder Coacher - Coaching Coders</title><meta content="Alex Castillo: NeuroJS - Capturing And Visualizing Brainwaves With Angular 2 - JSConf.Asia 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Alex Castillo: NeuroJS - Capturing And Visualizing Brainwaves With Angular 2 - JSConf.Asia 2016</b></h2><h5 class="post__date">2016-12-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/S7M2Dj-_fwU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">great awesome thank you Justin for
introducing me my name is Alex Castilla
I'm a software engineer in Netflix but
today I'm here to talk to you about my
side project so I build software to
understand human behavior and one of the
sources that I based my research on is
electricity the human body is an ocean
of electricity everything we do is
controlled and facilitated by electrical
signals are running through our bodies
well today I'm very excited to tell you
that we're going to use JavaScript to
witness some of these electricity in
real time but before I proceed I will
actually like to get a volunteer that is
going to join me on stage and it's going
to wear the nerdy hat anyone up for the
challenges raise your hands I have one
here two here I see someone jump in
there I'm a little blind but you can
come yeah thank you whoops whoa what's
your name sir a mint payment payment
yeah all right nice to meet you all
right please come here
take a seat and I'm just going to put
this on your head did you look like you
don't have a huge head which is a great
thing because sometimes this doesn't
feed and people have to you know exit
but electrocute you we'll get to that
part yeah
you scare me man all right so you're
gonna feel a little bit of spikes but we
actually want that because those are the
electrodes are going to make contact
with your head make sure if it heard
just let me know it shouldn't but yeah
you do have a good head for this headset
god bless your parents so I'm going to
put this your lobes here that is just so
your head doesn't explode so just okay
I'm going to turn it on if you can just
stand up real quick and turn around so
they can see that it's on just turn
around you're gonna see a blue light
take a seat relax and and just so we're
clear I'm gonna have pseudo access to
your brain just relax
and don't think of anything
inappropriate all right all right if
you're not the guy for this just let me
know how we can save you the
embarrassment all right and I hope you
got some time to read the fine print in
here it's not yeah all right so I'm
gonna take what is going to capture the
signals from the hats and I'm just gonna
plug it into my computer
good I'm gonna exit my slice and just
start running node all right so I'm just
gonna run and no doubt that I'm gonna
walk you through a little later but what
we want is to visualize it's just gonna
take a few seconds it's gonna enter your
brain and we should start seeing
something real real soon if you have
something on your head
all right of course
I should have turned these on after that
so let me just fix it real quick all
right there you go are you comfortable
there
awesome I'm gonna give this one more try
oh there must be something wrong with
you man
exception yeah for sure there's
something completely wrong with you
I'm gonna try to fix something here and
see are you thinking of something
inappropriate right now that would do it
for sure oh no man yeah yeah
this is this is not great I have to kill
the process it's your name process
I'm not running anything else let's give
this another try
otherwise I'll have to kill the process
okay I'll have to what is the command
again kill or no - nine
now kill oh yeah
okay this is embarrassing part when I'm
going to go to stack overflow you know
you all do this right you all do this I
don't know how many times I've had to do
this before
all right I knew we had a nine I knew
had a nine
there you go up what I don't have is a
PID and I have to do a grab first yeah
no you're making this very difficult
11:07 fifty which one Jesus where is it
kill and the PID is 1050
thank you thank you for your patience
but that didn't work I'm gonna give this
another try
although what is it gonna have to be
honest with us again yeah
well I give me one second of this one
second I try this one off plug this one
in turn this one on again
oh no comment oh there you go
thank you guys you do have something
great thank you for your patience is not
easy interacting with the human brain
with JavaScript alright so what we have
in here I'll walk you through but first
let's just see the fun stuff right and
let's start by checking out some actual
brain waves all right we are getting
some signals in here what I do see is
that there are some channels that are
not making contact with the scalp that
will be channel 1 2 3 4 5 5 &amp;amp; 6 okay so
I think this one here there you don't
move okay this relax if that one doesn't
work
it could mean you have nothing in this
area I'm just being honest here is it a
little tight I think it's that I think
this is just way too tight that means
you have probably a whitehead there's
nothing wrong with that though can you
feel that all right we have one
there you go now
one two three one two three this one
here almost almost almost
all right I think we can proceed with
what we have
don't shut down that part of your head
just you know it's just think of
beautiful things all right we'll work
with those seven okay all right so this
is some of the brainwaves visualized in
what we call a time series all the
contract is it's not great in here but
what you're seeing is the electrical
signals being captured by the headset
and being displayed in a web browser and
for a second time I'm going to show you
different ways we can visualize this if
my window would just all right fine
or right right
so I'm going to stop it and run in one
more time
with your server ok I think I have to
the trick of stopping again the process
to 1015 1172 it's okay
right this is good foot before it for
now I'm gonna stop here and I want to
walk you through what just happened okay
so please give it up for our volunteer
here thank you
yeah wait careful right thank you so
much fun thank you we really appreciate
it
all right okay so what just happened
here
this is what I called New York
JavaScript and what is New York
JavaScript new javascript is not this
keyboard helper at all but it's a
combination of some concepts right
isomorphic javascript is one of them
newer technology data science data
visualization open source and more so
I'm going to walk you through step by
step how we came to visualizes brain
waves in the web browser okay so the
first thing we need to know is that here
I have a headset and that headset it's
from a company called open BCI and the
great thing and what make this headset
so special is the fact that this is
completely open source and it's mostly
truly printed so as you can see here
this mostly plastic what you see is in
white and in red this is all plastic the
other part of it is actually the board
that is actually doing you know all the
computing and then you have cables that
end up in some sensors and these sensors
are called electrodes these electrodes
are actually make contact with your head
and you can see here animation of how
actually comes together it's a lot of
tiny parts you can actually go to the
github repo download all the 3d files
print it yourself order the board
separately and you split it together and
get up and running the next part that I
want to show you is the use
dangal the USB dongle is this guy right
here that is what actually connects via
bluetooth to this board then it gets to
the computer right as it's plugged in is
USB via serial port and that is exactly
where node takes it in and let me tell
you a little bit of how known takes it
in just probably doing an NPM style for
the open PCI SDK you are able to start
interacting with this so what i've done
i've created a series of like classes
that i've strike this process in order
for me to use that data that you saw and
start doing stuff with that so i broke
it down into some concepts I have some
connectors and connectors they basically
transmit the data right and right now
the connector is like Bluetooth via
serial port I cleared it in an abstract
class so you can choose from other
connectors that might be available in
the future for example maybe one of
these this dongle maybe we can just
connect the Bluetooth directly to the
computer maybe we can just do it through
Wi-Fi maybe we can do it with the next
thing that comes out then we have
providers these providers actually
capture that signal and they facilitate
and they basically distributed to our
node application then we have modules
that they take these data they transform
it into different formats one of those
formats for example is a time series
another format could be a fast Fourier
transform and I'm going to walk you
through it by simply just instantiating
some of the connectors and signals we
can then start and instantiate and
initialize our modules in this case we
have some FFT we have some topographic
data we're going to be I might be
showing you later and then the time
series which is exactly the lines that I
show you first
they all take the signal which is the
provider that I was talking about and
lastly we can just invoke a method
called stream that basically makes
available the data and we pass it to
different providers like the signal
provider or motion capture signal
provider is that data that is is sent to
the front end and for example motion
capture in this example this bore
actually contains accelerometer data so
that's something that we can also use so
you will get coordinates of like XY and
Z as you're moving the headset which is
something that you can also play with
you're going to be getting one sample
every four milliseconds right which
makes a 250 sample rate and a sample is
what I show you from the node terminal
and it looks something like that the
most relevant information here it's
actually the channel data that is what
has the signal from each different sides
each different part of your brain so in
here we have eight and that is what
you're getting some of the actual nodes
are just for comfort so they sit on top
of your head the other ones are actual
electrodes and those are the one that
pick up the signal ox data is emotion
accelerometer data that I was telling
you about and then we have over type of
metadata like the start by the sample
number stop byte etcetera lastly we're
using WebSockets from node to send this
data treated in a different format that
I talked about FFT teleport I'm serious
and we use WebSockets to send it to the
client to the web browser and in the
example that I show you there are many
technologies that are being used one of
them is flatly we have smoothie charts
for the time series we have three GS for
some WebGL data visualizations that I'm
working on
we have charged a s we
Angra to which is the actual app and
what is putting everything together the
time series looks something like this
most of the time on a very well headset
that is calibrated and everything in it
has data coming from all the channels
and I'm going to walk you through some
code samples with angular 2 that show
you how you can capture this data from
WebSockets and how to display it on the
browser so who has these tight script or
angular 2 here can you please raise your
hands all right we have like a few
people good so I chose angular 2 because
I build the app using other different
libraries and angler two is where I
finally landed it had great performance
benefits that really helped me
accomplish this in a way that was
effective and scalable so I'm important
from dependencies including some
components from the element reference
and some component lifecycle hooks for
example the component is ready and when
it's destroyed then I'm importing some
dependencies for like the smoothie chart
this example is going to show you that
that time series I was telling you about
and before I do that I'm gonna quickly
fire on my simulated data
right so skinny if I see in the meantime
let me keep showing you some of the code
this is an annotation that you can do
with type script which is angular 2
specific you can see the add component
which basically points to a selector
which is like the BCI time series we
have a template URL we have a styles and
we have some providers this the angular
2 AP a-- has changed a little bit since
then but it's pretty much very similar
but if we're looking at the template of
this if we're looking at the template of
this component the most important part
is that it has a canvas element because
it's Moody Jes is foodie charts uses
canvas so then you're gonna see some
angular to specific syntax here where
you have the brackets for binding and
then you have the actual class
definition which is just an es es in es6
class that implements the on in it and
on destroy from angular 2 some
dependency injection via constructor and
finally then some data structures that
we're going to be using in order to fill
our data so we have some smoothie chart
containers for the time series the
amplitudes are the values are shown to
the right the numbers change
positive and negative energy in
microvolts then you have a time line
which is the second that you have at the
bottom telling you exactly where in time
that data to be expressed and then we
have lines which are eight lines from
different parts of our head all day all
of them they map to a time series
container so when the component
initializes we're going to be calling a
function that is going to basically
initialize our smoothie data structures
and then
we're going to be using socket IO to
listen for events that are related to
time once we capture those events are
related to time what we do is that we
get data back so this is exactly the
data that is coming from the server but
pipe through the connectors the
providers the signals that I told you
about that are basically reciting the
data to be kind of like fun and friendly
so we're not sending a data event to the
client every 4 milliseconds we actually
have a buffer a node that we're
aggregating a certain amount of data I
think probably every like 64 samples and
then we're passing it through some
filters and there was something into the
front end
ok Calendar so once we get that data we
replace the amplitudes object these
amplitudes is basically what is what
we're binding to in our template so
amplitudes is an object that we have in
our template and we can have that data
available for us to basically
semantically Express we have a time line
which is basically an array of seconds
and then we're appending time lines when
we append time lines
when we append timelines here we're just
going for each one of those channels in
this case 8 and we are basically
appending a data point right in this
case a line that is over calling aligned
so each one of those eight lines they
directly correlate with this part here
so each time we'll receive an event we
go through each one of the channels
we're appending with the current date
and time right with the current time and
we're passing an amplitude that
amplitude is just that data set that I
told you about here
from each other the different channels
and in this case when we're adding the
time series initially right that's
function that I show you right here
we're just making sure that they have a
stroke style that map to the color that
we want to use in this case is just a
lid an array with eight different colors
so we can classify a by color something
that is very important to mention is
that because there's going to be a lot
of events being received by the client
you know on the browser is very
important that if the component is
actually not being displayed in the
application basically when it fires the
undestroyed event from the angular 2
component life cycle we need to make
sure that we remove that event listener
because if we have all these events
still lingering from other components
are also showing data visualizations
then it's going to overwhelm the browser
it's going to probably freeze ultimately
this is just a little bit of more
angular 2 template that shows how to do
a repeater in angular 1 it was like it
and you repeat in angular 2 we have an
NG 4 and then we have a more es6 style
type of declaration here when you have
read amplitude of amplitudes and that is
exactly the amplitude element that has
been shown to the
the same for the time line were
iterating through each one of the of the
time line elements that we have I
believe in this case like 18 where
actually is in an html5 time element
with a game time attribute that
basically formats that formats that time
in seconds into readable human seconds
great so that being said I want to talk
to you about this product a little bit
I've been taking this in phases right
now it's just phase one which is simply
visualization right and we've put a lot
of work into just making sure we can
visualize brain waves but there's so
much more that we still need yet to do
second phase is going to be about
experimentation so we can actually take
that data do something useful with it
right and I will give you few examples
ultimately interpretation which is
really just really thoughts I believe is
possible and I believe that each one of
you with your JavaScript skills could
get to contribute or to be part of
something as big as this this is why all
of this work that I've shown you today
including the hardware everything is
open-source and very affordable just to
put together a simple headset this is
just an example of some experiments all
the people have done this one is in a
JavaScript as specific but there's
nothing that is actually stopping us
from starting to control things and
doing things with our current skills
here imagine you can control user
interface with this headset maybe
someone's disabled and now has the
ability to do something with their
computer and there are so many other
things including like maybe controlling
your wheelchair accessibility for the
web and actually just getting to know
ourselves a little better think about it
all the data is right here and we
struggle with knowing ourselves
sometimes but I think now we have the
power to take that information and
with something meaningful with it so I
encourage you to get involved there are
many many meetups about New York tech I
used to go to one in New York City but
there are in many parts of the world
github repo that I've been doing all
this work in is New York is in there you
can find exactly where sure today that
whole app and there is an open beside
community it's not JavaScript specific
voice from your tech oriented and
everyone is welcome there so that being
said please keep in touch and let me
know if you have any questions let's
give this another try
I came from very far and I'm gonna let
the cold or jetlag get in the way so
thank you for joining again let's see
all right so you have only one channel
that is not really connecting well that
is 1 2 3 4 5 6
I think he doesn't have anything on the
side of the head but these are their
real brainwaves that I meant to show you
so thank you so here you can see to the
right you can see the voltage and you're
gonna see that fluctuating between
positive and negative values because
that's the way electrical signals work
they don't mean anything like positive
energy is not with them negative energy
is going to fluctuate so something else
I wanted to show you it's actually the
frequency when you pass a signal to a
fast for a transform this is actually
the frequency this is not like going in
time this is actually in real time the
way the frequencies translate so the
channel let's see the yellow one is
channel 6 that's the channel that's
we're not getting anything from that's
what you can see use today alright and
it towards the middle you're going to
see around this area here that things
are changed much is because in that part
of the frequency is being picked up by
like so I'm even like the background
noise so yeah just like the ambience
right like your body's receptive to that
so it's actually going to be translated
so you can see some of that well yeah
yeah and also is worth mentioning that
this headset in particular is also going
to pick up some emoji which is like the
muscular signals so let's do a little
experiment try blinking a couple of
times to
right regular horror yeah yeah so you
can see some of that being picked up
around here it gets very interesting
when you start seeing the frequency
categorize by different categorize by
different frequency bands so if you're
familiar with like data data alpha and
beta I can tell you for example
according to some experiment if you want
to measure hunger occurring to some
doctors some of the Delta band is going
to get lower and some of the alpha and
beta is going to get higher right so
this is also used to like measure
progress when it comes to like
concentration and meditation take a
screenshot take a screenshot yeah there
you go
this is just another way of showing
frequency in a 3-quart type of layout so
try to sleep in your jaw like like you
were like chewing something you can see
that being okay you can see that
actually the manifested here yeah yeah
but whatever you do okay thank you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>