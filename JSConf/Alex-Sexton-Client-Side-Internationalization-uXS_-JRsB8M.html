<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Alex Sexton: Client Side Internationalization | Coder Coacher - Coaching Coders</title><meta content="Alex Sexton: Client Side Internationalization - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Alex Sexton: Client Side Internationalization</b></h2><h5 class="post__date">2012-11-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uXS_-JRsB8M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I am actually gonna talk about
JavaScript internationalization there's
not a ton that people are doing on the
server side right now because a lot of
that's been figured out a lot of the
libraries well every library that I'm
gonna be talking about works in both
places so feel free to use any of these
modules or whatever in in node so
JavaScript internationalization
generally manifesting itself as a web
app that you're using so yeah that's all
so about me or about this talk I'm not
actually that great of a speaker but I
talk a lot about beautiful language and
so that's kind of a cool dichotomy so
also people think that I can speak
multiple languages because I talk about
translations and I think that's German
for I don't speak other languages so I
like to say that this is a problem that
it's a it's a data problem it's a
presentation it's a template problem
like there's it's not a language
necessarily form you have to understand
the the restrictions and the the things
that you're set out to solve and you can
solve it without you know knowing a
bunch of languages it helps to know
people who know multiple languages
though it's quite helpful so this is
less about internationalization
specifically and more about user
experience because really what you're
trying to do is is give users the the
best chance to understand what the heck
you're trying to get them to do but that
in this case turns out to be
international good internationalization
so what we're talking about when we talk
about messages and we talk about
internationalization I'm gonna talk a
lot about the message side of things for
now there's things like right-to-left
and and in quite a few things in
internationalization but a lot of the
pain that we struggle from these days is
is in message formatting and message
displaying so so you might not think
that it comes up much or you might think
that it's the same as translating like a
paragraph or something but it's not so
anytime you're mixing data and a phrase
much like you mix data and a template
and out comes the actual you know markup
for a page that's that's what we're
talking about with messages so you want
to consider problems like there are five
results or there are three new messages
or welcome so and so come see why your
score is X or you need X more points
that continue things like that are the
types of sentences that are actually
incredibly difficult to write in a way
that work in every language as much as
as you wouldn't think so things about me
is I like to build JavaScript programs
my mom was English teacher so there's
some background
those are my stats I started out a blog
post called the UX of language with this
tweet and I really liked it as kind of a
base for talking about this kind of
stuff it's kind of you tell I favor did
it and it's it says web program is the
science of coming up with increasingly
complicated ways of concatenated strings
that's kind of beautiful but that's
really what we're talking about and
really like in the end of the day if you
take about the JavaScript like what you
see is just a bunch of concatenated
strings so thanks Greg Brockman for
setting me up so I'm gonna give you a
brief history of string concatenates web
was four documents so it's static text
files rolled the web obviously no one
was running I term two so that is not
the best screenshot but either way there
were documents right and translation was
the translation of documents is no
different than translation had been in
the past some time passes montage video
if you will and people desire to
customize content and this is a huge
shift in the web right it stopped being
like look at this look at this look at
this and it became like here's something
for you and so this was the era of
literally just outputting concatenated
strings so if you remember like cgi-bin
Perl that kind of stuff like yeah line
endings inside the print statement is
awesome so you
like the original google app so then
after that crappy templates came around
you might recognize a language called
personal homepage or PHP hypertext
preprocessor however many levels deep
you want to go and and this is it really
was a template language like they wrote
it as a template language and then just
grew and grew and grew and grew and then
later it became like a actual language
kind of JSP and ASP are similar examples
of this just like write your app and
your your code all in the same line so I
used to write these sweet PHP F so it
was just like the top had like database
access and then it had like the doctype
and then I had some logic for like if it
was a login screen return and was
awesome it was good there's good days so
I call that the nearly 10 years of
string concatenation dark ages and then
around 2004 you started seeing I mean
before you saw but we really came
popular with some of the major NBC
server-side frameworks rails and Django
and that kind of stuff
spring if you will so logicalis
templates came into popularity they're
not necessary but they they became like
a good way to really really D couple you
know apps and and HTML so like 20
something years later we can finally
render HTML all right so what about
render get sentence how is it different
so a template sentence so this is
handlebars template I tend to like those
so this seems good welcome to the site
so and so Alex
so we'll try another one hi Alex you
have blank new messages seems good but
it's not good because there's a case
especially even in English right so it's
hi Alex oh you have one new messages and
that and that's bad that's gross
I believe I said so this why this talk
is is considered the the UX of language
we want to avoid situations like that
and it gets much much worse whenever you
start going into other languages that I
don't speak Sark
traditional way of concatenating strings
together isn't sufficient when those
strings form a coherent sentence so this
is like a rhetorical question but but
this is this is something that I used to
do and I still find myself doing it's
like when I make my template I make sure
that even when the template runs like
all the brackets line up nicely in like
the indented what right like so I spend
time doing that and then I don't
actually have good sentences on my site
so this is the sentence we were we were
talking about earlier you have two new
messages so this is this is some of the
ways that we saw this now kind of this
is this is our solutions these are our
solutions English so the first one is
just ugly
it works in English it doesn't work in
every language if you have more than one
additional way to pluralize something
you'd have to have like some or
operators in there it gets bad and the
second one is considered prefix and
postfix sometimes it works but other
times it's still just it's not very
personable if you consider something
like Facebook's application where they
say like Alex x10 and three others like
this product that would be really bad if
it was like people who like this product
other than alex sexton three so plural
branching is it's really what we want to
end up doing so let's write some code to
to figure out when we want our branch on
the two different strings so in this
case you can you have in English right
you say if it's one you have one new
message
and you have two new messages right and
so in Spanish if you're trying to
internationalize your app you have a
branch and you say okay now I'll do this
this message in Spanish and this message
in English and that's cool but this is
this really gross it's directly coupled
inside your app code and that gets
really big because here like some
commonly supported languages and not all
of them just have to pluralization forms
I think I was feeling
sorry so so a lot of people immediately
say all right Alex like I understand
this is bad I'm internationalize an app
before we use get text in our Python app
or we use get text here and I'll get
back to that that's the next almond
picture it's a good comic but I'll get
back to to that so hold your horses so
navigating the the message landscape so
I'll just go into like some of the ways
people are solving this properties files
is something that that often comes up
they're usually just for foreigner
initialization they're not necessarily
for actually like plural forms and
things like that our gender specific
specificity sometimes I'll ask someone I
like this metaphor someone what a friend
of mine gave me it's like I'll ask
someone do you support international
strings in your application and they'll
say yeah we have properties files which
is the same as saying is this TV
high-definition and someone saying yes
it has pixels I mean it's not no it's
just not a guess either right so it's
essentially a set of key values pairs in
this case these properties files are
some objects that I have and it's good I
forgot how good at Spanish I was the so
so this is all it is and then whenever
you write your application it just
sticks those strings in so this pretty
calm and you'll see it in Java rails
Django has this kind of stuff pretty
much everybody who's doing translations
you're kind of writing all your messages
in this file you send those off to
translators they send them back and you
switch them out so it doesn't really
address any of the hard problems with
rendering different strings for
different locales other than it renders
one string for for every different
locale let's it's not really what we're
looking for so a lot of times people add
sprint F so though I had one level of
indirection and then they'll put you
know the % deed and say a number goes
here you have blake messages right so
that's that
the same case we had before where you
have one messages again but it's better
than nothing so you can have data in
there again but you solve old problems
but our templates suck now because you
have two likes printf everything inside
so we can switch our messages and we can
interpolate data into them kind of like
a template but they're incorrectly
pluralized and devoid of gender and
context that's bad
so authoring templates also starts to
suck because you have all this HTML and
you have no context of what you're even
talking about you just have these keys
back to properties files and everything
doesn't look like what you expect it to
look like so go back to Stallman and get
text starts to solve some of this stuff
Pio files are the form of data exchange
that they use there's like the Mozilla
poodle project for translating and
that's P oh oh right so it's it's for P
alpha it's get text I'm sorry
so it decouples the data message which
was really what we want to do so they
got a few things really right and get
text this is like a JSON version of
maybe what a PL file would look like in
JSON you give it a little Cali go to a
plural form and so this is really
important you say I'm defining my
indexes for my strings in this plural
form and so in English Orion us up here
my plural form is if it's one return to
zero and if it's to return one or if
it's anything else return one and in
which case you'll grab that index out of
that key so if you notice the those
indexes match up to the correct string
there and then you'll run sprint F on it
and that's that's pretty good solution
so there's different plural form
functions it's it's kind of a C API
because it was written like in 1970
something this is the English Proform
splendors Spanish plural form looks
exactly the same French is a little
different zero is kind of like more like
none it's it's a it's translated along
with one so it's that's a singular form
kind of Slovenians crazy I like this one
because because you have like mod 100 in
there at all and I guess it's the
closest
the closest thing I can think of to that
is like in English we have first second
third and then it's 4th 5th 6th 7th 8th
and then when you get to like 21st 22nd
23rd it does it again right and so
Slovenian like that's just the way they
pluralize everything Welsh really sucks
too as far as how many different key
words they have so messages as keys is
another interesting thing that a lot of
people will do at get text so you stick
your whole message in there and you have
you have both you have your default set
in there directly and so in this case
you can see all your possible messages
kind of in line in there and then
they're used as the keys themselves so
then they go back through the get tech
stuff and they can be switched out so
you can kind of see what will eventually
be in there but also you can still have
properties files or Pio files in this
case a lot of people will fuzzy match
these so you can like switch out a comma
without screwing everything up but it's
harder in client-side JavaScript to
fuzzy mesh things so there's there's
quite a few things that the features
that we can do we can kind of hack
gender onto the top but but really what
I want to get to is you still can't do
things like concatenate two separately
translated strings together that never
works
so I like my red shirt can never work
because like languages will switch
things around so because you're implying
an order by doing string concatenation
you can never do string concatenation
you have to always completely translate
a full sentence together so that's
important so we'd get text we can
PluralEyes messages can interpolate
messages we can PluralEyes our message
correctly for each locale so we now have
that capacity we can kind of have
templates with the messages inside of
them good enough maybe we can use gender
specific words if we use context for
gender and it does it does a pretty good
job at most of the things that we need
so get text is used in the in most Linux
projects and Everett like tons and tons
apps use use get text and so it's a
pretty good solution so so this is kind
of what some of the reasons why you
might use it so I wrote Jed and I'll
probably change the name soon I'll let
you know why Jed is the emcee of the
other track he's he up until a few
months ago he was a trick translator
that was his full-time job he was just a
hobbyist JavaScript er that just
happened to be better at it than
everyone else I guess when you have a
hobby it's easier to have fun I don't
know he's just good so I named it after
him cuz you don't come across three
character names that often that work so
there's I added kind of a chainable API
for it if you want but you can also use
the old gross see api's and that was
cool so why am I not gonna recommend it
so if we go back to English we can I can
give you a new sentence a new hard one
not too complex there are three messages
from two people and so remember you have
to translate these all together and
that's bad because get Tex can only do
one plural so the plural form can take a
single input so also I guess the another
problem is if you have context like you
have a menu and you have a footer you
want to use that for your context not
genders so you can only go one level
deep on any of their features you can
PluralEyes one thing and you have one
context
capi is gross you can fix that yeah you
also have to repeat plural forms you can
get around some of this really there's
quite a bit wrong so norbert Lindenberg
told me about ICU message format
whenever i put that out they actually
kind of crapped all over it and i was
pretty disappointed but they pointed me
towards ICU message format and really
that's just plural format plus select
format IBM I think kind of runs most ICU
and they specify things like
internationalization standards and
things like that there are six key words
that map to different numbers in every
language different polarizations
and then they'll define plural functions
that map to those words this is the
syntax for message format so it's it's
pretty small and so I wrote an
implementation of message format in
JavaScript and so you can see see here I
can switch these out I'm probably too
short on time to do this very often but
I'll do one you can do that and then it
changes as a to messages so it's a take
grammar for describing
internationalization and message
situations right so you can have
literals that happen before the the
message format things and those just get
sent in if you don't need multiple
language it doesn't matter you still
need to do this in English right so this
is still a very hard task to do in
English because it's five results in two
categories or one results in two
categories or five results in one
category that gets excessively difficult
and then you had gender and it's he or
she received five results or one results
or one category or two categories and
just explodes and in that same case you
can do multiple plurals just in the same
sentence it's just two separate message
format parts in the sentence and then
you can nest them or you can do select
format for gender and you can get he
found five results in two categories and
I could change any of those and it'll
automatically output the correct string
you have named arguments so this is just
replacements and things like that you
can add plugins
this one's highly readable what this
will do is output every form of Alex
added himself and one other person to
his group it's using an offset plug-in
to say Alex is included in the totals
but he's not included in the other
person in this group so that's why the
plural amount of people is too but it's
just one person that's there so you have
complex plugins to to do strings like
this and this is like straight out of
off of Google's homepage or Facebook's
Google+ all this stuff the only couple
of apps that have decent you know
complex translations its translator
friendly in the sense that everything's
translated together you don't to
translate one sentence that's directly
related to another sentence completely
separately from each other but it's not
translator friendly in that you have to
be a programmer to understand the syntax
at all
so that's message format j/s it's
compiled able so it takes the input free
compile it out to a raw JavaScript
function it uses a parser expression
grammar a lot like ila did this morning
generated a is T and then and then spits
out JavaScript that doesn't even require
the original library so it integrates
directly into handlebars you can write
your messages directly in there it'll
it'll pull all those out compile them it
compiles them just like a template so a
little short on time but I just want to
talk about what the next steps are
tooling is really what's up next so how
do we use how do we get to use these
complex good solutions for translations
and then actually get our things
translated javascript
internationalization still in in the in
the dark ages so it's totally possible
to write good tools around these new
formats and so that's why I'm open
sourcing the JED toolkit which is a
whole family of internationalization
tools both libraries and like actual web
apps and api's
that you can set up in a stack to help
translators and do all this stuff so
it's tools and libraries
I want developers to be happy on a kill
like the two-month code freeze for the
translation time I want to automate
sending strings to translators and make
their translation experience much better
I have Jed toolkit org that you could
visit there's a picture of him we can
click on that and then I'll be done but
I'd love to talk oh he's down there
there he is so I'd love to talk about
how that web app works with a bunch of
people I've been working with some of
the major translation companies on
getting them to be able to use these
apps
as their translations kind of spot
because they're still using tools from
like the 70s and Word documents and
things like that and FTP file uploads
it's a terrible terrible world it's like
20 years behind every other place we are
so we can really really bring the
tooling for internationalization up to
par with the tooling that we have for
automated builds and testing and all
that kind of stuff and we'll be in a lot
better place I probably don't have time
for questions I'd guess but maybe one
all right one question do you handle it
any rtl stuff RTL I've been saving the
thing with RTL and I had to do one RTL
app is that so far as I can tell there's
no solution to RTL other than look at
everything individually all by itself
with someone who speaks those languages
a hundred times like there if someone
can create something that's awesome for
that I will totally help you but I don't
have that idea yet RTL is very difficult
it's it's really just like really pay
attention to everything and build new
code pass luckily there's no one's gonna
introduce a new direction in the next
like 20 years to read code so or read
read words so really yeah just have to
deal with the three that exists and
hopefully only two really in the real
world good good okay I'm happy to show
anyone the tool the translation tool if
you want to it's probably not a good
time up here
so thanks yeah it looks really good so
thank you Alex</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>