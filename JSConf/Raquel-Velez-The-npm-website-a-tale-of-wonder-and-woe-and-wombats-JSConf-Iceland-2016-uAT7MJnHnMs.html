<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Raquel Vélez: The npm website: a tale of wonder and woe (and wombats!) - JSConf Iceland 2016 | Coder Coacher - Coaching Coders</title><meta content="Raquel Vélez: The npm website: a tale of wonder and woe (and wombats!) - JSConf Iceland 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Raquel Vélez: The npm website: a tale of wonder and woe (and wombats!) - JSConf Iceland 2016</b></h2><h5 class="post__date">2016-09-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uAT7MJnHnMs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi everyone as you said my name is
Raquel Bellas I'm rockbot on all of the
things now let me just get a general
survey of the area how many of you have
ever used NPM okay excellent how many of
you have used the NPM website in the
last month last week last day use it
multiple times a day okay yeah the
numbers are dwindling that's okay one
day we'll get you using it all the time
forever and ever will be like the next
state no we won't okay now most of my
colleagues when they talk about NPM
they'll talk about the CLI they'll talk
about the registry but today you're all
y'all are in luck because I'm going to
talk about the website so my goal is to
kind of give you an overview of NPM in
general then talk about the history of
the website and then I want to talk
about the lessons that we have learned
in the process of building the website
and that I think is going to be the
coolest take away all right so NPM in
general fun fact npm does not actually
stand for node package manager when i've
actually recreated it it was literally
just a three letter word and p.m. you
could say that it has no prescribed
meaning okay only pun I promise okay
that said it is actually a package
manager for javascript though even that
is a little bit misleading because there
are over 350,000 packages on NPM right
now and many of them while many of them
are javascript-based there are ones with
CSS in them and ones with go and rest
and there's even a little bit of C++ in
there so really it's just a package
manager I like to think it's pretty cool
and so you may know that it started out
as an open source project node came
around in 2009 and that was really great
and people wanted to share code but they
wanted to really use it as like modules
and add those little modules into their
websites or their applications and so
Isaac schluter our CEO created NPM
as you know just a kind of cool thing
and that was fantastic except something
interesting happened people started
using node a lot and with it they
started using NPM a lot this is the
graph of people installing node modules
in over the course of the first four
years of n PM's existence but not only
were they using NPM they were also
really contributing to the NPM ecosystem
right this is exponential like this is
not what you expect in general now there
was a dark period at the end of 2013 in
those days we call the dark period
because NPM kept going down how many of
you used NPM in 2013 do you remember
those days they're kind of dark at
people were relying on node and NPM in
production and then all of a sudden they
couldn't use NPM because the growth was
so exponential and so massive that this
tiny open source project could not
handle the load there was no dedicated
people no real dedicated servers so it
went dark a lot at that point Isaac made
the decision to turn NPM into a company
because we wanted to be able to create
products and services to give real user
value to the point where you wanted to
pay money so that we could keep the
registry up and running and we could pay
people to keep the edge of the registry
up and running so that's how NPM kind of
started and in 2014 I became the first
employee of NPM and the entire existence
of my time a 10pm has been focused on
the website so let's go a little bit
back in time at the very first version
of the NPM website is from jun 2010 and
here's what it looked like it was just a
little landing page there's not much
here it's just a little like hey there's
this thing called NPM go to the github
repo you'll find out more information
there great six months later though
there's a little bit more information
again it's still really more of a
landing page but one really fun addition
is this idea of searching for packages
this is what the search looked like
anybody who uses its back then this is
like a nostalgia static sort of moment
this was a couch app created by michael
rogers and when you only have like a few
hundred packages this is fine this is
totally fine it was in fact it was so
fine it worked for 18 months and then
something really big happened npm became
packaged with node I'm all that in of
itself or the website is not that big of
a deal it does actually mean that there
are more users which means more user
growth and a few months after that the
first real community was was born on the
NPM website this really allows us to not
only search packages but to start seeing
people's profiles and start getting
statistics about about packages and
who's building stuff and and how many
people are downloading it and it was so
cool now the thing about the search
though is that the number of packages
started to skyrocket and Michael's
little couch app didn't quite work
anymore and so it actually turned out
that you would go to the little search
input and it would just take you to
google was like forget it we're not be
able to do this but eventually somebody
added an elastic search engine and we
had really really basic search I'm sad
to say that this is still the exact same
elastic search engine that we're using
on NPM Jess calm right now that's why
the search sucks we're working on it I
promise okay great so after that point
for the next two and a half years we
started this company we started really
getting into the website but something
very very very important really
important happened in jun 2014 we got a
wombat we got our first mascot and this
is our really our only mascot but it's
really cute and cuddly and a lot of
people ask me what is the origin of the
wombat where does this come from now if
you'll allow me a moment of
embarrassment this is the real story of
why we have a wombat as our mascot turns
out that there was an intern who
who was complaining one day about slow
internet and I don't I have no idea what
compelled me I have no clue at all but
basically here's what I said the
internet is a series of tubes which we
all know as a fact sometimes things get
clogged and sometimes there is a leak
because tubes can be broken there is no
fix except to release a pack of wombats
with pickaxes in little helmets and
bright orange vests for safety I have no
idea where this came from it just came
out of nowhere now CJ Silverio who
started a week after me chief chimes in
with wombat developers Union for the win
I don't know where that came from either
but see here's the fun thing if you take
the npm logo and you invert it it's wdu
so boom of course obviously we should be
the wombats developer Union so if you
love our wombat shout out to its John Q
on Twitter because I just one day was
like okay hey Twitter who can draw me a
wombat in ninja suit and John quach came
in and just drew his cute little thing
and we were like done it's over game
over we love our little wombat this is
the greatest so now you all know the
story back to the website okay so two
and a half years go by and uh actually
not to enough yours the next several
years later uh from the last time we saw
our website we spent time and we we put
out a brand new website we were really
focused now now that the community was
growing so much our major focus was to
build a website centered around the
community we wanted to make it as easy
as possible to find good packages to
connect with others and just give you a
really nice beautiful experience I love
the old website but I like this one
better now in the process we also
changed a whole bunch of backend stuff
and I'm going to dive into that in a
moment so here's where we are today over
the last 18 months we have released
three products on our website and it's
really important for us to
help tell you what they are so we've got
marketing pages now and we are really
just trying to push these products and
services because the last thing we ever
want ever again is for you to not be
able to depend on NPM when you're doing
your installs it's really important that
those servers do exactly what you want
so we got to sell you stuff okay great
news users are increasing on the website
this is great but did you know that
we're doing with the team of three
there's only three of us working on the
web team a 10pm there's only 24 of us a
10pm entirely so there's all y'all and
then there's just a couple of less so
but we all work together and that's
really important ok let's get into the
nitty-gritty meaty bits so over the
course of the last two and a half years
I have had the wonderful privilege of
working on the NPM website and I have
learned a ton of things I cannot go over
every single thing that we learned but
here are some kind of really high-level
highlights when we vary only first
started NPM I I started on the first day
a week later my coworker CJ started and
I'm sitting there just frantically
trying to figure out okay I just need to
put stars in the website let me add Ajax
like there was no javascript in the
original version of the of the web app
and seizure comes in and she's like okay
we are going to add metrics and logging
immediately and I was like why would we
do that that makes no sense right now
our servers keep falling over our
community is really upset with us we
need to build stuff fast well there's a
reason why CJ is now the CTO and I've
only made my way up to engineering
manager because it turns out that
metrics give you the information that
you didn't know you needed metrics tell
you what your users and what your
systems are doing because while you can
guess what they're doing you can't
actually know with real hard data until
you start adding metrics logs allow you
to basically record those metrics and
search them later so those two things
really come hand-in-hand for you to
really understand what the heck is going
on and let me tell you the sooner you do
it the easier
is to continue doing it and you'll have
all of that data from the beginning the
worst thing is when product comes in and
says hey so we have this idea what do
you think you're like hmm when you have
the actual data that's when you can
really kind of push forward and say yes
this is a great idea or no our users are
never going to want to do this to see
something a little bit yeah interesting
but I'm gonna give it to from a
different angle at some point so the
original website that Isaac built it was
a hand-rolled just kind of framework
that he built on his own and it was fine
except for the part where when I needed
to come on to on board it took me six
months to figure out how it all worked
and that was really difficult so we
decided to scrap it all entirely and
start from scratch now when you're
starting an app from scratch there are
so many options so many opportunities
and honestly it doesn't matter which one
you choose or if you even choose one at
all at the ultimately that it comes down
to the fact that your framework if you
choose one it okay let me phrase it this
way there is no one framework to solve
every single problem never ever ever
it's important if you're going to pick a
framework to pick one that suits your
needs specifically so assess what your
needs are and then focus on that I don't
care which one you choose if at all that
said use a framework please use a
framework when you're an early stage
startup you don't have time to be making
a billion in seven decisions right let
me tell you if you have 20 engineers in
a room you're going to have 50 different
opinions on how things should be done
right like we all know this a framework
gives you the opportunity to let
somebody else make those decisions let
someone else have the opinions and
everyone else just kind of fall in line
because you have to get product out you
don't have to sit there fighting about
whether or not you should have
semicolons or call backs or promises or
what you don't need that on your on your
plate you just don't that said we
ultimately decided to use happy j/s for
back-end framework if you want to know
why we chose happy over say something
like Express let's talk about that
afterwards but that was a decision that
we made similarly for our front-end we
haven't implemented a front-end
framework yet but we're thinking about
which one we're going to go with
ultimately again it doesn't matter which
one you choose but it does matter that
you pick something and stick with it the
absolute worst thing you can ever do is
implement a framework into your app and
then either not use it at all or fight
it if you find yourself fighting your
framework just stop get rid of your
framework and pick a new one that will
actually work with what you need as the
websites as the web team started to grow
an interesting thing started happening
because at first I was the only one
working on the website it was great
right because I had everything in my
brain I knew everything that I needed to
know every decision that was made all of
it the whole code base was in my head at
all times but then an interesting thing
happens when you bring someone else to
new to get the team right it's suddenly
like you have this whole arc
archaeological dig site you can see all
the decisions that were made but you'll
never know why they were made you you
can see what was done you'll never
understand what were the things that led
up to those decisions so ultimately
people would come and be like why why
are we doing it this way and I would
look at them like well isn't it obvious
and you're like no there's no
documentation this one function isn't
tested at all there's nothing here so
that was a huge moment for me to realize
that in order to get people to be in to
understand what's going on in this code
base we had to implement some new
processes that meant more pair
programming and even more importantly
whenever we get new things from product
we actually sit down and and have a
discussion about what decisions we
should be making and that was super
critical and so valuable because now
everybody is on the same page at the
same time as you're building your as
you're writing your code and you're
building your app there's this moment
when you know you need to push your
production
but you're probably a little nervous so
why why are you a little nervous well
it's probably because you're not as
confident in your code is you really
want to be ultimately this comes down to
testing right you know that you can put
stuff out when when it's really good
quality code when you trust your code
that means you are happy to let it go
out into production when I first started
when this team first started we thought
okay you know what unit tests let's just
focus on the unit tests because any
testing is better than no testing at all
for sure but about it got to the point
where we would throw things up into
staging and while all the individual
pieces of code worked just fine the
integration points didn't and why was
that well we didn't have any integration
tests so it was impossible for us to
know because we we mocked out all of our
API calls in our unit tests so if we had
no idea we did not realize that the
actual API calls from our external AP is
the the stuff that was coming out of
there was not much I was not matching
what we were expecting so eventually we
did put in integration tests I want to
make a huge shout out to Nemo Jas
they're made by the folks at paypal it
is the best rapper around selenium I've
ever seen so if you're if you're sitting
there going and I don't know about
integration tests nemo d is a promise
it's worth your time speaking about
trust n pm's ethos is all about the many
small modules we love small modules
there they make code easier to write
they make your code stronger and better
but ultimately there is that one tiny
caveat which is that you didn't
necessarily always right all of those
little modules so you have to trust the
people who created them in the first
place but what happens when that trust
is slightly broken we had an incident
where we implemented we created a
brand-new markdown parser and we added
it to the website and that was super
super great because it was beautiful and
it worked fast except for whatever
reason every 36 hours or so our website
would just go down and crash
because there was a massive memory leak
we had no idea why it took us six months
before before we we actually sat down
and just went through line by line
figured out where this memory leak was
it turns out that within our markdown
dependency there was a dependency that
was a dependency of another dependency
that had a memory leak in some c++ code
and they had never seen that leak
because nobody was using that that one
tiny module at the scale that we were so
we found this leak and the beauty of
open source is that we found the leak we
put in we put in a pull request and then
using the beauty of some ver just kind
of like worked our way back up memory
leak gone push it out to production
fantastic everything is fine again but
you do have to trust that is that is a
big thing I totally trust all of it just
you know okay now the fun thing about
working on a website is that you really
bring an entire company together right
everybody loves working on the website
everybody has an opinion about what
should be on the website and that's
because for a lot of companies the
website is your one opportunity to
interact with the user base npm is
interesting because we have a CLI and
that's where all of our users interact
with us but our marketing team and our
support team and our Doc's team they all
need to use the only to talk to you some
way somehow and that's in addition to
all the products that we're building so
one of the biggest difficulties we had
early on and actually even still to this
day is figuring out how to really
prioritize all of the different
requirements and needs which are all
valid in a way that we can really push
everything out the door especially given
that we have such a tiny tiny team the
fact that everybody wants their say on
how the website should look or act or
feel it can be really overwhelming so we
started we did two things and like I
said it's a work in progress but the
first thing we did was we started adding
some kind of project management some
product management to get people to kind
of line up and say okay here are the
major things that we need to accomplish
and that's been really helpful because
it allows us to kind of put into
perspective okay this is the next thing
that we need to accomplish everybody's
on board cool but the other thing that
we did from a technical side is we
started breaking the website down it's a
massive monolith at the moment but we're
starting to breaking it down into
different micro services which will
allow individual teams a 10pm to kind of
take over their own personal piece so
for example the marketing team will have
their own kind of marketing service that
you as the user won't ever actually
notice any difference but at least what
that means is the marketing team can go
ahead and push out the code they need
whenever they want without having to
incur the three-team three-person team
bottleneck now probably the hardest
lesson that we've learned in the last
two and a half years comes down to this
when Isaac first started NPM he did
everything an open source and it was
fantastic it was really really really
wonderful in fact all of us who joined
NPM especially on the engineering team
we were super ecstatic because how great
is it to have somebody else pay you to
work on open source like that is just
the coolest thing ever no more nights
and weekends this is your day job and it
was great but then something happened we
had to get stuff out the door we had a
move on product our team was too small
we didn't have any bandwidth or the
people or the time to really focus on
the user community so people would put
in pull requests and issues and we were
like okay well let's get to this but
then another thing happened which is
that the registry team decided to break
out the registry into lots of different
micro services which was great it made
us move a lot faster internally but it
meant that our user base couldn't
replicate the website locally because
all of these services were private and
everything like that and it was just
suddenly you could clone the repo but
you couldn't actually do anything with
it and Sippie would put in issues and
they'd be like hey I think I think this
is wrong but I don't know because I
can't replicate it but maybe you could
do it for us it's like we don't have the
time to do that oh gosh this is really
bad and
just kind of kept building up and
building up and it was kind of terrible
and at the same time we had the
situation where because our repo was
open source at the time like we've been
using Travis continuous integration for
last year and a half or so and it's been
fantastic at the time the if you have a
public repo you end up in the same queue
as all the other public repose which
sometimes meant that even if it was a
massive security bug fix it could take
up to an hour maybe two to get our build
to go that's not acceptable for a
production level website so we did a
little experiment we we went ahead and
we've made a private Fork of the website
just to see what happens well first of
all the Travis fields went the the
timing went down super it was super fast
right so great we can move forward and
we can move really quickly but then
another thing happened nobody noticed
nobody noticed that we made a private
Fork of everything like the public open
source version of our website was stale
for months and there may be two people
who are like hey wait a second this
doesn't quite look right but I'm talking
to out of all of our users that was it
was kind of like well so at this point
it kind of just feels like just a view
source button which it was really
awesome talking to miles the other night
he talked about open source vs. view
source and I thought it was a brilliant
brilliant idea but that was basically we
were doing we're just kind of showing
off our website but we couldn't let
anybody really comment on it or work
with it or play with it and so we made
the really tough decision to go ahead
and just shut it down that's hard it's
really hard believe me there was a lot
of angry people internally to the
company there were a lot of discussions
there were very heated discussions that
happen because of it now the way that
we've mollified it is that in the
process of taking our monolithic app and
breaking it down into smaller pieces
we're open sourcing the tiny modules
right and those are a lot easier to
maintain
because it's 30 lines of code there's a
pull request great and it's easy to see
an easy to test and it's fantastic so
that was rough but it happened now
through all of this we have learned a
ton of lessons right we've made a bunch
of mistakes we've made some really good
decisions and we paid a ton of progress
and just change this website so much but
ultimately no matter what mistakes we
made no matter what decisions we made
thin in the day we're going to make more
mistakes and we're going to make more
decisions and it's just going to
continue cycling because change is
inevitable as we move forward as we
continue learning we're going to get
we're going to learn yet even more and
ultimately personally I want to thank
you all for giving us that opportunity
because honestly it's because of all of
our users that we continually want and
strive to change and it's because of you
who use these products and services that
we are desperate to get out that we can
continue to maintain this wonderful
ecosystem and really build up this
community in every other way that we
possibly can so with that huge huge huge
thanks it's great to be here I have a
few pairs of socks um what do you mean
I'm not bribing me to be my friend's uh
so if you would like to maybe pukur one
of these I'd come hang out with me and
ask me questions and let's talk about
NPM and let's talk about the website or
the CLI or anything I want to hear your
opinions I want to hear what you have to
say that matters a lot to me all right
thank you so much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>