<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CSSConf Oakland 2014 | Ben Schwarz: Real metrics for front-end performance | Coder Coacher - Coaching Coders</title><meta content="CSSConf Oakland 2014 | Ben Schwarz: Real metrics for front-end performance - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CSSConf Oakland 2014 | Ben Schwarz: Real metrics for front-end performance</b></h2><h5 class="post__date">2015-02-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-D81Qj1YmPM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for the introduction there I
always like to start a talk with a
little bit of a personal note so
cameraman you can cut and you know my
talk is not starting yet it's my first
time to Oakland so thanks so much for
having me I'm really happy to come here
and I wanted to embarrass Carolina and
just say thank you thank you for running
such a such a great conference so far
and to have a conference with more
female speakers than male is something
that so so good and you should you
should definitely be very proud of the
work that you've done because I'm very
proud of you so good job okay let's get
started my talk today is called useful
front end metrics my name is ben
schwartz i'm at ben schwartz on
basically everything on the internet so
i'm going to go through i'm going to get
through performance stuff in general um
you've probably seen talks before about
performance and you know we kind of hear
the same things time and time again so I
wanted to cover kind of what those
things are here's the scuba time is
money everybody knows that it's really
great the time equals money on the
internet because it allows us to qualify
when we when we do performance work and
we make people terrified and we actually
get to spend time thinking about our
architecture and thinking about how we
can improve our code bases for ourselves
and for our teams and for the businesses
that were representing it's really great
that it equates to money so i think
that's that's something that we can
establish that we all kind of know that
time equals money when a website is slow
it costs money when they're slow sales
drop engagement drops abandonment Rises
we've heard this time and time again and
it's how we're able to you know to keep
going amazon found that when they
increased their their page speed by 100
milliseconds it equated to one percent
of their revenue which is kind of crazy
it's not really a metric that you can
use for your business definitely but it
definitely works for amazon so maybe if
you go work for them you're going to be
saving them a lot of money and get a
healthy bonus
forty percent of people about a website
that takes more than three seconds to
load that's that's from KISSmetrics last
year i believe and their 2nd stat which
also is kind of interesting is that
forty-seven percent of consumers expect
a page load in two seconds or less and I
don't know about you but I look at a lot
of pages every day and I would say that
probably about ten percent of them load
in two seconds or less particularly on a
phone so someone that is doing an
amazing amount of work in the
performance base in general is ilya
gorrik he works for for Google's one of
the chrome team members and he said that
after a second or more the uses flow and
engagement with the initiated task is
broken and he's actually talking about
an interaction where somebody clicks on
something and they wait for more than a
second so we've often heard that school
of thought of an animation shouldn't
probably last for more than a quarter of
a second he's saying that if you make
them wait and they don't see anything
within one second they just kind of this
mental blank comes to them and then they
just move on etsy learned that when they
added 160 k to a page they actually got
a 12-percent plus bounce rate on mobile
which is a pretty alarming stat from
this is uh it's it's actually a graph
but it's it's abstract so it doesn't
really matter but from 2010 until 2014
response size grew by two and a half
times so your average response side this
is taken from the HTTP archive grew from
about 700 k to somewhere like the 1800
ish be on there and that's that's pretty
crazy because mobile phones like he was
talking about this it was Adam he
mentioned that you know you just go down
to the pier and suddenly your phone
doesn't work and you can't tweet it
anybody and you can't actually meet that
friend that you're trying to check the
map to go see them or anything like that
and about that really sucks and I think
we can all emphasize with that so let's
start start a rule everyone is on your
team is responsible for the performance
of your side Steve Souders back in 2008
stated that eighty to ninety percent of
old sort of perceived speed is basically
because of the front end so it's not our
job right it's everybody's job people
like developers who work on the back
ends will say that you know the servers
are really fast and we've got sequel
queries or super amazing and we got all
these amazing architecture but it
doesn't matter like it's in the front so
what do we already know what are the
rules of engagement what we do to make
sides fast we minify everything okay
cool we use async JavaScript's we know
that base64 in large fonts can block
other styles from loading so if you load
every font in the world and base64 them
you're basically blocking the browser
what else we should animate using CSS
and not JavaScript we should use
requestanimationframe for JavaScript
based animation so this actually takes
the time of when the browser would
naturally paint it will call the
requestanimationframe loop and it's an
opportunity for you to be I would
actually draw something to the screen so
this is really great for canvas or for
WebGL or whatever another thing we can
do is we can use video rather than gifts
if I actually can't believe I just said
that everyone you should definitely
follow your dreams and use a gift
because they make you happy we know that
changing a paucity transforms clipped
and filters are cheap because they're
hot way hardware-accelerated we've
learned recently and I was talking to
mark about this for bootstrap that
position fixed can cause really
interesting repaints and read roars when
you're scrolling and they found the
performance in bootstrap when kind of
kind of crazy and so they actually
pulled all that those hacks out without
adding translate 3d to try and push
something to another like compositing
layer in the browser wasn't worth doing
so we're learning these things people
are talking about them time and time
again box-shadow can actually be kind of
evil here's my browser using just box
shadows on these chrome logos and just
doing some basic scrolling and as you
can see the performance goes from pretty
great too pretty abysmal and of course
the chrome team talking talking a lot
about make your make your animation 60
frames a second and try and strive to
get there in May 2013 addy Osmani ran
through an amazing pitchfork special
Daft Punk mini side just before their
album came out where the scope scroll
performance was less than ideal and I
don't know how many people will actually
remember this I certainly do I was I was
really interested in the the full screen
video and typographically I was
interesting and I just them as a group
we're doing interesting stuff but it
really performed like crap Eddie has a
really great article on his blog you can
see here he's actually profiling the the
60 frames per second mock just up here
and you'll see that it's barely doing 30
and it's jumping all over the place and
it really gives you the idea of that the
browser and your machine are struggling
so that side feels like crap so let's
CPU burning painting and heavy effects
equals less battery bone I think
everyone can actually agree with that
too here's a rule let me load what you
need this this comes from Patrick
Heyman's talk at CSS comfy you fantastic
talk Patrick works for the Guardian and
he talked about what CSS you need to
deliver your side and in this example
he's talking about basically the fold so
at the Guardian they did a study of what
they as an organization consider
important content so in their case the
article the story that's what they're
writing that's what they're producing
that's their their product that's the
really important part about this page
the comments not really never read the
comments anyway right sharing related
content and popular content they're not
important so what the Guardian actually
going do is render that article content
first and then later go and load in the
sharing related content popular content
using Ajax or maybe local storage
depending on sort of how that works for
them and beyond that they experimented
with actually in lining their CSS so
this is something that Adam also touched
on where it sits like a bit of a secret
that you should never use inline styles
because it's disgusting or something and
you should kill kittens if you do but
what they found is when they inlined
their CSS that was just the above the
fold CSS the actual critical path styles
their performance on for on content load
and for Dom ready dropped by six to
seven hundred milliseconds now when
you're on a phone six to seven hundred
milliseconds if you've got a budget of
two seconds or maybe one try and get
contents you users that's pretty
significant I think we can agree that
okay so now that we've we've sort of
talked about all these things that you
should and shouldn't do and you know
everyone knows everything about
performance right so we just minify
scripts and don't do anything stupid and
everything's fine right so okay cool
I'll see you um that's not the truth how
do we how do we know that what we've
been told or what we've learned years
ago or what we've discovered on the last
project we worked on how do we know that
that's actually true
set a budget so how much is too much if
you're a Content Heaviside this this
screenshot is taken from a site that I
believe it was a news site and so their
content changes on a hourly basis their
image size on the very last point is two
points view yeah two points who makes
which is quite a lot of quite a lot of
images if you set a budget for images
suddenly you can have really interesting
conversations with your team you can
talk about what's acceptable and what's
unacceptable you can say if we go over
to Meg's we need to reconsider this or
maybe we can drop one story for mobile
devices or maybe just not load them
because we're going to do mobile first
in the first place and for a designer
this is actually a really interesting
point do we really need that insanely
huge banner of that perfect looking rich
couple but everybody hates anyway what
so set a budget and monitor all the
things i wanted to mention just
real-time monitoring in general if
you've ever logged into google analytics
you'll you'll maybe have noted that you
can get to an average page time load
time and on this particular site it
dived up on this one day to 14 seconds
which is quite a lot I think we can all
agree this is the real thing that your
users are seeing so no matter how many
times you run you're like grunts scripts
and you think you're doing the best
thing in the world this is the real deal
this is what people are seeing and this
is what gives you dada to tell you
should we use a CDN should we not do
when we added one did it help what could
we do next but aside from that we can
actually do our own metrics in a side so
here's the San Francisco Chronicle I
don't know if that's like a good good
newspaper to show here but actually want
to show you this API here this is window
window performance timing what window
performance timing is is the HTML
timings so you can go into any side in
your browser right now and you
go and type this window top performing
star timing and it'll give you the any
redirect times it'll give you any delays
that happens with your with your HTML
it'll tell you when Don content loaded
actually occurred and just getting these
metrics I mean Google are pulling these
into analytics for you but you could
actually go and do your own stuff in
your test suite and if your site goes be
understood a number you can alert for
that in addition to the the HTML timings
we can also get some additional data
here we can actually get every resource
in your page go video we going to go I
don't know
it's not going mmm that's a video right
you know thank you okay so here I've
actually called window performance get
entries and you'll see that it's given
us a whole bunch of resource timing
entries each one of these in this case
this one was a resource you can see the
script that it actually was we can see
all the timings we can see if it
redirected so obviously putting
redirects on resources in your page is
terrible for performance and we can
track that so what I want to encourage
you to do is actually going to use these
these two simple really like super
simple API s go and put those in and
track some metrics and Ajax it back to
your server so that you can actually go
and track that for yourself and have
your own numbers you don't have to fight
for your you know your boss to let you
use Google Analytics or whatever other
analytic tool there is or something that
costs money where you have to sign up
for it you can just go and do this and
then just beacon it back to your server
which i think is actually really
empowering as a front-end developer so
those two to AP is super simple there's
a performance timing and then there's
get entries get entries you can also say
get entries by type and you can say get
entries by type of resource or get
entries by type another one there's a
three of work but coming back to the
Guardian example that I showed earlier I
think there's something interesting here
we can actually go and track metrics
custom metrics for stuff like how long
did it take for the comments to actually
load right so we could put a little code
block around our Ajax and say how often
you know what are the real people on
outside all over the world firstly let's
look at where they are let's look at
what CDN they're using if any how often
do the comments load how often do they
fail because often we don't know this
stuff and this is this is how you do it
it's actually super simple you can make
a mock in your timeline by using window
performance mark in this example I've
labeled it foo then you can go and say
get entries by type mark and suddenly
you've got custom metrics that have
recorded using these nano times that the
performance api's give you and then
another really interesting part of that
is you can measure something so you
can say the sidebar initialization in
the time from Dom complete until in your
JavaScript code when your magic sidebar
unit code loaded it took this much time
and again you can track it and send it
back again google chrome team who seem
to do a lot of the performance work that
we see online have a metric actually
smell google chrome technically its web
page test so web page test is a project
that's sponsored by google and and they
use the idea of visually complete and so
they go and get your site and they get a
video and they record the whole thing
and then they break it up into
increments here it's showing second by
second but they actually break it into
increments of 100 milliseconds and they
get they actually diff the images and
they figure out at what point your site
was visually complete and I think this
is a really interesting metric because
it's actually when somebody will start
interacting with your page people wait
for things and you can you can actually
see this in action on facebook anyone
who uses facebook have you ever noticed
we're on your timeline feed it shows a
box and some lines and it kind of looks
like the post is there it draws your eye
straight away the side bars are still
loading but you actually draw into the
timeline and then suddenly the posts
appear it's actually really interesting
thing when they launched thought I
noticed that I was engaging with the
page sooner and i think that the study
that they're they're doing there is is
really interesting and I think this is
the most interesting performance metric
that we have is when will somebody start
interacting with your page and using the
performance api's that i've shown you
you can actually go and say hey when was
the first time that somebody actually
clicked on the page when did they
actually interact with something or
select some text once to mention a
couple of radical tools firstly you
could use pinga more New Relic they seem
to be about the same product essentially
I think they're kind of copying each
other I don't know if anyone works for
them sorry they're about the same you
can you can get your average load times
you can you know breakdown by action you
can break down by geographical region
etc
and also I wanted to shout out for four
atoms tool and brents CSS that's where
you can throw heaps of CSS at this thing
and it'll tell you the statistics and
characteristics of your styles so it'll
give you a little graph this is one of
my phrase I think its new is the
specificity graph which was first coined
I think by Harry Roberts maybe yep yep
that's great cool as far as far as we
know anyway shout out to Harry as well
and I definitely encourage that you go
and throw your CSS at this and
understand some metrics and numbers
because metrics and numbers allow you to
talk with your team and figure out what
you just did and what you should maybe
do next and also setting up and
installing all of these new tools or
like using new services every time for
every new project can be really tedious
and I kind of agree with that too so for
the last year or so I've been working on
an app called caliber its caliber opcom
and I track your site every day or when
you hit it with an API I record videos I
keep screenshots I get every metric that
I can possibly get out of chrome
devtools actually Rome run chrome
headless and I record it all for you and
that's been a really interesting project
for me and love to love to get your
feedback or see what you what you think
about it here's a couple of quick
takeaways one is your work set budgets
and make sure that you talk about them
on a regular basis because this is what
you're judged on for quality as a
developer and don't rely on what you
think you know actually go and prove it
thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>