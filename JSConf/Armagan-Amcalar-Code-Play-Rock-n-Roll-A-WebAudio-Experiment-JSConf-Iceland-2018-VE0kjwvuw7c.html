<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Armagan Amcalar: Code, Play &amp; Rock 'n' Roll: A WebAudio Experiment | JSConf Iceland 2018 | Coder Coacher - Coaching Coders</title><meta content="Armagan Amcalar: Code, Play &amp; Rock 'n' Roll: A WebAudio Experiment | JSConf Iceland 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Armagan Amcalar: Code, Play &amp; Rock 'n' Roll: A WebAudio Experiment | JSConf Iceland 2018</b></h2><h5 class="post__date">2018-04-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VE0kjwvuw7c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome everybody
maybe maybe we could start with a song
do you like that okay let's start with
an easy one something that hopefully a
lot of people know
okay that didn't go as as well as plan
okay this one was better thank you cool
let's get back to the presentation so
this talk is called Coldplay and
rock'n'roll I hope to code some and play
some guitar and hopefully we'll enjoy
the show
all right great so before we start a lot
of you are you tourists out there so you
are familiar with the scene but this is
what a real pedal board looks like these
are all tiny gadgets that shaped the
sounds of famous guitarists legendary
guitarists that that we all know out
there and this is how it can work for
example in software in one of the one of
the tools or products that I've done
called pedals IO this is basically a
faithful representation of real-life
guitar pedals you sold two of them in
the short demo and we'll be adding more
an overdrive a chorus delay reverb and a
lot more in in the coming minutes so I'm
Arman Arman I'm jyler I come from Berlin
I work for a company called you know
Gambia and we're building electric
scooters so like West pas but with
electric batteries I'm also the founder
of Longy which is a software
craftsmanship school for women and I
like to play a lot with code I have a
lot of open source projects on github
that range from brain signal processing
to audio processing to front and
libraries and platform-as-a-service
and micro services and a lot of other
stuff so what is Web Audio anybody
familiar with Web Audio only a few ok
let this be a call to the guitarist out
there I hope you also write some code
this is extremely fun to play with this
is an amazing playground for especially
as the cold air musicians Web Audio API
is basically built into all of the major
browsers and it gives you everything you
need to build high quality audio
applications that are like this pedal
boards or full-fledged digital audio
workstations or game audio in a 3d room
where you can adjust the position of the
sound and you can have specific start
times and end times for specific samples
so that it matches with your animations
your characters and you can do some
production applications you can do video
production applications like DJ mixing
tools and basically anything you can do
with audio anything you are used to
using on your computers or on your
phones or iPads or tablets they they are
available through Web Audio API and you
can build any dream application that you
have in mind that includes audio as well
as you know art installation as well
because you can combine it with the
input that comes from a camera and you
can basically turn it into sound you can
turn the the pixels that the camera
captures and portrayed as sound samples
or any any kind of sound effects if you
have ever imagined anything about audio
that's available through Web Audio API
actually this was what I had imagined to
be able to play guitar effects free
everywhere without the need of
installation of a new software and
basically I made it possible with Web
Audio API so a little bit about Web
Audio API and its basic structure Web
Audio API is a network of nodes all you
do is you create some nodes
and they are either a source so that
they represent a signal like an mp3 file
for example or an oscillator like a
keyboard which is a source of sound or
they are sound processing units sound
processing notes so these can be as you
see here like a delay effect that is
like an echo that repeats the sound or a
gain effect that improves or amplifies
the sound or some filters some very
wonky filters that I will demo in a
couple of minutes that you can do and of
course at the end there is a target a
destination an output which is your
headphones or your speakers whatever you
like
or it could be a recording target so
that you could save whatever you created
with Web Audio to to an mp3 file much
like rendering in a in a digital audio
workstation the idea is very simple you
create these nodes and you set some
parameters which is very very simple
extremely simple you don't have to know
a lot of math actually you don't even
have to know math for anything except
one special node that is kind of there
to introduce gain distortion effects but
then you connect them you connect them
together starting from the source from
from the guitar or of course that's a
guitar for me but whatever source of
input you want maybe it's a mic or
another audio file and you connect them
in whatever way you like and then to the
output and everything happens in real
time
okay
so web audio hosts a lot of components
that you can generate that you can
create it starts with an audio context
everything has to happen within an audio
context anybody familiar with canvas API
to draw some pixels it also has a
context so in order to draw something to
the screen you have to get a get a hold
of a context and audio context is
basically the same in order to do any
audio application you need to have an
audio context now you can have more than
one and you can connect anything to more
than one context to have multiple
plugins or other applications but in the
end you need at least one audio context
then there's the offline of the context
for you to be able to record something
again and a lot of processing nodes
processing units like again gain delay
pan or Cromwell where panner is used to
direct the sound to either left or right
channels convolve ER is used to
introduce effects like the echo effect
here the whole effect like a cave you
know your your sound kind of echoes and
drifts away in a cave those effects are
made by finite impulse response filters
and a Cromwell ray node is basically
used there and you can have an analyzer
node so you can actually grab the signal
and look at its properties so look at
the frequency content look at the power
and you can do various effects based on
that you can split them into multiple
channels multiple tracks so that the
graph can get wider and wider as you
want it has a lot of a lot of nodes and
lately they also introduced some audio
worker so it's like a service worker it
works in the background it has separate
threads and basic
it allows you to implement your own
algorithms your own scripts or functions
that will run per sample but it will run
off thread and so you won't hit a
performance penalty so you won't be
using the the main thread of the browser
but it's parallel so that you can have
multiple of them which makes the browser
a very nice competitor for digital audio
workstations like you can really get
real production grade audio applications
riding inside the browser and okay
here's a very small example you start by
creating a context which you do new
audio context and as I said everything
is hosted under the under that context
so you can create a gain node which will
amplify the the incoming signal by doing
context that create gain and you can
connect it to the destination which is
the speaker output or whatever you like
again here's another example to
basically load an mp3 file and use it as
the source you can create a buffer
source and load the buffer that you
download from the internet and use it
connect it to the gain as the input so
this basically gives you a graph where
the source is at the beginning in the
middle you have the gain and in the end
you have the destination but this is
basically as simple as as this loading
an mp3 file ok let's talk about
pedalboard chess it is the first open
source web audio framework I guess I did
it in 2012
back then Web Audio API wasn't a thing
they were still developing it it didn't
have stream input for example it
couldn't capture directly from it from
your sound card and could only work with
static buffers but those days are
fortunately behind us and six years
later
it's still one of the best guitar
effects library out there full
disclosure I wrote it and it's GPL
licensed and it has a very nice
documentation both inside source code
and as I read me and it has very nice
abstractions based on the guitar world
so if you are into building your own
pedals which I am you can build your own
pedals here very easily and make it a
part of the library or you know play
play with it however you like
anybody doing guitar electronics like
their own pedals nobody ok interesting
good some of the guitars should start
doing that as well that's very fun I
started by doing real electronic
circuits for overdrive pedals and then
moved on to the digital world because
this is a lot easier so you have pedal
boxes pots potentiometers knobs that you
can twist and turn around switches that
you can push and LEDs that link and
basically you bring these together to
make pedals this is built on top of
something called Google closure library
which is ancient by today's standards I
guess start in 2008 or something anybody
using Google closure library one person
you're my hero
anybody who has used it before another
person
well it's arguably the best user
interface library out there it's by
Google and it's what Gmail Google Docs
and all the other serious Google tools
are built upon it has an amazing
compiler like nothing the other guys can
do nowadays like even roll up or other
information web pack but yeah Google
closure compiler has a really nice mode
called advanced mode which rewrites your
code from scratch doing a lot of
optimizations just like a real real
compiler just like a C compiler and it
also optimizes for speed and for
download speed and for runtime
performance
so pedalboard chess is built on top of
google closure library because that was
the best choice in 2012 but i guess i
want to rewrite it
now with es6 so if anybody out there I
wanna you a hand that will be
appreciated and it uses something called
an MBTA architecture which is kind of
out of fashion right now in in the
front-end world but yeah so you have a
stage as as the audio context in my
world you're in pedal board chairs
everything starts with a stage as you
see here because without a stage
there's no musicians even if you're
playing in your bedroom that's your
stage and then you have a board a pedal
board that hosts your pedals and you
have some boxes initially they're empty
so it's like a gut class but you can
fill them and make them guitar pedals
for example a reverb or a delay pedal is
a box with some inner circuitry you have
a foot switch that can toggle on and off
LEDs pots again file inputs and maybe
the most important one is the stream
input which is the thing you use to
capture the sound of your guitar or a
live instrument or also a microphone so
you can actually do pretty fun effects
with your voice just in your browser
okay
I'm not going to go into the details
here I'm gonna show you some code but
before that I also want to talk about
web MIDI API now anybody again please
raise your hands if you have played with
the web MIDI API one two three okay
this is also another very very fun API
that opens the web to a world of immense
pop possibilities you can do anything
with it so you can grab any DJ gear any
musician gear like a keyboard or a drum
pad or I don't know something like this
so this is also a MIDI controller it's a
wireless Bluetooth
midi-controller this thing is for the
foot pedal but there's bluetooth
connection to the computer so basically
you can connect this to the browser
directly and get some messages from that
depending on which key you press or
which button you press you get a
different message on your browser which
means you can then do whatever you want
with it you can use it for I don't know
if scrolling pages or hiding ads or I
don't know photo applications like photo
filters for me for example I'm really
sick of editing tiny sliders on my phone
when I when I edit photos or like in the
computer even worse with a mouse you
have to click something to change the
brightness of of an image for example
but if you have a MIDI controller that
has a knob that you can turn it's a lot
simpler to to modify images or or sound
if you're a DJ basically the mixer that
you see before the musicians there are
also medical rollers and they can be
reflected right in the browser and it's
super easy to get started so it also
these gears are like they start from I
don't know $20 or something so you can
get extremely cheap MIDI gear and use it
as an external input device to the to
the browser because with the mouse you
can only do so much
but tactile input is is really good if
you have a pad or a slider a fader or a
knob that you can twist to I don't know
to turn on the volume of YouTube videos
or something it's really really
effective and of course you can also do
some games with it let me see oh yeah
here it is
so this is a snake game that I
implemented in one of the DJ gears the
one on the left is the real DJ pad the
right is a browser
so I basically mirrored it in the Dom so
that's a snake game that that I play
with a with a real DJ device so you can
turn on the lights on and off through
the browser and again it's connected
over bluetooth and yeah you can do a lot
of a lot of stuff with it cool so how
does it look like really it's extremely
simple again you do navigator that
request media access so I want some MIDI
devices to be available and it gives you
something with inputs and outputs so
what you do is you traverse over the
input and attach an event handler called
media message event handler or whatever
so basically there you get any events
every time something changes in the MIDI
device like when you press a button or
when you turn a knob or anything you get
an event that is not that significant
except for the data which is an array of
three values or sometimes even two
values and they are the numbers the
channel that the middle signal is coming
in the note the the control change or
program change signals and its value and
it's either 0 or any value up to 127
it's very simple and then you do
whatever you want with it and of course
as you can imagine what I did with that
is I connected it to my pedal board and
I can turn on turn on and off my pedals
in real time as I play because I don't
have a third hand yet so here's the demo
that that is the the patch that I was
using first I actually want to show
you have the yeah so if you see it there
the the LED is blinking it's turning off
and on and I can also turn on and off
the second one if I long press this it
will change the patch so it will go to
the second song so that I can play that
one and yeah I can turn and turn on and
off different petals and the other one
has a very nice pedal called a wah pedal
anybody familiar with the wah pedal wah
wah pedal good well there were more
heaters here you should learn the while
pedal ok so basically it's it's like at
this device this is a this is called the
pedal it's a very confusing name
everything apparently is called the
pedal but this is also called the pedal
you can step on it and as you see you
can step on it to change the value and
look at the second one I hope you can
see it the the effect knob changes as I
move my my pedal which means it opens
the wah pedal or closes the wah pedal
depending on the position so basically I
use these with my library to make some
music ok now let's see some code
cool
so is it readable from the back that's
nice thank you so again it's very very
simple I included pedal board chairs as
a global library so even though this is
a module some of the the components are
available in the global context in the
window so I call something called a
stage it has its own context so stage
creates its own audio context and that
is what you use to create your other
pedals so you create a stage you create
a board a pedal board you use the stream
input to get the guitar and you set the
board to the stage and then you have
some pedals let's see
so
you have three pedals out there
yeah the first one is in noise gate a
noise gate basically saves our ears
because when you use distortion or
overdrive there is a lot of hum and a
lot of noise that I'm gonna demo right
now
that's really that's not ideal so you
use the noise get to to block those
those noises but it has a switch that
you can toggle on and off or you can
change some of its values you won't see
it there but there's a threshold pot
here and you can change it and it it is
it is dynamically reflected in in the
value so you can play play it here with
your mouse or as I hate Mouse's you can
change it through code or through
through this pedal so let me try another
one
cool
from
that's it thank you so basically this is
play-doh ball chess and this is what you
can do with the browser only a fraction
of it so I encourage you to take a look
into both pedalboard chess and the Web
Audio API thank you again</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>