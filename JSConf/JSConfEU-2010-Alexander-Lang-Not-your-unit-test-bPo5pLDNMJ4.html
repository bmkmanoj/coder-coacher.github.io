<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[JSConfEU 2010] Alexander Lang: Not your unit test | Coder Coacher - Coaching Coders</title><meta content="[JSConfEU 2010] Alexander Lang: Not your unit test - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[JSConfEU 2010] Alexander Lang: Not your unit test</b></h2><h5 class="post__date">2013-06-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/bPo5pLDNMJ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">yeah thanks before I start we seen some
pretty amazing Talk's today already
right I don't have any drinks for you
and no robots oh cool yeah I see some
some water would be nice but anyway so I
do have something else just before we
start because I brought my camera to
yesterday's party and so I have a little
sneak peek for you guys anyone hasn't
knocked in there one you slept no wait
damn it
so it's to direct him that was some nice
games I guess it's hard to see but it
gets better once I managed to switch the
video not sure the things i just copied
the video into the browser window and
now if it is stuck somehow i'm sick as I
yeah just one more which I think was
nice
we turn on the lights sorry tom see here
but yeah so we had a good time so did
Tom and um now i'll restart my browser
and start with the talk
no too much
sorry okay and then um so yeah let's get
to the talk and let's call the start
this talk is called not your unittest
which means it's not about unit testing
but I come to this in a second my name
is Alex I'm a programmer and I do a lot
of Ruby and also more and more
JavaScript and I'm a big fan of actually
uh just you know I work for and owned a
company and the name caught up stream
media and I also run a co-working space
which many of you have seen already
because that was the place other days
come people went under days before the
conference that office somewhere there
so let's talk is about something called
BDD with just the quick hands who knows
what that is huh sorry ok so BDD is
behavior driven development oh sorry
you're a hard to and so yeah anyway so
what is behavioral development met a lot
of things do some some random quotes
about it it's kind of a evolution of TDD
which is test-driven development it's
about getting the words right and
communicating with the business side of
things and writing software that matters
and I'm so what does it all mean right I
mean this is kind of the business side
of the whole thing so it's all about
coding or not just about coding but also
about business but since we're a
programming conference here i'm going to
talk about the coding stuff and so the
question here is what's in it for us
code is not just for the business and
what i want to show you today is a few
things that we can we can benefit from
BDD and that's you can improve your
design process the way you design your
software you can have less bugs in your
software which i guess is always good
and you can use some cool new tools with
well then again have you with the other
two so in December last year I started
little side project side project called
a robot which was intended to add me run
my my co-working space because I hate
accounting and all that stuff so I just
wanted to make that a bit easier for me
and I'm actually I need to switch my
resolution again concert just isn't
working here sorry
that's the correct yep
sorry about that
and so I started that little project and
I had a bunch of ideas which are bees so
I wanted to like automate some
accounting and other things and so how
do i turn that into software right I
just had some few ideas and how would I
start and turn it into something that
works and there's a few approaches to
this one has called the functional
specification document which kind of
means you sit down for a few months and
write some documentation about your
software and then you at some point
start coding according to the
documentation but then that's outdated
already and so let's called the
waterfall model and that doesn't make a
lot of sense to me also my company has
the name edgell in it so I'm kind of not
allowed to use it anyways and so there's
another approach which is called inside
out by the way the feature I'm
discussing years now the payment
tracking so co workers in the co-working
space if you know don't know what its
basis so people can rent a desk and then
I pay for it every month and so I need
to make sure they actually pay me and
track who is paid me and who hasn't so
that's kind of the thing we're going to
develop now and so this inside-out is
kind of program as favorite approach
because I'm you get to do all the
interesting stuff first so you kind of
design your database schema if you have
one or a few database replacement you
can check out some for plugins and you
know methods and all that stuff
algorithms that really is kind of
interesting program is right and so you
could come up with a few models so like
okay I'm going to need users and
memberships and something in this
application and you say okay I need some
methods on those and you kind of start
coding from the bottom you think okay I
need this and descendants in this
youngin I just start building up and
when I'm done I just put a user
interface on top
the problem with that is that it might
end up like this so there's a certain
disconnect right to get my tanning
better so you start from this this kind
of description oh I need payment
tracking which is way at the top or if
you will from the left side of the
bridge and then you have your
implementation coming from the other
side and then they kind of need to
connect in the middle and you just hope
that'll all work out but it's really
hard to do this because you're working
from the other side and so there's
another approach you can do and that's
called outside in and that's actually
encouraged by BDD people and how it
works is that you start with a feature
description and that's kind of a it has
a little formalized format and so how it
looks as you stop with this kind of
first describing the feature and sort of
the business benefits and what it's
supposed to do for your business and the
business is there to make money and so
the benefit should always kind of end up
in making money or saving money for the
business but that's the business side as
I said so we're not going to worry about
that too much instead we're starting
with giving it some context and that
works like this and so you're saying
okay I want to check those payments now
and suppose I have a new coworker and he
hasn't paid me anything yet and then I
say okay so in my system that I want to
test now there's a co-working space and
my software so i said this give them a
run a co-working space co-op which is
spacer on and then okay yeah i guess i
should be locked into into some kind of
management console so that i can can
mark that person is paid or not paid and
then I needed an example co-workers so
we have Joe a year and this is kind of
the context of my test case and next I'm
going to need some event so what happens
that looks like this so I say okay you
there's a page or a list of
coworker somewhere so I go to that list
and i click on Joe's name and then I
click on the current months which in
this case is sep tember and I press
payment received that's what I want the
interaction with the software to be
right and then at last I want some
outcome and in this case that as soon as
I first that button the page should say
okay now he's paid me everything's cool
and so that is I you start BDD with a
high-level feature description that kind
of describes what you want your software
to do in natural language which is
really nice because it's easy to
understand and also as it happens to be
this is a pretty nice starting point for
our implementation because we can run
this even though its natural language
there's a tool called cucumber how many
people know click amber you're not too
many good Sookie comer you can see it
here ready so the black thing is
supposed to be a shell so I typed in
cucumber and then this features / trike
payments feature that's the file i put
my description in and when i run this
it's going to tell me Oh undefined step
and it gives me some of this example
down there which i can paste into my
editor right here and so what this does
is it Maps natural language to code and
as you can see here so it has given and
unless a regular expression that matches
I run a co-working space and then quotes
and a matching group and cucumber will
match every line and that in that
feature a description to those steps and
then it'll pass the matching groups into
the function i give here so here it says
function name so i get the name which in
this case would be co-op and then i can
run some code so in this case i want to
if my co-working space in my database
that I can set up my test scenario with
my software and then next step I'm
logged in so I need to do some set some
cookie or something whichever my web
framework prize or actually go and fill
out the form or do basic auth whatever
it's another step given a co-worker so I
saved that guy to the database as well
and then s also what's this line when I
go to the list of co-workers and that's
actually a predefined step in cucumber
and you can map sort of descriptions of
pages so the list of coworkers and you
can map that to an actual URL in your
application so in this case I'm at the
list of coworkers to look a host /
co-workers and so run run it again and
it looks a bit better because now we are
in red green land and we can see a few
things are working already so I can I
kind of create that co-working space and
I'm like in now and there's this
coworker Joe and then at the fourth line
it says I can't go to that is a
coworker's because it doesn't exist
right and so what we have here now is a
failing test which is awesome because
now we can do TDD s / v DD and we do
that by kind of moving and now remember
we're doing outside in so we're on the
outside now we're moving one step in and
one step in in this case would be kind
of the HTTP layer interface so so kind
of your web app controller whatever
level and so since we're testing we're
not implementing that yet where were
writing a you test case and this is our
pseudocode so but it should kind of work
like this right um so you could use
something like Val stairs or jasmine
also to write this test and so now will
encode level and we're writing a test so
it says here it should load all the
co-workers so we are kind of yeah just
implementing some some tests that a
checks if the database is being asked
for the co-workers then there's another
one that checks that the response that
comes back is actually a success so the
state is 200 and then we have that and
then we implement that which will
probably look something like this if
you're using a space or something else
not really that interesting here and so
we run that again and so yeah well once
again on that list of coworkers and
still doesn't work we have the page now
but there's them some around the
database so what to fix that as well and
there's a view missing in the database
so I'm I need to write a test for that
as well run it again and now that works
and then the next step failed so i want
to click on Joe's name and that doesn't
work and so I keep going right i mean
you get the idea it's just normal TDD
test fail pass and so on so yeah that is
that's kind of the outside-in thing so
you start with the feature description
you describe what you want your software
to do oh oh you want to interact with it
and when you've got that it's pretty
much filling out the blanks right you're
just running the tests and it tells you
what to do next oh this isn't working ok
right it has for it fix it next and also
what's pretty cool is that you know when
you're done because as soon as
everything's green you can stop coding
instead of just keep working on and on
and on and just adding stuff you have a
clear goal where to go all right and
when you're done and so what that means
is that you're the design you're going
to come up with is probably a very
simple solution that just does what the
future describes are not anything else
also a nice side effect of that is that
you have a pretty good test coverage
since you're writing your test first
you're literally literally not writing
any untested code so I was a failing
test before you're implementing it and
so you also have those kind of multiple
levels of confidence in your code
because you still have those unit tests
that you know from from traditional TDD
by the way how many people here do tests
first f you okay so yeah so you have
those if you do it and then you also
have these kind of high level tests as
well these cucumbers and Aereo's and
that tell you that you're different
layers still work together because I
mean a unit has only tests like one
method of one object but what you really
need if you have like a spec that web
apps have you need to make sure that
your different layers to fit together so
yeah the database maybe observer and
then HTML and client-side code and all
that I'm just getting back to this
example that we saw here you might have
noticed we're clicking on a link here
and so how does it do that right it
clicks on links so it can and so the
answer how that works as there's a bunch
of cool tools now so we're at the next
section of my talk and those tools are
or can be these so first of all what you
can do of course is just parse HTML
using some XML parser find the link and
then pass out the hof and do that what
you can also do is use a headless
browser like for example htmlunit that
is a written in java and it's sort of a
complete browser without the GUI so you
can run it from the shell and tell it
what you do and it works kind of well it
has a few quirks and bugs in but you can
work with that and if that doesn't work
or you need extra
our extra testing awesomeness you can
actually use a real browser for example
selenium is a tool that allows you to
run or to script browsers behavior so
you can tell a browser from your test
what you do click on that link hover
over here do that and it'll do that and
you can run a surgeon's against that and
yeah test your app and there's a little
problem with these tools are the most
sophisticated they get that would slower
it is so running a selenium test takes
ages versus just passing HTML obviously
is much faster because it's just in
process right on the other hand you get
much more features if you're running a
real browser because you can also test
for browser compatibility issues and
that kind of stuff if you're using that
and if you're only using that headless
browser it's just well it's not the real
thing right so if the reader browser may
have to be different from this one and
your test one catch it and so you kind
of want to use these three altogether
depending on which scenario we have you
if you have a text you need to use at
least the headless browser if you just
have static HTML you can you see in the
inline HTML parser and so the good news
is there is a tool called capybara how
many people know that okay so capybara
is pretty cool because it allows you so
the tool to run all these others so it's
kind of an abstraction that runs all
these inside of cucumber the downside
for you guys is that it's written in
Ruby if that is a problem for for anyone
so the step definitions that i showed
you actually are not really true because
you're going to be writing ruby and
those which looks a bit different it
should be readable right and so yeah
what you can do is just
um tag the scenario here you can see at
javascript and then fiddle run in a
browser and so yeah full psych testing
which means you can test anything you
want client-side server site as a matter
the app is well tested and you have no
more bugs of course at least not so many
so back to my little project I was lucky
man so my initial idea was I would be
spending about four weeks on it cuz i
was just using it for myself to make my
own life easier right and so it would be
really simple and I wouldn't add much
and would be cool turns out I was
totally wrong on that cuz we started
offering that to other spaces as a
service and instead of four weeks and
not eight months almost full time and
that and we've had a tons of new
features and had to change some designs
and then swapped out code code and the
the code base and so we drew a lot
bigger than it was intended to be and
for that kind of changing software unit
tests don't really help you anymore
because I mean you still need them but
as I said you're not you're not covering
the interaction between your layers and
those tests so if you're changing my
lair the unit tests on that layer are
still working and also on the others
what your software's are broken so you
still need to test that and so what you
really need is a field of cucumbers AKA
cucumber test suite and so the advantage
that you get here is that it's totally
implementation independence in the
sexual language that means it's very
stable you can literally literally swept
swap out your entire code base and
replace it with something else and those
tests are still the same which means you
can run the new software against the
same test and so make sure that you
didn't break anything and so that was
pretty cool for that kind of stuff um
yeah it's a huge safety net three
minutes okay so big safety net and
my character effect or everything I need
and this way I can keep my coat clean
extensible maintainable that wouldn't
have been possible without those tests I
would keep breaking stuff again and
again and so on this way I must have a
nice picture yeah I can avoid the Aggies
spaghetti monster I need to be quick now
so M tools just to recap cucumber allows
you to write tests a natural language
and any right of step definitions which
is to map the natural language to the
implementation capybara is a written
Ruby allows you to drive all these tools
I can run your tests and different
environments from browsers to just
impresses whatever you want you can use
those kind of BDD unit testing tools
like those yes to test your code on a
unit level and there are three main
benefits from doing this first of all
you have this outside in approach which
means it drives the design process which
makes a design simpler and it helps you
to focus on what's important and what
you need and when you're done and you
know that you have that massive test
suit which is great and only also it's
just not unit test but also these
cucumber test that tests your your
layers in the interactions yeah what I
just said and also these tools allow you
to test the whole stack including
client-side JavaScript source ID
everything that gives you the confidence
to refactor your code so you can keep it
clean and avoid the spaghetti monster
and that's it pretty much things how
much time I Drive left it's not over
yeah so anyway um thanks that's my talk
that's a bunch of things and also this
one on the bottom it's an actual open
source project where you can see all
that really works got them was a bit
upside right now question what
written that's what the no I didn't
paint that that was her anyway and since
I'm running out of time one last thing
who feels like this honestly okay come
on know if you do just one piece of
advice for you stop writing shitty test
that's the only way you're going to
start testing you know never going to
start being good at it from the start
just write it they're gonna suck delete
them write better tests get better at it
and that's it for me thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>