<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Dmitry Jemerov: Static types in JavaScript: what, how and why -- JSConf EU 2013 | Coder Coacher - Coaching Coders</title><meta content="Dmitry Jemerov: Static types in JavaScript: what, how and why -- JSConf EU 2013 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Dmitry Jemerov: Static types in JavaScript: what, how and why -- JSConf EU 2013</b></h2><h5 class="post__date">2013-11-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0r9HPRJUaFo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
okay so hello everyone so my topic for
this talk might sound a little
surprising so I'm going to talk about
static typing and JavaScript and well
JavaScript is dynamically type it is a
dynamically typed language so how come
I'm going to talk about static types so
let's see so I'll start with a very
simple statement like types are there in
every program like in every program like
all the values that you manipulate with
have certain types and I do not actually
mean types in the like computer theory
sense like in the Haskell sense but
simply types that types like kind of
things that you are working with strings
objects like objects of a certain kind
that have certain attributes and so on
or functions which have like specific
set of arguments and so on and when
you're writing a program in any language
you have to understand what the types
are in order to be able to understand
code to reason about code and in order
to be able to write code and I'm not
sure if it's wise of me to show an
assembly language example in a
JavaScript conference but this is just a
single instruction so hopefully it's not
too hard
so obviously the CPU level there are no
types like there are like numbers that
are put into registers and are stored
into memory and so on but in order to
make sense of this instruction in order
to understand why it's plus four and not
plus eight and what this thing does you
need to know what they what the value of
the EDX register points to you know we
have to know what what the type is of
this thing that is stored in the memory
there and this of course this also
applies by writing when writing
JavaScript code and when we have been
and when the information is not
expressed in the source code when you
just have like a parameter declaration
what's disposing when it's not expressed
in the source code explicitly you still
have to know what this is and you still
have to understand what this thing is
about and of course because and of
course there are multiple ways to how
you can understand what this is about so
if it's a frame or function then you can
read the documentation for the framework
and you can see what it says about what
the particular function expects or what
what it gives you as a parameter if it's
your own code you can just look look
around and
see how this function is called try to
understand the context and try to figure
out what this thing is you can try to
give parameters you can get right
you can try to give meaningful names to
the parameter so from the name you can
so that from the name you can probably
figure out what the type of the thing is
but this is all of this is extra
cognitive load so it's an extra thing
that you have to think about when you
reason about the code and in some cases
it's just automatic in in some cases
this is not just as easy especially when
you have a large complicated code base
especially when you are reading the code
that you did that someone else wrote and
if it's not just like a couple of jQuery
adapters to make something's move on the
page when it's like like real big
large-scale JavaScript application and
of course with the of course the types
is the type system needs to be able to
express what what the code is about
instead type system so type of languages
like Java they are actually quite rigid
so you have classes and the class has a
fixed set of members and you have to
list the members when you are defining
the class and so on and with JavaScript
people want to have more flexibility
than that they want to have like objects
which have properties they can add some
properties and they can inspect what the
properties are there they can make
decisions based on depending on whether
some property is there or not so the
type system that you that we are using
the static type system needs to be
expressive enough to be able to state
all of these requirements and state all
of these points in the type declaration
but the interesting thing is it is
actually possible to express the stat to
infer the static types that were meant
by the JavaScript library developers so
this is the definite type brought this
is the definite typed project on github
where people actually after the fact
take JavaScript libraries written by the
community and come up with static type
declarations for all of the functions in
those libraries and you can see they
cover like a huge set so this is just
not a complete list of the libraries
that are there and it is actually
possible when you have a good language
of the good type system to express all
the types that are that have been used
by those libraries and so like in any in
any piece of JavaScript code it is also
possible with a good enough type system
to express your intentions and
your requirements another common
misconception about types is that like
type slowed you down when you change
code because you have to you have to
adapt the you have to go in and make
sure that the types actually fit and you
have to go and change the type
declarations when you are else altering
the code but this is actually all this
is actually not quite true so it does it
is true that you have to like go and
worry about the types but this is still
extremely useful to be able to
understand so the types are not there
for that for the sakes of themself for
the sake of themselves it's you they
give you a list of all the places that
you have to change when you are changing
a particular piece of code in order to
make sure that your program fit together
fits together yet that you do not end up
with the like square peg in the round
hole situation and if you don't have
types you have to run the test and you
have to like go through the test
failures and understand what exactly
needs to be changed when you because of
this test failure and you have to make
sure that you have enough coverage in
enough test covering your program and
like type save you a lot of pain in this
regard and of course a very good things
about types is that you do not have to
have them everywhere so if if in some
particular place like it's simple event
handler that takes it's like a parameter
you know what the parameter is you don't
you don't you are not ever getting
confused by that so you just leave it as
is but you can't specify types in like
more here in more complicated pieces of
code simply to support your thinking
simply to make it clear what happens in
every particular place now how can you
actually put types in a Java Script so
this was like a bit of the white part
and so how can you do actually how can
you actually do that
so first of all there are a bunch of
languages that compile to JavaScript and
that's like have fully supported static
type systems so these are just a few of
them there are actually like others so
cotton is made by JetBrains so this is
also something that I have worked on
previously but this is not what this
talk is about
so all these languages are nice they
give you a lot of a lot of power but
they require you to essentially change
the language in your project and then
the JavaScript communities can be often
a very controversial topic and there are
like many reasons why you do not want to
do that
and so this is not what I'm going to
talk about for like for the meat or my
talk today what I am going to talk to
talk about is Jays dog which is actually
great too and it actually it is much
more than just the cogeneration tool it
is a tool that lets you simply document
your code by adding parameter names like
like describing function specifying what
the negative of the purpose of the
parameters are and so on but it does
much more than that it has actually
built-in type system that allows you to
express like all of those things that I
was just talking about all of the
requirements all of the expectations
that you have about functions all of the
like like all the parameter types and so
on okay and beside the documentation
there are also tools that can make use
of this additional information to do
error checking and to improve your code
experience when you write code so Google
closure compiler is an example of a tool
that does quite extensive type checking
based on based on j-stop information and
webstorm is the tool that i'm currently
working on it's an ID for JavaScript and
it can extract a lot of value from JSTOR
comments and I'm going to show you how
exactly so the problem is just doc is
that there are actually more than there
is just no single standard J's doc
format that like everyone knows how to
use there are like multiple versions of
that there is like J's dog 3 which is
like the new kid on the block there are
multiple like older tools that use that
use different dialects of the Bluejays
doc and also documentation that is not
quite JSTOR but similar to that and its
form and function but the things that
I'm going to show you now are like
mostly there like there is a common
ground between all of the tools and this
and you can use it for for your for your
project and just to show that is not
that like there are like real people out
there that use J's dog for their comment
and for their comments this is just a
piece of the fire box source code and
you can see an example for how this is
used like this is the most common thing
the parameter
so the parameter it has a type string
the name of the parameter we are
documenting is expression and like what
it means is the expression which is I
guess not very useful and once you have
this kind of information let's see how
what you can do with that so for example
here is a very simple example of
function that has a string parameter and
we are calling it with a passing it an
integer so in this case it's not going
to crash Trotta but still it's not it's
something that we want to be able to be
able to get a warning about because this
isn't we are not using the function in a
way that I meant and this is an example
of a message produced by the Google
closure compiler to let it to rule
notify you about the error so this is
not an error actually this is a warning
but they still give tells you that the
actual parameter does not start them
does not match the formal parameter so
it's not a string it's a number and now
let's see what additional checks can be
performed by webstorm for examples so
yeah this is a function that takes it
takes an object and this object has to
have this number of fields like name age
and an optional professional profession
field and when we are passing some
specific objects that we also declare
the type of we can get a warning about
the mismatch of the type so like the we
are passing a structure that only has a
string as a string field and the
structure that the function expects must
have the swing and the number so the
function is going to crash and we get a
static of type warning about this yeah
this is a simpler example we are simply
define this rush in line and we are
passing into the function G's dog also
gives us a way to express certain so you
had certain class like constructs so
yeah JavaScript users prototype
inheritance what the people wanted to
use like want to use it like a more
object-oriented language and his dog has
tags to support this with a class tag
please find that the particular
functions the constructor works the
constructor of a class you can specimen
mark one classes extending another class
you can declare static members and also
declare the types of them and so on and
this actually gives you a common ground
among all of the different javascript
libraries which each of those implements
their own concept of inheritance
and so on and this this is just how you
can express all of those in a single in
a simple way also continuing the object
oriented programming topic you can also
express that some member is private of
course this is not enforced at runtime
so that there is no encapsulation
JavaScript but in an ID or when a
compiling your code you can get warnings
about trying to access private members
of a class another concept supported by
J's talk is the concept of interfaces so
this is this this allows you to say that
an object that you pass through some
function needs to have a certain set of
methods yeah this interface tag is used
to do that and when yes and you can also
mark an object that as requiring to
implement some interface and if it does
not actually implement the interface
then you get a warning because like the
implementation of the interfaces are not
there and once you do that it's very
easy to generate the implementations and
webstorm so you can just invoke the
implement methods quick fix and the
implementations are generated for you
it's quite easy to use the next concept
is announced so just the set of just
when a function takes the values that
need to be in a particular set you can
annotate this set as an enum and we are
trying to pass or to assign something
else to a function you get an warning
about not like this this thing is not
assignable it does not have the right
type you can also the next thing I'm
going to show you the type def tag so
the type def it actually allows you to
give a short name to a particular set of
like a set of object fields so like if
this is an this is no object like this
if this is a set of fields that you
commonly used when it does not have like
a class or space like a specific class
at a constructor function you can just
take this thing and give it a specific
particular name and you like use it in
your code and according to this name and
so in this case yeah we
you can simply after once you do that
you can use it as simply an parameters
and then type tags just all over the
place there are many more tags in J's
talk I'm not going to talk about all of
them because this would get quite boring
quite quickly but just the key concepts
are the one that the ones that have been
the traffic shown previously listen this
is another example which shows how JSTOR
can be used for JSTOR can be useful and
in this case the J's talk that we are
talking about or is that is the
documentation for for the job for the
standard job field function that we have
as part of the webstorm distribution so
in this case we are making a mistake
that's very easy to that's very easy to
make accidentally so to this set
interval function instead of passing the
function itself we are passing the
return value of the function which is
not going to work because this function
does not return anything just returns
undefined and webstorm can actually
highlight this error and so yeah
actually get this cubicle you can also
see that the type system allows you to
express alternatives and types so this
this thing must be either a string or a
function this or this pipe marker means
that yeah and this is how we how we
declare the types for the expected types
or sentence for the set interval
function it is just part of like this
these documents are just part of the
standard distribution of webstorm we are
simply maintaining this information to
make sure it's accurate and it reflects
all the stuff that's going on in the
browsers another thing that can the
another feature of webstorm that relies
on static type information is parameter
in for parameter information so it's a
very just very easy way to get to get a
tooltip for the function that you are
calling to get to check whether the
parameters that that it takes to match
your expectations the code completion
can also make use of static typing
information so in this case we have
declared the parameter parameter as a as
an element and so the completion
variants are generated based on knowing
the type of this value and so it's an
element and so we show the list of
members for element
this also works in slightly more
complicated situations so in this case
we have declared that the change
function takes a callback and the D and
in the context of the callback this is
going to be an element and so now we are
calling the change function and invoking
the code completion for this and once
again we get the list of the list of
members for element so this is also
quite handy in the next example we are
we are also we are also seeing another
common pattern in JavaScript libraries
where we have an object we has like so
instead of adding multiple parameters
for different separate parameters for
different options that the function can
take which as they make a single
settings object and we put all the sync
all of the things that we want to pass
to the function as attributes on the
settings object and we declare the types
of those so like in this case the
settings object has a context parameter
and the URL parameter and we are calling
the Ajax function passing in an object
object literal and inside the object
literal we get the completion for or for
the parameters that we have declared
webstorm also has a bunch of features
for helping you write J's documents and
so for example in this case we have a
function and we have started writing and
document for in for it so we have simply
started so we have simply type slash
double asterisk and we simply press
ENTER and once we do that we get a stop
for the door comment so we have actually
analyzed the code of the function we
have try to infer its return type and so
we have generated the returns tag for
you and because we don't know anything
about the object we just leave the
parameter declaration as is so you can
complete it as you need the refactorings
in webstorm also worked with the J's
Dogg comments correctly so in this case
we are we are taking a function and we
are going to apply the introduce Panther
refactoring to it so we select the piece
of code we press the shortcut to invoke
the refactoring it and it offers us the
generate a stock option
and then when we invoke the refactoring
you see that the function that we have
generated has the parameter tagged with
a correct parameter type we also have a
bunch of quick fixes - correct - correct
faulty J's dog comments so for example
in this case we have a variable that is
that this has actually a type of string
but and it is a data to have as have any
type number and we can invoke a quick
fix to correct this for us so we invoke
it and it changes the age a stock
declaration also common case is when we
have a J's comment that does not include
any information about types includes
just the description of the function and
we can invoke the fixed comment fixed
action the the fixed or comment action
in order to bring the to complete the
J's dog declaration with all the stuff
that needs to be there so we invoke the
action and now it gives out the actual
results that we give that the parameter
and the return type declarations
actually the so yeah as I mentioned so
J's dog has quite a sophisticated type
system and it's also interesting that
this the type system of JS JS dog maps
quite well - the type system of
typescript so like for the many like for
like many things supported by this dog
there are like good equivalents in the
types you type system and what what this
lets us do is actually it's less it lets
us use a single internal representation
for all of the types in your program and
to also use the declarations created by
the typescript community in order to
make to improve the quality of the code
completion in your JavaScript code so
even if you're writing in plain
JavaScript Hindman if you don't use any
type script in your application you can
still download the typescript stubs and
they are going to improve their code
completion experience very significantly
so we have a specific action for that
you can just go download and install a
library select the typescript immunity
stubs there's like a long list of
libraries that are there and you can you
can invoke you can select the one that
you need and it will be downloaded as
part of your project this is what the
declaration look
the declarations in those libraries
looks like so just Route interface like
callbacks methods and stuff like that
and here's how the code completion works
when you have this information so want
to get once again this is pure
JavaScript there is no typescript
anywhere in your project just in those
stop files and still we get all of the
all of the assistance that all of the
useful information that is contained in
those stop libraries so so that
concludes my presentation actually so as
we have seen there is a lot of power
that could be gained by simply using J's
talk to annotate your JavaScript code
with additional information about the
types it's going to help you with
refactorings it's going to help you with
code completion is going to generally
help you make your code easier to
maintain and you can apply this
technique exactly when you need it and
exactly to the degree that you need it
where it where it is actually helpful
and simply the places where it's not
helpful just leave them alone and there
are tools that can make a lot of that
can extract a lot of value for this
information make your life easier and
yeah webstorm is one of those tools
Google closure compiler is another is
another and yeah please go and use JSTOR
for your projects
we think we have some time for
five minutes for questions if anybody
wants question yep
hello no yes I I'm a bit slow today so
I'm sorry if this has been covered but I
wondered what if I wanted to do like a
postal code as a type I basically want
to string everything that the string is
like so I don't really want to create a
new class for it so if they're astern of
this technology what would allow me to
just sort of say that this function
returns and add a postal code it just
happens to be a string but I demand that
it's been called a postal code and
functions taking postal code will
require it to be this I'm not just a
random string I'm actually not quite
true so I think the type dev tag can
allow you to do that so you can like
type dev string as postal code and I'm
not sure if the static static checks are
going to be able to catch like you you
calling this incorrectly but at least
you will have this information written
in the code for use to you that you can
see that this takes a postal code hello
hey hey so uh given that the J stock is
completely unrelated to the code that
you command so you can synthesize a
function synthesize properties etc how
how do you think editors should react
when you try to you know mock them or
fool them
like you declare a property doesn't
exist or contradicts what you write in
the in the function this is for instance
this web from autocorrect this suggests
so actually for something like object
attributes we do not so if you are
declaring it an attribute that is not
explicitly defined anywhere in your code
we do not try to highlight this as an
error so we simply we assume that you
created somehow in some way that we do
not understand and so like the if you
declare that the attribute is there then
it's there for something like a fashion
function parameter if you for example if
you're in the if you have a parameter
that if you document a parameter that
the function does not actually take then
we do highlight this as a warning
because most likely you made a mistake
when you rename the parameter and forgot
to update the J stock or something like
that in this case we do highlight this
anyone else ultimate tree is here so if
you've any more questions you can just
come up and ask him we're breaking now
for an hour it's lunchtime thank you for
attention
thanks again
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>