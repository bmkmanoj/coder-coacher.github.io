<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>David Calhoun: Realtime Satellite Tracking in the Browser [JSConf2014] | Coder Coacher - Coaching Coders</title><meta content="David Calhoun: Realtime Satellite Tracking in the Browser [JSConf2014] - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>David Calhoun: Realtime Satellite Tracking in the Browser [JSConf2014]</b></h2><h5 class="post__date">2014-06-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vtvHOn9mIB4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">yeah so my name is David Calhoun as you
can read my talk is real-time satellite
tracking in the browser and not real
time in the sense as a last talk but
real time is that in that it's updating
and you can get the current location but
not like the two-way you know nice data
binding as described in the last time
but it's cool stuff I'm doing some basic
JavaScript I'm not doing anything with
emoji or anything like that so as people
walk out the doors and so started
disappoint you but yeah I work at a
place called skybox imaging and they
wanted me to show you this fancy slide
with a bunch of numbers and dollar signs
and stuff I just wanted to say like yeah
we launched a satellite last year which
is pretty cool a microsatellite and
we're in a launch one soon this year
that's all I want to say so skip it okay
so as for products we sell some cool
stuff we call these sky nodes on the
very left side and we sell that to
customers who you know are interested in
talking directly to our satellites and
actually processing images on server
racks that they actually own and control
pretty cool so and we saw the imagery
and video and of course we have like an
analytics component of all of that it's
cool we have the right and mountain to
view we have a clean room where we
constructed the satellites one of those
is in space know which is pretty crazy
to think about pretty smart people work
in there and as just a front end or UI
engineer I tend to think like at places
like this I'm overwhelmed by the amount
of intelligence in the room but I'm also
overwhelmed at sky
box because we have basically like
rocket scientists and they talk about
words I've never heard before and have
to go look them up and everything so
it's very very humbling very educational
experience we have this mission
operation center which is right in
Mountain View to and the screen in the
very back of the room actually I helped
develop that when I first joined skybox
it's a telemetry dashboard so it's
pretty awesome to see them actually
using that to to monitor communications
with the satellite as it makes it past
about every 90 minutes yeah and here's
some cool stuff like color infrared and
then we have this which is where is it
it's a little bit of a special slide
there goes so that's actually not an
image that's actually a video of the
tallest building in the world as a plane
flies by in the front so that's pretty
amazing and that's real parallax there
it's not parallax scrolling or anything
like that so i have to say these corny
jokes and i have to say we're hiring so
but i don't want to take too much time
Zanna but as a UI engineer I get to work
on cool stuff so I won't spend too much
time doing this I already mentioned the
telemetry dashboard some of these are
mapped based so it's actually quite
useful to understand some of the orbital
adji and the orbital mechanics mechanics
concepts behind the scenes even if I
don't fully understand the math which I
don't I could actually I could get the
words and get the terminology and just
to understand that is a huge leap so
we'll see a little bit of those concepts
in this but nothing too crazy no heavy
math so my goal is like to actually like
present something that everyone will be
able to understand and build and yeah I
gave a link to the to the to the talk
actually online so do a search for Jas
conf yeah and one of mine will be on the
top live upload the slides I've also
uploaded like step-by-step so you can
actually take this home and and do it
yourself nothing too crazy going on so I
just want to step backwards literally
for like 50 years actually over 50 years
ago so you're standing in your backyard
enjoying the dark black
sky the night sky um that's supposed to
happen that's okay you know it's very
early in the morning or late at night
and you tune your ham radio into the
right frequency and you know you look up
and you see this thing going across the
sky and you hear this do I have audio oh
I don't know if we can all hear this but
you hear this strange sound I should
have checked the audio first anyway it's
this telemetry signal for something
strange out there what the heck is that
its 19th years 1957 who knows the name
of what it is Sputnik exactly so this
guy this little unimpressive guy and
that's his only job to send that
telemetry signal out and from the
comfort of your own backyard in America
or wherever you are you can see this
soviet-built satellite go up across you
can see this and potentially it can see
you it doesn't have any optics or
anything in the middle of the Cold War
freaky as hell like this you know this
thing that could be an ICBM it could
have some nuclear payload is going right
right over your backyard literally so
it's somehow you know it's like all of a
sudden suddenly becomes quite important
to know like what is this thing and can
I actually track where it's going to be
tomorrow and the next day where is it
where is it going to orbit over that
suddenly becomes important and it
becomes early front-page news so if you
want to know if you want to keep up
today this is your main source as an
amateur you know person who has interest
in this and actually back then everyone
who hadn't had an interest in this
because it's quite important and you get
this one orbit track line it shows you
okay there's the satellite but that's
not quite hopeful it's like okay at one
point in time sometime yesterday or
something like that there's where the
satellite was well where is it right now
you know isn't that more useful so you
keep up-to-date you look you checking
another newspaper and you see this thing
that gives you more details sorry okay
the satellite is going to cross the 40th
parallel at these times which is
relevant for a mare
so it's like at those times you know you
can potentially go out in your backyard
and the Soviets were where they were
honest and saying if you had a cheap
pair of binoculars and you point in just
the right area extremely difficult but
you could actually see it or you could
see it with your eyes reflect off the
Sun if it was just the right right
timing but that's all you had at you as
your resources as an amateur you had to
rely on the newspaper so like we can't
really do that nowadays when we launch
our satellites and newspapers don't
really care there's a bunch of space
debris floating around up there people
you know newspapers aren't really
excited this is just because it was the
first time and it was especially
relevant for the Cold War so let's
fast-forward back 20 about last year in
November so should have Oh Dan play
there we go oh crap it's an ICBM
actually it's a decommissioned ICBM oh
stop playing ah it's a decommissioned
ICBM that's actually used for commercial
purposes and our satellite went up on
this with a bunch of other
microsatellites and someone in my
company had a good point they said that
the Russians former Soviets actually
turn into great capitalists because I
realized that they had all these ICBMs
lying around and they took out the
nuclear payload basically made contracts
with countries and companies and
realized I could profit like crazy off
of this so turned out to be fortuitous
on both sides so pretty amazing that we
came from the blaze of Sputnik and then
into the present day where were actually
passed the Cold War and actually doing
useful things with this in commercial
things with this but the goal is still
the same it's like back then you know I
was working on a project it happened to
be a map-based project that had orbit
lines and everything but I really wanted
to know ok how difficult is it for
someone like someone normal reasonably
normal like me who doesn't know a lot of
math who knows basic well some
JavaScript and can put some stuff
together and mash things together how
difficult is that so
I became my goal as sort of like a hack
date project my goal is to plot this the
current position of sky SAT one which is
the name of our satellite stick it on a
map okay let's see how far we can go so
first we need a map that's useful we
could use Google Maps that's another
option we happen to use leaflet j/s
which is a little more flexible it's
like a nice alternative very
customizable and this is what you get
straight out of the box in this pretty
plain looking map with some zoom
controls nothing too fancy the code for
this is pretty simple I copied it
straight out of there tutorial so
there's nothing fancy going on here I
set a latitude longitude which is just 0
0 to make it simple set a zoom level if
you've ever used google maps it's the
same concept zoom of one just happens to
be completely zoomed out widest angle
possible and then we add a tile layer
which which happens to be open street
map tiles and then that's what we get
out of it okay that's all well and good
but so we want to customize the tiles
and I don't like those colors maybe ok
we have an option to use matte box tiles
so matte box is a service that takes
those open street maps and and lets you
customize it puts tiles on it not as
simple as sort of like putting CSS
Styles on it but they help you with a
little interface you can customize it
you can go crazy you can do whatever you
want with the colors on here as an
example which something I wouldn't
recommend hello kitty theme if you're
really into hello kitty oh that looks
term okay well anyway that's hello kitty
colors you can go crazy and customize it
it's up to it's up to your whim
basically it's pretty simple you log in
and create an account you get a free
account to play around with you could
you say create a project which ends up
being your satellite tracker map and you
get an API key there so that just
happens to be my key so I copy and paste
it and paste it into my in it code so
now I can take out the actual vanilla
leaflet JavaScript include dump in Matt
boxes which is actually like a wrapper
around leaflet so it takes care of
everything for you it's still leaflet
but with some extra functions on it and
mapbox titles which is sweet so I can
customize it the initialization is
pretty much the same a little simpler
passing my api api key and i'm still
passing in the latin that long and the
zoom level so okay not too crazy so we
have our map now we probably want to put
a custom icon on there for our satellite
so I just grabbed a little icon of
that's roughly what sky SAT one looks
like with this door open it pops open
when it's in space and points down and
it's hovering over a location it's kind
of somewhere in northern Florida have no
idea where that would be probably around
here so i just took the latitude
longitude from amelia island plugged it
in there and then you can do it with
this don't let this frighten you if
you're new to java script or anything
it's super simple there's a basic
example at the top so you can say i just
want to put like the default leaflet map
marker on there at this latitude
longitude add it to my damn map and get
it over with or you can say well i want
a custom icon so you can specify the
path you know there's even one now for
the retina or you know high quality
displays high pixel density displays
specify the icon size and then the
anchor point is actually where you want
to position where you want to map the
latitude longitude relative to your
actual icon in this case we're just
putting it smack dab in the center some
cases you might want to put it on the
upper left or so forth but keeping it
simple now ok all set I think we got
everything we need right I'll know what
actually ok we're kind of missing some
things we're missing math some
astrophysics probably missing some more
math in there just for good measure
probably should throw that in there so
we it turns out we actually have to
backtrack a bit just to give you the
concepts we have to do the fastest orbit
ology crash course in the history and
probably not one of the best but that's
cool because you'll get a better
understanding of what's going on with
this math that we're going to use so way
back when when the earth was the center
of the universe
at least philosophically they actually
made the math work but with these crazy
epicycle things which end up looking
like little spirograph points so this
actually was a functional mathematically
like functional working model to predict
positions of planets and so forth but
they knew something was messed up
obviously you know the thing that they
have a philosophy that things in the
heavens were perfect it comes from
philosophy it's like the heavenly
spheres and things they're all perfect
circles perfect spheres obviously this
model doesn't have those perfect circles
in it so something is wrong with the
model but hey the math works so we'll
stick with it for about a thousand years
or so or longer so until Copernicus
comes along and actually the Greek way
before him actually believed in a
heliocentric Sun standard model of
everything but the the heliocentric
model actually rectified some of that
math so jumping past there took until
Kepler Kepler's first law says okay well
actually these orbits that go around the
Sun aren't perfect circle's turns out
the heavens aren't perfect after all
sorry to break the news to their slight
ellipses they're slight when you look at
them it looks almost like perfect
circles but they're slightly ellipses
and that makes the math work a little
better but we still can't make the
predictions we can't plug in numbers and
predict the position of where will this
be at this point in time that took until
Newton and it Newton has something
called the two body two body problem
okay then so Newton solved for the math
for this I took out as much of the math
as I could on here there's still a
little bit but I took out the formulas
mean basically solved for this and made
this work so in this case we can say
okay the blue thing in the middle is the
earth and that sky SAT one around there
so he did the math for that and that
math is actually very elegant works very
well in a system when there's only two
bodies but there's a problem that's not
actually reflective of reality there's
no actual to body system everything is
connected to each other gravitationally
everything's affecting each
there it turns out to be a huge problem
with the math and it makes things a
little crazy it's what they're called
it's what's called perturbations to the
orbit basically perturbations are things
that affect that two body problem and
the big things would be like the Sun the
Moon the earth even the virtue of the
earth be no blade which is not a perfect
sphere an oblate spheroid it actually
affects that it's actually measured as a
perturbation in itself it could be like
atmospheric drag little comets that go
by everything is related to it so so in
reality we actually have an N body
problem there's so many things flying
around out there they have an effect on
this and if we want a perfect model we
have to throw all of those into the math
into the perturbations formula which I
don't know how to do I'm not that good
at math and it's literally like rocket
science so not a lot of people can do
this but there's books about it and you
can get the concepts so what's useful
for us is that we have the what's called
this simplified perturbations model
which is abbreviated as sgp for and the
formulas for these were actually
released in the 80s i think it was right
in 1980 originally in fortran which
shows you about how old that is it's
been ported to so many things since then
to Joe about to see to MATLAB even and
of course now it's in JavaScript people
have poured it to JavaScript and when I
say simplified you know maybe it's like
someone's concept of simplified but that
does not appear to me to be like
simplified it's it's scary stuff
happening and yeah this is from
satellite jas so this is a port this is
just a glimpse into the file of what's
actually going on and they left the
comments intact it actually at the top
of the code blocks it still has comments
from the procedures from the fortran
code and from the port to c plus bus so
it's been ported like crazy and every
time it gets ported it has a run it has
a series of tests that you can test it
against to make sure that the math is
still preserved even though it's you
know actually I like a port but it's
pretty it looks pretty crazy the good
news is someone has already ported that
and we could theoretically interface to
it in
easy way which we can but we need inputs
for those functions so the sgp for gives
us the functions we still need to put
inputs into it and what we use it as
inputs are these things called tles so
there are two line element sets and I
show a picture of a punch card which i
also saw way earlier this morning at the
beginning of the day oh this is where
they originated in punch card land and
then in this in the age of mainframe
computers that were churning and
processing out all these calculations it
turns out we still use the same format
so even when we get to JavaScript land
when we ported everything all the way
through the tle still preserves the same
format as the punch card it actually
things are spaced out exactly where
they've been for so long like you know
decades and decades so it actually the
format exactly resembles it which is
pretty cool yeah so and what i'm doing
here is i'm basically saying okay the
tle gives us some information about the
satellite at a certain point of time and
because this is a simplified model the
math actually deviates over time so when
you have a tle for a certain day it's
been updated you get the updated tle you
plug it into the system that the math is
going to deviate a little if there's
going to be some drift day by day so you
after you have to keep the TL ease up to
date and there's a place online where
you can get these for free called
Celeste track actually if you just do a
search for any satellite like your
favorite satellite on Google like sky
SAT one tle or ISS for International
Space Station TLD they'll have tles that
get updated very frequently because
everyone plugs them in to their sgp for
a models you know and they and this is
useful information it shows us the parts
of the it shows us a little bit about
the orbit what's called eccentricity
inclination all these things you could
look up I'm not going to explain it
eccentricity is interesting one it
actually tells you how far does that
orbit deviate from a perfect circle so
there's there's no perfect circles of
course but there's there also there's
crazy orbits like for spy satellites
that
actually are hugely eccentric actually
the orbit goes way out here and it comes
when it comes back around the earth it
gets quite close to the earth and the
purpose is exactly for spying purposes
that is one purpose it goes with the
weight of the heck around comes swings
around really fast close to the earth
and comes out again so that number would
be quite different but yeah that gives
you an idea of what those represent I do
have a little tool down there I have a
link to it so you can check it out after
but I do have a tool that kind of helps
you like educate yourself about how the
others breaks down the first line turns
out to be more descriptive it doesn't
change much it tells you what the
satellite number is like the year it was
launched is that 1366 is that is the
number of the launch for that year see
is the piece of that launch so we were
also launched with Dubai sad and some
other satellites that have a different
number they might be B or D or something
like that 14 is the is the year that the
tle was generated so it's in this year
and then one 48.1 77 it's a fractional
number for what day of the year is it
out of 365 days so it's quite
descriptive and you can see when it gets
out of date by you know check-in that so
that's our input that's what we need we
have all the raw materials and we just
have to mash them together now we really
like standing on the shoulders of giants
so now at this point okay we plug them
into our functions so we need to get sgp
sgp for functions in JavaScript and we
have a couple options I found these two
main ones there's this one thing called
i SAT which is a nice NASA based
satellite viewer the end result of it is
actually a WebGL based nice 3d globe and
it plots the position of any satellite
on there I didn't use it because it's
not like a standalone sgp for library
it's actually and it's not actually an
active development it has a lot of tests
and it looks like everything's pretty
pretty accurate but it's like okay it's
just not in development now so I kind of
want to keep my hands off
that and i am using satellite Jase
alternatively because it's still an
active development the API is not
perfect but you know it's getting better
you know and it serves a single purpose
the purpose that I want so how do we
interface to this it turns out to be not
as clean of API as we want it like
ideally I have to write this little
helper wrapper function this thing that
don't let this frightened new nothing
complicated is happening here it's
called a function called gets at lot
that long so I'm going to plug in at tle
no plug in an optional local time if I
don't pass in a local time it's going to
default and whatever is now and then
it's going to take that local time and
this is an important step you have to
convert that to UTC time which is
roughly equivalent to gmt time there's
one catch here you have to there's off
by one thing in the library so so you
have to add one to the JavaScript month
the months in JavaScript are zeroth base
so you just add one and everything is
happy after that and then there's a lot
more to this function actually below but
it's straight up copied from there read
me so I didn't really do that much work
here I just have to like sanitize it
massage the data a little bit all i did
is write a nice little wrap around for
it and this is an example of the usage I
plugged in our tle for the sky set one
just plugging it right into the function
so what that's going to return is an
array of that lung that long of the
current position of the satellite
because I didn't passing at time I can
optionally pass in whatever time I want
so i could say in one hour what's going
to be the lab that long and it will give
that and then i'm going to do a simple
interval on it nothing too fancy every
two seconds update it and for that
leaflet marker update the latitude
longitude and we get something that
looks like i'm having a problem the
videos here dan you get something that
should be this ah very slight slightly
moving along there and I put a nice
little CSS transition
animation on it every two seconds it
gets updated and it kind of jumps a
little so all I did because leaf it
behind the scenes is doing a translate
3d I know I can animate that in CSS and
I just put a little transition on it a
two second transition so technically the
position is a little off but two seconds
but it's accurate enough where you get
the idea and it looks it moves pretty
gracefully across the screen okay that's
cool and it's supposed to stop there
because it's a video oh now it'd be nice
probably to have an orbit line just
because that would be nice where where
has the orbit been you know for a period
of time and where is it going to be
that's actually quite useful could be
useful for humanitarian purposes too we
know there's like some event in some
country and we want to see ok we know
sky set is an imaging satellite we want
to see when's the next opportunity when
we can actually take an image of that
country when's when's the next pass
going to be so this turns out to be
quite useful so we can generate what we
call a ground track which is just a
basic orbit line nothing too fancy going
on here too so don't be afraid the steps
are basically how many so we're going to
learn a piggyback on the thing that's
about the very end of this function
which is a polyline leaflet polyline
accepts an array of latitude longitude
and plots them on a polyline and so we
have to generate all those latitude
longitude and we have to generate them
by step intervals so I'm going to say
let's do one minute intervals because
that should be pretty enough line
especially when we resume doubt it
should be pretty smooth and we're going
to have a time upset so I'm just going
to say give me three hours in the past
and give me three hours in the future
and plot this orbit line for me I'm
sticking them into this array that's
what that while loop is doing and stick
the polyline on the screen give it a
blue color and we get something that's a
little ugly so it turns out leaflet has
this problem when the map wraps around
and also when the map goes across the
International Date Line it's a famous
source of headaches and all the the
computations
that breaks off there just happens to be
the International Date boundary so you
can see the lines at the bottom
obviously aren't correct it's not going
to jump across there but with some
further refinements you can get it to a
point where it's a little cleaner than
that there's also some like some
distortion there's some built-in
distortion into these maps actually
because this is a this is a projection
of a 3d space of a sphere so there's
gonna there's actually a huge distortion
at the poles and you can see a little
bit of that because our step function
isn't precise enough and near the poles
you can see actually like the lines
become even more jagged that's actually
an indication of the map distortion and
that sort of leads to what would be the
next steps with what do I do with this
like it actually turns out to be more
useful I don't have time to get into it
but you it's actually more intuitive if
you go to 3d maps because you can see
the orbits they actually intuitively
logically make more sense these orbits
are kind of crazy because there are map
projection doesn't seem right but with
this you have you have a couple tools
there's one out there called cesium
cesium this is what powers that what I
was talking about before i SAT it kind
of does all the fun work for you so you
don't have to do you can customize it
but you don't have to do terribly a lot
of work there's another one that's more
customizable with three j/s which is
more of a WebGL type of example and
there's this awesome tutorial that
someone other than read it online they
start with a sphere and 3gs put a little
texture around it put put the map
texture around it stretch it around they
get some clouds as a separate layer that
they can animate separately and the nice
thing about three JSI don't have it here
but you can plug in cad models in here
so i actually found like the cad model
on the share drive somewhere of the
satellite which we've actually like we
we don't have it there anymore and i
can't show it to because of you know
restrictions but i was able to plug in
that cad model it was way too big for my
purposes because it had all the little
detailed components about the satellite
inside but that actually worked very
slowly on here and I could see it
floating around
up there so that's what you can spring
board off of you can do all sorts of
stuff and everyone should be able to go
through the examples again I have the
link posted there jas kana its bit ly /
satellite and that shows all the steps
it corresponds to my slides through step
1 to the N so everyone should be able to
load that up and be able to tweak it and
play around with it yeah ping me on on
Twitter if you have any questions or any
questions about what I've been working
on happy to to answer so yeah that's
about it thank you for thank you for
listening</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>