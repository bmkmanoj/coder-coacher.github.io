<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Mary Rose Cook: Fakery, Artificial Intelligence, Collision Detection, a 2D Platform Shooter in JS | Coder Coacher - Coaching Coders</title><meta content="Mary Rose Cook: Fakery, Artificial Intelligence, Collision Detection, a 2D Platform Shooter in JS - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Mary Rose Cook: Fakery, Artificial Intelligence, Collision Detection, a 2D Platform Shooter in JS</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BYzvPhg4r8g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm Mary I'm going to talk about pistol
 which is a game i wrote in
JavaScript you played a pistol in
this game and i'll start off with a demo
to show how it works so you're the
little women on the bottom there and you
have to kill all of these policemen in
the level
see you get the idea okay um so I read
it in JavaScript and it's based on a
framework called the render engine which
is written by a man called breakfast or
e it's really cool it runs in the canvas
element and it works in any modern web
browser but I'm not going to talk about
any of that I'm going to talk about
fakery which i think is essential to
making games collision detection so the
code that i use to figure out what the
two objects were colliding artificial
intelligence so the code that runs the
enemies and at the end a little bit
about falling in love so fakery first up
recently over this book called Tinker
Tailor Soldier Spy which is by a man
called John the Carrie and I became kind
of completely obsessed with the book
I've read it several times and it's
about mi6 the British secret service and
they discover that they've got a Russian
agent working inside the organization
and they don't know who he is and
they've got to find him and the name for
such a person is a mall and the way this
person works as they pretend to be in a
kind of helping the organization they're
a part of but actually they're working
against it and I think if you're a mall
then you've got to keep like two
realities in your head first of all this
kind of fake reality which you're trying
to convince all the people around you
that you're working for British
interests to bring down the Russians or
whatever arm but actually underneath is
this real reality where in fact you're
trying to feed information back to the
Russians or trying to sabotage British
operations and I think making games you
have to do exactly the same thing to
keep these two realities in your head
where there's the kind of fake reality
we are trying to conjure these illusions
in the players head so
you want them to believe that there
really a grenade has just gone off by
their head or that they're trying to
kill policemen in some crazy utopian
world or whatever but then underneath
that you've got the real reality which
is just pixels moving around on a screen
so you a single red pixel might model
something like a fireball coming out of
an exploding barrel or a piece of
shrapnel from a grenade or a flame
licking up out of a bin that has a fire
burning inside it and so I'm going to
talk about a few of the bits of fakery
that I did in pistol slap and first up
particles so of particle is just a name
for a single pixel which has a certain
color and a set of behaviors and I use
particles for a bunch of different
things in the game so the five walls
that are thrown out by an exploding
barrel the fragments of shrapnel that a
produced foot by grenade when it
explodes the shrapnel that's thrown up
by a mortar round when it hits the
ground the flashes that come out of the
muzzle of a gun when it's fired the
sparks that have thrown out by firework
exploding the flames that come out of a
barrel that's on fire the debris that
comes out when a bullet hits a wall and
there's like this shower of sparks that
come out or the drops of blood that spew
out of an enemy when they're hit with a
bullet so this is a fire done with
particles and there's four basic rules
that control each of these particles
number one they have a fixed life so in
the game in pistol slide seven hundred
milliseconds number two they have a
fixed color cycle so they go from yellow
to red via orange number three days
start with a random speed so that's how
you get that high up red particle at the
top because that had a higher speed than
average and number four if your fire is
burning between here and here then each
new particle is spawned at a random
place along that line
and I use the same rules to produce
these particles which for when a grenade
goes off so you can't quite see it on
the slide there but a grenade has gone
off in the bottom right-hand corner of
the screen and then it's throwing out
all these particles but in grenade
particle or rather grenade shrapnel
particles have a bit of extra behavior
which is when they hit a solid object
then you get these plumes of yellow near
the bottom there so pieces of shrapnel
hit the floor and then thrown up more
more particles which are all yellow and
kind of simulate the idea of spa a
shower of sparks next bit of fakery in
pistol is parallax scrolling so
this is a way of faking depths in a 2d
game so if you and it's basically just
blind sliding sliding over each other so
if you imagine that my two hands at my
to a two bits of parallax layers then
there's three things that control when
you look at my hands how far away they
are in your brain so number one is this
hand because it's slightly further away
looks a tiny bit smaller number two if I
move them at what I promise you is equal
pace have passed each other then this
one looks like it's moving very slightly
slower number three when these hands
cross each other this one because it's
nearer to you obscures this hand so i
use those three things to generate this
illusion of depth in the game so you can
see that in this in this movie I've
taken out all the enemies so that large
you can't see it so the building is
really close and it's moving faster
those lanterns are further away and
they're moving more slowly and anis
three street lamps they'd all be the
same size if they were all up close but
I've drawn them smaller and made them
move more slowly which makes them look
like they're further away final bit of
folk who I'm going to talk about his
performance I think pistols that looks
like something on the nez so a game from
30 years ago
but you know it's running on a modern
computer and part of the reason well
there's many reasons for this probably
i'm a terrible programmer and i can't
draw very well but also there's not much
performance available in the browser
though WebGL is looking pretty amazing
and so i spent a lot of time optimizing
coat however yeah brilliant I find that
when you try and make code run faster
it's often a specific thing to that
piece of code that turns out to be the
problem so I dive into lots of different
bits of code and and say okay what's
wrong with this wise it's though and
then fix the problem but then there was
a general technique that I used again
and again and was able to apply to lots
of different pieces of code that we're
trying to achieve very different things
and that was the concept of denial so
essentially what can you ignore and then
if you can ignore it then it means you'd
have to spend any processing power on it
and you can use that processing power on
something else so there's two ways to
look at this if you imagine you're an
object in the game then do you have to
do your thing or can you just not bother
so if I'm an enemy do I need to move
around or if I'm a fire do i need to
bother burning or if I'm a firework
launcher do I need to launch or if I'm
an enemy do I need to have a brain or
can I just stand there or if I'm a piece
of ordnance like a bullet or a piece of
shrapnel do I need to continue to exist
and the other way to look at it is if
I'm an object in the game then there's
quite often I have to look at other
objects in the game and make decisions
about them so this must happen most
often happens with the enemies so if I'm
an enemy then and I'm trying to avoid
killing my my buddies who are on the
same side as me do I need to check out
where they all are or can I just look at
a subset of the other enemies in the
level or if I'm looking for a piece of
cover and I'm an enemy do I have to
consider all of the park benches in the
level or just a subset or if I'm hearing
all of these sounds of gunshots going
off around me
do I have to respond to them all or can
I ignore some of them because they're so
far away and the way to decide on all of
these questions is whether something's
on or off camera so if it's off camera I
probably don't have to care but if it's
on camera I do have to care so the
question is how do you decide whether
something's on or off camera and for
that we'll have to come back to it
because I need to talk about collision
detection first so collision detection
is a code that figures out whether
someone object is hitting another object
and I did is kind of two-pronged
approach to this and first of all the
first approach is assuming that the
world is a great which might look like
this so in this game magic game would
just black squares then if two objects
are in the same grid square they're
colliding and if they're not in the same
grid square they're not colliding so
those two guys in the top-left different
grid squares not colliding whereas the
guys in the bottom right same grid
square so they're colliding but the
world's not a grid so we need an extra
approach and this is called bounding
boxes so in this slide the two key
objects are the large black circles and
each of them has got a bounding box
which is just a rectangle which fits as
closely as possible around the object
and if the two bounding boxes of those
two objects are intersecting then the
two objects are colliding and if they're
not intersecting the two objects are not
colliding so now I'm going to talk about
some of the specific approaches to
collision detection they use for
particular objects and starting off with
bullets so in this slide the black
rectangles the small black rectangles
are a single bullet at different points
in time so the grenade I'm sorry the
bullet starts off at a position a moves
through position B and in Suffolk
position C and when the bullets at
position aid and it's not collided with
anything whereas when its up position C
then it's colliding with that large
white rectangle so we can just use
bounding boxes here to figure out that
it's colliding at position C and we
would be done because when a bullet hits
something it's just removed from the
game but there's a bit of extra stuff
because actually it's when a bullet hits
something it's not just removed from the
game there's also a shower of sparks
that come out of the object it hit so we
need to find position B because that's
where the shower of sparks is going to
come from and so the thing about writing
a game is that you don't actually see
your objects move through every pixel on
their path from A to C so I see or
rather they've game engine seized the
bullet at position a and then it next
sees it a position C and it's passed
through positioned be but it we didn't
see it so you need to figure out where
position B is and the way you do this is
you draw a line between position a in
position C and then you take the four
lines that define the edges of the large
white rectangle and you say okay which
of those lines is the line a to c
intersecting with oh it's the left-hand
side so you know which two lines are
intersecting and then you can find
intersection point and you're done
grenades so grenades are a little bit
different because when they hit an
object they don't just disappear they
bounce so for this we'll need position B
but we already know how to do that but
we also need to find out the new
trajectory that the grenade is going to
go on after it hits the large white
rectangle so it's the same thing again
it started off at position a and it ends
up a position C we find position B to
figure out where to bounce it from and
then we just need to find that gray line
that's sort of pointing diagonally down
in that direction and the way you do
this is that you know which side it hits
so it's that left hand side and so you
just reflect the bullet vector sorry the
grenade vector in the side that it hits
so this is my side this is the vector I
reflect it like that and then i'm done
but there's an extra bit of complication
with grenades excuse me because grenades
have an area where
so when you draw that line a to see if
you've got a bullet you just draw it
from the single pixel at position a to
the single pixel at position C but with
the grenade you need to figure out where
to draw that line from so let's say we
pick the top left-hand corner of where
the grenade is so I draw a line from the
top left-hand corner of position a to
the top left-hand corner of position C
and that gives me line one but we're bit
 because line ones not actually
intersecting with a large white
rectangle okay no big deal we'll just
draw that line from the bottom
right-hand corner right so draw the line
from the bottom right-hand corner of
position a to the bottom right-hand
corner of position C gives us line to
that lines intersecting we're done but
what about this so the grenades
approaching from a different angle in
this scenario and we draw that same line
bottom line right-hand corner of
position a to bottom right hand corner
of position see that gives us line 10
know when it's totally not intersecting
again so need a bit of a rethink and so
you need to use a different strategy for
grenades and this is called sweeping
according to the internet so it's the
same scenario grenade start setup
position a ends up at position C which
is where we detect the collision and
then to find out where the grenade
actually entered the object and
therefore find out where position B is
where we need to bounce the grenade from
then you just take the grave when it's a
position C and move it back along its
trajectory to position d but we need to
keep going because there's still no
intersection with a side so then we keep
going we move the grenade from position
d back along to position e now we've got
the intersection now we've got
positioned be we know it about Soren aid
from we're done ace so with all this in
mind then we can now figure out whether
something's on or off camera and the
strategy is bounding boxes so all of the
objects in the game have a bounding box
and the view the camera is just a single
large band new box somewhere in the
world and so we can just say ok bin is
your bounding box intersecting with the
views bounding box if it
is then you're on camera if it's not
you're off camera but we run into a
performance problem here again because
this check of bounding box against
another bounding box to see whether
they're intersecting it's not slow but
it's not fast either so we need to make
it faster for moving objects does not
like you can do apart from just try and
write code efficiently but with unmoving
objects then it's quite easy because
they're bounding boxes don't change so
this means when you load the level then
all of the unmoving objects like bins or
park benches or the floor or the fences
at both ends of the level they're
bounding boxes are not going to change
throughout the entire game so when the
level loads you just say to each object
right totally generate a bounding box
and then store it so this means when you
do that check of the view bounding box
against an object bounding box it
doesn't have to generate its bounding
box it can just go and fetch it from
memory so that's a performance
improvement but you can actually take it
a bit further because the answer to
whether a particular unmoving object is
on or off camera doesn't change all the
time so if the camera hasn't moved the
answer is still the same so I let's
imagine some scenario where i say been a
you on camera and he fetches his
bounding box which he's got pre-stored
and then he compares it against the
bounding box of the camera and he comes
back the answer and says yes I'm on
camera and then I come back two seconds
later and the camera hasn't moved in
that time and so I say I've been I need
to ask you again are you on camera and
he says like dude you totally just asked
me that I've already stored the result
to your last request so I'm just going
to give the answer from that cash and
then you don't need to you only need to
clear the cache when the camera moves
which only happens when the pistol slap
moves which is relatively speaking not
that often so this means that you can
check with the objects run off camera
are extremely cheaply performance wise
and that was a big big win
so penultimate topic artificial
intelligence so this is the code that
runs the enemies and the technique I
used is called behavior trees and a
behavior tree is just a special type of
state machine except it's in a tree
structure obviously and so because it's
a state machine then that means the
objects that it controls have states so
one of the states that a enemy and
pistol star can be in is fighting and
another state can be in a shooting but
these states are slightly different from
each other because fighting is like it's
you're not actually the enemies when
they are in the fight state they're not
actually doing anything it's more like a
gateway to a set of states whether
actually achieve some useful function
whereas fighting oh sorry shooting is
actually doing something so when of
enemy is in the chute state it's
actually firing actual bullets with an
actual gun so in this diagram of a
totally generic behavior tree then
fighting would be the fork point so in
the middle layer and shooting would be
an example of a leaf node so the general
rule is if you're at a fork point you're
deciding what to do next whereas if
you're at a leaf node that you're
actually deciding to achieve something
and do some selection in the game like
shooting a bullet now there's two wait
there's two rules that govern movement
around the behavior tree and the first
one is can I do this so before moving to
a state then the code always asks am I
allowed to do this so it might say am I
allowed to fight and the code comes back
and says yet there's totally an enemy
there and he's got guns so you should
totally fight him or we're shooting can
I shoot yeah you've totally got bullets
you've got a gun do it and then the
other thing that governs movement around
the behavior tree is a strategy and this
is a method for choosing where you're
going to move next
in the tree so in this we're in the
fight state and we need a strategy for
choosing whether to try and shoot or try
and throw a grenade and the two
strategies that I used in pistol start
there are a bunch of others that you can
use a behavior trees but this was enough
for pistol the first strategy i use
was prioritization and in this then you
just start at the left and you run the
first sub branch that you can run so i'm
in the fight state and I say okay start
at left can I shoot the answer comes
back know so I say all right then can I
throw a grenade the answer comes back
yes so I moved to the throw grenade
state I throw a grenade and then I move
back up to the parent state so that's
prioritization so you choose the first
one that can run and then you go back to
the parent the other strategy is
sequential ization which is where you
run every sub branch that you can so you
might end up running all of the sub
branches or nun or some so I'm in the
fight state the strategy is sequential
ization um I say can I shoot and answer
comes back yes so I moved to the shoot
state I shoot and then I move straight
on to the throw grenades dating can I
and say can I throw a grenade the answer
comes back yeah you can totally throw a
grenade so I throw a grenade and then
move back to the fight state so with all
that in mind here is the only side with
any code on it it's JSON so it's not
even real code but it's pretty much all
of the code that all of the behavior
tree for pistol and we're going to
go through it so I'm on line one I'm in
the idle state the strategy is the idle
state is prioritized so this means i
need to find the first child that can
run and then run it but actually the
idle state only has one child and that's
line three fight so i say can I fight
and the code comes back and says yeah
there's totally an enemy day you can
fight so I moved to the fight state the
strategy again is prioritized so now
I've got three children to choose
so I check out the first one on line
five find cover so I say can I find
cover and the code comes back and says
yeah there's there's have been between
you and the enemy you can run and hide
behind that so I moved to the fine cover
state and the strategy of the fine cover
stay on line five is sequential ization
so this means i'm going to run all the
children that apply and then move back
up so i go to line seven and say can I
turn towards the player and the code
comes back and says yet you're turned
away from him so are you should totally
turn towards him so I moved to the turn
towards player state turn towards player
and then I move right on to line eight
and say can I stand and the code says
yeah you can stand because you're
crouched at the moment so I moved to the
stand state and then I stand up and then
I move the line nine and I say can I run
for cover which just comes back yes and
so I run for cover and then I really
moved to line 10 and I say can I shoot
and again you've got bullets you've got
guns you can totally shoot so I moved to
the shoot state and then I shoot and
then I go back up to the fine cover
state now I'm probably not in cover
still so the answer on line five can I
find cover will come back yes you can so
I'm going to keep on looping through
this fine cover state until i get to
cover and let's say I actually make it
there and I don't get killed on the way
then eventually i'll come back up to
line five and say can i find cover and
the answer comes back no you can't
because you're already in cover you're
already duck down behind that bin so now
i say okay back up to the fight state
line three and then i say i minused i'm
using the prioritized strategy so I
check out find cover again still can't
find cover because I'm still duck down
behind that bin and so I go to line 13
the throw grenades day and I say can I
throw a grenade and it said the code
comes back I says yeah you've got
grenades throw one so I throw one and
then back up to the fight state again
line three now it's going to be fine
cover can't do that because still in
cover throw grenade can't do that
anymore because you've just thrown one
and so then you move the line 14 can I
shoot a new shoot so that's basically
how the AI and pistols that works
there's a bit of extra stuff but it's
not that instructive
now why is this cool I think number one
with that behavior tree then you can
move around that JSON really really
easily so you can change the behavior of
the AI with minimal code changes so
obviously there's a bunch of code which
does inferences about where the bins are
and and whether you've got any bullets
and all of that stuff but that's all
nicely tucked away inside you know
modularized and it's it's it's it's kind
of not dependent on other bits of code
and second of all I think that you can
actually read that Jason and understand
it so I showed this Jason to my mom when
I was trying to talk about pistols on
what I've been working on in my spare
time and I think she totally got it I
think and so I think this means you can
collaborate on a I with non-programmers
and I think it's always good to be able
to do that so penultimate topic before i
talk about falling in love i want to wet
discovery when i wrote pistol was
the first game i've written and it was
the first major javascript project I'd
done and I'd never done any hadn't done
much a I work and hadn't done anything
to do with collision detection as far as
I can remember and I didn't really read
up that much in advance and probably if
it'd been something i was doing for work
i would have felt obliged to do that and
so I would have done but because it was
for fun then I kind of just want didn't
want to spoil a surprise and so I
figured out that grenade sweeping stuff
and um figured out you know why my
enemies were running around madly
shooting each other and didn't Google
March and didn't read any books in
advance just because that process of
discovering how to do something even
when you know someone else has already
solved this problem I think is like one
of the most joyous feelings in the whole
world and so that's why I didn't want to
spoil a surprise so I suppose up what
I'm saying is
read new books and don't learn anything
except by doing um and so the final
topic is falling in love and this is not
really about code that much so apologies
one evening maybe a few months ago I was
in my kitchen writing some code with
pistols up and I had this ticket to go
and see this band called wolf parade who
are really really good and and they were
playing down the road for me where i
live in berlin and i was really into the
cone i really wanted to stay in and
write it but then I sort of forced my
tore myself away and then dashed down
the road went to this gig and then after
that ended up going up with some friends
and and and and and and drinking quite a
lot and stuff and then i came home at
sort of seven or eight in the morning as
its kind of still drunk basically and
sat down and carried on picked up where
I left off with the code um and I'm in a
band as a sort of separate thing and so
when I write songs then more and more
often recently than I started to write
about my real life rather than about
more generic things and so I wrote a
song about the fact that I'd been
writing the code for pistol sight in my
kitchen and then run out to sea wolf
parade and then got drunk on gimlets
with my friends and and and gone some
clubs and stuff and um then when I
figured out grenade sweeping then I was
in a bar called for vigne a really nice
bar and fell in drinking Hemingway's so
whenever I think about the grenade
sweeping code I think about the taste of
Hemingway's which is a it's a really
nice cocktail by the way it's got great
fruit juice and some sort of red thing
and gin and so
I sort of felt like crystals that was
becoming in time as my life and then
some of the bits of graffiti in the
level it is level singular at the moment
in the level in pistol shot are from my
diary or things that I'd seen around
Berlin and then recently I found myself
at a party talkin about pistols that to
a stranger who was a non programmer and
he seemed to sort of find it interesting
I hope and so I suppose what I'm trying
to say is that pistol start become more
and more entwined with my life or more
like what more importantly programming
has been coming twined with my life and
I think falling in love like with a
person is so thrilling because they show
you these possibilities that you'd never
even realized existed so they show you
new ways of thinking about things or new
perspectives and so it sets off all of
these endorphins in your brain that are
just super exciting and so I felt like
the same thing happened with pistols lat
in the sense that it become entwined
with my life and and different parts of
my life had started to inform each other
because of it so you know the songs I
was writing and the code i was writing
and their friendships i was having in
the bars i was going to and and and the
graffiti i was saying all kind of became
entwined and so i suppose in summary
what i mean is that pistol made me
fall in love with programming thanks
any questions my name or pistol
name what the story of me uh okay um
basically it was a joke um I started
writing the code last summer and I was
thinking about the most ridiculous names
that I could have and I thought will
surely I've got to combine sex and
violence into a single phrase and then I
thought okay yeah pistol sup brilliant
and so then I when I was talking about
the fact i was writing this game to my
friends they said what's it going to be
called and I said as a joke pistol
and then I tried to change it later but
they were all like no no no no no that's
the best thing about it so it's stuck um
so you can play a pistol calm if
you want to anyone else how are you
choosing him Sylvester for your
javascript file sorry say that again I
was going through your code how was how
did you choose the name Sylvester for
your main javascript file oh she does
not mind that so made by a man called
James Coughlan who's an excellent
JavaScript developer it's a library for
doing mathematical calculations based on
vectors I don't know how he chose it so
you'd have to ask him but he blogs at
jeg coughlin com he's a super genius he
should totally check her eyes code did
you look at box TD for your uh your
physics framework yeah so um I found out
about box2d at the Berlin JavaScript
group quite recently and I was like god
dammit all of those nights crying into
my gimlets about you know the fact that
my grenades were still bouncing
into bins and not on them so I nearly
killed myself at that point but then I
thought it's a fine I'll just totally
integrate it so I spent a very difficult
week integrating box2d with the game but
found out that actually there were some
things that because I'd written them
specifically for my game were better in
my collision section code but this is
not to say that box2d sucks
it's awesome obviously but it solves a
much greater more general class of
problems and so I found that I wanted
specific behavior for different objects
and so I found I kept my code in the end
but box2d is totally great so if
anyone's writing a game used that not my
collision detection code because it
sucks anyone else nope okay thanks did
you remember the baby oh</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>