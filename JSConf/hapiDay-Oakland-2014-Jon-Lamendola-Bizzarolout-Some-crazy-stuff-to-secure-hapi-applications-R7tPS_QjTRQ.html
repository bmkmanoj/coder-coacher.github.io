<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>hapiDay Oakland 2014 | Jon Lamendola: Bizzarolout - Some crazy stuff to secure hapi applications | Coder Coacher - Coaching Coders</title><meta content="hapiDay Oakland 2014 | Jon Lamendola: Bizzarolout - Some crazy stuff to secure hapi applications - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>hapiDay Oakland 2014 | Jon Lamendola: Bizzarolout - Some crazy stuff to secure hapi applications</b></h2><h5 class="post__date">2015-01-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/R7tPS_QjTRQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is my first conference talk so I
apologize it's horrible fair with me
what I'm talking about is cool so I am
John Lennon dilla and you can find me on
github under the same name as well as on
Twitter will be talking about bizarre
all out which is the beginnings of a
tool for happy to do some static
analysis as well as dynamic analysis to
help make secure apps so I first want to
look at why we lack good security tools
in node as it is right now one of the
main reasons is that a javascript is
pretty free you can do a whole lot of
different things with it you can use
just about any programming paradigm that
you want which means that it's hard to
make a static pattern you can look
through in an application and find out
okay well this this particular method is
bad it's a it's an insecure default kind
of thing right so happy happens to help
that problem a little bit by creating
some more structure which you can see we
can do this in rails because the rails
has clearly defined patterns and secure
defaults it's a lot more structured than
most note frameworks are that's why you
can do things like break man which
everybody loves really simple to use and
it works because there's good defaults
everything's unified you're using a one
consistent library to do your
connections to databases and things like
that or is in the the more not nodular
modular space of note you're going to be
using possibly any kind of database
connection right and no it doesn't
really have the secure defaults and
clearly defined patterns instead you got
to handle them yourselves the trade-off
for the freedom is similar to the
problem that you're going to find it any
complex parser if you want the parser to
handle the input well you have to define
clear structures and fail when the
structures are corrupted when there's no
structure there's no parsing if you try
and put a piece of random binary data in
to your PDF reader it's going to crash
we have a great tool for overcoming this
though and happy validating all data
structures is the norm rather than an
outlier it's it's what people do the
more common thing you'll see in a happy
application is validators for everything
which is awesome structure and happy is
not optional it's consistent it's
validated it doesn't let you do a lot of
crazy things that other frameworks let
you do which I really a security person
I think that's great and it allows me to
parse the routing table it allows me to
parse various configuration options
within the application and actually
verify that some of those things are
secure so laut is already utilized this
and as we saw in previous talks things
like happy swagger have utilized this to
make auto documentation tools so you can
see documentation for your routes well I
was working on something similar a
couple months ago and thought you know
what I wonder if I could use this to
actually test the application and fuzz
it without having to give it a whole lot
of manual context and this brings us
back to the beginning the security
animation is difficult because there's
so little consistent structuring node
but happy solves that problem so break
man is two rails as a bizarre lout is
the happy that's kind of what I'm trying
to build for the happy space it's a work
in progress I've begun work on it I had
something that has worked but it's a
very very complex problem and I'll just
say that converting from happy 72 happy
eight completely broke everything
because when you're dealing with like
parsing complex internal routing tables
it's it's a lot more complex of a change
right so I've got laut as a foundation
for the beginnings of the the parsing of
the routing table with some things added
on there so I can I can warn about some
basic stuff
but there's also parts of your
application like your route handlers
themselves that are still not going to
be using a necessarily a set pattern
like you can use promises or you can use
callbacks you can use any kind of
database you want or connection library
that you want right so that kind of
stuff is difficult to parse once again
so what I've done is to use that routing
table information to pull out your
parameters that you're going to be
expecting in the API get types for them
like string number whatever find out
what you're looking for in the API
endpoint and actually inject a very
complicated set of fuzzing algorithms
that I don't have time to explain but
yeah it's pretty cool stuff I'm excited
mostly about that part so given the lack
of the developer friendly API and most
security tools they're kind of a pain to
work with even if you do security
they're terrible I'm sure your thing in
what constitutes these secure defaults
that you're talking about is bizarre all
out really effective and most
importantly how much time and effort is
this going to cost me to actually use so
secure defaults this is what I have
right now these components were working
at some point now they're kind of
disconnected and I've got to link them
back together so unfortunately won't be
able to have a demo but are there an
authenticated routes this first one
really simple you just check the route
handler see if there's there's a no
offset all the routes have CSRF
protection on are the input fields
validated or rejected do you allow
unvalidated input fields do you have
empty validate handlers in your routes
and as their sensitive data being
compared in securely I can check that
with some simple static analysis stuff
as well so is bizarre a lot effective
well within the first 10 seconds of
turning it on I found a denial of
service issue with a
process next stick in a pretty popular
module and last night there is this so i
have a repeatable segments in v8 core so
that was that was a fun 2 a.m. adventure
here's the bad news though it's not
finished yet it's far from ready for
production use I'm working on it but I
have a day job as well so I don't have a
vast amount of time to put into this but
I am working on it as one of my primary
projects right now so it's it's
currently more of a proof of concept you
can use it if you're interested in that
to fuzz the internals of node and v8 but
it's not going to be terribly
informative for actually figuring out
the security of your application right
now but what I want to be able to do
with this is basically to have a tool
that developers can integrate into their
testing phase and just run a simple test
it doesn't have to be crazy complicated
it doesn't have to be this huge
intimidating thing you should be able to
just put something into your tests and
know whether or not you've got routes
that you forgot to put not handling
that's not a crazy difficult thing right
so I want to be able to do that and as
well as as testing for some of those
more configuration side of things I want
to make it easy for developers to battle
hardened their applications to actually
go and put more malicious path test
cases in there because i'm sure most
people that write a good solid
application will write good test cases
for it but most of those test cases are
pretty binary does this route work when
i put good stuff into it yeah okay does
it fail when I don't put stuff into it
yeah okay it fails but there's not a
whole lot further than that it's not
going to be repeatedly injecting okay is
my parser that I wrote like going to
fail so that's that's kind of
map it's where I'm wanting to head if
you're interested in using it go ahead
and start a project follow me on Twitter
or follow of security and just yeah
we'll let you know when it's ready or
make a pull request file an issue but
yeah</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>