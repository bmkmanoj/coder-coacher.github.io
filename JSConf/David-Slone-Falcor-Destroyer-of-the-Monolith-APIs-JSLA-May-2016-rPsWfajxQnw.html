<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>David Slone: Falcor, Destroyer of the Monolith APIs | JS.LA May 2016 | Coder Coacher - Coaching Coders</title><meta content="David Slone: Falcor, Destroyer of the Monolith APIs | JS.LA May 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>David Slone: Falcor, Destroyer of the Monolith APIs | JS.LA May 2016</b></h2><h5 class="post__date">2016-06-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rPsWfajxQnw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I guess so first off like how many of
you guys have heard about Falcor okay
decent number of you I know some of you
work with me so you've already heard a
lot of what I'm about to say anyway but
yeah so Falkor is actually it's a it's a
new framework this out from netflix it's
designed around a new concept is called
Jason graph which we'll get into in a
moment and it's all it's meant to be a
way to simplify the data that's actually
being sent to your client so whether
that be a mobile phone a tablet a
desktop only requesting the data that
you need is the key component to what
Falkor is really about and being able to
request multiple attributes from
multiple microservices at the same time
so no more like being able to just go to
one endpoint way and do everything
synchronously now through JavaScript
promises you can actually deploy and go
out to multiple microservices at the
same time wait for those payloads to
come back and be able to deliver only
the information that you need to deliver
to your front-end code so just real
quick a little bit about me you can find
me pretty much everywhere on the
internet at DB Sloan and I'm also an
engineer at Laurel and wolf but kind of
going on from there first we got to have
a little bit of a history lesson if
we're going to talk about data we're
going to talk about the way that data is
delivered on the web we've got to go
back a little bit and we got to go talk
about soap api's how many people
remember this it was terrible we hated
it let me look at this like there's so
much code just so much excess about the
way that we need to deliver data like
nobody wants to do this it had a there
are people that will give its valid
reasons and it had a small use case I
hated it so then we moved on we got
Jason API that was like this whole new
revolutionary world about how we can
actually start doing related resources
in relationships and like you can see
from the from this example here like
from set up like everything is
simplified a whole lot now and it's
great you can do I mean you can do
things like sports field sets and a lot
of things that Jason API allows you to
do but you're still going to one single
server to get all the data
and so over time just through watching
some of the videos from the team over at
netflix and talking about Falcor they
started really looking at this paradigm
and really just going okay how can we
make this better like we're delivering
so much extra data that we don't need to
deliver and what if we only if I wanted
to know about a an article and I only
want it like and of course I paired this
one down like I wanted I just wanted a
title like it's pretty you know there's
still so much excess data that you end
up getting because of related resources
in the way that Jason API works so now
let's talk about the future so we move
into Jason graph and the thing that
makes Jason graphs so valuable is the
fact that you can share and I will not
share so you can reference different
objects throughout the graph that's
being delivered back so for example here
with this like if we look at the bottom
here here am I to do's and I see here
that this is a type of reference that
has a value and it says to dues by ID
and it gives us an integer value here of
44 and the same thing is repeated below
as we're looking at an integer value of
54 so now we look back up to our graph
here and we see you to do is by ID and
now we see the actual object graph is
being stored and it's just JavaScript
objects down like that's what we're
talking about with Falkor is just
JavaScript objects we're simplifying
everything we're taking out needing to
go you know relationships and resource
ID and drilling down through the graph
like so drastically now everything is
just passed through x references and so
each time that I want to so imagine for
example like with my two dues here
imagine there was a another field that
was called created act and I needed to
know when the window to do was created
at I can easily make a request that will
only bring back the creative that
it will just append it into this object
here making it very simple so this is
just a quick overview there's a lot of
things that are kind of going on in here
but as we start looking at the way that
the requests and the responses are made
from Falkor it actually becomes much
simpler and you start really getting to
see the power of this and so this is
kind of the client side of things where
we're going to actually build a cash
will Falkor and so you know like it's
just very simple you know we say Falkor
top model and then we give it an object
structure here and the first thing that
we can give it is a data source the data
source actually isn't required we can
actually do Falkor completely just on
the cash and the and using setters and
getters inside of our code and never
touch an external server but in this
particular instance we are going to
define a cache and our cash here we can
see that we have our users and sorry
this doesn't relate to this previous
slide I didn't have time to make all the
data marry up and everything this was
just a quicker code example for me to
put together but so you know we see in
our cash we have our users we have a
user ID of one and we see this new
syntax here that's kind of interesting
is dollar sign rut well what is dollar
sign ref if we go back and we look at
this slide essentially dollar sign ref
is just a foul coarse sugar syntax that
actually just lets us do type ref here
and Jason graph is designed in a way
that when it sees an object and it sees
a type whether it be reference or Adam
or error it knows what to do and sorry
I'm throwing a lot of things out there
very fast this is a massive framework
Netflix has made tons of great
documentation go read it go watch the
videos the videos are fantastic like
there's so much more information you can
gain from this I just really want to
give you guys a high-level overview so
that you can see and understand what
this framework is capable of because you
know so many times when it comes to new
frameworks we don't fully like we're not
fully enticed to be one
go down that route just because well we
have this massive application it's going
to take so much extra engineering effort
to be able to do this well if we can
simplify the way that we evolve the
future of being able to write our code
and receiving the data then you know you
really start to see the power of this so
going back to the next slide here so now
we're looking at so this is just our
cash this is the way that Falkor will
locally store all of our data and so you
know it's it's just very simple
JavaScript objects and that's the beauty
of this is it's just dot notation to be
able to go and find anything that you
want to find so here i can see that i
have a user of zero who has a name and i
have a user of one who has a name now
imagine if i wanted to inside of this
users by ID here and and will do maybe
some examples a little bit later of this
but I could also have a attribute in
here called of friends that's an array
and that array would actually have a
reference to user 1 so now I didn't have
to go request user one because user one
is already in my cash and I know that
because I'm just following reference
links and what Falco would do is when
it's see like imagine now that there's
this imaginary friends list here and I
say user 55 well user 55 isn't in my
cash so it's going to go to my data
source and it's going to go and build a
query that goes out to my server and
it's going to say for user 55 give me
the name because that's all that I
requested so now the other piece of this
that it's really worth understanding is
the router inside a foul core because
this is where we start now dividing and
conquering and that's kind of where the
whole reason of the name from this is
destroy your model if api's is you know
we can have multiple microservices so I
can have one that's going to like so
deliver me users one that's going to
deliver me friends one that's going to
deliver me recommendations like there's
so
different ways in all of the different
companies that I'm sure we're all at
that we can start devaluing are our
object graphs that come back and being
able to really utilize smaller servers
that are more maintainable code so that
we can start really returning massive
object graphs back to the client and so
kind of taking a look here at this we
can see the first thing that is inside
of the Falkor router is we have a route
and we see projects and then the syntax
starts getting really weird and we
probably we don't see this in JavaScript
dot notation and the way that Jason
graph treats dot notation is it also
kind of treats it like a string so that
it can do interpolation and understand
what you're wanting so here we see that
in the middle like we see integers colon
indices well what does that mean well
what that means is i can write a request
that says give me projects 5 through 50
and i only want the titles of those
projects so it's you know instead of
having to write like queries and you
know i mean to do that in json api it's
a single resource so i would have to
make 50 request to get just the title
from 50 records well now I make one
request to get the title for 50 records
and so you know this is kind of some
some code that I pared down from what we
were using before but we see here with
this you know promise also i'm able to
do simultaneous requests to projects to
be able to retrieve that so our back end
is actually consisted of json api so
this example is kind of working
concurrently with json api as well to be
able to return the data that we want but
it just it makes it really simple to
just go to go grab all the data process
it and bring it back and so the next
thing in here that's really worth noting
about this is so we look at the return
value here that's coming back so now we
see another piece of new syntax that we
haven't seen before which is dollar sign
value
and essentially what dollar sign value
is doing is it's going to bring back
this user here and so we define so the
same way that our routes up here define
a project with an ID and the attribute
that I want to bring back down here I
redefine that route and now I'm actually
doing it in an array so i'm going to say
i want so this the data that's coming
back from Falkor is a project with a
project ID that also has a floor plan
and so then now we move on a little bit
further down the line and we see another
new piece of sugar like syntax sugar and
that is dollar sign Adam well dollar
sign Adam is it's another way of kind of
the same way that we see the ref here
the atom will be type Adam and what that
means is the Falkor model will say this
is a literal object that I'm going to
store whether that be a string whether
it be an array although you're not
supposed to store raised with Falkor
there's you know that's kind of the
whole point of our routes and just being
able to request only the information
that we need but we all know sometimes
you gotta break spec just to be able to
do what you need to do and you know in
this particular example like I'm
returning an array and you know just
kind of finishing out the the promise
here actually that code is kind of weird
oh that's for my promise all sorry i was
just looking back at my coat so that's
kind of the basics of the foul core
router and the model itself so let's
actually take a look at that and I
oh I forgot to open this up sorry about
that
so this is actually a github repo that I
created as well and I can share the link
with anybody that wants to take a look
at it and so it's actually it's using
happy as the node engine and then Falkor
is all implemented and there's a little
bit of testing still kind of working on
I'm getting this to to where I want it
to be but so let's see ya so here is
kind of the the routes actually that's
kind of small let me make that bigger so
you know the same the same idea applies
here like we see our users and we can
define our integers here and so the way
that that request looks is order here so
i say user dot get value and get value
as a way of saying that i'm only
requesting for one resource and I say
users the ID of the user and then the
attribute that I'm requesting well but
what if I also wanted to request
multiple users well the syntax only
changes slightly in the fact that I can
just say from 0 to 1 or I can even come
in here and i'll write this above here
so you can see an example of it i will
say user duck
so now I was able to do the same thing
that I did here but I was actually able
to use the JavaScript object and just
say from this index to this index and
both of these are equal and so I mean
that's that's kind of the basic overview
of this and the power that Falkor house
this is a lot of information I skimmed
through a lot of things just because
there's not a whole lot of time to be
able to really go in depth and I'm still
learning it as well as I'm going through
this and yeah so kind of going back and
looking at the client requests here you
know this is my data source so it's
using just a library from HTTP data
source and I can give it a URL of a
server you know anywhere in the world or
local host you know I can even take out
my source and I could say you know user
dot is it I forget the syntax for it
right now I won't do that example so we
go I mean that's kind of a very quick
overview of just that the power that
Falkor can actually provide to you as a
developer and also to to your users in
your client side code and you know
recently like I've been you know
starting to talk more and more about
this framework to people that are in a
non technical background as well and and
one of the things that I've really found
in being able to shorten down a way to
make it explainable to them is that
Falkor will provide a faster response
time for your users by limiting the
amount of data that you have to transfer
over the wire and it actually will speed
up your your development process you
and it works well with inside of Redux
or Redux react it also works with
angular the libraries it's just a
JavaScript SDK so you can use it with
inside of anything that you're working
with currently yeah and so that's it
yeah I'm not sure we'll just go to the
line here so you mentioned like getting
you know users 0 through on and dot name
how does that look if your back end
stores like my sequel or like a view how
do you translate that request into a
sequel query um yeah so I mean the way
like so if you were going from my sequel
and bringing this into Falkor you would
still have kind of an intermediary
server or you know something set up in
or you would you know even have post
grass or my sequel connector built into
your Falkor application so also threw it
through node there's adapters to connect
to my sequel and and post grads and
Redis and different things so I believe
there's actually I for certain databases
there overlays because of my clothes
dress for Valcourt and graph ql so you
can get the table schema and like some
representation you can start doing
user-defined queries
cool yeah thanks yep that's was
wondering mongo DB query language has
kind of the same function you know I
haven't used Mongo so I'm not as
familiar with it you can specify the
search and what fields you want back and
you can do a lot of things that you can
do here oh cool yeah but this is like
this is different right this is for like
the API you don't want to necessarily
change the entire way that your data is
laid out on your date with your entire
database management system because you
want to have your yeah I mean and
there's a lot of advantages between the
caching and the fetching that happen
with Falkor as well so you know as I'm
always retrieving things and then even
so like imagine like so I'm primarily
familiar with a react application right
now and so as I have multiple components
that are all needing data to be filled
Falkor will actually batch as well so
you know I'll periodically be making a
request and I'll grab you know the first
half of what i need and then the other
components will make it into the second
batch and it will go out and it will
bring back what you need and I know
that's kind of I mean a little bit off
from what you were talking about with
MongoDB I mean there's definitely
something i'll look into and just being
able to understand like what some of the
key differences are between this and
what manga is doing yeah so that's
that's kind of the other piece of like
if I've noticed that Falkor has started
like they've thought about this and and
my interpretation this is probably not
as good as Jafar's but you know I'm
trying to do my best with it but
essentially the way that it works
because of the way that things are being
referenced to each other so if we go
back to this so and I lost it
I think it might come back now but
anyway so essentially what happens is
through those references as I do a set
value it will update my local cache and
then in the background it will do a
dispatch out to the server to actually
be able to update the database store
there as well so everything stays in
sync Falkor just kind of manages a lot
more of that like kind of behind the
scenes like you're using HP caching it's
like very obvious when do we come on
exactly oh well okay so they can do some
like oh yeah although you want to do it
like I think the insurance I read about
it on a global stuff like okay here's
this specific like here's my main
application API here's how it anal thing
okay I couldn't remember reading
anything about resource level fashion
but I get the feeling my place yeah and
in Falkor like so as we were seeing on
the router I can actually say that if
you made a request that I want you to
invalidate other different things that
are being stored locally in the cash as
well so from the server I can dictate
locally on the client what's actually
invalidated yeah so from one of your
first examples obviously if you want to
get a list of all the articles available
you don't and the API gives you the
article the title the article and the
entire content of the article that would
be incredibly inefficient would be a
giant terrible amount of data that
you're getting just gonna list of titles
seems like this is kind of doing the
opposite where you're only getting the
stuff that you want however it worries
me and may have misunderstood how it
works but it seems like when you have a
bunch of things as microservices now if
I want to get title and the author and
the content I have to do three separate
requests for
the author and the title and the content
so that would suck yeah so look there's
uh there you can through the routing you
can group what comes from each
microservice so so yeah so i can say
like um where the remote go oh no that
one's the clicker is this the one for
the projector is it did it go back off
or okay um well sorry yeah so the way
that it works so we would like where we
saw like the the route for the floor
plans I can actually instead of just
saying floor plans there I can turn that
into an array and I can say that it's
anything that I pass into it and it's a
catch-all and then the floor plans is
only the one that gets called if I
specify floor plan so my graph request
itself I could say project one that and
give me name give me the user give me
the floor plans give me the photos floor
plans and photos could come from a
separate service while all the other
project information would actually come
from one single life you know in our
particular case thing it would be like a
JSON API response that comes back and
delivers me all the information about
the project does that help clarify the
like your thoughts are I I just don't
want to be do it it's a bunch of
microservices I don't want to be sending
a bunch of different requests I didn't
really honestly I didn't really
understand
returning various bits that any you need
you may have microservice too far for
you may well sounds like you might want
have a unifying layer in front of them
on the server side that does not
fetching 30 armed services so your
clients I could hang the one ancient
gear class call me look at the thing is
that this doesn't really wrong with
multiple requests like Browns pretty
good well it's about somebody you know
it's not going to certain point well I
mean you'll hit a big performance it
right if you're doing a bunch of HTTP
requests just for like a couple bits of
data like for the title and the author
gives you two separate HTTP requests for
like you know a couple characters and
that's okay given far i think i would
like to his example look like a sequel
select you list the columns i thought
you could you specify more than one
column more than one yeah you can
specify multiple columns that come from
one sir it's sort of decomposing it to
me it seems like the opposing into flat
relations and you can choose the columns
you want from a given relation so it
seems like you're doing one query /
relation right I just want to know that
what I just want to make sure that on
the how it works it's just sending one
request and instead of if you have it as
multiple services radios so like these
things at the same time and get the
upper back all the data at the same time
so that we're not doing most for HTTP
requests for work that's data
so the trick if you have these servers
in close proximity there's actually a
fairly low cost to doing aren't actually
restricted by some browser restrictions
for multiple is right that's like behind
my feet I mean you get into a situation
where we start preparing a public
database queries work yeah they are
technically an ax plus 1 degrees but you
know they're serving servers that are
that are next to each other in the three
categories and live in parallel right so
there's some you know some wasted server
time but let's in terms of the user time
it's much less you're also banking on
the fact that they're all the same sort
of data structure though because I'm
like I'm going to a bicycle Monica
Sandra database of am I supposed
probably spent the longest with your
complex query right so it's a gift away
converge so yeah no yeah but we probably
have not like five more minutes okay all
right I'm in this example you are
awaiting for everything in your path or
request
yeah actually fell court house web
socket adapter okay you can connect over
open connection and you start receiving
that dated back as it's available in
that case you'd start getting so if you
guys have any more like details for that
particular discussion guys always
welcome to join the select channel and
then your best can connect it's awesome
places everyone's here any other
questions for it yeah so validation any
question I had so I know with all these
graph Jason api's you can specify like
what types you're bringing you know that
when reflecting back out but what does
it do when I provide safe ever like
required fields on the face of a PR like
the jason crabb or be right too many or
by too few does it how does that handle
that the situations like is there like a
JSON schema validator so I guess as far
as the validation we're talking about
between Falkor and the micro service or
between the client and Falkor it's
really Falkor in the micro service so in
the promise like from making the request
out to the micro service you then
structure your data like you know you do
whatever manipulation you need to do
before you do the return and then so
like you can weed out anything that may
come back that you don't need and then
you only send back and Falkor even yell
at you too if you like try to send back
more fields then was actually requested
from from the client requests yeah cool
thank you
Thanks you've you've all done javascript
I assume you've seen the new JavaScript
I've been doing JavaScript for probably
about seven years now you know I've seen
the number of reserved keywords kind of
go up and down not all of these are
currently reserved keywords in
JavaScript but a lot of them are some of
them are historical there are a lot of
these aren't there they're a lot or
they're like too many does</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>