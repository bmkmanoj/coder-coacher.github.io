<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Aaron Heckmann: Code is Cool Products are Better | Coder Coacher - Coaching Coders</title><meta content="Aaron Heckmann: Code is Cool Products are Better - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Aaron Heckmann: Code is Cool Products are Better</b></h2><h5 class="post__date">2013-01-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QRc41TyT9Fw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright so I'm going to talk about why
code is cool but products are better I'm
Erin Heckman i work at learn boost we're
building the next generation education
platform on the web and if you're
familiar with learn boost it's probably
because of our github presence for real
believers in open source and and
javascript in general but i'm not going
to talk about any of our open source
stuff today pretty much i want to just
share some things are doing internally
that that are pretty cool in my opinion
so why do i say products are better than
code we're at this tech conference what
we're really like you know in deep to
like these greatest techniques and how
to do things really awesome is software
craftsman but i think it's important to
remember who that end user is and it may
be some of our cases they are developers
but in learn boost case it's it's a
typical you know user who knows how to
use a computer or a mobile device and
they're not they don't really care too
much about that i mean we could we could
spend a lot of time building a mountain
of amazing super efficient coolest you
know techniques software but our users
don't really care so much about how it's
made they just want to know that it
works and in this example of a ugly
antenna spitting out numbers these users
probably just care about something like
a wall of boom boxes blasting fresh cuts
so they can have an awesome break
dancing party I mean the product is the
boom box in this case and you know they
just they just want their life to be
improved in some way shape or form so at
learn posts were we're four and a half
developers were pretty small and
building our infrastructure on top of
node J s means we've had to write a lot
of things ourselves and so we kind of
need to be careful about where we're
spending our time because we really want
to stay focused on the product but yet
work on the projects that we're really
interested in and or that just need to
be done because there's you know no
module to do whatever it is we're trying
to do so we want to be more like neo and
we want to fly at a million miles an
hour but how do we do that in in general
and I'm going to cover a few ways that
we do that and it primarily the way we
save time is by not writing any code
yeah so the first way we don't write
code at learn boost is by not writing
any Ajax and I'm not saying we don't use
Ajax because we use it everywhere like
an every page a lot but for ninety-nine
percent of our use cases we don't write
it anymore it's all just abstracted out
so we can save time and I mean I
personally believe that if you're
writing Ajax today you're probably doing
it wrong because you don't really have
to and I'm going to kind of go into some
detail we use something we'd like to
call data dynamic to to take care of
this for us and it's really just a fancy
name for a lot of jQuery event
delegation and part two is a managed
JSON response from the server so as far
as event delegation goes will take like
a traditional form and we throw this
data dynamic attribute on it and so our
event delegator picks up on that and
it's smart enough to just serialize the
form and send it back to the server
that's pretty standard but it's also
smart enough to know if the jQuery
validator fails you know how to display
those messages and and not submit
anything so that's nothing really
mind-blowing or whatever but it doesn't
have to be a form it can be any element
on our page that we feel like putting
this on and we just point that attribute
at a route that we want to hit and so in
this case our anything route is just
going to go or anything element when you
click on it it's going to hit that wagon
route and you're not limited to a get
request which
this this use case would be but you can
change that you can put a method
actually beat on any element and you
know change it to a post and then we'll
have our cross site request forgery
protection like in place and all that
another really common use case for us
our dialogues we've used a ton of
dialogues and so we can just throw a
data pop up remote on there and that is
what it sounds like we want to grab the
content for the dialogue from a remote
location so you know this would delegate
off to the Oregon Trail route and then
populated a dialogue with the response
and similarly we do a lot of tooltips so
tooltips work the same way just throw
this at should be down there forget
about it so we're not writing anything
client-side anymore it's all delegated
as far as setting up the requests go so
the second part of that is that response
which we don't want to write either
because we're really lazy in a good way
and so this this kind of just shows
several the options that we have we're
using Express so here with Express you
can throw a buffer or an object or raise
or whatever down into response that sent
and it will see realize them for you
into JSON and send that string down with
a client but like these are the common
use cases we have and so once we're on
the server and we do what we need to do
we can tell the client whatever it is
that we feel like telling the client to
do so we can replace elements we can
omit events on either our global learn
boost object or trigger events
specifically on whatever elements we
want to impasse in whatever args we want
to pop up as the same thing as that data
pop up remote that I was talking about
so we don't need to you know ever get
dirty with that redirects success
validation failures it's all done right
here we can control at all from the
server so we never have to write any
client site Ajax stuff anymore it's just
all delegated to this thing so the
second way we don't write code at learn
boost is through our use of Express and
Mongoose like I mentioned before Express
is our web framework that we're using by
TJ Holloway check and Mongoose is what
we use as our RM to talk to MongoDB our
primary data store so we're going to
look at a little demo of how we use
these together and so can you see that
so we have a this is a typical use case
for us we have some route we have a
couple queries we want to run if any of
the queries return an error we want to
make sure that we're only passing that
error into next once I don't know how
many of you are familiar with express
but next will pass the the route the
control on to the next route and if
there isn't another match for that URL
hell just like 404 so anyway we only
want to call next once just because
otherwise it can cause problems so we're
going to check for errors and then if
both queries return successfully that we
want to render those results and it
seems pretty straightforward and it is
but it's a lot of boilerplate in my
opinion so you know we can see this in
action I think if I'm running which I'm
not so so they're just running we see
that our latest news in there the things
we like that's pretty boring but like
it's a lot of boilerplate and we don't
need to write any of that anymore so
what we really want to just write is
render and so this is pretty much
representative of what we do we just
return the result of that query in this
case it's get latest news and get this
user's likes just pass them straight
into the render call and Express we have
an express Mongoose plugin that's smart
enough to to detect when queries or
promises are passed in and resolve them
appropriately and if any of those return
an error of it will likewise pass that
air on to next one time so it's still
handled gracefully and we don't lose any
functionality there so here's a readout
the bacon route same result but hey it's
with a lot less code so that makes me
happy this Express Mongoose plugin is
actually something we open sourced this
morning even though you see the little
lock on there that means it's not open
source but it really is I can't refresh
the page because I'm not online yeah so
if you're using Express and Mongoose you
might want to check that out
and it's also on NPM the excellent NPM
so here's another little trick that we
use that it's it's actually quite simple
that that TJ kind of stumbled upon but
it's it's extremely helpful I really
didn't think it would be all that
helpful at first but if it's if it's
proven actually pretty nice so it's it's
instrumenting your code so note has this
required out extensions object so you
can like I think it's kind of how
coffeescript works but it lets you jump
in in between that require module call
and then do whatever you want with your
code and then respond or excuse me you
return that string that will get turned
into what node cares about so what we do
is we just kind of override you actually
let me show you an example it might be
easier to see what I'm getting at so
here's we've got a couple lines here
we've got a comment about debug line and
then we've got a start and an end and so
what we do is we process the JavaScript
files when we require them and like
parse those in tournament to console dot
error or console that time and time end
so we can do profiling and all that you
might be wondering why we do it this way
instead of just putting console that
error straight into the code and that's
because in production we don't turn
profiling or debugging on and then
there's no impact of performance so as
the debugging you know development tool
this is pretty nifty and it's pretty
helpful because when we're doing a lot
of a sync stuff your call stack gets
blown away and it can be helpful to see
like where you were in the stack by
leaving breadcrumbs or like you know a
little trail mm's behind you it's sort
of a lame hack or whatever
but it really works well and it's it's
you don't it doesn't impact anything
it's just kind of there if we need it to
be and it's also nice to see the output
of our the council time if we really
need to find out what queries pissing me
off or whatever it's very helpful and if
you're really having a bad day or
somebody's really bothering you at work
you can just like sneak this into the
code base and then everything blows up
and people get really mad yeah really
helpful error message when you do that
don't do that so let's instrumentation
uh and then I'm going to move on to
something that's kind of near and dear
to my heart and it happens a lot and
it's it's a simple mistake it's easy to
prevent but it can cause like terrible
things that happen in your application
as we've seen from experience just
global variable leaks you know you're
missing a var statement somewhere and
suddenly you know what you think is one
value turns into something else
especially when it comes to the modules
that you're requiring and so they like
prevent that there's a couple things we
can do and that's in my opinion
supporting like a using comma first but
I mean that's not it's just one little
thing what's more helpful for us is this
thing I ripped off from node in their
tests a few months back was this global
leak test so basically there's this
array of all the Global's that are known
to node and if something shows up there
that we don't know about we want to
print on our on our console as we're
developing so all this does is just go
through the Global's that we know about
if it finds anything it's not supposed
to be there we're going to return that
in an array and then what we do then is
we just require HTTP and then override
proxy to send method off of that right
here which runs the normal method as it
were before however we report all leaks
that show up afterward so here's what we
just were looking at a minute ago Lisa
find iterate that array if there is
something in that array that we didn't
know about already then we want a mark
we want to we want to record that we've
seen it and output it to the console and
so to give you an example what that
looks like we run it at startup and then
after every route runs so in this case
there's six unknown Global's that really
shouldn't be there and those were
actually all caused by node MongoDB
native which we already patched but in
this isn't perfect right it doesn't say
hey in this module you messed up and
it's not jslint and a lot of other
things but it's really it stands it's
out of your way it runs after every
route runs and it gives you immediate
feedback like hey you know somewhere in
this route we've got something going
wrong and you're kind of playing with
fire something shows up here yeah
because again in our experience we had
for example a module called errors which
we required at the top and we used VAR
errors equals require errors and then in
a route somewhere we've missed a
trailing comma and the you know the
variable was errors so it over wrote our
module and then we were it led to all
sorts of impossible to track down bugs
in production and like we wanted to rip
our hair out so these techniques have
really helped us out help us avoid those
situations in the future and that's
about all I have to talk about today
code is cool products are better thank
you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>