<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[JSConfEU 2010] Nicole Sullivan: CSS Lint for Massive Sites | Coder Coacher - Coaching Coders</title><meta content="[JSConfEU 2010] Nicole Sullivan: CSS Lint for Massive Sites - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[JSConfEU 2010] Nicole Sullivan: CSS Lint for Massive Sites</b></h2><h5 class="post__date">2013-06-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fampLn_i7Co" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi thanks for having me and thank you
for tolerating me talking about CSS at
javascript conferences it really is my
favorite thing to do to come and talk
about this stuff to you guys because I
feel like I found my people so thank you
for your patience with that today I'm
going to talk about CSS Lin for massive
websites so I my name is Nicole Sullivan
and I tweet at stubborn Ella here it's
probably the best way to reach me it
turns out I reply much more quickly to
140 characters than gigantic emails so I
work for generally bigger companies when
they realize that their CSS has gone
completely mad and completely out of
control so right now I'm consulting with
Salesforce and box.net in a few other
places basically trying to pair their
CSS down to something more reasonable
and I asked this last year and I'll do
it again how many people have found that
they were building something and the
most painful part of it was writing the
CSS as opposed to the JavaScript yeah
that can happen definitely especially if
you're more comfortable coming from the
programming angle the CSS can seem
really unintuitive but I think we can
make that better so a little bit about
CSS much like JavaScript it will let you
do absolutely anything no matter how
stupid it is no matter how about an idea
it is so you can get very excited likely
full and yet you can be completely
breaking everything the point of it is
that we don't have to do stupid things
just because we can we can resist we can
decide that we're not going to do the
thing that's going to end up with really
bad results so what is object-oriented
CSS it's sort of a nutty idea that we
can build CSS with engineering best
practices in mind no it's not like 12
correlation it's not like you can just
apply something from programming to a
declarative language and think it's just
going to automatically work there's a
thought process involved but over CSS is
about sort of saying we can do better we
can take a look at engineering best
practices and figure out how that's
going to make our CSS development better
and we absolutely can it is definitely
possible to make your CSS development
more logical more reasonable but I'll
warn you their language doesn't give you
any help with that at all there are
basically no constructs built into the
language which will which will help you
make anything object-oriented or even
remotely good programming really so the
only thing that really will make that
happen is developer discipline basically
deciding what your team CSS is going to
look like and sticking to it so why
bother optimizing CSS story on stepanov
and I have done some research and I'm
going to share with you some of the
results that we got about what happens
when CSS is unoptimized and our
experimental results from the Alexa top
1000 websites the basic reasons are
because it blocks progressive rendering
so if you've ever can the microphone be
a little less loud and bothering myself
with it I can't imagine how you guys
feel all right so if you want to go
visit this this some page that I have a
link to you absolutely can it basically
shows how CSS blocks progressive
rendering except in Opera it it
basically will show a blank page to the
user which will be completely white with
nothing on it until it's downloaded and
processed all the CSS files the only
browser that doesn't do that as opera so
compare it visit this URL compare it on
opera versus other browsers and you'll
see that we're actually giving users a
pretty bad experience when our CSS is
too big or we have too many files the
other reason is because it's verbose
there's really nothing we can do to make
CSS smaller so whereas in JavaScript you
can make all our variables shorter we
can
sit in all kinds of interesting ways for
CSS that just doesn't work there's no
way to do TD colon on calling you and
haven't know that that means text
decoration underline so it's important
to actually write it small from the
get-go but sort of more importantly is
what it does to your team's development
and the sort of mess it can cause with
the way that your team works one client
that I worked with basically they were
startup and I think this happens a lot
especially for startups is that you're
so busy trying to get the next feature
out there trying to meet the next
release and to you know to kind of beat
your competitor and to be the next one
to have the cool thing that's going to
bring users to your site that you don't
necessarily have the time to reflect and
to pull back and to say is our
architecture making sense so basically
it can happen that that a client can get
themselves painted so badly into a
corner that a feature that should take
two days to release actually takes two
weeks because they spend that much time
just trying to get the new feature not
to break when it's inserted in the news
in their actual site with their actual
CSS so I think yeah there are definitely
performance benefits to getting your CSS
figured out but the biggest benefit is
spending less time writing CSS and more
time writing stuff that's going to
actually add value for your users so
last year Facebook decided that they
were going to go on a diet they realized
that their site speed was not what they
wanted it to be and they made a big
commitment to fixing that and CSS was
sort of one part of of that puzzle and
they hired me to come in and look at
their CSS at that point just before i
started i went to velocity conference
and i heard two of their engineers david
and chang hao talk about their haste
based packaging system it is a really
neat idea basically they parse their
logs and they figure out which files are
requested together most frequently and
they build those into packages
automatically based on the previous
week's logs which means there's none of
this sort of wait should I combine these
two JavaScript files should I combine
these two CSS files they know what to
combine and what not to combine based on
their actual
usage patterns really super cool idea
which had unintended sort of unintended
bad consequences after a year of using
the system they had one point nine
megabytes of CSS and 706 CSS files it
basically made it far too easy to do the
wrong thing and so everybody did the
wrong thing this was what I sort of
started out with when you know when I
went to consult with them now their
performance group had a lot of different
angles they were working at they were
working on big pipe and X HP and a bunch
of other things some automated spriting
which works similarly to the packaging
system where they're actually figuring
out which images are requested together
and sticking them into sprites modifying
the CSS automatically really cool stuff
lots of different pieces coming together
the end result was that they reduce
their response time in half in only six
months that's a pretty important gain
and I'm going to talk to you a little
bit about how I did the CSS piece of
that puzzle and definitely check out
their engineering blog to hear more
about the other parts of the equation so
today we're going to talk about the
state of CSS performance building a
component library integrating components
with an existing site and then things
machine sorry things machines do well
that people kind of suck at I'm going to
tell you first about sort of how I did
this stuff by hand at Facebook because
at that point I didn't realize that some
of this could be automated and then talk
a bit about automating it so the state
of CSS performance it really isn't it
isn't a very pretty sight right now
stoyan stefanov and I this summer did
some research where we pulled down the
Alexa top 1000 website can we fix this
this is awful it keeps moving sorry
about that I'd rather fix it and get it
over with
it should be okay but every time I
breathe I can hear it and I don't like
that okay let's try again no it's still
bad can I just bend it away from me like
that is that okay can you guys hear me
if I bend it away yay okay good all
right so strand Stefan I've and I pulled
down the Alexa top 1,000 websites and we
ran some tests on them because what kind
of wanted to see well we've been in this
performance game for a while how are
things how are people doing how are
these websites performing what we found
was was not great so I'll talk a little
bit about the basics then how I used
grip on the facebook website and then
visual inventory and eliminating
inconsistencies so the first thing is
for the Alexa top 1000 we basically
grabbed each one of the Alexis sites
started Fiddler's loaded each site and
that exported the results from fiddler
stoian has published the PHP that we use
to do that so if you're interested in
running your own tests you can feel free
to grab that and use it it's available
as well on on my slides what we found is
that forty two percent aren't even gzip
in forty-four percent have more than two
CSS files fifty-six percent are still
serving CSS with cookies so unless
you're doing some kind of crazy
pre-processing there's really no reason
to send cookies back and forth every
single time with every request for the
CSS on your site sixty-two percent don't
minify the way that we determined that
was if they got more than a ten percent
improvement from running the Yui
compressor on their site we considered
them not minified if you run it over and
over you will get some smaller
diminishing gains but we didn't want to
count those really small sites in that
in that figure we also found that 21%
have greater than 100k of CSS so these
things that I've just showed you can use
why slow or PageSpeed to figure out if
we're your site is at their stuff that
we've known about for a long time but as
it turns out we're still we're still
kind of screwing up but when you want to
test more advanced stuff
I find that grep is the best way to do
it basically I want to be able to look
at all my style sheets in one go the
thing with the results at store and then
I got is that they actually
underestimate the problem because any
site that actually uses a packaging
system like the haste packaging system
that Facebook created is going to show a
much lower amount because we're only
going to ever see what they're pulling
down on one page so using grep you can
get the bigger picture of how
inefficient your site is sort of
globally so of the Alexa top 1000 we
found the worst site had 733 floated
elements that's absolutely gigantic but
fourteen percent had greater than 100
and who wait sorry thirteen percent had
greater than one hundred and fifty six
percent had greater than ten elements so
that's that's pretty broken what does it
mean if you find that you have too many
floats like say you've heard me say you
can go and grab your style sheets and
you go back and you try it and you think
you have too many it means that you need
a grid system you need a one consistent
way of laying out your pages and then
the interior parts of your pages that
work site wide so that you basically
don't repeat that layout stuff in every
single object more importantly you're
going to need to realize that the cost
for newbies joining your team is much
much higher when you have the layout
information mixed in with all the rest
of the CSS it's like a I don't know if
this is the right word for it but I
think of it as kind of separation of
concerns we're trying to get each object
that we build to solve one problem solve
it really well and not try to do the job
of other objects in the page you can
also grip for h1 to h6 this will tell
you how many headings in your page and
tell you a lot about the kind of
duplication that you have going on so
stoian and I found that the worst
website had 511 declarations of h1 to h6
but more importantly I think is this
number down here fifty-six percent have
greater than 10 so more than half has
greater than 10 greater than 10 heading
deck
erations why is that a big deal well
think about it this way most sites are
not going to use font sizes smaller than
say 10 pixels because smaller than that
is sort of good for mice to read not
humans and then unless they're you know
designer e site they're probably not
using greater than 24 pixels so that
leaves 14 pixels 14 different font size
that are usable then we look at the fact
that you're not going to usually want to
increment by just one pixel so if you
put 13 pixels and 14 pixels on the same
site either the user won't be able the
best case scenario is that the user
won't be able to tell the difference
between the two of them but the worst
case scenario is that they notice
there's a subtle difference and they
kind of thinks it should mean something
but they're not sure and they're not
really getting it so if we consider that
we want to increment by in most cases
two pixels at a time that leaves
actually only seven different usable
font sizes on any one website so in that
case we're seeing that more than half
have greater than the number that they
really need to have when i worked at
facebook the first thing i found when i
grep their style sheets was that they
had 958 different h1 to h6 declarations
after we redid their style sheets it was
down to 25 so yeah that's larger than
the absolute number of seven that we
think we should have but it's still so
much better than then where sites are
starting from currently so the worst
site in the Alexa top 1,000 had 889 font
size declarations this is sort of this
is another way of looking at headings
you can look at h1 to h6 but it's also
possible that people aren't using the
correct elements they are just you know
sticking font size changes on a div or
that they've put it in a class so
gripping for font size actually tells
you an even more exact picture of how
many how many declarations you have and
how many more than you should have and
this number is even more interesting
because when we grab for font size
rather than h1 to h6 we find that we've
got seventy eight percent of sites out
there in the Alexa
top 1000 having more more declarations
than they really need to have so if you
have too many headings what does that
mean basically that you need site-wide
said heading objects that you need
headings that you can plug in anywhere
and they're just going to work you don't
want to have a giant pink h3 and some
user comes along well sorry by user I
mean people who are going to build HTML
after you're done with the CSS comes
along and says great on my new page i
also need a giant pink h3 they grabbed
it they pasted it in their new page and
it completely explodes this is what we
need to avoid if we want to be able to
have site-wide headings and avoid that
kind of duplication so the worst website
in the Alexa top 1,000 had 518 margin
resets so by margin resets I mean they
set margin 20 basically that's the exact
thing that you would do with a reset
style sheet they're doing it over and
over and over again throughout the site
and I see this a lot with with sites
that don't use a reset dot CSS my
preference is the Yui reset because it's
really solid and it doesn't do a lot of
extra stuff that you don't necessarily
want to have happen oops I think I was
supposed to have a number here I forgot
to get it out of my out of my research
it was slightly less than the margins I
don't remember the exact number but it
was on the order of like 600 or
something like that okay so if you have
too many spacing tweaks reset CSS is
definitely your answer to get rid of the
the margin zero padding zero but if you
find all over your site you're saying
okay this but actually add two pixels
here and that but had five pixels there
you're also going to need some
abstracted spacing classes which work
basically like mix-ins and you can apply
them to existing objects to change your
spacing so you may not even know really
what your site is made out of a lot of
people don't I also think a lot of
people have trouble seeing their site
for what it really is they're so busy
looking at it and each feature means so
much to them because they built it with
their own hands that they really can't
see the repeating patterns in their own
so the way to start to see it is to do a
visual inventory a good way to think of
it as kind of like Lego so that these
crazy people built an entire car out of
Lego I couldn't believe it turns out if
they're just really neat stuff built
with Lego I like Lego Einstein as well
this guy brick artist com he's doing
actual art and sculpture out of Lego
like this poor thing that lost its arm
needed this one as well which reminds me
of how I feel when I see one point nine
megabytes of CSS there's a sort of panic
moment where I think oh dear God can I
actually optimize one point nine
megabytes to see as that and just okay
start do the first bit oh but this guy
stuff is really neat the thing to keep
in mind is that no matter what we've
built out of the Lego the fundamental
building blocks are the same for all of
them and so what we're trying to do with
our site is to say sure yeah we have a
Lego Einstein but what are the bricks
look like what are the little building
blocks that we made it out of look like
so we want to do exactly the same thing
with CSS you are going to be tempted how
many people do back-end code as well as
javascript in front and stuff okay you
especially are going to absolutely be
tempted to have PHP objects have a
one-to-one correlation with CSS objects
and you're going to want to say you know
pound my really fancy feature and then
all the CSS that goes with it don't do
it it's a trap each layer in the
architecture needs to have its own you
know its own way of functioning
basically well it's kind of like if you
took the DB schema and try to configure
apache with it just you can't do it
right but yet we expect the PHP
architecture to inform the CSS
architecture and it works just as poorly
Owen well so I think fit to be fair
you're whichever layer you're most
comfortable with you kind of project it
onto the other layers because when i was
at facebook i often wanted to make the
PHP match the CSS luckily i worked with
really smart developers who didn't let
me get away with that but that was sort
of my first instinct so i think it goes
both ways so let me show you practical
example is everyone familiar with this
it's a stream story on the facebook
website so in the PHP this might be one
object stream story and it's built and
it has comments and so there's you know
me saying something at the top and a
couple of people liking it and then me
talking to myself below it and in the
PHP that all fits together as one object
right in the CSS layer it isn't one
object at all it's actually a bunch of
smaller objects and if we break it down
to that level our sites will start to
look like repeating patterns so here's
what I found in this in this particular
object we have one heading so it's my
initial thing that I said and then we
have five media blocks a media block is
basically an image to the left and some
stuff that describes it to the right if
I had to pick one thing that the web was
made out of visually speaking it's that
we have a comments list an action list a
paragraph and a couple of links styles
in normal link style and a highlight
link style so you can imagine how if you
start to break things down to this level
and it's about taking these little
components and arranging them in
different ways with our grids all the
sudden most sites are actually built out
of exactly the same stuff and there's
this tiny little thin layer of chrome
which does colors and images which is
different but other than that our sites
are the same repeating patterns so it's
all about pattern matching but you have
to be willing to take a step back you
have to be willing to it might help
maybe if you have somebody who's never
looked at your site help you do it
because it can be really hard when
you're sort of in the trenches to to
figure this out also most sites get the
granular already wrong and the
architecture is basically set up to fail
if you find your CSS is growing and
growing and growing over time and
getting more and more unmanageable
probably your architecture and your
grandma granularity is wrong and we
basically can't to fight it back you
have to get the basic part right in
order to make it grow nicely so I want
to make you try it just that you'll have
a little experience with it what objects
do you see here
one of you has to actually speak I'm
really truly going to wait for for
someone to suggest an object in the page
or I could call on you wouldn't it be
awful hmm dialog box rounded-corners box
what you mean yeah like a pop-up exactly
he said a dialog box so it's true there
is in this a pop-up right now we want to
be sure to separate out its pop-up pneus
the fact that it's in the center of the
page and it has like a white
transparency like partial opacity that
covers the rest of the page from the
fact that this one happens to have blue
rounded corner box with a slight gray
shadow around it because that's a
separate object that's actually the
contour tabs yep tabs are container you
might very well want to have them
somewhere else you might have an
instance where you need tabs in a page
you need tabs in a different kind of
rounded corner box you definitely want
to separate out the tabs into their own
object good job
yes there are buttons absolutely there
are a couple different buttons and in
fact when you when you hover over them
they have a couple of different states
sew buttons are an important object to
separate out sorry input fields yep
we've got input fields we've got a text
area and an input we've also got labels
so those would be separate objects or
maybe together depending on if there
were different possible layouts link
styles yeah exactly we've got one link
style which is the basic link style the
change in the blue and then up at the
top the help we have a sort of low light
link style as well good job there are a
couple more sorry yeah there's a heading
absolutely one important thing to notice
about the heading is that it has a
little image to the left of it and you
know the media block we just saw in the
previous example all of a sudden if we
have a medial block object which exists
which we can just use without having to
write any CSS and we have a heading
object that we can just use without
writing any CSS all we do is insert our
image and are heading into the media
block and we have that that basic layout
yep one more sure in the back it could
be yeah so we have a list here for sure
my thought is that it might be a
definition list just because it sort of
got like thing and then something that
goes with it but it could also be an
unordered list yeah absolutely so that's
perfect you guys are definitely seeing
what this stuff is made of and how to
sort of break it down you'll definitely
have more trouble doing that with your
own sites because you're just more
familiar with it and that actually makes
it harder so when I go through the steps
to a good visual inventory and show you
a little bit about about how that works
first you want to pick pages in your
cider that are kind of representative of
the whole you may have a site with
thousands of pages you definitely don't
want to go through
all the thousands of them then you want
to go through the same exercise we did
with the pop-up but you want to do it
with every single piece of your site
copy them into a separate document and
the reason for doing that is because
you're going to want to group them by
type you want to going to want to group
all the headings together and all the
links Styles together and all the tabs
together and the other boxes together
and the popups together that way you
sort of get the idea when you have
duplication and when you have things
that are subtle variations on basically
the same thing what you have when you're
done with this is sort of the very
beginning of a brand new way of coding
the CSS for your website I want to show
you an example of visual inventory
results that i did so i basically go
through an entire site or well in this
case i did 12 pages we were able to find
12 pages that sort of fairly represented
the larger site and you find all of the
headings and text treatments so this is
an excerpt from the headings and text
treatments one thing to notice is if you
look more closely I think there were
eight or seven or eight different ways
of doing dates in just 12 pages so it
can be really important to put them all
together because all of a sudden you're
going to find all these inconsistencies
and when I give this kind of thing to a
client the designers have this moment
where they go oh no we screwed up bad
right because when it's all separated
out into different pages it can be
really easy to think oh we have a pretty
visually consistent site but when
they're right next to each other and you
can see that you used 12 pixels six six
six six and 12 pixel 333 and all of the
others right away you sort of can't you
can't argue with that so once you have
that once you have taken your visual
inventory and you've eliminated the
inconsistencies you've removed all of
the cases where you have something which
is exactly the same or is just a very
subtle variation on the same you can
start building your component library
and so we're building the Lego that are
going to be used to build all of the
features of our site that might be
heading
lists contours backgrounds text
treatments tabs carousels there are a
lot of different things buttons all the
all the bits we found form element
spacing classes but they have to be
built well we want to look at the
anatomy of a good component what makes a
good component so an example from
facebook is the media object that i
talked about with the image to the left
and the stuff that describes it to the
right what I realized when I was looking
at the facebook website is that they had
all of these different pieces and if you
use Facebook they'll be pretty familiar
to you but they're actually all the same
object the image might vary the image
width might vary but it's the same thing
happening over and over again so the
first thing to do when you're building a
component is to say all right what do we
know about this component what do we
know for sure it can be nested right we
can see from this one here that it can
have a media block nested inside of
itself so that's a really important
thing to know about it it has an
optional right button the little X to
close it so it had actually has three
regions the left right and then the
center area and it must absolutely clear
fix we won't wouldn't want something
sort of sliding up into the media block
perhaps more importantly we need to
define what we don't know about the
media object this is where we make our
our components flexible where we make
them work in situations that we didn't
originally intend them to keep in mind
that you're not writing your CSS for
where your project is now to build that
the designs you have now you're writing
your CSS to build the designs you're
going to have in six months time that
you have no idea what they're going to
look like yet so you're building the
pieces that will make the features later
so what don't we know about this the
image width and decoration very you can
have big images they can have hover
effects you can have tiny icons we
really don't know what the image is
going to look like the right contents
also unknown you can have lists in there
you can have paragraphs basically
anything can go inside of it that's how
we know where the boundary of our object
stops because I could say you know media
object Lane
blue but what I really want to say is I
know the media object doesn't care what
goes inside of it so the boundary of the
media object is the body area where you
can place any Content that you like
including other objects and then the
final thing is that the width is unknown
you'll notice that these are all
different widths now if I said that the
media object had to be 250 pixels it
could only be used in a space that
allowed 250 pixels by making the media
objects something flexible even if it's
going to then fit into a fixed width
layout I've made it something that can
be used anywhere we also want to
separate chrome from structure it's a
little hard to see on this slide but
these two media objects actually have a
different background color now the
typical way we've written CSS is that we
have one thing that we really like like
oh good the code for this is perfect we
say well but we need a blue one so we
copy paste the entire CSS over and then
we change the white background color to
a blue background color you absolutely
don't want to do that with your
components you want to basically take
off that layer which is just chrome and
apply that sort of like a mix in to the
base object it's really simple if we
look at the code of the media object is
just a few lines of code it's a div
basically a rapper element with an A in
it a link and then image inside of that
and then we have a body area which is
where our content of our media object
will be the CSS is also really simple we
basically have a new formatting context
which is the overflow hidden overflow
visible zoom one there are a few
different ways you can get a new
formatting context and the more
application like your site is you will
want to use a different one than this
but this works well for just sort of
plain websites and then it's pretty
simple a few floats and of some margins
and padding's to make everything line up
nicely and we're done it's a really
simple object this is my stream story
from the facebook website and this is my
stream story with all the examples where
a media object was used highlighted in
red so just this one object we were able
to have a huge impact in the amount of
code on the website each of these before
was coded individually
each of them before was a separate
instance and all of that floating and
margins was all repeated over and over
again so we got a huge performance
benefit just from this tiny change one
thing that people will say as well isn't
your HTML going to be a little bigger
because in the case with the icons maybe
we could have one less div or something
like that you know in a perfect world
where everything was coded perfectly
maybe that would be true but in the real
world where stuff gets coated with all
kinds of different levels of quality
implementing the media block actually
reduced the HTML size of a stream story
by about fifty percent so what makes a
good component what do we need we need
correct granularity to solve only one
problem with our object we needed to be
flexible and define what we don't know
define how it's going to work in
circumstances we didn't originally
protect predict we want low specificity
we want to make all the rules the same
strength and we want our objects not to
interfere with the existing website we
want to define our encapsulation which
means which of the sub nodes belong to
this object and which of the sub nodes
don't so if you have a rounded corner
box if you have a little element to make
your corners obviously that corner
belongs to the object it's a part of
your not going to have a corner floating
around by itself so in that case you
want to use encapsulation you want to
use the Cascade to to basically target
that exact element only when it's inside
of its parent but modularity on the
other hand means that we want to say
that ok this is the body of our media
object we don't know what someone's
going to put in there we don't want to
define what someone's going to put in
there that's where the the edge of our
object is and the next is predictability
if you have a giant pink heading you
want it to be a giant pink heading no
matter where its pasted in the site you
need to make it so that your CSS is
predictable otherwise it can't be reused
so next up let's talk about integrating
components with an existing site imagine
that we've built a library of little
component
so we have contours we have backgrounds
we have content objects we have a whole
library of different things we can then
mix and match those in order to build
new and interesting sites that we didn't
or pages or features that we didn't know
about when we first started building our
are citing so I'd like to show you an
example let me pop out of here
there we go
so I'd like to show you an example from
congregate com this is the library that
I built from that for them based on how
their website already looked so it was
based on you know going through their
website and finding all the different
pieces we eliminated a bunch of
inconsistencies we found about two
hundred and ninety nine different
heading styles which is relatively
smaller compared to most of the sites i
work on they were relatively visually
consistent but we were able to pare that
down to I think between 30 and 40
different heading styles and and text
treatments that they were going to keep
so here we have all the different
headings their sites interesting in that
it has areas which are on a dark
background in areas that are on a light
background so we had to make the objects
work whichever place they happen to fall
on so we never wanted to end it up end
up with a dark age 5 heading on a dark
background so we made sure that wouldn't
happen we built them link styles so they
have a default link style a low light
link mid mid light and highlight text
treatments so they had a bunch of
different text treatments that they use
in different cases the media block
obviously they needed one of those let
me see they also had ads so they needed
to be able to send her a line left a
line or write a line ads they needed
different add shapes and sizes so we
abstracted that out they had different
images so they had some with thicker
borders some with thinner borders they
needed spacing classes as well it turned
out in a lot of cases they need to tweak
the amount of space between between
different objects and what I didn't want
for them to do is to build that into the
CSS and to end up with a really
unpredictable system where you never
really knew what what your object was
going to behave like so we built them
away to tweak spacing without breaking
the site they had dividers as well so
just ways of creating horizontal space
between two part portions of the page
and containers so a lot of different
rounded corner boxes and you know hover
containers and and things like that
so that's an example of of the results
of visual inventory so first we saw the
visual inventory with all the
inconsistencies and everything else sort
of played out so everyone could see it
and then we built this component library
based on the simplified version of that
the big thing for me this summer and it
was sort of a big realization was that
what I was doing is basically cleaning
up after people's crazy code and I
really like that for me that's a fun
thing to do um why is everybody
snickering I guess there have to be
people who like a optimization anyway um
so if you had a really nasty messy
closet and stuff was everywhere it was
overflowing you couldn't even you
couldn't even basically fit anything
else in what I realized is that ok i
have this neat and orderly CSS that I've
built but how do I do it how do I make
it so that they can have both and what I
realized is that by writing my
components with really low specificity I
could basically tuck my components in
the background of their site and they
wouldn't mess up the existing site
because they're not very strong I don't
have really long selector strings if I
have an h1 it's just h1 and that's it
and maybe dot H 1 but simple simple
selector strings so i tuck my neat and
orderly CSS in the background behind
there you know well depends on the site
but it can be a crazy mess EC has that's
right and by doing that we start being
able to build new components with the
with the sorry build new features with
the good components straightaway so any
new pages any new features get built
with components straight from the get-go
then we look at sort of the 8020 rule
which is to say probably eighty percent
of your page views are from twenty
percent of your of your actual pages so
then we start going in and cleaning up
just those most traffic pages or most
trafficked features we rip all the code
out for one of them and replace it
completely with components and do that
over and over again and as you do it
your CSS gets smaller and smaller
because you can remove the
the existing CSS the broken CSS feature
by feature rather than having to redo
your entire site in one go it's
basically not possible to redo most
sites in one go we do sort of iterative
iterative development now we don't rip
out and replace an entire site with
another site so this allows us to do
sort of iterative development where we
can have you know eighty percent of our
site super fast super performant really
easy to use and yes sure there's twenty
percent of our pages which are crafty
and old and no one has touched in a
while but the first time someone needs
to make a modification to that page what
do they do they replace the old junk
with components and you have another
page which is in the superfast portion
of the site so then the important thing
to keep in mind is after you've done
that is that you delete the the obsolete
CSS don't leave the the junky old CSS
sort of running around in there once
it's no longer used make sure you take
it out so then I want to talk to you
about things machines do well that
people kind of suck at I had done this
by hand for a bunch of clients and
finally I was just like I don't want to
do this by hand anymore so I started
thinking about how the more predictable
things were the more I could the more I
could do them without ever needing to
look at their CSS it was a big
revelation to realize that I didn't need
to take someone's junkie messed up
broken CSS and move it migrated to
something good I could just replace it
with the right thing by doing the
tucking in the background method and so
in realizing that I thought well huh
actually this is something that I don't
have to do at all it seems like a
machine could be able to do this as well
there's sort of cross browser testing
every time we add something to a site
every time we change a feature we have
to be testing on every single browser
and especially with CSS it's not like
you just get to test once at the end if
you're doing it right you're probably
testing with you know every few changes
you make your testing because if
something gets really messy it's really
hard to get it back from there so we
were wasting just a ton of time with the
with this sort of cross browser testing
how much time do I have left okay
awesome so there are basically two main
pieces there's linting and there's
testing if we want to test the rendering
it gets much simpler when we have an
object that we know how it's supposed to
behave so let's look at the media object
basically we know that the width of the
wrapper should never be wider than the
width of the the three containing
elements and we know that the height of
the wrapper should always be the height
of the tallest child element because if
it's taller what happened it means that
something dropped below and so all of a
sudden we can start to think about
testing these objects in a way that
means that we don't have to go look in
every single browser it starts to be
automated linting can give us more
information as well simple things I
started looking at all the old websites
that talked about like the broken box
model and things like that and realizing
that most of what it was saying was
actually machine testable so you
shouldn't declare width and padding on
the same element or with and borders on
the same element I can parse through the
CSS and and figure out if someone's done
that without ever actually having to
look at the site and say oh this thing
is larger than a hundred percent clearly
there's a box model error as well font
size increments being more than two
pixels at a time and never being
repeated I can test that automatically
so I don't have to go through and do it
by hand the key to it is having simple
objects that solve one and only one
problem we can't unit test something if
everything in the kitchen sink is thrown
in so even in a visual way we have to
break things down so that each object
does one clearly testable thing grids
for example are the same as you know as
the media object we can test if they're
broken we can test if they're dropping
below because the height of the wrapper
should never be taller than the tallest
of its child nodes so looking at that
kind of testing as well so today we
talked about the state of CSS
performance building a component library
integrating components with an existing
site and thing
machines do well that people kind of
suck at well so I'm writing my first
JavaScript ever so i can tell you i kind
of stuck at that in order to build the
CSS lint tool but it's a ton of fun and
it's starting to test some really basic
stuff like broken box models and font
sizes and stuff like that so if the
premise is right if what i'm saying is
the way site should actually be built to
me we should see results I care a lot
about standards accessibility and
performance and all kinds of things but
what matters to me is did it change
something for my user is there user
experience actually better so I wanted
to show you some of the results of the
Facebook optimization they found that
due to these efforts we cut our average
CSS bytes per page by nineteen percent
after gzip and HTML bites by per page by
forty four percent before gzip and there
are some more notes about other
performance projects on the on the
engineering blog but to me that sort of
speaks for itself we have vastly less
code to deal with as developers and
obviously the site is going to be faster
because they're just pushing a lot less
over the wire so these are my contact
details thank you so much for having me
here you can get me at at stubborn Ella
as well if you're interested in more of
these sort of building of components
check out the open source project on
github</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>