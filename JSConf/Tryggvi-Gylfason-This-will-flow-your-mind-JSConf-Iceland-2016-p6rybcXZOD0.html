<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tryggvi Gylfason: This will flow your mind - JSConf Iceland 2016 | Coder Coacher - Coaching Coders</title><meta content="Tryggvi Gylfason: This will flow your mind - JSConf Iceland 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tryggvi Gylfason: This will flow your mind - JSConf Iceland 2016</b></h2><h5 class="post__date">2016-09-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/p6rybcXZOD0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for the introduction shower my
name is trickery and you can follow
along on speaker deck if you want to I
put the slides are you can see the link
there it's just the same as my twitter
handle and the title of the talk is this
will flow your mind and this talk is
actually nested it has a sub talk in it
the thing is that I found this one weird
trick while making this talk and
speakers will hate you for it it's how
to find a title for your talk step one
go to punch generator org look at the
list and find something that you like
other notable candidates were flow your
own trumpet and flow in the towel so
step through each prophet thank you but
let me fall back to the original talk
now so we've been using flow at
Queenston for over half a year so we
have kind of we have ever seen some of
its ups and downs and i'll go into what
it actually is in a moment but first i
just want to briefly go over their
structure of the talk the talk is very
linear it's split into five sections and
first this is the short introduction
then are really shallow dive into the
hood then I'll showcase some of the
features that flow can do and some of
its limitations and lastly I'll just go
over the lessons some of the lessons we
learned and color our experiences using
it so how many of you have heard about
flow okay a fair amount awesome so for
those of you don't know flow is a static
type checker for javascript it was open
sourced by Facebook and November of 2014
and that's their logo there it's kind of
made out of these modules of triangles
kind of and it's written in O'Connell
it's maintained by a team of around five
to seven people you can see the
contributions to master on the getup
repository since initial commit and it's
kind of interesting to compare that to
react flow is a little bit more than
half younger then react the red line
represents the lifetime of flow and we
can see that react really goes out with
a big bang and the Christmas months are
like really busy on the other hand flow
has this huge spike in contributions but
then this kind of goes into hibernation
for a few months but it's been picking
up a lot of steam lately and over the
last six months flow has actually been
more actively developed and react in
terms of contributions to master and to
compare flow and react again for no good
reason let's look at the punch cards of
the projects we can see that flow
contributors really hate contributing on
Sunday mornings and they ship the
hardest on Fridays but all nonsense
aside what what what is this well what
does it do how does it work so imagine
that the blue dots are JavaScript files
or modules if you will interconnected
and depending on each other what flow
does is it looks at those files parses
them and creates from the raw source
code this kind of format that it
understands and once all the files have
been parsed in this way we end up with
what is called a flow chart and using
the flow chart and this special format
flow notes down what your code is doing
for example what types go into functions
and come out of functions either by
inferring them or getting hints from
developers what kind of hints am I
talking about the hints are the type
annotations that they put to the
parameters and return types of functions
you can see that the
parameter has been annotated to be a
number and the return type of this
function must always be a string this is
an example of a function the flow can
fully understand flow is an opt-in tool
so we put this special line at the top
of files that we want to enable type
checking in this way it's really easy to
incrementally type check our large code
base that can be really important and
even vital to some projects you may not
notice that this isn't actually valid
JavaScript code if you try to run this
you'll get a syntax error and that's
because of the type annotations but
luckily flow support type annotations
inside of comments so the below function
is actually valid JavaScript and you can
run that but most projects nowadays use
some kind of transporation step so it's
really easy to just strip the type
annotations from the above function with
something like babe will precede react
or flow remove types but why would we
want to do this we have to type more as
in typing on our keyboards we're adding
restrictions to the code isn't a point
of dynamic languages to be faster
development and flexible and these
questions kind of bring us to the next
chapter of the talk which is why I
usually use it let me make it clear that
type checking might not be useful in all
projects if the project this small scope
tour short live it doesn't really
benefit as much from type checking that
being said flow is an opt-in tool so
it's really easy to just type check few
files and then go about your business
one of the most compelling reasons to
use type checker is bug prevention this
function should always return an object
no matter what it gets if it gets an
object its return that object else it
should return an empty object but this
function has a classic javascript bug in
it can anyone see it take a sec
ya know right so in JavaScript no
there's actually an object so if you
would pass null to this function would
go through it unharmed it won't resolve
to an empty object like we expect it to
so how we go about fixing this we could
just add a simple mail check but this is
exactly the kind of errors that flow can
help you find if we would have added
type annotations to this function pull
over the totals hey this thing you're
doing right here is not okay you have to
check for now notice the type annotation
on the x parameter has a question mark
in front of it and that tells flow that
X might be an object but it could also
be null or undefined so it's kind of a
maybe object other cases for using a
static type checker other than bug
prevention like this are auto completion
and refactoring tools as well as that
code elimination not all of those have
been implemented into useful tools back
by flow but auto-completion has and I'll
go over that in sac so what can I do you
can do auto completion so this is a
retouched action created it might
provide some context to those of you who
know Redux but is not important for this
example we're importing action types
from another file and the action types
are fully under flow fully understands
these action types it knows all the
properties on the object and the types
of those properties here I'm using a
plug-in called nuclide for the atom text
editor it's it's developed by Facebook
and it heavily integrates with flow it
provides type checks and safe and in
line adults just like each lens and also
type coverage so I can show you which
types flow can infer and which ones it
doesn't really understand
want to start typing the action types we
can see that we get Auto completion for
all of the properties and here I tried
to access the error and throw and I can
see that there are strings and this auto
completion applies to all JavaScript
native objects and all imports of
libraries that you have definitions for
fluids great support for a lot of new
JavaScript features and it ships with
support for native node libraries and
native jscript JavaScript objects
there's enough official repository that
is trying to gather all of this these
type signatures for all kinds of
libraries you can also write your own
it's also possible to do a little bit
more complex things with type parameters
so the big R and the big you here are
just placeholders for some type that you
will pass into this type this is a type
which describes an object which is a van
method that behaves exactly like the
done method of a promise so it's kind of
like an object which which is promise
like it behaves a little bit like a
promise and another thing the flow
supports really well is react react is
also developed by Facebook so naturally
flow can understand a lot about react
code let's look at one example of how
how flow can help reactive elbers so
flow can actually replace the the
reactor prop types type checking the run
the runtime type check that react you
can you can do with react so you can you
can throw away the runtime type checking
in favor of static type checking here
you can see a coffee image component
which only has one prop its format and
it can either be P&amp;amp;G or J
back so if we start to use the coffee in
it's in our application and we pass it a
format and if we give it something else
like a gif will get an inline error and
the error says that this string isn't in
the string item that you told me the
format is so this can be really useful
just for completeness sake we could have
implemented coffee images to save this
component and flow and support for that
as well so what can't do this section is
pretty short and pretty specific it
can't warn about additional properties
declared on a components prop type this
is an example of what I'm talking about
we have a hallow component which is only
has one prop name and if we invoke it
with another property like H we don't
get matter at all this is something that
the full team is looking into and will
probably be improved in the near future
the root cause of this is that flow
doesn't really support exact object I'm
kind of going to skip this slide but I
want it in the slide deck so you can
look at it later if you want to another
thing that is problematic with flow are
non-native data structures and what I
mean by non-native data structures are
their searches that don't behave like
normal JavaScript native data structures
like array and object for example we're
using immutable J's a lot and it's
really difficult to model mutable data
structures and flow I think it's mainly
because of how the API is constructed if
you're going to access a property deep
down in our object you have to give it a
key path which is an array of strings
it's really hard to model that but the
good news is that in a recent QA the
fluid flow team revealed that better
support for immutability is in the works
again I'm kind of going to skip this
slide this is this is how we're doing it
right now it's not really that good and
you can see that the kyare I was talking
about the keypad on line fourteen again
I'm going to skip this slide you can
look at it later if you want to this is
the last section of the talk I'll go
over some of the lessons learned then
kind of our experiences using flow so
the first point i want to make is but
it's super easy to start using an
existing project we have internal tools
that amount to about 60,000 lines of
JavaScript code and we started type
checking just a few files to see how it
felt and flow even copped some existing
errors while we're integrating it
indoors are a codebase incrementally
that would just what we're there since
the beginning and sometimes it doesn't
really make much sense to type check for
example functions which do really basic
operations flow can usually infer the
types of those functions so here's an
example of a function that flow can
fully understand you can infer the type
of the parameter and the return type of
the function and nuclide can really help
you here nuclear there's the plugin for
the atom text of the door and it can
highlight which part of the javascript
file flow can infer and which ones you
can't try to avoid type laziness it can
be really tempting sometimes to just
write object when you're describing a
type instead of creating a more
descriptive type that conveys more
information to flow this is happen to us
on several occasion and and it really
diminishes the benefits of static type
checking so try to avoid doing this and
do this instead notice the difference in
the power of parameter type annotation
adding type annotations in some cases
has made a code a little bit more
understandable and readable and when
you're looking at code that someone
somebody else wrote it kind of takes
just a little bit less mental power to
understand what what's going on I love
healthy discussion has also surfaced as
an effect of using the flow type system
for example in code reviews questions
like should this be able to return
undefined or should this parameter be
optional are discussed so it really has
a positive effect on code quality so to
sum it up flow has been a great success
at quizup it's really improved our
development experience by a lot and I
recommend using that usually try it out
if you're maintaining a JavaScript code
bitch and I hope some of this stuff blew
your mind but just in case that no one's
mind was blown I'm going to blow this
one so thanks thanks very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>