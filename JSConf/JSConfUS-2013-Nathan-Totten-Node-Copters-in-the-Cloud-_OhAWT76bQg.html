<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[JSConfUS 2013] Nathan Totten: Node Copters in the Cloud | Coder Coacher - Coaching Coders</title><meta content="[JSConfUS 2013] Nathan Totten: Node Copters in the Cloud - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[JSConfUS 2013] Nathan Totten: Node Copters in the Cloud</b></h2><h5 class="post__date">2013-10-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_OhAWT76bQg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">commands Nathan time I'm a technical
evangelist at Microsoft I work on
Windows Azure so probably a lot of stuff
that most of you have never heard of I
see a lot of max in the room that's all
right I've back to so today I'm going to
talk about cloud and node copters in the
cloud so I actually just got here today
unfortunately this is a super busy time
of the year for me so I wasn't able to
attend the full conference my
understanding is you guys saw a bunch of
robots drones things like that like 52
node copters so we're not going to go
over that again I know you've all seen
that but what we're going to do is talk
about how we can do some some crazy
stuff with these node copters with the
AR drones connecting through the cloud
so I want to preface this this demo is
like super crazy hardware wise I brought
my own router I have this so they like
there's two possibilities of this it's
either going to be awesome and we're all
gonna have fun or nothing's going to
work and i'm just going to sob up here
so hopefully that doesn't happen so uh
huh anyway so again talking quickly so i
kind of already did the intro why are we
doing this all right so actually quick
really quick what we're going to show
i'm going to do mostly code um so what
I'm going to show here what scenario i'm
going to show is basically we're going
to build a local app both running on my
on my mac here but a local app that's
receiving messages from the cloud and
i'll explain a little bit more how we're
going to do that in a bit and then we're
going to build a controller app that's
going to send messages so the idea is we
could be remote and actually fly this on
node copter and we're going to use a
queuing service in the cloud in windows
azure to actually communicate between
the two of these so why are we doing
this well there's a couple reasons the
first one I really wanted to use my
corporate expense account to buy one of
these things so I had to think of a
reason to do so ha the second reason i
thought what would be a fun what would
be a really fun way to to really just
scare the crap out of my girlfriend and
I thought if I just had this node copter
sitting in the living room and flew this
thing you know while I'm gone
that would that would be really fun for
me and probably get me in a lot of
trouble also pets it's super good on
pets so this is basically what we're
going to build here oh we're going to
we're going to build a local app
controlling our through the cloud
controlling our helicopter for the
amusement of the of the evildoer to
scare the pets and the clip art folks in
that in that microsoft legal approved
photo i'm allowed to use so a really
quick little bit a sales pitch here so I
do i do of course work for Microsoft
they only pay me if I tell you what I do
so again we're going to use Windows
Azure I'm going to make this 15 seconds
really quick we're going to skip the
marketing crap we're going to talk about
Windows edgers how many people here have
actually heard of Windows Azure that is
shocking okay how many people have used
it oh cool so the only thing I'm really
going to say about Windows Azure is we
are home i still have there we go we
we've really done a lot offer no Jess we
love no Jess so it's not all about
Microsoft right it's not all about net
net certainly works super well if you do
that I assume no one in here does odd
again judging by the sea of max there's
a guy there's a guy with an HP there
don't be embarrassed yeah I left mine in
my hotel so I thought I'd get lynched ah
no but yeah so basically we we've put a
lot of effort into I into basically
making nodejs work really well on
Windows Azure we actually have a number
of customers building very large
applications using a number of our
services on no Jess running in Windows
Azure as I'll show today we have a whole
CLI tools and and a whole SDK that works
entirely on Mac i'm not using windows so
we are definitely not even though it's
set in DOS it's all about open source
nodejs and and other things so i would
definitely encourage you to try it out
there's a lot of like free if we've got
all these free programs like we like to
give things away for free but there's
like a ton of stuff we give away for
free for Windows Azure like search for
biz spark or any number of things but
there's like a whole bunch of ways to
get a lot of free Windows Azure so
that's the only sales pitch I'll do I
apologize for that again I only get paid
if I if I say that so Windows Azure com
I'm actually really happy that that most
of you have heard about it
Zara or I guess I'm doing a good job so
offer the rest of the demo we're just
going to coat so this is the part that's
either going to leave me weeping in
tears or everyone everyone clapping and
cheering in my head fantasy so everyone
seems very tired here I've had like
three redbulls this morning I and
there's free Red Bulls out there why
haven't you guys been chugging these
things anytime I'm given free redbull I
drink a lot of them it's very dangerous
so I know like some some of you may work
at Facebook I know they're there they're
red bulls there all the time and and I
think I would die if I work there we
only get free soda which which makes it
harder to ingest large quantities of
caffeine so let's zoom in on this a
little bit tell me if you can't see it
so what I'm going to show again is we're
going to really quickly in 18 minutes
hopefully build an app that we can use
windows azure to basic communicate from
the client to the cloud and make this
thing fly and probably crash so let's
give it a go so I have an express jess
app basically already set up we ought we
probably all know how to do that I don't
want to explain that um we don't have
time to explain that so I've got a basic
Express jess app I've got a few modules
installed the ar.drone module windows
azure and then Jade and all that crap so
ah so let's do let's build our server
side app first so this is again just a
raw raw Express app so I'm going to
build and sorry actually let's do our
client site at first that makes more
sense so what I'm going to do is build a
client-side application that receives
messages I'm supposed to gesture to this
monitor that receives messages from the
cloud and tells our drone to fly to land
that's all I meant actually do because
otherwise i know i will crash it so fly
and land we've all seen the other things
it can do i yes yesterday and then we're
also if we have time we're going to do
some stuff with some logging data we of
course could do a lot more take photos
stream video all of the fun things but
but I think we're pretty short on time
we want to have time to show that so um
so I'm not actually gonna code in front
you but I do have some I've cheated
given the lack of time so the first
thing I want to do is I just use our
windows azure sdk to
you to actually read our sorry we're
starting with the client new file skip
the step here so actually hang on i'm
going to i'm going to go even faster i'm
going to cheat even more apologize since
we're running short on time alright so
let's copy some code and client j/s save
that so we're basically we've we've
imported drone module and and i have my
drone set on this IP address on my own
custom access point here so there's a
few things I'm going to do the first
thing is I want to actually I want to
actually receive some messages from the
service plus we'll send these messages
in a second but service bus is basically
a very simple queuing service in Windows
Azure so we're going to connect up to
this and we're just going to continually
pull our windows as your service bus for
cues I excuse my code this is really
awful but this is this is just for demo
so that's why it's not very robust but
hopefully you'll forgive me let me
assume in on that and let me know if I'm
talking too fast again I have had three
redbulls I have a lot to get through in
a very short period of time so so yeah
so this is our code here what we're
doing is again we're we're we're using
the nodejs SDK for Windows Azure we're
we're creating a service bus queue
client and then we're going to
continually read from from the queue and
actually let's just set interval and
we'll do receive oops a receive message
I can't spell an everton spell on the
stage that's why you snippets all right
receive message and let's just do it so
what we're going to do is just set a set
a set an interval here and we're going
to call our service bus every second and
check for a message and then we're going
to we're going to issue command so we
need a few commands to actually to
actually control our drone and these are
things you guys have already seen before
I think client so let's just do this
really quick commands so we've got a
couple commands here for takeoff and in
land so let's actually clips
I ain't a take-off no wait was it yeah
take off so i called the take-off so
client take off and client I don't know
why didn't fill those client land oops
again can't spell on stage land so to
recap this is our simple client and this
will be running on our local machine I
thought about actually running this on a
separate computer but there's the issue
of two monitors i also thought like I
could run this on my surface on Windows
to show that node works you know that we
could use both and then like to make it
even more portable like I could
duct-tape my surface to the drone but
then I discovered that it wouldn't fly
if it had a computer tough you guys
don't like my humor con are you guys
asleep was everyone out drinking last
night what's going on wake up I'm gonna
be I'm gonna get louder unless people
start laughing I can't handle it alright
so I'm trying to let's have fun I want
to have fun all right ah so I know I
know that most of the sessions here are
about learning something useful again
I'm going to repeat this is only about
doing something completely ridiculous
and kind of having some fun with it so
let's try to have a little bit of fun so
we've got our service bus receiver we're
going to continually pull for messages
obviously these messages could be more
sophisticated I just have a string take
off land wrote we're not going to do
rotate because I've had troubles with
that in the past and then we do all
kinds of crazy things then the things
flying across the room and then someone
gets hurt you know Microsoft is lawsuit
all kinds of stuff I get fired so so
we're going to just do take off and land
up and down as safe but we could of
course do more sophisticated things pass
more data altitude things like that so
this is our client I and we're going to
run that we're going to run this here in
just a second but let's build our server
so a couple code snippets here for
brevity so server service for us so
we're going to again connect to that
same service bus I using our as your SDK
service bus queue and and we're going to
we're going to have we give the send
command function here and then I'm just
going to add a few routes we're going to
do this again really terribly with just
some get requests routes so we've got
we've got our
take off route and we'll just redirect
back to home and our land gets and then
let's just add some very fancy you I I'm
for those who have seen me speak before
probably none of you you will know that
I'm world renowned for my great user
interface abilities there we go and
that's that you see someone's impressed
alright so so let's just make sure we
got everything so we have our client
we've got our point we've got our server
here running express couple simple
functions sending some messages to the
queue command take off and land and then
we've got our client which would be
running locally receiving messages from
the queue and if all goes according to
plan we'll be able to do some fun stuff
so let's first let's run our server if I
can type OS my I'm just happening there
we go after Jess all right we got that
running and client j/s so again well
look rookie mistake you guys can shout
at me but if you see something like you
missed a semicolon or noob all right
yeah this alright so we've got our we've
got our client j/s again remember even
though these are running on one machine
these in in practice when i'm harassing
friends relatives family pets would be
running on two separate machines and I
would be sitting somewhere remote
alright so let's go to our let's go to
our unnamed browser here there I get
that they don't have internet explorer
on a mac work for Microsoft so I'm not
allowed to say the name I'm just kidding
I'm not really that would be I just get
like a mount I get a hundred dollars
deducted from my paycheck so that's fine
haha so we've got our very fancy app up
here with our takeoff and our land
command now hopefully this is still
connected and let's let's go ahead and
click takeoff and this is going to
encule message what do we do uh-oh see
there we go we got to save things
obviously all right now let's try that
again take off yes and it takes off and
then we're it worked so happy and and
we'll land and again that's all we're
going to do I know there's a lot more
fun we can do but it will it will fly
around the room and it will crash and
bad things will happen so that's really
that's really the main the main thing I
want to show so this this to me like
even though again it's it's ha it's
pretty much useless but I think it's a
lot of fun and really like you can
imagine a lot of scenarios where
something like this would be useful
obviously there's the there's like a
bunch of industrial scenarios or remote
sensors remote devices that you could
actually build an app like this pushing
messages from any network through a
service like windows as your service bus
queues and receiving that locally um so
the last thing I want how much time do
we have we have we have enough time so
the next thing I want to show you is so
we basically sent data using the cloud
now I want to use another another
service in windows as this is a simple
storage service and actually save some
data up there so let's so the next thing
we're just going to take some of the
telemetry data there's for those who
have done note our programming before it
sends back basically telemetry data like
its current altitude various rotation
data things like that um so what I want
to do is actually just read that data
from the node copter and actually save
that up into windows azure so let's
let's go back to this we'll do on our
client application so let's go ahead and
just add some more code i already have
prepared here drone blob so for this i'm
going to use our Windows Azure blob
storage which is which is basically just
a binary service or storing any any
binary data we also have serve it we
also have some like table service for
storing a schema lyst tabular data we of
course have like sequel in the cloud my
sequel various things like that if you
want to if you want to use something
that's equal we have through hosting
providers we have of course mongodb
things like that but this we're just
going to basically store Jason text
object into our blob storage just for
simplicity so we've got so again this is
our our save function connect to Windows
Azure blob storage and then create a
blob and save that too let's create a
new blob just so we have an empty one to
prove that it is working so let's go
back to so I'm just going to go to my
azure portal here and storage and cloud
drone and let's just make a new
container I already got some logging
data in there but so we have a fresh one
let's call this log three and we'll make
a public container so everyone can see
all our fancy logging data log 3 that's
alright and let's just change that to
log 3 so what we're going to do again on
the client we're going to receive data
from from RR copter as its flying and
we're going to just save it back up to
went to the Windows Azure blob so we can
look at it that's really that's all we
have just look at it so let's uh oh and
we need to we need to fire an event
client on nav data so this is the the
the the ar.drone SDK is firing on nav
data and
save data so if you notice I'm doing
kind of something silly here I'm only
going to save it like an arbitrarily
every every millisecond that's divisible
by 100 just because basically this event
gets fired like like I don't I don't
know it's like forever but it gets fired
constantly so like we end up with a lot
of data so I'm just kind of like
limiting that to an arbitrary
arbitrarily smaller amount of data so
this is our this is all we need to do to
now capture data from our drone and save
it up into blob storage so let's go
ahead and and stop our clients here our
client and run that again and now we are
going to be capturing nav data so let's
let's let's launch this again and it's
still working awesome and now let's go
leave it running so we see we're going
to save some log data and we'll land it
now awesome so let's exciting the second
time and now we should see that in in in
our in our portal here we have we have
got some data so let's go ahead and copy
the URL since we made this public we can
just browse this and there we go we've
got all our log saved so so pretty
simple we have a few more minutes left
so now so what I want to do I think we
have time now I want to actually deploy
this application up into this is the web
app up into windows azure so on this is
the part that gets very dangerous so
that you guys can decide when it flaw
when it when it takes off and lands so
for nodejs we have we have a service
called windows as your websites which is
basically a super easy way to to deploy
applications into the cloud so let's
just go ahead and create a windows as
your website and let's just call this
j/s com it's not taken cool beans so
let's choose our region east us and
create Jas comp so with windows as your
websites is a variety of different
deployment options but the the one that
makes most sense for no developers as we
can deploy right up to Windows Azure
websites with get so so let's so our
sites created and let's go ahead and
select this and go to our dashboard oops
go back and a set of deployment so we
can do a couple of different things we
can actually deploy with continuous
integration from github or from you from
dropbox and from like bitbucket whatever
or we can just push directly to a to a
local to a local get or to a good end
point just in our in our deployment
servers so we'll take just a second to
create that get endpoint and then allah
then I'll initialize I'll set this up
and while this is and here's our here's
our get server so let's just let's just
quickly push this up into windows azure
so i'm going to nish Eliza's a git repo
again just a regular git repo remote as
europe's add a sure
and I didn't put it ignore so we're
going to push the node modules we don't
actually med sorry we don't actually
have to push up the modules of course
those will be installed the first time
those will be installed from packages
but i forgot to create a pack and ignore
to get ignore file so we're just going
to push those up anyway which is fine
get push as your master although it'll
take a little longer so we'll make it
quite a cool so again we're just pushing
this this website up to up to up to
windows as your websites port good so
we're just pushing this up with get to
windows azure websites to a website that
will be at j s comped as your websites
net and I should not have committed the
modules because they're huge compared to
the site but that's alright so normally
you would obviously ignore the modules
and not commit that into your git repo
eyes would be best practice and windows
as your websites will pull those and
install those when you when you push the
site so making it much faster so we'll
see here our deployment happens and this
just takes a few seconds few seconds
longer Joey's takes longer when you're
demoing right entra have any questions
while we're waiting oh there we go no
questions all right
j/s comp dot as your websites dotnet so
yeah good question so do native modules
work so yes so windows as your websites
is running on Windows we are Microsoft
after all so we do support running Linux
in Windows Azure through virtual
machines our websites which is basic
higher-level purely managed hosting
environment does run windows so
basically any module I mean most nade
module and most native modules at this
point do run I mean do work on windows
there certainly a number that don't
though if they don't build on windows
they're not going to work on Windows
Azure websites we're working we're
working we want to fix that like wow my
god i forgot that i forgot that this oh
man see this is why i only made it take
off and landing otherwise like you guys
would be flying around the room and
there would be a lawsuit and it would be
it would be bad i would definitely get
fired so cool yes so this is this is my
demo hopefully this this this was fun
and now hopefully some of you I'm not
actually recommending this but hopefully
you can use it for some sort of
entertaining purposes scaring friends
and family and pets not pet so that is a
joke that actually mean I wouldn't do
that but friends and family of course so
yes so so yeah so back to the the node
modules quote yes so we're working on it
I don't know what the solution will be
whether we have build servers that are
Linux whether we eventually have like
Linux servers for for node but yeah
there is the limitation with that right
now cool and you guys are fighting over
it now I like it all right so all right
we're just out of time so hopefully that
was somewhat enjoyable and maybe a
little useful but like I said they're so
for off for Windows Azure if you are a
start-up or if you're building something
and you want free hosting just go to
microsoft com whack business park we've
got this program that basically we're
going to give you like it's like six
thousand dollars a year of free Windows
Azure to host your stuff on so a
shameless plug but you get a lot of free
stuff so I would never heard you to
check that out if you do happen to have
an msdn subscription already through
work or whatever you also kind of free
Windows Azure through that so thank you
very much hopefully this was enjoyable
and enjoy the rest of the day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>