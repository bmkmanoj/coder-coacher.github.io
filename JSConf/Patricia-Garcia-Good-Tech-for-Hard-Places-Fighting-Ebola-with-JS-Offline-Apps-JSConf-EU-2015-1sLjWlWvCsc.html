<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Patricia Garcia: Good Tech for Hard Places: Fighting Ebola with JS Offline Apps | JSConf EU 2015 | Coder Coacher - Coaching Coders</title><meta content="Patricia Garcia: Good Tech for Hard Places: Fighting Ebola with JS Offline Apps | JSConf EU 2015 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Patricia Garcia: Good Tech for Hard Places: Fighting Ebola with JS Offline Apps | JSConf EU 2015</b></h2><h5 class="post__date">2015-10-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1sLjWlWvCsc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">(Applause) hi, everybody, I'm very proud of
you being here after lunch (Laughing) and
thanks for the introduction, Alex. You know
you can say live with JavaScript, really ‑‑
you can saver lives with JavaScript, you can,
you'll see, this is not necessarily an easy
path, we have been doing that for the past
13 months and writing JavaScript offline applications
to fight Ebola outbreak, we have made a lot
of mistakes and find a lot of challenges and
we have learn a loath. I want to share with
you the challenges the mistakes and the learningses
so maybe it will save you some pain if you
work withoffline applications. All right.
Ebola, I'm sure you know a lot about Ebola
because it's been in the media for the past
year and a half. Toking to review the facts
that will help you understand how to fight
it. So, we don't know much about Ebola, once
of the things we don't know is how to cure
it T way to treat it nowadays is just to bring
people to a medical facility and keep them
strong and hydrated and treat the symptoms.
So that the body can deal with the virus itself.
However, Ebola has some good parts in comparison
with some other diseases, one is that contagion
requires direct contact with body fluids,
so it's not air born like a cold. And also,
infected people are only contagious after
they develop symptoms. Unlike the flu where
you are giving it to other people and you
don't even know you are sick yet. We also
know the incubation period is up to 21 days
and the way to fight Ebola is mostly what
is called contact tracing. When you find someone
that is sick with Ebola, you, of course, first
bring them to a hospital, provide them with
care, and be careful to keep them isolated
from other patients because Ebola is very
contagious. But the second thing you do is
to find out everybody that has had significant
contact with that person in the last days.
And these people are put are infected with
Ebola too. So what you have to do is check
on them for 21 days, follow up on them for
21 days and sea if they develop symptoms,
if they don't, they are free, if they do,
then you have to start the process again,
so there are two important parts here for
stopping the sickness from spreading, one
is like, one is contact tracing, the other
one is to find infected people as soon as
possible so you can help them and also so
you prevent them from infecting other people.
For that, this is not so see city in the Ebola
countries in west Africa like in Liberia and
Guine and Sierra Lee I do not know, at one
point there were two many people infected,
it was difficult to find them ontop tomb.
Apart from contact tracing they set up an
emergency Ebola hotline where people can basically
call with an Ebola emergency saying that somebody's
sick or dead or just asking for information
because education is very important here too.
Some people didn't know what Ebola or didn't
believe it existed. Okay, so, how does JavaScript
enter the equation? I work for e‑health
Africa, a nigh jeerian based NGO that tries
to help vulnerable communities, mostly in
West Africa live healthy lives. And part of
it has been helping with Ebola outbreak (West
Africa) we first went to Nigeria pause rewriting
Nigeria based and things were somehow okay,
pretty okay, so we were asked to go to also
Sierrea Leon, Liberia, in Nigeria we realized
contact tracing was working, the contact tracers
that go to visit the contacts at home and
they use paper forms, you know how paper forms
work. It's slow to enter the information and
there's no other checking, paper doesn't complain
if you don't fill a mandatory field. And also
paper is easy to lose or it can be destroyed
like what if it gets wet, for example. Also
it travels slow, you have to bring it to the
place you want it to go. The place you want
it to be was what is called the emergency
operation center, there is where they take
the information and they decide what to do
with it. And they also try to digitalize it
you can do Analytics or plan a strategy further.
This is also like taking all this paper of ‑‑
all this paper and put it in an application,
also error prone and slow and something we
human suck at. However, you can do just a
simple application where the contact tracer
will select the name of a person they are
following up with and they can just fill out
the symptoms and as a bonus once you save
it, the phone can save the GPS coordinates
of the place you are, so you can be sure that
the contract tracer actually visited the person.
This can synchronize to the at that base and
you have the data digital lazed very fast.
And we could improvise another tool for the
major emergency operation center that allows
to have real‑time information about what's
happening for example if someone has developed
symptoms you can see they're highlighted in
red. I also mentioned the call center, for
the call center it was even more extreme because
they are receiving more information. They
were using different things, ranging from
paper to excel to some applications they were
not happy with. Imagine for example paper,
you are receiving all these calls from people
that are ‑‑ and you have to write everything
very fast and then the next call comes and
you have your paper that is piling up, and
then somebody has to go there and have to
filter the calls that were actually got or
the calls that were just asking for information
from the calls that says there is somebody
dead at my place and like my son has died
and he has been here for two days and somebody
has to e puck the corporation because this
is in ‑‑ has to pick up the Corps because
it's infections. We created a place where
they could enter the information easily. The
different teams you see here, the quartine
team, ambulance team can just filter the information
they want, we can prioritize it for them.
And they can the ‑‑ prioritize it for
them () these two applications are pretty
simple, but thaw manage to make the process
faster with the mobile applications, reduce
the response time from twelve hours to almost
instantly as instantly as the network connection
was working in the call center there was an
article the other Jan Day saying all the improvements
in the call center have managed to reduce
the response time from an average of five
days to one day, it was not only the support,
there were many other improvements, five days
is pretty bad if you're sick and you have
to be taken to a hospital. But this is not
very complicated this is a bunch of web forms
a bunch of API calls, we know how to cowhich,
we're web developers, it's a two minute job.
We have some constraints that make our live
difficult between difficult and a living hell.
There's not always internet () sometimes there
is, but it's too slow. It's unreliable, one
thing we know for sure is our applications
have to work offline. Fortunately, we have
the help of some awesome piece of technology,
couch DB, couch DB is document database that
allows you to do map reduce operations also
using JavaScript on the data. And has HTTP
API and designed with distributed systems
in mind. And this part about the HTTP API
means that couch DB can be your back end.
In our case this is what we did, couch DB
is our back end so we don't have to implement
this part. The only part missing here is the
offline capabilities. But, then we had the
help from touch DB, which is also an ‑‑
pouch DB which is an Open Source project which
provides you with a compatible database within
your browser. We added a little bit of Angular
to the mix, and it allowed us to move very
fast and be super flexible with the data we
were handling. So fast that the first prototype
of our contract tracing App was ready in three
days, the prototype, and same for the call
certain both were in production doing something
within a week. The code was somehow crappy
and we had to fix it, but, it helped and a
few weeks later, Ebola was eradicated from
Nigeria and we were asked to go to these other
countries where the emergency was much worse))
(Eradicated) there were two things that were
different in Guiene, and Liberia in comparison
with Nigeria, the infrastructure seven worse,
so internet is even ‑‑ infrastructure
is even worse and internet is not reliable
and the scale of the outbreak was completely
different. So we started having some problems.
Here you can see the difference between ‑‑
you cannot see even the numbers in Nigeria
because they are negligible in commissary
son with Sierra Leone in Nigeria there were
20 cases in total Sierra Leone at the worst
moment there were 500 new cases a week. 500
new sick people per week. What we were doing
at the beginning was simply following the
pouch DB tutorial. Just replicates couch DB
database in your browser. You have all your
data available and you can work as if you
were on‑line all the time. But we started
noticing that at some point this was not working
quite well. First the browser complained,
look this is too much space, you are being
too greedy. Different browsers have different
limits, but, yeah. We sort of ignored this
problem and decide, okay, we'll just support
Chrome, that lets us use six percent of the
hard drive, yeah, that didn't work out. The
next thing is that the replication started
being super slow, but it was ten minutes,
20 minutes, then40 minutes and that was in
Berlin, in Liberia with more latency and worse
internet ... so we were crazy trying to improve
this and fix it and then we saw this, which
is like Chrome saying, okay, I give up. I
thought it was very funny the first time,
oh, I totally own Chrome, but I felt it was
just my development team, no, it was in production,
not so funny. What we found is that there
was a problem with the replication in couch
DB and this is an issue field by one of the
couch DB developers for the couch DB guy.
There's a lot of information, sorry you may
not be able to read it. The summary is 23
you want to replicate ten thousand documents,
which is not see much, you can request batches
of 500 documents for example, you will assume
in 20 requests or more or less, I have my
data. However, the way replication works means
that you have to do one request per document,
so ten thousand documents ten thousand requests.
If you are using course, as we will, then
you have double the number of requests, so
ten thousand documents is not so much, 20,000
requests is a lot. Okay, so, problem solved,
scaling. You replicate your whole database
that can take too much space or too slow it
can even crash your browser because of the
number of requests. We did a custom solutions
to fix the third one, I'm not going to tell
you because it's already fixed in couch and
pouch DB and they're going to release it very
soon, they will do it better than us. But
the other two, my advise is think twice about
&quot;just&quot; using sink, think twice about what
you really need to replicate. Use your domain
knowledge. As an example for our contact tracing
mobile application, as I said it was just
a drop down with names and then you fill up
the symptoms right. So we were replicating
everything and then we realized, okay, why
do we need all these documents? Actually,
we don't need any contact after three weeks
because then they are not contacts anymore
because the incubation period is over. One
particular contact tracer only works in one
area, not in a whole country. And if people
turn out to be infected then they are not
followed up anymore, I don't need the contacts
there. If you just change from replicating
everything to just replicating this subset
it's already a hugh improvement. We even went
further, okay, but we don't even need all
the information about this contact, we just
need names and IDs, so just to show you the
kind of creative solutions you can make. This
is what we did. This is the remote database
and this is our document. We were using one
document per person, which is not the best
choice, I will tell you how to do better afterwards.
But, basically we created an index in the
remote database with names and IDs and we
were requesting ‑‑ and creating manually
a local database, a look up database. And
that's all the mobile phone need from the
remote database, the rest of the work is you
can do offline and the phone can add more
follow up information. And it can be synchronized
once you have internet. In this case the documents
are different in the stored database and remote
database so you have to do some custom lodging
too, this is due to the fact that our data
model is not ideal. will tell you more later.
In a completely different sample we had the
call center where the data set is much bigger
so we tried to reduce it. But the smallest
at that state was still way too big. And also
we were doing something funny here because
I told you that with the contact tracing and
the task force application we were speeding
up the time the paper information will arrive
to the operations centers from twelve hours
to almost instantly, right. And here in the
call center it was different, we had people
working side by side, people receiving calls
and people sending ambulances for example,
and if I take my call and put it on paper
I can just hand it to the person sending the
ambulance, however the way we were doings
it was sending the information all the way
to the internet and back. And if there is
no internet in two hours, it takes two hours
to transfer the information. So that didn't
make so much sense. That we released is that
we were sort of trying to solve a problem
for the sake of solving the problem somehow.
We didn't need pouch DB we just needed a database
available at all time. What about in every
call center you just have a local pouch DP,
it's very good at synchronizes between databases
when ever there's internet these databases
will synchronize. To have call centers in
places with no internet at all because you
can hire a dedicated telephone line between
call centers and then it would be the second
call center responsibility to synchronize
to the Cloud. As colleague of mine says building
off line applications is basically building
distributor systems. So my advise is solve
real world problems, not software problems
and just replicate what you need. The second
problem you may find when working with off
line applications is conflicts between documents.
What do I mean? So, again, this is our remote
database, our contact tracer forms, imagine
for simplicity that they can only contact
the internet throughout the night. So the
night of day two they replicate the remote
database to the local phones and then day
three one of the contact tracers go to follow
up on the person. At might on day three there's
no internet for some reason. Day four the
other contract tracers go to follow up on
the person and again at night it synchronize,
this time it works. But, what pouch DB says,
okay guys I have one document and you both
have modified and I have no idea which one
of you is right. So couch DB feels like this
this is a conflict and it's for you to the
side what to do. It's fine, you can do that,
you don't need to do that if you have a proper
data model. What if you have your documents
structure in the a way that things are chained
together are together and things that change
separately are separated. For example we have
a document with personal information and one
document per each follow up. This way there's
never going to be conflicts the phones are
just creating new documents, and these documents
can be synchronized with pouch DB synchronization
directly without any customer logic. No logics
and also this skips a number of revisions.
Revisions is the different versions of the
documents. So less revisions means better
replication and less storage. So, chose your
data model wisely. And the last thing I want
to tell you about is data loss, this is like
the nightmare of every off line application.
We found for a different application that
was reduced people for a vac ‑‑ that
was used for a vaccination trial, we just
to to collect personal information and take
a picture and print a card and they're registered.
We realized some people have cards but they're
not in our database. The problem we figure
was that some of the phones were deleting
the information before replicating to pouch
DB and we discovered that index DB that is
the storage we use for the browser is temporary
storage, which is pretty bad. The way it works
in Chrome is this is your hard drive and this
is your available space, and Chrome can use
one third of it. And every single application
within Chrome can use up to 20 percent of
it. If you have a compute E. 500 Gigas, this
is quite a lot of space. But if you have a
phone, this is maybe not so much. What happens
when all the space that Chrome has available
gets used is that Chrome decides to delete
the entire data for the least recently used
one. So we throughout, okay, but we still
have a lot of space why would Chrome delete
our applicationr? Then we remembered oh, wait
this application is taking pictures and probably
nobody's deleting those pictures, I never
do. So we are shrinking the space available
on disk at some point replication didn't have ‑‑
was the less recently used and Chrome has
to wipe it off. So be careful with this. We
are investigating whether we can use another
storage. So, that was where our some of our
mistakes. We did more mistakes. We will do
more mistakes still. But, it was worth it
and it was a lot of fun. We discovered most
of the mistakes we did was because this was
state of the art tech so we didn't know so
much about it. It was new for us and it was
new for the internet too, not so many pause
in the stack flow, not 50 tutorials about
how to scale. So, yeah, we learned a lot in
the process. What I can recommend you if you
work with the state of the art technology
is get an expert. We were lucky as to have
one of the core developers of couch DB joining
us, he didn't arrive on time to present us
from doing all the mistakes, but helped us
fix it. He's laughing. And also don't forget
you have the community. All these are Open
Source projects and the people who are developing
them are var passionate about it. And if you
have an interesting project and you are pushing
the limits and if you're nice, of course,
remember to be nice, they will probably help
you. And you can help them, you can fix back
if you feel you can do it. Or you can add
the information on the internet ‑‑ they
don't need to keep repeating the same stuff
over and over. So I talk a lot about ‑‑
I talk a lot about deaths and sick people
and this is pretty sad topic, but I wanted
to finish with a little bit brighter note.
I'm going to show you the status of the Ebola
outbreak in West Africa. There is two new
cases last week in G oarynea which is good
compared to what happened before. No new case
in Sierra Leone there is hope for theout break
to end maybe and the Liberia and Nigeria the
outbreak has ended already. (Applause) I know
that our JavaScript application didn't finish
the outbreak, I like to think that whelped
and we saved some lives even if only a few.
And I can only recommend to work on a project
with impact ‑‑ however we shouldn't stop
here. Ebola was quite high sickness because
it's pretty terrible. But there are many other
sickness that nobody's caring so much about.
We're doing now some work in polio maybe we'll
deal with measles afterwards there is always
a lot of things you can do. You don't have
to just work in emergencies you can prepare
for when the emergencies arrive. As time magazine
said, when the next epidemic the world must
learn the lesson of this one, be better prepared,
less fearful, run toward the fire and put
it out together. Thank you. (Applause).
&amp;gt;&amp;gt; Thank you, Patricia. That was excellent.
I had the great privilege of being able to
work on this as well. I want was really a
very interesting and very cool to do. And
if you're in the tech scene and you desperately
want to disrupt something that's something
to disrupt. Don't help rich people do laundry,
help fight diseases. (Applause).
&amp;gt;&amp;gt; Okay, we have a few more minutes but not
quite enough to have a proper break, so I'll
just stand here and talk. I'd like to introduce
myself, I'm Alex, I'll be your host for the
afternoon. Yeah, Whoop ‑‑ thank you.
I said it once before ‑‑ three years
before was my first conference talk, it was
a lot like now just a lot more terrified.
What I really want to say is you can stand
up here too if you want. If you haven't ever
done a conference talk before, it's very well
within your reach. The Conf is open to speakers
and topics of just about any purrtion this
is literally and figuratively a space for
a broad range of topics and speakers. Yeah,
very much like to encourage you to submit
to the CFP for next year and speak at other
conferences. It's also an interesting opportunity
for your life and job, you get to meet a lot
of people, you get to travel as well. Travel
the world meet interesting people and lecture
them about garbage collection, if you will.
And, yeah, it's a great way to, you know,
further your career a bit. It's very easy
to convince people that you're an expert on
something if you have three video of conference
talks from all over the world with you talking
about that thing. So, yeah. Conferences need
speakers and speakers come from people like
you or literally me, and yeah, so please.
If you don't have any experience, go to a
local meet up, speak there, and, you know,
get used to the feeling. And then who knows
maybe they'll fly you here and give you a
great opportunity and great food and then
one day you'll be up here too. Yeah. So, oh,
God that was only two minutes, terrible, I
need to talk slower. Any way the next talk
is also, in a way interested in offline communications
but not really networking in a very, very
interesting way. There'll be extremely funky
live demos and ‑‑ Funky live demos () I
would like to wait until it's actually quarter
to so the people in the other room have time
to come by. We'll wait for three minutes and
then we'll start. See you in a bit.</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>