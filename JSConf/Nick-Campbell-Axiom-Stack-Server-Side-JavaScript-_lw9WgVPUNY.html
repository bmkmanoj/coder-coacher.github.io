<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Nick Campbell: Axiom Stack: Server Side JavaScript | Coder Coacher - Coaching Coders</title><meta content="Nick Campbell: Axiom Stack: Server Side JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Nick Campbell: Axiom Stack: Server Side JavaScript</b></h2><h5 class="post__date">2013-01-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_lw9WgVPUNY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Nick Campo
as Chris said and I work for axiom
software and my twitter handle is NC boy
those are zeros today I'm gonna talk
about Timmy I'm gonna tell you a story
also any design work you see in here
I'll freelance for you a wizard with
Microsoft Paint so feel free Timmy's a
developer and Timmy was told to write a
web application Timmy has to create
models in his database he found that his
schema was rigid and stiff and it was
hard to change and integrating search
proved to be a challenge Plus Timmy was
used to working with JavaScript and
switching tracks was kind of a pain to
him over time he became displeased with
his templates and the fact that it was
more just copy and paste he really
couldn't get away from the tag soup that
the current framework Slynt timmy was a
sad panda so the current situation or
the situation that was about when we
started developing axiom stack was that
you really had to know all of the
database schemas the properties fields
things like that that you wanted to
actually expose to to a web application
it became a challenge to modify those
schemas when the application actually
changed and when your requirements the
specs of a web application changed for
you know customer or client your own
also search became an interesting
challenge to integrate you know you had
to you had to deal with full-text
searching indexing correctly with
relational database systems and then
once you got there you had to also build
in stemming stop words things like that
that really give really give search
engines some power plus existing systems
required you to always context switch
you always had to go from JavaScript
which is interactive the web you know
this is what we all associate with the
web and then move to Ruby or Python you
know one of the systems that I was
working with was soap and so that
provided unique and interesting
situations when I was trying to switch
back and forth between the Python and
the interactive side which was the web
and then you specifically was open and
other frameworks that existed you got to
deal with tag soup
we're not the conventional thoughts of
you know putting in invalid HTML into
your template for the presentation layer
so when a user actually saw your page
the the page wasn't completely correct
in terms of the w3c I'm talking more on
the server side where you're putting in
actual business logic to your templates
you know this this doesn't lend itself
to reuse and and the fact that they're
so invasive makes it hard to maintain
later on so let's go back to Timmy
coworker Karin saw that Timmy was down
Timmy told her what was wrong he wanted
a web framework that could grow with the
project Timmy didn't want to have to
rebuild his databases every time he
needed to change a schema every time a
new field came up and he wished that
search were easy not only on the site
but also from within the code he wanted
separation of layers to be able to write
the code once and have less of it
Timmy realized that you know his heart
his code is hard enough to maintain and
he didn't want to mix it into his
templates so the current complications
so this current meaning now write data
sources the the current convention with
systems like rails and the Django is
when you change your schemas when you
change the fields that you have you need
to migrate your database and so then
you're you are required to go out and
run scripts to to fix up your database
and that can be although it's relatively
easy write their scripts that are done
for you
over time you lose a decent amount of
time having to go back and update those
the tables and the databases and run
these scripts and you should be able to
expect more from your data source you
know you should you should be able to
expect that you get high power search
functionality out of the box with
existing systems like like rails and
Django they they tell you to use a peon
or Sphinx to integrate search with your
application and it
in well at least in our opinion that
should be a part of the application
framework the framework that you're
using should be simple and you should be
able to use the same data structures and
the same object structure that you're
using in the interactive web with the
with the backend right instead now
you're required to bring in external
libraries - for Python or PHP to
actually expose the data externally and
you should really be separating
separating your business logic from your
presentation layer the you basically
want to leave your tag soup at the table
right you don't want to bring the the
business logic into your code because it
as Timmy found out doesn't lend itself
to reusability and the maintainability
becomes a problem
so Karen smiled she she said I have a I
have a solution Karen showed Timmy axiom
stack Karen explained that axiom stack
is a web application framework for
server-side javascript in axiom your
models are called prototypes and your
schema is dynamic as soon as the data is
saved it's searchable within leucemia
you can use the Search API to access
your objects and because it uses the
Rhino engine you can write JavaScript
all the time and one of my co-workers
said yesterday that this is probably the
only conference that I would get away
saying that Karen also showed Timmy that
templates were a snap with only a few
attributes you can keep the logic out of
your templates
and in the JavaScript functions where
they belong so here's our resolution
this is a thousand foot view of the
axiom architecture right our web app web
server technology is jetty and what we
do is allow you to build prototypes the
prototypes are made up of security
functions templates and a schema and the
backend technology by default is leucine
but you know we know that there's
necessity for having legacy systems
right everybody has legacy data so if
you already have data in a my sequel
database you know Oracle that sort of
thing then you have that accessible to
you and we're also working with the
folks at 10gen to integrate the MongoDB
as well and I'll get to that in a second
basically with leucine being our
back-end data system we get a really
high power search and all the features
of their indexing system to create these
dynamic schemas because they're a schema
less document system much in the same
way that the CouchDB system is although
the feature sets are very different but
but the premise is there and the the
thing that's nice about that is that you
get the ability to grow your application
as the requirements change for that
application with with the relational
system you there's always a need for a
relational database right right now
you've got specific functionality such
as accounting and the functions that
exist within those
databases that make accessing your
information very fast and providing you
with really fast analysis on the data
itself so what we're looking at with
Mongo is the fact that they try they're
trying to take the features from the
scenes such as the schema list documents
and the features from the databases that
are good and combine them together
and so that's the purpose for Mongo
Search I touched on this a little bit
but the way that search works is that
all the data is stored in Reverse index
in Lucene and what we've done is
basically exposed an API which we call
the query API to get at your objects and
by objects I mean the the documents
based on the prototypes that you built
before and this query API works both
with the scene and the relational model
and and so on but basically all you do
is tell it you tell the query API which
prototypes you want to get back and you
pass in a JSON and detailing the field
and the the actual terms you want to
search for and you get your data back so
you can then display things like
navigation search results and all of
that all you know in a single function
all very fast and you can focus your
efforts in JavaScript you can basically
write JavaScript all day long you get
access to the JVM through rhino and
and then so if you've built if you've
built jars or Java libraries that have
that have specific functionality that
are necessity necessities for you for
instance we've were working on an
application right now that uses the
Amazon Web Services Flickr and a few
other external services we can basically
use the Java API with the same Java con
or the Java Script constructs all from
within the JavaScript functions and then
the the templating system we use is a
system that we came up with we weren't
really happy with the DT ml that we were
working with and if anyone's familiar
with it would probably understand why
it's completely intrusive it's not easy
to read and so what we did is expanded
upon the the new templating system the
soap was coming up with called tail and
called tip or they called it towel and
we're calling it tail which is tau
enhancements or extended basically and
so what we do is with a few simple
attributes two-year elements allow you
to create all the functionality that you
need to display anything in the
presentation layer that you would need
but not be intrusive to your code or not
be overly intrusive to your code as the
as the other systems that I've worked
with are and the all the attributes that
you add in are removed before it goes
out to the user in the in the web page
so if you're viewing source you wouldn't
see any of these attributes and then
these templates are reusable as well you
can basically pull in pull in other
templates through
a system similar to including templates
so that you can basically write your
template once and reuse it in multiple
places so back to Timmy Timmy began to
smile when Karen enlightened him to this
Timmy went on to do great things with
axiom stack and Timmy was happy so I
appreciate you coming out if you have
any questions for me I can answer them
now and I'm planning on doing a thing
tomorrow in the track B portion on on
server side Jess show you some code and
that sort of thing so anyone have any
questions
instead of using what you are there's
I'm actually not familiar with it but
the reason we use the reason we went
with Tao is because there when we were
first coming up with the templates we
were basically trying to create a system
that fit our notion of HTML which was
you know the stricter h missed XHTML and
and then make it so that it was as
simple as possible to to modify the the
actual templates to get your
functionality to happen but keep the
keep the ability to go overboard out
because that's that's generally what
happens right now right with templates
you you have the ability to go away
above and beyond what what you may mean
to when you are first creating them and
and so we basically nailed down the
necessary directives you know you can
repeat over an array you can iterate
over an array you can push content into
an element so creating child text nodes
and things like that but it really
creates that separation of the business
logic and the actual presentation layer
we actually didn't do extensions to
towel we rewrote the parser in
JavaScript and then and initially we had
the implementation called towel that we
basically we weren't huge fans of it and
moved to this enhanced version which
which does the specific things that we
need so by that I mean we can basically
run JavaScript functions we can you know
you can do API calls things like that
from within the within the attributes
and our original implementation didn't
support that so it was basically
anything that was passed in the scope
was available to you now anything that
isn't within the scope can still be
accessible to you you just need to call
the API is that you created
not yet but yet it's a keyword
I'd love to enhance this to basically
get it going into into other areas that
we haven't touched yet and you know
benchmark them see how does the Rhino
implementation perform against spider
monkey and that sort of thing
more easily
it's the it's the same normal Ajax that
you'd normally write I think you might
be referring more to the way that jax-ur
does it correct if I'm not mistaken
that's similar to their model and the
way that we're doing it is your
functions are the actions
so with those prototypes that I was
talking about you would create your
JavaScript functions inside of
JavaScript files those JavaScript files
then get loaded on to the prototypes and
are available to to both use from the
code side and then they become available
as functions or actions that you can hit
from a URL so for instance if I had a
home page at slash and off of that home
page I had a function called hello world
I can access that function directly from
from the web and so that's how you would
do the Ajax as well basically if you
wanted to return a JSON or XML and I'm
actually going to talk about XML in a
minute I kind of forgot that but if you
wanted to do JSON then you just return a
JSON and it would go into your
JavaScript on the client side and
assuming you set up the mime types and
whatnot correctly with the library are
using their it would parse correctly now
getting back to XML one thing I sort of
left out because it's not so much a
feature of the of axiom but it's a
feature of rhino is efore X and that's
basically XML as a JavaScript object so
what you get is the ability to drill
down into XML objects using a it's it's
sort of a cross between JavaScript and
XPath syntax
although you're not using slashes you're
using dots and things like that but you
basically get you get the ability to
manipulate your XML from the server side
and then return that and it'll be
serialized as it goes back out thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>