<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[JSConfUS 2013] Stephen Bannasch: A JavaScript framework for computational simulations | Coder Coacher - Coaching Coders</title><meta content="[JSConfUS 2013] Stephen Bannasch: A JavaScript framework for computational simulations - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[JSConfUS 2013] Stephen Bannasch: A JavaScript framework for computational simulations</b></h2><h5 class="post__date">2013-10-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/G5hu1x9z5V8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">and we're a non-profit tax-exempt our
focus is developing and adapting
technology so that all sorts of
different kinds of learners learners in
k-12 learners and university and
learners and makers in informal
education or just people who want to
investigate things can do a lot more
investigation inquiry experimentation
collaboration and communication sort of
in science and technology and
engineering what i'm here to show you
today is the framework that we've been
working on about a year and a half ago
we got a grant from the google
foundation to take a lot of the work
that we had done in java and redevelop
it to work in a browser we've been
wanting to move in that direction for a
while but the great deal of our funding
comes from National Science Foundation
grants and they're interested in
research and we develop technology with
those grants but it's very hard to
actually make it robust and useful so
I'm talking about something I needed to
pick a short name because I was going to
type it a lot so the project is called
lab and we're doing basically
html5-based scientific modelling
visualization graphing and probe where
this presentation is up in a github
repository so you can find it later the
slide at the end will show you where
that is we've designed the framework to
support multiple different kinds of
modeling engines some and I'm using the
word modeling a little bit widely the
biggest one the one with the most number
of features we call em d 2 d it's a
translation of a java application called
molecular workbench that does a lot of
2d molecular modeling there are some
other model types in progress one is for
a solar system and we're going to be
having some simple climate models in
there another is a signal generator and
another is for working with probe where
so I did not adjust this for the size of
the screen this is a a model that runs
it's basically a two-dimensional
simulation of
is it interesting I'm not getting it
running so we are going to quickly
we'll go to the production site and run
it there so there's a lot of calculation
going on here there are two different
kinds of two-dimensional molecules these
are uncharged these are charged we were
calculating the lennard-jones attraction
between all of these for all of them
those are relatively short range we're
also calculating the attraction due to
the Coulomb forces which are charged
forces those are longer range the way
this works is you're generally going to
see clumping among these molecules and
clumping among those and they don't mix
very well and if you mix them they will
um you know they will end up separating
again so i'm going to move through this
is in the presentation and it'll make
sure it's working there later embeddable
so this is a basically a relatively
simple model where we can adjust the we
can play God we can adjust the van der
Waals attraction we adjust it strongly
it forms sort of a hexagon zagging will
shape we loosen it and they start moving
all over we can change the temperature
and up one of the things that you could
pretty easily experiment with this is if
we change the temperature to here and we
turn on charge well you can take a look
at how hot do we have to get this to get
the molecules to move from a solid state
to a liquid state so I'm going to
increase the temperature here and what
would you call it it's sort of moving to
the liquid state there well that's
probably a liquid state we have to get
quite hot well if we're not using the
molecules aren't polarized and we'll
leave the van der Waals attraction the
same lower the temperature well that's
obviously a solid
let's make a little hotter a little
hotter we're moving into a liquid domain
at a much lower temperature see we've
got different kinds of even in the
molecular 2d dynamics we've got
something for investigating protein
folding and we can set up different
kinds of proteins now it's not real
protein folding but we actually are
doing a lot of modeling here to figure
out what lines up with what and here
you've got a collection of hydrophobic
and hydrophilic and things we could
change the solvent type will change it
to oil and when there's going to be a
different kind of attraction a different
kind of rearrangement of what's on the
inside and what's on the outside I'm
gonna one of the things so here we got
that one one of the things we can also
do with the molecular dynamics engine is
actually use macroscopic units this
particular model and again and having
trouble getting it working one of the
things in any of these models when
they're embedded you can actually click
the share link and you're going to get
the iframe code actually that's not
going to work so I'll just click on this
link which gives me the embeddable code
the embeddable zar designed these
Interactive's they're designed to
fluidly scale to whatever container you
put them in so obviously at some point
it's going to get too small to read but
we can see it here when we run this one
we're instead of using the units in the
molecular dynamics 2d where which would
be femtoseconds and nanometers or using
MKS units and this is a for the
molecular dynamics engine this is a very
simple model it's a pendulum and a
spring so it's a springy pendulum and
you can see all sorts of strange things
we can change the rod length in
centimeters and run that again we could
change gravity we could change the mass
of the ball the spring constant we can
do all of those things to do
investigations these graphs over here
are standard part of what we call
Interactive's which we'll be talking a
little I'll talk a little bit more
everything is sort of very nicely
scalable so since I don't know why it's
not running here but tends to move
forward that was the protein folding one
let's just we've also got one which is
modeling DNA transcription and
translation so this is combining some
animation steps with actually some
modeling steps also all of this code is
open source under attribution only
licenses so it's there for anybody to
use
and so on and so on the engine
underneath this can use all sorts of
different forms of these kinds of models
moving to another one this is one that
we've just started working on its
quantum collision the 2d molecular
dynamics model was not dealing with the
energy associated with an atom when the
electrons are moving from state to state
so this is the beginning of that we
start this model like that and nothing
special is happening let me change it
reset it back to the beginning I'm going
to change the starting velocity and
right now we're moving back and forth
and there's energy changes one of the
things you can do is you can run the
model backwards and forwards you can see
the graph is going backwards and we can
examine different points that's
available in all the models so here's
another model and the new quantum
dynamics plug in this is going to allow
us to actually we're starting to
visualize photons leaving this is one is
also an early development this is for to
help kids understand about seasons it's
just the beginning but it's using a
similar particle type engine but it's a
different model type and basically it
says particles with mass and
gravitational field and we're going to
be adding a climate a simple latitude
based climate model to that so kids can
investigate basically at different kinds
of tilt in different kinds of orbits one
of the things you can do here is you can
let's change it back to will change it
to an oblique orbit one of the things we
wanted kids to do is to investigate what
is the relationship of tilt of the
planet two seasons and how does that
relate to how far away we are from the
Sun and the northern hemisphere were
closer to the Sun in the winter most
kids would think we're further
because it's quite reasonable to think
it's warmer because we're closer to the
Sun so here's a simple model where earth
goes farther away so i'm not going to
signal generator model type was a way of
generating streaming data but it was
really designed to support this model
type which works with sensors I've got a
commercial device here from a company
named premier Adam right now the
connection to this is with an invisible
Java applet via the software from
vernier their sdk is completely public
domain so while getting things to work
with java applets and maintaining java
applets is quite difficult Richard would
you come up and help bring your computer
too because I'm going to be changing to
talk over to you so this is an
ultrasonic sensor i just plugged it in
and started out the browser it's a
browser which has java applets enabled
and it's all we know it's getting harder
and harder to maintain like security
with java applets but see can we start
this and we don't seem to be getting the
java applet working hold on yes so one
of the things i will mention so
yesterday in the node BOTS workshop I
did probably the smallest node bought
there that there's really not much here
I called a little bot but what I did was
turn this Arduino into something it it
turned itself into a joystick and I had
some simple pot and linear some analog
inputs and once I did turn it into a
joystick I could get data in using the
gamepad API so I'd really like to have
all sorts of people be able to measure
things more easily and if you can turn
arduino 'he's into sensing devices and
hang them pretend to be a gamepad you
can get analog data into your computer
into your browser without any extensions
or or any java
so I'm not sure why that's not working
one of the things i would do really
quickly let's quit that
I reloaded the page once more
okay so i actually it I think I know
what the problem is I'm going to do it
quick going to the development site i
think i forgot to rebuild the java
resources on the production site
yes it's downloading now okay so i
should be able to run it so Richards
moving further away I'm getting distance
data and I'm of course with a sonar
Ranger we have that kind of a thing but
we can get all sorts of data now we're
it's going to timeout because it only
goes to about 10 meters but we're
getting that data over here so you can
find this presentation later online on
my github account steven eb github.com /
steven eb you'll find Jas comp 2013
that's the part of the name and you can
find this all later i'm going to show
you just a bit about what do I mean by
an interactive so one of the things some
when we're developing models like this
it's different than the form that's
often used in many web applications
we've got this particular model here
we've got a set of JSON for defining how
it works it's referring to a model it's
referring to various components this
particular one has very simple it just
has a button component at a very simple
layout I'm going to jump to something
which has a more complex system here so
this was that pendulum inter actually
it's just a pendulum on not the springy
pendulum I'm going to go down to the
interactive and show you so I'm still
referencing a model I'm also saying
there's some options for the model I'm
changing the unit scheme to MKS and I'm
sending what the time step / stick is
I'm deciding what's going to happen on
load I'm going to reset various things
and I'm doing things like resetting an
angle well what's unusual here is weird
of synthesizing outputs and parameters
for this so in the molecular model there
isn't any
output called current angle but we're
synthesizing it we can then use that
later in our components so we have a
slider which is attached to the property
you know gravity but here let's just
take a look so we got a graph component
here and we're basically saying the
property we're graphing is current angle
so there's a lot of headroom in this
kind of architecture for developing
various kinds of ways that things are
wired up so when we look at this and one
of the edible own this is a molecular
model but we're running it in a MKS unit
system these components are all
listening to properties and our
modifying properties of the model the
properties are also being sent to the
graph these are synthesized properties
when we run them I'm going to let
Richard plug in for a bit because he's
got a short presentation on how these
kinds of property the modeling is
different grab that I will pick up this
computer go while he's getting onto the
screen I'm going to mention one other
thing you should have this that we
wanted to show if we have time
ok so i like to say we sorry
so I'd like to say we allow these
Interactive's to let students sort of
fork and really anyone really learning
something sort of fork history and
that's a model and so there's actually
we took a bunch of inspiration from
JavaScript MVC frameworks that exist in
a slightly different domain for thinking
about how to do that so Steven talked
about this um this pendulum interactive
which is actually pretty cool because we
have all these different things you can
explore to see what happens no what if i
change the links does that change the
period of the of the pendulum or not and
i can try to find out for myself well if
i go back in time and I've played with
the parameters a little bit and as well
I can play God I can adjust the gravity
makes a gravity bigger see if that
affects a period oh maybe it doesn't and
but I may want to go back in time back
where i was before gravity changed see
the old parameters that i had and then
adjust pick some other one and adjust it
and so we think of that as sort of
forking the history of this this model
and in order to do that we took a bit of
inspiration from MVC frameworks this is
your sort of canonical example from like
ember which is you know this says okay
here's my something object which has a
full name property and you know i have
two other properties called first name
and last name that are real properties
on this model and I want my UI to update
when you know the first name changes I
want the full name to update and I want
the UI to automatically update and so
that's what that handlebars template is
doing well okay fine well we don't
exactly care like about your name or how
many followers you have I mean those are
great things but we really care about
like physics and time and we have these
um we have these need Interactive's that
have these these properties that are
associated with the model and we want
the UI to update automatically with
those as well so in order to do that we
use this property system I'm talking
about so we have we have automatic do I
binding is a more difficult problem in
this case so here's an example i have a
gravitational field technically by the
way if you're too actually
work this out the physics this is like
the gravitational field on a neutron
star because it doesn't pull down
molecules like that fast but I want to
update the potential energy as the
things move around okay fine but the
potential energy is actually like the
energy between every two of those things
in the model and the interaction of each
like object in the model with the
gravitational fields it's a whole bunch
of computation that has to happen to
update that well what's actually need is
if I update the gravitational field
value even while the model is running
the potential energy is automatically
updated and so how do we do that and so
whatever method we use and this is sort
of how you would do it programmatically
bump up the bump up the gravitational
field we have to immediately update the
potential energy but there's no easy way
to say what is what is the relationship
between the output and the input we
actually have to recompute a whole bunch
of stuff so in order to do that we have
this concept called invalidation so if
we think about it in a sort of
programmatic way of doing some of the
stuff I was just showing you is we could
step the model forward 100 steps it's
like 100 ticks or 100 animation frames
and we can seek back to 50 well what
will happen is we'll update the we'll
update the UI using like saved state
because we're actually like saving like
a tape recorder of everything that
happened in the past then we can step
forward now we're on step 51 well okay
all we need to do is like replay the
stuff that saved in history but now
let's say we change the gravitational
field to twice what it was well now step
52 is got to be different then step 52
was before so we have to know that we
have to we can't just retrieve it from
memory we got to recalculate everything
so we have this concept of the
invalidation event and what's pretty
neat about that is that's a really
general way of thinking about how to
update mbc type properties so any change
to a model property invalidates it
forces recalculation of all the
properties and since we just you're just
in a physics model you just can't
predict what all the relationships will
be it triggers notification so you have
nice UI binding
and as we just saw it sort of is smart
enough to discard the future history
that you are no longer going to see we
have this idea of moving in time which
is which is kind of fundamental to these
models and something I think that's
interestingly different from a sort of
standard web app so you can they
progress in time and so when you move on
in time we sort of assume everything is
going to change so we just notify
everything and the last thing is this
these properties give you this neat idea
of parameters so parameters is soon UI
stuff you saw me manipulating in the in
the pendulum demo their properties too
and they just all they do is trigger an
action it can be a real ugly action to
make the model state somehow like match
their value like by updating the
gravitational field it'll make things
act as if the gravitational field this
is larger and so here's a really simple
model it's showing like this piston is
pushing in and these these molecules are
bouncing around well what if i add a
whole bunch of atoms i can just move
that slider and suddenly any ugly old
color i want that makes more atoms show
up we'll make actually make more answer
up and you'll see you'll bump up the
volume of the thing well if I go back in
time or if i do that i just took away a
whole bunch of atoms but let's say i
move backwards well i got on my a nose
back and I can play forward what I did
so if I actually really liked having 60
items and something really interesting
what's happening here I could I could
show that and so I just think it's a
neat a different way of thinking about
what web app properties are like and I
think it may have some applicability to
sort of games and simulations and a lot
of applications will see for javascript
in the future anyway that's it can you
bring up energy
so I was at the google Summer of Code
mentors conference last fall and I was
talking about some of this stuff and
these were people who came to a
presentation on how he can do very fast
computational simulation in the browser
and I realized after I showed them some
of this stuff and I told them what I was
doing almost half of them didn't
actually get what I was saying they
still thought it was happening in some
extension or plug-in or Java because
they really didn't understand how fast
you can do things in a browser there's
lots of great performance in a browser
I'm right now going to be showing
something here I'll just pick my
favorite one this is different this is
not yet internet connected SI as an
interactive but it is a model we want to
this is a fluid dynamics model we've got
a hundred by hundred cells here we're
doing convection conduction in a simple
form of radiation there's no radiation
in this model this is showing velocity
one velocity to velocity five and
velocity ten that what you're seeing
down here as turbulence is really the
tribulus associated with the kinematic
viscosity changes at the different
velocities there's a lot of calculation
going on in there we don't have time to
show it but last summer at the end of
the google Summer of Code work I was
doing with Pio Janek here e implemented
the physics solvers in here in WebGL we
were seeing speedups between four and
twenty times so if anyone has been doing
scientific computation this is all
happening right now in javascript in the
browser I just wanted to want everyone
to be inspired about what you could do
actually with this kind of scientific
processing this kind of capacity so
we're probably about one minute left
maybe there's some questions while we
pull off our computers any questions
what sort of what well this particular
one it's basic fluid dynamics its
relative that's why it was easy to
relatively easy to port into WebGL
because it can work in a sort of a
parallel fashion the if you go to lab
concord org there's a
section on energy to D and there's a
whole bunch of stuff with a pointer to
an article in our newsletter by p 0
about how he did the WebGL conversion
but all the code is there there's
there's a developer email list so you
know if you go to lab concord org you'll
find links to the repository links to
the developer email list and I'd be glad
to follow up if anyone's interested I
think that's probably the end of our
time if people have more questions I'm
Steve and banish Richard clan sir find
us milling around and talk to us we'd
love to have anybody add more model
types work with you to make this work
for more frameworks or more models thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>