<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>István Szmozsánszky &quot;Flaki&quot;: Honey, I Shrunk The Scripts — The Secret Life Of ... - JSConf.Asia 2018 | Coder Coacher - Coaching Coders</title><meta content="István Szmozsánszky &quot;Flaki&quot;: Honey, I Shrunk The Scripts — The Secret Life Of ... - JSConf.Asia 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>István Szmozsánszky &quot;Flaki&quot;: Honey, I Shrunk The Scripts — The Secret Life Of ... - JSConf.Asia 2018</b></h2><h5 class="post__date">2018-02-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8n4jCTbvYwI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">there's a very re so today Thomas
inception or Thomas section whatever you
might go to a conference in sumption
this my dear friend Bella who you can
see co-presenting right next to me I
made you a key mistake on my last
conference to forget my co-presenter I'm
never gonna make that mistake again
so yeah you're gonna be talking about
JavaScript or hardware or you could also
put it all these gadgets
I'm estimates moshansky you can reach me
in twitter at SL Softworks if you really
want to and I'm I'm always asked what do
you really do and I was like yeah I'm a
JavaScript developer also you program I
was like no not really I kind of write
emails like 24/7 but yeah because I do a
lot of community management conferences
I'm a missile text because this is the
big blue t-shirt and colorful heart
which is which one of the reasons why
I'm put on this stage and many other
stages as well and we're gonna be
talking about the decimal in a short
while so that's not who knows this dear
person right here
although will help this is 2009 I just
hands up if anybody all right
there's at least one this darling is
ryan doll and this is Jay's Kampf EU
2009 where no GS was presented for the
very first time noches zero point one
point 17 if I'm not mistaken something
like that they were waiting the big 0
put do version to command and why are we
starting window Jess and in a JavaScript
a microcontroller or Hardware talk well
you know the there's a lot that
influenced were the hardware communities
and the JavaScript and web hardware
community is that currently but the main
influence was mostly nodejs because when
no just came out it the browser and this
javascript language lost its shackles
its freed from its shackles being only a
thing in the browser
no jesus brought it to your computer's
common line brought it to your servers
and eventually to your hardware devices
and i wrote this article you know
shameless plug here javascript world
domination and has anybody read this one
gee i have less happy than then I not
seeing hands on Ryan the ha face anyway
it turned out to be a really long lead
and even this already haven't really
mentioned Harvard that much this was two
and a half years ago maybe but even then
like the writing was on the ball because
you can already see the emerging act
echo system around you know IOT smart
devices and all that so it's it's due to
an update because a lot of things have
happened since then because JavaScript
has finally arrived to the hardware and
what I'm saying you know JavaScript
arrived on the hardware but first we are
going to be talking about is really no
BOTS so note about is really hardware
plus no GS we took smells like node
robotics but no chairs and so there is a
trick here actually javascript is not
really on the heart verb and you know
talking about
nodebots there are a few ways to do this
but the number one ways to do this is
johnny-five which is a library you could
install for your new GS install under
nodejs it's an NPM package you install
it as a usual and you can use your node
script to control a device to control a
hardware device from inside your node.js
JavaScript code but your code is
actually not run on the device itself
the code runs on your computer and the
commands are transferred to the device
itself still it's not bad I mean it got
you some node boats not just some node
BOTS got you some node quadrocopters
which is pretty cool from something
that's not running on the hardware right
and 2014 there was this conference in
jail scoff in the US and they were like
we already have all the node robots and
and Volkers and boats and there is one
thing we don't have yeah that is right
what you see here is in a rocket well
there is no need to see other the fire
agency just yet
this was pressure using pressurized
water to launch rockets in kiddie air
but I mean it is a rocket right it
blasts often it flies it's a rocket it's
it's good enough so how did they
accomplish this is something called node
serial port was insurmountable which
basically lets you connect no GS with an
Arduino device or a any other hardware
device when you did that what you did is
you had your node.js and you're running
on your computer and you've installed
the node 0 port library which then went
on and you could write your code in your
node.js application you connected in
some way in one way or another
the microcontroller you wanted to
control and the natural port library
used to send your commands to this other
device using something like a Fermata
command for mother is basically a
protocol that you're gonna be using to
give comments to other devices so you
have your micro controller you have
Fermanagh connecting the two you have
another computer that's translating your
JavaScript code that you wrote for
nodejs into this platform our protocol
and sends your commands 2d 2d 2d
hardware device by the way these
pictures are taken from the wonderful
babbling mid merfolk talk by sis Hinton
or Nootka most people usually know her
lately from her twitch streaming
open-source development she's amazing
and you should definitely watch this
talk because it's amazing for an
introduction to hard I think to date
this is probably one of the best ones if
you never brought a work with hardware
it has all what you want cute animals
and interesting technical bits told very
well so if you want to get into and what
you get no more about Arduinos and
firmata
you're gonna be starting here there's
going to be a lot a bunch of links at
the end of this presentation you can
find it there so here's the thing
like I said these devices were really
running JavaScript on the harbor so what
you really wanted to have something a
device that runs JavaScript on the
hardware itself you know debry like it
said writing was on the wall everybody
wanted to code easily hardware devices
on in their favorite language so the
castle I mentioned before this is a
microcontroller that actually brought me
into programming hardware in the first
place
it had a crowdfunding campaign roughly
three years ago you can see 2015 January
I was a time oh it's almost exactly it's
gonna be in January 27 nice that I
presented the very first time at
Budapest Jas in Hungary about Harvard
and JavaScript in the first place
because the test song was a
microcontroller that was running
JavaScript which is a bit of a stretch
but it was running your code on the
hardware itself and then just sending
comments to the hardware what I'm saying
that this that this is a bit of a
stretch is I always have one image in
any member of my presentation that is
just not loading so my dear friend John
Mackay who is not going to be presented
on stage here has a very excellent talk
he is the founder of the project he is a
founder of the project that the tassel
he created the tassel project and he was
a initially a part of a team a start of
team who created the original tassel and
he had a very great talk about the
perils of running nodejs
on a microcontroller because that's what
they tried to do so what the test I'll
try to do is they try to put nodejs onto
the microcontroller that was this low
power device but how they accomplish
that is actually they use Lua who here
knows who not do is alright at least
there is a few people Solo is very
similar language in terms of complexity
to JavaScript for the average you know
person looking at the cue languages one
might even confuse it to Lua is that
explicitly made for embedding and
scripting a bunch of like World of
Warcraft is scripted in Lua for example
under a fantasy consoles used in law the
languages have very similar types and in
general very similar to each other so
they decided to create a compiler that
compiles your code from javascript to
Lua and
Lua on the actual device itself so it
still your code running on the device
itself but it's transformed to something
that the device could run later could
run itself we're gonna be talking about
bit more about this later why is that a
good idea and if you watched John's
video he will tell you why is that a
terrible idea the number one is the node
ecosystem itself NPM itself needs a lot
of breeds a lot of compatibility issue
especially when you're trying to cater
for it and JavaScript itself is not as
easy as it seems and not as easy to
compile to Lua as it seems and a bunch
of other things if you are thinking of
doing a hardware startup ever or just
this chart up in general he has very
good takeaways from the whole startup
thing as well so as as I said you will
find the link later on the slides and
the presentations so ok running nodejs a
microcontroller might not be a good idea
maybe let's try just running playing
JavaScript and this is what the Espino
is gonna be May making it possible for
us so what you see here is the s Perino
picker from all these gadgets I forgot
to bring my Ashbury nose so you'll have
to believe me that it's about the size
of a table drive and this actually runs
proper JavaScript on the device itself
even better it was created by a educator
in the UK called Gordon and what good
Gordon did you know there are a bunch of
educators in the UK you kind of find
them quite often so what Gordon did is
hey I had this idea I wanted to make
hardware accessible to people but he
actually went all the way he didn't just
make the hardware accessible in the
programming language accessible but what
he did is he actually
created a web IDE for the thing and made
it easy to program the device so you
just plugged your a Pico in you just
launched you can install a web from the
Chrome Web Store this this application
that would later connect to your Xperia
because these days you can just run this
web app from the from a URL itself
there's a Web API called web serial port
and web Bluetooth that lets you program
your hardware devices without installing
any extra plug-in or application itself
so he was like I'm not just gonna make
it the programming itself easier by
making this thing in JavaScript I'm
gonna make the whole experience better
so if you're ever doing something with
hardware think about this and tehsil was
was I was working a lot on making this
work with DITA so the first decide the
second tehsil the developer experience
and user experience where the user is
currently the developer make it better
and make it worthwhile so they even came
out with a new device lately that's the
purchase that's also super tiny and that
doesn't even require any wired
connection so you don't have to plug it
in anywhere it will just use bluetooth
and and the thing called that Bluetooth
which hasn't gonna be demoing you in a
short while if we still have time for it
so what's the interesting in the India
screener so how they did it so the S
Perino actually runs your JavaScript
code on the device even more so it
actually transfers the whole source code
onto the device and runs your JavaScript
code by interpreting it from out of the
source there are a lot of reasons might
doesn't convert to an est ast or si and
I think like that you'll find that on
the Esprit no explanation page but where
is more important and more interesting
is what are the implications of running
JavaScript from the source on a tiny
controller now these are a few megahertz
that the processors in these devices are
few megahertz and the memories of these
devices are few kilobytes the flash
program usually doesn't exceed a few
tenths or a few hundreds of kilobytes so
you're very resource constrained when
you are running your code on such a
resource-constrained device from the
source what happens is you're gonna be
interpreting and reading back the
JavaScript code from the source so what
that means and what that effect usually
results in how you flash a lad LED is
basically you turn it on you wait a
little and then you turn it off you can
even control the intensity of the light
by very fast turning it on and off again
this is called pulse width modulation
basically on these devices the very
white space that you live in your code
affect how fast your code will run so if
you're gonna leave a bunch of spaces
like you can see on the bottom in your
source code the microcontroller has to
read the bytes to be able to import
interpret your code so the
microcontroller will execute your code
slower than it would be if you would
have ditched the white space and this is
the implication of you know reading the
source code and executing it on the fly
which is you know we have been grown to
use a lot of like JIT compilers and a
cone running from a sts but this was the
olden days this was how JavaScript
originally I think almost 25 years ago
or 20 years ago it was conceived it was
interpreted and we tend to forget that
because it just got so much faster these
days and you are gonna say you know yeah
so what so there is this quirky
microcontroller that do is there's silly
things because of its tiny brains what
do I a bad developer have to do with all
of this and the problem is have you ever
heard of the function inlining
practices practiced by nodejs or
attention more specifically so what it
does modest fingers and I heard this at
my very first conference two or three
years or almost three years ago my very
first international conference I was
blown away because apparently the v8
engine which is used in node.js but also
in Chrome in a earlier iteration in its
turbo and it's a crankshaft compiler
what it did it chose to inline some
functions in lining a function means you
you inline some code in a place when you
compile it and choose to do that based
on the source code for a size of the
function so the problem is when you have
a function that has a has some comments
in it they count into the source code so
the this there is a blog post on this
you can read it so what it basically
resulted in you had your function if it
was changed by a tiny bit even though it
was change only in the comments and it
grew over the 600 character 600 byte
size note stopped inlining that function
and your code will run much slower so
you can see there could be a factor of
key difference between the two runs and
you know I was like oh this is crazy
I wonder if this still exists so I have
a very good fan working on the VA team
Benedict who I was hey how is this thing
is this fixed by now you know it's been
almost three years ago he was like yeah
it was fixed by you know switching out
the crankshaft compiler to the new
turbofan one and I was there is a good
presentation at Jazz Congress about
what's new in in turbofan it's a it it's
very good and it's used in nodejs
version eight which is a LTS version of
no GS so if you are no date on and on
the latest chrome you will be using
turbofan and crank
is deprecated and being removed but even
then turbo Fang doesn't care about the
source size so your comments doesn't
matter but there are of course still
limits like the bytecode size of your
code so the performance value of your
code is still limited by the code size
or the size of your functions even in
turbofan now I'm not saying everybody
should micro queue - and I'm not saying
everybody should you know know de very
intricate internals of the older
JavaScript engines and all their
optimizations on contrary justice
Benedict mourns in his talk I'm warning
you as well to not do that I'm just
saying that it doesn't hurt you know all
of these things and be aware it makes
you better programmer even if you're not
you know playing video hobby electronics
in the first place so we have talked
talked about v8 but there is a thing
called v7 it sounds like a very good pun
but it isn't actually a JavaScript
engine aimed at microcontrollers it was
created by Santa for the microcontroller
platform and it's a company created by
ex Googlers in Ireland so they know
they're their things and they created a
is a meta JavaScript engine that could
be put onto the very small brains of a
microcontroller it's you know it's 40 to
100 kilobytes in size like the compile
size like in comparison
I think v8 has multiple tens of
megabytes these days and even uses even
more even less memory like orders of
magnitude less memory than a v8 does and
it's es 5.1 component which is you know
very hard to tell about all the other
engines yes purino is getting there but
ver initially they had very poor
standard support and it has reasons so
well v8 not a J's engine it it not is
but it more like was it was deprecated a
few months ago
in favor of MJS and what they did it's
Assunta that said 40 to 40 to 120
kilobytes that's still too big we have
to go smaller so what they did is they
created MJS which is a restricted
JavaScript engine you could say it's a
JavaScript chops an engine because when
you are gonna go like to below the tens
of kilobytes you're gonna say hey we're
gonna get rid of some some features and
when you're doing this on the web you
cannot really break the web right so
you're not allowed to do that on the web
but alone when you're programming
microcontrollers which the primary
concerns of our you know downloading and
pinging server data and J salts and you
know connecting to other devices by IO
ports they don't really need a regular
expression support or for example unique
full Unicode support what they need is
long lifetime long battery life and easy
programmability modules is interfacing
with the with the underlying system so
they made this restrictions part of the
language itself and it gets closed its
25 kilobytes even the smallest or dinos
are equipped with 30 kilobytes of RAM
which doesn't leave you a lot of space
to put your actual programs on but you
know it gets close and we'll happily
live on a bunch of other a bunch of
devices there was one very large company
who tried to do this and create a
JavaScript soft set language that
pictures from the Samsung open the
Samsung's presentation from 2014 at the
tc39 which is the group that cares about
the improvements of the JavaScript
language and I expect my spirit language
they presented hey we want to do a
JavaScript
subset language officially and they got
a huge backlash because everybody's told
it was not it's not okay to do it cannot
be done you're gonna be losing too much
it's not worth it
they didn't give up that easy so what
they did is started some explorations
they started with the engine the open
source JavaScript core engine powering
most of the WebKit browsers and the
miniature JavaScript engine duck tape
and try to figure out if they could make
it small enough to fit into a
microcontroller and they found out that
the duct tape was small enough but
eventually they went with their own the
thing that's called gyroscope
Jerry script is actually one of the best
tiny JavaScript engines in these days
and they actually open sourced it that
helped a lot to get a system I'm going
to be showing you some examples very
soon about George cut so here's the
thing it could fly you could flash this
onto less than 200 km flash and it runs
there about 40 64 kilobytes of memory so
it's not the tiniest one but it comes
with es5 support heavy really optimized
and and very well usable the fact that
is very well usable comes from the fact
that even BBC micro bet has adapted it
and a bunch of erm devices the BBC micro
bet is a small educational device that
every seventh grader in the UK gets for
free to learn about computers so this is
the device itself and because you are
not gonna be seeing it like that let's
see if we can I get this working
no let me just related this and
I'll be again there you go so let's
focus no peeking
you will see all the other devices so
yes this is this big and you could tell
it's an educational device because it
has no pins and no whatsoever it has
very flat edges so you can give it to a
seventh grader and they're not gonna
kill anybody with it except if they are
very crafty which seventh graders are
mostly are so they are screwed anyway
but if you wanted to do more Hardware
stuff on this you could just add a
little expansion board this will just
snap right in and you can just plug your
devices onto it so it's very good for
prototyping as well and it has a bunch
of features built in that are not gonna
be mentioning now but you can ask me
about later all right let me see if this
works what made it even better is that
they they created a very special editor
for it
this device also runs JavaScript on it
it actually runs DJ script compiler
language engine on that but what you
could do is you could actually use this
web IDE again you know still the idea of
the ASP now there is a web page you can
go to I can actually just go there that
is basically this online editor and it
has a emulator on it but it also has
this block thing that you can just
puzzle together some code that is easy
to understand you don't have to write
anything and then you can see that it
actually translates to a basic
JavaScript and this is used to teach
people that web development and and
hardware development in the first place
from as early as seventh grade or even
less so that was a another JavaScript
conference in 2015
this is Jes conf 15 ironically this
looks also like Jays Cove is which is
Jay's confess land and ironically this
presentation actually took place on both
conferences this is hey come parents
who've worked at the time for pebble and
pebble put together something their
watches actually use javascript as well
they actually put together pebble juice
or rocky J us to run their run on their
watches and so I'm gonna see if I can
show you so this is a Pebble watch and
the actual watch face you are seeing and
a bunch of other watch faces are created
using html5 and JavaScript you'll find
that presentation it's quite fascinating
in the links as well the interesting
part of this what they did okay we're
gonna use Jerry script we're gonna put
this onto the device and we're not gonna
sleep until this goes just exactly the
same performance written in JavaScript
as it goes in in C and you would think
that's not possible that but that's
actually very much possible
they are running the thirty-nine lines
of code of the JavaScript watch face on
the same device on the same performance
same battery barrel usage in the exact
same place replacing they nobody
actually noticed they haven't announced
that they are replacing the watch face
with a one written in JavaScript and you
know 230 lights of seeker goodbye
well comforting nine lines of JavaScript
code that's equally performant running
on a watch and you're like okay okay but
my watch pebble has gone bankrupt but
actually the technology is not lost
actually because Fitbit bought the
company mostly for the intellectual
property so when they came out with
their own SmartWatch offering they
actually stole the idea while they
bought the idea first so
I'm going to show you that amount of
time but also I'm gonna show you my
Fitbit watch and I was joking on Twitter
but I was asking about this that if I
don't sleep I'm gonna show you a demo
even well I didn't actually end up
showing anything useful but here is the
application that I made with a few lines
of JavaScript and at web api's it says
you know accelerometer barometer heart
rate he is gonna faint
stuff like that you are running
JavaScript on a watch that could stay
with a single charge stay charged for a
whole week and you know people are
people are asking you know this
javascript is a toy language right so
okay so what I have been up to Dan these
are all nice and this should give you a
lot of improvement you know the state of
JavaScript on hardware I've been up to a
bunch of things and I mean I would like
to show you some of those in some of
those things in a short demo I here 2008
is gonna be the Europe declared I'm also
hearing this for like probably five
years now so okay we have shown you a
bunch of devices but how do you put
JavaScript on this device does anyone
know what's this
there is a there is a microcontroller on
the Left so that one is a
microcontroller well let me show you if
I may
to do so gonna die oh I always die the
first time ah so what is that right you
may ask
so that thing is called an Arduino on
the left you can see that the
microcontroller it's basically just
hooked up by a bunch of wires into your
screen and LCD screen or LED screen
buzzer and some buttons this finger
actually is running a C code so this
device has maybe 30 Q kilobytes of flash
memory kilobytes that is two and a half
kilobytes of memory and a 16 megahertz
8-bit processor so it's not the fastest
device on earth that was made what's
interesting about this thing is that
actually you can run JavaScript on it it
takes a few tricks but you can actually
do it and I don't think oh I think I
have maybe a bit more time to show you a
few things and after this talk and
throughout so tomorrow I'm gonna be
demoing cloud oh boy if somebody signed
up for my workshop you're gonna seeing a
lot more of this and if you're curious
and you're not signed up to the workshop
you can find me in the Mozilla booth
today and - and on Saturday as well and
they're happy to answer any questions
you may have about cloud oh boy and
everything else but also you can try
some of these devices that I'm gonna be
showing you so cloudy boy is basically
an online editor for games it has a
bunch of components but what makes it
most interesting is that it lets you
create pixel graphic art and games and
then lets you put that put those games
up on the internet because you can share
them because they're just JavaScript and
html5 canvas but you can also put that
onto microcontroller devices like this
one so you know this cobbled together
mess is not very exciting how about this
one this is called the order boy this is
the exact same device with the exact
same components on the right hand side
you can see the little tiny microchip
that is the same as the Arduino is
microchip some buttons and the screen
and a hidden buzzer in the back just you
know looks a lot nicer and you can
create games for this microcontroller or
how about this one
the tiny arcade how about this is
actually a much faster processor it's a
32-bit ARM processor and a colored
screen and because I'm not here to show
you pictures I'm here to show you games
actually so we have horrible glare but
you can buy probably a maybe able to see
the jas kana let me just zoom in a bit
and alright
gorgeous so come Jeschke invasion this
game itself when I was last time here in
November - we were sitting in Thomas and
doing a verse shop he put together a
picross game in maybe two and a half
hours with cloudy boy and it took me a
bit of time to to fix some of the bugs
but then after the pikers game was
compiled automatically to run on this
device so what means you create their
game on the Obey browser and then you
can you can put it onto your
microcontroller device yep and I have a
bunch of things that I had to skip skip
over so if you want to talk about those
things you can find me on Twitter at SL
softworks and if you want to hear more
about you know how to put games onto
microcontrollers you can follow at cloud
boy
and your job by them as a booth or the
workshop tomorrow thank you very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>