<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Thomas Kroeber: JavaScript on the Raspberry Pi | Coder Coacher - Coaching Coders</title><meta content="Thomas Kroeber: JavaScript on the Raspberry Pi - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Thomas Kroeber: JavaScript on the Raspberry Pi</b></h2><h5 class="post__date">2012-11-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NBZCZ57mTUc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I said this is a Raspberry Pi it's a $25
computer and I'm gonna plug it into this
5 volts USB cable that I had spare from
my on a broken phone and also to the
screen here and it's it's booting into a
Debian Linux system hopefully at least
and basically it's reading the system
from an SD card can we get the video or
oh we don't get the video so let's
believing that has video what's working
fine this is like the pattern of tech
stuff not working
it seems let's try again this cable
looks good ah perfect
so it's booting this Debian Linux
reading it from an SD card my name is
Thomas Cooper he mentioned that already
um I'm working at Nokia and actually on
automotive it's pretty unrelated but
it's and better technology as well as
well I'm trying to put JavaScript into
cars but that's the first step
so the the Raspberry Pi well let's start
this way so when I when I am grew up I
learning to program was actually
connected to wanting to play computer
games
let me quickly so so I had a zx81
computer and there wasn't like you
couldn't really go and biased games for
it so I had to do is get these magazines
copy the code of the games and then
compile them and run them on
on the small computer and and I learned
programming because I wanted to play
games and that that pattern that worked
for me I mean when I went to university
I was actually I had mastered three
programming languages there wasn't much
programming that I could be told at
least in the early semesters because and
that was there was a pattern at least in
my generation of a lot of people that
were came to went to university to study
computer science but they could already
write code now if you look at kids today
the gaming has moved to to these gaming
consoles and these these gaming systems
by design are designed as as closed
systems you can't really easily write
your own code for them you can't really
fiddle with the electronics in them and
so forth so that opportunity for me to
kind of learn to write code because I
wanted to play games it's not there for
kids of our age and according to this
gentleman even Upton who's the
co-creator of the Raspberry Pi and also
works at Cambridge University you can
see that in the applicants at university
for computer science so there the
numbers have gone down for him and I
don't know if that's a global pattern or
just Cambridge and also there the
knowledge that that students have at
university or the pre pre knowledge that
students have at university has went
down and what he started to do is think
about okay how can I create a computer
that is cheap and easy to use for
children that they can use to fill
around so something like the child's
bicycle compared to the to the family
car so you can't recount all can't
believe like well you don't really want
to break the family PC to to the kid
like to learn programming or anything or
learn how to install windows and so
forth and then that is kind of the idea
it's it's in the PI is in pretty early
stage so I'm not sure if it is yet that
thing for children to do but it is you
can see things like this so this is like
the child building a case for the PI
actually I don't have one so that's kind
of the kind of feeling they're looking
for
you look at the pie that's the board
it's it has pretty much everything you
need to connect it to a TV so it has
this HDMI plug down there it has an
s-video if you have an old-school TV it
doesn't have VGA which was like some
trouble to connect it here but it worked
finally it has audio it has at least
this one which is actually $35 has a
network adapter as well the the cheaper
one doesn't have it that has USB the the
CPU of this is for twenty-five dollars
you can't really expect much but this
it's this thing it's an arm 11 and it's
it's like clocked at I think 700
megahertz or something like that which
is like arm 11 I don't know how how much
you know embedded about a minute but
it's relatively Slocombe
CPU is like at the range of like free
iphone one free iphone one but the CPU
actually if the of that like well it's
like I think I'm 12 by 12 millimeter
size on there of that 12 by 12
millimeter size to square millimeters
only are the CPU and the rest of that
thing is actually GPU which is pretty
powerful so it can do full HD in 60fps
pretty much on that on that small thing
and actually the presentation that
you're seeing is running on that thing
and it is actually I'm rendering it in
Full HD it's just scaled down because
that system can't do full HD so it's
like it's it's it's pretty performant
GPU but then if you put do a lot of
things on the CPU it's it's not as great
and but you can't run X Windows on this
you can run most alone it's just not as
great as this stuff so what I'm using to
get JavaScript on this is cute which is
actually a C++ framework it's it's
pretty old like 20 years but it's like
it's been evolving over these 20 years
it's open source and it has like its for
instance the WebKit like Apple took at
some point took WebKit out of the cute
framework like I don't know 10 years ago
or whatever
so it like it's it's the route to many
systems but it's been evolving and the
latest version that I'm using is cute
five and that has undergone like a
complete rewrite of the of the graphics
pipeline so everything is put onto the
GPU
Lalli all the objects are basically and
textures and the day they actually went
away from using C++ to define the UI and
into something called cute quick which
is actually a UI markup language that is
built like looks a little bit like SCSS
so it's not it's not the XML based but
it's essentially still a tree it uses
JavaScript for scripting and it does
that different than what HTML does so
really the all the nodes in there are
basically you can put JavaScript code
actually they are JavaScript the at
least every all the values are
essentially JavaScript and it is - that
also different to a browser the the
elements that there's no no sandboxing
between the markup
scripting world and c++ so you can very
easily build something and C++ and I
expose it into key ml which is three ml
by the way steam markup language of cute
quick and there's other nice things like
shaders and like html5 canvas and
particles and stuff like that so that's
a very simple
qml program what it does is create a
rectangle with a pink color at a width
and hate and you can you can set like
all the things to the right of the
Cullens are actually javascript so i can
do with x 2 here or pi x
so I just squared you can to define the
markup you can then like add notes to as
children's over let's put a text note
there some text white then we can anchor
it to I get it so basically I use
anchors to position things so I incur
this to the parent right and it should
anchor the right of it don't need that
anyway so okay so there's other
properties where we can put the radius
there let me give it round or corners or
we can rotate it 30 degrees you can also
instead of just putting numbers there so
we can do something like so for instance
I could again like this all these
properties are bound on so let's give if
you give an ID to to an element here it
actually becomes an object in JavaScript
so this is all right text and then I can
say here I don't need so you can even if
he if things are animated the property
bindings will apply to those and you can
even put a function here so you can just
leave away the function keyword because
they don't get parameters because they
basically just supposed to return value
so you can also put kind of value here
or do things like like
ten times the rotation and again like in
in cute quick
it's like observing all the all the
properties that are changing and then
whenever something changes the
javascript is reevaluated and the engine
inside there is v8 cause okay so that's
that's like at least a simple quick
program you can also put shaders there
so this is a shader that actually has
commented most of the code out so I
think most of you heard about shaders
but basically it's like it's similar to
the stuff you get in WebGL so it's GLSL
that is built-in and you can just for a
note again like the straight a' effect
is a note a special note that allows to
have a shader there's like the property
that i'm defining here which like again
you could find properties that have
types which are becoming available in
javascript but also into in the shader
so this property is a real value of time
and that i'm using here in the shader
and then there's like this cute specific
text cord property which is exposed into
the shader which gives the pixel of that
should be rendered it is for the
fragment shader the fragment shader is
essentially a small program that is run
for every pixel in this green sorry for
a full HD it's like 1920 by 1080 by 60
years it's running at 60 frames per
second times per second so it's like 120
million times or something like that
that this is run and at the moment it's
just like using the X&amp;amp;Y position to for
to create a color like the for the red
channel and the green channel of the
color and then blue is there black and
then there's 50% opacity on it so
instead of that
let's just enable this code because I
didn't want to write it myself so let's
put this out just to show what you can
do with like shaders so this this is
essentially just a couple of sine curves
like put and put on on the on the screen
with I'm gradients so you can look like
this there's a sign here that uses the
time again which is a number animation
up here so if you if we decrease the
duration it should run a lot faster and
then there's a there's a value computed
out of the two positions which is
becoming the color once we apply a
square root on it slightly modified
example I found on some WebGL page okay
so let's get to do more interesting
stuff so in addition to this GPU and and
the capability run like Linux on it and
programs for Linux on it this thing is
also GPIO pins and you just heard about
them in the talk before lunch or is that
most of you have so it's essentially
these are programmable pins that you can
like set ask make like three volts
voltage on or no no voltage and you can
just put stuff on them so he can have
LEDs blinking and we can have serial
communication there's like I squared C
which is another like communication
protocol for like these embedded devices
or microcontrollers and you can also
read data and you can generate analog
curves for data to like create audio or
things like that so like these these
things are pretty much just exposed on
the board if there isn't there's much
usage on them yet but at least people
have been started building around things
around them and at the moment it's it's
really easy to to toast the board with
them if you if you just get them like
short circuits something or give them
too much voltage you'll you'll fry the
pie there's like the
like another open-source project to to
build a device that you can plug on that
like makes this more more secure and I
haven't gotten that yet so I actually
Friday was my Friday I am fried to pies
and then went a little bit panicked
because those were my only two and I had
this presentation coming so and I said
oh no I have to go here so this thing
here is like a nice sandwich that I
built to protect the pins and it's too
ugly to actually explain what it's doing
but basically it's it's like reducing
the voltage and I'm just going to put
this on here little quick and then first
thing I want to show is just like how to
control a simple LED with the pins so
it's just this is an LED and I want to
give it power yeah this is this is
actually supposedly a very bright LED so
if you look into the light you will die
but maybe it's bright enough here and
then we can try this is actually not yet
thing I want to show so it's just
quickly get a shell here so this again
like is like a pretty much shell written
in qml and JavaScript and some C++ you
can also see the can you see there's the
particle effect there another qml
feature you can add they're a little bit
crazy but anyway so what I would hope
happens now if I do detect yeah so it
found my LED so it's this initialize
this my quick
okay so it's black so now we can start
so what I can do with this LEDs is like
just send RGB values to it and it's a
little bit fragile so I'm not gonna but
easy you can I wrote this small script
which again is using shell like there's
commands that come with Linux to just
communicate with it so let's look at
this it's this simple shells which is
just this I to see said come on is
really crazy but busy it's just taking
an RGB value and then puts it on the
right formats it's right to the i2c set
up there can be called so value so let's
say we want to have red as you can see
there the red is blowing other things
like let's say white why it is actually
like it's three LEDs I don't know well
this can be seen but it's basically
adding these up so this is this is nice
but then we don't really it's it's like
I'm using the shell I'm not using
javascript so it's a little bit boring
so let's try to get Electra exposed this
this stuff into JavaScript so this is or
to qml actually i should say this is
what you have to do basically there's
one class that you have to write which
is creating an item in the in the acute
quick world which is this calling it
GPIO so it's extending a cute quick item
it's like there's some boilerplate you
object stuff that you have to add which
is just giving this like introspection K
this class C++ class introspection
capabilities
and then there's a constructor and this
digitalwrite function up there is
actually the the function that calls
that does the system cause to to write
something to the GPIO which is like I
found that in the documentation for this
chipset and then another class you have
to write which is just this plugin down
there which creates a plug-in for qml
and registers the GPIO type down there
under the name GPIO so the second thing
you would only have to do once per thing
that you want to expose the others the
classes you would hit right and then if
you this Q and vocable actually tells us
that this function should be in vocable
from the cute quick JavaScript world you
canyou can also have give add properties
to these items and do more things or
like do the inverse direction but just
for this simple thing this should allow
us to to write stuff and now I'm not
gonna compile this because it's it's
gonna be too nasty but basically the
idea is to use this for something more
and since this thing was made for kids I
thought I go into a toy store and bought
this small thing to play music and then
build this thing which is like a bunch
of like electromagnets with small
hammers and they are called solenoids
basically its coil that like draws
Cullen was current on a on a like this
this hammer and then pulls it down if
you if you apply power to it and if you
don't apply power there's a small spring
that pulls it back up and this crazy lis
great Woodward actually fits perfectly
on my instrument and then these wires
actually go to this thing the thing with
these coils is that they actually draw a
lot of power so this this these run at
24 volts makes you should put it this
way so you can see it better
so no way to like powered of the three
vaults that you get out of the out of
the Raspberry Pi and if you try or if
you make mistakes then you have a
raspberry fry which I don't suggest to
do one so instead of that I have this is
like old
oops Oh notebook power Deborah here that
should power them and then there's this
insulation circuit here that should like
maybe there's like a Darlington switch
that like allows to power a lot of power
to go run through without harming the
pins so this is all powered and we have
to wire this now let's think so if so I
have this this GPIO element and there's
there's a well we just had saw there's a
digital write function that that allows
to to write like set a pin to higher low
so this is this is just like my first
song so what I'd like to have is like
this this function I would want to call
this function which or I want to
something to call this function and then
run through this this song here which is
just a bunch of nodes and then the space
character should is this space thing so
and this space character should say like
okay there's actually nothing to play so
the ideas have something that every
whatever second iterates through the
string and then looks at what
what is the current note and then place
that now in EML is like it has
JavaScript but it doesn't have all the
things that the browser has so timers
are one of the things that are done
differently in cute quick the way they
are done is that you just add a timer
there that has an interval let's say we
want to play every 200 milliseconds
I want to iterate over 200 milliseconds
and should actually be repeating and
then there's a function or signal that
is called which is on trigger and that
actually does like trigger whenever
there the timer hits and this actually
should just be our play next call okay
so now we should have a timer that halts
this function and then this function
should play a tone and now if I set this
let's actually do this so that the this
pin map hash map that Harry there just
Maps the maps to the notes to the pins
on the PI so I want and then set at 1
let's put this away for now what's that
Oh Oh something's wrong it's like not
not a very decent way to enough debug
but oh okay control see was not a good
idea let's start from scratch how much
time do we have
so again we need a timer on triggered
oddly next enter power 200 should repeat
it should be running mm-hmm
let's use this later and then since the
let's take this out for now I just want
to get this thing hammering at least
once so you see this and I'm kind of
confident that it works so okay so
impressive isn't it but that's basically
now I wrote one but that one remains set
and it's not going up again and that
there's no real tone so if I said send a
zero again it goes up again so what we
have to do is have something that
actually moves the hammer down really
quick and then moves it up right away so
that that one timer won't really kick it
because we don't have well this is it's
JavaScript so it's a vent driven so we
don't have a delay function or anything
so we need another timer and then that
timer should just run really short so
let's say one millisecond oh sorry
I'll okay let me let's do this in two
minutes I'm gonna be quick I'm just cue
Mishnah wow this is this is gonna be
better maybe not yeah um okay I'm gonna
run so we want this and then
on triggered we want to digital right Oh
deep the note that I had and then then a
zero and the note we don't we don't
really well kind of we have to pass a
parameter into this the best way to do
this is probably just by adding a
property here that is accessible and
then give this a let's check okay
I guess I won't get this working in time
okay so that's just imagine that it
works it was working but I just don't
get this and I don't have really have a
backup that I could just put in and have
playing I think or do I actually I do
okay so if we have at least 10 more
seconds that's quickly just to show that
this can work
okay maybe not I'm sorry but then if you
if you want to play music
check out Roth peopIe awesome I live
coding which does not kill us only makes
us stronger
yeah maybe you could is it possible you
could even take this entire set up
outside and and then yeah yeah we can't
get yeah yeah if we got a break coming
up in two more presentations maybe yeah
alright so demo to be continued outside
all right cool</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>