<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[JSConfUS 2013] Jed Schmidt: Mass Hysteria: Clients and Servers, Living Together | Coder Coacher - Coaching Coders</title><meta content="[JSConfUS 2013] Jed Schmidt: Mass Hysteria: Clients and Servers, Living Together - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JSConf/">JSConf</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[JSConfUS 2013] Jed Schmidt: Mass Hysteria: Clients and Servers, Living Together</b></h2><h5 class="post__date">2013-07-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/UJHOzE28pKg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">everyone can see you guys again we're
going to talk about mass hysteria
clients servers living together my name
is Jed Schmitz my email just has changed
please update your rolodex Alex Sexton
it's now we're Jed is all the weight is
Icelandic so there's a connection there
yeah like you said I in 2004 I became a
full-time japanese translator and then
in 2005 I and six and was really seven
and eight and nine and 10 and 11 and
then I quit and 2012 and it became a
full-time job super over hey what's up
crazy Oh me I was worried sorry I we
still marrying good good so yeah so now
i'm doing a full-time javascript and
actually using both i'm working at
uniqlo which is like a american apparel
it's like the japanese version of
american apparel's japanese apparel
these shorts if I'm a model them in
yourself yes thank you and they drive
really quickly 2499 they can be yours
not these but you can go to website yeah
so it's cool you know i'm also in the
note firm a bunch of cool dudes or a lot
of them here which is really neat to see
them really good to be back at JS calm
my first ever technical conference was
JS conf in 2010 when i had the fortune
of that volcano and it's been really
awesome to just see this conference grow
now with 50 thirty-three percent more
Williams they really up that that's been
really nice and also it's really cool
it's a you know here in Florida my mom
you know went to high school in college
here I drink a lot of their orange juice
we send them a lot of old people from
New York really it's it's cool because I
don't you guys know but if you have like
like a week you get like a bunch of
nerds to be like hundreds of nerds
together like a whole week you know from
all over the country you can just talk
about stuff and you guys definitely I me
know if you know you've know this but
you can definitely keep the dream alive
I know because I did the same thing 20
years ago at Space Camp right down the
street so uh yeah so my first talk was
fab it was it was really crazy it was
this framework that was like really
really functional and like all these
nested not nested but like all these
parentheses to like it was basically a
lisp e type thing it was very academic
didn't go very far
bought a domain and then I let it lapse
and it got I discovered two months ago
picked up by a domain squatter so you
can tell it was clearly making buck good
bucks off of this off the framework
because it's a finance thing and you
actually read the read the text there
almost all of them who pay taxes want to
save some money from them and hence they
go for various tax saving options which
are available and most of them are
investment options so if you think this
language is difficult to understand well
I would actually argue that it's not
that much harder than fab itself which
is there before it so it was kind of an
esoteric approach to programming then of
esoteric as well I did the thing called
140 bites I was a go golfing contests or
plenty of contributors here I'm sure we
pretty much saturated the space of all
the things you can do in 1 40 bytes in
in JavaScript it was really cool i have
this thing called Domo it's basically
like let's put HTML and CSS in the
syntax of JavaScript so instead of
writing style sheets instead of writing
HTML you write it all in JavaScript it's
a small library presented that recently
I also wrote I'm sorry I didn't write I
had written about me this the JED
toolkit which was actually I woke up one
morning and found out that my entire
image had been co-opted by this this
toolkit for some reason but it actually
inspired me i turned it around I then
found my favorite programmer and decided
to make a library named after him Angus
scroll so I'm sure you can guess the
library is a Angus Kroll
it's a scrolling directive for angularjs
so you should check that out when you
have a chance look there is thanks Angus
mastery client service learning together
of course everyone knows where this
quote is adapted from Ghostbusters human
sacrifice cats and dogs living together
mass hysteria was the quote from
Ghostbusters which was filmed in 1984 or
at least probably releasing on TV for
him even before that actually it's
probably 30 years old now Wow I filled
cats and dogs 30 years later if you
google cats and dogs living together it
turned out not so bad they didn't have
the internet I guess back in the 80s
Bill Murray is a great actor but I guess
he didn't see this coming actually was
not so bad so uh mission accomplished
good job of course that phrase care of
george w president george w bush care of
florida thank you for that guess
speaking of mistakes from the 90s there
there was this book men are from Mars
Women are from Venus is the same thing
where it's like this kind of like cats
and dogs can't get along they can get
along we saw pictures men are from Mars
or Venus you know and also and I think
our community this is the client-server
model thing where it's like are you a
client guy are you server guy it's like
one or the other you kind of putting us
together so like you know just like man
from Mars Women for Venus it's like no
duh people are from Earth hello open a
book I don't fit mountain Scientology
maybe they have a different thing but I
kind of feel the same way about our
thing clients are from Mountain View and
servers are from Oakland but just like
Earth is a common ground between Venus
and Mars we have the san mateo bridge
it's beautiful really know seriously uh
you know like Angus talked about William
Shakespeare's Romeo and Juliet I think
this is actually the original cover that
he had on his on his version you know
it's the Montagues and Capulets and
fighting and then like lovers from each
meet and it's this whole thing or
likewise West Side Story it's an
adaptation of this you know the Jets and
sharks and you know to meet and then you
know for us I guess it's more of a
client side story but I'm just wondering
you know are we gonna find our Romeo and
Juliet are we going to find our Maria
and Tony to kind of bring these two
together so the idea is let's kind of
kick this process off let's turn service
into clients and let's turn clients into
servers okay so basically give two
approaches beach and so like you can
kind of you know widen your horizons if
you're like a client guy it's really
easy to dabble actually not necessarily
know Jess but in other things to get
more of a server background likewise the
other way so first step let's turn
servers into clients and I did this it's
called browser bruh have you guys heard
of browser anyone alright cool let me
give you a little a little rundown I
presented it at reject is in Berlin
Germany last year I reject ass of course
run by Robin sitting right in front me
which is really cool it was in October
fourth or as noted heartthrob multiple
calls it April 10
and yeah I actually what happened was I
tweeted I actually I tweeted this this
the douchiest tweet ever wondering if
this exists an oj server that exposes
WebSocket connected browsers over
subdomains is disposable web home karate
endpoints which is really you can tell i
hit all of the like the buzzword bingo
of yeah i missed a real time in trance
pile but yeah i'll pick those up someday
yeah so the idea is it's an oj s server
in your browser ok i would you want to
be this browser and it has a unibrow as
a logo which is an actual a sri lankan
letter as it were i don't know if they
have you knew browse over there but yeah
so basically it's HTTP / web sockets
okay so here's how it works there's five
easy steps all right follow me on this
one number one the browser connects to
the server right so just like you know
browser connect to the server just using
web socket right and then number two the
server announces assigns and announces
the hostname so the browser comes in on
a web socket and the server's like
you're going to be like some ID dot
whatever my domain is right and then he
can broadcast that to Evers listening on
the server and then the server proxies
HTTP in so HTTP requests that are bound
for that host get proxied to the browser
and likewise any HTTP requests that are
made over this web socket to general
internet or proxy through the server so
there's no cross domain anything it's
like you're just going through a server
because it's a proxy anyway and then
yeah and then the browser becomes a
server so basically here's how here's
what it looks like so there's two sides
right there's a client-side and
server-side so on the server side first
you have your your web socket engine or
whatever shame you want to use you can
use a sock JS engine i/o socket i/o
straight up web sockets whatever you
want that's optional then browse over
which is like 1.3 k of codes not a lot
this is like an API think it's not a
technology is just like an API to wrap
an existing technology and your coat
looks like this you create a WebSocket
server you create an HTTP server and on
request you do some stuff just like it
would note and then that HP server
listens on the WebSocket server that
make sense this is all making sense so
far
okay cool meanwhile on the server HTTP
engine io for example or you could do
straight-up WebSockets browser ver
create a server for each so the HP
server the web's the WebSocket server
and then the browser ver and then yeah
the browser listens to the WebSocket
server it also listens to the HTTP
server and then on connection it
announces that a server has come and you
can bind to that whatever you want and
then you just listen on a port so
basically it's a proxy that just maps
HTTP web sockets so it's really cool
because it's only like total like 3k of
code and it's just like a it's it's a
it's a good way to look at adopt that
kind of paradigm so web sockets you know
it could have been server sent events
when I was doing this I mean there it's
because it's a rapper you really could
use any of these things web RTC or
polling or or polling we know is long
polling really you can use anything but
why why would you use HTTP right the
idea is like well why do we use
javascript is it because we can use the
same language everywhere maybe it's not
that you can maybe share the code but at
least you already know it you're already
in one domain you're already probably
familiar with HTTP so why not reuse that
for using things instead of learning a
new paradigm is one idea second idea is
like wine ojs like why is no gel so
popular well call back
which are the best / worst / best again
thing about nodejs whether you like them
or not callbacks are here you can wrap
them or you can't what I don't
understand that hasn't taken off web
hooks haven't taken off nearly as much
as callbacks even though web hooks to me
are the HTTP version of callbacks and so
the idea is if you use something like
browser ver you can use web hooks I can
set up a web hook give an arbitrary host
to someone and they can just do whatever
they want to that URL and they get
routed to the browser so the idea is to
push the logic out to the end nodes so
you can you know abstract your
transports because now you're just using
HTTP you don't have to know anything
else you can decouple stuff because now
now that you have an actual transport
you can put things on different machines
and use it tech you already know that's
a that's the basic idea and you know I
got some feedback on similar library
that actually was relevant to this when
I was releasing don't is the thing I was
telling about with CSS but this is
actually a tweet that I really took to
heart and he sufficiently advanced
JavaScript framework is
indistinguishable from parody so I'm
towing a really fine line here I'm not
sure if it's right or if it's going to
work I have made mistakes in the past I
was in a I wasn't a boy band that's
actually not Joey Fatone that's Jonathan
David Dalton ooh kicking this thing
before he cleaned up and moved to
Microsoft yeah so we had this boy band
and it was like pretty sweet we charted
with our first hit but it started to
unravel he notes like the classic vh1
behind the music arc you know started
going downhill and then and then you
know just it really it really all fell
apart when we started getting a little
too abstract in our message actually I
don't think we even I don't think we've
enjoyed about
so anyway how much time do I have that
still says 30 i'll have to have an
infinite time oh sweet alright halfway
point sweet alright so we turn servers
into clients right and see what you know
we can get from that let's turn clients
into servers and so yeah yo dawg I know
I know I get that all time this is a
kind of the opposite of yo dawg if there
is such an opposite so so client-side
you know server-side client we're going
to do this there are a bunch of tools
you can use to do client stuff on the
server i'm going to show you three of
them that i use cheery ojs Tom and fan
MJS let's just go through these pretty
quickly you guys knew who this guy is
that's a bogota a bogota god bless him
dead in 82 actually that's not true sure
you know the story People magazine said
he was dead he wasn't dead he was
performing a stage play fine they got it
right though in 1987 well not really
because it was another dude who's like
he's dead he's not so it's like this
running joke you know like when the hell
did he die kind of thing but they had a
website and he doesn't want to actually
tell you whether he's dead or not and
it's a bogota com it's pretty sweet
there it is ah the source this is just
what you think it is from that era yeah
it's pretty incredible if you want to
find out if a pagoda is live you have to
swim through this so you can see a
bogota is span class equals fixed alive
oh sorry line returned alive so it's
kind of an old school so it's like
obviously not intended for human for
machine conceptions for humans right but
like if we want to make an API I won't
know he's live I either i don't want
HTML i want yes or no or oh dear please
no not like this I want yep nope for a
bogota
and so we scrape and so you know what do
you used to scrape well at the very soul
I go up in complexity now so we can use
Michaels request thing we can install
that we can you know have a really cool
color back name and when we find out
from this website we can look at status
codes and we can be like well this task
force to hundreds and now we don't know
because we can throw an error but then
what do we do so we have all this HTML
how do we turn that into a boolean I
mean right it's like it's I'll just use
regular expression right I don't have to
tell you where this goes I'm sure you've
seen this it goes it goes downhill
really fast
I'm surprised keynote actually rendered
that that's pretty good pretty amazing
uh right have you tried using an HTML
parser which is how that ends actually
pretty genius so let's try an HTML
parser i'm going to use cheerio if you
guys heard a cheerio it's pretty neat
it's jquery core for servers so the idea
is that there's no Dom it's like a
JavaScript implementation of the Dom
it's like very very simple and so it
just lets you do the basic simple stuff
that you'd expect to be able to do in
jQuery in terms of manipulation and
access things like that so get cheerio
put that in load some arbitrary the API
looks like this you just load some
arbitrary HTML and then you can just run
you know jquery like operations on it's
really cool so you install it and then
let's ok so let's take this thing its
load this body that we got from this
website called it almost jquery and then
let's find class fix let's find the
first one take the text and its trim it
right and then if the status that thing
that we trimmed is alive then return
true otherwise walls that's cool so how
do we use this thing check on Abe if
he's okay throw an error if it's not a
bits if if it is a boolean return
because this is just a test and
otherwise throw and this is how I throw
as a code golfer because I don't have
time for your new error this will return
a reference error unless you have an
OMFG variable somewhere up in the code
which maybe you do i don't know a little
throw and i come on it's got to throw at
some point this is on github check it
out I have received one pull request
which I accepted 15 hours after the
presentation gave us less debt from
cowboy thank you that Ben Ellman so it's
works and you can just MPM install a
bogota you can also NPM isn't all I
Bogota thank you to Alex textin for that
one he pushed that through Isaac was a
he has a soft heart so you can do that
it's so cheery it was easy it's fast in
process the biggest problem with doing
something like this is JavaScript itself
because what if this web page is running
JavaScript we're not executing
JavaScript how would we know so
JavaScript is like our best friend and
our kind of best enemy in this case you
know your fancy single page apps what do
you do well next level up Janice dumb ok
coolz j zoms really cool
Nicola who's here is the maintainer of
this there's like tons of committee
involvement as you can see there is lots
of modules that it uses so it's very
kind of reuse kind of node style thing
and the API is pretty cool you require
it you set up an environment you've
inject a script you get a call back and
then you can see how many nodejs
releases there are something right so
that's it's a really easy API runs
JavaScript easy it's in process the
problem is actually your stuff built on
top of it there's no taiyou which is a
scraping engine there's a tobie which is
a testing framework zombie jess is
another thing that people use the
problem is it requires C++ because it
actually has to create like a new
context to like evaluate that javascript
in because it's coming from an arbitrary
web page you know that running in your
like or your node process it's also
technically not a browser so you might
actually hit things where like stuff
doesn't exist because it's a pure
JavaScript implementation of a browser
so you can use selenium it's kind of
heavy or you know if you just need
WebKit if WebKit is all you need or I'm
sorry as sorry as Alex Russell calls it
blink classic
yeah if you just need that you can use
phantom jayus ah cementum jess is really
it's really cool fam Reyes is like a
totally powerful tool in fact if you are
a client more of a client personally
more comfortable client and you're
looking and go server I would almost
recommend Phantom jayus before I would
recommend node because it's literally
it's a server it has the same API know
does you like type phantom Jas and then
type that you know the directory of the
script you just point to a script and
it'll execute that code but that code is
a browser environment with a duck with a
window and a document and all that stuff
and so it's actually I think it's
actually a pretty good gateway drug to
doing more server stuff so I've been
using it for a bit it's actually really
cool yeah so there's stuff built on top
of it because you know it's it's a
little bit unwieldy there's a lot of
people who like want to use node and
want to use phantom j/s and so or like
phantom jess's may be too abstract and
they want to build stuff on top of it
Casper jayus is really popular thing
there's spooky j/s where you can
actually draw it the all this ghost
namings really kind of gets a I could
lose track of what's what spooky JSI
believe drives Casper from node so
Casper's like this you know really clean
API for testing and stuff automation on
top of phantom ge'ez and Casper can
drive that from node so there's all the
stuff they're spending just note if you
don't need the abstraction of Casper you
can just drive it yourself with phantom
Jo snowed there's school bus which is a
thing that's actually not really
specific to phantom jayus it's like just
a way of driving around an iframe it's a
very sub stachy api if you understand
what that is so api this pretty cool you
know their system file system file
system web server web page you can just
require it's like just commonjs pretty
cool system you know web server web page
so yeah you have access to like all of
these all these api is that you wouldn't
have access to in a normal browser like
for example if you want to get the
actual innerhtml the web page including
the doctype it's actually really hard to
do in a browser because that's actually
not available to you in a serialized
format so you can use phantom she has to
do that for you and there's there's a
few things missing you know function
prototype bind isn't there and there's a
few kind of gotchas but it's the closest
thing that we have to like a browser
that's not really a browser then is very
very easily automatable all these
methods too so I built this thing called
render what is like
my most recent fan of jas product
project do you have anyone has anyone
seen this there was this there was a
similar library actually built that does
a similar thing built by Airbnb it's
called render so actually I change the
name to render me yeah so it's a R&amp;amp;D art
ME ME domain is I don't even know where
but yeah so it's what's really cool so
here's what here's this for do you guys
know how hash bang SEO works do you guys
know like if you've a single page app
and you want SEO do you know like how to
do that there's a few things you can do
you're right you can inject you can
actually like compile your HTML and put
it in a no script tag you know people do
that but actually when Twitter came out
with the whole hash bank thing which is
by the way the most famous piece of URL
garbage since Alex sextons double men
when you have a hash spangle will
actually see a hash bang it will
actually go to that same URL without the
fragment because remember servers can't
see fragments because the browser keeps
that and just sends the rest of the
server so it replaces it with a query
string underscore escape underscore
fragment equals and the escaped version
of what that hash bang was does that
make sense so that's really cool so now
you don't actually have to like do any
of this like crazy HTML mangling you can
actually just tell google like what your
rendered HTML would be for any given
page so so there's the Google API so
yeah it's kind of cool and so what
render does is basically it lets you do
SEO more easily because like the problem
with single page apps it's like well you
want to see oh but you want speed right
because like so you want to see you
because like you want so you do
something server side because SEO is
easier for the server because it's like
well understood but then II want speed
and we all know that you know for any
app that you're gonna spend a lot of
time and not just hit you know once in a
while client-side opting to be faster
but you want the SEO but you want the
speed and I think with stuff like this
you actually don't need to decide you
can actually have your SEO and your
speed you can have an SEO speedwagon
and and that's what render is so
basically the idea is this all render is
and I should how much time oh whoa you
fix a thank you let's actually go check
it out I didn't intend to fire up
anything but you rendered me so yeah um
well that's thanks kiddo can you see
that let's actually look at what some
code looks like so yeah just create like
a really tiny document spin up a server
to serve it spin up a phantom j/s render
me server which is you know just a tiny
tiny little bit I may be 3k of code and
all that does is literally eat URLs and
poop HTML that's all it does right so
you're like hey render this page give me
the HTML to all does right so it's not
built into your framework it's really
cool because then you can just when
Google comes knocking when you're like
Google's like knock knock knock get
slashed and you're like redirect to hash
bang and google says did you just tell
me to go myself you can actually give
Google a 302 or 30 12 a service like
this and be like I don't have the
rendered HTML but you can get it there
so now it's really cool is you don't
have to bake all of this stuff into like
your existing app you can just put one
line that looks for that escape URL
fragment URL and just redirects to a
server like render that'll render it for
you and so it's pretty easy to use a
quick start on Heroku this is all the
code you need to just get a render
instance up and running and actually
what's really cool is like there is no
its server side JavaScript there's no
node we're actually using just a
straight-up Heroku build pack in this
case for for phantom jeaious which is
really cool and yeah so the API spurt
easy just like give it a URL and hof
tell them like how long you're willing
to wait how many bytes you're willing to
load whether you should load images and
what the ready event is to actually
execute rendering and it will return the
HTML for you you're all so anyway if you
want check that out please do let me
actually go back to my slides I don't
think I have much left here
and I think that is it so what's cool
about this and I'm sorry about these
like recursion memes I feel like every
one of my presentations as a recursion
me a minute what's cool about doing
scripting like this is actually it's
kind of it's kind of a brain bender you
are so someone has to Google like for
example to bought as a client that
accesses your server your server then
fires up a client right so that client
then goes and get a web gets a web page
about how do you get that web page back
well the client actually followed fires
up its own server within phantom
jessica's don't forget there's a web
server in Phantom Jas and then it uses
that to respond to requests to get web
pages out and then I'm pretty sure just
all goes to hell but but actually so
like doing this kind of like putting a
server Brenda browser and putting a
browser and server sometimes it's useful
but it's actually like pretty rewarding
programming in terms of like just
getting a like in one project like both
of the server side and the client side
in the same kind of code base which is
pretty neat anyway so that's it if check
out render me if you if you can and
thank you for having me
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>