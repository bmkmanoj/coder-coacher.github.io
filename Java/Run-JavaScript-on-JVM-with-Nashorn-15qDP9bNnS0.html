<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Run JavaScript on JVM with Nashorn | Coder Coacher - Coaching Coders</title><meta content="Run JavaScript on JVM with Nashorn - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Run JavaScript on JVM with Nashorn</b></h2><h5 class="post__date">2017-08-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/15qDP9bNnS0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so how many how many of you have had to
write JavaScript form validation code
right so one of the things I want to
challenge you to think about as I go
through this talk is how much could you
reuse that exact same validation logic
inside your java application there's so
there's more and more tools to do this
kind of thing one of the classics is
Rhino that's been around a long time but
in Java and in the VM now standard in
the VM there's a tool called nashorn
anybody use natural one so national arne
is a much more high-performance
JavaScript environment that's built into
your JVM all the time I'm not talking to
that but there's also things like
closure script which if you're writing
closure you can compile closure into
JavaScript with closure script but
there's also J sweet which J sweet you
can write standard Java and it will
compile your java into JavaScript that
you can then put into your browser pages
so what about national or national horn
like I said it's the JD kaise JavaScript
solution ship standard in in the JDK in
the Java VM so there all the time and
there Oracle is putting serious effort
into making it high-performance in you
know in Java 7 you had invokedynamic
there's there's improvements going in in
every Java release to improve the
performance of Nashua I won't tell you
that it's at parity with nodejs
but the gap is closing in many
situations it's going to perform
he knows close to node J s but it you
know the big difference with it is
you're in the Java VM so you have access
to facilities in the Java VM that just
don't exist in node.js root right no js'
doesn't have threads right there are no
threads for for node.js so anything you
do with a its you know sending data back
and forth between workers you have to
send essentially message objects and
pass data by value but you know let's
say you have something like the the
disrupter ring buffer right which is a
super high performance Java ring buffer
structure it's used a lot like some
stock trading applications use it
if you've got an 8 gigabyte in-memory
data structure that you're sharing
between a bunch of threads that the
threads are simultaneously manipulating
that you can't go handing an 8 gig
object between workers right so you can
do things with JavaScript in the Java VM
that you just can't even do in node.js
right just not even possible so a apples
to apples performance comparison is hard
to make because the facilities are
simply not there and how easy is it to
get going
so these two lines kind of show you a
super simple example of doing a little
Java Script the you get asked for a new
script engine from the script engine
manager you ask for it by name Nashorn
and then here you go engine eval and you
can put any JavaScript you want in there
and it'll run it it will convert it to
Java bytecode and execute it but you can
not only you know spit something to
standard out if you instantiate an
object in JavaScript here and return
that you're going to get back an object
handle in Java that you can call methods
on and you can even pass Java objects
into and have that JavaScript object
call methods on your Java object and it
all works seamlessly right it's all just
more objects in the Java VM so that's
one of the things I want you guys to
think about is don't think about it as
like there's JavaScript world in Java
world Java is a human language the Java
VM does not run Java source code right
it runs Java bytecode
well Nashorn compiles JavaScript into
Java bytecode so javascript with Nashorn
is just another way to produce Java
bytecode so if you have already have
validation logic if you already have
value in your existing JavaScript that
you've had to write for web applications
before you rewrite it in Java take a
step back and go like can we just use
that do we have to rewrite that and
really think about that right because if
you get in the position of that you're
not only doing your validation logic
let's say in in your web application but
now you're talking about doing an iOS
native app and you're talking about
doing an Android native app you know
that you're going to have to keep your
objective-c version of that validation
like logic your java version of that
validation logic your java script
that validation logic that's all
engineering hours and those are all
opportunities for failure right you can
have drift between your versions and
that's how you get serious bugs in your
platform so you want to you know don't
repeat yourself single source of truth
can you reuse that code and that's what
that's what isomorphic applications are
about it's Ekman script five I think
there's some Xmas scripts six coming but
you can you know like you can run
Express with Babel like you can use
webpack and Babel and produce with the
transpiler that will work on nashua so
you can use Eknath script six constructs
they're just transpiled so there's some
performance considerations but like I
said natural one is definitely under
active development Oracle is definitely
gets it the JavaScript in Java is a big
deal and then they are pursuing that
because you know the reality is for Java
and the browser applets are gone right
nobody's even thinking about I mean
before there and now that even that
they're officially gone nobody was
really that happy about using applets
for a while now so the web is just
getting to be a bigger and bigger deal
and javascript is everywhere you know
with and with tools like PhoneGap Apache
Cordova anybody ever play with that you
can you can build a simple web
application and package it for the web
store you can put it into the Apple
Store put it in the Android store so
there's these powerful platforms that
are emerging to let you move your code
between all kinds of different
environments you can get nodejs kind of
style work with yeah
yes yes so you can you should be able to
call any method on any java object from
javascript using Nashorn so anything you
could write in Java I believe and I
believe you should be able to MIT you
can do things like manipulate threads
from JavaScript in using Nashorn like
you know if you have a handle to those
objects you can call you just you can
call methods on Java objects so anything
you can do via calling methods on Java
objects you may you may have to do some
casting you may have to go depending out
like if you try to do something really
low-level I don't have a Pat answer in
terms of you know will it be easy but
you should be anything you can do in
Java you should be able to do in
JavaScript there may be some like there
may be some interesting things when it
comes to getting if you have like you
know a method that you're using casting
you know to that the type detection
plays a big role in it it may get a
little complicated but so you may have
to do something like write an adapter
class in Java that like gives JavaScript
little help in hand just to understand
the typing system</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>