<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java Mission Control | Coder Coacher - Coaching Coders</title><meta content="Java Mission Control - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java/">Java</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java Mission Control</b></h2><h5 class="post__date">2013-09-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WMEpRUgp9Y4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to this screencast on the Java
Mission Control the new java management
extensions sole which is in java update
40 my name is roger brinkley today we're
going to talk about an overview of the
Java Mission Control we'll do an
installation and usage and then we'll
walk through a couple of the tools that
we have as well so the overview the
purpose in the design of the Java
Mission Control was really to provide a
JDK profiling and diagnostic tool
platform the overall area in which it's
going to be used primarily is in
production views but it does work pretty
well in in the development platforms as
well our development use as well what
it'll give you is some real-time
monitoring of a variety of key
indicators you're going to see that with
in Mission Control itself and then with
the addition of flight recorder you have
the capability of doing some profiling
and diagnostics getting the events that
are coming back from that as well
the way this is implemented is with a
focus on really low overhead that can be
done primarily because a lot of what's
being done was built into the JVM it's
already available in the runtime
information what we just have to do with
Java Mission Control is be able to
capture that information but do it in
such a way that it's a high performance
implementation doesn't impact your
application as you're running it so that
we can actually attach it to an existing
application we can have the the running
of the application and not really affect
your performance or at least have a
minimal effect on your performance the
platforms that are supported are the
Windows and Linux x86 x64 and Mac OS 10
for the client and then the server
additional support for Solaris x86 x64
and SPARC there are two main tools for
Java Mission Control
they are the management console and the
flight recorder now the management
console is really one of the most
comprehensive java management extensions
oles that's available you probably won't
find anything that covers as many
details as this particular one does
then on top of that you have the flight
recorder which is a built-in
high-performance java virtual machine a
bit recorder taking a look at what's
happening on a regular basis going on
with with your particular application
that you're running the origins of this
came from the J rocket java virtual
machine based tool suite that was known
as J rocket Mission Control when Oracle
acquired the Java language as part of
one of its acquisitions J rocket and hot
spot became a convergence they converged
a rocket and hotspot into one common
code base and as part of that
convergence one of the things needed to
happen was that we needed to have
support for J rocket mission control and
so renamed Java Mission Control and
reimplemented so it would work into the
hotspot environment as well if you're
running on J rockets you want to run
this under you want to run J rocket
mission control for not one but if
you're on the hotspot environment you
want to run J Java Mission Control 5.2
or later the key part of all of this is
is that part of the integration part of
moving this together is that this is now
officially everything has been converged
and it's now available in JDK 7 update
40 so let's take a look at some
installation and usage of this so the
Java Mission Control installation the
Java Mission Control client is actually
a standalone client and to be able to
install it all you have to do is install
JDK at least 7.7 to 40 or later it's in
the same bin directory as Java Java C
you'll see that in just a few minutes
it's called JMC to be able to run that
the eclipse version can be ran along
with the eclipse in the in the in the
Eclipse environment as a plugin and you
can get installations of that from the
update from the OTN update site that's
listed below
there are additionally some experimental
plugins that you want to take a look at
these are already configured for use in
the standalone client the end the
installation of that is real
simple you just go choose help and then
install new software again with the
Eclipse version you can install those
from the update site exactly the same as
the one before a little key note here on
the on the plugins though is that
they're not thoroughly tested and
they're also not supported so use at
your own risk if you find a bug
certainly report it they'll get to it as
soon as they can get to it but at this
particular point in time they are not
tested they're not supported so use it
your own risk now starting the Java
mission control client basically all you
have to do is double click on the launch
Orion bin now on Mac OS 10 it's a little
more complicated than that
and we'll go into that in just a minute
I'm going to show you that actually how
that works there's a variety of logging
setting files in java.util logging
format that can be specified from the
Preferences you know you have window
preferences Mission Control logging
setting files those are basically the
the options that you would have here
more information about this and actually
more information on a lot of Java
Mission Control you can find at markers
Hertz blog specifically related to the
log setting files though you'll find
them in the article that's listed here
now let's take a let's go in and let's
actually show you how you launch Mission
Control now you remember I told you that
it's a little bit different on a Mac
environment as far as how you're going
to run or execute the installation how
you're going to install it how you're
going to run the Java Mission Control so
we take a look here now normally what
you would do is if you're working with
any of the other Java commands you would
say something like Java slag our - full
version to get the full version of Java
and of course it comes up and that's
because when we look at where Java is
located it's in user bin Java but
unfortunately when we do that with JMC
we find that the command is not found
and that's because the linkage that was
necessary to connect where Java actually
is or in this case JMC was not connected
to user bin so what we have to do is if
we look at a PWD if we go to
library Java Java Virtual Machines jdk
1.7 or build 40 jdk /contents slash home
slash bin then we can just do a dot
slash JMC and we can start executing the
java mission control and of course you
see right away you know that it's it's
starting to execute in there now I'm
going to control see that I'm going to
I'm going to kill that process right
there and I'm going to go ahead and show
you another way in which you can execute
this I'm going to go over here to finder
window
and I'm looking my hard drive and in the
hard drive if we go to the library drop
down to Java go to Java virtual machines
go to the 707 you forty update contents
home now I could go to bin just like I
went over here and and run JMX from
there but I'm going to do something a
little bit different here I'm going to
go to Lib and I'm going to give a
Mission Control and right there is a
Java Mission Control application and so
we can double click on this application
here and it's going to show up exactly
the same way now one bit of warning here
try to drag that application over into
your application directory it simply
won't work in that direction
the futures should be able to be able to
find this with the shortcut window up
here the helper window now when it comes
up the first time you're going to see
this window that's very similar to this
you'll have an opportunity to take a
look at what's in the Java mix console
so you can take a look some guided tours
get a quick overview browse iam beans
view the information files you can also
go to the flight recorder do the very
same things look at the overview view
some of the details analyze events and
then of course the last thing is the
plugins now in the plugins there's
something I want to show you here so
we're going to go up here to the to the
menu bar and we're going to pull down on
help and we're going to say install new
software now that if this is the first
time that you're going to do this then
it's probably a good idea to take a look
at some of the plugins that are
available there are a variety of plugins
that you might find interesting
here let's take a look first at the
console plugins and if I go the the one
here that just interests me the most is
the J console plug-in support so I would
definitely be colluding on that one
there's also support for the D trace
recorder and there's a recorder for
WebLogic flight recorder plug-in for web
logic and then finally the overflow heap
analyzer so I would probably choose
those two now I can select now take a
look at try to install them and of
course it's going to say well hey I
can't complete this and the reason I
can't complete this is because these
items have actually already been
installed once so but if you hadn't it
would go through a variety of processes
and you would go through and do the
installation so we'll cancel that back
out so that's how you get your plugins
or update or add any additional plugins
that you might be interested in now if
we want to go and take a look and
actually open up the Java Mission
Control we can do that right here click
on this and you can see right now that
we have actually three Java virtual
machines that are running there's a
glassfish virtual machine there is
actually a java virtual machine which is
running Mission Control and then there's
a derby machine which is running out
here as well so when we will do a little
bit more a little bit later on but that
gives you an idea of how you can install
Java Mission Control and then also how
you would run it and then how you can
also add the plugins that are associated
with it not you have an idea on how
Mission Control is run let's take a look
at starting this from the server now
server here really means an application
it could be in any type of server
environment but if you want to run the
flight recorder you're going to have to
add a couple of options and this is this
- xx semicolon R : I mean plus unlock
commercial features - xx : + flight
recorder and those are those both have
to be on the command line will show that
a little bit later in the in the in the
demos we talked about the flight
recorder itself now there are plenty of
other command-line options for
controlling Java flight recorder
again I told you that the source that
you really want to go to when we're
talking about Mission Control is Marcus
hurt in his blogs starting the
management agent so you want to use the
common management jmx remote properties
it just as you normally would
there's a guidance for that in the Java
70 Docs set you can take a look at those
give you an idea of how to run those
don't forget the RMI registry and the
server port can be set to the same port
that's really good from a tunneling
point of view and that has been there
since the 7 update for and then finally
are also the the broadcasts of the other
presence of the agents on the network
these are new so you can do auto
discovery and then you can do the names
now sometimes here a little warning here
caveat sometimes arm I will get the host
name wrong so it's always a good idea to
specify that host name let's walk
through the tools here so the JMX consul
highlight this is the Java mission
control simple but rich java management
extensions think of it as jake console
on a steroid type of environments going
to give you some real-time monitoring of
key indicators you're going to see that
in just a second as we go through the
demos you can set up triggers the very
simple rule engines with the triggers
you'll find that to be very very easy
for you to handle this is great for a
developer but also really good for the
system admins because they can provide a
variety of custom actions and in
responses to those particular actions
that are come out so you know once you
get this particular action how do you
want to handle it you will be sent an
email you just want to notice to come up
what do you want to have happen there
and then also there's a variety of the
experimental plugins that we talked
about before
so in particular oracle coherence and
then also the j console plugin support
are two of the more ready ones so let's
go now into that demo now when it comes
to the demos that we're going to run
today we'll run everything in a
combination
netbeans and a standalone java mission
control environment if you're in Eclipse
environment you can run Java Mission
Control directly within the Eclipse
environment but that's not something we
can do yet within the NetBeans
environment but to demonstrate this what
I want to do is show you this simple
program it's a column loaded deadlock
and as you can imagine it's a very does
exactly that we have an allocation
thread here which is going to just
continually run and keep updating 400000
are 40,000 int entries into new temp
characters and just keep moving things
around and around as we update that as
we go along and then the thread lock
side will pass in two objects l1 which
is lock one and the other one is l2 is
locked too and basically we're going to
synchronize on those two objects and
obviously what we're going to do down
here in the main is we're going to run
the first thing we'll do is we'll get a
locker thread the first thread and then
the second thread and then we'll go
through and we'll initialize both the
first one in the second one
locking each one on the other one and
then we'll run the allocation thread
will start it will start the first
thread and we'll start the second thread
that's pretty much it so let's go ahead
and we'll just get this running and
started so we'll come over here press
run take a look here and we should see
this running in just a second in fact
this what I'm going to do is hop over
here into the Oracle Java mission
control and we now see the load in the
deadlock which is there so we're going
to start the jmx Council from there it's
going to start up here in just a second
and we begin to see the loads already
occurring here we can see the machine
CPU usage starting to spike and go up we
can see the java virtual machine CPU
usage here as well and then we can take
a look at our physical memory as it goes
across we can see that in dials up above
here the the used Java memory heap
and the java java virtual machine cpu
usage and the lifestyle of the set
fragmentation now what's kind of cool
about this is I'm going to use my neck
and I have a little pad to the side so
I'm going to actually focus right here
on the processor window and just by
scrolling back and forth I can adjust
what that width is that I'm looking at
and what the time periods are that I'm
looking at and I can expand them out
shrink them back in do whatever I want
to do as far as as that goes there the
other thing that we can do here is we
can do a right-click now you notice it's
still collecting data there even though
I've got it expanded out so let's go
ahead and do a right-click and let's
just show and let's just say just show
me the last minute and now I'm just
looking at what is the last minute there
and again we can collapse this get focus
again here and we can collapse that down
to where we're looking at just that last
minute of data that's going on we can
see we're kind of getting these humps
and valleys that are going through here
and our our our CPU usages is spiking
and then we're probably doing a garbage
collection that it's going to spike
again and go back and forth now we can
also go through here and we can freeze
these updates at any particular point in
time that we want to we'll just press
this right here and say freeze and at
this point everything is frozen you can
tell there's no more updates that are
going on in the processor window now we
can add other charts to this for
instance let's go down here and let's go
down to the memory side and let's take a
look at the down here in the threading
side and there's a thread count and
we'll add that in and now you can see
the yellow line there with the thread
count now finally we can go down and
take a look at the server information
tab and it's going to give us a variety
of information that tells us about the
machine that we're running on
you know this is is running OS 10.8 dot
four it's got two processors four
gigabytes of memory the ID of the the
process ID here
what hotspot version it is seven seven
you forty build forty three so a little
bit of older one than what most of you
will be running by the time this
releases and we can take a look at our
current heap size the committed heap
size and the maximum beep size that
we'll be able to achieve with this
machine now of course when that's all
done one of the things that you might
want to do is say you've added a bunch
of items like we did here with the total
life thread count and you're thinking
well really what I want to do is I just
want to reset everything's just take it
back give me the screen the way it
initially started with so I can go up
here to this button up here which is the
reset default Mission Control default
tabs says okay and we get reset and
we're back exactly where we were the
screens are in the presentations when
they initially were started up and and
down here the memory thread-count that
we had was removed so that kind of takes
care of the general side so let's move
now to the mbeans so we're going to
click on them beams and in here we can
look at a variety of different
attributes you know that are coming in
here so let's let's start with threading
we can see here the the thread count
that we have 16 threads we can also go
up here and look at the deadlock thread
count and we notice that there are two
deadlock threads in this so this is a
nice to be able to get this information
that that's coming in here as well let's
go take a look at the memory for a
little bit memory pool I should say and
we'll take a look at the memory pool go
to the code cache and in looking at the
code cache information we'll go down
here and take a look at usage and we can
see the amount of what we have committed
number events max size how much has been
used you know at this particular point
in time now we can change a few
attributes if we
1 &amp;amp; 2 any of these are here that are in
yellow we could make a change to them
and it could change the usage threshold
or whatever we wanted it to be
collection use each threshold we could
change that as well now let's go over to
the operations tab here actually let's
go back to threading first and then
we'll go to the operations tab and we
can take a look here we could say find
deadlock threads and we execute this and
we can see that the value is 13 and 12
of course that doesn't give us a very
good idea other than knowing that it's
it's thread 13 and thread 12 there's
there's better ways that you know that
we might be able to do this so now let's
go back to attributes and we take a look
at the attributes and we can update the
interval numbers that we have here for
instant visible columns update interval
a dead thread lock count that's a good
example so instead of every 5,000
milliseconds we could make it every 500
milliseconds now let's go back to our
attributes here for a minute now the
last thing that we can do here is let's
let's select thread count and then we're
going to visualize the thread count and
so we can add the chart new chart that's
added and then if we go back to our
general tab now you'll see that we now
have a chart down here which is charting
the the thread counts I could have added
it to one of these others it doesn't
make much sense to be able to do that
and we can simply remove that as well
just by pressing this right here so
let's cover one less thing in mbeans and
let's go down to the trigger tab down
here at the bottom and let's see if we
can trigger some events it's
particularly particularly those are
related to CPU usage so we'll go to
condition first first and we're going to
change the max trigger value to be do
something anytime the CPU usage is above
say thirty percent so it's sustained
over one second and we'll limit this
period we could say the 60 seconds each
but let's just change it to five so that
you'll see the frequency of these
coming up now that we set the limit
period down to five let's go ahead and
we'll just turn on this value and we
should see in just a second or two here
where the max value is obtained and
there goes the alert which is it kind of
exactly what we were expecting it to
have happen once every few seconds there
now if I close that I'll probably be
getting another one of those here in
just another few seconds and now you can
see there were two alerts that occurred
they occurred actually just within 30
seconds of each other so we can see that
we're using more than 30% of the CPU by
humidity one point in time we can clear
those alerts close this window go back
we can turn this alert back off let's
set our trigger values back up to what
they were initially once every 60
seconds now that's it for M beam so
let's turn our focus to the last piece
here which is the run time in the run
time environment we can look at a
variety of things here we've already
kind of seen the the processor usage
that was on the general screen that's
exactly going to be the pretty it's
exactly the same presentation that's
right here but coming back to the run
time what we can look at is some of the
key properties here and so we can say
things like star AWT and we'll get all
of the properties in turn related to AWT
in this case e n mb t toolkit jwa dt
graphic server and the printer usage you
can use regular expressions in this
particular case down here as well we can
take a look at memory we could see the
physical memory the basic key attributes
of what we would look out here garbage
collection how many times how long it's
taking what the duration is with each
one of these these garbage collections
memory pools and then threads now
remember we talked about threads once
before and we said there's a better way
of doing deadlock detection and so we've
gone to the type threads down here in
the runtime and let's just go to
deadlock detection here
and we can see we've got two threads
thread three and thread for which are
blocked and the owner of those locks is
thread three so thread four is owned by
thread three that's what's causing the
lock there and thread four is where the
other lock is coming from a variety of
other information that we might want to
take a look at you know we could look at
allocations see who's really allocating
this the JMX server connection is is
actually a crew in most of it some CPU
profiling whereas most of the work
coming from and if we take a look at the
CPU usage we can see that all of the CPU
usage is in thread two and we would
expect it to be there because that's
where all the memory allocation is
occurring and it's just sitting there in
a loop going back and forth now there
are a lot of other features that exist
within the Java Mission Control
certainly you know a lot more
information that we can take a look at
now that we looked at the demo we look
at another piece here we're just we're
not going to be able to look at this in
full details but the Java flight
recorder here are some of the highlights
that you want to look at so we talked
about this before being a real high
performance JVM event recorder it does
produce a binary recordings but these
recordings are really self describing
self-contained chunks so they are
standalone type of environment once they
go out they do continue to run tide
profile information so you'll get a
whole idea of what goes on you can run
the recorder it can be run continuously
or you can run it for just a short-term
now when you when you run it
continuously whatever something happens
the data the data is dumped so you got
to think about this as like having a
black box for the java virtual machine
now we'll do more on java flight
recorder in another screencast but I
want to at this particular point in time
go in and just show you a quick demo of
how you would get Java flight recorder
started using the the load end and
thread demo that we were using before
this is by no means a comprehensive
investigation of what's going on with
flight recorder but just give you an
idea on how you can get it started how
you can get things running so if we take
a look here at the load deadlock java
virtual machine that's running we know
we've already gone through the in being
server that's running here we can take a
look at the flight recorder and we'll
notice that there are no recordings
running now we can start them right away
but before we do that I want to hop over
here into the the Java Mission Control
load and deadlock project that we have
in NetBeans I want to show you just a
special little piece over here and that
is before you go and run this you've got
to set those properties and here the
properties have come up and and we can
see here if we hop down here into the
run section what you need to add is this
right here so we're going to just go to
customize and we can see the X X colon
plus flight recorder and X X colon plus
unlock commercial features so those are
the two that you really have to add in
there if you uncheck those of course
they're going to go away you're going to
have to remember what those virtual
machine options are so that's all you
have to do to be able to get it to run
I've already got it set up so we can go
back here to the Java Mission Control
and we can say okay let's start a flight
recording and we'll start the flight
recording we have two choices when we go
to start a flight recording and one is
is that we can do a fixed time so we
could do this for one minute but in this
strict case I want to do a continuous
recording and we're going to do the
continuous server and let's low overhead
configuration it's safe for continuous
use of productions environments I could
set other event management settings up
so I could go to the template manager
here and and really customize what I
wanted to do but we're just going to use
continuous here and we'll press finish
and we should notice here real quickly
that there's a recording which is going
we notice that we know this is a
continuous recording because of the
infinite side which is right here we
could also run our recording start the
flight recording that was just a fixed
times and we can do it profiling on
service so this is just a profile type
of environment that we want to run and
you'll notice that we have two of them
also notice here that the countdown is
going on fifty five fifty four and so on
and so forth but while that's running
let's just go over here to my recording
and we'll just going to double click on
this and last part of the recording
we'll take that we're dump the recording
so we can go take a look at it notice we
see similar type of controls at the top
heap you see total CPU usage a little
different here than we got a GC pause
time so we'll be able to take a look at
you know a variety of environments that
are here but this will give us a general
idea at least how the how the execution
goes and how things start up and we can
see here also the various intervals that
we're looking at here as far as the
events when the events were coming in a
whole bunch of information that's here
that we'll cover in the next screencast
that we're going to do specifically this
related to Java flight recorder some
final information some resources that
you probably want to take a look at here
so the home page of course is oracle
comm slash Mission Control and forums if
you have any questions you concerns or
issues you can take a look at the
forum's as listed here too twitter
handles that you probably want to start
following if you're interested in this
one is Mission Control
Java Mission Control the other one is
hurt which is for Marcus hurt the blog
for this is Marcus Hertz blog that's
primarily the only thing he does on that
blog and yes there is a Facebook account
for this so you can find that
information there thanks for listening
to this screencast on the Java Mission
Control</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>